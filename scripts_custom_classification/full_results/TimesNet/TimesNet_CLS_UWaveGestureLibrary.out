Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 54.574599742889404
Epoch: 1, Steps: 8 | Train Loss: 1.907 Vali Loss: 1.364 Vali Acc: 0.728 Test Loss: 1.364 Test Acc: 0.728
Validation loss decreased (inf --> -0.728111).  Saving model ...
Epoch: 2 cost time: 55.180747985839844
Epoch: 2, Steps: 8 | Train Loss: 0.874 Vali Loss: 0.565 Vali Acc: 0.812 Test Loss: 0.565 Test Acc: 0.812
Validation loss decreased (-0.728111 --> -0.812494).  Saving model ...
Epoch: 3 cost time: 64.11958861351013
Epoch: 3, Steps: 8 | Train Loss: 0.327 Vali Loss: 0.461 Vali Acc: 0.850 Test Loss: 0.461 Test Acc: 0.850
Validation loss decreased (-0.812494 --> -0.849995).  Saving model ...
Epoch: 4 cost time: 50.863688468933105
Epoch: 4, Steps: 8 | Train Loss: 0.132 Vali Loss: 0.548 Vali Acc: 0.856 Test Loss: 0.548 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.856245).  Saving model ...
Epoch: 5 cost time: 50.55513954162598
Epoch: 5, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.565 Vali Acc: 0.850 Test Loss: 0.565 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 50.7432656288147
Epoch: 6, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.605 Vali Acc: 0.856 Test Loss: 0.605 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 49.14568042755127
Epoch: 7, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.683 Vali Acc: 0.834 Test Loss: 0.683 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 46.54212927818298
Epoch: 8, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.644 Vali Acc: 0.847 Test Loss: 0.644 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 49.677995920181274
Epoch: 9, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.620 Vali Acc: 0.859 Test Loss: 0.620 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859369).  Saving model ...
Epoch: 10 cost time: 47.94151735305786
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.678 Vali Acc: 0.859 Test Loss: 0.678 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 49.761038064956665
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.715 Vali Acc: 0.866 Test Loss: 0.715 Test Acc: 0.866
Validation loss decreased (-0.859369 --> -0.865618).  Saving model ...
Epoch: 12 cost time: 52.30140519142151
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.719 Vali Acc: 0.866 Test Loss: 0.719 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 43.89250135421753
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.711 Vali Acc: 0.859 Test Loss: 0.711 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 48.86658000946045
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.709 Vali Acc: 0.863 Test Loss: 0.709 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 41.69435787200928
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.715 Vali Acc: 0.863 Test Loss: 0.715 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 48.84168767929077
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.718 Vali Acc: 0.863 Test Loss: 0.718 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 48.47130584716797
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.721 Vali Acc: 0.863 Test Loss: 0.721 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 50.886998653411865
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.718 Vali Acc: 0.863 Test Loss: 0.718 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 44.340293407440186
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.727 Vali Acc: 0.863 Test Loss: 0.727 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 43.041391134262085
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.740 Vali Acc: 0.866 Test Loss: 0.740 Test Acc: 0.866
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 51.38965725898743
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.751 Vali Acc: 0.866 Test Loss: 0.751 Test Acc: 0.866
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 75306888
model size : 289.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 20.556752920150757
Epoch: 1, Steps: 8 | Train Loss: 1.896 Vali Loss: 1.405 Vali Acc: 0.681 Test Loss: 1.405 Test Acc: 0.681
Validation loss decreased (inf --> -0.681236).  Saving model ...
Epoch: 2 cost time: 18.25893998146057
Epoch: 2, Steps: 8 | Train Loss: 0.923 Vali Loss: 0.585 Vali Acc: 0.828 Test Loss: 0.585 Test Acc: 0.828
Validation loss decreased (-0.681236 --> -0.828119).  Saving model ...
Epoch: 3 cost time: 15.696699857711792
Epoch: 3, Steps: 8 | Train Loss: 0.340 Vali Loss: 0.474 Vali Acc: 0.838 Test Loss: 0.474 Test Acc: 0.838
Validation loss decreased (-0.828119 --> -0.837495).  Saving model ...
Epoch: 4 cost time: 19.32313585281372
Epoch: 4, Steps: 8 | Train Loss: 0.192 Vali Loss: 0.563 Vali Acc: 0.856 Test Loss: 0.563 Test Acc: 0.856
Validation loss decreased (-0.837495 --> -0.856244).  Saving model ...
Epoch: 5 cost time: 16.55305576324463
Epoch: 5, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.589 Vali Acc: 0.844 Test Loss: 0.589 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 16.027275562286377
Epoch: 6, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.720 Vali Acc: 0.838 Test Loss: 0.720 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 17.285079956054688
Epoch: 7, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.722 Vali Acc: 0.834 Test Loss: 0.722 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 17.11976432800293
Epoch: 8, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.765 Vali Acc: 0.834 Test Loss: 0.765 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 17.52385902404785
Epoch: 9, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.808 Vali Acc: 0.863 Test Loss: 0.808 Test Acc: 0.863
Validation loss decreased (-0.856244 --> -0.862492).  Saving model ...
Epoch: 10 cost time: 17.620084047317505
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.799 Vali Acc: 0.866 Test Loss: 0.799 Test Acc: 0.866
Validation loss decreased (-0.862492 --> -0.865617).  Saving model ...
Epoch: 11 cost time: 17.312394380569458
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.762 Vali Acc: 0.863 Test Loss: 0.762 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 17.96664047241211
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.757 Vali Acc: 0.866 Test Loss: 0.757 Test Acc: 0.866
Validation loss decreased (-0.865617 --> -0.865617).  Saving model ...
Epoch: 13 cost time: 13.698880195617676
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.750 Vali Acc: 0.866 Test Loss: 0.750 Test Acc: 0.866
Validation loss decreased (-0.865617 --> -0.865618).  Saving model ...
Epoch: 14 cost time: 18.70704436302185
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.747 Vali Acc: 0.866 Test Loss: 0.747 Test Acc: 0.866
Validation loss decreased (-0.865618 --> -0.865618).  Saving model ...
Epoch: 15 cost time: 13.671567916870117
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.747 Vali Acc: 0.872 Test Loss: 0.747 Test Acc: 0.872
Validation loss decreased (-0.865618 --> -0.871868).  Saving model ...
Epoch: 16 cost time: 17.318431854248047
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.750 Vali Acc: 0.872 Test Loss: 0.750 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 19.325660705566406
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.755 Vali Acc: 0.872 Test Loss: 0.755 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 17.51228141784668
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.757 Vali Acc: 0.872 Test Loss: 0.757 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 19.658061981201172
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.761 Vali Acc: 0.872 Test Loss: 0.761 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 17.118033409118652
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.763 Vali Acc: 0.872 Test Loss: 0.763 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 18.0664165019989
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.764 Vali Acc: 0.872 Test Loss: 0.764 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 16.990345239639282
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.766 Vali Acc: 0.872 Test Loss: 0.766 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 19.030052185058594
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.767 Vali Acc: 0.872 Test Loss: 0.767 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 18.877289533615112
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.769 Vali Acc: 0.872 Test Loss: 0.769 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 18.602956295013428
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.773 Vali Acc: 0.872 Test Loss: 0.773 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 22350728
model size : 87.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 39.84217166900635
Epoch: 1, Steps: 8 | Train Loss: 1.905 Vali Loss: 1.377 Vali Acc: 0.719 Test Loss: 1.377 Test Acc: 0.719
Validation loss decreased (inf --> -0.718736).  Saving model ...
Epoch: 2 cost time: 36.638898849487305
Epoch: 2, Steps: 8 | Train Loss: 0.875 Vali Loss: 0.584 Vali Acc: 0.816 Test Loss: 0.584 Test Acc: 0.816
Validation loss decreased (-0.718736 --> -0.815619).  Saving model ...
Epoch: 3 cost time: 34.1614043712616
Epoch: 3, Steps: 8 | Train Loss: 0.326 Vali Loss: 0.467 Vali Acc: 0.850 Test Loss: 0.467 Test Acc: 0.850
Validation loss decreased (-0.815619 --> -0.849995).  Saving model ...
Epoch: 4 cost time: 35.33713674545288
Epoch: 4, Steps: 8 | Train Loss: 0.133 Vali Loss: 0.554 Vali Acc: 0.856 Test Loss: 0.554 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.856244).  Saving model ...
Epoch: 5 cost time: 34.73658537864685
Epoch: 5, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.579 Vali Acc: 0.844 Test Loss: 0.579 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 34.331257343292236
Epoch: 6, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.625 Vali Acc: 0.841 Test Loss: 0.625 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 32.165043115615845
Epoch: 7, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.696 Vali Acc: 0.834 Test Loss: 0.696 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 30.833057403564453
Epoch: 8, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.654 Vali Acc: 0.856 Test Loss: 0.654 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 33.55664873123169
Epoch: 9, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.636 Vali Acc: 0.859 Test Loss: 0.636 Test Acc: 0.859
Validation loss decreased (-0.856244 --> -0.859369).  Saving model ...
Epoch: 10 cost time: 31.60750460624695
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.693 Vali Acc: 0.853 Test Loss: 0.693 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 35.00718903541565
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.729 Vali Acc: 0.859 Test Loss: 0.729 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 34.48788595199585
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.732 Vali Acc: 0.859 Test Loss: 0.732 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 33.61382842063904
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.725 Vali Acc: 0.856 Test Loss: 0.725 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 30.583884716033936
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.722 Vali Acc: 0.859 Test Loss: 0.722 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 34.57611322402954
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.728 Vali Acc: 0.859 Test Loss: 0.728 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 34.79638886451721
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.730 Vali Acc: 0.859 Test Loss: 0.730 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 35.506432056427
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.732 Vali Acc: 0.863 Test Loss: 0.732 Test Acc: 0.863
Validation loss decreased (-0.859369 --> -0.862493).  Saving model ...
Epoch: 18 cost time: 39.2026264667511
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.729 Vali Acc: 0.863 Test Loss: 0.729 Test Acc: 0.863
Validation loss decreased (-0.862493 --> -0.862493).  Saving model ...
Epoch: 19 cost time: 40.72431683540344
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.737 Vali Acc: 0.869 Test Loss: 0.737 Test Acc: 0.869
Validation loss decreased (-0.862493 --> -0.868743).  Saving model ...
Epoch: 20 cost time: 41.58953142166138
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.749 Vali Acc: 0.869 Test Loss: 0.749 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 39.036861419677734
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.760 Vali Acc: 0.869 Test Loss: 0.760 Test Acc: 0.869
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 36.97147297859192
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.762 Vali Acc: 0.869 Test Loss: 0.762 Test Acc: 0.869
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 37.335057735443115
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.761 Vali Acc: 0.866 Test Loss: 0.761 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 32.022884130477905
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.762 Vali Acc: 0.866 Test Loss: 0.762 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 32.78981876373291
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.759 Vali Acc: 0.863 Test Loss: 0.759 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 37.31889057159424
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.761 Vali Acc: 0.863 Test Loss: 0.761 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 36.80425047874451
Epoch: 27, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.768 Vali Acc: 0.863 Test Loss: 0.768 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 39.58081936836243
Epoch: 28, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.773 Vali Acc: 0.863 Test Loss: 0.773 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 39.53407645225525
Epoch: 29, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.777 Vali Acc: 0.863 Test Loss: 0.777 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 75306888
model size : 289.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 14.620932340621948
Epoch: 1, Steps: 8 | Train Loss: 1.893 Vali Loss: 1.411 Vali Acc: 0.681 Test Loss: 1.411 Test Acc: 0.681
Validation loss decreased (inf --> -0.681236).  Saving model ...
Epoch: 2 cost time: 12.177220106124878
Epoch: 2, Steps: 8 | Train Loss: 0.922 Vali Loss: 0.594 Vali Acc: 0.828 Test Loss: 0.594 Test Acc: 0.828
Validation loss decreased (-0.681236 --> -0.828119).  Saving model ...
Epoch: 3 cost time: 13.491049766540527
Epoch: 3, Steps: 8 | Train Loss: 0.338 Vali Loss: 0.478 Vali Acc: 0.834 Test Loss: 0.478 Test Acc: 0.834
Validation loss decreased (-0.828119 --> -0.834370).  Saving model ...
Epoch: 4 cost time: 13.627466917037964
Epoch: 4, Steps: 8 | Train Loss: 0.194 Vali Loss: 0.571 Vali Acc: 0.856 Test Loss: 0.571 Test Acc: 0.856
Validation loss decreased (-0.834370 --> -0.856244).  Saving model ...
Epoch: 5 cost time: 14.060084104537964
Epoch: 5, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.594 Vali Acc: 0.844 Test Loss: 0.594 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 12.785319328308105
Epoch: 6, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.727 Vali Acc: 0.841 Test Loss: 0.727 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 13.421037673950195
Epoch: 7, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.731 Vali Acc: 0.831 Test Loss: 0.731 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 13.335939645767212
Epoch: 8, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.766 Vali Acc: 0.834 Test Loss: 0.766 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 13.541032314300537
Epoch: 9, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.812 Vali Acc: 0.856 Test Loss: 0.812 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 12.636038541793823
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.806 Vali Acc: 0.863 Test Loss: 0.806 Test Acc: 0.863
Validation loss decreased (-0.856244 --> -0.862492).  Saving model ...
Epoch: 11 cost time: 12.326397180557251
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.766 Vali Acc: 0.866 Test Loss: 0.766 Test Acc: 0.866
Validation loss decreased (-0.862492 --> -0.865617).  Saving model ...
Epoch: 12 cost time: 14.587568044662476
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.761 Vali Acc: 0.866 Test Loss: 0.761 Test Acc: 0.866
Validation loss decreased (-0.865617 --> -0.865617).  Saving model ...
Epoch: 13 cost time: 13.80462908744812
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.753 Vali Acc: 0.866 Test Loss: 0.753 Test Acc: 0.866
Validation loss decreased (-0.865617 --> -0.865617).  Saving model ...
Epoch: 14 cost time: 14.308533668518066
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.749 Vali Acc: 0.866 Test Loss: 0.749 Test Acc: 0.866
Validation loss decreased (-0.865617 --> -0.865618).  Saving model ...
Epoch: 15 cost time: 14.358838319778442
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.749 Vali Acc: 0.869 Test Loss: 0.749 Test Acc: 0.869
Validation loss decreased (-0.865618 --> -0.868743).  Saving model ...
Epoch: 16 cost time: 14.287127256393433
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.752 Vali Acc: 0.878 Test Loss: 0.752 Test Acc: 0.878
Validation loss decreased (-0.868743 --> -0.878117).  Saving model ...
Epoch: 17 cost time: 13.265155792236328
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.757 Vali Acc: 0.878 Test Loss: 0.757 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 12.880881786346436
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.760 Vali Acc: 0.878 Test Loss: 0.760 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 12.210770606994629
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.764 Vali Acc: 0.872 Test Loss: 0.764 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 13.743589162826538
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.767 Vali Acc: 0.872 Test Loss: 0.767 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 10.693040609359741
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.768 Vali Acc: 0.872 Test Loss: 0.768 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 13.669317960739136
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.770 Vali Acc: 0.872 Test Loss: 0.770 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 13.257169961929321
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.772 Vali Acc: 0.872 Test Loss: 0.772 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 14.48950743675232
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.773 Vali Acc: 0.872 Test Loss: 0.773 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 11.7124183177948
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.777 Vali Acc: 0.872 Test Loss: 0.777 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 12.224752187728882
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.777 Vali Acc: 0.872 Test Loss: 0.777 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.878125
model parameter : 22350728
model size : 87.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 18.395572185516357
Epoch: 1, Steps: 8 | Train Loss: 1.907 Vali Loss: 1.399 Vali Acc: 0.703 Test Loss: 1.399 Test Acc: 0.703
Validation loss decreased (inf --> -0.703111).  Saving model ...
Epoch: 2 cost time: 20.172913074493408
Epoch: 2, Steps: 8 | Train Loss: 0.915 Vali Loss: 0.605 Vali Acc: 0.806 Test Loss: 0.605 Test Acc: 0.806
Validation loss decreased (-0.703111 --> -0.806244).  Saving model ...
Epoch: 3 cost time: 17.392872095108032
Epoch: 3, Steps: 8 | Train Loss: 0.385 Vali Loss: 0.491 Vali Acc: 0.847 Test Loss: 0.491 Test Acc: 0.847
Validation loss decreased (-0.806244 --> -0.846870).  Saving model ...
Epoch: 4 cost time: 16.132925033569336
Epoch: 4, Steps: 8 | Train Loss: 0.166 Vali Loss: 0.564 Vali Acc: 0.853 Test Loss: 0.564 Test Acc: 0.853
Validation loss decreased (-0.846870 --> -0.853119).  Saving model ...
Epoch: 5 cost time: 19.245612859725952
Epoch: 5, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.603 Vali Acc: 0.847 Test Loss: 0.603 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 21.010744094848633
Epoch: 6, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.653 Vali Acc: 0.850 Test Loss: 0.653 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 19.793076276779175
Epoch: 7, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.737 Vali Acc: 0.834 Test Loss: 0.737 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 18.988868951797485
Epoch: 8, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.730 Vali Acc: 0.834 Test Loss: 0.730 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 18.706292390823364
Epoch: 9, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.737 Vali Acc: 0.847 Test Loss: 0.737 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 20.01012659072876
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.754 Vali Acc: 0.847 Test Loss: 0.754 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 17.484923839569092
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.767 Vali Acc: 0.847 Test Loss: 0.767 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 17.61608386039734
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.781 Vali Acc: 0.838 Test Loss: 0.781 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 18.95130443572998
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.787 Vali Acc: 0.838 Test Loss: 0.787 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 16.612565517425537
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.792 Vali Acc: 0.841 Test Loss: 0.792 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 75306888
model size : 289.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 10.08265471458435
Epoch: 1, Steps: 8 | Train Loss: 1.892 Vali Loss: 1.434 Vali Acc: 0.681 Test Loss: 1.434 Test Acc: 0.681
Validation loss decreased (inf --> -0.681236).  Saving model ...
Epoch: 2 cost time: 8.676262617111206
Epoch: 2, Steps: 8 | Train Loss: 0.957 Vali Loss: 0.628 Vali Acc: 0.812 Test Loss: 0.628 Test Acc: 0.812
Validation loss decreased (-0.681236 --> -0.812494).  Saving model ...
Epoch: 3 cost time: 6.951052665710449
Epoch: 3, Steps: 8 | Train Loss: 0.403 Vali Loss: 0.512 Vali Acc: 0.825 Test Loss: 0.512 Test Acc: 0.825
Validation loss decreased (-0.812494 --> -0.824995).  Saving model ...
Epoch: 4 cost time: 8.059308528900146
Epoch: 4, Steps: 8 | Train Loss: 0.234 Vali Loss: 0.610 Vali Acc: 0.850 Test Loss: 0.610 Test Acc: 0.850
Validation loss decreased (-0.824995 --> -0.849994).  Saving model ...
Epoch: 5 cost time: 8.315844535827637
Epoch: 5, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.620 Vali Acc: 0.841 Test Loss: 0.620 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.531370162963867
Epoch: 6, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.689 Vali Acc: 0.847 Test Loss: 0.689 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.671307802200317
Epoch: 7, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.690 Vali Acc: 0.828 Test Loss: 0.690 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 7.795085430145264
Epoch: 8, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.785 Vali Acc: 0.822 Test Loss: 0.785 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 8.00952959060669
Epoch: 9, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.904 Vali Acc: 0.847 Test Loss: 0.904 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 8.548792600631714
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.848 Vali Acc: 0.834 Test Loss: 0.848 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 7.742395877838135
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.814 Vali Acc: 0.825 Test Loss: 0.814 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 8.96485161781311
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.802 Vali Acc: 0.828 Test Loss: 0.802 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 8.037022829055786
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.796 Vali Acc: 0.825 Test Loss: 0.796 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 7.618369817733765
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.796 Vali Acc: 0.838 Test Loss: 0.796 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 22350728
model size : 87.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 25.718563556671143
Epoch: 1, Steps: 8 | Train Loss: 1.954 Vali Loss: 1.437 Vali Acc: 0.725 Test Loss: 1.437 Test Acc: 0.725
Validation loss decreased (inf --> -0.724986).  Saving model ...
Epoch: 2 cost time: 26.87327742576599
Epoch: 2, Steps: 8 | Train Loss: 0.924 Vali Loss: 0.604 Vali Acc: 0.828 Test Loss: 0.604 Test Acc: 0.828
Validation loss decreased (-0.724986 --> -0.828119).  Saving model ...
Epoch: 3 cost time: 24.315961599349976
Epoch: 3, Steps: 8 | Train Loss: 0.351 Vali Loss: 0.464 Vali Acc: 0.872 Test Loss: 0.464 Test Acc: 0.872
Validation loss decreased (-0.828119 --> -0.871870).  Saving model ...
Epoch: 4 cost time: 28.89252781867981
Epoch: 4, Steps: 8 | Train Loss: 0.145 Vali Loss: 0.537 Vali Acc: 0.847 Test Loss: 0.537 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 27.193573713302612
Epoch: 5, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.571 Vali Acc: 0.863 Test Loss: 0.571 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 25.719902992248535
Epoch: 6, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.560 Vali Acc: 0.856 Test Loss: 0.560 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 24.059805631637573
Epoch: 7, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.633 Vali Acc: 0.853 Test Loss: 0.633 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 27.195541858673096
Epoch: 8, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.653 Vali Acc: 0.856 Test Loss: 0.653 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 23.962242603302002
Epoch: 9, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.655 Vali Acc: 0.863 Test Loss: 0.655 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 29.18688654899597
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.685 Vali Acc: 0.863 Test Loss: 0.685 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 26.34498691558838
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.715 Vali Acc: 0.856 Test Loss: 0.715 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 26.417081832885742
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.726 Vali Acc: 0.866 Test Loss: 0.726 Test Acc: 0.866
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 27.138967037200928
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.727 Vali Acc: 0.866 Test Loss: 0.727 Test Acc: 0.866
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 37817224
model size : 146.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 11.929988622665405
Epoch: 1, Steps: 8 | Train Loss: 1.908 Vali Loss: 1.401 Vali Acc: 0.728 Test Loss: 1.401 Test Acc: 0.728
Validation loss decreased (inf --> -0.728111).  Saving model ...
Epoch: 2 cost time: 9.739529132843018
Epoch: 2, Steps: 8 | Train Loss: 0.976 Vali Loss: 0.576 Vali Acc: 0.825 Test Loss: 0.576 Test Acc: 0.825
Validation loss decreased (-0.728111 --> -0.824994).  Saving model ...
Epoch: 3 cost time: 10.68163251876831
Epoch: 3, Steps: 8 | Train Loss: 0.381 Vali Loss: 0.467 Vali Acc: 0.863 Test Loss: 0.467 Test Acc: 0.863
Validation loss decreased (-0.824994 --> -0.862495).  Saving model ...
Epoch: 4 cost time: 9.078882932662964
Epoch: 4, Steps: 8 | Train Loss: 0.153 Vali Loss: 0.490 Vali Acc: 0.863 Test Loss: 0.490 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.54982876777649
Epoch: 5, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.549 Vali Acc: 0.853 Test Loss: 0.549 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 9.727752923965454
Epoch: 6, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.536 Vali Acc: 0.872 Test Loss: 0.536 Test Acc: 0.872
Validation loss decreased (-0.862495 --> -0.871870).  Saving model ...
Epoch: 7 cost time: 11.516929864883423
Epoch: 7, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.632 Vali Acc: 0.869 Test Loss: 0.632 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 10.828239440917969
Epoch: 8, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.807 Vali Acc: 0.844 Test Loss: 0.807 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 9.936242580413818
Epoch: 9, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.736 Vali Acc: 0.863 Test Loss: 0.736 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 9.513057470321655
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.713 Vali Acc: 0.859 Test Loss: 0.713 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 10.632458925247192
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.683 Vali Acc: 0.863 Test Loss: 0.683 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 11.361750602722168
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.672 Vali Acc: 0.872 Test Loss: 0.672 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 9.929954290390015
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.676 Vali Acc: 0.872 Test Loss: 0.676 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 9.483918905258179
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.677 Vali Acc: 0.875 Test Loss: 0.677 Test Acc: 0.875
Validation loss decreased (-0.871870 --> -0.874993).  Saving model ...
Epoch: 15 cost time: 11.1732759475708
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.680 Vali Acc: 0.869 Test Loss: 0.680 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 11.253300666809082
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.680 Vali Acc: 0.869 Test Loss: 0.680 Test Acc: 0.869
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 12.140916347503662
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.681 Vali Acc: 0.869 Test Loss: 0.681 Test Acc: 0.869
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 11.362274169921875
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.687 Vali Acc: 0.869 Test Loss: 0.687 Test Acc: 0.869
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 9.868114709854126
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.692 Vali Acc: 0.866 Test Loss: 0.692 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 10.550451517105103
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.697 Vali Acc: 0.866 Test Loss: 0.697 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 10.688842535018921
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.703 Vali Acc: 0.866 Test Loss: 0.703 Test Acc: 0.866
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 11.324331283569336
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.708 Vali Acc: 0.866 Test Loss: 0.708 Test Acc: 0.866
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 10.480548620223999
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.711 Vali Acc: 0.866 Test Loss: 0.711 Test Acc: 0.866
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 9.582335948944092
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.708 Vali Acc: 0.866 Test Loss: 0.708 Test Acc: 0.866
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.875
model parameter : 11338632
model size : 45.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 20.0474796295166
Epoch: 1, Steps: 8 | Train Loss: 1.952 Vali Loss: 1.441 Vali Acc: 0.722 Test Loss: 1.441 Test Acc: 0.722
Validation loss decreased (inf --> -0.721861).  Saving model ...
Epoch: 2 cost time: 20.1740665435791
Epoch: 2, Steps: 8 | Train Loss: 0.923 Vali Loss: 0.613 Vali Acc: 0.828 Test Loss: 0.613 Test Acc: 0.828
Validation loss decreased (-0.721861 --> -0.828119).  Saving model ...
Epoch: 3 cost time: 17.447350025177002
Epoch: 3, Steps: 8 | Train Loss: 0.350 Vali Loss: 0.469 Vali Acc: 0.872 Test Loss: 0.469 Test Acc: 0.872
Validation loss decreased (-0.828119 --> -0.871870).  Saving model ...
Epoch: 4 cost time: 21.3433620929718
Epoch: 4, Steps: 8 | Train Loss: 0.144 Vali Loss: 0.541 Vali Acc: 0.844 Test Loss: 0.541 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 17.976685523986816
Epoch: 5, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.573 Vali Acc: 0.866 Test Loss: 0.573 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 15.14137315750122
Epoch: 6, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.566 Vali Acc: 0.853 Test Loss: 0.566 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 17.58508539199829
Epoch: 7, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.644 Vali Acc: 0.850 Test Loss: 0.644 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 14.73683786392212
Epoch: 8, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.672 Vali Acc: 0.850 Test Loss: 0.672 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 15.19573974609375
Epoch: 9, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.674 Vali Acc: 0.859 Test Loss: 0.674 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 18.84154438972473
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.696 Vali Acc: 0.856 Test Loss: 0.696 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 16.056129217147827
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.720 Vali Acc: 0.856 Test Loss: 0.720 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 19.021822690963745
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.735 Vali Acc: 0.863 Test Loss: 0.735 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 17.781399488449097
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.742 Vali Acc: 0.866 Test Loss: 0.742 Test Acc: 0.866
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 37817224
model size : 146.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 7.9842424392700195
Epoch: 1, Steps: 8 | Train Loss: 1.910 Vali Loss: 1.418 Vali Acc: 0.716 Test Loss: 1.418 Test Acc: 0.716
Validation loss decreased (inf --> -0.715611).  Saving model ...
Epoch: 2 cost time: 6.973571538925171
Epoch: 2, Steps: 8 | Train Loss: 0.985 Vali Loss: 0.603 Vali Acc: 0.822 Test Loss: 0.603 Test Acc: 0.822
Validation loss decreased (-0.715611 --> -0.821869).  Saving model ...
Epoch: 3 cost time: 6.94889497756958
Epoch: 3, Steps: 8 | Train Loss: 0.390 Vali Loss: 0.484 Vali Acc: 0.859 Test Loss: 0.484 Test Acc: 0.859
Validation loss decreased (-0.821869 --> -0.859370).  Saving model ...
Epoch: 4 cost time: 8.5750253200531
Epoch: 4, Steps: 8 | Train Loss: 0.153 Vali Loss: 0.504 Vali Acc: 0.863 Test Loss: 0.504 Test Acc: 0.863
Validation loss decreased (-0.859370 --> -0.862495).  Saving model ...
Epoch: 5 cost time: 8.674732446670532
Epoch: 5, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.563 Vali Acc: 0.838 Test Loss: 0.563 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.38378620147705
Epoch: 6, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.555 Vali Acc: 0.866 Test Loss: 0.555 Test Acc: 0.866
Validation loss decreased (-0.862495 --> -0.865619).  Saving model ...
Epoch: 7 cost time: 9.037073850631714
Epoch: 7, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.637 Vali Acc: 0.866 Test Loss: 0.637 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.803969621658325
Epoch: 8, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.797 Vali Acc: 0.844 Test Loss: 0.797 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 8.83134651184082
Epoch: 9, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.744 Vali Acc: 0.859 Test Loss: 0.744 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 8.850868940353394
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.714 Vali Acc: 0.856 Test Loss: 0.714 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 8.356732845306396
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.700 Vali Acc: 0.856 Test Loss: 0.700 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 8.86858582496643
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.692 Vali Acc: 0.859 Test Loss: 0.692 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 8.767545223236084
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.694 Vali Acc: 0.866 Test Loss: 0.694 Test Acc: 0.866
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 9.3418710231781
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.693 Vali Acc: 0.869 Test Loss: 0.693 Test Acc: 0.869
Validation loss decreased (-0.865619 --> -0.868743).  Saving model ...
Epoch: 15 cost time: 9.034363508224487
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.695 Vali Acc: 0.872 Test Loss: 0.695 Test Acc: 0.872
Validation loss decreased (-0.868743 --> -0.871868).  Saving model ...
Epoch: 16 cost time: 8.37109088897705
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.696 Vali Acc: 0.866 Test Loss: 0.696 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 8.074040174484253
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.698 Vali Acc: 0.866 Test Loss: 0.698 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 8.885802268981934
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.704 Vali Acc: 0.863 Test Loss: 0.704 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 9.480925559997559
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.709 Vali Acc: 0.863 Test Loss: 0.709 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 10.089332580566406
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.715 Vali Acc: 0.859 Test Loss: 0.715 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 9.597440242767334
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.721 Vali Acc: 0.859 Test Loss: 0.721 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 9.08845853805542
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.726 Vali Acc: 0.859 Test Loss: 0.726 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 9.037783145904541
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.730 Vali Acc: 0.859 Test Loss: 0.730 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 8.935467004776001
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.727 Vali Acc: 0.859 Test Loss: 0.727 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 9.544374942779541
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.731 Vali Acc: 0.859 Test Loss: 0.731 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 11338632
model size : 45.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 14.801883935928345
Epoch: 1, Steps: 8 | Train Loss: 1.950 Vali Loss: 1.451 Vali Acc: 0.722 Test Loss: 1.451 Test Acc: 0.722
Validation loss decreased (inf --> -0.721860).  Saving model ...
Epoch: 2 cost time: 12.721609115600586
Epoch: 2, Steps: 8 | Train Loss: 0.952 Vali Loss: 0.629 Vali Acc: 0.828 Test Loss: 0.629 Test Acc: 0.828
Validation loss decreased (-0.721860 --> -0.828119).  Saving model ...
Epoch: 3 cost time: 12.63406753540039
Epoch: 3, Steps: 8 | Train Loss: 0.387 Vali Loss: 0.485 Vali Acc: 0.863 Test Loss: 0.485 Test Acc: 0.863
Validation loss decreased (-0.828119 --> -0.862495).  Saving model ...
Epoch: 4 cost time: 12.775184631347656
Epoch: 4, Steps: 8 | Train Loss: 0.172 Vali Loss: 0.561 Vali Acc: 0.838 Test Loss: 0.561 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.704899787902832
Epoch: 5, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.569 Vali Acc: 0.856 Test Loss: 0.569 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 11.479701519012451
Epoch: 6, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.569 Vali Acc: 0.853 Test Loss: 0.569 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 11.626556158065796
Epoch: 7, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.642 Vali Acc: 0.847 Test Loss: 0.642 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 12.891478061676025
Epoch: 8, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.699 Vali Acc: 0.853 Test Loss: 0.699 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 11.368645668029785
Epoch: 9, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.728 Vali Acc: 0.856 Test Loss: 0.728 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 12.135585069656372
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.767 Vali Acc: 0.850 Test Loss: 0.767 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 12.138684272766113
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.811 Vali Acc: 0.844 Test Loss: 0.811 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 12.373865127563477
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.834 Vali Acc: 0.841 Test Loss: 0.834 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 11.701991558074951
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.833 Vali Acc: 0.847 Test Loss: 0.833 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 37817224
model size : 146.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 7.513569593429565
Epoch: 1, Steps: 8 | Train Loss: 1.907 Vali Loss: 1.436 Vali Acc: 0.703 Test Loss: 1.436 Test Acc: 0.703
Validation loss decreased (inf --> -0.703111).  Saving model ...
Epoch: 2 cost time: 5.393516302108765
Epoch: 2, Steps: 8 | Train Loss: 1.019 Vali Loss: 0.622 Vali Acc: 0.816 Test Loss: 0.622 Test Acc: 0.816
Validation loss decreased (-0.703111 --> -0.815619).  Saving model ...
Epoch: 3 cost time: 5.745918035507202
Epoch: 3, Steps: 8 | Train Loss: 0.420 Vali Loss: 0.503 Vali Acc: 0.863 Test Loss: 0.503 Test Acc: 0.863
Validation loss decreased (-0.815619 --> -0.862495).  Saving model ...
Epoch: 4 cost time: 5.446157455444336
Epoch: 4, Steps: 8 | Train Loss: 0.190 Vali Loss: 0.536 Vali Acc: 0.863 Test Loss: 0.536 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.386838674545288
Epoch: 5, Steps: 8 | Train Loss: 0.109 Vali Loss: 0.613 Vali Acc: 0.841 Test Loss: 0.613 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.993633031845093
Epoch: 6, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.593 Vali Acc: 0.872 Test Loss: 0.593 Test Acc: 0.872
Validation loss decreased (-0.862495 --> -0.871869).  Saving model ...
Epoch: 7 cost time: 6.0583882331848145
Epoch: 7, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.679 Vali Acc: 0.847 Test Loss: 0.679 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.922474145889282
Epoch: 8, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.890 Vali Acc: 0.825 Test Loss: 0.890 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.489372491836548
Epoch: 9, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.883 Vali Acc: 0.856 Test Loss: 0.883 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.492165565490723
Epoch: 10, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.654 Vali Acc: 0.853 Test Loss: 0.654 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.9058754444122314
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.753 Vali Acc: 0.825 Test Loss: 0.753 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.852497577667236
Epoch: 12, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.785 Vali Acc: 0.834 Test Loss: 0.785 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.772756099700928
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.840 Vali Acc: 0.825 Test Loss: 0.840 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.823298454284668
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.896 Vali Acc: 0.831 Test Loss: 0.896 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.285848617553711
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.954 Vali Acc: 0.831 Test Loss: 0.954 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.235475540161133
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.906 Vali Acc: 0.828 Test Loss: 0.906 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 11338632
model size : 45.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 32.876577615737915
Epoch: 1, Steps: 8 | Train Loss: 1.933 Vali Loss: 1.616 Vali Acc: 0.572 Test Loss: 1.616 Test Acc: 0.572
Validation loss decreased (inf --> -0.571859).  Saving model ...
Epoch: 2 cost time: 28.48373508453369
Epoch: 2, Steps: 8 | Train Loss: 1.251 Vali Loss: 0.849 Vali Acc: 0.800 Test Loss: 0.849 Test Acc: 0.800
Validation loss decreased (-0.571859 --> -0.799992).  Saving model ...
Epoch: 3 cost time: 29.387627840042114
Epoch: 3, Steps: 8 | Train Loss: 0.589 Vali Loss: 0.527 Vali Acc: 0.834 Test Loss: 0.527 Test Acc: 0.834
Validation loss decreased (-0.799992 --> -0.834370).  Saving model ...
Epoch: 4 cost time: 29.64974617958069
Epoch: 4, Steps: 8 | Train Loss: 0.322 Vali Loss: 0.433 Vali Acc: 0.866 Test Loss: 0.433 Test Acc: 0.866
Validation loss decreased (-0.834370 --> -0.865621).  Saving model ...
Epoch: 5 cost time: 28.504649877548218
Epoch: 5, Steps: 8 | Train Loss: 0.145 Vali Loss: 0.470 Vali Acc: 0.859 Test Loss: 0.470 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 28.985727787017822
Epoch: 6, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.544 Vali Acc: 0.856 Test Loss: 0.544 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 28.74177885055542
Epoch: 7, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.518 Vali Acc: 0.859 Test Loss: 0.518 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 26.618751049041748
Epoch: 8, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.535 Vali Acc: 0.853 Test Loss: 0.535 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 29.522737979888916
Epoch: 9, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.526 Vali Acc: 0.863 Test Loss: 0.526 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 30.620517253875732
Epoch: 10, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.582 Vali Acc: 0.859 Test Loss: 0.582 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 27.41170024871826
Epoch: 11, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.595 Vali Acc: 0.856 Test Loss: 0.595 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 30.439396619796753
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.601 Vali Acc: 0.850 Test Loss: 0.601 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 27.326605081558228
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.611 Vali Acc: 0.856 Test Loss: 0.611 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 26.933642625808716
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.639 Vali Acc: 0.850 Test Loss: 0.639 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 37656520
model size : 144.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 13.468232870101929
Epoch: 1, Steps: 8 | Train Loss: 1.971 Vali Loss: 1.631 Vali Acc: 0.631 Test Loss: 1.631 Test Acc: 0.631
Validation loss decreased (inf --> -0.631234).  Saving model ...
Epoch: 2 cost time: 13.12967586517334
Epoch: 2, Steps: 8 | Train Loss: 1.224 Vali Loss: 0.821 Vali Acc: 0.812 Test Loss: 0.821 Test Acc: 0.812
Validation loss decreased (-0.631234 --> -0.812492).  Saving model ...
Epoch: 3 cost time: 12.959914207458496
Epoch: 3, Steps: 8 | Train Loss: 0.574 Vali Loss: 0.513 Vali Acc: 0.847 Test Loss: 0.513 Test Acc: 0.847
Validation loss decreased (-0.812492 --> -0.846870).  Saving model ...
Epoch: 4 cost time: 11.781334161758423
Epoch: 4, Steps: 8 | Train Loss: 0.288 Vali Loss: 0.446 Vali Acc: 0.872 Test Loss: 0.446 Test Acc: 0.872
Validation loss decreased (-0.846870 --> -0.871871).  Saving model ...
Epoch: 5 cost time: 11.924562215805054
Epoch: 5, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.457 Vali Acc: 0.866 Test Loss: 0.457 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 12.469719171524048
Epoch: 6, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.495 Vali Acc: 0.863 Test Loss: 0.495 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 12.677830457687378
Epoch: 7, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.475 Vali Acc: 0.859 Test Loss: 0.475 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 10.794331312179565
Epoch: 8, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.547 Vali Acc: 0.856 Test Loss: 0.547 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 12.18245553970337
Epoch: 9, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.593 Vali Acc: 0.844 Test Loss: 0.593 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 12.487197399139404
Epoch: 10, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.588 Vali Acc: 0.856 Test Loss: 0.588 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 8.38501787185669
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.553 Vali Acc: 0.872 Test Loss: 0.553 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 12.237674713134766
Epoch: 12, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.579 Vali Acc: 0.878 Test Loss: 0.579 Test Acc: 0.878
Validation loss decreased (-0.871871 --> -0.878119).  Saving model ...
Epoch: 13 cost time: 10.18796992301941
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.608 Vali Acc: 0.866 Test Loss: 0.608 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 13.831207752227783
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.614 Vali Acc: 0.866 Test Loss: 0.614 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 12.395074367523193
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.612 Vali Acc: 0.866 Test Loss: 0.612 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 11.93620491027832
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.615 Vali Acc: 0.869 Test Loss: 0.615 Test Acc: 0.869
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 11.521997690200806
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.613 Vali Acc: 0.872 Test Loss: 0.613 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 12.41070818901062
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.621 Vali Acc: 0.872 Test Loss: 0.621 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 12.271621704101562
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.632 Vali Acc: 0.872 Test Loss: 0.632 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 8.673771381378174
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.643 Vali Acc: 0.872 Test Loss: 0.643 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 14.11990737915039
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.644 Vali Acc: 0.872 Test Loss: 0.644 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 13.434211492538452
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.646 Vali Acc: 0.872 Test Loss: 0.646 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.878125
model parameter : 11177416
model size : 43.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 27.621026754379272
Epoch: 1, Steps: 8 | Train Loss: 1.939 Vali Loss: 1.632 Vali Acc: 0.547 Test Loss: 1.632 Test Acc: 0.547
Validation loss decreased (inf --> -0.546859).  Saving model ...
Epoch: 2 cost time: 25.596776723861694
Epoch: 2, Steps: 8 | Train Loss: 1.275 Vali Loss: 0.881 Vali Acc: 0.803 Test Loss: 0.881 Test Acc: 0.803
Validation loss decreased (-0.546859 --> -0.803116).  Saving model ...
Epoch: 3 cost time: 24.302067756652832
Epoch: 3, Steps: 8 | Train Loss: 0.604 Vali Loss: 0.547 Vali Acc: 0.841 Test Loss: 0.547 Test Acc: 0.841
Validation loss decreased (-0.803116 --> -0.840620).  Saving model ...
Epoch: 4 cost time: 24.84042978286743
Epoch: 4, Steps: 8 | Train Loss: 0.325 Vali Loss: 0.445 Vali Acc: 0.866 Test Loss: 0.445 Test Acc: 0.866
Validation loss decreased (-0.840620 --> -0.865621).  Saving model ...
Epoch: 5 cost time: 21.37175726890564
Epoch: 5, Steps: 8 | Train Loss: 0.144 Vali Loss: 0.478 Vali Acc: 0.853 Test Loss: 0.478 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 23.335195779800415
Epoch: 6, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.550 Vali Acc: 0.850 Test Loss: 0.550 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 21.080472707748413
Epoch: 7, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.515 Vali Acc: 0.863 Test Loss: 0.515 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 23.3056697845459
Epoch: 8, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.540 Vali Acc: 0.850 Test Loss: 0.540 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 19.911364316940308
Epoch: 9, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.534 Vali Acc: 0.866 Test Loss: 0.534 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 22.457460641860962
Epoch: 10, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.599 Vali Acc: 0.850 Test Loss: 0.599 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 20.762139320373535
Epoch: 11, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.593 Vali Acc: 0.853 Test Loss: 0.593 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 19.015891075134277
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.588 Vali Acc: 0.853 Test Loss: 0.588 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 19.80721879005432
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.596 Vali Acc: 0.859 Test Loss: 0.596 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 20.30502462387085
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.624 Vali Acc: 0.853 Test Loss: 0.624 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 37656520
model size : 144.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 12.091744184494019
Epoch: 1, Steps: 8 | Train Loss: 1.968 Vali Loss: 1.635 Vali Acc: 0.622 Test Loss: 1.635 Test Acc: 0.622
Validation loss decreased (inf --> -0.621859).  Saving model ...
Epoch: 2 cost time: 9.915060758590698
Epoch: 2, Steps: 8 | Train Loss: 1.224 Vali Loss: 0.840 Vali Acc: 0.809 Test Loss: 0.840 Test Acc: 0.809
Validation loss decreased (-0.621859 --> -0.809367).  Saving model ...
Epoch: 3 cost time: 8.929775476455688
Epoch: 3, Steps: 8 | Train Loss: 0.578 Vali Loss: 0.528 Vali Acc: 0.850 Test Loss: 0.528 Test Acc: 0.850
Validation loss decreased (-0.809367 --> -0.849995).  Saving model ...
Epoch: 4 cost time: 9.236958265304565
Epoch: 4, Steps: 8 | Train Loss: 0.289 Vali Loss: 0.456 Vali Acc: 0.872 Test Loss: 0.456 Test Acc: 0.872
Validation loss decreased (-0.849995 --> -0.871870).  Saving model ...
Epoch: 5 cost time: 6.887136936187744
Epoch: 5, Steps: 8 | Train Loss: 0.136 Vali Loss: 0.464 Vali Acc: 0.863 Test Loss: 0.464 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.814531564712524
Epoch: 6, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.505 Vali Acc: 0.856 Test Loss: 0.505 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 8.518671989440918
Epoch: 7, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.489 Vali Acc: 0.863 Test Loss: 0.489 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 7.095020771026611
Epoch: 8, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.560 Vali Acc: 0.844 Test Loss: 0.560 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 8.803081274032593
Epoch: 9, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.601 Vali Acc: 0.841 Test Loss: 0.601 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 9.76474666595459
Epoch: 10, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.598 Vali Acc: 0.853 Test Loss: 0.598 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 9.822401762008667
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.565 Vali Acc: 0.863 Test Loss: 0.565 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 8.661295890808105
Epoch: 12, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.592 Vali Acc: 0.869 Test Loss: 0.592 Test Acc: 0.869
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 9.165820121765137
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.620 Vali Acc: 0.856 Test Loss: 0.620 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 9.127851247787476
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.625 Vali Acc: 0.866 Test Loss: 0.625 Test Acc: 0.866
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 11177416
model size : 43.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 10.660683870315552
Epoch: 1, Steps: 8 | Train Loss: 1.942 Vali Loss: 1.649 Vali Acc: 0.519 Test Loss: 1.649 Test Acc: 0.519
Validation loss decreased (inf --> -0.518734).  Saving model ...
Epoch: 2 cost time: 11.328324556350708
Epoch: 2, Steps: 8 | Train Loss: 1.316 Vali Loss: 0.929 Vali Acc: 0.781 Test Loss: 0.929 Test Acc: 0.781
Validation loss decreased (-0.518734 --> -0.781241).  Saving model ...
Epoch: 3 cost time: 11.894160985946655
Epoch: 3, Steps: 8 | Train Loss: 0.664 Vali Loss: 0.587 Vali Acc: 0.812 Test Loss: 0.587 Test Acc: 0.812
Validation loss decreased (-0.781241 --> -0.812494).  Saving model ...
Epoch: 4 cost time: 12.844495296478271
Epoch: 4, Steps: 8 | Train Loss: 0.381 Vali Loss: 0.471 Vali Acc: 0.866 Test Loss: 0.471 Test Acc: 0.866
Validation loss decreased (-0.812494 --> -0.865620).  Saving model ...
Epoch: 5 cost time: 10.643082618713379
Epoch: 5, Steps: 8 | Train Loss: 0.177 Vali Loss: 0.506 Vali Acc: 0.844 Test Loss: 0.506 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 12.29578161239624
Epoch: 6, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.560 Vali Acc: 0.859 Test Loss: 0.560 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 13.022278308868408
Epoch: 7, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.510 Vali Acc: 0.863 Test Loss: 0.510 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 11.652771711349487
Epoch: 8, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.557 Vali Acc: 0.850 Test Loss: 0.557 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 8.6768798828125
Epoch: 9, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.579 Vali Acc: 0.863 Test Loss: 0.579 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 12.860538482666016
Epoch: 10, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.602 Vali Acc: 0.853 Test Loss: 0.602 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 11.770482778549194
Epoch: 11, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.603 Vali Acc: 0.847 Test Loss: 0.603 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 8.649635791778564
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.613 Vali Acc: 0.850 Test Loss: 0.613 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 12.718454360961914
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.623 Vali Acc: 0.847 Test Loss: 0.623 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 14.166293382644653
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.651 Vali Acc: 0.847 Test Loss: 0.651 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 37656520
model size : 144.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 6.488062381744385
Epoch: 1, Steps: 8 | Train Loss: 1.976 Vali Loss: 1.648 Vali Acc: 0.609 Test Loss: 1.648 Test Acc: 0.609
Validation loss decreased (inf --> -0.609359).  Saving model ...
Epoch: 2 cost time: 5.621321201324463
Epoch: 2, Steps: 8 | Train Loss: 1.267 Vali Loss: 0.874 Vali Acc: 0.800 Test Loss: 0.874 Test Acc: 0.800
Validation loss decreased (-0.609359 --> -0.799991).  Saving model ...
Epoch: 3 cost time: 4.622893810272217
Epoch: 3, Steps: 8 | Train Loss: 0.631 Vali Loss: 0.557 Vali Acc: 0.825 Test Loss: 0.557 Test Acc: 0.825
Validation loss decreased (-0.799991 --> -0.824994).  Saving model ...
Epoch: 4 cost time: 5.703170537948608
Epoch: 4, Steps: 8 | Train Loss: 0.349 Vali Loss: 0.483 Vali Acc: 0.859 Test Loss: 0.483 Test Acc: 0.859
Validation loss decreased (-0.824994 --> -0.859370).  Saving model ...
Epoch: 5 cost time: 5.91724157333374
Epoch: 5, Steps: 8 | Train Loss: 0.189 Vali Loss: 0.492 Vali Acc: 0.841 Test Loss: 0.492 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.908039093017578
Epoch: 6, Steps: 8 | Train Loss: 0.099 Vali Loss: 0.537 Vali Acc: 0.838 Test Loss: 0.537 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.960343837738037
Epoch: 7, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.516 Vali Acc: 0.863 Test Loss: 0.516 Test Acc: 0.863
Validation loss decreased (-0.859370 --> -0.862495).  Saving model ...
Epoch: 8 cost time: 5.394141674041748
Epoch: 8, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.595 Vali Acc: 0.847 Test Loss: 0.595 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.950945615768433
Epoch: 9, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.597 Vali Acc: 0.844 Test Loss: 0.597 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.030529022216797
Epoch: 10, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.594 Vali Acc: 0.850 Test Loss: 0.594 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.7284040451049805
Epoch: 11, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.579 Vali Acc: 0.847 Test Loss: 0.579 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.958745241165161
Epoch: 12, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.614 Vali Acc: 0.853 Test Loss: 0.614 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.151571273803711
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.647 Vali Acc: 0.850 Test Loss: 0.647 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.812480449676514
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.652 Vali Acc: 0.850 Test Loss: 0.652 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.470203638076782
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.646 Vali Acc: 0.850 Test Loss: 0.646 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.820263385772705
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.648 Vali Acc: 0.853 Test Loss: 0.648 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.578297853469849
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.645 Vali Acc: 0.859 Test Loss: 0.645 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 11177416
model size : 43.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 17.05382800102234
Epoch: 1, Steps: 8 | Train Loss: 2.008 Vali Loss: 1.659 Vali Acc: 0.581 Test Loss: 1.659 Test Acc: 0.581
Validation loss decreased (inf --> -0.581233).  Saving model ...
Epoch: 2 cost time: 14.649348497390747
Epoch: 2, Steps: 8 | Train Loss: 1.291 Vali Loss: 0.872 Vali Acc: 0.838 Test Loss: 0.872 Test Acc: 0.838
Validation loss decreased (-0.581233 --> -0.837491).  Saving model ...
Epoch: 3 cost time: 13.539948225021362
Epoch: 3, Steps: 8 | Train Loss: 0.622 Vali Loss: 0.547 Vali Acc: 0.816 Test Loss: 0.547 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.127705335617065
Epoch: 4, Steps: 8 | Train Loss: 0.327 Vali Loss: 0.456 Vali Acc: 0.847 Test Loss: 0.456 Test Acc: 0.847
Validation loss decreased (-0.837491 --> -0.846870).  Saving model ...
Epoch: 5 cost time: 14.800709247589111
Epoch: 5, Steps: 8 | Train Loss: 0.189 Vali Loss: 0.473 Vali Acc: 0.850 Test Loss: 0.473 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 6 cost time: 9.313072681427002
Epoch: 6, Steps: 8 | Train Loss: 0.120 Vali Loss: 0.560 Vali Acc: 0.838 Test Loss: 0.560 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 14.424453020095825
Epoch: 7, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.521 Vali Acc: 0.869 Test Loss: 0.521 Test Acc: 0.869
Validation loss decreased (-0.849995 --> -0.868745).  Saving model ...
Epoch: 8 cost time: 13.649227380752563
Epoch: 8, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.522 Vali Acc: 0.856 Test Loss: 0.522 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 15.62165379524231
Epoch: 9, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.545 Vali Acc: 0.859 Test Loss: 0.545 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 14.555591821670532
Epoch: 10, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.592 Vali Acc: 0.850 Test Loss: 0.592 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 15.284841299057007
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.621 Vali Acc: 0.850 Test Loss: 0.621 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 14.118673086166382
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.615 Vali Acc: 0.856 Test Loss: 0.615 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 16.192368984222412
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.613 Vali Acc: 0.856 Test Loss: 0.613 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 14.164753198623657
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.619 Vali Acc: 0.853 Test Loss: 0.619 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 15.774326086044312
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.625 Vali Acc: 0.853 Test Loss: 0.625 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 10.791577339172363
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.638 Vali Acc: 0.853 Test Loss: 0.638 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 15.959303379058838
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.640 Vali Acc: 0.853 Test Loss: 0.640 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 18910152
model size : 73.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 7.8338305950164795
Epoch: 1, Steps: 8 | Train Loss: 2.131 Vali Loss: 1.804 Vali Acc: 0.419 Test Loss: 1.804 Test Acc: 0.419
Validation loss decreased (inf --> -0.418732).  Saving model ...
Epoch: 2 cost time: 7.050999641418457
Epoch: 2, Steps: 8 | Train Loss: 1.422 Vali Loss: 0.938 Vali Acc: 0.806 Test Loss: 0.938 Test Acc: 0.806
Validation loss decreased (-0.418732 --> -0.806241).  Saving model ...
Epoch: 3 cost time: 7.215534687042236
Epoch: 3, Steps: 8 | Train Loss: 0.677 Vali Loss: 0.571 Vali Acc: 0.834 Test Loss: 0.571 Test Acc: 0.834
Validation loss decreased (-0.806241 --> -0.834369).  Saving model ...
Epoch: 4 cost time: 4.6389381885528564
Epoch: 4, Steps: 8 | Train Loss: 0.340 Vali Loss: 0.459 Vali Acc: 0.859 Test Loss: 0.459 Test Acc: 0.859
Validation loss decreased (-0.834369 --> -0.859370).  Saving model ...
Epoch: 5 cost time: 6.360258340835571
Epoch: 5, Steps: 8 | Train Loss: 0.188 Vali Loss: 0.491 Vali Acc: 0.850 Test Loss: 0.491 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.027647495269775
Epoch: 6, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.574 Vali Acc: 0.850 Test Loss: 0.574 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.408984422683716
Epoch: 7, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.527 Vali Acc: 0.850 Test Loss: 0.527 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.428988218307495
Epoch: 8, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.509 Vali Acc: 0.869 Test Loss: 0.509 Test Acc: 0.869
Validation loss decreased (-0.859370 --> -0.868745).  Saving model ...
Epoch: 9 cost time: 5.144033670425415
Epoch: 9, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.564 Vali Acc: 0.866 Test Loss: 0.564 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.4819629192352295
Epoch: 10, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.568 Vali Acc: 0.853 Test Loss: 0.568 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.269451141357422
Epoch: 11, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.579 Vali Acc: 0.850 Test Loss: 0.579 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.695945978164673
Epoch: 12, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.594 Vali Acc: 0.859 Test Loss: 0.594 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.319591283798218
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.611 Vali Acc: 0.866 Test Loss: 0.611 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.23710823059082
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.609 Vali Acc: 0.866 Test Loss: 0.609 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 6.2226784229278564
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.596 Vali Acc: 0.869 Test Loss: 0.596 Test Acc: 0.869
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.919048070907593
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.595 Vali Acc: 0.872 Test Loss: 0.595 Test Acc: 0.872
Validation loss decreased (-0.868745 --> -0.871869).  Saving model ...
Epoch: 17 cost time: 5.701850175857544
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.601 Vali Acc: 0.869 Test Loss: 0.601 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.23109245300293
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.609 Vali Acc: 0.872 Test Loss: 0.609 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.3215882778167725
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.615 Vali Acc: 0.872 Test Loss: 0.615 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.044321537017822
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.616 Vali Acc: 0.875 Test Loss: 0.616 Test Acc: 0.875
Validation loss decreased (-0.871869 --> -0.874994).  Saving model ...
Epoch: 21 cost time: 5.061660051345825
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.623 Vali Acc: 0.872 Test Loss: 0.623 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.931172847747803
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.627 Vali Acc: 0.872 Test Loss: 0.627 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.877650737762451
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.634 Vali Acc: 0.872 Test Loss: 0.634 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 5.716777801513672
Epoch: 24, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.630 Vali Acc: 0.875 Test Loss: 0.630 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 5.418421030044556
Epoch: 25, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.637 Vali Acc: 0.875 Test Loss: 0.637 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 5.982131481170654
Epoch: 26, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.642 Vali Acc: 0.872 Test Loss: 0.642 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 4.756396293640137
Epoch: 27, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.646 Vali Acc: 0.872 Test Loss: 0.646 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 5.006327390670776
Epoch: 28, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.649 Vali Acc: 0.872 Test Loss: 0.649 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 4.949258089065552
Epoch: 29, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.653 Vali Acc: 0.872 Test Loss: 0.653 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 4.183520555496216
Epoch: 30, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.658 Vali Acc: 0.872 Test Loss: 0.658 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.875
model parameter : 5670344
model size : 22.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 12.417806625366211
Epoch: 1, Steps: 8 | Train Loss: 2.010 Vali Loss: 1.662 Vali Acc: 0.578 Test Loss: 1.662 Test Acc: 0.578
Validation loss decreased (inf --> -0.578108).  Saving model ...
Epoch: 2 cost time: 10.72400975227356
Epoch: 2, Steps: 8 | Train Loss: 1.294 Vali Loss: 0.887 Vali Acc: 0.834 Test Loss: 0.887 Test Acc: 0.834
Validation loss decreased (-0.578108 --> -0.834366).  Saving model ...
Epoch: 3 cost time: 10.290122270584106
Epoch: 3, Steps: 8 | Train Loss: 0.629 Vali Loss: 0.558 Vali Acc: 0.819 Test Loss: 0.558 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.137079000473022
Epoch: 4, Steps: 8 | Train Loss: 0.334 Vali Loss: 0.462 Vali Acc: 0.850 Test Loss: 0.462 Test Acc: 0.850
Validation loss decreased (-0.834366 --> -0.849995).  Saving model ...
Epoch: 5 cost time: 13.04040002822876
Epoch: 5, Steps: 8 | Train Loss: 0.192 Vali Loss: 0.477 Vali Acc: 0.856 Test Loss: 0.477 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.856245).  Saving model ...
Epoch: 6 cost time: 10.740899085998535
Epoch: 6, Steps: 8 | Train Loss: 0.123 Vali Loss: 0.571 Vali Acc: 0.831 Test Loss: 0.571 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 12.15790319442749
Epoch: 7, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.538 Vali Acc: 0.859 Test Loss: 0.538 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 8 cost time: 9.635333776473999
Epoch: 8, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.545 Vali Acc: 0.863 Test Loss: 0.545 Test Acc: 0.863
Validation loss decreased (-0.859370 --> -0.862495).  Saving model ...
Epoch: 9 cost time: 11.084586381912231
Epoch: 9, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.566 Vali Acc: 0.847 Test Loss: 0.566 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 12.616342067718506
Epoch: 10, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.614 Vali Acc: 0.850 Test Loss: 0.614 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 9.64708924293518
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.650 Vali Acc: 0.850 Test Loss: 0.650 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 10.180484294891357
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.642 Vali Acc: 0.856 Test Loss: 0.642 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 9.557799816131592
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.638 Vali Acc: 0.853 Test Loss: 0.638 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 7.888582229614258
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.644 Vali Acc: 0.856 Test Loss: 0.644 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 9.244430303573608
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.652 Vali Acc: 0.856 Test Loss: 0.652 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 10.87649917602539
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.666 Vali Acc: 0.856 Test Loss: 0.666 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 11.059125661849976
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.670 Vali Acc: 0.856 Test Loss: 0.670 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 10.863131523132324
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.674 Vali Acc: 0.856 Test Loss: 0.674 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 18910152
model size : 73.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 6.635433197021484
Epoch: 1, Steps: 8 | Train Loss: 2.130 Vali Loss: 1.809 Vali Acc: 0.416 Test Loss: 1.809 Test Acc: 0.416
Validation loss decreased (inf --> -0.415607).  Saving model ...
Epoch: 2 cost time: 4.1485435962677
Epoch: 2, Steps: 8 | Train Loss: 1.424 Vali Loss: 0.961 Vali Acc: 0.794 Test Loss: 0.961 Test Acc: 0.794
Validation loss decreased (-0.415607 --> -0.793740).  Saving model ...
Epoch: 3 cost time: 3.3835675716400146
Epoch: 3, Steps: 8 | Train Loss: 0.681 Vali Loss: 0.586 Vali Acc: 0.831 Test Loss: 0.586 Test Acc: 0.831
Validation loss decreased (-0.793740 --> -0.831244).  Saving model ...
Epoch: 4 cost time: 5.146949291229248
Epoch: 4, Steps: 8 | Train Loss: 0.341 Vali Loss: 0.473 Vali Acc: 0.856 Test Loss: 0.473 Test Acc: 0.856
Validation loss decreased (-0.831244 --> -0.856245).  Saving model ...
Epoch: 5 cost time: 4.964557886123657
Epoch: 5, Steps: 8 | Train Loss: 0.187 Vali Loss: 0.500 Vali Acc: 0.850 Test Loss: 0.500 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.847102165222168
Epoch: 6, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.586 Vali Acc: 0.847 Test Loss: 0.586 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.822031021118164
Epoch: 7, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.537 Vali Acc: 0.844 Test Loss: 0.537 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.3110477924346924
Epoch: 8, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.519 Vali Acc: 0.863 Test Loss: 0.519 Test Acc: 0.863
Validation loss decreased (-0.856245 --> -0.862495).  Saving model ...
Epoch: 9 cost time: 4.724004030227661
Epoch: 9, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.576 Vali Acc: 0.859 Test Loss: 0.576 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.978638172149658
Epoch: 10, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.577 Vali Acc: 0.847 Test Loss: 0.577 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.765810966491699
Epoch: 11, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.588 Vali Acc: 0.844 Test Loss: 0.588 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.981775522232056
Epoch: 12, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.607 Vali Acc: 0.850 Test Loss: 0.607 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.084149122238159
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.626 Vali Acc: 0.856 Test Loss: 0.626 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.060476779937744
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.622 Vali Acc: 0.856 Test Loss: 0.622 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.760773658752441
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.608 Vali Acc: 0.863 Test Loss: 0.608 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.923983812332153
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.606 Vali Acc: 0.866 Test Loss: 0.606 Test Acc: 0.866
Validation loss decreased (-0.862495 --> -0.865619).  Saving model ...
Epoch: 17 cost time: 5.0133256912231445
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.612 Vali Acc: 0.863 Test Loss: 0.612 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.374317169189453
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.621 Vali Acc: 0.863 Test Loss: 0.621 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.957134485244751
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.627 Vali Acc: 0.863 Test Loss: 0.627 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.651195764541626
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.628 Vali Acc: 0.863 Test Loss: 0.628 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 5.523593902587891
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.635 Vali Acc: 0.863 Test Loss: 0.635 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 5.30153751373291
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.639 Vali Acc: 0.863 Test Loss: 0.639 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 4.1125807762146
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.647 Vali Acc: 0.863 Test Loss: 0.647 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 4.7064666748046875
Epoch: 24, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.642 Vali Acc: 0.866 Test Loss: 0.642 Test Acc: 0.866
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 5.080617189407349
Epoch: 25, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.649 Vali Acc: 0.866 Test Loss: 0.649 Test Acc: 0.866
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 5.078980445861816
Epoch: 26, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.654 Vali Acc: 0.863 Test Loss: 0.654 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 5670344
model size : 22.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 8.103902816772461
Epoch: 1, Steps: 8 | Train Loss: 2.011 Vali Loss: 1.676 Vali Acc: 0.578 Test Loss: 1.676 Test Acc: 0.578
Validation loss decreased (inf --> -0.578108).  Saving model ...
Epoch: 2 cost time: 7.35846734046936
Epoch: 2, Steps: 8 | Train Loss: 1.331 Vali Loss: 0.926 Vali Acc: 0.828 Test Loss: 0.926 Test Acc: 0.828
Validation loss decreased (-0.578108 --> -0.828116).  Saving model ...
Epoch: 3 cost time: 5.734132289886475
Epoch: 3, Steps: 8 | Train Loss: 0.666 Vali Loss: 0.581 Vali Acc: 0.809 Test Loss: 0.581 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.114709854125977
Epoch: 4, Steps: 8 | Train Loss: 0.377 Vali Loss: 0.479 Vali Acc: 0.853 Test Loss: 0.479 Test Acc: 0.853
Validation loss decreased (-0.828116 --> -0.853120).  Saving model ...
Epoch: 5 cost time: 5.243130445480347
Epoch: 5, Steps: 8 | Train Loss: 0.229 Vali Loss: 0.497 Vali Acc: 0.850 Test Loss: 0.497 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.005632162094116
Epoch: 6, Steps: 8 | Train Loss: 0.148 Vali Loss: 0.603 Vali Acc: 0.825 Test Loss: 0.603 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.771910905838013
Epoch: 7, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.556 Vali Acc: 0.863 Test Loss: 0.556 Test Acc: 0.863
Validation loss decreased (-0.853120 --> -0.862494).  Saving model ...
Epoch: 8 cost time: 4.5114524364471436
Epoch: 8, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.550 Vali Acc: 0.850 Test Loss: 0.550 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.5426764488220215
Epoch: 9, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.581 Vali Acc: 0.841 Test Loss: 0.581 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.705195188522339
Epoch: 10, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.635 Vali Acc: 0.847 Test Loss: 0.635 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.776843547821045
Epoch: 11, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.636 Vali Acc: 0.844 Test Loss: 0.636 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.588697195053101
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.636 Vali Acc: 0.841 Test Loss: 0.636 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.1957807540893555
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.645 Vali Acc: 0.841 Test Loss: 0.645 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.187413930892944
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.657 Vali Acc: 0.844 Test Loss: 0.657 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.971791744232178
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.667 Vali Acc: 0.850 Test Loss: 0.667 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.14902138710022
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.678 Vali Acc: 0.850 Test Loss: 0.678 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 6.017470836639404
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.682 Vali Acc: 0.850 Test Loss: 0.682 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 18910152
model size : 73.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.421494722366333
Epoch: 1, Steps: 8 | Train Loss: 2.137 Vali Loss: 1.818 Vali Acc: 0.403 Test Loss: 1.818 Test Acc: 0.403
Validation loss decreased (inf --> -0.403107).  Saving model ...
Epoch: 2 cost time: 2.3966119289398193
Epoch: 2, Steps: 8 | Train Loss: 1.455 Vali Loss: 0.992 Vali Acc: 0.791 Test Loss: 0.992 Test Acc: 0.791
Validation loss decreased (-0.403107 --> -0.790615).  Saving model ...
Epoch: 3 cost time: 2.7113053798675537
Epoch: 3, Steps: 8 | Train Loss: 0.716 Vali Loss: 0.607 Vali Acc: 0.825 Test Loss: 0.607 Test Acc: 0.825
Validation loss decreased (-0.790615 --> -0.824994).  Saving model ...
Epoch: 4 cost time: 2.8037428855895996
Epoch: 4, Steps: 8 | Train Loss: 0.377 Vali Loss: 0.490 Vali Acc: 0.850 Test Loss: 0.490 Test Acc: 0.850
Validation loss decreased (-0.824994 --> -0.849995).  Saving model ...
Epoch: 5 cost time: 2.5134081840515137
Epoch: 5, Steps: 8 | Train Loss: 0.220 Vali Loss: 0.525 Vali Acc: 0.841 Test Loss: 0.525 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1152405738830566
Epoch: 6, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.607 Vali Acc: 0.834 Test Loss: 0.607 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.1069023609161377
Epoch: 7, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.550 Vali Acc: 0.850 Test Loss: 0.550 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.7976224422454834
Epoch: 8, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.532 Vali Acc: 0.863 Test Loss: 0.532 Test Acc: 0.863
Validation loss decreased (-0.849995 --> -0.862495).  Saving model ...
Epoch: 9 cost time: 2.836338758468628
Epoch: 9, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.591 Vali Acc: 0.850 Test Loss: 0.591 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.741957664489746
Epoch: 10, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.613 Vali Acc: 0.844 Test Loss: 0.613 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.284696340560913
Epoch: 11, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.625 Vali Acc: 0.841 Test Loss: 0.625 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.1891655921936035
Epoch: 12, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.644 Vali Acc: 0.850 Test Loss: 0.644 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.598853826522827
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.658 Vali Acc: 0.850 Test Loss: 0.658 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.5817134380340576
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.662 Vali Acc: 0.847 Test Loss: 0.662 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.859388828277588
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.657 Vali Acc: 0.841 Test Loss: 0.657 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.7061150074005127
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.659 Vali Acc: 0.844 Test Loss: 0.659 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.272768497467041
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.665 Vali Acc: 0.850 Test Loss: 0.665 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.0979385375976562
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.672 Vali Acc: 0.850 Test Loss: 0.672 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 5670344
model size : 22.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 10.579100131988525
Epoch: 1, Steps: 8 | Train Loss: 1.974 Vali Loss: 1.699 Vali Acc: 0.469 Test Loss: 1.699 Test Acc: 0.469
Validation loss decreased (inf --> -0.468733).  Saving model ...
Epoch: 2 cost time: 10.451955318450928
Epoch: 2, Steps: 8 | Train Loss: 1.311 Vali Loss: 0.920 Vali Acc: 0.812 Test Loss: 0.920 Test Acc: 0.812
Validation loss decreased (-0.468733 --> -0.812491).  Saving model ...
Epoch: 3 cost time: 10.457097053527832
Epoch: 3, Steps: 8 | Train Loss: 0.625 Vali Loss: 0.563 Vali Acc: 0.841 Test Loss: 0.563 Test Acc: 0.841
Validation loss decreased (-0.812491 --> -0.840619).  Saving model ...
Epoch: 4 cost time: 10.106220722198486
Epoch: 4, Steps: 8 | Train Loss: 0.348 Vali Loss: 0.481 Vali Acc: 0.850 Test Loss: 0.481 Test Acc: 0.850
Validation loss decreased (-0.840619 --> -0.849995).  Saving model ...
Epoch: 5 cost time: 10.053258419036865
Epoch: 5, Steps: 8 | Train Loss: 0.185 Vali Loss: 0.472 Vali Acc: 0.850 Test Loss: 0.472 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 6 cost time: 10.159666299819946
Epoch: 6, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.509 Vali Acc: 0.853 Test Loss: 0.509 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 7 cost time: 10.648474931716919
Epoch: 7, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.526 Vali Acc: 0.853 Test Loss: 0.526 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.057132482528687
Epoch: 8, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.527 Vali Acc: 0.850 Test Loss: 0.527 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 8.984105587005615
Epoch: 9, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.590 Vali Acc: 0.850 Test Loss: 0.590 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 10.728031635284424
Epoch: 10, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.553 Vali Acc: 0.859 Test Loss: 0.553 Test Acc: 0.859
Validation loss decreased (-0.853120 --> -0.859369).  Saving model ...
Epoch: 11 cost time: 10.300171375274658
Epoch: 11, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.551 Vali Acc: 0.853 Test Loss: 0.551 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 9.268697261810303
Epoch: 12, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.589 Vali Acc: 0.850 Test Loss: 0.589 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 7.334149122238159
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.601 Vali Acc: 0.853 Test Loss: 0.601 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 9.699440956115723
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.613 Vali Acc: 0.853 Test Loss: 0.613 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 8.367247819900513
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.620 Vali Acc: 0.856 Test Loss: 0.620 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 7.693463087081909
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.618 Vali Acc: 0.853 Test Loss: 0.618 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 8.661579370498657
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.624 Vali Acc: 0.856 Test Loss: 0.624 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 7.5538010597229
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.636 Vali Acc: 0.856 Test Loss: 0.636 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 8.360998630523682
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.635 Vali Acc: 0.856 Test Loss: 0.635 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 7.024925470352173
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.644 Vali Acc: 0.856 Test Loss: 0.644 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 9536968
model size : 37.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.169131278991699
Epoch: 1, Steps: 8 | Train Loss: 2.004 Vali Loss: 1.711 Vali Acc: 0.497 Test Loss: 1.711 Test Acc: 0.497
Validation loss decreased (inf --> -0.496858).  Saving model ...
Epoch: 2 cost time: 3.724597692489624
Epoch: 2, Steps: 8 | Train Loss: 1.384 Vali Loss: 0.967 Vali Acc: 0.778 Test Loss: 0.967 Test Acc: 0.778
Validation loss decreased (-0.496858 --> -0.778115).  Saving model ...
Epoch: 3 cost time: 3.6861610412597656
Epoch: 3, Steps: 8 | Train Loss: 0.743 Vali Loss: 0.613 Vali Acc: 0.825 Test Loss: 0.613 Test Acc: 0.825
Validation loss decreased (-0.778115 --> -0.824994).  Saving model ...
Epoch: 4 cost time: 3.2869749069213867
Epoch: 4, Steps: 8 | Train Loss: 0.394 Vali Loss: 0.528 Vali Acc: 0.850 Test Loss: 0.528 Test Acc: 0.850
Validation loss decreased (-0.824994 --> -0.849995).  Saving model ...
Epoch: 5 cost time: 3.7797858715057373
Epoch: 5, Steps: 8 | Train Loss: 0.203 Vali Loss: 0.512 Vali Acc: 0.838 Test Loss: 0.512 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.6154582500457764
Epoch: 6, Steps: 8 | Train Loss: 0.122 Vali Loss: 0.537 Vali Acc: 0.853 Test Loss: 0.537 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 7 cost time: 3.013789415359497
Epoch: 7, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.536 Vali Acc: 0.863 Test Loss: 0.536 Test Acc: 0.863
Validation loss decreased (-0.853120 --> -0.862495).  Saving model ...
Epoch: 8 cost time: 3.315345287322998
Epoch: 8, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.525 Vali Acc: 0.866 Test Loss: 0.525 Test Acc: 0.866
Validation loss decreased (-0.862495 --> -0.865620).  Saving model ...
Epoch: 9 cost time: 3.755413055419922
Epoch: 9, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.536 Vali Acc: 0.856 Test Loss: 0.536 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.7110953330993652
Epoch: 10, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.577 Vali Acc: 0.863 Test Loss: 0.577 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.3193564414978027
Epoch: 11, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.614 Vali Acc: 0.856 Test Loss: 0.614 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.9075028896331787
Epoch: 12, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.608 Vali Acc: 0.850 Test Loss: 0.608 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.962409734725952
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.608 Vali Acc: 0.853 Test Loss: 0.608 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.610105276107788
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.615 Vali Acc: 0.863 Test Loss: 0.615 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.089969873428345
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.616 Vali Acc: 0.866 Test Loss: 0.616 Test Acc: 0.866
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.942720890045166
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.619 Vali Acc: 0.863 Test Loss: 0.619 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.7872049808502197
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.627 Vali Acc: 0.859 Test Loss: 0.627 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.7576816082000732
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.633 Vali Acc: 0.863 Test Loss: 0.633 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 2916808
model size : 12.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 8.531848192214966
Epoch: 1, Steps: 8 | Train Loss: 1.975 Vali Loss: 1.701 Vali Acc: 0.469 Test Loss: 1.701 Test Acc: 0.469
Validation loss decreased (inf --> -0.468733).  Saving model ...
Epoch: 2 cost time: 9.11242389678955
Epoch: 2, Steps: 8 | Train Loss: 1.311 Vali Loss: 0.929 Vali Acc: 0.812 Test Loss: 0.929 Test Acc: 0.812
Validation loss decreased (-0.468733 --> -0.812491).  Saving model ...
Epoch: 3 cost time: 8.945038795471191
Epoch: 3, Steps: 8 | Train Loss: 0.625 Vali Loss: 0.569 Vali Acc: 0.838 Test Loss: 0.569 Test Acc: 0.838
Validation loss decreased (-0.812491 --> -0.837494).  Saving model ...
Epoch: 4 cost time: 9.844112634658813
Epoch: 4, Steps: 8 | Train Loss: 0.349 Vali Loss: 0.486 Vali Acc: 0.850 Test Loss: 0.486 Test Acc: 0.850
Validation loss decreased (-0.837494 --> -0.849995).  Saving model ...
Epoch: 5 cost time: 9.097919702529907
Epoch: 5, Steps: 8 | Train Loss: 0.185 Vali Loss: 0.475 Vali Acc: 0.850 Test Loss: 0.475 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 6 cost time: 8.319818258285522
Epoch: 6, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.512 Vali Acc: 0.853 Test Loss: 0.512 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 7 cost time: 9.679611682891846
Epoch: 7, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.532 Vali Acc: 0.850 Test Loss: 0.532 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.840879917144775
Epoch: 8, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.532 Vali Acc: 0.847 Test Loss: 0.532 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 8.799662113189697
Epoch: 9, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.594 Vali Acc: 0.844 Test Loss: 0.594 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 9.532877683639526
Epoch: 10, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.560 Vali Acc: 0.853 Test Loss: 0.560 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 8.696743488311768
Epoch: 11, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.558 Vali Acc: 0.850 Test Loss: 0.558 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 8.884435892105103
Epoch: 12, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.598 Vali Acc: 0.847 Test Loss: 0.598 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 9.16274881362915
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.609 Vali Acc: 0.844 Test Loss: 0.609 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 8.436833143234253
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.621 Vali Acc: 0.847 Test Loss: 0.621 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 7.447323799133301
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.629 Vali Acc: 0.850 Test Loss: 0.629 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 9.261693000793457
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.628 Vali Acc: 0.847 Test Loss: 0.628 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 9536968
model size : 37.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.199606418609619
Epoch: 1, Steps: 8 | Train Loss: 2.007 Vali Loss: 1.715 Vali Acc: 0.494 Test Loss: 1.715 Test Acc: 0.494
Validation loss decreased (inf --> -0.493733).  Saving model ...
Epoch: 2 cost time: 4.189010143280029
Epoch: 2, Steps: 8 | Train Loss: 1.388 Vali Loss: 0.981 Vali Acc: 0.775 Test Loss: 0.981 Test Acc: 0.775
Validation loss decreased (-0.493733 --> -0.774990).  Saving model ...
Epoch: 3 cost time: 3.756880044937134
Epoch: 3, Steps: 8 | Train Loss: 0.748 Vali Loss: 0.628 Vali Acc: 0.822 Test Loss: 0.628 Test Acc: 0.822
Validation loss decreased (-0.774990 --> -0.821869).  Saving model ...
Epoch: 4 cost time: 3.8529725074768066
Epoch: 4, Steps: 8 | Train Loss: 0.396 Vali Loss: 0.540 Vali Acc: 0.847 Test Loss: 0.540 Test Acc: 0.847
Validation loss decreased (-0.821869 --> -0.846870).  Saving model ...
Epoch: 5 cost time: 4.106408357620239
Epoch: 5, Steps: 8 | Train Loss: 0.204 Vali Loss: 0.517 Vali Acc: 0.831 Test Loss: 0.517 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.8077542781829834
Epoch: 6, Steps: 8 | Train Loss: 0.122 Vali Loss: 0.546 Vali Acc: 0.853 Test Loss: 0.546 Test Acc: 0.853
Validation loss decreased (-0.846870 --> -0.853120).  Saving model ...
Epoch: 7 cost time: 4.050184726715088
Epoch: 7, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.550 Vali Acc: 0.856 Test Loss: 0.550 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 8 cost time: 3.3812835216522217
Epoch: 8, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.542 Vali Acc: 0.856 Test Loss: 0.542 Test Acc: 0.856
Validation loss decreased (-0.856245 --> -0.856245).  Saving model ...
Epoch: 9 cost time: 2.4129738807678223
Epoch: 9, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.550 Vali Acc: 0.853 Test Loss: 0.550 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.166210651397705
Epoch: 10, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.590 Vali Acc: 0.863 Test Loss: 0.590 Test Acc: 0.863
Validation loss decreased (-0.856245 --> -0.862494).  Saving model ...
Epoch: 11 cost time: 3.6019904613494873
Epoch: 11, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.625 Vali Acc: 0.856 Test Loss: 0.625 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.919881820678711
Epoch: 12, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.621 Vali Acc: 0.850 Test Loss: 0.621 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.6750025749206543
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.625 Vali Acc: 0.853 Test Loss: 0.625 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.073413610458374
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.633 Vali Acc: 0.863 Test Loss: 0.633 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.3994436264038086
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.635 Vali Acc: 0.863 Test Loss: 0.635 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.4610280990600586
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.635 Vali Acc: 0.853 Test Loss: 0.635 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.996485471725464
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.642 Vali Acc: 0.850 Test Loss: 0.642 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.469153881072998
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.647 Vali Acc: 0.853 Test Loss: 0.647 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.1793437004089355
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.658 Vali Acc: 0.850 Test Loss: 0.658 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.6130995750427246
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.668 Vali Acc: 0.850 Test Loss: 0.668 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 2916808
model size : 12.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.8792009353637695
Epoch: 1, Steps: 8 | Train Loss: 1.973 Vali Loss: 1.708 Vali Acc: 0.456 Test Loss: 1.708 Test Acc: 0.456
Validation loss decreased (inf --> -0.456233).  Saving model ...
Epoch: 2 cost time: 4.255985975265503
Epoch: 2, Steps: 8 | Train Loss: 1.327 Vali Loss: 0.947 Vali Acc: 0.806 Test Loss: 0.947 Test Acc: 0.806
Validation loss decreased (-0.456233 --> -0.806241).  Saving model ...
Epoch: 3 cost time: 4.893290758132935
Epoch: 3, Steps: 8 | Train Loss: 0.648 Vali Loss: 0.587 Vali Acc: 0.838 Test Loss: 0.587 Test Acc: 0.838
Validation loss decreased (-0.806241 --> -0.837494).  Saving model ...
Epoch: 4 cost time: 5.558573007583618
Epoch: 4, Steps: 8 | Train Loss: 0.372 Vali Loss: 0.505 Vali Acc: 0.841 Test Loss: 0.505 Test Acc: 0.841
Validation loss decreased (-0.837494 --> -0.840620).  Saving model ...
Epoch: 5 cost time: 5.429459571838379
Epoch: 5, Steps: 8 | Train Loss: 0.208 Vali Loss: 0.498 Vali Acc: 0.841 Test Loss: 0.498 Test Acc: 0.841
Validation loss decreased (-0.840620 --> -0.840620).  Saving model ...
Epoch: 6 cost time: 5.134981393814087
Epoch: 6, Steps: 8 | Train Loss: 0.125 Vali Loss: 0.532 Vali Acc: 0.853 Test Loss: 0.532 Test Acc: 0.853
Validation loss decreased (-0.840620 --> -0.853120).  Saving model ...
Epoch: 7 cost time: 5.032317876815796
Epoch: 7, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.540 Vali Acc: 0.853 Test Loss: 0.540 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.355600357055664
Epoch: 8, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.535 Vali Acc: 0.850 Test Loss: 0.535 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.272737503051758
Epoch: 9, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.595 Vali Acc: 0.847 Test Loss: 0.595 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.2061450481414795
Epoch: 10, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.576 Vali Acc: 0.841 Test Loss: 0.576 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.7086710929870605
Epoch: 11, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.584 Vali Acc: 0.850 Test Loss: 0.584 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.247157573699951
Epoch: 12, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.626 Vali Acc: 0.844 Test Loss: 0.626 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.734345436096191
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.631 Vali Acc: 0.850 Test Loss: 0.631 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.843302965164185
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.641 Vali Acc: 0.853 Test Loss: 0.641 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.686636209487915
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.652 Vali Acc: 0.847 Test Loss: 0.652 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.495116949081421
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.654 Vali Acc: 0.847 Test Loss: 0.654 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 9536968
model size : 37.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.5083634853363037
Epoch: 1, Steps: 8 | Train Loss: 2.003 Vali Loss: 1.717 Vali Acc: 0.500 Test Loss: 1.717 Test Acc: 0.500
Validation loss decreased (inf --> -0.499983).  Saving model ...
Epoch: 2 cost time: 2.5161995887756348
Epoch: 2, Steps: 8 | Train Loss: 1.394 Vali Loss: 0.994 Vali Acc: 0.772 Test Loss: 0.994 Test Acc: 0.772
Validation loss decreased (-0.499983 --> -0.771865).  Saving model ...
Epoch: 3 cost time: 2.5053844451904297
Epoch: 3, Steps: 8 | Train Loss: 0.768 Vali Loss: 0.647 Vali Acc: 0.809 Test Loss: 0.647 Test Acc: 0.809
Validation loss decreased (-0.771865 --> -0.809369).  Saving model ...
Epoch: 4 cost time: 2.292407989501953
Epoch: 4, Steps: 8 | Train Loss: 0.425 Vali Loss: 0.564 Vali Acc: 0.841 Test Loss: 0.564 Test Acc: 0.841
Validation loss decreased (-0.809369 --> -0.840619).  Saving model ...
Epoch: 5 cost time: 2.4432382583618164
Epoch: 5, Steps: 8 | Train Loss: 0.239 Vali Loss: 0.543 Vali Acc: 0.834 Test Loss: 0.543 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.762585401535034
Epoch: 6, Steps: 8 | Train Loss: 0.144 Vali Loss: 0.581 Vali Acc: 0.831 Test Loss: 0.581 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.7574026584625244
Epoch: 7, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.582 Vali Acc: 0.841 Test Loss: 0.582 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.503291606903076
Epoch: 8, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.575 Vali Acc: 0.841 Test Loss: 0.575 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.4598004817962646
Epoch: 9, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.589 Vali Acc: 0.853 Test Loss: 0.589 Test Acc: 0.853
Validation loss decreased (-0.840619 --> -0.853119).  Saving model ...
Epoch: 10 cost time: 2.2560312747955322
Epoch: 10, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.630 Vali Acc: 0.853 Test Loss: 0.630 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.5563814640045166
Epoch: 11, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.670 Vali Acc: 0.844 Test Loss: 0.670 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.642251491546631
Epoch: 12, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.673 Vali Acc: 0.844 Test Loss: 0.673 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.0125629901885986
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.672 Vali Acc: 0.841 Test Loss: 0.672 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.5657238960266113
Epoch: 14, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.677 Vali Acc: 0.850 Test Loss: 0.677 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.6436822414398193
Epoch: 15, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.677 Vali Acc: 0.850 Test Loss: 0.677 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.997699737548828
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.686 Vali Acc: 0.844 Test Loss: 0.686 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.115501880645752
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.702 Vali Acc: 0.841 Test Loss: 0.702 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.3503098487854004
Epoch: 18, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.710 Vali Acc: 0.841 Test Loss: 0.710 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.624000310897827
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.722 Vali Acc: 0.841 Test Loss: 0.722 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 2916808
model size : 12.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 18.44120717048645
Epoch: 1, Steps: 8 | Train Loss: 2.007 Vali Loss: 1.814 Vali Acc: 0.391 Test Loss: 1.814 Test Acc: 0.391
Validation loss decreased (inf --> -0.390607).  Saving model ...
Epoch: 2 cost time: 13.183928966522217
Epoch: 2, Steps: 8 | Train Loss: 1.557 Vali Loss: 1.304 Vali Acc: 0.731 Test Loss: 1.304 Test Acc: 0.731
Validation loss decreased (-0.390607 --> -0.731237).  Saving model ...
Epoch: 3 cost time: 19.77665376663208
Epoch: 3, Steps: 8 | Train Loss: 1.064 Vali Loss: 0.856 Vali Acc: 0.803 Test Loss: 0.856 Test Acc: 0.803
Validation loss decreased (-0.731237 --> -0.803116).  Saving model ...
Epoch: 4 cost time: 17.20002579689026
Epoch: 4, Steps: 8 | Train Loss: 0.670 Vali Loss: 0.597 Vali Acc: 0.831 Test Loss: 0.597 Test Acc: 0.831
Validation loss decreased (-0.803116 --> -0.831244).  Saving model ...
Epoch: 5 cost time: 18.76014471054077
Epoch: 5, Steps: 8 | Train Loss: 0.398 Vali Loss: 0.507 Vali Acc: 0.859 Test Loss: 0.507 Test Acc: 0.859
Validation loss decreased (-0.831244 --> -0.859370).  Saving model ...
Epoch: 6 cost time: 19.862123727798462
Epoch: 6, Steps: 8 | Train Loss: 0.274 Vali Loss: 0.443 Vali Acc: 0.863 Test Loss: 0.443 Test Acc: 0.863
Validation loss decreased (-0.859370 --> -0.862496).  Saving model ...
Epoch: 7 cost time: 17.852556943893433
Epoch: 7, Steps: 8 | Train Loss: 0.167 Vali Loss: 0.470 Vali Acc: 0.863 Test Loss: 0.470 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 15.841119289398193
Epoch: 8, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.466 Vali Acc: 0.856 Test Loss: 0.466 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 17.573551416397095
Epoch: 9, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.458 Vali Acc: 0.869 Test Loss: 0.458 Test Acc: 0.869
Validation loss decreased (-0.862496 --> -0.868745).  Saving model ...
Epoch: 10 cost time: 13.378282308578491
Epoch: 10, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.488 Vali Acc: 0.869 Test Loss: 0.488 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 17.273689031600952
Epoch: 11, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.450 Vali Acc: 0.866 Test Loss: 0.450 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 18.410398244857788
Epoch: 12, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.483 Vali Acc: 0.872 Test Loss: 0.483 Test Acc: 0.872
Validation loss decreased (-0.868745 --> -0.871870).  Saving model ...
Epoch: 13 cost time: 21.5559184551239
Epoch: 13, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.505 Vali Acc: 0.869 Test Loss: 0.505 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 16.807021141052246
Epoch: 14, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.487 Vali Acc: 0.878 Test Loss: 0.487 Test Acc: 0.878
Validation loss decreased (-0.871870 --> -0.878120).  Saving model ...
Epoch: 15 cost time: 19.61035418510437
Epoch: 15, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.496 Vali Acc: 0.875 Test Loss: 0.496 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 21.144136428833008
Epoch: 16, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.546 Vali Acc: 0.866 Test Loss: 0.546 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 18.735301971435547
Epoch: 17, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.513 Vali Acc: 0.866 Test Loss: 0.513 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 20.796502828598022
Epoch: 18, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.506 Vali Acc: 0.875 Test Loss: 0.506 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 20.497942686080933
Epoch: 19, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.528 Vali Acc: 0.872 Test Loss: 0.528 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 19.423393487930298
Epoch: 20, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.547 Vali Acc: 0.872 Test Loss: 0.547 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 21.62966299057007
Epoch: 21, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.533 Vali Acc: 0.869 Test Loss: 0.533 Test Acc: 0.869
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 21.447898864746094
Epoch: 22, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.529 Vali Acc: 0.869 Test Loss: 0.529 Test Acc: 0.869
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 21.084028720855713
Epoch: 23, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.541 Vali Acc: 0.869 Test Loss: 0.541 Test Acc: 0.869
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 21.170255422592163
Epoch: 24, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.543 Vali Acc: 0.872 Test Loss: 0.543 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.878125
model parameter : 9456616
model size : 36.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 13.11183476448059
Epoch: 1, Steps: 8 | Train Loss: 2.119 Vali Loss: 1.886 Vali Acc: 0.303 Test Loss: 1.886 Test Acc: 0.303
Validation loss decreased (inf --> -0.303106).  Saving model ...
Epoch: 2 cost time: 12.2212495803833
Epoch: 2, Steps: 8 | Train Loss: 1.644 Vali Loss: 1.310 Vali Acc: 0.778 Test Loss: 1.310 Test Acc: 0.778
Validation loss decreased (-0.303106 --> -0.778112).  Saving model ...
Epoch: 3 cost time: 13.936218976974487
Epoch: 3, Steps: 8 | Train Loss: 1.070 Vali Loss: 0.841 Vali Acc: 0.812 Test Loss: 0.841 Test Acc: 0.812
Validation loss decreased (-0.778112 --> -0.812492).  Saving model ...
Epoch: 4 cost time: 12.060726404190063
Epoch: 4, Steps: 8 | Train Loss: 0.623 Vali Loss: 0.600 Vali Acc: 0.834 Test Loss: 0.600 Test Acc: 0.834
Validation loss decreased (-0.812492 --> -0.834369).  Saving model ...
Epoch: 5 cost time: 13.547929286956787
Epoch: 5, Steps: 8 | Train Loss: 0.440 Vali Loss: 0.500 Vali Acc: 0.859 Test Loss: 0.500 Test Acc: 0.859
Validation loss decreased (-0.834369 --> -0.859370).  Saving model ...
Epoch: 6 cost time: 13.788910865783691
Epoch: 6, Steps: 8 | Train Loss: 0.263 Vali Loss: 0.480 Vali Acc: 0.853 Test Loss: 0.480 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 12.817412853240967
Epoch: 7, Steps: 8 | Train Loss: 0.172 Vali Loss: 0.438 Vali Acc: 0.863 Test Loss: 0.438 Test Acc: 0.863
Validation loss decreased (-0.859370 --> -0.862496).  Saving model ...
Epoch: 8 cost time: 13.936977863311768
Epoch: 8, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.451 Vali Acc: 0.866 Test Loss: 0.451 Test Acc: 0.866
Validation loss decreased (-0.862496 --> -0.865620).  Saving model ...
Epoch: 9 cost time: 15.227492332458496
Epoch: 9, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.469 Vali Acc: 0.872 Test Loss: 0.469 Test Acc: 0.872
Validation loss decreased (-0.865620 --> -0.871870).  Saving model ...
Epoch: 10 cost time: 14.175583124160767
Epoch: 10, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.480 Vali Acc: 0.878 Test Loss: 0.480 Test Acc: 0.878
Validation loss decreased (-0.871870 --> -0.878120).  Saving model ...
Epoch: 11 cost time: 12.765263795852661
Epoch: 11, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.482 Vali Acc: 0.866 Test Loss: 0.482 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 11.874275922775269
Epoch: 12, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.487 Vali Acc: 0.869 Test Loss: 0.487 Test Acc: 0.869
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 13.155636310577393
Epoch: 13, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.489 Vali Acc: 0.875 Test Loss: 0.489 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 10.165360689163208
Epoch: 14, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.497 Vali Acc: 0.875 Test Loss: 0.497 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 12.808838367462158
Epoch: 15, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.490 Vali Acc: 0.875 Test Loss: 0.490 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 12.388295412063599
Epoch: 16, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.507 Vali Acc: 0.872 Test Loss: 0.507 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 12.591452360153198
Epoch: 17, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.510 Vali Acc: 0.872 Test Loss: 0.510 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 15.338138818740845
Epoch: 18, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.530 Vali Acc: 0.872 Test Loss: 0.530 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 13.454906463623047
Epoch: 19, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.545 Vali Acc: 0.872 Test Loss: 0.545 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 12.166649103164673
Epoch: 20, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.541 Vali Acc: 0.872 Test Loss: 0.541 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.878125
model parameter : 2836200
model size : 11.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 15.994657516479492
Epoch: 1, Steps: 8 | Train Loss: 2.005 Vali Loss: 1.817 Vali Acc: 0.384 Test Loss: 1.817 Test Acc: 0.384
Validation loss decreased (inf --> -0.384357).  Saving model ...
Epoch: 2 cost time: 16.079400777816772
Epoch: 2, Steps: 8 | Train Loss: 1.557 Vali Loss: 1.323 Vali Acc: 0.731 Test Loss: 1.323 Test Acc: 0.731
Validation loss decreased (-0.384357 --> -0.731237).  Saving model ...
Epoch: 3 cost time: 16.517972230911255
Epoch: 3, Steps: 8 | Train Loss: 1.067 Vali Loss: 0.883 Vali Acc: 0.797 Test Loss: 0.883 Test Acc: 0.797
Validation loss decreased (-0.731237 --> -0.796866).  Saving model ...
Epoch: 4 cost time: 15.309019565582275
Epoch: 4, Steps: 8 | Train Loss: 0.679 Vali Loss: 0.624 Vali Acc: 0.831 Test Loss: 0.624 Test Acc: 0.831
Validation loss decreased (-0.796866 --> -0.831244).  Saving model ...
Epoch: 5 cost time: 15.291118383407593
Epoch: 5, Steps: 8 | Train Loss: 0.403 Vali Loss: 0.523 Vali Acc: 0.856 Test Loss: 0.523 Test Acc: 0.856
Validation loss decreased (-0.831244 --> -0.856245).  Saving model ...
Epoch: 6 cost time: 15.898372888565063
Epoch: 6, Steps: 8 | Train Loss: 0.276 Vali Loss: 0.458 Vali Acc: 0.863 Test Loss: 0.458 Test Acc: 0.863
Validation loss decreased (-0.856245 --> -0.862495).  Saving model ...
Epoch: 7 cost time: 15.201176643371582
Epoch: 7, Steps: 8 | Train Loss: 0.168 Vali Loss: 0.480 Vali Acc: 0.856 Test Loss: 0.480 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 14.75560975074768
Epoch: 8, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.480 Vali Acc: 0.850 Test Loss: 0.480 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 16.13031506538391
Epoch: 9, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.474 Vali Acc: 0.863 Test Loss: 0.474 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 17.015856742858887
Epoch: 10, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.502 Vali Acc: 0.856 Test Loss: 0.502 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 11.822436332702637
Epoch: 11, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.468 Vali Acc: 0.853 Test Loss: 0.468 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 14.531920194625854
Epoch: 12, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.496 Vali Acc: 0.863 Test Loss: 0.496 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 11.993303537368774
Epoch: 13, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.517 Vali Acc: 0.863 Test Loss: 0.517 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 14.8941171169281
Epoch: 14, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.504 Vali Acc: 0.866 Test Loss: 0.504 Test Acc: 0.866
Validation loss decreased (-0.862495 --> -0.865620).  Saving model ...
Epoch: 15 cost time: 11.156584978103638
Epoch: 15, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.512 Vali Acc: 0.863 Test Loss: 0.512 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 11.614981174468994
Epoch: 16, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.559 Vali Acc: 0.856 Test Loss: 0.559 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 12.635754346847534
Epoch: 17, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.522 Vali Acc: 0.859 Test Loss: 0.522 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 13.305899620056152
Epoch: 18, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.517 Vali Acc: 0.875 Test Loss: 0.517 Test Acc: 0.875
Validation loss decreased (-0.865620 --> -0.874995).  Saving model ...
Epoch: 19 cost time: 14.380895376205444
Epoch: 19, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.541 Vali Acc: 0.863 Test Loss: 0.541 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 14.246499300003052
Epoch: 20, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.559 Vali Acc: 0.863 Test Loss: 0.559 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 14.012073040008545
Epoch: 21, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.543 Vali Acc: 0.872 Test Loss: 0.543 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 12.18720030784607
Epoch: 22, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.542 Vali Acc: 0.869 Test Loss: 0.542 Test Acc: 0.869
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 12.940293312072754
Epoch: 23, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.556 Vali Acc: 0.863 Test Loss: 0.556 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 14.152567625045776
Epoch: 24, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.559 Vali Acc: 0.863 Test Loss: 0.559 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 8.352264404296875
Epoch: 25, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.550 Vali Acc: 0.869 Test Loss: 0.550 Test Acc: 0.869
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 12.02529764175415
Epoch: 26, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.561 Vali Acc: 0.866 Test Loss: 0.561 Test Acc: 0.866
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 8.710850954055786
Epoch: 27, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.573 Vali Acc: 0.866 Test Loss: 0.573 Test Acc: 0.866
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 12.932734727859497
Epoch: 28, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.572 Vali Acc: 0.869 Test Loss: 0.572 Test Acc: 0.869
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.875
model parameter : 9456616
model size : 36.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 10.417822122573853
Epoch: 1, Steps: 8 | Train Loss: 2.123 Vali Loss: 1.888 Vali Acc: 0.297 Test Loss: 1.888 Test Acc: 0.297
Validation loss decreased (inf --> -0.296856).  Saving model ...
Epoch: 2 cost time: 7.347220420837402
Epoch: 2, Steps: 8 | Train Loss: 1.645 Vali Loss: 1.319 Vali Acc: 0.775 Test Loss: 1.319 Test Acc: 0.775
Validation loss decreased (-0.296856 --> -0.774987).  Saving model ...
Epoch: 3 cost time: 10.520671844482422
Epoch: 3, Steps: 8 | Train Loss: 1.071 Vali Loss: 0.856 Vali Acc: 0.800 Test Loss: 0.856 Test Acc: 0.800
Validation loss decreased (-0.774987 --> -0.799991).  Saving model ...
Epoch: 4 cost time: 11.18713927268982
Epoch: 4, Steps: 8 | Train Loss: 0.626 Vali Loss: 0.616 Vali Acc: 0.828 Test Loss: 0.616 Test Acc: 0.828
Validation loss decreased (-0.799991 --> -0.828119).  Saving model ...
Epoch: 5 cost time: 11.022802352905273
Epoch: 5, Steps: 8 | Train Loss: 0.444 Vali Loss: 0.513 Vali Acc: 0.856 Test Loss: 0.513 Test Acc: 0.856
Validation loss decreased (-0.828119 --> -0.856245).  Saving model ...
Epoch: 6 cost time: 10.995743989944458
Epoch: 6, Steps: 8 | Train Loss: 0.267 Vali Loss: 0.492 Vali Acc: 0.850 Test Loss: 0.492 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.251868963241577
Epoch: 7, Steps: 8 | Train Loss: 0.175 Vali Loss: 0.449 Vali Acc: 0.863 Test Loss: 0.449 Test Acc: 0.863
Validation loss decreased (-0.856245 --> -0.862496).  Saving model ...
Epoch: 8 cost time: 11.413033246994019
Epoch: 8, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.466 Vali Acc: 0.859 Test Loss: 0.466 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 11.254002332687378
Epoch: 9, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.486 Vali Acc: 0.863 Test Loss: 0.486 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 8.272046089172363
Epoch: 10, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.494 Vali Acc: 0.869 Test Loss: 0.494 Test Acc: 0.869
Validation loss decreased (-0.862496 --> -0.868745).  Saving model ...
Epoch: 11 cost time: 9.74562954902649
Epoch: 11, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.490 Vali Acc: 0.866 Test Loss: 0.490 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 9.822849750518799
Epoch: 12, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.495 Vali Acc: 0.866 Test Loss: 0.495 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 10.24712061882019
Epoch: 13, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.501 Vali Acc: 0.866 Test Loss: 0.501 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 10.132212400436401
Epoch: 14, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.510 Vali Acc: 0.866 Test Loss: 0.510 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 7.995496988296509
Epoch: 15, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.501 Vali Acc: 0.875 Test Loss: 0.501 Test Acc: 0.875
Validation loss decreased (-0.868745 --> -0.874995).  Saving model ...
Epoch: 16 cost time: 10.160009384155273
Epoch: 16, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.518 Vali Acc: 0.872 Test Loss: 0.518 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 11.341641664505005
Epoch: 17, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.520 Vali Acc: 0.869 Test Loss: 0.520 Test Acc: 0.869
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 9.368186712265015
Epoch: 18, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.541 Vali Acc: 0.866 Test Loss: 0.541 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 6.923743963241577
Epoch: 19, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.556 Vali Acc: 0.869 Test Loss: 0.556 Test Acc: 0.869
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 8.074850082397461
Epoch: 20, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.550 Vali Acc: 0.872 Test Loss: 0.550 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 8.711143732070923
Epoch: 21, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.553 Vali Acc: 0.866 Test Loss: 0.553 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 7.369351148605347
Epoch: 22, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.553 Vali Acc: 0.866 Test Loss: 0.553 Test Acc: 0.866
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 8.051265239715576
Epoch: 23, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.558 Vali Acc: 0.866 Test Loss: 0.558 Test Acc: 0.866
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 7.8967814445495605
Epoch: 24, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.566 Vali Acc: 0.866 Test Loss: 0.566 Test Acc: 0.866
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 6.602266550064087
Epoch: 25, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.573 Vali Acc: 0.869 Test Loss: 0.573 Test Acc: 0.869
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.875
model parameter : 2836200
model size : 11.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.800532817840576
Epoch: 1, Steps: 8 | Train Loss: 2.007 Vali Loss: 1.827 Vali Acc: 0.366 Test Loss: 1.827 Test Acc: 0.366
Validation loss decreased (inf --> -0.365607).  Saving model ...
Epoch: 2 cost time: 2.906381130218506
Epoch: 2, Steps: 8 | Train Loss: 1.582 Vali Loss: 1.354 Vali Acc: 0.719 Test Loss: 1.354 Test Acc: 0.719
Validation loss decreased (-0.365607 --> -0.718736).  Saving model ...
Epoch: 3 cost time: 3.399081230163574
Epoch: 3, Steps: 8 | Train Loss: 1.113 Vali Loss: 0.920 Vali Acc: 0.794 Test Loss: 0.920 Test Acc: 0.794
Validation loss decreased (-0.718736 --> -0.793741).  Saving model ...
Epoch: 4 cost time: 4.327024936676025
Epoch: 4, Steps: 8 | Train Loss: 0.729 Vali Loss: 0.655 Vali Acc: 0.822 Test Loss: 0.655 Test Acc: 0.822
Validation loss decreased (-0.793741 --> -0.821868).  Saving model ...
Epoch: 5 cost time: 4.722795486450195
Epoch: 5, Steps: 8 | Train Loss: 0.448 Vali Loss: 0.547 Vali Acc: 0.841 Test Loss: 0.547 Test Acc: 0.841
Validation loss decreased (-0.821868 --> -0.840620).  Saving model ...
Epoch: 6 cost time: 3.9058492183685303
Epoch: 6, Steps: 8 | Train Loss: 0.338 Vali Loss: 0.478 Vali Acc: 0.856 Test Loss: 0.478 Test Acc: 0.856
Validation loss decreased (-0.840620 --> -0.856245).  Saving model ...
Epoch: 7 cost time: 3.9066011905670166
Epoch: 7, Steps: 8 | Train Loss: 0.210 Vali Loss: 0.503 Vali Acc: 0.856 Test Loss: 0.503 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.1206371784210205
Epoch: 8, Steps: 8 | Train Loss: 0.137 Vali Loss: 0.509 Vali Acc: 0.844 Test Loss: 0.509 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.6465938091278076
Epoch: 9, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.511 Vali Acc: 0.847 Test Loss: 0.511 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.9892940521240234
Epoch: 10, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.529 Vali Acc: 0.866 Test Loss: 0.529 Test Acc: 0.866
Validation loss decreased (-0.856245 --> -0.865620).  Saving model ...
Epoch: 11 cost time: 4.265669107437134
Epoch: 11, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.513 Vali Acc: 0.841 Test Loss: 0.513 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.1540372371673584
Epoch: 12, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.531 Vali Acc: 0.863 Test Loss: 0.531 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.6602931022644043
Epoch: 13, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.550 Vali Acc: 0.850 Test Loss: 0.550 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.01448917388916
Epoch: 14, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.554 Vali Acc: 0.841 Test Loss: 0.554 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.425290822982788
Epoch: 15, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.572 Vali Acc: 0.850 Test Loss: 0.572 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.748461961746216
Epoch: 16, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.606 Vali Acc: 0.853 Test Loss: 0.606 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.999051332473755
Epoch: 17, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.583 Vali Acc: 0.841 Test Loss: 0.583 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.6722865104675293
Epoch: 18, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.584 Vali Acc: 0.853 Test Loss: 0.584 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.194376230239868
Epoch: 19, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.601 Vali Acc: 0.853 Test Loss: 0.601 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.139803886413574
Epoch: 20, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.616 Vali Acc: 0.850 Test Loss: 0.616 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 9456616
model size : 36.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.6763229370117188
Epoch: 1, Steps: 8 | Train Loss: 2.128 Vali Loss: 1.899 Vali Acc: 0.297 Test Loss: 1.899 Test Acc: 0.297
Validation loss decreased (inf --> -0.296856).  Saving model ...
Epoch: 2 cost time: 2.255082607269287
Epoch: 2, Steps: 8 | Train Loss: 1.670 Vali Loss: 1.350 Vali Acc: 0.759 Test Loss: 1.350 Test Acc: 0.759
Validation loss decreased (-0.296856 --> -0.759362).  Saving model ...
Epoch: 3 cost time: 1.9188411235809326
Epoch: 3, Steps: 8 | Train Loss: 1.103 Vali Loss: 0.894 Vali Acc: 0.803 Test Loss: 0.894 Test Acc: 0.803
Validation loss decreased (-0.759362 --> -0.803116).  Saving model ...
Epoch: 4 cost time: 1.8793971538543701
Epoch: 4, Steps: 8 | Train Loss: 0.664 Vali Loss: 0.652 Vali Acc: 0.819 Test Loss: 0.652 Test Acc: 0.819
Validation loss decreased (-0.803116 --> -0.818743).  Saving model ...
Epoch: 5 cost time: 2.1377859115600586
Epoch: 5, Steps: 8 | Train Loss: 0.479 Vali Loss: 0.546 Vali Acc: 0.844 Test Loss: 0.546 Test Acc: 0.844
Validation loss decreased (-0.818743 --> -0.843745).  Saving model ...
Epoch: 6 cost time: 2.3423075675964355
Epoch: 6, Steps: 8 | Train Loss: 0.308 Vali Loss: 0.531 Vali Acc: 0.838 Test Loss: 0.531 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.103832483291626
Epoch: 7, Steps: 8 | Train Loss: 0.213 Vali Loss: 0.494 Vali Acc: 0.850 Test Loss: 0.494 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849995).  Saving model ...
Epoch: 8 cost time: 2.013474464416504
Epoch: 8, Steps: 8 | Train Loss: 0.137 Vali Loss: 0.520 Vali Acc: 0.859 Test Loss: 0.520 Test Acc: 0.859
Validation loss decreased (-0.849995 --> -0.859370).  Saving model ...
Epoch: 9 cost time: 1.9982481002807617
Epoch: 9, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.528 Vali Acc: 0.853 Test Loss: 0.528 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.611347198486328
Epoch: 10, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.523 Vali Acc: 0.856 Test Loss: 0.523 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.4971201419830322
Epoch: 11, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.521 Vali Acc: 0.853 Test Loss: 0.521 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.1978955268859863
Epoch: 12, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.534 Vali Acc: 0.853 Test Loss: 0.534 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.3709347248077393
Epoch: 13, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.553 Vali Acc: 0.856 Test Loss: 0.553 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.4993536472320557
Epoch: 14, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.565 Vali Acc: 0.859 Test Loss: 0.565 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.9676330089569092
Epoch: 15, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.556 Vali Acc: 0.853 Test Loss: 0.556 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.1214852333068848
Epoch: 16, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.568 Vali Acc: 0.853 Test Loss: 0.568 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.4993622303009033
Epoch: 17, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.571 Vali Acc: 0.853 Test Loss: 0.571 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.3111157417297363
Epoch: 18, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.595 Vali Acc: 0.850 Test Loss: 0.595 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 2836200
model size : 11.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 8.538914680480957
Epoch: 1, Steps: 8 | Train Loss: 2.038 Vali Loss: 1.834 Vali Acc: 0.425 Test Loss: 1.834 Test Acc: 0.425
Validation loss decreased (inf --> -0.424982).  Saving model ...
Epoch: 2 cost time: 7.971731185913086
Epoch: 2, Steps: 8 | Train Loss: 1.633 Vali Loss: 1.340 Vali Acc: 0.747 Test Loss: 1.340 Test Acc: 0.747
Validation loss decreased (-0.424982 --> -0.746862).  Saving model ...
Epoch: 3 cost time: 6.985679388046265
Epoch: 3, Steps: 8 | Train Loss: 1.097 Vali Loss: 0.906 Vali Acc: 0.791 Test Loss: 0.906 Test Acc: 0.791
Validation loss decreased (-0.746862 --> -0.790616).  Saving model ...
Epoch: 4 cost time: 6.022086143493652
Epoch: 4, Steps: 8 | Train Loss: 0.670 Vali Loss: 0.634 Vali Acc: 0.816 Test Loss: 0.634 Test Acc: 0.816
Validation loss decreased (-0.790616 --> -0.815619).  Saving model ...
Epoch: 5 cost time: 6.071441173553467
Epoch: 5, Steps: 8 | Train Loss: 0.418 Vali Loss: 0.523 Vali Acc: 0.844 Test Loss: 0.523 Test Acc: 0.844
Validation loss decreased (-0.815619 --> -0.843745).  Saving model ...
Epoch: 6 cost time: 5.998650312423706
Epoch: 6, Steps: 8 | Train Loss: 0.254 Vali Loss: 0.485 Vali Acc: 0.847 Test Loss: 0.485 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 7 cost time: 6.252249717712402
Epoch: 7, Steps: 8 | Train Loss: 0.175 Vali Loss: 0.487 Vali Acc: 0.856 Test Loss: 0.487 Test Acc: 0.856
Validation loss decreased (-0.846870 --> -0.856245).  Saving model ...
Epoch: 8 cost time: 5.681708812713623
Epoch: 8, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.481 Vali Acc: 0.859 Test Loss: 0.481 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 9 cost time: 5.383203744888306
Epoch: 9, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.472 Vali Acc: 0.856 Test Loss: 0.472 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.181474924087524
Epoch: 10, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.475 Vali Acc: 0.863 Test Loss: 0.475 Test Acc: 0.863
Validation loss decreased (-0.859370 --> -0.862495).  Saving model ...
Epoch: 11 cost time: 7.156796455383301
Epoch: 11, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.476 Vali Acc: 0.866 Test Loss: 0.476 Test Acc: 0.866
Validation loss decreased (-0.862495 --> -0.865620).  Saving model ...
Epoch: 12 cost time: 7.418219566345215
Epoch: 12, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.502 Vali Acc: 0.859 Test Loss: 0.502 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.7996909618377686
Epoch: 13, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.508 Vali Acc: 0.866 Test Loss: 0.508 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.576386213302612
Epoch: 14, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.528 Vali Acc: 0.869 Test Loss: 0.528 Test Acc: 0.869
Validation loss decreased (-0.865620 --> -0.868745).  Saving model ...
Epoch: 15 cost time: 6.053687334060669
Epoch: 15, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.548 Vali Acc: 0.863 Test Loss: 0.548 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 8.05778956413269
Epoch: 16, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.556 Vali Acc: 0.859 Test Loss: 0.556 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.907308101654053
Epoch: 17, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.554 Vali Acc: 0.859 Test Loss: 0.554 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 6.6624226570129395
Epoch: 18, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.549 Vali Acc: 0.863 Test Loss: 0.549 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 6.634627819061279
Epoch: 19, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.565 Vali Acc: 0.863 Test Loss: 0.565 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 6.339067697525024
Epoch: 20, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.570 Vali Acc: 0.863 Test Loss: 0.570 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 6.606164216995239
Epoch: 21, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.568 Vali Acc: 0.866 Test Loss: 0.568 Test Acc: 0.866
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 5.75265097618103
Epoch: 22, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.575 Vali Acc: 0.866 Test Loss: 0.575 Test Acc: 0.866
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 6.908818483352661
Epoch: 23, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.578 Vali Acc: 0.869 Test Loss: 0.578 Test Acc: 0.869
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 7.785010814666748
Epoch: 24, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.582 Vali Acc: 0.869 Test Loss: 0.582 Test Acc: 0.869
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 4769256
model size : 18.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 6.565853834152222
Epoch: 1, Steps: 8 | Train Loss: 2.105 Vali Loss: 1.886 Vali Acc: 0.362 Test Loss: 1.886 Test Acc: 0.362
Validation loss decreased (inf --> -0.362481).  Saving model ...
Epoch: 2 cost time: 5.507677793502808
Epoch: 2, Steps: 8 | Train Loss: 1.716 Vali Loss: 1.364 Vali Acc: 0.706 Test Loss: 1.364 Test Acc: 0.706
Validation loss decreased (-0.362481 --> -0.706236).  Saving model ...
Epoch: 3 cost time: 5.363508224487305
Epoch: 3, Steps: 8 | Train Loss: 1.115 Vali Loss: 0.922 Vali Acc: 0.791 Test Loss: 0.922 Test Acc: 0.791
Validation loss decreased (-0.706236 --> -0.790616).  Saving model ...
Epoch: 4 cost time: 4.393104791641235
Epoch: 4, Steps: 8 | Train Loss: 0.708 Vali Loss: 0.670 Vali Acc: 0.816 Test Loss: 0.670 Test Acc: 0.816
Validation loss decreased (-0.790616 --> -0.815618).  Saving model ...
Epoch: 5 cost time: 4.465652227401733
Epoch: 5, Steps: 8 | Train Loss: 0.446 Vali Loss: 0.531 Vali Acc: 0.850 Test Loss: 0.531 Test Acc: 0.850
Validation loss decreased (-0.815618 --> -0.849995).  Saving model ...
Epoch: 6 cost time: 4.88998556137085
Epoch: 6, Steps: 8 | Train Loss: 0.328 Vali Loss: 0.490 Vali Acc: 0.859 Test Loss: 0.490 Test Acc: 0.859
Validation loss decreased (-0.849995 --> -0.859370).  Saving model ...
Epoch: 7 cost time: 4.658017873764038
Epoch: 7, Steps: 8 | Train Loss: 0.184 Vali Loss: 0.472 Vali Acc: 0.859 Test Loss: 0.472 Test Acc: 0.859
Validation loss decreased (-0.859370 --> -0.859370).  Saving model ...
Epoch: 8 cost time: 4.480592966079712
Epoch: 8, Steps: 8 | Train Loss: 0.132 Vali Loss: 0.470 Vali Acc: 0.869 Test Loss: 0.470 Test Acc: 0.869
Validation loss decreased (-0.859370 --> -0.868745).  Saving model ...
Epoch: 9 cost time: 4.465662002563477
Epoch: 9, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.471 Vali Acc: 0.866 Test Loss: 0.471 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.505929946899414
Epoch: 10, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.501 Vali Acc: 0.863 Test Loss: 0.501 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.064776182174683
Epoch: 11, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.558 Vali Acc: 0.847 Test Loss: 0.558 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.839881896972656
Epoch: 12, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.558 Vali Acc: 0.859 Test Loss: 0.558 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.137701988220215
Epoch: 13, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.548 Vali Acc: 0.863 Test Loss: 0.548 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.782824993133545
Epoch: 14, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.552 Vali Acc: 0.863 Test Loss: 0.552 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.978065013885498
Epoch: 15, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.557 Vali Acc: 0.866 Test Loss: 0.557 Test Acc: 0.866
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.857128143310547
Epoch: 16, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.552 Vali Acc: 0.859 Test Loss: 0.552 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.6754066944122314
Epoch: 17, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.568 Vali Acc: 0.863 Test Loss: 0.568 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.816373825073242
Epoch: 18, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.595 Vali Acc: 0.859 Test Loss: 0.595 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 1458920
model size : 6.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 8.29793906211853
Epoch: 1, Steps: 8 | Train Loss: 2.038 Vali Loss: 1.835 Vali Acc: 0.428 Test Loss: 1.835 Test Acc: 0.428
Validation loss decreased (inf --> -0.428107).  Saving model ...
Epoch: 2 cost time: 5.949783563613892
Epoch: 2, Steps: 8 | Train Loss: 1.635 Vali Loss: 1.345 Vali Acc: 0.747 Test Loss: 1.345 Test Acc: 0.747
Validation loss decreased (-0.428107 --> -0.746862).  Saving model ...
Epoch: 3 cost time: 5.503719091415405
Epoch: 3, Steps: 8 | Train Loss: 1.101 Vali Loss: 0.913 Vali Acc: 0.787 Test Loss: 0.913 Test Acc: 0.787
Validation loss decreased (-0.746862 --> -0.787491).  Saving model ...
Epoch: 4 cost time: 4.8652238845825195
Epoch: 4, Steps: 8 | Train Loss: 0.675 Vali Loss: 0.643 Vali Acc: 0.819 Test Loss: 0.643 Test Acc: 0.819
Validation loss decreased (-0.787491 --> -0.818744).  Saving model ...
Epoch: 5 cost time: 5.078911542892456
Epoch: 5, Steps: 8 | Train Loss: 0.419 Vali Loss: 0.533 Vali Acc: 0.844 Test Loss: 0.533 Test Acc: 0.844
Validation loss decreased (-0.818744 --> -0.843745).  Saving model ...
Epoch: 6 cost time: 5.9367451667785645
Epoch: 6, Steps: 8 | Train Loss: 0.254 Vali Loss: 0.495 Vali Acc: 0.841 Test Loss: 0.495 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.2827465534210205
Epoch: 7, Steps: 8 | Train Loss: 0.176 Vali Loss: 0.497 Vali Acc: 0.856 Test Loss: 0.497 Test Acc: 0.856
Validation loss decreased (-0.843745 --> -0.856245).  Saving model ...
Epoch: 8 cost time: 4.423009395599365
Epoch: 8, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.493 Vali Acc: 0.856 Test Loss: 0.493 Test Acc: 0.856
Validation loss decreased (-0.856245 --> -0.856245).  Saving model ...
Epoch: 9 cost time: 4.813692808151245
Epoch: 9, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.487 Vali Acc: 0.847 Test Loss: 0.487 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.416598081588745
Epoch: 10, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.493 Vali Acc: 0.853 Test Loss: 0.493 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.330636978149414
Epoch: 11, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.496 Vali Acc: 0.866 Test Loss: 0.496 Test Acc: 0.866
Validation loss decreased (-0.856245 --> -0.865620).  Saving model ...
Epoch: 12 cost time: 5.276110649108887
Epoch: 12, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.521 Vali Acc: 0.856 Test Loss: 0.521 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.531442165374756
Epoch: 13, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.527 Vali Acc: 0.859 Test Loss: 0.527 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.173673629760742
Epoch: 14, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.548 Vali Acc: 0.863 Test Loss: 0.548 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.858942747116089
Epoch: 15, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.567 Vali Acc: 0.859 Test Loss: 0.567 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.632020473480225
Epoch: 16, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.574 Vali Acc: 0.853 Test Loss: 0.574 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.739170789718628
Epoch: 17, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.569 Vali Acc: 0.853 Test Loss: 0.569 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.498058080673218
Epoch: 18, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.564 Vali Acc: 0.856 Test Loss: 0.564 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.805569410324097
Epoch: 19, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.579 Vali Acc: 0.856 Test Loss: 0.579 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.297899484634399
Epoch: 20, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.585 Vali Acc: 0.856 Test Loss: 0.585 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.641575813293457
Epoch: 21, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.581 Vali Acc: 0.859 Test Loss: 0.581 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 4769256
model size : 18.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.714187860488892
Epoch: 1, Steps: 8 | Train Loss: 2.106 Vali Loss: 1.888 Vali Acc: 0.362 Test Loss: 1.888 Test Acc: 0.362
Validation loss decreased (inf --> -0.362481).  Saving model ...
Epoch: 2 cost time: 3.604569435119629
Epoch: 2, Steps: 8 | Train Loss: 1.717 Vali Loss: 1.370 Vali Acc: 0.697 Test Loss: 1.370 Test Acc: 0.697
Validation loss decreased (-0.362481 --> -0.696861).  Saving model ...
Epoch: 3 cost time: 3.2152655124664307
Epoch: 3, Steps: 8 | Train Loss: 1.115 Vali Loss: 0.931 Vali Acc: 0.794 Test Loss: 0.931 Test Acc: 0.794
Validation loss decreased (-0.696861 --> -0.793741).  Saving model ...
Epoch: 4 cost time: 2.939408779144287
Epoch: 4, Steps: 8 | Train Loss: 0.707 Vali Loss: 0.679 Vali Acc: 0.816 Test Loss: 0.679 Test Acc: 0.816
Validation loss decreased (-0.793741 --> -0.815618).  Saving model ...
Epoch: 5 cost time: 3.582969903945923
Epoch: 5, Steps: 8 | Train Loss: 0.446 Vali Loss: 0.539 Vali Acc: 0.844 Test Loss: 0.539 Test Acc: 0.844
Validation loss decreased (-0.815618 --> -0.843745).  Saving model ...
Epoch: 6 cost time: 3.7664294242858887
Epoch: 6, Steps: 8 | Train Loss: 0.326 Vali Loss: 0.500 Vali Acc: 0.856 Test Loss: 0.500 Test Acc: 0.856
Validation loss decreased (-0.843745 --> -0.856245).  Saving model ...
Epoch: 7 cost time: 3.945114850997925
Epoch: 7, Steps: 8 | Train Loss: 0.183 Vali Loss: 0.481 Vali Acc: 0.853 Test Loss: 0.481 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.182900905609131
Epoch: 8, Steps: 8 | Train Loss: 0.131 Vali Loss: 0.480 Vali Acc: 0.859 Test Loss: 0.480 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 9 cost time: 3.9248132705688477
Epoch: 9, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.482 Vali Acc: 0.859 Test Loss: 0.482 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.423978567123413
Epoch: 10, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.514 Vali Acc: 0.856 Test Loss: 0.514 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.4893248081207275
Epoch: 11, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.571 Vali Acc: 0.841 Test Loss: 0.571 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.2044692039489746
Epoch: 12, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.569 Vali Acc: 0.847 Test Loss: 0.569 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.201547622680664
Epoch: 13, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.561 Vali Acc: 0.853 Test Loss: 0.561 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.34502911567688
Epoch: 14, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.566 Vali Acc: 0.856 Test Loss: 0.566 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.070617437362671
Epoch: 15, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.571 Vali Acc: 0.856 Test Loss: 0.571 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.772226572036743
Epoch: 16, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.567 Vali Acc: 0.853 Test Loss: 0.567 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.276846408843994
Epoch: 17, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.585 Vali Acc: 0.853 Test Loss: 0.585 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.233194589614868
Epoch: 18, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.613 Vali Acc: 0.853 Test Loss: 0.613 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 1458920
model size : 6.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.067014217376709
Epoch: 1, Steps: 8 | Train Loss: 2.035 Vali Loss: 1.837 Vali Acc: 0.434 Test Loss: 1.837 Test Acc: 0.434
Validation loss decreased (inf --> -0.434357).  Saving model ...
Epoch: 2 cost time: 2.3075246810913086
Epoch: 2, Steps: 8 | Train Loss: 1.642 Vali Loss: 1.363 Vali Acc: 0.738 Test Loss: 1.363 Test Acc: 0.738
Validation loss decreased (-0.434357 --> -0.737486).  Saving model ...
Epoch: 3 cost time: 2.525162696838379
Epoch: 3, Steps: 8 | Train Loss: 1.127 Vali Loss: 0.940 Vali Acc: 0.778 Test Loss: 0.940 Test Acc: 0.778
Validation loss decreased (-0.737486 --> -0.778116).  Saving model ...
Epoch: 4 cost time: 2.805055856704712
Epoch: 4, Steps: 8 | Train Loss: 0.708 Vali Loss: 0.670 Vali Acc: 0.812 Test Loss: 0.670 Test Acc: 0.812
Validation loss decreased (-0.778116 --> -0.812493).  Saving model ...
Epoch: 5 cost time: 2.765038013458252
Epoch: 5, Steps: 8 | Train Loss: 0.459 Vali Loss: 0.560 Vali Acc: 0.834 Test Loss: 0.560 Test Acc: 0.834
Validation loss decreased (-0.812493 --> -0.834369).  Saving model ...
Epoch: 6 cost time: 2.8605499267578125
Epoch: 6, Steps: 8 | Train Loss: 0.311 Vali Loss: 0.520 Vali Acc: 0.841 Test Loss: 0.520 Test Acc: 0.841
Validation loss decreased (-0.834369 --> -0.840620).  Saving model ...
Epoch: 7 cost time: 2.5972864627838135
Epoch: 7, Steps: 8 | Train Loss: 0.216 Vali Loss: 0.519 Vali Acc: 0.856 Test Loss: 0.519 Test Acc: 0.856
Validation loss decreased (-0.840620 --> -0.856245).  Saving model ...
Epoch: 8 cost time: 2.860919713973999
Epoch: 8, Steps: 8 | Train Loss: 0.152 Vali Loss: 0.520 Vali Acc: 0.853 Test Loss: 0.520 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.0933573246002197
Epoch: 9, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.506 Vali Acc: 0.853 Test Loss: 0.506 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.195650815963745
Epoch: 10, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.505 Vali Acc: 0.869 Test Loss: 0.505 Test Acc: 0.869
Validation loss decreased (-0.856245 --> -0.868745).  Saving model ...
Epoch: 11 cost time: 3.236682176589966
Epoch: 11, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.518 Vali Acc: 0.859 Test Loss: 0.518 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.3729031085968018
Epoch: 12, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.533 Vali Acc: 0.853 Test Loss: 0.533 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.6838042736053467
Epoch: 13, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.539 Vali Acc: 0.859 Test Loss: 0.539 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.6807496547698975
Epoch: 14, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.560 Vali Acc: 0.859 Test Loss: 0.560 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.759793281555176
Epoch: 15, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.584 Vali Acc: 0.847 Test Loss: 0.584 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.901012659072876
Epoch: 16, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.594 Vali Acc: 0.841 Test Loss: 0.594 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.1866559982299805
Epoch: 17, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.592 Vali Acc: 0.853 Test Loss: 0.592 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.298689365386963
Epoch: 18, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.590 Vali Acc: 0.850 Test Loss: 0.590 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.4614033699035645
Epoch: 19, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.602 Vali Acc: 0.856 Test Loss: 0.602 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.238126516342163
Epoch: 20, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.609 Vali Acc: 0.859 Test Loss: 0.609 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 4769256
model size : 18.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.171130418777466
Epoch: 1, Steps: 8 | Train Loss: 2.109 Vali Loss: 1.890 Vali Acc: 0.375 Test Loss: 1.890 Test Acc: 0.375
Validation loss decreased (inf --> -0.374981).  Saving model ...
Epoch: 2 cost time: 1.9207513332366943
Epoch: 2, Steps: 8 | Train Loss: 1.728 Vali Loss: 1.382 Vali Acc: 0.697 Test Loss: 1.382 Test Acc: 0.697
Validation loss decreased (-0.374981 --> -0.696861).  Saving model ...
Epoch: 3 cost time: 1.9016859531402588
Epoch: 3, Steps: 8 | Train Loss: 1.141 Vali Loss: 0.950 Vali Acc: 0.794 Test Loss: 0.950 Test Acc: 0.794
Validation loss decreased (-0.696861 --> -0.793740).  Saving model ...
Epoch: 4 cost time: 1.9367706775665283
Epoch: 4, Steps: 8 | Train Loss: 0.738 Vali Loss: 0.698 Vali Acc: 0.812 Test Loss: 0.698 Test Acc: 0.812
Validation loss decreased (-0.793740 --> -0.812493).  Saving model ...
Epoch: 5 cost time: 1.7820446491241455
Epoch: 5, Steps: 8 | Train Loss: 0.480 Vali Loss: 0.558 Vali Acc: 0.828 Test Loss: 0.558 Test Acc: 0.828
Validation loss decreased (-0.812493 --> -0.828119).  Saving model ...
Epoch: 6 cost time: 1.60819411277771
Epoch: 6, Steps: 8 | Train Loss: 0.367 Vali Loss: 0.519 Vali Acc: 0.850 Test Loss: 0.519 Test Acc: 0.850
Validation loss decreased (-0.828119 --> -0.849995).  Saving model ...
Epoch: 7 cost time: 1.8627288341522217
Epoch: 7, Steps: 8 | Train Loss: 0.212 Vali Loss: 0.511 Vali Acc: 0.847 Test Loss: 0.511 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8941731452941895
Epoch: 8, Steps: 8 | Train Loss: 0.154 Vali Loss: 0.509 Vali Acc: 0.850 Test Loss: 0.509 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 9 cost time: 1.7001712322235107
Epoch: 9, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.503 Vali Acc: 0.856 Test Loss: 0.503 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.856245).  Saving model ...
Epoch: 10 cost time: 1.830824613571167
Epoch: 10, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.530 Vali Acc: 0.859 Test Loss: 0.530 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 11 cost time: 1.8600659370422363
Epoch: 11, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.586 Vali Acc: 0.844 Test Loss: 0.586 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7741515636444092
Epoch: 12, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.587 Vali Acc: 0.844 Test Loss: 0.587 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.9713363647460938
Epoch: 13, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.576 Vali Acc: 0.850 Test Loss: 0.576 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.8941500186920166
Epoch: 14, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.583 Vali Acc: 0.856 Test Loss: 0.583 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.8197989463806152
Epoch: 15, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.590 Vali Acc: 0.853 Test Loss: 0.590 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.611522912979126
Epoch: 16, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.590 Vali Acc: 0.847 Test Loss: 0.590 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.636000394821167
Epoch: 17, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.607 Vali Acc: 0.847 Test Loss: 0.607 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.453010082244873
Epoch: 18, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.634 Vali Acc: 0.856 Test Loss: 0.634 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.6945128440856934
Epoch: 19, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.649 Vali Acc: 0.847 Test Loss: 0.649 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.761366844177246
Epoch: 20, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.652 Vali Acc: 0.847 Test Loss: 0.652 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 1458920
model size : 6.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.751245975494385
Epoch: 1, Steps: 8 | Train Loss: 1.984 Vali Loss: 1.828 Vali Acc: 0.453 Test Loss: 1.828 Test Acc: 0.453
Validation loss decreased (inf --> -0.453107).  Saving model ...
Epoch: 2 cost time: 3.751854658126831
Epoch: 2, Steps: 8 | Train Loss: 1.605 Vali Loss: 1.305 Vali Acc: 0.787 Test Loss: 1.305 Test Acc: 0.787
Validation loss decreased (-0.453107 --> -0.787487).  Saving model ...
Epoch: 3 cost time: 3.7398264408111572
Epoch: 3, Steps: 8 | Train Loss: 1.051 Vali Loss: 0.858 Vali Acc: 0.819 Test Loss: 0.858 Test Acc: 0.819
Validation loss decreased (-0.787487 --> -0.818741).  Saving model ...
Epoch: 4 cost time: 3.7769861221313477
Epoch: 4, Steps: 8 | Train Loss: 0.719 Vali Loss: 0.596 Vali Acc: 0.844 Test Loss: 0.596 Test Acc: 0.844
Validation loss decreased (-0.818741 --> -0.843744).  Saving model ...
Epoch: 5 cost time: 4.0559165477752686
Epoch: 5, Steps: 8 | Train Loss: 0.458 Vali Loss: 0.512 Vali Acc: 0.853 Test Loss: 0.512 Test Acc: 0.853
Validation loss decreased (-0.843744 --> -0.853120).  Saving model ...
Epoch: 6 cost time: 4.550152063369751
Epoch: 6, Steps: 8 | Train Loss: 0.316 Vali Loss: 0.469 Vali Acc: 0.847 Test Loss: 0.469 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.290186166763306
Epoch: 7, Steps: 8 | Train Loss: 0.224 Vali Loss: 0.454 Vali Acc: 0.859 Test Loss: 0.454 Test Acc: 0.859
Validation loss decreased (-0.853120 --> -0.859370).  Saving model ...
Epoch: 8 cost time: 3.863140821456909
Epoch: 8, Steps: 8 | Train Loss: 0.143 Vali Loss: 0.456 Vali Acc: 0.866 Test Loss: 0.456 Test Acc: 0.866
Validation loss decreased (-0.859370 --> -0.865620).  Saving model ...
Epoch: 9 cost time: 3.862769842147827
Epoch: 9, Steps: 8 | Train Loss: 0.096 Vali Loss: 0.436 Vali Acc: 0.872 Test Loss: 0.436 Test Acc: 0.872
Validation loss decreased (-0.865620 --> -0.871871).  Saving model ...
Epoch: 10 cost time: 3.8039298057556152
Epoch: 10, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.440 Vali Acc: 0.875 Test Loss: 0.440 Test Acc: 0.875
Validation loss decreased (-0.871871 --> -0.874996).  Saving model ...
Epoch: 11 cost time: 3.9814629554748535
Epoch: 11, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.479 Vali Acc: 0.869 Test Loss: 0.479 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.491321086883545
Epoch: 12, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.465 Vali Acc: 0.881 Test Loss: 0.465 Test Acc: 0.881
Validation loss decreased (-0.874996 --> -0.881245).  Saving model ...
Epoch: 13 cost time: 3.6316592693328857
Epoch: 13, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.457 Vali Acc: 0.881 Test Loss: 0.457 Test Acc: 0.881
Validation loss decreased (-0.881245 --> -0.881245).  Saving model ...
Epoch: 14 cost time: 3.8218653202056885
Epoch: 14, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.476 Vali Acc: 0.881 Test Loss: 0.476 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.939115285873413
Epoch: 15, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.480 Vali Acc: 0.884 Test Loss: 0.480 Test Acc: 0.884
Validation loss decreased (-0.881245 --> -0.884370).  Saving model ...
Epoch: 16 cost time: 4.127422332763672
Epoch: 16, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.487 Vali Acc: 0.881 Test Loss: 0.487 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.990044355392456
Epoch: 17, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.485 Vali Acc: 0.881 Test Loss: 0.485 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.8618342876434326
Epoch: 18, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.486 Vali Acc: 0.881 Test Loss: 0.486 Test Acc: 0.881
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.2849280834198
Epoch: 19, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.496 Vali Acc: 0.881 Test Loss: 0.496 Test Acc: 0.881
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.2405078411102295
Epoch: 20, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.508 Vali Acc: 0.875 Test Loss: 0.508 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.5196988582611084
Epoch: 21, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.512 Vali Acc: 0.878 Test Loss: 0.512 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.6762707233428955
Epoch: 22, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.514 Vali Acc: 0.878 Test Loss: 0.514 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.4913649559020996
Epoch: 23, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.516 Vali Acc: 0.878 Test Loss: 0.516 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.2846245765686035
Epoch: 24, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.526 Vali Acc: 0.881 Test Loss: 0.526 Test Acc: 0.881
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.3563344478607178
Epoch: 25, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.535 Vali Acc: 0.875 Test Loss: 0.535 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.884375
model parameter : 2425576
model size : 9.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.542574405670166
Epoch: 1, Steps: 8 | Train Loss: 2.070 Vali Loss: 1.855 Vali Acc: 0.366 Test Loss: 1.855 Test Acc: 0.366
Validation loss decreased (inf --> -0.365606).  Saving model ...
Epoch: 2 cost time: 2.1001367568969727
Epoch: 2, Steps: 8 | Train Loss: 1.687 Vali Loss: 1.337 Vali Acc: 0.775 Test Loss: 1.337 Test Acc: 0.775
Validation loss decreased (-0.365606 --> -0.774987).  Saving model ...
Epoch: 3 cost time: 2.0627546310424805
Epoch: 3, Steps: 8 | Train Loss: 1.148 Vali Loss: 0.876 Vali Acc: 0.806 Test Loss: 0.876 Test Acc: 0.806
Validation loss decreased (-0.774987 --> -0.806241).  Saving model ...
Epoch: 4 cost time: 1.8743443489074707
Epoch: 4, Steps: 8 | Train Loss: 0.700 Vali Loss: 0.609 Vali Acc: 0.844 Test Loss: 0.609 Test Acc: 0.844
Validation loss decreased (-0.806241 --> -0.843744).  Saving model ...
Epoch: 5 cost time: 1.856710433959961
Epoch: 5, Steps: 8 | Train Loss: 0.439 Vali Loss: 0.492 Vali Acc: 0.850 Test Loss: 0.492 Test Acc: 0.850
Validation loss decreased (-0.843744 --> -0.849995).  Saving model ...
Epoch: 6 cost time: 1.9894003868103027
Epoch: 6, Steps: 8 | Train Loss: 0.266 Vali Loss: 0.444 Vali Acc: 0.869 Test Loss: 0.444 Test Acc: 0.869
Validation loss decreased (-0.849995 --> -0.868746).  Saving model ...
Epoch: 7 cost time: 1.9530000686645508
Epoch: 7, Steps: 8 | Train Loss: 0.201 Vali Loss: 0.453 Vali Acc: 0.859 Test Loss: 0.453 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.1332249641418457
Epoch: 8, Steps: 8 | Train Loss: 0.120 Vali Loss: 0.439 Vali Acc: 0.863 Test Loss: 0.439 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9986293315887451
Epoch: 9, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.449 Vali Acc: 0.866 Test Loss: 0.449 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.0902576446533203
Epoch: 10, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.457 Vali Acc: 0.872 Test Loss: 0.457 Test Acc: 0.872
Validation loss decreased (-0.868746 --> -0.871870).  Saving model ...
Epoch: 11 cost time: 2.0807106494903564
Epoch: 11, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.473 Vali Acc: 0.869 Test Loss: 0.473 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9289085865020752
Epoch: 12, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.481 Vali Acc: 0.875 Test Loss: 0.481 Test Acc: 0.875
Validation loss decreased (-0.871870 --> -0.874995).  Saving model ...
Epoch: 13 cost time: 1.8650164604187012
Epoch: 13, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.488 Vali Acc: 0.875 Test Loss: 0.488 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9044954776763916
Epoch: 14, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.492 Vali Acc: 0.872 Test Loss: 0.492 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.9084053039550781
Epoch: 15, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.497 Vali Acc: 0.872 Test Loss: 0.497 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.14754319190979
Epoch: 16, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.512 Vali Acc: 0.869 Test Loss: 0.512 Test Acc: 0.869
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.081831932067871
Epoch: 17, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.517 Vali Acc: 0.869 Test Loss: 0.517 Test Acc: 0.869
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.0763604640960693
Epoch: 18, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.518 Vali Acc: 0.872 Test Loss: 0.518 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.0212507247924805
Epoch: 19, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.529 Vali Acc: 0.872 Test Loss: 0.529 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.9387810230255127
Epoch: 20, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.537 Vali Acc: 0.869 Test Loss: 0.537 Test Acc: 0.869
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.9194254875183105
Epoch: 21, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.537 Vali Acc: 0.869 Test Loss: 0.537 Test Acc: 0.869
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.8185455799102783
Epoch: 22, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.540 Vali Acc: 0.869 Test Loss: 0.540 Test Acc: 0.869
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.875
model parameter : 770280
model size : 3.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.375114679336548
Epoch: 1, Steps: 8 | Train Loss: 1.984 Vali Loss: 1.830 Vali Acc: 0.447 Test Loss: 1.830 Test Acc: 0.447
Validation loss decreased (inf --> -0.446857).  Saving model ...
Epoch: 2 cost time: 3.0544204711914062
Epoch: 2, Steps: 8 | Train Loss: 1.608 Vali Loss: 1.312 Vali Acc: 0.781 Test Loss: 1.312 Test Acc: 0.781
Validation loss decreased (-0.446857 --> -0.781237).  Saving model ...
Epoch: 3 cost time: 2.615838050842285
Epoch: 3, Steps: 8 | Train Loss: 1.057 Vali Loss: 0.868 Vali Acc: 0.819 Test Loss: 0.868 Test Acc: 0.819
Validation loss decreased (-0.781237 --> -0.818741).  Saving model ...
Epoch: 4 cost time: 2.5796926021575928
Epoch: 4, Steps: 8 | Train Loss: 0.722 Vali Loss: 0.606 Vali Acc: 0.844 Test Loss: 0.606 Test Acc: 0.844
Validation loss decreased (-0.818741 --> -0.843744).  Saving model ...
Epoch: 5 cost time: 2.752337694168091
Epoch: 5, Steps: 8 | Train Loss: 0.458 Vali Loss: 0.520 Vali Acc: 0.856 Test Loss: 0.520 Test Acc: 0.856
Validation loss decreased (-0.843744 --> -0.856245).  Saving model ...
Epoch: 6 cost time: 2.923628807067871
Epoch: 6, Steps: 8 | Train Loss: 0.314 Vali Loss: 0.475 Vali Acc: 0.847 Test Loss: 0.475 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.001230239868164
Epoch: 7, Steps: 8 | Train Loss: 0.223 Vali Loss: 0.461 Vali Acc: 0.863 Test Loss: 0.461 Test Acc: 0.863
Validation loss decreased (-0.856245 --> -0.862495).  Saving model ...
Epoch: 8 cost time: 3.063655138015747
Epoch: 8, Steps: 8 | Train Loss: 0.143 Vali Loss: 0.466 Vali Acc: 0.863 Test Loss: 0.466 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.7911810874938965
Epoch: 9, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.448 Vali Acc: 0.866 Test Loss: 0.448 Test Acc: 0.866
Validation loss decreased (-0.862495 --> -0.865621).  Saving model ...
Epoch: 10 cost time: 2.618720293045044
Epoch: 10, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.451 Vali Acc: 0.872 Test Loss: 0.451 Test Acc: 0.872
Validation loss decreased (-0.865621 --> -0.871870).  Saving model ...
Epoch: 11 cost time: 3.01820969581604
Epoch: 11, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.489 Vali Acc: 0.866 Test Loss: 0.489 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.1173291206359863
Epoch: 12, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.472 Vali Acc: 0.878 Test Loss: 0.472 Test Acc: 0.878
Validation loss decreased (-0.871870 --> -0.878120).  Saving model ...
Epoch: 13 cost time: 2.9917819499969482
Epoch: 13, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.462 Vali Acc: 0.881 Test Loss: 0.462 Test Acc: 0.881
Validation loss decreased (-0.878120 --> -0.881245).  Saving model ...
Epoch: 14 cost time: 2.691291093826294
Epoch: 14, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.484 Vali Acc: 0.881 Test Loss: 0.484 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.035167694091797
Epoch: 15, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.488 Vali Acc: 0.878 Test Loss: 0.488 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.1633548736572266
Epoch: 16, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.495 Vali Acc: 0.881 Test Loss: 0.495 Test Acc: 0.881
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.8713231086730957
Epoch: 17, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.491 Vali Acc: 0.875 Test Loss: 0.491 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.9108664989471436
Epoch: 18, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.493 Vali Acc: 0.875 Test Loss: 0.493 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.0889315605163574
Epoch: 19, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.502 Vali Acc: 0.875 Test Loss: 0.502 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.9933602809906006
Epoch: 20, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.514 Vali Acc: 0.872 Test Loss: 0.514 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.1981143951416016
Epoch: 21, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.517 Vali Acc: 0.872 Test Loss: 0.517 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.0403504371643066
Epoch: 22, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.519 Vali Acc: 0.872 Test Loss: 0.519 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.9529383182525635
Epoch: 23, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.522 Vali Acc: 0.872 Test Loss: 0.522 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.88125
model parameter : 2425576
model size : 9.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.2067136764526367
Epoch: 1, Steps: 8 | Train Loss: 2.074 Vali Loss: 1.857 Vali Acc: 0.372 Test Loss: 1.857 Test Acc: 0.372
Validation loss decreased (inf --> -0.371856).  Saving model ...
Epoch: 2 cost time: 1.9031589031219482
Epoch: 2, Steps: 8 | Train Loss: 1.695 Vali Loss: 1.348 Vali Acc: 0.775 Test Loss: 1.348 Test Acc: 0.775
Validation loss decreased (-0.371856 --> -0.774987).  Saving model ...
Epoch: 3 cost time: 1.8072972297668457
Epoch: 3, Steps: 8 | Train Loss: 1.156 Vali Loss: 0.893 Vali Acc: 0.806 Test Loss: 0.893 Test Acc: 0.806
Validation loss decreased (-0.774987 --> -0.806241).  Saving model ...
Epoch: 4 cost time: 1.6803030967712402
Epoch: 4, Steps: 8 | Train Loss: 0.705 Vali Loss: 0.624 Vali Acc: 0.838 Test Loss: 0.624 Test Acc: 0.838
Validation loss decreased (-0.806241 --> -0.837494).  Saving model ...
Epoch: 5 cost time: 1.6704423427581787
Epoch: 5, Steps: 8 | Train Loss: 0.442 Vali Loss: 0.504 Vali Acc: 0.856 Test Loss: 0.504 Test Acc: 0.856
Validation loss decreased (-0.837494 --> -0.856245).  Saving model ...
Epoch: 6 cost time: 1.6252405643463135
Epoch: 6, Steps: 8 | Train Loss: 0.269 Vali Loss: 0.454 Vali Acc: 0.869 Test Loss: 0.454 Test Acc: 0.869
Validation loss decreased (-0.856245 --> -0.868745).  Saving model ...
Epoch: 7 cost time: 1.7167375087738037
Epoch: 7, Steps: 8 | Train Loss: 0.206 Vali Loss: 0.466 Vali Acc: 0.859 Test Loss: 0.466 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.684051752090454
Epoch: 8, Steps: 8 | Train Loss: 0.123 Vali Loss: 0.448 Vali Acc: 0.863 Test Loss: 0.448 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6508405208587646
Epoch: 9, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.460 Vali Acc: 0.866 Test Loss: 0.460 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.705747127532959
Epoch: 10, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.473 Vali Acc: 0.869 Test Loss: 0.473 Test Acc: 0.869
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.9602227210998535
Epoch: 11, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.489 Vali Acc: 0.863 Test Loss: 0.489 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.853830337524414
Epoch: 12, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.492 Vali Acc: 0.869 Test Loss: 0.492 Test Acc: 0.869
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.8096628189086914
Epoch: 13, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.496 Vali Acc: 0.869 Test Loss: 0.496 Test Acc: 0.869
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.753185510635376
Epoch: 14, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.500 Vali Acc: 0.872 Test Loss: 0.500 Test Acc: 0.872
Validation loss decreased (-0.868745 --> -0.871870).  Saving model ...
Epoch: 15 cost time: 1.7629108428955078
Epoch: 15, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.506 Vali Acc: 0.869 Test Loss: 0.506 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7004375457763672
Epoch: 16, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.522 Vali Acc: 0.863 Test Loss: 0.522 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.8393237590789795
Epoch: 17, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.528 Vali Acc: 0.863 Test Loss: 0.528 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.855220079421997
Epoch: 18, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.529 Vali Acc: 0.869 Test Loss: 0.529 Test Acc: 0.869
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.9461784362792969
Epoch: 19, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.541 Vali Acc: 0.866 Test Loss: 0.541 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.9507420063018799
Epoch: 20, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.549 Vali Acc: 0.863 Test Loss: 0.549 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.83921480178833
Epoch: 21, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.549 Vali Acc: 0.866 Test Loss: 0.549 Test Acc: 0.866
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.791271448135376
Epoch: 22, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.552 Vali Acc: 0.866 Test Loss: 0.552 Test Acc: 0.866
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.7685518264770508
Epoch: 23, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.554 Vali Acc: 0.869 Test Loss: 0.554 Test Acc: 0.869
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.7752785682678223
Epoch: 24, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.558 Vali Acc: 0.866 Test Loss: 0.558 Test Acc: 0.866
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 770280
model size : 3.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.5875766277313232
Epoch: 1, Steps: 8 | Train Loss: 1.985 Vali Loss: 1.833 Vali Acc: 0.444 Test Loss: 1.833 Test Acc: 0.444
Validation loss decreased (inf --> -0.443732).  Saving model ...
Epoch: 2 cost time: 2.0915396213531494
Epoch: 2, Steps: 8 | Train Loss: 1.614 Vali Loss: 1.328 Vali Acc: 0.772 Test Loss: 1.328 Test Acc: 0.772
Validation loss decreased (-0.443732 --> -0.771862).  Saving model ...
Epoch: 3 cost time: 2.0503149032592773
Epoch: 3, Steps: 8 | Train Loss: 1.072 Vali Loss: 0.888 Vali Acc: 0.816 Test Loss: 0.888 Test Acc: 0.816
Validation loss decreased (-0.771862 --> -0.815616).  Saving model ...
Epoch: 4 cost time: 1.9612386226654053
Epoch: 4, Steps: 8 | Train Loss: 0.740 Vali Loss: 0.623 Vali Acc: 0.838 Test Loss: 0.623 Test Acc: 0.838
Validation loss decreased (-0.815616 --> -0.837494).  Saving model ...
Epoch: 5 cost time: 1.8982157707214355
Epoch: 5, Steps: 8 | Train Loss: 0.483 Vali Loss: 0.537 Vali Acc: 0.847 Test Loss: 0.537 Test Acc: 0.847
Validation loss decreased (-0.837494 --> -0.846870).  Saving model ...
Epoch: 6 cost time: 2.043977737426758
Epoch: 6, Steps: 8 | Train Loss: 0.359 Vali Loss: 0.495 Vali Acc: 0.844 Test Loss: 0.495 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.16696834564209
Epoch: 7, Steps: 8 | Train Loss: 0.259 Vali Loss: 0.485 Vali Acc: 0.850 Test Loss: 0.485 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 8 cost time: 2.2083957195281982
Epoch: 8, Steps: 8 | Train Loss: 0.170 Vali Loss: 0.492 Vali Acc: 0.856 Test Loss: 0.492 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.856245).  Saving model ...
Epoch: 9 cost time: 2.1680262088775635
Epoch: 9, Steps: 8 | Train Loss: 0.116 Vali Loss: 0.474 Vali Acc: 0.866 Test Loss: 0.474 Test Acc: 0.866
Validation loss decreased (-0.856245 --> -0.865620).  Saving model ...
Epoch: 10 cost time: 2.087156295776367
Epoch: 10, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.479 Vali Acc: 0.863 Test Loss: 0.479 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9842424392700195
Epoch: 11, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.518 Vali Acc: 0.856 Test Loss: 0.518 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.9671247005462646
Epoch: 12, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.500 Vali Acc: 0.869 Test Loss: 0.500 Test Acc: 0.869
Validation loss decreased (-0.865620 --> -0.868745).  Saving model ...
Epoch: 13 cost time: 1.95322585105896
Epoch: 13, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.497 Vali Acc: 0.872 Test Loss: 0.497 Test Acc: 0.872
Validation loss decreased (-0.868745 --> -0.871870).  Saving model ...
Epoch: 14 cost time: 2.0750021934509277
Epoch: 14, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.514 Vali Acc: 0.872 Test Loss: 0.514 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.2299673557281494
Epoch: 15, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.521 Vali Acc: 0.872 Test Loss: 0.521 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.26171875
Epoch: 16, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.535 Vali Acc: 0.872 Test Loss: 0.535 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.190546989440918
Epoch: 17, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.535 Vali Acc: 0.872 Test Loss: 0.535 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.0221362113952637
Epoch: 18, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.537 Vali Acc: 0.869 Test Loss: 0.537 Test Acc: 0.869
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.0103657245635986
Epoch: 19, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.547 Vali Acc: 0.866 Test Loss: 0.547 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.9981749057769775
Epoch: 20, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.558 Vali Acc: 0.872 Test Loss: 0.558 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.051126480102539
Epoch: 21, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.564 Vali Acc: 0.866 Test Loss: 0.564 Test Acc: 0.866
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.1654422283172607
Epoch: 22, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.568 Vali Acc: 0.869 Test Loss: 0.568 Test Acc: 0.869
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.0111324787139893
Epoch: 23, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.573 Vali Acc: 0.866 Test Loss: 0.573 Test Acc: 0.866
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 2425576
model size : 9.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.505250930786133
Epoch: 1, Steps: 8 | Train Loss: 2.076 Vali Loss: 1.859 Vali Acc: 0.359 Test Loss: 1.859 Test Acc: 0.359
Validation loss decreased (inf --> -0.359356).  Saving model ...
Epoch: 2 cost time: 1.195000410079956
Epoch: 2, Steps: 8 | Train Loss: 1.699 Vali Loss: 1.359 Vali Acc: 0.772 Test Loss: 1.359 Test Acc: 0.772
Validation loss decreased (-0.359356 --> -0.771861).  Saving model ...
Epoch: 3 cost time: 1.165762186050415
Epoch: 3, Steps: 8 | Train Loss: 1.170 Vali Loss: 0.911 Vali Acc: 0.803 Test Loss: 0.911 Test Acc: 0.803
Validation loss decreased (-0.771861 --> -0.803116).  Saving model ...
Epoch: 4 cost time: 1.37266206741333
Epoch: 4, Steps: 8 | Train Loss: 0.733 Vali Loss: 0.642 Vali Acc: 0.828 Test Loss: 0.642 Test Acc: 0.828
Validation loss decreased (-0.803116 --> -0.828119).  Saving model ...
Epoch: 5 cost time: 1.3417465686798096
Epoch: 5, Steps: 8 | Train Loss: 0.467 Vali Loss: 0.521 Vali Acc: 0.859 Test Loss: 0.521 Test Acc: 0.859
Validation loss decreased (-0.828119 --> -0.859370).  Saving model ...
Epoch: 6 cost time: 1.3577399253845215
Epoch: 6, Steps: 8 | Train Loss: 0.303 Vali Loss: 0.471 Vali Acc: 0.869 Test Loss: 0.471 Test Acc: 0.869
Validation loss decreased (-0.859370 --> -0.868745).  Saving model ...
Epoch: 7 cost time: 1.352895975112915
Epoch: 7, Steps: 8 | Train Loss: 0.231 Vali Loss: 0.493 Vali Acc: 0.850 Test Loss: 0.493 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1174874305725098
Epoch: 8, Steps: 8 | Train Loss: 0.144 Vali Loss: 0.478 Vali Acc: 0.859 Test Loss: 0.478 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1693696975708008
Epoch: 9, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.493 Vali Acc: 0.853 Test Loss: 0.493 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1446645259857178
Epoch: 10, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.501 Vali Acc: 0.853 Test Loss: 0.501 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.20802903175354
Epoch: 11, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.513 Vali Acc: 0.859 Test Loss: 0.513 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.2763230800628662
Epoch: 12, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.517 Vali Acc: 0.863 Test Loss: 0.517 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2709860801696777
Epoch: 13, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.523 Vali Acc: 0.863 Test Loss: 0.523 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.3780968189239502
Epoch: 14, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.532 Vali Acc: 0.863 Test Loss: 0.532 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.4206666946411133
Epoch: 15, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.544 Vali Acc: 0.859 Test Loss: 0.544 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.3218183517456055
Epoch: 16, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.563 Vali Acc: 0.850 Test Loss: 0.563 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 770280
model size : 3.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 6.04901385307312
Epoch: 1, Steps: 8 | Train Loss: 2.012 Vali Loss: 1.928 Vali Acc: 0.353 Test Loss: 1.928 Test Acc: 0.353
Validation loss decreased (inf --> -0.353106).  Saving model ...
Epoch: 2 cost time: 5.085372686386108
Epoch: 2, Steps: 8 | Train Loss: 1.788 Vali Loss: 1.620 Vali Acc: 0.609 Test Loss: 1.620 Test Acc: 0.609
Validation loss decreased (-0.353106 --> -0.609359).  Saving model ...
Epoch: 3 cost time: 5.467210054397583
Epoch: 3, Steps: 8 | Train Loss: 1.469 Vali Loss: 1.279 Vali Acc: 0.734 Test Loss: 1.279 Test Acc: 0.734
Validation loss decreased (-0.609359 --> -0.734362).  Saving model ...
Epoch: 4 cost time: 4.766225814819336
Epoch: 4, Steps: 8 | Train Loss: 1.107 Vali Loss: 0.988 Vali Acc: 0.778 Test Loss: 0.988 Test Acc: 0.778
Validation loss decreased (-0.734362 --> -0.778115).  Saving model ...
Epoch: 5 cost time: 4.654091119766235
Epoch: 5, Steps: 8 | Train Loss: 0.809 Vali Loss: 0.778 Vali Acc: 0.803 Test Loss: 0.778 Test Acc: 0.803
Validation loss decreased (-0.778115 --> -0.803117).  Saving model ...
Epoch: 6 cost time: 5.0738701820373535
Epoch: 6, Steps: 8 | Train Loss: 0.608 Vali Loss: 0.627 Vali Acc: 0.831 Test Loss: 0.627 Test Acc: 0.831
Validation loss decreased (-0.803117 --> -0.831244).  Saving model ...
Epoch: 7 cost time: 5.40250825881958
Epoch: 7, Steps: 8 | Train Loss: 0.463 Vali Loss: 0.547 Vali Acc: 0.831 Test Loss: 0.547 Test Acc: 0.831
Validation loss decreased (-0.831244 --> -0.831245).  Saving model ...
Epoch: 8 cost time: 4.878011465072632
Epoch: 8, Steps: 8 | Train Loss: 0.352 Vali Loss: 0.493 Vali Acc: 0.853 Test Loss: 0.493 Test Acc: 0.853
Validation loss decreased (-0.831245 --> -0.853120).  Saving model ...
Epoch: 9 cost time: 4.847407102584839
Epoch: 9, Steps: 8 | Train Loss: 0.258 Vali Loss: 0.468 Vali Acc: 0.859 Test Loss: 0.468 Test Acc: 0.859
Validation loss decreased (-0.853120 --> -0.859370).  Saving model ...
Epoch: 10 cost time: 5.100996017456055
Epoch: 10, Steps: 8 | Train Loss: 0.183 Vali Loss: 0.474 Vali Acc: 0.856 Test Loss: 0.474 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.348954439163208
Epoch: 11, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.465 Vali Acc: 0.853 Test Loss: 0.465 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.077540874481201
Epoch: 12, Steps: 8 | Train Loss: 0.104 Vali Loss: 0.459 Vali Acc: 0.856 Test Loss: 0.459 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.871756315231323
Epoch: 13, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.461 Vali Acc: 0.856 Test Loss: 0.461 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.144730091094971
Epoch: 14, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.465 Vali Acc: 0.859 Test Loss: 0.465 Test Acc: 0.859
Validation loss decreased (-0.859370 --> -0.859370).  Saving model ...
Epoch: 15 cost time: 5.2080934047698975
Epoch: 15, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.472 Vali Acc: 0.856 Test Loss: 0.472 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.12532377243042
Epoch: 16, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.488 Vali Acc: 0.850 Test Loss: 0.488 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.772830247879028
Epoch: 17, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.498 Vali Acc: 0.850 Test Loss: 0.498 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.199117183685303
Epoch: 18, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.502 Vali Acc: 0.850 Test Loss: 0.502 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 5.133862733840942
Epoch: 19, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.501 Vali Acc: 0.850 Test Loss: 0.501 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 5.051700830459595
Epoch: 20, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.514 Vali Acc: 0.853 Test Loss: 0.514 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.3180108070373535
Epoch: 21, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.536 Vali Acc: 0.850 Test Loss: 0.536 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 5.728874921798706
Epoch: 22, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.538 Vali Acc: 0.850 Test Loss: 0.538 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 5.7290709018707275
Epoch: 23, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.542 Vali Acc: 0.850 Test Loss: 0.542 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 5.7568323612213135
Epoch: 24, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.551 Vali Acc: 0.853 Test Loss: 0.551 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 2385400
model size : 9.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.957172155380249
Epoch: 1, Steps: 8 | Train Loss: 2.172 Vali Loss: 2.030 Vali Acc: 0.159 Test Loss: 2.030 Test Acc: 0.159
Validation loss decreased (inf --> -0.159355).  Saving model ...
Epoch: 2 cost time: 3.570438861846924
Epoch: 2, Steps: 8 | Train Loss: 1.887 Vali Loss: 1.746 Vali Acc: 0.481 Test Loss: 1.746 Test Acc: 0.481
Validation loss decreased (-0.159355 --> -0.481233).  Saving model ...
Epoch: 3 cost time: 3.556462049484253
Epoch: 3, Steps: 8 | Train Loss: 1.577 Vali Loss: 1.407 Vali Acc: 0.694 Test Loss: 1.407 Test Acc: 0.694
Validation loss decreased (-0.481233 --> -0.693736).  Saving model ...
Epoch: 4 cost time: 3.5095551013946533
Epoch: 4, Steps: 8 | Train Loss: 1.218 Vali Loss: 1.092 Vali Acc: 0.762 Test Loss: 1.092 Test Acc: 0.762
Validation loss decreased (-0.693736 --> -0.762489).  Saving model ...
Epoch: 5 cost time: 3.4446780681610107
Epoch: 5, Steps: 8 | Train Loss: 0.913 Vali Loss: 0.862 Vali Acc: 0.791 Test Loss: 0.862 Test Acc: 0.791
Validation loss decreased (-0.762489 --> -0.790616).  Saving model ...
Epoch: 6 cost time: 3.7245540618896484
Epoch: 6, Steps: 8 | Train Loss: 0.661 Vali Loss: 0.704 Vali Acc: 0.806 Test Loss: 0.704 Test Acc: 0.806
Validation loss decreased (-0.790616 --> -0.806243).  Saving model ...
Epoch: 7 cost time: 3.656989574432373
Epoch: 7, Steps: 8 | Train Loss: 0.497 Vali Loss: 0.614 Vali Acc: 0.825 Test Loss: 0.614 Test Acc: 0.825
Validation loss decreased (-0.806243 --> -0.824994).  Saving model ...
Epoch: 8 cost time: 3.380701780319214
Epoch: 8, Steps: 8 | Train Loss: 0.365 Vali Loss: 0.558 Vali Acc: 0.831 Test Loss: 0.558 Test Acc: 0.831
Validation loss decreased (-0.824994 --> -0.831244).  Saving model ...
Epoch: 9 cost time: 3.576486349105835
Epoch: 9, Steps: 8 | Train Loss: 0.277 Vali Loss: 0.544 Vali Acc: 0.816 Test Loss: 0.544 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.5765221118927
Epoch: 10, Steps: 8 | Train Loss: 0.217 Vali Loss: 0.527 Vali Acc: 0.831 Test Loss: 0.527 Test Acc: 0.831
Validation loss decreased (-0.831244 --> -0.831245).  Saving model ...
Epoch: 11 cost time: 3.6329474449157715
Epoch: 11, Steps: 8 | Train Loss: 0.165 Vali Loss: 0.526 Vali Acc: 0.834 Test Loss: 0.526 Test Acc: 0.834
Validation loss decreased (-0.831245 --> -0.834370).  Saving model ...
Epoch: 12 cost time: 3.535034418106079
Epoch: 12, Steps: 8 | Train Loss: 0.123 Vali Loss: 0.532 Vali Acc: 0.831 Test Loss: 0.532 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.51762318611145
Epoch: 13, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.536 Vali Acc: 0.834 Test Loss: 0.536 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.338980197906494
Epoch: 14, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.542 Vali Acc: 0.838 Test Loss: 0.542 Test Acc: 0.838
Validation loss decreased (-0.834370 --> -0.837495).  Saving model ...
Epoch: 15 cost time: 3.3227248191833496
Epoch: 15, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.550 Vali Acc: 0.838 Test Loss: 0.550 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.337198257446289
Epoch: 16, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.552 Vali Acc: 0.853 Test Loss: 0.552 Test Acc: 0.853
Validation loss decreased (-0.837495 --> -0.853119).  Saving model ...
Epoch: 17 cost time: 3.345790147781372
Epoch: 17, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.560 Vali Acc: 0.844 Test Loss: 0.560 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.7764511108398438
Epoch: 18, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.565 Vali Acc: 0.844 Test Loss: 0.565 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.7880775928497314
Epoch: 19, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.572 Vali Acc: 0.850 Test Loss: 0.572 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.645488739013672
Epoch: 20, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.562 Vali Acc: 0.859 Test Loss: 0.562 Test Acc: 0.859
Validation loss decreased (-0.853119 --> -0.859369).  Saving model ...
Epoch: 21 cost time: 3.4832637310028076
Epoch: 21, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.568 Vali Acc: 0.859 Test Loss: 0.568 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.4041199684143066
Epoch: 22, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.586 Vali Acc: 0.856 Test Loss: 0.586 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.6564056873321533
Epoch: 23, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.585 Vali Acc: 0.866 Test Loss: 0.585 Test Acc: 0.866
Validation loss decreased (-0.859369 --> -0.865619).  Saving model ...
Epoch: 24 cost time: 3.8454766273498535
Epoch: 24, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.588 Vali Acc: 0.856 Test Loss: 0.588 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.749953031539917
Epoch: 25, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.584 Vali Acc: 0.859 Test Loss: 0.584 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.6380488872528076
Epoch: 26, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.592 Vali Acc: 0.859 Test Loss: 0.592 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.375211238861084
Epoch: 27, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.601 Vali Acc: 0.856 Test Loss: 0.601 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.413445472717285
Epoch: 28, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.610 Vali Acc: 0.853 Test Loss: 0.610 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.6420085430145264
Epoch: 29, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.624 Vali Acc: 0.853 Test Loss: 0.624 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.9611470699310303
Epoch: 30, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.629 Vali Acc: 0.853 Test Loss: 0.629 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 729976
model size : 3.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.735552787780762
Epoch: 1, Steps: 8 | Train Loss: 2.015 Vali Loss: 1.932 Vali Acc: 0.353 Test Loss: 1.932 Test Acc: 0.353
Validation loss decreased (inf --> -0.353106).  Saving model ...
Epoch: 2 cost time: 4.3203284740448
Epoch: 2, Steps: 8 | Train Loss: 1.799 Vali Loss: 1.640 Vali Acc: 0.584 Test Loss: 1.640 Test Acc: 0.584
Validation loss decreased (-0.353106 --> -0.584359).  Saving model ...
Epoch: 3 cost time: 4.650741100311279
Epoch: 3, Steps: 8 | Train Loss: 1.484 Vali Loss: 1.313 Vali Acc: 0.734 Test Loss: 1.313 Test Acc: 0.734
Validation loss decreased (-0.584359 --> -0.734362).  Saving model ...
Epoch: 4 cost time: 5.108750581741333
Epoch: 4, Steps: 8 | Train Loss: 1.131 Vali Loss: 1.029 Vali Acc: 0.775 Test Loss: 1.029 Test Acc: 0.775
Validation loss decreased (-0.734362 --> -0.774990).  Saving model ...
Epoch: 5 cost time: 4.6248955726623535
Epoch: 5, Steps: 8 | Train Loss: 0.831 Vali Loss: 0.817 Vali Acc: 0.797 Test Loss: 0.817 Test Acc: 0.797
Validation loss decreased (-0.774990 --> -0.796867).  Saving model ...
Epoch: 6 cost time: 4.409933567047119
Epoch: 6, Steps: 8 | Train Loss: 0.623 Vali Loss: 0.660 Vali Acc: 0.825 Test Loss: 0.660 Test Acc: 0.825
Validation loss decreased (-0.796867 --> -0.824993).  Saving model ...
Epoch: 7 cost time: 4.610888957977295
Epoch: 7, Steps: 8 | Train Loss: 0.471 Vali Loss: 0.573 Vali Acc: 0.834 Test Loss: 0.573 Test Acc: 0.834
Validation loss decreased (-0.824993 --> -0.834369).  Saving model ...
Epoch: 8 cost time: 4.948583364486694
Epoch: 8, Steps: 8 | Train Loss: 0.358 Vali Loss: 0.515 Vali Acc: 0.850 Test Loss: 0.515 Test Acc: 0.850
Validation loss decreased (-0.834369 --> -0.849995).  Saving model ...
Epoch: 9 cost time: 4.657919645309448
Epoch: 9, Steps: 8 | Train Loss: 0.260 Vali Loss: 0.492 Vali Acc: 0.847 Test Loss: 0.492 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.349914073944092
Epoch: 10, Steps: 8 | Train Loss: 0.185 Vali Loss: 0.502 Vali Acc: 0.844 Test Loss: 0.502 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.273401737213135
Epoch: 11, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.489 Vali Acc: 0.844 Test Loss: 0.489 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.699086427688599
Epoch: 12, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.484 Vali Acc: 0.853 Test Loss: 0.484 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 13 cost time: 4.806723356246948
Epoch: 13, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.488 Vali Acc: 0.856 Test Loss: 0.488 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 14 cost time: 4.7667036056518555
Epoch: 14, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.489 Vali Acc: 0.853 Test Loss: 0.489 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.366177320480347
Epoch: 15, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.492 Vali Acc: 0.859 Test Loss: 0.492 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 16 cost time: 3.8463165760040283
Epoch: 16, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.506 Vali Acc: 0.853 Test Loss: 0.506 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.242067098617554
Epoch: 17, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.511 Vali Acc: 0.853 Test Loss: 0.511 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.4942522048950195
Epoch: 18, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.517 Vali Acc: 0.856 Test Loss: 0.517 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.067901611328125
Epoch: 19, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.517 Vali Acc: 0.859 Test Loss: 0.517 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.9404993057250977
Epoch: 20, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.526 Vali Acc: 0.859 Test Loss: 0.526 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.229233741760254
Epoch: 21, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.547 Vali Acc: 0.856 Test Loss: 0.547 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.464771032333374
Epoch: 22, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.548 Vali Acc: 0.850 Test Loss: 0.548 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.216266393661499
Epoch: 23, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.551 Vali Acc: 0.853 Test Loss: 0.551 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.903374195098877
Epoch: 24, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.558 Vali Acc: 0.856 Test Loss: 0.558 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.8958401679992676
Epoch: 25, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.565 Vali Acc: 0.863 Test Loss: 0.565 Test Acc: 0.863
Validation loss decreased (-0.859370 --> -0.862494).  Saving model ...
Epoch: 26 cost time: 4.2212231159210205
Epoch: 26, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.559 Vali Acc: 0.863 Test Loss: 0.559 Test Acc: 0.863
Validation loss decreased (-0.862494 --> -0.862494).  Saving model ...
Epoch: 27 cost time: 4.489684581756592
Epoch: 27, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.569 Vali Acc: 0.859 Test Loss: 0.569 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.160504341125488
Epoch: 28, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.585 Vali Acc: 0.859 Test Loss: 0.585 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.891580820083618
Epoch: 29, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.593 Vali Acc: 0.859 Test Loss: 0.593 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.97658371925354
Epoch: 30, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.598 Vali Acc: 0.863 Test Loss: 0.598 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 2385400
model size : 9.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.334235668182373
Epoch: 1, Steps: 8 | Train Loss: 2.173 Vali Loss: 2.030 Vali Acc: 0.156 Test Loss: 2.030 Test Acc: 0.156
Validation loss decreased (inf --> -0.156230).  Saving model ...
Epoch: 2 cost time: 2.5832033157348633
Epoch: 2, Steps: 8 | Train Loss: 1.886 Vali Loss: 1.746 Vali Acc: 0.475 Test Loss: 1.746 Test Acc: 0.475
Validation loss decreased (-0.156230 --> -0.474983).  Saving model ...
Epoch: 3 cost time: 2.6236040592193604
Epoch: 3, Steps: 8 | Train Loss: 1.576 Vali Loss: 1.408 Vali Acc: 0.694 Test Loss: 1.408 Test Acc: 0.694
Validation loss decreased (-0.474983 --> -0.693736).  Saving model ...
Epoch: 4 cost time: 2.533827304840088
Epoch: 4, Steps: 8 | Train Loss: 1.217 Vali Loss: 1.094 Vali Acc: 0.772 Test Loss: 1.094 Test Acc: 0.772
Validation loss decreased (-0.693736 --> -0.771864).  Saving model ...
Epoch: 5 cost time: 2.814291000366211
Epoch: 5, Steps: 8 | Train Loss: 0.913 Vali Loss: 0.865 Vali Acc: 0.797 Test Loss: 0.865 Test Acc: 0.797
Validation loss decreased (-0.771864 --> -0.796866).  Saving model ...
Epoch: 6 cost time: 2.9628536701202393
Epoch: 6, Steps: 8 | Train Loss: 0.658 Vali Loss: 0.707 Vali Acc: 0.816 Test Loss: 0.707 Test Acc: 0.816
Validation loss decreased (-0.796866 --> -0.815618).  Saving model ...
Epoch: 7 cost time: 2.838395595550537
Epoch: 7, Steps: 8 | Train Loss: 0.496 Vali Loss: 0.619 Vali Acc: 0.825 Test Loss: 0.619 Test Acc: 0.825
Validation loss decreased (-0.815618 --> -0.824994).  Saving model ...
Epoch: 8 cost time: 2.582151412963867
Epoch: 8, Steps: 8 | Train Loss: 0.360 Vali Loss: 0.563 Vali Acc: 0.831 Test Loss: 0.563 Test Acc: 0.831
Validation loss decreased (-0.824994 --> -0.831244).  Saving model ...
Epoch: 9 cost time: 2.622147560119629
Epoch: 9, Steps: 8 | Train Loss: 0.274 Vali Loss: 0.551 Vali Acc: 0.809 Test Loss: 0.551 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.5965073108673096
Epoch: 10, Steps: 8 | Train Loss: 0.216 Vali Loss: 0.537 Vali Acc: 0.825 Test Loss: 0.537 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.667816400527954
Epoch: 11, Steps: 8 | Train Loss: 0.163 Vali Loss: 0.538 Vali Acc: 0.828 Test Loss: 0.538 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.7420387268066406
Epoch: 12, Steps: 8 | Train Loss: 0.122 Vali Loss: 0.544 Vali Acc: 0.828 Test Loss: 0.544 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.4918384552001953
Epoch: 13, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.549 Vali Acc: 0.828 Test Loss: 0.549 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.912630081176758
Epoch: 14, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.557 Vali Acc: 0.825 Test Loss: 0.557 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.6361210346221924
Epoch: 15, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.566 Vali Acc: 0.825 Test Loss: 0.566 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.417100667953491
Epoch: 16, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.567 Vali Acc: 0.844 Test Loss: 0.567 Test Acc: 0.844
Validation loss decreased (-0.831244 --> -0.843744).  Saving model ...
Epoch: 17 cost time: 2.571166515350342
Epoch: 17, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.576 Vali Acc: 0.838 Test Loss: 0.576 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.7965760231018066
Epoch: 18, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.580 Vali Acc: 0.841 Test Loss: 0.580 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.832845449447632
Epoch: 19, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.587 Vali Acc: 0.841 Test Loss: 0.587 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.8238890171051025
Epoch: 20, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.578 Vali Acc: 0.847 Test Loss: 0.578 Test Acc: 0.847
Validation loss decreased (-0.843744 --> -0.846869).  Saving model ...
Epoch: 21 cost time: 2.6263298988342285
Epoch: 21, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.584 Vali Acc: 0.850 Test Loss: 0.584 Test Acc: 0.850
Validation loss decreased (-0.846869 --> -0.849994).  Saving model ...
Epoch: 22 cost time: 2.487576961517334
Epoch: 22, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.602 Vali Acc: 0.850 Test Loss: 0.602 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.598040819168091
Epoch: 23, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.601 Vali Acc: 0.853 Test Loss: 0.601 Test Acc: 0.853
Validation loss decreased (-0.849994 --> -0.853119).  Saving model ...
Epoch: 24 cost time: 2.7312638759613037
Epoch: 24, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.605 Vali Acc: 0.850 Test Loss: 0.605 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.9517030715942383
Epoch: 25, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.601 Vali Acc: 0.853 Test Loss: 0.601 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.915389060974121
Epoch: 26, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.610 Vali Acc: 0.853 Test Loss: 0.610 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.5273542404174805
Epoch: 27, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.619 Vali Acc: 0.853 Test Loss: 0.619 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.4704339504241943
Epoch: 28, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.629 Vali Acc: 0.850 Test Loss: 0.629 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.781270980834961
Epoch: 29, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.644 Vali Acc: 0.850 Test Loss: 0.644 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.0303447246551514
Epoch: 30, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.649 Vali Acc: 0.850 Test Loss: 0.649 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 729976
model size : 3.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.7991950511932373
Epoch: 1, Steps: 8 | Train Loss: 2.017 Vali Loss: 1.935 Vali Acc: 0.353 Test Loss: 1.935 Test Acc: 0.353
Validation loss decreased (inf --> -0.353106).  Saving model ...
Epoch: 2 cost time: 2.133396625518799
Epoch: 2, Steps: 8 | Train Loss: 1.808 Vali Loss: 1.655 Vali Acc: 0.581 Test Loss: 1.655 Test Acc: 0.581
Validation loss decreased (-0.353106 --> -0.581233).  Saving model ...
Epoch: 3 cost time: 2.126498222351074
Epoch: 3, Steps: 8 | Train Loss: 1.507 Vali Loss: 1.339 Vali Acc: 0.731 Test Loss: 1.339 Test Acc: 0.731
Validation loss decreased (-0.581233 --> -0.731237).  Saving model ...
Epoch: 4 cost time: 2.2182226181030273
Epoch: 4, Steps: 8 | Train Loss: 1.154 Vali Loss: 1.059 Vali Acc: 0.762 Test Loss: 1.059 Test Acc: 0.762
Validation loss decreased (-0.731237 --> -0.762489).  Saving model ...
Epoch: 5 cost time: 2.415275812149048
Epoch: 5, Steps: 8 | Train Loss: 0.859 Vali Loss: 0.846 Vali Acc: 0.794 Test Loss: 0.846 Test Acc: 0.794
Validation loss decreased (-0.762489 --> -0.793742).  Saving model ...
Epoch: 6 cost time: 2.3592631816864014
Epoch: 6, Steps: 8 | Train Loss: 0.650 Vali Loss: 0.687 Vali Acc: 0.819 Test Loss: 0.687 Test Acc: 0.819
Validation loss decreased (-0.793742 --> -0.818743).  Saving model ...
Epoch: 7 cost time: 2.2516984939575195
Epoch: 7, Steps: 8 | Train Loss: 0.502 Vali Loss: 0.600 Vali Acc: 0.828 Test Loss: 0.600 Test Acc: 0.828
Validation loss decreased (-0.818743 --> -0.828119).  Saving model ...
Epoch: 8 cost time: 2.073775291442871
Epoch: 8, Steps: 8 | Train Loss: 0.402 Vali Loss: 0.544 Vali Acc: 0.834 Test Loss: 0.544 Test Acc: 0.834
Validation loss decreased (-0.828119 --> -0.834370).  Saving model ...
Epoch: 9 cost time: 2.1968884468078613
Epoch: 9, Steps: 8 | Train Loss: 0.311 Vali Loss: 0.519 Vali Acc: 0.844 Test Loss: 0.519 Test Acc: 0.844
Validation loss decreased (-0.834370 --> -0.843745).  Saving model ...
Epoch: 10 cost time: 2.2970972061157227
Epoch: 10, Steps: 8 | Train Loss: 0.244 Vali Loss: 0.526 Vali Acc: 0.838 Test Loss: 0.526 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.2249295711517334
Epoch: 11, Steps: 8 | Train Loss: 0.164 Vali Loss: 0.513 Vali Acc: 0.850 Test Loss: 0.513 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849995).  Saving model ...
Epoch: 12 cost time: 2.308882713317871
Epoch: 12, Steps: 8 | Train Loss: 0.133 Vali Loss: 0.507 Vali Acc: 0.856 Test Loss: 0.507 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.856245).  Saving model ...
Epoch: 13 cost time: 2.343808889389038
Epoch: 13, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.506 Vali Acc: 0.853 Test Loss: 0.506 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.3481647968292236
Epoch: 14, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.509 Vali Acc: 0.853 Test Loss: 0.509 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.3113768100738525
Epoch: 15, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.512 Vali Acc: 0.856 Test Loss: 0.512 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.2887771129608154
Epoch: 16, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.525 Vali Acc: 0.856 Test Loss: 0.525 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.191434144973755
Epoch: 17, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.534 Vali Acc: 0.859 Test Loss: 0.534 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 18 cost time: 2.1568520069122314
Epoch: 18, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.536 Vali Acc: 0.856 Test Loss: 0.536 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.3259236812591553
Epoch: 19, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.538 Vali Acc: 0.859 Test Loss: 0.538 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.43949031829834
Epoch: 20, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.547 Vali Acc: 0.853 Test Loss: 0.547 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.3382508754730225
Epoch: 21, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.569 Vali Acc: 0.853 Test Loss: 0.569 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.2854743003845215
Epoch: 22, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.573 Vali Acc: 0.850 Test Loss: 0.573 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.1893227100372314
Epoch: 23, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.578 Vali Acc: 0.853 Test Loss: 0.578 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.1587116718292236
Epoch: 24, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.588 Vali Acc: 0.850 Test Loss: 0.588 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.164052724838257
Epoch: 25, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.598 Vali Acc: 0.853 Test Loss: 0.598 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.456804037094116
Epoch: 26, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.592 Vali Acc: 0.853 Test Loss: 0.592 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.409550428390503
Epoch: 27, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.603 Vali Acc: 0.850 Test Loss: 0.603 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 2385400
model size : 9.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.6493804454803467
Epoch: 1, Steps: 8 | Train Loss: 2.170 Vali Loss: 2.031 Vali Acc: 0.156 Test Loss: 2.031 Test Acc: 0.156
Validation loss decreased (inf --> -0.156230).  Saving model ...
Epoch: 2 cost time: 1.447767972946167
Epoch: 2, Steps: 8 | Train Loss: 1.891 Vali Loss: 1.755 Vali Acc: 0.450 Test Loss: 1.755 Test Acc: 0.450
Validation loss decreased (-0.156230 --> -0.449982).  Saving model ...
Epoch: 3 cost time: 1.459968090057373
Epoch: 3, Steps: 8 | Train Loss: 1.591 Vali Loss: 1.427 Vali Acc: 0.684 Test Loss: 1.427 Test Acc: 0.684
Validation loss decreased (-0.449982 --> -0.684361).  Saving model ...
Epoch: 4 cost time: 1.6013758182525635
Epoch: 4, Steps: 8 | Train Loss: 1.244 Vali Loss: 1.119 Vali Acc: 0.769 Test Loss: 1.119 Test Acc: 0.769
Validation loss decreased (-0.684361 --> -0.768739).  Saving model ...
Epoch: 5 cost time: 1.6214666366577148
Epoch: 5, Steps: 8 | Train Loss: 0.945 Vali Loss: 0.894 Vali Acc: 0.775 Test Loss: 0.894 Test Acc: 0.775
Validation loss decreased (-0.768739 --> -0.774991).  Saving model ...
Epoch: 6 cost time: 1.4995038509368896
Epoch: 6, Steps: 8 | Train Loss: 0.710 Vali Loss: 0.736 Vali Acc: 0.800 Test Loss: 0.736 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799993).  Saving model ...
Epoch: 7 cost time: 1.5006752014160156
Epoch: 7, Steps: 8 | Train Loss: 0.548 Vali Loss: 0.650 Vali Acc: 0.812 Test Loss: 0.650 Test Acc: 0.812
Validation loss decreased (-0.799993 --> -0.812494).  Saving model ...
Epoch: 8 cost time: 1.396338701248169
Epoch: 8, Steps: 8 | Train Loss: 0.417 Vali Loss: 0.593 Vali Acc: 0.819 Test Loss: 0.593 Test Acc: 0.819
Validation loss decreased (-0.812494 --> -0.818744).  Saving model ...
Epoch: 9 cost time: 1.4639561176300049
Epoch: 9, Steps: 8 | Train Loss: 0.330 Vali Loss: 0.578 Vali Acc: 0.812 Test Loss: 0.578 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.542602777481079
Epoch: 10, Steps: 8 | Train Loss: 0.269 Vali Loss: 0.563 Vali Acc: 0.825 Test Loss: 0.563 Test Acc: 0.825
Validation loss decreased (-0.818744 --> -0.824994).  Saving model ...
Epoch: 11 cost time: 1.553856611251831
Epoch: 11, Steps: 8 | Train Loss: 0.203 Vali Loss: 0.568 Vali Acc: 0.812 Test Loss: 0.568 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4629225730895996
Epoch: 12, Steps: 8 | Train Loss: 0.154 Vali Loss: 0.570 Vali Acc: 0.825 Test Loss: 0.570 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3772263526916504
Epoch: 13, Steps: 8 | Train Loss: 0.117 Vali Loss: 0.570 Vali Acc: 0.841 Test Loss: 0.570 Test Acc: 0.841
Validation loss decreased (-0.824994 --> -0.840619).  Saving model ...
Epoch: 14 cost time: 1.3814520835876465
Epoch: 14, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.572 Vali Acc: 0.838 Test Loss: 0.572 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3709452152252197
Epoch: 15, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.583 Vali Acc: 0.841 Test Loss: 0.583 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3045766353607178
Epoch: 16, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.587 Vali Acc: 0.834 Test Loss: 0.587 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3162524700164795
Epoch: 17, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.599 Vali Acc: 0.844 Test Loss: 0.599 Test Acc: 0.844
Validation loss decreased (-0.840619 --> -0.843744).  Saving model ...
Epoch: 18 cost time: 1.516875982284546
Epoch: 18, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.607 Vali Acc: 0.850 Test Loss: 0.607 Test Acc: 0.850
Validation loss decreased (-0.843744 --> -0.849994).  Saving model ...
Epoch: 19 cost time: 1.5797295570373535
Epoch: 19, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.611 Vali Acc: 0.853 Test Loss: 0.611 Test Acc: 0.853
Validation loss decreased (-0.849994 --> -0.853119).  Saving model ...
Epoch: 20 cost time: 1.5023572444915771
Epoch: 20, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.605 Vali Acc: 0.841 Test Loss: 0.605 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3161916732788086
Epoch: 21, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.617 Vali Acc: 0.841 Test Loss: 0.617 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.4442164897918701
Epoch: 22, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.637 Vali Acc: 0.850 Test Loss: 0.637 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.4196357727050781
Epoch: 23, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.635 Vali Acc: 0.847 Test Loss: 0.635 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.4531292915344238
Epoch: 24, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.637 Vali Acc: 0.847 Test Loss: 0.637 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.493638515472412
Epoch: 25, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.633 Vali Acc: 0.850 Test Loss: 0.633 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.4958970546722412
Epoch: 26, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.644 Vali Acc: 0.850 Test Loss: 0.644 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.4103727340698242
Epoch: 27, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.654 Vali Acc: 0.850 Test Loss: 0.654 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.4362115859985352
Epoch: 28, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.664 Vali Acc: 0.844 Test Loss: 0.664 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.350283145904541
Epoch: 29, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.678 Vali Acc: 0.844 Test Loss: 0.678 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 729976
model size : 3.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.575993299484253
Epoch: 1, Steps: 8 | Train Loss: 2.156 Vali Loss: 1.975 Vali Acc: 0.266 Test Loss: 1.975 Test Acc: 0.266
Validation loss decreased (inf --> -0.265605).  Saving model ...
Epoch: 2 cost time: 2.956271171569824
Epoch: 2, Steps: 8 | Train Loss: 1.926 Vali Loss: 1.689 Vali Acc: 0.469 Test Loss: 1.689 Test Acc: 0.469
Validation loss decreased (-0.265605 --> -0.468733).  Saving model ...
Epoch: 3 cost time: 2.945596694946289
Epoch: 3, Steps: 8 | Train Loss: 1.583 Vali Loss: 1.348 Vali Acc: 0.719 Test Loss: 1.348 Test Acc: 0.719
Validation loss decreased (-0.468733 --> -0.718737).  Saving model ...
Epoch: 4 cost time: 2.957446336746216
Epoch: 4, Steps: 8 | Train Loss: 1.247 Vali Loss: 1.050 Vali Acc: 0.772 Test Loss: 1.050 Test Acc: 0.772
Validation loss decreased (-0.718737 --> -0.771865).  Saving model ...
Epoch: 5 cost time: 3.085383176803589
Epoch: 5, Steps: 8 | Train Loss: 0.910 Vali Loss: 0.822 Vali Acc: 0.809 Test Loss: 0.822 Test Acc: 0.809
Validation loss decreased (-0.771865 --> -0.809367).  Saving model ...
Epoch: 6 cost time: 3.0542707443237305
Epoch: 6, Steps: 8 | Train Loss: 0.641 Vali Loss: 0.673 Vali Acc: 0.819 Test Loss: 0.673 Test Acc: 0.819
Validation loss decreased (-0.809367 --> -0.818743).  Saving model ...
Epoch: 7 cost time: 2.7300407886505127
Epoch: 7, Steps: 8 | Train Loss: 0.496 Vali Loss: 0.576 Vali Acc: 0.828 Test Loss: 0.576 Test Acc: 0.828
Validation loss decreased (-0.818743 --> -0.828119).  Saving model ...
Epoch: 8 cost time: 2.596917152404785
Epoch: 8, Steps: 8 | Train Loss: 0.383 Vali Loss: 0.505 Vali Acc: 0.844 Test Loss: 0.505 Test Acc: 0.844
Validation loss decreased (-0.828119 --> -0.843745).  Saving model ...
Epoch: 9 cost time: 2.724823474884033
Epoch: 9, Steps: 8 | Train Loss: 0.289 Vali Loss: 0.470 Vali Acc: 0.856 Test Loss: 0.470 Test Acc: 0.856
Validation loss decreased (-0.843745 --> -0.856245).  Saving model ...
Epoch: 10 cost time: 2.747856378555298
Epoch: 10, Steps: 8 | Train Loss: 0.200 Vali Loss: 0.454 Vali Acc: 0.869 Test Loss: 0.454 Test Acc: 0.869
Validation loss decreased (-0.856245 --> -0.868745).  Saving model ...
Epoch: 11 cost time: 2.828439474105835
Epoch: 11, Steps: 8 | Train Loss: 0.157 Vali Loss: 0.438 Vali Acc: 0.866 Test Loss: 0.438 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.8112823963165283
Epoch: 12, Steps: 8 | Train Loss: 0.109 Vali Loss: 0.442 Vali Acc: 0.866 Test Loss: 0.442 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.5328938961029053
Epoch: 13, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.452 Vali Acc: 0.866 Test Loss: 0.452 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.7228610515594482
Epoch: 14, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.443 Vali Acc: 0.863 Test Loss: 0.443 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.927271604537964
Epoch: 15, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.427 Vali Acc: 0.878 Test Loss: 0.427 Test Acc: 0.878
Validation loss decreased (-0.868745 --> -0.878121).  Saving model ...
Epoch: 16 cost time: 2.8320391178131104
Epoch: 16, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.435 Vali Acc: 0.878 Test Loss: 0.435 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.5749261379241943
Epoch: 17, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.445 Vali Acc: 0.869 Test Loss: 0.445 Test Acc: 0.869
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.7015490531921387
Epoch: 18, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.466 Vali Acc: 0.859 Test Loss: 0.466 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.869600534439087
Epoch: 19, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.466 Vali Acc: 0.866 Test Loss: 0.466 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.762868642807007
Epoch: 20, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.470 Vali Acc: 0.863 Test Loss: 0.470 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.683677911758423
Epoch: 21, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.470 Vali Acc: 0.866 Test Loss: 0.470 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.5325868129730225
Epoch: 22, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.477 Vali Acc: 0.863 Test Loss: 0.477 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.7434463500976562
Epoch: 23, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.482 Vali Acc: 0.859 Test Loss: 0.482 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.5513384342193604
Epoch: 24, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.486 Vali Acc: 0.856 Test Loss: 0.486 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.707688808441162
Epoch: 25, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.491 Vali Acc: 0.856 Test Loss: 0.491 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.878125
model parameter : 1213176
model size : 4.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.3031816482543945
Epoch: 1, Steps: 8 | Train Loss: 2.070 Vali Loss: 2.026 Vali Acc: 0.284 Test Loss: 2.026 Test Acc: 0.284
Validation loss decreased (inf --> -0.284355).  Saving model ...
Epoch: 2 cost time: 1.6214632987976074
Epoch: 2, Steps: 8 | Train Loss: 1.887 Vali Loss: 1.741 Vali Acc: 0.522 Test Loss: 1.741 Test Acc: 0.522
Validation loss decreased (-0.284355 --> -0.521858).  Saving model ...
Epoch: 3 cost time: 1.8462917804718018
Epoch: 3, Steps: 8 | Train Loss: 1.555 Vali Loss: 1.390 Vali Acc: 0.731 Test Loss: 1.390 Test Acc: 0.731
Validation loss decreased (-0.521858 --> -0.731236).  Saving model ...
Epoch: 4 cost time: 1.7430646419525146
Epoch: 4, Steps: 8 | Train Loss: 1.180 Vali Loss: 1.065 Vali Acc: 0.775 Test Loss: 1.065 Test Acc: 0.775
Validation loss decreased (-0.731236 --> -0.774989).  Saving model ...
Epoch: 5 cost time: 1.8394296169281006
Epoch: 5, Steps: 8 | Train Loss: 0.843 Vali Loss: 0.822 Vali Acc: 0.822 Test Loss: 0.822 Test Acc: 0.822
Validation loss decreased (-0.774989 --> -0.821867).  Saving model ...
Epoch: 6 cost time: 1.6712636947631836
Epoch: 6, Steps: 8 | Train Loss: 0.581 Vali Loss: 0.656 Vali Acc: 0.850 Test Loss: 0.656 Test Acc: 0.850
Validation loss decreased (-0.821867 --> -0.849993).  Saving model ...
Epoch: 7 cost time: 1.570319652557373
Epoch: 7, Steps: 8 | Train Loss: 0.442 Vali Loss: 0.560 Vali Acc: 0.853 Test Loss: 0.560 Test Acc: 0.853
Validation loss decreased (-0.849993 --> -0.853119).  Saving model ...
Epoch: 8 cost time: 1.6943790912628174
Epoch: 8, Steps: 8 | Train Loss: 0.331 Vali Loss: 0.510 Vali Acc: 0.859 Test Loss: 0.510 Test Acc: 0.859
Validation loss decreased (-0.853119 --> -0.859370).  Saving model ...
Epoch: 9 cost time: 1.9103169441223145
Epoch: 9, Steps: 8 | Train Loss: 0.263 Vali Loss: 0.489 Vali Acc: 0.859 Test Loss: 0.489 Test Acc: 0.859
Validation loss decreased (-0.859370 --> -0.859370).  Saving model ...
Epoch: 10 cost time: 1.7156693935394287
Epoch: 10, Steps: 8 | Train Loss: 0.178 Vali Loss: 0.487 Vali Acc: 0.853 Test Loss: 0.487 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8160300254821777
Epoch: 11, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.483 Vali Acc: 0.856 Test Loss: 0.483 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6839251518249512
Epoch: 12, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.473 Vali Acc: 0.859 Test Loss: 0.473 Test Acc: 0.859
Validation loss decreased (-0.859370 --> -0.859370).  Saving model ...
Epoch: 13 cost time: 1.6095404624938965
Epoch: 13, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.473 Vali Acc: 0.856 Test Loss: 0.473 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.71586012840271
Epoch: 14, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.473 Vali Acc: 0.856 Test Loss: 0.473 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.793583869934082
Epoch: 15, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.479 Vali Acc: 0.859 Test Loss: 0.479 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.793837547302246
Epoch: 16, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.486 Vali Acc: 0.859 Test Loss: 0.486 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.7917513847351074
Epoch: 17, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.498 Vali Acc: 0.859 Test Loss: 0.498 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.791916847229004
Epoch: 18, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.485 Vali Acc: 0.866 Test Loss: 0.485 Test Acc: 0.866
Validation loss decreased (-0.859370 --> -0.865620).  Saving model ...
Epoch: 19 cost time: 1.6680669784545898
Epoch: 19, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.491 Vali Acc: 0.869 Test Loss: 0.491 Test Acc: 0.869
Validation loss decreased (-0.865620 --> -0.868745).  Saving model ...
Epoch: 20 cost time: 1.6032004356384277
Epoch: 20, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.506 Vali Acc: 0.866 Test Loss: 0.506 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.706871509552002
Epoch: 21, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.514 Vali Acc: 0.859 Test Loss: 0.514 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.7398695945739746
Epoch: 22, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.532 Vali Acc: 0.853 Test Loss: 0.532 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.6952438354492188
Epoch: 23, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.534 Vali Acc: 0.856 Test Loss: 0.534 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.5804550647735596
Epoch: 24, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.536 Vali Acc: 0.859 Test Loss: 0.536 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.6483588218688965
Epoch: 25, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.538 Vali Acc: 0.856 Test Loss: 0.538 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.8805263042449951
Epoch: 26, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.535 Vali Acc: 0.856 Test Loss: 0.535 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.0259666442871094
Epoch: 27, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.536 Vali Acc: 0.863 Test Loss: 0.536 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.9533352851867676
Epoch: 28, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.540 Vali Acc: 0.863 Test Loss: 0.540 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.0044140815734863
Epoch: 29, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.548 Vali Acc: 0.863 Test Loss: 0.548 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 385400
model size : 1.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.8977510929107666
Epoch: 1, Steps: 8 | Train Loss: 2.152 Vali Loss: 1.977 Vali Acc: 0.266 Test Loss: 1.977 Test Acc: 0.266
Validation loss decreased (inf --> -0.265605).  Saving model ...
Epoch: 2 cost time: 2.6685569286346436
Epoch: 2, Steps: 8 | Train Loss: 1.924 Vali Loss: 1.699 Vali Acc: 0.469 Test Loss: 1.699 Test Acc: 0.469
Validation loss decreased (-0.265605 --> -0.468733).  Saving model ...
Epoch: 3 cost time: 2.513230085372925
Epoch: 3, Steps: 8 | Train Loss: 1.586 Vali Loss: 1.367 Vali Acc: 0.716 Test Loss: 1.367 Test Acc: 0.716
Validation loss decreased (-0.468733 --> -0.715611).  Saving model ...
Epoch: 4 cost time: 2.503641366958618
Epoch: 4, Steps: 8 | Train Loss: 1.260 Vali Loss: 1.076 Vali Acc: 0.766 Test Loss: 1.076 Test Acc: 0.766
Validation loss decreased (-0.715611 --> -0.765614).  Saving model ...
Epoch: 5 cost time: 2.3180370330810547
Epoch: 5, Steps: 8 | Train Loss: 0.927 Vali Loss: 0.851 Vali Acc: 0.800 Test Loss: 0.851 Test Acc: 0.800
Validation loss decreased (-0.765614 --> -0.799991).  Saving model ...
Epoch: 6 cost time: 2.7232236862182617
Epoch: 6, Steps: 8 | Train Loss: 0.653 Vali Loss: 0.694 Vali Acc: 0.806 Test Loss: 0.694 Test Acc: 0.806
Validation loss decreased (-0.799991 --> -0.806243).  Saving model ...
Epoch: 7 cost time: 2.6871893405914307
Epoch: 7, Steps: 8 | Train Loss: 0.507 Vali Loss: 0.593 Vali Acc: 0.822 Test Loss: 0.593 Test Acc: 0.822
Validation loss decreased (-0.806243 --> -0.821869).  Saving model ...
Epoch: 8 cost time: 2.442769765853882
Epoch: 8, Steps: 8 | Train Loss: 0.390 Vali Loss: 0.521 Vali Acc: 0.838 Test Loss: 0.521 Test Acc: 0.838
Validation loss decreased (-0.821869 --> -0.837495).  Saving model ...
Epoch: 9 cost time: 2.399925947189331
Epoch: 9, Steps: 8 | Train Loss: 0.291 Vali Loss: 0.487 Vali Acc: 0.859 Test Loss: 0.487 Test Acc: 0.859
Validation loss decreased (-0.837495 --> -0.859370).  Saving model ...
Epoch: 10 cost time: 2.426172971725464
Epoch: 10, Steps: 8 | Train Loss: 0.201 Vali Loss: 0.473 Vali Acc: 0.869 Test Loss: 0.473 Test Acc: 0.869
Validation loss decreased (-0.859370 --> -0.868745).  Saving model ...
Epoch: 11 cost time: 2.7228617668151855
Epoch: 11, Steps: 8 | Train Loss: 0.155 Vali Loss: 0.458 Vali Acc: 0.866 Test Loss: 0.458 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.6499361991882324
Epoch: 12, Steps: 8 | Train Loss: 0.109 Vali Loss: 0.459 Vali Acc: 0.869 Test Loss: 0.459 Test Acc: 0.869
Validation loss decreased (-0.868745 --> -0.868745).  Saving model ...
Epoch: 13 cost time: 2.591449499130249
Epoch: 13, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.469 Vali Acc: 0.859 Test Loss: 0.469 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.4138338565826416
Epoch: 14, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.462 Vali Acc: 0.859 Test Loss: 0.462 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.319463014602661
Epoch: 15, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.443 Vali Acc: 0.863 Test Loss: 0.443 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.5485823154449463
Epoch: 16, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.450 Vali Acc: 0.869 Test Loss: 0.450 Test Acc: 0.869
Validation loss decreased (-0.868745 --> -0.868746).  Saving model ...
Epoch: 17 cost time: 2.558673143386841
Epoch: 17, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.461 Vali Acc: 0.859 Test Loss: 0.461 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.672302007675171
Epoch: 18, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.482 Vali Acc: 0.856 Test Loss: 0.482 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.326429605484009
Epoch: 19, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.481 Vali Acc: 0.856 Test Loss: 0.481 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.4061949253082275
Epoch: 20, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.486 Vali Acc: 0.859 Test Loss: 0.486 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.471189022064209
Epoch: 21, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.488 Vali Acc: 0.863 Test Loss: 0.488 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.5529367923736572
Epoch: 22, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.495 Vali Acc: 0.863 Test Loss: 0.495 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.6161465644836426
Epoch: 23, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.499 Vali Acc: 0.859 Test Loss: 0.499 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.4713847637176514
Epoch: 24, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.503 Vali Acc: 0.853 Test Loss: 0.503 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.4330925941467285
Epoch: 25, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.508 Vali Acc: 0.853 Test Loss: 0.508 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.4720351696014404
Epoch: 26, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.516 Vali Acc: 0.853 Test Loss: 0.516 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 1213176
model size : 4.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.057382583618164
Epoch: 1, Steps: 8 | Train Loss: 2.067 Vali Loss: 2.026 Vali Acc: 0.287 Test Loss: 2.026 Test Acc: 0.287
Validation loss decreased (inf --> -0.287480).  Saving model ...
Epoch: 2 cost time: 1.5565276145935059
Epoch: 2, Steps: 8 | Train Loss: 1.895 Vali Loss: 1.746 Vali Acc: 0.512 Test Loss: 1.746 Test Acc: 0.512
Validation loss decreased (-0.287480 --> -0.512483).  Saving model ...
Epoch: 3 cost time: 1.5324978828430176
Epoch: 3, Steps: 8 | Train Loss: 1.564 Vali Loss: 1.401 Vali Acc: 0.734 Test Loss: 1.401 Test Acc: 0.734
Validation loss decreased (-0.512483 --> -0.734361).  Saving model ...
Epoch: 4 cost time: 1.8737964630126953
Epoch: 4, Steps: 8 | Train Loss: 1.194 Vali Loss: 1.078 Vali Acc: 0.778 Test Loss: 1.078 Test Acc: 0.778
Validation loss decreased (-0.734361 --> -0.778114).  Saving model ...
Epoch: 5 cost time: 1.9019646644592285
Epoch: 5, Steps: 8 | Train Loss: 0.862 Vali Loss: 0.836 Vali Acc: 0.825 Test Loss: 0.836 Test Acc: 0.825
Validation loss decreased (-0.778114 --> -0.824992).  Saving model ...
Epoch: 6 cost time: 1.9054956436157227
Epoch: 6, Steps: 8 | Train Loss: 0.602 Vali Loss: 0.668 Vali Acc: 0.850 Test Loss: 0.668 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849993).  Saving model ...
Epoch: 7 cost time: 1.8728783130645752
Epoch: 7, Steps: 8 | Train Loss: 0.455 Vali Loss: 0.570 Vali Acc: 0.853 Test Loss: 0.570 Test Acc: 0.853
Validation loss decreased (-0.849993 --> -0.853119).  Saving model ...
Epoch: 8 cost time: 1.783501148223877
Epoch: 8, Steps: 8 | Train Loss: 0.340 Vali Loss: 0.520 Vali Acc: 0.859 Test Loss: 0.520 Test Acc: 0.859
Validation loss decreased (-0.853119 --> -0.859370).  Saving model ...
Epoch: 9 cost time: 1.6572349071502686
Epoch: 9, Steps: 8 | Train Loss: 0.269 Vali Loss: 0.498 Vali Acc: 0.863 Test Loss: 0.498 Test Acc: 0.863
Validation loss decreased (-0.859370 --> -0.862495).  Saving model ...
Epoch: 10 cost time: 1.7554185390472412
Epoch: 10, Steps: 8 | Train Loss: 0.184 Vali Loss: 0.496 Vali Acc: 0.853 Test Loss: 0.496 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8154597282409668
Epoch: 11, Steps: 8 | Train Loss: 0.136 Vali Loss: 0.493 Vali Acc: 0.856 Test Loss: 0.493 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8471176624298096
Epoch: 12, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.484 Vali Acc: 0.863 Test Loss: 0.484 Test Acc: 0.863
Validation loss decreased (-0.862495 --> -0.862495).  Saving model ...
Epoch: 13 cost time: 1.8340485095977783
Epoch: 13, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.484 Vali Acc: 0.856 Test Loss: 0.484 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7733979225158691
Epoch: 14, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.484 Vali Acc: 0.856 Test Loss: 0.484 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.928074836730957
Epoch: 15, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.490 Vali Acc: 0.856 Test Loss: 0.490 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.8386361598968506
Epoch: 16, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.500 Vali Acc: 0.856 Test Loss: 0.500 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.9489986896514893
Epoch: 17, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.514 Vali Acc: 0.869 Test Loss: 0.514 Test Acc: 0.869
Validation loss decreased (-0.862495 --> -0.868745).  Saving model ...
Epoch: 18 cost time: 1.963141918182373
Epoch: 18, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.503 Vali Acc: 0.869 Test Loss: 0.503 Test Acc: 0.869
Validation loss decreased (-0.868745 --> -0.868745).  Saving model ...
Epoch: 19 cost time: 1.9329254627227783
Epoch: 19, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.509 Vali Acc: 0.869 Test Loss: 0.509 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.713566780090332
Epoch: 20, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.524 Vali Acc: 0.869 Test Loss: 0.524 Test Acc: 0.869
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.6695199012756348
Epoch: 21, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.531 Vali Acc: 0.859 Test Loss: 0.531 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.6599268913269043
Epoch: 22, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.549 Vali Acc: 0.853 Test Loss: 0.549 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.7620973587036133
Epoch: 23, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.552 Vali Acc: 0.859 Test Loss: 0.552 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.7381806373596191
Epoch: 24, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.553 Vali Acc: 0.863 Test Loss: 0.553 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.7348544597625732
Epoch: 25, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.556 Vali Acc: 0.853 Test Loss: 0.556 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.937422513961792
Epoch: 26, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.555 Vali Acc: 0.859 Test Loss: 0.555 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.7647171020507812
Epoch: 27, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.555 Vali Acc: 0.863 Test Loss: 0.555 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.7786133289337158
Epoch: 28, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.559 Vali Acc: 0.859 Test Loss: 0.559 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 385400
model size : 1.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.182051420211792
Epoch: 1, Steps: 8 | Train Loss: 2.152 Vali Loss: 1.979 Vali Acc: 0.263 Test Loss: 1.979 Test Acc: 0.263
Validation loss decreased (inf --> -0.262480).  Saving model ...
Epoch: 2 cost time: 1.6906912326812744
Epoch: 2, Steps: 8 | Train Loss: 1.929 Vali Loss: 1.708 Vali Acc: 0.447 Test Loss: 1.708 Test Acc: 0.447
Validation loss decreased (-0.262480 --> -0.446858).  Saving model ...
Epoch: 3 cost time: 1.5767290592193604
Epoch: 3, Steps: 8 | Train Loss: 1.601 Vali Loss: 1.384 Vali Acc: 0.713 Test Loss: 1.384 Test Acc: 0.713
Validation loss decreased (-0.446858 --> -0.712486).  Saving model ...
Epoch: 4 cost time: 1.59775710105896
Epoch: 4, Steps: 8 | Train Loss: 1.280 Vali Loss: 1.096 Vali Acc: 0.762 Test Loss: 1.096 Test Acc: 0.762
Validation loss decreased (-0.712486 --> -0.762489).  Saving model ...
Epoch: 5 cost time: 1.641036033630371
Epoch: 5, Steps: 8 | Train Loss: 0.948 Vali Loss: 0.872 Vali Acc: 0.797 Test Loss: 0.872 Test Acc: 0.797
Validation loss decreased (-0.762489 --> -0.796866).  Saving model ...
Epoch: 6 cost time: 1.764139175415039
Epoch: 6, Steps: 8 | Train Loss: 0.680 Vali Loss: 0.717 Vali Acc: 0.797 Test Loss: 0.717 Test Acc: 0.797
Validation loss decreased (-0.796866 --> -0.796868).  Saving model ...
Epoch: 7 cost time: 1.891502857208252
Epoch: 7, Steps: 8 | Train Loss: 0.538 Vali Loss: 0.615 Vali Acc: 0.812 Test Loss: 0.615 Test Acc: 0.812
Validation loss decreased (-0.796868 --> -0.812494).  Saving model ...
Epoch: 8 cost time: 1.8256750106811523
Epoch: 8, Steps: 8 | Train Loss: 0.426 Vali Loss: 0.544 Vali Acc: 0.828 Test Loss: 0.544 Test Acc: 0.828
Validation loss decreased (-0.812494 --> -0.828120).  Saving model ...
Epoch: 9 cost time: 1.8671271800994873
Epoch: 9, Steps: 8 | Train Loss: 0.329 Vali Loss: 0.513 Vali Acc: 0.844 Test Loss: 0.513 Test Acc: 0.844
Validation loss decreased (-0.828120 --> -0.843745).  Saving model ...
Epoch: 10 cost time: 1.7399556636810303
Epoch: 10, Steps: 8 | Train Loss: 0.234 Vali Loss: 0.502 Vali Acc: 0.850 Test Loss: 0.502 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849995).  Saving model ...
Epoch: 11 cost time: 1.5557918548583984
Epoch: 11, Steps: 8 | Train Loss: 0.181 Vali Loss: 0.486 Vali Acc: 0.856 Test Loss: 0.486 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.856245).  Saving model ...
Epoch: 12 cost time: 1.5462510585784912
Epoch: 12, Steps: 8 | Train Loss: 0.133 Vali Loss: 0.491 Vali Acc: 0.844 Test Loss: 0.491 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5246820449829102
Epoch: 13, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.505 Vali Acc: 0.847 Test Loss: 0.505 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6787092685699463
Epoch: 14, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.495 Vali Acc: 0.853 Test Loss: 0.495 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6811130046844482
Epoch: 15, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.477 Vali Acc: 0.841 Test Loss: 0.477 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.5078766345977783
Epoch: 16, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.483 Vali Acc: 0.844 Test Loss: 0.483 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.7251291275024414
Epoch: 17, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.497 Vali Acc: 0.853 Test Loss: 0.497 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.8016786575317383
Epoch: 18, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.516 Vali Acc: 0.853 Test Loss: 0.516 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.8161990642547607
Epoch: 19, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.516 Vali Acc: 0.844 Test Loss: 0.516 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.778430700302124
Epoch: 20, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.520 Vali Acc: 0.841 Test Loss: 0.520 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.7768559455871582
Epoch: 21, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.524 Vali Acc: 0.844 Test Loss: 0.524 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 1213176
model size : 4.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.4829347133636475
Epoch: 1, Steps: 8 | Train Loss: 2.067 Vali Loss: 2.027 Vali Acc: 0.287 Test Loss: 2.027 Test Acc: 0.287
Validation loss decreased (inf --> -0.287480).  Saving model ...
Epoch: 2 cost time: 1.056448221206665
Epoch: 2, Steps: 8 | Train Loss: 1.898 Vali Loss: 1.752 Vali Acc: 0.519 Test Loss: 1.752 Test Acc: 0.519
Validation loss decreased (-0.287480 --> -0.518732).  Saving model ...
Epoch: 3 cost time: 1.1139492988586426
Epoch: 3, Steps: 8 | Train Loss: 1.573 Vali Loss: 1.415 Vali Acc: 0.731 Test Loss: 1.415 Test Acc: 0.731
Validation loss decreased (-0.518732 --> -0.731236).  Saving model ...
Epoch: 4 cost time: 1.2820491790771484
Epoch: 4, Steps: 8 | Train Loss: 1.213 Vali Loss: 1.100 Vali Acc: 0.775 Test Loss: 1.100 Test Acc: 0.775
Validation loss decreased (-0.731236 --> -0.774989).  Saving model ...
Epoch: 5 cost time: 1.3084964752197266
Epoch: 5, Steps: 8 | Train Loss: 0.886 Vali Loss: 0.858 Vali Acc: 0.816 Test Loss: 0.858 Test Acc: 0.816
Validation loss decreased (-0.774989 --> -0.815616).  Saving model ...
Epoch: 6 cost time: 1.387727975845337
Epoch: 6, Steps: 8 | Train Loss: 0.627 Vali Loss: 0.688 Vali Acc: 0.841 Test Loss: 0.688 Test Acc: 0.841
Validation loss decreased (-0.815616 --> -0.840618).  Saving model ...
Epoch: 7 cost time: 1.1765861511230469
Epoch: 7, Steps: 8 | Train Loss: 0.483 Vali Loss: 0.587 Vali Acc: 0.856 Test Loss: 0.587 Test Acc: 0.856
Validation loss decreased (-0.840618 --> -0.856244).  Saving model ...
Epoch: 8 cost time: 1.2573001384735107
Epoch: 8, Steps: 8 | Train Loss: 0.374 Vali Loss: 0.536 Vali Acc: 0.859 Test Loss: 0.536 Test Acc: 0.859
Validation loss decreased (-0.856244 --> -0.859370).  Saving model ...
Epoch: 9 cost time: 1.2261106967926025
Epoch: 9, Steps: 8 | Train Loss: 0.313 Vali Loss: 0.511 Vali Acc: 0.863 Test Loss: 0.511 Test Acc: 0.863
Validation loss decreased (-0.859370 --> -0.862495).  Saving model ...
Epoch: 10 cost time: 1.0955538749694824
Epoch: 10, Steps: 8 | Train Loss: 0.217 Vali Loss: 0.512 Vali Acc: 0.850 Test Loss: 0.512 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1395668983459473
Epoch: 11, Steps: 8 | Train Loss: 0.166 Vali Loss: 0.508 Vali Acc: 0.856 Test Loss: 0.508 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1618726253509521
Epoch: 12, Steps: 8 | Train Loss: 0.126 Vali Loss: 0.500 Vali Acc: 0.856 Test Loss: 0.500 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1645257472991943
Epoch: 13, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.494 Vali Acc: 0.856 Test Loss: 0.494 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1959614753723145
Epoch: 14, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.495 Vali Acc: 0.859 Test Loss: 0.495 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.0467257499694824
Epoch: 15, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.508 Vali Acc: 0.853 Test Loss: 0.508 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0826983451843262
Epoch: 16, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.518 Vali Acc: 0.850 Test Loss: 0.518 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.219102144241333
Epoch: 17, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.520 Vali Acc: 0.853 Test Loss: 0.520 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.2268388271331787
Epoch: 18, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.513 Vali Acc: 0.850 Test Loss: 0.513 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.1879162788391113
Epoch: 19, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.528 Vali Acc: 0.850 Test Loss: 0.528 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 385400
model size : 1.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.759748697280884
Epoch: 1, Steps: 8 | Train Loss: 2.083 Vali Loss: 1.910 Vali Acc: 0.300 Test Loss: 1.910 Test Acc: 0.300
Validation loss decreased (inf --> -0.299981).  Saving model ...
Epoch: 2 cost time: 2.3810553550720215
Epoch: 2, Steps: 8 | Train Loss: 1.835 Vali Loss: 1.612 Vali Acc: 0.591 Test Loss: 1.612 Test Acc: 0.591
Validation loss decreased (-0.299981 --> -0.590609).  Saving model ...
Epoch: 3 cost time: 2.2414658069610596
Epoch: 3, Steps: 8 | Train Loss: 1.448 Vali Loss: 1.271 Vali Acc: 0.762 Test Loss: 1.271 Test Acc: 0.762
Validation loss decreased (-0.590609 --> -0.762487).  Saving model ...
Epoch: 4 cost time: 2.5109200477600098
Epoch: 4, Steps: 8 | Train Loss: 1.074 Vali Loss: 0.985 Vali Acc: 0.784 Test Loss: 0.985 Test Acc: 0.784
Validation loss decreased (-0.762487 --> -0.784365).  Saving model ...
Epoch: 5 cost time: 2.5142910480499268
Epoch: 5, Steps: 8 | Train Loss: 0.833 Vali Loss: 0.767 Vali Acc: 0.806 Test Loss: 0.767 Test Acc: 0.806
Validation loss decreased (-0.784365 --> -0.806242).  Saving model ...
Epoch: 6 cost time: 2.570758104324341
Epoch: 6, Steps: 8 | Train Loss: 0.626 Vali Loss: 0.651 Vali Acc: 0.819 Test Loss: 0.651 Test Acc: 0.819
Validation loss decreased (-0.806242 --> -0.818743).  Saving model ...
Epoch: 7 cost time: 2.543071985244751
Epoch: 7, Steps: 8 | Train Loss: 0.478 Vali Loss: 0.584 Vali Acc: 0.828 Test Loss: 0.584 Test Acc: 0.828
Validation loss decreased (-0.818743 --> -0.828119).  Saving model ...
Epoch: 8 cost time: 2.56339430809021
Epoch: 8, Steps: 8 | Train Loss: 0.364 Vali Loss: 0.539 Vali Acc: 0.831 Test Loss: 0.539 Test Acc: 0.831
Validation loss decreased (-0.828119 --> -0.831245).  Saving model ...
Epoch: 9 cost time: 2.4921913146972656
Epoch: 9, Steps: 8 | Train Loss: 0.303 Vali Loss: 0.510 Vali Acc: 0.834 Test Loss: 0.510 Test Acc: 0.834
Validation loss decreased (-0.831245 --> -0.834370).  Saving model ...
Epoch: 10 cost time: 2.5286009311676025
Epoch: 10, Steps: 8 | Train Loss: 0.228 Vali Loss: 0.488 Vali Acc: 0.847 Test Loss: 0.488 Test Acc: 0.847
Validation loss decreased (-0.834370 --> -0.846870).  Saving model ...
Epoch: 11 cost time: 2.231781005859375
Epoch: 11, Steps: 8 | Train Loss: 0.188 Vali Loss: 0.487 Vali Acc: 0.831 Test Loss: 0.487 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.335725784301758
Epoch: 12, Steps: 8 | Train Loss: 0.153 Vali Loss: 0.489 Vali Acc: 0.838 Test Loss: 0.489 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.318737268447876
Epoch: 13, Steps: 8 | Train Loss: 0.121 Vali Loss: 0.485 Vali Acc: 0.834 Test Loss: 0.485 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.6774065494537354
Epoch: 14, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.483 Vali Acc: 0.844 Test Loss: 0.483 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.7296695709228516
Epoch: 15, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.482 Vali Acc: 0.844 Test Loss: 0.482 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.573662757873535
Epoch: 16, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.484 Vali Acc: 0.844 Test Loss: 0.484 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.183577299118042
Epoch: 17, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.489 Vali Acc: 0.847 Test Loss: 0.489 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.632354736328125
Epoch: 18, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.498 Vali Acc: 0.841 Test Loss: 0.498 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.8507986068725586
Epoch: 19, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.495 Vali Acc: 0.844 Test Loss: 0.495 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.7871718406677246
Epoch: 20, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.510 Vali Acc: 0.844 Test Loss: 0.510 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 627064
model size : 2.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.164350748062134
Epoch: 1, Steps: 8 | Train Loss: 2.136 Vali Loss: 2.051 Vali Acc: 0.272 Test Loss: 2.051 Test Acc: 0.272
Validation loss decreased (inf --> -0.271854).  Saving model ...
Epoch: 2 cost time: 1.8564074039459229
Epoch: 2, Steps: 8 | Train Loss: 1.894 Vali Loss: 1.757 Vali Acc: 0.456 Test Loss: 1.757 Test Acc: 0.456
Validation loss decreased (-0.271854 --> -0.456232).  Saving model ...
Epoch: 3 cost time: 1.9372985363006592
Epoch: 3, Steps: 8 | Train Loss: 1.549 Vali Loss: 1.402 Vali Acc: 0.722 Test Loss: 1.402 Test Acc: 0.722
Validation loss decreased (-0.456232 --> -0.721861).  Saving model ...
Epoch: 4 cost time: 1.9475948810577393
Epoch: 4, Steps: 8 | Train Loss: 1.227 Vali Loss: 1.088 Vali Acc: 0.778 Test Loss: 1.088 Test Acc: 0.778
Validation loss decreased (-0.721861 --> -0.778114).  Saving model ...
Epoch: 5 cost time: 1.7699229717254639
Epoch: 5, Steps: 8 | Train Loss: 0.922 Vali Loss: 0.853 Vali Acc: 0.797 Test Loss: 0.853 Test Acc: 0.797
Validation loss decreased (-0.778114 --> -0.796866).  Saving model ...
Epoch: 6 cost time: 1.6825013160705566
Epoch: 6, Steps: 8 | Train Loss: 0.651 Vali Loss: 0.684 Vali Acc: 0.825 Test Loss: 0.684 Test Acc: 0.825
Validation loss decreased (-0.796866 --> -0.824993).  Saving model ...
Epoch: 7 cost time: 1.7097110748291016
Epoch: 7, Steps: 8 | Train Loss: 0.532 Vali Loss: 0.582 Vali Acc: 0.828 Test Loss: 0.582 Test Acc: 0.828
Validation loss decreased (-0.824993 --> -0.828119).  Saving model ...
Epoch: 8 cost time: 1.869927167892456
Epoch: 8, Steps: 8 | Train Loss: 0.394 Vali Loss: 0.536 Vali Acc: 0.828 Test Loss: 0.536 Test Acc: 0.828
Validation loss decreased (-0.828119 --> -0.828120).  Saving model ...
Epoch: 9 cost time: 1.7457783222198486
Epoch: 9, Steps: 8 | Train Loss: 0.309 Vali Loss: 0.513 Vali Acc: 0.831 Test Loss: 0.513 Test Acc: 0.831
Validation loss decreased (-0.828120 --> -0.831245).  Saving model ...
Epoch: 10 cost time: 1.7827434539794922
Epoch: 10, Steps: 8 | Train Loss: 0.237 Vali Loss: 0.481 Vali Acc: 0.844 Test Loss: 0.481 Test Acc: 0.844
Validation loss decreased (-0.831245 --> -0.843745).  Saving model ...
Epoch: 11 cost time: 1.8989360332489014
Epoch: 11, Steps: 8 | Train Loss: 0.180 Vali Loss: 0.475 Vali Acc: 0.853 Test Loss: 0.475 Test Acc: 0.853
Validation loss decreased (-0.843745 --> -0.853120).  Saving model ...
Epoch: 12 cost time: 2.02433180809021
Epoch: 12, Steps: 8 | Train Loss: 0.149 Vali Loss: 0.467 Vali Acc: 0.856 Test Loss: 0.467 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 13 cost time: 1.918940782546997
Epoch: 13, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.470 Vali Acc: 0.859 Test Loss: 0.470 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 14 cost time: 1.8749127388000488
Epoch: 14, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.467 Vali Acc: 0.863 Test Loss: 0.467 Test Acc: 0.863
Validation loss decreased (-0.859370 --> -0.862495).  Saving model ...
Epoch: 15 cost time: 1.7331600189208984
Epoch: 15, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.459 Vali Acc: 0.859 Test Loss: 0.459 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7238974571228027
Epoch: 16, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.464 Vali Acc: 0.859 Test Loss: 0.464 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.743504285812378
Epoch: 17, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.482 Vali Acc: 0.856 Test Loss: 0.482 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.8043556213378906
Epoch: 18, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.497 Vali Acc: 0.853 Test Loss: 0.497 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.8064100742340088
Epoch: 19, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.485 Vali Acc: 0.863 Test Loss: 0.485 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.8467862606048584
Epoch: 20, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.494 Vali Acc: 0.859 Test Loss: 0.494 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.916971206665039
Epoch: 21, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.507 Vali Acc: 0.850 Test Loss: 0.507 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.8902065753936768
Epoch: 22, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.509 Vali Acc: 0.856 Test Loss: 0.509 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.9128990173339844
Epoch: 23, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.511 Vali Acc: 0.856 Test Loss: 0.511 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.9446320533752441
Epoch: 24, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.510 Vali Acc: 0.856 Test Loss: 0.510 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 213112
model size : 1.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.603339433670044
Epoch: 1, Steps: 8 | Train Loss: 2.085 Vali Loss: 1.911 Vali Acc: 0.300 Test Loss: 1.911 Test Acc: 0.300
Validation loss decreased (inf --> -0.299981).  Saving model ...
Epoch: 2 cost time: 2.198901653289795
Epoch: 2, Steps: 8 | Train Loss: 1.837 Vali Loss: 1.614 Vali Acc: 0.584 Test Loss: 1.614 Test Acc: 0.584
Validation loss decreased (-0.299981 --> -0.584359).  Saving model ...
Epoch: 3 cost time: 2.317347288131714
Epoch: 3, Steps: 8 | Train Loss: 1.451 Vali Loss: 1.274 Vali Acc: 0.762 Test Loss: 1.274 Test Acc: 0.762
Validation loss decreased (-0.584359 --> -0.762487).  Saving model ...
Epoch: 4 cost time: 2.501365900039673
Epoch: 4, Steps: 8 | Train Loss: 1.076 Vali Loss: 0.988 Vali Acc: 0.784 Test Loss: 0.988 Test Acc: 0.784
Validation loss decreased (-0.762487 --> -0.784365).  Saving model ...
Epoch: 5 cost time: 2.3951528072357178
Epoch: 5, Steps: 8 | Train Loss: 0.834 Vali Loss: 0.771 Vali Acc: 0.806 Test Loss: 0.771 Test Acc: 0.806
Validation loss decreased (-0.784365 --> -0.806242).  Saving model ...
Epoch: 6 cost time: 2.3779754638671875
Epoch: 6, Steps: 8 | Train Loss: 0.628 Vali Loss: 0.655 Vali Acc: 0.819 Test Loss: 0.655 Test Acc: 0.819
Validation loss decreased (-0.806242 --> -0.818743).  Saving model ...
Epoch: 7 cost time: 2.4140515327453613
Epoch: 7, Steps: 8 | Train Loss: 0.479 Vali Loss: 0.587 Vali Acc: 0.828 Test Loss: 0.587 Test Acc: 0.828
Validation loss decreased (-0.818743 --> -0.828119).  Saving model ...
Epoch: 8 cost time: 2.3265066146850586
Epoch: 8, Steps: 8 | Train Loss: 0.365 Vali Loss: 0.542 Vali Acc: 0.831 Test Loss: 0.542 Test Acc: 0.831
Validation loss decreased (-0.828119 --> -0.831245).  Saving model ...
Epoch: 9 cost time: 2.3811824321746826
Epoch: 9, Steps: 8 | Train Loss: 0.303 Vali Loss: 0.513 Vali Acc: 0.834 Test Loss: 0.513 Test Acc: 0.834
Validation loss decreased (-0.831245 --> -0.834370).  Saving model ...
Epoch: 10 cost time: 2.1888844966888428
Epoch: 10, Steps: 8 | Train Loss: 0.228 Vali Loss: 0.491 Vali Acc: 0.844 Test Loss: 0.491 Test Acc: 0.844
Validation loss decreased (-0.834370 --> -0.843745).  Saving model ...
Epoch: 11 cost time: 2.3090600967407227
Epoch: 11, Steps: 8 | Train Loss: 0.187 Vali Loss: 0.489 Vali Acc: 0.831 Test Loss: 0.489 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.3361923694610596
Epoch: 12, Steps: 8 | Train Loss: 0.153 Vali Loss: 0.491 Vali Acc: 0.834 Test Loss: 0.491 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.5471043586730957
Epoch: 13, Steps: 8 | Train Loss: 0.121 Vali Loss: 0.487 Vali Acc: 0.831 Test Loss: 0.487 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.4767796993255615
Epoch: 14, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.486 Vali Acc: 0.838 Test Loss: 0.486 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.3720600605010986
Epoch: 15, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.485 Vali Acc: 0.838 Test Loss: 0.485 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.2830629348754883
Epoch: 16, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.486 Vali Acc: 0.844 Test Loss: 0.486 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 17 cost time: 2.276620388031006
Epoch: 17, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.490 Vali Acc: 0.850 Test Loss: 0.490 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849995).  Saving model ...
Epoch: 18 cost time: 2.207735776901245
Epoch: 18, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.499 Vali Acc: 0.841 Test Loss: 0.499 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.181627035140991
Epoch: 19, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.497 Vali Acc: 0.841 Test Loss: 0.497 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.192430019378662
Epoch: 20, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.513 Vali Acc: 0.844 Test Loss: 0.513 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.361412763595581
Epoch: 21, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.511 Vali Acc: 0.847 Test Loss: 0.511 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.348297357559204
Epoch: 22, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.507 Vali Acc: 0.850 Test Loss: 0.507 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.4381160736083984
Epoch: 23, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.508 Vali Acc: 0.847 Test Loss: 0.508 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.4970853328704834
Epoch: 24, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.523 Vali Acc: 0.844 Test Loss: 0.523 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.13818097114563
Epoch: 25, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.539 Vali Acc: 0.847 Test Loss: 0.539 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.2012364864349365
Epoch: 26, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.538 Vali Acc: 0.850 Test Loss: 0.538 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.015477418899536
Epoch: 27, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.536 Vali Acc: 0.844 Test Loss: 0.536 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 627064
model size : 2.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.8779523372650146
Epoch: 1, Steps: 8 | Train Loss: 2.152 Vali Loss: 2.056 Vali Acc: 0.269 Test Loss: 2.056 Test Acc: 0.269
Validation loss decreased (inf --> -0.268729).  Saving model ...
Epoch: 2 cost time: 1.5306627750396729
Epoch: 2, Steps: 8 | Train Loss: 1.904 Vali Loss: 1.769 Vali Acc: 0.450 Test Loss: 1.769 Test Acc: 0.450
Validation loss decreased (-0.268729 --> -0.449982).  Saving model ...
Epoch: 3 cost time: 1.4628369808197021
Epoch: 3, Steps: 8 | Train Loss: 1.564 Vali Loss: 1.422 Vali Acc: 0.703 Test Loss: 1.422 Test Acc: 0.703
Validation loss decreased (-0.449982 --> -0.703111).  Saving model ...
Epoch: 4 cost time: 1.491410732269287
Epoch: 4, Steps: 8 | Train Loss: 1.244 Vali Loss: 1.114 Vali Acc: 0.769 Test Loss: 1.114 Test Acc: 0.769
Validation loss decreased (-0.703111 --> -0.768739).  Saving model ...
Epoch: 5 cost time: 1.5359227657318115
Epoch: 5, Steps: 8 | Train Loss: 0.935 Vali Loss: 0.881 Vali Acc: 0.787 Test Loss: 0.881 Test Acc: 0.787
Validation loss decreased (-0.768739 --> -0.787491).  Saving model ...
Epoch: 6 cost time: 1.4360737800598145
Epoch: 6, Steps: 8 | Train Loss: 0.661 Vali Loss: 0.710 Vali Acc: 0.822 Test Loss: 0.710 Test Acc: 0.822
Validation loss decreased (-0.787491 --> -0.821868).  Saving model ...
Epoch: 7 cost time: 1.1136579513549805
Epoch: 7, Steps: 8 | Train Loss: 0.540 Vali Loss: 0.605 Vali Acc: 0.831 Test Loss: 0.605 Test Acc: 0.831
Validation loss decreased (-0.821868 --> -0.831244).  Saving model ...
Epoch: 8 cost time: 1.2487878799438477
Epoch: 8, Steps: 8 | Train Loss: 0.400 Vali Loss: 0.557 Vali Acc: 0.828 Test Loss: 0.557 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2696971893310547
Epoch: 9, Steps: 8 | Train Loss: 0.313 Vali Loss: 0.532 Vali Acc: 0.828 Test Loss: 0.532 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.31707763671875
Epoch: 10, Steps: 8 | Train Loss: 0.243 Vali Loss: 0.500 Vali Acc: 0.847 Test Loss: 0.500 Test Acc: 0.847
Validation loss decreased (-0.831244 --> -0.846870).  Saving model ...
Epoch: 11 cost time: 1.3306150436401367
Epoch: 11, Steps: 8 | Train Loss: 0.184 Vali Loss: 0.495 Vali Acc: 0.847 Test Loss: 0.495 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 12 cost time: 1.3745286464691162
Epoch: 12, Steps: 8 | Train Loss: 0.151 Vali Loss: 0.488 Vali Acc: 0.853 Test Loss: 0.488 Test Acc: 0.853
Validation loss decreased (-0.846870 --> -0.853120).  Saving model ...
Epoch: 13 cost time: 1.4873683452606201
Epoch: 13, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.489 Vali Acc: 0.856 Test Loss: 0.489 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 14 cost time: 1.3217177391052246
Epoch: 14, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.487 Vali Acc: 0.853 Test Loss: 0.487 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4201972484588623
Epoch: 15, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.478 Vali Acc: 0.856 Test Loss: 0.478 Test Acc: 0.856
Validation loss decreased (-0.856245 --> -0.856245).  Saving model ...
Epoch: 16 cost time: 1.4001476764678955
Epoch: 16, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.484 Vali Acc: 0.856 Test Loss: 0.484 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.400545597076416
Epoch: 17, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.503 Vali Acc: 0.850 Test Loss: 0.503 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2666571140289307
Epoch: 18, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.517 Vali Acc: 0.853 Test Loss: 0.517 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3203060626983643
Epoch: 19, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.505 Vali Acc: 0.859 Test Loss: 0.505 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 20 cost time: 1.3658323287963867
Epoch: 20, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.515 Vali Acc: 0.856 Test Loss: 0.515 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3453073501586914
Epoch: 21, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.528 Vali Acc: 0.850 Test Loss: 0.528 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.3435797691345215
Epoch: 22, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.530 Vali Acc: 0.850 Test Loss: 0.530 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.3653085231781006
Epoch: 23, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.532 Vali Acc: 0.856 Test Loss: 0.532 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.3957583904266357
Epoch: 24, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.530 Vali Acc: 0.850 Test Loss: 0.530 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.3432965278625488
Epoch: 25, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.531 Vali Acc: 0.856 Test Loss: 0.531 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.4570209980010986
Epoch: 26, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.534 Vali Acc: 0.853 Test Loss: 0.534 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.5182008743286133
Epoch: 27, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.539 Vali Acc: 0.853 Test Loss: 0.539 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.5124797821044922
Epoch: 28, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.539 Vali Acc: 0.859 Test Loss: 0.539 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.3697946071624756
Epoch: 29, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.539 Vali Acc: 0.859 Test Loss: 0.539 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 213112
model size : 1.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.873189926147461
Epoch: 1, Steps: 8 | Train Loss: 2.084 Vali Loss: 1.917 Vali Acc: 0.300 Test Loss: 1.917 Test Acc: 0.300
Validation loss decreased (inf --> -0.299981).  Saving model ...
Epoch: 2 cost time: 1.2257025241851807
Epoch: 2, Steps: 8 | Train Loss: 1.840 Vali Loss: 1.625 Vali Acc: 0.562 Test Loss: 1.625 Test Acc: 0.562
Validation loss decreased (-0.299981 --> -0.562484).  Saving model ...
Epoch: 3 cost time: 1.2964966297149658
Epoch: 3, Steps: 8 | Train Loss: 1.459 Vali Loss: 1.289 Vali Acc: 0.753 Test Loss: 1.289 Test Acc: 0.753
Validation loss decreased (-0.562484 --> -0.753112).  Saving model ...
Epoch: 4 cost time: 1.4877877235412598
Epoch: 4, Steps: 8 | Train Loss: 1.088 Vali Loss: 1.006 Vali Acc: 0.775 Test Loss: 1.006 Test Acc: 0.775
Validation loss decreased (-0.753112 --> -0.774990).  Saving model ...
Epoch: 5 cost time: 1.4793660640716553
Epoch: 5, Steps: 8 | Train Loss: 0.849 Vali Loss: 0.790 Vali Acc: 0.809 Test Loss: 0.790 Test Acc: 0.809
Validation loss decreased (-0.774990 --> -0.809367).  Saving model ...
Epoch: 6 cost time: 1.5700323581695557
Epoch: 6, Steps: 8 | Train Loss: 0.645 Vali Loss: 0.674 Vali Acc: 0.816 Test Loss: 0.674 Test Acc: 0.816
Validation loss decreased (-0.809367 --> -0.815618).  Saving model ...
Epoch: 7 cost time: 1.5436415672302246
Epoch: 7, Steps: 8 | Train Loss: 0.499 Vali Loss: 0.608 Vali Acc: 0.828 Test Loss: 0.608 Test Acc: 0.828
Validation loss decreased (-0.815618 --> -0.828119).  Saving model ...
Epoch: 8 cost time: 1.4862382411956787
Epoch: 8, Steps: 8 | Train Loss: 0.386 Vali Loss: 0.567 Vali Acc: 0.834 Test Loss: 0.567 Test Acc: 0.834
Validation loss decreased (-0.828119 --> -0.834369).  Saving model ...
Epoch: 9 cost time: 1.371579647064209
Epoch: 9, Steps: 8 | Train Loss: 0.332 Vali Loss: 0.541 Vali Acc: 0.822 Test Loss: 0.541 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3408126831054688
Epoch: 10, Steps: 8 | Train Loss: 0.252 Vali Loss: 0.525 Vali Acc: 0.838 Test Loss: 0.525 Test Acc: 0.838
Validation loss decreased (-0.834369 --> -0.837495).  Saving model ...
Epoch: 11 cost time: 1.3562779426574707
Epoch: 11, Steps: 8 | Train Loss: 0.215 Vali Loss: 0.531 Vali Acc: 0.838 Test Loss: 0.531 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3716695308685303
Epoch: 12, Steps: 8 | Train Loss: 0.176 Vali Loss: 0.544 Vali Acc: 0.834 Test Loss: 0.544 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4859437942504883
Epoch: 13, Steps: 8 | Train Loss: 0.138 Vali Loss: 0.546 Vali Acc: 0.834 Test Loss: 0.546 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.4844655990600586
Epoch: 14, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.547 Vali Acc: 0.844 Test Loss: 0.547 Test Acc: 0.844
Validation loss decreased (-0.837495 --> -0.843745).  Saving model ...
Epoch: 15 cost time: 1.587491750717163
Epoch: 15, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.547 Vali Acc: 0.841 Test Loss: 0.547 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5457680225372314
Epoch: 16, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.549 Vali Acc: 0.838 Test Loss: 0.549 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.5381155014038086
Epoch: 17, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.555 Vali Acc: 0.834 Test Loss: 0.555 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.509406566619873
Epoch: 18, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.563 Vali Acc: 0.834 Test Loss: 0.563 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.61753511428833
Epoch: 19, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.560 Vali Acc: 0.834 Test Loss: 0.560 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.468099594116211
Epoch: 20, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.579 Vali Acc: 0.831 Test Loss: 0.579 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.4626781940460205
Epoch: 21, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.583 Vali Acc: 0.828 Test Loss: 0.583 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.4261784553527832
Epoch: 22, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.585 Vali Acc: 0.828 Test Loss: 0.585 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.4999940395355225
Epoch: 23, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.591 Vali Acc: 0.828 Test Loss: 0.591 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.4132258892059326
Epoch: 24, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.605 Vali Acc: 0.831 Test Loss: 0.605 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 627064
model size : 2.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.440606117248535
Epoch: 1, Steps: 8 | Train Loss: 2.156 Vali Loss: 2.055 Vali Acc: 0.272 Test Loss: 2.055 Test Acc: 0.272
Validation loss decreased (inf --> -0.271854).  Saving model ...
Epoch: 2 cost time: 1.0859715938568115
Epoch: 2, Steps: 8 | Train Loss: 1.908 Vali Loss: 1.773 Vali Acc: 0.459 Test Loss: 1.773 Test Acc: 0.459
Validation loss decreased (-0.271854 --> -0.459357).  Saving model ...
Epoch: 3 cost time: 1.0861091613769531
Epoch: 3, Steps: 8 | Train Loss: 1.570 Vali Loss: 1.432 Vali Acc: 0.697 Test Loss: 1.432 Test Acc: 0.697
Validation loss decreased (-0.459357 --> -0.696861).  Saving model ...
Epoch: 4 cost time: 1.0064728260040283
Epoch: 4, Steps: 8 | Train Loss: 1.253 Vali Loss: 1.129 Vali Acc: 0.766 Test Loss: 1.129 Test Acc: 0.766
Validation loss decreased (-0.696861 --> -0.765614).  Saving model ...
Epoch: 5 cost time: 0.9616291522979736
Epoch: 5, Steps: 8 | Train Loss: 0.954 Vali Loss: 0.898 Vali Acc: 0.794 Test Loss: 0.898 Test Acc: 0.794
Validation loss decreased (-0.765614 --> -0.793741).  Saving model ...
Epoch: 6 cost time: 1.0122997760772705
Epoch: 6, Steps: 8 | Train Loss: 0.678 Vali Loss: 0.728 Vali Acc: 0.822 Test Loss: 0.728 Test Acc: 0.822
Validation loss decreased (-0.793741 --> -0.821868).  Saving model ...
Epoch: 7 cost time: 1.0009284019470215
Epoch: 7, Steps: 8 | Train Loss: 0.563 Vali Loss: 0.624 Vali Acc: 0.819 Test Loss: 0.624 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9577527046203613
Epoch: 8, Steps: 8 | Train Loss: 0.429 Vali Loss: 0.577 Vali Acc: 0.819 Test Loss: 0.577 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9711580276489258
Epoch: 9, Steps: 8 | Train Loss: 0.343 Vali Loss: 0.555 Vali Acc: 0.819 Test Loss: 0.555 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9494314193725586
Epoch: 10, Steps: 8 | Train Loss: 0.272 Vali Loss: 0.527 Vali Acc: 0.828 Test Loss: 0.527 Test Acc: 0.828
Validation loss decreased (-0.821868 --> -0.828120).  Saving model ...
Epoch: 11 cost time: 0.9545567035675049
Epoch: 11, Steps: 8 | Train Loss: 0.215 Vali Loss: 0.523 Vali Acc: 0.841 Test Loss: 0.523 Test Acc: 0.841
Validation loss decreased (-0.828120 --> -0.840620).  Saving model ...
Epoch: 12 cost time: 0.9323291778564453
Epoch: 12, Steps: 8 | Train Loss: 0.178 Vali Loss: 0.516 Vali Acc: 0.847 Test Loss: 0.516 Test Acc: 0.847
Validation loss decreased (-0.840620 --> -0.846870).  Saving model ...
Epoch: 13 cost time: 1.0918164253234863
Epoch: 13, Steps: 8 | Train Loss: 0.125 Vali Loss: 0.521 Vali Acc: 0.844 Test Loss: 0.521 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9668152332305908
Epoch: 14, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.515 Vali Acc: 0.847 Test Loss: 0.515 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 15 cost time: 1.1690173149108887
Epoch: 15, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.501 Vali Acc: 0.850 Test Loss: 0.501 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 16 cost time: 1.2248964309692383
Epoch: 16, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.505 Vali Acc: 0.850 Test Loss: 0.505 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1998915672302246
Epoch: 17, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.525 Vali Acc: 0.850 Test Loss: 0.525 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1576273441314697
Epoch: 18, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.540 Vali Acc: 0.847 Test Loss: 0.540 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1204164028167725
Epoch: 19, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.529 Vali Acc: 0.856 Test Loss: 0.529 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.856245).  Saving model ...
Epoch: 20 cost time: 1.097400426864624
Epoch: 20, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.536 Vali Acc: 0.856 Test Loss: 0.536 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0987963676452637
Epoch: 21, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.547 Vali Acc: 0.853 Test Loss: 0.547 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0712478160858154
Epoch: 22, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.549 Vali Acc: 0.847 Test Loss: 0.549 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.125899076461792
Epoch: 23, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.554 Vali Acc: 0.847 Test Loss: 0.554 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.113633394241333
Epoch: 24, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.549 Vali Acc: 0.853 Test Loss: 0.549 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.145918846130371
Epoch: 25, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.551 Vali Acc: 0.856 Test Loss: 0.551 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.18658447265625
Epoch: 26, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.553 Vali Acc: 0.856 Test Loss: 0.553 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.2278239727020264
Epoch: 27, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.558 Vali Acc: 0.853 Test Loss: 0.558 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.2511053085327148
Epoch: 28, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.560 Vali Acc: 0.859 Test Loss: 0.560 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859369).  Saving model ...
Epoch: 29 cost time: 1.1756260395050049
Epoch: 29, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.564 Vali Acc: 0.856 Test Loss: 0.564 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.2114105224609375
Epoch: 30, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.573 Vali Acc: 0.856 Test Loss: 0.573 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 213112
model size : 1.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.7157883644104
Epoch: 1, Steps: 8 | Train Loss: 2.171 Vali Loss: 2.147 Vali Acc: 0.169 Test Loss: 2.147 Test Acc: 0.169
Validation loss decreased (inf --> -0.168729).  Saving model ...
Epoch: 2 cost time: 4.301947355270386
Epoch: 2, Steps: 8 | Train Loss: 2.037 Vali Loss: 1.967 Vali Acc: 0.253 Test Loss: 1.967 Test Acc: 0.253
Validation loss decreased (-0.168729 --> -0.253105).  Saving model ...
Epoch: 3 cost time: 4.388044834136963
Epoch: 3, Steps: 8 | Train Loss: 1.809 Vali Loss: 1.735 Vali Acc: 0.494 Test Loss: 1.735 Test Acc: 0.494
Validation loss decreased (-0.253105 --> -0.493733).  Saving model ...
Epoch: 4 cost time: 4.689826011657715
Epoch: 4, Steps: 8 | Train Loss: 1.586 Vali Loss: 1.493 Vali Acc: 0.631 Test Loss: 1.493 Test Acc: 0.631
Validation loss decreased (-0.493733 --> -0.631235).  Saving model ...
Epoch: 5 cost time: 4.7106897830963135
Epoch: 5, Steps: 8 | Train Loss: 1.281 Vali Loss: 1.270 Vali Acc: 0.691 Test Loss: 1.270 Test Acc: 0.691
Validation loss decreased (-0.631235 --> -0.690612).  Saving model ...
Epoch: 6 cost time: 4.7434515953063965
Epoch: 6, Steps: 8 | Train Loss: 1.080 Vali Loss: 1.070 Vali Acc: 0.731 Test Loss: 1.070 Test Acc: 0.731
Validation loss decreased (-0.690612 --> -0.731239).  Saving model ...
Epoch: 7 cost time: 4.494519948959351
Epoch: 7, Steps: 8 | Train Loss: 0.855 Vali Loss: 0.926 Vali Acc: 0.775 Test Loss: 0.926 Test Acc: 0.775
Validation loss decreased (-0.731239 --> -0.774991).  Saving model ...
Epoch: 8 cost time: 4.3340418338775635
Epoch: 8, Steps: 8 | Train Loss: 0.724 Vali Loss: 0.810 Vali Acc: 0.797 Test Loss: 0.810 Test Acc: 0.797
Validation loss decreased (-0.774991 --> -0.796867).  Saving model ...
Epoch: 9 cost time: 4.379997730255127
Epoch: 9, Steps: 8 | Train Loss: 0.558 Vali Loss: 0.720 Vali Acc: 0.809 Test Loss: 0.720 Test Acc: 0.809
Validation loss decreased (-0.796867 --> -0.809368).  Saving model ...
Epoch: 10 cost time: 4.372198820114136
Epoch: 10, Steps: 8 | Train Loss: 0.443 Vali Loss: 0.650 Vali Acc: 0.809 Test Loss: 0.650 Test Acc: 0.809
Validation loss decreased (-0.809368 --> -0.809368).  Saving model ...
Epoch: 11 cost time: 4.390734434127808
Epoch: 11, Steps: 8 | Train Loss: 0.398 Vali Loss: 0.599 Vali Acc: 0.819 Test Loss: 0.599 Test Acc: 0.819
Validation loss decreased (-0.809368 --> -0.818744).  Saving model ...
Epoch: 12 cost time: 4.12219500541687
Epoch: 12, Steps: 8 | Train Loss: 0.314 Vali Loss: 0.562 Vali Acc: 0.825 Test Loss: 0.562 Test Acc: 0.825
Validation loss decreased (-0.818744 --> -0.824994).  Saving model ...
Epoch: 13 cost time: 3.8023862838745117
Epoch: 13, Steps: 8 | Train Loss: 0.269 Vali Loss: 0.539 Vali Acc: 0.828 Test Loss: 0.539 Test Acc: 0.828
Validation loss decreased (-0.824994 --> -0.828120).  Saving model ...
Epoch: 14 cost time: 4.4546120166778564
Epoch: 14, Steps: 8 | Train Loss: 0.221 Vali Loss: 0.524 Vali Acc: 0.838 Test Loss: 0.524 Test Acc: 0.838
Validation loss decreased (-0.828120 --> -0.837495).  Saving model ...
Epoch: 15 cost time: 4.472391605377197
Epoch: 15, Steps: 8 | Train Loss: 0.196 Vali Loss: 0.514 Vali Acc: 0.841 Test Loss: 0.514 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 16 cost time: 4.138525485992432
Epoch: 16, Steps: 8 | Train Loss: 0.148 Vali Loss: 0.511 Vali Acc: 0.841 Test Loss: 0.511 Test Acc: 0.841
Validation loss decreased (-0.840620 --> -0.840620).  Saving model ...
Epoch: 17 cost time: 3.9674220085144043
Epoch: 17, Steps: 8 | Train Loss: 0.126 Vali Loss: 0.505 Vali Acc: 0.844 Test Loss: 0.505 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 18 cost time: 4.1688361167907715
Epoch: 18, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.496 Vali Acc: 0.841 Test Loss: 0.496 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.153954744338989
Epoch: 19, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.504 Vali Acc: 0.844 Test Loss: 0.504 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 20 cost time: 4.441169738769531
Epoch: 20, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.498 Vali Acc: 0.841 Test Loss: 0.498 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.366979122161865
Epoch: 21, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.506 Vali Acc: 0.831 Test Loss: 0.506 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.053424596786499
Epoch: 22, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.513 Vali Acc: 0.825 Test Loss: 0.513 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.254687309265137
Epoch: 23, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.524 Vali Acc: 0.831 Test Loss: 0.524 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 4.074500799179077
Epoch: 24, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.513 Vali Acc: 0.828 Test Loss: 0.513 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 4.080058574676514
Epoch: 25, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.512 Vali Acc: 0.834 Test Loss: 0.512 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 4.480875730514526
Epoch: 26, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.517 Vali Acc: 0.834 Test Loss: 0.517 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 4.465102672576904
Epoch: 27, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.525 Vali Acc: 0.834 Test Loss: 0.525 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 4.040305852890015
Epoch: 28, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.521 Vali Acc: 0.834 Test Loss: 0.521 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 4.024641513824463
Epoch: 29, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.524 Vali Acc: 0.838 Test Loss: 0.524 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 1193472
model size : 4.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.559459447860718
Epoch: 1, Steps: 8 | Train Loss: 2.094 Vali Loss: 2.066 Vali Acc: 0.100 Test Loss: 2.066 Test Acc: 0.100
Validation loss decreased (inf --> -0.099979).  Saving model ...
Epoch: 2 cost time: 2.977092981338501
Epoch: 2, Steps: 8 | Train Loss: 1.980 Vali Loss: 1.931 Vali Acc: 0.216 Test Loss: 1.931 Test Acc: 0.216
Validation loss decreased (-0.099979 --> -0.215606).  Saving model ...
Epoch: 3 cost time: 2.952263832092285
Epoch: 3, Steps: 8 | Train Loss: 1.823 Vali Loss: 1.748 Vali Acc: 0.453 Test Loss: 1.748 Test Acc: 0.453
Validation loss decreased (-0.215606 --> -0.453108).  Saving model ...
Epoch: 4 cost time: 2.7966651916503906
Epoch: 4, Steps: 8 | Train Loss: 1.604 Vali Loss: 1.556 Vali Acc: 0.619 Test Loss: 1.556 Test Acc: 0.619
Validation loss decreased (-0.453108 --> -0.618734).  Saving model ...
Epoch: 5 cost time: 2.862595319747925
Epoch: 5, Steps: 8 | Train Loss: 1.400 Vali Loss: 1.363 Vali Acc: 0.681 Test Loss: 1.363 Test Acc: 0.681
Validation loss decreased (-0.618734 --> -0.681236).  Saving model ...
Epoch: 6 cost time: 2.7498879432678223
Epoch: 6, Steps: 8 | Train Loss: 1.179 Vali Loss: 1.191 Vali Acc: 0.716 Test Loss: 1.191 Test Acc: 0.716
Validation loss decreased (-0.681236 --> -0.715613).  Saving model ...
Epoch: 7 cost time: 2.7021572589874268
Epoch: 7, Steps: 8 | Train Loss: 0.968 Vali Loss: 1.025 Vali Acc: 0.731 Test Loss: 1.025 Test Acc: 0.731
Validation loss decreased (-0.715613 --> -0.731240).  Saving model ...
Epoch: 8 cost time: 2.7472035884857178
Epoch: 8, Steps: 8 | Train Loss: 0.814 Vali Loss: 0.884 Vali Acc: 0.766 Test Loss: 0.884 Test Acc: 0.766
Validation loss decreased (-0.731240 --> -0.765616).  Saving model ...
Epoch: 9 cost time: 2.9611265659332275
Epoch: 9, Steps: 8 | Train Loss: 0.681 Vali Loss: 0.764 Vali Acc: 0.803 Test Loss: 0.764 Test Acc: 0.803
Validation loss decreased (-0.765616 --> -0.803117).  Saving model ...
Epoch: 10 cost time: 3.113612413406372
Epoch: 10, Steps: 8 | Train Loss: 0.546 Vali Loss: 0.678 Vali Acc: 0.834 Test Loss: 0.678 Test Acc: 0.834
Validation loss decreased (-0.803117 --> -0.834368).  Saving model ...
Epoch: 11 cost time: 2.7770862579345703
Epoch: 11, Steps: 8 | Train Loss: 0.440 Vali Loss: 0.620 Vali Acc: 0.847 Test Loss: 0.620 Test Acc: 0.847
Validation loss decreased (-0.834368 --> -0.846869).  Saving model ...
Epoch: 12 cost time: 2.48867130279541
Epoch: 12, Steps: 8 | Train Loss: 0.371 Vali Loss: 0.585 Vali Acc: 0.850 Test Loss: 0.585 Test Acc: 0.850
Validation loss decreased (-0.846869 --> -0.849994).  Saving model ...
Epoch: 13 cost time: 2.4678561687469482
Epoch: 13, Steps: 8 | Train Loss: 0.282 Vali Loss: 0.560 Vali Acc: 0.844 Test Loss: 0.560 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.5831892490386963
Epoch: 14, Steps: 8 | Train Loss: 0.259 Vali Loss: 0.542 Vali Acc: 0.841 Test Loss: 0.542 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.509397029876709
Epoch: 15, Steps: 8 | Train Loss: 0.211 Vali Loss: 0.533 Vali Acc: 0.847 Test Loss: 0.533 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.6601860523223877
Epoch: 16, Steps: 8 | Train Loss: 0.188 Vali Loss: 0.519 Vali Acc: 0.859 Test Loss: 0.519 Test Acc: 0.859
Validation loss decreased (-0.849994 --> -0.859370).  Saving model ...
Epoch: 17 cost time: 2.645625114440918
Epoch: 17, Steps: 8 | Train Loss: 0.171 Vali Loss: 0.512 Vali Acc: 0.850 Test Loss: 0.512 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.6115901470184326
Epoch: 18, Steps: 8 | Train Loss: 0.150 Vali Loss: 0.511 Vali Acc: 0.847 Test Loss: 0.511 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.6111948490142822
Epoch: 19, Steps: 8 | Train Loss: 0.123 Vali Loss: 0.523 Vali Acc: 0.844 Test Loss: 0.523 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.5891637802124023
Epoch: 20, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.528 Vali Acc: 0.850 Test Loss: 0.528 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.5370686054229736
Epoch: 21, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.524 Vali Acc: 0.844 Test Loss: 0.524 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.5357511043548584
Epoch: 22, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.515 Vali Acc: 0.841 Test Loss: 0.515 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.423908233642578
Epoch: 23, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.518 Vali Acc: 0.847 Test Loss: 0.518 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.457839250564575
Epoch: 24, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.528 Vali Acc: 0.847 Test Loss: 0.528 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.6126179695129395
Epoch: 25, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.541 Vali Acc: 0.844 Test Loss: 0.541 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.7190682888031006
Epoch: 26, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.542 Vali Acc: 0.847 Test Loss: 0.542 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 365504
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.386681795120239
Epoch: 1, Steps: 8 | Train Loss: 2.174 Vali Loss: 2.149 Vali Acc: 0.169 Test Loss: 2.149 Test Acc: 0.169
Validation loss decreased (inf --> -0.168729).  Saving model ...
Epoch: 2 cost time: 2.9850504398345947
Epoch: 2, Steps: 8 | Train Loss: 2.045 Vali Loss: 1.984 Vali Acc: 0.253 Test Loss: 1.984 Test Acc: 0.253
Validation loss decreased (-0.168729 --> -0.253105).  Saving model ...
Epoch: 3 cost time: 3.1191670894622803
Epoch: 3, Steps: 8 | Train Loss: 1.826 Vali Loss: 1.767 Vali Acc: 0.469 Test Loss: 1.767 Test Acc: 0.469
Validation loss decreased (-0.253105 --> -0.468732).  Saving model ...
Epoch: 4 cost time: 3.1675448417663574
Epoch: 4, Steps: 8 | Train Loss: 1.604 Vali Loss: 1.539 Vali Acc: 0.556 Test Loss: 1.539 Test Acc: 0.556
Validation loss decreased (-0.468732 --> -0.556235).  Saving model ...
Epoch: 5 cost time: 3.163426637649536
Epoch: 5, Steps: 8 | Train Loss: 1.314 Vali Loss: 1.326 Vali Acc: 0.659 Test Loss: 1.326 Test Acc: 0.659
Validation loss decreased (-0.556235 --> -0.659362).  Saving model ...
Epoch: 6 cost time: 3.1789004802703857
Epoch: 6, Steps: 8 | Train Loss: 1.110 Vali Loss: 1.135 Vali Acc: 0.706 Test Loss: 1.135 Test Acc: 0.706
Validation loss decreased (-0.659362 --> -0.706239).  Saving model ...
Epoch: 7 cost time: 3.108989953994751
Epoch: 7, Steps: 8 | Train Loss: 0.893 Vali Loss: 0.992 Vali Acc: 0.750 Test Loss: 0.992 Test Acc: 0.750
Validation loss decreased (-0.706239 --> -0.749990).  Saving model ...
Epoch: 8 cost time: 2.9892053604125977
Epoch: 8, Steps: 8 | Train Loss: 0.756 Vali Loss: 0.872 Vali Acc: 0.787 Test Loss: 0.872 Test Acc: 0.787
Validation loss decreased (-0.749990 --> -0.787491).  Saving model ...
Epoch: 9 cost time: 2.88917875289917
Epoch: 9, Steps: 8 | Train Loss: 0.592 Vali Loss: 0.779 Vali Acc: 0.816 Test Loss: 0.779 Test Acc: 0.816
Validation loss decreased (-0.787491 --> -0.815617).  Saving model ...
Epoch: 10 cost time: 2.9731736183166504
Epoch: 10, Steps: 8 | Train Loss: 0.463 Vali Loss: 0.704 Vali Acc: 0.822 Test Loss: 0.704 Test Acc: 0.822
Validation loss decreased (-0.815617 --> -0.821868).  Saving model ...
Epoch: 11 cost time: 3.296069383621216
Epoch: 11, Steps: 8 | Train Loss: 0.411 Vali Loss: 0.651 Vali Acc: 0.825 Test Loss: 0.651 Test Acc: 0.825
Validation loss decreased (-0.821868 --> -0.824993).  Saving model ...
Epoch: 12 cost time: 3.306046724319458
Epoch: 12, Steps: 8 | Train Loss: 0.318 Vali Loss: 0.607 Vali Acc: 0.834 Test Loss: 0.607 Test Acc: 0.834
Validation loss decreased (-0.824993 --> -0.834369).  Saving model ...
Epoch: 13 cost time: 3.0976691246032715
Epoch: 13, Steps: 8 | Train Loss: 0.272 Vali Loss: 0.578 Vali Acc: 0.838 Test Loss: 0.578 Test Acc: 0.838
Validation loss decreased (-0.834369 --> -0.837494).  Saving model ...
Epoch: 14 cost time: 2.922553062438965
Epoch: 14, Steps: 8 | Train Loss: 0.218 Vali Loss: 0.557 Vali Acc: 0.844 Test Loss: 0.557 Test Acc: 0.844
Validation loss decreased (-0.837494 --> -0.843744).  Saving model ...
Epoch: 15 cost time: 3.1320037841796875
Epoch: 15, Steps: 8 | Train Loss: 0.194 Vali Loss: 0.548 Vali Acc: 0.847 Test Loss: 0.548 Test Acc: 0.847
Validation loss decreased (-0.843744 --> -0.846870).  Saving model ...
Epoch: 16 cost time: 3.0864553451538086
Epoch: 16, Steps: 8 | Train Loss: 0.149 Vali Loss: 0.548 Vali Acc: 0.850 Test Loss: 0.548 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 17 cost time: 2.950704336166382
Epoch: 17, Steps: 8 | Train Loss: 0.128 Vali Loss: 0.541 Vali Acc: 0.853 Test Loss: 0.541 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 18 cost time: 3.0768730640411377
Epoch: 18, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.536 Vali Acc: 0.838 Test Loss: 0.536 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.182255268096924
Epoch: 19, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.539 Vali Acc: 0.844 Test Loss: 0.539 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.3884449005126953
Epoch: 20, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.532 Vali Acc: 0.847 Test Loss: 0.532 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.9247426986694336
Epoch: 21, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.540 Vali Acc: 0.844 Test Loss: 0.540 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.020099401473999
Epoch: 22, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.546 Vali Acc: 0.841 Test Loss: 0.546 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.9429523944854736
Epoch: 23, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.556 Vali Acc: 0.831 Test Loss: 0.556 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.014202117919922
Epoch: 24, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.549 Vali Acc: 0.838 Test Loss: 0.549 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.203878402709961
Epoch: 25, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.549 Vali Acc: 0.841 Test Loss: 0.549 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.245262861251831
Epoch: 26, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.552 Vali Acc: 0.844 Test Loss: 0.552 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.068413019180298
Epoch: 27, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.560 Vali Acc: 0.841 Test Loss: 0.560 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 1193472
model size : 4.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.646967887878418
Epoch: 1, Steps: 8 | Train Loss: 2.091 Vali Loss: 2.067 Vali Acc: 0.100 Test Loss: 2.067 Test Acc: 0.100
Validation loss decreased (inf --> -0.099979).  Saving model ...
Epoch: 2 cost time: 2.1762142181396484
Epoch: 2, Steps: 8 | Train Loss: 1.980 Vali Loss: 1.932 Vali Acc: 0.212 Test Loss: 1.932 Test Acc: 0.212
Validation loss decreased (-0.099979 --> -0.212481).  Saving model ...
Epoch: 3 cost time: 2.394375801086426
Epoch: 3, Steps: 8 | Train Loss: 1.830 Vali Loss: 1.754 Vali Acc: 0.450 Test Loss: 1.754 Test Acc: 0.450
Validation loss decreased (-0.212481 --> -0.449982).  Saving model ...
Epoch: 4 cost time: 2.4865036010742188
Epoch: 4, Steps: 8 | Train Loss: 1.625 Vali Loss: 1.563 Vali Acc: 0.616 Test Loss: 1.563 Test Acc: 0.616
Validation loss decreased (-0.449982 --> -0.615609).  Saving model ...
Epoch: 5 cost time: 2.4483389854431152
Epoch: 5, Steps: 8 | Train Loss: 1.430 Vali Loss: 1.365 Vali Acc: 0.694 Test Loss: 1.365 Test Acc: 0.694
Validation loss decreased (-0.615609 --> -0.693736).  Saving model ...
Epoch: 6 cost time: 2.25449538230896
Epoch: 6, Steps: 8 | Train Loss: 1.208 Vali Loss: 1.175 Vali Acc: 0.725 Test Loss: 1.175 Test Acc: 0.725
Validation loss decreased (-0.693736 --> -0.724988).  Saving model ...
Epoch: 7 cost time: 2.24377703666687
Epoch: 7, Steps: 8 | Train Loss: 0.980 Vali Loss: 1.000 Vali Acc: 0.766 Test Loss: 1.000 Test Acc: 0.766
Validation loss decreased (-0.724988 --> -0.765615).  Saving model ...
Epoch: 8 cost time: 2.19077730178833
Epoch: 8, Steps: 8 | Train Loss: 0.821 Vali Loss: 0.850 Vali Acc: 0.794 Test Loss: 0.850 Test Acc: 0.794
Validation loss decreased (-0.765615 --> -0.793741).  Saving model ...
Epoch: 9 cost time: 2.2109880447387695
Epoch: 9, Steps: 8 | Train Loss: 0.686 Vali Loss: 0.737 Vali Acc: 0.822 Test Loss: 0.737 Test Acc: 0.822
Validation loss decreased (-0.793741 --> -0.821868).  Saving model ...
Epoch: 10 cost time: 2.3865761756896973
Epoch: 10, Steps: 8 | Train Loss: 0.548 Vali Loss: 0.664 Vali Acc: 0.828 Test Loss: 0.664 Test Acc: 0.828
Validation loss decreased (-0.821868 --> -0.828118).  Saving model ...
Epoch: 11 cost time: 2.2892611026763916
Epoch: 11, Steps: 8 | Train Loss: 0.441 Vali Loss: 0.609 Vali Acc: 0.844 Test Loss: 0.609 Test Acc: 0.844
Validation loss decreased (-0.828118 --> -0.843744).  Saving model ...
Epoch: 12 cost time: 2.382420063018799
Epoch: 12, Steps: 8 | Train Loss: 0.376 Vali Loss: 0.575 Vali Acc: 0.847 Test Loss: 0.575 Test Acc: 0.847
Validation loss decreased (-0.843744 --> -0.846869).  Saving model ...
Epoch: 13 cost time: 2.3885369300842285
Epoch: 13, Steps: 8 | Train Loss: 0.286 Vali Loss: 0.550 Vali Acc: 0.834 Test Loss: 0.550 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.422395706176758
Epoch: 14, Steps: 8 | Train Loss: 0.251 Vali Loss: 0.539 Vali Acc: 0.841 Test Loss: 0.539 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.461038827896118
Epoch: 15, Steps: 8 | Train Loss: 0.207 Vali Loss: 0.531 Vali Acc: 0.844 Test Loss: 0.531 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.4290401935577393
Epoch: 16, Steps: 8 | Train Loss: 0.183 Vali Loss: 0.518 Vali Acc: 0.847 Test Loss: 0.518 Test Acc: 0.847
Validation loss decreased (-0.846869 --> -0.846870).  Saving model ...
Epoch: 17 cost time: 2.32179856300354
Epoch: 17, Steps: 8 | Train Loss: 0.174 Vali Loss: 0.512 Vali Acc: 0.847 Test Loss: 0.512 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 18 cost time: 2.2067151069641113
Epoch: 18, Steps: 8 | Train Loss: 0.150 Vali Loss: 0.509 Vali Acc: 0.847 Test Loss: 0.509 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 19 cost time: 2.2227752208709717
Epoch: 19, Steps: 8 | Train Loss: 0.126 Vali Loss: 0.522 Vali Acc: 0.856 Test Loss: 0.522 Test Acc: 0.856
Validation loss decreased (-0.846870 --> -0.856245).  Saving model ...
Epoch: 20 cost time: 2.1782829761505127
Epoch: 20, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.523 Vali Acc: 0.850 Test Loss: 0.523 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.3619742393493652
Epoch: 21, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.525 Vali Acc: 0.841 Test Loss: 0.525 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.4560186862945557
Epoch: 22, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.519 Vali Acc: 0.847 Test Loss: 0.519 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.431579351425171
Epoch: 23, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.519 Vali Acc: 0.850 Test Loss: 0.519 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.3226213455200195
Epoch: 24, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.526 Vali Acc: 0.847 Test Loss: 0.526 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.245823383331299
Epoch: 25, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.538 Vali Acc: 0.847 Test Loss: 0.538 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.3491203784942627
Epoch: 26, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.536 Vali Acc: 0.847 Test Loss: 0.536 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.253140687942505
Epoch: 27, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.544 Vali Acc: 0.841 Test Loss: 0.544 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.2947587966918945
Epoch: 28, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.549 Vali Acc: 0.838 Test Loss: 0.549 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.3307993412017822
Epoch: 29, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.556 Vali Acc: 0.841 Test Loss: 0.556 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 365504
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.297884225845337
Epoch: 1, Steps: 8 | Train Loss: 2.175 Vali Loss: 2.152 Vali Acc: 0.166 Test Loss: 2.152 Test Acc: 0.166
Validation loss decreased (inf --> -0.165603).  Saving model ...
Epoch: 2 cost time: 2.0221023559570312
Epoch: 2, Steps: 8 | Train Loss: 2.052 Vali Loss: 1.990 Vali Acc: 0.247 Test Loss: 1.990 Test Acc: 0.247
Validation loss decreased (-0.165603 --> -0.246855).  Saving model ...
Epoch: 3 cost time: 1.909306287765503
Epoch: 3, Steps: 8 | Train Loss: 1.842 Vali Loss: 1.778 Vali Acc: 0.450 Test Loss: 1.778 Test Acc: 0.450
Validation loss decreased (-0.246855 --> -0.449982).  Saving model ...
Epoch: 4 cost time: 1.8007407188415527
Epoch: 4, Steps: 8 | Train Loss: 1.632 Vali Loss: 1.551 Vali Acc: 0.544 Test Loss: 1.551 Test Acc: 0.544
Validation loss decreased (-0.449982 --> -0.543734).  Saving model ...
Epoch: 5 cost time: 1.8031666278839111
Epoch: 5, Steps: 8 | Train Loss: 1.353 Vali Loss: 1.339 Vali Acc: 0.641 Test Loss: 1.339 Test Acc: 0.641
Validation loss decreased (-0.543734 --> -0.640612).  Saving model ...
Epoch: 6 cost time: 1.8299195766448975
Epoch: 6, Steps: 8 | Train Loss: 1.148 Vali Loss: 1.144 Vali Acc: 0.709 Test Loss: 1.144 Test Acc: 0.709
Validation loss decreased (-0.640612 --> -0.709364).  Saving model ...
Epoch: 7 cost time: 1.8120660781860352
Epoch: 7, Steps: 8 | Train Loss: 0.930 Vali Loss: 0.998 Vali Acc: 0.750 Test Loss: 0.998 Test Acc: 0.750
Validation loss decreased (-0.709364 --> -0.749990).  Saving model ...
Epoch: 8 cost time: 2.062270164489746
Epoch: 8, Steps: 8 | Train Loss: 0.792 Vali Loss: 0.877 Vali Acc: 0.781 Test Loss: 0.877 Test Acc: 0.781
Validation loss decreased (-0.749990 --> -0.781241).  Saving model ...
Epoch: 9 cost time: 2.008591413497925
Epoch: 9, Steps: 8 | Train Loss: 0.628 Vali Loss: 0.781 Vali Acc: 0.806 Test Loss: 0.781 Test Acc: 0.806
Validation loss decreased (-0.781241 --> -0.806242).  Saving model ...
Epoch: 10 cost time: 1.8976173400878906
Epoch: 10, Steps: 8 | Train Loss: 0.504 Vali Loss: 0.708 Vali Acc: 0.812 Test Loss: 0.708 Test Acc: 0.812
Validation loss decreased (-0.806242 --> -0.812493).  Saving model ...
Epoch: 11 cost time: 1.887709140777588
Epoch: 11, Steps: 8 | Train Loss: 0.451 Vali Loss: 0.650 Vali Acc: 0.819 Test Loss: 0.650 Test Acc: 0.819
Validation loss decreased (-0.812493 --> -0.818743).  Saving model ...
Epoch: 12 cost time: 1.9087262153625488
Epoch: 12, Steps: 8 | Train Loss: 0.365 Vali Loss: 0.611 Vali Acc: 0.825 Test Loss: 0.611 Test Acc: 0.825
Validation loss decreased (-0.818743 --> -0.824994).  Saving model ...
Epoch: 13 cost time: 1.8074522018432617
Epoch: 13, Steps: 8 | Train Loss: 0.323 Vali Loss: 0.588 Vali Acc: 0.828 Test Loss: 0.588 Test Acc: 0.828
Validation loss decreased (-0.824994 --> -0.828119).  Saving model ...
Epoch: 14 cost time: 1.9031057357788086
Epoch: 14, Steps: 8 | Train Loss: 0.258 Vali Loss: 0.571 Vali Acc: 0.844 Test Loss: 0.571 Test Acc: 0.844
Validation loss decreased (-0.828119 --> -0.843744).  Saving model ...
Epoch: 15 cost time: 1.9509811401367188
Epoch: 15, Steps: 8 | Train Loss: 0.238 Vali Loss: 0.559 Vali Acc: 0.841 Test Loss: 0.559 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8876187801361084
Epoch: 16, Steps: 8 | Train Loss: 0.179 Vali Loss: 0.561 Vali Acc: 0.838 Test Loss: 0.561 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.8476593494415283
Epoch: 17, Steps: 8 | Train Loss: 0.154 Vali Loss: 0.554 Vali Acc: 0.841 Test Loss: 0.554 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.9060091972351074
Epoch: 18, Steps: 8 | Train Loss: 0.144 Vali Loss: 0.541 Vali Acc: 0.841 Test Loss: 0.541 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.7899479866027832
Epoch: 19, Steps: 8 | Train Loss: 0.117 Vali Loss: 0.563 Vali Acc: 0.834 Test Loss: 0.563 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.9456257820129395
Epoch: 20, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.543 Vali Acc: 0.841 Test Loss: 0.543 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.7439689636230469
Epoch: 21, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.544 Vali Acc: 0.841 Test Loss: 0.544 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.710829257965088
Epoch: 22, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.557 Vali Acc: 0.834 Test Loss: 0.557 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.8369359970092773
Epoch: 23, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.567 Vali Acc: 0.831 Test Loss: 0.567 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.7538018226623535
Epoch: 24, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.554 Vali Acc: 0.838 Test Loss: 0.554 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 1193472
model size : 4.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.741407871246338
Epoch: 1, Steps: 8 | Train Loss: 2.099 Vali Loss: 2.065 Vali Acc: 0.100 Test Loss: 2.065 Test Acc: 0.100
Validation loss decreased (inf --> -0.099979).  Saving model ...
Epoch: 2 cost time: 1.302933692932129
Epoch: 2, Steps: 8 | Train Loss: 1.981 Vali Loss: 1.935 Vali Acc: 0.216 Test Loss: 1.935 Test Acc: 0.216
Validation loss decreased (-0.099979 --> -0.215606).  Saving model ...
Epoch: 3 cost time: 1.2219460010528564
Epoch: 3, Steps: 8 | Train Loss: 1.841 Vali Loss: 1.762 Vali Acc: 0.438 Test Loss: 1.762 Test Acc: 0.438
Validation loss decreased (-0.215606 --> -0.437482).  Saving model ...
Epoch: 4 cost time: 1.186124324798584
Epoch: 4, Steps: 8 | Train Loss: 1.647 Vali Loss: 1.576 Vali Acc: 0.600 Test Loss: 1.576 Test Acc: 0.600
Validation loss decreased (-0.437482 --> -0.599984).  Saving model ...
Epoch: 5 cost time: 1.1532714366912842
Epoch: 5, Steps: 8 | Train Loss: 1.447 Vali Loss: 1.381 Vali Acc: 0.691 Test Loss: 1.381 Test Acc: 0.691
Validation loss decreased (-0.599984 --> -0.690611).  Saving model ...
Epoch: 6 cost time: 1.139209508895874
Epoch: 6, Steps: 8 | Train Loss: 1.240 Vali Loss: 1.190 Vali Acc: 0.744 Test Loss: 1.190 Test Acc: 0.744
Validation loss decreased (-0.690611 --> -0.743738).  Saving model ...
Epoch: 7 cost time: 1.174621343612671
Epoch: 7, Steps: 8 | Train Loss: 1.005 Vali Loss: 1.012 Vali Acc: 0.762 Test Loss: 1.012 Test Acc: 0.762
Validation loss decreased (-0.743738 --> -0.762490).  Saving model ...
Epoch: 8 cost time: 1.142643928527832
Epoch: 8, Steps: 8 | Train Loss: 0.844 Vali Loss: 0.852 Vali Acc: 0.803 Test Loss: 0.852 Test Acc: 0.803
Validation loss decreased (-0.762490 --> -0.803116).  Saving model ...
Epoch: 9 cost time: 1.134570837020874
Epoch: 9, Steps: 8 | Train Loss: 0.705 Vali Loss: 0.734 Vali Acc: 0.838 Test Loss: 0.734 Test Acc: 0.838
Validation loss decreased (-0.803116 --> -0.837493).  Saving model ...
Epoch: 10 cost time: 1.0877306461334229
Epoch: 10, Steps: 8 | Train Loss: 0.565 Vali Loss: 0.659 Vali Acc: 0.831 Test Loss: 0.659 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1213548183441162
Epoch: 11, Steps: 8 | Train Loss: 0.462 Vali Loss: 0.606 Vali Acc: 0.850 Test Loss: 0.606 Test Acc: 0.850
Validation loss decreased (-0.837493 --> -0.849994).  Saving model ...
Epoch: 12 cost time: 1.233222246170044
Epoch: 12, Steps: 8 | Train Loss: 0.405 Vali Loss: 0.575 Vali Acc: 0.841 Test Loss: 0.575 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2035446166992188
Epoch: 13, Steps: 8 | Train Loss: 0.308 Vali Loss: 0.560 Vali Acc: 0.844 Test Loss: 0.560 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2291333675384521
Epoch: 14, Steps: 8 | Train Loss: 0.277 Vali Loss: 0.552 Vali Acc: 0.841 Test Loss: 0.552 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1973085403442383
Epoch: 15, Steps: 8 | Train Loss: 0.229 Vali Loss: 0.548 Vali Acc: 0.844 Test Loss: 0.548 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2249476909637451
Epoch: 16, Steps: 8 | Train Loss: 0.201 Vali Loss: 0.535 Vali Acc: 0.850 Test Loss: 0.535 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 17 cost time: 1.1224524974822998
Epoch: 17, Steps: 8 | Train Loss: 0.201 Vali Loss: 0.529 Vali Acc: 0.850 Test Loss: 0.529 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 18 cost time: 1.102452039718628
Epoch: 18, Steps: 8 | Train Loss: 0.168 Vali Loss: 0.524 Vali Acc: 0.853 Test Loss: 0.524 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 19 cost time: 1.080944299697876
Epoch: 19, Steps: 8 | Train Loss: 0.143 Vali Loss: 0.535 Vali Acc: 0.859 Test Loss: 0.535 Test Acc: 0.859
Validation loss decreased (-0.853120 --> -0.859370).  Saving model ...
Epoch: 20 cost time: 1.0214614868164062
Epoch: 20, Steps: 8 | Train Loss: 0.120 Vali Loss: 0.533 Vali Acc: 0.850 Test Loss: 0.533 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0378038883209229
Epoch: 21, Steps: 8 | Train Loss: 0.123 Vali Loss: 0.538 Vali Acc: 0.853 Test Loss: 0.538 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9960970878601074
Epoch: 22, Steps: 8 | Train Loss: 0.096 Vali Loss: 0.528 Vali Acc: 0.847 Test Loss: 0.528 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.0105574131011963
Epoch: 23, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.530 Vali Acc: 0.841 Test Loss: 0.530 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.0275561809539795
Epoch: 24, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.541 Vali Acc: 0.850 Test Loss: 0.541 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.092989444732666
Epoch: 25, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.552 Vali Acc: 0.847 Test Loss: 0.552 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.0951995849609375
Epoch: 26, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.549 Vali Acc: 0.844 Test Loss: 0.549 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.0534765720367432
Epoch: 27, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.558 Vali Acc: 0.841 Test Loss: 0.558 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.0749132633209229
Epoch: 28, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.562 Vali Acc: 0.844 Test Loss: 0.562 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.1175308227539062
Epoch: 29, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.566 Vali Acc: 0.847 Test Loss: 0.566 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 365504
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.5976336002349854
Epoch: 1, Steps: 8 | Train Loss: 2.115 Vali Loss: 2.021 Vali Acc: 0.181 Test Loss: 2.021 Test Acc: 0.181
Validation loss decreased (inf --> -0.181230).  Saving model ...
Epoch: 2 cost time: 2.089632272720337
Epoch: 2, Steps: 8 | Train Loss: 1.963 Vali Loss: 1.854 Vali Acc: 0.450 Test Loss: 1.854 Test Acc: 0.450
Validation loss decreased (-0.181230 --> -0.449981).  Saving model ...
Epoch: 3 cost time: 2.204192876815796
Epoch: 3, Steps: 8 | Train Loss: 1.762 Vali Loss: 1.651 Vali Acc: 0.591 Test Loss: 1.651 Test Acc: 0.591
Validation loss decreased (-0.449981 --> -0.590608).  Saving model ...
Epoch: 4 cost time: 2.238286256790161
Epoch: 4, Steps: 8 | Train Loss: 1.549 Vali Loss: 1.440 Vali Acc: 0.703 Test Loss: 1.440 Test Acc: 0.703
Validation loss decreased (-0.590608 --> -0.703111).  Saving model ...
Epoch: 5 cost time: 2.207369804382324
Epoch: 5, Steps: 8 | Train Loss: 1.344 Vali Loss: 1.253 Vali Acc: 0.744 Test Loss: 1.253 Test Acc: 0.744
Validation loss decreased (-0.703111 --> -0.743737).  Saving model ...
Epoch: 6 cost time: 2.0786519050598145
Epoch: 6, Steps: 8 | Train Loss: 1.124 Vali Loss: 1.091 Vali Acc: 0.775 Test Loss: 1.091 Test Acc: 0.775
Validation loss decreased (-0.743737 --> -0.774989).  Saving model ...
Epoch: 7 cost time: 2.0819056034088135
Epoch: 7, Steps: 8 | Train Loss: 0.963 Vali Loss: 0.951 Vali Acc: 0.787 Test Loss: 0.951 Test Acc: 0.787
Validation loss decreased (-0.774989 --> -0.787490).  Saving model ...
Epoch: 8 cost time: 2.0280001163482666
Epoch: 8, Steps: 8 | Train Loss: 0.796 Vali Loss: 0.847 Vali Acc: 0.791 Test Loss: 0.847 Test Acc: 0.791
Validation loss decreased (-0.787490 --> -0.790617).  Saving model ...
Epoch: 9 cost time: 2.140606164932251
Epoch: 9, Steps: 8 | Train Loss: 0.692 Vali Loss: 0.751 Vali Acc: 0.812 Test Loss: 0.751 Test Acc: 0.812
Validation loss decreased (-0.790617 --> -0.812492).  Saving model ...
Epoch: 10 cost time: 2.0857880115509033
Epoch: 10, Steps: 8 | Train Loss: 0.603 Vali Loss: 0.696 Vali Acc: 0.816 Test Loss: 0.696 Test Acc: 0.816
Validation loss decreased (-0.812492 --> -0.815618).  Saving model ...
Epoch: 11 cost time: 2.103222131729126
Epoch: 11, Steps: 8 | Train Loss: 0.519 Vali Loss: 0.654 Vali Acc: 0.819 Test Loss: 0.654 Test Acc: 0.819
Validation loss decreased (-0.815618 --> -0.818743).  Saving model ...
Epoch: 12 cost time: 2.0584278106689453
Epoch: 12, Steps: 8 | Train Loss: 0.401 Vali Loss: 0.629 Vali Acc: 0.816 Test Loss: 0.629 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8803956508636475
Epoch: 13, Steps: 8 | Train Loss: 0.357 Vali Loss: 0.609 Vali Acc: 0.816 Test Loss: 0.609 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6231634616851807
Epoch: 14, Steps: 8 | Train Loss: 0.334 Vali Loss: 0.594 Vali Acc: 0.822 Test Loss: 0.594 Test Acc: 0.822
Validation loss decreased (-0.818743 --> -0.821869).  Saving model ...
Epoch: 15 cost time: 2.4314393997192383
Epoch: 15, Steps: 8 | Train Loss: 0.269 Vali Loss: 0.579 Vali Acc: 0.831 Test Loss: 0.579 Test Acc: 0.831
Validation loss decreased (-0.821869 --> -0.831244).  Saving model ...
Epoch: 16 cost time: 2.309278964996338
Epoch: 16, Steps: 8 | Train Loss: 0.241 Vali Loss: 0.581 Vali Acc: 0.844 Test Loss: 0.581 Test Acc: 0.844
Validation loss decreased (-0.831244 --> -0.843744).  Saving model ...
Epoch: 17 cost time: 2.344179391860962
Epoch: 17, Steps: 8 | Train Loss: 0.211 Vali Loss: 0.570 Vali Acc: 0.816 Test Loss: 0.570 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.11773419380188
Epoch: 18, Steps: 8 | Train Loss: 0.219 Vali Loss: 0.574 Vali Acc: 0.831 Test Loss: 0.574 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.1712818145751953
Epoch: 19, Steps: 8 | Train Loss: 0.173 Vali Loss: 0.565 Vali Acc: 0.822 Test Loss: 0.565 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.136108160018921
Epoch: 20, Steps: 8 | Train Loss: 0.152 Vali Loss: 0.552 Vali Acc: 0.822 Test Loss: 0.552 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.146381139755249
Epoch: 21, Steps: 8 | Train Loss: 0.139 Vali Loss: 0.582 Vali Acc: 0.841 Test Loss: 0.582 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.20540452003479
Epoch: 22, Steps: 8 | Train Loss: 0.121 Vali Loss: 0.571 Vali Acc: 0.828 Test Loss: 0.571 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.3491485118865967
Epoch: 23, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.562 Vali Acc: 0.838 Test Loss: 0.562 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.4207568168640137
Epoch: 24, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.569 Vali Acc: 0.838 Test Loss: 0.569 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.4188778400421143
Epoch: 25, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.572 Vali Acc: 0.844 Test Loss: 0.572 Test Acc: 0.844
Validation loss decreased (-0.843744 --> -0.843744).  Saving model ...
Epoch: 26 cost time: 2.266984224319458
Epoch: 26, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.565 Vali Acc: 0.831 Test Loss: 0.565 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.117964506149292
Epoch: 27, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.583 Vali Acc: 0.841 Test Loss: 0.583 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.2432050704956055
Epoch: 28, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.587 Vali Acc: 0.828 Test Loss: 0.587 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.3415098190307617
Epoch: 29, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.599 Vali Acc: 0.819 Test Loss: 0.599 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.421621561050415
Epoch: 30, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.612 Vali Acc: 0.831 Test Loss: 0.612 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 606976
model size : 2.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.988319158554077
Epoch: 1, Steps: 8 | Train Loss: 2.088 Vali Loss: 2.066 Vali Acc: 0.125 Test Loss: 2.066 Test Acc: 0.125
Validation loss decreased (inf --> -0.124979).  Saving model ...
Epoch: 2 cost time: 1.5038361549377441
Epoch: 2, Steps: 8 | Train Loss: 2.020 Vali Loss: 1.915 Vali Acc: 0.237 Test Loss: 1.915 Test Acc: 0.237
Validation loss decreased (-0.124979 --> -0.237481).  Saving model ...
Epoch: 3 cost time: 1.4267313480377197
Epoch: 3, Steps: 8 | Train Loss: 1.802 Vali Loss: 1.723 Vali Acc: 0.438 Test Loss: 1.723 Test Acc: 0.438
Validation loss decreased (-0.237481 --> -0.437483).  Saving model ...
Epoch: 4 cost time: 1.4616127014160156
Epoch: 4, Steps: 8 | Train Loss: 1.595 Vali Loss: 1.523 Vali Acc: 0.616 Test Loss: 1.523 Test Acc: 0.616
Validation loss decreased (-0.437483 --> -0.615610).  Saving model ...
Epoch: 5 cost time: 1.5517520904541016
Epoch: 5, Steps: 8 | Train Loss: 1.438 Vali Loss: 1.332 Vali Acc: 0.741 Test Loss: 1.332 Test Acc: 0.741
Validation loss decreased (-0.615610 --> -0.740612).  Saving model ...
Epoch: 6 cost time: 1.6729347705841064
Epoch: 6, Steps: 8 | Train Loss: 1.208 Vali Loss: 1.161 Vali Acc: 0.772 Test Loss: 1.161 Test Acc: 0.772
Validation loss decreased (-0.740612 --> -0.771863).  Saving model ...
Epoch: 7 cost time: 1.2163548469543457
Epoch: 7, Steps: 8 | Train Loss: 1.014 Vali Loss: 1.006 Vali Acc: 0.803 Test Loss: 1.006 Test Acc: 0.803
Validation loss decreased (-0.771863 --> -0.803115).  Saving model ...
Epoch: 8 cost time: 1.8268954753875732
Epoch: 8, Steps: 8 | Train Loss: 0.842 Vali Loss: 0.874 Vali Acc: 0.825 Test Loss: 0.874 Test Acc: 0.825
Validation loss decreased (-0.803115 --> -0.824991).  Saving model ...
Epoch: 9 cost time: 1.7191410064697266
Epoch: 9, Steps: 8 | Train Loss: 0.738 Vali Loss: 0.767 Vali Acc: 0.828 Test Loss: 0.767 Test Acc: 0.828
Validation loss decreased (-0.824991 --> -0.828117).  Saving model ...
Epoch: 10 cost time: 1.6106185913085938
Epoch: 10, Steps: 8 | Train Loss: 0.634 Vali Loss: 0.688 Vali Acc: 0.834 Test Loss: 0.688 Test Acc: 0.834
Validation loss decreased (-0.828117 --> -0.834368).  Saving model ...
Epoch: 11 cost time: 1.6043920516967773
Epoch: 11, Steps: 8 | Train Loss: 0.538 Vali Loss: 0.629 Vali Acc: 0.825 Test Loss: 0.629 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6682028770446777
Epoch: 12, Steps: 8 | Train Loss: 0.396 Vali Loss: 0.581 Vali Acc: 0.831 Test Loss: 0.581 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6195602416992188
Epoch: 13, Steps: 8 | Train Loss: 0.341 Vali Loss: 0.548 Vali Acc: 0.844 Test Loss: 0.548 Test Acc: 0.844
Validation loss decreased (-0.834368 --> -0.843745).  Saving model ...
Epoch: 14 cost time: 1.6316657066345215
Epoch: 14, Steps: 8 | Train Loss: 0.341 Vali Loss: 0.527 Vali Acc: 0.834 Test Loss: 0.527 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.693516492843628
Epoch: 15, Steps: 8 | Train Loss: 0.267 Vali Loss: 0.512 Vali Acc: 0.838 Test Loss: 0.512 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.710730791091919
Epoch: 16, Steps: 8 | Train Loss: 0.208 Vali Loss: 0.505 Vali Acc: 0.831 Test Loss: 0.505 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.6959729194641113
Epoch: 17, Steps: 8 | Train Loss: 0.191 Vali Loss: 0.518 Vali Acc: 0.850 Test Loss: 0.518 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849995).  Saving model ...
Epoch: 18 cost time: 1.7206921577453613
Epoch: 18, Steps: 8 | Train Loss: 0.147 Vali Loss: 0.500 Vali Acc: 0.850 Test Loss: 0.500 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 19 cost time: 1.4855518341064453
Epoch: 19, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.502 Vali Acc: 0.844 Test Loss: 0.502 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5269532203674316
Epoch: 20, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.496 Vali Acc: 0.844 Test Loss: 0.496 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5418601036071777
Epoch: 21, Steps: 8 | Train Loss: 0.104 Vali Loss: 0.499 Vali Acc: 0.841 Test Loss: 0.499 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.5682215690612793
Epoch: 22, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.489 Vali Acc: 0.844 Test Loss: 0.489 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.5269105434417725
Epoch: 23, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.485 Vali Acc: 0.844 Test Loss: 0.485 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.5523076057434082
Epoch: 24, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.488 Vali Acc: 0.844 Test Loss: 0.488 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.698617935180664
Epoch: 25, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.502 Vali Acc: 0.841 Test Loss: 0.502 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.7224442958831787
Epoch: 26, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.492 Vali Acc: 0.838 Test Loss: 0.492 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.6496648788452148
Epoch: 27, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.488 Vali Acc: 0.844 Test Loss: 0.488 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.8216657638549805
Epoch: 28, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.507 Vali Acc: 0.844 Test Loss: 0.507 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 192960
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.4734065532684326
Epoch: 1, Steps: 8 | Train Loss: 2.115 Vali Loss: 2.021 Vali Acc: 0.181 Test Loss: 2.021 Test Acc: 0.181
Validation loss decreased (inf --> -0.181230).  Saving model ...
Epoch: 2 cost time: 2.073503255844116
Epoch: 2, Steps: 8 | Train Loss: 1.963 Vali Loss: 1.854 Vali Acc: 0.453 Test Loss: 1.854 Test Acc: 0.453
Validation loss decreased (-0.181230 --> -0.453106).  Saving model ...
Epoch: 3 cost time: 2.2075035572052
Epoch: 3, Steps: 8 | Train Loss: 1.762 Vali Loss: 1.651 Vali Acc: 0.591 Test Loss: 1.651 Test Acc: 0.591
Validation loss decreased (-0.453106 --> -0.590608).  Saving model ...
Epoch: 4 cost time: 2.251028537750244
Epoch: 4, Steps: 8 | Train Loss: 1.549 Vali Loss: 1.440 Vali Acc: 0.703 Test Loss: 1.440 Test Acc: 0.703
Validation loss decreased (-0.590608 --> -0.703111).  Saving model ...
Epoch: 5 cost time: 2.32078218460083
Epoch: 5, Steps: 8 | Train Loss: 1.343 Vali Loss: 1.253 Vali Acc: 0.744 Test Loss: 1.253 Test Acc: 0.744
Validation loss decreased (-0.703111 --> -0.743737).  Saving model ...
Epoch: 6 cost time: 2.1044888496398926
Epoch: 6, Steps: 8 | Train Loss: 1.124 Vali Loss: 1.091 Vali Acc: 0.775 Test Loss: 1.091 Test Acc: 0.775
Validation loss decreased (-0.743737 --> -0.774989).  Saving model ...
Epoch: 7 cost time: 1.981851577758789
Epoch: 7, Steps: 8 | Train Loss: 0.964 Vali Loss: 0.951 Vali Acc: 0.787 Test Loss: 0.951 Test Acc: 0.787
Validation loss decreased (-0.774989 --> -0.787490).  Saving model ...
Epoch: 8 cost time: 1.9444026947021484
Epoch: 8, Steps: 8 | Train Loss: 0.797 Vali Loss: 0.848 Vali Acc: 0.791 Test Loss: 0.848 Test Acc: 0.791
Validation loss decreased (-0.787490 --> -0.790617).  Saving model ...
Epoch: 9 cost time: 2.028412103652954
Epoch: 9, Steps: 8 | Train Loss: 0.693 Vali Loss: 0.752 Vali Acc: 0.809 Test Loss: 0.752 Test Acc: 0.809
Validation loss decreased (-0.790617 --> -0.809367).  Saving model ...
Epoch: 10 cost time: 2.119259834289551
Epoch: 10, Steps: 8 | Train Loss: 0.604 Vali Loss: 0.698 Vali Acc: 0.816 Test Loss: 0.698 Test Acc: 0.816
Validation loss decreased (-0.809367 --> -0.815618).  Saving model ...
Epoch: 11 cost time: 2.2274906635284424
Epoch: 11, Steps: 8 | Train Loss: 0.521 Vali Loss: 0.656 Vali Acc: 0.816 Test Loss: 0.656 Test Acc: 0.816
Validation loss decreased (-0.815618 --> -0.815618).  Saving model ...
Epoch: 12 cost time: 2.2294797897338867
Epoch: 12, Steps: 8 | Train Loss: 0.401 Vali Loss: 0.631 Vali Acc: 0.812 Test Loss: 0.631 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.214341640472412
Epoch: 13, Steps: 8 | Train Loss: 0.357 Vali Loss: 0.609 Vali Acc: 0.816 Test Loss: 0.609 Test Acc: 0.816
Validation loss decreased (-0.815618 --> -0.815619).  Saving model ...
Epoch: 14 cost time: 2.121851921081543
Epoch: 14, Steps: 8 | Train Loss: 0.334 Vali Loss: 0.594 Vali Acc: 0.816 Test Loss: 0.594 Test Acc: 0.816
Validation loss decreased (-0.815619 --> -0.815619).  Saving model ...
Epoch: 15 cost time: 2.1210169792175293
Epoch: 15, Steps: 8 | Train Loss: 0.269 Vali Loss: 0.579 Vali Acc: 0.834 Test Loss: 0.579 Test Acc: 0.834
Validation loss decreased (-0.815619 --> -0.834369).  Saving model ...
Epoch: 16 cost time: 2.0799877643585205
Epoch: 16, Steps: 8 | Train Loss: 0.239 Vali Loss: 0.581 Vali Acc: 0.844 Test Loss: 0.581 Test Acc: 0.844
Validation loss decreased (-0.834369 --> -0.843744).  Saving model ...
Epoch: 17 cost time: 2.0560386180877686
Epoch: 17, Steps: 8 | Train Loss: 0.212 Vali Loss: 0.569 Vali Acc: 0.816 Test Loss: 0.569 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.200493097305298
Epoch: 18, Steps: 8 | Train Loss: 0.219 Vali Loss: 0.574 Vali Acc: 0.828 Test Loss: 0.574 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.1489737033843994
Epoch: 19, Steps: 8 | Train Loss: 0.174 Vali Loss: 0.566 Vali Acc: 0.822 Test Loss: 0.566 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.3055124282836914
Epoch: 20, Steps: 8 | Train Loss: 0.152 Vali Loss: 0.552 Vali Acc: 0.822 Test Loss: 0.552 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.282447576522827
Epoch: 21, Steps: 8 | Train Loss: 0.138 Vali Loss: 0.580 Vali Acc: 0.841 Test Loss: 0.580 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.0269453525543213
Epoch: 22, Steps: 8 | Train Loss: 0.121 Vali Loss: 0.570 Vali Acc: 0.828 Test Loss: 0.570 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.0541176795959473
Epoch: 23, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.561 Vali Acc: 0.834 Test Loss: 0.561 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.030660629272461
Epoch: 24, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.570 Vali Acc: 0.841 Test Loss: 0.570 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.105093479156494
Epoch: 25, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.575 Vali Acc: 0.844 Test Loss: 0.575 Test Acc: 0.844
Validation loss decreased (-0.843744 --> -0.843744).  Saving model ...
Epoch: 26 cost time: 2.2464563846588135
Epoch: 26, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.567 Vali Acc: 0.831 Test Loss: 0.567 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.2275943756103516
Epoch: 27, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.585 Vali Acc: 0.841 Test Loss: 0.585 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.1867051124572754
Epoch: 28, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.589 Vali Acc: 0.828 Test Loss: 0.589 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.3243627548217773
Epoch: 29, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.600 Vali Acc: 0.828 Test Loss: 0.600 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.162508487701416
Epoch: 30, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.612 Vali Acc: 0.834 Test Loss: 0.612 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 606976
model size : 2.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.991501569747925
Epoch: 1, Steps: 8 | Train Loss: 2.091 Vali Loss: 2.067 Vali Acc: 0.125 Test Loss: 2.067 Test Acc: 0.125
Validation loss decreased (inf --> -0.124979).  Saving model ...
Epoch: 2 cost time: 1.480309247970581
Epoch: 2, Steps: 8 | Train Loss: 2.019 Vali Loss: 1.916 Vali Acc: 0.241 Test Loss: 1.916 Test Acc: 0.241
Validation loss decreased (-0.124979 --> -0.240606).  Saving model ...
Epoch: 3 cost time: 1.5142173767089844
Epoch: 3, Steps: 8 | Train Loss: 1.805 Vali Loss: 1.725 Vali Acc: 0.431 Test Loss: 1.725 Test Acc: 0.431
Validation loss decreased (-0.240606 --> -0.431233).  Saving model ...
Epoch: 4 cost time: 1.5078105926513672
Epoch: 4, Steps: 8 | Train Loss: 1.597 Vali Loss: 1.525 Vali Acc: 0.622 Test Loss: 1.525 Test Acc: 0.622
Validation loss decreased (-0.431233 --> -0.621860).  Saving model ...
Epoch: 5 cost time: 1.4195160865783691
Epoch: 5, Steps: 8 | Train Loss: 1.438 Vali Loss: 1.335 Vali Acc: 0.741 Test Loss: 1.335 Test Acc: 0.741
Validation loss decreased (-0.621860 --> -0.740612).  Saving model ...
Epoch: 6 cost time: 1.4337339401245117
Epoch: 6, Steps: 8 | Train Loss: 1.209 Vali Loss: 1.165 Vali Acc: 0.769 Test Loss: 1.165 Test Acc: 0.769
Validation loss decreased (-0.740612 --> -0.768738).  Saving model ...
Epoch: 7 cost time: 1.343085765838623
Epoch: 7, Steps: 8 | Train Loss: 1.011 Vali Loss: 1.010 Vali Acc: 0.800 Test Loss: 1.010 Test Acc: 0.800
Validation loss decreased (-0.768738 --> -0.799990).  Saving model ...
Epoch: 8 cost time: 1.3961799144744873
Epoch: 8, Steps: 8 | Train Loss: 0.840 Vali Loss: 0.880 Vali Acc: 0.822 Test Loss: 0.880 Test Acc: 0.822
Validation loss decreased (-0.799990 --> -0.821866).  Saving model ...
Epoch: 9 cost time: 1.4777629375457764
Epoch: 9, Steps: 8 | Train Loss: 0.738 Vali Loss: 0.773 Vali Acc: 0.828 Test Loss: 0.773 Test Acc: 0.828
Validation loss decreased (-0.821866 --> -0.828117).  Saving model ...
Epoch: 10 cost time: 1.4318046569824219
Epoch: 10, Steps: 8 | Train Loss: 0.631 Vali Loss: 0.694 Vali Acc: 0.831 Test Loss: 0.694 Test Acc: 0.831
Validation loss decreased (-0.828117 --> -0.831243).  Saving model ...
Epoch: 11 cost time: 1.496819257736206
Epoch: 11, Steps: 8 | Train Loss: 0.537 Vali Loss: 0.635 Vali Acc: 0.822 Test Loss: 0.635 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5118935108184814
Epoch: 12, Steps: 8 | Train Loss: 0.395 Vali Loss: 0.587 Vali Acc: 0.834 Test Loss: 0.587 Test Acc: 0.834
Validation loss decreased (-0.831243 --> -0.834369).  Saving model ...
Epoch: 13 cost time: 1.6822168827056885
Epoch: 13, Steps: 8 | Train Loss: 0.340 Vali Loss: 0.555 Vali Acc: 0.844 Test Loss: 0.555 Test Acc: 0.844
Validation loss decreased (-0.834369 --> -0.843744).  Saving model ...
Epoch: 14 cost time: 1.7271342277526855
Epoch: 14, Steps: 8 | Train Loss: 0.340 Vali Loss: 0.535 Vali Acc: 0.831 Test Loss: 0.535 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7226357460021973
Epoch: 15, Steps: 8 | Train Loss: 0.267 Vali Loss: 0.519 Vali Acc: 0.838 Test Loss: 0.519 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3984620571136475
Epoch: 16, Steps: 8 | Train Loss: 0.206 Vali Loss: 0.513 Vali Acc: 0.841 Test Loss: 0.513 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.4192183017730713
Epoch: 17, Steps: 8 | Train Loss: 0.191 Vali Loss: 0.524 Vali Acc: 0.850 Test Loss: 0.524 Test Acc: 0.850
Validation loss decreased (-0.843744 --> -0.849995).  Saving model ...
Epoch: 18 cost time: 1.3848042488098145
Epoch: 18, Steps: 8 | Train Loss: 0.147 Vali Loss: 0.508 Vali Acc: 0.847 Test Loss: 0.508 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3947982788085938
Epoch: 19, Steps: 8 | Train Loss: 0.127 Vali Loss: 0.513 Vali Acc: 0.838 Test Loss: 0.513 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.4263947010040283
Epoch: 20, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.507 Vali Acc: 0.841 Test Loss: 0.507 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.6048660278320312
Epoch: 21, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.510 Vali Acc: 0.841 Test Loss: 0.510 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.5619838237762451
Epoch: 22, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.501 Vali Acc: 0.838 Test Loss: 0.501 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.574904203414917
Epoch: 23, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.498 Vali Acc: 0.834 Test Loss: 0.498 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.5287773609161377
Epoch: 24, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.503 Vali Acc: 0.841 Test Loss: 0.503 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.319742202758789
Epoch: 25, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.518 Vali Acc: 0.834 Test Loss: 0.518 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.3370122909545898
Epoch: 26, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.508 Vali Acc: 0.834 Test Loss: 0.508 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.3267247676849365
Epoch: 27, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.507 Vali Acc: 0.841 Test Loss: 0.507 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 192960
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.7655327320098877
Epoch: 1, Steps: 8 | Train Loss: 2.117 Vali Loss: 2.022 Vali Acc: 0.181 Test Loss: 2.022 Test Acc: 0.181
Validation loss decreased (inf --> -0.181230).  Saving model ...
Epoch: 2 cost time: 1.4456751346588135
Epoch: 2, Steps: 8 | Train Loss: 1.971 Vali Loss: 1.859 Vali Acc: 0.447 Test Loss: 1.859 Test Acc: 0.447
Validation loss decreased (-0.181230 --> -0.446856).  Saving model ...
Epoch: 3 cost time: 1.4767675399780273
Epoch: 3, Steps: 8 | Train Loss: 1.771 Vali Loss: 1.661 Vali Acc: 0.594 Test Loss: 1.661 Test Acc: 0.594
Validation loss decreased (-0.446856 --> -0.593733).  Saving model ...
Epoch: 4 cost time: 1.4489405155181885
Epoch: 4, Steps: 8 | Train Loss: 1.561 Vali Loss: 1.455 Vali Acc: 0.697 Test Loss: 1.455 Test Acc: 0.697
Validation loss decreased (-0.593733 --> -0.696860).  Saving model ...
Epoch: 5 cost time: 1.2695860862731934
Epoch: 5, Steps: 8 | Train Loss: 1.361 Vali Loss: 1.272 Vali Acc: 0.741 Test Loss: 1.272 Test Acc: 0.741
Validation loss decreased (-0.696860 --> -0.740612).  Saving model ...
Epoch: 6 cost time: 1.2837190628051758
Epoch: 6, Steps: 8 | Train Loss: 1.142 Vali Loss: 1.113 Vali Acc: 0.769 Test Loss: 1.113 Test Acc: 0.769
Validation loss decreased (-0.740612 --> -0.768739).  Saving model ...
Epoch: 7 cost time: 1.2798190116882324
Epoch: 7, Steps: 8 | Train Loss: 0.984 Vali Loss: 0.975 Vali Acc: 0.784 Test Loss: 0.975 Test Acc: 0.784
Validation loss decreased (-0.768739 --> -0.784365).  Saving model ...
Epoch: 8 cost time: 1.3130929470062256
Epoch: 8, Steps: 8 | Train Loss: 0.820 Vali Loss: 0.873 Vali Acc: 0.791 Test Loss: 0.873 Test Acc: 0.791
Validation loss decreased (-0.784365 --> -0.790616).  Saving model ...
Epoch: 9 cost time: 1.312087059020996
Epoch: 9, Steps: 8 | Train Loss: 0.722 Vali Loss: 0.778 Vali Acc: 0.803 Test Loss: 0.778 Test Acc: 0.803
Validation loss decreased (-0.790616 --> -0.803117).  Saving model ...
Epoch: 10 cost time: 1.3849284648895264
Epoch: 10, Steps: 8 | Train Loss: 0.631 Vali Loss: 0.722 Vali Acc: 0.806 Test Loss: 0.722 Test Acc: 0.806
Validation loss decreased (-0.803117 --> -0.806243).  Saving model ...
Epoch: 11 cost time: 1.517258882522583
Epoch: 11, Steps: 8 | Train Loss: 0.555 Vali Loss: 0.677 Vali Acc: 0.803 Test Loss: 0.677 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.416175127029419
Epoch: 12, Steps: 8 | Train Loss: 0.433 Vali Loss: 0.649 Vali Acc: 0.816 Test Loss: 0.649 Test Acc: 0.816
Validation loss decreased (-0.806243 --> -0.815619).  Saving model ...
Epoch: 13 cost time: 1.4526424407958984
Epoch: 13, Steps: 8 | Train Loss: 0.390 Vali Loss: 0.626 Vali Acc: 0.809 Test Loss: 0.626 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.452812671661377
Epoch: 14, Steps: 8 | Train Loss: 0.356 Vali Loss: 0.610 Vali Acc: 0.812 Test Loss: 0.610 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3280081748962402
Epoch: 15, Steps: 8 | Train Loss: 0.292 Vali Loss: 0.597 Vali Acc: 0.816 Test Loss: 0.597 Test Acc: 0.816
Validation loss decreased (-0.815619 --> -0.815619).  Saving model ...
Epoch: 16 cost time: 1.3318028450012207
Epoch: 16, Steps: 8 | Train Loss: 0.273 Vali Loss: 0.599 Vali Acc: 0.822 Test Loss: 0.599 Test Acc: 0.822
Validation loss decreased (-0.815619 --> -0.821869).  Saving model ...
Epoch: 17 cost time: 1.0666842460632324
Epoch: 17, Steps: 8 | Train Loss: 0.235 Vali Loss: 0.583 Vali Acc: 0.819 Test Loss: 0.583 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4153656959533691
Epoch: 18, Steps: 8 | Train Loss: 0.227 Vali Loss: 0.591 Vali Acc: 0.825 Test Loss: 0.591 Test Acc: 0.825
Validation loss decreased (-0.821869 --> -0.824994).  Saving model ...
Epoch: 19 cost time: 1.300910472869873
Epoch: 19, Steps: 8 | Train Loss: 0.185 Vali Loss: 0.584 Vali Acc: 0.828 Test Loss: 0.584 Test Acc: 0.828
Validation loss decreased (-0.824994 --> -0.828119).  Saving model ...
Epoch: 20 cost time: 1.363461971282959
Epoch: 20, Steps: 8 | Train Loss: 0.165 Vali Loss: 0.566 Vali Acc: 0.822 Test Loss: 0.566 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.499732255935669
Epoch: 21, Steps: 8 | Train Loss: 0.147 Vali Loss: 0.598 Vali Acc: 0.841 Test Loss: 0.598 Test Acc: 0.841
Validation loss decreased (-0.828119 --> -0.840619).  Saving model ...
Epoch: 22 cost time: 1.517139196395874
Epoch: 22, Steps: 8 | Train Loss: 0.132 Vali Loss: 0.582 Vali Acc: 0.822 Test Loss: 0.582 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3464808464050293
Epoch: 23, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.571 Vali Acc: 0.831 Test Loss: 0.571 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.4604713916778564
Epoch: 24, Steps: 8 | Train Loss: 0.099 Vali Loss: 0.577 Vali Acc: 0.834 Test Loss: 0.577 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.24405837059021
Epoch: 25, Steps: 8 | Train Loss: 0.104 Vali Loss: 0.584 Vali Acc: 0.841 Test Loss: 0.584 Test Acc: 0.841
Validation loss decreased (-0.840619 --> -0.840619).  Saving model ...
Epoch: 26 cost time: 1.4607579708099365
Epoch: 26, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.579 Vali Acc: 0.828 Test Loss: 0.579 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.4902780055999756
Epoch: 27, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.600 Vali Acc: 0.834 Test Loss: 0.600 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.4425640106201172
Epoch: 28, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.602 Vali Acc: 0.838 Test Loss: 0.602 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.3914196491241455
Epoch: 29, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.615 Vali Acc: 0.838 Test Loss: 0.615 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.2765169143676758
Epoch: 30, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.633 Vali Acc: 0.838 Test Loss: 0.633 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.840625
model parameter : 606976
model size : 2.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.4310531616210938
Epoch: 1, Steps: 8 | Train Loss: 2.085 Vali Loss: 2.062 Vali Acc: 0.122 Test Loss: 2.062 Test Acc: 0.122
Validation loss decreased (inf --> -0.121854).  Saving model ...
Epoch: 2 cost time: 1.1688339710235596
Epoch: 2, Steps: 8 | Train Loss: 2.010 Vali Loss: 1.915 Vali Acc: 0.222 Test Loss: 1.915 Test Acc: 0.222
Validation loss decreased (-0.121854 --> -0.221856).  Saving model ...
Epoch: 3 cost time: 1.0393261909484863
Epoch: 3, Steps: 8 | Train Loss: 1.803 Vali Loss: 1.724 Vali Acc: 0.431 Test Loss: 1.724 Test Acc: 0.431
Validation loss decreased (-0.221856 --> -0.431233).  Saving model ...
Epoch: 4 cost time: 1.018848180770874
Epoch: 4, Steps: 8 | Train Loss: 1.596 Vali Loss: 1.528 Vali Acc: 0.619 Test Loss: 1.528 Test Acc: 0.619
Validation loss decreased (-0.431233 --> -0.618735).  Saving model ...
Epoch: 5 cost time: 1.0058722496032715
Epoch: 5, Steps: 8 | Train Loss: 1.449 Vali Loss: 1.342 Vali Acc: 0.713 Test Loss: 1.342 Test Acc: 0.713
Validation loss decreased (-0.618735 --> -0.712487).  Saving model ...
Epoch: 6 cost time: 0.9679350852966309
Epoch: 6, Steps: 8 | Train Loss: 1.226 Vali Loss: 1.183 Vali Acc: 0.744 Test Loss: 1.183 Test Acc: 0.744
Validation loss decreased (-0.712487 --> -0.743738).  Saving model ...
Epoch: 7 cost time: 0.9565451145172119
Epoch: 7, Steps: 8 | Train Loss: 1.028 Vali Loss: 1.029 Vali Acc: 0.775 Test Loss: 1.029 Test Acc: 0.775
Validation loss decreased (-0.743738 --> -0.774990).  Saving model ...
Epoch: 8 cost time: 1.0234076976776123
Epoch: 8, Steps: 8 | Train Loss: 0.857 Vali Loss: 0.897 Vali Acc: 0.809 Test Loss: 0.897 Test Acc: 0.809
Validation loss decreased (-0.774990 --> -0.809366).  Saving model ...
Epoch: 9 cost time: 0.9696333408355713
Epoch: 9, Steps: 8 | Train Loss: 0.759 Vali Loss: 0.788 Vali Acc: 0.806 Test Loss: 0.788 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0494086742401123
Epoch: 10, Steps: 8 | Train Loss: 0.654 Vali Loss: 0.705 Vali Acc: 0.812 Test Loss: 0.705 Test Acc: 0.812
Validation loss decreased (-0.809366 --> -0.812493).  Saving model ...
Epoch: 11 cost time: 0.9427096843719482
Epoch: 11, Steps: 8 | Train Loss: 0.556 Vali Loss: 0.647 Vali Acc: 0.825 Test Loss: 0.647 Test Acc: 0.825
Validation loss decreased (-0.812493 --> -0.824994).  Saving model ...
Epoch: 12 cost time: 0.9459290504455566
Epoch: 12, Steps: 8 | Train Loss: 0.413 Vali Loss: 0.598 Vali Acc: 0.822 Test Loss: 0.598 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9235312938690186
Epoch: 13, Steps: 8 | Train Loss: 0.360 Vali Loss: 0.569 Vali Acc: 0.822 Test Loss: 0.569 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9504916667938232
Epoch: 14, Steps: 8 | Train Loss: 0.359 Vali Loss: 0.548 Vali Acc: 0.825 Test Loss: 0.548 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824995).  Saving model ...
Epoch: 15 cost time: 0.9417755603790283
Epoch: 15, Steps: 8 | Train Loss: 0.282 Vali Loss: 0.535 Vali Acc: 0.828 Test Loss: 0.535 Test Acc: 0.828
Validation loss decreased (-0.824995 --> -0.828120).  Saving model ...
Epoch: 16 cost time: 0.9551956653594971
Epoch: 16, Steps: 8 | Train Loss: 0.225 Vali Loss: 0.530 Vali Acc: 0.831 Test Loss: 0.530 Test Acc: 0.831
Validation loss decreased (-0.828120 --> -0.831245).  Saving model ...
Epoch: 17 cost time: 1.0167391300201416
Epoch: 17, Steps: 8 | Train Loss: 0.201 Vali Loss: 0.543 Vali Acc: 0.844 Test Loss: 0.543 Test Acc: 0.844
Validation loss decreased (-0.831245 --> -0.843745).  Saving model ...
Epoch: 18 cost time: 0.9815847873687744
Epoch: 18, Steps: 8 | Train Loss: 0.159 Vali Loss: 0.525 Vali Acc: 0.841 Test Loss: 0.525 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0814392566680908
Epoch: 19, Steps: 8 | Train Loss: 0.139 Vali Loss: 0.531 Vali Acc: 0.841 Test Loss: 0.531 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1934230327606201
Epoch: 20, Steps: 8 | Train Loss: 0.141 Vali Loss: 0.527 Vali Acc: 0.847 Test Loss: 0.527 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 21 cost time: 1.1014394760131836
Epoch: 21, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.533 Vali Acc: 0.853 Test Loss: 0.533 Test Acc: 0.853
Validation loss decreased (-0.846870 --> -0.853120).  Saving model ...
Epoch: 22 cost time: 1.1438219547271729
Epoch: 22, Steps: 8 | Train Loss: 0.096 Vali Loss: 0.524 Vali Acc: 0.844 Test Loss: 0.524 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.142021656036377
Epoch: 23, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.524 Vali Acc: 0.844 Test Loss: 0.524 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1311476230621338
Epoch: 24, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.528 Vali Acc: 0.841 Test Loss: 0.528 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.1880371570587158
Epoch: 25, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.543 Vali Acc: 0.838 Test Loss: 0.543 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.1829407215118408
Epoch: 26, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.530 Vali Acc: 0.834 Test Loss: 0.530 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.1135673522949219
Epoch: 27, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.529 Vali Acc: 0.844 Test Loss: 0.529 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.1993579864501953
Epoch: 28, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.556 Vali Acc: 0.847 Test Loss: 0.556 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.1276488304138184
Epoch: 29, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.557 Vali Acc: 0.844 Test Loss: 0.557 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.12929368019104
Epoch: 30, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.544 Vali Acc: 0.844 Test Loss: 0.544 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 192960
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.605935573577881
Epoch: 1, Steps: 8 | Train Loss: 2.124 Vali Loss: 2.041 Vali Acc: 0.194 Test Loss: 2.041 Test Acc: 0.194
Validation loss decreased (inf --> -0.193730).  Saving model ...
Epoch: 2 cost time: 2.294602632522583
Epoch: 2, Steps: 8 | Train Loss: 2.028 Vali Loss: 1.877 Vali Acc: 0.359 Test Loss: 1.877 Test Acc: 0.359
Validation loss decreased (-0.193730 --> -0.359356).  Saving model ...
Epoch: 3 cost time: 2.2497713565826416
Epoch: 3, Steps: 8 | Train Loss: 1.804 Vali Loss: 1.672 Vali Acc: 0.544 Test Loss: 1.672 Test Acc: 0.544
Validation loss decreased (-0.359356 --> -0.543733).  Saving model ...
Epoch: 4 cost time: 2.1943676471710205
Epoch: 4, Steps: 8 | Train Loss: 1.599 Vali Loss: 1.459 Vali Acc: 0.628 Test Loss: 1.459 Test Acc: 0.628
Validation loss decreased (-0.543733 --> -0.628110).  Saving model ...
Epoch: 5 cost time: 2.271190881729126
Epoch: 5, Steps: 8 | Train Loss: 1.370 Vali Loss: 1.261 Vali Acc: 0.681 Test Loss: 1.261 Test Acc: 0.681
Validation loss decreased (-0.628110 --> -0.681237).  Saving model ...
Epoch: 6 cost time: 2.3225393295288086
Epoch: 6, Steps: 8 | Train Loss: 1.152 Vali Loss: 1.084 Vali Acc: 0.725 Test Loss: 1.084 Test Acc: 0.725
Validation loss decreased (-0.681237 --> -0.724989).  Saving model ...
Epoch: 7 cost time: 2.2579643726348877
Epoch: 7, Steps: 8 | Train Loss: 0.964 Vali Loss: 0.945 Vali Acc: 0.741 Test Loss: 0.945 Test Acc: 0.741
Validation loss decreased (-0.724989 --> -0.740616).  Saving model ...
Epoch: 8 cost time: 2.296265125274658
Epoch: 8, Steps: 8 | Train Loss: 0.820 Vali Loss: 0.834 Vali Acc: 0.759 Test Loss: 0.834 Test Acc: 0.759
Validation loss decreased (-0.740616 --> -0.759367).  Saving model ...
Epoch: 9 cost time: 2.2630233764648438
Epoch: 9, Steps: 8 | Train Loss: 0.687 Vali Loss: 0.737 Vali Acc: 0.800 Test Loss: 0.737 Test Acc: 0.800
Validation loss decreased (-0.759367 --> -0.799993).  Saving model ...
Epoch: 10 cost time: 2.2582345008850098
Epoch: 10, Steps: 8 | Train Loss: 0.587 Vali Loss: 0.672 Vali Acc: 0.800 Test Loss: 0.672 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 11 cost time: 2.2072019577026367
Epoch: 11, Steps: 8 | Train Loss: 0.491 Vali Loss: 0.616 Vali Acc: 0.822 Test Loss: 0.616 Test Acc: 0.822
Validation loss decreased (-0.799993 --> -0.821869).  Saving model ...
Epoch: 12 cost time: 2.324352741241455
Epoch: 12, Steps: 8 | Train Loss: 0.413 Vali Loss: 0.583 Vali Acc: 0.816 Test Loss: 0.583 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.2517638206481934
Epoch: 13, Steps: 8 | Train Loss: 0.371 Vali Loss: 0.570 Vali Acc: 0.816 Test Loss: 0.570 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.2657856941223145
Epoch: 14, Steps: 8 | Train Loss: 0.302 Vali Loss: 0.554 Vali Acc: 0.816 Test Loss: 0.554 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.1286916732788086
Epoch: 15, Steps: 8 | Train Loss: 0.283 Vali Loss: 0.550 Vali Acc: 0.816 Test Loss: 0.550 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.1663951873779297
Epoch: 16, Steps: 8 | Train Loss: 0.225 Vali Loss: 0.533 Vali Acc: 0.819 Test Loss: 0.533 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.238586187362671
Epoch: 17, Steps: 8 | Train Loss: 0.210 Vali Loss: 0.532 Vali Acc: 0.825 Test Loss: 0.532 Test Acc: 0.825
Validation loss decreased (-0.821869 --> -0.824995).  Saving model ...
Epoch: 18 cost time: 2.41768479347229
Epoch: 18, Steps: 8 | Train Loss: 0.183 Vali Loss: 0.527 Vali Acc: 0.819 Test Loss: 0.527 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.454360246658325
Epoch: 19, Steps: 8 | Train Loss: 0.161 Vali Loss: 0.521 Vali Acc: 0.831 Test Loss: 0.521 Test Acc: 0.831
Validation loss decreased (-0.824995 --> -0.831245).  Saving model ...
Epoch: 20 cost time: 2.341526746749878
Epoch: 20, Steps: 8 | Train Loss: 0.141 Vali Loss: 0.516 Vali Acc: 0.825 Test Loss: 0.516 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.263740301132202
Epoch: 21, Steps: 8 | Train Loss: 0.126 Vali Loss: 0.520 Vali Acc: 0.825 Test Loss: 0.520 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.1674563884735107
Epoch: 22, Steps: 8 | Train Loss: 0.122 Vali Loss: 0.517 Vali Acc: 0.828 Test Loss: 0.517 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.2112202644348145
Epoch: 23, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.535 Vali Acc: 0.828 Test Loss: 0.535 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.2453436851501465
Epoch: 24, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.545 Vali Acc: 0.838 Test Loss: 0.545 Test Acc: 0.838
Validation loss decreased (-0.831245 --> -0.837495).  Saving model ...
Epoch: 25 cost time: 2.3401870727539062
Epoch: 25, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.533 Vali Acc: 0.834 Test Loss: 0.533 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.5015156269073486
Epoch: 26, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.539 Vali Acc: 0.834 Test Loss: 0.539 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.315650701522827
Epoch: 27, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.552 Vali Acc: 0.844 Test Loss: 0.552 Test Acc: 0.844
Validation loss decreased (-0.837495 --> -0.843744).  Saving model ...
Epoch: 28 cost time: 2.2589731216430664
Epoch: 28, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.544 Vali Acc: 0.844 Test Loss: 0.544 Test Acc: 0.844
Validation loss decreased (-0.843744 --> -0.843745).  Saving model ...
Epoch: 29 cost time: 2.182969808578491
Epoch: 29, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.534 Vali Acc: 0.844 Test Loss: 0.534 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 30 cost time: 2.227057456970215
Epoch: 30, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.541 Vali Acc: 0.844 Test Loss: 0.541 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 313728
model size : 1.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.0302364826202393
Epoch: 1, Steps: 8 | Train Loss: 2.121 Vali Loss: 2.057 Vali Acc: 0.256 Test Loss: 2.057 Test Acc: 0.256
Validation loss decreased (inf --> -0.256229).  Saving model ...
Epoch: 2 cost time: 1.5597732067108154
Epoch: 2, Steps: 8 | Train Loss: 2.011 Vali Loss: 1.899 Vali Acc: 0.394 Test Loss: 1.899 Test Acc: 0.394
Validation loss decreased (-0.256229 --> -0.393731).  Saving model ...
Epoch: 3 cost time: 1.4216563701629639
Epoch: 3, Steps: 8 | Train Loss: 1.832 Vali Loss: 1.701 Vali Acc: 0.534 Test Loss: 1.701 Test Acc: 0.534
Validation loss decreased (-0.393731 --> -0.534358).  Saving model ...
Epoch: 4 cost time: 1.4926421642303467
Epoch: 4, Steps: 8 | Train Loss: 1.609 Vali Loss: 1.487 Vali Acc: 0.644 Test Loss: 1.487 Test Acc: 0.644
Validation loss decreased (-0.534358 --> -0.643735).  Saving model ...
Epoch: 5 cost time: 1.4704852104187012
Epoch: 5, Steps: 8 | Train Loss: 1.358 Vali Loss: 1.286 Vali Acc: 0.741 Test Loss: 1.286 Test Acc: 0.741
Validation loss decreased (-0.643735 --> -0.740612).  Saving model ...
Epoch: 6 cost time: 1.5255646705627441
Epoch: 6, Steps: 8 | Train Loss: 1.146 Vali Loss: 1.110 Vali Acc: 0.778 Test Loss: 1.110 Test Acc: 0.778
Validation loss decreased (-0.740612 --> -0.778114).  Saving model ...
Epoch: 7 cost time: 1.5454773902893066
Epoch: 7, Steps: 8 | Train Loss: 0.961 Vali Loss: 0.952 Vali Acc: 0.781 Test Loss: 0.952 Test Acc: 0.781
Validation loss decreased (-0.778114 --> -0.781240).  Saving model ...
Epoch: 8 cost time: 1.6131701469421387
Epoch: 8, Steps: 8 | Train Loss: 0.832 Vali Loss: 0.825 Vali Acc: 0.803 Test Loss: 0.825 Test Acc: 0.803
Validation loss decreased (-0.781240 --> -0.803117).  Saving model ...
Epoch: 9 cost time: 1.6225569248199463
Epoch: 9, Steps: 8 | Train Loss: 0.670 Vali Loss: 0.720 Vali Acc: 0.812 Test Loss: 0.720 Test Acc: 0.812
Validation loss decreased (-0.803117 --> -0.812493).  Saving model ...
Epoch: 10 cost time: 1.464444637298584
Epoch: 10, Steps: 8 | Train Loss: 0.520 Vali Loss: 0.641 Vali Acc: 0.834 Test Loss: 0.641 Test Acc: 0.834
Validation loss decreased (-0.812493 --> -0.834369).  Saving model ...
Epoch: 11 cost time: 1.318802833557129
Epoch: 11, Steps: 8 | Train Loss: 0.437 Vali Loss: 0.579 Vali Acc: 0.844 Test Loss: 0.579 Test Acc: 0.844
Validation loss decreased (-0.834369 --> -0.843744).  Saving model ...
Epoch: 12 cost time: 1.4848601818084717
Epoch: 12, Steps: 8 | Train Loss: 0.365 Vali Loss: 0.538 Vali Acc: 0.847 Test Loss: 0.538 Test Acc: 0.847
Validation loss decreased (-0.843744 --> -0.846870).  Saving model ...
Epoch: 13 cost time: 1.53666090965271
Epoch: 13, Steps: 8 | Train Loss: 0.297 Vali Loss: 0.509 Vali Acc: 0.856 Test Loss: 0.509 Test Acc: 0.856
Validation loss decreased (-0.846870 --> -0.856245).  Saving model ...
Epoch: 14 cost time: 1.4786992073059082
Epoch: 14, Steps: 8 | Train Loss: 0.251 Vali Loss: 0.488 Vali Acc: 0.869 Test Loss: 0.488 Test Acc: 0.869
Validation loss decreased (-0.856245 --> -0.868745).  Saving model ...
Epoch: 15 cost time: 1.5330150127410889
Epoch: 15, Steps: 8 | Train Loss: 0.203 Vali Loss: 0.466 Vali Acc: 0.866 Test Loss: 0.466 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.575709581375122
Epoch: 16, Steps: 8 | Train Loss: 0.190 Vali Loss: 0.463 Vali Acc: 0.863 Test Loss: 0.463 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4827053546905518
Epoch: 17, Steps: 8 | Train Loss: 0.156 Vali Loss: 0.457 Vali Acc: 0.863 Test Loss: 0.457 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.5544564723968506
Epoch: 18, Steps: 8 | Train Loss: 0.137 Vali Loss: 0.455 Vali Acc: 0.869 Test Loss: 0.455 Test Acc: 0.869
Validation loss decreased (-0.868745 --> -0.868745).  Saving model ...
Epoch: 19 cost time: 1.4793882369995117
Epoch: 19, Steps: 8 | Train Loss: 0.122 Vali Loss: 0.449 Vali Acc: 0.863 Test Loss: 0.449 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4929587841033936
Epoch: 20, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.448 Vali Acc: 0.872 Test Loss: 0.448 Test Acc: 0.872
Validation loss decreased (-0.868745 --> -0.871871).  Saving model ...
Epoch: 21 cost time: 1.489725112915039
Epoch: 21, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.447 Vali Acc: 0.863 Test Loss: 0.447 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.423156499862671
Epoch: 22, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.443 Vali Acc: 0.866 Test Loss: 0.443 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.4475390911102295
Epoch: 23, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.447 Vali Acc: 0.863 Test Loss: 0.447 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.4329793453216553
Epoch: 24, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.453 Vali Acc: 0.866 Test Loss: 0.453 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.4783928394317627
Epoch: 25, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.467 Vali Acc: 0.863 Test Loss: 0.467 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.4932522773742676
Epoch: 26, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.464 Vali Acc: 0.863 Test Loss: 0.464 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.4713969230651855
Epoch: 27, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.465 Vali Acc: 0.859 Test Loss: 0.465 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.4001317024230957
Epoch: 28, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.458 Vali Acc: 0.866 Test Loss: 0.458 Test Acc: 0.866
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.3078057765960693
Epoch: 29, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.464 Vali Acc: 0.863 Test Loss: 0.464 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.238053560256958
Epoch: 30, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.467 Vali Acc: 0.859 Test Loss: 0.467 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 106688
model size : 0.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.323934316635132
Epoch: 1, Steps: 8 | Train Loss: 2.122 Vali Loss: 2.040 Vali Acc: 0.194 Test Loss: 2.040 Test Acc: 0.194
Validation loss decreased (inf --> -0.193730).  Saving model ...
Epoch: 2 cost time: 1.7673149108886719
Epoch: 2, Steps: 8 | Train Loss: 2.025 Vali Loss: 1.877 Vali Acc: 0.362 Test Loss: 1.877 Test Acc: 0.362
Validation loss decreased (-0.193730 --> -0.362481).  Saving model ...
Epoch: 3 cost time: 1.7370250225067139
Epoch: 3, Steps: 8 | Train Loss: 1.803 Vali Loss: 1.672 Vali Acc: 0.541 Test Loss: 1.672 Test Acc: 0.541
Validation loss decreased (-0.362481 --> -0.540608).  Saving model ...
Epoch: 4 cost time: 1.5927433967590332
Epoch: 4, Steps: 8 | Train Loss: 1.597 Vali Loss: 1.460 Vali Acc: 0.628 Test Loss: 1.460 Test Acc: 0.628
Validation loss decreased (-0.540608 --> -0.628110).  Saving model ...
Epoch: 5 cost time: 1.5870895385742188
Epoch: 5, Steps: 8 | Train Loss: 1.367 Vali Loss: 1.262 Vali Acc: 0.672 Test Loss: 1.262 Test Acc: 0.672
Validation loss decreased (-0.628110 --> -0.671862).  Saving model ...
Epoch: 6 cost time: 1.5465445518493652
Epoch: 6, Steps: 8 | Train Loss: 1.150 Vali Loss: 1.085 Vali Acc: 0.725 Test Loss: 1.085 Test Acc: 0.725
Validation loss decreased (-0.671862 --> -0.724989).  Saving model ...
Epoch: 7 cost time: 1.5178678035736084
Epoch: 7, Steps: 8 | Train Loss: 0.963 Vali Loss: 0.947 Vali Acc: 0.741 Test Loss: 0.947 Test Acc: 0.741
Validation loss decreased (-0.724989 --> -0.740616).  Saving model ...
Epoch: 8 cost time: 1.61344313621521
Epoch: 8, Steps: 8 | Train Loss: 0.818 Vali Loss: 0.838 Vali Acc: 0.759 Test Loss: 0.838 Test Acc: 0.759
Validation loss decreased (-0.740616 --> -0.759367).  Saving model ...
Epoch: 9 cost time: 1.7582972049713135
Epoch: 9, Steps: 8 | Train Loss: 0.685 Vali Loss: 0.742 Vali Acc: 0.797 Test Loss: 0.742 Test Acc: 0.797
Validation loss decreased (-0.759367 --> -0.796868).  Saving model ...
Epoch: 10 cost time: 1.5727941989898682
Epoch: 10, Steps: 8 | Train Loss: 0.587 Vali Loss: 0.680 Vali Acc: 0.806 Test Loss: 0.680 Test Acc: 0.806
Validation loss decreased (-0.796868 --> -0.806243).  Saving model ...
Epoch: 11 cost time: 1.6840832233428955
Epoch: 11, Steps: 8 | Train Loss: 0.490 Vali Loss: 0.626 Vali Acc: 0.819 Test Loss: 0.626 Test Acc: 0.819
Validation loss decreased (-0.806243 --> -0.818744).  Saving model ...
Epoch: 12 cost time: 1.5348289012908936
Epoch: 12, Steps: 8 | Train Loss: 0.412 Vali Loss: 0.593 Vali Acc: 0.816 Test Loss: 0.593 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5761103630065918
Epoch: 13, Steps: 8 | Train Loss: 0.369 Vali Loss: 0.583 Vali Acc: 0.812 Test Loss: 0.583 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5760133266448975
Epoch: 14, Steps: 8 | Train Loss: 0.298 Vali Loss: 0.568 Vali Acc: 0.812 Test Loss: 0.568 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6161255836486816
Epoch: 15, Steps: 8 | Train Loss: 0.278 Vali Loss: 0.557 Vali Acc: 0.809 Test Loss: 0.557 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.6016302108764648
Epoch: 16, Steps: 8 | Train Loss: 0.221 Vali Loss: 0.536 Vali Acc: 0.819 Test Loss: 0.536 Test Acc: 0.819
Validation loss decreased (-0.818744 --> -0.818745).  Saving model ...
Epoch: 17 cost time: 1.6151864528656006
Epoch: 17, Steps: 8 | Train Loss: 0.205 Vali Loss: 0.533 Vali Acc: 0.819 Test Loss: 0.533 Test Acc: 0.819
Validation loss decreased (-0.818745 --> -0.818745).  Saving model ...
Epoch: 18 cost time: 1.6060833930969238
Epoch: 18, Steps: 8 | Train Loss: 0.181 Vali Loss: 0.527 Vali Acc: 0.825 Test Loss: 0.527 Test Acc: 0.825
Validation loss decreased (-0.818745 --> -0.824995).  Saving model ...
Epoch: 19 cost time: 1.6501538753509521
Epoch: 19, Steps: 8 | Train Loss: 0.157 Vali Loss: 0.521 Vali Acc: 0.831 Test Loss: 0.521 Test Acc: 0.831
Validation loss decreased (-0.824995 --> -0.831245).  Saving model ...
Epoch: 20 cost time: 1.495302677154541
Epoch: 20, Steps: 8 | Train Loss: 0.137 Vali Loss: 0.513 Vali Acc: 0.828 Test Loss: 0.513 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2533340454101562
Epoch: 21, Steps: 8 | Train Loss: 0.126 Vali Loss: 0.515 Vali Acc: 0.831 Test Loss: 0.515 Test Acc: 0.831
Validation loss decreased (-0.831245 --> -0.831245).  Saving model ...
Epoch: 22 cost time: 1.6345305442810059
Epoch: 22, Steps: 8 | Train Loss: 0.121 Vali Loss: 0.510 Vali Acc: 0.831 Test Loss: 0.510 Test Acc: 0.831
Validation loss decreased (-0.831245 --> -0.831245).  Saving model ...
Epoch: 23 cost time: 1.679765224456787
Epoch: 23, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.529 Vali Acc: 0.831 Test Loss: 0.529 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.6746575832366943
Epoch: 24, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.546 Vali Acc: 0.828 Test Loss: 0.546 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.6472158432006836
Epoch: 25, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.535 Vali Acc: 0.831 Test Loss: 0.535 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.6981101036071777
Epoch: 26, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.540 Vali Acc: 0.831 Test Loss: 0.540 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.8324058055877686
Epoch: 27, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.555 Vali Acc: 0.828 Test Loss: 0.555 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.6089057922363281
Epoch: 28, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.549 Vali Acc: 0.834 Test Loss: 0.549 Test Acc: 0.834
Validation loss decreased (-0.831245 --> -0.834370).  Saving model ...
Epoch: 29 cost time: 1.655571699142456
Epoch: 29, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.537 Vali Acc: 0.838 Test Loss: 0.537 Test Acc: 0.838
Validation loss decreased (-0.834370 --> -0.837495).  Saving model ...
Epoch: 30 cost time: 1.5938355922698975
Epoch: 30, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.535 Vali Acc: 0.834 Test Loss: 0.535 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8375
model parameter : 313728
model size : 1.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.4812064170837402
Epoch: 1, Steps: 8 | Train Loss: 2.124 Vali Loss: 2.057 Vali Acc: 0.256 Test Loss: 2.057 Test Acc: 0.256
Validation loss decreased (inf --> -0.256229).  Saving model ...
Epoch: 2 cost time: 1.244067668914795
Epoch: 2, Steps: 8 | Train Loss: 2.015 Vali Loss: 1.902 Vali Acc: 0.388 Test Loss: 1.902 Test Acc: 0.388
Validation loss decreased (-0.256229 --> -0.387481).  Saving model ...
Epoch: 3 cost time: 1.1054763793945312
Epoch: 3, Steps: 8 | Train Loss: 1.832 Vali Loss: 1.707 Vali Acc: 0.534 Test Loss: 1.707 Test Acc: 0.534
Validation loss decreased (-0.387481 --> -0.534358).  Saving model ...
Epoch: 4 cost time: 1.1590113639831543
Epoch: 4, Steps: 8 | Train Loss: 1.615 Vali Loss: 1.496 Vali Acc: 0.647 Test Loss: 1.496 Test Acc: 0.647
Validation loss decreased (-0.534358 --> -0.646860).  Saving model ...
Epoch: 5 cost time: 1.1720671653747559
Epoch: 5, Steps: 8 | Train Loss: 1.369 Vali Loss: 1.296 Vali Acc: 0.734 Test Loss: 1.296 Test Acc: 0.734
Validation loss decreased (-0.646860 --> -0.734362).  Saving model ...
Epoch: 6 cost time: 1.1348984241485596
Epoch: 6, Steps: 8 | Train Loss: 1.160 Vali Loss: 1.122 Vali Acc: 0.769 Test Loss: 1.122 Test Acc: 0.769
Validation loss decreased (-0.734362 --> -0.768739).  Saving model ...
Epoch: 7 cost time: 1.1247999668121338
Epoch: 7, Steps: 8 | Train Loss: 0.974 Vali Loss: 0.967 Vali Acc: 0.775 Test Loss: 0.967 Test Acc: 0.775
Validation loss decreased (-0.768739 --> -0.774990).  Saving model ...
Epoch: 8 cost time: 1.1487882137298584
Epoch: 8, Steps: 8 | Train Loss: 0.846 Vali Loss: 0.842 Vali Acc: 0.797 Test Loss: 0.842 Test Acc: 0.797
Validation loss decreased (-0.774990 --> -0.796867).  Saving model ...
Epoch: 9 cost time: 1.1806821823120117
Epoch: 9, Steps: 8 | Train Loss: 0.686 Vali Loss: 0.738 Vali Acc: 0.806 Test Loss: 0.738 Test Acc: 0.806
Validation loss decreased (-0.796867 --> -0.806243).  Saving model ...
Epoch: 10 cost time: 1.2505333423614502
Epoch: 10, Steps: 8 | Train Loss: 0.540 Vali Loss: 0.662 Vali Acc: 0.828 Test Loss: 0.662 Test Acc: 0.828
Validation loss decreased (-0.806243 --> -0.828118).  Saving model ...
Epoch: 11 cost time: 1.0922284126281738
Epoch: 11, Steps: 8 | Train Loss: 0.453 Vali Loss: 0.601 Vali Acc: 0.831 Test Loss: 0.601 Test Acc: 0.831
Validation loss decreased (-0.828118 --> -0.831244).  Saving model ...
Epoch: 12 cost time: 1.1052758693695068
Epoch: 12, Steps: 8 | Train Loss: 0.381 Vali Loss: 0.560 Vali Acc: 0.834 Test Loss: 0.560 Test Acc: 0.834
Validation loss decreased (-0.831244 --> -0.834369).  Saving model ...
Epoch: 13 cost time: 1.036661148071289
Epoch: 13, Steps: 8 | Train Loss: 0.313 Vali Loss: 0.530 Vali Acc: 0.847 Test Loss: 0.530 Test Acc: 0.847
Validation loss decreased (-0.834369 --> -0.846870).  Saving model ...
Epoch: 14 cost time: 1.190364122390747
Epoch: 14, Steps: 8 | Train Loss: 0.255 Vali Loss: 0.509 Vali Acc: 0.863 Test Loss: 0.509 Test Acc: 0.863
Validation loss decreased (-0.846870 --> -0.862495).  Saving model ...
Epoch: 15 cost time: 1.3443706035614014
Epoch: 15, Steps: 8 | Train Loss: 0.208 Vali Loss: 0.485 Vali Acc: 0.866 Test Loss: 0.485 Test Acc: 0.866
Validation loss decreased (-0.862495 --> -0.865620).  Saving model ...
Epoch: 16 cost time: 1.3176593780517578
Epoch: 16, Steps: 8 | Train Loss: 0.193 Vali Loss: 0.480 Vali Acc: 0.859 Test Loss: 0.480 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3211495876312256
Epoch: 17, Steps: 8 | Train Loss: 0.158 Vali Loss: 0.471 Vali Acc: 0.863 Test Loss: 0.471 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3932344913482666
Epoch: 18, Steps: 8 | Train Loss: 0.138 Vali Loss: 0.468 Vali Acc: 0.859 Test Loss: 0.468 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3238754272460938
Epoch: 19, Steps: 8 | Train Loss: 0.124 Vali Loss: 0.462 Vali Acc: 0.859 Test Loss: 0.462 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.2567496299743652
Epoch: 20, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.459 Vali Acc: 0.866 Test Loss: 0.459 Test Acc: 0.866
Validation loss decreased (-0.865620 --> -0.865620).  Saving model ...
Epoch: 21 cost time: 1.321272850036621
Epoch: 21, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.459 Vali Acc: 0.866 Test Loss: 0.459 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3606431484222412
Epoch: 22, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.456 Vali Acc: 0.866 Test Loss: 0.456 Test Acc: 0.866
Validation loss decreased (-0.865620 --> -0.865620).  Saving model ...
Epoch: 23 cost time: 1.4057800769805908
Epoch: 23, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.461 Vali Acc: 0.856 Test Loss: 0.461 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.378605604171753
Epoch: 24, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.467 Vali Acc: 0.863 Test Loss: 0.467 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.3915064334869385
Epoch: 25, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.481 Vali Acc: 0.859 Test Loss: 0.481 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.2643184661865234
Epoch: 26, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.480 Vali Acc: 0.859 Test Loss: 0.480 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.3415696620941162
Epoch: 27, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.481 Vali Acc: 0.856 Test Loss: 0.481 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.2440979480743408
Epoch: 28, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.473 Vali Acc: 0.859 Test Loss: 0.473 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.2869868278503418
Epoch: 29, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.480 Vali Acc: 0.863 Test Loss: 0.480 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.3938441276550293
Epoch: 30, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.482 Vali Acc: 0.859 Test Loss: 0.482 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 106688
model size : 0.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.60496187210083
Epoch: 1, Steps: 8 | Train Loss: 2.121 Vali Loss: 2.046 Vali Acc: 0.197 Test Loss: 2.046 Test Acc: 0.197
Validation loss decreased (inf --> -0.196855).  Saving model ...
Epoch: 2 cost time: 1.2823679447174072
Epoch: 2, Steps: 8 | Train Loss: 2.025 Vali Loss: 1.886 Vali Acc: 0.347 Test Loss: 1.886 Test Acc: 0.347
Validation loss decreased (-0.196855 --> -0.346856).  Saving model ...
Epoch: 3 cost time: 1.2468957901000977
Epoch: 3, Steps: 8 | Train Loss: 1.806 Vali Loss: 1.683 Vali Acc: 0.537 Test Loss: 1.683 Test Acc: 0.537
Validation loss decreased (-0.346856 --> -0.537483).  Saving model ...
Epoch: 4 cost time: 1.323063850402832
Epoch: 4, Steps: 8 | Train Loss: 1.603 Vali Loss: 1.472 Vali Acc: 0.616 Test Loss: 1.472 Test Acc: 0.616
Validation loss decreased (-0.537483 --> -0.615610).  Saving model ...
Epoch: 5 cost time: 1.3030445575714111
Epoch: 5, Steps: 8 | Train Loss: 1.375 Vali Loss: 1.275 Vali Acc: 0.672 Test Loss: 1.275 Test Acc: 0.672
Validation loss decreased (-0.615610 --> -0.671862).  Saving model ...
Epoch: 6 cost time: 1.4669792652130127
Epoch: 6, Steps: 8 | Train Loss: 1.158 Vali Loss: 1.098 Vali Acc: 0.719 Test Loss: 1.098 Test Acc: 0.719
Validation loss decreased (-0.671862 --> -0.718739).  Saving model ...
Epoch: 7 cost time: 1.4530882835388184
Epoch: 7, Steps: 8 | Train Loss: 0.973 Vali Loss: 0.959 Vali Acc: 0.731 Test Loss: 0.959 Test Acc: 0.731
Validation loss decreased (-0.718739 --> -0.731240).  Saving model ...
Epoch: 8 cost time: 1.4947733879089355
Epoch: 8, Steps: 8 | Train Loss: 0.832 Vali Loss: 0.849 Vali Acc: 0.756 Test Loss: 0.849 Test Acc: 0.756
Validation loss decreased (-0.731240 --> -0.756242).  Saving model ...
Epoch: 9 cost time: 1.3297398090362549
Epoch: 9, Steps: 8 | Train Loss: 0.698 Vali Loss: 0.752 Vali Acc: 0.787 Test Loss: 0.752 Test Acc: 0.787
Validation loss decreased (-0.756242 --> -0.787492).  Saving model ...
Epoch: 10 cost time: 1.3152413368225098
Epoch: 10, Steps: 8 | Train Loss: 0.602 Vali Loss: 0.689 Vali Acc: 0.797 Test Loss: 0.689 Test Acc: 0.797
Validation loss decreased (-0.787492 --> -0.796868).  Saving model ...
Epoch: 11 cost time: 1.308988332748413
Epoch: 11, Steps: 8 | Train Loss: 0.507 Vali Loss: 0.635 Vali Acc: 0.828 Test Loss: 0.635 Test Acc: 0.828
Validation loss decreased (-0.796868 --> -0.828119).  Saving model ...
Epoch: 12 cost time: 1.3491628170013428
Epoch: 12, Steps: 8 | Train Loss: 0.433 Vali Loss: 0.602 Vali Acc: 0.819 Test Loss: 0.602 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3737499713897705
Epoch: 13, Steps: 8 | Train Loss: 0.391 Vali Loss: 0.591 Vali Acc: 0.822 Test Loss: 0.591 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4860920906066895
Epoch: 14, Steps: 8 | Train Loss: 0.327 Vali Loss: 0.575 Vali Acc: 0.822 Test Loss: 0.575 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5513253211975098
Epoch: 15, Steps: 8 | Train Loss: 0.309 Vali Loss: 0.573 Vali Acc: 0.812 Test Loss: 0.573 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.4460787773132324
Epoch: 16, Steps: 8 | Train Loss: 0.251 Vali Loss: 0.560 Vali Acc: 0.816 Test Loss: 0.560 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.38673996925354
Epoch: 17, Steps: 8 | Train Loss: 0.238 Vali Loss: 0.562 Vali Acc: 0.825 Test Loss: 0.562 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.3133013248443604
Epoch: 18, Steps: 8 | Train Loss: 0.215 Vali Loss: 0.560 Vali Acc: 0.819 Test Loss: 0.560 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.3222296237945557
Epoch: 19, Steps: 8 | Train Loss: 0.195 Vali Loss: 0.558 Vali Acc: 0.819 Test Loss: 0.558 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.3376224040985107
Epoch: 20, Steps: 8 | Train Loss: 0.166 Vali Loss: 0.559 Vali Acc: 0.812 Test Loss: 0.559 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.3887910842895508
Epoch: 21, Steps: 8 | Train Loss: 0.153 Vali Loss: 0.566 Vali Acc: 0.809 Test Loss: 0.566 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.828125
model parameter : 313728
model size : 1.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.5411572456359863
Epoch: 1, Steps: 8 | Train Loss: 2.129 Vali Loss: 2.059 Vali Acc: 0.256 Test Loss: 2.059 Test Acc: 0.256
Validation loss decreased (inf --> -0.256229).  Saving model ...
Epoch: 2 cost time: 1.008887529373169
Epoch: 2, Steps: 8 | Train Loss: 2.017 Vali Loss: 1.905 Vali Acc: 0.394 Test Loss: 1.905 Test Acc: 0.394
Validation loss decreased (-0.256229 --> -0.393731).  Saving model ...
Epoch: 3 cost time: 0.9891092777252197
Epoch: 3, Steps: 8 | Train Loss: 1.837 Vali Loss: 1.711 Vali Acc: 0.531 Test Loss: 1.711 Test Acc: 0.531
Validation loss decreased (-0.393731 --> -0.531233).  Saving model ...
Epoch: 4 cost time: 1.028717279434204
Epoch: 4, Steps: 8 | Train Loss: 1.619 Vali Loss: 1.502 Vali Acc: 0.634 Test Loss: 1.502 Test Acc: 0.634
Validation loss decreased (-0.531233 --> -0.634360).  Saving model ...
Epoch: 5 cost time: 1.0667271614074707
Epoch: 5, Steps: 8 | Train Loss: 1.374 Vali Loss: 1.303 Vali Acc: 0.722 Test Loss: 1.303 Test Acc: 0.722
Validation loss decreased (-0.634360 --> -0.721862).  Saving model ...
Epoch: 6 cost time: 1.1446659564971924
Epoch: 6, Steps: 8 | Train Loss: 1.167 Vali Loss: 1.130 Vali Acc: 0.762 Test Loss: 1.130 Test Acc: 0.762
Validation loss decreased (-0.721862 --> -0.762489).  Saving model ...
Epoch: 7 cost time: 1.0898315906524658
Epoch: 7, Steps: 8 | Train Loss: 0.985 Vali Loss: 0.978 Vali Acc: 0.775 Test Loss: 0.978 Test Acc: 0.775
Validation loss decreased (-0.762489 --> -0.774990).  Saving model ...
Epoch: 8 cost time: 1.1194653511047363
Epoch: 8, Steps: 8 | Train Loss: 0.860 Vali Loss: 0.856 Vali Acc: 0.794 Test Loss: 0.856 Test Acc: 0.794
Validation loss decreased (-0.774990 --> -0.793741).  Saving model ...
Epoch: 9 cost time: 1.0801053047180176
Epoch: 9, Steps: 8 | Train Loss: 0.705 Vali Loss: 0.755 Vali Acc: 0.806 Test Loss: 0.755 Test Acc: 0.806
Validation loss decreased (-0.793741 --> -0.806242).  Saving model ...
Epoch: 10 cost time: 1.0672345161437988
Epoch: 10, Steps: 8 | Train Loss: 0.565 Vali Loss: 0.680 Vali Acc: 0.825 Test Loss: 0.680 Test Acc: 0.825
Validation loss decreased (-0.806242 --> -0.824993).  Saving model ...
Epoch: 11 cost time: 1.113631248474121
Epoch: 11, Steps: 8 | Train Loss: 0.481 Vali Loss: 0.620 Vali Acc: 0.831 Test Loss: 0.620 Test Acc: 0.831
Validation loss decreased (-0.824993 --> -0.831244).  Saving model ...
Epoch: 12 cost time: 1.0620365142822266
Epoch: 12, Steps: 8 | Train Loss: 0.415 Vali Loss: 0.580 Vali Acc: 0.828 Test Loss: 0.580 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9856669902801514
Epoch: 13, Steps: 8 | Train Loss: 0.353 Vali Loss: 0.552 Vali Acc: 0.831 Test Loss: 0.552 Test Acc: 0.831
Validation loss decreased (-0.831244 --> -0.831244).  Saving model ...
Epoch: 14 cost time: 1.098229169845581
Epoch: 14, Steps: 8 | Train Loss: 0.298 Vali Loss: 0.531 Vali Acc: 0.844 Test Loss: 0.531 Test Acc: 0.844
Validation loss decreased (-0.831244 --> -0.843745).  Saving model ...
Epoch: 15 cost time: 1.0938622951507568
Epoch: 15, Steps: 8 | Train Loss: 0.244 Vali Loss: 0.510 Vali Acc: 0.844 Test Loss: 0.510 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 16 cost time: 1.142148494720459
Epoch: 16, Steps: 8 | Train Loss: 0.235 Vali Loss: 0.505 Vali Acc: 0.841 Test Loss: 0.505 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1841862201690674
Epoch: 17, Steps: 8 | Train Loss: 0.191 Vali Loss: 0.499 Vali Acc: 0.853 Test Loss: 0.499 Test Acc: 0.853
Validation loss decreased (-0.843745 --> -0.853120).  Saving model ...
Epoch: 18 cost time: 1.0870978832244873
Epoch: 18, Steps: 8 | Train Loss: 0.168 Vali Loss: 0.499 Vali Acc: 0.847 Test Loss: 0.499 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1450510025024414
Epoch: 19, Steps: 8 | Train Loss: 0.153 Vali Loss: 0.488 Vali Acc: 0.856 Test Loss: 0.488 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 20 cost time: 1.0043742656707764
Epoch: 20, Steps: 8 | Train Loss: 0.140 Vali Loss: 0.490 Vali Acc: 0.850 Test Loss: 0.490 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.995617151260376
Epoch: 21, Steps: 8 | Train Loss: 0.110 Vali Loss: 0.494 Vali Acc: 0.853 Test Loss: 0.494 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9877126216888428
Epoch: 22, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.492 Vali Acc: 0.847 Test Loss: 0.492 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.0148100852966309
Epoch: 23, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.494 Vali Acc: 0.847 Test Loss: 0.494 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.0543873310089111
Epoch: 24, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.501 Vali Acc: 0.844 Test Loss: 0.501 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.0478274822235107
Epoch: 25, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.518 Vali Acc: 0.844 Test Loss: 0.518 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.0960462093353271
Epoch: 26, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.514 Vali Acc: 0.844 Test Loss: 0.514 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.1165144443511963
Epoch: 27, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.515 Vali Acc: 0.847 Test Loss: 0.515 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.2778069972991943
Epoch: 28, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.508 Vali Acc: 0.850 Test Loss: 0.508 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.0887959003448486
Epoch: 29, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.516 Vali Acc: 0.847 Test Loss: 0.516 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el4_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 106688
model size : 0.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 25.093510150909424
Epoch: 1, Steps: 8 | Train Loss: 1.954 Vali Loss: 1.425 Vali Acc: 0.706 Test Loss: 1.425 Test Acc: 0.706
Validation loss decreased (inf --> -0.706236).  Saving model ...
Epoch: 2 cost time: 23.841907262802124
Epoch: 2, Steps: 8 | Train Loss: 0.981 Vali Loss: 0.597 Vali Acc: 0.794 Test Loss: 0.597 Test Acc: 0.794
Validation loss decreased (-0.706236 --> -0.793744).  Saving model ...
Epoch: 3 cost time: 20.71963667869568
Epoch: 3, Steps: 8 | Train Loss: 0.360 Vali Loss: 0.457 Vali Acc: 0.878 Test Loss: 0.457 Test Acc: 0.878
Validation loss decreased (-0.793744 --> -0.878120).  Saving model ...
Epoch: 4 cost time: 20.018144130706787
Epoch: 4, Steps: 8 | Train Loss: 0.159 Vali Loss: 0.551 Vali Acc: 0.853 Test Loss: 0.551 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 19.86906099319458
Epoch: 5, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.544 Vali Acc: 0.859 Test Loss: 0.544 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 20.501518964767456
Epoch: 6, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.654 Vali Acc: 0.841 Test Loss: 0.654 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 20.3718581199646
Epoch: 7, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.724 Vali Acc: 0.850 Test Loss: 0.724 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 19.313124895095825
Epoch: 8, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.753 Vali Acc: 0.847 Test Loss: 0.753 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 18.79797077178955
Epoch: 9, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.743 Vali Acc: 0.853 Test Loss: 0.743 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 19.102123975753784
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.710 Vali Acc: 0.859 Test Loss: 0.710 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 21.857465505599976
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.714 Vali Acc: 0.863 Test Loss: 0.714 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 21.3257155418396
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.726 Vali Acc: 0.859 Test Loss: 0.726 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 21.829065322875977
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.734 Vali Acc: 0.863 Test Loss: 0.734 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.878125
model parameter : 56561288
model size : 218.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 9.483232498168945
Epoch: 1, Steps: 8 | Train Loss: 1.994 Vali Loss: 1.420 Vali Acc: 0.703 Test Loss: 1.420 Test Acc: 0.703
Validation loss decreased (inf --> -0.703111).  Saving model ...
Epoch: 2 cost time: 8.903573513031006
Epoch: 2, Steps: 8 | Train Loss: 0.919 Vali Loss: 0.586 Vali Acc: 0.841 Test Loss: 0.586 Test Acc: 0.841
Validation loss decreased (-0.703111 --> -0.840619).  Saving model ...
Epoch: 3 cost time: 8.43507170677185
Epoch: 3, Steps: 8 | Train Loss: 0.336 Vali Loss: 0.449 Vali Acc: 0.856 Test Loss: 0.449 Test Acc: 0.856
Validation loss decreased (-0.840619 --> -0.856246).  Saving model ...
Epoch: 4 cost time: 8.308846712112427
Epoch: 4, Steps: 8 | Train Loss: 0.160 Vali Loss: 0.503 Vali Acc: 0.859 Test Loss: 0.503 Test Acc: 0.859
Validation loss decreased (-0.856246 --> -0.859370).  Saving model ...
Epoch: 5 cost time: 8.3844153881073
Epoch: 5, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.603 Vali Acc: 0.828 Test Loss: 0.603 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.528482913970947
Epoch: 6, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.723 Vali Acc: 0.844 Test Loss: 0.723 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.760725259780884
Epoch: 7, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.742 Vali Acc: 0.834 Test Loss: 0.742 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 8.012529850006104
Epoch: 8, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.778 Vali Acc: 0.844 Test Loss: 0.778 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 7.6468799114227295
Epoch: 9, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.892 Vali Acc: 0.838 Test Loss: 0.892 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 8.097788333892822
Epoch: 10, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.754 Vali Acc: 0.859 Test Loss: 0.754 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 8.255854845046997
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.693 Vali Acc: 0.850 Test Loss: 0.693 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 8.522520303726196
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.690 Vali Acc: 0.859 Test Loss: 0.690 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 7.935485363006592
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.745 Vali Acc: 0.856 Test Loss: 0.745 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 7.810745000839233
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.756 Vali Acc: 0.859 Test Loss: 0.756 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 16844168
model size : 66.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 14.503293514251709
Epoch: 1, Steps: 8 | Train Loss: 1.955 Vali Loss: 1.430 Vali Acc: 0.703 Test Loss: 1.430 Test Acc: 0.703
Validation loss decreased (inf --> -0.703111).  Saving model ...
Epoch: 2 cost time: 16.010412216186523
Epoch: 2, Steps: 8 | Train Loss: 0.981 Vali Loss: 0.604 Vali Acc: 0.797 Test Loss: 0.604 Test Acc: 0.797
Validation loss decreased (-0.703111 --> -0.796869).  Saving model ...
Epoch: 3 cost time: 20.973207473754883
Epoch: 3, Steps: 8 | Train Loss: 0.359 Vali Loss: 0.460 Vali Acc: 0.878 Test Loss: 0.460 Test Acc: 0.878
Validation loss decreased (-0.796869 --> -0.878120).  Saving model ...
Epoch: 4 cost time: 21.081539154052734
Epoch: 4, Steps: 8 | Train Loss: 0.158 Vali Loss: 0.553 Vali Acc: 0.853 Test Loss: 0.553 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 20.850735425949097
Epoch: 5, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.548 Vali Acc: 0.859 Test Loss: 0.548 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 21.02776312828064
Epoch: 6, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.661 Vali Acc: 0.841 Test Loss: 0.661 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 21.416375875473022
Epoch: 7, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.728 Vali Acc: 0.853 Test Loss: 0.728 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 20.265997409820557
Epoch: 8, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.757 Vali Acc: 0.847 Test Loss: 0.757 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 20.324530839920044
Epoch: 9, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.744 Vali Acc: 0.853 Test Loss: 0.744 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 20.06324863433838
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.710 Vali Acc: 0.853 Test Loss: 0.710 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 22.38655161857605
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.717 Vali Acc: 0.856 Test Loss: 0.717 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 23.951502561569214
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.733 Vali Acc: 0.859 Test Loss: 0.733 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 23.461499214172363
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.743 Vali Acc: 0.859 Test Loss: 0.743 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.878125
model parameter : 56561288
model size : 218.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 10.376418113708496
Epoch: 1, Steps: 8 | Train Loss: 1.997 Vali Loss: 1.434 Vali Acc: 0.697 Test Loss: 1.434 Test Acc: 0.697
Validation loss decreased (inf --> -0.696861).  Saving model ...
Epoch: 2 cost time: 9.213324069976807
Epoch: 2, Steps: 8 | Train Loss: 0.925 Vali Loss: 0.601 Vali Acc: 0.834 Test Loss: 0.601 Test Acc: 0.834
Validation loss decreased (-0.696861 --> -0.834369).  Saving model ...
Epoch: 3 cost time: 8.864824056625366
Epoch: 3, Steps: 8 | Train Loss: 0.336 Vali Loss: 0.454 Vali Acc: 0.863 Test Loss: 0.454 Test Acc: 0.863
Validation loss decreased (-0.834369 --> -0.862495).  Saving model ...
Epoch: 4 cost time: 9.09407377243042
Epoch: 4, Steps: 8 | Train Loss: 0.163 Vali Loss: 0.504 Vali Acc: 0.856 Test Loss: 0.504 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.862136125564575
Epoch: 5, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.600 Vali Acc: 0.838 Test Loss: 0.600 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 9.444148063659668
Epoch: 6, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.721 Vali Acc: 0.841 Test Loss: 0.721 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 8.89062762260437
Epoch: 7, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.741 Vali Acc: 0.828 Test Loss: 0.741 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 8.33212399482727
Epoch: 8, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.769 Vali Acc: 0.838 Test Loss: 0.769 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 8.875622034072876
Epoch: 9, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.888 Vali Acc: 0.834 Test Loss: 0.888 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 8.714296102523804
Epoch: 10, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.750 Vali Acc: 0.859 Test Loss: 0.750 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 8.851612329483032
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.713 Vali Acc: 0.850 Test Loss: 0.713 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 8.702980756759644
Epoch: 12, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.765 Vali Acc: 0.856 Test Loss: 0.765 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 8.598937749862671
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.900 Vali Acc: 0.844 Test Loss: 0.900 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 16844168
model size : 66.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 14.578762292861938
Epoch: 1, Steps: 8 | Train Loss: 1.961 Vali Loss: 1.451 Vali Acc: 0.691 Test Loss: 1.451 Test Acc: 0.691
Validation loss decreased (inf --> -0.690610).  Saving model ...
Epoch: 2 cost time: 13.966357946395874
Epoch: 2, Steps: 8 | Train Loss: 1.015 Vali Loss: 0.633 Vali Acc: 0.800 Test Loss: 0.633 Test Acc: 0.800
Validation loss decreased (-0.690610 --> -0.799994).  Saving model ...
Epoch: 3 cost time: 13.540677309036255
Epoch: 3, Steps: 8 | Train Loss: 0.403 Vali Loss: 0.486 Vali Acc: 0.869 Test Loss: 0.486 Test Acc: 0.869
Validation loss decreased (-0.799994 --> -0.868745).  Saving model ...
Epoch: 4 cost time: 13.11336612701416
Epoch: 4, Steps: 8 | Train Loss: 0.197 Vali Loss: 0.561 Vali Acc: 0.850 Test Loss: 0.561 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.564265489578247
Epoch: 5, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.542 Vali Acc: 0.869 Test Loss: 0.542 Test Acc: 0.869
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 12.425777673721313
Epoch: 6, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.650 Vali Acc: 0.847 Test Loss: 0.650 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 12.305420637130737
Epoch: 7, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.694 Vali Acc: 0.847 Test Loss: 0.694 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 12.711363554000854
Epoch: 8, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.708 Vali Acc: 0.847 Test Loss: 0.708 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 12.317557096481323
Epoch: 9, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.723 Vali Acc: 0.841 Test Loss: 0.723 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 12.739800214767456
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.759 Vali Acc: 0.841 Test Loss: 0.759 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 12.270180940628052
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.780 Vali Acc: 0.841 Test Loss: 0.780 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 12.050419330596924
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.785 Vali Acc: 0.844 Test Loss: 0.785 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 12.172107696533203
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.779 Vali Acc: 0.841 Test Loss: 0.779 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 56561288
model size : 218.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 6.436420202255249
Epoch: 1, Steps: 8 | Train Loss: 1.996 Vali Loss: 1.449 Vali Acc: 0.694 Test Loss: 1.449 Test Acc: 0.694
Validation loss decreased (inf --> -0.693736).  Saving model ...
Epoch: 2 cost time: 4.78389048576355
Epoch: 2, Steps: 8 | Train Loss: 0.957 Vali Loss: 0.615 Vali Acc: 0.831 Test Loss: 0.615 Test Acc: 0.831
Validation loss decreased (-0.693736 --> -0.831244).  Saving model ...
Epoch: 3 cost time: 4.959939241409302
Epoch: 3, Steps: 8 | Train Loss: 0.372 Vali Loss: 0.475 Vali Acc: 0.850 Test Loss: 0.475 Test Acc: 0.850
Validation loss decreased (-0.831244 --> -0.849995).  Saving model ...
Epoch: 4 cost time: 4.841211557388306
Epoch: 4, Steps: 8 | Train Loss: 0.207 Vali Loss: 0.511 Vali Acc: 0.856 Test Loss: 0.511 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.856245).  Saving model ...
Epoch: 5 cost time: 4.7127439975738525
Epoch: 5, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.622 Vali Acc: 0.844 Test Loss: 0.622 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.012178659439087
Epoch: 6, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.670 Vali Acc: 0.853 Test Loss: 0.670 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.645765781402588
Epoch: 7, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.706 Vali Acc: 0.853 Test Loss: 0.706 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.210264682769775
Epoch: 8, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.721 Vali Acc: 0.856 Test Loss: 0.721 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.153033018112183
Epoch: 9, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.772 Vali Acc: 0.856 Test Loss: 0.772 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.071681261062622
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.745 Vali Acc: 0.866 Test Loss: 0.745 Test Acc: 0.866
Validation loss decreased (-0.856245 --> -0.865618).  Saving model ...
Epoch: 11 cost time: 4.903721332550049
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.731 Vali Acc: 0.853 Test Loss: 0.731 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.094411849975586
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.728 Vali Acc: 0.853 Test Loss: 0.728 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.077003479003906
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.744 Vali Acc: 0.856 Test Loss: 0.744 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.992167234420776
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.763 Vali Acc: 0.859 Test Loss: 0.763 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.531359434127808
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.773 Vali Acc: 0.859 Test Loss: 0.773 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.496126651763916
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.781 Vali Acc: 0.859 Test Loss: 0.781 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 5.483088970184326
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.788 Vali Acc: 0.856 Test Loss: 0.788 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 5.459119558334351
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.795 Vali Acc: 0.853 Test Loss: 0.795 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 5.562665224075317
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.801 Vali Acc: 0.856 Test Loss: 0.801 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 5.5426716804504395
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.807 Vali Acc: 0.853 Test Loss: 0.807 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 16844168
model size : 66.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 18.620458841323853
Epoch: 1, Steps: 8 | Train Loss: 2.061 Vali Loss: 1.496 Vali Acc: 0.659 Test Loss: 1.496 Test Acc: 0.659
Validation loss decreased (inf --> -0.659360).  Saving model ...
Epoch: 2 cost time: 17.35588502883911
Epoch: 2, Steps: 8 | Train Loss: 1.020 Vali Loss: 0.590 Vali Acc: 0.816 Test Loss: 0.590 Test Acc: 0.816
Validation loss decreased (-0.659360 --> -0.815619).  Saving model ...
Epoch: 3 cost time: 16.490696668624878
Epoch: 3, Steps: 8 | Train Loss: 0.336 Vali Loss: 0.492 Vali Acc: 0.853 Test Loss: 0.492 Test Acc: 0.853
Validation loss decreased (-0.815619 --> -0.853120).  Saving model ...
Epoch: 4 cost time: 16.48939561843872
Epoch: 4, Steps: 8 | Train Loss: 0.157 Vali Loss: 0.514 Vali Acc: 0.841 Test Loss: 0.514 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 16.6329243183136
Epoch: 5, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.546 Vali Acc: 0.850 Test Loss: 0.546 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 17.052249670028687
Epoch: 6, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.592 Vali Acc: 0.841 Test Loss: 0.592 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 17.13211750984192
Epoch: 7, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.648 Vali Acc: 0.841 Test Loss: 0.648 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 16.945943593978882
Epoch: 8, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.696 Vali Acc: 0.841 Test Loss: 0.696 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 16.7373948097229
Epoch: 9, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.737 Vali Acc: 0.841 Test Loss: 0.737 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 16.66112780570984
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.749 Vali Acc: 0.853 Test Loss: 0.749 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 16.499651193618774
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.734 Vali Acc: 0.856 Test Loss: 0.734 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856243).  Saving model ...
Epoch: 12 cost time: 16.6100435256958
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.717 Vali Acc: 0.856 Test Loss: 0.717 Test Acc: 0.856
Validation loss decreased (-0.856243 --> -0.856243).  Saving model ...
Epoch: 13 cost time: 16.59609842300415
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.724 Vali Acc: 0.850 Test Loss: 0.724 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 17.232013463974
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.727 Vali Acc: 0.853 Test Loss: 0.727 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 16.408686876296997
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.738 Vali Acc: 0.853 Test Loss: 0.738 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 15.310694456100464
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.738 Vali Acc: 0.853 Test Loss: 0.738 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 14.932987689971924
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.742 Vali Acc: 0.853 Test Loss: 0.742 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 14.977906227111816
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.747 Vali Acc: 0.853 Test Loss: 0.747 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 14.763906240463257
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.752 Vali Acc: 0.853 Test Loss: 0.752 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 15.250627756118774
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.759 Vali Acc: 0.853 Test Loss: 0.759 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 15.348908185958862
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.760 Vali Acc: 0.853 Test Loss: 0.760 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 15.236539125442505
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.762 Vali Acc: 0.856 Test Loss: 0.762 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 28444040
model size : 110.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 7.725267648696899
Epoch: 1, Steps: 8 | Train Loss: 1.900 Vali Loss: 1.386 Vali Acc: 0.738 Test Loss: 1.386 Test Acc: 0.738
Validation loss decreased (inf --> -0.737486).  Saving model ...
Epoch: 2 cost time: 6.129681825637817
Epoch: 2, Steps: 8 | Train Loss: 0.940 Vali Loss: 0.605 Vali Acc: 0.819 Test Loss: 0.605 Test Acc: 0.819
Validation loss decreased (-0.737486 --> -0.818744).  Saving model ...
Epoch: 3 cost time: 6.452004432678223
Epoch: 3, Steps: 8 | Train Loss: 0.360 Vali Loss: 0.479 Vali Acc: 0.847 Test Loss: 0.479 Test Acc: 0.847
Validation loss decreased (-0.818744 --> -0.846870).  Saving model ...
Epoch: 4 cost time: 6.302412986755371
Epoch: 4, Steps: 8 | Train Loss: 0.160 Vali Loss: 0.502 Vali Acc: 0.869 Test Loss: 0.502 Test Acc: 0.869
Validation loss decreased (-0.846870 --> -0.868745).  Saving model ...
Epoch: 5 cost time: 6.2356345653533936
Epoch: 5, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.540 Vali Acc: 0.853 Test Loss: 0.540 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.453455686569214
Epoch: 6, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.655 Vali Acc: 0.850 Test Loss: 0.655 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.3146467208862305
Epoch: 7, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.610 Vali Acc: 0.863 Test Loss: 0.610 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.434854507446289
Epoch: 8, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.634 Vali Acc: 0.866 Test Loss: 0.634 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.234773874282837
Epoch: 9, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.750 Vali Acc: 0.853 Test Loss: 0.750 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 6.262074708938599
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.711 Vali Acc: 0.856 Test Loss: 0.711 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 6.4089460372924805
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.712 Vali Acc: 0.859 Test Loss: 0.712 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 6.640734434127808
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.734 Vali Acc: 0.863 Test Loss: 0.734 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 6.818028450012207
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.740 Vali Acc: 0.866 Test Loss: 0.740 Test Acc: 0.866
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 6.624365329742432
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.737 Vali Acc: 0.866 Test Loss: 0.737 Test Acc: 0.866
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 8585096
model size : 35.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 14.686270236968994
Epoch: 1, Steps: 8 | Train Loss: 2.064 Vali Loss: 1.509 Vali Acc: 0.647 Test Loss: 1.509 Test Acc: 0.647
Validation loss decreased (inf --> -0.646860).  Saving model ...
Epoch: 2 cost time: 12.817257165908813
Epoch: 2, Steps: 8 | Train Loss: 1.040 Vali Loss: 0.604 Vali Acc: 0.812 Test Loss: 0.604 Test Acc: 0.812
Validation loss decreased (-0.646860 --> -0.812494).  Saving model ...
Epoch: 3 cost time: 12.760742902755737
Epoch: 3, Steps: 8 | Train Loss: 0.354 Vali Loss: 0.504 Vali Acc: 0.847 Test Loss: 0.504 Test Acc: 0.847
Validation loss decreased (-0.812494 --> -0.846870).  Saving model ...
Epoch: 4 cost time: 12.944864749908447
Epoch: 4, Steps: 8 | Train Loss: 0.162 Vali Loss: 0.519 Vali Acc: 0.844 Test Loss: 0.519 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 13.220097780227661
Epoch: 5, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.571 Vali Acc: 0.838 Test Loss: 0.571 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 12.840317010879517
Epoch: 6, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.622 Vali Acc: 0.841 Test Loss: 0.622 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 12.964593648910522
Epoch: 7, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.667 Vali Acc: 0.847 Test Loss: 0.667 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 13.370426893234253
Epoch: 8, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.704 Vali Acc: 0.834 Test Loss: 0.704 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 12.995505571365356
Epoch: 9, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.748 Vali Acc: 0.834 Test Loss: 0.748 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 13.120089769363403
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.760 Vali Acc: 0.853 Test Loss: 0.760 Test Acc: 0.853
Validation loss decreased (-0.846870 --> -0.853117).  Saving model ...
Epoch: 11 cost time: 13.205615520477295
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.749 Vali Acc: 0.856 Test Loss: 0.749 Test Acc: 0.856
Validation loss decreased (-0.853117 --> -0.856243).  Saving model ...
Epoch: 12 cost time: 13.271213054656982
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.733 Vali Acc: 0.859 Test Loss: 0.733 Test Acc: 0.859
Validation loss decreased (-0.856243 --> -0.859368).  Saving model ...
Epoch: 13 cost time: 13.036837816238403
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.738 Vali Acc: 0.853 Test Loss: 0.738 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 13.064584016799927
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.742 Vali Acc: 0.853 Test Loss: 0.742 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 13.551499605178833
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.754 Vali Acc: 0.853 Test Loss: 0.754 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 12.982657432556152
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.754 Vali Acc: 0.850 Test Loss: 0.754 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 12.720980644226074
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.759 Vali Acc: 0.850 Test Loss: 0.759 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 12.509493112564087
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.764 Vali Acc: 0.850 Test Loss: 0.764 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 14.082277536392212
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.769 Vali Acc: 0.853 Test Loss: 0.769 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 12.460033178329468
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.776 Vali Acc: 0.853 Test Loss: 0.776 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 13.018764972686768
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.778 Vali Acc: 0.853 Test Loss: 0.778 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 12.279981136322021
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.781 Vali Acc: 0.853 Test Loss: 0.781 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 28444040
model size : 110.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 6.955805540084839
Epoch: 1, Steps: 8 | Train Loss: 1.900 Vali Loss: 1.390 Vali Acc: 0.734 Test Loss: 1.390 Test Acc: 0.734
Validation loss decreased (inf --> -0.734361).  Saving model ...
Epoch: 2 cost time: 5.420309782028198
Epoch: 2, Steps: 8 | Train Loss: 0.939 Vali Loss: 0.610 Vali Acc: 0.819 Test Loss: 0.610 Test Acc: 0.819
Validation loss decreased (-0.734361 --> -0.818744).  Saving model ...
Epoch: 3 cost time: 5.774162769317627
Epoch: 3, Steps: 8 | Train Loss: 0.359 Vali Loss: 0.482 Vali Acc: 0.847 Test Loss: 0.482 Test Acc: 0.847
Validation loss decreased (-0.818744 --> -0.846870).  Saving model ...
Epoch: 4 cost time: 5.6892921924591064
Epoch: 4, Steps: 8 | Train Loss: 0.159 Vali Loss: 0.504 Vali Acc: 0.869 Test Loss: 0.504 Test Acc: 0.869
Validation loss decreased (-0.846870 --> -0.868745).  Saving model ...
Epoch: 5 cost time: 5.375103235244751
Epoch: 5, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.542 Vali Acc: 0.853 Test Loss: 0.542 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.351038217544556
Epoch: 6, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.659 Vali Acc: 0.847 Test Loss: 0.659 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.490830183029175
Epoch: 7, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.617 Vali Acc: 0.863 Test Loss: 0.617 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.724804639816284
Epoch: 8, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.642 Vali Acc: 0.863 Test Loss: 0.642 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.7117321491241455
Epoch: 9, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.758 Vali Acc: 0.853 Test Loss: 0.758 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.401099920272827
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.716 Vali Acc: 0.856 Test Loss: 0.716 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.4655373096466064
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.716 Vali Acc: 0.856 Test Loss: 0.716 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.809988021850586
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.740 Vali Acc: 0.859 Test Loss: 0.740 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.804727792739868
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.746 Vali Acc: 0.866 Test Loss: 0.746 Test Acc: 0.866
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 5.479600191116333
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.742 Vali Acc: 0.863 Test Loss: 0.742 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 8585096
model size : 35.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 9.31811237335205
Epoch: 1, Steps: 8 | Train Loss: 2.062 Vali Loss: 1.524 Vali Acc: 0.619 Test Loss: 1.524 Test Acc: 0.619
Validation loss decreased (inf --> -0.618735).  Saving model ...
Epoch: 2 cost time: 8.00059723854065
Epoch: 2, Steps: 8 | Train Loss: 1.060 Vali Loss: 0.628 Vali Acc: 0.812 Test Loss: 0.628 Test Acc: 0.812
Validation loss decreased (-0.618735 --> -0.812494).  Saving model ...
Epoch: 3 cost time: 7.478848218917847
Epoch: 3, Steps: 8 | Train Loss: 0.384 Vali Loss: 0.519 Vali Acc: 0.856 Test Loss: 0.519 Test Acc: 0.856
Validation loss decreased (-0.812494 --> -0.856245).  Saving model ...
Epoch: 4 cost time: 7.68933892250061
Epoch: 4, Steps: 8 | Train Loss: 0.196 Vali Loss: 0.540 Vali Acc: 0.841 Test Loss: 0.540 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.8820648193359375
Epoch: 5, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.628 Vali Acc: 0.831 Test Loss: 0.628 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.440885066986084
Epoch: 6, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.644 Vali Acc: 0.838 Test Loss: 0.644 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 7.351739406585693
Epoch: 7, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.617 Vali Acc: 0.850 Test Loss: 0.617 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 7.833693981170654
Epoch: 8, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.629 Vali Acc: 0.850 Test Loss: 0.629 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 7.2217488288879395
Epoch: 9, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.773 Vali Acc: 0.838 Test Loss: 0.773 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 7.928770065307617
Epoch: 10, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.774 Vali Acc: 0.841 Test Loss: 0.774 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 8.365873336791992
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.752 Vali Acc: 0.856 Test Loss: 0.752 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 8.366019248962402
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.775 Vali Acc: 0.853 Test Loss: 0.775 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 8.035523891448975
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.865 Vali Acc: 0.844 Test Loss: 0.865 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 28444040
model size : 110.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.840888261795044
Epoch: 1, Steps: 8 | Train Loss: 1.897 Vali Loss: 1.399 Vali Acc: 0.738 Test Loss: 1.399 Test Acc: 0.738
Validation loss decreased (inf --> -0.737486).  Saving model ...
Epoch: 2 cost time: 3.9766993522644043
Epoch: 2, Steps: 8 | Train Loss: 0.954 Vali Loss: 0.628 Vali Acc: 0.809 Test Loss: 0.628 Test Acc: 0.809
Validation loss decreased (-0.737486 --> -0.809369).  Saving model ...
Epoch: 3 cost time: 3.760077476501465
Epoch: 3, Steps: 8 | Train Loss: 0.394 Vali Loss: 0.503 Vali Acc: 0.841 Test Loss: 0.503 Test Acc: 0.841
Validation loss decreased (-0.809369 --> -0.840620).  Saving model ...
Epoch: 4 cost time: 3.7312583923339844
Epoch: 4, Steps: 8 | Train Loss: 0.187 Vali Loss: 0.526 Vali Acc: 0.856 Test Loss: 0.526 Test Acc: 0.856
Validation loss decreased (-0.840620 --> -0.856245).  Saving model ...
Epoch: 5 cost time: 3.729750156402588
Epoch: 5, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.602 Vali Acc: 0.841 Test Loss: 0.602 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.961228847503662
Epoch: 6, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.661 Vali Acc: 0.841 Test Loss: 0.661 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.012948513031006
Epoch: 7, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.602 Vali Acc: 0.863 Test Loss: 0.602 Test Acc: 0.863
Validation loss decreased (-0.856245 --> -0.862494).  Saving model ...
Epoch: 8 cost time: 3.9342105388641357
Epoch: 8, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.662 Vali Acc: 0.856 Test Loss: 0.662 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.7423369884490967
Epoch: 9, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.812 Vali Acc: 0.844 Test Loss: 0.812 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.783078670501709
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.778 Vali Acc: 0.838 Test Loss: 0.778 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.7474663257598877
Epoch: 11, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.790 Vali Acc: 0.831 Test Loss: 0.790 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.9969961643218994
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.857 Vali Acc: 0.841 Test Loss: 0.857 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.058043956756592
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.873 Vali Acc: 0.838 Test Loss: 0.873 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.978187322616577
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.854 Vali Acc: 0.841 Test Loss: 0.854 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.7558834552764893
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.848 Vali Acc: 0.841 Test Loss: 0.848 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.783418893814087
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.843 Vali Acc: 0.841 Test Loss: 0.843 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.8533530235290527
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.838 Vali Acc: 0.841 Test Loss: 0.838 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 8585096
model size : 35.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 23.323437452316284
Epoch: 1, Steps: 8 | Train Loss: 1.951 Vali Loss: 1.635 Vali Acc: 0.562 Test Loss: 1.635 Test Acc: 0.562
Validation loss decreased (inf --> -0.562484).  Saving model ...
Epoch: 2 cost time: 21.01254940032959
Epoch: 2, Steps: 8 | Train Loss: 1.247 Vali Loss: 0.896 Vali Acc: 0.778 Test Loss: 0.896 Test Acc: 0.778
Validation loss decreased (-0.562484 --> -0.778116).  Saving model ...
Epoch: 3 cost time: 20.4373140335083
Epoch: 3, Steps: 8 | Train Loss: 0.643 Vali Loss: 0.541 Vali Acc: 0.825 Test Loss: 0.541 Test Acc: 0.825
Validation loss decreased (-0.778116 --> -0.824995).  Saving model ...
Epoch: 4 cost time: 21.33302068710327
Epoch: 4, Steps: 8 | Train Loss: 0.345 Vali Loss: 0.480 Vali Acc: 0.847 Test Loss: 0.480 Test Acc: 0.847
Validation loss decreased (-0.824995 --> -0.846870).  Saving model ...
Epoch: 5 cost time: 20.03965735435486
Epoch: 5, Steps: 8 | Train Loss: 0.183 Vali Loss: 0.574 Vali Acc: 0.828 Test Loss: 0.574 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 20.245301961898804
Epoch: 6, Steps: 8 | Train Loss: 0.110 Vali Loss: 0.530 Vali Acc: 0.850 Test Loss: 0.530 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 7 cost time: 20.08641815185547
Epoch: 7, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.477 Vali Acc: 0.856 Test Loss: 0.477 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.856245).  Saving model ...
Epoch: 8 cost time: 19.409239768981934
Epoch: 8, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.545 Vali Acc: 0.866 Test Loss: 0.545 Test Acc: 0.866
Validation loss decreased (-0.856245 --> -0.865620).  Saving model ...
Epoch: 9 cost time: 19.331729888916016
Epoch: 9, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.670 Vali Acc: 0.859 Test Loss: 0.670 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 19.154126405715942
Epoch: 10, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.655 Vali Acc: 0.838 Test Loss: 0.655 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 18.604092121124268
Epoch: 11, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.659 Vali Acc: 0.831 Test Loss: 0.659 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 18.231335639953613
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.659 Vali Acc: 0.844 Test Loss: 0.659 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 18.552939653396606
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.662 Vali Acc: 0.847 Test Loss: 0.662 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 18.163566827774048
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.657 Vali Acc: 0.856 Test Loss: 0.657 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 17.952877283096313
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.649 Vali Acc: 0.856 Test Loss: 0.649 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 17.770641326904297
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.646 Vali Acc: 0.856 Test Loss: 0.646 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 18.347503185272217
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.645 Vali Acc: 0.859 Test Loss: 0.645 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 18.185235500335693
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.656 Vali Acc: 0.859 Test Loss: 0.656 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 28282952
model size : 109.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 9.258239030838013
Epoch: 1, Steps: 8 | Train Loss: 2.092 Vali Loss: 1.740 Vali Acc: 0.434 Test Loss: 1.740 Test Acc: 0.434
Validation loss decreased (inf --> -0.434358).  Saving model ...
Epoch: 2 cost time: 6.8573548793792725
Epoch: 2, Steps: 8 | Train Loss: 1.335 Vali Loss: 0.944 Vali Acc: 0.766 Test Loss: 0.944 Test Acc: 0.766
Validation loss decreased (-0.434358 --> -0.765616).  Saving model ...
Epoch: 3 cost time: 6.669537782669067
Epoch: 3, Steps: 8 | Train Loss: 0.696 Vali Loss: 0.574 Vali Acc: 0.844 Test Loss: 0.574 Test Acc: 0.844
Validation loss decreased (-0.765616 --> -0.843744).  Saving model ...
Epoch: 4 cost time: 7.263843297958374
Epoch: 4, Steps: 8 | Train Loss: 0.345 Vali Loss: 0.504 Vali Acc: 0.847 Test Loss: 0.504 Test Acc: 0.847
Validation loss decreased (-0.843744 --> -0.846870).  Saving model ...
Epoch: 5 cost time: 6.980689525604248
Epoch: 5, Steps: 8 | Train Loss: 0.186 Vali Loss: 0.481 Vali Acc: 0.844 Test Loss: 0.481 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.69466495513916
Epoch: 6, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.490 Vali Acc: 0.856 Test Loss: 0.490 Test Acc: 0.856
Validation loss decreased (-0.846870 --> -0.856245).  Saving model ...
Epoch: 7 cost time: 7.7452569007873535
Epoch: 7, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.495 Vali Acc: 0.859 Test Loss: 0.495 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 8 cost time: 7.71273136138916
Epoch: 8, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.522 Vali Acc: 0.863 Test Loss: 0.522 Test Acc: 0.863
Validation loss decreased (-0.859370 --> -0.862495).  Saving model ...
Epoch: 9 cost time: 7.74494743347168
Epoch: 9, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.604 Vali Acc: 0.847 Test Loss: 0.604 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.843115568161011
Epoch: 10, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.582 Vali Acc: 0.853 Test Loss: 0.582 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 7.6496007442474365
Epoch: 11, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.577 Vali Acc: 0.863 Test Loss: 0.577 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 7.637470960617065
Epoch: 12, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.583 Vali Acc: 0.869 Test Loss: 0.583 Test Acc: 0.869
Validation loss decreased (-0.862495 --> -0.868744).  Saving model ...
Epoch: 13 cost time: 8.016278743743896
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.609 Vali Acc: 0.856 Test Loss: 0.609 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 7.777070045471191
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.618 Vali Acc: 0.859 Test Loss: 0.618 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 7.837820053100586
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.627 Vali Acc: 0.863 Test Loss: 0.627 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 8.113636493682861
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.634 Vali Acc: 0.863 Test Loss: 0.634 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 7.896304130554199
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.643 Vali Acc: 0.863 Test Loss: 0.643 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 7.89439058303833
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.645 Vali Acc: 0.869 Test Loss: 0.645 Test Acc: 0.869
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 7.881157875061035
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.645 Vali Acc: 0.872 Test Loss: 0.645 Test Acc: 0.872
Validation loss decreased (-0.868744 --> -0.871869).  Saving model ...
Epoch: 20 cost time: 7.633745431900024
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.646 Vali Acc: 0.869 Test Loss: 0.646 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 7.680749177932739
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.659 Vali Acc: 0.863 Test Loss: 0.659 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 8.041111707687378
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.665 Vali Acc: 0.869 Test Loss: 0.665 Test Acc: 0.869
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 7.669790983200073
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.672 Vali Acc: 0.869 Test Loss: 0.672 Test Acc: 0.869
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 7.704497814178467
Epoch: 24, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.678 Vali Acc: 0.866 Test Loss: 0.678 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 8.139663219451904
Epoch: 25, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.678 Vali Acc: 0.866 Test Loss: 0.678 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 7.846395492553711
Epoch: 26, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.681 Vali Acc: 0.866 Test Loss: 0.681 Test Acc: 0.866
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 8.087152242660522
Epoch: 27, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.679 Vali Acc: 0.869 Test Loss: 0.679 Test Acc: 0.869
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 8.085317611694336
Epoch: 28, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.684 Vali Acc: 0.872 Test Loss: 0.684 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 7.85164475440979
Epoch: 29, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.699 Vali Acc: 0.866 Test Loss: 0.699 Test Acc: 0.866
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 8423624
model size : 33.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 16.904188871383667
Epoch: 1, Steps: 8 | Train Loss: 1.951 Vali Loss: 1.639 Vali Acc: 0.562 Test Loss: 1.639 Test Acc: 0.562
Validation loss decreased (inf --> -0.562484).  Saving model ...
Epoch: 2 cost time: 16.156402587890625
Epoch: 2, Steps: 8 | Train Loss: 1.248 Vali Loss: 0.905 Vali Acc: 0.781 Test Loss: 0.905 Test Acc: 0.781
Validation loss decreased (-0.562484 --> -0.781241).  Saving model ...
Epoch: 3 cost time: 15.60851788520813
Epoch: 3, Steps: 8 | Train Loss: 0.643 Vali Loss: 0.551 Vali Acc: 0.825 Test Loss: 0.551 Test Acc: 0.825
Validation loss decreased (-0.781241 --> -0.824994).  Saving model ...
Epoch: 4 cost time: 14.937069416046143
Epoch: 4, Steps: 8 | Train Loss: 0.344 Vali Loss: 0.488 Vali Acc: 0.847 Test Loss: 0.488 Test Acc: 0.847
Validation loss decreased (-0.824994 --> -0.846870).  Saving model ...
Epoch: 5 cost time: 15.129562139511108
Epoch: 5, Steps: 8 | Train Loss: 0.182 Vali Loss: 0.574 Vali Acc: 0.828 Test Loss: 0.574 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 15.204901456832886
Epoch: 6, Steps: 8 | Train Loss: 0.110 Vali Loss: 0.534 Vali Acc: 0.847 Test Loss: 0.534 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 14.41939902305603
Epoch: 7, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.486 Vali Acc: 0.856 Test Loss: 0.486 Test Acc: 0.856
Validation loss decreased (-0.846870 --> -0.856245).  Saving model ...
Epoch: 8 cost time: 15.11074447631836
Epoch: 8, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.556 Vali Acc: 0.859 Test Loss: 0.556 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859369).  Saving model ...
Epoch: 9 cost time: 14.637247085571289
Epoch: 9, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.678 Vali Acc: 0.856 Test Loss: 0.678 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 14.113798141479492
Epoch: 10, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.667 Vali Acc: 0.834 Test Loss: 0.667 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 14.89636492729187
Epoch: 11, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.670 Vali Acc: 0.831 Test Loss: 0.670 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 14.042153596878052
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.668 Vali Acc: 0.844 Test Loss: 0.668 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 14.356286764144897
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.670 Vali Acc: 0.850 Test Loss: 0.670 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 14.989766120910645
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.665 Vali Acc: 0.853 Test Loss: 0.665 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 14.090726137161255
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.658 Vali Acc: 0.853 Test Loss: 0.658 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 14.841509103775024
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.655 Vali Acc: 0.853 Test Loss: 0.655 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 15.232142686843872
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.655 Vali Acc: 0.856 Test Loss: 0.655 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 14.531360626220703
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.666 Vali Acc: 0.856 Test Loss: 0.666 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 28282952
model size : 109.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 7.439349174499512
Epoch: 1, Steps: 8 | Train Loss: 2.093 Vali Loss: 1.742 Vali Acc: 0.428 Test Loss: 1.742 Test Acc: 0.428
Validation loss decreased (inf --> -0.428108).  Saving model ...
Epoch: 2 cost time: 6.327363014221191
Epoch: 2, Steps: 8 | Train Loss: 1.335 Vali Loss: 0.951 Vali Acc: 0.766 Test Loss: 0.951 Test Acc: 0.766
Validation loss decreased (-0.428108 --> -0.765615).  Saving model ...
Epoch: 3 cost time: 6.370026588439941
Epoch: 3, Steps: 8 | Train Loss: 0.697 Vali Loss: 0.580 Vali Acc: 0.838 Test Loss: 0.580 Test Acc: 0.838
Validation loss decreased (-0.765615 --> -0.837494).  Saving model ...
Epoch: 4 cost time: 6.487206935882568
Epoch: 4, Steps: 8 | Train Loss: 0.345 Vali Loss: 0.509 Vali Acc: 0.847 Test Loss: 0.509 Test Acc: 0.847
Validation loss decreased (-0.837494 --> -0.846870).  Saving model ...
Epoch: 5 cost time: 6.447248935699463
Epoch: 5, Steps: 8 | Train Loss: 0.186 Vali Loss: 0.491 Vali Acc: 0.841 Test Loss: 0.491 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.885201930999756
Epoch: 6, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.507 Vali Acc: 0.847 Test Loss: 0.507 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 7 cost time: 6.470976829528809
Epoch: 7, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.511 Vali Acc: 0.850 Test Loss: 0.511 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 8 cost time: 6.486546993255615
Epoch: 8, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.538 Vali Acc: 0.863 Test Loss: 0.538 Test Acc: 0.863
Validation loss decreased (-0.849995 --> -0.862495).  Saving model ...
Epoch: 9 cost time: 7.001039981842041
Epoch: 9, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.619 Vali Acc: 0.847 Test Loss: 0.619 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.835919141769409
Epoch: 10, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.593 Vali Acc: 0.853 Test Loss: 0.593 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.364432096481323
Epoch: 11, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.590 Vali Acc: 0.866 Test Loss: 0.590 Test Acc: 0.866
Validation loss decreased (-0.862495 --> -0.865619).  Saving model ...
Epoch: 12 cost time: 6.730605125427246
Epoch: 12, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.596 Vali Acc: 0.853 Test Loss: 0.596 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.719595193862915
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.619 Vali Acc: 0.850 Test Loss: 0.619 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.354663372039795
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.627 Vali Acc: 0.853 Test Loss: 0.627 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.272921562194824
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.639 Vali Acc: 0.853 Test Loss: 0.639 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.982957601547241
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.647 Vali Acc: 0.850 Test Loss: 0.647 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 6.458312749862671
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.657 Vali Acc: 0.853 Test Loss: 0.657 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 6.2097697257995605
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.658 Vali Acc: 0.856 Test Loss: 0.658 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 6.253231048583984
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.658 Vali Acc: 0.856 Test Loss: 0.658 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 6.597313165664673
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.659 Vali Acc: 0.866 Test Loss: 0.659 Test Acc: 0.866
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 6.284057140350342
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.673 Vali Acc: 0.856 Test Loss: 0.673 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 8423624
model size : 33.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 10.550903797149658
Epoch: 1, Steps: 8 | Train Loss: 1.953 Vali Loss: 1.652 Vali Acc: 0.562 Test Loss: 1.652 Test Acc: 0.562
Validation loss decreased (inf --> -0.562483).  Saving model ...
Epoch: 2 cost time: 8.871849536895752
Epoch: 2, Steps: 8 | Train Loss: 1.276 Vali Loss: 0.940 Vali Acc: 0.769 Test Loss: 0.940 Test Acc: 0.769
Validation loss decreased (-0.562483 --> -0.768741).  Saving model ...
Epoch: 3 cost time: 9.182049036026001
Epoch: 3, Steps: 8 | Train Loss: 0.687 Vali Loss: 0.584 Vali Acc: 0.812 Test Loss: 0.584 Test Acc: 0.812
Validation loss decreased (-0.768741 --> -0.812494).  Saving model ...
Epoch: 4 cost time: 8.94596529006958
Epoch: 4, Steps: 8 | Train Loss: 0.399 Vali Loss: 0.517 Vali Acc: 0.844 Test Loss: 0.517 Test Acc: 0.844
Validation loss decreased (-0.812494 --> -0.843745).  Saving model ...
Epoch: 5 cost time: 8.893250465393066
Epoch: 5, Steps: 8 | Train Loss: 0.240 Vali Loss: 0.596 Vali Acc: 0.822 Test Loss: 0.596 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.474871635437012
Epoch: 6, Steps: 8 | Train Loss: 0.147 Vali Loss: 0.566 Vali Acc: 0.844 Test Loss: 0.566 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 9.158874988555908
Epoch: 7, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.513 Vali Acc: 0.856 Test Loss: 0.513 Test Acc: 0.856
Validation loss decreased (-0.843745 --> -0.856245).  Saving model ...
Epoch: 8 cost time: 9.161982536315918
Epoch: 8, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.595 Vali Acc: 0.856 Test Loss: 0.595 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 8.905969381332397
Epoch: 9, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.692 Vali Acc: 0.838 Test Loss: 0.692 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 9.17006254196167
Epoch: 10, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.759 Vali Acc: 0.806 Test Loss: 0.759 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 8.973945617675781
Epoch: 11, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.726 Vali Acc: 0.816 Test Loss: 0.726 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 9.054424285888672
Epoch: 12, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.693 Vali Acc: 0.825 Test Loss: 0.693 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 9.138851165771484
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.691 Vali Acc: 0.834 Test Loss: 0.691 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 9.10642385482788
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.692 Vali Acc: 0.844 Test Loss: 0.692 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 9.473462104797363
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.693 Vali Acc: 0.844 Test Loss: 0.693 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 8.377354860305786
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.691 Vali Acc: 0.844 Test Loss: 0.691 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 8.454297065734863
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.691 Vali Acc: 0.847 Test Loss: 0.691 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 28282952
model size : 109.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.805531024932861
Epoch: 1, Steps: 8 | Train Loss: 2.092 Vali Loss: 1.754 Vali Acc: 0.412 Test Loss: 1.754 Test Acc: 0.412
Validation loss decreased (inf --> -0.412482).  Saving model ...
Epoch: 2 cost time: 3.743044376373291
Epoch: 2, Steps: 8 | Train Loss: 1.363 Vali Loss: 0.991 Vali Acc: 0.759 Test Loss: 0.991 Test Acc: 0.759
Validation loss decreased (-0.412482 --> -0.759365).  Saving model ...
Epoch: 3 cost time: 3.6047847270965576
Epoch: 3, Steps: 8 | Train Loss: 0.736 Vali Loss: 0.609 Vali Acc: 0.828 Test Loss: 0.609 Test Acc: 0.828
Validation loss decreased (-0.759365 --> -0.828119).  Saving model ...
Epoch: 4 cost time: 3.275951862335205
Epoch: 4, Steps: 8 | Train Loss: 0.390 Vali Loss: 0.527 Vali Acc: 0.847 Test Loss: 0.527 Test Acc: 0.847
Validation loss decreased (-0.828119 --> -0.846870).  Saving model ...
Epoch: 5 cost time: 3.4684793949127197
Epoch: 5, Steps: 8 | Train Loss: 0.222 Vali Loss: 0.515 Vali Acc: 0.841 Test Loss: 0.515 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.7835693359375
Epoch: 6, Steps: 8 | Train Loss: 0.110 Vali Loss: 0.523 Vali Acc: 0.863 Test Loss: 0.523 Test Acc: 0.863
Validation loss decreased (-0.846870 --> -0.862495).  Saving model ...
Epoch: 7 cost time: 3.608011484146118
Epoch: 7, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.523 Vali Acc: 0.856 Test Loss: 0.523 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.660062551498413
Epoch: 8, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.538 Vali Acc: 0.859 Test Loss: 0.538 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.4808428287506104
Epoch: 9, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.621 Vali Acc: 0.847 Test Loss: 0.621 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.721048355102539
Epoch: 10, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.609 Vali Acc: 0.853 Test Loss: 0.609 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.683797836303711
Epoch: 11, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.606 Vali Acc: 0.856 Test Loss: 0.606 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.4984631538391113
Epoch: 12, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.616 Vali Acc: 0.853 Test Loss: 0.616 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.505228281021118
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.646 Vali Acc: 0.853 Test Loss: 0.646 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.398000717163086
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.655 Vali Acc: 0.847 Test Loss: 0.655 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.8685965538024902
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.664 Vali Acc: 0.850 Test Loss: 0.664 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.646120548248291
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.673 Vali Acc: 0.850 Test Loss: 0.673 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 8423624
model size : 33.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 12.30286979675293
Epoch: 1, Steps: 8 | Train Loss: 2.019 Vali Loss: 1.720 Vali Acc: 0.509 Test Loss: 1.720 Test Acc: 0.509
Validation loss decreased (inf --> -0.509358).  Saving model ...
Epoch: 2 cost time: 10.512964725494385
Epoch: 2, Steps: 8 | Train Loss: 1.373 Vali Loss: 0.920 Vali Acc: 0.816 Test Loss: 0.920 Test Acc: 0.816
Validation loss decreased (-0.509358 --> -0.815616).  Saving model ...
Epoch: 3 cost time: 11.084633111953735
Epoch: 3, Steps: 8 | Train Loss: 0.621 Vali Loss: 0.546 Vali Acc: 0.847 Test Loss: 0.546 Test Acc: 0.847
Validation loss decreased (-0.815616 --> -0.846870).  Saving model ...
Epoch: 4 cost time: 10.344092607498169
Epoch: 4, Steps: 8 | Train Loss: 0.309 Vali Loss: 0.458 Vali Acc: 0.863 Test Loss: 0.458 Test Acc: 0.863
Validation loss decreased (-0.846870 --> -0.862495).  Saving model ...
Epoch: 5 cost time: 10.96006441116333
Epoch: 5, Steps: 8 | Train Loss: 0.151 Vali Loss: 0.461 Vali Acc: 0.872 Test Loss: 0.461 Test Acc: 0.872
Validation loss decreased (-0.862495 --> -0.871870).  Saving model ...
Epoch: 6 cost time: 10.502943515777588
Epoch: 6, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.509 Vali Acc: 0.863 Test Loss: 0.509 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.943824291229248
Epoch: 7, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.520 Vali Acc: 0.863 Test Loss: 0.520 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 10.424688339233398
Epoch: 8, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.546 Vali Acc: 0.859 Test Loss: 0.546 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 10.679734945297241
Epoch: 9, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.599 Vali Acc: 0.850 Test Loss: 0.599 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 10.71547245979309
Epoch: 10, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.619 Vali Acc: 0.853 Test Loss: 0.619 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 10.322077512741089
Epoch: 11, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.614 Vali Acc: 0.856 Test Loss: 0.614 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 10.607898950576782
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.605 Vali Acc: 0.859 Test Loss: 0.605 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 10.327194213867188
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.612 Vali Acc: 0.859 Test Loss: 0.612 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 10.836493015289307
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.638 Vali Acc: 0.853 Test Loss: 0.638 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 10.41035008430481
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.655 Vali Acc: 0.853 Test Loss: 0.655 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 14223176
model size : 55.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 6.1836652755737305
Epoch: 1, Steps: 8 | Train Loss: 1.912 Vali Loss: 1.657 Vali Acc: 0.553 Test Loss: 1.657 Test Acc: 0.553
Validation loss decreased (inf --> -0.553108).  Saving model ...
Epoch: 2 cost time: 4.480476140975952
Epoch: 2, Steps: 8 | Train Loss: 1.281 Vali Loss: 0.890 Vali Acc: 0.797 Test Loss: 0.890 Test Acc: 0.797
Validation loss decreased (-0.553108 --> -0.796866).  Saving model ...
Epoch: 3 cost time: 4.428791761398315
Epoch: 3, Steps: 8 | Train Loss: 0.601 Vali Loss: 0.537 Vali Acc: 0.841 Test Loss: 0.537 Test Acc: 0.841
Validation loss decreased (-0.796866 --> -0.840620).  Saving model ...
Epoch: 4 cost time: 4.17471718788147
Epoch: 4, Steps: 8 | Train Loss: 0.341 Vali Loss: 0.448 Vali Acc: 0.853 Test Loss: 0.448 Test Acc: 0.853
Validation loss decreased (-0.840620 --> -0.853121).  Saving model ...
Epoch: 5 cost time: 4.175865888595581
Epoch: 5, Steps: 8 | Train Loss: 0.154 Vali Loss: 0.448 Vali Acc: 0.869 Test Loss: 0.448 Test Acc: 0.869
Validation loss decreased (-0.853121 --> -0.868746).  Saving model ...
Epoch: 6 cost time: 4.5468926429748535
Epoch: 6, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.483 Vali Acc: 0.869 Test Loss: 0.483 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.413203239440918
Epoch: 7, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.545 Vali Acc: 0.853 Test Loss: 0.545 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.499109745025635
Epoch: 8, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.622 Vali Acc: 0.856 Test Loss: 0.622 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.501530170440674
Epoch: 9, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.563 Vali Acc: 0.850 Test Loss: 0.563 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.644667625427246
Epoch: 10, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.559 Vali Acc: 0.856 Test Loss: 0.559 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.735156774520874
Epoch: 11, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.572 Vali Acc: 0.859 Test Loss: 0.572 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.572121620178223
Epoch: 12, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.593 Vali Acc: 0.856 Test Loss: 0.593 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.55682110786438
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.602 Vali Acc: 0.859 Test Loss: 0.602 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.646003246307373
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.610 Vali Acc: 0.859 Test Loss: 0.610 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.848130941390991
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.626 Vali Acc: 0.859 Test Loss: 0.626 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 4293320
model size : 17.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 9.693673133850098
Epoch: 1, Steps: 8 | Train Loss: 2.020 Vali Loss: 1.722 Vali Acc: 0.506 Test Loss: 1.722 Test Acc: 0.506
Validation loss decreased (inf --> -0.506233).  Saving model ...
Epoch: 2 cost time: 8.430371284484863
Epoch: 2, Steps: 8 | Train Loss: 1.373 Vali Loss: 0.926 Vali Acc: 0.812 Test Loss: 0.926 Test Acc: 0.812
Validation loss decreased (-0.506233 --> -0.812491).  Saving model ...
Epoch: 3 cost time: 8.671920537948608
Epoch: 3, Steps: 8 | Train Loss: 0.621 Vali Loss: 0.552 Vali Acc: 0.847 Test Loss: 0.552 Test Acc: 0.847
Validation loss decreased (-0.812491 --> -0.846869).  Saving model ...
Epoch: 4 cost time: 8.376671552658081
Epoch: 4, Steps: 8 | Train Loss: 0.308 Vali Loss: 0.463 Vali Acc: 0.859 Test Loss: 0.463 Test Acc: 0.859
Validation loss decreased (-0.846869 --> -0.859370).  Saving model ...
Epoch: 5 cost time: 8.52392864227295
Epoch: 5, Steps: 8 | Train Loss: 0.150 Vali Loss: 0.463 Vali Acc: 0.872 Test Loss: 0.463 Test Acc: 0.872
Validation loss decreased (-0.859370 --> -0.871870).  Saving model ...
Epoch: 6 cost time: 8.368810653686523
Epoch: 6, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.513 Vali Acc: 0.859 Test Loss: 0.513 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.644630908966064
Epoch: 7, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.528 Vali Acc: 0.853 Test Loss: 0.528 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 8.226951837539673
Epoch: 8, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.549 Vali Acc: 0.856 Test Loss: 0.549 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 8.158402919769287
Epoch: 9, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.598 Vali Acc: 0.856 Test Loss: 0.598 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 7.462911367416382
Epoch: 10, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.619 Vali Acc: 0.853 Test Loss: 0.619 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 7.32218074798584
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.616 Vali Acc: 0.853 Test Loss: 0.616 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 7.059528112411499
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.608 Vali Acc: 0.856 Test Loss: 0.608 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 7.393755912780762
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.615 Vali Acc: 0.859 Test Loss: 0.615 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 7.1980977058410645
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.639 Vali Acc: 0.850 Test Loss: 0.639 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 7.738089084625244
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.657 Vali Acc: 0.841 Test Loss: 0.657 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 14223176
model size : 55.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.831793308258057
Epoch: 1, Steps: 8 | Train Loss: 1.909 Vali Loss: 1.662 Vali Acc: 0.547 Test Loss: 1.662 Test Acc: 0.547
Validation loss decreased (inf --> -0.546858).  Saving model ...
Epoch: 2 cost time: 3.5815703868865967
Epoch: 2, Steps: 8 | Train Loss: 1.285 Vali Loss: 0.909 Vali Acc: 0.794 Test Loss: 0.909 Test Acc: 0.794
Validation loss decreased (-0.546858 --> -0.793741).  Saving model ...
Epoch: 3 cost time: 3.3491594791412354
Epoch: 3, Steps: 8 | Train Loss: 0.606 Vali Loss: 0.551 Vali Acc: 0.841 Test Loss: 0.551 Test Acc: 0.841
Validation loss decreased (-0.793741 --> -0.840619).  Saving model ...
Epoch: 4 cost time: 3.373922824859619
Epoch: 4, Steps: 8 | Train Loss: 0.343 Vali Loss: 0.453 Vali Acc: 0.856 Test Loss: 0.453 Test Acc: 0.856
Validation loss decreased (-0.840619 --> -0.856245).  Saving model ...
Epoch: 5 cost time: 3.4413771629333496
Epoch: 5, Steps: 8 | Train Loss: 0.153 Vali Loss: 0.452 Vali Acc: 0.869 Test Loss: 0.452 Test Acc: 0.869
Validation loss decreased (-0.856245 --> -0.868745).  Saving model ...
Epoch: 6 cost time: 3.561223030090332
Epoch: 6, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.489 Vali Acc: 0.869 Test Loss: 0.489 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.4318904876708984
Epoch: 7, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.553 Vali Acc: 0.853 Test Loss: 0.553 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.3110969066619873
Epoch: 8, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.630 Vali Acc: 0.853 Test Loss: 0.630 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.364713191986084
Epoch: 9, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.569 Vali Acc: 0.853 Test Loss: 0.569 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.522115468978882
Epoch: 10, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.564 Vali Acc: 0.856 Test Loss: 0.564 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.6359498500823975
Epoch: 11, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.579 Vali Acc: 0.856 Test Loss: 0.579 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.4802894592285156
Epoch: 12, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.600 Vali Acc: 0.856 Test Loss: 0.600 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.49649715423584
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.610 Vali Acc: 0.859 Test Loss: 0.610 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.570220947265625
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.619 Vali Acc: 0.863 Test Loss: 0.619 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.8610215187072754
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.635 Vali Acc: 0.859 Test Loss: 0.635 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 4293320
model size : 17.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 6.262246131896973
Epoch: 1, Steps: 8 | Train Loss: 2.021 Vali Loss: 1.728 Vali Acc: 0.506 Test Loss: 1.728 Test Acc: 0.506
Validation loss decreased (inf --> -0.506233).  Saving model ...
Epoch: 2 cost time: 5.195135831832886
Epoch: 2, Steps: 8 | Train Loss: 1.398 Vali Loss: 0.952 Vali Acc: 0.803 Test Loss: 0.952 Test Acc: 0.803
Validation loss decreased (-0.506233 --> -0.803115).  Saving model ...
Epoch: 3 cost time: 4.95447564125061
Epoch: 3, Steps: 8 | Train Loss: 0.655 Vali Loss: 0.571 Vali Acc: 0.834 Test Loss: 0.571 Test Acc: 0.834
Validation loss decreased (-0.803115 --> -0.834369).  Saving model ...
Epoch: 4 cost time: 4.952218532562256
Epoch: 4, Steps: 8 | Train Loss: 0.345 Vali Loss: 0.484 Vali Acc: 0.844 Test Loss: 0.484 Test Acc: 0.844
Validation loss decreased (-0.834369 --> -0.843745).  Saving model ...
Epoch: 5 cost time: 5.194560766220093
Epoch: 5, Steps: 8 | Train Loss: 0.184 Vali Loss: 0.487 Vali Acc: 0.863 Test Loss: 0.487 Test Acc: 0.863
Validation loss decreased (-0.843745 --> -0.862495).  Saving model ...
Epoch: 6 cost time: 5.220513820648193
Epoch: 6, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.538 Vali Acc: 0.850 Test Loss: 0.538 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.995394229888916
Epoch: 7, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.530 Vali Acc: 0.872 Test Loss: 0.530 Test Acc: 0.872
Validation loss decreased (-0.862495 --> -0.871870).  Saving model ...
Epoch: 8 cost time: 4.947367906570435
Epoch: 8, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.571 Vali Acc: 0.863 Test Loss: 0.571 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.157748460769653
Epoch: 9, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.623 Vali Acc: 0.853 Test Loss: 0.623 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.933894395828247
Epoch: 10, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.622 Vali Acc: 0.850 Test Loss: 0.622 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.885892868041992
Epoch: 11, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.623 Vali Acc: 0.859 Test Loss: 0.623 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.835439205169678
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.625 Vali Acc: 0.866 Test Loss: 0.625 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.686932325363159
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.635 Vali Acc: 0.866 Test Loss: 0.635 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.887737512588501
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.663 Vali Acc: 0.859 Test Loss: 0.663 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.872802734375
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.683 Vali Acc: 0.853 Test Loss: 0.683 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.477349281311035
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.681 Vali Acc: 0.856 Test Loss: 0.681 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.832319021224976
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.693 Vali Acc: 0.856 Test Loss: 0.693 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 14223176
model size : 55.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.57869029045105
Epoch: 1, Steps: 8 | Train Loss: 1.910 Vali Loss: 1.676 Vali Acc: 0.525 Test Loss: 1.676 Test Acc: 0.525
Validation loss decreased (inf --> -0.524983).  Saving model ...
Epoch: 2 cost time: 2.204447031021118
Epoch: 2, Steps: 8 | Train Loss: 1.303 Vali Loss: 0.942 Vali Acc: 0.784 Test Loss: 0.942 Test Acc: 0.784
Validation loss decreased (-0.524983 --> -0.784366).  Saving model ...
Epoch: 3 cost time: 2.2032010555267334
Epoch: 3, Steps: 8 | Train Loss: 0.633 Vali Loss: 0.582 Vali Acc: 0.831 Test Loss: 0.582 Test Acc: 0.831
Validation loss decreased (-0.784366 --> -0.831244).  Saving model ...
Epoch: 4 cost time: 2.2926766872406006
Epoch: 4, Steps: 8 | Train Loss: 0.373 Vali Loss: 0.486 Vali Acc: 0.847 Test Loss: 0.486 Test Acc: 0.847
Validation loss decreased (-0.831244 --> -0.846870).  Saving model ...
Epoch: 5 cost time: 2.251305341720581
Epoch: 5, Steps: 8 | Train Loss: 0.192 Vali Loss: 0.501 Vali Acc: 0.850 Test Loss: 0.501 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 6 cost time: 2.1521921157836914
Epoch: 6, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.537 Vali Acc: 0.856 Test Loss: 0.537 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.856245).  Saving model ...
Epoch: 7 cost time: 2.1477646827697754
Epoch: 7, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.580 Vali Acc: 0.847 Test Loss: 0.580 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.679795742034912
Epoch: 8, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.661 Vali Acc: 0.838 Test Loss: 0.661 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.1789281368255615
Epoch: 9, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.591 Vali Acc: 0.847 Test Loss: 0.591 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.2320125102996826
Epoch: 10, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.588 Vali Acc: 0.853 Test Loss: 0.588 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.203355550765991
Epoch: 11, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.612 Vali Acc: 0.853 Test Loss: 0.612 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.22135066986084
Epoch: 12, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.640 Vali Acc: 0.847 Test Loss: 0.640 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.2232773303985596
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.654 Vali Acc: 0.847 Test Loss: 0.654 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.2092642784118652
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.664 Vali Acc: 0.847 Test Loss: 0.664 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.1817100048065186
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.677 Vali Acc: 0.850 Test Loss: 0.677 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.249488353729248
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.684 Vali Acc: 0.850 Test Loss: 0.684 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 4293320
model size : 17.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 7.720233678817749
Epoch: 1, Steps: 8 | Train Loss: 1.963 Vali Loss: 1.630 Vali Acc: 0.631 Test Loss: 1.630 Test Acc: 0.631
Validation loss decreased (inf --> -0.631234).  Saving model ...
Epoch: 2 cost time: 6.1940741539001465
Epoch: 2, Steps: 8 | Train Loss: 1.325 Vali Loss: 0.887 Vali Acc: 0.797 Test Loss: 0.887 Test Acc: 0.797
Validation loss decreased (-0.631234 --> -0.796866).  Saving model ...
Epoch: 3 cost time: 6.422688961029053
Epoch: 3, Steps: 8 | Train Loss: 0.631 Vali Loss: 0.550 Vali Acc: 0.841 Test Loss: 0.550 Test Acc: 0.841
Validation loss decreased (-0.796866 --> -0.840620).  Saving model ...
Epoch: 4 cost time: 6.229983568191528
Epoch: 4, Steps: 8 | Train Loss: 0.358 Vali Loss: 0.475 Vali Acc: 0.847 Test Loss: 0.475 Test Acc: 0.847
Validation loss decreased (-0.840620 --> -0.846870).  Saving model ...
Epoch: 5 cost time: 6.302594900131226
Epoch: 5, Steps: 8 | Train Loss: 0.185 Vali Loss: 0.469 Vali Acc: 0.853 Test Loss: 0.469 Test Acc: 0.853
Validation loss decreased (-0.846870 --> -0.853120).  Saving model ...
Epoch: 6 cost time: 6.4278082847595215
Epoch: 6, Steps: 8 | Train Loss: 0.099 Vali Loss: 0.466 Vali Acc: 0.866 Test Loss: 0.466 Test Acc: 0.866
Validation loss decreased (-0.853120 --> -0.865620).  Saving model ...
Epoch: 7 cost time: 6.279911041259766
Epoch: 7, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.499 Vali Acc: 0.869 Test Loss: 0.499 Test Acc: 0.869
Validation loss decreased (-0.865620 --> -0.868745).  Saving model ...
Epoch: 8 cost time: 7.073659896850586
Epoch: 8, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.551 Vali Acc: 0.863 Test Loss: 0.551 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.9779603481292725
Epoch: 9, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.594 Vali Acc: 0.844 Test Loss: 0.594 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.962300539016724
Epoch: 10, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.638 Vali Acc: 0.850 Test Loss: 0.638 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 7.083349227905273
Epoch: 11, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.643 Vali Acc: 0.850 Test Loss: 0.643 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.860212802886963
Epoch: 12, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.624 Vali Acc: 0.841 Test Loss: 0.624 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 7.0338640213012695
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.623 Vali Acc: 0.850 Test Loss: 0.623 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.9217681884765625
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.634 Vali Acc: 0.853 Test Loss: 0.634 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 6.761246919631958
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.641 Vali Acc: 0.853 Test Loss: 0.641 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 6.816641330718994
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.641 Vali Acc: 0.853 Test Loss: 0.641 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 6.935866594314575
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.657 Vali Acc: 0.856 Test Loss: 0.657 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 7193288
model size : 28.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.811731815338135
Epoch: 1, Steps: 8 | Train Loss: 2.030 Vali Loss: 1.670 Vali Acc: 0.547 Test Loss: 1.670 Test Acc: 0.547
Validation loss decreased (inf --> -0.546858).  Saving model ...
Epoch: 2 cost time: 3.2785913944244385
Epoch: 2, Steps: 8 | Train Loss: 1.361 Vali Loss: 0.933 Vali Acc: 0.787 Test Loss: 0.933 Test Acc: 0.787
Validation loss decreased (-0.546858 --> -0.787491).  Saving model ...
Epoch: 3 cost time: 3.1877527236938477
Epoch: 3, Steps: 8 | Train Loss: 0.660 Vali Loss: 0.552 Vali Acc: 0.850 Test Loss: 0.552 Test Acc: 0.850
Validation loss decreased (-0.787491 --> -0.849994).  Saving model ...
Epoch: 4 cost time: 3.219998836517334
Epoch: 4, Steps: 8 | Train Loss: 0.384 Vali Loss: 0.474 Vali Acc: 0.850 Test Loss: 0.474 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 5 cost time: 3.188239574432373
Epoch: 5, Steps: 8 | Train Loss: 0.239 Vali Loss: 0.466 Vali Acc: 0.853 Test Loss: 0.466 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 6 cost time: 3.331017255783081
Epoch: 6, Steps: 8 | Train Loss: 0.117 Vali Loss: 0.472 Vali Acc: 0.856 Test Loss: 0.472 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 7 cost time: 3.3704161643981934
Epoch: 7, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.473 Vali Acc: 0.869 Test Loss: 0.473 Test Acc: 0.869
Validation loss decreased (-0.856245 --> -0.868745).  Saving model ...
Epoch: 8 cost time: 2.885545015335083
Epoch: 8, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.484 Vali Acc: 0.875 Test Loss: 0.484 Test Acc: 0.875
Validation loss decreased (-0.868745 --> -0.874995).  Saving model ...
Epoch: 9 cost time: 2.8862345218658447
Epoch: 9, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.530 Vali Acc: 0.866 Test Loss: 0.530 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.2379109859466553
Epoch: 10, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.554 Vali Acc: 0.869 Test Loss: 0.554 Test Acc: 0.869
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.960148572921753
Epoch: 11, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.576 Vali Acc: 0.859 Test Loss: 0.576 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.9321396350860596
Epoch: 12, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.582 Vali Acc: 0.863 Test Loss: 0.582 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.859119415283203
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.570 Vali Acc: 0.866 Test Loss: 0.570 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.926215171813965
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.586 Vali Acc: 0.866 Test Loss: 0.586 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.0736215114593506
Epoch: 15, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.600 Vali Acc: 0.869 Test Loss: 0.600 Test Acc: 0.869
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.0472633838653564
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.607 Vali Acc: 0.869 Test Loss: 0.607 Test Acc: 0.869
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.8913557529449463
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.613 Vali Acc: 0.869 Test Loss: 0.613 Test Acc: 0.869
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.8747446537017822
Epoch: 18, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.603 Vali Acc: 0.869 Test Loss: 0.603 Test Acc: 0.869
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.875
model parameter : 2228168
model size : 9.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.5943732261657715
Epoch: 1, Steps: 8 | Train Loss: 1.965 Vali Loss: 1.635 Vali Acc: 0.619 Test Loss: 1.635 Test Acc: 0.619
Validation loss decreased (inf --> -0.618734).  Saving model ...
Epoch: 2 cost time: 4.441498756408691
Epoch: 2, Steps: 8 | Train Loss: 1.334 Vali Loss: 0.901 Vali Acc: 0.794 Test Loss: 0.901 Test Acc: 0.794
Validation loss decreased (-0.618734 --> -0.793741).  Saving model ...
Epoch: 3 cost time: 4.875760078430176
Epoch: 3, Steps: 8 | Train Loss: 0.639 Vali Loss: 0.559 Vali Acc: 0.841 Test Loss: 0.559 Test Acc: 0.841
Validation loss decreased (-0.793741 --> -0.840619).  Saving model ...
Epoch: 4 cost time: 4.710633993148804
Epoch: 4, Steps: 8 | Train Loss: 0.360 Vali Loss: 0.478 Vali Acc: 0.847 Test Loss: 0.478 Test Acc: 0.847
Validation loss decreased (-0.840619 --> -0.846870).  Saving model ...
Epoch: 5 cost time: 4.787182807922363
Epoch: 5, Steps: 8 | Train Loss: 0.185 Vali Loss: 0.471 Vali Acc: 0.856 Test Loss: 0.471 Test Acc: 0.856
Validation loss decreased (-0.846870 --> -0.856245).  Saving model ...
Epoch: 6 cost time: 5.0226476192474365
Epoch: 6, Steps: 8 | Train Loss: 0.099 Vali Loss: 0.470 Vali Acc: 0.869 Test Loss: 0.470 Test Acc: 0.869
Validation loss decreased (-0.856245 --> -0.868745).  Saving model ...
Epoch: 7 cost time: 4.795544147491455
Epoch: 7, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.505 Vali Acc: 0.859 Test Loss: 0.505 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.825488567352295
Epoch: 8, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.556 Vali Acc: 0.863 Test Loss: 0.556 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.652350425720215
Epoch: 9, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.599 Vali Acc: 0.841 Test Loss: 0.599 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.51724648475647
Epoch: 10, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.643 Vali Acc: 0.853 Test Loss: 0.643 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.666914701461792
Epoch: 11, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.649 Vali Acc: 0.850 Test Loss: 0.649 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.367984771728516
Epoch: 12, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.629 Vali Acc: 0.844 Test Loss: 0.629 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.23877477645874
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.629 Vali Acc: 0.853 Test Loss: 0.629 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.125254154205322
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.640 Vali Acc: 0.856 Test Loss: 0.640 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.147736072540283
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.646 Vali Acc: 0.856 Test Loss: 0.646 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.47644567489624
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.646 Vali Acc: 0.856 Test Loss: 0.646 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 7193288
model size : 28.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.281367301940918
Epoch: 1, Steps: 8 | Train Loss: 2.030 Vali Loss: 1.674 Vali Acc: 0.544 Test Loss: 1.674 Test Acc: 0.544
Validation loss decreased (inf --> -0.543733).  Saving model ...
Epoch: 2 cost time: 2.6005899906158447
Epoch: 2, Steps: 8 | Train Loss: 1.361 Vali Loss: 0.943 Vali Acc: 0.791 Test Loss: 0.943 Test Acc: 0.791
Validation loss decreased (-0.543733 --> -0.790616).  Saving model ...
Epoch: 3 cost time: 2.590268850326538
Epoch: 3, Steps: 8 | Train Loss: 0.660 Vali Loss: 0.562 Vali Acc: 0.850 Test Loss: 0.562 Test Acc: 0.850
Validation loss decreased (-0.790616 --> -0.849994).  Saving model ...
Epoch: 4 cost time: 2.5674965381622314
Epoch: 4, Steps: 8 | Train Loss: 0.383 Vali Loss: 0.482 Vali Acc: 0.847 Test Loss: 0.482 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.6813461780548096
Epoch: 5, Steps: 8 | Train Loss: 0.236 Vali Loss: 0.473 Vali Acc: 0.850 Test Loss: 0.473 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 6 cost time: 2.771122694015503
Epoch: 6, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.475 Vali Acc: 0.856 Test Loss: 0.475 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.856245).  Saving model ...
Epoch: 7 cost time: 2.6749463081359863
Epoch: 7, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.480 Vali Acc: 0.859 Test Loss: 0.480 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 8 cost time: 2.5095126628875732
Epoch: 8, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.492 Vali Acc: 0.869 Test Loss: 0.492 Test Acc: 0.869
Validation loss decreased (-0.859370 --> -0.868745).  Saving model ...
Epoch: 9 cost time: 2.578336238861084
Epoch: 9, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.539 Vali Acc: 0.859 Test Loss: 0.539 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.489548444747925
Epoch: 10, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.564 Vali Acc: 0.863 Test Loss: 0.564 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.571320056915283
Epoch: 11, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.586 Vali Acc: 0.853 Test Loss: 0.586 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.7046749591827393
Epoch: 12, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.591 Vali Acc: 0.850 Test Loss: 0.591 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.3002896308898926
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.579 Vali Acc: 0.863 Test Loss: 0.579 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.5699610710144043
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.597 Vali Acc: 0.859 Test Loss: 0.597 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.502904176712036
Epoch: 15, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.611 Vali Acc: 0.859 Test Loss: 0.611 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.617203712463379
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.617 Vali Acc: 0.859 Test Loss: 0.617 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.4543557167053223
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.624 Vali Acc: 0.856 Test Loss: 0.624 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.237112283706665
Epoch: 18, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.613 Vali Acc: 0.853 Test Loss: 0.613 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 2228168
model size : 9.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.725424528121948
Epoch: 1, Steps: 8 | Train Loss: 1.968 Vali Loss: 1.639 Vali Acc: 0.625 Test Loss: 1.639 Test Acc: 0.625
Validation loss decreased (inf --> -0.624984).  Saving model ...
Epoch: 2 cost time: 3.0328893661499023
Epoch: 2, Steps: 8 | Train Loss: 1.348 Vali Loss: 0.917 Vali Acc: 0.787 Test Loss: 0.917 Test Acc: 0.787
Validation loss decreased (-0.624984 --> -0.787491).  Saving model ...
Epoch: 3 cost time: 3.069641351699829
Epoch: 3, Steps: 8 | Train Loss: 0.660 Vali Loss: 0.575 Vali Acc: 0.834 Test Loss: 0.575 Test Acc: 0.834
Validation loss decreased (-0.787491 --> -0.834369).  Saving model ...
Epoch: 4 cost time: 3.060497283935547
Epoch: 4, Steps: 8 | Train Loss: 0.389 Vali Loss: 0.499 Vali Acc: 0.841 Test Loss: 0.499 Test Acc: 0.841
Validation loss decreased (-0.834369 --> -0.840620).  Saving model ...
Epoch: 5 cost time: 3.227346658706665
Epoch: 5, Steps: 8 | Train Loss: 0.215 Vali Loss: 0.487 Vali Acc: 0.856 Test Loss: 0.487 Test Acc: 0.856
Validation loss decreased (-0.840620 --> -0.856245).  Saving model ...
Epoch: 6 cost time: 3.2245378494262695
Epoch: 6, Steps: 8 | Train Loss: 0.123 Vali Loss: 0.495 Vali Acc: 0.856 Test Loss: 0.495 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.2612204551696777
Epoch: 7, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.526 Vali Acc: 0.866 Test Loss: 0.526 Test Acc: 0.866
Validation loss decreased (-0.856245 --> -0.865620).  Saving model ...
Epoch: 8 cost time: 3.1054022312164307
Epoch: 8, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.565 Vali Acc: 0.850 Test Loss: 0.565 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.8864455223083496
Epoch: 9, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.599 Vali Acc: 0.838 Test Loss: 0.599 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.7630558013916016
Epoch: 10, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.658 Vali Acc: 0.853 Test Loss: 0.658 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.982016086578369
Epoch: 11, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.649 Vali Acc: 0.847 Test Loss: 0.649 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.8150970935821533
Epoch: 12, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.644 Vali Acc: 0.838 Test Loss: 0.644 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.9306793212890625
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.640 Vali Acc: 0.850 Test Loss: 0.640 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.5990490913391113
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.648 Vali Acc: 0.856 Test Loss: 0.648 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.8244967460632324
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.654 Vali Acc: 0.853 Test Loss: 0.654 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.7455506324768066
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.655 Vali Acc: 0.853 Test Loss: 0.655 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.785597562789917
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.674 Vali Acc: 0.853 Test Loss: 0.674 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 7193288
model size : 28.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.095449924468994
Epoch: 1, Steps: 8 | Train Loss: 2.033 Vali Loss: 1.676 Vali Acc: 0.537 Test Loss: 1.676 Test Acc: 0.537
Validation loss decreased (inf --> -0.537483).  Saving model ...
Epoch: 2 cost time: 1.5872609615325928
Epoch: 2, Steps: 8 | Train Loss: 1.373 Vali Loss: 0.958 Vali Acc: 0.791 Test Loss: 0.958 Test Acc: 0.791
Validation loss decreased (-0.537483 --> -0.790615).  Saving model ...
Epoch: 3 cost time: 1.6342015266418457
Epoch: 3, Steps: 8 | Train Loss: 0.682 Vali Loss: 0.580 Vali Acc: 0.841 Test Loss: 0.580 Test Acc: 0.841
Validation loss decreased (-0.790615 --> -0.840619).  Saving model ...
Epoch: 4 cost time: 1.6840870380401611
Epoch: 4, Steps: 8 | Train Loss: 0.404 Vali Loss: 0.504 Vali Acc: 0.838 Test Loss: 0.504 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6186614036560059
Epoch: 5, Steps: 8 | Train Loss: 0.263 Vali Loss: 0.500 Vali Acc: 0.850 Test Loss: 0.500 Test Acc: 0.850
Validation loss decreased (-0.840619 --> -0.849995).  Saving model ...
Epoch: 6 cost time: 1.6021699905395508
Epoch: 6, Steps: 8 | Train Loss: 0.136 Vali Loss: 0.511 Vali Acc: 0.847 Test Loss: 0.511 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7997970581054688
Epoch: 7, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.516 Vali Acc: 0.853 Test Loss: 0.516 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 8 cost time: 1.6370124816894531
Epoch: 8, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.530 Vali Acc: 0.853 Test Loss: 0.530 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7720000743865967
Epoch: 9, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.575 Vali Acc: 0.844 Test Loss: 0.575 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.7327964305877686
Epoch: 10, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.606 Vali Acc: 0.834 Test Loss: 0.606 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.707273244857788
Epoch: 11, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.637 Vali Acc: 0.831 Test Loss: 0.637 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.6367685794830322
Epoch: 12, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.639 Vali Acc: 0.831 Test Loss: 0.639 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.606564998626709
Epoch: 13, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.627 Vali Acc: 0.841 Test Loss: 0.627 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.637197732925415
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.645 Vali Acc: 0.838 Test Loss: 0.645 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.760185718536377
Epoch: 15, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.663 Vali Acc: 0.838 Test Loss: 0.663 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.6917736530303955
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.675 Vali Acc: 0.831 Test Loss: 0.675 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.835942268371582
Epoch: 17, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.684 Vali Acc: 0.831 Test Loss: 0.684 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 2228168
model size : 9.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 13.426233768463135
Epoch: 1, Steps: 8 | Train Loss: 2.020 Vali Loss: 1.832 Vali Acc: 0.359 Test Loss: 1.832 Test Acc: 0.359
Validation loss decreased (inf --> -0.359357).  Saving model ...
Epoch: 2 cost time: 11.69925594329834
Epoch: 2, Steps: 8 | Train Loss: 1.616 Vali Loss: 1.277 Vali Acc: 0.787 Test Loss: 1.277 Test Acc: 0.787
Validation loss decreased (-0.359357 --> -0.787487).  Saving model ...
Epoch: 3 cost time: 12.70305347442627
Epoch: 3, Steps: 8 | Train Loss: 1.037 Vali Loss: 0.799 Vali Acc: 0.809 Test Loss: 0.799 Test Acc: 0.809
Validation loss decreased (-0.787487 --> -0.809367).  Saving model ...
Epoch: 4 cost time: 12.752052068710327
Epoch: 4, Steps: 8 | Train Loss: 0.615 Vali Loss: 0.570 Vali Acc: 0.819 Test Loss: 0.570 Test Acc: 0.819
Validation loss decreased (-0.809367 --> -0.818744).  Saving model ...
Epoch: 5 cost time: 13.129259824752808
Epoch: 5, Steps: 8 | Train Loss: 0.371 Vali Loss: 0.494 Vali Acc: 0.838 Test Loss: 0.494 Test Acc: 0.838
Validation loss decreased (-0.818744 --> -0.837495).  Saving model ...
Epoch: 6 cost time: 13.456470489501953
Epoch: 6, Steps: 8 | Train Loss: 0.234 Vali Loss: 0.457 Vali Acc: 0.859 Test Loss: 0.457 Test Acc: 0.859
Validation loss decreased (-0.837495 --> -0.859370).  Saving model ...
Epoch: 7 cost time: 12.529064655303955
Epoch: 7, Steps: 8 | Train Loss: 0.154 Vali Loss: 0.467 Vali Acc: 0.856 Test Loss: 0.467 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 12.669318914413452
Epoch: 8, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.489 Vali Acc: 0.863 Test Loss: 0.489 Test Acc: 0.863
Validation loss decreased (-0.859370 --> -0.862495).  Saving model ...
Epoch: 9 cost time: 12.163233280181885
Epoch: 9, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.485 Vali Acc: 0.856 Test Loss: 0.485 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 11.825185298919678
Epoch: 10, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.508 Vali Acc: 0.856 Test Loss: 0.508 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 11.666755437850952
Epoch: 11, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.542 Vali Acc: 0.853 Test Loss: 0.542 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 10.771724224090576
Epoch: 12, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.556 Vali Acc: 0.847 Test Loss: 0.556 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 11.579224348068237
Epoch: 13, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.544 Vali Acc: 0.850 Test Loss: 0.544 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 12.253207206726074
Epoch: 14, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.586 Vali Acc: 0.850 Test Loss: 0.586 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 11.369831085205078
Epoch: 15, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.585 Vali Acc: 0.847 Test Loss: 0.585 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 12.062381029129028
Epoch: 16, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.573 Vali Acc: 0.853 Test Loss: 0.573 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 10.479494333267212
Epoch: 17, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.574 Vali Acc: 0.850 Test Loss: 0.574 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 10.338135480880737
Epoch: 18, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.583 Vali Acc: 0.856 Test Loss: 0.583 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 7112744
model size : 27.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 9.249492645263672
Epoch: 1, Steps: 8 | Train Loss: 2.047 Vali Loss: 1.853 Vali Acc: 0.403 Test Loss: 1.853 Test Acc: 0.403
Validation loss decreased (inf --> -0.403106).  Saving model ...
Epoch: 2 cost time: 7.367012977600098
Epoch: 2, Steps: 8 | Train Loss: 1.615 Vali Loss: 1.294 Vali Acc: 0.756 Test Loss: 1.294 Test Acc: 0.756
Validation loss decreased (-0.403106 --> -0.756237).  Saving model ...
Epoch: 3 cost time: 8.484290838241577
Epoch: 3, Steps: 8 | Train Loss: 1.037 Vali Loss: 0.822 Vali Acc: 0.834 Test Loss: 0.822 Test Acc: 0.834
Validation loss decreased (-0.756237 --> -0.834367).  Saving model ...
Epoch: 4 cost time: 8.565196752548218
Epoch: 4, Steps: 8 | Train Loss: 0.587 Vali Loss: 0.566 Vali Acc: 0.841 Test Loss: 0.566 Test Acc: 0.841
Validation loss decreased (-0.834367 --> -0.840619).  Saving model ...
Epoch: 5 cost time: 7.975821495056152
Epoch: 5, Steps: 8 | Train Loss: 0.371 Vali Loss: 0.461 Vali Acc: 0.856 Test Loss: 0.461 Test Acc: 0.856
Validation loss decreased (-0.840619 --> -0.856245).  Saving model ...
Epoch: 6 cost time: 7.86523175239563
Epoch: 6, Steps: 8 | Train Loss: 0.237 Vali Loss: 0.430 Vali Acc: 0.863 Test Loss: 0.430 Test Acc: 0.863
Validation loss decreased (-0.856245 --> -0.862496).  Saving model ...
Epoch: 7 cost time: 8.503861665725708
Epoch: 7, Steps: 8 | Train Loss: 0.168 Vali Loss: 0.439 Vali Acc: 0.863 Test Loss: 0.439 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.212279796600342
Epoch: 8, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.441 Vali Acc: 0.866 Test Loss: 0.441 Test Acc: 0.866
Validation loss decreased (-0.862496 --> -0.865621).  Saving model ...
Epoch: 9 cost time: 9.073347806930542
Epoch: 9, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.443 Vali Acc: 0.869 Test Loss: 0.443 Test Acc: 0.869
Validation loss decreased (-0.865621 --> -0.868746).  Saving model ...
Epoch: 10 cost time: 8.702427387237549
Epoch: 10, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.439 Vali Acc: 0.872 Test Loss: 0.439 Test Acc: 0.872
Validation loss decreased (-0.868746 --> -0.871871).  Saving model ...
Epoch: 11 cost time: 8.854649066925049
Epoch: 11, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.450 Vali Acc: 0.878 Test Loss: 0.450 Test Acc: 0.878
Validation loss decreased (-0.871871 --> -0.878121).  Saving model ...
Epoch: 12 cost time: 9.206885576248169
Epoch: 12, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.471 Vali Acc: 0.866 Test Loss: 0.471 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 8.551284551620483
Epoch: 13, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.491 Vali Acc: 0.869 Test Loss: 0.491 Test Acc: 0.869
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 8.480575799942017
Epoch: 14, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.488 Vali Acc: 0.869 Test Loss: 0.488 Test Acc: 0.869
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 9.034116983413696
Epoch: 15, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.493 Vali Acc: 0.863 Test Loss: 0.493 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 9.702390909194946
Epoch: 16, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.510 Vali Acc: 0.863 Test Loss: 0.510 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 8.969293355941772
Epoch: 17, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.524 Vali Acc: 0.866 Test Loss: 0.524 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 9.22521448135376
Epoch: 18, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.513 Vali Acc: 0.863 Test Loss: 0.513 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 9.47550630569458
Epoch: 19, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.523 Vali Acc: 0.863 Test Loss: 0.523 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 9.76969027519226
Epoch: 20, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.530 Vali Acc: 0.863 Test Loss: 0.530 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 9.001534461975098
Epoch: 21, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.538 Vali Acc: 0.863 Test Loss: 0.538 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.878125
model parameter : 2147432
model size : 8.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 11.744572877883911
Epoch: 1, Steps: 8 | Train Loss: 2.021 Vali Loss: 1.839 Vali Acc: 0.344 Test Loss: 1.839 Test Acc: 0.344
Validation loss decreased (inf --> -0.343732).  Saving model ...
Epoch: 2 cost time: 9.431403636932373
Epoch: 2, Steps: 8 | Train Loss: 1.638 Vali Loss: 1.306 Vali Acc: 0.781 Test Loss: 1.306 Test Acc: 0.781
Validation loss decreased (-0.343732 --> -0.781237).  Saving model ...
Epoch: 3 cost time: 8.720816850662231
Epoch: 3, Steps: 8 | Train Loss: 1.074 Vali Loss: 0.837 Vali Acc: 0.806 Test Loss: 0.837 Test Acc: 0.806
Validation loss decreased (-0.781237 --> -0.806242).  Saving model ...
Epoch: 4 cost time: 9.181024074554443
Epoch: 4, Steps: 8 | Train Loss: 0.647 Vali Loss: 0.602 Vali Acc: 0.825 Test Loss: 0.602 Test Acc: 0.825
Validation loss decreased (-0.806242 --> -0.824994).  Saving model ...
Epoch: 5 cost time: 8.680959939956665
Epoch: 5, Steps: 8 | Train Loss: 0.395 Vali Loss: 0.518 Vali Acc: 0.847 Test Loss: 0.518 Test Acc: 0.847
Validation loss decreased (-0.824994 --> -0.846870).  Saving model ...
Epoch: 6 cost time: 9.09394097328186
Epoch: 6, Steps: 8 | Train Loss: 0.251 Vali Loss: 0.478 Vali Acc: 0.863 Test Loss: 0.478 Test Acc: 0.863
Validation loss decreased (-0.846870 --> -0.862495).  Saving model ...
Epoch: 7 cost time: 9.713314771652222
Epoch: 7, Steps: 8 | Train Loss: 0.163 Vali Loss: 0.482 Vali Acc: 0.850 Test Loss: 0.482 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.489551067352295
Epoch: 8, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.507 Vali Acc: 0.847 Test Loss: 0.507 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 9.11430287361145
Epoch: 9, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.496 Vali Acc: 0.850 Test Loss: 0.496 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 9.816100597381592
Epoch: 10, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.516 Vali Acc: 0.850 Test Loss: 0.516 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 9.58172607421875
Epoch: 11, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.550 Vali Acc: 0.847 Test Loss: 0.550 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 8.701417207717896
Epoch: 12, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.562 Vali Acc: 0.844 Test Loss: 0.562 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 9.03611969947815
Epoch: 13, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.551 Vali Acc: 0.841 Test Loss: 0.551 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 8.873703718185425
Epoch: 14, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.593 Vali Acc: 0.844 Test Loss: 0.593 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 8.540895223617554
Epoch: 15, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.593 Vali Acc: 0.844 Test Loss: 0.593 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 8.64220380783081
Epoch: 16, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.579 Vali Acc: 0.847 Test Loss: 0.579 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 7112744
model size : 27.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 8.044666051864624
Epoch: 1, Steps: 8 | Train Loss: 2.045 Vali Loss: 1.853 Vali Acc: 0.400 Test Loss: 1.853 Test Acc: 0.400
Validation loss decreased (inf --> -0.399981).  Saving model ...
Epoch: 2 cost time: 6.689324140548706
Epoch: 2, Steps: 8 | Train Loss: 1.613 Vali Loss: 1.298 Vali Acc: 0.756 Test Loss: 1.298 Test Acc: 0.756
Validation loss decreased (-0.399981 --> -0.756237).  Saving model ...
Epoch: 3 cost time: 7.4798173904418945
Epoch: 3, Steps: 8 | Train Loss: 1.037 Vali Loss: 0.830 Vali Acc: 0.838 Test Loss: 0.830 Test Acc: 0.838
Validation loss decreased (-0.756237 --> -0.837492).  Saving model ...
Epoch: 4 cost time: 7.179143667221069
Epoch: 4, Steps: 8 | Train Loss: 0.589 Vali Loss: 0.574 Vali Acc: 0.838 Test Loss: 0.574 Test Acc: 0.838
Validation loss decreased (-0.837492 --> -0.837494).  Saving model ...
Epoch: 5 cost time: 7.631745338439941
Epoch: 5, Steps: 8 | Train Loss: 0.370 Vali Loss: 0.467 Vali Acc: 0.859 Test Loss: 0.467 Test Acc: 0.859
Validation loss decreased (-0.837494 --> -0.859370).  Saving model ...
Epoch: 6 cost time: 7.6980204582214355
Epoch: 6, Steps: 8 | Train Loss: 0.236 Vali Loss: 0.436 Vali Acc: 0.863 Test Loss: 0.436 Test Acc: 0.863
Validation loss decreased (-0.859370 --> -0.862496).  Saving model ...
Epoch: 7 cost time: 7.072935104370117
Epoch: 7, Steps: 8 | Train Loss: 0.168 Vali Loss: 0.444 Vali Acc: 0.859 Test Loss: 0.444 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.993754625320435
Epoch: 8, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.448 Vali Acc: 0.866 Test Loss: 0.448 Test Acc: 0.866
Validation loss decreased (-0.862496 --> -0.865621).  Saving model ...
Epoch: 9 cost time: 6.992400169372559
Epoch: 9, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.454 Vali Acc: 0.869 Test Loss: 0.454 Test Acc: 0.869
Validation loss decreased (-0.865621 --> -0.868745).  Saving model ...
Epoch: 10 cost time: 7.264190196990967
Epoch: 10, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.449 Vali Acc: 0.875 Test Loss: 0.449 Test Acc: 0.875
Validation loss decreased (-0.868745 --> -0.874996).  Saving model ...
Epoch: 11 cost time: 7.273710012435913
Epoch: 11, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.460 Vali Acc: 0.881 Test Loss: 0.460 Test Acc: 0.881
Validation loss decreased (-0.874996 --> -0.881245).  Saving model ...
Epoch: 12 cost time: 6.971002817153931
Epoch: 12, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.481 Vali Acc: 0.866 Test Loss: 0.481 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.9970173835754395
Epoch: 13, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.502 Vali Acc: 0.866 Test Loss: 0.502 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 7.244592905044556
Epoch: 14, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.500 Vali Acc: 0.869 Test Loss: 0.500 Test Acc: 0.869
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 7.680812120437622
Epoch: 15, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.505 Vali Acc: 0.863 Test Loss: 0.505 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 7.345316648483276
Epoch: 16, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.522 Vali Acc: 0.863 Test Loss: 0.522 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 7.3323822021484375
Epoch: 17, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.537 Vali Acc: 0.863 Test Loss: 0.537 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 7.371788740158081
Epoch: 18, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.526 Vali Acc: 0.863 Test Loss: 0.526 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 7.613418340682983
Epoch: 19, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.533 Vali Acc: 0.859 Test Loss: 0.533 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 7.489087104797363
Epoch: 20, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.539 Vali Acc: 0.859 Test Loss: 0.539 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 7.318627595901489
Epoch: 21, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.546 Vali Acc: 0.859 Test Loss: 0.546 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.88125
model parameter : 2147432
model size : 8.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.398586750030518
Epoch: 1, Steps: 8 | Train Loss: 2.020 Vali Loss: 1.844 Vali Acc: 0.331 Test Loss: 1.844 Test Acc: 0.331
Validation loss decreased (inf --> -0.331232).  Saving model ...
Epoch: 2 cost time: 3.0198450088500977
Epoch: 2, Steps: 8 | Train Loss: 1.652 Vali Loss: 1.328 Vali Acc: 0.769 Test Loss: 1.328 Test Acc: 0.769
Validation loss decreased (-0.331232 --> -0.768737).  Saving model ...
Epoch: 3 cost time: 2.8796231746673584
Epoch: 3, Steps: 8 | Train Loss: 1.113 Vali Loss: 0.865 Vali Acc: 0.797 Test Loss: 0.865 Test Acc: 0.797
Validation loss decreased (-0.768737 --> -0.796866).  Saving model ...
Epoch: 4 cost time: 2.8871521949768066
Epoch: 4, Steps: 8 | Train Loss: 0.691 Vali Loss: 0.624 Vali Acc: 0.816 Test Loss: 0.624 Test Acc: 0.816
Validation loss decreased (-0.796866 --> -0.815619).  Saving model ...
Epoch: 5 cost time: 2.8423287868499756
Epoch: 5, Steps: 8 | Train Loss: 0.440 Vali Loss: 0.535 Vali Acc: 0.841 Test Loss: 0.535 Test Acc: 0.841
Validation loss decreased (-0.815619 --> -0.840620).  Saving model ...
Epoch: 6 cost time: 2.9673731327056885
Epoch: 6, Steps: 8 | Train Loss: 0.291 Vali Loss: 0.496 Vali Acc: 0.850 Test Loss: 0.496 Test Acc: 0.850
Validation loss decreased (-0.840620 --> -0.849995).  Saving model ...
Epoch: 7 cost time: 2.9534263610839844
Epoch: 7, Steps: 8 | Train Loss: 0.207 Vali Loss: 0.497 Vali Acc: 0.844 Test Loss: 0.497 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.802480697631836
Epoch: 8, Steps: 8 | Train Loss: 0.122 Vali Loss: 0.503 Vali Acc: 0.859 Test Loss: 0.503 Test Acc: 0.859
Validation loss decreased (-0.849995 --> -0.859370).  Saving model ...
Epoch: 9 cost time: 3.0338799953460693
Epoch: 9, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.486 Vali Acc: 0.853 Test Loss: 0.486 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.9711692333221436
Epoch: 10, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.501 Vali Acc: 0.866 Test Loss: 0.501 Test Acc: 0.866
Validation loss decreased (-0.859370 --> -0.865620).  Saving model ...
Epoch: 11 cost time: 3.162670612335205
Epoch: 11, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.528 Vali Acc: 0.850 Test Loss: 0.528 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.153704881668091
Epoch: 12, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.540 Vali Acc: 0.850 Test Loss: 0.540 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.0398359298706055
Epoch: 13, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.534 Vali Acc: 0.844 Test Loss: 0.534 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.05070161819458
Epoch: 14, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.570 Vali Acc: 0.847 Test Loss: 0.570 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.0231306552886963
Epoch: 15, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.569 Vali Acc: 0.853 Test Loss: 0.569 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.091777801513672
Epoch: 16, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.557 Vali Acc: 0.847 Test Loss: 0.557 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.179351568222046
Epoch: 17, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.557 Vali Acc: 0.850 Test Loss: 0.557 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.141190767288208
Epoch: 18, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.567 Vali Acc: 0.847 Test Loss: 0.567 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.5973877906799316
Epoch: 19, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.580 Vali Acc: 0.847 Test Loss: 0.580 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.958777904510498
Epoch: 20, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.579 Vali Acc: 0.847 Test Loss: 0.579 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 7112744
model size : 27.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.033790349960327
Epoch: 1, Steps: 8 | Train Loss: 2.042 Vali Loss: 1.853 Vali Acc: 0.388 Test Loss: 1.853 Test Acc: 0.388
Validation loss decreased (inf --> -0.387481).  Saving model ...
Epoch: 2 cost time: 1.7263052463531494
Epoch: 2, Steps: 8 | Train Loss: 1.617 Vali Loss: 1.307 Vali Acc: 0.756 Test Loss: 1.307 Test Acc: 0.756
Validation loss decreased (-0.387481 --> -0.756237).  Saving model ...
Epoch: 3 cost time: 1.6021592617034912
Epoch: 3, Steps: 8 | Train Loss: 1.055 Vali Loss: 0.842 Vali Acc: 0.828 Test Loss: 0.842 Test Acc: 0.828
Validation loss decreased (-0.756237 --> -0.828117).  Saving model ...
Epoch: 4 cost time: 1.5941588878631592
Epoch: 4, Steps: 8 | Train Loss: 0.610 Vali Loss: 0.584 Vali Acc: 0.838 Test Loss: 0.584 Test Acc: 0.838
Validation loss decreased (-0.828117 --> -0.837494).  Saving model ...
Epoch: 5 cost time: 1.6374809741973877
Epoch: 5, Steps: 8 | Train Loss: 0.396 Vali Loss: 0.477 Vali Acc: 0.850 Test Loss: 0.477 Test Acc: 0.850
Validation loss decreased (-0.837494 --> -0.849995).  Saving model ...
Epoch: 6 cost time: 1.627685785293579
Epoch: 6, Steps: 8 | Train Loss: 0.262 Vali Loss: 0.446 Vali Acc: 0.863 Test Loss: 0.446 Test Acc: 0.863
Validation loss decreased (-0.849995 --> -0.862496).  Saving model ...
Epoch: 7 cost time: 1.6393060684204102
Epoch: 7, Steps: 8 | Train Loss: 0.192 Vali Loss: 0.459 Vali Acc: 0.859 Test Loss: 0.459 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6891791820526123
Epoch: 8, Steps: 8 | Train Loss: 0.133 Vali Loss: 0.472 Vali Acc: 0.863 Test Loss: 0.472 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.814037799835205
Epoch: 9, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.470 Vali Acc: 0.856 Test Loss: 0.470 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.630465030670166
Epoch: 10, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.462 Vali Acc: 0.859 Test Loss: 0.462 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.9448127746582031
Epoch: 11, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.474 Vali Acc: 0.863 Test Loss: 0.474 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.927304744720459
Epoch: 12, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.496 Vali Acc: 0.863 Test Loss: 0.496 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.8847191333770752
Epoch: 13, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.519 Vali Acc: 0.863 Test Loss: 0.519 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.9404752254486084
Epoch: 14, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.520 Vali Acc: 0.863 Test Loss: 0.520 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.9091062545776367
Epoch: 15, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.529 Vali Acc: 0.866 Test Loss: 0.529 Test Acc: 0.866
Validation loss decreased (-0.862496 --> -0.865620).  Saving model ...
Epoch: 16 cost time: 1.9171388149261475
Epoch: 16, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.545 Vali Acc: 0.866 Test Loss: 0.545 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.0535366535186768
Epoch: 17, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.558 Vali Acc: 0.863 Test Loss: 0.558 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.9922049045562744
Epoch: 18, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.552 Vali Acc: 0.856 Test Loss: 0.552 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.9217860698699951
Epoch: 19, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.563 Vali Acc: 0.859 Test Loss: 0.563 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.932020664215088
Epoch: 20, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.570 Vali Acc: 0.859 Test Loss: 0.570 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.9288537502288818
Epoch: 21, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.577 Vali Acc: 0.863 Test Loss: 0.577 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.9483222961425781
Epoch: 22, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.598 Vali Acc: 0.866 Test Loss: 0.598 Test Acc: 0.866
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.784233570098877
Epoch: 23, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.602 Vali Acc: 0.866 Test Loss: 0.602 Test Acc: 0.866
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.8493716716766357
Epoch: 24, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.605 Vali Acc: 0.866 Test Loss: 0.605 Test Acc: 0.866
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.943657398223877
Epoch: 25, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.603 Vali Acc: 0.859 Test Loss: 0.603 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 2147432
model size : 8.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 6.863123178482056
Epoch: 1, Steps: 8 | Train Loss: 2.018 Vali Loss: 1.867 Vali Acc: 0.334 Test Loss: 1.867 Test Acc: 0.334
Validation loss decreased (inf --> -0.334356).  Saving model ...
Epoch: 2 cost time: 5.595442056655884
Epoch: 2, Steps: 8 | Train Loss: 1.646 Vali Loss: 1.373 Vali Acc: 0.697 Test Loss: 1.373 Test Acc: 0.697
Validation loss decreased (-0.334356 --> -0.696861).  Saving model ...
Epoch: 3 cost time: 5.7289745807647705
Epoch: 3, Steps: 8 | Train Loss: 1.105 Vali Loss: 0.925 Vali Acc: 0.766 Test Loss: 0.925 Test Acc: 0.766
Validation loss decreased (-0.696861 --> -0.765616).  Saving model ...
Epoch: 4 cost time: 5.616474628448486
Epoch: 4, Steps: 8 | Train Loss: 0.678 Vali Loss: 0.642 Vali Acc: 0.825 Test Loss: 0.642 Test Acc: 0.825
Validation loss decreased (-0.765616 --> -0.824994).  Saving model ...
Epoch: 5 cost time: 5.835933446884155
Epoch: 5, Steps: 8 | Train Loss: 0.425 Vali Loss: 0.534 Vali Acc: 0.831 Test Loss: 0.534 Test Acc: 0.831
Validation loss decreased (-0.824994 --> -0.831245).  Saving model ...
Epoch: 6 cost time: 5.865544080734253
Epoch: 6, Steps: 8 | Train Loss: 0.290 Vali Loss: 0.513 Vali Acc: 0.831 Test Loss: 0.513 Test Acc: 0.831
Validation loss decreased (-0.831245 --> -0.831245).  Saving model ...
Epoch: 7 cost time: 6.09110426902771
Epoch: 7, Steps: 8 | Train Loss: 0.188 Vali Loss: 0.468 Vali Acc: 0.863 Test Loss: 0.468 Test Acc: 0.863
Validation loss decreased (-0.831245 --> -0.862495).  Saving model ...
Epoch: 8 cost time: 5.911358594894409
Epoch: 8, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.474 Vali Acc: 0.866 Test Loss: 0.474 Test Acc: 0.866
Validation loss decreased (-0.862495 --> -0.865620).  Saving model ...
Epoch: 9 cost time: 5.8367462158203125
Epoch: 9, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.473 Vali Acc: 0.869 Test Loss: 0.473 Test Acc: 0.869
Validation loss decreased (-0.865620 --> -0.868745).  Saving model ...
Epoch: 10 cost time: 5.890141487121582
Epoch: 10, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.503 Vali Acc: 0.869 Test Loss: 0.503 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.548755168914795
Epoch: 11, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.488 Vali Acc: 0.863 Test Loss: 0.488 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.924533367156982
Epoch: 12, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.502 Vali Acc: 0.866 Test Loss: 0.502 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.982336044311523
Epoch: 13, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.530 Vali Acc: 0.869 Test Loss: 0.530 Test Acc: 0.869
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.089108228683472
Epoch: 14, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.522 Vali Acc: 0.869 Test Loss: 0.522 Test Acc: 0.869
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.909051418304443
Epoch: 15, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.526 Vali Acc: 0.866 Test Loss: 0.526 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.896679162979126
Epoch: 16, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.541 Vali Acc: 0.872 Test Loss: 0.541 Test Acc: 0.872
Validation loss decreased (-0.868745 --> -0.871870).  Saving model ...
Epoch: 17 cost time: 4.879632472991943
Epoch: 17, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.552 Vali Acc: 0.869 Test Loss: 0.552 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.007128715515137
Epoch: 18, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.552 Vali Acc: 0.866 Test Loss: 0.552 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.3535075187683105
Epoch: 19, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.551 Vali Acc: 0.869 Test Loss: 0.551 Test Acc: 0.869
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.198041915893555
Epoch: 20, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.550 Vali Acc: 0.866 Test Loss: 0.550 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 5.148609161376953
Epoch: 21, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.563 Vali Acc: 0.869 Test Loss: 0.563 Test Acc: 0.869
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 5.219418048858643
Epoch: 22, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.573 Vali Acc: 0.869 Test Loss: 0.573 Test Acc: 0.869
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 4.9911110401153564
Epoch: 23, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.576 Vali Acc: 0.875 Test Loss: 0.576 Test Acc: 0.875
Validation loss decreased (-0.871870 --> -0.874994).  Saving model ...
Epoch: 24 cost time: 5.6015684604644775
Epoch: 24, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.577 Vali Acc: 0.878 Test Loss: 0.577 Test Acc: 0.878
Validation loss decreased (-0.874994 --> -0.878119).  Saving model ...
Epoch: 25 cost time: 5.519607067108154
Epoch: 25, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.576 Vali Acc: 0.878 Test Loss: 0.576 Test Acc: 0.878
Validation loss decreased (-0.878119 --> -0.878119).  Saving model ...
Epoch: 26 cost time: 5.097845077514648
Epoch: 26, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.576 Vali Acc: 0.878 Test Loss: 0.576 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.989261865615845
Epoch: 27, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.579 Vali Acc: 0.875 Test Loss: 0.579 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 5.381744146347046
Epoch: 28, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.579 Vali Acc: 0.875 Test Loss: 0.579 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 5.225842714309692
Epoch: 29, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.587 Vali Acc: 0.875 Test Loss: 0.587 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 4.990500450134277
Epoch: 30, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.601 Vali Acc: 0.878 Test Loss: 0.601 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.878125
model parameter : 3597224
model size : 14.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.6903908252716064
Epoch: 1, Steps: 8 | Train Loss: 2.122 Vali Loss: 1.947 Vali Acc: 0.247 Test Loss: 1.947 Test Acc: 0.247
Validation loss decreased (inf --> -0.246856).  Saving model ...
Epoch: 2 cost time: 3.8862738609313965
Epoch: 2, Steps: 8 | Train Loss: 1.684 Vali Loss: 1.431 Vali Acc: 0.759 Test Loss: 1.431 Test Acc: 0.759
Validation loss decreased (-0.246856 --> -0.759361).  Saving model ...
Epoch: 3 cost time: 3.808502197265625
Epoch: 3, Steps: 8 | Train Loss: 1.161 Vali Loss: 0.942 Vali Acc: 0.812 Test Loss: 0.942 Test Acc: 0.812
Validation loss decreased (-0.759361 --> -0.812491).  Saving model ...
Epoch: 4 cost time: 3.873159170150757
Epoch: 4, Steps: 8 | Train Loss: 0.714 Vali Loss: 0.668 Vali Acc: 0.806 Test Loss: 0.668 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.0587403774261475
Epoch: 5, Steps: 8 | Train Loss: 0.484 Vali Loss: 0.526 Vali Acc: 0.822 Test Loss: 0.526 Test Acc: 0.822
Validation loss decreased (-0.812491 --> -0.821870).  Saving model ...
Epoch: 6 cost time: 4.090929269790649
Epoch: 6, Steps: 8 | Train Loss: 0.308 Vali Loss: 0.482 Vali Acc: 0.863 Test Loss: 0.482 Test Acc: 0.863
Validation loss decreased (-0.821870 --> -0.862495).  Saving model ...
Epoch: 7 cost time: 4.1043782234191895
Epoch: 7, Steps: 8 | Train Loss: 0.185 Vali Loss: 0.474 Vali Acc: 0.853 Test Loss: 0.474 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.9064013957977295
Epoch: 8, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.482 Vali Acc: 0.859 Test Loss: 0.482 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.890949249267578
Epoch: 9, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.497 Vali Acc: 0.863 Test Loss: 0.497 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.9548819065093994
Epoch: 10, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.489 Vali Acc: 0.869 Test Loss: 0.489 Test Acc: 0.869
Validation loss decreased (-0.862495 --> -0.868745).  Saving model ...
Epoch: 11 cost time: 4.0324742794036865
Epoch: 11, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.476 Vali Acc: 0.869 Test Loss: 0.476 Test Acc: 0.869
Validation loss decreased (-0.868745 --> -0.868745).  Saving model ...
Epoch: 12 cost time: 3.901000738143921
Epoch: 12, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.497 Vali Acc: 0.859 Test Loss: 0.497 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.8001019954681396
Epoch: 13, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.538 Vali Acc: 0.853 Test Loss: 0.538 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.73393177986145
Epoch: 14, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.550 Vali Acc: 0.856 Test Loss: 0.550 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.6808362007141113
Epoch: 15, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.556 Vali Acc: 0.863 Test Loss: 0.556 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.8875794410705566
Epoch: 16, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.556 Vali Acc: 0.863 Test Loss: 0.556 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.907162666320801
Epoch: 17, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.553 Vali Acc: 0.863 Test Loss: 0.553 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.9160163402557373
Epoch: 18, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.560 Vali Acc: 0.863 Test Loss: 0.560 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.73417592048645
Epoch: 19, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.558 Vali Acc: 0.856 Test Loss: 0.558 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.7063422203063965
Epoch: 20, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.564 Vali Acc: 0.856 Test Loss: 0.564 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.6315670013427734
Epoch: 21, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.566 Vali Acc: 0.859 Test Loss: 0.566 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 1114472
model size : 4.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 6.022490739822388
Epoch: 1, Steps: 8 | Train Loss: 2.017 Vali Loss: 1.867 Vali Acc: 0.334 Test Loss: 1.867 Test Acc: 0.334
Validation loss decreased (inf --> -0.334356).  Saving model ...
Epoch: 2 cost time: 4.519558906555176
Epoch: 2, Steps: 8 | Train Loss: 1.645 Vali Loss: 1.374 Vali Acc: 0.691 Test Loss: 1.374 Test Acc: 0.691
Validation loss decreased (-0.334356 --> -0.690611).  Saving model ...
Epoch: 3 cost time: 4.479470729827881
Epoch: 3, Steps: 8 | Train Loss: 1.105 Vali Loss: 0.927 Vali Acc: 0.766 Test Loss: 0.927 Test Acc: 0.766
Validation loss decreased (-0.690611 --> -0.765616).  Saving model ...
Epoch: 4 cost time: 2.916497230529785
Epoch: 4, Steps: 8 | Train Loss: 0.677 Vali Loss: 0.646 Vali Acc: 0.825 Test Loss: 0.646 Test Acc: 0.825
Validation loss decreased (-0.765616 --> -0.824994).  Saving model ...
Epoch: 5 cost time: 4.507022380828857
Epoch: 5, Steps: 8 | Train Loss: 0.424 Vali Loss: 0.537 Vali Acc: 0.831 Test Loss: 0.537 Test Acc: 0.831
Validation loss decreased (-0.824994 --> -0.831245).  Saving model ...
Epoch: 6 cost time: 4.401955842971802
Epoch: 6, Steps: 8 | Train Loss: 0.289 Vali Loss: 0.515 Vali Acc: 0.831 Test Loss: 0.515 Test Acc: 0.831
Validation loss decreased (-0.831245 --> -0.831245).  Saving model ...
Epoch: 7 cost time: 4.408963680267334
Epoch: 7, Steps: 8 | Train Loss: 0.187 Vali Loss: 0.470 Vali Acc: 0.859 Test Loss: 0.470 Test Acc: 0.859
Validation loss decreased (-0.831245 --> -0.859370).  Saving model ...
Epoch: 8 cost time: 4.622907400131226
Epoch: 8, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.476 Vali Acc: 0.866 Test Loss: 0.476 Test Acc: 0.866
Validation loss decreased (-0.859370 --> -0.865620).  Saving model ...
Epoch: 9 cost time: 4.664661169052124
Epoch: 9, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.476 Vali Acc: 0.866 Test Loss: 0.476 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.419990062713623
Epoch: 10, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.508 Vali Acc: 0.872 Test Loss: 0.508 Test Acc: 0.872
Validation loss decreased (-0.865620 --> -0.871870).  Saving model ...
Epoch: 11 cost time: 4.431707859039307
Epoch: 11, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.493 Vali Acc: 0.863 Test Loss: 0.493 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.477799415588379
Epoch: 12, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.507 Vali Acc: 0.863 Test Loss: 0.507 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.775642395019531
Epoch: 13, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.534 Vali Acc: 0.869 Test Loss: 0.534 Test Acc: 0.869
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.345082998275757
Epoch: 14, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.525 Vali Acc: 0.869 Test Loss: 0.525 Test Acc: 0.869
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.308813095092773
Epoch: 15, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.529 Vali Acc: 0.866 Test Loss: 0.529 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.592304944992065
Epoch: 16, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.545 Vali Acc: 0.866 Test Loss: 0.545 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.557042121887207
Epoch: 17, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.558 Vali Acc: 0.863 Test Loss: 0.558 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.250001668930054
Epoch: 18, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.558 Vali Acc: 0.869 Test Loss: 0.558 Test Acc: 0.869
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.392713785171509
Epoch: 19, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.557 Vali Acc: 0.869 Test Loss: 0.557 Test Acc: 0.869
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.624511480331421
Epoch: 20, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.556 Vali Acc: 0.866 Test Loss: 0.556 Test Acc: 0.866
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 3597224
model size : 14.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.362537384033203
Epoch: 1, Steps: 8 | Train Loss: 2.118 Vali Loss: 1.948 Vali Acc: 0.244 Test Loss: 1.948 Test Acc: 0.244
Validation loss decreased (inf --> -0.243731).  Saving model ...
Epoch: 2 cost time: 2.939833879470825
Epoch: 2, Steps: 8 | Train Loss: 1.682 Vali Loss: 1.438 Vali Acc: 0.759 Test Loss: 1.438 Test Acc: 0.759
Validation loss decreased (-0.243731 --> -0.759361).  Saving model ...
Epoch: 3 cost time: 2.9920573234558105
Epoch: 3, Steps: 8 | Train Loss: 1.158 Vali Loss: 0.954 Vali Acc: 0.806 Test Loss: 0.954 Test Acc: 0.806
Validation loss decreased (-0.759361 --> -0.806240).  Saving model ...
Epoch: 4 cost time: 2.8732504844665527
Epoch: 4, Steps: 8 | Train Loss: 0.715 Vali Loss: 0.678 Vali Acc: 0.806 Test Loss: 0.678 Test Acc: 0.806
Validation loss decreased (-0.806240 --> -0.806243).  Saving model ...
Epoch: 5 cost time: 2.953932046890259
Epoch: 5, Steps: 8 | Train Loss: 0.485 Vali Loss: 0.534 Vali Acc: 0.822 Test Loss: 0.534 Test Acc: 0.822
Validation loss decreased (-0.806243 --> -0.821870).  Saving model ...
Epoch: 6 cost time: 2.814331531524658
Epoch: 6, Steps: 8 | Train Loss: 0.308 Vali Loss: 0.490 Vali Acc: 0.863 Test Loss: 0.490 Test Acc: 0.863
Validation loss decreased (-0.821870 --> -0.862495).  Saving model ...
Epoch: 7 cost time: 2.6274235248565674
Epoch: 7, Steps: 8 | Train Loss: 0.183 Vali Loss: 0.480 Vali Acc: 0.856 Test Loss: 0.480 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.017577648162842
Epoch: 8, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.487 Vali Acc: 0.856 Test Loss: 0.487 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.9882431030273438
Epoch: 9, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.501 Vali Acc: 0.863 Test Loss: 0.501 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.0236480236053467
Epoch: 10, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.497 Vali Acc: 0.872 Test Loss: 0.497 Test Acc: 0.872
Validation loss decreased (-0.862495 --> -0.871870).  Saving model ...
Epoch: 11 cost time: 3.164910316467285
Epoch: 11, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.484 Vali Acc: 0.869 Test Loss: 0.484 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.1003990173339844
Epoch: 12, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.505 Vali Acc: 0.859 Test Loss: 0.505 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.1028475761413574
Epoch: 13, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.547 Vali Acc: 0.856 Test Loss: 0.547 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.168865203857422
Epoch: 14, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.559 Vali Acc: 0.856 Test Loss: 0.559 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.14640736579895
Epoch: 15, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.565 Vali Acc: 0.856 Test Loss: 0.565 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.1124796867370605
Epoch: 16, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.566 Vali Acc: 0.863 Test Loss: 0.566 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.3770875930786133
Epoch: 17, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.563 Vali Acc: 0.863 Test Loss: 0.563 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.4116456508636475
Epoch: 18, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.570 Vali Acc: 0.859 Test Loss: 0.570 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.299588680267334
Epoch: 19, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.569 Vali Acc: 0.859 Test Loss: 0.569 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.3030576705932617
Epoch: 20, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.575 Vali Acc: 0.856 Test Loss: 0.575 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 1114472
model size : 4.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.103398323059082
Epoch: 1, Steps: 8 | Train Loss: 2.017 Vali Loss: 1.870 Vali Acc: 0.334 Test Loss: 1.870 Test Acc: 0.334
Validation loss decreased (inf --> -0.334356).  Saving model ...
Epoch: 2 cost time: 2.362208366394043
Epoch: 2, Steps: 8 | Train Loss: 1.653 Vali Loss: 1.386 Vali Acc: 0.700 Test Loss: 1.386 Test Acc: 0.700
Validation loss decreased (-0.334356 --> -0.699986).  Saving model ...
Epoch: 3 cost time: 2.4700167179107666
Epoch: 3, Steps: 8 | Train Loss: 1.124 Vali Loss: 0.942 Vali Acc: 0.762 Test Loss: 0.942 Test Acc: 0.762
Validation loss decreased (-0.699986 --> -0.762491).  Saving model ...
Epoch: 4 cost time: 2.372835397720337
Epoch: 4, Steps: 8 | Train Loss: 0.701 Vali Loss: 0.662 Vali Acc: 0.819 Test Loss: 0.662 Test Acc: 0.819
Validation loss decreased (-0.762491 --> -0.818743).  Saving model ...
Epoch: 5 cost time: 2.3207602500915527
Epoch: 5, Steps: 8 | Train Loss: 0.452 Vali Loss: 0.556 Vali Acc: 0.816 Test Loss: 0.556 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.4844894409179688
Epoch: 6, Steps: 8 | Train Loss: 0.325 Vali Loss: 0.542 Vali Acc: 0.819 Test Loss: 0.542 Test Acc: 0.819
Validation loss decreased (-0.818743 --> -0.818745).  Saving model ...
Epoch: 7 cost time: 2.5341877937316895
Epoch: 7, Steps: 8 | Train Loss: 0.228 Vali Loss: 0.500 Vali Acc: 0.856 Test Loss: 0.500 Test Acc: 0.856
Validation loss decreased (-0.818745 --> -0.856245).  Saving model ...
Epoch: 8 cost time: 2.486539363861084
Epoch: 8, Steps: 8 | Train Loss: 0.135 Vali Loss: 0.518 Vali Acc: 0.853 Test Loss: 0.518 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.3404459953308105
Epoch: 9, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.514 Vali Acc: 0.850 Test Loss: 0.514 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.4023728370666504
Epoch: 10, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.534 Vali Acc: 0.856 Test Loss: 0.534 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.3468661308288574
Epoch: 11, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.526 Vali Acc: 0.859 Test Loss: 0.526 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 12 cost time: 2.3566887378692627
Epoch: 12, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.543 Vali Acc: 0.850 Test Loss: 0.543 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.4772768020629883
Epoch: 13, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.573 Vali Acc: 0.853 Test Loss: 0.573 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.4371554851531982
Epoch: 14, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.568 Vali Acc: 0.850 Test Loss: 0.568 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.3738272190093994
Epoch: 15, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.566 Vali Acc: 0.856 Test Loss: 0.566 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.348100185394287
Epoch: 16, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.575 Vali Acc: 0.853 Test Loss: 0.575 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.3557701110839844
Epoch: 17, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.578 Vali Acc: 0.853 Test Loss: 0.578 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.3411169052124023
Epoch: 18, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.579 Vali Acc: 0.850 Test Loss: 0.579 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.5222256183624268
Epoch: 19, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.581 Vali Acc: 0.850 Test Loss: 0.581 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.3967087268829346
Epoch: 20, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.585 Vali Acc: 0.850 Test Loss: 0.585 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.084658145904541
Epoch: 21, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.602 Vali Acc: 0.853 Test Loss: 0.602 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 3597224
model size : 14.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.6798017024993896
Epoch: 1, Steps: 8 | Train Loss: 2.116 Vali Loss: 1.946 Vali Acc: 0.250 Test Loss: 1.946 Test Acc: 0.250
Validation loss decreased (inf --> -0.249981).  Saving model ...
Epoch: 2 cost time: 1.4207062721252441
Epoch: 2, Steps: 8 | Train Loss: 1.686 Vali Loss: 1.449 Vali Acc: 0.738 Test Loss: 1.449 Test Acc: 0.738
Validation loss decreased (-0.249981 --> -0.737486).  Saving model ...
Epoch: 3 cost time: 1.4028968811035156
Epoch: 3, Steps: 8 | Train Loss: 1.174 Vali Loss: 0.971 Vali Acc: 0.800 Test Loss: 0.971 Test Acc: 0.800
Validation loss decreased (-0.737486 --> -0.799990).  Saving model ...
Epoch: 4 cost time: 1.4038238525390625
Epoch: 4, Steps: 8 | Train Loss: 0.732 Vali Loss: 0.693 Vali Acc: 0.803 Test Loss: 0.693 Test Acc: 0.803
Validation loss decreased (-0.799990 --> -0.803118).  Saving model ...
Epoch: 5 cost time: 1.3361194133758545
Epoch: 5, Steps: 8 | Train Loss: 0.502 Vali Loss: 0.550 Vali Acc: 0.816 Test Loss: 0.550 Test Acc: 0.816
Validation loss decreased (-0.803118 --> -0.815619).  Saving model ...
Epoch: 6 cost time: 1.360520362854004
Epoch: 6, Steps: 8 | Train Loss: 0.327 Vali Loss: 0.508 Vali Acc: 0.856 Test Loss: 0.508 Test Acc: 0.856
Validation loss decreased (-0.815619 --> -0.856245).  Saving model ...
Epoch: 7 cost time: 0.961108922958374
Epoch: 7, Steps: 8 | Train Loss: 0.209 Vali Loss: 0.505 Vali Acc: 0.844 Test Loss: 0.505 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2439274787902832
Epoch: 8, Steps: 8 | Train Loss: 0.135 Vali Loss: 0.517 Vali Acc: 0.844 Test Loss: 0.517 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.334169626235962
Epoch: 9, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.537 Vali Acc: 0.841 Test Loss: 0.537 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4343512058258057
Epoch: 10, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.529 Vali Acc: 0.866 Test Loss: 0.529 Test Acc: 0.866
Validation loss decreased (-0.856245 --> -0.865620).  Saving model ...
Epoch: 11 cost time: 1.38875412940979
Epoch: 11, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.516 Vali Acc: 0.859 Test Loss: 0.516 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4153149127960205
Epoch: 12, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.538 Vali Acc: 0.850 Test Loss: 0.538 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3529844284057617
Epoch: 13, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.579 Vali Acc: 0.844 Test Loss: 0.579 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.3692080974578857
Epoch: 14, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.592 Vali Acc: 0.850 Test Loss: 0.592 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.4662868976593018
Epoch: 15, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.600 Vali Acc: 0.847 Test Loss: 0.600 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.4144372940063477
Epoch: 16, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.601 Vali Acc: 0.847 Test Loss: 0.601 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.3661854267120361
Epoch: 17, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.600 Vali Acc: 0.850 Test Loss: 0.600 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.4496257305145264
Epoch: 18, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.611 Vali Acc: 0.847 Test Loss: 0.611 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.0771210193634033
Epoch: 19, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.612 Vali Acc: 0.847 Test Loss: 0.612 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.4394872188568115
Epoch: 20, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.619 Vali Acc: 0.841 Test Loss: 0.619 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 1114472
model size : 4.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.372239828109741
Epoch: 1, Steps: 8 | Train Loss: 2.196 Vali Loss: 1.929 Vali Acc: 0.256 Test Loss: 1.929 Test Acc: 0.256
Validation loss decreased (inf --> -0.256231).  Saving model ...
Epoch: 2 cost time: 3.0685014724731445
Epoch: 2, Steps: 8 | Train Loss: 1.791 Vali Loss: 1.396 Vali Acc: 0.738 Test Loss: 1.396 Test Acc: 0.738
Validation loss decreased (-0.256231 --> -0.737486).  Saving model ...
Epoch: 3 cost time: 3.1501667499542236
Epoch: 3, Steps: 8 | Train Loss: 1.223 Vali Loss: 0.903 Vali Acc: 0.825 Test Loss: 0.903 Test Acc: 0.825
Validation loss decreased (-0.737486 --> -0.824991).  Saving model ...
Epoch: 4 cost time: 3.1414456367492676
Epoch: 4, Steps: 8 | Train Loss: 0.686 Vali Loss: 0.635 Vali Acc: 0.834 Test Loss: 0.635 Test Acc: 0.834
Validation loss decreased (-0.824991 --> -0.834369).  Saving model ...
Epoch: 5 cost time: 3.0553324222564697
Epoch: 5, Steps: 8 | Train Loss: 0.460 Vali Loss: 0.522 Vali Acc: 0.838 Test Loss: 0.522 Test Acc: 0.838
Validation loss decreased (-0.834369 --> -0.837495).  Saving model ...
Epoch: 6 cost time: 3.0489661693573
Epoch: 6, Steps: 8 | Train Loss: 0.320 Vali Loss: 0.482 Vali Acc: 0.844 Test Loss: 0.482 Test Acc: 0.844
Validation loss decreased (-0.837495 --> -0.843745).  Saving model ...
Epoch: 7 cost time: 3.1946890354156494
Epoch: 7, Steps: 8 | Train Loss: 0.202 Vali Loss: 0.462 Vali Acc: 0.866 Test Loss: 0.462 Test Acc: 0.866
Validation loss decreased (-0.843745 --> -0.865620).  Saving model ...
Epoch: 8 cost time: 3.136702060699463
Epoch: 8, Steps: 8 | Train Loss: 0.130 Vali Loss: 0.473 Vali Acc: 0.863 Test Loss: 0.473 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.974644660949707
Epoch: 9, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.465 Vali Acc: 0.872 Test Loss: 0.465 Test Acc: 0.872
Validation loss decreased (-0.865620 --> -0.871870).  Saving model ...
Epoch: 10 cost time: 2.9740748405456543
Epoch: 10, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.480 Vali Acc: 0.872 Test Loss: 0.480 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.0667736530303955
Epoch: 11, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.490 Vali Acc: 0.872 Test Loss: 0.490 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.041285514831543
Epoch: 12, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.512 Vali Acc: 0.869 Test Loss: 0.512 Test Acc: 0.869
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.1390910148620605
Epoch: 13, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.513 Vali Acc: 0.872 Test Loss: 0.513 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.296720027923584
Epoch: 14, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.528 Vali Acc: 0.869 Test Loss: 0.528 Test Acc: 0.869
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.2765324115753174
Epoch: 15, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.539 Vali Acc: 0.869 Test Loss: 0.539 Test Acc: 0.869
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.261613368988037
Epoch: 16, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.551 Vali Acc: 0.863 Test Loss: 0.551 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.476731300354004
Epoch: 17, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.561 Vali Acc: 0.859 Test Loss: 0.561 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.1828062534332275
Epoch: 18, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.572 Vali Acc: 0.863 Test Loss: 0.572 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.1605184078216553
Epoch: 19, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.572 Vali Acc: 0.859 Test Loss: 0.572 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 1839464
model size : 7.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.412764549255371
Epoch: 1, Steps: 8 | Train Loss: 2.148 Vali Loss: 1.954 Vali Acc: 0.206 Test Loss: 1.954 Test Acc: 0.206
Validation loss decreased (inf --> -0.206230).  Saving model ...
Epoch: 2 cost time: 1.952141523361206
Epoch: 2, Steps: 8 | Train Loss: 1.730 Vali Loss: 1.403 Vali Acc: 0.734 Test Loss: 1.403 Test Acc: 0.734
Validation loss decreased (-0.206230 --> -0.734361).  Saving model ...
Epoch: 3 cost time: 2.070416212081909
Epoch: 3, Steps: 8 | Train Loss: 1.125 Vali Loss: 0.917 Vali Acc: 0.816 Test Loss: 0.917 Test Acc: 0.816
Validation loss decreased (-0.734361 --> -0.815616).  Saving model ...
Epoch: 4 cost time: 1.9508509635925293
Epoch: 4, Steps: 8 | Train Loss: 0.710 Vali Loss: 0.654 Vali Acc: 0.809 Test Loss: 0.654 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9484515190124512
Epoch: 5, Steps: 8 | Train Loss: 0.476 Vali Loss: 0.533 Vali Acc: 0.825 Test Loss: 0.533 Test Acc: 0.825
Validation loss decreased (-0.815616 --> -0.824995).  Saving model ...
Epoch: 6 cost time: 1.9083161354064941
Epoch: 6, Steps: 8 | Train Loss: 0.306 Vali Loss: 0.464 Vali Acc: 0.863 Test Loss: 0.464 Test Acc: 0.863
Validation loss decreased (-0.824995 --> -0.862495).  Saving model ...
Epoch: 7 cost time: 1.8970561027526855
Epoch: 7, Steps: 8 | Train Loss: 0.218 Vali Loss: 0.451 Vali Acc: 0.859 Test Loss: 0.451 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0370001792907715
Epoch: 8, Steps: 8 | Train Loss: 0.145 Vali Loss: 0.455 Vali Acc: 0.866 Test Loss: 0.455 Test Acc: 0.866
Validation loss decreased (-0.862495 --> -0.865620).  Saving model ...
Epoch: 9 cost time: 2.038468360900879
Epoch: 9, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.456 Vali Acc: 0.856 Test Loss: 0.456 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9616072177886963
Epoch: 10, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.482 Vali Acc: 0.863 Test Loss: 0.482 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9658923149108887
Epoch: 11, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.473 Vali Acc: 0.863 Test Loss: 0.473 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.9068059921264648
Epoch: 12, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.476 Vali Acc: 0.863 Test Loss: 0.476 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.915520429611206
Epoch: 13, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.491 Vali Acc: 0.856 Test Loss: 0.491 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.930556297302246
Epoch: 14, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.504 Vali Acc: 0.853 Test Loss: 0.504 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.027507781982422
Epoch: 15, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.500 Vali Acc: 0.856 Test Loss: 0.500 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.0143768787384033
Epoch: 16, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.503 Vali Acc: 0.866 Test Loss: 0.503 Test Acc: 0.866
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.0744376182556152
Epoch: 17, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.514 Vali Acc: 0.856 Test Loss: 0.514 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.9524104595184326
Epoch: 18, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.522 Vali Acc: 0.859 Test Loss: 0.522 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 597992
model size : 2.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.348508596420288
Epoch: 1, Steps: 8 | Train Loss: 2.194 Vali Loss: 1.930 Vali Acc: 0.259 Test Loss: 1.930 Test Acc: 0.259
Validation loss decreased (inf --> -0.259356).  Saving model ...
Epoch: 2 cost time: 2.842430591583252
Epoch: 2, Steps: 8 | Train Loss: 1.792 Vali Loss: 1.404 Vali Acc: 0.734 Test Loss: 1.404 Test Acc: 0.734
Validation loss decreased (-0.259356 --> -0.734361).  Saving model ...
Epoch: 3 cost time: 2.894533634185791
Epoch: 3, Steps: 8 | Train Loss: 1.227 Vali Loss: 0.917 Vali Acc: 0.822 Test Loss: 0.917 Test Acc: 0.822
Validation loss decreased (-0.734361 --> -0.821866).  Saving model ...
Epoch: 4 cost time: 2.8052523136138916
Epoch: 4, Steps: 8 | Train Loss: 0.690 Vali Loss: 0.648 Vali Acc: 0.831 Test Loss: 0.648 Test Acc: 0.831
Validation loss decreased (-0.821866 --> -0.831244).  Saving model ...
Epoch: 5 cost time: 2.535240888595581
Epoch: 5, Steps: 8 | Train Loss: 0.461 Vali Loss: 0.533 Vali Acc: 0.838 Test Loss: 0.533 Test Acc: 0.838
Validation loss decreased (-0.831244 --> -0.837495).  Saving model ...
Epoch: 6 cost time: 2.6293814182281494
Epoch: 6, Steps: 8 | Train Loss: 0.320 Vali Loss: 0.490 Vali Acc: 0.844 Test Loss: 0.490 Test Acc: 0.844
Validation loss decreased (-0.837495 --> -0.843745).  Saving model ...
Epoch: 7 cost time: 2.5856308937072754
Epoch: 7, Steps: 8 | Train Loss: 0.201 Vali Loss: 0.471 Vali Acc: 0.863 Test Loss: 0.471 Test Acc: 0.863
Validation loss decreased (-0.843745 --> -0.862495).  Saving model ...
Epoch: 8 cost time: 2.4451522827148438
Epoch: 8, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.484 Vali Acc: 0.859 Test Loss: 0.484 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.6510066986083984
Epoch: 9, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.477 Vali Acc: 0.856 Test Loss: 0.477 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.6454861164093018
Epoch: 10, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.492 Vali Acc: 0.863 Test Loss: 0.492 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.5609331130981445
Epoch: 11, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.500 Vali Acc: 0.866 Test Loss: 0.500 Test Acc: 0.866
Validation loss decreased (-0.862495 --> -0.865620).  Saving model ...
Epoch: 12 cost time: 2.5331807136535645
Epoch: 12, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.523 Vali Acc: 0.863 Test Loss: 0.523 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.4943525791168213
Epoch: 13, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.524 Vali Acc: 0.869 Test Loss: 0.524 Test Acc: 0.869
Validation loss decreased (-0.865620 --> -0.868745).  Saving model ...
Epoch: 14 cost time: 2.6605875492095947
Epoch: 14, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.539 Vali Acc: 0.863 Test Loss: 0.539 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.6718220710754395
Epoch: 15, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.550 Vali Acc: 0.863 Test Loss: 0.550 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.457467555999756
Epoch: 16, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.563 Vali Acc: 0.859 Test Loss: 0.563 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.5948033332824707
Epoch: 17, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.573 Vali Acc: 0.856 Test Loss: 0.573 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.590395927429199
Epoch: 18, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.584 Vali Acc: 0.859 Test Loss: 0.584 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.675041675567627
Epoch: 19, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.584 Vali Acc: 0.856 Test Loss: 0.584 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.349210262298584
Epoch: 20, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.592 Vali Acc: 0.850 Test Loss: 0.592 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.544177770614624
Epoch: 21, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.609 Vali Acc: 0.859 Test Loss: 0.609 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.4259939193725586
Epoch: 22, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.621 Vali Acc: 0.859 Test Loss: 0.621 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.5084006786346436
Epoch: 23, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.615 Vali Acc: 0.856 Test Loss: 0.615 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 1839464
model size : 7.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.8008127212524414
Epoch: 1, Steps: 8 | Train Loss: 2.151 Vali Loss: 1.956 Vali Acc: 0.206 Test Loss: 1.956 Test Acc: 0.206
Validation loss decreased (inf --> -0.206230).  Saving model ...
Epoch: 2 cost time: 1.4769699573516846
Epoch: 2, Steps: 8 | Train Loss: 1.732 Vali Loss: 1.410 Vali Acc: 0.719 Test Loss: 1.410 Test Acc: 0.719
Validation loss decreased (-0.206230 --> -0.718736).  Saving model ...
Epoch: 3 cost time: 1.4920508861541748
Epoch: 3, Steps: 8 | Train Loss: 1.134 Vali Loss: 0.929 Vali Acc: 0.816 Test Loss: 0.929 Test Acc: 0.816
Validation loss decreased (-0.718736 --> -0.815616).  Saving model ...
Epoch: 4 cost time: 1.4981372356414795
Epoch: 4, Steps: 8 | Train Loss: 0.715 Vali Loss: 0.664 Vali Acc: 0.803 Test Loss: 0.664 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4695522785186768
Epoch: 5, Steps: 8 | Train Loss: 0.480 Vali Loss: 0.543 Vali Acc: 0.828 Test Loss: 0.543 Test Acc: 0.828
Validation loss decreased (-0.815616 --> -0.828120).  Saving model ...
Epoch: 6 cost time: 1.4913556575775146
Epoch: 6, Steps: 8 | Train Loss: 0.311 Vali Loss: 0.471 Vali Acc: 0.863 Test Loss: 0.471 Test Acc: 0.863
Validation loss decreased (-0.828120 --> -0.862495).  Saving model ...
Epoch: 7 cost time: 1.5227153301239014
Epoch: 7, Steps: 8 | Train Loss: 0.220 Vali Loss: 0.458 Vali Acc: 0.859 Test Loss: 0.458 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4786534309387207
Epoch: 8, Steps: 8 | Train Loss: 0.146 Vali Loss: 0.461 Vali Acc: 0.853 Test Loss: 0.461 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.522273302078247
Epoch: 9, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.461 Vali Acc: 0.853 Test Loss: 0.461 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4683589935302734
Epoch: 10, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.487 Vali Acc: 0.859 Test Loss: 0.487 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.5722556114196777
Epoch: 11, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.477 Vali Acc: 0.866 Test Loss: 0.477 Test Acc: 0.866
Validation loss decreased (-0.862495 --> -0.865620).  Saving model ...
Epoch: 12 cost time: 1.4364898204803467
Epoch: 12, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.482 Vali Acc: 0.863 Test Loss: 0.482 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5876734256744385
Epoch: 13, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.499 Vali Acc: 0.853 Test Loss: 0.499 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.553929328918457
Epoch: 14, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.512 Vali Acc: 0.856 Test Loss: 0.512 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.4655919075012207
Epoch: 15, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.507 Vali Acc: 0.859 Test Loss: 0.507 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.6932032108306885
Epoch: 16, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.511 Vali Acc: 0.856 Test Loss: 0.511 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.7020928859710693
Epoch: 17, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.523 Vali Acc: 0.856 Test Loss: 0.523 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.7025344371795654
Epoch: 18, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.531 Vali Acc: 0.853 Test Loss: 0.531 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.7175462245941162
Epoch: 19, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.536 Vali Acc: 0.856 Test Loss: 0.536 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.8521833419799805
Epoch: 20, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.539 Vali Acc: 0.853 Test Loss: 0.539 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.734786033630371
Epoch: 21, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.549 Vali Acc: 0.856 Test Loss: 0.549 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 597992
model size : 2.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.1130459308624268
Epoch: 1, Steps: 8 | Train Loss: 2.194 Vali Loss: 1.933 Vali Acc: 0.250 Test Loss: 1.933 Test Acc: 0.250
Validation loss decreased (inf --> -0.249981).  Saving model ...
Epoch: 2 cost time: 1.8349778652191162
Epoch: 2, Steps: 8 | Train Loss: 1.797 Vali Loss: 1.411 Vali Acc: 0.738 Test Loss: 1.411 Test Acc: 0.738
Validation loss decreased (-0.249981 --> -0.737486).  Saving model ...
Epoch: 3 cost time: 1.8663291931152344
Epoch: 3, Steps: 8 | Train Loss: 1.236 Vali Loss: 0.925 Vali Acc: 0.825 Test Loss: 0.925 Test Acc: 0.825
Validation loss decreased (-0.737486 --> -0.824991).  Saving model ...
Epoch: 4 cost time: 1.9967031478881836
Epoch: 4, Steps: 8 | Train Loss: 0.704 Vali Loss: 0.656 Vali Acc: 0.825 Test Loss: 0.656 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824993).  Saving model ...
Epoch: 5 cost time: 2.0137572288513184
Epoch: 5, Steps: 8 | Train Loss: 0.479 Vali Loss: 0.540 Vali Acc: 0.828 Test Loss: 0.540 Test Acc: 0.828
Validation loss decreased (-0.824993 --> -0.828120).  Saving model ...
Epoch: 6 cost time: 1.8877487182617188
Epoch: 6, Steps: 8 | Train Loss: 0.341 Vali Loss: 0.499 Vali Acc: 0.838 Test Loss: 0.499 Test Acc: 0.838
Validation loss decreased (-0.828120 --> -0.837495).  Saving model ...
Epoch: 7 cost time: 1.8904123306274414
Epoch: 7, Steps: 8 | Train Loss: 0.221 Vali Loss: 0.481 Vali Acc: 0.866 Test Loss: 0.481 Test Acc: 0.866
Validation loss decreased (-0.837495 --> -0.865620).  Saving model ...
Epoch: 8 cost time: 1.9143054485321045
Epoch: 8, Steps: 8 | Train Loss: 0.157 Vali Loss: 0.494 Vali Acc: 0.856 Test Loss: 0.494 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9226336479187012
Epoch: 9, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.490 Vali Acc: 0.859 Test Loss: 0.490 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.9849402904510498
Epoch: 10, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.503 Vali Acc: 0.863 Test Loss: 0.503 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.9634323120117188
Epoch: 11, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.506 Vali Acc: 0.863 Test Loss: 0.506 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.9713730812072754
Epoch: 12, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.527 Vali Acc: 0.859 Test Loss: 0.527 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.8806183338165283
Epoch: 13, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.533 Vali Acc: 0.863 Test Loss: 0.533 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.873042345046997
Epoch: 14, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.550 Vali Acc: 0.853 Test Loss: 0.550 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.917654037475586
Epoch: 15, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.564 Vali Acc: 0.847 Test Loss: 0.564 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.8587737083435059
Epoch: 16, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.579 Vali Acc: 0.847 Test Loss: 0.579 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.014892816543579
Epoch: 17, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.588 Vali Acc: 0.853 Test Loss: 0.588 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 1839464
model size : 7.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.5792341232299805
Epoch: 1, Steps: 8 | Train Loss: 2.149 Vali Loss: 1.953 Vali Acc: 0.216 Test Loss: 1.953 Test Acc: 0.216
Validation loss decreased (inf --> -0.215605).  Saving model ...
Epoch: 2 cost time: 1.2418081760406494
Epoch: 2, Steps: 8 | Train Loss: 1.735 Vali Loss: 1.417 Vali Acc: 0.725 Test Loss: 1.417 Test Acc: 0.725
Validation loss decreased (-0.215605 --> -0.724986).  Saving model ...
Epoch: 3 cost time: 1.202394723892212
Epoch: 3, Steps: 8 | Train Loss: 1.143 Vali Loss: 0.941 Vali Acc: 0.803 Test Loss: 0.941 Test Acc: 0.803
Validation loss decreased (-0.724986 --> -0.803116).  Saving model ...
Epoch: 4 cost time: 1.2318365573883057
Epoch: 4, Steps: 8 | Train Loss: 0.731 Vali Loss: 0.679 Vali Acc: 0.803 Test Loss: 0.679 Test Acc: 0.803
Validation loss decreased (-0.803116 --> -0.803118).  Saving model ...
Epoch: 5 cost time: 1.2351913452148438
Epoch: 5, Steps: 8 | Train Loss: 0.496 Vali Loss: 0.559 Vali Acc: 0.825 Test Loss: 0.559 Test Acc: 0.825
Validation loss decreased (-0.803118 --> -0.824994).  Saving model ...
Epoch: 6 cost time: 1.2970514297485352
Epoch: 6, Steps: 8 | Train Loss: 0.328 Vali Loss: 0.490 Vali Acc: 0.859 Test Loss: 0.490 Test Acc: 0.859
Validation loss decreased (-0.824994 --> -0.859370).  Saving model ...
Epoch: 7 cost time: 1.2584352493286133
Epoch: 7, Steps: 8 | Train Loss: 0.241 Vali Loss: 0.479 Vali Acc: 0.856 Test Loss: 0.479 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2729761600494385
Epoch: 8, Steps: 8 | Train Loss: 0.169 Vali Loss: 0.488 Vali Acc: 0.847 Test Loss: 0.488 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2602448463439941
Epoch: 9, Steps: 8 | Train Loss: 0.110 Vali Loss: 0.490 Vali Acc: 0.841 Test Loss: 0.490 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2868547439575195
Epoch: 10, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.513 Vali Acc: 0.853 Test Loss: 0.513 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2603275775909424
Epoch: 11, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.504 Vali Acc: 0.844 Test Loss: 0.504 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.2379615306854248
Epoch: 12, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.512 Vali Acc: 0.844 Test Loss: 0.512 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.1311681270599365
Epoch: 13, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.530 Vali Acc: 0.844 Test Loss: 0.530 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.105776071548462
Epoch: 14, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.542 Vali Acc: 0.844 Test Loss: 0.542 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.1302118301391602
Epoch: 15, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.539 Vali Acc: 0.841 Test Loss: 0.539 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.251796007156372
Epoch: 16, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.545 Vali Acc: 0.847 Test Loss: 0.545 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 597992
model size : 2.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.734769344329834
Epoch: 1, Steps: 8 | Train Loss: 2.103 Vali Loss: 2.009 Vali Acc: 0.153 Test Loss: 2.009 Test Acc: 0.153
Validation loss decreased (inf --> -0.153105).  Saving model ...
Epoch: 2 cost time: 4.186544418334961
Epoch: 2, Steps: 8 | Train Loss: 1.852 Vali Loss: 1.697 Vali Acc: 0.553 Test Loss: 1.697 Test Acc: 0.553
Validation loss decreased (-0.153105 --> -0.553108).  Saving model ...
Epoch: 3 cost time: 4.332434415817261
Epoch: 3, Steps: 8 | Train Loss: 1.483 Vali Loss: 1.317 Vali Acc: 0.769 Test Loss: 1.317 Test Acc: 0.769
Validation loss decreased (-0.553108 --> -0.768737).  Saving model ...
Epoch: 4 cost time: 4.137768507003784
Epoch: 4, Steps: 8 | Train Loss: 1.090 Vali Loss: 0.983 Vali Acc: 0.787 Test Loss: 0.983 Test Acc: 0.787
Validation loss decreased (-0.768737 --> -0.787490).  Saving model ...
Epoch: 5 cost time: 4.209677457809448
Epoch: 5, Steps: 8 | Train Loss: 0.782 Vali Loss: 0.752 Vali Acc: 0.809 Test Loss: 0.752 Test Acc: 0.809
Validation loss decreased (-0.787490 --> -0.809367).  Saving model ...
Epoch: 6 cost time: 4.340368747711182
Epoch: 6, Steps: 8 | Train Loss: 0.566 Vali Loss: 0.610 Vali Acc: 0.831 Test Loss: 0.610 Test Acc: 0.831
Validation loss decreased (-0.809367 --> -0.831244).  Saving model ...
Epoch: 7 cost time: 4.517776250839233
Epoch: 7, Steps: 8 | Train Loss: 0.373 Vali Loss: 0.531 Vali Acc: 0.844 Test Loss: 0.531 Test Acc: 0.844
Validation loss decreased (-0.831244 --> -0.843745).  Saving model ...
Epoch: 8 cost time: 4.316131114959717
Epoch: 8, Steps: 8 | Train Loss: 0.301 Vali Loss: 0.489 Vali Acc: 0.850 Test Loss: 0.489 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849995).  Saving model ...
Epoch: 9 cost time: 4.326179504394531
Epoch: 9, Steps: 8 | Train Loss: 0.212 Vali Loss: 0.474 Vali Acc: 0.853 Test Loss: 0.474 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 10 cost time: 4.5191490650177
Epoch: 10, Steps: 8 | Train Loss: 0.154 Vali Loss: 0.462 Vali Acc: 0.863 Test Loss: 0.462 Test Acc: 0.863
Validation loss decreased (-0.853120 --> -0.862495).  Saving model ...
Epoch: 11 cost time: 4.562077522277832
Epoch: 11, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.464 Vali Acc: 0.866 Test Loss: 0.464 Test Acc: 0.866
Validation loss decreased (-0.862495 --> -0.865620).  Saving model ...
Epoch: 12 cost time: 4.379619598388672
Epoch: 12, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.467 Vali Acc: 0.869 Test Loss: 0.467 Test Acc: 0.869
Validation loss decreased (-0.865620 --> -0.868745).  Saving model ...
Epoch: 13 cost time: 4.3985044956207275
Epoch: 13, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.466 Vali Acc: 0.859 Test Loss: 0.466 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.521101236343384
Epoch: 14, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.464 Vali Acc: 0.859 Test Loss: 0.464 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.533434867858887
Epoch: 15, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.477 Vali Acc: 0.853 Test Loss: 0.477 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.312981843948364
Epoch: 16, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.493 Vali Acc: 0.856 Test Loss: 0.493 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.303050756454468
Epoch: 17, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.489 Vali Acc: 0.853 Test Loss: 0.489 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.545356273651123
Epoch: 18, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.498 Vali Acc: 0.856 Test Loss: 0.498 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.42014479637146
Epoch: 19, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.510 Vali Acc: 0.853 Test Loss: 0.510 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.3423051834106445
Epoch: 20, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.521 Vali Acc: 0.847 Test Loss: 0.521 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.295853137969971
Epoch: 21, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.516 Vali Acc: 0.850 Test Loss: 0.516 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.6507837772369385
Epoch: 22, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.525 Vali Acc: 0.853 Test Loss: 0.525 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 1799192
model size : 7.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.641526222229004
Epoch: 1, Steps: 8 | Train Loss: 2.204 Vali Loss: 2.071 Vali Acc: 0.156 Test Loss: 2.071 Test Acc: 0.156
Validation loss decreased (inf --> -0.156229).  Saving model ...
Epoch: 2 cost time: 3.078662633895874
Epoch: 2, Steps: 8 | Train Loss: 1.905 Vali Loss: 1.732 Vali Acc: 0.478 Test Loss: 1.732 Test Acc: 0.478
Validation loss decreased (-0.156229 --> -0.478108).  Saving model ...
Epoch: 3 cost time: 3.1744272708892822
Epoch: 3, Steps: 8 | Train Loss: 1.517 Vali Loss: 1.350 Vali Acc: 0.731 Test Loss: 1.350 Test Acc: 0.731
Validation loss decreased (-0.478108 --> -0.731236).  Saving model ...
Epoch: 4 cost time: 3.1583337783813477
Epoch: 4, Steps: 8 | Train Loss: 1.155 Vali Loss: 1.035 Vali Acc: 0.769 Test Loss: 1.035 Test Acc: 0.769
Validation loss decreased (-0.731236 --> -0.768740).  Saving model ...
Epoch: 5 cost time: 3.0852510929107666
Epoch: 5, Steps: 8 | Train Loss: 0.855 Vali Loss: 0.813 Vali Acc: 0.797 Test Loss: 0.813 Test Acc: 0.797
Validation loss decreased (-0.768740 --> -0.796867).  Saving model ...
Epoch: 6 cost time: 3.066230297088623
Epoch: 6, Steps: 8 | Train Loss: 0.620 Vali Loss: 0.682 Vali Acc: 0.800 Test Loss: 0.682 Test Acc: 0.800
Validation loss decreased (-0.796867 --> -0.799993).  Saving model ...
Epoch: 7 cost time: 3.0146231651306152
Epoch: 7, Steps: 8 | Train Loss: 0.496 Vali Loss: 0.616 Vali Acc: 0.822 Test Loss: 0.616 Test Acc: 0.822
Validation loss decreased (-0.799993 --> -0.821869).  Saving model ...
Epoch: 8 cost time: 3.109762191772461
Epoch: 8, Steps: 8 | Train Loss: 0.355 Vali Loss: 0.580 Vali Acc: 0.825 Test Loss: 0.580 Test Acc: 0.825
Validation loss decreased (-0.821869 --> -0.824994).  Saving model ...
Epoch: 9 cost time: 3.2099568843841553
Epoch: 9, Steps: 8 | Train Loss: 0.283 Vali Loss: 0.551 Vali Acc: 0.831 Test Loss: 0.551 Test Acc: 0.831
Validation loss decreased (-0.824994 --> -0.831244).  Saving model ...
Epoch: 10 cost time: 3.206341505050659
Epoch: 10, Steps: 8 | Train Loss: 0.222 Vali Loss: 0.540 Vali Acc: 0.834 Test Loss: 0.540 Test Acc: 0.834
Validation loss decreased (-0.831244 --> -0.834370).  Saving model ...
Epoch: 11 cost time: 3.046923875808716
Epoch: 11, Steps: 8 | Train Loss: 0.165 Vali Loss: 0.538 Vali Acc: 0.844 Test Loss: 0.538 Test Acc: 0.844
Validation loss decreased (-0.834370 --> -0.843745).  Saving model ...
Epoch: 12 cost time: 3.018933057785034
Epoch: 12, Steps: 8 | Train Loss: 0.135 Vali Loss: 0.540 Vali Acc: 0.838 Test Loss: 0.540 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.051222085952759
Epoch: 13, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.543 Vali Acc: 0.838 Test Loss: 0.543 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.2610108852386475
Epoch: 14, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.533 Vali Acc: 0.841 Test Loss: 0.533 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.117661237716675
Epoch: 15, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.533 Vali Acc: 0.841 Test Loss: 0.533 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.0704703330993652
Epoch: 16, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.542 Vali Acc: 0.831 Test Loss: 0.542 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.0915279388427734
Epoch: 17, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.537 Vali Acc: 0.841 Test Loss: 0.537 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.041771173477173
Epoch: 18, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.537 Vali Acc: 0.847 Test Loss: 0.537 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 19 cost time: 2.4197986125946045
Epoch: 19, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.532 Vali Acc: 0.850 Test Loss: 0.532 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 20 cost time: 3.177260637283325
Epoch: 20, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.523 Vali Acc: 0.853 Test Loss: 0.523 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 21 cost time: 3.0636160373687744
Epoch: 21, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.531 Vali Acc: 0.850 Test Loss: 0.531 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.1216015815734863
Epoch: 22, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.547 Vali Acc: 0.847 Test Loss: 0.547 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.242344856262207
Epoch: 23, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.550 Vali Acc: 0.844 Test Loss: 0.550 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.1829237937927246
Epoch: 24, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.546 Vali Acc: 0.850 Test Loss: 0.546 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.139927625656128
Epoch: 25, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.552 Vali Acc: 0.847 Test Loss: 0.552 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.079988479614258
Epoch: 26, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.563 Vali Acc: 0.856 Test Loss: 0.563 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856244).  Saving model ...
Epoch: 27 cost time: 3.158351421356201
Epoch: 27, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.558 Vali Acc: 0.856 Test Loss: 0.558 Test Acc: 0.856
Validation loss decreased (-0.856244 --> -0.856244).  Saving model ...
Epoch: 28 cost time: 3.1446259021759033
Epoch: 28, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.560 Vali Acc: 0.853 Test Loss: 0.560 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.9604427814483643
Epoch: 29, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.563 Vali Acc: 0.853 Test Loss: 0.563 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.915555000305176
Epoch: 30, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.567 Vali Acc: 0.853 Test Loss: 0.567 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 557624
model size : 2.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.983166217803955
Epoch: 1, Steps: 8 | Train Loss: 2.107 Vali Loss: 2.011 Vali Acc: 0.150 Test Loss: 2.011 Test Acc: 0.150
Validation loss decreased (inf --> -0.149980).  Saving model ...
Epoch: 2 cost time: 3.5934479236602783
Epoch: 2, Steps: 8 | Train Loss: 1.858 Vali Loss: 1.712 Vali Acc: 0.537 Test Loss: 1.712 Test Acc: 0.537
Validation loss decreased (-0.149980 --> -0.537483).  Saving model ...
Epoch: 3 cost time: 3.3863308429718018
Epoch: 3, Steps: 8 | Train Loss: 1.499 Vali Loss: 1.346 Vali Acc: 0.769 Test Loss: 1.346 Test Acc: 0.769
Validation loss decreased (-0.537483 --> -0.768737).  Saving model ...
Epoch: 4 cost time: 3.4752883911132812
Epoch: 4, Steps: 8 | Train Loss: 1.119 Vali Loss: 1.024 Vali Acc: 0.784 Test Loss: 1.024 Test Acc: 0.784
Validation loss decreased (-0.768737 --> -0.784365).  Saving model ...
Epoch: 5 cost time: 3.5334153175354004
Epoch: 5, Steps: 8 | Train Loss: 0.811 Vali Loss: 0.793 Vali Acc: 0.809 Test Loss: 0.793 Test Acc: 0.809
Validation loss decreased (-0.784365 --> -0.809367).  Saving model ...
Epoch: 6 cost time: 3.6191465854644775
Epoch: 6, Steps: 8 | Train Loss: 0.590 Vali Loss: 0.644 Vali Acc: 0.838 Test Loss: 0.644 Test Acc: 0.838
Validation loss decreased (-0.809367 --> -0.837494).  Saving model ...
Epoch: 7 cost time: 3.707317590713501
Epoch: 7, Steps: 8 | Train Loss: 0.393 Vali Loss: 0.558 Vali Acc: 0.844 Test Loss: 0.558 Test Acc: 0.844
Validation loss decreased (-0.837494 --> -0.843744).  Saving model ...
Epoch: 8 cost time: 3.6399402618408203
Epoch: 8, Steps: 8 | Train Loss: 0.317 Vali Loss: 0.512 Vali Acc: 0.847 Test Loss: 0.512 Test Acc: 0.847
Validation loss decreased (-0.843744 --> -0.846870).  Saving model ...
Epoch: 9 cost time: 3.4646623134613037
Epoch: 9, Steps: 8 | Train Loss: 0.220 Vali Loss: 0.494 Vali Acc: 0.853 Test Loss: 0.494 Test Acc: 0.853
Validation loss decreased (-0.846870 --> -0.853120).  Saving model ...
Epoch: 10 cost time: 3.188511848449707
Epoch: 10, Steps: 8 | Train Loss: 0.161 Vali Loss: 0.479 Vali Acc: 0.866 Test Loss: 0.479 Test Acc: 0.866
Validation loss decreased (-0.853120 --> -0.865620).  Saving model ...
Epoch: 11 cost time: 3.4543659687042236
Epoch: 11, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.479 Vali Acc: 0.866 Test Loss: 0.479 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.4997758865356445
Epoch: 12, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.484 Vali Acc: 0.859 Test Loss: 0.484 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.513943672180176
Epoch: 13, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.484 Vali Acc: 0.866 Test Loss: 0.484 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.3925135135650635
Epoch: 14, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.481 Vali Acc: 0.872 Test Loss: 0.481 Test Acc: 0.872
Validation loss decreased (-0.865620 --> -0.871870).  Saving model ...
Epoch: 15 cost time: 3.4244754314422607
Epoch: 15, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.493 Vali Acc: 0.863 Test Loss: 0.493 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.5312275886535645
Epoch: 16, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.507 Vali Acc: 0.859 Test Loss: 0.507 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.498992919921875
Epoch: 17, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.506 Vali Acc: 0.856 Test Loss: 0.506 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.389967441558838
Epoch: 18, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.515 Vali Acc: 0.853 Test Loss: 0.515 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.3890974521636963
Epoch: 19, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.523 Vali Acc: 0.859 Test Loss: 0.523 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.317812919616699
Epoch: 20, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.538 Vali Acc: 0.863 Test Loss: 0.538 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.5315566062927246
Epoch: 21, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.534 Vali Acc: 0.859 Test Loss: 0.534 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.4717190265655518
Epoch: 22, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.544 Vali Acc: 0.863 Test Loss: 0.544 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.3639986515045166
Epoch: 23, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.553 Vali Acc: 0.859 Test Loss: 0.553 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.374260902404785
Epoch: 24, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.565 Vali Acc: 0.856 Test Loss: 0.565 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 1799192
model size : 7.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.101369380950928
Epoch: 1, Steps: 8 | Train Loss: 2.205 Vali Loss: 2.071 Vali Acc: 0.156 Test Loss: 2.071 Test Acc: 0.156
Validation loss decreased (inf --> -0.156229).  Saving model ...
Epoch: 2 cost time: 2.6519687175750732
Epoch: 2, Steps: 8 | Train Loss: 1.905 Vali Loss: 1.732 Vali Acc: 0.478 Test Loss: 1.732 Test Acc: 0.478
Validation loss decreased (-0.156229 --> -0.478108).  Saving model ...
Epoch: 3 cost time: 2.508171319961548
Epoch: 3, Steps: 8 | Train Loss: 1.517 Vali Loss: 1.351 Vali Acc: 0.731 Test Loss: 1.351 Test Acc: 0.731
Validation loss decreased (-0.478108 --> -0.731236).  Saving model ...
Epoch: 4 cost time: 2.5409021377563477
Epoch: 4, Steps: 8 | Train Loss: 1.156 Vali Loss: 1.035 Vali Acc: 0.769 Test Loss: 1.035 Test Acc: 0.769
Validation loss decreased (-0.731236 --> -0.768740).  Saving model ...
Epoch: 5 cost time: 2.6502208709716797
Epoch: 5, Steps: 8 | Train Loss: 0.855 Vali Loss: 0.814 Vali Acc: 0.797 Test Loss: 0.814 Test Acc: 0.797
Validation loss decreased (-0.768740 --> -0.796867).  Saving model ...
Epoch: 6 cost time: 2.5752665996551514
Epoch: 6, Steps: 8 | Train Loss: 0.621 Vali Loss: 0.683 Vali Acc: 0.803 Test Loss: 0.683 Test Acc: 0.803
Validation loss decreased (-0.796867 --> -0.803118).  Saving model ...
Epoch: 7 cost time: 2.642167329788208
Epoch: 7, Steps: 8 | Train Loss: 0.496 Vali Loss: 0.616 Vali Acc: 0.822 Test Loss: 0.616 Test Acc: 0.822
Validation loss decreased (-0.803118 --> -0.821869).  Saving model ...
Epoch: 8 cost time: 2.597468137741089
Epoch: 8, Steps: 8 | Train Loss: 0.355 Vali Loss: 0.579 Vali Acc: 0.825 Test Loss: 0.579 Test Acc: 0.825
Validation loss decreased (-0.821869 --> -0.824994).  Saving model ...
Epoch: 9 cost time: 2.5735981464385986
Epoch: 9, Steps: 8 | Train Loss: 0.282 Vali Loss: 0.551 Vali Acc: 0.831 Test Loss: 0.551 Test Acc: 0.831
Validation loss decreased (-0.824994 --> -0.831244).  Saving model ...
Epoch: 10 cost time: 2.5287704467773438
Epoch: 10, Steps: 8 | Train Loss: 0.221 Vali Loss: 0.540 Vali Acc: 0.828 Test Loss: 0.540 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.6173222064971924
Epoch: 11, Steps: 8 | Train Loss: 0.164 Vali Loss: 0.538 Vali Acc: 0.844 Test Loss: 0.538 Test Acc: 0.844
Validation loss decreased (-0.831244 --> -0.843745).  Saving model ...
Epoch: 12 cost time: 2.5956244468688965
Epoch: 12, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.540 Vali Acc: 0.844 Test Loss: 0.540 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.6506996154785156
Epoch: 13, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.542 Vali Acc: 0.838 Test Loss: 0.542 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.5548019409179688
Epoch: 14, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.532 Vali Acc: 0.838 Test Loss: 0.532 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.535672187805176
Epoch: 15, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.533 Vali Acc: 0.841 Test Loss: 0.533 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.5620267391204834
Epoch: 16, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.542 Vali Acc: 0.831 Test Loss: 0.542 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.6126441955566406
Epoch: 17, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.537 Vali Acc: 0.841 Test Loss: 0.537 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.671400785446167
Epoch: 18, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.538 Vali Acc: 0.847 Test Loss: 0.538 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 19 cost time: 2.577821731567383
Epoch: 19, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.533 Vali Acc: 0.850 Test Loss: 0.533 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 20 cost time: 2.646409034729004
Epoch: 20, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.524 Vali Acc: 0.853 Test Loss: 0.524 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 21 cost time: 2.5497000217437744
Epoch: 21, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.532 Vali Acc: 0.850 Test Loss: 0.532 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.5738682746887207
Epoch: 22, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.548 Vali Acc: 0.847 Test Loss: 0.548 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.5759801864624023
Epoch: 23, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.551 Vali Acc: 0.847 Test Loss: 0.551 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.6253185272216797
Epoch: 24, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.547 Vali Acc: 0.847 Test Loss: 0.547 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.6316561698913574
Epoch: 25, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.552 Vali Acc: 0.844 Test Loss: 0.552 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.5889599323272705
Epoch: 26, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.563 Vali Acc: 0.856 Test Loss: 0.563 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856244).  Saving model ...
Epoch: 27 cost time: 2.4712679386138916
Epoch: 27, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.559 Vali Acc: 0.856 Test Loss: 0.559 Test Acc: 0.856
Validation loss decreased (-0.856244 --> -0.856244).  Saving model ...
Epoch: 28 cost time: 2.638242244720459
Epoch: 28, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.561 Vali Acc: 0.853 Test Loss: 0.561 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.5240085124969482
Epoch: 29, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.564 Vali Acc: 0.850 Test Loss: 0.564 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.598813056945801
Epoch: 30, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.567 Vali Acc: 0.850 Test Loss: 0.567 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 557624
model size : 2.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.34912109375
Epoch: 1, Steps: 8 | Train Loss: 2.112 Vali Loss: 2.016 Vali Acc: 0.144 Test Loss: 2.016 Test Acc: 0.144
Validation loss decreased (inf --> -0.143730).  Saving model ...
Epoch: 2 cost time: 1.9462223052978516
Epoch: 2, Steps: 8 | Train Loss: 1.872 Vali Loss: 1.722 Vali Acc: 0.522 Test Loss: 1.722 Test Acc: 0.522
Validation loss decreased (-0.143730 --> -0.521858).  Saving model ...
Epoch: 3 cost time: 1.8871839046478271
Epoch: 3, Steps: 8 | Train Loss: 1.527 Vali Loss: 1.362 Vali Acc: 0.744 Test Loss: 1.362 Test Acc: 0.744
Validation loss decreased (-0.521858 --> -0.743736).  Saving model ...
Epoch: 4 cost time: 1.817488670349121
Epoch: 4, Steps: 8 | Train Loss: 1.152 Vali Loss: 1.040 Vali Acc: 0.791 Test Loss: 1.040 Test Acc: 0.791
Validation loss decreased (-0.743736 --> -0.790615).  Saving model ...
Epoch: 5 cost time: 1.557776927947998
Epoch: 5, Steps: 8 | Train Loss: 0.844 Vali Loss: 0.807 Vali Acc: 0.809 Test Loss: 0.807 Test Acc: 0.809
Validation loss decreased (-0.790615 --> -0.809367).  Saving model ...
Epoch: 6 cost time: 1.9012224674224854
Epoch: 6, Steps: 8 | Train Loss: 0.628 Vali Loss: 0.656 Vali Acc: 0.828 Test Loss: 0.656 Test Acc: 0.828
Validation loss decreased (-0.809367 --> -0.828118).  Saving model ...
Epoch: 7 cost time: 1.7067875862121582
Epoch: 7, Steps: 8 | Train Loss: 0.431 Vali Loss: 0.569 Vali Acc: 0.850 Test Loss: 0.569 Test Acc: 0.850
Validation loss decreased (-0.828118 --> -0.849994).  Saving model ...
Epoch: 8 cost time: 1.6953544616699219
Epoch: 8, Steps: 8 | Train Loss: 0.353 Vali Loss: 0.527 Vali Acc: 0.847 Test Loss: 0.527 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.660886287689209
Epoch: 9, Steps: 8 | Train Loss: 0.268 Vali Loss: 0.512 Vali Acc: 0.841 Test Loss: 0.512 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.64914870262146
Epoch: 10, Steps: 8 | Train Loss: 0.202 Vali Loss: 0.499 Vali Acc: 0.841 Test Loss: 0.499 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.913036584854126
Epoch: 11, Steps: 8 | Train Loss: 0.139 Vali Loss: 0.491 Vali Acc: 0.866 Test Loss: 0.491 Test Acc: 0.866
Validation loss decreased (-0.849994 --> -0.865620).  Saving model ...
Epoch: 12 cost time: 1.838310718536377
Epoch: 12, Steps: 8 | Train Loss: 0.110 Vali Loss: 0.493 Vali Acc: 0.863 Test Loss: 0.493 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7364146709442139
Epoch: 13, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.496 Vali Acc: 0.853 Test Loss: 0.496 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7426841259002686
Epoch: 14, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.493 Vali Acc: 0.856 Test Loss: 0.493 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.7061245441436768
Epoch: 15, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.498 Vali Acc: 0.863 Test Loss: 0.498 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.7791578769683838
Epoch: 16, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.509 Vali Acc: 0.866 Test Loss: 0.509 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.8625504970550537
Epoch: 17, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.512 Vali Acc: 0.859 Test Loss: 0.512 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.7699482440948486
Epoch: 18, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.522 Vali Acc: 0.859 Test Loss: 0.522 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.8818349838256836
Epoch: 19, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.531 Vali Acc: 0.853 Test Loss: 0.531 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.7533519268035889
Epoch: 20, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.545 Vali Acc: 0.859 Test Loss: 0.545 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.7581517696380615
Epoch: 21, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.545 Vali Acc: 0.844 Test Loss: 0.545 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 1799192
model size : 7.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.465418815612793
Epoch: 1, Steps: 8 | Train Loss: 2.208 Vali Loss: 2.078 Vali Acc: 0.153 Test Loss: 2.078 Test Acc: 0.153
Validation loss decreased (inf --> -0.153104).  Saving model ...
Epoch: 2 cost time: 1.226072072982788
Epoch: 2, Steps: 8 | Train Loss: 1.917 Vali Loss: 1.746 Vali Acc: 0.463 Test Loss: 1.746 Test Acc: 0.463
Validation loss decreased (-0.153104 --> -0.462483).  Saving model ...
Epoch: 3 cost time: 1.2446529865264893
Epoch: 3, Steps: 8 | Train Loss: 1.540 Vali Loss: 1.372 Vali Acc: 0.728 Test Loss: 1.372 Test Acc: 0.728
Validation loss decreased (-0.462483 --> -0.728111).  Saving model ...
Epoch: 4 cost time: 1.1803553104400635
Epoch: 4, Steps: 8 | Train Loss: 1.184 Vali Loss: 1.058 Vali Acc: 0.775 Test Loss: 1.058 Test Acc: 0.775
Validation loss decreased (-0.728111 --> -0.774989).  Saving model ...
Epoch: 5 cost time: 1.1680264472961426
Epoch: 5, Steps: 8 | Train Loss: 0.888 Vali Loss: 0.832 Vali Acc: 0.797 Test Loss: 0.832 Test Acc: 0.797
Validation loss decreased (-0.774989 --> -0.796867).  Saving model ...
Epoch: 6 cost time: 1.1701772212982178
Epoch: 6, Steps: 8 | Train Loss: 0.651 Vali Loss: 0.697 Vali Acc: 0.806 Test Loss: 0.697 Test Acc: 0.806
Validation loss decreased (-0.796867 --> -0.806243).  Saving model ...
Epoch: 7 cost time: 1.1817855834960938
Epoch: 7, Steps: 8 | Train Loss: 0.537 Vali Loss: 0.629 Vali Acc: 0.819 Test Loss: 0.629 Test Acc: 0.819
Validation loss decreased (-0.806243 --> -0.818744).  Saving model ...
Epoch: 8 cost time: 1.213641881942749
Epoch: 8, Steps: 8 | Train Loss: 0.392 Vali Loss: 0.591 Vali Acc: 0.828 Test Loss: 0.591 Test Acc: 0.828
Validation loss decreased (-0.818744 --> -0.828119).  Saving model ...
Epoch: 9 cost time: 1.216160774230957
Epoch: 9, Steps: 8 | Train Loss: 0.329 Vali Loss: 0.563 Vali Acc: 0.834 Test Loss: 0.563 Test Acc: 0.834
Validation loss decreased (-0.828119 --> -0.834369).  Saving model ...
Epoch: 10 cost time: 1.226435899734497
Epoch: 10, Steps: 8 | Train Loss: 0.268 Vali Loss: 0.552 Vali Acc: 0.834 Test Loss: 0.552 Test Acc: 0.834
Validation loss decreased (-0.834369 --> -0.834369).  Saving model ...
Epoch: 11 cost time: 1.149616003036499
Epoch: 11, Steps: 8 | Train Loss: 0.192 Vali Loss: 0.549 Vali Acc: 0.838 Test Loss: 0.549 Test Acc: 0.838
Validation loss decreased (-0.834369 --> -0.837495).  Saving model ...
Epoch: 12 cost time: 1.2191359996795654
Epoch: 12, Steps: 8 | Train Loss: 0.158 Vali Loss: 0.548 Vali Acc: 0.847 Test Loss: 0.548 Test Acc: 0.847
Validation loss decreased (-0.837495 --> -0.846870).  Saving model ...
Epoch: 13 cost time: 1.1688406467437744
Epoch: 13, Steps: 8 | Train Loss: 0.123 Vali Loss: 0.548 Vali Acc: 0.834 Test Loss: 0.548 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1758091449737549
Epoch: 14, Steps: 8 | Train Loss: 0.104 Vali Loss: 0.536 Vali Acc: 0.844 Test Loss: 0.536 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1417303085327148
Epoch: 15, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.534 Vali Acc: 0.847 Test Loss: 0.534 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 16 cost time: 1.1318912506103516
Epoch: 16, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.543 Vali Acc: 0.850 Test Loss: 0.543 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 17 cost time: 1.18955659866333
Epoch: 17, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.538 Vali Acc: 0.850 Test Loss: 0.538 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 18 cost time: 1.201019525527954
Epoch: 18, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.541 Vali Acc: 0.844 Test Loss: 0.541 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2016942501068115
Epoch: 19, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.538 Vali Acc: 0.847 Test Loss: 0.538 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1606249809265137
Epoch: 20, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.533 Vali Acc: 0.841 Test Loss: 0.533 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.172868251800537
Epoch: 21, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.544 Vali Acc: 0.847 Test Loss: 0.544 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.186983346939087
Epoch: 22, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.563 Vali Acc: 0.850 Test Loss: 0.563 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.1705989837646484
Epoch: 23, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.565 Vali Acc: 0.850 Test Loss: 0.565 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.2008681297302246
Epoch: 24, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.561 Vali Acc: 0.847 Test Loss: 0.561 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.202833652496338
Epoch: 25, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.563 Vali Acc: 0.844 Test Loss: 0.563 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.169844150543213
Epoch: 26, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.573 Vali Acc: 0.847 Test Loss: 0.573 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.1978955268859863
Epoch: 27, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.570 Vali Acc: 0.850 Test Loss: 0.570 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 557624
model size : 2.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.97141432762146
Epoch: 1, Steps: 8 | Train Loss: 1.927 Vali Loss: 1.860 Vali Acc: 0.359 Test Loss: 1.860 Test Acc: 0.359
Validation loss decreased (inf --> -0.359356).  Saving model ...
Epoch: 2 cost time: 2.608856678009033
Epoch: 2, Steps: 8 | Train Loss: 1.702 Vali Loss: 1.583 Vali Acc: 0.634 Test Loss: 1.583 Test Acc: 0.634
Validation loss decreased (-0.359356 --> -0.634359).  Saving model ...
Epoch: 3 cost time: 2.675710678100586
Epoch: 3, Steps: 8 | Train Loss: 1.367 Vali Loss: 1.273 Vali Acc: 0.719 Test Loss: 1.273 Test Acc: 0.719
Validation loss decreased (-0.634359 --> -0.718737).  Saving model ...
Epoch: 4 cost time: 2.6571133136749268
Epoch: 4, Steps: 8 | Train Loss: 1.053 Vali Loss: 1.004 Vali Acc: 0.772 Test Loss: 1.004 Test Acc: 0.772
Validation loss decreased (-0.718737 --> -0.771865).  Saving model ...
Epoch: 5 cost time: 2.594905138015747
Epoch: 5, Steps: 8 | Train Loss: 0.818 Vali Loss: 0.810 Vali Acc: 0.781 Test Loss: 0.810 Test Acc: 0.781
Validation loss decreased (-0.771865 --> -0.781242).  Saving model ...
Epoch: 6 cost time: 2.5336556434631348
Epoch: 6, Steps: 8 | Train Loss: 0.609 Vali Loss: 0.696 Vali Acc: 0.781 Test Loss: 0.696 Test Acc: 0.781
Validation loss decreased (-0.781242 --> -0.781243).  Saving model ...
Epoch: 7 cost time: 2.5724411010742188
Epoch: 7, Steps: 8 | Train Loss: 0.468 Vali Loss: 0.603 Vali Acc: 0.819 Test Loss: 0.603 Test Acc: 0.819
Validation loss decreased (-0.781243 --> -0.818744).  Saving model ...
Epoch: 8 cost time: 2.6571381092071533
Epoch: 8, Steps: 8 | Train Loss: 0.350 Vali Loss: 0.560 Vali Acc: 0.831 Test Loss: 0.560 Test Acc: 0.831
Validation loss decreased (-0.818744 --> -0.831244).  Saving model ...
Epoch: 9 cost time: 2.693532705307007
Epoch: 9, Steps: 8 | Train Loss: 0.271 Vali Loss: 0.540 Vali Acc: 0.831 Test Loss: 0.540 Test Acc: 0.831
Validation loss decreased (-0.831244 --> -0.831245).  Saving model ...
Epoch: 10 cost time: 2.6173675060272217
Epoch: 10, Steps: 8 | Train Loss: 0.210 Vali Loss: 0.520 Vali Acc: 0.831 Test Loss: 0.520 Test Acc: 0.831
Validation loss decreased (-0.831245 --> -0.831245).  Saving model ...
Epoch: 11 cost time: 2.546717882156372
Epoch: 11, Steps: 8 | Train Loss: 0.155 Vali Loss: 0.523 Vali Acc: 0.825 Test Loss: 0.523 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.5708742141723633
Epoch: 12, Steps: 8 | Train Loss: 0.118 Vali Loss: 0.524 Vali Acc: 0.825 Test Loss: 0.524 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.6989805698394775
Epoch: 13, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.523 Vali Acc: 0.828 Test Loss: 0.523 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.680459976196289
Epoch: 14, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.530 Vali Acc: 0.831 Test Loss: 0.530 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.5746424198150635
Epoch: 15, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.542 Vali Acc: 0.831 Test Loss: 0.542 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.376042366027832
Epoch: 16, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.536 Vali Acc: 0.828 Test Loss: 0.536 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.7659854888916016
Epoch: 17, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.561 Vali Acc: 0.831 Test Loss: 0.561 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.7529399394989014
Epoch: 18, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.571 Vali Acc: 0.828 Test Loss: 0.571 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.8103084564208984
Epoch: 19, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.573 Vali Acc: 0.828 Test Loss: 0.573 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.650585651397705
Epoch: 20, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.572 Vali Acc: 0.831 Test Loss: 0.572 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.83125
model parameter : 920024
model size : 3.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.1408426761627197
Epoch: 1, Steps: 8 | Train Loss: 2.120 Vali Loss: 2.052 Vali Acc: 0.178 Test Loss: 2.052 Test Acc: 0.178
Validation loss decreased (inf --> -0.178104).  Saving model ...
Epoch: 2 cost time: 1.7949812412261963
Epoch: 2, Steps: 8 | Train Loss: 1.955 Vali Loss: 1.805 Vali Acc: 0.419 Test Loss: 1.805 Test Acc: 0.419
Validation loss decreased (-0.178104 --> -0.418732).  Saving model ...
Epoch: 3 cost time: 1.7504913806915283
Epoch: 3, Steps: 8 | Train Loss: 1.650 Vali Loss: 1.506 Vali Acc: 0.700 Test Loss: 1.506 Test Acc: 0.700
Validation loss decreased (-0.418732 --> -0.699985).  Saving model ...
Epoch: 4 cost time: 1.8021385669708252
Epoch: 4, Steps: 8 | Train Loss: 1.344 Vali Loss: 1.212 Vali Acc: 0.784 Test Loss: 1.212 Test Acc: 0.784
Validation loss decreased (-0.699985 --> -0.784363).  Saving model ...
Epoch: 5 cost time: 1.7150092124938965
Epoch: 5, Steps: 8 | Train Loss: 1.036 Vali Loss: 0.975 Vali Acc: 0.791 Test Loss: 0.975 Test Acc: 0.791
Validation loss decreased (-0.784363 --> -0.790615).  Saving model ...
Epoch: 6 cost time: 1.7828454971313477
Epoch: 6, Steps: 8 | Train Loss: 0.796 Vali Loss: 0.804 Vali Acc: 0.812 Test Loss: 0.804 Test Acc: 0.812
Validation loss decreased (-0.790615 --> -0.812492).  Saving model ...
Epoch: 7 cost time: 1.6969518661499023
Epoch: 7, Steps: 8 | Train Loss: 0.559 Vali Loss: 0.695 Vali Acc: 0.819 Test Loss: 0.695 Test Acc: 0.819
Validation loss decreased (-0.812492 --> -0.818743).  Saving model ...
Epoch: 8 cost time: 1.7422730922698975
Epoch: 8, Steps: 8 | Train Loss: 0.451 Vali Loss: 0.613 Vali Acc: 0.825 Test Loss: 0.613 Test Acc: 0.825
Validation loss decreased (-0.818743 --> -0.824994).  Saving model ...
Epoch: 9 cost time: 1.8183400630950928
Epoch: 9, Steps: 8 | Train Loss: 0.322 Vali Loss: 0.560 Vali Acc: 0.850 Test Loss: 0.560 Test Acc: 0.850
Validation loss decreased (-0.824994 --> -0.849994).  Saving model ...
Epoch: 10 cost time: 1.607663869857788
Epoch: 10, Steps: 8 | Train Loss: 0.245 Vali Loss: 0.530 Vali Acc: 0.859 Test Loss: 0.530 Test Acc: 0.859
Validation loss decreased (-0.849994 --> -0.859370).  Saving model ...
Epoch: 11 cost time: 1.5672521591186523
Epoch: 11, Steps: 8 | Train Loss: 0.181 Vali Loss: 0.502 Vali Acc: 0.853 Test Loss: 0.502 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.555729627609253
Epoch: 12, Steps: 8 | Train Loss: 0.136 Vali Loss: 0.492 Vali Acc: 0.856 Test Loss: 0.492 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.552299976348877
Epoch: 13, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.493 Vali Acc: 0.859 Test Loss: 0.493 Test Acc: 0.859
Validation loss decreased (-0.859370 --> -0.859370).  Saving model ...
Epoch: 14 cost time: 1.602160930633545
Epoch: 14, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.500 Vali Acc: 0.859 Test Loss: 0.500 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6372056007385254
Epoch: 15, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.496 Vali Acc: 0.859 Test Loss: 0.496 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6105458736419678
Epoch: 16, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.497 Vali Acc: 0.863 Test Loss: 0.497 Test Acc: 0.863
Validation loss decreased (-0.859370 --> -0.862495).  Saving model ...
Epoch: 17 cost time: 1.6246066093444824
Epoch: 17, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.500 Vali Acc: 0.859 Test Loss: 0.500 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5590643882751465
Epoch: 18, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.515 Vali Acc: 0.863 Test Loss: 0.515 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.591726303100586
Epoch: 19, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.529 Vali Acc: 0.859 Test Loss: 0.529 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.518725872039795
Epoch: 20, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.538 Vali Acc: 0.859 Test Loss: 0.538 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.5414104461669922
Epoch: 21, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.538 Vali Acc: 0.859 Test Loss: 0.538 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.24592924118042
Epoch: 22, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.539 Vali Acc: 0.866 Test Loss: 0.539 Test Acc: 0.866
Validation loss decreased (-0.862495 --> -0.865620).  Saving model ...
Epoch: 23 cost time: 1.5943191051483154
Epoch: 23, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.539 Vali Acc: 0.866 Test Loss: 0.539 Test Acc: 0.866
Validation loss decreased (-0.865620 --> -0.865620).  Saving model ...
Epoch: 24 cost time: 1.4876048564910889
Epoch: 24, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.541 Vali Acc: 0.866 Test Loss: 0.541 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5638668537139893
Epoch: 25, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.548 Vali Acc: 0.866 Test Loss: 0.548 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.474557638168335
Epoch: 26, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.550 Vali Acc: 0.866 Test Loss: 0.550 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.5090999603271484
Epoch: 27, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.559 Vali Acc: 0.866 Test Loss: 0.559 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.691500186920166
Epoch: 28, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.569 Vali Acc: 0.859 Test Loss: 0.569 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.585578441619873
Epoch: 29, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.575 Vali Acc: 0.853 Test Loss: 0.575 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.5721638202667236
Epoch: 30, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.576 Vali Acc: 0.859 Test Loss: 0.576 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 299192
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.3835721015930176
Epoch: 1, Steps: 8 | Train Loss: 1.924 Vali Loss: 1.861 Vali Acc: 0.353 Test Loss: 1.861 Test Acc: 0.353
Validation loss decreased (inf --> -0.353106).  Saving model ...
Epoch: 2 cost time: 2.019819736480713
Epoch: 2, Steps: 8 | Train Loss: 1.700 Vali Loss: 1.588 Vali Acc: 0.641 Test Loss: 1.588 Test Acc: 0.641
Validation loss decreased (-0.353106 --> -0.640609).  Saving model ...
Epoch: 3 cost time: 2.0989181995391846
Epoch: 3, Steps: 8 | Train Loss: 1.367 Vali Loss: 1.282 Vali Acc: 0.719 Test Loss: 1.282 Test Acc: 0.719
Validation loss decreased (-0.640609 --> -0.718737).  Saving model ...
Epoch: 4 cost time: 1.9334797859191895
Epoch: 4, Steps: 8 | Train Loss: 1.055 Vali Loss: 1.015 Vali Acc: 0.772 Test Loss: 1.015 Test Acc: 0.772
Validation loss decreased (-0.718737 --> -0.771865).  Saving model ...
Epoch: 5 cost time: 1.9218695163726807
Epoch: 5, Steps: 8 | Train Loss: 0.820 Vali Loss: 0.823 Vali Acc: 0.781 Test Loss: 0.823 Test Acc: 0.781
Validation loss decreased (-0.771865 --> -0.781242).  Saving model ...
Epoch: 6 cost time: 2.0338473320007324
Epoch: 6, Steps: 8 | Train Loss: 0.612 Vali Loss: 0.710 Vali Acc: 0.781 Test Loss: 0.710 Test Acc: 0.781
Validation loss decreased (-0.781242 --> -0.781243).  Saving model ...
Epoch: 7 cost time: 1.8930418491363525
Epoch: 7, Steps: 8 | Train Loss: 0.470 Vali Loss: 0.617 Vali Acc: 0.816 Test Loss: 0.617 Test Acc: 0.816
Validation loss decreased (-0.781243 --> -0.815619).  Saving model ...
Epoch: 8 cost time: 1.9882447719573975
Epoch: 8, Steps: 8 | Train Loss: 0.351 Vali Loss: 0.575 Vali Acc: 0.834 Test Loss: 0.575 Test Acc: 0.834
Validation loss decreased (-0.815619 --> -0.834369).  Saving model ...
Epoch: 9 cost time: 1.9245426654815674
Epoch: 9, Steps: 8 | Train Loss: 0.272 Vali Loss: 0.556 Vali Acc: 0.825 Test Loss: 0.556 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2965257167816162
Epoch: 10, Steps: 8 | Train Loss: 0.210 Vali Loss: 0.536 Vali Acc: 0.828 Test Loss: 0.536 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.0162200927734375
Epoch: 11, Steps: 8 | Train Loss: 0.155 Vali Loss: 0.539 Vali Acc: 0.825 Test Loss: 0.539 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.008683919906616
Epoch: 12, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.541 Vali Acc: 0.822 Test Loss: 0.541 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.964210033416748
Epoch: 13, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.541 Vali Acc: 0.831 Test Loss: 0.541 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.0691115856170654
Epoch: 14, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.548 Vali Acc: 0.831 Test Loss: 0.548 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.027179479598999
Epoch: 15, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.560 Vali Acc: 0.828 Test Loss: 0.560 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.1409757137298584
Epoch: 16, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.552 Vali Acc: 0.831 Test Loss: 0.552 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.168517827987671
Epoch: 17, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.577 Vali Acc: 0.831 Test Loss: 0.577 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.308485507965088
Epoch: 18, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.587 Vali Acc: 0.831 Test Loss: 0.587 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.834375
model parameter : 920024
model size : 3.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.122893810272217
Epoch: 1, Steps: 8 | Train Loss: 2.121 Vali Loss: 2.052 Vali Acc: 0.178 Test Loss: 2.052 Test Acc: 0.178
Validation loss decreased (inf --> -0.178104).  Saving model ...
Epoch: 2 cost time: 1.5076243877410889
Epoch: 2, Steps: 8 | Train Loss: 1.955 Vali Loss: 1.807 Vali Acc: 0.425 Test Loss: 1.807 Test Acc: 0.425
Validation loss decreased (-0.178104 --> -0.424982).  Saving model ...
Epoch: 3 cost time: 1.5062458515167236
Epoch: 3, Steps: 8 | Train Loss: 1.650 Vali Loss: 1.507 Vali Acc: 0.697 Test Loss: 1.507 Test Acc: 0.697
Validation loss decreased (-0.424982 --> -0.696860).  Saving model ...
Epoch: 4 cost time: 1.4936668872833252
Epoch: 4, Steps: 8 | Train Loss: 1.343 Vali Loss: 1.214 Vali Acc: 0.784 Test Loss: 1.214 Test Acc: 0.784
Validation loss decreased (-0.696860 --> -0.784363).  Saving model ...
Epoch: 5 cost time: 1.5090856552124023
Epoch: 5, Steps: 8 | Train Loss: 1.036 Vali Loss: 0.978 Vali Acc: 0.791 Test Loss: 0.978 Test Acc: 0.791
Validation loss decreased (-0.784363 --> -0.790615).  Saving model ...
Epoch: 6 cost time: 1.4603865146636963
Epoch: 6, Steps: 8 | Train Loss: 0.796 Vali Loss: 0.808 Vali Acc: 0.812 Test Loss: 0.808 Test Acc: 0.812
Validation loss decreased (-0.790615 --> -0.812492).  Saving model ...
Epoch: 7 cost time: 1.470991849899292
Epoch: 7, Steps: 8 | Train Loss: 0.559 Vali Loss: 0.699 Vali Acc: 0.819 Test Loss: 0.699 Test Acc: 0.819
Validation loss decreased (-0.812492 --> -0.818743).  Saving model ...
Epoch: 8 cost time: 1.4589338302612305
Epoch: 8, Steps: 8 | Train Loss: 0.450 Vali Loss: 0.618 Vali Acc: 0.825 Test Loss: 0.618 Test Acc: 0.825
Validation loss decreased (-0.818743 --> -0.824994).  Saving model ...
Epoch: 9 cost time: 1.4377195835113525
Epoch: 9, Steps: 8 | Train Loss: 0.322 Vali Loss: 0.565 Vali Acc: 0.853 Test Loss: 0.565 Test Acc: 0.853
Validation loss decreased (-0.824994 --> -0.853119).  Saving model ...
Epoch: 10 cost time: 1.486280918121338
Epoch: 10, Steps: 8 | Train Loss: 0.245 Vali Loss: 0.535 Vali Acc: 0.859 Test Loss: 0.535 Test Acc: 0.859
Validation loss decreased (-0.853119 --> -0.859370).  Saving model ...
Epoch: 11 cost time: 1.5216805934906006
Epoch: 11, Steps: 8 | Train Loss: 0.180 Vali Loss: 0.506 Vali Acc: 0.853 Test Loss: 0.506 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.524186372756958
Epoch: 12, Steps: 8 | Train Loss: 0.135 Vali Loss: 0.496 Vali Acc: 0.856 Test Loss: 0.496 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.5122144222259521
Epoch: 13, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.497 Vali Acc: 0.859 Test Loss: 0.497 Test Acc: 0.859
Validation loss decreased (-0.859370 --> -0.859370).  Saving model ...
Epoch: 14 cost time: 1.4784104824066162
Epoch: 14, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.504 Vali Acc: 0.859 Test Loss: 0.504 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4491536617279053
Epoch: 15, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.500 Vali Acc: 0.856 Test Loss: 0.500 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.481459379196167
Epoch: 16, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.502 Vali Acc: 0.856 Test Loss: 0.502 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.4807157516479492
Epoch: 17, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.504 Vali Acc: 0.853 Test Loss: 0.504 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.478442668914795
Epoch: 18, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.520 Vali Acc: 0.859 Test Loss: 0.520 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.5378029346466064
Epoch: 19, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.534 Vali Acc: 0.856 Test Loss: 0.534 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.5225579738616943
Epoch: 20, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.543 Vali Acc: 0.856 Test Loss: 0.543 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.4392328262329102
Epoch: 21, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.542 Vali Acc: 0.856 Test Loss: 0.542 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.357771396636963
Epoch: 22, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.544 Vali Acc: 0.863 Test Loss: 0.544 Test Acc: 0.863
Validation loss decreased (-0.859370 --> -0.862495).  Saving model ...
Epoch: 23 cost time: 1.4584507942199707
Epoch: 23, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.543 Vali Acc: 0.863 Test Loss: 0.543 Test Acc: 0.863
Validation loss decreased (-0.862495 --> -0.862495).  Saving model ...
Epoch: 24 cost time: 1.4642844200134277
Epoch: 24, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.545 Vali Acc: 0.863 Test Loss: 0.545 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.4915852546691895
Epoch: 25, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.552 Vali Acc: 0.866 Test Loss: 0.552 Test Acc: 0.866
Validation loss decreased (-0.862495 --> -0.865619).  Saving model ...
Epoch: 26 cost time: 1.4565315246582031
Epoch: 26, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.554 Vali Acc: 0.866 Test Loss: 0.554 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.4569993019104004
Epoch: 27, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.564 Vali Acc: 0.866 Test Loss: 0.564 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.4079413414001465
Epoch: 28, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.573 Vali Acc: 0.859 Test Loss: 0.573 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.522364854812622
Epoch: 29, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.579 Vali Acc: 0.853 Test Loss: 0.579 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.456604242324829
Epoch: 30, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.580 Vali Acc: 0.859 Test Loss: 0.580 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 299192
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.885711908340454
Epoch: 1, Steps: 8 | Train Loss: 1.923 Vali Loss: 1.866 Vali Acc: 0.350 Test Loss: 1.866 Test Acc: 0.350
Validation loss decreased (inf --> -0.349981).  Saving model ...
Epoch: 2 cost time: 1.567619800567627
Epoch: 2, Steps: 8 | Train Loss: 1.703 Vali Loss: 1.598 Vali Acc: 0.625 Test Loss: 1.598 Test Acc: 0.625
Validation loss decreased (-0.349981 --> -0.624984).  Saving model ...
Epoch: 3 cost time: 1.4979612827301025
Epoch: 3, Steps: 8 | Train Loss: 1.377 Vali Loss: 1.296 Vali Acc: 0.719 Test Loss: 1.296 Test Acc: 0.719
Validation loss decreased (-0.624984 --> -0.718737).  Saving model ...
Epoch: 4 cost time: 1.4966652393341064
Epoch: 4, Steps: 8 | Train Loss: 1.068 Vali Loss: 1.031 Vali Acc: 0.769 Test Loss: 1.031 Test Acc: 0.769
Validation loss decreased (-0.718737 --> -0.768740).  Saving model ...
Epoch: 5 cost time: 1.5394706726074219
Epoch: 5, Steps: 8 | Train Loss: 0.834 Vali Loss: 0.839 Vali Acc: 0.787 Test Loss: 0.839 Test Acc: 0.787
Validation loss decreased (-0.768740 --> -0.787492).  Saving model ...
Epoch: 6 cost time: 1.3541321754455566
Epoch: 6, Steps: 8 | Train Loss: 0.629 Vali Loss: 0.725 Vali Acc: 0.781 Test Loss: 0.725 Test Acc: 0.781
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3168468475341797
Epoch: 7, Steps: 8 | Train Loss: 0.491 Vali Loss: 0.631 Vali Acc: 0.806 Test Loss: 0.631 Test Acc: 0.806
Validation loss decreased (-0.787492 --> -0.806244).  Saving model ...
Epoch: 8 cost time: 1.4511308670043945
Epoch: 8, Steps: 8 | Train Loss: 0.381 Vali Loss: 0.589 Vali Acc: 0.822 Test Loss: 0.589 Test Acc: 0.822
Validation loss decreased (-0.806244 --> -0.821869).  Saving model ...
Epoch: 9 cost time: 1.3399324417114258
Epoch: 9, Steps: 8 | Train Loss: 0.308 Vali Loss: 0.574 Vali Acc: 0.822 Test Loss: 0.574 Test Acc: 0.822
Validation loss decreased (-0.821869 --> -0.821869).  Saving model ...
Epoch: 10 cost time: 1.4010884761810303
Epoch: 10, Steps: 8 | Train Loss: 0.248 Vali Loss: 0.556 Vali Acc: 0.819 Test Loss: 0.556 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3224656581878662
Epoch: 11, Steps: 8 | Train Loss: 0.197 Vali Loss: 0.566 Vali Acc: 0.822 Test Loss: 0.566 Test Acc: 0.822
Validation loss decreased (-0.821869 --> -0.821869).  Saving model ...
Epoch: 12 cost time: 1.4088053703308105
Epoch: 12, Steps: 8 | Train Loss: 0.150 Vali Loss: 0.570 Vali Acc: 0.819 Test Loss: 0.570 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4077043533325195
Epoch: 13, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.567 Vali Acc: 0.828 Test Loss: 0.567 Test Acc: 0.828
Validation loss decreased (-0.821869 --> -0.828119).  Saving model ...
Epoch: 14 cost time: 1.415630578994751
Epoch: 14, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.570 Vali Acc: 0.819 Test Loss: 0.570 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.407721757888794
Epoch: 15, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.581 Vali Acc: 0.828 Test Loss: 0.581 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4061551094055176
Epoch: 16, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.575 Vali Acc: 0.822 Test Loss: 0.575 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.4007856845855713
Epoch: 17, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.596 Vali Acc: 0.822 Test Loss: 0.596 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.431337594985962
Epoch: 18, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.604 Vali Acc: 0.825 Test Loss: 0.604 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.4080383777618408
Epoch: 19, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.603 Vali Acc: 0.825 Test Loss: 0.603 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.399808406829834
Epoch: 20, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.597 Vali Acc: 0.834 Test Loss: 0.597 Test Acc: 0.834
Validation loss decreased (-0.828119 --> -0.834369).  Saving model ...
Epoch: 21 cost time: 1.3832099437713623
Epoch: 21, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.595 Vali Acc: 0.834 Test Loss: 0.595 Test Acc: 0.834
Validation loss decreased (-0.834369 --> -0.834369).  Saving model ...
Epoch: 22 cost time: 1.4276130199432373
Epoch: 22, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.597 Vali Acc: 0.831 Test Loss: 0.597 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4161403179168701
Epoch: 23, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.601 Vali Acc: 0.828 Test Loss: 0.601 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.3458776473999023
Epoch: 24, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.608 Vali Acc: 0.825 Test Loss: 0.608 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.4379854202270508
Epoch: 25, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.618 Vali Acc: 0.828 Test Loss: 0.618 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.4467337131500244
Epoch: 26, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.623 Vali Acc: 0.825 Test Loss: 0.623 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.4069404602050781
Epoch: 27, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.627 Vali Acc: 0.828 Test Loss: 0.627 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.3837518692016602
Epoch: 28, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.629 Vali Acc: 0.825 Test Loss: 0.629 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.4482741355895996
Epoch: 29, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.634 Vali Acc: 0.825 Test Loss: 0.634 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.4084954261779785
Epoch: 30, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.637 Vali Acc: 0.825 Test Loss: 0.637 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.834375
model parameter : 920024
model size : 3.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.6394476890563965
Epoch: 1, Steps: 8 | Train Loss: 2.115 Vali Loss: 2.055 Vali Acc: 0.181 Test Loss: 2.055 Test Acc: 0.181
Validation loss decreased (inf --> -0.181229).  Saving model ...
Epoch: 2 cost time: 1.0618839263916016
Epoch: 2, Steps: 8 | Train Loss: 1.960 Vali Loss: 1.815 Vali Acc: 0.409 Test Loss: 1.815 Test Acc: 0.409
Validation loss decreased (-0.181229 --> -0.409357).  Saving model ...
Epoch: 3 cost time: 1.0398104190826416
Epoch: 3, Steps: 8 | Train Loss: 1.660 Vali Loss: 1.523 Vali Acc: 0.684 Test Loss: 1.523 Test Acc: 0.684
Validation loss decreased (-0.409357 --> -0.684360).  Saving model ...
Epoch: 4 cost time: 1.0591490268707275
Epoch: 4, Steps: 8 | Train Loss: 1.362 Vali Loss: 1.235 Vali Acc: 0.769 Test Loss: 1.235 Test Acc: 0.769
Validation loss decreased (-0.684360 --> -0.768738).  Saving model ...
Epoch: 5 cost time: 1.0742580890655518
Epoch: 5, Steps: 8 | Train Loss: 1.061 Vali Loss: 1.000 Vali Acc: 0.781 Test Loss: 1.000 Test Acc: 0.781
Validation loss decreased (-0.768738 --> -0.781240).  Saving model ...
Epoch: 6 cost time: 1.0415666103363037
Epoch: 6, Steps: 8 | Train Loss: 0.825 Vali Loss: 0.830 Vali Acc: 0.816 Test Loss: 0.830 Test Acc: 0.816
Validation loss decreased (-0.781240 --> -0.815617).  Saving model ...
Epoch: 7 cost time: 1.0777819156646729
Epoch: 7, Steps: 8 | Train Loss: 0.585 Vali Loss: 0.720 Vali Acc: 0.822 Test Loss: 0.720 Test Acc: 0.822
Validation loss decreased (-0.815617 --> -0.821868).  Saving model ...
Epoch: 8 cost time: 1.0726041793823242
Epoch: 8, Steps: 8 | Train Loss: 0.483 Vali Loss: 0.640 Vali Acc: 0.825 Test Loss: 0.640 Test Acc: 0.825
Validation loss decreased (-0.821868 --> -0.824994).  Saving model ...
Epoch: 9 cost time: 1.0783464908599854
Epoch: 9, Steps: 8 | Train Loss: 0.356 Vali Loss: 0.589 Vali Acc: 0.847 Test Loss: 0.589 Test Acc: 0.847
Validation loss decreased (-0.824994 --> -0.846869).  Saving model ...
Epoch: 10 cost time: 1.055985689163208
Epoch: 10, Steps: 8 | Train Loss: 0.281 Vali Loss: 0.562 Vali Acc: 0.844 Test Loss: 0.562 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0470094680786133
Epoch: 11, Steps: 8 | Train Loss: 0.215 Vali Loss: 0.535 Vali Acc: 0.844 Test Loss: 0.535 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0682921409606934
Epoch: 12, Steps: 8 | Train Loss: 0.167 Vali Loss: 0.526 Vali Acc: 0.850 Test Loss: 0.526 Test Acc: 0.850
Validation loss decreased (-0.846869 --> -0.849995).  Saving model ...
Epoch: 13 cost time: 0.799238920211792
Epoch: 13, Steps: 8 | Train Loss: 0.139 Vali Loss: 0.530 Vali Acc: 0.853 Test Loss: 0.530 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 14 cost time: 1.0293524265289307
Epoch: 14, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.535 Vali Acc: 0.850 Test Loss: 0.535 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0480639934539795
Epoch: 15, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.529 Vali Acc: 0.844 Test Loss: 0.529 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0455775260925293
Epoch: 16, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.528 Vali Acc: 0.838 Test Loss: 0.528 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0082025527954102
Epoch: 17, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.529 Vali Acc: 0.844 Test Loss: 0.529 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.0830907821655273
Epoch: 18, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.545 Vali Acc: 0.844 Test Loss: 0.545 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.0477542877197266
Epoch: 19, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.559 Vali Acc: 0.844 Test Loss: 0.559 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.0234673023223877
Epoch: 20, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.568 Vali Acc: 0.841 Test Loss: 0.568 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.0052874088287354
Epoch: 21, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.568 Vali Acc: 0.841 Test Loss: 0.568 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.9635119438171387
Epoch: 22, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.568 Vali Acc: 0.847 Test Loss: 0.568 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.1291635036468506
Epoch: 23, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.565 Vali Acc: 0.847 Test Loss: 0.565 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 299192
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.722538709640503
Epoch: 1, Steps: 8 | Train Loss: 2.101 Vali Loss: 1.998 Vali Acc: 0.212 Test Loss: 1.998 Test Acc: 0.212
Validation loss decreased (inf --> -0.212480).  Saving model ...
Epoch: 2 cost time: 2.323378324508667
Epoch: 2, Steps: 8 | Train Loss: 1.865 Vali Loss: 1.691 Vali Acc: 0.494 Test Loss: 1.691 Test Acc: 0.494
Validation loss decreased (-0.212480 --> -0.493733).  Saving model ...
Epoch: 3 cost time: 2.393535852432251
Epoch: 3, Steps: 8 | Train Loss: 1.515 Vali Loss: 1.350 Vali Acc: 0.728 Test Loss: 1.350 Test Acc: 0.728
Validation loss decreased (-0.493733 --> -0.728111).  Saving model ...
Epoch: 4 cost time: 2.407224655151367
Epoch: 4, Steps: 8 | Train Loss: 1.139 Vali Loss: 1.039 Vali Acc: 0.787 Test Loss: 1.039 Test Acc: 0.787
Validation loss decreased (-0.728111 --> -0.787490).  Saving model ...
Epoch: 5 cost time: 2.422713041305542
Epoch: 5, Steps: 8 | Train Loss: 0.870 Vali Loss: 0.821 Vali Acc: 0.803 Test Loss: 0.821 Test Acc: 0.803
Validation loss decreased (-0.787490 --> -0.803117).  Saving model ...
Epoch: 6 cost time: 2.3681037425994873
Epoch: 6, Steps: 8 | Train Loss: 0.643 Vali Loss: 0.682 Vali Acc: 0.809 Test Loss: 0.682 Test Acc: 0.809
Validation loss decreased (-0.803117 --> -0.809368).  Saving model ...
Epoch: 7 cost time: 2.395880699157715
Epoch: 7, Steps: 8 | Train Loss: 0.480 Vali Loss: 0.599 Vali Acc: 0.828 Test Loss: 0.599 Test Acc: 0.828
Validation loss decreased (-0.809368 --> -0.828119).  Saving model ...
Epoch: 8 cost time: 2.274280548095703
Epoch: 8, Steps: 8 | Train Loss: 0.396 Vali Loss: 0.550 Vali Acc: 0.834 Test Loss: 0.550 Test Acc: 0.834
Validation loss decreased (-0.828119 --> -0.834370).  Saving model ...
Epoch: 9 cost time: 2.324296236038208
Epoch: 9, Steps: 8 | Train Loss: 0.295 Vali Loss: 0.526 Vali Acc: 0.844 Test Loss: 0.526 Test Acc: 0.844
Validation loss decreased (-0.834370 --> -0.843745).  Saving model ...
Epoch: 10 cost time: 2.4274187088012695
Epoch: 10, Steps: 8 | Train Loss: 0.230 Vali Loss: 0.512 Vali Acc: 0.844 Test Loss: 0.512 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 11 cost time: 2.346256732940674
Epoch: 11, Steps: 8 | Train Loss: 0.181 Vali Loss: 0.501 Vali Acc: 0.853 Test Loss: 0.501 Test Acc: 0.853
Validation loss decreased (-0.843745 --> -0.853120).  Saving model ...
Epoch: 12 cost time: 2.447739839553833
Epoch: 12, Steps: 8 | Train Loss: 0.130 Vali Loss: 0.524 Vali Acc: 0.841 Test Loss: 0.524 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.4115774631500244
Epoch: 13, Steps: 8 | Train Loss: 0.114 Vali Loss: 0.536 Vali Acc: 0.844 Test Loss: 0.536 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.3483633995056152
Epoch: 14, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.526 Vali Acc: 0.850 Test Loss: 0.526 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.490704298019409
Epoch: 15, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.528 Vali Acc: 0.850 Test Loss: 0.528 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.4627795219421387
Epoch: 16, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.530 Vali Acc: 0.850 Test Loss: 0.530 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.4056272506713867
Epoch: 17, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.540 Vali Acc: 0.850 Test Loss: 0.540 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.4180426597595215
Epoch: 18, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.544 Vali Acc: 0.847 Test Loss: 0.544 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.3953371047973633
Epoch: 19, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.547 Vali Acc: 0.847 Test Loss: 0.547 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.4332196712493896
Epoch: 20, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.556 Vali Acc: 0.847 Test Loss: 0.556 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.4430809020996094
Epoch: 21, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.556 Vali Acc: 0.847 Test Loss: 0.556 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 480440
model size : 2.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.9104087352752686
Epoch: 1, Steps: 8 | Train Loss: 2.200 Vali Loss: 2.122 Vali Acc: 0.156 Test Loss: 2.122 Test Acc: 0.156
Validation loss decreased (inf --> -0.156229).  Saving model ...
Epoch: 2 cost time: 1.527841329574585
Epoch: 2, Steps: 8 | Train Loss: 1.901 Vali Loss: 1.800 Vali Acc: 0.409 Test Loss: 1.800 Test Acc: 0.409
Validation loss decreased (-0.156229 --> -0.409357).  Saving model ...
Epoch: 3 cost time: 1.6008894443511963
Epoch: 3, Steps: 8 | Train Loss: 1.611 Vali Loss: 1.414 Vali Acc: 0.684 Test Loss: 1.414 Test Acc: 0.684
Validation loss decreased (-0.409357 --> -0.684361).  Saving model ...
Epoch: 4 cost time: 1.5947856903076172
Epoch: 4, Steps: 8 | Train Loss: 1.183 Vali Loss: 1.087 Vali Acc: 0.781 Test Loss: 1.087 Test Acc: 0.781
Validation loss decreased (-0.684361 --> -0.781239).  Saving model ...
Epoch: 5 cost time: 1.6420278549194336
Epoch: 5, Steps: 8 | Train Loss: 0.877 Vali Loss: 0.844 Vali Acc: 0.800 Test Loss: 0.844 Test Acc: 0.800
Validation loss decreased (-0.781239 --> -0.799992).  Saving model ...
Epoch: 6 cost time: 1.5590238571166992
Epoch: 6, Steps: 8 | Train Loss: 0.640 Vali Loss: 0.690 Vali Acc: 0.834 Test Loss: 0.690 Test Acc: 0.834
Validation loss decreased (-0.799992 --> -0.834368).  Saving model ...
Epoch: 7 cost time: 1.5522606372833252
Epoch: 7, Steps: 8 | Train Loss: 0.533 Vali Loss: 0.601 Vali Acc: 0.838 Test Loss: 0.601 Test Acc: 0.838
Validation loss decreased (-0.834368 --> -0.837494).  Saving model ...
Epoch: 8 cost time: 1.601604700088501
Epoch: 8, Steps: 8 | Train Loss: 0.389 Vali Loss: 0.525 Vali Acc: 0.859 Test Loss: 0.525 Test Acc: 0.859
Validation loss decreased (-0.837494 --> -0.859370).  Saving model ...
Epoch: 9 cost time: 1.4852399826049805
Epoch: 9, Steps: 8 | Train Loss: 0.289 Vali Loss: 0.490 Vali Acc: 0.863 Test Loss: 0.490 Test Acc: 0.863
Validation loss decreased (-0.859370 --> -0.862495).  Saving model ...
Epoch: 10 cost time: 1.388824462890625
Epoch: 10, Steps: 8 | Train Loss: 0.236 Vali Loss: 0.471 Vali Acc: 0.866 Test Loss: 0.471 Test Acc: 0.866
Validation loss decreased (-0.862495 --> -0.865620).  Saving model ...
Epoch: 11 cost time: 1.4214367866516113
Epoch: 11, Steps: 8 | Train Loss: 0.170 Vali Loss: 0.462 Vali Acc: 0.863 Test Loss: 0.462 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4808073043823242
Epoch: 12, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.454 Vali Acc: 0.866 Test Loss: 0.454 Test Acc: 0.866
Validation loss decreased (-0.865620 --> -0.865620).  Saving model ...
Epoch: 13 cost time: 1.4546740055084229
Epoch: 13, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.444 Vali Acc: 0.863 Test Loss: 0.444 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.432589054107666
Epoch: 14, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.431 Vali Acc: 0.875 Test Loss: 0.431 Test Acc: 0.875
Validation loss decreased (-0.865620 --> -0.874996).  Saving model ...
Epoch: 15 cost time: 1.382164716720581
Epoch: 15, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.449 Vali Acc: 0.869 Test Loss: 0.449 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3480489253997803
Epoch: 16, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.451 Vali Acc: 0.872 Test Loss: 0.451 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4181928634643555
Epoch: 17, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.453 Vali Acc: 0.872 Test Loss: 0.453 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.4198451042175293
Epoch: 18, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.456 Vali Acc: 0.869 Test Loss: 0.456 Test Acc: 0.869
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.3745009899139404
Epoch: 19, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.461 Vali Acc: 0.869 Test Loss: 0.461 Test Acc: 0.869
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.3403239250183105
Epoch: 20, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.465 Vali Acc: 0.869 Test Loss: 0.465 Test Acc: 0.869
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.5905413627624512
Epoch: 21, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.472 Vali Acc: 0.869 Test Loss: 0.472 Test Acc: 0.869
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.49015212059021
Epoch: 22, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.479 Vali Acc: 0.872 Test Loss: 0.479 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.5107378959655762
Epoch: 23, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.483 Vali Acc: 0.869 Test Loss: 0.483 Test Acc: 0.869
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.4852395057678223
Epoch: 24, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.482 Vali Acc: 0.872 Test Loss: 0.482 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.875
model parameter : 169976
model size : 0.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.128784418106079
Epoch: 1, Steps: 8 | Train Loss: 2.101 Vali Loss: 1.998 Vali Acc: 0.212 Test Loss: 1.998 Test Acc: 0.212
Validation loss decreased (inf --> -0.212480).  Saving model ...
Epoch: 2 cost time: 1.7937548160552979
Epoch: 2, Steps: 8 | Train Loss: 1.865 Vali Loss: 1.691 Vali Acc: 0.494 Test Loss: 1.691 Test Acc: 0.494
Validation loss decreased (-0.212480 --> -0.493733).  Saving model ...
Epoch: 3 cost time: 1.8924071788787842
Epoch: 3, Steps: 8 | Train Loss: 1.515 Vali Loss: 1.350 Vali Acc: 0.728 Test Loss: 1.350 Test Acc: 0.728
Validation loss decreased (-0.493733 --> -0.728111).  Saving model ...
Epoch: 4 cost time: 1.8989052772521973
Epoch: 4, Steps: 8 | Train Loss: 1.139 Vali Loss: 1.039 Vali Acc: 0.787 Test Loss: 1.039 Test Acc: 0.787
Validation loss decreased (-0.728111 --> -0.787490).  Saving model ...
Epoch: 5 cost time: 1.7701544761657715
Epoch: 5, Steps: 8 | Train Loss: 0.869 Vali Loss: 0.821 Vali Acc: 0.803 Test Loss: 0.821 Test Acc: 0.803
Validation loss decreased (-0.787490 --> -0.803117).  Saving model ...
Epoch: 6 cost time: 1.9887406826019287
Epoch: 6, Steps: 8 | Train Loss: 0.643 Vali Loss: 0.682 Vali Acc: 0.809 Test Loss: 0.682 Test Acc: 0.809
Validation loss decreased (-0.803117 --> -0.809368).  Saving model ...
Epoch: 7 cost time: 1.7662863731384277
Epoch: 7, Steps: 8 | Train Loss: 0.480 Vali Loss: 0.599 Vali Acc: 0.828 Test Loss: 0.599 Test Acc: 0.828
Validation loss decreased (-0.809368 --> -0.828119).  Saving model ...
Epoch: 8 cost time: 1.8541393280029297
Epoch: 8, Steps: 8 | Train Loss: 0.396 Vali Loss: 0.550 Vali Acc: 0.838 Test Loss: 0.550 Test Acc: 0.838
Validation loss decreased (-0.828119 --> -0.837495).  Saving model ...
Epoch: 9 cost time: 1.6856498718261719
Epoch: 9, Steps: 8 | Train Loss: 0.295 Vali Loss: 0.526 Vali Acc: 0.844 Test Loss: 0.526 Test Acc: 0.844
Validation loss decreased (-0.837495 --> -0.843745).  Saving model ...
Epoch: 10 cost time: 1.5388696193695068
Epoch: 10, Steps: 8 | Train Loss: 0.230 Vali Loss: 0.512 Vali Acc: 0.841 Test Loss: 0.512 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.940702199935913
Epoch: 11, Steps: 8 | Train Loss: 0.181 Vali Loss: 0.501 Vali Acc: 0.853 Test Loss: 0.501 Test Acc: 0.853
Validation loss decreased (-0.843745 --> -0.853120).  Saving model ...
Epoch: 12 cost time: 1.9551875591278076
Epoch: 12, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.524 Vali Acc: 0.841 Test Loss: 0.524 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8927814960479736
Epoch: 13, Steps: 8 | Train Loss: 0.114 Vali Loss: 0.537 Vali Acc: 0.844 Test Loss: 0.537 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.9441778659820557
Epoch: 14, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.527 Vali Acc: 0.850 Test Loss: 0.527 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.892406702041626
Epoch: 15, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.527 Vali Acc: 0.850 Test Loss: 0.527 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.821042537689209
Epoch: 16, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.530 Vali Acc: 0.850 Test Loss: 0.530 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.8856511116027832
Epoch: 17, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.539 Vali Acc: 0.850 Test Loss: 0.539 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.8113465309143066
Epoch: 18, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.544 Vali Acc: 0.847 Test Loss: 0.544 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.097135066986084
Epoch: 19, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.547 Vali Acc: 0.847 Test Loss: 0.547 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.9526619911193848
Epoch: 20, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.556 Vali Acc: 0.847 Test Loss: 0.556 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.900508165359497
Epoch: 21, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.556 Vali Acc: 0.847 Test Loss: 0.556 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 480440
model size : 2.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.555966377258301
Epoch: 1, Steps: 8 | Train Loss: 2.209 Vali Loss: 2.126 Vali Acc: 0.153 Test Loss: 2.126 Test Acc: 0.153
Validation loss decreased (inf --> -0.153104).  Saving model ...
Epoch: 2 cost time: 1.2338593006134033
Epoch: 2, Steps: 8 | Train Loss: 1.914 Vali Loss: 1.807 Vali Acc: 0.397 Test Loss: 1.807 Test Acc: 0.397
Validation loss decreased (-0.153104 --> -0.396857).  Saving model ...
Epoch: 3 cost time: 1.2330570220947266
Epoch: 3, Steps: 8 | Train Loss: 1.625 Vali Loss: 1.426 Vali Acc: 0.678 Test Loss: 1.426 Test Acc: 0.678
Validation loss decreased (-0.396857 --> -0.678111).  Saving model ...
Epoch: 4 cost time: 1.3113610744476318
Epoch: 4, Steps: 8 | Train Loss: 1.198 Vali Loss: 1.102 Vali Acc: 0.775 Test Loss: 1.102 Test Acc: 0.775
Validation loss decreased (-0.678111 --> -0.774989).  Saving model ...
Epoch: 5 cost time: 1.2567451000213623
Epoch: 5, Steps: 8 | Train Loss: 0.893 Vali Loss: 0.861 Vali Acc: 0.800 Test Loss: 0.861 Test Acc: 0.800
Validation loss decreased (-0.774989 --> -0.799991).  Saving model ...
Epoch: 6 cost time: 1.3171265125274658
Epoch: 6, Steps: 8 | Train Loss: 0.654 Vali Loss: 0.708 Vali Acc: 0.828 Test Loss: 0.708 Test Acc: 0.828
Validation loss decreased (-0.799991 --> -0.828118).  Saving model ...
Epoch: 7 cost time: 1.2667720317840576
Epoch: 7, Steps: 8 | Train Loss: 0.543 Vali Loss: 0.618 Vali Acc: 0.816 Test Loss: 0.618 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2700011730194092
Epoch: 8, Steps: 8 | Train Loss: 0.396 Vali Loss: 0.542 Vali Acc: 0.850 Test Loss: 0.542 Test Acc: 0.850
Validation loss decreased (-0.828118 --> -0.849995).  Saving model ...
Epoch: 9 cost time: 1.2023582458496094
Epoch: 9, Steps: 8 | Train Loss: 0.294 Vali Loss: 0.507 Vali Acc: 0.856 Test Loss: 0.507 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.856245).  Saving model ...
Epoch: 10 cost time: 1.195180892944336
Epoch: 10, Steps: 8 | Train Loss: 0.240 Vali Loss: 0.488 Vali Acc: 0.863 Test Loss: 0.488 Test Acc: 0.863
Validation loss decreased (-0.856245 --> -0.862495).  Saving model ...
Epoch: 11 cost time: 1.209031581878662
Epoch: 11, Steps: 8 | Train Loss: 0.173 Vali Loss: 0.479 Vali Acc: 0.859 Test Loss: 0.479 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2459485530853271
Epoch: 12, Steps: 8 | Train Loss: 0.137 Vali Loss: 0.473 Vali Acc: 0.863 Test Loss: 0.473 Test Acc: 0.863
Validation loss decreased (-0.862495 --> -0.862495).  Saving model ...
Epoch: 13 cost time: 1.189668893814087
Epoch: 13, Steps: 8 | Train Loss: 0.109 Vali Loss: 0.463 Vali Acc: 0.859 Test Loss: 0.463 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2309529781341553
Epoch: 14, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.452 Vali Acc: 0.863 Test Loss: 0.452 Test Acc: 0.863
Validation loss decreased (-0.862495 --> -0.862495).  Saving model ...
Epoch: 15 cost time: 1.291670322418213
Epoch: 15, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.473 Vali Acc: 0.859 Test Loss: 0.473 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2555596828460693
Epoch: 16, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.476 Vali Acc: 0.859 Test Loss: 0.476 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0303130149841309
Epoch: 17, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.479 Vali Acc: 0.863 Test Loss: 0.479 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2385520935058594
Epoch: 18, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.483 Vali Acc: 0.859 Test Loss: 0.483 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.31788969039917
Epoch: 19, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.489 Vali Acc: 0.859 Test Loss: 0.489 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.2017977237701416
Epoch: 20, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.494 Vali Acc: 0.859 Test Loss: 0.494 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.2402153015136719
Epoch: 21, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.500 Vali Acc: 0.859 Test Loss: 0.500 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.2061808109283447
Epoch: 22, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.507 Vali Acc: 0.863 Test Loss: 0.507 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.171814203262329
Epoch: 23, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.511 Vali Acc: 0.856 Test Loss: 0.511 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.2326741218566895
Epoch: 24, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.510 Vali Acc: 0.863 Test Loss: 0.510 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 169976
model size : 0.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.4771203994750977
Epoch: 1, Steps: 8 | Train Loss: 2.098 Vali Loss: 1.997 Vali Acc: 0.216 Test Loss: 1.997 Test Acc: 0.216
Validation loss decreased (inf --> -0.215605).  Saving model ...
Epoch: 2 cost time: 1.3117549419403076
Epoch: 2, Steps: 8 | Train Loss: 1.864 Vali Loss: 1.694 Vali Acc: 0.500 Test Loss: 1.694 Test Acc: 0.500
Validation loss decreased (-0.215605 --> -0.499983).  Saving model ...
Epoch: 3 cost time: 1.4372577667236328
Epoch: 3, Steps: 8 | Train Loss: 1.520 Vali Loss: 1.357 Vali Acc: 0.728 Test Loss: 1.357 Test Acc: 0.728
Validation loss decreased (-0.499983 --> -0.728111).  Saving model ...
Epoch: 4 cost time: 1.5351965427398682
Epoch: 4, Steps: 8 | Train Loss: 1.148 Vali Loss: 1.048 Vali Acc: 0.784 Test Loss: 1.048 Test Acc: 0.784
Validation loss decreased (-0.728111 --> -0.784365).  Saving model ...
Epoch: 5 cost time: 1.5231103897094727
Epoch: 5, Steps: 8 | Train Loss: 0.883 Vali Loss: 0.831 Vali Acc: 0.803 Test Loss: 0.831 Test Acc: 0.803
Validation loss decreased (-0.784365 --> -0.803117).  Saving model ...
Epoch: 6 cost time: 1.489598274230957
Epoch: 6, Steps: 8 | Train Loss: 0.658 Vali Loss: 0.692 Vali Acc: 0.812 Test Loss: 0.692 Test Acc: 0.812
Validation loss decreased (-0.803117 --> -0.812493).  Saving model ...
Epoch: 7 cost time: 1.4292457103729248
Epoch: 7, Steps: 8 | Train Loss: 0.497 Vali Loss: 0.610 Vali Acc: 0.828 Test Loss: 0.610 Test Acc: 0.828
Validation loss decreased (-0.812493 --> -0.828119).  Saving model ...
Epoch: 8 cost time: 1.6381335258483887
Epoch: 8, Steps: 8 | Train Loss: 0.416 Vali Loss: 0.562 Vali Acc: 0.834 Test Loss: 0.562 Test Acc: 0.834
Validation loss decreased (-0.828119 --> -0.834369).  Saving model ...
Epoch: 9 cost time: 1.5930795669555664
Epoch: 9, Steps: 8 | Train Loss: 0.323 Vali Loss: 0.541 Vali Acc: 0.831 Test Loss: 0.541 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6060502529144287
Epoch: 10, Steps: 8 | Train Loss: 0.257 Vali Loss: 0.531 Vali Acc: 0.828 Test Loss: 0.531 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5285072326660156
Epoch: 11, Steps: 8 | Train Loss: 0.204 Vali Loss: 0.522 Vali Acc: 0.838 Test Loss: 0.522 Test Acc: 0.838
Validation loss decreased (-0.834369 --> -0.837495).  Saving model ...
Epoch: 12 cost time: 1.6212098598480225
Epoch: 12, Steps: 8 | Train Loss: 0.153 Vali Loss: 0.549 Vali Acc: 0.838 Test Loss: 0.549 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4792077541351318
Epoch: 13, Steps: 8 | Train Loss: 0.137 Vali Loss: 0.563 Vali Acc: 0.834 Test Loss: 0.563 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4824042320251465
Epoch: 14, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.557 Vali Acc: 0.838 Test Loss: 0.557 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.515362024307251
Epoch: 15, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.557 Vali Acc: 0.838 Test Loss: 0.557 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2959060668945312
Epoch: 16, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.559 Vali Acc: 0.841 Test Loss: 0.559 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840619).  Saving model ...
Epoch: 17 cost time: 1.4939312934875488
Epoch: 17, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.570 Vali Acc: 0.841 Test Loss: 0.570 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6330163478851318
Epoch: 18, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.577 Vali Acc: 0.838 Test Loss: 0.577 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.6857640743255615
Epoch: 19, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.580 Vali Acc: 0.841 Test Loss: 0.580 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.5907433032989502
Epoch: 20, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.590 Vali Acc: 0.838 Test Loss: 0.590 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.7337570190429688
Epoch: 21, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.591 Vali Acc: 0.838 Test Loss: 0.591 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.6702139377593994
Epoch: 22, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.592 Vali Acc: 0.838 Test Loss: 0.592 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.5588774681091309
Epoch: 23, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.597 Vali Acc: 0.838 Test Loss: 0.597 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.671442985534668
Epoch: 24, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.595 Vali Acc: 0.838 Test Loss: 0.595 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.6224102973937988
Epoch: 25, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.607 Vali Acc: 0.838 Test Loss: 0.607 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.6628432273864746
Epoch: 26, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.630 Vali Acc: 0.838 Test Loss: 0.630 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.840625
model parameter : 480440
model size : 2.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.6047236919403076
Epoch: 1, Steps: 8 | Train Loss: 2.208 Vali Loss: 2.118 Vali Acc: 0.159 Test Loss: 2.118 Test Acc: 0.159
Validation loss decreased (inf --> -0.159354).  Saving model ...
Epoch: 2 cost time: 1.1619009971618652
Epoch: 2, Steps: 8 | Train Loss: 1.908 Vali Loss: 1.803 Vali Acc: 0.400 Test Loss: 1.803 Test Acc: 0.400
Validation loss decreased (-0.159354 --> -0.399982).  Saving model ...
Epoch: 3 cost time: 1.1538498401641846
Epoch: 3, Steps: 8 | Train Loss: 1.625 Vali Loss: 1.427 Vali Acc: 0.672 Test Loss: 1.427 Test Acc: 0.672
Validation loss decreased (-0.399982 --> -0.671861).  Saving model ...
Epoch: 4 cost time: 1.112577199935913
Epoch: 4, Steps: 8 | Train Loss: 1.200 Vali Loss: 1.107 Vali Acc: 0.762 Test Loss: 1.107 Test Acc: 0.762
Validation loss decreased (-0.671861 --> -0.762489).  Saving model ...
Epoch: 5 cost time: 1.1031110286712646
Epoch: 5, Steps: 8 | Train Loss: 0.900 Vali Loss: 0.869 Vali Acc: 0.797 Test Loss: 0.869 Test Acc: 0.797
Validation loss decreased (-0.762489 --> -0.796866).  Saving model ...
Epoch: 6 cost time: 1.1209206581115723
Epoch: 6, Steps: 8 | Train Loss: 0.668 Vali Loss: 0.718 Vali Acc: 0.822 Test Loss: 0.718 Test Acc: 0.822
Validation loss decreased (-0.796866 --> -0.821868).  Saving model ...
Epoch: 7 cost time: 1.0989317893981934
Epoch: 7, Steps: 8 | Train Loss: 0.559 Vali Loss: 0.630 Vali Acc: 0.819 Test Loss: 0.630 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.150191307067871
Epoch: 8, Steps: 8 | Train Loss: 0.414 Vali Loss: 0.556 Vali Acc: 0.853 Test Loss: 0.556 Test Acc: 0.853
Validation loss decreased (-0.821868 --> -0.853119).  Saving model ...
Epoch: 9 cost time: 1.105419397354126
Epoch: 9, Steps: 8 | Train Loss: 0.312 Vali Loss: 0.522 Vali Acc: 0.856 Test Loss: 0.522 Test Acc: 0.856
Validation loss decreased (-0.853119 --> -0.856245).  Saving model ...
Epoch: 10 cost time: 1.139725923538208
Epoch: 10, Steps: 8 | Train Loss: 0.262 Vali Loss: 0.503 Vali Acc: 0.863 Test Loss: 0.503 Test Acc: 0.863
Validation loss decreased (-0.856245 --> -0.862495).  Saving model ...
Epoch: 11 cost time: 1.2035853862762451
Epoch: 11, Steps: 8 | Train Loss: 0.196 Vali Loss: 0.498 Vali Acc: 0.863 Test Loss: 0.498 Test Acc: 0.863
Validation loss decreased (-0.862495 --> -0.862495).  Saving model ...
Epoch: 12 cost time: 1.1439907550811768
Epoch: 12, Steps: 8 | Train Loss: 0.156 Vali Loss: 0.493 Vali Acc: 0.869 Test Loss: 0.493 Test Acc: 0.869
Validation loss decreased (-0.862495 --> -0.868745).  Saving model ...
Epoch: 13 cost time: 1.1494450569152832
Epoch: 13, Steps: 8 | Train Loss: 0.121 Vali Loss: 0.483 Vali Acc: 0.869 Test Loss: 0.483 Test Acc: 0.869
Validation loss decreased (-0.868745 --> -0.868745).  Saving model ...
Epoch: 14 cost time: 1.2224857807159424
Epoch: 14, Steps: 8 | Train Loss: 0.108 Vali Loss: 0.471 Vali Acc: 0.872 Test Loss: 0.471 Test Acc: 0.872
Validation loss decreased (-0.868745 --> -0.871870).  Saving model ...
Epoch: 15 cost time: 1.142042875289917
Epoch: 15, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.492 Vali Acc: 0.863 Test Loss: 0.492 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1827600002288818
Epoch: 16, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.497 Vali Acc: 0.863 Test Loss: 0.497 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1036183834075928
Epoch: 17, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.499 Vali Acc: 0.866 Test Loss: 0.499 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1659572124481201
Epoch: 18, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.502 Vali Acc: 0.859 Test Loss: 0.502 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0960495471954346
Epoch: 19, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.507 Vali Acc: 0.859 Test Loss: 0.507 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.0939090251922607
Epoch: 20, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.508 Vali Acc: 0.866 Test Loss: 0.508 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.1451342105865479
Epoch: 21, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.513 Vali Acc: 0.859 Test Loss: 0.513 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.1112561225891113
Epoch: 22, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.523 Vali Acc: 0.859 Test Loss: 0.523 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.088197946548462
Epoch: 23, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.529 Vali Acc: 0.856 Test Loss: 0.529 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.1641604900360107
Epoch: 24, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.526 Vali Acc: 0.859 Test Loss: 0.526 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 169976
model size : 0.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.693292617797852
Epoch: 1, Steps: 8 | Train Loss: 2.186 Vali Loss: 2.121 Vali Acc: 0.188 Test Loss: 2.121 Test Acc: 0.188
Validation loss decreased (inf --> -0.187479).  Saving model ...
Epoch: 2 cost time: 4.275907039642334
Epoch: 2, Steps: 8 | Train Loss: 2.076 Vali Loss: 1.951 Vali Acc: 0.384 Test Loss: 1.951 Test Acc: 0.384
Validation loss decreased (-0.187479 --> -0.384355).  Saving model ...
Epoch: 3 cost time: 4.096717357635498
Epoch: 3, Steps: 8 | Train Loss: 1.848 Vali Loss: 1.724 Vali Acc: 0.528 Test Loss: 1.724 Test Acc: 0.528
Validation loss decreased (-0.384355 --> -0.528108).  Saving model ...
Epoch: 4 cost time: 3.880908727645874
Epoch: 4, Steps: 8 | Train Loss: 1.616 Vali Loss: 1.483 Vali Acc: 0.703 Test Loss: 1.483 Test Acc: 0.703
Validation loss decreased (-0.528108 --> -0.703110).  Saving model ...
Epoch: 5 cost time: 4.35057806968689
Epoch: 5, Steps: 8 | Train Loss: 1.348 Vali Loss: 1.235 Vali Acc: 0.753 Test Loss: 1.235 Test Acc: 0.753
Validation loss decreased (-0.703110 --> -0.753113).  Saving model ...
Epoch: 6 cost time: 4.295269250869751
Epoch: 6, Steps: 8 | Train Loss: 1.096 Vali Loss: 1.018 Vali Acc: 0.797 Test Loss: 1.018 Test Acc: 0.797
Validation loss decreased (-0.753113 --> -0.796865).  Saving model ...
Epoch: 7 cost time: 4.309455156326294
Epoch: 7, Steps: 8 | Train Loss: 0.899 Vali Loss: 0.843 Vali Acc: 0.794 Test Loss: 0.843 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.009029388427734
Epoch: 8, Steps: 8 | Train Loss: 0.725 Vali Loss: 0.721 Vali Acc: 0.803 Test Loss: 0.721 Test Acc: 0.803
Validation loss decreased (-0.796865 --> -0.803118).  Saving model ...
Epoch: 9 cost time: 3.9871199131011963
Epoch: 9, Steps: 8 | Train Loss: 0.550 Vali Loss: 0.639 Vali Acc: 0.822 Test Loss: 0.639 Test Acc: 0.822
Validation loss decreased (-0.803118 --> -0.821869).  Saving model ...
Epoch: 10 cost time: 3.9215128421783447
Epoch: 10, Steps: 8 | Train Loss: 0.453 Vali Loss: 0.581 Vali Acc: 0.828 Test Loss: 0.581 Test Acc: 0.828
Validation loss decreased (-0.821869 --> -0.828119).  Saving model ...
Epoch: 11 cost time: 4.358118057250977
Epoch: 11, Steps: 8 | Train Loss: 0.362 Vali Loss: 0.536 Vali Acc: 0.838 Test Loss: 0.536 Test Acc: 0.838
Validation loss decreased (-0.828119 --> -0.837495).  Saving model ...
Epoch: 12 cost time: 3.843304395675659
Epoch: 12, Steps: 8 | Train Loss: 0.333 Vali Loss: 0.512 Vali Acc: 0.838 Test Loss: 0.512 Test Acc: 0.838
Validation loss decreased (-0.837495 --> -0.837495).  Saving model ...
Epoch: 13 cost time: 3.835610866546631
Epoch: 13, Steps: 8 | Train Loss: 0.273 Vali Loss: 0.490 Vali Acc: 0.844 Test Loss: 0.490 Test Acc: 0.844
Validation loss decreased (-0.837495 --> -0.843745).  Saving model ...
Epoch: 14 cost time: 3.4350154399871826
Epoch: 14, Steps: 8 | Train Loss: 0.221 Vali Loss: 0.484 Vali Acc: 0.838 Test Loss: 0.484 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.561753988265991
Epoch: 15, Steps: 8 | Train Loss: 0.194 Vali Loss: 0.477 Vali Acc: 0.844 Test Loss: 0.477 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 16 cost time: 3.4960508346557617
Epoch: 16, Steps: 8 | Train Loss: 0.162 Vali Loss: 0.474 Vali Acc: 0.847 Test Loss: 0.474 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 17 cost time: 3.766413927078247
Epoch: 17, Steps: 8 | Train Loss: 0.135 Vali Loss: 0.463 Vali Acc: 0.856 Test Loss: 0.463 Test Acc: 0.856
Validation loss decreased (-0.846870 --> -0.856245).  Saving model ...
Epoch: 18 cost time: 3.850238800048828
Epoch: 18, Steps: 8 | Train Loss: 0.130 Vali Loss: 0.459 Vali Acc: 0.856 Test Loss: 0.459 Test Acc: 0.856
Validation loss decreased (-0.856245 --> -0.856245).  Saving model ...
Epoch: 19 cost time: 3.735778570175171
Epoch: 19, Steps: 8 | Train Loss: 0.110 Vali Loss: 0.456 Vali Acc: 0.850 Test Loss: 0.456 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.6905109882354736
Epoch: 20, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.455 Vali Acc: 0.859 Test Loss: 0.455 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 21 cost time: 3.7330574989318848
Epoch: 21, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.458 Vali Acc: 0.856 Test Loss: 0.458 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.6215736865997314
Epoch: 22, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.456 Vali Acc: 0.856 Test Loss: 0.456 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.7637853622436523
Epoch: 23, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.459 Vali Acc: 0.856 Test Loss: 0.459 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.881085157394409
Epoch: 24, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.464 Vali Acc: 0.856 Test Loss: 0.464 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.8012571334838867
Epoch: 25, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.464 Vali Acc: 0.863 Test Loss: 0.464 Test Acc: 0.863
Validation loss decreased (-0.859370 --> -0.862495).  Saving model ...
Epoch: 26 cost time: 3.6752095222473145
Epoch: 26, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.464 Vali Acc: 0.866 Test Loss: 0.464 Test Acc: 0.866
Validation loss decreased (-0.862495 --> -0.865620).  Saving model ...
Epoch: 27 cost time: 3.6309657096862793
Epoch: 27, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.464 Vali Acc: 0.866 Test Loss: 0.464 Test Acc: 0.866
Validation loss decreased (-0.865620 --> -0.865620).  Saving model ...
Epoch: 28 cost time: 3.689422607421875
Epoch: 28, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.472 Vali Acc: 0.863 Test Loss: 0.472 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.8887288570404053
Epoch: 29, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.480 Vali Acc: 0.856 Test Loss: 0.480 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.846799850463867
Epoch: 30, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.483 Vali Acc: 0.859 Test Loss: 0.483 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 900176
model size : 3.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.091521263122559
Epoch: 1, Steps: 8 | Train Loss: 2.150 Vali Loss: 2.070 Vali Acc: 0.159 Test Loss: 2.070 Test Acc: 0.159
Validation loss decreased (inf --> -0.159354).  Saving model ...
Epoch: 2 cost time: 2.553614616394043
Epoch: 2, Steps: 8 | Train Loss: 2.046 Vali Loss: 1.945 Vali Acc: 0.287 Test Loss: 1.945 Test Acc: 0.287
Validation loss decreased (-0.159354 --> -0.287481).  Saving model ...
Epoch: 3 cost time: 2.510261297225952
Epoch: 3, Steps: 8 | Train Loss: 1.907 Vali Loss: 1.780 Vali Acc: 0.541 Test Loss: 1.780 Test Acc: 0.541
Validation loss decreased (-0.287481 --> -0.540607).  Saving model ...
Epoch: 4 cost time: 2.4596643447875977
Epoch: 4, Steps: 8 | Train Loss: 1.725 Vali Loss: 1.589 Vali Acc: 0.684 Test Loss: 1.589 Test Acc: 0.684
Validation loss decreased (-0.540607 --> -0.684359).  Saving model ...
Epoch: 5 cost time: 2.502980947494507
Epoch: 5, Steps: 8 | Train Loss: 1.482 Vali Loss: 1.382 Vali Acc: 0.784 Test Loss: 1.382 Test Acc: 0.784
Validation loss decreased (-0.684359 --> -0.784361).  Saving model ...
Epoch: 6 cost time: 2.405155897140503
Epoch: 6, Steps: 8 | Train Loss: 1.264 Vali Loss: 1.176 Vali Acc: 0.809 Test Loss: 1.176 Test Acc: 0.809
Validation loss decreased (-0.784361 --> -0.809363).  Saving model ...
Epoch: 7 cost time: 2.463229179382324
Epoch: 7, Steps: 8 | Train Loss: 1.058 Vali Loss: 0.996 Vali Acc: 0.822 Test Loss: 0.996 Test Acc: 0.822
Validation loss decreased (-0.809363 --> -0.821865).  Saving model ...
Epoch: 8 cost time: 2.6207923889160156
Epoch: 8, Steps: 8 | Train Loss: 0.888 Vali Loss: 0.845 Vali Acc: 0.816 Test Loss: 0.845 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.5208683013916016
Epoch: 9, Steps: 8 | Train Loss: 0.702 Vali Loss: 0.726 Vali Acc: 0.822 Test Loss: 0.726 Test Acc: 0.822
Validation loss decreased (-0.821865 --> -0.821868).  Saving model ...
Epoch: 10 cost time: 2.3938608169555664
Epoch: 10, Steps: 8 | Train Loss: 0.560 Vali Loss: 0.644 Vali Acc: 0.822 Test Loss: 0.644 Test Acc: 0.822
Validation loss decreased (-0.821868 --> -0.821869).  Saving model ...
Epoch: 11 cost time: 2.4613301753997803
Epoch: 11, Steps: 8 | Train Loss: 0.472 Vali Loss: 0.591 Vali Acc: 0.825 Test Loss: 0.591 Test Acc: 0.825
Validation loss decreased (-0.821869 --> -0.824994).  Saving model ...
Epoch: 12 cost time: 2.3245270252227783
Epoch: 12, Steps: 8 | Train Loss: 0.405 Vali Loss: 0.556 Vali Acc: 0.822 Test Loss: 0.556 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.2895493507385254
Epoch: 13, Steps: 8 | Train Loss: 0.333 Vali Loss: 0.530 Vali Acc: 0.831 Test Loss: 0.530 Test Acc: 0.831
Validation loss decreased (-0.824994 --> -0.831245).  Saving model ...
Epoch: 14 cost time: 2.393232822418213
Epoch: 14, Steps: 8 | Train Loss: 0.279 Vali Loss: 0.516 Vali Acc: 0.838 Test Loss: 0.516 Test Acc: 0.838
Validation loss decreased (-0.831245 --> -0.837495).  Saving model ...
Epoch: 15 cost time: 2.454054117202759
Epoch: 15, Steps: 8 | Train Loss: 0.241 Vali Loss: 0.501 Vali Acc: 0.838 Test Loss: 0.501 Test Acc: 0.838
Validation loss decreased (-0.837495 --> -0.837495).  Saving model ...
Epoch: 16 cost time: 2.524513006210327
Epoch: 16, Steps: 8 | Train Loss: 0.197 Vali Loss: 0.498 Vali Acc: 0.841 Test Loss: 0.498 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 17 cost time: 2.46752667427063
Epoch: 17, Steps: 8 | Train Loss: 0.169 Vali Loss: 0.492 Vali Acc: 0.841 Test Loss: 0.492 Test Acc: 0.841
Validation loss decreased (-0.840620 --> -0.840620).  Saving model ...
Epoch: 18 cost time: 2.36352801322937
Epoch: 18, Steps: 8 | Train Loss: 0.147 Vali Loss: 0.482 Vali Acc: 0.853 Test Loss: 0.482 Test Acc: 0.853
Validation loss decreased (-0.840620 --> -0.853120).  Saving model ...
Epoch: 19 cost time: 2.4134888648986816
Epoch: 19, Steps: 8 | Train Loss: 0.132 Vali Loss: 0.478 Vali Acc: 0.844 Test Loss: 0.478 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.3685147762298584
Epoch: 20, Steps: 8 | Train Loss: 0.118 Vali Loss: 0.479 Vali Acc: 0.850 Test Loss: 0.479 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.3620846271514893
Epoch: 21, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.483 Vali Acc: 0.847 Test Loss: 0.483 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.5334346294403076
Epoch: 22, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.489 Vali Acc: 0.847 Test Loss: 0.489 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.832761764526367
Epoch: 23, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.495 Vali Acc: 0.847 Test Loss: 0.495 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.797276258468628
Epoch: 24, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.504 Vali Acc: 0.847 Test Loss: 0.504 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.8290882110595703
Epoch: 25, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.505 Vali Acc: 0.847 Test Loss: 0.505 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.6475682258605957
Epoch: 26, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.507 Vali Acc: 0.841 Test Loss: 0.507 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.659595012664795
Epoch: 27, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.518 Vali Acc: 0.831 Test Loss: 0.518 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.6835782527923584
Epoch: 28, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.527 Vali Acc: 0.841 Test Loss: 0.527 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 279200
model size : 1.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.504684209823608
Epoch: 1, Steps: 8 | Train Loss: 2.186 Vali Loss: 2.122 Vali Acc: 0.188 Test Loss: 2.122 Test Acc: 0.188
Validation loss decreased (inf --> -0.187479).  Saving model ...
Epoch: 2 cost time: 3.3257317543029785
Epoch: 2, Steps: 8 | Train Loss: 2.076 Vali Loss: 1.954 Vali Acc: 0.375 Test Loss: 1.954 Test Acc: 0.375
Validation loss decreased (-0.187479 --> -0.374980).  Saving model ...
Epoch: 3 cost time: 3.4359145164489746
Epoch: 3, Steps: 8 | Train Loss: 1.849 Vali Loss: 1.730 Vali Acc: 0.519 Test Loss: 1.730 Test Acc: 0.519
Validation loss decreased (-0.374980 --> -0.518733).  Saving model ...
Epoch: 4 cost time: 3.2333950996398926
Epoch: 4, Steps: 8 | Train Loss: 1.619 Vali Loss: 1.492 Vali Acc: 0.709 Test Loss: 1.492 Test Acc: 0.709
Validation loss decreased (-0.518733 --> -0.709360).  Saving model ...
Epoch: 5 cost time: 3.270857334136963
Epoch: 5, Steps: 8 | Train Loss: 1.351 Vali Loss: 1.246 Vali Acc: 0.753 Test Loss: 1.246 Test Acc: 0.753
Validation loss decreased (-0.709360 --> -0.753113).  Saving model ...
Epoch: 6 cost time: 3.2521300315856934
Epoch: 6, Steps: 8 | Train Loss: 1.099 Vali Loss: 1.030 Vali Acc: 0.794 Test Loss: 1.030 Test Acc: 0.794
Validation loss decreased (-0.753113 --> -0.793740).  Saving model ...
Epoch: 7 cost time: 3.4020678997039795
Epoch: 7, Steps: 8 | Train Loss: 0.901 Vali Loss: 0.855 Vali Acc: 0.797 Test Loss: 0.855 Test Acc: 0.797
Validation loss decreased (-0.793740 --> -0.796866).  Saving model ...
Epoch: 8 cost time: 3.210181951522827
Epoch: 8, Steps: 8 | Train Loss: 0.730 Vali Loss: 0.732 Vali Acc: 0.803 Test Loss: 0.732 Test Acc: 0.803
Validation loss decreased (-0.796866 --> -0.803118).  Saving model ...
Epoch: 9 cost time: 3.3674991130828857
Epoch: 9, Steps: 8 | Train Loss: 0.551 Vali Loss: 0.650 Vali Acc: 0.816 Test Loss: 0.650 Test Acc: 0.816
Validation loss decreased (-0.803118 --> -0.815618).  Saving model ...
Epoch: 10 cost time: 3.200042963027954
Epoch: 10, Steps: 8 | Train Loss: 0.452 Vali Loss: 0.593 Vali Acc: 0.831 Test Loss: 0.593 Test Acc: 0.831
Validation loss decreased (-0.815618 --> -0.831244).  Saving model ...
Epoch: 11 cost time: 3.2231903076171875
Epoch: 11, Steps: 8 | Train Loss: 0.364 Vali Loss: 0.548 Vali Acc: 0.838 Test Loss: 0.548 Test Acc: 0.838
Validation loss decreased (-0.831244 --> -0.837495).  Saving model ...
Epoch: 12 cost time: 3.264516830444336
Epoch: 12, Steps: 8 | Train Loss: 0.341 Vali Loss: 0.526 Vali Acc: 0.834 Test Loss: 0.526 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.2327237129211426
Epoch: 13, Steps: 8 | Train Loss: 0.278 Vali Loss: 0.502 Vali Acc: 0.841 Test Loss: 0.502 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 14 cost time: 3.3725059032440186
Epoch: 14, Steps: 8 | Train Loss: 0.220 Vali Loss: 0.494 Vali Acc: 0.841 Test Loss: 0.494 Test Acc: 0.841
Validation loss decreased (-0.840620 --> -0.840620).  Saving model ...
Epoch: 15 cost time: 3.307091474533081
Epoch: 15, Steps: 8 | Train Loss: 0.196 Vali Loss: 0.484 Vali Acc: 0.847 Test Loss: 0.484 Test Acc: 0.847
Validation loss decreased (-0.840620 --> -0.846870).  Saving model ...
Epoch: 16 cost time: 3.4319241046905518
Epoch: 16, Steps: 8 | Train Loss: 0.168 Vali Loss: 0.478 Vali Acc: 0.850 Test Loss: 0.478 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 17 cost time: 3.283613443374634
Epoch: 17, Steps: 8 | Train Loss: 0.135 Vali Loss: 0.467 Vali Acc: 0.859 Test Loss: 0.467 Test Acc: 0.859
Validation loss decreased (-0.849995 --> -0.859370).  Saving model ...
Epoch: 18 cost time: 3.3677659034729004
Epoch: 18, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.465 Vali Acc: 0.859 Test Loss: 0.465 Test Acc: 0.859
Validation loss decreased (-0.859370 --> -0.859370).  Saving model ...
Epoch: 19 cost time: 3.1737284660339355
Epoch: 19, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.461 Vali Acc: 0.859 Test Loss: 0.461 Test Acc: 0.859
Validation loss decreased (-0.859370 --> -0.859370).  Saving model ...
Epoch: 20 cost time: 3.3871195316314697
Epoch: 20, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.460 Vali Acc: 0.856 Test Loss: 0.460 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.4335830211639404
Epoch: 21, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.465 Vali Acc: 0.856 Test Loss: 0.465 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.2097442150115967
Epoch: 22, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.467 Vali Acc: 0.850 Test Loss: 0.467 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.3406245708465576
Epoch: 23, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.470 Vali Acc: 0.853 Test Loss: 0.470 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.2889444828033447
Epoch: 24, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.474 Vali Acc: 0.856 Test Loss: 0.474 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.2674636840820312
Epoch: 25, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.473 Vali Acc: 0.866 Test Loss: 0.473 Test Acc: 0.866
Validation loss decreased (-0.859370 --> -0.865620).  Saving model ...
Epoch: 26 cost time: 3.0845937728881836
Epoch: 26, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.472 Vali Acc: 0.866 Test Loss: 0.472 Test Acc: 0.866
Validation loss decreased (-0.865620 --> -0.865620).  Saving model ...
Epoch: 27 cost time: 3.4460031986236572
Epoch: 27, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.471 Vali Acc: 0.859 Test Loss: 0.471 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.2103402614593506
Epoch: 28, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.479 Vali Acc: 0.859 Test Loss: 0.479 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.3420615196228027
Epoch: 29, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.488 Vali Acc: 0.859 Test Loss: 0.488 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.1586081981658936
Epoch: 30, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.489 Vali Acc: 0.859 Test Loss: 0.489 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 900176
model size : 3.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.3731353282928467
Epoch: 1, Steps: 8 | Train Loss: 2.157 Vali Loss: 2.070 Vali Acc: 0.159 Test Loss: 2.070 Test Acc: 0.159
Validation loss decreased (inf --> -0.159354).  Saving model ...
Epoch: 2 cost time: 2.107064962387085
Epoch: 2, Steps: 8 | Train Loss: 2.054 Vali Loss: 1.946 Vali Acc: 0.284 Test Loss: 1.946 Test Acc: 0.284
Validation loss decreased (-0.159354 --> -0.284356).  Saving model ...
Epoch: 3 cost time: 2.0989181995391846
Epoch: 3, Steps: 8 | Train Loss: 1.916 Vali Loss: 1.783 Vali Acc: 0.537 Test Loss: 1.783 Test Acc: 0.537
Validation loss decreased (-0.284356 --> -0.537482).  Saving model ...
Epoch: 4 cost time: 2.1394107341766357
Epoch: 4, Steps: 8 | Train Loss: 1.745 Vali Loss: 1.593 Vali Acc: 0.681 Test Loss: 1.593 Test Acc: 0.681
Validation loss decreased (-0.537482 --> -0.681234).  Saving model ...
Epoch: 5 cost time: 2.155883550643921
Epoch: 5, Steps: 8 | Train Loss: 1.511 Vali Loss: 1.386 Vali Acc: 0.781 Test Loss: 1.386 Test Acc: 0.781
Validation loss decreased (-0.681234 --> -0.781236).  Saving model ...
Epoch: 6 cost time: 2.024193048477173
Epoch: 6, Steps: 8 | Train Loss: 1.292 Vali Loss: 1.178 Vali Acc: 0.819 Test Loss: 1.178 Test Acc: 0.819
Validation loss decreased (-0.781236 --> -0.818738).  Saving model ...
Epoch: 7 cost time: 2.158057451248169
Epoch: 7, Steps: 8 | Train Loss: 1.088 Vali Loss: 1.001 Vali Acc: 0.816 Test Loss: 1.001 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.1813597679138184
Epoch: 8, Steps: 8 | Train Loss: 0.904 Vali Loss: 0.847 Vali Acc: 0.819 Test Loss: 0.847 Test Acc: 0.819
Validation loss decreased (-0.818738 --> -0.818742).  Saving model ...
Epoch: 9 cost time: 2.0337419509887695
Epoch: 9, Steps: 8 | Train Loss: 0.716 Vali Loss: 0.728 Vali Acc: 0.822 Test Loss: 0.728 Test Acc: 0.822
Validation loss decreased (-0.818742 --> -0.821868).  Saving model ...
Epoch: 10 cost time: 2.1376824378967285
Epoch: 10, Steps: 8 | Train Loss: 0.574 Vali Loss: 0.645 Vali Acc: 0.819 Test Loss: 0.645 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9222705364227295
Epoch: 11, Steps: 8 | Train Loss: 0.481 Vali Loss: 0.592 Vali Acc: 0.822 Test Loss: 0.592 Test Acc: 0.822
Validation loss decreased (-0.821868 --> -0.821869).  Saving model ...
Epoch: 12 cost time: 1.9549062252044678
Epoch: 12, Steps: 8 | Train Loss: 0.400 Vali Loss: 0.560 Vali Acc: 0.828 Test Loss: 0.560 Test Acc: 0.828
Validation loss decreased (-0.821869 --> -0.828119).  Saving model ...
Epoch: 13 cost time: 1.9794838428497314
Epoch: 13, Steps: 8 | Train Loss: 0.329 Vali Loss: 0.536 Vali Acc: 0.838 Test Loss: 0.536 Test Acc: 0.838
Validation loss decreased (-0.828119 --> -0.837495).  Saving model ...
Epoch: 14 cost time: 1.9332640171051025
Epoch: 14, Steps: 8 | Train Loss: 0.272 Vali Loss: 0.523 Vali Acc: 0.838 Test Loss: 0.523 Test Acc: 0.838
Validation loss decreased (-0.837495 --> -0.837495).  Saving model ...
Epoch: 15 cost time: 2.110757827758789
Epoch: 15, Steps: 8 | Train Loss: 0.231 Vali Loss: 0.510 Vali Acc: 0.841 Test Loss: 0.510 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 16 cost time: 2.0124528408050537
Epoch: 16, Steps: 8 | Train Loss: 0.186 Vali Loss: 0.511 Vali Acc: 0.834 Test Loss: 0.511 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7652294635772705
Epoch: 17, Steps: 8 | Train Loss: 0.161 Vali Loss: 0.507 Vali Acc: 0.838 Test Loss: 0.507 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.152116537094116
Epoch: 18, Steps: 8 | Train Loss: 0.136 Vali Loss: 0.499 Vali Acc: 0.841 Test Loss: 0.499 Test Acc: 0.841
Validation loss decreased (-0.840620 --> -0.840620).  Saving model ...
Epoch: 19 cost time: 2.0785560607910156
Epoch: 19, Steps: 8 | Train Loss: 0.122 Vali Loss: 0.495 Vali Acc: 0.844 Test Loss: 0.495 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 20 cost time: 2.160914182662964
Epoch: 20, Steps: 8 | Train Loss: 0.109 Vali Loss: 0.494 Vali Acc: 0.841 Test Loss: 0.494 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.293123483657837
Epoch: 21, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.498 Vali Acc: 0.841 Test Loss: 0.498 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.237396717071533
Epoch: 22, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.503 Vali Acc: 0.844 Test Loss: 0.503 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.3822038173675537
Epoch: 23, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.512 Vali Acc: 0.834 Test Loss: 0.512 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.1251065731048584
Epoch: 24, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.521 Vali Acc: 0.844 Test Loss: 0.521 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.0953710079193115
Epoch: 25, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.527 Vali Acc: 0.841 Test Loss: 0.527 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.137148380279541
Epoch: 26, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.526 Vali Acc: 0.844 Test Loss: 0.526 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.050469398498535
Epoch: 27, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.528 Vali Acc: 0.844 Test Loss: 0.528 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.0520787239074707
Epoch: 28, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.540 Vali Acc: 0.841 Test Loss: 0.540 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.0819027423858643
Epoch: 29, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.544 Vali Acc: 0.838 Test Loss: 0.544 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 279200
model size : 1.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.2677698135375977
Epoch: 1, Steps: 8 | Train Loss: 2.186 Vali Loss: 2.124 Vali Acc: 0.184 Test Loss: 2.124 Test Acc: 0.184
Validation loss decreased (inf --> -0.184354).  Saving model ...
Epoch: 2 cost time: 1.7539808750152588
Epoch: 2, Steps: 8 | Train Loss: 2.078 Vali Loss: 1.959 Vali Acc: 0.366 Test Loss: 1.959 Test Acc: 0.366
Validation loss decreased (-0.184354 --> -0.365605).  Saving model ...
Epoch: 3 cost time: 1.7202582359313965
Epoch: 3, Steps: 8 | Train Loss: 1.856 Vali Loss: 1.738 Vali Acc: 0.522 Test Loss: 1.738 Test Acc: 0.522
Validation loss decreased (-0.365605 --> -0.521858).  Saving model ...
Epoch: 4 cost time: 1.8322551250457764
Epoch: 4, Steps: 8 | Train Loss: 1.631 Vali Loss: 1.505 Vali Acc: 0.703 Test Loss: 1.505 Test Acc: 0.703
Validation loss decreased (-0.521858 --> -0.703110).  Saving model ...
Epoch: 5 cost time: 1.8628332614898682
Epoch: 5, Steps: 8 | Train Loss: 1.369 Vali Loss: 1.262 Vali Acc: 0.741 Test Loss: 1.262 Test Acc: 0.741
Validation loss decreased (-0.703110 --> -0.740612).  Saving model ...
Epoch: 6 cost time: 1.7988123893737793
Epoch: 6, Steps: 8 | Train Loss: 1.124 Vali Loss: 1.047 Vali Acc: 0.787 Test Loss: 1.047 Test Acc: 0.787
Validation loss decreased (-0.740612 --> -0.787490).  Saving model ...
Epoch: 7 cost time: 1.8007986545562744
Epoch: 7, Steps: 8 | Train Loss: 0.926 Vali Loss: 0.872 Vali Acc: 0.797 Test Loss: 0.872 Test Acc: 0.797
Validation loss decreased (-0.787490 --> -0.796866).  Saving model ...
Epoch: 8 cost time: 1.8774964809417725
Epoch: 8, Steps: 8 | Train Loss: 0.763 Vali Loss: 0.747 Vali Acc: 0.806 Test Loss: 0.747 Test Acc: 0.806
Validation loss decreased (-0.796866 --> -0.806243).  Saving model ...
Epoch: 9 cost time: 1.8503227233886719
Epoch: 9, Steps: 8 | Train Loss: 0.581 Vali Loss: 0.666 Vali Acc: 0.812 Test Loss: 0.666 Test Acc: 0.812
Validation loss decreased (-0.806243 --> -0.812493).  Saving model ...
Epoch: 10 cost time: 1.7681224346160889
Epoch: 10, Steps: 8 | Train Loss: 0.484 Vali Loss: 0.606 Vali Acc: 0.825 Test Loss: 0.606 Test Acc: 0.825
Validation loss decreased (-0.812493 --> -0.824994).  Saving model ...
Epoch: 11 cost time: 1.8275573253631592
Epoch: 11, Steps: 8 | Train Loss: 0.408 Vali Loss: 0.562 Vali Acc: 0.828 Test Loss: 0.562 Test Acc: 0.828
Validation loss decreased (-0.824994 --> -0.828119).  Saving model ...
Epoch: 12 cost time: 1.734468936920166
Epoch: 12, Steps: 8 | Train Loss: 0.379 Vali Loss: 0.541 Vali Acc: 0.831 Test Loss: 0.541 Test Acc: 0.831
Validation loss decreased (-0.828119 --> -0.831245).  Saving model ...
Epoch: 13 cost time: 1.6717545986175537
Epoch: 13, Steps: 8 | Train Loss: 0.307 Vali Loss: 0.524 Vali Acc: 0.825 Test Loss: 0.524 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7632710933685303
Epoch: 14, Steps: 8 | Train Loss: 0.250 Vali Loss: 0.523 Vali Acc: 0.831 Test Loss: 0.523 Test Acc: 0.831
Validation loss decreased (-0.831245 --> -0.831245).  Saving model ...
Epoch: 15 cost time: 1.7291271686553955
Epoch: 15, Steps: 8 | Train Loss: 0.224 Vali Loss: 0.517 Vali Acc: 0.834 Test Loss: 0.517 Test Acc: 0.834
Validation loss decreased (-0.831245 --> -0.834370).  Saving model ...
Epoch: 16 cost time: 1.757197618484497
Epoch: 16, Steps: 8 | Train Loss: 0.189 Vali Loss: 0.516 Vali Acc: 0.838 Test Loss: 0.516 Test Acc: 0.838
Validation loss decreased (-0.834370 --> -0.837495).  Saving model ...
Epoch: 17 cost time: 1.7835073471069336
Epoch: 17, Steps: 8 | Train Loss: 0.155 Vali Loss: 0.505 Vali Acc: 0.853 Test Loss: 0.505 Test Acc: 0.853
Validation loss decreased (-0.837495 --> -0.853120).  Saving model ...
Epoch: 18 cost time: 1.744870901107788
Epoch: 18, Steps: 8 | Train Loss: 0.150 Vali Loss: 0.501 Vali Acc: 0.847 Test Loss: 0.501 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7040936946868896
Epoch: 19, Steps: 8 | Train Loss: 0.124 Vali Loss: 0.503 Vali Acc: 0.838 Test Loss: 0.503 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.714282512664795
Epoch: 20, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.502 Vali Acc: 0.844 Test Loss: 0.502 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.7177972793579102
Epoch: 21, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.507 Vali Acc: 0.838 Test Loss: 0.507 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.7039382457733154
Epoch: 22, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.509 Vali Acc: 0.844 Test Loss: 0.509 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.7394351959228516
Epoch: 23, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.514 Vali Acc: 0.841 Test Loss: 0.514 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.8586359024047852
Epoch: 24, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.519 Vali Acc: 0.834 Test Loss: 0.519 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.8239083290100098
Epoch: 25, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.514 Vali Acc: 0.847 Test Loss: 0.514 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.7406291961669922
Epoch: 26, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.514 Vali Acc: 0.850 Test Loss: 0.514 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.7720897197723389
Epoch: 27, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.518 Vali Acc: 0.841 Test Loss: 0.518 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 900176
model size : 3.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.634727716445923
Epoch: 1, Steps: 8 | Train Loss: 2.158 Vali Loss: 2.070 Vali Acc: 0.159 Test Loss: 2.070 Test Acc: 0.159
Validation loss decreased (inf --> -0.159354).  Saving model ...
Epoch: 2 cost time: 1.1451904773712158
Epoch: 2, Steps: 8 | Train Loss: 2.055 Vali Loss: 1.950 Vali Acc: 0.275 Test Loss: 1.950 Test Acc: 0.275
Validation loss decreased (-0.159354 --> -0.274980).  Saving model ...
Epoch: 3 cost time: 1.158290147781372
Epoch: 3, Steps: 8 | Train Loss: 1.931 Vali Loss: 1.793 Vali Acc: 0.522 Test Loss: 1.793 Test Acc: 0.522
Validation loss decreased (-0.274980 --> -0.521857).  Saving model ...
Epoch: 4 cost time: 1.126096487045288
Epoch: 4, Steps: 8 | Train Loss: 1.761 Vali Loss: 1.610 Vali Acc: 0.662 Test Loss: 1.610 Test Acc: 0.662
Validation loss decreased (-0.521857 --> -0.662484).  Saving model ...
Epoch: 5 cost time: 1.1799230575561523
Epoch: 5, Steps: 8 | Train Loss: 1.533 Vali Loss: 1.409 Vali Acc: 0.766 Test Loss: 1.409 Test Acc: 0.766
Validation loss decreased (-0.662484 --> -0.765611).  Saving model ...
Epoch: 6 cost time: 1.1352837085723877
Epoch: 6, Steps: 8 | Train Loss: 1.318 Vali Loss: 1.204 Vali Acc: 0.803 Test Loss: 1.204 Test Acc: 0.803
Validation loss decreased (-0.765611 --> -0.803113).  Saving model ...
Epoch: 7 cost time: 1.1713972091674805
Epoch: 7, Steps: 8 | Train Loss: 1.113 Vali Loss: 1.023 Vali Acc: 0.809 Test Loss: 1.023 Test Acc: 0.809
Validation loss decreased (-0.803113 --> -0.809365).  Saving model ...
Epoch: 8 cost time: 1.2569961547851562
Epoch: 8, Steps: 8 | Train Loss: 0.928 Vali Loss: 0.867 Vali Acc: 0.800 Test Loss: 0.867 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2822132110595703
Epoch: 9, Steps: 8 | Train Loss: 0.745 Vali Loss: 0.749 Vali Acc: 0.806 Test Loss: 0.749 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2509119510650635
Epoch: 10, Steps: 8 | Train Loss: 0.601 Vali Loss: 0.669 Vali Acc: 0.797 Test Loss: 0.669 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.235095739364624
Epoch: 11, Steps: 8 | Train Loss: 0.509 Vali Loss: 0.618 Vali Acc: 0.803 Test Loss: 0.618 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3043365478515625
Epoch: 12, Steps: 8 | Train Loss: 0.433 Vali Loss: 0.590 Vali Acc: 0.812 Test Loss: 0.590 Test Acc: 0.812
Validation loss decreased (-0.809365 --> -0.812494).  Saving model ...
Epoch: 13 cost time: 1.2500956058502197
Epoch: 13, Steps: 8 | Train Loss: 0.369 Vali Loss: 0.569 Vali Acc: 0.819 Test Loss: 0.569 Test Acc: 0.819
Validation loss decreased (-0.812494 --> -0.818744).  Saving model ...
Epoch: 14 cost time: 1.3784959316253662
Epoch: 14, Steps: 8 | Train Loss: 0.308 Vali Loss: 0.558 Vali Acc: 0.822 Test Loss: 0.558 Test Acc: 0.822
Validation loss decreased (-0.818744 --> -0.821869).  Saving model ...
Epoch: 15 cost time: 1.3184492588043213
Epoch: 15, Steps: 8 | Train Loss: 0.274 Vali Loss: 0.547 Vali Acc: 0.819 Test Loss: 0.547 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2867772579193115
Epoch: 16, Steps: 8 | Train Loss: 0.219 Vali Loss: 0.551 Vali Acc: 0.816 Test Loss: 0.551 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0973505973815918
Epoch: 17, Steps: 8 | Train Loss: 0.187 Vali Loss: 0.548 Vali Acc: 0.819 Test Loss: 0.548 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3236992359161377
Epoch: 18, Steps: 8 | Train Loss: 0.161 Vali Loss: 0.540 Vali Acc: 0.825 Test Loss: 0.540 Test Acc: 0.825
Validation loss decreased (-0.821869 --> -0.824995).  Saving model ...
Epoch: 19 cost time: 1.302156925201416
Epoch: 19, Steps: 8 | Train Loss: 0.144 Vali Loss: 0.537 Vali Acc: 0.834 Test Loss: 0.537 Test Acc: 0.834
Validation loss decreased (-0.824995 --> -0.834370).  Saving model ...
Epoch: 20 cost time: 1.342588186264038
Epoch: 20, Steps: 8 | Train Loss: 0.126 Vali Loss: 0.537 Vali Acc: 0.825 Test Loss: 0.537 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3029043674468994
Epoch: 21, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.539 Vali Acc: 0.838 Test Loss: 0.539 Test Acc: 0.838
Validation loss decreased (-0.834370 --> -0.837495).  Saving model ...
Epoch: 22 cost time: 1.2890918254852295
Epoch: 22, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.548 Vali Acc: 0.831 Test Loss: 0.548 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3117082118988037
Epoch: 23, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.562 Vali Acc: 0.831 Test Loss: 0.562 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.2512028217315674
Epoch: 24, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.571 Vali Acc: 0.838 Test Loss: 0.571 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.3495090007781982
Epoch: 25, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.574 Vali Acc: 0.831 Test Loss: 0.574 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.2445108890533447
Epoch: 26, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.574 Vali Acc: 0.838 Test Loss: 0.574 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.2535552978515625
Epoch: 27, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.575 Vali Acc: 0.838 Test Loss: 0.575 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.2554218769073486
Epoch: 28, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.586 Vali Acc: 0.841 Test Loss: 0.586 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840619).  Saving model ...
Epoch: 29 cost time: 1.2883682250976562
Epoch: 29, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.592 Vali Acc: 0.841 Test Loss: 0.592 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.2226111888885498
Epoch: 30, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.594 Vali Acc: 0.838 Test Loss: 0.594 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.840625
model parameter : 279200
model size : 1.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.170022010803223
Epoch: 1, Steps: 8 | Train Loss: 2.067 Vali Loss: 1.998 Vali Acc: 0.322 Test Loss: 1.998 Test Acc: 0.322
Validation loss decreased (inf --> -0.321855).  Saving model ...
Epoch: 2 cost time: 2.7511494159698486
Epoch: 2, Steps: 8 | Train Loss: 1.921 Vali Loss: 1.856 Vali Acc: 0.422 Test Loss: 1.856 Test Acc: 0.422
Validation loss decreased (-0.321855 --> -0.421856).  Saving model ...
Epoch: 3 cost time: 2.6768476963043213
Epoch: 3, Steps: 8 | Train Loss: 1.721 Vali Loss: 1.671 Vali Acc: 0.534 Test Loss: 1.671 Test Acc: 0.534
Validation loss decreased (-0.421856 --> -0.534358).  Saving model ...
Epoch: 4 cost time: 2.5682015419006348
Epoch: 4, Steps: 8 | Train Loss: 1.527 Vali Loss: 1.470 Vali Acc: 0.637 Test Loss: 1.470 Test Acc: 0.637
Validation loss decreased (-0.534358 --> -0.637485).  Saving model ...
Epoch: 5 cost time: 2.8131816387176514
Epoch: 5, Steps: 8 | Train Loss: 1.335 Vali Loss: 1.279 Vali Acc: 0.719 Test Loss: 1.279 Test Acc: 0.719
Validation loss decreased (-0.637485 --> -0.718737).  Saving model ...
Epoch: 6 cost time: 2.713928461074829
Epoch: 6, Steps: 8 | Train Loss: 1.123 Vali Loss: 1.101 Vali Acc: 0.753 Test Loss: 1.101 Test Acc: 0.753
Validation loss decreased (-0.718737 --> -0.753114).  Saving model ...
Epoch: 7 cost time: 2.6921002864837646
Epoch: 7, Steps: 8 | Train Loss: 0.917 Vali Loss: 0.951 Vali Acc: 0.781 Test Loss: 0.951 Test Acc: 0.781
Validation loss decreased (-0.753114 --> -0.781240).  Saving model ...
Epoch: 8 cost time: 2.749666929244995
Epoch: 8, Steps: 8 | Train Loss: 0.758 Vali Loss: 0.832 Vali Acc: 0.800 Test Loss: 0.832 Test Acc: 0.800
Validation loss decreased (-0.781240 --> -0.799992).  Saving model ...
Epoch: 9 cost time: 2.745253562927246
Epoch: 9, Steps: 8 | Train Loss: 0.620 Vali Loss: 0.745 Vali Acc: 0.816 Test Loss: 0.745 Test Acc: 0.816
Validation loss decreased (-0.799992 --> -0.815618).  Saving model ...
Epoch: 10 cost time: 2.5190346240997314
Epoch: 10, Steps: 8 | Train Loss: 0.513 Vali Loss: 0.668 Vali Acc: 0.825 Test Loss: 0.668 Test Acc: 0.825
Validation loss decreased (-0.815618 --> -0.824993).  Saving model ...
Epoch: 11 cost time: 2.6081347465515137
Epoch: 11, Steps: 8 | Train Loss: 0.430 Vali Loss: 0.610 Vali Acc: 0.838 Test Loss: 0.610 Test Acc: 0.838
Validation loss decreased (-0.824993 --> -0.837494).  Saving model ...
Epoch: 12 cost time: 2.576521873474121
Epoch: 12, Steps: 8 | Train Loss: 0.345 Vali Loss: 0.573 Vali Acc: 0.831 Test Loss: 0.573 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.570650339126587
Epoch: 13, Steps: 8 | Train Loss: 0.267 Vali Loss: 0.540 Vali Acc: 0.828 Test Loss: 0.540 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.6794683933258057
Epoch: 14, Steps: 8 | Train Loss: 0.229 Vali Loss: 0.520 Vali Acc: 0.834 Test Loss: 0.520 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.7352182865142822
Epoch: 15, Steps: 8 | Train Loss: 0.202 Vali Loss: 0.512 Vali Acc: 0.841 Test Loss: 0.512 Test Acc: 0.841
Validation loss decreased (-0.837494 --> -0.840620).  Saving model ...
Epoch: 16 cost time: 2.702035903930664
Epoch: 16, Steps: 8 | Train Loss: 0.168 Vali Loss: 0.508 Vali Acc: 0.838 Test Loss: 0.508 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.692548990249634
Epoch: 17, Steps: 8 | Train Loss: 0.167 Vali Loss: 0.498 Vali Acc: 0.847 Test Loss: 0.498 Test Acc: 0.847
Validation loss decreased (-0.840620 --> -0.846870).  Saving model ...
Epoch: 18 cost time: 2.524681568145752
Epoch: 18, Steps: 8 | Train Loss: 0.142 Vali Loss: 0.487 Vali Acc: 0.847 Test Loss: 0.487 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 19 cost time: 2.523498773574829
Epoch: 19, Steps: 8 | Train Loss: 0.116 Vali Loss: 0.485 Vali Acc: 0.850 Test Loss: 0.485 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 20 cost time: 2.665898084640503
Epoch: 20, Steps: 8 | Train Loss: 0.108 Vali Loss: 0.484 Vali Acc: 0.850 Test Loss: 0.484 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 21 cost time: 2.7031989097595215
Epoch: 21, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.488 Vali Acc: 0.853 Test Loss: 0.488 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 22 cost time: 2.653656244277954
Epoch: 22, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.498 Vali Acc: 0.850 Test Loss: 0.498 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.631849765777588
Epoch: 23, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.495 Vali Acc: 0.853 Test Loss: 0.495 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.6068103313446045
Epoch: 24, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.495 Vali Acc: 0.853 Test Loss: 0.495 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.4551849365234375
Epoch: 25, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.510 Vali Acc: 0.853 Test Loss: 0.510 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.529101610183716
Epoch: 26, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.518 Vali Acc: 0.853 Test Loss: 0.518 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.6008408069610596
Epoch: 27, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.512 Vali Acc: 0.853 Test Loss: 0.512 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.6466662883758545
Epoch: 28, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.523 Vali Acc: 0.847 Test Loss: 0.523 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.540576934814453
Epoch: 29, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.542 Vali Acc: 0.847 Test Loss: 0.542 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.716224193572998
Epoch: 30, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.546 Vali Acc: 0.856 Test Loss: 0.546 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 460304
model size : 1.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.244933843612671
Epoch: 1, Steps: 8 | Train Loss: 2.053 Vali Loss: 2.011 Vali Acc: 0.181 Test Loss: 2.011 Test Acc: 0.181
Validation loss decreased (inf --> -0.181230).  Saving model ...
Epoch: 2 cost time: 1.7093098163604736
Epoch: 2, Steps: 8 | Train Loss: 2.005 Vali Loss: 1.859 Vali Acc: 0.322 Test Loss: 1.859 Test Acc: 0.322
Validation loss decreased (-0.181230 --> -0.321856).  Saving model ...
Epoch: 3 cost time: 1.7815368175506592
Epoch: 3, Steps: 8 | Train Loss: 1.798 Vali Loss: 1.652 Vali Acc: 0.578 Test Loss: 1.652 Test Acc: 0.578
Validation loss decreased (-0.321856 --> -0.578108).  Saving model ...
Epoch: 4 cost time: 1.705233097076416
Epoch: 4, Steps: 8 | Train Loss: 1.587 Vali Loss: 1.429 Vali Acc: 0.738 Test Loss: 1.429 Test Acc: 0.738
Validation loss decreased (-0.578108 --> -0.737486).  Saving model ...
Epoch: 5 cost time: 1.6975388526916504
Epoch: 5, Steps: 8 | Train Loss: 1.320 Vali Loss: 1.216 Vali Acc: 0.781 Test Loss: 1.216 Test Acc: 0.781
Validation loss decreased (-0.737486 --> -0.781238).  Saving model ...
Epoch: 6 cost time: 1.673626184463501
Epoch: 6, Steps: 8 | Train Loss: 1.117 Vali Loss: 1.022 Vali Acc: 0.806 Test Loss: 1.022 Test Acc: 0.806
Validation loss decreased (-0.781238 --> -0.806240).  Saving model ...
Epoch: 7 cost time: 1.6975574493408203
Epoch: 7, Steps: 8 | Train Loss: 0.896 Vali Loss: 0.858 Vali Acc: 0.816 Test Loss: 0.858 Test Acc: 0.816
Validation loss decreased (-0.806240 --> -0.815616).  Saving model ...
Epoch: 8 cost time: 1.4894781112670898
Epoch: 8, Steps: 8 | Train Loss: 0.741 Vali Loss: 0.735 Vali Acc: 0.822 Test Loss: 0.735 Test Acc: 0.822
Validation loss decreased (-0.815616 --> -0.821868).  Saving model ...
Epoch: 9 cost time: 1.5332410335540771
Epoch: 9, Steps: 8 | Train Loss: 0.589 Vali Loss: 0.644 Vali Acc: 0.844 Test Loss: 0.644 Test Acc: 0.844
Validation loss decreased (-0.821868 --> -0.843744).  Saving model ...
Epoch: 10 cost time: 1.152369737625122
Epoch: 10, Steps: 8 | Train Loss: 0.489 Vali Loss: 0.587 Vali Acc: 0.844 Test Loss: 0.587 Test Acc: 0.844
Validation loss decreased (-0.843744 --> -0.843744).  Saving model ...
Epoch: 11 cost time: 1.547926425933838
Epoch: 11, Steps: 8 | Train Loss: 0.384 Vali Loss: 0.541 Vali Acc: 0.853 Test Loss: 0.541 Test Acc: 0.853
Validation loss decreased (-0.843744 --> -0.853120).  Saving model ...
Epoch: 12 cost time: 1.5904648303985596
Epoch: 12, Steps: 8 | Train Loss: 0.324 Vali Loss: 0.518 Vali Acc: 0.844 Test Loss: 0.518 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5647995471954346
Epoch: 13, Steps: 8 | Train Loss: 0.266 Vali Loss: 0.499 Vali Acc: 0.847 Test Loss: 0.499 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6713457107543945
Epoch: 14, Steps: 8 | Train Loss: 0.236 Vali Loss: 0.485 Vali Acc: 0.850 Test Loss: 0.485 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.4938757419586182
Epoch: 15, Steps: 8 | Train Loss: 0.202 Vali Loss: 0.482 Vali Acc: 0.850 Test Loss: 0.482 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.534013271331787
Epoch: 16, Steps: 8 | Train Loss: 0.171 Vali Loss: 0.484 Vali Acc: 0.844 Test Loss: 0.484 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.6221885681152344
Epoch: 17, Steps: 8 | Train Loss: 0.146 Vali Loss: 0.480 Vali Acc: 0.844 Test Loss: 0.480 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.523688793182373
Epoch: 18, Steps: 8 | Train Loss: 0.149 Vali Loss: 0.474 Vali Acc: 0.850 Test Loss: 0.474 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.561880350112915
Epoch: 19, Steps: 8 | Train Loss: 0.122 Vali Loss: 0.480 Vali Acc: 0.847 Test Loss: 0.480 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.5973412990570068
Epoch: 20, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.481 Vali Acc: 0.850 Test Loss: 0.481 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.6037564277648926
Epoch: 21, Steps: 8 | Train Loss: 0.099 Vali Loss: 0.483 Vali Acc: 0.841 Test Loss: 0.483 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 149792
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.633591413497925
Epoch: 1, Steps: 8 | Train Loss: 2.070 Vali Loss: 1.998 Vali Acc: 0.328 Test Loss: 1.998 Test Acc: 0.328
Validation loss decreased (inf --> -0.328105).  Saving model ...
Epoch: 2 cost time: 2.0813262462615967
Epoch: 2, Steps: 8 | Train Loss: 1.925 Vali Loss: 1.858 Vali Acc: 0.419 Test Loss: 1.858 Test Acc: 0.419
Validation loss decreased (-0.328105 --> -0.418731).  Saving model ...
Epoch: 3 cost time: 2.1194117069244385
Epoch: 3, Steps: 8 | Train Loss: 1.726 Vali Loss: 1.676 Vali Acc: 0.525 Test Loss: 1.676 Test Acc: 0.525
Validation loss decreased (-0.418731 --> -0.524983).  Saving model ...
Epoch: 4 cost time: 1.9818644523620605
Epoch: 4, Steps: 8 | Train Loss: 1.532 Vali Loss: 1.477 Vali Acc: 0.641 Test Loss: 1.477 Test Acc: 0.641
Validation loss decreased (-0.524983 --> -0.640610).  Saving model ...
Epoch: 5 cost time: 2.1373629570007324
Epoch: 5, Steps: 8 | Train Loss: 1.343 Vali Loss: 1.288 Vali Acc: 0.713 Test Loss: 1.288 Test Acc: 0.713
Validation loss decreased (-0.640610 --> -0.712487).  Saving model ...
Epoch: 6 cost time: 2.071746587753296
Epoch: 6, Steps: 8 | Train Loss: 1.135 Vali Loss: 1.116 Vali Acc: 0.747 Test Loss: 1.116 Test Acc: 0.747
Validation loss decreased (-0.712487 --> -0.746864).  Saving model ...
Epoch: 7 cost time: 2.018441915512085
Epoch: 7, Steps: 8 | Train Loss: 0.927 Vali Loss: 0.967 Vali Acc: 0.772 Test Loss: 0.967 Test Acc: 0.772
Validation loss decreased (-0.746864 --> -0.771865).  Saving model ...
Epoch: 8 cost time: 2.0575857162475586
Epoch: 8, Steps: 8 | Train Loss: 0.771 Vali Loss: 0.850 Vali Acc: 0.806 Test Loss: 0.850 Test Acc: 0.806
Validation loss decreased (-0.771865 --> -0.806241).  Saving model ...
Epoch: 9 cost time: 1.9930777549743652
Epoch: 9, Steps: 8 | Train Loss: 0.631 Vali Loss: 0.767 Vali Acc: 0.816 Test Loss: 0.767 Test Acc: 0.816
Validation loss decreased (-0.806241 --> -0.815617).  Saving model ...
Epoch: 10 cost time: 2.074052095413208
Epoch: 10, Steps: 8 | Train Loss: 0.527 Vali Loss: 0.691 Vali Acc: 0.822 Test Loss: 0.691 Test Acc: 0.822
Validation loss decreased (-0.815617 --> -0.821868).  Saving model ...
Epoch: 11 cost time: 2.013639450073242
Epoch: 11, Steps: 8 | Train Loss: 0.439 Vali Loss: 0.635 Vali Acc: 0.822 Test Loss: 0.635 Test Acc: 0.822
Validation loss decreased (-0.821868 --> -0.821869).  Saving model ...
Epoch: 12 cost time: 2.1376116275787354
Epoch: 12, Steps: 8 | Train Loss: 0.351 Vali Loss: 0.598 Vali Acc: 0.825 Test Loss: 0.598 Test Acc: 0.825
Validation loss decreased (-0.821869 --> -0.824994).  Saving model ...
Epoch: 13 cost time: 2.1559672355651855
Epoch: 13, Steps: 8 | Train Loss: 0.278 Vali Loss: 0.565 Vali Acc: 0.825 Test Loss: 0.565 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 14 cost time: 2.094313621520996
Epoch: 14, Steps: 8 | Train Loss: 0.250 Vali Loss: 0.549 Vali Acc: 0.831 Test Loss: 0.549 Test Acc: 0.831
Validation loss decreased (-0.824994 --> -0.831245).  Saving model ...
Epoch: 15 cost time: 2.0609946250915527
Epoch: 15, Steps: 8 | Train Loss: 0.206 Vali Loss: 0.539 Vali Acc: 0.828 Test Loss: 0.539 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.0637001991271973
Epoch: 16, Steps: 8 | Train Loss: 0.168 Vali Loss: 0.534 Vali Acc: 0.834 Test Loss: 0.534 Test Acc: 0.834
Validation loss decreased (-0.831245 --> -0.834370).  Saving model ...
Epoch: 17 cost time: 2.0705251693725586
Epoch: 17, Steps: 8 | Train Loss: 0.161 Vali Loss: 0.521 Vali Acc: 0.841 Test Loss: 0.521 Test Acc: 0.841
Validation loss decreased (-0.834370 --> -0.840620).  Saving model ...
Epoch: 18 cost time: 1.8103511333465576
Epoch: 18, Steps: 8 | Train Loss: 0.139 Vali Loss: 0.508 Vali Acc: 0.844 Test Loss: 0.508 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 19 cost time: 2.0987050533294678
Epoch: 19, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.510 Vali Acc: 0.844 Test Loss: 0.510 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.0491626262664795
Epoch: 20, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.506 Vali Acc: 0.844 Test Loss: 0.506 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 21 cost time: 1.9531207084655762
Epoch: 21, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.517 Vali Acc: 0.847 Test Loss: 0.517 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 22 cost time: 1.9503297805786133
Epoch: 22, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.529 Vali Acc: 0.853 Test Loss: 0.529 Test Acc: 0.853
Validation loss decreased (-0.846870 --> -0.853120).  Saving model ...
Epoch: 23 cost time: 1.9061710834503174
Epoch: 23, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.525 Vali Acc: 0.847 Test Loss: 0.525 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.9564964771270752
Epoch: 24, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.524 Vali Acc: 0.850 Test Loss: 0.524 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.9278168678283691
Epoch: 25, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.537 Vali Acc: 0.850 Test Loss: 0.537 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.15572190284729
Epoch: 26, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.544 Vali Acc: 0.850 Test Loss: 0.544 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.144148111343384
Epoch: 27, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.541 Vali Acc: 0.853 Test Loss: 0.541 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.1068217754364014
Epoch: 28, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.549 Vali Acc: 0.850 Test Loss: 0.549 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.6865873336791992
Epoch: 29, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.567 Vali Acc: 0.844 Test Loss: 0.567 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.973663091659546
Epoch: 30, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.576 Vali Acc: 0.841 Test Loss: 0.576 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 460304
model size : 1.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.782158613204956
Epoch: 1, Steps: 8 | Train Loss: 2.050 Vali Loss: 2.014 Vali Acc: 0.178 Test Loss: 2.014 Test Acc: 0.178
Validation loss decreased (inf --> -0.178105).  Saving model ...
Epoch: 2 cost time: 1.4189672470092773
Epoch: 2, Steps: 8 | Train Loss: 2.005 Vali Loss: 1.864 Vali Acc: 0.319 Test Loss: 1.864 Test Acc: 0.319
Validation loss decreased (-0.178105 --> -0.318731).  Saving model ...
Epoch: 3 cost time: 1.3781955242156982
Epoch: 3, Steps: 8 | Train Loss: 1.795 Vali Loss: 1.659 Vali Acc: 0.578 Test Loss: 1.659 Test Acc: 0.578
Validation loss decreased (-0.318731 --> -0.578108).  Saving model ...
Epoch: 4 cost time: 1.35516357421875
Epoch: 4, Steps: 8 | Train Loss: 1.587 Vali Loss: 1.439 Vali Acc: 0.731 Test Loss: 1.439 Test Acc: 0.731
Validation loss decreased (-0.578108 --> -0.731236).  Saving model ...
Epoch: 5 cost time: 1.354396104812622
Epoch: 5, Steps: 8 | Train Loss: 1.324 Vali Loss: 1.228 Vali Acc: 0.778 Test Loss: 1.228 Test Acc: 0.778
Validation loss decreased (-0.731236 --> -0.778113).  Saving model ...
Epoch: 6 cost time: 1.3722689151763916
Epoch: 6, Steps: 8 | Train Loss: 1.123 Vali Loss: 1.037 Vali Acc: 0.806 Test Loss: 1.037 Test Acc: 0.806
Validation loss decreased (-0.778113 --> -0.806240).  Saving model ...
Epoch: 7 cost time: 1.2962720394134521
Epoch: 7, Steps: 8 | Train Loss: 0.900 Vali Loss: 0.874 Vali Acc: 0.816 Test Loss: 0.874 Test Acc: 0.816
Validation loss decreased (-0.806240 --> -0.815616).  Saving model ...
Epoch: 8 cost time: 1.4603958129882812
Epoch: 8, Steps: 8 | Train Loss: 0.748 Vali Loss: 0.754 Vali Acc: 0.812 Test Loss: 0.754 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4814960956573486
Epoch: 9, Steps: 8 | Train Loss: 0.590 Vali Loss: 0.661 Vali Acc: 0.841 Test Loss: 0.661 Test Acc: 0.841
Validation loss decreased (-0.815616 --> -0.840618).  Saving model ...
Epoch: 10 cost time: 1.1359071731567383
Epoch: 10, Steps: 8 | Train Loss: 0.495 Vali Loss: 0.604 Vali Acc: 0.841 Test Loss: 0.604 Test Acc: 0.841
Validation loss decreased (-0.840618 --> -0.840619).  Saving model ...
Epoch: 11 cost time: 1.541515827178955
Epoch: 11, Steps: 8 | Train Loss: 0.391 Vali Loss: 0.559 Vali Acc: 0.856 Test Loss: 0.559 Test Acc: 0.856
Validation loss decreased (-0.840619 --> -0.856244).  Saving model ...
Epoch: 12 cost time: 1.5656366348266602
Epoch: 12, Steps: 8 | Train Loss: 0.326 Vali Loss: 0.535 Vali Acc: 0.841 Test Loss: 0.535 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6230969429016113
Epoch: 13, Steps: 8 | Train Loss: 0.273 Vali Loss: 0.516 Vali Acc: 0.847 Test Loss: 0.516 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5944819450378418
Epoch: 14, Steps: 8 | Train Loss: 0.242 Vali Loss: 0.502 Vali Acc: 0.847 Test Loss: 0.502 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5334324836730957
Epoch: 15, Steps: 8 | Train Loss: 0.206 Vali Loss: 0.498 Vali Acc: 0.847 Test Loss: 0.498 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.5312690734863281
Epoch: 16, Steps: 8 | Train Loss: 0.175 Vali Loss: 0.498 Vali Acc: 0.847 Test Loss: 0.498 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.5441691875457764
Epoch: 17, Steps: 8 | Train Loss: 0.152 Vali Loss: 0.495 Vali Acc: 0.847 Test Loss: 0.495 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.4930572509765625
Epoch: 18, Steps: 8 | Train Loss: 0.156 Vali Loss: 0.490 Vali Acc: 0.847 Test Loss: 0.490 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.5438768863677979
Epoch: 19, Steps: 8 | Train Loss: 0.128 Vali Loss: 0.498 Vali Acc: 0.850 Test Loss: 0.498 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.6437737941741943
Epoch: 20, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.500 Vali Acc: 0.847 Test Loss: 0.500 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.569821834564209
Epoch: 21, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.501 Vali Acc: 0.841 Test Loss: 0.501 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 149792
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.473414182662964
Epoch: 1, Steps: 8 | Train Loss: 2.070 Vali Loss: 1.998 Vali Acc: 0.325 Test Loss: 1.998 Test Acc: 0.325
Validation loss decreased (inf --> -0.324980).  Saving model ...
Epoch: 2 cost time: 1.1268882751464844
Epoch: 2, Steps: 8 | Train Loss: 1.926 Vali Loss: 1.861 Vali Acc: 0.419 Test Loss: 1.861 Test Acc: 0.419
Validation loss decreased (-0.324980 --> -0.418731).  Saving model ...
Epoch: 3 cost time: 1.082864761352539
Epoch: 3, Steps: 8 | Train Loss: 1.731 Vali Loss: 1.682 Vali Acc: 0.516 Test Loss: 1.682 Test Acc: 0.516
Validation loss decreased (-0.418731 --> -0.515608).  Saving model ...
Epoch: 4 cost time: 1.085308313369751
Epoch: 4, Steps: 8 | Train Loss: 1.542 Vali Loss: 1.489 Vali Acc: 0.641 Test Loss: 1.489 Test Acc: 0.641
Validation loss decreased (-0.515608 --> -0.640610).  Saving model ...
Epoch: 5 cost time: 1.5951790809631348
Epoch: 5, Steps: 8 | Train Loss: 1.353 Vali Loss: 1.304 Vali Acc: 0.703 Test Loss: 1.304 Test Acc: 0.703
Validation loss decreased (-0.640610 --> -0.703112).  Saving model ...
Epoch: 6 cost time: 1.550419807434082
Epoch: 6, Steps: 8 | Train Loss: 1.147 Vali Loss: 1.132 Vali Acc: 0.747 Test Loss: 1.132 Test Acc: 0.747
Validation loss decreased (-0.703112 --> -0.746864).  Saving model ...
Epoch: 7 cost time: 1.547623634338379
Epoch: 7, Steps: 8 | Train Loss: 0.947 Vali Loss: 0.985 Vali Acc: 0.778 Test Loss: 0.985 Test Acc: 0.778
Validation loss decreased (-0.746864 --> -0.778115).  Saving model ...
Epoch: 8 cost time: 1.6291499137878418
Epoch: 8, Steps: 8 | Train Loss: 0.794 Vali Loss: 0.870 Vali Acc: 0.797 Test Loss: 0.870 Test Acc: 0.797
Validation loss decreased (-0.778115 --> -0.796866).  Saving model ...
Epoch: 9 cost time: 1.5839977264404297
Epoch: 9, Steps: 8 | Train Loss: 0.656 Vali Loss: 0.786 Vali Acc: 0.809 Test Loss: 0.786 Test Acc: 0.809
Validation loss decreased (-0.796866 --> -0.809367).  Saving model ...
Epoch: 10 cost time: 1.6574151515960693
Epoch: 10, Steps: 8 | Train Loss: 0.563 Vali Loss: 0.713 Vali Acc: 0.806 Test Loss: 0.713 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5731916427612305
Epoch: 11, Steps: 8 | Train Loss: 0.480 Vali Loss: 0.657 Vali Acc: 0.825 Test Loss: 0.657 Test Acc: 0.825
Validation loss decreased (-0.809367 --> -0.824993).  Saving model ...
Epoch: 12 cost time: 1.6103334426879883
Epoch: 12, Steps: 8 | Train Loss: 0.397 Vali Loss: 0.619 Vali Acc: 0.828 Test Loss: 0.619 Test Acc: 0.828
Validation loss decreased (-0.824993 --> -0.828119).  Saving model ...
Epoch: 13 cost time: 1.6712439060211182
Epoch: 13, Steps: 8 | Train Loss: 0.320 Vali Loss: 0.584 Vali Acc: 0.834 Test Loss: 0.584 Test Acc: 0.834
Validation loss decreased (-0.828119 --> -0.834369).  Saving model ...
Epoch: 14 cost time: 1.636037826538086
Epoch: 14, Steps: 8 | Train Loss: 0.276 Vali Loss: 0.561 Vali Acc: 0.841 Test Loss: 0.561 Test Acc: 0.841
Validation loss decreased (-0.834369 --> -0.840619).  Saving model ...
Epoch: 15 cost time: 1.609325885772705
Epoch: 15, Steps: 8 | Train Loss: 0.241 Vali Loss: 0.553 Vali Acc: 0.834 Test Loss: 0.553 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5894544124603271
Epoch: 16, Steps: 8 | Train Loss: 0.194 Vali Loss: 0.548 Vali Acc: 0.828 Test Loss: 0.548 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.6183655261993408
Epoch: 17, Steps: 8 | Train Loss: 0.188 Vali Loss: 0.536 Vali Acc: 0.841 Test Loss: 0.536 Test Acc: 0.841
Validation loss decreased (-0.840619 --> -0.840620).  Saving model ...
Epoch: 18 cost time: 1.6291673183441162
Epoch: 18, Steps: 8 | Train Loss: 0.165 Vali Loss: 0.525 Vali Acc: 0.841 Test Loss: 0.525 Test Acc: 0.841
Validation loss decreased (-0.840620 --> -0.840620).  Saving model ...
Epoch: 19 cost time: 1.4917852878570557
Epoch: 19, Steps: 8 | Train Loss: 0.140 Vali Loss: 0.529 Vali Acc: 0.841 Test Loss: 0.529 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5628714561462402
Epoch: 20, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.523 Vali Acc: 0.844 Test Loss: 0.523 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 21 cost time: 1.5256638526916504
Epoch: 21, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.535 Vali Acc: 0.844 Test Loss: 0.535 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4848182201385498
Epoch: 22, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.546 Vali Acc: 0.847 Test Loss: 0.546 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 23 cost time: 1.4721300601959229
Epoch: 23, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.543 Vali Acc: 0.841 Test Loss: 0.543 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5207817554473877
Epoch: 24, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.544 Vali Acc: 0.841 Test Loss: 0.544 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.4130568504333496
Epoch: 25, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.556 Vali Acc: 0.850 Test Loss: 0.556 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849994).  Saving model ...
Epoch: 26 cost time: 1.4199321269989014
Epoch: 26, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.563 Vali Acc: 0.844 Test Loss: 0.563 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.4288504123687744
Epoch: 27, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.557 Vali Acc: 0.847 Test Loss: 0.557 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.5595879554748535
Epoch: 28, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.564 Vali Acc: 0.844 Test Loss: 0.564 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.4915802478790283
Epoch: 29, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.579 Vali Acc: 0.841 Test Loss: 0.579 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.491288423538208
Epoch: 30, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.585 Vali Acc: 0.841 Test Loss: 0.585 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 460304
model size : 1.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.781273603439331
Epoch: 1, Steps: 8 | Train Loss: 2.048 Vali Loss: 2.013 Vali Acc: 0.175 Test Loss: 2.013 Test Acc: 0.175
Validation loss decreased (inf --> -0.174980).  Saving model ...
Epoch: 2 cost time: 1.2092671394348145
Epoch: 2, Steps: 8 | Train Loss: 2.010 Vali Loss: 1.865 Vali Acc: 0.334 Test Loss: 1.865 Test Acc: 0.334
Validation loss decreased (-0.174980 --> -0.334356).  Saving model ...
Epoch: 3 cost time: 1.176537275314331
Epoch: 3, Steps: 8 | Train Loss: 1.800 Vali Loss: 1.665 Vali Acc: 0.578 Test Loss: 1.665 Test Acc: 0.578
Validation loss decreased (-0.334356 --> -0.578108).  Saving model ...
Epoch: 4 cost time: 1.2119226455688477
Epoch: 4, Steps: 8 | Train Loss: 1.601 Vali Loss: 1.448 Vali Acc: 0.725 Test Loss: 1.448 Test Acc: 0.725
Validation loss decreased (-0.578108 --> -0.724986).  Saving model ...
Epoch: 5 cost time: 1.204535961151123
Epoch: 5, Steps: 8 | Train Loss: 1.340 Vali Loss: 1.241 Vali Acc: 0.781 Test Loss: 1.241 Test Acc: 0.781
Validation loss decreased (-0.724986 --> -0.781238).  Saving model ...
Epoch: 6 cost time: 1.2375755310058594
Epoch: 6, Steps: 8 | Train Loss: 1.143 Vali Loss: 1.052 Vali Acc: 0.806 Test Loss: 1.052 Test Acc: 0.806
Validation loss decreased (-0.781238 --> -0.806239).  Saving model ...
Epoch: 7 cost time: 1.1961722373962402
Epoch: 7, Steps: 8 | Train Loss: 0.921 Vali Loss: 0.889 Vali Acc: 0.819 Test Loss: 0.889 Test Acc: 0.819
Validation loss decreased (-0.806239 --> -0.818741).  Saving model ...
Epoch: 8 cost time: 1.2268216609954834
Epoch: 8, Steps: 8 | Train Loss: 0.775 Vali Loss: 0.767 Vali Acc: 0.809 Test Loss: 0.767 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.194934606552124
Epoch: 9, Steps: 8 | Train Loss: 0.615 Vali Loss: 0.671 Vali Acc: 0.831 Test Loss: 0.671 Test Acc: 0.831
Validation loss decreased (-0.818741 --> -0.831243).  Saving model ...
Epoch: 10 cost time: 1.1827235221862793
Epoch: 10, Steps: 8 | Train Loss: 0.520 Vali Loss: 0.610 Vali Acc: 0.834 Test Loss: 0.610 Test Acc: 0.834
Validation loss decreased (-0.831243 --> -0.834369).  Saving model ...
Epoch: 11 cost time: 1.1375818252563477
Epoch: 11, Steps: 8 | Train Loss: 0.419 Vali Loss: 0.562 Vali Acc: 0.844 Test Loss: 0.562 Test Acc: 0.844
Validation loss decreased (-0.834369 --> -0.843744).  Saving model ...
Epoch: 12 cost time: 1.1784112453460693
Epoch: 12, Steps: 8 | Train Loss: 0.355 Vali Loss: 0.536 Vali Acc: 0.841 Test Loss: 0.536 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.183281421661377
Epoch: 13, Steps: 8 | Train Loss: 0.307 Vali Loss: 0.519 Vali Acc: 0.841 Test Loss: 0.519 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.071826696395874
Epoch: 14, Steps: 8 | Train Loss: 0.270 Vali Loss: 0.507 Vali Acc: 0.850 Test Loss: 0.507 Test Acc: 0.850
Validation loss decreased (-0.843744 --> -0.849995).  Saving model ...
Epoch: 15 cost time: 1.1341137886047363
Epoch: 15, Steps: 8 | Train Loss: 0.236 Vali Loss: 0.503 Vali Acc: 0.847 Test Loss: 0.503 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.139040470123291
Epoch: 16, Steps: 8 | Train Loss: 0.202 Vali Loss: 0.500 Vali Acc: 0.847 Test Loss: 0.500 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1742265224456787
Epoch: 17, Steps: 8 | Train Loss: 0.173 Vali Loss: 0.493 Vali Acc: 0.850 Test Loss: 0.493 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 18 cost time: 1.202470064163208
Epoch: 18, Steps: 8 | Train Loss: 0.179 Vali Loss: 0.487 Vali Acc: 0.847 Test Loss: 0.487 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.109442949295044
Epoch: 19, Steps: 8 | Train Loss: 0.144 Vali Loss: 0.491 Vali Acc: 0.850 Test Loss: 0.491 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 20 cost time: 1.1418201923370361
Epoch: 20, Steps: 8 | Train Loss: 0.124 Vali Loss: 0.492 Vali Acc: 0.844 Test Loss: 0.492 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.152663230895996
Epoch: 21, Steps: 8 | Train Loss: 0.116 Vali Loss: 0.493 Vali Acc: 0.841 Test Loss: 0.493 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1352710723876953
Epoch: 22, Steps: 8 | Train Loss: 0.118 Vali Loss: 0.493 Vali Acc: 0.847 Test Loss: 0.493 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.100665807723999
Epoch: 23, Steps: 8 | Train Loss: 0.096 Vali Loss: 0.492 Vali Acc: 0.844 Test Loss: 0.492 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.1081442832946777
Epoch: 24, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.494 Vali Acc: 0.841 Test Loss: 0.494 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.0844156742095947
Epoch: 25, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.492 Vali Acc: 0.838 Test Loss: 0.492 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.0370914936065674
Epoch: 26, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.493 Vali Acc: 0.834 Test Loss: 0.493 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.0685746669769287
Epoch: 27, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.499 Vali Acc: 0.834 Test Loss: 0.499 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.0254449844360352
Epoch: 28, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.504 Vali Acc: 0.838 Test Loss: 0.504 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.1004934310913086
Epoch: 29, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.514 Vali Acc: 0.841 Test Loss: 0.514 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 149792
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.4983019828796387
Epoch: 1, Steps: 8 | Train Loss: 2.101 Vali Loss: 2.058 Vali Acc: 0.200 Test Loss: 2.058 Test Acc: 0.200
Validation loss decreased (inf --> -0.199979).  Saving model ...
Epoch: 2 cost time: 2.0913071632385254
Epoch: 2, Steps: 8 | Train Loss: 1.985 Vali Loss: 1.899 Vali Acc: 0.306 Test Loss: 1.899 Test Acc: 0.306
Validation loss decreased (-0.199979 --> -0.306231).  Saving model ...
Epoch: 3 cost time: 2.014101266860962
Epoch: 3, Steps: 8 | Train Loss: 1.830 Vali Loss: 1.701 Vali Acc: 0.556 Test Loss: 1.701 Test Acc: 0.556
Validation loss decreased (-0.306231 --> -0.556233).  Saving model ...
Epoch: 4 cost time: 1.9659397602081299
Epoch: 4, Steps: 8 | Train Loss: 1.596 Vali Loss: 1.482 Vali Acc: 0.697 Test Loss: 1.482 Test Acc: 0.697
Validation loss decreased (-0.556233 --> -0.696860).  Saving model ...
Epoch: 5 cost time: 1.8095037937164307
Epoch: 5, Steps: 8 | Train Loss: 1.335 Vali Loss: 1.276 Vali Acc: 0.750 Test Loss: 1.276 Test Acc: 0.750
Validation loss decreased (-0.696860 --> -0.749987).  Saving model ...
Epoch: 6 cost time: 1.9262068271636963
Epoch: 6, Steps: 8 | Train Loss: 1.172 Vali Loss: 1.084 Vali Acc: 0.762 Test Loss: 1.084 Test Acc: 0.762
Validation loss decreased (-0.749987 --> -0.762489).  Saving model ...
Epoch: 7 cost time: 1.9180245399475098
Epoch: 7, Steps: 8 | Train Loss: 0.963 Vali Loss: 0.927 Vali Acc: 0.794 Test Loss: 0.927 Test Acc: 0.794
Validation loss decreased (-0.762489 --> -0.793741).  Saving model ...
Epoch: 8 cost time: 1.9822356700897217
Epoch: 8, Steps: 8 | Train Loss: 0.778 Vali Loss: 0.801 Vali Acc: 0.809 Test Loss: 0.801 Test Acc: 0.809
Validation loss decreased (-0.793741 --> -0.809367).  Saving model ...
Epoch: 9 cost time: 1.8327152729034424
Epoch: 9, Steps: 8 | Train Loss: 0.650 Vali Loss: 0.703 Vali Acc: 0.819 Test Loss: 0.703 Test Acc: 0.819
Validation loss decreased (-0.809367 --> -0.818743).  Saving model ...
Epoch: 10 cost time: 1.8485450744628906
Epoch: 10, Steps: 8 | Train Loss: 0.530 Vali Loss: 0.629 Vali Acc: 0.834 Test Loss: 0.629 Test Acc: 0.834
Validation loss decreased (-0.818743 --> -0.834369).  Saving model ...
Epoch: 11 cost time: 1.8252029418945312
Epoch: 11, Steps: 8 | Train Loss: 0.441 Vali Loss: 0.568 Vali Acc: 0.844 Test Loss: 0.568 Test Acc: 0.844
Validation loss decreased (-0.834369 --> -0.843744).  Saving model ...
Epoch: 12 cost time: 1.7645769119262695
Epoch: 12, Steps: 8 | Train Loss: 0.382 Vali Loss: 0.532 Vali Acc: 0.856 Test Loss: 0.532 Test Acc: 0.856
Validation loss decreased (-0.843744 --> -0.856245).  Saving model ...
Epoch: 13 cost time: 1.7836616039276123
Epoch: 13, Steps: 8 | Train Loss: 0.325 Vali Loss: 0.503 Vali Acc: 0.853 Test Loss: 0.503 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9380671977996826
Epoch: 14, Steps: 8 | Train Loss: 0.245 Vali Loss: 0.478 Vali Acc: 0.869 Test Loss: 0.478 Test Acc: 0.869
Validation loss decreased (-0.856245 --> -0.868745).  Saving model ...
Epoch: 15 cost time: 1.898106575012207
Epoch: 15, Steps: 8 | Train Loss: 0.229 Vali Loss: 0.462 Vali Acc: 0.872 Test Loss: 0.462 Test Acc: 0.872
Validation loss decreased (-0.868745 --> -0.871870).  Saving model ...
Epoch: 16 cost time: 1.7517120838165283
Epoch: 16, Steps: 8 | Train Loss: 0.206 Vali Loss: 0.456 Vali Acc: 0.866 Test Loss: 0.456 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9293153285980225
Epoch: 17, Steps: 8 | Train Loss: 0.174 Vali Loss: 0.453 Vali Acc: 0.863 Test Loss: 0.453 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.804292917251587
Epoch: 18, Steps: 8 | Train Loss: 0.135 Vali Loss: 0.446 Vali Acc: 0.866 Test Loss: 0.446 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.0131046772003174
Epoch: 19, Steps: 8 | Train Loss: 0.114 Vali Loss: 0.442 Vali Acc: 0.856 Test Loss: 0.442 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.9366402626037598
Epoch: 20, Steps: 8 | Train Loss: 0.110 Vali Loss: 0.440 Vali Acc: 0.863 Test Loss: 0.440 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.7588410377502441
Epoch: 21, Steps: 8 | Train Loss: 0.096 Vali Loss: 0.445 Vali Acc: 0.869 Test Loss: 0.445 Test Acc: 0.869
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.8224751949310303
Epoch: 22, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.440 Vali Acc: 0.866 Test Loss: 0.440 Test Acc: 0.866
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.1563737392425537
Epoch: 23, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.438 Vali Acc: 0.866 Test Loss: 0.438 Test Acc: 0.866
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.0072097778320312
Epoch: 24, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.435 Vali Acc: 0.863 Test Loss: 0.435 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.962721347808838
Epoch: 25, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.437 Vali Acc: 0.869 Test Loss: 0.437 Test Acc: 0.869
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 240368
model size : 1.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.010654926300049
Epoch: 1, Steps: 8 | Train Loss: 2.084 Vali Loss: 2.001 Vali Acc: 0.206 Test Loss: 2.001 Test Acc: 0.206
Validation loss decreased (inf --> -0.206230).  Saving model ...
Epoch: 2 cost time: 1.3237154483795166
Epoch: 2, Steps: 8 | Train Loss: 1.990 Vali Loss: 1.874 Vali Acc: 0.328 Test Loss: 1.874 Test Acc: 0.328
Validation loss decreased (-0.206230 --> -0.328106).  Saving model ...
Epoch: 3 cost time: 1.3602259159088135
Epoch: 3, Steps: 8 | Train Loss: 1.832 Vali Loss: 1.710 Vali Acc: 0.531 Test Loss: 1.710 Test Acc: 0.531
Validation loss decreased (-0.328106 --> -0.531233).  Saving model ...
Epoch: 4 cost time: 1.3132002353668213
Epoch: 4, Steps: 8 | Train Loss: 1.641 Vali Loss: 1.533 Vali Acc: 0.669 Test Loss: 1.533 Test Acc: 0.669
Validation loss decreased (-0.531233 --> -0.668735).  Saving model ...
Epoch: 5 cost time: 1.2131755352020264
Epoch: 5, Steps: 8 | Train Loss: 1.528 Vali Loss: 1.360 Vali Acc: 0.722 Test Loss: 1.360 Test Acc: 0.722
Validation loss decreased (-0.668735 --> -0.721861).  Saving model ...
Epoch: 6 cost time: 1.2752587795257568
Epoch: 6, Steps: 8 | Train Loss: 1.299 Vali Loss: 1.195 Vali Acc: 0.744 Test Loss: 1.195 Test Acc: 0.744
Validation loss decreased (-0.721861 --> -0.743738).  Saving model ...
Epoch: 7 cost time: 1.2527143955230713
Epoch: 7, Steps: 8 | Train Loss: 1.079 Vali Loss: 1.041 Vali Acc: 0.781 Test Loss: 1.041 Test Acc: 0.781
Validation loss decreased (-0.743738 --> -0.781240).  Saving model ...
Epoch: 8 cost time: 1.2457315921783447
Epoch: 8, Steps: 8 | Train Loss: 0.939 Vali Loss: 0.908 Vali Acc: 0.816 Test Loss: 0.908 Test Acc: 0.816
Validation loss decreased (-0.781240 --> -0.815616).  Saving model ...
Epoch: 9 cost time: 1.297661542892456
Epoch: 9, Steps: 8 | Train Loss: 0.794 Vali Loss: 0.789 Vali Acc: 0.825 Test Loss: 0.789 Test Acc: 0.825
Validation loss decreased (-0.815616 --> -0.824992).  Saving model ...
Epoch: 10 cost time: 1.2500693798065186
Epoch: 10, Steps: 8 | Train Loss: 0.691 Vali Loss: 0.693 Vali Acc: 0.841 Test Loss: 0.693 Test Acc: 0.841
Validation loss decreased (-0.824992 --> -0.840618).  Saving model ...
Epoch: 11 cost time: 1.2624387741088867
Epoch: 11, Steps: 8 | Train Loss: 0.560 Vali Loss: 0.625 Vali Acc: 0.841 Test Loss: 0.625 Test Acc: 0.841
Validation loss decreased (-0.840618 --> -0.840619).  Saving model ...
Epoch: 12 cost time: 1.3857200145721436
Epoch: 12, Steps: 8 | Train Loss: 0.458 Vali Loss: 0.575 Vali Acc: 0.834 Test Loss: 0.575 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.35622239112854
Epoch: 13, Steps: 8 | Train Loss: 0.409 Vali Loss: 0.538 Vali Acc: 0.853 Test Loss: 0.538 Test Acc: 0.853
Validation loss decreased (-0.840619 --> -0.853120).  Saving model ...
Epoch: 14 cost time: 1.3479185104370117
Epoch: 14, Steps: 8 | Train Loss: 0.331 Vali Loss: 0.504 Vali Acc: 0.847 Test Loss: 0.504 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3850457668304443
Epoch: 15, Steps: 8 | Train Loss: 0.269 Vali Loss: 0.489 Vali Acc: 0.863 Test Loss: 0.489 Test Acc: 0.863
Validation loss decreased (-0.853120 --> -0.862495).  Saving model ...
Epoch: 16 cost time: 1.3544888496398926
Epoch: 16, Steps: 8 | Train Loss: 0.241 Vali Loss: 0.478 Vali Acc: 0.863 Test Loss: 0.478 Test Acc: 0.863
Validation loss decreased (-0.862495 --> -0.862495).  Saving model ...
Epoch: 17 cost time: 1.3104031085968018
Epoch: 17, Steps: 8 | Train Loss: 0.202 Vali Loss: 0.472 Vali Acc: 0.866 Test Loss: 0.472 Test Acc: 0.866
Validation loss decreased (-0.862495 --> -0.865620).  Saving model ...
Epoch: 18 cost time: 1.3721723556518555
Epoch: 18, Steps: 8 | Train Loss: 0.180 Vali Loss: 0.461 Vali Acc: 0.872 Test Loss: 0.461 Test Acc: 0.872
Validation loss decreased (-0.865620 --> -0.871870).  Saving model ...
Epoch: 19 cost time: 1.3860447406768799
Epoch: 19, Steps: 8 | Train Loss: 0.145 Vali Loss: 0.460 Vali Acc: 0.863 Test Loss: 0.460 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3539795875549316
Epoch: 20, Steps: 8 | Train Loss: 0.132 Vali Loss: 0.457 Vali Acc: 0.859 Test Loss: 0.457 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.4488122463226318
Epoch: 21, Steps: 8 | Train Loss: 0.104 Vali Loss: 0.455 Vali Acc: 0.875 Test Loss: 0.455 Test Acc: 0.875
Validation loss decreased (-0.871870 --> -0.874995).  Saving model ...
Epoch: 22 cost time: 1.5524616241455078
Epoch: 22, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.451 Vali Acc: 0.875 Test Loss: 0.451 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 23 cost time: 1.5688998699188232
Epoch: 23, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.449 Vali Acc: 0.872 Test Loss: 0.449 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.471311092376709
Epoch: 24, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.451 Vali Acc: 0.875 Test Loss: 0.451 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.44087553024292
Epoch: 25, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.449 Vali Acc: 0.875 Test Loss: 0.449 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 26 cost time: 1.4526293277740479
Epoch: 26, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.450 Vali Acc: 0.875 Test Loss: 0.450 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.4715194702148438
Epoch: 27, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.448 Vali Acc: 0.875 Test Loss: 0.448 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 28 cost time: 1.455275535583496
Epoch: 28, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.444 Vali Acc: 0.878 Test Loss: 0.444 Test Acc: 0.878
Validation loss decreased (-0.874996 --> -0.878121).  Saving model ...
Epoch: 29 cost time: 1.4912357330322266
Epoch: 29, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.447 Vali Acc: 0.878 Test Loss: 0.447 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.4430975914001465
Epoch: 30, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.456 Vali Acc: 0.878 Test Loss: 0.456 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.878125
model parameter : 85088
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.1838762760162354
Epoch: 1, Steps: 8 | Train Loss: 2.101 Vali Loss: 2.058 Vali Acc: 0.203 Test Loss: 2.058 Test Acc: 0.203
Validation loss decreased (inf --> -0.203104).  Saving model ...
Epoch: 2 cost time: 1.7240486145019531
Epoch: 2, Steps: 8 | Train Loss: 1.982 Vali Loss: 1.900 Vali Acc: 0.306 Test Loss: 1.900 Test Acc: 0.306
Validation loss decreased (-0.203104 --> -0.306231).  Saving model ...
Epoch: 3 cost time: 1.8225340843200684
Epoch: 3, Steps: 8 | Train Loss: 1.830 Vali Loss: 1.705 Vali Acc: 0.550 Test Loss: 1.705 Test Acc: 0.550
Validation loss decreased (-0.306231 --> -0.549983).  Saving model ...
Epoch: 4 cost time: 1.7103588581085205
Epoch: 4, Steps: 8 | Train Loss: 1.596 Vali Loss: 1.488 Vali Acc: 0.700 Test Loss: 1.488 Test Acc: 0.700
Validation loss decreased (-0.549983 --> -0.699985).  Saving model ...
Epoch: 5 cost time: 1.8340013027191162
Epoch: 5, Steps: 8 | Train Loss: 1.338 Vali Loss: 1.282 Vali Acc: 0.747 Test Loss: 1.282 Test Acc: 0.747
Validation loss decreased (-0.699985 --> -0.746862).  Saving model ...
Epoch: 6 cost time: 1.8119852542877197
Epoch: 6, Steps: 8 | Train Loss: 1.179 Vali Loss: 1.093 Vali Acc: 0.766 Test Loss: 1.093 Test Acc: 0.766
Validation loss decreased (-0.746862 --> -0.765614).  Saving model ...
Epoch: 7 cost time: 1.9055969715118408
Epoch: 7, Steps: 8 | Train Loss: 0.969 Vali Loss: 0.937 Vali Acc: 0.787 Test Loss: 0.937 Test Acc: 0.787
Validation loss decreased (-0.765614 --> -0.787491).  Saving model ...
Epoch: 8 cost time: 1.6327815055847168
Epoch: 8, Steps: 8 | Train Loss: 0.784 Vali Loss: 0.814 Vali Acc: 0.809 Test Loss: 0.814 Test Acc: 0.809
Validation loss decreased (-0.787491 --> -0.809367).  Saving model ...
Epoch: 9 cost time: 1.8648426532745361
Epoch: 9, Steps: 8 | Train Loss: 0.658 Vali Loss: 0.717 Vali Acc: 0.819 Test Loss: 0.717 Test Acc: 0.819
Validation loss decreased (-0.809367 --> -0.818743).  Saving model ...
Epoch: 10 cost time: 1.7967197895050049
Epoch: 10, Steps: 8 | Train Loss: 0.536 Vali Loss: 0.643 Vali Acc: 0.825 Test Loss: 0.643 Test Acc: 0.825
Validation loss decreased (-0.818743 --> -0.824994).  Saving model ...
Epoch: 11 cost time: 1.8735535144805908
Epoch: 11, Steps: 8 | Train Loss: 0.445 Vali Loss: 0.582 Vali Acc: 0.847 Test Loss: 0.582 Test Acc: 0.847
Validation loss decreased (-0.824994 --> -0.846869).  Saving model ...
Epoch: 12 cost time: 1.9099781513214111
Epoch: 12, Steps: 8 | Train Loss: 0.381 Vali Loss: 0.545 Vali Acc: 0.850 Test Loss: 0.545 Test Acc: 0.850
Validation loss decreased (-0.846869 --> -0.849995).  Saving model ...
Epoch: 13 cost time: 1.88627290725708
Epoch: 13, Steps: 8 | Train Loss: 0.327 Vali Loss: 0.512 Vali Acc: 0.847 Test Loss: 0.512 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8024675846099854
Epoch: 14, Steps: 8 | Train Loss: 0.251 Vali Loss: 0.488 Vali Acc: 0.866 Test Loss: 0.488 Test Acc: 0.866
Validation loss decreased (-0.849995 --> -0.865620).  Saving model ...
Epoch: 15 cost time: 1.815704584121704
Epoch: 15, Steps: 8 | Train Loss: 0.231 Vali Loss: 0.474 Vali Acc: 0.866 Test Loss: 0.474 Test Acc: 0.866
Validation loss decreased (-0.865620 --> -0.865620).  Saving model ...
Epoch: 16 cost time: 1.8940362930297852
Epoch: 16, Steps: 8 | Train Loss: 0.209 Vali Loss: 0.468 Vali Acc: 0.859 Test Loss: 0.468 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8570129871368408
Epoch: 17, Steps: 8 | Train Loss: 0.170 Vali Loss: 0.463 Vali Acc: 0.853 Test Loss: 0.463 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.8016371726989746
Epoch: 18, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.454 Vali Acc: 0.853 Test Loss: 0.454 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.868814468383789
Epoch: 19, Steps: 8 | Train Loss: 0.114 Vali Loss: 0.449 Vali Acc: 0.853 Test Loss: 0.449 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.9648568630218506
Epoch: 20, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.446 Vali Acc: 0.856 Test Loss: 0.446 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.7838914394378662
Epoch: 21, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.450 Vali Acc: 0.863 Test Loss: 0.450 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.8407793045043945
Epoch: 22, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.447 Vali Acc: 0.863 Test Loss: 0.447 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.751983880996704
Epoch: 23, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.446 Vali Acc: 0.859 Test Loss: 0.446 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.7556235790252686
Epoch: 24, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.441 Vali Acc: 0.859 Test Loss: 0.441 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.7021260261535645
Epoch: 25, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.443 Vali Acc: 0.866 Test Loss: 0.443 Test Acc: 0.866
Validation loss decreased (-0.865620 --> -0.865621).  Saving model ...
Epoch: 26 cost time: 1.7715885639190674
Epoch: 26, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.452 Vali Acc: 0.872 Test Loss: 0.452 Test Acc: 0.872
Validation loss decreased (-0.865621 --> -0.871870).  Saving model ...
Epoch: 27 cost time: 1.7650136947631836
Epoch: 27, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.453 Vali Acc: 0.869 Test Loss: 0.453 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.8134374618530273
Epoch: 28, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.455 Vali Acc: 0.869 Test Loss: 0.455 Test Acc: 0.869
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.7109637260437012
Epoch: 29, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.460 Vali Acc: 0.856 Test Loss: 0.460 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.7108690738677979
Epoch: 30, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.465 Vali Acc: 0.856 Test Loss: 0.465 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 240368
model size : 1.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.8157780170440674
Epoch: 1, Steps: 8 | Train Loss: 2.087 Vali Loss: 1.999 Vali Acc: 0.206 Test Loss: 1.999 Test Acc: 0.206
Validation loss decreased (inf --> -0.206230).  Saving model ...
Epoch: 2 cost time: 1.4132273197174072
Epoch: 2, Steps: 8 | Train Loss: 1.998 Vali Loss: 1.872 Vali Acc: 0.328 Test Loss: 1.872 Test Acc: 0.328
Validation loss decreased (-0.206230 --> -0.328106).  Saving model ...
Epoch: 3 cost time: 1.41396164894104
Epoch: 3, Steps: 8 | Train Loss: 1.840 Vali Loss: 1.709 Vali Acc: 0.537 Test Loss: 1.709 Test Acc: 0.537
Validation loss decreased (-0.328106 --> -0.537483).  Saving model ...
Epoch: 4 cost time: 1.3975193500518799
Epoch: 4, Steps: 8 | Train Loss: 1.655 Vali Loss: 1.535 Vali Acc: 0.672 Test Loss: 1.535 Test Acc: 0.672
Validation loss decreased (-0.537483 --> -0.671860).  Saving model ...
Epoch: 5 cost time: 1.3840265274047852
Epoch: 5, Steps: 8 | Train Loss: 1.544 Vali Loss: 1.364 Vali Acc: 0.722 Test Loss: 1.364 Test Acc: 0.722
Validation loss decreased (-0.671860 --> -0.721861).  Saving model ...
Epoch: 6 cost time: 1.341325283050537
Epoch: 6, Steps: 8 | Train Loss: 1.321 Vali Loss: 1.200 Vali Acc: 0.747 Test Loss: 1.200 Test Acc: 0.747
Validation loss decreased (-0.721861 --> -0.746863).  Saving model ...
Epoch: 7 cost time: 1.3711955547332764
Epoch: 7, Steps: 8 | Train Loss: 1.108 Vali Loss: 1.047 Vali Acc: 0.784 Test Loss: 1.047 Test Acc: 0.784
Validation loss decreased (-0.746863 --> -0.784365).  Saving model ...
Epoch: 8 cost time: 1.365985631942749
Epoch: 8, Steps: 8 | Train Loss: 0.963 Vali Loss: 0.915 Vali Acc: 0.809 Test Loss: 0.915 Test Acc: 0.809
Validation loss decreased (-0.784365 --> -0.809366).  Saving model ...
Epoch: 9 cost time: 1.3597862720489502
Epoch: 9, Steps: 8 | Train Loss: 0.814 Vali Loss: 0.798 Vali Acc: 0.822 Test Loss: 0.798 Test Acc: 0.822
Validation loss decreased (-0.809366 --> -0.821867).  Saving model ...
Epoch: 10 cost time: 1.3405177593231201
Epoch: 10, Steps: 8 | Train Loss: 0.711 Vali Loss: 0.704 Vali Acc: 0.841 Test Loss: 0.704 Test Acc: 0.841
Validation loss decreased (-0.821867 --> -0.840618).  Saving model ...
Epoch: 11 cost time: 1.4129579067230225
Epoch: 11, Steps: 8 | Train Loss: 0.577 Vali Loss: 0.633 Vali Acc: 0.844 Test Loss: 0.633 Test Acc: 0.844
Validation loss decreased (-0.840618 --> -0.843744).  Saving model ...
Epoch: 12 cost time: 1.4068875312805176
Epoch: 12, Steps: 8 | Train Loss: 0.478 Vali Loss: 0.581 Vali Acc: 0.841 Test Loss: 0.581 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.436265468597412
Epoch: 13, Steps: 8 | Train Loss: 0.427 Vali Loss: 0.544 Vali Acc: 0.853 Test Loss: 0.544 Test Acc: 0.853
Validation loss decreased (-0.843744 --> -0.853120).  Saving model ...
Epoch: 14 cost time: 1.3759281635284424
Epoch: 14, Steps: 8 | Train Loss: 0.342 Vali Loss: 0.510 Vali Acc: 0.856 Test Loss: 0.510 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 15 cost time: 1.4109349250793457
Epoch: 15, Steps: 8 | Train Loss: 0.274 Vali Loss: 0.493 Vali Acc: 0.863 Test Loss: 0.493 Test Acc: 0.863
Validation loss decreased (-0.856245 --> -0.862495).  Saving model ...
Epoch: 16 cost time: 1.3421714305877686
Epoch: 16, Steps: 8 | Train Loss: 0.243 Vali Loss: 0.483 Vali Acc: 0.866 Test Loss: 0.483 Test Acc: 0.866
Validation loss decreased (-0.862495 --> -0.865620).  Saving model ...
Epoch: 17 cost time: 1.294527292251587
Epoch: 17, Steps: 8 | Train Loss: 0.208 Vali Loss: 0.479 Vali Acc: 0.863 Test Loss: 0.479 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3204841613769531
Epoch: 18, Steps: 8 | Train Loss: 0.183 Vali Loss: 0.469 Vali Acc: 0.863 Test Loss: 0.469 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3123195171356201
Epoch: 19, Steps: 8 | Train Loss: 0.144 Vali Loss: 0.468 Vali Acc: 0.866 Test Loss: 0.468 Test Acc: 0.866
Validation loss decreased (-0.865620 --> -0.865620).  Saving model ...
Epoch: 20 cost time: 1.281738042831421
Epoch: 20, Steps: 8 | Train Loss: 0.132 Vali Loss: 0.465 Vali Acc: 0.866 Test Loss: 0.465 Test Acc: 0.866
Validation loss decreased (-0.865620 --> -0.865620).  Saving model ...
Epoch: 21 cost time: 1.2622957229614258
Epoch: 21, Steps: 8 | Train Loss: 0.104 Vali Loss: 0.465 Vali Acc: 0.878 Test Loss: 0.465 Test Acc: 0.878
Validation loss decreased (-0.865620 --> -0.878120).  Saving model ...
Epoch: 22 cost time: 1.3194329738616943
Epoch: 22, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.461 Vali Acc: 0.875 Test Loss: 0.461 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.43855619430542
Epoch: 23, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.459 Vali Acc: 0.869 Test Loss: 0.459 Test Acc: 0.869
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.2624948024749756
Epoch: 24, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.462 Vali Acc: 0.875 Test Loss: 0.462 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.1968166828155518
Epoch: 25, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.460 Vali Acc: 0.869 Test Loss: 0.460 Test Acc: 0.869
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.1752309799194336
Epoch: 26, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.460 Vali Acc: 0.869 Test Loss: 0.460 Test Acc: 0.869
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.1558058261871338
Epoch: 27, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.458 Vali Acc: 0.872 Test Loss: 0.458 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.1886556148529053
Epoch: 28, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.454 Vali Acc: 0.869 Test Loss: 0.454 Test Acc: 0.869
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.3191883563995361
Epoch: 29, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.458 Vali Acc: 0.872 Test Loss: 0.458 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.279222011566162
Epoch: 30, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.466 Vali Acc: 0.872 Test Loss: 0.466 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.878125
model parameter : 85088
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.629279851913452
Epoch: 1, Steps: 8 | Train Loss: 2.102 Vali Loss: 2.059 Vali Acc: 0.200 Test Loss: 2.059 Test Acc: 0.200
Validation loss decreased (inf --> -0.199979).  Saving model ...
Epoch: 2 cost time: 1.2860589027404785
Epoch: 2, Steps: 8 | Train Loss: 1.983 Vali Loss: 1.904 Vali Acc: 0.300 Test Loss: 1.904 Test Acc: 0.300
Validation loss decreased (-0.199979 --> -0.299981).  Saving model ...
Epoch: 3 cost time: 1.1872889995574951
Epoch: 3, Steps: 8 | Train Loss: 1.834 Vali Loss: 1.711 Vali Acc: 0.537 Test Loss: 1.711 Test Acc: 0.537
Validation loss decreased (-0.299981 --> -0.537483).  Saving model ...
Epoch: 4 cost time: 1.2397794723510742
Epoch: 4, Steps: 8 | Train Loss: 1.603 Vali Loss: 1.497 Vali Acc: 0.697 Test Loss: 1.497 Test Acc: 0.697
Validation loss decreased (-0.537483 --> -0.696860).  Saving model ...
Epoch: 5 cost time: 1.2797133922576904
Epoch: 5, Steps: 8 | Train Loss: 1.348 Vali Loss: 1.293 Vali Acc: 0.756 Test Loss: 1.293 Test Acc: 0.756
Validation loss decreased (-0.696860 --> -0.756237).  Saving model ...
Epoch: 6 cost time: 1.254347801208496
Epoch: 6, Steps: 8 | Train Loss: 1.194 Vali Loss: 1.105 Vali Acc: 0.769 Test Loss: 1.105 Test Acc: 0.769
Validation loss decreased (-0.756237 --> -0.768739).  Saving model ...
Epoch: 7 cost time: 1.3393568992614746
Epoch: 7, Steps: 8 | Train Loss: 0.991 Vali Loss: 0.952 Vali Acc: 0.787 Test Loss: 0.952 Test Acc: 0.787
Validation loss decreased (-0.768739 --> -0.787490).  Saving model ...
Epoch: 8 cost time: 1.2541193962097168
Epoch: 8, Steps: 8 | Train Loss: 0.806 Vali Loss: 0.831 Vali Acc: 0.803 Test Loss: 0.831 Test Acc: 0.803
Validation loss decreased (-0.787490 --> -0.803117).  Saving model ...
Epoch: 9 cost time: 1.2862062454223633
Epoch: 9, Steps: 8 | Train Loss: 0.684 Vali Loss: 0.735 Vali Acc: 0.809 Test Loss: 0.735 Test Acc: 0.809
Validation loss decreased (-0.803117 --> -0.809368).  Saving model ...
Epoch: 10 cost time: 1.1781854629516602
Epoch: 10, Steps: 8 | Train Loss: 0.568 Vali Loss: 0.664 Vali Acc: 0.819 Test Loss: 0.664 Test Acc: 0.819
Validation loss decreased (-0.809368 --> -0.818743).  Saving model ...
Epoch: 11 cost time: 1.1099157333374023
Epoch: 11, Steps: 8 | Train Loss: 0.483 Vali Loss: 0.608 Vali Acc: 0.831 Test Loss: 0.608 Test Acc: 0.831
Validation loss decreased (-0.818743 --> -0.831244).  Saving model ...
Epoch: 12 cost time: 1.1801228523254395
Epoch: 12, Steps: 8 | Train Loss: 0.424 Vali Loss: 0.575 Vali Acc: 0.831 Test Loss: 0.575 Test Acc: 0.831
Validation loss decreased (-0.831244 --> -0.831244).  Saving model ...
Epoch: 13 cost time: 1.0774579048156738
Epoch: 13, Steps: 8 | Train Loss: 0.373 Vali Loss: 0.547 Vali Acc: 0.834 Test Loss: 0.547 Test Acc: 0.834
Validation loss decreased (-0.831244 --> -0.834370).  Saving model ...
Epoch: 14 cost time: 1.1354076862335205
Epoch: 14, Steps: 8 | Train Loss: 0.296 Vali Loss: 0.524 Vali Acc: 0.853 Test Loss: 0.524 Test Acc: 0.853
Validation loss decreased (-0.834370 --> -0.853120).  Saving model ...
Epoch: 15 cost time: 1.117748737335205
Epoch: 15, Steps: 8 | Train Loss: 0.276 Vali Loss: 0.511 Vali Acc: 0.853 Test Loss: 0.511 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 16 cost time: 1.042414903640747
Epoch: 16, Steps: 8 | Train Loss: 0.250 Vali Loss: 0.506 Vali Acc: 0.850 Test Loss: 0.506 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1972174644470215
Epoch: 17, Steps: 8 | Train Loss: 0.208 Vali Loss: 0.503 Vali Acc: 0.850 Test Loss: 0.503 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1703712940216064
Epoch: 18, Steps: 8 | Train Loss: 0.164 Vali Loss: 0.494 Vali Acc: 0.847 Test Loss: 0.494 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2094790935516357
Epoch: 19, Steps: 8 | Train Loss: 0.143 Vali Loss: 0.490 Vali Acc: 0.847 Test Loss: 0.490 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.1895933151245117
Epoch: 20, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.488 Vali Acc: 0.853 Test Loss: 0.488 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 21 cost time: 1.1360726356506348
Epoch: 21, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.492 Vali Acc: 0.853 Test Loss: 0.492 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1395440101623535
Epoch: 22, Steps: 8 | Train Loss: 0.099 Vali Loss: 0.485 Vali Acc: 0.853 Test Loss: 0.485 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 23 cost time: 1.273045539855957
Epoch: 23, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.481 Vali Acc: 0.863 Test Loss: 0.481 Test Acc: 0.863
Validation loss decreased (-0.853120 --> -0.862495).  Saving model ...
Epoch: 24 cost time: 1.271998405456543
Epoch: 24, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.473 Vali Acc: 0.859 Test Loss: 0.473 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2816593647003174
Epoch: 25, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.475 Vali Acc: 0.863 Test Loss: 0.475 Test Acc: 0.863
Validation loss decreased (-0.862495 --> -0.862495).  Saving model ...
Epoch: 26 cost time: 1.2575647830963135
Epoch: 26, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.484 Vali Acc: 0.863 Test Loss: 0.484 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2289667129516602
Epoch: 27, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.485 Vali Acc: 0.863 Test Loss: 0.485 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2346208095550537
Epoch: 28, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.487 Vali Acc: 0.866 Test Loss: 0.487 Test Acc: 0.866
Validation loss decreased (-0.862495 --> -0.865620).  Saving model ...
Epoch: 29 cost time: 1.2158002853393555
Epoch: 29, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.491 Vali Acc: 0.866 Test Loss: 0.491 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.2098169326782227
Epoch: 30, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.495 Vali Acc: 0.863 Test Loss: 0.495 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 240368
model size : 1.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.3242878913879395
Epoch: 1, Steps: 8 | Train Loss: 2.080 Vali Loss: 1.997 Vali Acc: 0.206 Test Loss: 1.997 Test Acc: 0.206
Validation loss decreased (inf --> -0.206230).  Saving model ...
Epoch: 2 cost time: 0.9749345779418945
Epoch: 2, Steps: 8 | Train Loss: 1.991 Vali Loss: 1.872 Vali Acc: 0.331 Test Loss: 1.872 Test Acc: 0.331
Validation loss decreased (-0.206230 --> -0.331231).  Saving model ...
Epoch: 3 cost time: 0.9820196628570557
Epoch: 3, Steps: 8 | Train Loss: 1.836 Vali Loss: 1.711 Vali Acc: 0.534 Test Loss: 1.711 Test Acc: 0.534
Validation loss decreased (-0.331231 --> -0.534358).  Saving model ...
Epoch: 4 cost time: 0.8123989105224609
Epoch: 4, Steps: 8 | Train Loss: 1.652 Vali Loss: 1.538 Vali Acc: 0.659 Test Loss: 1.538 Test Acc: 0.659
Validation loss decreased (-0.534358 --> -0.659360).  Saving model ...
Epoch: 5 cost time: 0.9688417911529541
Epoch: 5, Steps: 8 | Train Loss: 1.544 Vali Loss: 1.369 Vali Acc: 0.719 Test Loss: 1.369 Test Acc: 0.719
Validation loss decreased (-0.659360 --> -0.718736).  Saving model ...
Epoch: 6 cost time: 0.934096097946167
Epoch: 6, Steps: 8 | Train Loss: 1.325 Vali Loss: 1.207 Vali Acc: 0.759 Test Loss: 1.207 Test Acc: 0.759
Validation loss decreased (-0.718736 --> -0.759363).  Saving model ...
Epoch: 7 cost time: 0.9373087882995605
Epoch: 7, Steps: 8 | Train Loss: 1.119 Vali Loss: 1.056 Vali Acc: 0.794 Test Loss: 1.056 Test Acc: 0.794
Validation loss decreased (-0.759363 --> -0.793739).  Saving model ...
Epoch: 8 cost time: 0.9992570877075195
Epoch: 8, Steps: 8 | Train Loss: 0.975 Vali Loss: 0.925 Vali Acc: 0.809 Test Loss: 0.925 Test Acc: 0.809
Validation loss decreased (-0.793739 --> -0.809366).  Saving model ...
Epoch: 9 cost time: 0.8727245330810547
Epoch: 9, Steps: 8 | Train Loss: 0.827 Vali Loss: 0.809 Vali Acc: 0.819 Test Loss: 0.809 Test Acc: 0.819
Validation loss decreased (-0.809366 --> -0.818742).  Saving model ...
Epoch: 10 cost time: 0.9316089153289795
Epoch: 10, Steps: 8 | Train Loss: 0.731 Vali Loss: 0.717 Vali Acc: 0.844 Test Loss: 0.717 Test Acc: 0.844
Validation loss decreased (-0.818742 --> -0.843743).  Saving model ...
Epoch: 11 cost time: 1.0457773208618164
Epoch: 11, Steps: 8 | Train Loss: 0.596 Vali Loss: 0.650 Vali Acc: 0.838 Test Loss: 0.650 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9125173091888428
Epoch: 12, Steps: 8 | Train Loss: 0.497 Vali Loss: 0.599 Vali Acc: 0.831 Test Loss: 0.599 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.939058780670166
Epoch: 13, Steps: 8 | Train Loss: 0.455 Vali Loss: 0.563 Vali Acc: 0.850 Test Loss: 0.563 Test Acc: 0.850
Validation loss decreased (-0.843743 --> -0.849994).  Saving model ...
Epoch: 14 cost time: 0.9182288646697998
Epoch: 14, Steps: 8 | Train Loss: 0.365 Vali Loss: 0.530 Vali Acc: 0.853 Test Loss: 0.530 Test Acc: 0.853
Validation loss decreased (-0.849994 --> -0.853120).  Saving model ...
Epoch: 15 cost time: 0.8771402835845947
Epoch: 15, Steps: 8 | Train Loss: 0.298 Vali Loss: 0.515 Vali Acc: 0.863 Test Loss: 0.515 Test Acc: 0.863
Validation loss decreased (-0.853120 --> -0.862495).  Saving model ...
Epoch: 16 cost time: 0.8930871486663818
Epoch: 16, Steps: 8 | Train Loss: 0.270 Vali Loss: 0.505 Vali Acc: 0.863 Test Loss: 0.505 Test Acc: 0.863
Validation loss decreased (-0.862495 --> -0.862495).  Saving model ...
Epoch: 17 cost time: 0.9233167171478271
Epoch: 17, Steps: 8 | Train Loss: 0.233 Vali Loss: 0.501 Vali Acc: 0.859 Test Loss: 0.501 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9316980838775635
Epoch: 18, Steps: 8 | Train Loss: 0.201 Vali Loss: 0.492 Vali Acc: 0.856 Test Loss: 0.492 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0153160095214844
Epoch: 19, Steps: 8 | Train Loss: 0.161 Vali Loss: 0.495 Vali Acc: 0.863 Test Loss: 0.495 Test Acc: 0.863
Validation loss decreased (-0.862495 --> -0.862495).  Saving model ...
Epoch: 20 cost time: 0.9452548027038574
Epoch: 20, Steps: 8 | Train Loss: 0.149 Vali Loss: 0.494 Vali Acc: 0.859 Test Loss: 0.494 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.024731159210205
Epoch: 21, Steps: 8 | Train Loss: 0.118 Vali Loss: 0.495 Vali Acc: 0.859 Test Loss: 0.495 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0439293384552002
Epoch: 22, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.490 Vali Acc: 0.866 Test Loss: 0.490 Test Acc: 0.866
Validation loss decreased (-0.862495 --> -0.865620).  Saving model ...
Epoch: 23 cost time: 0.9932272434234619
Epoch: 23, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.491 Vali Acc: 0.869 Test Loss: 0.491 Test Acc: 0.869
Validation loss decreased (-0.865620 --> -0.868745).  Saving model ...
Epoch: 24 cost time: 0.9463589191436768
Epoch: 24, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.497 Vali Acc: 0.866 Test Loss: 0.497 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.113065481185913
Epoch: 25, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.496 Vali Acc: 0.869 Test Loss: 0.496 Test Acc: 0.869
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1262016296386719
Epoch: 26, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.498 Vali Acc: 0.866 Test Loss: 0.498 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.0808839797973633
Epoch: 27, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.496 Vali Acc: 0.863 Test Loss: 0.496 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.0686285495758057
Epoch: 28, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.494 Vali Acc: 0.863 Test Loss: 0.494 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.0852482318878174
Epoch: 29, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.497 Vali Acc: 0.863 Test Loss: 0.497 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.0533030033111572
Epoch: 30, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.506 Vali Acc: 0.863 Test Loss: 0.506 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el3_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 85088
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 18.600403308868408
Epoch: 1, Steps: 8 | Train Loss: 1.944 Vali Loss: 1.411 Vali Acc: 0.741 Test Loss: 1.411 Test Acc: 0.741
Validation loss decreased (inf --> -0.740611).  Saving model ...
Epoch: 2 cost time: 17.37063431739807
Epoch: 2, Steps: 8 | Train Loss: 0.893 Vali Loss: 0.588 Vali Acc: 0.831 Test Loss: 0.588 Test Acc: 0.831
Validation loss decreased (-0.740611 --> -0.831244).  Saving model ...
Epoch: 3 cost time: 18.222766876220703
Epoch: 3, Steps: 8 | Train Loss: 0.379 Vali Loss: 0.442 Vali Acc: 0.866 Test Loss: 0.442 Test Acc: 0.866
Validation loss decreased (-0.831244 --> -0.865621).  Saving model ...
Epoch: 4 cost time: 18.8301842212677
Epoch: 4, Steps: 8 | Train Loss: 0.138 Vali Loss: 0.528 Vali Acc: 0.856 Test Loss: 0.528 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 17.018727779388428
Epoch: 5, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.566 Vali Acc: 0.863 Test Loss: 0.566 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 17.316595792770386
Epoch: 6, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.582 Vali Acc: 0.875 Test Loss: 0.582 Test Acc: 0.875
Validation loss decreased (-0.865621 --> -0.874994).  Saving model ...
Epoch: 7 cost time: 17.833437204360962
Epoch: 7, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.599 Vali Acc: 0.866 Test Loss: 0.599 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 18.34649634361267
Epoch: 8, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.736 Vali Acc: 0.850 Test Loss: 0.736 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 16.914596796035767
Epoch: 9, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.769 Vali Acc: 0.853 Test Loss: 0.769 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 15.780736446380615
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.759 Vali Acc: 0.853 Test Loss: 0.759 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 16.45186495780945
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.737 Vali Acc: 0.866 Test Loss: 0.737 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 16.469573974609375
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.729 Vali Acc: 0.866 Test Loss: 0.729 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 15.442693948745728
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.725 Vali Acc: 0.869 Test Loss: 0.725 Test Acc: 0.869
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 17.142566442489624
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.723 Vali Acc: 0.878 Test Loss: 0.723 Test Acc: 0.878
Validation loss decreased (-0.874994 --> -0.878118).  Saving model ...
Epoch: 15 cost time: 16.527864933013916
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.726 Vali Acc: 0.878 Test Loss: 0.726 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 16.158193588256836
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.729 Vali Acc: 0.878 Test Loss: 0.729 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 15.316195726394653
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.734 Vali Acc: 0.872 Test Loss: 0.734 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 18.15469980239868
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.740 Vali Acc: 0.872 Test Loss: 0.740 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 18.004945755004883
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.744 Vali Acc: 0.872 Test Loss: 0.744 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 17.71825075149536
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.748 Vali Acc: 0.872 Test Loss: 0.748 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 17.200531482696533
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.750 Vali Acc: 0.872 Test Loss: 0.750 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 18.316914796829224
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.750 Vali Acc: 0.872 Test Loss: 0.750 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 18.345083713531494
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.756 Vali Acc: 0.872 Test Loss: 0.756 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 16.87179708480835
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.761 Vali Acc: 0.872 Test Loss: 0.761 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.878125
model parameter : 37815688
model size : 146.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 8.159111499786377
Epoch: 1, Steps: 8 | Train Loss: 2.034 Vali Loss: 1.472 Vali Acc: 0.684 Test Loss: 1.472 Test Acc: 0.684
Validation loss decreased (inf --> -0.684360).  Saving model ...
Epoch: 2 cost time: 7.050211668014526
Epoch: 2, Steps: 8 | Train Loss: 1.040 Vali Loss: 0.574 Vali Acc: 0.809 Test Loss: 0.574 Test Acc: 0.809
Validation loss decreased (-0.684360 --> -0.809369).  Saving model ...
Epoch: 3 cost time: 7.014820575714111
Epoch: 3, Steps: 8 | Train Loss: 0.382 Vali Loss: 0.421 Vali Acc: 0.869 Test Loss: 0.421 Test Acc: 0.869
Validation loss decreased (-0.809369 --> -0.868746).  Saving model ...
Epoch: 4 cost time: 7.114769220352173
Epoch: 4, Steps: 8 | Train Loss: 0.145 Vali Loss: 0.491 Vali Acc: 0.850 Test Loss: 0.491 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.478643417358398
Epoch: 5, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.552 Vali Acc: 0.863 Test Loss: 0.552 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.8209452629089355
Epoch: 6, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.595 Vali Acc: 0.869 Test Loss: 0.595 Test Acc: 0.869
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.052590847015381
Epoch: 7, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.638 Vali Acc: 0.866 Test Loss: 0.638 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.97678542137146
Epoch: 8, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.634 Vali Acc: 0.859 Test Loss: 0.634 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 6.415616035461426
Epoch: 9, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.649 Vali Acc: 0.856 Test Loss: 0.649 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 6.312995910644531
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.703 Vali Acc: 0.853 Test Loss: 0.703 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 6.15746283531189
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.740 Vali Acc: 0.850 Test Loss: 0.740 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 6.443496227264404
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.742 Vali Acc: 0.847 Test Loss: 0.742 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.9542601108551025
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.735 Vali Acc: 0.856 Test Loss: 0.735 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 11337608
model size : 45.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 13.31123423576355
Epoch: 1, Steps: 8 | Train Loss: 1.944 Vali Loss: 1.420 Vali Acc: 0.728 Test Loss: 1.420 Test Acc: 0.728
Validation loss decreased (inf --> -0.728111).  Saving model ...
Epoch: 2 cost time: 12.605416297912598
Epoch: 2, Steps: 8 | Train Loss: 0.897 Vali Loss: 0.602 Vali Acc: 0.831 Test Loss: 0.602 Test Acc: 0.831
Validation loss decreased (-0.728111 --> -0.831244).  Saving model ...
Epoch: 3 cost time: 12.232410192489624
Epoch: 3, Steps: 8 | Train Loss: 0.376 Vali Loss: 0.450 Vali Acc: 0.866 Test Loss: 0.450 Test Acc: 0.866
Validation loss decreased (-0.831244 --> -0.865621).  Saving model ...
Epoch: 4 cost time: 11.812322854995728
Epoch: 4, Steps: 8 | Train Loss: 0.137 Vali Loss: 0.534 Vali Acc: 0.853 Test Loss: 0.534 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.048439979553223
Epoch: 5, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.573 Vali Acc: 0.859 Test Loss: 0.573 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 11.845608472824097
Epoch: 6, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.593 Vali Acc: 0.872 Test Loss: 0.593 Test Acc: 0.872
Validation loss decreased (-0.865621 --> -0.871869).  Saving model ...
Epoch: 7 cost time: 13.98923945426941
Epoch: 7, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.611 Vali Acc: 0.856 Test Loss: 0.611 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 14.285773038864136
Epoch: 8, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.741 Vali Acc: 0.853 Test Loss: 0.741 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 13.85165786743164
Epoch: 9, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.793 Vali Acc: 0.853 Test Loss: 0.793 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 13.570149421691895
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.767 Vali Acc: 0.856 Test Loss: 0.767 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 13.336487770080566
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.738 Vali Acc: 0.863 Test Loss: 0.738 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 12.156448125839233
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.728 Vali Acc: 0.859 Test Loss: 0.728 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 15.000711679458618
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.724 Vali Acc: 0.875 Test Loss: 0.724 Test Acc: 0.875
Validation loss decreased (-0.871869 --> -0.874993).  Saving model ...
Epoch: 14 cost time: 15.055057764053345
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.724 Vali Acc: 0.878 Test Loss: 0.724 Test Acc: 0.878
Validation loss decreased (-0.874993 --> -0.878118).  Saving model ...
Epoch: 15 cost time: 14.63621473312378
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.730 Vali Acc: 0.872 Test Loss: 0.730 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 14.666666984558105
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.736 Vali Acc: 0.866 Test Loss: 0.736 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 14.44744062423706
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.743 Vali Acc: 0.856 Test Loss: 0.743 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 12.679316520690918
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.751 Vali Acc: 0.856 Test Loss: 0.751 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 12.840562105178833
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.755 Vali Acc: 0.856 Test Loss: 0.755 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 13.518078565597534
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.758 Vali Acc: 0.859 Test Loss: 0.758 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 13.454077959060669
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.760 Vali Acc: 0.856 Test Loss: 0.760 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 13.683969974517822
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.761 Vali Acc: 0.859 Test Loss: 0.761 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 12.8376145362854
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.767 Vali Acc: 0.856 Test Loss: 0.767 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 12.944646120071411
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.771 Vali Acc: 0.856 Test Loss: 0.771 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.878125
model parameter : 37815688
model size : 146.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 6.635684251785278
Epoch: 1, Steps: 8 | Train Loss: 2.034 Vali Loss: 1.484 Vali Acc: 0.694 Test Loss: 1.484 Test Acc: 0.694
Validation loss decreased (inf --> -0.693735).  Saving model ...
Epoch: 2 cost time: 5.401958703994751
Epoch: 2, Steps: 8 | Train Loss: 1.044 Vali Loss: 0.587 Vali Acc: 0.809 Test Loss: 0.587 Test Acc: 0.809
Validation loss decreased (-0.693735 --> -0.809369).  Saving model ...
Epoch: 3 cost time: 5.304259300231934
Epoch: 3, Steps: 8 | Train Loss: 0.381 Vali Loss: 0.425 Vali Acc: 0.866 Test Loss: 0.425 Test Acc: 0.866
Validation loss decreased (-0.809369 --> -0.865621).  Saving model ...
Epoch: 4 cost time: 5.4871063232421875
Epoch: 4, Steps: 8 | Train Loss: 0.143 Vali Loss: 0.493 Vali Acc: 0.850 Test Loss: 0.493 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.279996871948242
Epoch: 5, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.559 Vali Acc: 0.863 Test Loss: 0.559 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.4008872509002686
Epoch: 6, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.609 Vali Acc: 0.863 Test Loss: 0.609 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.406607627868652
Epoch: 7, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.654 Vali Acc: 0.866 Test Loss: 0.654 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.995075702667236
Epoch: 8, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.651 Vali Acc: 0.850 Test Loss: 0.651 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.822051048278809
Epoch: 9, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.664 Vali Acc: 0.856 Test Loss: 0.664 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.699965715408325
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.717 Vali Acc: 0.850 Test Loss: 0.717 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.792300224304199
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.755 Vali Acc: 0.853 Test Loss: 0.755 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.646828651428223
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.758 Vali Acc: 0.850 Test Loss: 0.758 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.789147853851318
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.751 Vali Acc: 0.856 Test Loss: 0.751 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 11337608
model size : 45.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 9.938125610351562
Epoch: 1, Steps: 8 | Train Loss: 1.946 Vali Loss: 1.435 Vali Acc: 0.716 Test Loss: 1.435 Test Acc: 0.716
Validation loss decreased (inf --> -0.715611).  Saving model ...
Epoch: 2 cost time: 8.592547178268433
Epoch: 2, Steps: 8 | Train Loss: 0.926 Vali Loss: 0.627 Vali Acc: 0.825 Test Loss: 0.627 Test Acc: 0.825
Validation loss decreased (-0.715611 --> -0.824994).  Saving model ...
Epoch: 3 cost time: 11.558931350708008
Epoch: 3, Steps: 8 | Train Loss: 0.413 Vali Loss: 0.470 Vali Acc: 0.869 Test Loss: 0.470 Test Acc: 0.869
Validation loss decreased (-0.824994 --> -0.868745).  Saving model ...
Epoch: 4 cost time: 11.276683568954468
Epoch: 4, Steps: 8 | Train Loss: 0.176 Vali Loss: 0.566 Vali Acc: 0.853 Test Loss: 0.566 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.963019132614136
Epoch: 5, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.604 Vali Acc: 0.856 Test Loss: 0.604 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 11.24681568145752
Epoch: 6, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.595 Vali Acc: 0.859 Test Loss: 0.595 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 11.225637197494507
Epoch: 7, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.659 Vali Acc: 0.863 Test Loss: 0.659 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 11.158303260803223
Epoch: 8, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.806 Vali Acc: 0.847 Test Loss: 0.806 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 10.667946100234985
Epoch: 9, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.812 Vali Acc: 0.825 Test Loss: 0.812 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 10.796462774276733
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.760 Vali Acc: 0.869 Test Loss: 0.760 Test Acc: 0.869
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 10.655017614364624
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.767 Vali Acc: 0.875 Test Loss: 0.767 Test Acc: 0.875
Validation loss decreased (-0.868745 --> -0.874992).  Saving model ...
Epoch: 12 cost time: 10.646582126617432
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.748 Vali Acc: 0.866 Test Loss: 0.748 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 10.467280626296997
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.751 Vali Acc: 0.847 Test Loss: 0.751 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 10.583205938339233
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.764 Vali Acc: 0.844 Test Loss: 0.764 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 10.055835247039795
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.778 Vali Acc: 0.847 Test Loss: 0.778 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 10.320456504821777
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.786 Vali Acc: 0.844 Test Loss: 0.786 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 10.069104194641113
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.794 Vali Acc: 0.844 Test Loss: 0.794 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 10.20906376838684
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.799 Vali Acc: 0.847 Test Loss: 0.799 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 10.088617324829102
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.802 Vali Acc: 0.847 Test Loss: 0.802 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 9.95957088470459
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.805 Vali Acc: 0.847 Test Loss: 0.805 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 10.005159378051758
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.806 Vali Acc: 0.847 Test Loss: 0.806 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.875
model parameter : 37815688
model size : 146.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.431873321533203
Epoch: 1, Steps: 8 | Train Loss: 2.037 Vali Loss: 1.496 Vali Acc: 0.672 Test Loss: 1.496 Test Acc: 0.672
Validation loss decreased (inf --> -0.671860).  Saving model ...
Epoch: 2 cost time: 3.8463704586029053
Epoch: 2, Steps: 8 | Train Loss: 1.069 Vali Loss: 0.604 Vali Acc: 0.806 Test Loss: 0.604 Test Acc: 0.806
Validation loss decreased (-0.671860 --> -0.806244).  Saving model ...
Epoch: 3 cost time: 4.205406665802002
Epoch: 3, Steps: 8 | Train Loss: 0.408 Vali Loss: 0.444 Vali Acc: 0.869 Test Loss: 0.444 Test Acc: 0.869
Validation loss decreased (-0.806244 --> -0.868746).  Saving model ...
Epoch: 4 cost time: 4.007270812988281
Epoch: 4, Steps: 8 | Train Loss: 0.174 Vali Loss: 0.501 Vali Acc: 0.847 Test Loss: 0.501 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.108530044555664
Epoch: 5, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.575 Vali Acc: 0.853 Test Loss: 0.575 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.305370569229126
Epoch: 6, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.635 Vali Acc: 0.859 Test Loss: 0.635 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.18655252456665
Epoch: 7, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.646 Vali Acc: 0.856 Test Loss: 0.646 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.158477544784546
Epoch: 8, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.639 Vali Acc: 0.859 Test Loss: 0.639 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.263587474822998
Epoch: 9, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.665 Vali Acc: 0.856 Test Loss: 0.665 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.242247104644775
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.728 Vali Acc: 0.838 Test Loss: 0.728 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.359416484832764
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.776 Vali Acc: 0.841 Test Loss: 0.776 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.332218170166016
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.787 Vali Acc: 0.841 Test Loss: 0.787 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.550684690475464
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.781 Vali Acc: 0.841 Test Loss: 0.781 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 11337608
model size : 45.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 14.026247262954712
Epoch: 1, Steps: 8 | Train Loss: 1.998 Vali Loss: 1.478 Vali Acc: 0.681 Test Loss: 1.478 Test Acc: 0.681
Validation loss decreased (inf --> -0.681235).  Saving model ...
Epoch: 2 cost time: 11.94744873046875
Epoch: 2, Steps: 8 | Train Loss: 0.988 Vali Loss: 0.586 Vali Acc: 0.838 Test Loss: 0.586 Test Acc: 0.838
Validation loss decreased (-0.681235 --> -0.837494).  Saving model ...
Epoch: 3 cost time: 13.411244630813599
Epoch: 3, Steps: 8 | Train Loss: 0.412 Vali Loss: 0.485 Vali Acc: 0.856 Test Loss: 0.485 Test Acc: 0.856
Validation loss decreased (-0.837494 --> -0.856245).  Saving model ...
Epoch: 4 cost time: 13.141164541244507
Epoch: 4, Steps: 8 | Train Loss: 0.170 Vali Loss: 0.485 Vali Acc: 0.866 Test Loss: 0.485 Test Acc: 0.866
Validation loss decreased (-0.856245 --> -0.865620).  Saving model ...
Epoch: 5 cost time: 12.847205877304077
Epoch: 5, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.611 Vali Acc: 0.863 Test Loss: 0.611 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 12.927233457565308
Epoch: 6, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.591 Vali Acc: 0.863 Test Loss: 0.591 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 13.447465658187866
Epoch: 7, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.599 Vali Acc: 0.859 Test Loss: 0.599 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 13.35463261604309
Epoch: 8, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.628 Vali Acc: 0.850 Test Loss: 0.628 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 13.686821937561035
Epoch: 9, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.746 Vali Acc: 0.856 Test Loss: 0.746 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 13.045299291610718
Epoch: 10, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.759 Vali Acc: 0.856 Test Loss: 0.759 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 13.314148902893066
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.696 Vali Acc: 0.847 Test Loss: 0.696 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 12.87994384765625
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.710 Vali Acc: 0.847 Test Loss: 0.710 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 12.856927156448364
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.740 Vali Acc: 0.866 Test Loss: 0.740 Test Acc: 0.866
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 13.139185428619385
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.718 Vali Acc: 0.869 Test Loss: 0.718 Test Acc: 0.869
Validation loss decreased (-0.865620 --> -0.868743).  Saving model ...
Epoch: 15 cost time: 13.622824430465698
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.723 Vali Acc: 0.863 Test Loss: 0.723 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 13.429067850112915
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.735 Vali Acc: 0.863 Test Loss: 0.735 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 12.87320876121521
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.746 Vali Acc: 0.869 Test Loss: 0.746 Test Acc: 0.869
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 13.185524463653564
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.757 Vali Acc: 0.866 Test Loss: 0.757 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 12.441052436828613
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.764 Vali Acc: 0.859 Test Loss: 0.764 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 12.19083857536316
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.771 Vali Acc: 0.853 Test Loss: 0.771 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 12.004264116287231
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.772 Vali Acc: 0.866 Test Loss: 0.772 Test Acc: 0.866
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 12.330578088760376
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.777 Vali Acc: 0.863 Test Loss: 0.777 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 12.847745418548584
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.778 Vali Acc: 0.863 Test Loss: 0.778 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 11.968803405761719
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.779 Vali Acc: 0.866 Test Loss: 0.779 Test Acc: 0.866
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 19070856
model size : 75.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 6.34726881980896
Epoch: 1, Steps: 8 | Train Loss: 2.004 Vali Loss: 1.464 Vali Acc: 0.734 Test Loss: 1.464 Test Acc: 0.734
Validation loss decreased (inf --> -0.734360).  Saving model ...
Epoch: 2 cost time: 5.085871696472168
Epoch: 2, Steps: 8 | Train Loss: 0.984 Vali Loss: 0.633 Vali Acc: 0.812 Test Loss: 0.633 Test Acc: 0.812
Validation loss decreased (-0.734360 --> -0.812494).  Saving model ...
Epoch: 3 cost time: 4.969605445861816
Epoch: 3, Steps: 8 | Train Loss: 0.380 Vali Loss: 0.506 Vali Acc: 0.850 Test Loss: 0.506 Test Acc: 0.850
Validation loss decreased (-0.812494 --> -0.849995).  Saving model ...
Epoch: 4 cost time: 4.693088531494141
Epoch: 4, Steps: 8 | Train Loss: 0.198 Vali Loss: 0.522 Vali Acc: 0.847 Test Loss: 0.522 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.754896879196167
Epoch: 5, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.560 Vali Acc: 0.844 Test Loss: 0.560 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.82217812538147
Epoch: 6, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.677 Vali Acc: 0.841 Test Loss: 0.677 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.967516899108887
Epoch: 7, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.754 Vali Acc: 0.847 Test Loss: 0.754 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.091954946517944
Epoch: 8, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.682 Vali Acc: 0.847 Test Loss: 0.682 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.075235843658447
Epoch: 9, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.687 Vali Acc: 0.859 Test Loss: 0.687 Test Acc: 0.859
Validation loss decreased (-0.849995 --> -0.859368).  Saving model ...
Epoch: 10 cost time: 5.059186935424805
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.727 Vali Acc: 0.853 Test Loss: 0.727 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.9463746547698975
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.755 Vali Acc: 0.847 Test Loss: 0.755 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.305546283721924
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.751 Vali Acc: 0.850 Test Loss: 0.751 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.381360769271851
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.759 Vali Acc: 0.847 Test Loss: 0.759 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.218362331390381
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.759 Vali Acc: 0.850 Test Loss: 0.759 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.123278856277466
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.760 Vali Acc: 0.856 Test Loss: 0.760 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.1562018394470215
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.765 Vali Acc: 0.853 Test Loss: 0.765 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.346647262573242
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.771 Vali Acc: 0.859 Test Loss: 0.771 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.231276750564575
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.777 Vali Acc: 0.856 Test Loss: 0.777 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.454770088195801
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.780 Vali Acc: 0.856 Test Loss: 0.780 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 5831560
model size : 24.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 11.72241759300232
Epoch: 1, Steps: 8 | Train Loss: 1.997 Vali Loss: 1.483 Vali Acc: 0.672 Test Loss: 1.483 Test Acc: 0.672
Validation loss decreased (inf --> -0.671860).  Saving model ...
Epoch: 2 cost time: 9.884124755859375
Epoch: 2, Steps: 8 | Train Loss: 0.989 Vali Loss: 0.595 Vali Acc: 0.834 Test Loss: 0.595 Test Acc: 0.834
Validation loss decreased (-0.671860 --> -0.834369).  Saving model ...
Epoch: 3 cost time: 10.062341928482056
Epoch: 3, Steps: 8 | Train Loss: 0.411 Vali Loss: 0.488 Vali Acc: 0.856 Test Loss: 0.488 Test Acc: 0.856
Validation loss decreased (-0.834369 --> -0.856245).  Saving model ...
Epoch: 4 cost time: 10.012571811676025
Epoch: 4, Steps: 8 | Train Loss: 0.168 Vali Loss: 0.484 Vali Acc: 0.869 Test Loss: 0.484 Test Acc: 0.869
Validation loss decreased (-0.856245 --> -0.868745).  Saving model ...
Epoch: 5 cost time: 10.536812782287598
Epoch: 5, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.614 Vali Acc: 0.863 Test Loss: 0.614 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 10.406488180160522
Epoch: 6, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.601 Vali Acc: 0.853 Test Loss: 0.601 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 10.510032892227173
Epoch: 7, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.610 Vali Acc: 0.856 Test Loss: 0.610 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 10.478942394256592
Epoch: 8, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.634 Vali Acc: 0.847 Test Loss: 0.634 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 10.861853122711182
Epoch: 9, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.753 Vali Acc: 0.856 Test Loss: 0.753 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 10.529607057571411
Epoch: 10, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.766 Vali Acc: 0.859 Test Loss: 0.766 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 10.485360383987427
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.701 Vali Acc: 0.847 Test Loss: 0.701 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 10.085769653320312
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.713 Vali Acc: 0.853 Test Loss: 0.713 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 10.059474229812622
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.742 Vali Acc: 0.866 Test Loss: 0.742 Test Acc: 0.866
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 10.084617137908936
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.721 Vali Acc: 0.866 Test Loss: 0.721 Test Acc: 0.866
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 19070856
model size : 75.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.840304374694824
Epoch: 1, Steps: 8 | Train Loss: 2.004 Vali Loss: 1.465 Vali Acc: 0.734 Test Loss: 1.465 Test Acc: 0.734
Validation loss decreased (inf --> -0.734360).  Saving model ...
Epoch: 2 cost time: 4.401835680007935
Epoch: 2, Steps: 8 | Train Loss: 0.983 Vali Loss: 0.636 Vali Acc: 0.812 Test Loss: 0.636 Test Acc: 0.812
Validation loss decreased (-0.734360 --> -0.812494).  Saving model ...
Epoch: 3 cost time: 4.665873050689697
Epoch: 3, Steps: 8 | Train Loss: 0.380 Vali Loss: 0.507 Vali Acc: 0.850 Test Loss: 0.507 Test Acc: 0.850
Validation loss decreased (-0.812494 --> -0.849995).  Saving model ...
Epoch: 4 cost time: 4.677316427230835
Epoch: 4, Steps: 8 | Train Loss: 0.198 Vali Loss: 0.522 Vali Acc: 0.847 Test Loss: 0.522 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.579687595367432
Epoch: 5, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.560 Vali Acc: 0.844 Test Loss: 0.560 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.7195587158203125
Epoch: 6, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.677 Vali Acc: 0.841 Test Loss: 0.677 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.528053045272827
Epoch: 7, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.755 Vali Acc: 0.847 Test Loss: 0.755 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.498155832290649
Epoch: 8, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.682 Vali Acc: 0.847 Test Loss: 0.682 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.2100067138671875
Epoch: 9, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.689 Vali Acc: 0.859 Test Loss: 0.689 Test Acc: 0.859
Validation loss decreased (-0.849995 --> -0.859368).  Saving model ...
Epoch: 10 cost time: 4.110401391983032
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.728 Vali Acc: 0.853 Test Loss: 0.728 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.0818705558776855
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.756 Vali Acc: 0.847 Test Loss: 0.756 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.089462041854858
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.752 Vali Acc: 0.847 Test Loss: 0.752 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.003683805465698
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.760 Vali Acc: 0.847 Test Loss: 0.760 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.991878032684326
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.759 Vali Acc: 0.847 Test Loss: 0.759 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.108575820922852
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.760 Vali Acc: 0.853 Test Loss: 0.760 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.011046648025513
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.766 Vali Acc: 0.850 Test Loss: 0.766 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.053090333938599
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.771 Vali Acc: 0.856 Test Loss: 0.771 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.8263285160064697
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.778 Vali Acc: 0.853 Test Loss: 0.778 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.82096791267395
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.780 Vali Acc: 0.853 Test Loss: 0.780 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 5831560
model size : 24.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 6.966682195663452
Epoch: 1, Steps: 8 | Train Loss: 2.001 Vali Loss: 1.489 Vali Acc: 0.672 Test Loss: 1.489 Test Acc: 0.672
Validation loss decreased (inf --> -0.671860).  Saving model ...
Epoch: 2 cost time: 5.555819034576416
Epoch: 2, Steps: 8 | Train Loss: 1.000 Vali Loss: 0.606 Vali Acc: 0.825 Test Loss: 0.606 Test Acc: 0.825
Validation loss decreased (-0.671860 --> -0.824994).  Saving model ...
Epoch: 3 cost time: 5.38172721862793
Epoch: 3, Steps: 8 | Train Loss: 0.433 Vali Loss: 0.503 Vali Acc: 0.856 Test Loss: 0.503 Test Acc: 0.856
Validation loss decreased (-0.824994 --> -0.856245).  Saving model ...
Epoch: 4 cost time: 5.4478654861450195
Epoch: 4, Steps: 8 | Train Loss: 0.197 Vali Loss: 0.508 Vali Acc: 0.872 Test Loss: 0.508 Test Acc: 0.872
Validation loss decreased (-0.856245 --> -0.871870).  Saving model ...
Epoch: 5 cost time: 3.9831936359405518
Epoch: 5, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.629 Vali Acc: 0.856 Test Loss: 0.629 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.716023921966553
Epoch: 6, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.619 Vali Acc: 0.853 Test Loss: 0.619 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.6726343631744385
Epoch: 7, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.617 Vali Acc: 0.853 Test Loss: 0.617 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.816713094711304
Epoch: 8, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.670 Vali Acc: 0.841 Test Loss: 0.670 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.631948232650757
Epoch: 9, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.800 Vali Acc: 0.838 Test Loss: 0.800 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.329065561294556
Epoch: 10, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.818 Vali Acc: 0.834 Test Loss: 0.818 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.244455099105835
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.756 Vali Acc: 0.838 Test Loss: 0.756 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.224200010299683
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.748 Vali Acc: 0.850 Test Loss: 0.748 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.296541690826416
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.767 Vali Acc: 0.859 Test Loss: 0.767 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 5.732931852340698
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.766 Vali Acc: 0.856 Test Loss: 0.766 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 19070856
model size : 75.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.1328840255737305
Epoch: 1, Steps: 8 | Train Loss: 1.998 Vali Loss: 1.469 Vali Acc: 0.728 Test Loss: 1.469 Test Acc: 0.728
Validation loss decreased (inf --> -0.728110).  Saving model ...
Epoch: 2 cost time: 2.6222143173217773
Epoch: 2, Steps: 8 | Train Loss: 0.995 Vali Loss: 0.651 Vali Acc: 0.806 Test Loss: 0.651 Test Acc: 0.806
Validation loss decreased (-0.728110 --> -0.806243).  Saving model ...
Epoch: 3 cost time: 2.4787044525146484
Epoch: 3, Steps: 8 | Train Loss: 0.400 Vali Loss: 0.528 Vali Acc: 0.847 Test Loss: 0.528 Test Acc: 0.847
Validation loss decreased (-0.806243 --> -0.846870).  Saving model ...
Epoch: 4 cost time: 2.4346601963043213
Epoch: 4, Steps: 8 | Train Loss: 0.231 Vali Loss: 0.554 Vali Acc: 0.828 Test Loss: 0.554 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.523421287536621
Epoch: 5, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.585 Vali Acc: 0.856 Test Loss: 0.585 Test Acc: 0.856
Validation loss decreased (-0.846870 --> -0.856244).  Saving model ...
Epoch: 6 cost time: 2.6430366039276123
Epoch: 6, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.707 Vali Acc: 0.841 Test Loss: 0.707 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.6916110515594482
Epoch: 7, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.753 Vali Acc: 0.834 Test Loss: 0.753 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.71531343460083
Epoch: 8, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.694 Vali Acc: 0.850 Test Loss: 0.694 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.848325490951538
Epoch: 9, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.722 Vali Acc: 0.853 Test Loss: 0.722 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.4663586616516113
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.772 Vali Acc: 0.850 Test Loss: 0.772 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.893040418624878
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.796 Vali Acc: 0.847 Test Loss: 0.796 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.918982982635498
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.785 Vali Acc: 0.838 Test Loss: 0.785 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.8357083797454834
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.794 Vali Acc: 0.834 Test Loss: 0.794 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.733966588973999
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.799 Vali Acc: 0.834 Test Loss: 0.799 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.8526854515075684
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.804 Vali Acc: 0.834 Test Loss: 0.804 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 5831560
model size : 24.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 15.602226972579956
Epoch: 1, Steps: 8 | Train Loss: 1.989 Vali Loss: 1.662 Vali Acc: 0.519 Test Loss: 1.662 Test Acc: 0.519
Validation loss decreased (inf --> -0.518733).  Saving model ...
Epoch: 2 cost time: 14.161770582199097
Epoch: 2, Steps: 8 | Train Loss: 1.285 Vali Loss: 0.906 Vali Acc: 0.809 Test Loss: 0.906 Test Acc: 0.809
Validation loss decreased (-0.518733 --> -0.809366).  Saving model ...
Epoch: 3 cost time: 14.857377767562866
Epoch: 3, Steps: 8 | Train Loss: 0.674 Vali Loss: 0.529 Vali Acc: 0.838 Test Loss: 0.529 Test Acc: 0.838
Validation loss decreased (-0.809366 --> -0.837495).  Saving model ...
Epoch: 4 cost time: 14.88023853302002
Epoch: 4, Steps: 8 | Train Loss: 0.342 Vali Loss: 0.465 Vali Acc: 0.850 Test Loss: 0.465 Test Acc: 0.850
Validation loss decreased (-0.837495 --> -0.849995).  Saving model ...
Epoch: 5 cost time: 13.830060958862305
Epoch: 5, Steps: 8 | Train Loss: 0.173 Vali Loss: 0.483 Vali Acc: 0.853 Test Loss: 0.483 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 6 cost time: 13.605038404464722
Epoch: 6, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.473 Vali Acc: 0.872 Test Loss: 0.473 Test Acc: 0.872
Validation loss decreased (-0.853120 --> -0.871870).  Saving model ...
Epoch: 7 cost time: 14.50370979309082
Epoch: 7, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.482 Vali Acc: 0.863 Test Loss: 0.482 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 14.608829259872437
Epoch: 8, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.533 Vali Acc: 0.838 Test Loss: 0.533 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 14.011456966400146
Epoch: 9, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.578 Vali Acc: 0.866 Test Loss: 0.578 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 14.263547658920288
Epoch: 10, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.589 Vali Acc: 0.856 Test Loss: 0.589 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 15.200374126434326
Epoch: 11, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.591 Vali Acc: 0.859 Test Loss: 0.591 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 14.413355350494385
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.605 Vali Acc: 0.866 Test Loss: 0.605 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 12.71968412399292
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.610 Vali Acc: 0.878 Test Loss: 0.610 Test Acc: 0.878
Validation loss decreased (-0.871870 --> -0.878119).  Saving model ...
Epoch: 14 cost time: 13.037115097045898
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.604 Vali Acc: 0.872 Test Loss: 0.604 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 13.097212791442871
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.614 Vali Acc: 0.869 Test Loss: 0.614 Test Acc: 0.869
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 12.553559064865112
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.632 Vali Acc: 0.875 Test Loss: 0.632 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 12.647866010665894
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.644 Vali Acc: 0.869 Test Loss: 0.644 Test Acc: 0.869
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 13.481975078582764
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.653 Vali Acc: 0.872 Test Loss: 0.653 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 13.85448431968689
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.655 Vali Acc: 0.872 Test Loss: 0.655 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 12.873192310333252
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.665 Vali Acc: 0.872 Test Loss: 0.665 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 12.99906611442566
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.671 Vali Acc: 0.866 Test Loss: 0.671 Test Acc: 0.866
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 13.849331617355347
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.675 Vali Acc: 0.869 Test Loss: 0.675 Test Acc: 0.869
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 12.300464391708374
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.672 Vali Acc: 0.875 Test Loss: 0.672 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.878125
model parameter : 18909384
model size : 73.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 6.897048711776733
Epoch: 1, Steps: 8 | Train Loss: 1.974 Vali Loss: 1.637 Vali Acc: 0.531 Test Loss: 1.637 Test Acc: 0.531
Validation loss decreased (inf --> -0.531234).  Saving model ...
Epoch: 2 cost time: 5.580489635467529
Epoch: 2, Steps: 8 | Train Loss: 1.255 Vali Loss: 0.899 Vali Acc: 0.747 Test Loss: 0.899 Test Acc: 0.747
Validation loss decreased (-0.531234 --> -0.746866).  Saving model ...
Epoch: 3 cost time: 5.616811037063599
Epoch: 3, Steps: 8 | Train Loss: 0.632 Vali Loss: 0.592 Vali Acc: 0.800 Test Loss: 0.592 Test Acc: 0.800
Validation loss decreased (-0.746866 --> -0.799994).  Saving model ...
Epoch: 4 cost time: 6.072641134262085
Epoch: 4, Steps: 8 | Train Loss: 0.360 Vali Loss: 0.499 Vali Acc: 0.847 Test Loss: 0.499 Test Acc: 0.847
Validation loss decreased (-0.799994 --> -0.846870).  Saving model ...
Epoch: 5 cost time: 5.564186096191406
Epoch: 5, Steps: 8 | Train Loss: 0.203 Vali Loss: 0.476 Vali Acc: 0.834 Test Loss: 0.476 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.633883714675903
Epoch: 6, Steps: 8 | Train Loss: 0.109 Vali Loss: 0.489 Vali Acc: 0.844 Test Loss: 0.489 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.617163181304932
Epoch: 7, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.512 Vali Acc: 0.853 Test Loss: 0.512 Test Acc: 0.853
Validation loss decreased (-0.846870 --> -0.853120).  Saving model ...
Epoch: 8 cost time: 5.976345062255859
Epoch: 8, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.540 Vali Acc: 0.853 Test Loss: 0.540 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.104071140289307
Epoch: 9, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.555 Vali Acc: 0.859 Test Loss: 0.555 Test Acc: 0.859
Validation loss decreased (-0.853120 --> -0.859369).  Saving model ...
Epoch: 10 cost time: 6.331326723098755
Epoch: 10, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.569 Vali Acc: 0.853 Test Loss: 0.569 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.170241117477417
Epoch: 11, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.574 Vali Acc: 0.850 Test Loss: 0.574 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.730179071426392
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.589 Vali Acc: 0.853 Test Loss: 0.589 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.853082656860352
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.606 Vali Acc: 0.853 Test Loss: 0.606 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.820840120315552
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.608 Vali Acc: 0.856 Test Loss: 0.608 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.770669937133789
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.616 Vali Acc: 0.856 Test Loss: 0.616 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.146084785461426
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.620 Vali Acc: 0.856 Test Loss: 0.620 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 6.06593132019043
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.625 Vali Acc: 0.856 Test Loss: 0.625 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.977741956710815
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.634 Vali Acc: 0.856 Test Loss: 0.634 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.314027786254883
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.641 Vali Acc: 0.856 Test Loss: 0.641 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 5669832
model size : 22.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 12.224176406860352
Epoch: 1, Steps: 8 | Train Loss: 1.990 Vali Loss: 1.664 Vali Acc: 0.519 Test Loss: 1.664 Test Acc: 0.519
Validation loss decreased (inf --> -0.518733).  Saving model ...
Epoch: 2 cost time: 11.627771615982056
Epoch: 2, Steps: 8 | Train Loss: 1.291 Vali Loss: 0.920 Vali Acc: 0.806 Test Loss: 0.920 Test Acc: 0.806
Validation loss decreased (-0.518733 --> -0.806241).  Saving model ...
Epoch: 3 cost time: 11.633012771606445
Epoch: 3, Steps: 8 | Train Loss: 0.677 Vali Loss: 0.541 Vali Acc: 0.838 Test Loss: 0.541 Test Acc: 0.838
Validation loss decreased (-0.806241 --> -0.837495).  Saving model ...
Epoch: 4 cost time: 10.877710342407227
Epoch: 4, Steps: 8 | Train Loss: 0.343 Vali Loss: 0.472 Vali Acc: 0.847 Test Loss: 0.472 Test Acc: 0.847
Validation loss decreased (-0.837495 --> -0.846870).  Saving model ...
Epoch: 5 cost time: 10.93635106086731
Epoch: 5, Steps: 8 | Train Loss: 0.171 Vali Loss: 0.487 Vali Acc: 0.847 Test Loss: 0.487 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 11.507740497589111
Epoch: 6, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.478 Vali Acc: 0.863 Test Loss: 0.478 Test Acc: 0.863
Validation loss decreased (-0.846870 --> -0.862495).  Saving model ...
Epoch: 7 cost time: 11.797377824783325
Epoch: 7, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.488 Vali Acc: 0.850 Test Loss: 0.488 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 11.300834894180298
Epoch: 8, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.533 Vali Acc: 0.844 Test Loss: 0.533 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 9.611701965332031
Epoch: 9, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.579 Vali Acc: 0.853 Test Loss: 0.579 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 9.710386037826538
Epoch: 10, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.591 Vali Acc: 0.856 Test Loss: 0.591 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 10.156774044036865
Epoch: 11, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.594 Vali Acc: 0.850 Test Loss: 0.594 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 9.80581521987915
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.610 Vali Acc: 0.863 Test Loss: 0.610 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 9.738039255142212
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.609 Vali Acc: 0.863 Test Loss: 0.609 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 8.981483459472656
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.602 Vali Acc: 0.866 Test Loss: 0.602 Test Acc: 0.866
Validation loss decreased (-0.862495 --> -0.865619).  Saving model ...
Epoch: 15 cost time: 10.640939474105835
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.613 Vali Acc: 0.866 Test Loss: 0.613 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 10.658233165740967
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.633 Vali Acc: 0.869 Test Loss: 0.633 Test Acc: 0.869
Validation loss decreased (-0.865619 --> -0.868744).  Saving model ...
Epoch: 17 cost time: 9.907310009002686
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.646 Vali Acc: 0.863 Test Loss: 0.646 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 10.060707807540894
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.652 Vali Acc: 0.863 Test Loss: 0.652 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 10.205930233001709
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.654 Vali Acc: 0.869 Test Loss: 0.654 Test Acc: 0.869
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 8.005396842956543
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.664 Vali Acc: 0.863 Test Loss: 0.664 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 10.741097450256348
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.672 Vali Acc: 0.859 Test Loss: 0.672 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 10.510989427566528
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.676 Vali Acc: 0.863 Test Loss: 0.676 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 10.394618272781372
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.672 Vali Acc: 0.869 Test Loss: 0.672 Test Acc: 0.869
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 10.505956888198853
Epoch: 24, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.673 Vali Acc: 0.872 Test Loss: 0.673 Test Acc: 0.872
Validation loss decreased (-0.868744 --> -0.871868).  Saving model ...
Epoch: 25 cost time: 10.334748268127441
Epoch: 25, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.676 Vali Acc: 0.875 Test Loss: 0.676 Test Acc: 0.875
Validation loss decreased (-0.871868 --> -0.874993).  Saving model ...
Epoch: 26 cost time: 11.122462749481201
Epoch: 26, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.687 Vali Acc: 0.866 Test Loss: 0.687 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 10.929250001907349
Epoch: 27, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.696 Vali Acc: 0.869 Test Loss: 0.696 Test Acc: 0.869
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 10.596175909042358
Epoch: 28, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.700 Vali Acc: 0.866 Test Loss: 0.700 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 10.825599431991577
Epoch: 29, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.705 Vali Acc: 0.866 Test Loss: 0.705 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 10.682282447814941
Epoch: 30, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.711 Vali Acc: 0.863 Test Loss: 0.711 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.875
model parameter : 18909384
model size : 73.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.7495551109313965
Epoch: 1, Steps: 8 | Train Loss: 1.974 Vali Loss: 1.639 Vali Acc: 0.528 Test Loss: 1.639 Test Acc: 0.528
Validation loss decreased (inf --> -0.528109).  Saving model ...
Epoch: 2 cost time: 4.403700113296509
Epoch: 2, Steps: 8 | Train Loss: 1.255 Vali Loss: 0.903 Vali Acc: 0.747 Test Loss: 0.903 Test Acc: 0.747
Validation loss decreased (-0.528109 --> -0.746866).  Saving model ...
Epoch: 3 cost time: 4.4280126094818115
Epoch: 3, Steps: 8 | Train Loss: 0.632 Vali Loss: 0.596 Vali Acc: 0.800 Test Loss: 0.596 Test Acc: 0.800
Validation loss decreased (-0.746866 --> -0.799994).  Saving model ...
Epoch: 4 cost time: 4.583585739135742
Epoch: 4, Steps: 8 | Train Loss: 0.359 Vali Loss: 0.502 Vali Acc: 0.850 Test Loss: 0.502 Test Acc: 0.850
Validation loss decreased (-0.799994 --> -0.849995).  Saving model ...
Epoch: 5 cost time: 4.145092487335205
Epoch: 5, Steps: 8 | Train Loss: 0.203 Vali Loss: 0.479 Vali Acc: 0.834 Test Loss: 0.479 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.688571214675903
Epoch: 6, Steps: 8 | Train Loss: 0.109 Vali Loss: 0.493 Vali Acc: 0.844 Test Loss: 0.493 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.560973644256592
Epoch: 7, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.516 Vali Acc: 0.853 Test Loss: 0.516 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 8 cost time: 4.610497951507568
Epoch: 8, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.546 Vali Acc: 0.850 Test Loss: 0.546 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.853287935256958
Epoch: 9, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.561 Vali Acc: 0.856 Test Loss: 0.561 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856244).  Saving model ...
Epoch: 10 cost time: 4.874014616012573
Epoch: 10, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.578 Vali Acc: 0.853 Test Loss: 0.578 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.7548418045043945
Epoch: 11, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.584 Vali Acc: 0.853 Test Loss: 0.584 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.919699668884277
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.600 Vali Acc: 0.856 Test Loss: 0.600 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.866595268249512
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.617 Vali Acc: 0.856 Test Loss: 0.617 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.86602258682251
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.618 Vali Acc: 0.859 Test Loss: 0.618 Test Acc: 0.859
Validation loss decreased (-0.856244 --> -0.859369).  Saving model ...
Epoch: 15 cost time: 4.775969982147217
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.626 Vali Acc: 0.859 Test Loss: 0.626 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.9194724559783936
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.630 Vali Acc: 0.856 Test Loss: 0.630 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.583242654800415
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.635 Vali Acc: 0.859 Test Loss: 0.635 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.809133052825928
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.643 Vali Acc: 0.859 Test Loss: 0.643 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.8220672607421875
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.650 Vali Acc: 0.859 Test Loss: 0.650 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.781912803649902
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.648 Vali Acc: 0.856 Test Loss: 0.648 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.842562913894653
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.655 Vali Acc: 0.859 Test Loss: 0.655 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.818688154220581
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.658 Vali Acc: 0.859 Test Loss: 0.658 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.177715063095093
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.663 Vali Acc: 0.859 Test Loss: 0.663 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 4.2253358364105225
Epoch: 24, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.671 Vali Acc: 0.863 Test Loss: 0.671 Test Acc: 0.863
Validation loss decreased (-0.859369 --> -0.862493).  Saving model ...
Epoch: 25 cost time: 4.31528639793396
Epoch: 25, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.677 Vali Acc: 0.863 Test Loss: 0.677 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.135873794555664
Epoch: 26, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.682 Vali Acc: 0.863 Test Loss: 0.682 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 4.001299619674683
Epoch: 27, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.685 Vali Acc: 0.859 Test Loss: 0.685 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 4.266542196273804
Epoch: 28, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.687 Vali Acc: 0.859 Test Loss: 0.687 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 4.366373062133789
Epoch: 29, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.693 Vali Acc: 0.856 Test Loss: 0.693 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 4.412975788116455
Epoch: 30, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.696 Vali Acc: 0.856 Test Loss: 0.696 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 5669832
model size : 22.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 7.563593864440918
Epoch: 1, Steps: 8 | Train Loss: 1.991 Vali Loss: 1.676 Vali Acc: 0.497 Test Loss: 1.676 Test Acc: 0.497
Validation loss decreased (inf --> -0.496858).  Saving model ...
Epoch: 2 cost time: 6.200354337692261
Epoch: 2, Steps: 8 | Train Loss: 1.314 Vali Loss: 0.950 Vali Acc: 0.800 Test Loss: 0.950 Test Acc: 0.800
Validation loss decreased (-0.496858 --> -0.799990).  Saving model ...
Epoch: 3 cost time: 6.1833343505859375
Epoch: 3, Steps: 8 | Train Loss: 0.724 Vali Loss: 0.566 Vali Acc: 0.828 Test Loss: 0.566 Test Acc: 0.828
Validation loss decreased (-0.799990 --> -0.828119).  Saving model ...
Epoch: 4 cost time: 6.227981805801392
Epoch: 4, Steps: 8 | Train Loss: 0.386 Vali Loss: 0.492 Vali Acc: 0.847 Test Loss: 0.492 Test Acc: 0.847
Validation loss decreased (-0.828119 --> -0.846870).  Saving model ...
Epoch: 5 cost time: 6.319663763046265
Epoch: 5, Steps: 8 | Train Loss: 0.206 Vali Loss: 0.520 Vali Acc: 0.828 Test Loss: 0.520 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.165785551071167
Epoch: 6, Steps: 8 | Train Loss: 0.114 Vali Loss: 0.508 Vali Acc: 0.850 Test Loss: 0.508 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 7 cost time: 6.247713804244995
Epoch: 7, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.508 Vali Acc: 0.853 Test Loss: 0.508 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 8 cost time: 6.145496845245361
Epoch: 8, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.547 Vali Acc: 0.847 Test Loss: 0.547 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.997962713241577
Epoch: 9, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.614 Vali Acc: 0.850 Test Loss: 0.614 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.754715204238892
Epoch: 10, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.651 Vali Acc: 0.838 Test Loss: 0.651 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.520256757736206
Epoch: 11, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.657 Vali Acc: 0.828 Test Loss: 0.657 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.281649351119995
Epoch: 12, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.658 Vali Acc: 0.856 Test Loss: 0.658 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856243).  Saving model ...
Epoch: 13 cost time: 6.2490739822387695
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.649 Vali Acc: 0.856 Test Loss: 0.649 Test Acc: 0.856
Validation loss decreased (-0.856243 --> -0.856244).  Saving model ...
Epoch: 14 cost time: 6.428750991821289
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.643 Vali Acc: 0.844 Test Loss: 0.643 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.151665925979614
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.658 Vali Acc: 0.844 Test Loss: 0.658 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.491733074188232
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.680 Vali Acc: 0.847 Test Loss: 0.680 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 6.694593667984009
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.695 Vali Acc: 0.847 Test Loss: 0.695 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.750499963760376
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.702 Vali Acc: 0.844 Test Loss: 0.702 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 6.777101278305054
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.705 Vali Acc: 0.847 Test Loss: 0.705 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 6.729424715042114
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.716 Vali Acc: 0.841 Test Loss: 0.716 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 6.851266384124756
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.724 Vali Acc: 0.844 Test Loss: 0.724 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 6.875294923782349
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.726 Vali Acc: 0.847 Test Loss: 0.726 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 6.7000977993011475
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.721 Vali Acc: 0.847 Test Loss: 0.721 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 18909384
model size : 73.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.399198293685913
Epoch: 1, Steps: 8 | Train Loss: 1.976 Vali Loss: 1.646 Vali Acc: 0.525 Test Loss: 1.646 Test Acc: 0.525
Validation loss decreased (inf --> -0.524984).  Saving model ...
Epoch: 2 cost time: 2.797156810760498
Epoch: 2, Steps: 8 | Train Loss: 1.273 Vali Loss: 0.926 Vali Acc: 0.738 Test Loss: 0.926 Test Acc: 0.738
Validation loss decreased (-0.524984 --> -0.737491).  Saving model ...
Epoch: 3 cost time: 2.8866329193115234
Epoch: 3, Steps: 8 | Train Loss: 0.663 Vali Loss: 0.616 Vali Acc: 0.797 Test Loss: 0.616 Test Acc: 0.797
Validation loss decreased (-0.737491 --> -0.796869).  Saving model ...
Epoch: 4 cost time: 2.9581329822540283
Epoch: 4, Steps: 8 | Train Loss: 0.401 Vali Loss: 0.528 Vali Acc: 0.838 Test Loss: 0.528 Test Acc: 0.838
Validation loss decreased (-0.796869 --> -0.837495).  Saving model ...
Epoch: 5 cost time: 2.8407721519470215
Epoch: 5, Steps: 8 | Train Loss: 0.240 Vali Loss: 0.507 Vali Acc: 0.825 Test Loss: 0.507 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.6501305103302
Epoch: 6, Steps: 8 | Train Loss: 0.128 Vali Loss: 0.515 Vali Acc: 0.856 Test Loss: 0.515 Test Acc: 0.856
Validation loss decreased (-0.837495 --> -0.856245).  Saving model ...
Epoch: 7 cost time: 2.656813621520996
Epoch: 7, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.526 Vali Acc: 0.850 Test Loss: 0.526 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.7503151893615723
Epoch: 8, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.552 Vali Acc: 0.863 Test Loss: 0.552 Test Acc: 0.863
Validation loss decreased (-0.856245 --> -0.862494).  Saving model ...
Epoch: 9 cost time: 2.8492584228515625
Epoch: 9, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.566 Vali Acc: 0.850 Test Loss: 0.566 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.6445019245147705
Epoch: 10, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.593 Vali Acc: 0.853 Test Loss: 0.593 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.6537108421325684
Epoch: 11, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.609 Vali Acc: 0.853 Test Loss: 0.609 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.4561991691589355
Epoch: 12, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.626 Vali Acc: 0.850 Test Loss: 0.626 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.5823750495910645
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.643 Vali Acc: 0.847 Test Loss: 0.643 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.643660068511963
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.641 Vali Acc: 0.841 Test Loss: 0.641 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.609758138656616
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.647 Vali Acc: 0.841 Test Loss: 0.647 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.665881633758545
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.654 Vali Acc: 0.847 Test Loss: 0.654 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.7388501167297363
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.661 Vali Acc: 0.847 Test Loss: 0.661 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.651344060897827
Epoch: 18, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.670 Vali Acc: 0.847 Test Loss: 0.670 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 5669832
model size : 22.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 8.885652780532837
Epoch: 1, Steps: 8 | Train Loss: 2.014 Vali Loss: 1.692 Vali Acc: 0.550 Test Loss: 1.692 Test Acc: 0.550
Validation loss decreased (inf --> -0.549983).  Saving model ...
Epoch: 2 cost time: 7.687467575073242
Epoch: 2, Steps: 8 | Train Loss: 1.312 Vali Loss: 0.911 Vali Acc: 0.781 Test Loss: 0.911 Test Acc: 0.781
Validation loss decreased (-0.549983 --> -0.781241).  Saving model ...
Epoch: 3 cost time: 7.744442701339722
Epoch: 3, Steps: 8 | Train Loss: 0.688 Vali Loss: 0.565 Vali Acc: 0.819 Test Loss: 0.565 Test Acc: 0.819
Validation loss decreased (-0.781241 --> -0.818744).  Saving model ...
Epoch: 4 cost time: 7.667365550994873
Epoch: 4, Steps: 8 | Train Loss: 0.347 Vali Loss: 0.459 Vali Acc: 0.850 Test Loss: 0.459 Test Acc: 0.850
Validation loss decreased (-0.818744 --> -0.849995).  Saving model ...
Epoch: 5 cost time: 8.328693866729736
Epoch: 5, Steps: 8 | Train Loss: 0.207 Vali Loss: 0.446 Vali Acc: 0.856 Test Loss: 0.446 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.856246).  Saving model ...
Epoch: 6 cost time: 8.257585287094116
Epoch: 6, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.457 Vali Acc: 0.869 Test Loss: 0.457 Test Acc: 0.869
Validation loss decreased (-0.856246 --> -0.868745).  Saving model ...
Epoch: 7 cost time: 8.409261703491211
Epoch: 7, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.504 Vali Acc: 0.863 Test Loss: 0.504 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.401117324829102
Epoch: 8, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.574 Vali Acc: 0.850 Test Loss: 0.574 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 8.168873071670532
Epoch: 9, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.517 Vali Acc: 0.866 Test Loss: 0.517 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 8.35295820236206
Epoch: 10, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.541 Vali Acc: 0.863 Test Loss: 0.541 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 7.92586088180542
Epoch: 11, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.571 Vali Acc: 0.863 Test Loss: 0.571 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 7.787294387817383
Epoch: 12, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.578 Vali Acc: 0.863 Test Loss: 0.578 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 7.76766300201416
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.585 Vali Acc: 0.859 Test Loss: 0.585 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 7.773452997207642
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.591 Vali Acc: 0.863 Test Loss: 0.591 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 7.9674155712127686
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.598 Vali Acc: 0.863 Test Loss: 0.598 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 8.075694799423218
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.598 Vali Acc: 0.863 Test Loss: 0.598 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 9536200
model size : 37.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.844533205032349
Epoch: 1, Steps: 8 | Train Loss: 2.051 Vali Loss: 1.719 Vali Acc: 0.481 Test Loss: 1.719 Test Acc: 0.481
Validation loss decreased (inf --> -0.481233).  Saving model ...
Epoch: 2 cost time: 3.4774136543273926
Epoch: 2, Steps: 8 | Train Loss: 1.371 Vali Loss: 0.951 Vali Acc: 0.816 Test Loss: 0.951 Test Acc: 0.816
Validation loss decreased (-0.481233 --> -0.815615).  Saving model ...
Epoch: 3 cost time: 3.4889492988586426
Epoch: 3, Steps: 8 | Train Loss: 0.659 Vali Loss: 0.596 Vali Acc: 0.828 Test Loss: 0.596 Test Acc: 0.828
Validation loss decreased (-0.815615 --> -0.828119).  Saving model ...
Epoch: 4 cost time: 3.506892204284668
Epoch: 4, Steps: 8 | Train Loss: 0.377 Vali Loss: 0.475 Vali Acc: 0.859 Test Loss: 0.475 Test Acc: 0.859
Validation loss decreased (-0.828119 --> -0.859370).  Saving model ...
Epoch: 5 cost time: 3.496504783630371
Epoch: 5, Steps: 8 | Train Loss: 0.243 Vali Loss: 0.496 Vali Acc: 0.841 Test Loss: 0.496 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.587162971496582
Epoch: 6, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.502 Vali Acc: 0.866 Test Loss: 0.502 Test Acc: 0.866
Validation loss decreased (-0.859370 --> -0.865620).  Saving model ...
Epoch: 7 cost time: 3.4810736179351807
Epoch: 7, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.621 Vali Acc: 0.844 Test Loss: 0.621 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.41400408744812
Epoch: 8, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.611 Vali Acc: 0.847 Test Loss: 0.611 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.534756898880005
Epoch: 9, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.607 Vali Acc: 0.850 Test Loss: 0.607 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.4502410888671875
Epoch: 10, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.616 Vali Acc: 0.844 Test Loss: 0.616 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.3891515731811523
Epoch: 11, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.643 Vali Acc: 0.841 Test Loss: 0.643 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.387235164642334
Epoch: 12, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.659 Vali Acc: 0.838 Test Loss: 0.659 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.364041566848755
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.661 Vali Acc: 0.844 Test Loss: 0.661 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.303061008453369
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.661 Vali Acc: 0.847 Test Loss: 0.661 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.2735252380371094
Epoch: 15, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.668 Vali Acc: 0.841 Test Loss: 0.668 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.2047476768493652
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.676 Vali Acc: 0.841 Test Loss: 0.676 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 2916296
model size : 12.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 7.295752048492432
Epoch: 1, Steps: 8 | Train Loss: 2.016 Vali Loss: 1.700 Vali Acc: 0.544 Test Loss: 1.700 Test Acc: 0.544
Validation loss decreased (inf --> -0.543733).  Saving model ...
Epoch: 2 cost time: 5.780328273773193
Epoch: 2, Steps: 8 | Train Loss: 1.330 Vali Loss: 0.935 Vali Acc: 0.778 Test Loss: 0.935 Test Acc: 0.778
Validation loss decreased (-0.543733 --> -0.778116).  Saving model ...
Epoch: 3 cost time: 5.713377475738525
Epoch: 3, Steps: 8 | Train Loss: 0.705 Vali Loss: 0.584 Vali Acc: 0.816 Test Loss: 0.584 Test Acc: 0.816
Validation loss decreased (-0.778116 --> -0.815619).  Saving model ...
Epoch: 4 cost time: 5.760115146636963
Epoch: 4, Steps: 8 | Train Loss: 0.350 Vali Loss: 0.470 Vali Acc: 0.850 Test Loss: 0.470 Test Acc: 0.850
Validation loss decreased (-0.815619 --> -0.849995).  Saving model ...
Epoch: 5 cost time: 5.989622354507446
Epoch: 5, Steps: 8 | Train Loss: 0.205 Vali Loss: 0.451 Vali Acc: 0.856 Test Loss: 0.451 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.856245).  Saving model ...
Epoch: 6 cost time: 6.393949508666992
Epoch: 6, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.460 Vali Acc: 0.863 Test Loss: 0.460 Test Acc: 0.863
Validation loss decreased (-0.856245 --> -0.862495).  Saving model ...
Epoch: 7 cost time: 6.434134244918823
Epoch: 7, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.512 Vali Acc: 0.856 Test Loss: 0.512 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.335198163986206
Epoch: 8, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.590 Vali Acc: 0.850 Test Loss: 0.590 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.390616416931152
Epoch: 9, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.532 Vali Acc: 0.863 Test Loss: 0.532 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.4620420932769775
Epoch: 10, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.549 Vali Acc: 0.859 Test Loss: 0.549 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.68991494178772
Epoch: 11, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.576 Vali Acc: 0.863 Test Loss: 0.576 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 6.710065841674805
Epoch: 12, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.582 Vali Acc: 0.866 Test Loss: 0.582 Test Acc: 0.866
Validation loss decreased (-0.862495 --> -0.865619).  Saving model ...
Epoch: 13 cost time: 6.525189161300659
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.591 Vali Acc: 0.859 Test Loss: 0.591 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.277037143707275
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.603 Vali Acc: 0.863 Test Loss: 0.603 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.6536242961883545
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.609 Vali Acc: 0.859 Test Loss: 0.609 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.256886720657349
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.609 Vali Acc: 0.863 Test Loss: 0.609 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 6.263137340545654
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.621 Vali Acc: 0.863 Test Loss: 0.621 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 6.591587543487549
Epoch: 18, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.626 Vali Acc: 0.863 Test Loss: 0.626 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 6.0665442943573
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.628 Vali Acc: 0.869 Test Loss: 0.628 Test Acc: 0.869
Validation loss decreased (-0.865619 --> -0.868744).  Saving model ...
Epoch: 20 cost time: 5.722566604614258
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.626 Vali Acc: 0.875 Test Loss: 0.626 Test Acc: 0.875
Validation loss decreased (-0.868744 --> -0.874994).  Saving model ...
Epoch: 21 cost time: 6.158346891403198
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.626 Vali Acc: 0.875 Test Loss: 0.626 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 22 cost time: 5.954996585845947
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.635 Vali Acc: 0.869 Test Loss: 0.635 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 6.149621963500977
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.641 Vali Acc: 0.869 Test Loss: 0.641 Test Acc: 0.869
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 5.952576160430908
Epoch: 24, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.646 Vali Acc: 0.872 Test Loss: 0.646 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 5.937128782272339
Epoch: 25, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.655 Vali Acc: 0.872 Test Loss: 0.655 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 5.838796854019165
Epoch: 26, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.660 Vali Acc: 0.872 Test Loss: 0.660 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 5.891675233840942
Epoch: 27, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.662 Vali Acc: 0.872 Test Loss: 0.662 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 5.900538444519043
Epoch: 28, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.665 Vali Acc: 0.875 Test Loss: 0.665 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 5.9393792152404785
Epoch: 29, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.668 Vali Acc: 0.872 Test Loss: 0.668 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 6.044511079788208
Epoch: 30, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.672 Vali Acc: 0.875 Test Loss: 0.672 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.875
model parameter : 9536200
model size : 37.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.275049686431885
Epoch: 1, Steps: 8 | Train Loss: 2.048 Vali Loss: 1.720 Vali Acc: 0.484 Test Loss: 1.720 Test Acc: 0.484
Validation loss decreased (inf --> -0.484358).  Saving model ...
Epoch: 2 cost time: 2.8391504287719727
Epoch: 2, Steps: 8 | Train Loss: 1.368 Vali Loss: 0.956 Vali Acc: 0.809 Test Loss: 0.956 Test Acc: 0.809
Validation loss decreased (-0.484358 --> -0.809365).  Saving model ...
Epoch: 3 cost time: 2.820719003677368
Epoch: 3, Steps: 8 | Train Loss: 0.660 Vali Loss: 0.600 Vali Acc: 0.828 Test Loss: 0.600 Test Acc: 0.828
Validation loss decreased (-0.809365 --> -0.828119).  Saving model ...
Epoch: 4 cost time: 2.897399425506592
Epoch: 4, Steps: 8 | Train Loss: 0.378 Vali Loss: 0.479 Vali Acc: 0.863 Test Loss: 0.479 Test Acc: 0.863
Validation loss decreased (-0.828119 --> -0.862495).  Saving model ...
Epoch: 5 cost time: 2.7535717487335205
Epoch: 5, Steps: 8 | Train Loss: 0.242 Vali Loss: 0.500 Vali Acc: 0.844 Test Loss: 0.500 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.8058955669403076
Epoch: 6, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.504 Vali Acc: 0.863 Test Loss: 0.504 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.7919487953186035
Epoch: 7, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.621 Vali Acc: 0.847 Test Loss: 0.621 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.830554962158203
Epoch: 8, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.618 Vali Acc: 0.850 Test Loss: 0.618 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.97524356842041
Epoch: 9, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.616 Vali Acc: 0.853 Test Loss: 0.616 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.978069305419922
Epoch: 10, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.622 Vali Acc: 0.850 Test Loss: 0.622 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.0033342838287354
Epoch: 11, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.644 Vali Acc: 0.847 Test Loss: 0.644 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.1295573711395264
Epoch: 12, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.658 Vali Acc: 0.844 Test Loss: 0.658 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.1839916706085205
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.662 Vali Acc: 0.847 Test Loss: 0.662 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.108870267868042
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.664 Vali Acc: 0.850 Test Loss: 0.664 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 2916296
model size : 12.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.419381380081177
Epoch: 1, Steps: 8 | Train Loss: 2.018 Vali Loss: 1.704 Vali Acc: 0.531 Test Loss: 1.704 Test Acc: 0.531
Validation loss decreased (inf --> -0.531233).  Saving model ...
Epoch: 2 cost time: 4.04622483253479
Epoch: 2, Steps: 8 | Train Loss: 1.342 Vali Loss: 0.950 Vali Acc: 0.772 Test Loss: 0.950 Test Acc: 0.772
Validation loss decreased (-0.531233 --> -0.771865).  Saving model ...
Epoch: 3 cost time: 4.0073323249816895
Epoch: 3, Steps: 8 | Train Loss: 0.725 Vali Loss: 0.600 Vali Acc: 0.812 Test Loss: 0.600 Test Acc: 0.812
Validation loss decreased (-0.771865 --> -0.812494).  Saving model ...
Epoch: 4 cost time: 4.02797794342041
Epoch: 4, Steps: 8 | Train Loss: 0.381 Vali Loss: 0.486 Vali Acc: 0.847 Test Loss: 0.486 Test Acc: 0.847
Validation loss decreased (-0.812494 --> -0.846870).  Saving model ...
Epoch: 5 cost time: 4.028989553451538
Epoch: 5, Steps: 8 | Train Loss: 0.242 Vali Loss: 0.475 Vali Acc: 0.853 Test Loss: 0.475 Test Acc: 0.853
Validation loss decreased (-0.846870 --> -0.853120).  Saving model ...
Epoch: 6 cost time: 3.918668746948242
Epoch: 6, Steps: 8 | Train Loss: 0.149 Vali Loss: 0.483 Vali Acc: 0.869 Test Loss: 0.483 Test Acc: 0.869
Validation loss decreased (-0.853120 --> -0.868745).  Saving model ...
Epoch: 7 cost time: 3.9851272106170654
Epoch: 7, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.543 Vali Acc: 0.859 Test Loss: 0.543 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.044657945632935
Epoch: 8, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.602 Vali Acc: 0.850 Test Loss: 0.602 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.6685869693756104
Epoch: 9, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.536 Vali Acc: 0.859 Test Loss: 0.536 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.090377569198608
Epoch: 10, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.579 Vali Acc: 0.859 Test Loss: 0.579 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.008917331695557
Epoch: 11, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.636 Vali Acc: 0.853 Test Loss: 0.636 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.8979270458221436
Epoch: 12, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.657 Vali Acc: 0.850 Test Loss: 0.657 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.9379117488861084
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.648 Vali Acc: 0.847 Test Loss: 0.648 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.9750843048095703
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.646 Vali Acc: 0.850 Test Loss: 0.646 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.561291217803955
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.652 Vali Acc: 0.850 Test Loss: 0.652 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.6189708709716797
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.656 Vali Acc: 0.850 Test Loss: 0.656 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 9536200
model size : 37.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.458470344543457
Epoch: 1, Steps: 8 | Train Loss: 2.050 Vali Loss: 1.727 Vali Acc: 0.459 Test Loss: 1.727 Test Acc: 0.459
Validation loss decreased (inf --> -0.459358).  Saving model ...
Epoch: 2 cost time: 1.8835828304290771
Epoch: 2, Steps: 8 | Train Loss: 1.385 Vali Loss: 0.971 Vali Acc: 0.809 Test Loss: 0.971 Test Acc: 0.809
Validation loss decreased (-0.459358 --> -0.809365).  Saving model ...
Epoch: 3 cost time: 1.8890883922576904
Epoch: 3, Steps: 8 | Train Loss: 0.673 Vali Loss: 0.611 Vali Acc: 0.828 Test Loss: 0.611 Test Acc: 0.828
Validation loss decreased (-0.809365 --> -0.828119).  Saving model ...
Epoch: 4 cost time: 1.9172923564910889
Epoch: 4, Steps: 8 | Train Loss: 0.398 Vali Loss: 0.489 Vali Acc: 0.856 Test Loss: 0.489 Test Acc: 0.856
Validation loss decreased (-0.828119 --> -0.856245).  Saving model ...
Epoch: 5 cost time: 1.8790578842163086
Epoch: 5, Steps: 8 | Train Loss: 0.271 Vali Loss: 0.528 Vali Acc: 0.831 Test Loss: 0.528 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8884828090667725
Epoch: 6, Steps: 8 | Train Loss: 0.135 Vali Loss: 0.526 Vali Acc: 0.859 Test Loss: 0.526 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 7 cost time: 1.965010166168213
Epoch: 7, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.642 Vali Acc: 0.847 Test Loss: 0.642 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8993451595306396
Epoch: 8, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.631 Vali Acc: 0.831 Test Loss: 0.631 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8739032745361328
Epoch: 9, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.613 Vali Acc: 0.847 Test Loss: 0.613 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.907400369644165
Epoch: 10, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.607 Vali Acc: 0.856 Test Loss: 0.607 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.0228419303894043
Epoch: 11, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.634 Vali Acc: 0.850 Test Loss: 0.634 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.9577653408050537
Epoch: 12, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.656 Vali Acc: 0.847 Test Loss: 0.656 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.980119228363037
Epoch: 13, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.664 Vali Acc: 0.850 Test Loss: 0.664 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.946242094039917
Epoch: 14, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.669 Vali Acc: 0.850 Test Loss: 0.669 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.9762494564056396
Epoch: 15, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.681 Vali Acc: 0.850 Test Loss: 0.681 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.0109434127807617
Epoch: 16, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.690 Vali Acc: 0.850 Test Loss: 0.690 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 2916296
model size : 12.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 6.718409061431885
Epoch: 1, Steps: 8 | Train Loss: 1.895 Vali Loss: 1.585 Vali Acc: 0.678 Test Loss: 1.585 Test Acc: 0.678
Validation loss decreased (inf --> -0.678109).  Saving model ...
Epoch: 2 cost time: 5.114851713180542
Epoch: 2, Steps: 8 | Train Loss: 1.274 Vali Loss: 0.904 Vali Acc: 0.809 Test Loss: 0.904 Test Acc: 0.809
Validation loss decreased (-0.678109 --> -0.809366).  Saving model ...
Epoch: 3 cost time: 5.238489151000977
Epoch: 3, Steps: 8 | Train Loss: 0.678 Vali Loss: 0.583 Vali Acc: 0.838 Test Loss: 0.583 Test Acc: 0.838
Validation loss decreased (-0.809366 --> -0.837494).  Saving model ...
Epoch: 4 cost time: 5.1570680141448975
Epoch: 4, Steps: 8 | Train Loss: 0.413 Vali Loss: 0.503 Vali Acc: 0.856 Test Loss: 0.503 Test Acc: 0.856
Validation loss decreased (-0.837494 --> -0.856245).  Saving model ...
Epoch: 5 cost time: 5.015562295913696
Epoch: 5, Steps: 8 | Train Loss: 0.207 Vali Loss: 0.488 Vali Acc: 0.859 Test Loss: 0.488 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 6 cost time: 5.111536979675293
Epoch: 6, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.503 Vali Acc: 0.859 Test Loss: 0.503 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.136243104934692
Epoch: 7, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.535 Vali Acc: 0.856 Test Loss: 0.535 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.934102535247803
Epoch: 8, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.589 Vali Acc: 0.850 Test Loss: 0.589 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.062392473220825
Epoch: 9, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.579 Vali Acc: 0.847 Test Loss: 0.579 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.360591411590576
Epoch: 10, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.590 Vali Acc: 0.850 Test Loss: 0.590 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.248900413513184
Epoch: 11, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.631 Vali Acc: 0.850 Test Loss: 0.631 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.9265406131744385
Epoch: 12, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.671 Vali Acc: 0.850 Test Loss: 0.671 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 5.154391050338745
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.666 Vali Acc: 0.853 Test Loss: 0.666 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 5.495517730712891
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.657 Vali Acc: 0.856 Test Loss: 0.657 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 5.3232810497283936
Epoch: 15, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.656 Vali Acc: 0.859 Test Loss: 0.656 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 4849608
model size : 19.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.117367506027222
Epoch: 1, Steps: 8 | Train Loss: 2.116 Vali Loss: 1.752 Vali Acc: 0.456 Test Loss: 1.752 Test Acc: 0.456
Validation loss decreased (inf --> -0.456232).  Saving model ...
Epoch: 2 cost time: 2.7594833374023438
Epoch: 2, Steps: 8 | Train Loss: 1.372 Vali Loss: 0.929 Vali Acc: 0.803 Test Loss: 0.929 Test Acc: 0.803
Validation loss decreased (-0.456232 --> -0.803116).  Saving model ...
Epoch: 3 cost time: 2.7244479656219482
Epoch: 3, Steps: 8 | Train Loss: 0.642 Vali Loss: 0.566 Vali Acc: 0.828 Test Loss: 0.566 Test Acc: 0.828
Validation loss decreased (-0.803116 --> -0.828119).  Saving model ...
Epoch: 4 cost time: 2.723961353302002
Epoch: 4, Steps: 8 | Train Loss: 0.386 Vali Loss: 0.482 Vali Acc: 0.850 Test Loss: 0.482 Test Acc: 0.850
Validation loss decreased (-0.828119 --> -0.849995).  Saving model ...
Epoch: 5 cost time: 2.7114875316619873
Epoch: 5, Steps: 8 | Train Loss: 0.188 Vali Loss: 0.463 Vali Acc: 0.863 Test Loss: 0.463 Test Acc: 0.863
Validation loss decreased (-0.849995 --> -0.862495).  Saving model ...
Epoch: 6 cost time: 2.766456365585327
Epoch: 6, Steps: 8 | Train Loss: 0.109 Vali Loss: 0.475 Vali Acc: 0.859 Test Loss: 0.475 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.769942283630371
Epoch: 7, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.504 Vali Acc: 0.863 Test Loss: 0.504 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.832028388977051
Epoch: 8, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.522 Vali Acc: 0.856 Test Loss: 0.522 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.721698760986328
Epoch: 9, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.543 Vali Acc: 0.863 Test Loss: 0.543 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.8346519470214844
Epoch: 10, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.564 Vali Acc: 0.859 Test Loss: 0.564 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.801730155944824
Epoch: 11, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.578 Vali Acc: 0.853 Test Loss: 0.578 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.705272674560547
Epoch: 12, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.587 Vali Acc: 0.853 Test Loss: 0.587 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.7013165950775146
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.598 Vali Acc: 0.859 Test Loss: 0.598 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.793945074081421
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.605 Vali Acc: 0.863 Test Loss: 0.605 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.744790554046631
Epoch: 15, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.609 Vali Acc: 0.863 Test Loss: 0.609 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 1539528
model size : 7.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.780072927474976
Epoch: 1, Steps: 8 | Train Loss: 1.895 Vali Loss: 1.586 Vali Acc: 0.678 Test Loss: 1.586 Test Acc: 0.678
Validation loss decreased (inf --> -0.678109).  Saving model ...
Epoch: 2 cost time: 4.098337411880493
Epoch: 2, Steps: 8 | Train Loss: 1.274 Vali Loss: 0.906 Vali Acc: 0.809 Test Loss: 0.906 Test Acc: 0.809
Validation loss decreased (-0.678109 --> -0.809366).  Saving model ...
Epoch: 3 cost time: 3.813666582107544
Epoch: 3, Steps: 8 | Train Loss: 0.678 Vali Loss: 0.584 Vali Acc: 0.834 Test Loss: 0.584 Test Acc: 0.834
Validation loss decreased (-0.809366 --> -0.834369).  Saving model ...
Epoch: 4 cost time: 4.058596849441528
Epoch: 4, Steps: 8 | Train Loss: 0.411 Vali Loss: 0.504 Vali Acc: 0.856 Test Loss: 0.504 Test Acc: 0.856
Validation loss decreased (-0.834369 --> -0.856245).  Saving model ...
Epoch: 5 cost time: 3.818898916244507
Epoch: 5, Steps: 8 | Train Loss: 0.205 Vali Loss: 0.489 Vali Acc: 0.859 Test Loss: 0.489 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 6 cost time: 3.7935826778411865
Epoch: 6, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.503 Vali Acc: 0.859 Test Loss: 0.503 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.7636141777038574
Epoch: 7, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.535 Vali Acc: 0.853 Test Loss: 0.535 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.8399486541748047
Epoch: 8, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.590 Vali Acc: 0.850 Test Loss: 0.590 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.809148073196411
Epoch: 9, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.581 Vali Acc: 0.847 Test Loss: 0.581 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.029052972793579
Epoch: 10, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.591 Vali Acc: 0.850 Test Loss: 0.591 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.710568428039551
Epoch: 11, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.634 Vali Acc: 0.844 Test Loss: 0.634 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.861395835876465
Epoch: 12, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.674 Vali Acc: 0.847 Test Loss: 0.674 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.993335485458374
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.668 Vali Acc: 0.853 Test Loss: 0.668 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.0444560050964355
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.659 Vali Acc: 0.856 Test Loss: 0.659 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.187930583953857
Epoch: 15, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.658 Vali Acc: 0.856 Test Loss: 0.658 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 4849608
model size : 19.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.7115960121154785
Epoch: 1, Steps: 8 | Train Loss: 2.118 Vali Loss: 1.756 Vali Acc: 0.450 Test Loss: 1.756 Test Acc: 0.450
Validation loss decreased (inf --> -0.449982).  Saving model ...
Epoch: 2 cost time: 2.176936149597168
Epoch: 2, Steps: 8 | Train Loss: 1.376 Vali Loss: 0.945 Vali Acc: 0.806 Test Loss: 0.945 Test Acc: 0.806
Validation loss decreased (-0.449982 --> -0.806241).  Saving model ...
Epoch: 3 cost time: 2.059861421585083
Epoch: 3, Steps: 8 | Train Loss: 0.652 Vali Loss: 0.578 Vali Acc: 0.828 Test Loss: 0.578 Test Acc: 0.828
Validation loss decreased (-0.806241 --> -0.828119).  Saving model ...
Epoch: 4 cost time: 2.1205410957336426
Epoch: 4, Steps: 8 | Train Loss: 0.391 Vali Loss: 0.493 Vali Acc: 0.847 Test Loss: 0.493 Test Acc: 0.847
Validation loss decreased (-0.828119 --> -0.846870).  Saving model ...
Epoch: 5 cost time: 2.0900142192840576
Epoch: 5, Steps: 8 | Train Loss: 0.189 Vali Loss: 0.470 Vali Acc: 0.863 Test Loss: 0.470 Test Acc: 0.863
Validation loss decreased (-0.846870 --> -0.862495).  Saving model ...
Epoch: 6 cost time: 2.0789101123809814
Epoch: 6, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.482 Vali Acc: 0.856 Test Loss: 0.482 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.137995958328247
Epoch: 7, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.516 Vali Acc: 0.856 Test Loss: 0.516 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.070455551147461
Epoch: 8, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.535 Vali Acc: 0.856 Test Loss: 0.535 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.151078939437866
Epoch: 9, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.555 Vali Acc: 0.853 Test Loss: 0.555 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.0976953506469727
Epoch: 10, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.575 Vali Acc: 0.859 Test Loss: 0.575 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.1760025024414062
Epoch: 11, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.589 Vali Acc: 0.856 Test Loss: 0.589 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.0830931663513184
Epoch: 12, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.599 Vali Acc: 0.853 Test Loss: 0.599 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.2980871200561523
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.612 Vali Acc: 0.856 Test Loss: 0.612 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.2123401165008545
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.621 Vali Acc: 0.853 Test Loss: 0.621 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.366811990737915
Epoch: 15, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.626 Vali Acc: 0.853 Test Loss: 0.626 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 1539528
model size : 7.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.9830079078674316
Epoch: 1, Steps: 8 | Train Loss: 1.896 Vali Loss: 1.592 Vali Acc: 0.666 Test Loss: 1.592 Test Acc: 0.666
Validation loss decreased (inf --> -0.665609).  Saving model ...
Epoch: 2 cost time: 2.8253180980682373
Epoch: 2, Steps: 8 | Train Loss: 1.281 Vali Loss: 0.917 Vali Acc: 0.806 Test Loss: 0.917 Test Acc: 0.806
Validation loss decreased (-0.665609 --> -0.806241).  Saving model ...
Epoch: 3 cost time: 2.5464389324188232
Epoch: 3, Steps: 8 | Train Loss: 0.693 Vali Loss: 0.595 Vali Acc: 0.831 Test Loss: 0.595 Test Acc: 0.831
Validation loss decreased (-0.806241 --> -0.831244).  Saving model ...
Epoch: 4 cost time: 2.5593318939208984
Epoch: 4, Steps: 8 | Train Loss: 0.450 Vali Loss: 0.517 Vali Acc: 0.853 Test Loss: 0.517 Test Acc: 0.853
Validation loss decreased (-0.831244 --> -0.853120).  Saving model ...
Epoch: 5 cost time: 2.559037685394287
Epoch: 5, Steps: 8 | Train Loss: 0.244 Vali Loss: 0.501 Vali Acc: 0.856 Test Loss: 0.501 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 6 cost time: 2.6087934970855713
Epoch: 6, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.522 Vali Acc: 0.859 Test Loss: 0.522 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 7 cost time: 2.5344018936157227
Epoch: 7, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.558 Vali Acc: 0.859 Test Loss: 0.558 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.5833187103271484
Epoch: 8, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.595 Vali Acc: 0.853 Test Loss: 0.595 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.720245122909546
Epoch: 9, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.586 Vali Acc: 0.853 Test Loss: 0.586 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.582030773162842
Epoch: 10, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.608 Vali Acc: 0.853 Test Loss: 0.608 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.550096035003662
Epoch: 11, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.649 Vali Acc: 0.853 Test Loss: 0.649 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.739225149154663
Epoch: 12, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.677 Vali Acc: 0.856 Test Loss: 0.677 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.5501701831817627
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.681 Vali Acc: 0.853 Test Loss: 0.681 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.798285722732544
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.682 Vali Acc: 0.847 Test Loss: 0.682 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.638521909713745
Epoch: 15, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.684 Vali Acc: 0.850 Test Loss: 0.684 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.741551399230957
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.684 Vali Acc: 0.856 Test Loss: 0.684 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 4849608
model size : 19.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.900702953338623
Epoch: 1, Steps: 8 | Train Loss: 2.125 Vali Loss: 1.759 Vali Acc: 0.453 Test Loss: 1.759 Test Acc: 0.453
Validation loss decreased (inf --> -0.453107).  Saving model ...
Epoch: 2 cost time: 1.5245730876922607
Epoch: 2, Steps: 8 | Train Loss: 1.383 Vali Loss: 0.958 Vali Acc: 0.803 Test Loss: 0.958 Test Acc: 0.803
Validation loss decreased (-0.453107 --> -0.803115).  Saving model ...
Epoch: 3 cost time: 1.5788991451263428
Epoch: 3, Steps: 8 | Train Loss: 0.667 Vali Loss: 0.591 Vali Acc: 0.831 Test Loss: 0.591 Test Acc: 0.831
Validation loss decreased (-0.803115 --> -0.831244).  Saving model ...
Epoch: 4 cost time: 1.6004762649536133
Epoch: 4, Steps: 8 | Train Loss: 0.415 Vali Loss: 0.508 Vali Acc: 0.847 Test Loss: 0.508 Test Acc: 0.847
Validation loss decreased (-0.831244 --> -0.846870).  Saving model ...
Epoch: 5 cost time: 1.6104168891906738
Epoch: 5, Steps: 8 | Train Loss: 0.211 Vali Loss: 0.491 Vali Acc: 0.863 Test Loss: 0.491 Test Acc: 0.863
Validation loss decreased (-0.846870 --> -0.862495).  Saving model ...
Epoch: 6 cost time: 1.5979609489440918
Epoch: 6, Steps: 8 | Train Loss: 0.133 Vali Loss: 0.505 Vali Acc: 0.856 Test Loss: 0.505 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.60626220703125
Epoch: 7, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.539 Vali Acc: 0.859 Test Loss: 0.539 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4311819076538086
Epoch: 8, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.562 Vali Acc: 0.850 Test Loss: 0.562 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4737200736999512
Epoch: 9, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.582 Vali Acc: 0.850 Test Loss: 0.582 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.435091257095337
Epoch: 10, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.598 Vali Acc: 0.853 Test Loss: 0.598 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.5158820152282715
Epoch: 11, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.621 Vali Acc: 0.853 Test Loss: 0.621 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.505042314529419
Epoch: 12, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.635 Vali Acc: 0.850 Test Loss: 0.635 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.4850497245788574
Epoch: 13, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.642 Vali Acc: 0.856 Test Loss: 0.642 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.4739530086517334
Epoch: 14, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.649 Vali Acc: 0.856 Test Loss: 0.649 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.4840176105499268
Epoch: 15, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.655 Vali Acc: 0.850 Test Loss: 0.655 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 1539528
model size : 7.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 11.054982900619507
Epoch: 1, Steps: 8 | Train Loss: 2.160 Vali Loss: 1.912 Vali Acc: 0.331 Test Loss: 1.912 Test Acc: 0.331
Validation loss decreased (inf --> -0.331231).  Saving model ...
Epoch: 2 cost time: 9.051426649093628
Epoch: 2, Steps: 8 | Train Loss: 1.704 Vali Loss: 1.351 Vali Acc: 0.734 Test Loss: 1.351 Test Acc: 0.734
Validation loss decreased (-0.331231 --> -0.734361).  Saving model ...
Epoch: 3 cost time: 9.01112985610962
Epoch: 3, Steps: 8 | Train Loss: 1.115 Vali Loss: 0.869 Vali Acc: 0.806 Test Loss: 0.869 Test Acc: 0.806
Validation loss decreased (-0.734361 --> -0.806241).  Saving model ...
Epoch: 4 cost time: 8.927565574645996
Epoch: 4, Steps: 8 | Train Loss: 0.673 Vali Loss: 0.623 Vali Acc: 0.816 Test Loss: 0.623 Test Acc: 0.816
Validation loss decreased (-0.806241 --> -0.815619).  Saving model ...
Epoch: 5 cost time: 9.239896297454834
Epoch: 5, Steps: 8 | Train Loss: 0.446 Vali Loss: 0.521 Vali Acc: 0.841 Test Loss: 0.521 Test Acc: 0.841
Validation loss decreased (-0.815619 --> -0.840620).  Saving model ...
Epoch: 6 cost time: 8.915926694869995
Epoch: 6, Steps: 8 | Train Loss: 0.290 Vali Loss: 0.485 Vali Acc: 0.853 Test Loss: 0.485 Test Acc: 0.853
Validation loss decreased (-0.840620 --> -0.853120).  Saving model ...
Epoch: 7 cost time: 8.569641828536987
Epoch: 7, Steps: 8 | Train Loss: 0.193 Vali Loss: 0.470 Vali Acc: 0.847 Test Loss: 0.470 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.546207666397095
Epoch: 8, Steps: 8 | Train Loss: 0.122 Vali Loss: 0.493 Vali Acc: 0.850 Test Loss: 0.493 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 8.330628156661987
Epoch: 9, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.513 Vali Acc: 0.853 Test Loss: 0.513 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 8.514292240142822
Epoch: 10, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.509 Vali Acc: 0.859 Test Loss: 0.509 Test Acc: 0.859
Validation loss decreased (-0.853120 --> -0.859370).  Saving model ...
Epoch: 11 cost time: 8.695664882659912
Epoch: 11, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.528 Vali Acc: 0.859 Test Loss: 0.528 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 8.649636030197144
Epoch: 12, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.538 Vali Acc: 0.863 Test Loss: 0.538 Test Acc: 0.863
Validation loss decreased (-0.859370 --> -0.862495).  Saving model ...
Epoch: 13 cost time: 6.91453218460083
Epoch: 13, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.547 Vali Acc: 0.856 Test Loss: 0.547 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 9.440154075622559
Epoch: 14, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.582 Vali Acc: 0.859 Test Loss: 0.582 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 9.715140581130981
Epoch: 15, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.585 Vali Acc: 0.856 Test Loss: 0.585 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 9.63968825340271
Epoch: 16, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.583 Vali Acc: 0.850 Test Loss: 0.583 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 9.173138856887817
Epoch: 17, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.584 Vali Acc: 0.853 Test Loss: 0.584 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 9.24734115600586
Epoch: 18, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.581 Vali Acc: 0.856 Test Loss: 0.581 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 9.206331491470337
Epoch: 19, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.592 Vali Acc: 0.853 Test Loss: 0.592 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 9.87143874168396
Epoch: 20, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.610 Vali Acc: 0.850 Test Loss: 0.610 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 9.950735807418823
Epoch: 21, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.613 Vali Acc: 0.847 Test Loss: 0.613 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 9.81404733657837
Epoch: 22, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.613 Vali Acc: 0.850 Test Loss: 0.613 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 4768872
model size : 18.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 8.310027599334717
Epoch: 1, Steps: 8 | Train Loss: 2.059 Vali Loss: 1.851 Vali Acc: 0.394 Test Loss: 1.851 Test Acc: 0.394
Validation loss decreased (inf --> -0.393731).  Saving model ...
Epoch: 2 cost time: 6.737758636474609
Epoch: 2, Steps: 8 | Train Loss: 1.622 Vali Loss: 1.292 Vali Acc: 0.778 Test Loss: 1.292 Test Acc: 0.778
Validation loss decreased (-0.393731 --> -0.778112).  Saving model ...
Epoch: 3 cost time: 7.025214195251465
Epoch: 3, Steps: 8 | Train Loss: 1.072 Vali Loss: 0.836 Vali Acc: 0.806 Test Loss: 0.836 Test Acc: 0.806
Validation loss decreased (-0.778112 --> -0.806242).  Saving model ...
Epoch: 4 cost time: 6.264970779418945
Epoch: 4, Steps: 8 | Train Loss: 0.678 Vali Loss: 0.614 Vali Acc: 0.831 Test Loss: 0.614 Test Acc: 0.831
Validation loss decreased (-0.806242 --> -0.831244).  Saving model ...
Epoch: 5 cost time: 6.5984790325164795
Epoch: 5, Steps: 8 | Train Loss: 0.447 Vali Loss: 0.515 Vali Acc: 0.853 Test Loss: 0.515 Test Acc: 0.853
Validation loss decreased (-0.831244 --> -0.853120).  Saving model ...
Epoch: 6 cost time: 6.532832860946655
Epoch: 6, Steps: 8 | Train Loss: 0.322 Vali Loss: 0.490 Vali Acc: 0.853 Test Loss: 0.490 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 7 cost time: 6.241001844406128
Epoch: 7, Steps: 8 | Train Loss: 0.223 Vali Loss: 0.497 Vali Acc: 0.847 Test Loss: 0.497 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.0603110790252686
Epoch: 8, Steps: 8 | Train Loss: 0.159 Vali Loss: 0.463 Vali Acc: 0.859 Test Loss: 0.463 Test Acc: 0.859
Validation loss decreased (-0.853120 --> -0.859370).  Saving model ...
Epoch: 9 cost time: 5.923349857330322
Epoch: 9, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.465 Vali Acc: 0.863 Test Loss: 0.465 Test Acc: 0.863
Validation loss decreased (-0.859370 --> -0.862495).  Saving model ...
Epoch: 10 cost time: 5.991483688354492
Epoch: 10, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.505 Vali Acc: 0.859 Test Loss: 0.505 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.8413660526275635
Epoch: 11, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.528 Vali Acc: 0.847 Test Loss: 0.528 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.432211637496948
Epoch: 12, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.536 Vali Acc: 0.847 Test Loss: 0.536 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.508350133895874
Epoch: 13, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.538 Vali Acc: 0.841 Test Loss: 0.538 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.135906934738159
Epoch: 14, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.560 Vali Acc: 0.850 Test Loss: 0.560 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.525378704071045
Epoch: 15, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.586 Vali Acc: 0.847 Test Loss: 0.586 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.0613415241241455
Epoch: 16, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.583 Vali Acc: 0.841 Test Loss: 0.583 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 6.129623651504517
Epoch: 17, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.572 Vali Acc: 0.844 Test Loss: 0.572 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 6.102373361587524
Epoch: 18, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.576 Vali Acc: 0.850 Test Loss: 0.576 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 6.145726442337036
Epoch: 19, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.579 Vali Acc: 0.850 Test Loss: 0.579 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 1458664
model size : 6.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 8.340455770492554
Epoch: 1, Steps: 8 | Train Loss: 2.160 Vali Loss: 1.920 Vali Acc: 0.331 Test Loss: 1.920 Test Acc: 0.331
Validation loss decreased (inf --> -0.331231).  Saving model ...
Epoch: 2 cost time: 6.9508092403411865
Epoch: 2, Steps: 8 | Train Loss: 1.729 Vali Loss: 1.389 Vali Acc: 0.713 Test Loss: 1.389 Test Acc: 0.713
Validation loss decreased (-0.331231 --> -0.712486).  Saving model ...
Epoch: 3 cost time: 6.55452823638916
Epoch: 3, Steps: 8 | Train Loss: 1.162 Vali Loss: 0.916 Vali Acc: 0.800 Test Loss: 0.916 Test Acc: 0.800
Validation loss decreased (-0.712486 --> -0.799991).  Saving model ...
Epoch: 4 cost time: 6.52932071685791
Epoch: 4, Steps: 8 | Train Loss: 0.710 Vali Loss: 0.655 Vali Acc: 0.816 Test Loss: 0.655 Test Acc: 0.816
Validation loss decreased (-0.799991 --> -0.815618).  Saving model ...
Epoch: 5 cost time: 7.205881118774414
Epoch: 5, Steps: 8 | Train Loss: 0.474 Vali Loss: 0.541 Vali Acc: 0.847 Test Loss: 0.541 Test Acc: 0.847
Validation loss decreased (-0.815618 --> -0.846870).  Saving model ...
Epoch: 6 cost time: 6.830598592758179
Epoch: 6, Steps: 8 | Train Loss: 0.305 Vali Loss: 0.498 Vali Acc: 0.856 Test Loss: 0.498 Test Acc: 0.856
Validation loss decreased (-0.846870 --> -0.856245).  Saving model ...
Epoch: 7 cost time: 7.368122339248657
Epoch: 7, Steps: 8 | Train Loss: 0.197 Vali Loss: 0.485 Vali Acc: 0.847 Test Loss: 0.485 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.341611623764038
Epoch: 8, Steps: 8 | Train Loss: 0.124 Vali Loss: 0.504 Vali Acc: 0.847 Test Loss: 0.504 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.34442400932312
Epoch: 9, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.519 Vali Acc: 0.844 Test Loss: 0.519 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.773530006408691
Epoch: 10, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.518 Vali Acc: 0.844 Test Loss: 0.518 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.9933695793151855
Epoch: 11, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.537 Vali Acc: 0.847 Test Loss: 0.537 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 7.256457805633545
Epoch: 12, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.537 Vali Acc: 0.853 Test Loss: 0.537 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 7.25705623626709
Epoch: 13, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.547 Vali Acc: 0.847 Test Loss: 0.547 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 7.80839467048645
Epoch: 14, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.581 Vali Acc: 0.859 Test Loss: 0.581 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859369).  Saving model ...
Epoch: 15 cost time: 7.786409854888916
Epoch: 15, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.583 Vali Acc: 0.869 Test Loss: 0.583 Test Acc: 0.869
Validation loss decreased (-0.859369 --> -0.868744).  Saving model ...
Epoch: 16 cost time: 7.049174547195435
Epoch: 16, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.580 Vali Acc: 0.856 Test Loss: 0.580 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.800181150436401
Epoch: 17, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.581 Vali Acc: 0.859 Test Loss: 0.581 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.767148733139038
Epoch: 18, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.579 Vali Acc: 0.859 Test Loss: 0.579 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 6.432490587234497
Epoch: 19, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.590 Vali Acc: 0.859 Test Loss: 0.590 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 6.1771159172058105
Epoch: 20, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.609 Vali Acc: 0.856 Test Loss: 0.609 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 6.812540292739868
Epoch: 21, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.610 Vali Acc: 0.853 Test Loss: 0.610 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 7.139305830001831
Epoch: 22, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.609 Vali Acc: 0.853 Test Loss: 0.609 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 7.08970308303833
Epoch: 23, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.612 Vali Acc: 0.853 Test Loss: 0.612 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 6.681534051895142
Epoch: 24, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.618 Vali Acc: 0.856 Test Loss: 0.618 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 6.617311716079712
Epoch: 25, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.625 Vali Acc: 0.859 Test Loss: 0.625 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 4768872
model size : 18.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.743614912033081
Epoch: 1, Steps: 8 | Train Loss: 2.060 Vali Loss: 1.852 Vali Acc: 0.394 Test Loss: 1.852 Test Acc: 0.394
Validation loss decreased (inf --> -0.393731).  Saving model ...
Epoch: 2 cost time: 5.015068769454956
Epoch: 2, Steps: 8 | Train Loss: 1.622 Vali Loss: 1.293 Vali Acc: 0.778 Test Loss: 1.293 Test Acc: 0.778
Validation loss decreased (-0.393731 --> -0.778112).  Saving model ...
Epoch: 3 cost time: 4.934856176376343
Epoch: 3, Steps: 8 | Train Loss: 1.073 Vali Loss: 0.837 Vali Acc: 0.806 Test Loss: 0.837 Test Acc: 0.806
Validation loss decreased (-0.778112 --> -0.806242).  Saving model ...
Epoch: 4 cost time: 4.89016580581665
Epoch: 4, Steps: 8 | Train Loss: 0.677 Vali Loss: 0.615 Vali Acc: 0.831 Test Loss: 0.615 Test Acc: 0.831
Validation loss decreased (-0.806242 --> -0.831244).  Saving model ...
Epoch: 5 cost time: 4.892625570297241
Epoch: 5, Steps: 8 | Train Loss: 0.446 Vali Loss: 0.516 Vali Acc: 0.853 Test Loss: 0.516 Test Acc: 0.853
Validation loss decreased (-0.831244 --> -0.853120).  Saving model ...
Epoch: 6 cost time: 4.379816293716431
Epoch: 6, Steps: 8 | Train Loss: 0.321 Vali Loss: 0.492 Vali Acc: 0.847 Test Loss: 0.492 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.866760730743408
Epoch: 7, Steps: 8 | Train Loss: 0.223 Vali Loss: 0.499 Vali Acc: 0.844 Test Loss: 0.499 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.890005826950073
Epoch: 8, Steps: 8 | Train Loss: 0.159 Vali Loss: 0.465 Vali Acc: 0.856 Test Loss: 0.465 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 9 cost time: 4.871009349822998
Epoch: 9, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.467 Vali Acc: 0.859 Test Loss: 0.467 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 10 cost time: 4.837730407714844
Epoch: 10, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.506 Vali Acc: 0.856 Test Loss: 0.506 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.237198829650879
Epoch: 11, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.530 Vali Acc: 0.844 Test Loss: 0.530 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.259073734283447
Epoch: 12, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.539 Vali Acc: 0.847 Test Loss: 0.539 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.060886383056641
Epoch: 13, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.541 Vali Acc: 0.838 Test Loss: 0.541 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.939819574356079
Epoch: 14, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.563 Vali Acc: 0.847 Test Loss: 0.563 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.960792303085327
Epoch: 15, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.589 Vali Acc: 0.844 Test Loss: 0.589 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.011494398117065
Epoch: 16, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.586 Vali Acc: 0.838 Test Loss: 0.586 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.072024583816528
Epoch: 17, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.574 Vali Acc: 0.838 Test Loss: 0.574 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.966016054153442
Epoch: 18, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.578 Vali Acc: 0.847 Test Loss: 0.578 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.115073919296265
Epoch: 19, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.582 Vali Acc: 0.847 Test Loss: 0.582 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 1458664
model size : 6.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.163258075714111
Epoch: 1, Steps: 8 | Train Loss: 2.161 Vali Loss: 1.924 Vali Acc: 0.331 Test Loss: 1.924 Test Acc: 0.331
Validation loss decreased (inf --> -0.331231).  Saving model ...
Epoch: 2 cost time: 2.7518763542175293
Epoch: 2, Steps: 8 | Train Loss: 1.738 Vali Loss: 1.406 Vali Acc: 0.713 Test Loss: 1.406 Test Acc: 0.713
Validation loss decreased (-0.331231 --> -0.712486).  Saving model ...
Epoch: 3 cost time: 2.7458155155181885
Epoch: 3, Steps: 8 | Train Loss: 1.185 Vali Loss: 0.938 Vali Acc: 0.797 Test Loss: 0.938 Test Acc: 0.797
Validation loss decreased (-0.712486 --> -0.796866).  Saving model ...
Epoch: 4 cost time: 2.7833592891693115
Epoch: 4, Steps: 8 | Train Loss: 0.736 Vali Loss: 0.674 Vali Acc: 0.812 Test Loss: 0.674 Test Acc: 0.812
Validation loss decreased (-0.796866 --> -0.812493).  Saving model ...
Epoch: 5 cost time: 2.7726030349731445
Epoch: 5, Steps: 8 | Train Loss: 0.508 Vali Loss: 0.558 Vali Acc: 0.831 Test Loss: 0.558 Test Acc: 0.831
Validation loss decreased (-0.812493 --> -0.831244).  Saving model ...
Epoch: 6 cost time: 2.784729242324829
Epoch: 6, Steps: 8 | Train Loss: 0.350 Vali Loss: 0.514 Vali Acc: 0.847 Test Loss: 0.514 Test Acc: 0.847
Validation loss decreased (-0.831244 --> -0.846870).  Saving model ...
Epoch: 7 cost time: 2.6072094440460205
Epoch: 7, Steps: 8 | Train Loss: 0.248 Vali Loss: 0.501 Vali Acc: 0.850 Test Loss: 0.501 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 8 cost time: 2.6097030639648438
Epoch: 8, Steps: 8 | Train Loss: 0.163 Vali Loss: 0.535 Vali Acc: 0.844 Test Loss: 0.535 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.4564101696014404
Epoch: 9, Steps: 8 | Train Loss: 0.104 Vali Loss: 0.546 Vali Acc: 0.847 Test Loss: 0.546 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.4751574993133545
Epoch: 10, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.516 Vali Acc: 0.850 Test Loss: 0.516 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.489640712738037
Epoch: 11, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.536 Vali Acc: 0.847 Test Loss: 0.536 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.3887062072753906
Epoch: 12, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.566 Vali Acc: 0.844 Test Loss: 0.566 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.590327501296997
Epoch: 13, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.579 Vali Acc: 0.847 Test Loss: 0.579 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.608959674835205
Epoch: 14, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.599 Vali Acc: 0.850 Test Loss: 0.599 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.596886157989502
Epoch: 15, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.598 Vali Acc: 0.844 Test Loss: 0.598 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.67506742477417
Epoch: 16, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.606 Vali Acc: 0.847 Test Loss: 0.606 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.612504482269287
Epoch: 17, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.611 Vali Acc: 0.850 Test Loss: 0.611 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 4768872
model size : 18.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.7002484798431396
Epoch: 1, Steps: 8 | Train Loss: 2.065 Vali Loss: 1.858 Vali Acc: 0.369 Test Loss: 1.858 Test Acc: 0.369
Validation loss decreased (inf --> -0.368731).  Saving model ...
Epoch: 2 cost time: 1.4386451244354248
Epoch: 2, Steps: 8 | Train Loss: 1.636 Vali Loss: 1.310 Vali Acc: 0.769 Test Loss: 1.310 Test Acc: 0.769
Validation loss decreased (-0.368731 --> -0.768737).  Saving model ...
Epoch: 3 cost time: 1.4110372066497803
Epoch: 3, Steps: 8 | Train Loss: 1.095 Vali Loss: 0.858 Vali Acc: 0.794 Test Loss: 0.858 Test Acc: 0.794
Validation loss decreased (-0.768737 --> -0.793741).  Saving model ...
Epoch: 4 cost time: 1.4392786026000977
Epoch: 4, Steps: 8 | Train Loss: 0.704 Vali Loss: 0.636 Vali Acc: 0.819 Test Loss: 0.636 Test Acc: 0.819
Validation loss decreased (-0.793741 --> -0.818744).  Saving model ...
Epoch: 5 cost time: 1.4643969535827637
Epoch: 5, Steps: 8 | Train Loss: 0.474 Vali Loss: 0.538 Vali Acc: 0.841 Test Loss: 0.538 Test Acc: 0.841
Validation loss decreased (-0.818744 --> -0.840620).  Saving model ...
Epoch: 6 cost time: 1.4343199729919434
Epoch: 6, Steps: 8 | Train Loss: 0.350 Vali Loss: 0.517 Vali Acc: 0.834 Test Loss: 0.517 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.453826904296875
Epoch: 7, Steps: 8 | Train Loss: 0.254 Vali Loss: 0.528 Vali Acc: 0.831 Test Loss: 0.528 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.583777666091919
Epoch: 8, Steps: 8 | Train Loss: 0.183 Vali Loss: 0.502 Vali Acc: 0.844 Test Loss: 0.502 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 9 cost time: 1.5792427062988281
Epoch: 9, Steps: 8 | Train Loss: 0.128 Vali Loss: 0.509 Vali Acc: 0.850 Test Loss: 0.509 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849995).  Saving model ...
Epoch: 10 cost time: 1.478264570236206
Epoch: 10, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.552 Vali Acc: 0.847 Test Loss: 0.552 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.488631248474121
Epoch: 11, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.553 Vali Acc: 0.850 Test Loss: 0.553 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4769246578216553
Epoch: 12, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.555 Vali Acc: 0.850 Test Loss: 0.555 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4847793579101562
Epoch: 13, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.560 Vali Acc: 0.844 Test Loss: 0.560 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.446702003479004
Epoch: 14, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.587 Vali Acc: 0.844 Test Loss: 0.587 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.273817777633667
Epoch: 15, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.616 Vali Acc: 0.844 Test Loss: 0.616 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.3550994396209717
Epoch: 16, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.615 Vali Acc: 0.847 Test Loss: 0.615 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.3550646305084229
Epoch: 17, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.605 Vali Acc: 0.844 Test Loss: 0.605 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.3903822898864746
Epoch: 18, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.607 Vali Acc: 0.841 Test Loss: 0.607 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.3511016368865967
Epoch: 19, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.610 Vali Acc: 0.841 Test Loss: 0.610 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 1458664
model size : 6.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.677444219589233
Epoch: 1, Steps: 8 | Train Loss: 2.066 Vali Loss: 1.870 Vali Acc: 0.406 Test Loss: 1.870 Test Acc: 0.406
Validation loss decreased (inf --> -0.406231).  Saving model ...
Epoch: 2 cost time: 4.320026397705078
Epoch: 2, Steps: 8 | Train Loss: 1.681 Vali Loss: 1.362 Vali Acc: 0.784 Test Loss: 1.362 Test Acc: 0.784
Validation loss decreased (-0.406231 --> -0.784361).  Saving model ...
Epoch: 3 cost time: 4.376412391662598
Epoch: 3, Steps: 8 | Train Loss: 1.181 Vali Loss: 0.911 Vali Acc: 0.819 Test Loss: 0.911 Test Acc: 0.819
Validation loss decreased (-0.784361 --> -0.818741).  Saving model ...
Epoch: 4 cost time: 4.3069024085998535
Epoch: 4, Steps: 8 | Train Loss: 0.737 Vali Loss: 0.643 Vali Acc: 0.828 Test Loss: 0.643 Test Acc: 0.828
Validation loss decreased (-0.818741 --> -0.828119).  Saving model ...
Epoch: 5 cost time: 4.331777811050415
Epoch: 5, Steps: 8 | Train Loss: 0.488 Vali Loss: 0.515 Vali Acc: 0.853 Test Loss: 0.515 Test Acc: 0.853
Validation loss decreased (-0.828119 --> -0.853120).  Saving model ...
Epoch: 6 cost time: 4.045899391174316
Epoch: 6, Steps: 8 | Train Loss: 0.301 Vali Loss: 0.467 Vali Acc: 0.866 Test Loss: 0.467 Test Acc: 0.866
Validation loss decreased (-0.853120 --> -0.865620).  Saving model ...
Epoch: 7 cost time: 3.7284817695617676
Epoch: 7, Steps: 8 | Train Loss: 0.193 Vali Loss: 0.459 Vali Acc: 0.863 Test Loss: 0.459 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.5704245567321777
Epoch: 8, Steps: 8 | Train Loss: 0.128 Vali Loss: 0.438 Vali Acc: 0.875 Test Loss: 0.438 Test Acc: 0.875
Validation loss decreased (-0.865620 --> -0.874996).  Saving model ...
Epoch: 9 cost time: 3.7962918281555176
Epoch: 9, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.430 Vali Acc: 0.872 Test Loss: 0.430 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.763471841812134
Epoch: 10, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.446 Vali Acc: 0.869 Test Loss: 0.446 Test Acc: 0.869
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.0999915599823
Epoch: 11, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.472 Vali Acc: 0.875 Test Loss: 0.472 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.108962535858154
Epoch: 12, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.460 Vali Acc: 0.878 Test Loss: 0.460 Test Acc: 0.878
Validation loss decreased (-0.874996 --> -0.878120).  Saving model ...
Epoch: 13 cost time: 4.778533220291138
Epoch: 13, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.484 Vali Acc: 0.875 Test Loss: 0.484 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.720667123794556
Epoch: 14, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.499 Vali Acc: 0.875 Test Loss: 0.499 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.358738422393799
Epoch: 15, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.495 Vali Acc: 0.878 Test Loss: 0.495 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.380080461502075
Epoch: 16, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.504 Vali Acc: 0.878 Test Loss: 0.504 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.311639785766602
Epoch: 17, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.512 Vali Acc: 0.881 Test Loss: 0.512 Test Acc: 0.881
Validation loss decreased (-0.878120 --> -0.881245).  Saving model ...
Epoch: 18 cost time: 4.452259063720703
Epoch: 18, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.532 Vali Acc: 0.875 Test Loss: 0.532 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.471763372421265
Epoch: 19, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.544 Vali Acc: 0.878 Test Loss: 0.544 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.53345251083374
Epoch: 20, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.548 Vali Acc: 0.881 Test Loss: 0.548 Test Acc: 0.881
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.5120532512664795
Epoch: 21, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.552 Vali Acc: 0.881 Test Loss: 0.552 Test Acc: 0.881
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.51816463470459
Epoch: 22, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.552 Vali Acc: 0.881 Test Loss: 0.552 Test Acc: 0.881
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.491317272186279
Epoch: 23, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.555 Vali Acc: 0.881 Test Loss: 0.555 Test Acc: 0.881
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 4.240044593811035
Epoch: 24, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.561 Vali Acc: 0.881 Test Loss: 0.561 Test Acc: 0.881
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 4.1538779735565186
Epoch: 25, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.567 Vali Acc: 0.878 Test Loss: 0.567 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 4.451138496398926
Epoch: 26, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.571 Vali Acc: 0.878 Test Loss: 0.571 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 4.450961589813232
Epoch: 27, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.582 Vali Acc: 0.878 Test Loss: 0.582 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.88125
model parameter : 2425192
model size : 9.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.576782703399658
Epoch: 1, Steps: 8 | Train Loss: 2.059 Vali Loss: 1.883 Vali Acc: 0.359 Test Loss: 1.883 Test Acc: 0.359
Validation loss decreased (inf --> -0.359356).  Saving model ...
Epoch: 2 cost time: 3.121613025665283
Epoch: 2, Steps: 8 | Train Loss: 1.641 Vali Loss: 1.359 Vali Acc: 0.784 Test Loss: 1.359 Test Acc: 0.784
Validation loss decreased (-0.359356 --> -0.784361).  Saving model ...
Epoch: 3 cost time: 3.1035361289978027
Epoch: 3, Steps: 8 | Train Loss: 1.094 Vali Loss: 0.894 Vali Acc: 0.819 Test Loss: 0.894 Test Acc: 0.819
Validation loss decreased (-0.784361 --> -0.818741).  Saving model ...
Epoch: 4 cost time: 2.795616626739502
Epoch: 4, Steps: 8 | Train Loss: 0.648 Vali Loss: 0.635 Vali Acc: 0.850 Test Loss: 0.635 Test Acc: 0.850
Validation loss decreased (-0.818741 --> -0.849994).  Saving model ...
Epoch: 5 cost time: 2.845580577850342
Epoch: 5, Steps: 8 | Train Loss: 0.422 Vali Loss: 0.527 Vali Acc: 0.853 Test Loss: 0.527 Test Acc: 0.853
Validation loss decreased (-0.849994 --> -0.853120).  Saving model ...
Epoch: 6 cost time: 2.5736825466156006
Epoch: 6, Steps: 8 | Train Loss: 0.282 Vali Loss: 0.461 Vali Acc: 0.859 Test Loss: 0.461 Test Acc: 0.859
Validation loss decreased (-0.853120 --> -0.859370).  Saving model ...
Epoch: 7 cost time: 2.5275793075561523
Epoch: 7, Steps: 8 | Train Loss: 0.174 Vali Loss: 0.452 Vali Acc: 0.853 Test Loss: 0.452 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.476717948913574
Epoch: 8, Steps: 8 | Train Loss: 0.126 Vali Loss: 0.458 Vali Acc: 0.863 Test Loss: 0.458 Test Acc: 0.863
Validation loss decreased (-0.859370 --> -0.862495).  Saving model ...
Epoch: 9 cost time: 2.526416301727295
Epoch: 9, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.458 Vali Acc: 0.863 Test Loss: 0.458 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.3202619552612305
Epoch: 10, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.453 Vali Acc: 0.866 Test Loss: 0.453 Test Acc: 0.866
Validation loss decreased (-0.862495 --> -0.865620).  Saving model ...
Epoch: 11 cost time: 2.4640753269195557
Epoch: 11, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.462 Vali Acc: 0.866 Test Loss: 0.462 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.512449026107788
Epoch: 12, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.473 Vali Acc: 0.872 Test Loss: 0.473 Test Acc: 0.872
Validation loss decreased (-0.865620 --> -0.871870).  Saving model ...
Epoch: 13 cost time: 2.4410769939422607
Epoch: 13, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.485 Vali Acc: 0.878 Test Loss: 0.485 Test Acc: 0.878
Validation loss decreased (-0.871870 --> -0.878120).  Saving model ...
Epoch: 14 cost time: 2.668895959854126
Epoch: 14, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.496 Vali Acc: 0.869 Test Loss: 0.496 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.4336202144622803
Epoch: 15, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.508 Vali Acc: 0.866 Test Loss: 0.508 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.8539271354675293
Epoch: 16, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.516 Vali Acc: 0.863 Test Loss: 0.516 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.8486175537109375
Epoch: 17, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.520 Vali Acc: 0.866 Test Loss: 0.520 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.810612678527832
Epoch: 18, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.522 Vali Acc: 0.863 Test Loss: 0.522 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.8283965587615967
Epoch: 19, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.526 Vali Acc: 0.866 Test Loss: 0.526 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.67503023147583
Epoch: 20, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.532 Vali Acc: 0.866 Test Loss: 0.532 Test Acc: 0.866
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.6633927822113037
Epoch: 21, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.538 Vali Acc: 0.866 Test Loss: 0.538 Test Acc: 0.866
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.7427306175231934
Epoch: 22, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.541 Vali Acc: 0.863 Test Loss: 0.541 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.6451900005340576
Epoch: 23, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.548 Vali Acc: 0.863 Test Loss: 0.548 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.878125
model parameter : 770024
model size : 3.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.49744176864624
Epoch: 1, Steps: 8 | Train Loss: 2.067 Vali Loss: 1.873 Vali Acc: 0.406 Test Loss: 1.873 Test Acc: 0.406
Validation loss decreased (inf --> -0.406231).  Saving model ...
Epoch: 2 cost time: 3.3425581455230713
Epoch: 2, Steps: 8 | Train Loss: 1.684 Vali Loss: 1.371 Vali Acc: 0.784 Test Loss: 1.371 Test Acc: 0.784
Validation loss decreased (-0.406231 --> -0.784361).  Saving model ...
Epoch: 3 cost time: 3.29980206489563
Epoch: 3, Steps: 8 | Train Loss: 1.188 Vali Loss: 0.923 Vali Acc: 0.819 Test Loss: 0.923 Test Acc: 0.819
Validation loss decreased (-0.784361 --> -0.818741).  Saving model ...
Epoch: 4 cost time: 3.3461291790008545
Epoch: 4, Steps: 8 | Train Loss: 0.745 Vali Loss: 0.655 Vali Acc: 0.828 Test Loss: 0.655 Test Acc: 0.828
Validation loss decreased (-0.818741 --> -0.828118).  Saving model ...
Epoch: 5 cost time: 3.2605996131896973
Epoch: 5, Steps: 8 | Train Loss: 0.492 Vali Loss: 0.526 Vali Acc: 0.853 Test Loss: 0.526 Test Acc: 0.853
Validation loss decreased (-0.828118 --> -0.853120).  Saving model ...
Epoch: 6 cost time: 3.311584949493408
Epoch: 6, Steps: 8 | Train Loss: 0.304 Vali Loss: 0.478 Vali Acc: 0.863 Test Loss: 0.478 Test Acc: 0.863
Validation loss decreased (-0.853120 --> -0.862495).  Saving model ...
Epoch: 7 cost time: 3.054368257522583
Epoch: 7, Steps: 8 | Train Loss: 0.194 Vali Loss: 0.471 Vali Acc: 0.863 Test Loss: 0.471 Test Acc: 0.863
Validation loss decreased (-0.862495 --> -0.862495).  Saving model ...
Epoch: 8 cost time: 3.2524993419647217
Epoch: 8, Steps: 8 | Train Loss: 0.128 Vali Loss: 0.454 Vali Acc: 0.869 Test Loss: 0.454 Test Acc: 0.869
Validation loss decreased (-0.862495 --> -0.868745).  Saving model ...
Epoch: 9 cost time: 3.3184890747070312
Epoch: 9, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.443 Vali Acc: 0.872 Test Loss: 0.443 Test Acc: 0.872
Validation loss decreased (-0.868745 --> -0.871871).  Saving model ...
Epoch: 10 cost time: 3.2796878814697266
Epoch: 10, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.459 Vali Acc: 0.872 Test Loss: 0.459 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.161121368408203
Epoch: 11, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.486 Vali Acc: 0.872 Test Loss: 0.486 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.8589823246002197
Epoch: 12, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.476 Vali Acc: 0.878 Test Loss: 0.476 Test Acc: 0.878
Validation loss decreased (-0.871871 --> -0.878120).  Saving model ...
Epoch: 13 cost time: 3.8201818466186523
Epoch: 13, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.501 Vali Acc: 0.881 Test Loss: 0.501 Test Acc: 0.881
Validation loss decreased (-0.878120 --> -0.881245).  Saving model ...
Epoch: 14 cost time: 3.8733632564544678
Epoch: 14, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.515 Vali Acc: 0.878 Test Loss: 0.515 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.6774685382843018
Epoch: 15, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.509 Vali Acc: 0.878 Test Loss: 0.509 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.654568910598755
Epoch: 16, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.519 Vali Acc: 0.881 Test Loss: 0.519 Test Acc: 0.881
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.4656598567962646
Epoch: 17, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.529 Vali Acc: 0.881 Test Loss: 0.529 Test Acc: 0.881
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.3542513847351074
Epoch: 18, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.549 Vali Acc: 0.881 Test Loss: 0.549 Test Acc: 0.881
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.4425361156463623
Epoch: 19, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.562 Vali Acc: 0.881 Test Loss: 0.562 Test Acc: 0.881
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.3860721588134766
Epoch: 20, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.565 Vali Acc: 0.881 Test Loss: 0.565 Test Acc: 0.881
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.3482067584991455
Epoch: 21, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.569 Vali Acc: 0.881 Test Loss: 0.569 Test Acc: 0.881
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.4431817531585693
Epoch: 22, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.569 Vali Acc: 0.881 Test Loss: 0.569 Test Acc: 0.881
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.8427932262420654
Epoch: 23, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.573 Vali Acc: 0.881 Test Loss: 0.573 Test Acc: 0.881
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.88125
model parameter : 2425192
model size : 9.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.0440287590026855
Epoch: 1, Steps: 8 | Train Loss: 2.060 Vali Loss: 1.887 Vali Acc: 0.350 Test Loss: 1.887 Test Acc: 0.350
Validation loss decreased (inf --> -0.349981).  Saving model ...
Epoch: 2 cost time: 2.6522114276885986
Epoch: 2, Steps: 8 | Train Loss: 1.646 Vali Loss: 1.374 Vali Acc: 0.781 Test Loss: 1.374 Test Acc: 0.781
Validation loss decreased (-0.349981 --> -0.781236).  Saving model ...
Epoch: 3 cost time: 2.659898042678833
Epoch: 3, Steps: 8 | Train Loss: 1.105 Vali Loss: 0.916 Vali Acc: 0.819 Test Loss: 0.916 Test Acc: 0.819
Validation loss decreased (-0.781236 --> -0.818741).  Saving model ...
Epoch: 4 cost time: 2.4750332832336426
Epoch: 4, Steps: 8 | Train Loss: 0.666 Vali Loss: 0.658 Vali Acc: 0.847 Test Loss: 0.658 Test Acc: 0.847
Validation loss decreased (-0.818741 --> -0.846868).  Saving model ...
Epoch: 5 cost time: 2.4174678325653076
Epoch: 5, Steps: 8 | Train Loss: 0.435 Vali Loss: 0.548 Vali Acc: 0.850 Test Loss: 0.548 Test Acc: 0.850
Validation loss decreased (-0.846868 --> -0.849995).  Saving model ...
Epoch: 6 cost time: 2.4305620193481445
Epoch: 6, Steps: 8 | Train Loss: 0.291 Vali Loss: 0.480 Vali Acc: 0.847 Test Loss: 0.480 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.4663467407226562
Epoch: 7, Steps: 8 | Train Loss: 0.182 Vali Loss: 0.470 Vali Acc: 0.859 Test Loss: 0.470 Test Acc: 0.859
Validation loss decreased (-0.849995 --> -0.859370).  Saving model ...
Epoch: 8 cost time: 2.213343381881714
Epoch: 8, Steps: 8 | Train Loss: 0.131 Vali Loss: 0.476 Vali Acc: 0.866 Test Loss: 0.476 Test Acc: 0.866
Validation loss decreased (-0.859370 --> -0.865620).  Saving model ...
Epoch: 9 cost time: 2.3340656757354736
Epoch: 9, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.479 Vali Acc: 0.863 Test Loss: 0.479 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.3571770191192627
Epoch: 10, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.469 Vali Acc: 0.869 Test Loss: 0.469 Test Acc: 0.869
Validation loss decreased (-0.865620 --> -0.868745).  Saving model ...
Epoch: 11 cost time: 2.212383985519409
Epoch: 11, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.481 Vali Acc: 0.863 Test Loss: 0.481 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.3032259941101074
Epoch: 12, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.496 Vali Acc: 0.872 Test Loss: 0.496 Test Acc: 0.872
Validation loss decreased (-0.868745 --> -0.871870).  Saving model ...
Epoch: 13 cost time: 2.1308388710021973
Epoch: 13, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.508 Vali Acc: 0.869 Test Loss: 0.508 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.310809373855591
Epoch: 14, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.516 Vali Acc: 0.863 Test Loss: 0.516 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.2831881046295166
Epoch: 15, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.528 Vali Acc: 0.859 Test Loss: 0.528 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.313699245452881
Epoch: 16, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.536 Vali Acc: 0.856 Test Loss: 0.536 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.245922803878784
Epoch: 17, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.540 Vali Acc: 0.866 Test Loss: 0.540 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.1866629123687744
Epoch: 18, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.542 Vali Acc: 0.863 Test Loss: 0.542 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.250638484954834
Epoch: 19, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.547 Vali Acc: 0.866 Test Loss: 0.547 Test Acc: 0.866
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.2621042728424072
Epoch: 20, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.554 Vali Acc: 0.863 Test Loss: 0.554 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.2358877658843994
Epoch: 21, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.559 Vali Acc: 0.859 Test Loss: 0.559 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.2295749187469482
Epoch: 22, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.562 Vali Acc: 0.856 Test Loss: 0.562 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 770024
model size : 3.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.0754756927490234
Epoch: 1, Steps: 8 | Train Loss: 2.071 Vali Loss: 1.876 Vali Acc: 0.394 Test Loss: 1.876 Test Acc: 0.394
Validation loss decreased (inf --> -0.393731).  Saving model ...
Epoch: 2 cost time: 1.7720956802368164
Epoch: 2, Steps: 8 | Train Loss: 1.693 Vali Loss: 1.383 Vali Acc: 0.791 Test Loss: 1.383 Test Acc: 0.791
Validation loss decreased (-0.393731 --> -0.790611).  Saving model ...
Epoch: 3 cost time: 1.78947114944458
Epoch: 3, Steps: 8 | Train Loss: 1.204 Vali Loss: 0.940 Vali Acc: 0.809 Test Loss: 0.940 Test Acc: 0.809
Validation loss decreased (-0.790611 --> -0.809366).  Saving model ...
Epoch: 4 cost time: 1.7718861103057861
Epoch: 4, Steps: 8 | Train Loss: 0.768 Vali Loss: 0.674 Vali Acc: 0.822 Test Loss: 0.674 Test Acc: 0.822
Validation loss decreased (-0.809366 --> -0.821868).  Saving model ...
Epoch: 5 cost time: 1.7578802108764648
Epoch: 5, Steps: 8 | Train Loss: 0.516 Vali Loss: 0.546 Vali Acc: 0.850 Test Loss: 0.546 Test Acc: 0.850
Validation loss decreased (-0.821868 --> -0.849995).  Saving model ...
Epoch: 6 cost time: 1.6898345947265625
Epoch: 6, Steps: 8 | Train Loss: 0.341 Vali Loss: 0.498 Vali Acc: 0.859 Test Loss: 0.498 Test Acc: 0.859
Validation loss decreased (-0.849995 --> -0.859370).  Saving model ...
Epoch: 7 cost time: 1.6747806072235107
Epoch: 7, Steps: 8 | Train Loss: 0.227 Vali Loss: 0.497 Vali Acc: 0.856 Test Loss: 0.497 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7095699310302734
Epoch: 8, Steps: 8 | Train Loss: 0.158 Vali Loss: 0.489 Vali Acc: 0.863 Test Loss: 0.489 Test Acc: 0.863
Validation loss decreased (-0.859370 --> -0.862495).  Saving model ...
Epoch: 9 cost time: 1.7477571964263916
Epoch: 9, Steps: 8 | Train Loss: 0.096 Vali Loss: 0.475 Vali Acc: 0.869 Test Loss: 0.475 Test Acc: 0.869
Validation loss decreased (-0.862495 --> -0.868745).  Saving model ...
Epoch: 10 cost time: 1.5890188217163086
Epoch: 10, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.491 Vali Acc: 0.859 Test Loss: 0.491 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5982763767242432
Epoch: 11, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.520 Vali Acc: 0.859 Test Loss: 0.520 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5997467041015625
Epoch: 12, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.502 Vali Acc: 0.869 Test Loss: 0.502 Test Acc: 0.869
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.6209967136383057
Epoch: 13, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.524 Vali Acc: 0.875 Test Loss: 0.524 Test Acc: 0.875
Validation loss decreased (-0.868745 --> -0.874995).  Saving model ...
Epoch: 14 cost time: 1.545241355895996
Epoch: 14, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.542 Vali Acc: 0.863 Test Loss: 0.542 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5742464065551758
Epoch: 15, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.543 Vali Acc: 0.859 Test Loss: 0.543 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.489415168762207
Epoch: 16, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.554 Vali Acc: 0.863 Test Loss: 0.554 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.5263161659240723
Epoch: 17, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.564 Vali Acc: 0.866 Test Loss: 0.564 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.6955721378326416
Epoch: 18, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.585 Vali Acc: 0.866 Test Loss: 0.585 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.670445203781128
Epoch: 19, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.600 Vali Acc: 0.863 Test Loss: 0.600 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.6766960620880127
Epoch: 20, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.603 Vali Acc: 0.859 Test Loss: 0.603 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.2945020198822021
Epoch: 21, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.606 Vali Acc: 0.859 Test Loss: 0.606 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.3986668586730957
Epoch: 22, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.608 Vali Acc: 0.859 Test Loss: 0.608 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.6552455425262451
Epoch: 23, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.612 Vali Acc: 0.863 Test Loss: 0.612 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.875
model parameter : 2425192
model size : 9.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.606163740158081
Epoch: 1, Steps: 8 | Train Loss: 2.061 Vali Loss: 1.887 Vali Acc: 0.347 Test Loss: 1.887 Test Acc: 0.347
Validation loss decreased (inf --> -0.346856).  Saving model ...
Epoch: 2 cost time: 1.2484126091003418
Epoch: 2, Steps: 8 | Train Loss: 1.649 Vali Loss: 1.380 Vali Acc: 0.772 Test Loss: 1.380 Test Acc: 0.772
Validation loss decreased (-0.346856 --> -0.771861).  Saving model ...
Epoch: 3 cost time: 1.1888542175292969
Epoch: 3, Steps: 8 | Train Loss: 1.116 Vali Loss: 0.926 Vali Acc: 0.812 Test Loss: 0.926 Test Acc: 0.812
Validation loss decreased (-0.771861 --> -0.812491).  Saving model ...
Epoch: 4 cost time: 1.228806972503662
Epoch: 4, Steps: 8 | Train Loss: 0.676 Vali Loss: 0.669 Vali Acc: 0.841 Test Loss: 0.669 Test Acc: 0.841
Validation loss decreased (-0.812491 --> -0.840618).  Saving model ...
Epoch: 5 cost time: 1.185269832611084
Epoch: 5, Steps: 8 | Train Loss: 0.453 Vali Loss: 0.555 Vali Acc: 0.847 Test Loss: 0.555 Test Acc: 0.847
Validation loss decreased (-0.840618 --> -0.846869).  Saving model ...
Epoch: 6 cost time: 1.1823523044586182
Epoch: 6, Steps: 8 | Train Loss: 0.320 Vali Loss: 0.487 Vali Acc: 0.853 Test Loss: 0.487 Test Acc: 0.853
Validation loss decreased (-0.846869 --> -0.853120).  Saving model ...
Epoch: 7 cost time: 1.2306170463562012
Epoch: 7, Steps: 8 | Train Loss: 0.202 Vali Loss: 0.484 Vali Acc: 0.847 Test Loss: 0.484 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1809813976287842
Epoch: 8, Steps: 8 | Train Loss: 0.150 Vali Loss: 0.491 Vali Acc: 0.853 Test Loss: 0.491 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1191880702972412
Epoch: 9, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.491 Vali Acc: 0.853 Test Loss: 0.491 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1952481269836426
Epoch: 10, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.480 Vali Acc: 0.853 Test Loss: 0.480 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 11 cost time: 1.1933948993682861
Epoch: 11, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.494 Vali Acc: 0.853 Test Loss: 0.494 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2258787155151367
Epoch: 12, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.509 Vali Acc: 0.866 Test Loss: 0.509 Test Acc: 0.866
Validation loss decreased (-0.853120 --> -0.865620).  Saving model ...
Epoch: 13 cost time: 1.2144601345062256
Epoch: 13, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.520 Vali Acc: 0.863 Test Loss: 0.520 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1656196117401123
Epoch: 14, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.535 Vali Acc: 0.853 Test Loss: 0.535 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2073919773101807
Epoch: 15, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.550 Vali Acc: 0.850 Test Loss: 0.550 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2668633460998535
Epoch: 16, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.558 Vali Acc: 0.850 Test Loss: 0.558 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2628095149993896
Epoch: 17, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.561 Vali Acc: 0.853 Test Loss: 0.561 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.1226234436035156
Epoch: 18, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.563 Vali Acc: 0.853 Test Loss: 0.563 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.1905958652496338
Epoch: 19, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.568 Vali Acc: 0.853 Test Loss: 0.568 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.2380311489105225
Epoch: 20, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.575 Vali Acc: 0.853 Test Loss: 0.575 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.1659305095672607
Epoch: 21, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.582 Vali Acc: 0.853 Test Loss: 0.582 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.1813111305236816
Epoch: 22, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.586 Vali Acc: 0.853 Test Loss: 0.586 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 770024
model size : 3.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.7574074268341064
Epoch: 1, Steps: 8 | Train Loss: 2.136 Vali Loss: 1.980 Vali Acc: 0.234 Test Loss: 1.980 Test Acc: 0.234
Validation loss decreased (inf --> -0.234355).  Saving model ...
Epoch: 2 cost time: 2.404933452606201
Epoch: 2, Steps: 8 | Train Loss: 1.782 Vali Loss: 1.481 Vali Acc: 0.619 Test Loss: 1.481 Test Acc: 0.619
Validation loss decreased (-0.234355 --> -0.618735).  Saving model ...
Epoch: 3 cost time: 2.191419839859009
Epoch: 3, Steps: 8 | Train Loss: 1.211 Vali Loss: 0.991 Vali Acc: 0.787 Test Loss: 0.991 Test Acc: 0.787
Validation loss decreased (-0.618735 --> -0.787490).  Saving model ...
Epoch: 4 cost time: 2.1233396530151367
Epoch: 4, Steps: 8 | Train Loss: 0.811 Vali Loss: 0.701 Vali Acc: 0.809 Test Loss: 0.701 Test Acc: 0.809
Validation loss decreased (-0.787490 --> -0.809368).  Saving model ...
Epoch: 5 cost time: 2.8415374755859375
Epoch: 5, Steps: 8 | Train Loss: 0.489 Vali Loss: 0.564 Vali Acc: 0.831 Test Loss: 0.564 Test Acc: 0.831
Validation loss decreased (-0.809368 --> -0.831244).  Saving model ...
Epoch: 6 cost time: 2.840282440185547
Epoch: 6, Steps: 8 | Train Loss: 0.357 Vali Loss: 0.502 Vali Acc: 0.841 Test Loss: 0.502 Test Acc: 0.841
Validation loss decreased (-0.831244 --> -0.840620).  Saving model ...
Epoch: 7 cost time: 2.817150831222534
Epoch: 7, Steps: 8 | Train Loss: 0.253 Vali Loss: 0.469 Vali Acc: 0.850 Test Loss: 0.469 Test Acc: 0.850
Validation loss decreased (-0.840620 --> -0.849995).  Saving model ...
Epoch: 8 cost time: 2.7025222778320312
Epoch: 8, Steps: 8 | Train Loss: 0.154 Vali Loss: 0.472 Vali Acc: 0.847 Test Loss: 0.472 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.7984464168548584
Epoch: 9, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.487 Vali Acc: 0.841 Test Loss: 0.487 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.777209520339966
Epoch: 10, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.487 Vali Acc: 0.850 Test Loss: 0.487 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.8550684452056885
Epoch: 11, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.482 Vali Acc: 0.856 Test Loss: 0.482 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.856245).  Saving model ...
Epoch: 12 cost time: 2.8659939765930176
Epoch: 12, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.485 Vali Acc: 0.847 Test Loss: 0.485 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.9779257774353027
Epoch: 13, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.523 Vali Acc: 0.850 Test Loss: 0.523 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.985041618347168
Epoch: 14, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.536 Vali Acc: 0.850 Test Loss: 0.536 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.984717845916748
Epoch: 15, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.540 Vali Acc: 0.850 Test Loss: 0.540 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.0111746788024902
Epoch: 16, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.552 Vali Acc: 0.844 Test Loss: 0.552 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.014620065689087
Epoch: 17, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.561 Vali Acc: 0.847 Test Loss: 0.561 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.996753454208374
Epoch: 18, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.562 Vali Acc: 0.844 Test Loss: 0.562 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.7762606143951416
Epoch: 19, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.563 Vali Acc: 0.847 Test Loss: 0.563 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.9609761238098145
Epoch: 20, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.575 Vali Acc: 0.847 Test Loss: 0.575 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.8457014560699463
Epoch: 21, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.582 Vali Acc: 0.844 Test Loss: 0.582 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 1253352
model size : 5.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.084357261657715
Epoch: 1, Steps: 8 | Train Loss: 2.064 Vali Loss: 1.851 Vali Acc: 0.384 Test Loss: 1.851 Test Acc: 0.384
Validation loss decreased (inf --> -0.384356).  Saving model ...
Epoch: 2 cost time: 1.6569621562957764
Epoch: 2, Steps: 8 | Train Loss: 1.645 Vali Loss: 1.339 Vali Acc: 0.703 Test Loss: 1.339 Test Acc: 0.703
Validation loss decreased (-0.384356 --> -0.703112).  Saving model ...
Epoch: 3 cost time: 1.6535050868988037
Epoch: 3, Steps: 8 | Train Loss: 1.095 Vali Loss: 0.900 Vali Acc: 0.794 Test Loss: 0.900 Test Acc: 0.794
Validation loss decreased (-0.703112 --> -0.793741).  Saving model ...
Epoch: 4 cost time: 1.6593432426452637
Epoch: 4, Steps: 8 | Train Loss: 0.715 Vali Loss: 0.645 Vali Acc: 0.803 Test Loss: 0.645 Test Acc: 0.803
Validation loss decreased (-0.793741 --> -0.803119).  Saving model ...
Epoch: 5 cost time: 1.6702537536621094
Epoch: 5, Steps: 8 | Train Loss: 0.476 Vali Loss: 0.533 Vali Acc: 0.825 Test Loss: 0.533 Test Acc: 0.825
Validation loss decreased (-0.803119 --> -0.824995).  Saving model ...
Epoch: 6 cost time: 1.7335715293884277
Epoch: 6, Steps: 8 | Train Loss: 0.379 Vali Loss: 0.507 Vali Acc: 0.812 Test Loss: 0.507 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.690476655960083
Epoch: 7, Steps: 8 | Train Loss: 0.232 Vali Loss: 0.478 Vali Acc: 0.850 Test Loss: 0.478 Test Acc: 0.850
Validation loss decreased (-0.824995 --> -0.849995).  Saving model ...
Epoch: 8 cost time: 1.6806344985961914
Epoch: 8, Steps: 8 | Train Loss: 0.166 Vali Loss: 0.452 Vali Acc: 0.859 Test Loss: 0.452 Test Acc: 0.859
Validation loss decreased (-0.849995 --> -0.859370).  Saving model ...
Epoch: 9 cost time: 1.741647720336914
Epoch: 9, Steps: 8 | Train Loss: 0.108 Vali Loss: 0.466 Vali Acc: 0.859 Test Loss: 0.466 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7266197204589844
Epoch: 10, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.509 Vali Acc: 0.863 Test Loss: 0.509 Test Acc: 0.863
Validation loss decreased (-0.859370 --> -0.862495).  Saving model ...
Epoch: 11 cost time: 1.8227267265319824
Epoch: 11, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.504 Vali Acc: 0.859 Test Loss: 0.504 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8449656963348389
Epoch: 12, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.499 Vali Acc: 0.863 Test Loss: 0.499 Test Acc: 0.863
Validation loss decreased (-0.862495 --> -0.862495).  Saving model ...
Epoch: 13 cost time: 1.8737995624542236
Epoch: 13, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.500 Vali Acc: 0.872 Test Loss: 0.500 Test Acc: 0.872
Validation loss decreased (-0.862495 --> -0.871870).  Saving model ...
Epoch: 14 cost time: 1.8320481777191162
Epoch: 14, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.514 Vali Acc: 0.872 Test Loss: 0.514 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8859083652496338
Epoch: 15, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.527 Vali Acc: 0.866 Test Loss: 0.527 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.875981092453003
Epoch: 16, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.528 Vali Acc: 0.863 Test Loss: 0.528 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.882368803024292
Epoch: 17, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.535 Vali Acc: 0.863 Test Loss: 0.535 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.8900601863861084
Epoch: 18, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.543 Vali Acc: 0.866 Test Loss: 0.543 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.8545513153076172
Epoch: 19, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.542 Vali Acc: 0.866 Test Loss: 0.542 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.8289785385131836
Epoch: 20, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.546 Vali Acc: 0.866 Test Loss: 0.546 Test Acc: 0.866
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.7883484363555908
Epoch: 21, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.553 Vali Acc: 0.859 Test Loss: 0.553 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.8350889682769775
Epoch: 22, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.561 Vali Acc: 0.863 Test Loss: 0.561 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.8337690830230713
Epoch: 23, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.558 Vali Acc: 0.863 Test Loss: 0.558 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 425704
model size : 2.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.8563616275787354
Epoch: 1, Steps: 8 | Train Loss: 2.138 Vali Loss: 1.982 Vali Acc: 0.228 Test Loss: 1.982 Test Acc: 0.228
Validation loss decreased (inf --> -0.228105).  Saving model ...
Epoch: 2 cost time: 2.27282977104187
Epoch: 2, Steps: 8 | Train Loss: 1.788 Vali Loss: 1.492 Vali Acc: 0.619 Test Loss: 1.492 Test Acc: 0.619
Validation loss decreased (-0.228105 --> -0.618735).  Saving model ...
Epoch: 3 cost time: 2.3101277351379395
Epoch: 3, Steps: 8 | Train Loss: 1.222 Vali Loss: 1.008 Vali Acc: 0.787 Test Loss: 1.008 Test Acc: 0.787
Validation loss decreased (-0.618735 --> -0.787490).  Saving model ...
Epoch: 4 cost time: 2.2891030311584473
Epoch: 4, Steps: 8 | Train Loss: 0.825 Vali Loss: 0.721 Vali Acc: 0.809 Test Loss: 0.721 Test Acc: 0.809
Validation loss decreased (-0.787490 --> -0.809368).  Saving model ...
Epoch: 5 cost time: 2.35276460647583
Epoch: 5, Steps: 8 | Train Loss: 0.503 Vali Loss: 0.582 Vali Acc: 0.822 Test Loss: 0.582 Test Acc: 0.822
Validation loss decreased (-0.809368 --> -0.821869).  Saving model ...
Epoch: 6 cost time: 2.3235485553741455
Epoch: 6, Steps: 8 | Train Loss: 0.370 Vali Loss: 0.515 Vali Acc: 0.838 Test Loss: 0.515 Test Acc: 0.838
Validation loss decreased (-0.821869 --> -0.837495).  Saving model ...
Epoch: 7 cost time: 2.239835500717163
Epoch: 7, Steps: 8 | Train Loss: 0.262 Vali Loss: 0.479 Vali Acc: 0.850 Test Loss: 0.479 Test Acc: 0.850
Validation loss decreased (-0.837495 --> -0.849995).  Saving model ...
Epoch: 8 cost time: 2.284468173980713
Epoch: 8, Steps: 8 | Train Loss: 0.162 Vali Loss: 0.486 Vali Acc: 0.847 Test Loss: 0.486 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.5009877681732178
Epoch: 9, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.499 Vali Acc: 0.844 Test Loss: 0.499 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.3453595638275146
Epoch: 10, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.501 Vali Acc: 0.853 Test Loss: 0.501 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 11 cost time: 2.3938021659851074
Epoch: 11, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.498 Vali Acc: 0.856 Test Loss: 0.498 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 12 cost time: 2.4145941734313965
Epoch: 12, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.499 Vali Acc: 0.853 Test Loss: 0.499 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.263259172439575
Epoch: 13, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.538 Vali Acc: 0.850 Test Loss: 0.538 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.5550696849823
Epoch: 14, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.550 Vali Acc: 0.850 Test Loss: 0.550 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.545466184616089
Epoch: 15, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.554 Vali Acc: 0.856 Test Loss: 0.554 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.479588747024536
Epoch: 16, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.565 Vali Acc: 0.850 Test Loss: 0.565 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.50087308883667
Epoch: 17, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.573 Vali Acc: 0.853 Test Loss: 0.573 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.5759880542755127
Epoch: 18, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.574 Vali Acc: 0.856 Test Loss: 0.574 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.4534575939178467
Epoch: 19, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.575 Vali Acc: 0.859 Test Loss: 0.575 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859369).  Saving model ...
Epoch: 20 cost time: 2.457864999771118
Epoch: 20, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.587 Vali Acc: 0.859 Test Loss: 0.587 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.3887832164764404
Epoch: 21, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.594 Vali Acc: 0.859 Test Loss: 0.594 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.328073740005493
Epoch: 22, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.601 Vali Acc: 0.859 Test Loss: 0.601 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.528960943222046
Epoch: 23, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.607 Vali Acc: 0.856 Test Loss: 0.607 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.4465126991271973
Epoch: 24, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.612 Vali Acc: 0.853 Test Loss: 0.612 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.3804166316986084
Epoch: 25, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.617 Vali Acc: 0.853 Test Loss: 0.617 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.449965476989746
Epoch: 26, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.624 Vali Acc: 0.853 Test Loss: 0.624 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.517667770385742
Epoch: 27, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.629 Vali Acc: 0.850 Test Loss: 0.629 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.3980915546417236
Epoch: 28, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.638 Vali Acc: 0.856 Test Loss: 0.638 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.4759950637817383
Epoch: 29, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.640 Vali Acc: 0.856 Test Loss: 0.640 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 1253352
model size : 5.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.8905787467956543
Epoch: 1, Steps: 8 | Train Loss: 2.067 Vali Loss: 1.853 Vali Acc: 0.384 Test Loss: 1.853 Test Acc: 0.384
Validation loss decreased (inf --> -0.384356).  Saving model ...
Epoch: 2 cost time: 1.4849820137023926
Epoch: 2, Steps: 8 | Train Loss: 1.648 Vali Loss: 1.346 Vali Acc: 0.700 Test Loss: 1.346 Test Acc: 0.700
Validation loss decreased (-0.384356 --> -0.699987).  Saving model ...
Epoch: 3 cost time: 1.4987678527832031
Epoch: 3, Steps: 8 | Train Loss: 1.100 Vali Loss: 0.910 Vali Acc: 0.791 Test Loss: 0.910 Test Acc: 0.791
Validation loss decreased (-0.699987 --> -0.790616).  Saving model ...
Epoch: 4 cost time: 1.6023154258728027
Epoch: 4, Steps: 8 | Train Loss: 0.719 Vali Loss: 0.653 Vali Acc: 0.800 Test Loss: 0.653 Test Acc: 0.800
Validation loss decreased (-0.790616 --> -0.799993).  Saving model ...
Epoch: 5 cost time: 1.4568405151367188
Epoch: 5, Steps: 8 | Train Loss: 0.477 Vali Loss: 0.540 Vali Acc: 0.822 Test Loss: 0.540 Test Acc: 0.822
Validation loss decreased (-0.799993 --> -0.821870).  Saving model ...
Epoch: 6 cost time: 1.5080657005310059
Epoch: 6, Steps: 8 | Train Loss: 0.378 Vali Loss: 0.511 Vali Acc: 0.812 Test Loss: 0.511 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6264386177062988
Epoch: 7, Steps: 8 | Train Loss: 0.232 Vali Loss: 0.481 Vali Acc: 0.850 Test Loss: 0.481 Test Acc: 0.850
Validation loss decreased (-0.821870 --> -0.849995).  Saving model ...
Epoch: 8 cost time: 1.523926019668579
Epoch: 8, Steps: 8 | Train Loss: 0.164 Vali Loss: 0.457 Vali Acc: 0.859 Test Loss: 0.457 Test Acc: 0.859
Validation loss decreased (-0.849995 --> -0.859370).  Saving model ...
Epoch: 9 cost time: 1.4988420009613037
Epoch: 9, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.471 Vali Acc: 0.859 Test Loss: 0.471 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4576857089996338
Epoch: 10, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.513 Vali Acc: 0.856 Test Loss: 0.513 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5208024978637695
Epoch: 11, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.509 Vali Acc: 0.853 Test Loss: 0.509 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.5272200107574463
Epoch: 12, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.505 Vali Acc: 0.856 Test Loss: 0.505 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.481748104095459
Epoch: 13, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.507 Vali Acc: 0.869 Test Loss: 0.507 Test Acc: 0.869
Validation loss decreased (-0.859370 --> -0.868745).  Saving model ...
Epoch: 14 cost time: 1.5066635608673096
Epoch: 14, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.521 Vali Acc: 0.869 Test Loss: 0.521 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4457273483276367
Epoch: 15, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.533 Vali Acc: 0.856 Test Loss: 0.533 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.502634048461914
Epoch: 16, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.533 Vali Acc: 0.856 Test Loss: 0.533 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.6173014640808105
Epoch: 17, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.540 Vali Acc: 0.856 Test Loss: 0.540 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.481215238571167
Epoch: 18, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.550 Vali Acc: 0.863 Test Loss: 0.550 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.576923131942749
Epoch: 19, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.548 Vali Acc: 0.863 Test Loss: 0.548 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.4897558689117432
Epoch: 20, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.552 Vali Acc: 0.856 Test Loss: 0.552 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.5660014152526855
Epoch: 21, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.563 Vali Acc: 0.853 Test Loss: 0.563 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.5391654968261719
Epoch: 22, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.597 Vali Acc: 0.850 Test Loss: 0.597 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.5323302745819092
Epoch: 23, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.593 Vali Acc: 0.847 Test Loss: 0.593 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 425704
model size : 2.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.083082437515259
Epoch: 1, Steps: 8 | Train Loss: 2.136 Vali Loss: 1.982 Vali Acc: 0.231 Test Loss: 1.982 Test Acc: 0.231
Validation loss decreased (inf --> -0.231230).  Saving model ...
Epoch: 2 cost time: 1.6415674686431885
Epoch: 2, Steps: 8 | Train Loss: 1.788 Vali Loss: 1.498 Vali Acc: 0.609 Test Loss: 1.498 Test Acc: 0.609
Validation loss decreased (-0.231230 --> -0.609360).  Saving model ...
Epoch: 3 cost time: 1.7027218341827393
Epoch: 3, Steps: 8 | Train Loss: 1.227 Vali Loss: 1.017 Vali Acc: 0.787 Test Loss: 1.017 Test Acc: 0.787
Validation loss decreased (-0.609360 --> -0.787490).  Saving model ...
Epoch: 4 cost time: 1.6720325946807861
Epoch: 4, Steps: 8 | Train Loss: 0.835 Vali Loss: 0.730 Vali Acc: 0.803 Test Loss: 0.730 Test Acc: 0.803
Validation loss decreased (-0.787490 --> -0.803118).  Saving model ...
Epoch: 5 cost time: 1.692995309829712
Epoch: 5, Steps: 8 | Train Loss: 0.516 Vali Loss: 0.592 Vali Acc: 0.822 Test Loss: 0.592 Test Acc: 0.822
Validation loss decreased (-0.803118 --> -0.821869).  Saving model ...
Epoch: 6 cost time: 1.2945609092712402
Epoch: 6, Steps: 8 | Train Loss: 0.388 Vali Loss: 0.528 Vali Acc: 0.831 Test Loss: 0.528 Test Acc: 0.831
Validation loss decreased (-0.821869 --> -0.831245).  Saving model ...
Epoch: 7 cost time: 1.3462927341461182
Epoch: 7, Steps: 8 | Train Loss: 0.296 Vali Loss: 0.494 Vali Acc: 0.841 Test Loss: 0.494 Test Acc: 0.841
Validation loss decreased (-0.831245 --> -0.840620).  Saving model ...
Epoch: 8 cost time: 1.6033477783203125
Epoch: 8, Steps: 8 | Train Loss: 0.189 Vali Loss: 0.508 Vali Acc: 0.847 Test Loss: 0.508 Test Acc: 0.847
Validation loss decreased (-0.840620 --> -0.846870).  Saving model ...
Epoch: 9 cost time: 1.7574100494384766
Epoch: 9, Steps: 8 | Train Loss: 0.123 Vali Loss: 0.525 Vali Acc: 0.841 Test Loss: 0.525 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7104802131652832
Epoch: 10, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.528 Vali Acc: 0.859 Test Loss: 0.528 Test Acc: 0.859
Validation loss decreased (-0.846870 --> -0.859370).  Saving model ...
Epoch: 11 cost time: 1.6975255012512207
Epoch: 11, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.525 Vali Acc: 0.856 Test Loss: 0.525 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7277982234954834
Epoch: 12, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.529 Vali Acc: 0.841 Test Loss: 0.529 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7658445835113525
Epoch: 13, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.560 Vali Acc: 0.847 Test Loss: 0.560 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.7566075325012207
Epoch: 14, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.576 Vali Acc: 0.853 Test Loss: 0.576 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.7573668956756592
Epoch: 15, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.583 Vali Acc: 0.856 Test Loss: 0.583 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.767836093902588
Epoch: 16, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.596 Vali Acc: 0.853 Test Loss: 0.596 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.7406165599822998
Epoch: 17, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.606 Vali Acc: 0.847 Test Loss: 0.606 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.7962853908538818
Epoch: 18, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.609 Vali Acc: 0.850 Test Loss: 0.609 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.7700765132904053
Epoch: 19, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.615 Vali Acc: 0.847 Test Loss: 0.615 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.7767338752746582
Epoch: 20, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.628 Vali Acc: 0.850 Test Loss: 0.628 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 1253352
model size : 5.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.6990623474121094
Epoch: 1, Steps: 8 | Train Loss: 2.063 Vali Loss: 1.855 Vali Acc: 0.378 Test Loss: 1.855 Test Acc: 0.378
Validation loss decreased (inf --> -0.378106).  Saving model ...
Epoch: 2 cost time: 1.3603980541229248
Epoch: 2, Steps: 8 | Train Loss: 1.649 Vali Loss: 1.351 Vali Acc: 0.700 Test Loss: 1.351 Test Acc: 0.700
Validation loss decreased (-0.378106 --> -0.699986).  Saving model ...
Epoch: 3 cost time: 1.2988672256469727
Epoch: 3, Steps: 8 | Train Loss: 1.101 Vali Loss: 0.916 Vali Acc: 0.791 Test Loss: 0.916 Test Acc: 0.791
Validation loss decreased (-0.699986 --> -0.790616).  Saving model ...
Epoch: 4 cost time: 1.2991337776184082
Epoch: 4, Steps: 8 | Train Loss: 0.724 Vali Loss: 0.658 Vali Acc: 0.800 Test Loss: 0.658 Test Acc: 0.800
Validation loss decreased (-0.790616 --> -0.799993).  Saving model ...
Epoch: 5 cost time: 1.2815563678741455
Epoch: 5, Steps: 8 | Train Loss: 0.490 Vali Loss: 0.546 Vali Acc: 0.825 Test Loss: 0.546 Test Acc: 0.825
Validation loss decreased (-0.799993 --> -0.824995).  Saving model ...
Epoch: 6 cost time: 1.26273512840271
Epoch: 6, Steps: 8 | Train Loss: 0.395 Vali Loss: 0.520 Vali Acc: 0.809 Test Loss: 0.520 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2833678722381592
Epoch: 7, Steps: 8 | Train Loss: 0.250 Vali Loss: 0.491 Vali Acc: 0.844 Test Loss: 0.491 Test Acc: 0.844
Validation loss decreased (-0.824995 --> -0.843745).  Saving model ...
Epoch: 8 cost time: 1.2564349174499512
Epoch: 8, Steps: 8 | Train Loss: 0.188 Vali Loss: 0.470 Vali Acc: 0.859 Test Loss: 0.470 Test Acc: 0.859
Validation loss decreased (-0.843745 --> -0.859370).  Saving model ...
Epoch: 9 cost time: 1.2976820468902588
Epoch: 9, Steps: 8 | Train Loss: 0.121 Vali Loss: 0.492 Vali Acc: 0.853 Test Loss: 0.492 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2946348190307617
Epoch: 10, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.536 Vali Acc: 0.847 Test Loss: 0.536 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2252392768859863
Epoch: 11, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.526 Vali Acc: 0.853 Test Loss: 0.526 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2164859771728516
Epoch: 12, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.526 Vali Acc: 0.850 Test Loss: 0.526 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2076733112335205
Epoch: 13, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.524 Vali Acc: 0.866 Test Loss: 0.524 Test Acc: 0.866
Validation loss decreased (-0.859370 --> -0.865620).  Saving model ...
Epoch: 14 cost time: 1.2403526306152344
Epoch: 14, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.539 Vali Acc: 0.866 Test Loss: 0.539 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2298047542572021
Epoch: 15, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.553 Vali Acc: 0.853 Test Loss: 0.553 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2376668453216553
Epoch: 16, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.559 Vali Acc: 0.847 Test Loss: 0.559 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2477383613586426
Epoch: 17, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.565 Vali Acc: 0.850 Test Loss: 0.565 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2563958168029785
Epoch: 18, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.571 Vali Acc: 0.859 Test Loss: 0.571 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.2600319385528564
Epoch: 19, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.569 Vali Acc: 0.863 Test Loss: 0.569 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.234382152557373
Epoch: 20, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.576 Vali Acc: 0.850 Test Loss: 0.576 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.2481226921081543
Epoch: 21, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.585 Vali Acc: 0.847 Test Loss: 0.585 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.2347126007080078
Epoch: 22, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.592 Vali Acc: 0.850 Test Loss: 0.592 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.0180885791778564
Epoch: 23, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.589 Vali Acc: 0.850 Test Loss: 0.589 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 425704
model size : 2.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.462290287017822
Epoch: 1, Steps: 8 | Train Loss: 2.088 Vali Loss: 1.963 Vali Acc: 0.300 Test Loss: 1.963 Test Acc: 0.300
Validation loss decreased (inf --> -0.299980).  Saving model ...
Epoch: 2 cost time: 4.09794545173645
Epoch: 2, Steps: 8 | Train Loss: 1.883 Vali Loss: 1.703 Vali Acc: 0.584 Test Loss: 1.703 Test Acc: 0.584
Validation loss decreased (-0.299980 --> -0.584358).  Saving model ...
Epoch: 3 cost time: 4.089577913284302
Epoch: 3, Steps: 8 | Train Loss: 1.602 Vali Loss: 1.381 Vali Acc: 0.756 Test Loss: 1.381 Test Acc: 0.756
Validation loss decreased (-0.584358 --> -0.756236).  Saving model ...
Epoch: 4 cost time: 4.0816802978515625
Epoch: 4, Steps: 8 | Train Loss: 1.229 Vali Loss: 1.083 Vali Acc: 0.800 Test Loss: 1.083 Test Acc: 0.800
Validation loss decreased (-0.756236 --> -0.799989).  Saving model ...
Epoch: 5 cost time: 4.1146252155303955
Epoch: 5, Steps: 8 | Train Loss: 0.943 Vali Loss: 0.831 Vali Acc: 0.828 Test Loss: 0.831 Test Acc: 0.828
Validation loss decreased (-0.799989 --> -0.828117).  Saving model ...
Epoch: 6 cost time: 4.12841010093689
Epoch: 6, Steps: 8 | Train Loss: 0.700 Vali Loss: 0.667 Vali Acc: 0.825 Test Loss: 0.667 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.105928421020508
Epoch: 7, Steps: 8 | Train Loss: 0.542 Vali Loss: 0.571 Vali Acc: 0.831 Test Loss: 0.571 Test Acc: 0.831
Validation loss decreased (-0.828117 --> -0.831244).  Saving model ...
Epoch: 8 cost time: 3.707043170928955
Epoch: 8, Steps: 8 | Train Loss: 0.390 Vali Loss: 0.505 Vali Acc: 0.850 Test Loss: 0.505 Test Acc: 0.850
Validation loss decreased (-0.831244 --> -0.849995).  Saving model ...
Epoch: 9 cost time: 4.3697710037231445
Epoch: 9, Steps: 8 | Train Loss: 0.307 Vali Loss: 0.472 Vali Acc: 0.844 Test Loss: 0.472 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.33662748336792
Epoch: 10, Steps: 8 | Train Loss: 0.232 Vali Loss: 0.464 Vali Acc: 0.850 Test Loss: 0.464 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 11 cost time: 4.558029890060425
Epoch: 11, Steps: 8 | Train Loss: 0.186 Vali Loss: 0.456 Vali Acc: 0.850 Test Loss: 0.456 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 12 cost time: 4.488253355026245
Epoch: 12, Steps: 8 | Train Loss: 0.137 Vali Loss: 0.452 Vali Acc: 0.856 Test Loss: 0.452 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.856245).  Saving model ...
Epoch: 13 cost time: 4.570353269577026
Epoch: 13, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.453 Vali Acc: 0.856 Test Loss: 0.453 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.417399168014526
Epoch: 14, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.455 Vali Acc: 0.863 Test Loss: 0.455 Test Acc: 0.863
Validation loss decreased (-0.856245 --> -0.862495).  Saving model ...
Epoch: 15 cost time: 4.291555643081665
Epoch: 15, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.461 Vali Acc: 0.856 Test Loss: 0.461 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.243113994598389
Epoch: 16, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.466 Vali Acc: 0.859 Test Loss: 0.466 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.217381000518799
Epoch: 17, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.465 Vali Acc: 0.863 Test Loss: 0.465 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.286905288696289
Epoch: 18, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.480 Vali Acc: 0.869 Test Loss: 0.480 Test Acc: 0.869
Validation loss decreased (-0.862495 --> -0.868745).  Saving model ...
Epoch: 19 cost time: 4.130069255828857
Epoch: 19, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.494 Vali Acc: 0.866 Test Loss: 0.494 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.838991403579712
Epoch: 20, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.502 Vali Acc: 0.863 Test Loss: 0.502 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.825284481048584
Epoch: 21, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.505 Vali Acc: 0.866 Test Loss: 0.505 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.7937533855438232
Epoch: 22, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.503 Vali Acc: 0.863 Test Loss: 0.503 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.9408743381500244
Epoch: 23, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.528 Vali Acc: 0.869 Test Loss: 0.528 Test Acc: 0.869
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.902665376663208
Epoch: 24, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.538 Vali Acc: 0.866 Test Loss: 0.538 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.9720869064331055
Epoch: 25, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.533 Vali Acc: 0.869 Test Loss: 0.533 Test Acc: 0.869
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.919710636138916
Epoch: 26, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.541 Vali Acc: 0.869 Test Loss: 0.541 Test Acc: 0.869
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.9252517223358154
Epoch: 27, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.546 Vali Acc: 0.872 Test Loss: 0.546 Test Acc: 0.872
Validation loss decreased (-0.868745 --> -0.871870).  Saving model ...
Epoch: 28 cost time: 3.881070852279663
Epoch: 28, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.543 Vali Acc: 0.872 Test Loss: 0.543 Test Acc: 0.872
Validation loss decreased (-0.871870 --> -0.871870).  Saving model ...
Epoch: 29 cost time: 4.1282830238342285
Epoch: 29, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.539 Vali Acc: 0.869 Test Loss: 0.539 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.765779733657837
Epoch: 30, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.543 Vali Acc: 0.872 Test Loss: 0.543 Test Acc: 0.872
Validation loss decreased (-0.871870 --> -0.871870).  Saving model ...
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 1212984
model size : 4.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.4444732666015625
Epoch: 1, Steps: 8 | Train Loss: 2.165 Vali Loss: 2.077 Vali Acc: 0.150 Test Loss: 2.077 Test Acc: 0.150
Validation loss decreased (inf --> -0.149979).  Saving model ...
Epoch: 2 cost time: 2.822706699371338
Epoch: 2, Steps: 8 | Train Loss: 1.948 Vali Loss: 1.779 Vali Acc: 0.512 Test Loss: 1.779 Test Acc: 0.512
Validation loss decreased (-0.149979 --> -0.512482).  Saving model ...
Epoch: 3 cost time: 2.775339126586914
Epoch: 3, Steps: 8 | Train Loss: 1.591 Vali Loss: 1.431 Vali Acc: 0.728 Test Loss: 1.431 Test Acc: 0.728
Validation loss decreased (-0.512482 --> -0.728111).  Saving model ...
Epoch: 4 cost time: 2.7493362426757812
Epoch: 4, Steps: 8 | Train Loss: 1.232 Vali Loss: 1.114 Vali Acc: 0.800 Test Loss: 1.114 Test Acc: 0.800
Validation loss decreased (-0.728111 --> -0.799989).  Saving model ...
Epoch: 5 cost time: 2.7725956439971924
Epoch: 5, Steps: 8 | Train Loss: 0.893 Vali Loss: 0.873 Vali Acc: 0.803 Test Loss: 0.873 Test Acc: 0.803
Validation loss decreased (-0.799989 --> -0.803116).  Saving model ...
Epoch: 6 cost time: 2.8096425533294678
Epoch: 6, Steps: 8 | Train Loss: 0.657 Vali Loss: 0.700 Vali Acc: 0.828 Test Loss: 0.700 Test Acc: 0.828
Validation loss decreased (-0.803116 --> -0.828118).  Saving model ...
Epoch: 7 cost time: 2.7790138721466064
Epoch: 7, Steps: 8 | Train Loss: 0.496 Vali Loss: 0.597 Vali Acc: 0.841 Test Loss: 0.597 Test Acc: 0.841
Validation loss decreased (-0.828118 --> -0.840619).  Saving model ...
Epoch: 8 cost time: 2.751197338104248
Epoch: 8, Steps: 8 | Train Loss: 0.388 Vali Loss: 0.535 Vali Acc: 0.847 Test Loss: 0.535 Test Acc: 0.847
Validation loss decreased (-0.840619 --> -0.846870).  Saving model ...
Epoch: 9 cost time: 2.9966695308685303
Epoch: 9, Steps: 8 | Train Loss: 0.256 Vali Loss: 0.491 Vali Acc: 0.856 Test Loss: 0.491 Test Acc: 0.856
Validation loss decreased (-0.846870 --> -0.856245).  Saving model ...
Epoch: 10 cost time: 2.8664417266845703
Epoch: 10, Steps: 8 | Train Loss: 0.191 Vali Loss: 0.483 Vali Acc: 0.853 Test Loss: 0.483 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.820453643798828
Epoch: 11, Steps: 8 | Train Loss: 0.154 Vali Loss: 0.489 Vali Acc: 0.859 Test Loss: 0.489 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 12 cost time: 2.770946502685547
Epoch: 12, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.475 Vali Acc: 0.859 Test Loss: 0.475 Test Acc: 0.859
Validation loss decreased (-0.859370 --> -0.859370).  Saving model ...
Epoch: 13 cost time: 2.6559643745422363
Epoch: 13, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.471 Vali Acc: 0.863 Test Loss: 0.471 Test Acc: 0.863
Validation loss decreased (-0.859370 --> -0.862495).  Saving model ...
Epoch: 14 cost time: 2.7824923992156982
Epoch: 14, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.475 Vali Acc: 0.859 Test Loss: 0.475 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.6147706508636475
Epoch: 15, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.477 Vali Acc: 0.863 Test Loss: 0.477 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.7355735301971436
Epoch: 16, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.490 Vali Acc: 0.863 Test Loss: 0.490 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.6482760906219482
Epoch: 17, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.501 Vali Acc: 0.863 Test Loss: 0.501 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.630176067352295
Epoch: 18, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.493 Vali Acc: 0.866 Test Loss: 0.493 Test Acc: 0.866
Validation loss decreased (-0.862495 --> -0.865620).  Saving model ...
Epoch: 19 cost time: 2.574253559112549
Epoch: 19, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.500 Vali Acc: 0.863 Test Loss: 0.500 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.5542774200439453
Epoch: 20, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.513 Vali Acc: 0.856 Test Loss: 0.513 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.612860918045044
Epoch: 21, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.524 Vali Acc: 0.856 Test Loss: 0.524 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.488542318344116
Epoch: 22, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.519 Vali Acc: 0.863 Test Loss: 0.519 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.4928934574127197
Epoch: 23, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.517 Vali Acc: 0.863 Test Loss: 0.517 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.485750675201416
Epoch: 24, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.523 Vali Acc: 0.863 Test Loss: 0.523 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.0060007572174072
Epoch: 25, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.529 Vali Acc: 0.863 Test Loss: 0.529 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.771357297897339
Epoch: 26, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.536 Vali Acc: 0.859 Test Loss: 0.536 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.635254383087158
Epoch: 27, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.540 Vali Acc: 0.859 Test Loss: 0.540 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.7236194610595703
Epoch: 28, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.540 Vali Acc: 0.859 Test Loss: 0.540 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 385272
model size : 1.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.75934100151062
Epoch: 1, Steps: 8 | Train Loss: 2.087 Vali Loss: 1.964 Vali Acc: 0.291 Test Loss: 1.964 Test Acc: 0.291
Validation loss decreased (inf --> -0.290605).  Saving model ...
Epoch: 2 cost time: 3.2494447231292725
Epoch: 2, Steps: 8 | Train Loss: 1.885 Vali Loss: 1.711 Vali Acc: 0.591 Test Loss: 1.711 Test Acc: 0.591
Validation loss decreased (-0.290605 --> -0.590608).  Saving model ...
Epoch: 3 cost time: 3.3928492069244385
Epoch: 3, Steps: 8 | Train Loss: 1.610 Vali Loss: 1.398 Vali Acc: 0.759 Test Loss: 1.398 Test Acc: 0.759
Validation loss decreased (-0.590608 --> -0.759361).  Saving model ...
Epoch: 4 cost time: 3.2794413566589355
Epoch: 4, Steps: 8 | Train Loss: 1.249 Vali Loss: 1.107 Vali Acc: 0.800 Test Loss: 1.107 Test Acc: 0.800
Validation loss decreased (-0.759361 --> -0.799989).  Saving model ...
Epoch: 5 cost time: 3.4603400230407715
Epoch: 5, Steps: 8 | Train Loss: 0.964 Vali Loss: 0.855 Vali Acc: 0.822 Test Loss: 0.855 Test Acc: 0.822
Validation loss decreased (-0.799989 --> -0.821866).  Saving model ...
Epoch: 6 cost time: 3.4055581092834473
Epoch: 6, Steps: 8 | Train Loss: 0.720 Vali Loss: 0.686 Vali Acc: 0.828 Test Loss: 0.686 Test Acc: 0.828
Validation loss decreased (-0.821866 --> -0.828118).  Saving model ...
Epoch: 7 cost time: 3.466641902923584
Epoch: 7, Steps: 8 | Train Loss: 0.554 Vali Loss: 0.586 Vali Acc: 0.828 Test Loss: 0.586 Test Acc: 0.828
Validation loss decreased (-0.828118 --> -0.828119).  Saving model ...
Epoch: 8 cost time: 3.3626840114593506
Epoch: 8, Steps: 8 | Train Loss: 0.399 Vali Loss: 0.517 Vali Acc: 0.856 Test Loss: 0.517 Test Acc: 0.856
Validation loss decreased (-0.828119 --> -0.856245).  Saving model ...
Epoch: 9 cost time: 3.5427451133728027
Epoch: 9, Steps: 8 | Train Loss: 0.311 Vali Loss: 0.479 Vali Acc: 0.850 Test Loss: 0.479 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.2833564281463623
Epoch: 10, Steps: 8 | Train Loss: 0.237 Vali Loss: 0.472 Vali Acc: 0.853 Test Loss: 0.472 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.3407154083251953
Epoch: 11, Steps: 8 | Train Loss: 0.189 Vali Loss: 0.469 Vali Acc: 0.856 Test Loss: 0.469 Test Acc: 0.856
Validation loss decreased (-0.856245 --> -0.856245).  Saving model ...
Epoch: 12 cost time: 3.242990255355835
Epoch: 12, Steps: 8 | Train Loss: 0.140 Vali Loss: 0.466 Vali Acc: 0.859 Test Loss: 0.466 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 13 cost time: 3.315326452255249
Epoch: 13, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.466 Vali Acc: 0.856 Test Loss: 0.466 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.3693699836730957
Epoch: 14, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.466 Vali Acc: 0.859 Test Loss: 0.466 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.3042259216308594
Epoch: 15, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.473 Vali Acc: 0.859 Test Loss: 0.473 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.3175394535064697
Epoch: 16, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.478 Vali Acc: 0.866 Test Loss: 0.478 Test Acc: 0.866
Validation loss decreased (-0.859370 --> -0.865620).  Saving model ...
Epoch: 17 cost time: 3.3683950901031494
Epoch: 17, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.481 Vali Acc: 0.863 Test Loss: 0.481 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.385829448699951
Epoch: 18, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.496 Vali Acc: 0.866 Test Loss: 0.496 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.2521467208862305
Epoch: 19, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.509 Vali Acc: 0.866 Test Loss: 0.509 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.493699312210083
Epoch: 20, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.515 Vali Acc: 0.866 Test Loss: 0.515 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.203125238418579
Epoch: 21, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.520 Vali Acc: 0.859 Test Loss: 0.520 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.2689850330352783
Epoch: 22, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.520 Vali Acc: 0.856 Test Loss: 0.520 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.2363874912261963
Epoch: 23, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.545 Vali Acc: 0.863 Test Loss: 0.545 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.370156764984131
Epoch: 24, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.557 Vali Acc: 0.869 Test Loss: 0.557 Test Acc: 0.869
Validation loss decreased (-0.865620 --> -0.868744).  Saving model ...
Epoch: 25 cost time: 3.3820877075195312
Epoch: 25, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.551 Vali Acc: 0.866 Test Loss: 0.551 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.3076207637786865
Epoch: 26, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.559 Vali Acc: 0.863 Test Loss: 0.559 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.3346762657165527
Epoch: 27, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.565 Vali Acc: 0.866 Test Loss: 0.565 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.3331801891326904
Epoch: 28, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.563 Vali Acc: 0.866 Test Loss: 0.563 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.3385703563690186
Epoch: 29, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.560 Vali Acc: 0.872 Test Loss: 0.560 Test Acc: 0.872
Validation loss decreased (-0.868744 --> -0.871869).  Saving model ...
Epoch: 30 cost time: 3.3482863903045654
Epoch: 30, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.563 Vali Acc: 0.875 Test Loss: 0.563 Test Acc: 0.875
Validation loss decreased (-0.871869 --> -0.874994).  Saving model ...
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.875
model parameter : 1212984
model size : 4.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.847151279449463
Epoch: 1, Steps: 8 | Train Loss: 2.166 Vali Loss: 2.077 Vali Acc: 0.153 Test Loss: 2.077 Test Acc: 0.153
Validation loss decreased (inf --> -0.153104).  Saving model ...
Epoch: 2 cost time: 2.232119560241699
Epoch: 2, Steps: 8 | Train Loss: 1.948 Vali Loss: 1.779 Vali Acc: 0.522 Test Loss: 1.779 Test Acc: 0.522
Validation loss decreased (-0.153104 --> -0.521857).  Saving model ...
Epoch: 3 cost time: 2.2155544757843018
Epoch: 3, Steps: 8 | Train Loss: 1.592 Vali Loss: 1.432 Vali Acc: 0.734 Test Loss: 1.432 Test Acc: 0.734
Validation loss decreased (-0.521857 --> -0.734361).  Saving model ...
Epoch: 4 cost time: 2.3567681312561035
Epoch: 4, Steps: 8 | Train Loss: 1.232 Vali Loss: 1.115 Vali Acc: 0.803 Test Loss: 1.115 Test Acc: 0.803
Validation loss decreased (-0.734361 --> -0.803114).  Saving model ...
Epoch: 5 cost time: 2.4061312675476074
Epoch: 5, Steps: 8 | Train Loss: 0.894 Vali Loss: 0.876 Vali Acc: 0.803 Test Loss: 0.876 Test Acc: 0.803
Validation loss decreased (-0.803114 --> -0.803116).  Saving model ...
Epoch: 6 cost time: 2.313833713531494
Epoch: 6, Steps: 8 | Train Loss: 0.659 Vali Loss: 0.702 Vali Acc: 0.828 Test Loss: 0.702 Test Acc: 0.828
Validation loss decreased (-0.803116 --> -0.828118).  Saving model ...
Epoch: 7 cost time: 2.281093120574951
Epoch: 7, Steps: 8 | Train Loss: 0.497 Vali Loss: 0.600 Vali Acc: 0.841 Test Loss: 0.600 Test Acc: 0.841
Validation loss decreased (-0.828118 --> -0.840619).  Saving model ...
Epoch: 8 cost time: 2.249486207962036
Epoch: 8, Steps: 8 | Train Loss: 0.389 Vali Loss: 0.538 Vali Acc: 0.847 Test Loss: 0.538 Test Acc: 0.847
Validation loss decreased (-0.840619 --> -0.846870).  Saving model ...
Epoch: 9 cost time: 2.408672332763672
Epoch: 9, Steps: 8 | Train Loss: 0.255 Vali Loss: 0.493 Vali Acc: 0.856 Test Loss: 0.493 Test Acc: 0.856
Validation loss decreased (-0.846870 --> -0.856245).  Saving model ...
Epoch: 10 cost time: 2.3617217540740967
Epoch: 10, Steps: 8 | Train Loss: 0.190 Vali Loss: 0.486 Vali Acc: 0.853 Test Loss: 0.486 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.2898788452148438
Epoch: 11, Steps: 8 | Train Loss: 0.154 Vali Loss: 0.491 Vali Acc: 0.859 Test Loss: 0.491 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 12 cost time: 2.3353750705718994
Epoch: 12, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.478 Vali Acc: 0.859 Test Loss: 0.478 Test Acc: 0.859
Validation loss decreased (-0.859370 --> -0.859370).  Saving model ...
Epoch: 13 cost time: 2.2821404933929443
Epoch: 13, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.475 Vali Acc: 0.866 Test Loss: 0.475 Test Acc: 0.866
Validation loss decreased (-0.859370 --> -0.865620).  Saving model ...
Epoch: 14 cost time: 2.273383855819702
Epoch: 14, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.479 Vali Acc: 0.856 Test Loss: 0.479 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.3775789737701416
Epoch: 15, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.481 Vali Acc: 0.859 Test Loss: 0.481 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.4356980323791504
Epoch: 16, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.493 Vali Acc: 0.859 Test Loss: 0.493 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.38022780418396
Epoch: 17, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.505 Vali Acc: 0.863 Test Loss: 0.505 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.5311529636383057
Epoch: 18, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.497 Vali Acc: 0.856 Test Loss: 0.497 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.4839813709259033
Epoch: 19, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.513 Vali Acc: 0.850 Test Loss: 0.513 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.4200921058654785
Epoch: 20, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.525 Vali Acc: 0.853 Test Loss: 0.525 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.529437303543091
Epoch: 21, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.531 Vali Acc: 0.856 Test Loss: 0.531 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.4674384593963623
Epoch: 22, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.520 Vali Acc: 0.863 Test Loss: 0.520 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.5269317626953125
Epoch: 23, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.513 Vali Acc: 0.866 Test Loss: 0.513 Test Acc: 0.866
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 385272
model size : 1.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.1565537452697754
Epoch: 1, Steps: 8 | Train Loss: 2.086 Vali Loss: 1.964 Vali Acc: 0.278 Test Loss: 1.964 Test Acc: 0.278
Validation loss decreased (inf --> -0.278105).  Saving model ...
Epoch: 2 cost time: 1.7829132080078125
Epoch: 2, Steps: 8 | Train Loss: 1.889 Vali Loss: 1.720 Vali Acc: 0.572 Test Loss: 1.720 Test Acc: 0.572
Validation loss decreased (-0.278105 --> -0.571858).  Saving model ...
Epoch: 3 cost time: 1.8723318576812744
Epoch: 3, Steps: 8 | Train Loss: 1.622 Vali Loss: 1.415 Vali Acc: 0.747 Test Loss: 1.415 Test Acc: 0.747
Validation loss decreased (-0.571858 --> -0.746861).  Saving model ...
Epoch: 4 cost time: 1.8267900943756104
Epoch: 4, Steps: 8 | Train Loss: 1.269 Vali Loss: 1.129 Vali Acc: 0.794 Test Loss: 1.129 Test Acc: 0.794
Validation loss decreased (-0.746861 --> -0.793739).  Saving model ...
Epoch: 5 cost time: 1.8028771877288818
Epoch: 5, Steps: 8 | Train Loss: 0.987 Vali Loss: 0.882 Vali Acc: 0.812 Test Loss: 0.882 Test Acc: 0.812
Validation loss decreased (-0.793739 --> -0.812491).  Saving model ...
Epoch: 6 cost time: 1.8264594078063965
Epoch: 6, Steps: 8 | Train Loss: 0.750 Vali Loss: 0.714 Vali Acc: 0.819 Test Loss: 0.714 Test Acc: 0.819
Validation loss decreased (-0.812491 --> -0.818743).  Saving model ...
Epoch: 7 cost time: 1.7616965770721436
Epoch: 7, Steps: 8 | Train Loss: 0.592 Vali Loss: 0.618 Vali Acc: 0.822 Test Loss: 0.618 Test Acc: 0.822
Validation loss decreased (-0.818743 --> -0.821869).  Saving model ...
Epoch: 8 cost time: 1.7633419036865234
Epoch: 8, Steps: 8 | Train Loss: 0.438 Vali Loss: 0.549 Vali Acc: 0.838 Test Loss: 0.549 Test Acc: 0.838
Validation loss decreased (-0.821869 --> -0.837495).  Saving model ...
Epoch: 9 cost time: 1.7151761054992676
Epoch: 9, Steps: 8 | Train Loss: 0.354 Vali Loss: 0.515 Vali Acc: 0.841 Test Loss: 0.515 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 10 cost time: 1.6978788375854492
Epoch: 10, Steps: 8 | Train Loss: 0.273 Vali Loss: 0.509 Vali Acc: 0.825 Test Loss: 0.509 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7495951652526855
Epoch: 11, Steps: 8 | Train Loss: 0.226 Vali Loss: 0.505 Vali Acc: 0.838 Test Loss: 0.505 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6529040336608887
Epoch: 12, Steps: 8 | Train Loss: 0.167 Vali Loss: 0.501 Vali Acc: 0.856 Test Loss: 0.501 Test Acc: 0.856
Validation loss decreased (-0.840620 --> -0.856245).  Saving model ...
Epoch: 13 cost time: 1.795605182647705
Epoch: 13, Steps: 8 | Train Loss: 0.133 Vali Loss: 0.502 Vali Acc: 0.847 Test Loss: 0.502 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.809478759765625
Epoch: 14, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.499 Vali Acc: 0.853 Test Loss: 0.499 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8472938537597656
Epoch: 15, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.505 Vali Acc: 0.850 Test Loss: 0.505 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.8021273612976074
Epoch: 16, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.512 Vali Acc: 0.850 Test Loss: 0.512 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.7974433898925781
Epoch: 17, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.515 Vali Acc: 0.847 Test Loss: 0.515 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.8096938133239746
Epoch: 18, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.530 Vali Acc: 0.850 Test Loss: 0.530 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.8219597339630127
Epoch: 19, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.542 Vali Acc: 0.850 Test Loss: 0.542 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.5346529483795166
Epoch: 20, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.547 Vali Acc: 0.847 Test Loss: 0.547 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.9290504455566406
Epoch: 21, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.552 Vali Acc: 0.850 Test Loss: 0.552 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.8606188297271729
Epoch: 22, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.553 Vali Acc: 0.844 Test Loss: 0.553 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 1212984
model size : 4.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.6893393993377686
Epoch: 1, Steps: 8 | Train Loss: 2.154 Vali Loss: 2.078 Vali Acc: 0.153 Test Loss: 2.078 Test Acc: 0.153
Validation loss decreased (inf --> -0.153104).  Saving model ...
Epoch: 2 cost time: 1.309882402420044
Epoch: 2, Steps: 8 | Train Loss: 1.946 Vali Loss: 1.783 Vali Acc: 0.509 Test Loss: 1.783 Test Acc: 0.509
Validation loss decreased (-0.153104 --> -0.509357).  Saving model ...
Epoch: 3 cost time: 1.3208508491516113
Epoch: 3, Steps: 8 | Train Loss: 1.599 Vali Loss: 1.441 Vali Acc: 0.719 Test Loss: 1.441 Test Acc: 0.719
Validation loss decreased (-0.509357 --> -0.718736).  Saving model ...
Epoch: 4 cost time: 1.3443660736083984
Epoch: 4, Steps: 8 | Train Loss: 1.242 Vali Loss: 1.129 Vali Acc: 0.800 Test Loss: 1.129 Test Acc: 0.800
Validation loss decreased (-0.718736 --> -0.799989).  Saving model ...
Epoch: 5 cost time: 1.3411691188812256
Epoch: 5, Steps: 8 | Train Loss: 0.911 Vali Loss: 0.892 Vali Acc: 0.800 Test Loss: 0.892 Test Acc: 0.800
Validation loss decreased (-0.799989 --> -0.799991).  Saving model ...
Epoch: 6 cost time: 1.3248114585876465
Epoch: 6, Steps: 8 | Train Loss: 0.681 Vali Loss: 0.720 Vali Acc: 0.825 Test Loss: 0.720 Test Acc: 0.825
Validation loss decreased (-0.799991 --> -0.824993).  Saving model ...
Epoch: 7 cost time: 1.3290338516235352
Epoch: 7, Steps: 8 | Train Loss: 0.524 Vali Loss: 0.620 Vali Acc: 0.838 Test Loss: 0.620 Test Acc: 0.838
Validation loss decreased (-0.824993 --> -0.837494).  Saving model ...
Epoch: 8 cost time: 1.327155590057373
Epoch: 8, Steps: 8 | Train Loss: 0.425 Vali Loss: 0.557 Vali Acc: 0.847 Test Loss: 0.557 Test Acc: 0.847
Validation loss decreased (-0.837494 --> -0.846869).  Saving model ...
Epoch: 9 cost time: 1.3429460525512695
Epoch: 9, Steps: 8 | Train Loss: 0.289 Vali Loss: 0.512 Vali Acc: 0.853 Test Loss: 0.512 Test Acc: 0.853
Validation loss decreased (-0.846869 --> -0.853120).  Saving model ...
Epoch: 10 cost time: 1.3129618167877197
Epoch: 10, Steps: 8 | Train Loss: 0.219 Vali Loss: 0.508 Vali Acc: 0.850 Test Loss: 0.508 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4223408699035645
Epoch: 11, Steps: 8 | Train Loss: 0.179 Vali Loss: 0.513 Vali Acc: 0.850 Test Loss: 0.513 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.322251796722412
Epoch: 12, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.495 Vali Acc: 0.853 Test Loss: 0.495 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 13 cost time: 1.3453352451324463
Epoch: 13, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.489 Vali Acc: 0.856 Test Loss: 0.489 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 14 cost time: 1.3437724113464355
Epoch: 14, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.495 Vali Acc: 0.856 Test Loss: 0.495 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3394286632537842
Epoch: 15, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.495 Vali Acc: 0.859 Test Loss: 0.495 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 16 cost time: 1.356755256652832
Epoch: 16, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.505 Vali Acc: 0.856 Test Loss: 0.505 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3964643478393555
Epoch: 17, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.516 Vali Acc: 0.856 Test Loss: 0.516 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3812005519866943
Epoch: 18, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.507 Vali Acc: 0.853 Test Loss: 0.507 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3700523376464844
Epoch: 19, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.516 Vali Acc: 0.853 Test Loss: 0.516 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.4015393257141113
Epoch: 20, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.528 Vali Acc: 0.850 Test Loss: 0.528 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.3923442363739014
Epoch: 21, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.538 Vali Acc: 0.850 Test Loss: 0.538 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.3647527694702148
Epoch: 22, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.533 Vali Acc: 0.850 Test Loss: 0.533 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.3186886310577393
Epoch: 23, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.530 Vali Acc: 0.853 Test Loss: 0.530 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.3084437847137451
Epoch: 24, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.536 Vali Acc: 0.856 Test Loss: 0.536 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.2716774940490723
Epoch: 25, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.544 Vali Acc: 0.856 Test Loss: 0.544 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 385272
model size : 1.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.7994418144226074
Epoch: 1, Steps: 8 | Train Loss: 2.107 Vali Loss: 1.990 Vali Acc: 0.291 Test Loss: 1.990 Test Acc: 0.291
Validation loss decreased (inf --> -0.290605).  Saving model ...
Epoch: 2 cost time: 2.473907470703125
Epoch: 2, Steps: 8 | Train Loss: 1.871 Vali Loss: 1.715 Vali Acc: 0.544 Test Loss: 1.715 Test Acc: 0.544
Validation loss decreased (-0.290605 --> -0.543733).  Saving model ...
Epoch: 3 cost time: 2.389270067214966
Epoch: 3, Steps: 8 | Train Loss: 1.563 Vali Loss: 1.388 Vali Acc: 0.678 Test Loss: 1.388 Test Acc: 0.678
Validation loss decreased (-0.543733 --> -0.678111).  Saving model ...
Epoch: 4 cost time: 2.468888759613037
Epoch: 4, Steps: 8 | Train Loss: 1.186 Vali Loss: 1.108 Vali Acc: 0.744 Test Loss: 1.108 Test Acc: 0.744
Validation loss decreased (-0.678111 --> -0.743739).  Saving model ...
Epoch: 5 cost time: 2.4794981479644775
Epoch: 5, Steps: 8 | Train Loss: 0.927 Vali Loss: 0.889 Vali Acc: 0.791 Test Loss: 0.889 Test Acc: 0.791
Validation loss decreased (-0.743739 --> -0.790616).  Saving model ...
Epoch: 6 cost time: 2.4252161979675293
Epoch: 6, Steps: 8 | Train Loss: 0.720 Vali Loss: 0.731 Vali Acc: 0.812 Test Loss: 0.731 Test Acc: 0.812
Validation loss decreased (-0.790616 --> -0.812493).  Saving model ...
Epoch: 7 cost time: 2.3074069023132324
Epoch: 7, Steps: 8 | Train Loss: 0.533 Vali Loss: 0.645 Vali Acc: 0.831 Test Loss: 0.645 Test Acc: 0.831
Validation loss decreased (-0.812493 --> -0.831244).  Saving model ...
Epoch: 8 cost time: 2.4444704055786133
Epoch: 8, Steps: 8 | Train Loss: 0.415 Vali Loss: 0.584 Vali Acc: 0.825 Test Loss: 0.584 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.512803554534912
Epoch: 9, Steps: 8 | Train Loss: 0.311 Vali Loss: 0.529 Vali Acc: 0.838 Test Loss: 0.529 Test Acc: 0.838
Validation loss decreased (-0.831244 --> -0.837495).  Saving model ...
Epoch: 10 cost time: 2.5335731506347656
Epoch: 10, Steps: 8 | Train Loss: 0.259 Vali Loss: 0.508 Vali Acc: 0.831 Test Loss: 0.508 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.4504446983337402
Epoch: 11, Steps: 8 | Train Loss: 0.188 Vali Loss: 0.495 Vali Acc: 0.853 Test Loss: 0.495 Test Acc: 0.853
Validation loss decreased (-0.837495 --> -0.853120).  Saving model ...
Epoch: 12 cost time: 2.516515016555786
Epoch: 12, Steps: 8 | Train Loss: 0.143 Vali Loss: 0.463 Vali Acc: 0.863 Test Loss: 0.463 Test Acc: 0.863
Validation loss decreased (-0.853120 --> -0.862495).  Saving model ...
Epoch: 13 cost time: 2.499903678894043
Epoch: 13, Steps: 8 | Train Loss: 0.114 Vali Loss: 0.441 Vali Acc: 0.869 Test Loss: 0.441 Test Acc: 0.869
Validation loss decreased (-0.862495 --> -0.868746).  Saving model ...
Epoch: 14 cost time: 2.5894930362701416
Epoch: 14, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.448 Vali Acc: 0.856 Test Loss: 0.448 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.510735273361206
Epoch: 15, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.448 Vali Acc: 0.856 Test Loss: 0.448 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.6188340187072754
Epoch: 16, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.462 Vali Acc: 0.853 Test Loss: 0.462 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.565436363220215
Epoch: 17, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.468 Vali Acc: 0.853 Test Loss: 0.468 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.6228885650634766
Epoch: 18, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.471 Vali Acc: 0.856 Test Loss: 0.471 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.620507001876831
Epoch: 19, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.462 Vali Acc: 0.863 Test Loss: 0.462 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.585103988647461
Epoch: 20, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.466 Vali Acc: 0.863 Test Loss: 0.466 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.6645350456237793
Epoch: 21, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.482 Vali Acc: 0.853 Test Loss: 0.482 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.6630213260650635
Epoch: 22, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.493 Vali Acc: 0.856 Test Loss: 0.493 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.62211275100708
Epoch: 23, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.471 Vali Acc: 0.856 Test Loss: 0.471 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 626872
model size : 2.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.1110117435455322
Epoch: 1, Steps: 8 | Train Loss: 2.090 Vali Loss: 1.986 Vali Acc: 0.294 Test Loss: 1.986 Test Acc: 0.294
Validation loss decreased (inf --> -0.293730).  Saving model ...
Epoch: 2 cost time: 1.7212350368499756
Epoch: 2, Steps: 8 | Train Loss: 1.899 Vali Loss: 1.717 Vali Acc: 0.509 Test Loss: 1.717 Test Acc: 0.509
Validation loss decreased (-0.293730 --> -0.509358).  Saving model ...
Epoch: 3 cost time: 1.642648458480835
Epoch: 3, Steps: 8 | Train Loss: 1.629 Vali Loss: 1.394 Vali Acc: 0.728 Test Loss: 1.394 Test Acc: 0.728
Validation loss decreased (-0.509358 --> -0.728111).  Saving model ...
Epoch: 4 cost time: 1.592212200164795
Epoch: 4, Steps: 8 | Train Loss: 1.282 Vali Loss: 1.103 Vali Acc: 0.800 Test Loss: 1.103 Test Acc: 0.800
Validation loss decreased (-0.728111 --> -0.799989).  Saving model ...
Epoch: 5 cost time: 1.7500665187835693
Epoch: 5, Steps: 8 | Train Loss: 0.956 Vali Loss: 0.867 Vali Acc: 0.834 Test Loss: 0.867 Test Acc: 0.834
Validation loss decreased (-0.799989 --> -0.834366).  Saving model ...
Epoch: 6 cost time: 1.7048702239990234
Epoch: 6, Steps: 8 | Train Loss: 0.724 Vali Loss: 0.708 Vali Acc: 0.834 Test Loss: 0.708 Test Acc: 0.834
Validation loss decreased (-0.834366 --> -0.834368).  Saving model ...
Epoch: 7 cost time: 1.7223050594329834
Epoch: 7, Steps: 8 | Train Loss: 0.527 Vali Loss: 0.601 Vali Acc: 0.859 Test Loss: 0.601 Test Acc: 0.859
Validation loss decreased (-0.834368 --> -0.859369).  Saving model ...
Epoch: 8 cost time: 1.6675686836242676
Epoch: 8, Steps: 8 | Train Loss: 0.409 Vali Loss: 0.537 Vali Acc: 0.878 Test Loss: 0.537 Test Acc: 0.878
Validation loss decreased (-0.859369 --> -0.878120).  Saving model ...
Epoch: 9 cost time: 1.7192494869232178
Epoch: 9, Steps: 8 | Train Loss: 0.295 Vali Loss: 0.502 Vali Acc: 0.872 Test Loss: 0.502 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6567115783691406
Epoch: 10, Steps: 8 | Train Loss: 0.225 Vali Loss: 0.488 Vali Acc: 0.859 Test Loss: 0.488 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7173092365264893
Epoch: 11, Steps: 8 | Train Loss: 0.173 Vali Loss: 0.475 Vali Acc: 0.866 Test Loss: 0.475 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.7492356300354004
Epoch: 12, Steps: 8 | Train Loss: 0.130 Vali Loss: 0.452 Vali Acc: 0.872 Test Loss: 0.452 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.5843348503112793
Epoch: 13, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.451 Vali Acc: 0.878 Test Loss: 0.451 Test Acc: 0.878
Validation loss decreased (-0.878120 --> -0.878120).  Saving model ...
Epoch: 14 cost time: 1.7104218006134033
Epoch: 14, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.451 Vali Acc: 0.875 Test Loss: 0.451 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.617197036743164
Epoch: 15, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.469 Vali Acc: 0.878 Test Loss: 0.469 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.76900315284729
Epoch: 16, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.493 Vali Acc: 0.866 Test Loss: 0.493 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.7368407249450684
Epoch: 17, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.494 Vali Acc: 0.859 Test Loss: 0.494 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.7298674583435059
Epoch: 18, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.497 Vali Acc: 0.856 Test Loss: 0.497 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.7345430850982666
Epoch: 19, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.501 Vali Acc: 0.853 Test Loss: 0.501 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.6436963081359863
Epoch: 20, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.510 Vali Acc: 0.850 Test Loss: 0.510 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.6601524353027344
Epoch: 21, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.520 Vali Acc: 0.850 Test Loss: 0.520 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.7082509994506836
Epoch: 22, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.534 Vali Acc: 0.847 Test Loss: 0.534 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.7770061492919922
Epoch: 23, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.545 Vali Acc: 0.844 Test Loss: 0.545 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.878125
model parameter : 212984
model size : 1.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.6632840633392334
Epoch: 1, Steps: 8 | Train Loss: 2.107 Vali Loss: 1.991 Vali Acc: 0.294 Test Loss: 1.991 Test Acc: 0.294
Validation loss decreased (inf --> -0.293730).  Saving model ...
Epoch: 2 cost time: 2.1307475566864014
Epoch: 2, Steps: 8 | Train Loss: 1.871 Vali Loss: 1.717 Vali Acc: 0.534 Test Loss: 1.717 Test Acc: 0.534
Validation loss decreased (-0.293730 --> -0.534358).  Saving model ...
Epoch: 3 cost time: 2.1395888328552246
Epoch: 3, Steps: 8 | Train Loss: 1.564 Vali Loss: 1.391 Vali Acc: 0.678 Test Loss: 1.391 Test Acc: 0.678
Validation loss decreased (-0.534358 --> -0.678111).  Saving model ...
Epoch: 4 cost time: 2.12528133392334
Epoch: 4, Steps: 8 | Train Loss: 1.187 Vali Loss: 1.113 Vali Acc: 0.747 Test Loss: 1.113 Test Acc: 0.747
Validation loss decreased (-0.678111 --> -0.746864).  Saving model ...
Epoch: 5 cost time: 2.1602895259857178
Epoch: 5, Steps: 8 | Train Loss: 0.929 Vali Loss: 0.895 Vali Acc: 0.787 Test Loss: 0.895 Test Acc: 0.787
Validation loss decreased (-0.746864 --> -0.787491).  Saving model ...
Epoch: 6 cost time: 2.229485034942627
Epoch: 6, Steps: 8 | Train Loss: 0.722 Vali Loss: 0.738 Vali Acc: 0.812 Test Loss: 0.738 Test Acc: 0.812
Validation loss decreased (-0.787491 --> -0.812493).  Saving model ...
Epoch: 7 cost time: 2.021583318710327
Epoch: 7, Steps: 8 | Train Loss: 0.535 Vali Loss: 0.653 Vali Acc: 0.828 Test Loss: 0.653 Test Acc: 0.828
Validation loss decreased (-0.812493 --> -0.828118).  Saving model ...
Epoch: 8 cost time: 2.185701847076416
Epoch: 8, Steps: 8 | Train Loss: 0.417 Vali Loss: 0.592 Vali Acc: 0.825 Test Loss: 0.592 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.0490992069244385
Epoch: 9, Steps: 8 | Train Loss: 0.311 Vali Loss: 0.537 Vali Acc: 0.838 Test Loss: 0.537 Test Acc: 0.838
Validation loss decreased (-0.828118 --> -0.837495).  Saving model ...
Epoch: 10 cost time: 2.0745322704315186
Epoch: 10, Steps: 8 | Train Loss: 0.260 Vali Loss: 0.516 Vali Acc: 0.834 Test Loss: 0.516 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.114946126937866
Epoch: 11, Steps: 8 | Train Loss: 0.189 Vali Loss: 0.502 Vali Acc: 0.847 Test Loss: 0.502 Test Acc: 0.847
Validation loss decreased (-0.837495 --> -0.846870).  Saving model ...
Epoch: 12 cost time: 2.0800836086273193
Epoch: 12, Steps: 8 | Train Loss: 0.144 Vali Loss: 0.470 Vali Acc: 0.856 Test Loss: 0.470 Test Acc: 0.856
Validation loss decreased (-0.846870 --> -0.856245).  Saving model ...
Epoch: 13 cost time: 2.1230010986328125
Epoch: 13, Steps: 8 | Train Loss: 0.116 Vali Loss: 0.449 Vali Acc: 0.863 Test Loss: 0.449 Test Acc: 0.863
Validation loss decreased (-0.856245 --> -0.862496).  Saving model ...
Epoch: 14 cost time: 2.123661518096924
Epoch: 14, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.458 Vali Acc: 0.850 Test Loss: 0.458 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.054180860519409
Epoch: 15, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.459 Vali Acc: 0.850 Test Loss: 0.459 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.1458888053894043
Epoch: 16, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.471 Vali Acc: 0.847 Test Loss: 0.471 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.068709373474121
Epoch: 17, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.476 Vali Acc: 0.847 Test Loss: 0.476 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.07378888130188
Epoch: 18, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.481 Vali Acc: 0.850 Test Loss: 0.481 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.0919525623321533
Epoch: 19, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.472 Vali Acc: 0.853 Test Loss: 0.472 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.064772367477417
Epoch: 20, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.478 Vali Acc: 0.850 Test Loss: 0.478 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.1792373657226562
Epoch: 21, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.495 Vali Acc: 0.850 Test Loss: 0.495 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.179431915283203
Epoch: 22, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.508 Vali Acc: 0.850 Test Loss: 0.508 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.20623779296875
Epoch: 23, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.484 Vali Acc: 0.853 Test Loss: 0.484 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 626872
model size : 2.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.0025229454040527
Epoch: 1, Steps: 8 | Train Loss: 2.088 Vali Loss: 1.985 Vali Acc: 0.297 Test Loss: 1.985 Test Acc: 0.297
Validation loss decreased (inf --> -0.296855).  Saving model ...
Epoch: 2 cost time: 1.555095911026001
Epoch: 2, Steps: 8 | Train Loss: 1.896 Vali Loss: 1.717 Vali Acc: 0.509 Test Loss: 1.717 Test Acc: 0.509
Validation loss decreased (-0.296855 --> -0.509358).  Saving model ...
Epoch: 3 cost time: 1.4298880100250244
Epoch: 3, Steps: 8 | Train Loss: 1.627 Vali Loss: 1.395 Vali Acc: 0.728 Test Loss: 1.395 Test Acc: 0.728
Validation loss decreased (-0.509358 --> -0.728111).  Saving model ...
Epoch: 4 cost time: 1.5241689682006836
Epoch: 4, Steps: 8 | Train Loss: 1.281 Vali Loss: 1.105 Vali Acc: 0.797 Test Loss: 1.105 Test Acc: 0.797
Validation loss decreased (-0.728111 --> -0.796864).  Saving model ...
Epoch: 5 cost time: 1.5160012245178223
Epoch: 5, Steps: 8 | Train Loss: 0.954 Vali Loss: 0.871 Vali Acc: 0.834 Test Loss: 0.871 Test Acc: 0.834
Validation loss decreased (-0.796864 --> -0.834366).  Saving model ...
Epoch: 6 cost time: 1.4990308284759521
Epoch: 6, Steps: 8 | Train Loss: 0.723 Vali Loss: 0.713 Vali Acc: 0.834 Test Loss: 0.713 Test Acc: 0.834
Validation loss decreased (-0.834366 --> -0.834368).  Saving model ...
Epoch: 7 cost time: 1.4826204776763916
Epoch: 7, Steps: 8 | Train Loss: 0.527 Vali Loss: 0.606 Vali Acc: 0.859 Test Loss: 0.606 Test Acc: 0.859
Validation loss decreased (-0.834368 --> -0.859369).  Saving model ...
Epoch: 8 cost time: 1.4331083297729492
Epoch: 8, Steps: 8 | Train Loss: 0.409 Vali Loss: 0.543 Vali Acc: 0.875 Test Loss: 0.543 Test Acc: 0.875
Validation loss decreased (-0.859369 --> -0.874995).  Saving model ...
Epoch: 9 cost time: 1.401221513748169
Epoch: 9, Steps: 8 | Train Loss: 0.295 Vali Loss: 0.509 Vali Acc: 0.872 Test Loss: 0.509 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5010066032409668
Epoch: 10, Steps: 8 | Train Loss: 0.225 Vali Loss: 0.494 Vali Acc: 0.859 Test Loss: 0.494 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.469740390777588
Epoch: 11, Steps: 8 | Train Loss: 0.173 Vali Loss: 0.482 Vali Acc: 0.866 Test Loss: 0.482 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4713304042816162
Epoch: 12, Steps: 8 | Train Loss: 0.130 Vali Loss: 0.458 Vali Acc: 0.872 Test Loss: 0.458 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.4702427387237549
Epoch: 13, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.457 Vali Acc: 0.878 Test Loss: 0.457 Test Acc: 0.878
Validation loss decreased (-0.874995 --> -0.878120).  Saving model ...
Epoch: 14 cost time: 1.2416012287139893
Epoch: 14, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.459 Vali Acc: 0.875 Test Loss: 0.459 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4699971675872803
Epoch: 15, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.476 Vali Acc: 0.869 Test Loss: 0.476 Test Acc: 0.869
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.356001853942871
Epoch: 16, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.501 Vali Acc: 0.859 Test Loss: 0.501 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.45157790184021
Epoch: 17, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.500 Vali Acc: 0.859 Test Loss: 0.500 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.4258604049682617
Epoch: 18, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.503 Vali Acc: 0.859 Test Loss: 0.503 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.4193134307861328
Epoch: 19, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.507 Vali Acc: 0.859 Test Loss: 0.507 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.346428394317627
Epoch: 20, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.516 Vali Acc: 0.853 Test Loss: 0.516 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.4623138904571533
Epoch: 21, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.526 Vali Acc: 0.850 Test Loss: 0.526 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.3431167602539062
Epoch: 22, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.540 Vali Acc: 0.850 Test Loss: 0.540 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.4153401851654053
Epoch: 23, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.552 Vali Acc: 0.850 Test Loss: 0.552 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.878125
model parameter : 212984
model size : 1.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.9154136180877686
Epoch: 1, Steps: 8 | Train Loss: 2.107 Vali Loss: 1.989 Vali Acc: 0.297 Test Loss: 1.989 Test Acc: 0.297
Validation loss decreased (inf --> -0.296855).  Saving model ...
Epoch: 2 cost time: 1.503091812133789
Epoch: 2, Steps: 8 | Train Loss: 1.872 Vali Loss: 1.718 Vali Acc: 0.541 Test Loss: 1.718 Test Acc: 0.541
Validation loss decreased (-0.296855 --> -0.540608).  Saving model ...
Epoch: 3 cost time: 1.5142111778259277
Epoch: 3, Steps: 8 | Train Loss: 1.568 Vali Loss: 1.397 Vali Acc: 0.675 Test Loss: 1.397 Test Acc: 0.675
Validation loss decreased (-0.540608 --> -0.674986).  Saving model ...
Epoch: 4 cost time: 1.4844131469726562
Epoch: 4, Steps: 8 | Train Loss: 1.193 Vali Loss: 1.122 Vali Acc: 0.744 Test Loss: 1.122 Test Acc: 0.744
Validation loss decreased (-0.674986 --> -0.743739).  Saving model ...
Epoch: 5 cost time: 1.516380786895752
Epoch: 5, Steps: 8 | Train Loss: 0.937 Vali Loss: 0.905 Vali Acc: 0.791 Test Loss: 0.905 Test Acc: 0.791
Validation loss decreased (-0.743739 --> -0.790616).  Saving model ...
Epoch: 6 cost time: 1.4858531951904297
Epoch: 6, Steps: 8 | Train Loss: 0.734 Vali Loss: 0.749 Vali Acc: 0.809 Test Loss: 0.749 Test Acc: 0.809
Validation loss decreased (-0.790616 --> -0.809368).  Saving model ...
Epoch: 7 cost time: 1.6018764972686768
Epoch: 7, Steps: 8 | Train Loss: 0.547 Vali Loss: 0.664 Vali Acc: 0.825 Test Loss: 0.664 Test Acc: 0.825
Validation loss decreased (-0.809368 --> -0.824993).  Saving model ...
Epoch: 8 cost time: 1.5601239204406738
Epoch: 8, Steps: 8 | Train Loss: 0.436 Vali Loss: 0.606 Vali Acc: 0.816 Test Loss: 0.606 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5742359161376953
Epoch: 9, Steps: 8 | Train Loss: 0.336 Vali Loss: 0.555 Vali Acc: 0.828 Test Loss: 0.555 Test Acc: 0.828
Validation loss decreased (-0.824993 --> -0.828119).  Saving model ...
Epoch: 10 cost time: 1.5820775032043457
Epoch: 10, Steps: 8 | Train Loss: 0.292 Vali Loss: 0.537 Vali Acc: 0.831 Test Loss: 0.537 Test Acc: 0.831
Validation loss decreased (-0.828119 --> -0.831245).  Saving model ...
Epoch: 11 cost time: 1.5926597118377686
Epoch: 11, Steps: 8 | Train Loss: 0.221 Vali Loss: 0.529 Vali Acc: 0.841 Test Loss: 0.529 Test Acc: 0.841
Validation loss decreased (-0.831245 --> -0.840620).  Saving model ...
Epoch: 12 cost time: 1.6138858795166016
Epoch: 12, Steps: 8 | Train Loss: 0.170 Vali Loss: 0.496 Vali Acc: 0.850 Test Loss: 0.496 Test Acc: 0.850
Validation loss decreased (-0.840620 --> -0.849995).  Saving model ...
Epoch: 13 cost time: 1.551884412765503
Epoch: 13, Steps: 8 | Train Loss: 0.137 Vali Loss: 0.476 Vali Acc: 0.866 Test Loss: 0.476 Test Acc: 0.866
Validation loss decreased (-0.849995 --> -0.865620).  Saving model ...
Epoch: 14 cost time: 1.5456714630126953
Epoch: 14, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.481 Vali Acc: 0.863 Test Loss: 0.481 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6719744205474854
Epoch: 15, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.482 Vali Acc: 0.856 Test Loss: 0.482 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5574641227722168
Epoch: 16, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.492 Vali Acc: 0.850 Test Loss: 0.492 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.574568748474121
Epoch: 17, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.495 Vali Acc: 0.853 Test Loss: 0.495 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.5791618824005127
Epoch: 18, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.499 Vali Acc: 0.856 Test Loss: 0.499 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.5876119136810303
Epoch: 19, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.488 Vali Acc: 0.859 Test Loss: 0.488 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.6125550270080566
Epoch: 20, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.492 Vali Acc: 0.856 Test Loss: 0.492 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.6101701259613037
Epoch: 21, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.508 Vali Acc: 0.853 Test Loss: 0.508 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.5633149147033691
Epoch: 22, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.521 Vali Acc: 0.850 Test Loss: 0.521 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.6044111251831055
Epoch: 23, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.499 Vali Acc: 0.856 Test Loss: 0.499 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 626872
model size : 2.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.6805763244628906
Epoch: 1, Steps: 8 | Train Loss: 2.088 Vali Loss: 1.980 Vali Acc: 0.297 Test Loss: 1.980 Test Acc: 0.297
Validation loss decreased (inf --> -0.296855).  Saving model ...
Epoch: 2 cost time: 1.1808884143829346
Epoch: 2, Steps: 8 | Train Loss: 1.898 Vali Loss: 1.714 Vali Acc: 0.503 Test Loss: 1.714 Test Acc: 0.503
Validation loss decreased (-0.296855 --> -0.503108).  Saving model ...
Epoch: 3 cost time: 1.2047929763793945
Epoch: 3, Steps: 8 | Train Loss: 1.633 Vali Loss: 1.396 Vali Acc: 0.719 Test Loss: 1.396 Test Acc: 0.719
Validation loss decreased (-0.503108 --> -0.718736).  Saving model ...
Epoch: 4 cost time: 1.169630765914917
Epoch: 4, Steps: 8 | Train Loss: 1.289 Vali Loss: 1.109 Vali Acc: 0.800 Test Loss: 1.109 Test Acc: 0.800
Validation loss decreased (-0.718736 --> -0.799989).  Saving model ...
Epoch: 5 cost time: 1.1729185581207275
Epoch: 5, Steps: 8 | Train Loss: 0.965 Vali Loss: 0.877 Vali Acc: 0.822 Test Loss: 0.877 Test Acc: 0.822
Validation loss decreased (-0.799989 --> -0.821866).  Saving model ...
Epoch: 6 cost time: 1.155130386352539
Epoch: 6, Steps: 8 | Train Loss: 0.737 Vali Loss: 0.722 Vali Acc: 0.825 Test Loss: 0.722 Test Acc: 0.825
Validation loss decreased (-0.821866 --> -0.824993).  Saving model ...
Epoch: 7 cost time: 1.1404392719268799
Epoch: 7, Steps: 8 | Train Loss: 0.543 Vali Loss: 0.619 Vali Acc: 0.841 Test Loss: 0.619 Test Acc: 0.841
Validation loss decreased (-0.824993 --> -0.840619).  Saving model ...
Epoch: 8 cost time: 1.1405653953552246
Epoch: 8, Steps: 8 | Train Loss: 0.431 Vali Loss: 0.559 Vali Acc: 0.859 Test Loss: 0.559 Test Acc: 0.859
Validation loss decreased (-0.840619 --> -0.859369).  Saving model ...
Epoch: 9 cost time: 1.113135814666748
Epoch: 9, Steps: 8 | Train Loss: 0.321 Vali Loss: 0.529 Vali Acc: 0.853 Test Loss: 0.529 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1687870025634766
Epoch: 10, Steps: 8 | Train Loss: 0.253 Vali Loss: 0.520 Vali Acc: 0.844 Test Loss: 0.520 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1030356884002686
Epoch: 11, Steps: 8 | Train Loss: 0.201 Vali Loss: 0.510 Vali Acc: 0.850 Test Loss: 0.510 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0989837646484375
Epoch: 12, Steps: 8 | Train Loss: 0.156 Vali Loss: 0.488 Vali Acc: 0.859 Test Loss: 0.488 Test Acc: 0.859
Validation loss decreased (-0.859369 --> -0.859370).  Saving model ...
Epoch: 13 cost time: 1.1142361164093018
Epoch: 13, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.490 Vali Acc: 0.863 Test Loss: 0.490 Test Acc: 0.863
Validation loss decreased (-0.859370 --> -0.862495).  Saving model ...
Epoch: 14 cost time: 1.0384972095489502
Epoch: 14, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.494 Vali Acc: 0.856 Test Loss: 0.494 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1309959888458252
Epoch: 15, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.516 Vali Acc: 0.850 Test Loss: 0.516 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.150162696838379
Epoch: 16, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.538 Vali Acc: 0.841 Test Loss: 0.538 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.1050360202789307
Epoch: 17, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.535 Vali Acc: 0.838 Test Loss: 0.535 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1023058891296387
Epoch: 18, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.536 Vali Acc: 0.841 Test Loss: 0.536 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.1320111751556396
Epoch: 19, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.541 Vali Acc: 0.847 Test Loss: 0.541 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.1393356323242188
Epoch: 20, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.550 Vali Acc: 0.841 Test Loss: 0.550 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.1341190338134766
Epoch: 21, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.560 Vali Acc: 0.838 Test Loss: 0.560 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.9818365573883057
Epoch: 22, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.573 Vali Acc: 0.834 Test Loss: 0.573 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.1791050434112549
Epoch: 23, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.584 Vali Acc: 0.834 Test Loss: 0.584 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 212984
model size : 1.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.6747994422912598
Epoch: 1, Steps: 8 | Train Loss: 2.091 Vali Loss: 1.972 Vali Acc: 0.319 Test Loss: 1.972 Test Acc: 0.319
Validation loss decreased (inf --> -0.318730).  Saving model ...
Epoch: 2 cost time: 2.148597240447998
Epoch: 2, Steps: 8 | Train Loss: 1.850 Vali Loss: 1.685 Vali Acc: 0.541 Test Loss: 1.685 Test Acc: 0.541
Validation loss decreased (-0.318730 --> -0.540608).  Saving model ...
Epoch: 3 cost time: 2.2445502281188965
Epoch: 3, Steps: 8 | Train Loss: 1.503 Vali Loss: 1.348 Vali Acc: 0.728 Test Loss: 1.348 Test Acc: 0.728
Validation loss decreased (-0.540608 --> -0.728112).  Saving model ...
Epoch: 4 cost time: 2.348630666732788
Epoch: 4, Steps: 8 | Train Loss: 1.151 Vali Loss: 1.049 Vali Acc: 0.800 Test Loss: 1.049 Test Acc: 0.800
Validation loss decreased (-0.728112 --> -0.799990).  Saving model ...
Epoch: 5 cost time: 2.243910312652588
Epoch: 5, Steps: 8 | Train Loss: 0.887 Vali Loss: 0.828 Vali Acc: 0.797 Test Loss: 0.828 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.17872953414917
Epoch: 6, Steps: 8 | Train Loss: 0.654 Vali Loss: 0.683 Vali Acc: 0.822 Test Loss: 0.683 Test Acc: 0.822
Validation loss decreased (-0.799990 --> -0.821868).  Saving model ...
Epoch: 7 cost time: 2.1972954273223877
Epoch: 7, Steps: 8 | Train Loss: 0.489 Vali Loss: 0.595 Vali Acc: 0.828 Test Loss: 0.595 Test Acc: 0.828
Validation loss decreased (-0.821868 --> -0.828119).  Saving model ...
Epoch: 8 cost time: 2.287060499191284
Epoch: 8, Steps: 8 | Train Loss: 0.384 Vali Loss: 0.550 Vali Acc: 0.828 Test Loss: 0.550 Test Acc: 0.828
Validation loss decreased (-0.828119 --> -0.828120).  Saving model ...
Epoch: 9 cost time: 2.2514190673828125
Epoch: 9, Steps: 8 | Train Loss: 0.302 Vali Loss: 0.520 Vali Acc: 0.841 Test Loss: 0.520 Test Acc: 0.841
Validation loss decreased (-0.828120 --> -0.840620).  Saving model ...
Epoch: 10 cost time: 2.155303478240967
Epoch: 10, Steps: 8 | Train Loss: 0.250 Vali Loss: 0.511 Vali Acc: 0.844 Test Loss: 0.511 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 11 cost time: 2.1878793239593506
Epoch: 11, Steps: 8 | Train Loss: 0.178 Vali Loss: 0.490 Vali Acc: 0.847 Test Loss: 0.490 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 12 cost time: 2.301515817642212
Epoch: 12, Steps: 8 | Train Loss: 0.143 Vali Loss: 0.496 Vali Acc: 0.856 Test Loss: 0.496 Test Acc: 0.856
Validation loss decreased (-0.846870 --> -0.856245).  Saving model ...
Epoch: 13 cost time: 2.238091468811035
Epoch: 13, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.496 Vali Acc: 0.856 Test Loss: 0.496 Test Acc: 0.856
Validation loss decreased (-0.856245 --> -0.856245).  Saving model ...
Epoch: 14 cost time: 2.157135009765625
Epoch: 14, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.496 Vali Acc: 0.872 Test Loss: 0.496 Test Acc: 0.872
Validation loss decreased (-0.856245 --> -0.871870).  Saving model ...
Epoch: 15 cost time: 2.1483263969421387
Epoch: 15, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.483 Vali Acc: 0.866 Test Loss: 0.483 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.109771728515625
Epoch: 16, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.481 Vali Acc: 0.859 Test Loss: 0.481 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.189387798309326
Epoch: 17, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.488 Vali Acc: 0.866 Test Loss: 0.488 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.097731113433838
Epoch: 18, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.493 Vali Acc: 0.866 Test Loss: 0.493 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.0755350589752197
Epoch: 19, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.498 Vali Acc: 0.847 Test Loss: 0.498 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.3092024326324463
Epoch: 20, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.511 Vali Acc: 0.847 Test Loss: 0.511 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.154787540435791
Epoch: 21, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.512 Vali Acc: 0.841 Test Loss: 0.512 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.1486549377441406
Epoch: 22, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.513 Vali Acc: 0.853 Test Loss: 0.513 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.080662250518799
Epoch: 23, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.519 Vali Acc: 0.853 Test Loss: 0.519 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.06600022315979
Epoch: 24, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.522 Vali Acc: 0.847 Test Loss: 0.522 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 333816
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.0024499893188477
Epoch: 1, Steps: 8 | Train Loss: 2.017 Vali Loss: 1.896 Vali Acc: 0.378 Test Loss: 1.896 Test Acc: 0.378
Validation loss decreased (inf --> -0.378106).  Saving model ...
Epoch: 2 cost time: 1.5373361110687256
Epoch: 2, Steps: 8 | Train Loss: 1.798 Vali Loss: 1.609 Vali Acc: 0.544 Test Loss: 1.609 Test Acc: 0.544
Validation loss decreased (-0.378106 --> -0.543734).  Saving model ...
Epoch: 3 cost time: 1.5014455318450928
Epoch: 3, Steps: 8 | Train Loss: 1.489 Vali Loss: 1.270 Vali Acc: 0.778 Test Loss: 1.270 Test Acc: 0.778
Validation loss decreased (-0.543734 --> -0.778112).  Saving model ...
Epoch: 4 cost time: 1.4592857360839844
Epoch: 4, Steps: 8 | Train Loss: 1.098 Vali Loss: 1.001 Vali Acc: 0.791 Test Loss: 1.001 Test Acc: 0.791
Validation loss decreased (-0.778112 --> -0.790615).  Saving model ...
Epoch: 5 cost time: 1.5092041492462158
Epoch: 5, Steps: 8 | Train Loss: 0.834 Vali Loss: 0.794 Vali Acc: 0.816 Test Loss: 0.794 Test Acc: 0.816
Validation loss decreased (-0.790615 --> -0.815617).  Saving model ...
Epoch: 6 cost time: 1.4796514511108398
Epoch: 6, Steps: 8 | Train Loss: 0.665 Vali Loss: 0.657 Vali Acc: 0.822 Test Loss: 0.657 Test Acc: 0.822
Validation loss decreased (-0.815617 --> -0.821868).  Saving model ...
Epoch: 7 cost time: 1.4549236297607422
Epoch: 7, Steps: 8 | Train Loss: 0.502 Vali Loss: 0.582 Vali Acc: 0.816 Test Loss: 0.582 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.456977367401123
Epoch: 8, Steps: 8 | Train Loss: 0.393 Vali Loss: 0.533 Vali Acc: 0.828 Test Loss: 0.533 Test Acc: 0.828
Validation loss decreased (-0.821868 --> -0.828120).  Saving model ...
Epoch: 9 cost time: 1.499774694442749
Epoch: 9, Steps: 8 | Train Loss: 0.344 Vali Loss: 0.495 Vali Acc: 0.844 Test Loss: 0.495 Test Acc: 0.844
Validation loss decreased (-0.828120 --> -0.843745).  Saving model ...
Epoch: 10 cost time: 1.4844400882720947
Epoch: 10, Steps: 8 | Train Loss: 0.255 Vali Loss: 0.483 Vali Acc: 0.850 Test Loss: 0.483 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849995).  Saving model ...
Epoch: 11 cost time: 1.429896354675293
Epoch: 11, Steps: 8 | Train Loss: 0.197 Vali Loss: 0.487 Vali Acc: 0.834 Test Loss: 0.487 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4916069507598877
Epoch: 12, Steps: 8 | Train Loss: 0.168 Vali Loss: 0.492 Vali Acc: 0.838 Test Loss: 0.492 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4909038543701172
Epoch: 13, Steps: 8 | Train Loss: 0.146 Vali Loss: 0.480 Vali Acc: 0.841 Test Loss: 0.480 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.4493424892425537
Epoch: 14, Steps: 8 | Train Loss: 0.096 Vali Loss: 0.480 Vali Acc: 0.847 Test Loss: 0.480 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.4480509757995605
Epoch: 15, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.474 Vali Acc: 0.850 Test Loss: 0.474 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 16 cost time: 1.5227041244506836
Epoch: 16, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.475 Vali Acc: 0.850 Test Loss: 0.475 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4954521656036377
Epoch: 17, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.481 Vali Acc: 0.850 Test Loss: 0.481 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.5457382202148438
Epoch: 18, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.486 Vali Acc: 0.856 Test Loss: 0.486 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.856245).  Saving model ...
Epoch: 19 cost time: 1.4837117195129395
Epoch: 19, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.494 Vali Acc: 0.853 Test Loss: 0.494 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5185010433197021
Epoch: 20, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.500 Vali Acc: 0.853 Test Loss: 0.500 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.4765739440917969
Epoch: 21, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.502 Vali Acc: 0.856 Test Loss: 0.502 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.4059867858886719
Epoch: 22, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.508 Vali Acc: 0.853 Test Loss: 0.508 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.598759412765503
Epoch: 23, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.513 Vali Acc: 0.853 Test Loss: 0.513 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.4435129165649414
Epoch: 24, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.516 Vali Acc: 0.853 Test Loss: 0.516 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.5137910842895508
Epoch: 25, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.530 Vali Acc: 0.850 Test Loss: 0.530 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.4554789066314697
Epoch: 26, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.534 Vali Acc: 0.850 Test Loss: 0.534 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.4607863426208496
Epoch: 27, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.535 Vali Acc: 0.850 Test Loss: 0.535 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.4250624179840088
Epoch: 28, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.545 Vali Acc: 0.850 Test Loss: 0.545 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 126840
model size : 0.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.2914390563964844
Epoch: 1, Steps: 8 | Train Loss: 2.094 Vali Loss: 1.973 Vali Acc: 0.312 Test Loss: 1.973 Test Acc: 0.312
Validation loss decreased (inf --> -0.312480).  Saving model ...
Epoch: 2 cost time: 1.8300025463104248
Epoch: 2, Steps: 8 | Train Loss: 1.854 Vali Loss: 1.689 Vali Acc: 0.537 Test Loss: 1.689 Test Acc: 0.537
Validation loss decreased (-0.312480 --> -0.537483).  Saving model ...
Epoch: 3 cost time: 1.9265797138214111
Epoch: 3, Steps: 8 | Train Loss: 1.508 Vali Loss: 1.355 Vali Acc: 0.722 Test Loss: 1.355 Test Acc: 0.722
Validation loss decreased (-0.537483 --> -0.721861).  Saving model ...
Epoch: 4 cost time: 1.8089354038238525
Epoch: 4, Steps: 8 | Train Loss: 1.157 Vali Loss: 1.059 Vali Acc: 0.800 Test Loss: 1.059 Test Acc: 0.800
Validation loss decreased (-0.721861 --> -0.799989).  Saving model ...
Epoch: 5 cost time: 1.7874102592468262
Epoch: 5, Steps: 8 | Train Loss: 0.894 Vali Loss: 0.840 Vali Acc: 0.794 Test Loss: 0.840 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8455514907836914
Epoch: 6, Steps: 8 | Train Loss: 0.661 Vali Loss: 0.696 Vali Acc: 0.819 Test Loss: 0.696 Test Acc: 0.819
Validation loss decreased (-0.799989 --> -0.818743).  Saving model ...
Epoch: 7 cost time: 1.8774054050445557
Epoch: 7, Steps: 8 | Train Loss: 0.494 Vali Loss: 0.608 Vali Acc: 0.825 Test Loss: 0.608 Test Acc: 0.825
Validation loss decreased (-0.818743 --> -0.824994).  Saving model ...
Epoch: 8 cost time: 1.8681762218475342
Epoch: 8, Steps: 8 | Train Loss: 0.387 Vali Loss: 0.562 Vali Acc: 0.828 Test Loss: 0.562 Test Acc: 0.828
Validation loss decreased (-0.824994 --> -0.828119).  Saving model ...
Epoch: 9 cost time: 1.8581469058990479
Epoch: 9, Steps: 8 | Train Loss: 0.304 Vali Loss: 0.532 Vali Acc: 0.838 Test Loss: 0.532 Test Acc: 0.838
Validation loss decreased (-0.828119 --> -0.837495).  Saving model ...
Epoch: 10 cost time: 1.7310748100280762
Epoch: 10, Steps: 8 | Train Loss: 0.252 Vali Loss: 0.522 Vali Acc: 0.844 Test Loss: 0.522 Test Acc: 0.844
Validation loss decreased (-0.837495 --> -0.843745).  Saving model ...
Epoch: 11 cost time: 1.7832732200622559
Epoch: 11, Steps: 8 | Train Loss: 0.180 Vali Loss: 0.500 Vali Acc: 0.847 Test Loss: 0.500 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 12 cost time: 1.8628509044647217
Epoch: 12, Steps: 8 | Train Loss: 0.144 Vali Loss: 0.506 Vali Acc: 0.844 Test Loss: 0.506 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4137365818023682
Epoch: 13, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.507 Vali Acc: 0.850 Test Loss: 0.507 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 14 cost time: 1.4403893947601318
Epoch: 14, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.507 Vali Acc: 0.863 Test Loss: 0.507 Test Acc: 0.863
Validation loss decreased (-0.849995 --> -0.862495).  Saving model ...
Epoch: 15 cost time: 1.8559434413909912
Epoch: 15, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.494 Vali Acc: 0.853 Test Loss: 0.494 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9503538608551025
Epoch: 16, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.494 Vali Acc: 0.853 Test Loss: 0.494 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7941358089447021
Epoch: 17, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.502 Vali Acc: 0.859 Test Loss: 0.502 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.7822861671447754
Epoch: 18, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.508 Vali Acc: 0.856 Test Loss: 0.508 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.7972955703735352
Epoch: 19, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.511 Vali Acc: 0.841 Test Loss: 0.511 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.7814371585845947
Epoch: 20, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.524 Vali Acc: 0.841 Test Loss: 0.524 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.7988438606262207
Epoch: 21, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.527 Vali Acc: 0.841 Test Loss: 0.527 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.6745028495788574
Epoch: 22, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.527 Vali Acc: 0.847 Test Loss: 0.527 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.7445664405822754
Epoch: 23, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.534 Vali Acc: 0.841 Test Loss: 0.534 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.6455020904541016
Epoch: 24, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.538 Vali Acc: 0.841 Test Loss: 0.538 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 333816
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.823821783065796
Epoch: 1, Steps: 8 | Train Loss: 2.014 Vali Loss: 1.895 Vali Acc: 0.381 Test Loss: 1.895 Test Acc: 0.381
Validation loss decreased (inf --> -0.381231).  Saving model ...
Epoch: 2 cost time: 1.172694206237793
Epoch: 2, Steps: 8 | Train Loss: 1.796 Vali Loss: 1.610 Vali Acc: 0.537 Test Loss: 1.610 Test Acc: 0.537
Validation loss decreased (-0.381231 --> -0.537484).  Saving model ...
Epoch: 3 cost time: 1.250037670135498
Epoch: 3, Steps: 8 | Train Loss: 1.488 Vali Loss: 1.274 Vali Acc: 0.772 Test Loss: 1.274 Test Acc: 0.772
Validation loss decreased (-0.537484 --> -0.771862).  Saving model ...
Epoch: 4 cost time: 1.281914472579956
Epoch: 4, Steps: 8 | Train Loss: 1.100 Vali Loss: 1.007 Vali Acc: 0.787 Test Loss: 1.007 Test Acc: 0.787
Validation loss decreased (-0.771862 --> -0.787490).  Saving model ...
Epoch: 5 cost time: 1.313793659210205
Epoch: 5, Steps: 8 | Train Loss: 0.837 Vali Loss: 0.801 Vali Acc: 0.816 Test Loss: 0.801 Test Acc: 0.816
Validation loss decreased (-0.787490 --> -0.815617).  Saving model ...
Epoch: 6 cost time: 1.2674376964569092
Epoch: 6, Steps: 8 | Train Loss: 0.669 Vali Loss: 0.663 Vali Acc: 0.822 Test Loss: 0.663 Test Acc: 0.822
Validation loss decreased (-0.815617 --> -0.821868).  Saving model ...
Epoch: 7 cost time: 1.321794033050537
Epoch: 7, Steps: 8 | Train Loss: 0.506 Vali Loss: 0.587 Vali Acc: 0.816 Test Loss: 0.587 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3370332717895508
Epoch: 8, Steps: 8 | Train Loss: 0.396 Vali Loss: 0.537 Vali Acc: 0.828 Test Loss: 0.537 Test Acc: 0.828
Validation loss decreased (-0.821868 --> -0.828120).  Saving model ...
Epoch: 9 cost time: 1.2999796867370605
Epoch: 9, Steps: 8 | Train Loss: 0.344 Vali Loss: 0.498 Vali Acc: 0.844 Test Loss: 0.498 Test Acc: 0.844
Validation loss decreased (-0.828120 --> -0.843745).  Saving model ...
Epoch: 10 cost time: 1.3246893882751465
Epoch: 10, Steps: 8 | Train Loss: 0.255 Vali Loss: 0.486 Vali Acc: 0.853 Test Loss: 0.486 Test Acc: 0.853
Validation loss decreased (-0.843745 --> -0.853120).  Saving model ...
Epoch: 11 cost time: 1.1999859809875488
Epoch: 11, Steps: 8 | Train Loss: 0.196 Vali Loss: 0.489 Vali Acc: 0.834 Test Loss: 0.489 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2020924091339111
Epoch: 12, Steps: 8 | Train Loss: 0.167 Vali Loss: 0.493 Vali Acc: 0.841 Test Loss: 0.493 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.231351613998413
Epoch: 13, Steps: 8 | Train Loss: 0.145 Vali Loss: 0.482 Vali Acc: 0.847 Test Loss: 0.482 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2109038829803467
Epoch: 14, Steps: 8 | Train Loss: 0.096 Vali Loss: 0.481 Vali Acc: 0.847 Test Loss: 0.481 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2303411960601807
Epoch: 15, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.476 Vali Acc: 0.850 Test Loss: 0.476 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.219871997833252
Epoch: 16, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.477 Vali Acc: 0.850 Test Loss: 0.477 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.19337797164917
Epoch: 17, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.483 Vali Acc: 0.853 Test Loss: 0.483 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 18 cost time: 1.2344605922698975
Epoch: 18, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.489 Vali Acc: 0.856 Test Loss: 0.489 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 19 cost time: 1.2300302982330322
Epoch: 19, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.497 Vali Acc: 0.853 Test Loss: 0.497 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2739059925079346
Epoch: 20, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.504 Vali Acc: 0.847 Test Loss: 0.504 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3001081943511963
Epoch: 21, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.506 Vali Acc: 0.856 Test Loss: 0.506 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.3155527114868164
Epoch: 22, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.513 Vali Acc: 0.853 Test Loss: 0.513 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.3147475719451904
Epoch: 23, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.518 Vali Acc: 0.850 Test Loss: 0.518 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.3304908275604248
Epoch: 24, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.521 Vali Acc: 0.853 Test Loss: 0.521 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.3092889785766602
Epoch: 25, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.535 Vali Acc: 0.853 Test Loss: 0.535 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.2985930442810059
Epoch: 26, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.539 Vali Acc: 0.850 Test Loss: 0.539 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.372460126876831
Epoch: 27, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.540 Vali Acc: 0.850 Test Loss: 0.540 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.323838710784912
Epoch: 28, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.550 Vali Acc: 0.853 Test Loss: 0.550 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 126840
model size : 0.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.6985180377960205
Epoch: 1, Steps: 8 | Train Loss: 2.096 Vali Loss: 1.973 Vali Acc: 0.316 Test Loss: 1.973 Test Acc: 0.316
Validation loss decreased (inf --> -0.315605).  Saving model ...
Epoch: 2 cost time: 1.1614046096801758
Epoch: 2, Steps: 8 | Train Loss: 1.856 Vali Loss: 1.691 Vali Acc: 0.534 Test Loss: 1.691 Test Acc: 0.534
Validation loss decreased (-0.315605 --> -0.534358).  Saving model ...
Epoch: 3 cost time: 1.234264850616455
Epoch: 3, Steps: 8 | Train Loss: 1.515 Vali Loss: 1.360 Vali Acc: 0.728 Test Loss: 1.360 Test Acc: 0.728
Validation loss decreased (-0.534358 --> -0.728111).  Saving model ...
Epoch: 4 cost time: 1.2365667819976807
Epoch: 4, Steps: 8 | Train Loss: 1.165 Vali Loss: 1.066 Vali Acc: 0.797 Test Loss: 1.066 Test Acc: 0.797
Validation loss decreased (-0.728111 --> -0.796864).  Saving model ...
Epoch: 5 cost time: 1.234705924987793
Epoch: 5, Steps: 8 | Train Loss: 0.902 Vali Loss: 0.848 Vali Acc: 0.791 Test Loss: 0.848 Test Acc: 0.791
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.128643274307251
Epoch: 6, Steps: 8 | Train Loss: 0.671 Vali Loss: 0.704 Vali Acc: 0.816 Test Loss: 0.704 Test Acc: 0.816
Validation loss decreased (-0.796864 --> -0.815618).  Saving model ...
Epoch: 7 cost time: 1.3758575916290283
Epoch: 7, Steps: 8 | Train Loss: 0.507 Vali Loss: 0.617 Vali Acc: 0.825 Test Loss: 0.617 Test Acc: 0.825
Validation loss decreased (-0.815618 --> -0.824994).  Saving model ...
Epoch: 8 cost time: 1.3832385540008545
Epoch: 8, Steps: 8 | Train Loss: 0.400 Vali Loss: 0.573 Vali Acc: 0.822 Test Loss: 0.573 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3443231582641602
Epoch: 9, Steps: 8 | Train Loss: 0.322 Vali Loss: 0.544 Vali Acc: 0.834 Test Loss: 0.544 Test Acc: 0.834
Validation loss decreased (-0.824994 --> -0.834370).  Saving model ...
Epoch: 10 cost time: 1.196474313735962
Epoch: 10, Steps: 8 | Train Loss: 0.272 Vali Loss: 0.537 Vali Acc: 0.838 Test Loss: 0.537 Test Acc: 0.838
Validation loss decreased (-0.834370 --> -0.837495).  Saving model ...
Epoch: 11 cost time: 1.3386521339416504
Epoch: 11, Steps: 8 | Train Loss: 0.199 Vali Loss: 0.517 Vali Acc: 0.834 Test Loss: 0.517 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3067028522491455
Epoch: 12, Steps: 8 | Train Loss: 0.164 Vali Loss: 0.526 Vali Acc: 0.841 Test Loss: 0.526 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 13 cost time: 1.3443446159362793
Epoch: 13, Steps: 8 | Train Loss: 0.127 Vali Loss: 0.531 Vali Acc: 0.844 Test Loss: 0.531 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 14 cost time: 1.3082082271575928
Epoch: 14, Steps: 8 | Train Loss: 0.117 Vali Loss: 0.534 Vali Acc: 0.844 Test Loss: 0.534 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1824193000793457
Epoch: 15, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.518 Vali Acc: 0.853 Test Loss: 0.518 Test Acc: 0.853
Validation loss decreased (-0.843745 --> -0.853120).  Saving model ...
Epoch: 16 cost time: 1.1907494068145752
Epoch: 16, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.516 Vali Acc: 0.850 Test Loss: 0.516 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2004883289337158
Epoch: 17, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.525 Vali Acc: 0.847 Test Loss: 0.525 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2673828601837158
Epoch: 18, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.533 Vali Acc: 0.850 Test Loss: 0.533 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.226189136505127
Epoch: 19, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.534 Vali Acc: 0.847 Test Loss: 0.534 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.2263422012329102
Epoch: 20, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.546 Vali Acc: 0.850 Test Loss: 0.546 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.1605103015899658
Epoch: 21, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.546 Vali Acc: 0.847 Test Loss: 0.546 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.2837142944335938
Epoch: 22, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.548 Vali Acc: 0.850 Test Loss: 0.548 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.2234530448913574
Epoch: 23, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.557 Vali Acc: 0.850 Test Loss: 0.557 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.3613495826721191
Epoch: 24, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.561 Vali Acc: 0.850 Test Loss: 0.561 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.369194746017456
Epoch: 25, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.562 Vali Acc: 0.850 Test Loss: 0.562 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 333816
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.492474317550659
Epoch: 1, Steps: 8 | Train Loss: 2.012 Vali Loss: 1.896 Vali Acc: 0.375 Test Loss: 1.896 Test Acc: 0.375
Validation loss decreased (inf --> -0.374981).  Saving model ...
Epoch: 2 cost time: 1.010676622390747
Epoch: 2, Steps: 8 | Train Loss: 1.795 Vali Loss: 1.613 Vali Acc: 0.531 Test Loss: 1.613 Test Acc: 0.531
Validation loss decreased (-0.374981 --> -0.531234).  Saving model ...
Epoch: 3 cost time: 0.9880013465881348
Epoch: 3, Steps: 8 | Train Loss: 1.491 Vali Loss: 1.278 Vali Acc: 0.769 Test Loss: 1.278 Test Acc: 0.769
Validation loss decreased (-0.531234 --> -0.768737).  Saving model ...
Epoch: 4 cost time: 1.0288865566253662
Epoch: 4, Steps: 8 | Train Loss: 1.106 Vali Loss: 1.012 Vali Acc: 0.791 Test Loss: 1.012 Test Acc: 0.791
Validation loss decreased (-0.768737 --> -0.790615).  Saving model ...
Epoch: 5 cost time: 1.0255846977233887
Epoch: 5, Steps: 8 | Train Loss: 0.843 Vali Loss: 0.807 Vali Acc: 0.812 Test Loss: 0.807 Test Acc: 0.812
Validation loss decreased (-0.790615 --> -0.812492).  Saving model ...
Epoch: 6 cost time: 0.9779787063598633
Epoch: 6, Steps: 8 | Train Loss: 0.679 Vali Loss: 0.669 Vali Acc: 0.822 Test Loss: 0.669 Test Acc: 0.822
Validation loss decreased (-0.812492 --> -0.821868).  Saving model ...
Epoch: 7 cost time: 0.9770283699035645
Epoch: 7, Steps: 8 | Train Loss: 0.516 Vali Loss: 0.594 Vali Acc: 0.816 Test Loss: 0.594 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9790303707122803
Epoch: 8, Steps: 8 | Train Loss: 0.409 Vali Loss: 0.545 Vali Acc: 0.831 Test Loss: 0.545 Test Acc: 0.831
Validation loss decreased (-0.821868 --> -0.831245).  Saving model ...
Epoch: 9 cost time: 1.0127568244934082
Epoch: 9, Steps: 8 | Train Loss: 0.363 Vali Loss: 0.507 Vali Acc: 0.847 Test Loss: 0.507 Test Acc: 0.847
Validation loss decreased (-0.831245 --> -0.846870).  Saving model ...
Epoch: 10 cost time: 0.9379336833953857
Epoch: 10, Steps: 8 | Train Loss: 0.271 Vali Loss: 0.497 Vali Acc: 0.847 Test Loss: 0.497 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 11 cost time: 0.9964196681976318
Epoch: 11, Steps: 8 | Train Loss: 0.212 Vali Loss: 0.502 Vali Acc: 0.831 Test Loss: 0.502 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9841053485870361
Epoch: 12, Steps: 8 | Train Loss: 0.180 Vali Loss: 0.509 Vali Acc: 0.838 Test Loss: 0.509 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9583785533905029
Epoch: 13, Steps: 8 | Train Loss: 0.160 Vali Loss: 0.498 Vali Acc: 0.838 Test Loss: 0.498 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9452636241912842
Epoch: 14, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.499 Vali Acc: 0.850 Test Loss: 0.499 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 15 cost time: 0.9875771999359131
Epoch: 15, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.497 Vali Acc: 0.847 Test Loss: 0.497 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0043973922729492
Epoch: 16, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.499 Vali Acc: 0.847 Test Loss: 0.499 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0109028816223145
Epoch: 17, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.508 Vali Acc: 0.841 Test Loss: 0.508 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0264837741851807
Epoch: 18, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.515 Vali Acc: 0.844 Test Loss: 0.515 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8668854236602783
Epoch: 19, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.523 Vali Acc: 0.850 Test Loss: 0.523 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.027841567993164
Epoch: 20, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.529 Vali Acc: 0.850 Test Loss: 0.529 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.065293788909912
Epoch: 21, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.530 Vali Acc: 0.850 Test Loss: 0.530 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.0587372779846191
Epoch: 22, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.539 Vali Acc: 0.850 Test Loss: 0.539 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.0436546802520752
Epoch: 23, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.545 Vali Acc: 0.850 Test Loss: 0.545 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.0310125350952148
Epoch: 24, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.550 Vali Acc: 0.850 Test Loss: 0.550 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 126840
model size : 0.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.8331663608551025
Epoch: 1, Steps: 8 | Train Loss: 2.100 Vali Loss: 2.023 Vali Acc: 0.194 Test Loss: 2.023 Test Acc: 0.194
Validation loss decreased (inf --> -0.193730).  Saving model ...
Epoch: 2 cost time: 3.287022352218628
Epoch: 2, Steps: 8 | Train Loss: 2.015 Vali Loss: 1.855 Vali Acc: 0.412 Test Loss: 1.855 Test Acc: 0.412
Validation loss decreased (-0.193730 --> -0.412481).  Saving model ...
Epoch: 3 cost time: 3.3650712966918945
Epoch: 3, Steps: 8 | Train Loss: 1.772 Vali Loss: 1.635 Vali Acc: 0.628 Test Loss: 1.635 Test Acc: 0.628
Validation loss decreased (-0.412481 --> -0.628109).  Saving model ...
Epoch: 4 cost time: 3.3465464115142822
Epoch: 4, Steps: 8 | Train Loss: 1.505 Vali Loss: 1.394 Vali Acc: 0.781 Test Loss: 1.394 Test Acc: 0.781
Validation loss decreased (-0.628109 --> -0.781236).  Saving model ...
Epoch: 5 cost time: 3.3496947288513184
Epoch: 5, Steps: 8 | Train Loss: 1.264 Vali Loss: 1.173 Vali Acc: 0.784 Test Loss: 1.173 Test Acc: 0.784
Validation loss decreased (-0.781236 --> -0.784363).  Saving model ...
Epoch: 6 cost time: 3.611215114593506
Epoch: 6, Steps: 8 | Train Loss: 1.034 Vali Loss: 0.984 Vali Acc: 0.791 Test Loss: 0.984 Test Acc: 0.791
Validation loss decreased (-0.784363 --> -0.790615).  Saving model ...
Epoch: 7 cost time: 3.5595571994781494
Epoch: 7, Steps: 8 | Train Loss: 0.824 Vali Loss: 0.832 Vali Acc: 0.797 Test Loss: 0.832 Test Acc: 0.797
Validation loss decreased (-0.790615 --> -0.796867).  Saving model ...
Epoch: 8 cost time: 3.539984941482544
Epoch: 8, Steps: 8 | Train Loss: 0.655 Vali Loss: 0.709 Vali Acc: 0.819 Test Loss: 0.709 Test Acc: 0.819
Validation loss decreased (-0.796867 --> -0.818743).  Saving model ...
Epoch: 9 cost time: 3.553755521774292
Epoch: 9, Steps: 8 | Train Loss: 0.523 Vali Loss: 0.611 Vali Acc: 0.828 Test Loss: 0.611 Test Acc: 0.828
Validation loss decreased (-0.818743 --> -0.828119).  Saving model ...
Epoch: 10 cost time: 3.5071115493774414
Epoch: 10, Steps: 8 | Train Loss: 0.406 Vali Loss: 0.549 Vali Acc: 0.841 Test Loss: 0.549 Test Acc: 0.841
Validation loss decreased (-0.828119 --> -0.840620).  Saving model ...
Epoch: 11 cost time: 3.220771312713623
Epoch: 11, Steps: 8 | Train Loss: 0.324 Vali Loss: 0.512 Vali Acc: 0.850 Test Loss: 0.512 Test Acc: 0.850
Validation loss decreased (-0.840620 --> -0.849995).  Saving model ...
Epoch: 12 cost time: 3.252140998840332
Epoch: 12, Steps: 8 | Train Loss: 0.264 Vali Loss: 0.492 Vali Acc: 0.844 Test Loss: 0.492 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.240929365158081
Epoch: 13, Steps: 8 | Train Loss: 0.218 Vali Loss: 0.475 Vali Acc: 0.856 Test Loss: 0.475 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.856245).  Saving model ...
Epoch: 14 cost time: 3.2814834117889404
Epoch: 14, Steps: 8 | Train Loss: 0.181 Vali Loss: 0.460 Vali Acc: 0.859 Test Loss: 0.460 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 15 cost time: 3.396404981613159
Epoch: 15, Steps: 8 | Train Loss: 0.150 Vali Loss: 0.451 Vali Acc: 0.869 Test Loss: 0.451 Test Acc: 0.869
Validation loss decreased (-0.859370 --> -0.868745).  Saving model ...
Epoch: 16 cost time: 3.3616175651550293
Epoch: 16, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.446 Vali Acc: 0.869 Test Loss: 0.446 Test Acc: 0.869
Validation loss decreased (-0.868745 --> -0.868746).  Saving model ...
Epoch: 17 cost time: 3.563052177429199
Epoch: 17, Steps: 8 | Train Loss: 0.121 Vali Loss: 0.445 Vali Acc: 0.863 Test Loss: 0.445 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.607588052749634
Epoch: 18, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.445 Vali Acc: 0.866 Test Loss: 0.445 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.6295547485351562
Epoch: 19, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.443 Vali Acc: 0.866 Test Loss: 0.443 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.6036813259124756
Epoch: 20, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.448 Vali Acc: 0.866 Test Loss: 0.448 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.653691053390503
Epoch: 21, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.455 Vali Acc: 0.866 Test Loss: 0.455 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.4111058712005615
Epoch: 22, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.454 Vali Acc: 0.866 Test Loss: 0.454 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.3517117500305176
Epoch: 23, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.459 Vali Acc: 0.866 Test Loss: 0.459 Test Acc: 0.866
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.336270332336426
Epoch: 24, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.456 Vali Acc: 0.863 Test Loss: 0.456 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.2955639362335205
Epoch: 25, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.457 Vali Acc: 0.869 Test Loss: 0.457 Test Acc: 0.869
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.4068851470947266
Epoch: 26, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.465 Vali Acc: 0.869 Test Loss: 0.465 Test Acc: 0.869
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 606880
model size : 2.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.131678819656372
Epoch: 1, Steps: 8 | Train Loss: 2.112 Vali Loss: 2.068 Vali Acc: 0.156 Test Loss: 2.068 Test Acc: 0.156
Validation loss decreased (inf --> -0.156229).  Saving model ...
Epoch: 2 cost time: 2.4964871406555176
Epoch: 2, Steps: 8 | Train Loss: 1.974 Vali Loss: 1.930 Vali Acc: 0.263 Test Loss: 1.930 Test Acc: 0.263
Validation loss decreased (-0.156229 --> -0.262481).  Saving model ...
Epoch: 3 cost time: 2.509799003601074
Epoch: 3, Steps: 8 | Train Loss: 1.797 Vali Loss: 1.741 Vali Acc: 0.463 Test Loss: 1.741 Test Acc: 0.463
Validation loss decreased (-0.262481 --> -0.462483).  Saving model ...
Epoch: 4 cost time: 2.495516300201416
Epoch: 4, Steps: 8 | Train Loss: 1.588 Vali Loss: 1.529 Vali Acc: 0.675 Test Loss: 1.529 Test Acc: 0.675
Validation loss decreased (-0.462483 --> -0.674985).  Saving model ...
Epoch: 5 cost time: 2.470273733139038
Epoch: 5, Steps: 8 | Train Loss: 1.371 Vali Loss: 1.321 Vali Acc: 0.762 Test Loss: 1.321 Test Acc: 0.762
Validation loss decreased (-0.674985 --> -0.762487).  Saving model ...
Epoch: 6 cost time: 2.477257013320923
Epoch: 6, Steps: 8 | Train Loss: 1.140 Vali Loss: 1.129 Vali Acc: 0.775 Test Loss: 1.129 Test Acc: 0.775
Validation loss decreased (-0.762487 --> -0.774989).  Saving model ...
Epoch: 7 cost time: 2.2691166400909424
Epoch: 7, Steps: 8 | Train Loss: 0.984 Vali Loss: 0.958 Vali Acc: 0.787 Test Loss: 0.958 Test Acc: 0.787
Validation loss decreased (-0.774989 --> -0.787490).  Saving model ...
Epoch: 8 cost time: 2.2582895755767822
Epoch: 8, Steps: 8 | Train Loss: 0.808 Vali Loss: 0.812 Vali Acc: 0.819 Test Loss: 0.812 Test Acc: 0.819
Validation loss decreased (-0.787490 --> -0.818742).  Saving model ...
Epoch: 9 cost time: 2.2638261318206787
Epoch: 9, Steps: 8 | Train Loss: 0.669 Vali Loss: 0.702 Vali Acc: 0.825 Test Loss: 0.702 Test Acc: 0.825
Validation loss decreased (-0.818742 --> -0.824993).  Saving model ...
Epoch: 10 cost time: 2.3195126056671143
Epoch: 10, Steps: 8 | Train Loss: 0.520 Vali Loss: 0.623 Vali Acc: 0.834 Test Loss: 0.623 Test Acc: 0.834
Validation loss decreased (-0.824993 --> -0.834369).  Saving model ...
Epoch: 11 cost time: 2.3100457191467285
Epoch: 11, Steps: 8 | Train Loss: 0.437 Vali Loss: 0.565 Vali Acc: 0.841 Test Loss: 0.565 Test Acc: 0.841
Validation loss decreased (-0.834369 --> -0.840619).  Saving model ...
Epoch: 12 cost time: 2.3377420902252197
Epoch: 12, Steps: 8 | Train Loss: 0.339 Vali Loss: 0.519 Vali Acc: 0.847 Test Loss: 0.519 Test Acc: 0.847
Validation loss decreased (-0.840619 --> -0.846870).  Saving model ...
Epoch: 13 cost time: 2.3475985527038574
Epoch: 13, Steps: 8 | Train Loss: 0.288 Vali Loss: 0.494 Vali Acc: 0.844 Test Loss: 0.494 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.2223830223083496
Epoch: 14, Steps: 8 | Train Loss: 0.232 Vali Loss: 0.481 Vali Acc: 0.844 Test Loss: 0.481 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.483461618423462
Epoch: 15, Steps: 8 | Train Loss: 0.207 Vali Loss: 0.472 Vali Acc: 0.850 Test Loss: 0.472 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 16 cost time: 2.4410629272460938
Epoch: 16, Steps: 8 | Train Loss: 0.187 Vali Loss: 0.458 Vali Acc: 0.859 Test Loss: 0.458 Test Acc: 0.859
Validation loss decreased (-0.849995 --> -0.859370).  Saving model ...
Epoch: 17 cost time: 2.413179397583008
Epoch: 17, Steps: 8 | Train Loss: 0.177 Vali Loss: 0.452 Vali Acc: 0.856 Test Loss: 0.452 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.469683885574341
Epoch: 18, Steps: 8 | Train Loss: 0.143 Vali Loss: 0.460 Vali Acc: 0.853 Test Loss: 0.460 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.435685157775879
Epoch: 19, Steps: 8 | Train Loss: 0.124 Vali Loss: 0.453 Vali Acc: 0.853 Test Loss: 0.453 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.4093925952911377
Epoch: 20, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.449 Vali Acc: 0.863 Test Loss: 0.449 Test Acc: 0.863
Validation loss decreased (-0.859370 --> -0.862496).  Saving model ...
Epoch: 21 cost time: 2.423671007156372
Epoch: 21, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.447 Vali Acc: 0.863 Test Loss: 0.447 Test Acc: 0.863
Validation loss decreased (-0.862496 --> -0.862496).  Saving model ...
Epoch: 22 cost time: 2.264221429824829
Epoch: 22, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.448 Vali Acc: 0.859 Test Loss: 0.448 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.2647194862365723
Epoch: 23, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.459 Vali Acc: 0.856 Test Loss: 0.459 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.2965238094329834
Epoch: 24, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.462 Vali Acc: 0.856 Test Loss: 0.462 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.312356472015381
Epoch: 25, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.461 Vali Acc: 0.856 Test Loss: 0.461 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.3634114265441895
Epoch: 26, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.456 Vali Acc: 0.859 Test Loss: 0.456 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.3631370067596436
Epoch: 27, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.455 Vali Acc: 0.866 Test Loss: 0.455 Test Acc: 0.866
Validation loss decreased (-0.862496 --> -0.865620).  Saving model ...
Epoch: 28 cost time: 2.3352487087249756
Epoch: 28, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.458 Vali Acc: 0.869 Test Loss: 0.458 Test Acc: 0.869
Validation loss decreased (-0.865620 --> -0.868745).  Saving model ...
Epoch: 29 cost time: 2.3542075157165527
Epoch: 29, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.473 Vali Acc: 0.863 Test Loss: 0.473 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.5070266723632812
Epoch: 30, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.481 Vali Acc: 0.859 Test Loss: 0.481 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 192896
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.5964155197143555
Epoch: 1, Steps: 8 | Train Loss: 2.098 Vali Loss: 2.023 Vali Acc: 0.191 Test Loss: 2.023 Test Acc: 0.191
Validation loss decreased (inf --> -0.190605).  Saving model ...
Epoch: 2 cost time: 2.9437594413757324
Epoch: 2, Steps: 8 | Train Loss: 2.015 Vali Loss: 1.857 Vali Acc: 0.403 Test Loss: 1.857 Test Acc: 0.403
Validation loss decreased (-0.190605 --> -0.403106).  Saving model ...
Epoch: 3 cost time: 2.9749863147735596
Epoch: 3, Steps: 8 | Train Loss: 1.774 Vali Loss: 1.640 Vali Acc: 0.622 Test Loss: 1.640 Test Acc: 0.622
Validation loss decreased (-0.403106 --> -0.621859).  Saving model ...
Epoch: 4 cost time: 2.7401745319366455
Epoch: 4, Steps: 8 | Train Loss: 1.509 Vali Loss: 1.401 Vali Acc: 0.778 Test Loss: 1.401 Test Acc: 0.778
Validation loss decreased (-0.621859 --> -0.778111).  Saving model ...
Epoch: 5 cost time: 2.7729005813598633
Epoch: 5, Steps: 8 | Train Loss: 1.269 Vali Loss: 1.183 Vali Acc: 0.781 Test Loss: 1.183 Test Acc: 0.781
Validation loss decreased (-0.778111 --> -0.781238).  Saving model ...
Epoch: 6 cost time: 2.716984987258911
Epoch: 6, Steps: 8 | Train Loss: 1.041 Vali Loss: 0.995 Vali Acc: 0.791 Test Loss: 0.995 Test Acc: 0.791
Validation loss decreased (-0.781238 --> -0.790615).  Saving model ...
Epoch: 7 cost time: 2.699951171875
Epoch: 7, Steps: 8 | Train Loss: 0.830 Vali Loss: 0.844 Vali Acc: 0.800 Test Loss: 0.844 Test Acc: 0.800
Validation loss decreased (-0.790615 --> -0.799992).  Saving model ...
Epoch: 8 cost time: 2.7598342895507812
Epoch: 8, Steps: 8 | Train Loss: 0.663 Vali Loss: 0.722 Vali Acc: 0.816 Test Loss: 0.722 Test Acc: 0.816
Validation loss decreased (-0.799992 --> -0.815618).  Saving model ...
Epoch: 9 cost time: 2.8243534564971924
Epoch: 9, Steps: 8 | Train Loss: 0.528 Vali Loss: 0.630 Vali Acc: 0.831 Test Loss: 0.630 Test Acc: 0.831
Validation loss decreased (-0.815618 --> -0.831244).  Saving model ...
Epoch: 10 cost time: 2.740891695022583
Epoch: 10, Steps: 8 | Train Loss: 0.408 Vali Loss: 0.572 Vali Acc: 0.831 Test Loss: 0.572 Test Acc: 0.831
Validation loss decreased (-0.831244 --> -0.831244).  Saving model ...
Epoch: 11 cost time: 2.9674315452575684
Epoch: 11, Steps: 8 | Train Loss: 0.327 Vali Loss: 0.539 Vali Acc: 0.841 Test Loss: 0.539 Test Acc: 0.841
Validation loss decreased (-0.831244 --> -0.840620).  Saving model ...
Epoch: 12 cost time: 2.958223581314087
Epoch: 12, Steps: 8 | Train Loss: 0.264 Vali Loss: 0.520 Vali Acc: 0.838 Test Loss: 0.520 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.795581102371216
Epoch: 13, Steps: 8 | Train Loss: 0.220 Vali Loss: 0.506 Vali Acc: 0.838 Test Loss: 0.506 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.861586093902588
Epoch: 14, Steps: 8 | Train Loss: 0.181 Vali Loss: 0.491 Vali Acc: 0.850 Test Loss: 0.491 Test Acc: 0.850
Validation loss decreased (-0.840620 --> -0.849995).  Saving model ...
Epoch: 15 cost time: 2.900897979736328
Epoch: 15, Steps: 8 | Train Loss: 0.148 Vali Loss: 0.483 Vali Acc: 0.856 Test Loss: 0.483 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.856245).  Saving model ...
Epoch: 16 cost time: 2.8400137424468994
Epoch: 16, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.477 Vali Acc: 0.863 Test Loss: 0.477 Test Acc: 0.863
Validation loss decreased (-0.856245 --> -0.862495).  Saving model ...
Epoch: 17 cost time: 2.7130661010742188
Epoch: 17, Steps: 8 | Train Loss: 0.121 Vali Loss: 0.477 Vali Acc: 0.859 Test Loss: 0.477 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.6938560009002686
Epoch: 18, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.476 Vali Acc: 0.859 Test Loss: 0.476 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.7437124252319336
Epoch: 19, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.474 Vali Acc: 0.863 Test Loss: 0.474 Test Acc: 0.863
Validation loss decreased (-0.862495 --> -0.862495).  Saving model ...
Epoch: 20 cost time: 2.75235915184021
Epoch: 20, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.484 Vali Acc: 0.859 Test Loss: 0.484 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.674373149871826
Epoch: 21, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.489 Vali Acc: 0.853 Test Loss: 0.489 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.7789225578308105
Epoch: 22, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.490 Vali Acc: 0.853 Test Loss: 0.490 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.0125391483306885
Epoch: 23, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.497 Vali Acc: 0.853 Test Loss: 0.497 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.0311665534973145
Epoch: 24, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.491 Vali Acc: 0.850 Test Loss: 0.491 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.0145604610443115
Epoch: 25, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.492 Vali Acc: 0.853 Test Loss: 0.492 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.8381693363189697
Epoch: 26, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.502 Vali Acc: 0.853 Test Loss: 0.502 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.898575782775879
Epoch: 27, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.511 Vali Acc: 0.850 Test Loss: 0.511 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.9259893894195557
Epoch: 28, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.516 Vali Acc: 0.853 Test Loss: 0.516 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.7240676879882812
Epoch: 29, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.520 Vali Acc: 0.853 Test Loss: 0.520 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 606880
model size : 2.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.355922222137451
Epoch: 1, Steps: 8 | Train Loss: 2.111 Vali Loss: 2.069 Vali Acc: 0.156 Test Loss: 2.069 Test Acc: 0.156
Validation loss decreased (inf --> -0.156229).  Saving model ...
Epoch: 2 cost time: 1.8469080924987793
Epoch: 2, Steps: 8 | Train Loss: 1.972 Vali Loss: 1.933 Vali Acc: 0.256 Test Loss: 1.933 Test Acc: 0.256
Validation loss decreased (-0.156229 --> -0.256231).  Saving model ...
Epoch: 3 cost time: 1.9082164764404297
Epoch: 3, Steps: 8 | Train Loss: 1.799 Vali Loss: 1.745 Vali Acc: 0.463 Test Loss: 1.745 Test Acc: 0.463
Validation loss decreased (-0.256231 --> -0.462483).  Saving model ...
Epoch: 4 cost time: 1.8774075508117676
Epoch: 4, Steps: 8 | Train Loss: 1.592 Vali Loss: 1.535 Vali Acc: 0.666 Test Loss: 1.535 Test Acc: 0.666
Validation loss decreased (-0.462483 --> -0.665610).  Saving model ...
Epoch: 5 cost time: 1.886486530303955
Epoch: 5, Steps: 8 | Train Loss: 1.377 Vali Loss: 1.327 Vali Acc: 0.762 Test Loss: 1.327 Test Acc: 0.762
Validation loss decreased (-0.665610 --> -0.762487).  Saving model ...
Epoch: 6 cost time: 2.058314085006714
Epoch: 6, Steps: 8 | Train Loss: 1.143 Vali Loss: 1.134 Vali Acc: 0.769 Test Loss: 1.134 Test Acc: 0.769
Validation loss decreased (-0.762487 --> -0.768739).  Saving model ...
Epoch: 7 cost time: 2.0047218799591064
Epoch: 7, Steps: 8 | Train Loss: 0.985 Vali Loss: 0.964 Vali Acc: 0.781 Test Loss: 0.964 Test Acc: 0.781
Validation loss decreased (-0.768739 --> -0.781240).  Saving model ...
Epoch: 8 cost time: 1.8433358669281006
Epoch: 8, Steps: 8 | Train Loss: 0.806 Vali Loss: 0.819 Vali Acc: 0.806 Test Loss: 0.819 Test Acc: 0.806
Validation loss decreased (-0.781240 --> -0.806242).  Saving model ...
Epoch: 9 cost time: 1.5294792652130127
Epoch: 9, Steps: 8 | Train Loss: 0.664 Vali Loss: 0.711 Vali Acc: 0.828 Test Loss: 0.711 Test Acc: 0.828
Validation loss decreased (-0.806242 --> -0.828118).  Saving model ...
Epoch: 10 cost time: 1.569307804107666
Epoch: 10, Steps: 8 | Train Loss: 0.519 Vali Loss: 0.633 Vali Acc: 0.834 Test Loss: 0.633 Test Acc: 0.834
Validation loss decreased (-0.828118 --> -0.834369).  Saving model ...
Epoch: 11 cost time: 1.8924756050109863
Epoch: 11, Steps: 8 | Train Loss: 0.431 Vali Loss: 0.575 Vali Acc: 0.841 Test Loss: 0.575 Test Acc: 0.841
Validation loss decreased (-0.834369 --> -0.840619).  Saving model ...
Epoch: 12 cost time: 1.9865221977233887
Epoch: 12, Steps: 8 | Train Loss: 0.334 Vali Loss: 0.530 Vali Acc: 0.847 Test Loss: 0.530 Test Acc: 0.847
Validation loss decreased (-0.840619 --> -0.846870).  Saving model ...
Epoch: 13 cost time: 1.9539811611175537
Epoch: 13, Steps: 8 | Train Loss: 0.282 Vali Loss: 0.506 Vali Acc: 0.844 Test Loss: 0.506 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8729496002197266
Epoch: 14, Steps: 8 | Train Loss: 0.227 Vali Loss: 0.495 Vali Acc: 0.847 Test Loss: 0.495 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 15 cost time: 1.9840631484985352
Epoch: 15, Steps: 8 | Train Loss: 0.203 Vali Loss: 0.485 Vali Acc: 0.856 Test Loss: 0.485 Test Acc: 0.856
Validation loss decreased (-0.846870 --> -0.856245).  Saving model ...
Epoch: 16 cost time: 1.8664956092834473
Epoch: 16, Steps: 8 | Train Loss: 0.182 Vali Loss: 0.470 Vali Acc: 0.866 Test Loss: 0.470 Test Acc: 0.866
Validation loss decreased (-0.856245 --> -0.865620).  Saving model ...
Epoch: 17 cost time: 1.8241946697235107
Epoch: 17, Steps: 8 | Train Loss: 0.173 Vali Loss: 0.465 Vali Acc: 0.859 Test Loss: 0.465 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8427691459655762
Epoch: 18, Steps: 8 | Train Loss: 0.140 Vali Loss: 0.473 Vali Acc: 0.853 Test Loss: 0.473 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.8196370601654053
Epoch: 19, Steps: 8 | Train Loss: 0.120 Vali Loss: 0.465 Vali Acc: 0.856 Test Loss: 0.465 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.8522396087646484
Epoch: 20, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.461 Vali Acc: 0.856 Test Loss: 0.461 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.8821823596954346
Epoch: 21, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.458 Vali Acc: 0.863 Test Loss: 0.458 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.007458448410034
Epoch: 22, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.459 Vali Acc: 0.863 Test Loss: 0.459 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.8835601806640625
Epoch: 23, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.469 Vali Acc: 0.863 Test Loss: 0.469 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.8852849006652832
Epoch: 24, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.471 Vali Acc: 0.866 Test Loss: 0.471 Test Acc: 0.866
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.9186110496520996
Epoch: 25, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.471 Vali Acc: 0.866 Test Loss: 0.471 Test Acc: 0.866
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.8812739849090576
Epoch: 26, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.466 Vali Acc: 0.872 Test Loss: 0.466 Test Acc: 0.872
Validation loss decreased (-0.865620 --> -0.871870).  Saving model ...
Epoch: 27 cost time: 1.8763322830200195
Epoch: 27, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.464 Vali Acc: 0.875 Test Loss: 0.464 Test Acc: 0.875
Validation loss decreased (-0.871870 --> -0.874995).  Saving model ...
Epoch: 28 cost time: 1.910656213760376
Epoch: 28, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.466 Vali Acc: 0.878 Test Loss: 0.466 Test Acc: 0.878
Validation loss decreased (-0.874995 --> -0.878120).  Saving model ...
Epoch: 29 cost time: 1.883807897567749
Epoch: 29, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.480 Vali Acc: 0.872 Test Loss: 0.480 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.7567856311798096
Epoch: 30, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.489 Vali Acc: 0.863 Test Loss: 0.489 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.878125
model parameter : 192896
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.9413444995880127
Epoch: 1, Steps: 8 | Train Loss: 2.101 Vali Loss: 2.027 Vali Acc: 0.181 Test Loss: 2.027 Test Acc: 0.181
Validation loss decreased (inf --> -0.181230).  Saving model ...
Epoch: 2 cost time: 1.5841891765594482
Epoch: 2, Steps: 8 | Train Loss: 2.020 Vali Loss: 1.864 Vali Acc: 0.372 Test Loss: 1.864 Test Acc: 0.372
Validation loss decreased (-0.181230 --> -0.371856).  Saving model ...
Epoch: 3 cost time: 1.5482795238494873
Epoch: 3, Steps: 8 | Train Loss: 1.788 Vali Loss: 1.650 Vali Acc: 0.606 Test Loss: 1.650 Test Acc: 0.606
Validation loss decreased (-0.371856 --> -0.606233).  Saving model ...
Epoch: 4 cost time: 1.5952739715576172
Epoch: 4, Steps: 8 | Train Loss: 1.528 Vali Loss: 1.416 Vali Acc: 0.772 Test Loss: 1.416 Test Acc: 0.772
Validation loss decreased (-0.606233 --> -0.771861).  Saving model ...
Epoch: 5 cost time: 1.5506060123443604
Epoch: 5, Steps: 8 | Train Loss: 1.299 Vali Loss: 1.202 Vali Acc: 0.775 Test Loss: 1.202 Test Acc: 0.775
Validation loss decreased (-0.771861 --> -0.774988).  Saving model ...
Epoch: 6 cost time: 1.6451637744903564
Epoch: 6, Steps: 8 | Train Loss: 1.077 Vali Loss: 1.019 Vali Acc: 0.781 Test Loss: 1.019 Test Acc: 0.781
Validation loss decreased (-0.774988 --> -0.781240).  Saving model ...
Epoch: 7 cost time: 1.6724154949188232
Epoch: 7, Steps: 8 | Train Loss: 0.878 Vali Loss: 0.872 Vali Acc: 0.791 Test Loss: 0.872 Test Acc: 0.791
Validation loss decreased (-0.781240 --> -0.790616).  Saving model ...
Epoch: 8 cost time: 1.70546555519104
Epoch: 8, Steps: 8 | Train Loss: 0.707 Vali Loss: 0.751 Vali Acc: 0.806 Test Loss: 0.751 Test Acc: 0.806
Validation loss decreased (-0.790616 --> -0.806242).  Saving model ...
Epoch: 9 cost time: 1.7002005577087402
Epoch: 9, Steps: 8 | Train Loss: 0.578 Vali Loss: 0.656 Vali Acc: 0.816 Test Loss: 0.656 Test Acc: 0.816
Validation loss decreased (-0.806242 --> -0.815618).  Saving model ...
Epoch: 10 cost time: 1.7106072902679443
Epoch: 10, Steps: 8 | Train Loss: 0.463 Vali Loss: 0.594 Vali Acc: 0.825 Test Loss: 0.594 Test Acc: 0.825
Validation loss decreased (-0.815618 --> -0.824994).  Saving model ...
Epoch: 11 cost time: 1.6662254333496094
Epoch: 11, Steps: 8 | Train Loss: 0.374 Vali Loss: 0.558 Vali Acc: 0.828 Test Loss: 0.558 Test Acc: 0.828
Validation loss decreased (-0.824994 --> -0.828119).  Saving model ...
Epoch: 12 cost time: 1.5037760734558105
Epoch: 12, Steps: 8 | Train Loss: 0.314 Vali Loss: 0.539 Vali Acc: 0.822 Test Loss: 0.539 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6036646366119385
Epoch: 13, Steps: 8 | Train Loss: 0.261 Vali Loss: 0.523 Vali Acc: 0.850 Test Loss: 0.523 Test Acc: 0.850
Validation loss decreased (-0.828119 --> -0.849995).  Saving model ...
Epoch: 14 cost time: 1.4845762252807617
Epoch: 14, Steps: 8 | Train Loss: 0.220 Vali Loss: 0.508 Vali Acc: 0.850 Test Loss: 0.508 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 15 cost time: 1.4404828548431396
Epoch: 15, Steps: 8 | Train Loss: 0.181 Vali Loss: 0.500 Vali Acc: 0.853 Test Loss: 0.500 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 16 cost time: 1.4792242050170898
Epoch: 16, Steps: 8 | Train Loss: 0.162 Vali Loss: 0.495 Vali Acc: 0.856 Test Loss: 0.495 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 17 cost time: 1.5189282894134521
Epoch: 17, Steps: 8 | Train Loss: 0.148 Vali Loss: 0.496 Vali Acc: 0.853 Test Loss: 0.496 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4400627613067627
Epoch: 18, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.499 Vali Acc: 0.850 Test Loss: 0.499 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.4729337692260742
Epoch: 19, Steps: 8 | Train Loss: 0.110 Vali Loss: 0.498 Vali Acc: 0.847 Test Loss: 0.498 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.5163347721099854
Epoch: 20, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.503 Vali Acc: 0.853 Test Loss: 0.503 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.484010934829712
Epoch: 21, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.503 Vali Acc: 0.856 Test Loss: 0.503 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.5985095500946045
Epoch: 22, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.506 Vali Acc: 0.850 Test Loss: 0.506 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.6053690910339355
Epoch: 23, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.514 Vali Acc: 0.844 Test Loss: 0.514 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.6640956401824951
Epoch: 24, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.511 Vali Acc: 0.841 Test Loss: 0.511 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.6987135410308838
Epoch: 25, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.513 Vali Acc: 0.847 Test Loss: 0.513 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.6726815700531006
Epoch: 26, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.523 Vali Acc: 0.850 Test Loss: 0.523 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 606880
model size : 2.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.5863544940948486
Epoch: 1, Steps: 8 | Train Loss: 2.111 Vali Loss: 2.070 Vali Acc: 0.147 Test Loss: 2.070 Test Acc: 0.147
Validation loss decreased (inf --> -0.146854).  Saving model ...
Epoch: 2 cost time: 1.1136212348937988
Epoch: 2, Steps: 8 | Train Loss: 1.976 Vali Loss: 1.937 Vali Acc: 0.244 Test Loss: 1.937 Test Acc: 0.244
Validation loss decreased (-0.146854 --> -0.243731).  Saving model ...
Epoch: 3 cost time: 1.0781035423278809
Epoch: 3, Steps: 8 | Train Loss: 1.804 Vali Loss: 1.752 Vali Acc: 0.438 Test Loss: 1.752 Test Acc: 0.438
Validation loss decreased (-0.243731 --> -0.437482).  Saving model ...
Epoch: 4 cost time: 1.1121389865875244
Epoch: 4, Steps: 8 | Train Loss: 1.603 Vali Loss: 1.546 Vali Acc: 0.666 Test Loss: 1.546 Test Acc: 0.666
Validation loss decreased (-0.437482 --> -0.665610).  Saving model ...
Epoch: 5 cost time: 1.1822335720062256
Epoch: 5, Steps: 8 | Train Loss: 1.392 Vali Loss: 1.341 Vali Acc: 0.750 Test Loss: 1.341 Test Acc: 0.750
Validation loss decreased (-0.665610 --> -0.749987).  Saving model ...
Epoch: 6 cost time: 1.146862268447876
Epoch: 6, Steps: 8 | Train Loss: 1.160 Vali Loss: 1.151 Vali Acc: 0.762 Test Loss: 1.151 Test Acc: 0.762
Validation loss decreased (-0.749987 --> -0.762488).  Saving model ...
Epoch: 7 cost time: 1.1194407939910889
Epoch: 7, Steps: 8 | Train Loss: 1.011 Vali Loss: 0.982 Vali Acc: 0.772 Test Loss: 0.982 Test Acc: 0.772
Validation loss decreased (-0.762488 --> -0.771865).  Saving model ...
Epoch: 8 cost time: 1.063187837600708
Epoch: 8, Steps: 8 | Train Loss: 0.832 Vali Loss: 0.836 Vali Acc: 0.794 Test Loss: 0.836 Test Acc: 0.794
Validation loss decreased (-0.771865 --> -0.793742).  Saving model ...
Epoch: 9 cost time: 1.0215058326721191
Epoch: 9, Steps: 8 | Train Loss: 0.691 Vali Loss: 0.726 Vali Acc: 0.812 Test Loss: 0.726 Test Acc: 0.812
Validation loss decreased (-0.793742 --> -0.812493).  Saving model ...
Epoch: 10 cost time: 1.0525002479553223
Epoch: 10, Steps: 8 | Train Loss: 0.555 Vali Loss: 0.647 Vali Acc: 0.822 Test Loss: 0.647 Test Acc: 0.822
Validation loss decreased (-0.812493 --> -0.821869).  Saving model ...
Epoch: 11 cost time: 1.061617374420166
Epoch: 11, Steps: 8 | Train Loss: 0.466 Vali Loss: 0.587 Vali Acc: 0.838 Test Loss: 0.587 Test Acc: 0.838
Validation loss decreased (-0.821869 --> -0.837494).  Saving model ...
Epoch: 12 cost time: 1.045583963394165
Epoch: 12, Steps: 8 | Train Loss: 0.376 Vali Loss: 0.541 Vali Acc: 0.838 Test Loss: 0.541 Test Acc: 0.838
Validation loss decreased (-0.837494 --> -0.837495).  Saving model ...
Epoch: 13 cost time: 1.1518452167510986
Epoch: 13, Steps: 8 | Train Loss: 0.332 Vali Loss: 0.518 Vali Acc: 0.847 Test Loss: 0.518 Test Acc: 0.847
Validation loss decreased (-0.837495 --> -0.846870).  Saving model ...
Epoch: 14 cost time: 1.179394245147705
Epoch: 14, Steps: 8 | Train Loss: 0.271 Vali Loss: 0.508 Vali Acc: 0.847 Test Loss: 0.508 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 15 cost time: 1.1239919662475586
Epoch: 15, Steps: 8 | Train Loss: 0.241 Vali Loss: 0.494 Vali Acc: 0.856 Test Loss: 0.494 Test Acc: 0.856
Validation loss decreased (-0.846870 --> -0.856245).  Saving model ...
Epoch: 16 cost time: 1.2123005390167236
Epoch: 16, Steps: 8 | Train Loss: 0.217 Vali Loss: 0.481 Vali Acc: 0.853 Test Loss: 0.481 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.135758876800537
Epoch: 17, Steps: 8 | Train Loss: 0.202 Vali Loss: 0.477 Vali Acc: 0.850 Test Loss: 0.477 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0953075885772705
Epoch: 18, Steps: 8 | Train Loss: 0.164 Vali Loss: 0.486 Vali Acc: 0.853 Test Loss: 0.486 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0880510807037354
Epoch: 19, Steps: 8 | Train Loss: 0.147 Vali Loss: 0.480 Vali Acc: 0.847 Test Loss: 0.480 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.137824535369873
Epoch: 20, Steps: 8 | Train Loss: 0.118 Vali Loss: 0.474 Vali Acc: 0.863 Test Loss: 0.474 Test Acc: 0.863
Validation loss decreased (-0.856245 --> -0.862495).  Saving model ...
Epoch: 21 cost time: 1.074535846710205
Epoch: 21, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.470 Vali Acc: 0.859 Test Loss: 0.470 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0332815647125244
Epoch: 22, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.471 Vali Acc: 0.859 Test Loss: 0.471 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0796606540679932
Epoch: 23, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.482 Vali Acc: 0.853 Test Loss: 0.482 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1034088134765625
Epoch: 24, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.487 Vali Acc: 0.856 Test Loss: 0.487 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.0698437690734863
Epoch: 25, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.490 Vali Acc: 0.853 Test Loss: 0.490 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.0456795692443848
Epoch: 26, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.485 Vali Acc: 0.856 Test Loss: 0.485 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.9873855113983154
Epoch: 27, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.484 Vali Acc: 0.863 Test Loss: 0.484 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.0505955219268799
Epoch: 28, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.486 Vali Acc: 0.859 Test Loss: 0.486 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.0846264362335205
Epoch: 29, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.502 Vali Acc: 0.850 Test Loss: 0.502 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.1047112941741943
Epoch: 30, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.512 Vali Acc: 0.850 Test Loss: 0.512 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 192896
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.5503454208374023
Epoch: 1, Steps: 8 | Train Loss: 2.187 Vali Loss: 2.153 Vali Acc: 0.075 Test Loss: 2.153 Test Acc: 0.075
Validation loss decreased (inf --> -0.074978).  Saving model ...
Epoch: 2 cost time: 1.78489351272583
Epoch: 2, Steps: 8 | Train Loss: 2.081 Vali Loss: 2.002 Vali Acc: 0.203 Test Loss: 2.002 Test Acc: 0.203
Validation loss decreased (-0.074978 --> -0.203105).  Saving model ...
Epoch: 3 cost time: 1.598644733428955
Epoch: 3, Steps: 8 | Train Loss: 1.901 Vali Loss: 1.797 Vali Acc: 0.425 Test Loss: 1.797 Test Acc: 0.425
Validation loss decreased (-0.203105 --> -0.424982).  Saving model ...
Epoch: 4 cost time: 1.5613923072814941
Epoch: 4, Steps: 8 | Train Loss: 1.708 Vali Loss: 1.572 Vali Acc: 0.556 Test Loss: 1.572 Test Acc: 0.556
Validation loss decreased (-0.424982 --> -0.556234).  Saving model ...
Epoch: 5 cost time: 1.5001602172851562
Epoch: 5, Steps: 8 | Train Loss: 1.437 Vali Loss: 1.362 Vali Acc: 0.662 Test Loss: 1.362 Test Acc: 0.662
Validation loss decreased (-0.556234 --> -0.662486).  Saving model ...
Epoch: 6 cost time: 2.1161344051361084
Epoch: 6, Steps: 8 | Train Loss: 1.196 Vali Loss: 1.170 Vali Acc: 0.725 Test Loss: 1.170 Test Acc: 0.725
Validation loss decreased (-0.662486 --> -0.724988).  Saving model ...
Epoch: 7 cost time: 2.070197343826294
Epoch: 7, Steps: 8 | Train Loss: 1.025 Vali Loss: 1.007 Vali Acc: 0.734 Test Loss: 1.007 Test Acc: 0.734
Validation loss decreased (-0.724988 --> -0.734365).  Saving model ...
Epoch: 8 cost time: 1.979781150817871
Epoch: 8, Steps: 8 | Train Loss: 0.835 Vali Loss: 0.883 Vali Acc: 0.769 Test Loss: 0.883 Test Acc: 0.769
Validation loss decreased (-0.734365 --> -0.768741).  Saving model ...
Epoch: 9 cost time: 2.0388896465301514
Epoch: 9, Steps: 8 | Train Loss: 0.687 Vali Loss: 0.790 Vali Acc: 0.791 Test Loss: 0.790 Test Acc: 0.791
Validation loss decreased (-0.768741 --> -0.790617).  Saving model ...
Epoch: 10 cost time: 2.0295262336730957
Epoch: 10, Steps: 8 | Train Loss: 0.564 Vali Loss: 0.723 Vali Acc: 0.803 Test Loss: 0.723 Test Acc: 0.803
Validation loss decreased (-0.790617 --> -0.803118).  Saving model ...
Epoch: 11 cost time: 1.912205696105957
Epoch: 11, Steps: 8 | Train Loss: 0.475 Vali Loss: 0.669 Vali Acc: 0.812 Test Loss: 0.669 Test Acc: 0.812
Validation loss decreased (-0.803118 --> -0.812493).  Saving model ...
Epoch: 12 cost time: 2.1750497817993164
Epoch: 12, Steps: 8 | Train Loss: 0.381 Vali Loss: 0.637 Vali Acc: 0.834 Test Loss: 0.637 Test Acc: 0.834
Validation loss decreased (-0.812493 --> -0.834369).  Saving model ...
Epoch: 13 cost time: 2.1374921798706055
Epoch: 13, Steps: 8 | Train Loss: 0.332 Vali Loss: 0.612 Vali Acc: 0.838 Test Loss: 0.612 Test Acc: 0.838
Validation loss decreased (-0.834369 --> -0.837494).  Saving model ...
Epoch: 14 cost time: 2.1920080184936523
Epoch: 14, Steps: 8 | Train Loss: 0.272 Vali Loss: 0.589 Vali Acc: 0.831 Test Loss: 0.589 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.1596522331237793
Epoch: 15, Steps: 8 | Train Loss: 0.224 Vali Loss: 0.578 Vali Acc: 0.838 Test Loss: 0.578 Test Acc: 0.838
Validation loss decreased (-0.837494 --> -0.837494).  Saving model ...
Epoch: 16 cost time: 2.0196828842163086
Epoch: 16, Steps: 8 | Train Loss: 0.183 Vali Loss: 0.570 Vali Acc: 0.828 Test Loss: 0.570 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.0054218769073486
Epoch: 17, Steps: 8 | Train Loss: 0.158 Vali Loss: 0.563 Vali Acc: 0.841 Test Loss: 0.563 Test Acc: 0.841
Validation loss decreased (-0.837494 --> -0.840619).  Saving model ...
Epoch: 18 cost time: 2.0001916885375977
Epoch: 18, Steps: 8 | Train Loss: 0.136 Vali Loss: 0.560 Vali Acc: 0.834 Test Loss: 0.560 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.0900557041168213
Epoch: 19, Steps: 8 | Train Loss: 0.120 Vali Loss: 0.550 Vali Acc: 0.841 Test Loss: 0.550 Test Acc: 0.841
Validation loss decreased (-0.840619 --> -0.840619).  Saving model ...
Epoch: 20 cost time: 1.986213207244873
Epoch: 20, Steps: 8 | Train Loss: 0.104 Vali Loss: 0.548 Vali Acc: 0.841 Test Loss: 0.548 Test Acc: 0.841
Validation loss decreased (-0.840619 --> -0.840620).  Saving model ...
Epoch: 21 cost time: 1.9959213733673096
Epoch: 21, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.545 Vali Acc: 0.844 Test Loss: 0.545 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 22 cost time: 1.906221866607666
Epoch: 22, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.547 Vali Acc: 0.844 Test Loss: 0.547 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.876655101776123
Epoch: 23, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.548 Vali Acc: 0.844 Test Loss: 0.548 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.0419957637786865
Epoch: 24, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.550 Vali Acc: 0.841 Test Loss: 0.550 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.0083718299865723
Epoch: 25, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.559 Vali Acc: 0.838 Test Loss: 0.559 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.124770164489746
Epoch: 26, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.559 Vali Acc: 0.831 Test Loss: 0.559 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.0682780742645264
Epoch: 27, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.562 Vali Acc: 0.838 Test Loss: 0.562 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.1004140377044678
Epoch: 28, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.563 Vali Acc: 0.838 Test Loss: 0.563 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.0808613300323486
Epoch: 29, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.566 Vali Acc: 0.838 Test Loss: 0.566 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.927666187286377
Epoch: 30, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.572 Vali Acc: 0.838 Test Loss: 0.572 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 313632
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.063077449798584
Epoch: 1, Steps: 8 | Train Loss: 2.118 Vali Loss: 2.060 Vali Acc: 0.144 Test Loss: 2.060 Test Acc: 0.144
Validation loss decreased (inf --> -0.143729).  Saving model ...
Epoch: 2 cost time: 1.4510810375213623
Epoch: 2, Steps: 8 | Train Loss: 1.994 Vali Loss: 1.895 Vali Acc: 0.237 Test Loss: 1.895 Test Acc: 0.237
Validation loss decreased (-0.143729 --> -0.237481).  Saving model ...
Epoch: 3 cost time: 1.3620808124542236
Epoch: 3, Steps: 8 | Train Loss: 1.821 Vali Loss: 1.685 Vali Acc: 0.503 Test Loss: 1.685 Test Acc: 0.503
Validation loss decreased (-0.237481 --> -0.503108).  Saving model ...
Epoch: 4 cost time: 1.382533073425293
Epoch: 4, Steps: 8 | Train Loss: 1.600 Vali Loss: 1.467 Vali Acc: 0.647 Test Loss: 1.467 Test Acc: 0.647
Validation loss decreased (-0.503108 --> -0.646860).  Saving model ...
Epoch: 5 cost time: 1.354926586151123
Epoch: 5, Steps: 8 | Train Loss: 1.331 Vali Loss: 1.266 Vali Acc: 0.706 Test Loss: 1.266 Test Acc: 0.706
Validation loss decreased (-0.646860 --> -0.706237).  Saving model ...
Epoch: 6 cost time: 1.376201868057251
Epoch: 6, Steps: 8 | Train Loss: 1.153 Vali Loss: 1.095 Vali Acc: 0.756 Test Loss: 1.095 Test Acc: 0.756
Validation loss decreased (-0.706237 --> -0.756239).  Saving model ...
Epoch: 7 cost time: 1.3956573009490967
Epoch: 7, Steps: 8 | Train Loss: 0.936 Vali Loss: 0.958 Vali Acc: 0.775 Test Loss: 0.958 Test Acc: 0.775
Validation loss decreased (-0.756239 --> -0.774990).  Saving model ...
Epoch: 8 cost time: 1.3937995433807373
Epoch: 8, Steps: 8 | Train Loss: 0.821 Vali Loss: 0.855 Vali Acc: 0.784 Test Loss: 0.855 Test Acc: 0.784
Validation loss decreased (-0.774990 --> -0.784366).  Saving model ...
Epoch: 9 cost time: 1.3727355003356934
Epoch: 9, Steps: 8 | Train Loss: 0.673 Vali Loss: 0.781 Vali Acc: 0.797 Test Loss: 0.781 Test Acc: 0.797
Validation loss decreased (-0.784366 --> -0.796867).  Saving model ...
Epoch: 10 cost time: 1.262739658355713
Epoch: 10, Steps: 8 | Train Loss: 0.594 Vali Loss: 0.719 Vali Acc: 0.806 Test Loss: 0.719 Test Acc: 0.806
Validation loss decreased (-0.796867 --> -0.806243).  Saving model ...
Epoch: 11 cost time: 1.3618037700653076
Epoch: 11, Steps: 8 | Train Loss: 0.491 Vali Loss: 0.683 Vali Acc: 0.803 Test Loss: 0.683 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2691881656646729
Epoch: 12, Steps: 8 | Train Loss: 0.432 Vali Loss: 0.653 Vali Acc: 0.797 Test Loss: 0.653 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3297183513641357
Epoch: 13, Steps: 8 | Train Loss: 0.362 Vali Loss: 0.620 Vali Acc: 0.806 Test Loss: 0.620 Test Acc: 0.806
Validation loss decreased (-0.806243 --> -0.806244).  Saving model ...
Epoch: 14 cost time: 1.1247880458831787
Epoch: 14, Steps: 8 | Train Loss: 0.305 Vali Loss: 0.603 Vali Acc: 0.803 Test Loss: 0.603 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4098281860351562
Epoch: 15, Steps: 8 | Train Loss: 0.272 Vali Loss: 0.592 Vali Acc: 0.809 Test Loss: 0.592 Test Acc: 0.809
Validation loss decreased (-0.806244 --> -0.809369).  Saving model ...
Epoch: 16 cost time: 1.3841538429260254
Epoch: 16, Steps: 8 | Train Loss: 0.244 Vali Loss: 0.583 Vali Acc: 0.822 Test Loss: 0.583 Test Acc: 0.822
Validation loss decreased (-0.809369 --> -0.821869).  Saving model ...
Epoch: 17 cost time: 1.3903422355651855
Epoch: 17, Steps: 8 | Train Loss: 0.205 Vali Loss: 0.566 Vali Acc: 0.838 Test Loss: 0.566 Test Acc: 0.838
Validation loss decreased (-0.821869 --> -0.837494).  Saving model ...
Epoch: 18 cost time: 1.3660955429077148
Epoch: 18, Steps: 8 | Train Loss: 0.171 Vali Loss: 0.555 Vali Acc: 0.828 Test Loss: 0.555 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.448354721069336
Epoch: 19, Steps: 8 | Train Loss: 0.164 Vali Loss: 0.549 Vali Acc: 0.834 Test Loss: 0.549 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.3885741233825684
Epoch: 20, Steps: 8 | Train Loss: 0.143 Vali Loss: 0.551 Vali Acc: 0.841 Test Loss: 0.551 Test Acc: 0.841
Validation loss decreased (-0.837494 --> -0.840619).  Saving model ...
Epoch: 21 cost time: 1.3561761379241943
Epoch: 21, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.552 Vali Acc: 0.841 Test Loss: 0.552 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.474877119064331
Epoch: 22, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.550 Vali Acc: 0.841 Test Loss: 0.550 Test Acc: 0.841
Validation loss decreased (-0.840619 --> -0.840620).  Saving model ...
Epoch: 23 cost time: 1.4703748226165771
Epoch: 23, Steps: 8 | Train Loss: 0.104 Vali Loss: 0.540 Vali Acc: 0.841 Test Loss: 0.540 Test Acc: 0.841
Validation loss decreased (-0.840620 --> -0.840620).  Saving model ...
Epoch: 24 cost time: 1.4456427097320557
Epoch: 24, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.541 Vali Acc: 0.844 Test Loss: 0.541 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 25 cost time: 1.4585018157958984
Epoch: 25, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.542 Vali Acc: 0.853 Test Loss: 0.542 Test Acc: 0.853
Validation loss decreased (-0.843745 --> -0.853120).  Saving model ...
Epoch: 26 cost time: 1.4756219387054443
Epoch: 26, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.547 Vali Acc: 0.844 Test Loss: 0.547 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.4913053512573242
Epoch: 27, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.554 Vali Acc: 0.841 Test Loss: 0.554 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.3636057376861572
Epoch: 28, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.559 Vali Acc: 0.847 Test Loss: 0.559 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.4197425842285156
Epoch: 29, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.554 Vali Acc: 0.838 Test Loss: 0.554 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.347759485244751
Epoch: 30, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.557 Vali Acc: 0.831 Test Loss: 0.557 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 106624
model size : 0.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.1695616245269775
Epoch: 1, Steps: 8 | Train Loss: 2.187 Vali Loss: 2.153 Vali Acc: 0.075 Test Loss: 2.153 Test Acc: 0.075
Validation loss decreased (inf --> -0.074978).  Saving model ...
Epoch: 2 cost time: 1.6549110412597656
Epoch: 2, Steps: 8 | Train Loss: 2.082 Vali Loss: 2.003 Vali Acc: 0.197 Test Loss: 2.003 Test Acc: 0.197
Validation loss decreased (-0.074978 --> -0.196855).  Saving model ...
Epoch: 3 cost time: 1.7367572784423828
Epoch: 3, Steps: 8 | Train Loss: 1.902 Vali Loss: 1.799 Vali Acc: 0.422 Test Loss: 1.799 Test Acc: 0.422
Validation loss decreased (-0.196855 --> -0.421857).  Saving model ...
Epoch: 4 cost time: 1.641409158706665
Epoch: 4, Steps: 8 | Train Loss: 1.709 Vali Loss: 1.576 Vali Acc: 0.556 Test Loss: 1.576 Test Acc: 0.556
Validation loss decreased (-0.421857 --> -0.556234).  Saving model ...
Epoch: 5 cost time: 1.4738004207611084
Epoch: 5, Steps: 8 | Train Loss: 1.438 Vali Loss: 1.367 Vali Acc: 0.650 Test Loss: 1.367 Test Acc: 0.650
Validation loss decreased (-0.556234 --> -0.649986).  Saving model ...
Epoch: 6 cost time: 1.756542682647705
Epoch: 6, Steps: 8 | Train Loss: 1.196 Vali Loss: 1.176 Vali Acc: 0.706 Test Loss: 1.176 Test Acc: 0.706
Validation loss decreased (-0.649986 --> -0.706238).  Saving model ...
Epoch: 7 cost time: 1.7713994979858398
Epoch: 7, Steps: 8 | Train Loss: 1.024 Vali Loss: 1.013 Vali Acc: 0.734 Test Loss: 1.013 Test Acc: 0.734
Validation loss decreased (-0.706238 --> -0.734365).  Saving model ...
Epoch: 8 cost time: 1.769698143005371
Epoch: 8, Steps: 8 | Train Loss: 0.834 Vali Loss: 0.889 Vali Acc: 0.766 Test Loss: 0.889 Test Acc: 0.766
Validation loss decreased (-0.734365 --> -0.765616).  Saving model ...
Epoch: 9 cost time: 1.787121295928955
Epoch: 9, Steps: 8 | Train Loss: 0.685 Vali Loss: 0.797 Vali Acc: 0.781 Test Loss: 0.797 Test Acc: 0.781
Validation loss decreased (-0.765616 --> -0.781242).  Saving model ...
Epoch: 10 cost time: 1.681422472000122
Epoch: 10, Steps: 8 | Train Loss: 0.561 Vali Loss: 0.730 Vali Acc: 0.800 Test Loss: 0.730 Test Acc: 0.800
Validation loss decreased (-0.781242 --> -0.799993).  Saving model ...
Epoch: 11 cost time: 1.9500455856323242
Epoch: 11, Steps: 8 | Train Loss: 0.473 Vali Loss: 0.677 Vali Acc: 0.809 Test Loss: 0.677 Test Acc: 0.809
Validation loss decreased (-0.799993 --> -0.809368).  Saving model ...
Epoch: 12 cost time: 1.8577709197998047
Epoch: 12, Steps: 8 | Train Loss: 0.381 Vali Loss: 0.646 Vali Acc: 0.838 Test Loss: 0.646 Test Acc: 0.838
Validation loss decreased (-0.809368 --> -0.837494).  Saving model ...
Epoch: 13 cost time: 1.8631691932678223
Epoch: 13, Steps: 8 | Train Loss: 0.327 Vali Loss: 0.623 Vali Acc: 0.834 Test Loss: 0.623 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9127788543701172
Epoch: 14, Steps: 8 | Train Loss: 0.270 Vali Loss: 0.599 Vali Acc: 0.834 Test Loss: 0.599 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8806395530700684
Epoch: 15, Steps: 8 | Train Loss: 0.223 Vali Loss: 0.587 Vali Acc: 0.831 Test Loss: 0.587 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.735793113708496
Epoch: 16, Steps: 8 | Train Loss: 0.182 Vali Loss: 0.579 Vali Acc: 0.828 Test Loss: 0.579 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.8236050605773926
Epoch: 17, Steps: 8 | Train Loss: 0.159 Vali Loss: 0.572 Vali Acc: 0.844 Test Loss: 0.572 Test Acc: 0.844
Validation loss decreased (-0.837494 --> -0.843744).  Saving model ...
Epoch: 18 cost time: 1.784698724746704
Epoch: 18, Steps: 8 | Train Loss: 0.135 Vali Loss: 0.570 Vali Acc: 0.847 Test Loss: 0.570 Test Acc: 0.847
Validation loss decreased (-0.843744 --> -0.846869).  Saving model ...
Epoch: 19 cost time: 1.816342830657959
Epoch: 19, Steps: 8 | Train Loss: 0.120 Vali Loss: 0.560 Vali Acc: 0.847 Test Loss: 0.560 Test Acc: 0.847
Validation loss decreased (-0.846869 --> -0.846869).  Saving model ...
Epoch: 20 cost time: 1.5983912944793701
Epoch: 20, Steps: 8 | Train Loss: 0.104 Vali Loss: 0.556 Vali Acc: 0.847 Test Loss: 0.556 Test Acc: 0.847
Validation loss decreased (-0.846869 --> -0.846869).  Saving model ...
Epoch: 21 cost time: 1.6394281387329102
Epoch: 21, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.551 Vali Acc: 0.850 Test Loss: 0.551 Test Acc: 0.850
Validation loss decreased (-0.846869 --> -0.849994).  Saving model ...
Epoch: 22 cost time: 1.653313398361206
Epoch: 22, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.552 Vali Acc: 0.850 Test Loss: 0.552 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.6741158962249756
Epoch: 23, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.552 Vali Acc: 0.847 Test Loss: 0.552 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.6010093688964844
Epoch: 24, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.554 Vali Acc: 0.844 Test Loss: 0.554 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.8120899200439453
Epoch: 25, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.564 Vali Acc: 0.847 Test Loss: 0.564 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.754739761352539
Epoch: 26, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.563 Vali Acc: 0.844 Test Loss: 0.563 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.8971905708312988
Epoch: 27, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.566 Vali Acc: 0.841 Test Loss: 0.566 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.7825508117675781
Epoch: 28, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.566 Vali Acc: 0.847 Test Loss: 0.566 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.8892414569854736
Epoch: 29, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.570 Vali Acc: 0.847 Test Loss: 0.570 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.9513890743255615
Epoch: 30, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.576 Vali Acc: 0.847 Test Loss: 0.576 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 313632
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.926257610321045
Epoch: 1, Steps: 8 | Train Loss: 2.118 Vali Loss: 2.059 Vali Acc: 0.141 Test Loss: 2.059 Test Acc: 0.141
Validation loss decreased (inf --> -0.140604).  Saving model ...
Epoch: 2 cost time: 1.358520746231079
Epoch: 2, Steps: 8 | Train Loss: 1.995 Vali Loss: 1.895 Vali Acc: 0.237 Test Loss: 1.895 Test Acc: 0.237
Validation loss decreased (-0.140604 --> -0.237481).  Saving model ...
Epoch: 3 cost time: 1.423952579498291
Epoch: 3, Steps: 8 | Train Loss: 1.821 Vali Loss: 1.684 Vali Acc: 0.509 Test Loss: 1.684 Test Acc: 0.509
Validation loss decreased (-0.237481 --> -0.509358).  Saving model ...
Epoch: 4 cost time: 1.2867460250854492
Epoch: 4, Steps: 8 | Train Loss: 1.600 Vali Loss: 1.467 Vali Acc: 0.650 Test Loss: 1.467 Test Acc: 0.650
Validation loss decreased (-0.509358 --> -0.649985).  Saving model ...
Epoch: 5 cost time: 1.2562720775604248
Epoch: 5, Steps: 8 | Train Loss: 1.331 Vali Loss: 1.266 Vali Acc: 0.713 Test Loss: 1.266 Test Acc: 0.713
Validation loss decreased (-0.649985 --> -0.712487).  Saving model ...
Epoch: 6 cost time: 1.3067996501922607
Epoch: 6, Steps: 8 | Train Loss: 1.152 Vali Loss: 1.095 Vali Acc: 0.759 Test Loss: 1.095 Test Acc: 0.759
Validation loss decreased (-0.712487 --> -0.759364).  Saving model ...
Epoch: 7 cost time: 1.302114725112915
Epoch: 7, Steps: 8 | Train Loss: 0.934 Vali Loss: 0.958 Vali Acc: 0.775 Test Loss: 0.958 Test Acc: 0.775
Validation loss decreased (-0.759364 --> -0.774990).  Saving model ...
Epoch: 8 cost time: 1.2601091861724854
Epoch: 8, Steps: 8 | Train Loss: 0.819 Vali Loss: 0.855 Vali Acc: 0.787 Test Loss: 0.855 Test Acc: 0.787
Validation loss decreased (-0.774990 --> -0.787491).  Saving model ...
Epoch: 9 cost time: 1.1795654296875
Epoch: 9, Steps: 8 | Train Loss: 0.671 Vali Loss: 0.782 Vali Acc: 0.794 Test Loss: 0.782 Test Acc: 0.794
Validation loss decreased (-0.787491 --> -0.793742).  Saving model ...
Epoch: 10 cost time: 1.2049920558929443
Epoch: 10, Steps: 8 | Train Loss: 0.593 Vali Loss: 0.720 Vali Acc: 0.803 Test Loss: 0.720 Test Acc: 0.803
Validation loss decreased (-0.793742 --> -0.803118).  Saving model ...
Epoch: 11 cost time: 1.2107923030853271
Epoch: 11, Steps: 8 | Train Loss: 0.489 Vali Loss: 0.685 Vali Acc: 0.800 Test Loss: 0.685 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1978623867034912
Epoch: 12, Steps: 8 | Train Loss: 0.429 Vali Loss: 0.655 Vali Acc: 0.797 Test Loss: 0.655 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2390458583831787
Epoch: 13, Steps: 8 | Train Loss: 0.361 Vali Loss: 0.622 Vali Acc: 0.803 Test Loss: 0.622 Test Acc: 0.803
Validation loss decreased (-0.803118 --> -0.803119).  Saving model ...
Epoch: 14 cost time: 1.2390391826629639
Epoch: 14, Steps: 8 | Train Loss: 0.303 Vali Loss: 0.606 Vali Acc: 0.800 Test Loss: 0.606 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.314288854598999
Epoch: 15, Steps: 8 | Train Loss: 0.269 Vali Loss: 0.595 Vali Acc: 0.803 Test Loss: 0.595 Test Acc: 0.803
Validation loss decreased (-0.803119 --> -0.803119).  Saving model ...
Epoch: 16 cost time: 1.3246173858642578
Epoch: 16, Steps: 8 | Train Loss: 0.244 Vali Loss: 0.587 Vali Acc: 0.816 Test Loss: 0.587 Test Acc: 0.816
Validation loss decreased (-0.803119 --> -0.815619).  Saving model ...
Epoch: 17 cost time: 1.3047173023223877
Epoch: 17, Steps: 8 | Train Loss: 0.202 Vali Loss: 0.571 Vali Acc: 0.831 Test Loss: 0.571 Test Acc: 0.831
Validation loss decreased (-0.815619 --> -0.831244).  Saving model ...
Epoch: 18 cost time: 1.3396601676940918
Epoch: 18, Steps: 8 | Train Loss: 0.169 Vali Loss: 0.560 Vali Acc: 0.822 Test Loss: 0.560 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3115038871765137
Epoch: 19, Steps: 8 | Train Loss: 0.162 Vali Loss: 0.554 Vali Acc: 0.831 Test Loss: 0.554 Test Acc: 0.831
Validation loss decreased (-0.831244 --> -0.831244).  Saving model ...
Epoch: 20 cost time: 1.3085167407989502
Epoch: 20, Steps: 8 | Train Loss: 0.143 Vali Loss: 0.557 Vali Acc: 0.838 Test Loss: 0.557 Test Acc: 0.838
Validation loss decreased (-0.831244 --> -0.837494).  Saving model ...
Epoch: 21 cost time: 1.354717493057251
Epoch: 21, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.558 Vali Acc: 0.838 Test Loss: 0.558 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3691234588623047
Epoch: 22, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.556 Vali Acc: 0.838 Test Loss: 0.556 Test Acc: 0.838
Validation loss decreased (-0.837494 --> -0.837494).  Saving model ...
Epoch: 23 cost time: 1.4228119850158691
Epoch: 23, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.546 Vali Acc: 0.841 Test Loss: 0.546 Test Acc: 0.841
Validation loss decreased (-0.837494 --> -0.840620).  Saving model ...
Epoch: 24 cost time: 1.3575961589813232
Epoch: 24, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.548 Vali Acc: 0.847 Test Loss: 0.548 Test Acc: 0.847
Validation loss decreased (-0.840620 --> -0.846870).  Saving model ...
Epoch: 25 cost time: 1.4003944396972656
Epoch: 25, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.548 Vali Acc: 0.853 Test Loss: 0.548 Test Acc: 0.853
Validation loss decreased (-0.846870 --> -0.853120).  Saving model ...
Epoch: 26 cost time: 1.3655664920806885
Epoch: 26, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.552 Vali Acc: 0.847 Test Loss: 0.552 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3907411098480225
Epoch: 27, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.559 Vali Acc: 0.838 Test Loss: 0.559 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2354655265808105
Epoch: 28, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.565 Vali Acc: 0.841 Test Loss: 0.565 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.3008637428283691
Epoch: 29, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.560 Vali Acc: 0.838 Test Loss: 0.560 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.2788434028625488
Epoch: 30, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.563 Vali Acc: 0.831 Test Loss: 0.563 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 106624
model size : 0.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.612605333328247
Epoch: 1, Steps: 8 | Train Loss: 2.189 Vali Loss: 2.153 Vali Acc: 0.075 Test Loss: 2.153 Test Acc: 0.075
Validation loss decreased (inf --> -0.074978).  Saving model ...
Epoch: 2 cost time: 1.2320454120635986
Epoch: 2, Steps: 8 | Train Loss: 2.088 Vali Loss: 2.004 Vali Acc: 0.191 Test Loss: 2.004 Test Acc: 0.191
Validation loss decreased (-0.074978 --> -0.190605).  Saving model ...
Epoch: 3 cost time: 1.2145769596099854
Epoch: 3, Steps: 8 | Train Loss: 1.907 Vali Loss: 1.802 Vali Acc: 0.422 Test Loss: 1.802 Test Acc: 0.422
Validation loss decreased (-0.190605 --> -0.421857).  Saving model ...
Epoch: 4 cost time: 1.2217819690704346
Epoch: 4, Steps: 8 | Train Loss: 1.719 Vali Loss: 1.580 Vali Acc: 0.550 Test Loss: 1.580 Test Acc: 0.550
Validation loss decreased (-0.421857 --> -0.549984).  Saving model ...
Epoch: 5 cost time: 1.2708613872528076
Epoch: 5, Steps: 8 | Train Loss: 1.452 Vali Loss: 1.372 Vali Acc: 0.659 Test Loss: 1.372 Test Acc: 0.659
Validation loss decreased (-0.549984 --> -0.659361).  Saving model ...
Epoch: 6 cost time: 1.2075111865997314
Epoch: 6, Steps: 8 | Train Loss: 1.210 Vali Loss: 1.182 Vali Acc: 0.719 Test Loss: 1.182 Test Acc: 0.719
Validation loss decreased (-0.659361 --> -0.718738).  Saving model ...
Epoch: 7 cost time: 1.299734354019165
Epoch: 7, Steps: 8 | Train Loss: 1.044 Vali Loss: 1.021 Vali Acc: 0.734 Test Loss: 1.021 Test Acc: 0.734
Validation loss decreased (-0.718738 --> -0.734365).  Saving model ...
Epoch: 8 cost time: 1.3316314220428467
Epoch: 8, Steps: 8 | Train Loss: 0.858 Vali Loss: 0.898 Vali Acc: 0.759 Test Loss: 0.898 Test Acc: 0.759
Validation loss decreased (-0.734365 --> -0.759366).  Saving model ...
Epoch: 9 cost time: 1.2997736930847168
Epoch: 9, Steps: 8 | Train Loss: 0.707 Vali Loss: 0.806 Vali Acc: 0.784 Test Loss: 0.806 Test Acc: 0.784
Validation loss decreased (-0.759366 --> -0.784367).  Saving model ...
Epoch: 10 cost time: 1.2985289096832275
Epoch: 10, Steps: 8 | Train Loss: 0.586 Vali Loss: 0.740 Vali Acc: 0.797 Test Loss: 0.740 Test Acc: 0.797
Validation loss decreased (-0.784367 --> -0.796868).  Saving model ...
Epoch: 11 cost time: 1.3577909469604492
Epoch: 11, Steps: 8 | Train Loss: 0.498 Vali Loss: 0.687 Vali Acc: 0.816 Test Loss: 0.687 Test Acc: 0.816
Validation loss decreased (-0.796868 --> -0.815618).  Saving model ...
Epoch: 12 cost time: 1.3455395698547363
Epoch: 12, Steps: 8 | Train Loss: 0.409 Vali Loss: 0.657 Vali Acc: 0.828 Test Loss: 0.657 Test Acc: 0.828
Validation loss decreased (-0.815618 --> -0.828118).  Saving model ...
Epoch: 13 cost time: 1.4028031826019287
Epoch: 13, Steps: 8 | Train Loss: 0.358 Vali Loss: 0.633 Vali Acc: 0.828 Test Loss: 0.633 Test Acc: 0.828
Validation loss decreased (-0.828118 --> -0.828119).  Saving model ...
Epoch: 14 cost time: 1.4798569679260254
Epoch: 14, Steps: 8 | Train Loss: 0.301 Vali Loss: 0.610 Vali Acc: 0.822 Test Loss: 0.610 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4649410247802734
Epoch: 15, Steps: 8 | Train Loss: 0.249 Vali Loss: 0.597 Vali Acc: 0.831 Test Loss: 0.597 Test Acc: 0.831
Validation loss decreased (-0.828119 --> -0.831244).  Saving model ...
Epoch: 16 cost time: 1.4759867191314697
Epoch: 16, Steps: 8 | Train Loss: 0.208 Vali Loss: 0.589 Vali Acc: 0.844 Test Loss: 0.589 Test Acc: 0.844
Validation loss decreased (-0.831244 --> -0.843744).  Saving model ...
Epoch: 17 cost time: 1.580838918685913
Epoch: 17, Steps: 8 | Train Loss: 0.178 Vali Loss: 0.582 Vali Acc: 0.853 Test Loss: 0.582 Test Acc: 0.853
Validation loss decreased (-0.843744 --> -0.853119).  Saving model ...
Epoch: 18 cost time: 1.4955501556396484
Epoch: 18, Steps: 8 | Train Loss: 0.154 Vali Loss: 0.580 Vali Acc: 0.856 Test Loss: 0.580 Test Acc: 0.856
Validation loss decreased (-0.853119 --> -0.856244).  Saving model ...
Epoch: 19 cost time: 1.4282772541046143
Epoch: 19, Steps: 8 | Train Loss: 0.137 Vali Loss: 0.569 Vali Acc: 0.856 Test Loss: 0.569 Test Acc: 0.856
Validation loss decreased (-0.856244 --> -0.856244).  Saving model ...
Epoch: 20 cost time: 1.378108263015747
Epoch: 20, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.566 Vali Acc: 0.853 Test Loss: 0.566 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3637871742248535
Epoch: 21, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.563 Vali Acc: 0.853 Test Loss: 0.563 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.3631231784820557
Epoch: 22, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.565 Vali Acc: 0.853 Test Loss: 0.565 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.4092459678649902
Epoch: 23, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.566 Vali Acc: 0.856 Test Loss: 0.566 Test Acc: 0.856
Validation loss decreased (-0.856244 --> -0.856244).  Saving model ...
Epoch: 24 cost time: 1.378011703491211
Epoch: 24, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.571 Vali Acc: 0.853 Test Loss: 0.571 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.357814073562622
Epoch: 25, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.582 Vali Acc: 0.850 Test Loss: 0.582 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.3283641338348389
Epoch: 26, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.581 Vali Acc: 0.850 Test Loss: 0.581 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.3252389430999756
Epoch: 27, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.584 Vali Acc: 0.853 Test Loss: 0.584 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.3096213340759277
Epoch: 28, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.585 Vali Acc: 0.853 Test Loss: 0.585 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.3223907947540283
Epoch: 29, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.589 Vali Acc: 0.853 Test Loss: 0.589 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.2970283031463623
Epoch: 30, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.594 Vali Acc: 0.853 Test Loss: 0.594 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 313632
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.540912389755249
Epoch: 1, Steps: 8 | Train Loss: 2.119 Vali Loss: 2.060 Vali Acc: 0.138 Test Loss: 2.060 Test Acc: 0.138
Validation loss decreased (inf --> -0.137479).  Saving model ...
Epoch: 2 cost time: 1.0629231929779053
Epoch: 2, Steps: 8 | Train Loss: 1.993 Vali Loss: 1.896 Vali Acc: 0.244 Test Loss: 1.896 Test Acc: 0.244
Validation loss decreased (-0.137479 --> -0.243731).  Saving model ...
Epoch: 3 cost time: 1.116715431213379
Epoch: 3, Steps: 8 | Train Loss: 1.824 Vali Loss: 1.686 Vali Acc: 0.509 Test Loss: 1.686 Test Acc: 0.509
Validation loss decreased (-0.243731 --> -0.509358).  Saving model ...
Epoch: 4 cost time: 1.0837693214416504
Epoch: 4, Steps: 8 | Train Loss: 1.601 Vali Loss: 1.469 Vali Acc: 0.650 Test Loss: 1.469 Test Acc: 0.650
Validation loss decreased (-0.509358 --> -0.649985).  Saving model ...
Epoch: 5 cost time: 1.1174743175506592
Epoch: 5, Steps: 8 | Train Loss: 1.334 Vali Loss: 1.269 Vali Acc: 0.716 Test Loss: 1.269 Test Acc: 0.716
Validation loss decreased (-0.649985 --> -0.715612).  Saving model ...
Epoch: 6 cost time: 1.1843798160552979
Epoch: 6, Steps: 8 | Train Loss: 1.162 Vali Loss: 1.097 Vali Acc: 0.756 Test Loss: 1.097 Test Acc: 0.756
Validation loss decreased (-0.715612 --> -0.756239).  Saving model ...
Epoch: 7 cost time: 1.1700067520141602
Epoch: 7, Steps: 8 | Train Loss: 0.941 Vali Loss: 0.961 Vali Acc: 0.775 Test Loss: 0.961 Test Acc: 0.775
Validation loss decreased (-0.756239 --> -0.774990).  Saving model ...
Epoch: 8 cost time: 1.1776695251464844
Epoch: 8, Steps: 8 | Train Loss: 0.827 Vali Loss: 0.859 Vali Acc: 0.781 Test Loss: 0.859 Test Acc: 0.781
Validation loss decreased (-0.774990 --> -0.781241).  Saving model ...
Epoch: 9 cost time: 1.145073413848877
Epoch: 9, Steps: 8 | Train Loss: 0.684 Vali Loss: 0.788 Vali Acc: 0.791 Test Loss: 0.788 Test Acc: 0.791
Validation loss decreased (-0.781241 --> -0.790617).  Saving model ...
Epoch: 10 cost time: 1.1653294563293457
Epoch: 10, Steps: 8 | Train Loss: 0.610 Vali Loss: 0.728 Vali Acc: 0.800 Test Loss: 0.728 Test Acc: 0.800
Validation loss decreased (-0.790617 --> -0.799993).  Saving model ...
Epoch: 11 cost time: 1.1302392482757568
Epoch: 11, Steps: 8 | Train Loss: 0.511 Vali Loss: 0.695 Vali Acc: 0.800 Test Loss: 0.695 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 12 cost time: 1.1427903175354004
Epoch: 12, Steps: 8 | Train Loss: 0.454 Vali Loss: 0.668 Vali Acc: 0.794 Test Loss: 0.668 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1190595626831055
Epoch: 13, Steps: 8 | Train Loss: 0.388 Vali Loss: 0.635 Vali Acc: 0.803 Test Loss: 0.635 Test Acc: 0.803
Validation loss decreased (-0.799993 --> -0.803119).  Saving model ...
Epoch: 14 cost time: 1.06414794921875
Epoch: 14, Steps: 8 | Train Loss: 0.332 Vali Loss: 0.621 Vali Acc: 0.809 Test Loss: 0.621 Test Acc: 0.809
Validation loss decreased (-0.803119 --> -0.809369).  Saving model ...
Epoch: 15 cost time: 1.0718913078308105
Epoch: 15, Steps: 8 | Train Loss: 0.299 Vali Loss: 0.611 Vali Acc: 0.816 Test Loss: 0.611 Test Acc: 0.816
Validation loss decreased (-0.809369 --> -0.815619).  Saving model ...
Epoch: 16 cost time: 1.091041088104248
Epoch: 16, Steps: 8 | Train Loss: 0.277 Vali Loss: 0.604 Vali Acc: 0.822 Test Loss: 0.604 Test Acc: 0.822
Validation loss decreased (-0.815619 --> -0.821869).  Saving model ...
Epoch: 17 cost time: 1.0722405910491943
Epoch: 17, Steps: 8 | Train Loss: 0.233 Vali Loss: 0.590 Vali Acc: 0.822 Test Loss: 0.590 Test Acc: 0.822
Validation loss decreased (-0.821869 --> -0.821869).  Saving model ...
Epoch: 18 cost time: 1.1043553352355957
Epoch: 18, Steps: 8 | Train Loss: 0.196 Vali Loss: 0.578 Vali Acc: 0.822 Test Loss: 0.578 Test Acc: 0.822
Validation loss decreased (-0.821869 --> -0.821869).  Saving model ...
Epoch: 19 cost time: 1.0787556171417236
Epoch: 19, Steps: 8 | Train Loss: 0.186 Vali Loss: 0.573 Vali Acc: 0.825 Test Loss: 0.573 Test Acc: 0.825
Validation loss decreased (-0.821869 --> -0.824994).  Saving model ...
Epoch: 20 cost time: 0.9326446056365967
Epoch: 20, Steps: 8 | Train Loss: 0.167 Vali Loss: 0.577 Vali Acc: 0.838 Test Loss: 0.577 Test Acc: 0.838
Validation loss decreased (-0.824994 --> -0.837494).  Saving model ...
Epoch: 21 cost time: 1.0996103286743164
Epoch: 21, Steps: 8 | Train Loss: 0.153 Vali Loss: 0.578 Vali Acc: 0.841 Test Loss: 0.578 Test Acc: 0.841
Validation loss decreased (-0.837494 --> -0.840619).  Saving model ...
Epoch: 22 cost time: 1.034104347229004
Epoch: 22, Steps: 8 | Train Loss: 0.131 Vali Loss: 0.574 Vali Acc: 0.847 Test Loss: 0.574 Test Acc: 0.847
Validation loss decreased (-0.840619 --> -0.846869).  Saving model ...
Epoch: 23 cost time: 1.0377774238586426
Epoch: 23, Steps: 8 | Train Loss: 0.122 Vali Loss: 0.564 Vali Acc: 0.847 Test Loss: 0.564 Test Acc: 0.847
Validation loss decreased (-0.846869 --> -0.846869).  Saving model ...
Epoch: 24 cost time: 1.0314617156982422
Epoch: 24, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.567 Vali Acc: 0.847 Test Loss: 0.567 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0008728504180908
Epoch: 25, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.569 Vali Acc: 0.847 Test Loss: 0.569 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0166020393371582
Epoch: 26, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.573 Vali Acc: 0.838 Test Loss: 0.573 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.0936315059661865
Epoch: 27, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.576 Vali Acc: 0.841 Test Loss: 0.576 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.1110625267028809
Epoch: 28, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.585 Vali Acc: 0.844 Test Loss: 0.585 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.0854723453521729
Epoch: 29, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.581 Vali Acc: 0.844 Test Loss: 0.581 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.0938854217529297
Epoch: 30, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.586 Vali Acc: 0.841 Test Loss: 0.586 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 106624
model size : 0.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.5765316486358643
Epoch: 1, Steps: 8 | Train Loss: 2.138 Vali Loss: 2.037 Vali Acc: 0.203 Test Loss: 2.037 Test Acc: 0.203
Validation loss decreased (inf --> -0.203105).  Saving model ...
Epoch: 2 cost time: 2.0171210765838623
Epoch: 2, Steps: 8 | Train Loss: 2.004 Vali Loss: 1.865 Vali Acc: 0.388 Test Loss: 1.865 Test Acc: 0.388
Validation loss decreased (-0.203105 --> -0.387481).  Saving model ...
Epoch: 3 cost time: 1.9851083755493164
Epoch: 3, Steps: 8 | Train Loss: 1.762 Vali Loss: 1.651 Vali Acc: 0.631 Test Loss: 1.651 Test Acc: 0.631
Validation loss decreased (-0.387481 --> -0.631233).  Saving model ...
Epoch: 4 cost time: 2.0086724758148193
Epoch: 4, Steps: 8 | Train Loss: 1.521 Vali Loss: 1.430 Vali Acc: 0.722 Test Loss: 1.430 Test Acc: 0.722
Validation loss decreased (-0.631233 --> -0.721861).  Saving model ...
Epoch: 5 cost time: 2.092966318130493
Epoch: 5, Steps: 8 | Train Loss: 1.263 Vali Loss: 1.227 Vali Acc: 0.747 Test Loss: 1.227 Test Acc: 0.747
Validation loss decreased (-0.721861 --> -0.746863).  Saving model ...
Epoch: 6 cost time: 1.9957199096679688
Epoch: 6, Steps: 8 | Train Loss: 1.056 Vali Loss: 1.053 Vali Acc: 0.766 Test Loss: 1.053 Test Acc: 0.766
Validation loss decreased (-0.746863 --> -0.765614).  Saving model ...
Epoch: 7 cost time: 1.897759199142456
Epoch: 7, Steps: 8 | Train Loss: 0.869 Vali Loss: 0.907 Vali Acc: 0.772 Test Loss: 0.907 Test Acc: 0.772
Validation loss decreased (-0.765614 --> -0.771866).  Saving model ...
Epoch: 8 cost time: 1.8608622550964355
Epoch: 8, Steps: 8 | Train Loss: 0.734 Vali Loss: 0.792 Vali Acc: 0.800 Test Loss: 0.792 Test Acc: 0.800
Validation loss decreased (-0.771866 --> -0.799992).  Saving model ...
Epoch: 9 cost time: 1.8174586296081543
Epoch: 9, Steps: 8 | Train Loss: 0.617 Vali Loss: 0.709 Vali Acc: 0.809 Test Loss: 0.709 Test Acc: 0.809
Validation loss decreased (-0.799992 --> -0.809368).  Saving model ...
Epoch: 10 cost time: 1.9295094013214111
Epoch: 10, Steps: 8 | Train Loss: 0.510 Vali Loss: 0.646 Vali Acc: 0.822 Test Loss: 0.646 Test Acc: 0.822
Validation loss decreased (-0.809368 --> -0.821869).  Saving model ...
Epoch: 11 cost time: 1.917743444442749
Epoch: 11, Steps: 8 | Train Loss: 0.422 Vali Loss: 0.609 Vali Acc: 0.819 Test Loss: 0.609 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7973625659942627
Epoch: 12, Steps: 8 | Train Loss: 0.343 Vali Loss: 0.584 Vali Acc: 0.838 Test Loss: 0.584 Test Acc: 0.838
Validation loss decreased (-0.821869 --> -0.837494).  Saving model ...
Epoch: 13 cost time: 1.7902796268463135
Epoch: 13, Steps: 8 | Train Loss: 0.297 Vali Loss: 0.565 Vali Acc: 0.841 Test Loss: 0.565 Test Acc: 0.841
Validation loss decreased (-0.837494 --> -0.840619).  Saving model ...
Epoch: 14 cost time: 1.798738956451416
Epoch: 14, Steps: 8 | Train Loss: 0.249 Vali Loss: 0.558 Vali Acc: 0.844 Test Loss: 0.558 Test Acc: 0.844
Validation loss decreased (-0.840619 --> -0.843744).  Saving model ...
Epoch: 15 cost time: 1.8365161418914795
Epoch: 15, Steps: 8 | Train Loss: 0.222 Vali Loss: 0.549 Vali Acc: 0.841 Test Loss: 0.549 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9787778854370117
Epoch: 16, Steps: 8 | Train Loss: 0.184 Vali Loss: 0.546 Vali Acc: 0.844 Test Loss: 0.546 Test Acc: 0.844
Validation loss decreased (-0.843744 --> -0.843745).  Saving model ...
Epoch: 17 cost time: 1.950469970703125
Epoch: 17, Steps: 8 | Train Loss: 0.165 Vali Loss: 0.544 Vali Acc: 0.838 Test Loss: 0.544 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.906623363494873
Epoch: 18, Steps: 8 | Train Loss: 0.156 Vali Loss: 0.544 Vali Acc: 0.834 Test Loss: 0.544 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.0199623107910156
Epoch: 19, Steps: 8 | Train Loss: 0.125 Vali Loss: 0.537 Vali Acc: 0.831 Test Loss: 0.537 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.8891522884368896
Epoch: 20, Steps: 8 | Train Loss: 0.124 Vali Loss: 0.535 Vali Acc: 0.847 Test Loss: 0.535 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 21 cost time: 1.8700611591339111
Epoch: 21, Steps: 8 | Train Loss: 0.104 Vali Loss: 0.540 Vali Acc: 0.838 Test Loss: 0.540 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.082447052001953
Epoch: 22, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.558 Vali Acc: 0.828 Test Loss: 0.558 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.058589458465576
Epoch: 23, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.560 Vali Acc: 0.822 Test Loss: 0.560 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.0952279567718506
Epoch: 24, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.561 Vali Acc: 0.825 Test Loss: 0.561 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.9976811408996582
Epoch: 25, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.559 Vali Acc: 0.828 Test Loss: 0.559 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.0376811027526855
Epoch: 26, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.561 Vali Acc: 0.825 Test Loss: 0.561 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.928403377532959
Epoch: 27, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.565 Vali Acc: 0.822 Test Loss: 0.565 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.9092967510223389
Epoch: 28, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.570 Vali Acc: 0.819 Test Loss: 0.570 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.8954596519470215
Epoch: 29, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.575 Vali Acc: 0.819 Test Loss: 0.575 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.914409875869751
Epoch: 30, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.574 Vali Acc: 0.825 Test Loss: 0.574 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 167008
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.823232650756836
Epoch: 1, Steps: 8 | Train Loss: 2.043 Vali Loss: 2.007 Vali Acc: 0.200 Test Loss: 2.007 Test Acc: 0.200
Validation loss decreased (inf --> -0.199980).  Saving model ...
Epoch: 2 cost time: 1.2542064189910889
Epoch: 2, Steps: 8 | Train Loss: 1.959 Vali Loss: 1.855 Vali Acc: 0.328 Test Loss: 1.855 Test Acc: 0.328
Validation loss decreased (-0.199980 --> -0.328106).  Saving model ...
Epoch: 3 cost time: 1.3118221759796143
Epoch: 3, Steps: 8 | Train Loss: 1.773 Vali Loss: 1.658 Vali Acc: 0.522 Test Loss: 1.658 Test Acc: 0.522
Validation loss decreased (-0.328106 --> -0.521858).  Saving model ...
Epoch: 4 cost time: 1.3566398620605469
Epoch: 4, Steps: 8 | Train Loss: 1.557 Vali Loss: 1.457 Vali Acc: 0.678 Test Loss: 1.457 Test Acc: 0.678
Validation loss decreased (-0.521858 --> -0.678110).  Saving model ...
Epoch: 5 cost time: 1.3123524188995361
Epoch: 5, Steps: 8 | Train Loss: 1.357 Vali Loss: 1.267 Vali Acc: 0.719 Test Loss: 1.267 Test Acc: 0.719
Validation loss decreased (-0.678110 --> -0.718737).  Saving model ...
Epoch: 6 cost time: 1.396272897720337
Epoch: 6, Steps: 8 | Train Loss: 1.150 Vali Loss: 1.103 Vali Acc: 0.744 Test Loss: 1.103 Test Acc: 0.744
Validation loss decreased (-0.718737 --> -0.743739).  Saving model ...
Epoch: 7 cost time: 1.3791322708129883
Epoch: 7, Steps: 8 | Train Loss: 0.959 Vali Loss: 0.952 Vali Acc: 0.778 Test Loss: 0.952 Test Acc: 0.778
Validation loss decreased (-0.743739 --> -0.778115).  Saving model ...
Epoch: 8 cost time: 1.362492322921753
Epoch: 8, Steps: 8 | Train Loss: 0.810 Vali Loss: 0.848 Vali Acc: 0.800 Test Loss: 0.848 Test Acc: 0.800
Validation loss decreased (-0.778115 --> -0.799992).  Saving model ...
Epoch: 9 cost time: 1.3650858402252197
Epoch: 9, Steps: 8 | Train Loss: 0.701 Vali Loss: 0.766 Vali Acc: 0.800 Test Loss: 0.766 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 10 cost time: 1.3715183734893799
Epoch: 10, Steps: 8 | Train Loss: 0.574 Vali Loss: 0.694 Vali Acc: 0.812 Test Loss: 0.694 Test Acc: 0.812
Validation loss decreased (-0.799992 --> -0.812493).  Saving model ...
Epoch: 11 cost time: 1.2793686389923096
Epoch: 11, Steps: 8 | Train Loss: 0.508 Vali Loss: 0.646 Vali Acc: 0.825 Test Loss: 0.646 Test Acc: 0.825
Validation loss decreased (-0.812493 --> -0.824994).  Saving model ...
Epoch: 12 cost time: 1.4111719131469727
Epoch: 12, Steps: 8 | Train Loss: 0.432 Vali Loss: 0.610 Vali Acc: 0.831 Test Loss: 0.610 Test Acc: 0.831
Validation loss decreased (-0.824994 --> -0.831244).  Saving model ...
Epoch: 13 cost time: 1.411034345626831
Epoch: 13, Steps: 8 | Train Loss: 0.378 Vali Loss: 0.578 Vali Acc: 0.834 Test Loss: 0.578 Test Acc: 0.834
Validation loss decreased (-0.831244 --> -0.834369).  Saving model ...
Epoch: 14 cost time: 1.4359958171844482
Epoch: 14, Steps: 8 | Train Loss: 0.318 Vali Loss: 0.560 Vali Acc: 0.838 Test Loss: 0.560 Test Acc: 0.838
Validation loss decreased (-0.834369 --> -0.837494).  Saving model ...
Epoch: 15 cost time: 1.4299650192260742
Epoch: 15, Steps: 8 | Train Loss: 0.283 Vali Loss: 0.542 Vali Acc: 0.844 Test Loss: 0.542 Test Acc: 0.844
Validation loss decreased (-0.837494 --> -0.843745).  Saving model ...
Epoch: 16 cost time: 1.4242489337921143
Epoch: 16, Steps: 8 | Train Loss: 0.294 Vali Loss: 0.535 Vali Acc: 0.844 Test Loss: 0.535 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 17 cost time: 1.4408977031707764
Epoch: 17, Steps: 8 | Train Loss: 0.217 Vali Loss: 0.527 Vali Acc: 0.847 Test Loss: 0.527 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 18 cost time: 1.3523414134979248
Epoch: 18, Steps: 8 | Train Loss: 0.198 Vali Loss: 0.521 Vali Acc: 0.847 Test Loss: 0.521 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 19 cost time: 1.335458755493164
Epoch: 19, Steps: 8 | Train Loss: 0.188 Vali Loss: 0.522 Vali Acc: 0.844 Test Loss: 0.522 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.318718671798706
Epoch: 20, Steps: 8 | Train Loss: 0.147 Vali Loss: 0.511 Vali Acc: 0.847 Test Loss: 0.511 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 21 cost time: 1.3821392059326172
Epoch: 21, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.505 Vali Acc: 0.859 Test Loss: 0.505 Test Acc: 0.859
Validation loss decreased (-0.846870 --> -0.859370).  Saving model ...
Epoch: 22 cost time: 1.315053939819336
Epoch: 22, Steps: 8 | Train Loss: 0.116 Vali Loss: 0.512 Vali Acc: 0.859 Test Loss: 0.512 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3195312023162842
Epoch: 23, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.523 Vali Acc: 0.853 Test Loss: 0.523 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.316734790802002
Epoch: 24, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.518 Vali Acc: 0.863 Test Loss: 0.518 Test Acc: 0.863
Validation loss decreased (-0.859370 --> -0.862495).  Saving model ...
Epoch: 25 cost time: 1.3029003143310547
Epoch: 25, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.516 Vali Acc: 0.863 Test Loss: 0.516 Test Acc: 0.863
Validation loss decreased (-0.862495 --> -0.862495).  Saving model ...
Epoch: 26 cost time: 1.310490369796753
Epoch: 26, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.523 Vali Acc: 0.866 Test Loss: 0.523 Test Acc: 0.866
Validation loss decreased (-0.862495 --> -0.865620).  Saving model ...
Epoch: 27 cost time: 1.3317267894744873
Epoch: 27, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.528 Vali Acc: 0.869 Test Loss: 0.528 Test Acc: 0.869
Validation loss decreased (-0.865620 --> -0.868745).  Saving model ...
Epoch: 28 cost time: 1.2732529640197754
Epoch: 28, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.532 Vali Acc: 0.863 Test Loss: 0.532 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.3784384727478027
Epoch: 29, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.539 Vali Acc: 0.856 Test Loss: 0.539 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.3612074851989746
Epoch: 30, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.546 Vali Acc: 0.850 Test Loss: 0.546 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 63488
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.172987937927246
Epoch: 1, Steps: 8 | Train Loss: 2.138 Vali Loss: 2.038 Vali Acc: 0.203 Test Loss: 2.038 Test Acc: 0.203
Validation loss decreased (inf --> -0.203105).  Saving model ...
Epoch: 2 cost time: 1.6348016262054443
Epoch: 2, Steps: 8 | Train Loss: 2.005 Vali Loss: 1.866 Vali Acc: 0.388 Test Loss: 1.866 Test Acc: 0.388
Validation loss decreased (-0.203105 --> -0.387481).  Saving model ...
Epoch: 3 cost time: 1.6576826572418213
Epoch: 3, Steps: 8 | Train Loss: 1.762 Vali Loss: 1.651 Vali Acc: 0.628 Test Loss: 1.651 Test Acc: 0.628
Validation loss decreased (-0.387481 --> -0.628108).  Saving model ...
Epoch: 4 cost time: 1.7244455814361572
Epoch: 4, Steps: 8 | Train Loss: 1.521 Vali Loss: 1.431 Vali Acc: 0.722 Test Loss: 1.431 Test Acc: 0.722
Validation loss decreased (-0.628108 --> -0.721861).  Saving model ...
Epoch: 5 cost time: 1.846461296081543
Epoch: 5, Steps: 8 | Train Loss: 1.263 Vali Loss: 1.227 Vali Acc: 0.747 Test Loss: 1.227 Test Acc: 0.747
Validation loss decreased (-0.721861 --> -0.746863).  Saving model ...
Epoch: 6 cost time: 1.8117072582244873
Epoch: 6, Steps: 8 | Train Loss: 1.056 Vali Loss: 1.053 Vali Acc: 0.766 Test Loss: 1.053 Test Acc: 0.766
Validation loss decreased (-0.746863 --> -0.765614).  Saving model ...
Epoch: 7 cost time: 1.7254209518432617
Epoch: 7, Steps: 8 | Train Loss: 0.869 Vali Loss: 0.907 Vali Acc: 0.772 Test Loss: 0.907 Test Acc: 0.772
Validation loss decreased (-0.765614 --> -0.771866).  Saving model ...
Epoch: 8 cost time: 1.7229762077331543
Epoch: 8, Steps: 8 | Train Loss: 0.735 Vali Loss: 0.793 Vali Acc: 0.800 Test Loss: 0.793 Test Acc: 0.800
Validation loss decreased (-0.771866 --> -0.799992).  Saving model ...
Epoch: 9 cost time: 1.6142759323120117
Epoch: 9, Steps: 8 | Train Loss: 0.618 Vali Loss: 0.710 Vali Acc: 0.809 Test Loss: 0.710 Test Acc: 0.809
Validation loss decreased (-0.799992 --> -0.809368).  Saving model ...
Epoch: 10 cost time: 1.608748197555542
Epoch: 10, Steps: 8 | Train Loss: 0.510 Vali Loss: 0.647 Vali Acc: 0.822 Test Loss: 0.647 Test Acc: 0.822
Validation loss decreased (-0.809368 --> -0.821869).  Saving model ...
Epoch: 11 cost time: 1.6261413097381592
Epoch: 11, Steps: 8 | Train Loss: 0.422 Vali Loss: 0.610 Vali Acc: 0.819 Test Loss: 0.610 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.645686388015747
Epoch: 12, Steps: 8 | Train Loss: 0.343 Vali Loss: 0.585 Vali Acc: 0.838 Test Loss: 0.585 Test Acc: 0.838
Validation loss decreased (-0.821869 --> -0.837494).  Saving model ...
Epoch: 13 cost time: 1.6217749118804932
Epoch: 13, Steps: 8 | Train Loss: 0.296 Vali Loss: 0.567 Vali Acc: 0.841 Test Loss: 0.567 Test Acc: 0.841
Validation loss decreased (-0.837494 --> -0.840619).  Saving model ...
Epoch: 14 cost time: 1.6125679016113281
Epoch: 14, Steps: 8 | Train Loss: 0.249 Vali Loss: 0.560 Vali Acc: 0.844 Test Loss: 0.560 Test Acc: 0.844
Validation loss decreased (-0.840619 --> -0.843744).  Saving model ...
Epoch: 15 cost time: 1.5309844017028809
Epoch: 15, Steps: 8 | Train Loss: 0.222 Vali Loss: 0.553 Vali Acc: 0.841 Test Loss: 0.553 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.543321132659912
Epoch: 16, Steps: 8 | Train Loss: 0.184 Vali Loss: 0.550 Vali Acc: 0.847 Test Loss: 0.550 Test Acc: 0.847
Validation loss decreased (-0.843744 --> -0.846869).  Saving model ...
Epoch: 17 cost time: 1.6042194366455078
Epoch: 17, Steps: 8 | Train Loss: 0.164 Vali Loss: 0.549 Vali Acc: 0.838 Test Loss: 0.549 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5337462425231934
Epoch: 18, Steps: 8 | Train Loss: 0.156 Vali Loss: 0.550 Vali Acc: 0.841 Test Loss: 0.550 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.545952558517456
Epoch: 19, Steps: 8 | Train Loss: 0.126 Vali Loss: 0.544 Vali Acc: 0.828 Test Loss: 0.544 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.665703296661377
Epoch: 20, Steps: 8 | Train Loss: 0.124 Vali Loss: 0.542 Vali Acc: 0.844 Test Loss: 0.542 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.6996896266937256
Epoch: 21, Steps: 8 | Train Loss: 0.104 Vali Loss: 0.548 Vali Acc: 0.834 Test Loss: 0.548 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.681023359298706
Epoch: 22, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.566 Vali Acc: 0.831 Test Loss: 0.566 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.6284940242767334
Epoch: 23, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.569 Vali Acc: 0.822 Test Loss: 0.569 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.6281676292419434
Epoch: 24, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.569 Vali Acc: 0.822 Test Loss: 0.569 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.6575989723205566
Epoch: 25, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.568 Vali Acc: 0.825 Test Loss: 0.568 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.7529990673065186
Epoch: 26, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.570 Vali Acc: 0.825 Test Loss: 0.570 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 167008
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.8892149925231934
Epoch: 1, Steps: 8 | Train Loss: 2.043 Vali Loss: 2.007 Vali Acc: 0.200 Test Loss: 2.007 Test Acc: 0.200
Validation loss decreased (inf --> -0.199980).  Saving model ...
Epoch: 2 cost time: 1.3181250095367432
Epoch: 2, Steps: 8 | Train Loss: 1.959 Vali Loss: 1.855 Vali Acc: 0.328 Test Loss: 1.855 Test Acc: 0.328
Validation loss decreased (-0.199980 --> -0.328106).  Saving model ...
Epoch: 3 cost time: 1.315675973892212
Epoch: 3, Steps: 8 | Train Loss: 1.773 Vali Loss: 1.658 Vali Acc: 0.522 Test Loss: 1.658 Test Acc: 0.522
Validation loss decreased (-0.328106 --> -0.521858).  Saving model ...
Epoch: 4 cost time: 1.2471461296081543
Epoch: 4, Steps: 8 | Train Loss: 1.557 Vali Loss: 1.457 Vali Acc: 0.678 Test Loss: 1.457 Test Acc: 0.678
Validation loss decreased (-0.521858 --> -0.678110).  Saving model ...
Epoch: 5 cost time: 1.3082406520843506
Epoch: 5, Steps: 8 | Train Loss: 1.357 Vali Loss: 1.267 Vali Acc: 0.719 Test Loss: 1.267 Test Acc: 0.719
Validation loss decreased (-0.678110 --> -0.718737).  Saving model ...
Epoch: 6 cost time: 1.269463062286377
Epoch: 6, Steps: 8 | Train Loss: 1.149 Vali Loss: 1.102 Vali Acc: 0.747 Test Loss: 1.102 Test Acc: 0.747
Validation loss decreased (-0.718737 --> -0.746864).  Saving model ...
Epoch: 7 cost time: 1.2025799751281738
Epoch: 7, Steps: 8 | Train Loss: 0.958 Vali Loss: 0.952 Vali Acc: 0.781 Test Loss: 0.952 Test Acc: 0.781
Validation loss decreased (-0.746864 --> -0.781240).  Saving model ...
Epoch: 8 cost time: 1.2388708591461182
Epoch: 8, Steps: 8 | Train Loss: 0.810 Vali Loss: 0.848 Vali Acc: 0.800 Test Loss: 0.848 Test Acc: 0.800
Validation loss decreased (-0.781240 --> -0.799992).  Saving model ...
Epoch: 9 cost time: 1.1219558715820312
Epoch: 9, Steps: 8 | Train Loss: 0.701 Vali Loss: 0.766 Vali Acc: 0.800 Test Loss: 0.766 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 10 cost time: 1.2422924041748047
Epoch: 10, Steps: 8 | Train Loss: 0.573 Vali Loss: 0.694 Vali Acc: 0.816 Test Loss: 0.694 Test Acc: 0.816
Validation loss decreased (-0.799992 --> -0.815618).  Saving model ...
Epoch: 11 cost time: 1.2319741249084473
Epoch: 11, Steps: 8 | Train Loss: 0.508 Vali Loss: 0.646 Vali Acc: 0.825 Test Loss: 0.646 Test Acc: 0.825
Validation loss decreased (-0.815618 --> -0.824994).  Saving model ...
Epoch: 12 cost time: 1.2083983421325684
Epoch: 12, Steps: 8 | Train Loss: 0.431 Vali Loss: 0.610 Vali Acc: 0.834 Test Loss: 0.610 Test Acc: 0.834
Validation loss decreased (-0.824994 --> -0.834369).  Saving model ...
Epoch: 13 cost time: 1.1622047424316406
Epoch: 13, Steps: 8 | Train Loss: 0.378 Vali Loss: 0.578 Vali Acc: 0.834 Test Loss: 0.578 Test Acc: 0.834
Validation loss decreased (-0.834369 --> -0.834369).  Saving model ...
Epoch: 14 cost time: 1.221863031387329
Epoch: 14, Steps: 8 | Train Loss: 0.318 Vali Loss: 0.560 Vali Acc: 0.838 Test Loss: 0.560 Test Acc: 0.838
Validation loss decreased (-0.834369 --> -0.837494).  Saving model ...
Epoch: 15 cost time: 1.2085931301116943
Epoch: 15, Steps: 8 | Train Loss: 0.283 Vali Loss: 0.542 Vali Acc: 0.841 Test Loss: 0.542 Test Acc: 0.841
Validation loss decreased (-0.837494 --> -0.840620).  Saving model ...
Epoch: 16 cost time: 1.234755516052246
Epoch: 16, Steps: 8 | Train Loss: 0.293 Vali Loss: 0.536 Vali Acc: 0.844 Test Loss: 0.536 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 17 cost time: 1.2406082153320312
Epoch: 17, Steps: 8 | Train Loss: 0.217 Vali Loss: 0.527 Vali Acc: 0.847 Test Loss: 0.527 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 18 cost time: 1.228135108947754
Epoch: 18, Steps: 8 | Train Loss: 0.198 Vali Loss: 0.521 Vali Acc: 0.847 Test Loss: 0.521 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 19 cost time: 1.2253437042236328
Epoch: 19, Steps: 8 | Train Loss: 0.188 Vali Loss: 0.522 Vali Acc: 0.841 Test Loss: 0.522 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1933965682983398
Epoch: 20, Steps: 8 | Train Loss: 0.147 Vali Loss: 0.512 Vali Acc: 0.847 Test Loss: 0.512 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 21 cost time: 1.026508092880249
Epoch: 21, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.506 Vali Acc: 0.856 Test Loss: 0.506 Test Acc: 0.856
Validation loss decreased (-0.846870 --> -0.856245).  Saving model ...
Epoch: 22 cost time: 1.0470106601715088
Epoch: 22, Steps: 8 | Train Loss: 0.116 Vali Loss: 0.513 Vali Acc: 0.859 Test Loss: 0.513 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 23 cost time: 1.087477684020996
Epoch: 23, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.524 Vali Acc: 0.853 Test Loss: 0.524 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2659752368927002
Epoch: 24, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.519 Vali Acc: 0.863 Test Loss: 0.519 Test Acc: 0.863
Validation loss decreased (-0.859370 --> -0.862495).  Saving model ...
Epoch: 25 cost time: 1.2949230670928955
Epoch: 25, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.517 Vali Acc: 0.863 Test Loss: 0.517 Test Acc: 0.863
Validation loss decreased (-0.862495 --> -0.862495).  Saving model ...
Epoch: 26 cost time: 1.2938873767852783
Epoch: 26, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.523 Vali Acc: 0.866 Test Loss: 0.523 Test Acc: 0.866
Validation loss decreased (-0.862495 --> -0.865620).  Saving model ...
Epoch: 27 cost time: 1.2871277332305908
Epoch: 27, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.529 Vali Acc: 0.869 Test Loss: 0.529 Test Acc: 0.869
Validation loss decreased (-0.865620 --> -0.868745).  Saving model ...
Epoch: 28 cost time: 1.2839293479919434
Epoch: 28, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.533 Vali Acc: 0.863 Test Loss: 0.533 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2886958122253418
Epoch: 29, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.540 Vali Acc: 0.856 Test Loss: 0.540 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.2313883304595947
Epoch: 30, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.547 Vali Acc: 0.850 Test Loss: 0.547 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 63488
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.5921707153320312
Epoch: 1, Steps: 8 | Train Loss: 2.140 Vali Loss: 2.040 Vali Acc: 0.203 Test Loss: 2.040 Test Acc: 0.203
Validation loss decreased (inf --> -0.203105).  Saving model ...
Epoch: 2 cost time: 1.2049305438995361
Epoch: 2, Steps: 8 | Train Loss: 2.007 Vali Loss: 1.869 Vali Acc: 0.384 Test Loss: 1.869 Test Acc: 0.384
Validation loss decreased (-0.203105 --> -0.384356).  Saving model ...
Epoch: 3 cost time: 1.1642177104949951
Epoch: 3, Steps: 8 | Train Loss: 1.765 Vali Loss: 1.655 Vali Acc: 0.628 Test Loss: 1.655 Test Acc: 0.628
Validation loss decreased (-0.384356 --> -0.628108).  Saving model ...
Epoch: 4 cost time: 1.2470331192016602
Epoch: 4, Steps: 8 | Train Loss: 1.525 Vali Loss: 1.436 Vali Acc: 0.722 Test Loss: 1.436 Test Acc: 0.722
Validation loss decreased (-0.628108 --> -0.721861).  Saving model ...
Epoch: 5 cost time: 1.1853814125061035
Epoch: 5, Steps: 8 | Train Loss: 1.269 Vali Loss: 1.233 Vali Acc: 0.753 Test Loss: 1.233 Test Acc: 0.753
Validation loss decreased (-0.721861 --> -0.753113).  Saving model ...
Epoch: 6 cost time: 1.2618927955627441
Epoch: 6, Steps: 8 | Train Loss: 1.063 Vali Loss: 1.060 Vali Acc: 0.766 Test Loss: 1.060 Test Acc: 0.766
Validation loss decreased (-0.753113 --> -0.765614).  Saving model ...
Epoch: 7 cost time: 1.2851228713989258
Epoch: 7, Steps: 8 | Train Loss: 0.877 Vali Loss: 0.916 Vali Acc: 0.772 Test Loss: 0.916 Test Acc: 0.772
Validation loss decreased (-0.765614 --> -0.771866).  Saving model ...
Epoch: 8 cost time: 1.2733023166656494
Epoch: 8, Steps: 8 | Train Loss: 0.746 Vali Loss: 0.803 Vali Acc: 0.797 Test Loss: 0.803 Test Acc: 0.797
Validation loss decreased (-0.771866 --> -0.796867).  Saving model ...
Epoch: 9 cost time: 1.264674425125122
Epoch: 9, Steps: 8 | Train Loss: 0.632 Vali Loss: 0.723 Vali Acc: 0.803 Test Loss: 0.723 Test Acc: 0.803
Validation loss decreased (-0.796867 --> -0.803118).  Saving model ...
Epoch: 10 cost time: 1.1586599349975586
Epoch: 10, Steps: 8 | Train Loss: 0.533 Vali Loss: 0.662 Vali Acc: 0.812 Test Loss: 0.662 Test Acc: 0.812
Validation loss decreased (-0.803118 --> -0.812493).  Saving model ...
Epoch: 11 cost time: 1.0971989631652832
Epoch: 11, Steps: 8 | Train Loss: 0.443 Vali Loss: 0.627 Vali Acc: 0.806 Test Loss: 0.627 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.188965082168579
Epoch: 12, Steps: 8 | Train Loss: 0.365 Vali Loss: 0.603 Vali Acc: 0.825 Test Loss: 0.603 Test Acc: 0.825
Validation loss decreased (-0.812493 --> -0.824994).  Saving model ...
Epoch: 13 cost time: 1.1832847595214844
Epoch: 13, Steps: 8 | Train Loss: 0.317 Vali Loss: 0.585 Vali Acc: 0.831 Test Loss: 0.585 Test Acc: 0.831
Validation loss decreased (-0.824994 --> -0.831244).  Saving model ...
Epoch: 14 cost time: 1.1761393547058105
Epoch: 14, Steps: 8 | Train Loss: 0.276 Vali Loss: 0.579 Vali Acc: 0.831 Test Loss: 0.579 Test Acc: 0.831
Validation loss decreased (-0.831244 --> -0.831244).  Saving model ...
Epoch: 15 cost time: 1.2310597896575928
Epoch: 15, Steps: 8 | Train Loss: 0.247 Vali Loss: 0.571 Vali Acc: 0.831 Test Loss: 0.571 Test Acc: 0.831
Validation loss decreased (-0.831244 --> -0.831244).  Saving model ...
Epoch: 16 cost time: 1.237079381942749
Epoch: 16, Steps: 8 | Train Loss: 0.208 Vali Loss: 0.568 Vali Acc: 0.831 Test Loss: 0.568 Test Acc: 0.831
Validation loss decreased (-0.831244 --> -0.831244).  Saving model ...
Epoch: 17 cost time: 1.3151252269744873
Epoch: 17, Steps: 8 | Train Loss: 0.184 Vali Loss: 0.566 Vali Acc: 0.828 Test Loss: 0.566 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3454170227050781
Epoch: 18, Steps: 8 | Train Loss: 0.177 Vali Loss: 0.569 Vali Acc: 0.831 Test Loss: 0.569 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3568999767303467
Epoch: 19, Steps: 8 | Train Loss: 0.140 Vali Loss: 0.562 Vali Acc: 0.828 Test Loss: 0.562 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.33323073387146
Epoch: 20, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.558 Vali Acc: 0.834 Test Loss: 0.558 Test Acc: 0.834
Validation loss decreased (-0.831244 --> -0.834369).  Saving model ...
Epoch: 21 cost time: 1.34554123878479
Epoch: 21, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.566 Vali Acc: 0.838 Test Loss: 0.566 Test Acc: 0.838
Validation loss decreased (-0.834369 --> -0.837494).  Saving model ...
Epoch: 22 cost time: 1.3872199058532715
Epoch: 22, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.582 Vali Acc: 0.822 Test Loss: 0.582 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2215304374694824
Epoch: 23, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.581 Vali Acc: 0.828 Test Loss: 0.581 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.2025299072265625
Epoch: 24, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.580 Vali Acc: 0.838 Test Loss: 0.580 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.2411561012268066
Epoch: 25, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.579 Vali Acc: 0.834 Test Loss: 0.579 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.211979627609253
Epoch: 26, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.586 Vali Acc: 0.831 Test Loss: 0.586 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.2315995693206787
Epoch: 27, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.593 Vali Acc: 0.831 Test Loss: 0.593 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.1373918056488037
Epoch: 28, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.596 Vali Acc: 0.825 Test Loss: 0.596 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.1581406593322754
Epoch: 29, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.600 Vali Acc: 0.831 Test Loss: 0.600 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.0502159595489502
Epoch: 30, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.599 Vali Acc: 0.834 Test Loss: 0.599 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8375
model parameter : 167008
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.369504451751709
Epoch: 1, Steps: 8 | Train Loss: 2.045 Vali Loss: 2.007 Vali Acc: 0.200 Test Loss: 2.007 Test Acc: 0.200
Validation loss decreased (inf --> -0.199980).  Saving model ...
Epoch: 2 cost time: 0.9995326995849609
Epoch: 2, Steps: 8 | Train Loss: 1.960 Vali Loss: 1.856 Vali Acc: 0.331 Test Loss: 1.856 Test Acc: 0.331
Validation loss decreased (-0.199980 --> -0.331231).  Saving model ...
Epoch: 3 cost time: 0.9707038402557373
Epoch: 3, Steps: 8 | Train Loss: 1.776 Vali Loss: 1.659 Vali Acc: 0.537 Test Loss: 1.659 Test Acc: 0.537
Validation loss decreased (-0.331231 --> -0.537483).  Saving model ...
Epoch: 4 cost time: 0.9625098705291748
Epoch: 4, Steps: 8 | Train Loss: 1.558 Vali Loss: 1.459 Vali Acc: 0.669 Test Loss: 1.459 Test Acc: 0.669
Validation loss decreased (-0.537483 --> -0.668735).  Saving model ...
Epoch: 5 cost time: 0.8831074237823486
Epoch: 5, Steps: 8 | Train Loss: 1.359 Vali Loss: 1.270 Vali Acc: 0.719 Test Loss: 1.270 Test Acc: 0.719
Validation loss decreased (-0.668735 --> -0.718737).  Saving model ...
Epoch: 6 cost time: 0.8954071998596191
Epoch: 6, Steps: 8 | Train Loss: 1.150 Vali Loss: 1.107 Vali Acc: 0.753 Test Loss: 1.107 Test Acc: 0.753
Validation loss decreased (-0.718737 --> -0.753114).  Saving model ...
Epoch: 7 cost time: 0.9325807094573975
Epoch: 7, Steps: 8 | Train Loss: 0.965 Vali Loss: 0.958 Vali Acc: 0.784 Test Loss: 0.958 Test Acc: 0.784
Validation loss decreased (-0.753114 --> -0.784365).  Saving model ...
Epoch: 8 cost time: 0.9884195327758789
Epoch: 8, Steps: 8 | Train Loss: 0.816 Vali Loss: 0.856 Vali Acc: 0.794 Test Loss: 0.856 Test Acc: 0.794
Validation loss decreased (-0.784365 --> -0.793741).  Saving model ...
Epoch: 9 cost time: 0.976294755935669
Epoch: 9, Steps: 8 | Train Loss: 0.710 Vali Loss: 0.776 Vali Acc: 0.797 Test Loss: 0.776 Test Acc: 0.797
Validation loss decreased (-0.793741 --> -0.796867).  Saving model ...
Epoch: 10 cost time: 0.976978063583374
Epoch: 10, Steps: 8 | Train Loss: 0.587 Vali Loss: 0.706 Vali Acc: 0.812 Test Loss: 0.706 Test Acc: 0.812
Validation loss decreased (-0.796867 --> -0.812493).  Saving model ...
Epoch: 11 cost time: 0.9371521472930908
Epoch: 11, Steps: 8 | Train Loss: 0.520 Vali Loss: 0.660 Vali Acc: 0.822 Test Loss: 0.660 Test Acc: 0.822
Validation loss decreased (-0.812493 --> -0.821868).  Saving model ...
Epoch: 12 cost time: 1.0808191299438477
Epoch: 12, Steps: 8 | Train Loss: 0.445 Vali Loss: 0.626 Vali Acc: 0.822 Test Loss: 0.626 Test Acc: 0.822
Validation loss decreased (-0.821868 --> -0.821869).  Saving model ...
Epoch: 13 cost time: 1.0188593864440918
Epoch: 13, Steps: 8 | Train Loss: 0.396 Vali Loss: 0.597 Vali Acc: 0.828 Test Loss: 0.597 Test Acc: 0.828
Validation loss decreased (-0.821869 --> -0.828119).  Saving model ...
Epoch: 14 cost time: 1.0434386730194092
Epoch: 14, Steps: 8 | Train Loss: 0.336 Vali Loss: 0.583 Vali Acc: 0.834 Test Loss: 0.583 Test Acc: 0.834
Validation loss decreased (-0.828119 --> -0.834369).  Saving model ...
Epoch: 15 cost time: 1.0485115051269531
Epoch: 15, Steps: 8 | Train Loss: 0.300 Vali Loss: 0.568 Vali Acc: 0.828 Test Loss: 0.568 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0668067932128906
Epoch: 16, Steps: 8 | Train Loss: 0.314 Vali Loss: 0.565 Vali Acc: 0.838 Test Loss: 0.565 Test Acc: 0.838
Validation loss decreased (-0.834369 --> -0.837494).  Saving model ...
Epoch: 17 cost time: 1.0501484870910645
Epoch: 17, Steps: 8 | Train Loss: 0.233 Vali Loss: 0.561 Vali Acc: 0.838 Test Loss: 0.561 Test Acc: 0.838
Validation loss decreased (-0.837494 --> -0.837494).  Saving model ...
Epoch: 18 cost time: 1.0266854763031006
Epoch: 18, Steps: 8 | Train Loss: 0.214 Vali Loss: 0.559 Vali Acc: 0.841 Test Loss: 0.559 Test Acc: 0.841
Validation loss decreased (-0.837494 --> -0.840619).  Saving model ...
Epoch: 19 cost time: 0.9841618537902832
Epoch: 19, Steps: 8 | Train Loss: 0.202 Vali Loss: 0.562 Vali Acc: 0.831 Test Loss: 0.562 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9659819602966309
Epoch: 20, Steps: 8 | Train Loss: 0.160 Vali Loss: 0.553 Vali Acc: 0.834 Test Loss: 0.553 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9581117630004883
Epoch: 21, Steps: 8 | Train Loss: 0.142 Vali Loss: 0.547 Vali Acc: 0.847 Test Loss: 0.547 Test Acc: 0.847
Validation loss decreased (-0.840619 --> -0.846870).  Saving model ...
Epoch: 22 cost time: 0.9641821384429932
Epoch: 22, Steps: 8 | Train Loss: 0.128 Vali Loss: 0.554 Vali Acc: 0.838 Test Loss: 0.554 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9272036552429199
Epoch: 23, Steps: 8 | Train Loss: 0.125 Vali Loss: 0.566 Vali Acc: 0.838 Test Loss: 0.566 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9164791107177734
Epoch: 24, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.563 Vali Acc: 0.841 Test Loss: 0.563 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9219191074371338
Epoch: 25, Steps: 8 | Train Loss: 0.096 Vali Loss: 0.562 Vali Acc: 0.844 Test Loss: 0.562 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.8255844116210938
Epoch: 26, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.570 Vali Acc: 0.841 Test Loss: 0.570 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.9695451259613037
Epoch: 27, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.578 Vali Acc: 0.838 Test Loss: 0.578 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.9950201511383057
Epoch: 28, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.582 Vali Acc: 0.838 Test Loss: 0.582 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.9641780853271484
Epoch: 29, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.588 Vali Acc: 0.844 Test Loss: 0.588 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.008230209350586
Epoch: 30, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.594 Vali Acc: 0.844 Test Loss: 0.594 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_TimesNet_UEA_ftM_sl315_ll0_pl0_el2_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 63488
model size : 0.41MB
