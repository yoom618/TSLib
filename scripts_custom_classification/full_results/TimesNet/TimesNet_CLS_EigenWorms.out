Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 637.3064422607422
Epoch: 1, Steps: 32 | Train Loss: 12.372 Vali Loss: 16.198 Vali Acc: 0.191 Test Loss: 16.198 Test Acc: 0.191
Validation loss decreased (inf --> -0.190678).  Saving model ...
Epoch: 2 cost time: 635.0386147499084
Epoch: 2, Steps: 32 | Train Loss: 11.332 Vali Loss: 58.250 Vali Acc: 0.206 Test Loss: 58.250 Test Acc: 0.206
Validation loss decreased (-0.190678 --> -0.205524).  Saving model ...
Epoch: 3 cost time: 635.3208999633789
Epoch: 3, Steps: 32 | Train Loss: 18.109 Vali Loss: 77.917 Vali Acc: 0.237 Test Loss: 77.917 Test Acc: 0.237
Validation loss decreased (-0.205524 --> -0.235862).  Saving model ...
Epoch: 4 cost time: 632.2605323791504
Epoch: 4, Steps: 32 | Train Loss: 17.483 Vali Loss: 67.940 Vali Acc: 0.328 Test Loss: 67.940 Test Acc: 0.328
Validation loss decreased (-0.235862 --> -0.327565).  Saving model ...
Epoch: 5 cost time: 632.8935296535492
Epoch: 5, Steps: 32 | Train Loss: 25.679 Vali Loss: 73.487 Vali Acc: 0.443 Test Loss: 73.487 Test Acc: 0.443
Validation loss decreased (-0.327565 --> -0.442013).  Saving model ...
Epoch: 6 cost time: 636.2161889076233
Epoch: 6, Steps: 32 | Train Loss: 22.850 Vali Loss: 82.510 Vali Acc: 0.496 Test Loss: 82.510 Test Acc: 0.496
Validation loss decreased (-0.442013 --> -0.495358).  Saving model ...
Epoch: 7 cost time: 632.2655258178711
Epoch: 7, Steps: 32 | Train Loss: 16.669 Vali Loss: 110.533 Vali Acc: 0.504 Test Loss: 110.533 Test Acc: 0.504
Validation loss decreased (-0.495358 --> -0.502711).  Saving model ...
Epoch: 8 cost time: 634.6360218524933
Epoch: 8, Steps: 32 | Train Loss: 22.055 Vali Loss: 114.126 Vali Acc: 0.275 Test Loss: 114.126 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 632.2142822742462
Epoch: 9, Steps: 32 | Train Loss: 12.087 Vali Loss: 116.970 Vali Acc: 0.443 Test Loss: 116.970 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 637.2105004787445
Epoch: 10, Steps: 32 | Train Loss: 19.995 Vali Loss: 153.664 Vali Acc: 0.496 Test Loss: 153.664 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 632.3389220237732
Epoch: 11, Steps: 32 | Train Loss: 21.991 Vali Loss: 147.535 Vali Acc: 0.321 Test Loss: 147.535 Test Acc: 0.321
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 634.3921558856964
Epoch: 12, Steps: 32 | Train Loss: 21.147 Vali Loss: 155.833 Vali Acc: 0.344 Test Loss: 155.833 Test Acc: 0.344
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 627.5203242301941
Epoch: 13, Steps: 32 | Train Loss: 9.403 Vali Loss: 221.617 Vali Acc: 0.221 Test Loss: 221.617 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 622.5380764007568
Epoch: 14, Steps: 32 | Train Loss: 20.573 Vali Loss: 174.197 Vali Acc: 0.466 Test Loss: 174.197 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 623.0221748352051
Epoch: 15, Steps: 32 | Train Loss: 27.468 Vali Loss: 129.136 Vali Acc: 0.450 Test Loss: 129.136 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 626.9552338123322
Epoch: 16, Steps: 32 | Train Loss: 8.789 Vali Loss: 188.073 Vali Acc: 0.405 Test Loss: 188.073 Test Acc: 0.405
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 620.0897386074066
Epoch: 17, Steps: 32 | Train Loss: 7.129 Vali Loss: 149.747 Vali Acc: 0.443 Test Loss: 149.747 Test Acc: 0.443
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5038167938931297
model parameter : 86495237
model size : 338.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 206.82167196273804
Epoch: 1, Steps: 32 | Train Loss: 9.053 Vali Loss: 15.026 Vali Acc: 0.221 Test Loss: 15.026 Test Acc: 0.221
Validation loss decreased (inf --> -0.221224).  Saving model ...
Epoch: 2 cost time: 205.2980601787567
Epoch: 2, Steps: 32 | Train Loss: 14.945 Vali Loss: 23.038 Vali Acc: 0.527 Test Loss: 23.038 Test Acc: 0.527
Validation loss decreased (-0.221224 --> -0.526487).  Saving model ...
Epoch: 3 cost time: 203.47156691551208
Epoch: 3, Steps: 32 | Train Loss: 11.961 Vali Loss: 87.773 Vali Acc: 0.466 Test Loss: 87.773 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 202.47701287269592
Epoch: 4, Steps: 32 | Train Loss: 13.068 Vali Loss: 41.131 Vali Acc: 0.504 Test Loss: 41.131 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 202.9951295852661
Epoch: 5, Steps: 32 | Train Loss: 9.483 Vali Loss: 81.879 Vali Acc: 0.527 Test Loss: 81.879 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 203.31778192520142
Epoch: 6, Steps: 32 | Train Loss: 17.464 Vali Loss: 81.237 Vali Acc: 0.275 Test Loss: 81.237 Test Acc: 0.275
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 203.24806928634644
Epoch: 7, Steps: 32 | Train Loss: 11.037 Vali Loss: 112.420 Vali Acc: 0.466 Test Loss: 112.420 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 204.16996693611145
Epoch: 8, Steps: 32 | Train Loss: 11.088 Vali Loss: 94.035 Vali Acc: 0.336 Test Loss: 94.035 Test Acc: 0.336
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 202.90953421592712
Epoch: 9, Steps: 32 | Train Loss: 7.538 Vali Loss: 92.130 Vali Acc: 0.328 Test Loss: 92.130 Test Acc: 0.328
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 201.88029265403748
Epoch: 10, Steps: 32 | Train Loss: 21.750 Vali Loss: 177.421 Vali Acc: 0.260 Test Loss: 177.421 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 202.51373624801636
Epoch: 11, Steps: 32 | Train Loss: 4.703 Vali Loss: 98.789 Vali Acc: 0.389 Test Loss: 98.789 Test Acc: 0.389
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 203.04835677146912
Epoch: 12, Steps: 32 | Train Loss: 2.241 Vali Loss: 163.892 Vali Acc: 0.527 Test Loss: 163.892 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 33539077
model size : 136.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 427.59661054611206
Epoch: 1, Steps: 32 | Train Loss: 12.568 Vali Loss: 9.397 Vali Acc: 0.389 Test Loss: 9.397 Test Acc: 0.389
Validation loss decreased (inf --> -0.389219).  Saving model ...
Epoch: 2 cost time: 426.0536377429962
Epoch: 2, Steps: 32 | Train Loss: 10.474 Vali Loss: 26.969 Vali Acc: 0.275 Test Loss: 26.969 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 430.46037125587463
Epoch: 3, Steps: 32 | Train Loss: 11.814 Vali Loss: 26.223 Vali Acc: 0.405 Test Loss: 26.223 Test Acc: 0.405
Validation loss decreased (-0.389219 --> -0.404318).  Saving model ...
Epoch: 4 cost time: 430.27874088287354
Epoch: 4, Steps: 32 | Train Loss: 6.450 Vali Loss: 67.063 Vali Acc: 0.191 Test Loss: 67.063 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 432.40172839164734
Epoch: 5, Steps: 32 | Train Loss: 10.360 Vali Loss: 65.914 Vali Acc: 0.359 Test Loss: 65.914 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 427.7823700904846
Epoch: 6, Steps: 32 | Train Loss: 11.389 Vali Loss: 73.392 Vali Acc: 0.473 Test Loss: 73.392 Test Acc: 0.473
Validation loss decreased (-0.404318 --> -0.472549).  Saving model ...
Epoch: 7 cost time: 427.7702989578247
Epoch: 7, Steps: 32 | Train Loss: 10.682 Vali Loss: 76.455 Vali Acc: 0.466 Test Loss: 76.455 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 428.2441921234131
Epoch: 8, Steps: 32 | Train Loss: 29.775 Vali Loss: 130.164 Vali Acc: 0.420 Test Loss: 130.164 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 425.6790111064911
Epoch: 9, Steps: 32 | Train Loss: 31.722 Vali Loss: 213.536 Vali Acc: 0.473 Test Loss: 213.536 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 428.3858370780945
Epoch: 10, Steps: 32 | Train Loss: 24.979 Vali Loss: 183.252 Vali Acc: 0.305 Test Loss: 183.252 Test Acc: 0.305
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 431.29286217689514
Epoch: 11, Steps: 32 | Train Loss: 21.418 Vali Loss: 99.913 Vali Acc: 0.504 Test Loss: 99.913 Test Acc: 0.504
Validation loss decreased (-0.472549 --> -0.502818).  Saving model ...
Epoch: 12 cost time: 430.118745803833
Epoch: 12, Steps: 32 | Train Loss: 30.813 Vali Loss: 210.192 Vali Acc: 0.229 Test Loss: 210.192 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 430.42854619026184
Epoch: 13, Steps: 32 | Train Loss: 25.640 Vali Loss: 169.874 Vali Acc: 0.481 Test Loss: 169.874 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 433.29731583595276
Epoch: 14, Steps: 32 | Train Loss: 44.309 Vali Loss: 136.159 Vali Acc: 0.473 Test Loss: 136.159 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 428.2142333984375
Epoch: 15, Steps: 32 | Train Loss: 30.282 Vali Loss: 311.632 Vali Acc: 0.473 Test Loss: 311.632 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 430.9857199192047
Epoch: 16, Steps: 32 | Train Loss: 24.734 Vali Loss: 289.512 Vali Acc: 0.176 Test Loss: 289.512 Test Acc: 0.176
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 428.7666721343994
Epoch: 17, Steps: 32 | Train Loss: 24.513 Vali Loss: 214.993 Vali Acc: 0.252 Test Loss: 214.993 Test Acc: 0.252
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 432.5854251384735
Epoch: 18, Steps: 32 | Train Loss: 17.270 Vali Loss: 173.677 Vali Acc: 0.458 Test Loss: 173.677 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 435.8680531978607
Epoch: 19, Steps: 32 | Train Loss: 9.881 Vali Loss: 276.661 Vali Acc: 0.229 Test Loss: 276.661 Test Acc: 0.229
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 435.5474157333374
Epoch: 20, Steps: 32 | Train Loss: 53.581 Vali Loss: 241.272 Vali Acc: 0.359 Test Loss: 241.272 Test Acc: 0.359
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 436.4335238933563
Epoch: 21, Steps: 32 | Train Loss: 35.313 Vali Loss: 246.142 Vali Acc: 0.458 Test Loss: 246.142 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5038167938931297
model parameter : 86495237
model size : 338.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 145.9774513244629
Epoch: 1, Steps: 32 | Train Loss: 8.815 Vali Loss: 12.631 Vali Acc: 0.252 Test Loss: 12.631 Test Acc: 0.252
Validation loss decreased (inf --> -0.251782).  Saving model ...
Epoch: 2 cost time: 144.29096722602844
Epoch: 2, Steps: 32 | Train Loss: 12.612 Vali Loss: 17.652 Vali Acc: 0.534 Test Loss: 17.652 Test Acc: 0.534
Validation loss decreased (-0.251782 --> -0.534175).  Saving model ...
Epoch: 3 cost time: 144.55678915977478
Epoch: 3, Steps: 32 | Train Loss: 16.448 Vali Loss: 42.845 Vali Acc: 0.504 Test Loss: 42.845 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 143.77365517616272
Epoch: 4, Steps: 32 | Train Loss: 12.828 Vali Loss: 54.021 Vali Acc: 0.344 Test Loss: 54.021 Test Acc: 0.344
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 143.0630452632904
Epoch: 5, Steps: 32 | Train Loss: 17.750 Vali Loss: 49.879 Vali Acc: 0.496 Test Loss: 49.879 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 144.16400909423828
Epoch: 6, Steps: 32 | Train Loss: 9.608 Vali Loss: 109.024 Vali Acc: 0.496 Test Loss: 109.024 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 142.94929337501526
Epoch: 7, Steps: 32 | Train Loss: 14.878 Vali Loss: 93.695 Vali Acc: 0.313 Test Loss: 93.695 Test Acc: 0.313
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 144.21693181991577
Epoch: 8, Steps: 32 | Train Loss: 7.670 Vali Loss: 70.443 Vali Acc: 0.405 Test Loss: 70.443 Test Acc: 0.405
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 143.56555247306824
Epoch: 9, Steps: 32 | Train Loss: 6.543 Vali Loss: 135.446 Vali Acc: 0.534 Test Loss: 135.446 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 143.78569173812866
Epoch: 10, Steps: 32 | Train Loss: 7.272 Vali Loss: 92.985 Vali Acc: 0.344 Test Loss: 92.985 Test Acc: 0.344
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 143.93794560432434
Epoch: 11, Steps: 32 | Train Loss: 14.299 Vali Loss: 95.895 Vali Acc: 0.450 Test Loss: 95.895 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 143.92250657081604
Epoch: 12, Steps: 32 | Train Loss: 9.684 Vali Loss: 119.107 Vali Acc: 0.550 Test Loss: 119.107 Test Acc: 0.550
Validation loss decreased (-0.534175 --> -0.548427).  Saving model ...
Epoch: 13 cost time: 144.06186270713806
Epoch: 13, Steps: 32 | Train Loss: 7.279 Vali Loss: 254.785 Vali Acc: 0.450 Test Loss: 254.785 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 143.36326599121094
Epoch: 14, Steps: 32 | Train Loss: 14.682 Vali Loss: 133.552 Vali Acc: 0.427 Test Loss: 133.552 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 143.82347178459167
Epoch: 15, Steps: 32 | Train Loss: 13.885 Vali Loss: 206.945 Vali Acc: 0.466 Test Loss: 206.945 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 144.74215722084045
Epoch: 16, Steps: 32 | Train Loss: 10.301 Vali Loss: 234.135 Vali Acc: 0.260 Test Loss: 234.135 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 144.2939383983612
Epoch: 17, Steps: 32 | Train Loss: 23.927 Vali Loss: 161.812 Vali Acc: 0.489 Test Loss: 161.812 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 143.92305040359497
Epoch: 18, Steps: 32 | Train Loss: 15.643 Vali Loss: 184.517 Vali Acc: 0.550 Test Loss: 184.517 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 143.30221128463745
Epoch: 19, Steps: 32 | Train Loss: 16.406 Vali Loss: 163.524 Vali Acc: 0.420 Test Loss: 163.524 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 143.68842220306396
Epoch: 20, Steps: 32 | Train Loss: 10.091 Vali Loss: 172.731 Vali Acc: 0.382 Test Loss: 172.731 Test Acc: 0.382
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 142.9973509311676
Epoch: 21, Steps: 32 | Train Loss: 35.987 Vali Loss: 277.307 Vali Acc: 0.489 Test Loss: 277.307 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 144.96082854270935
Epoch: 22, Steps: 32 | Train Loss: 10.721 Vali Loss: 271.699 Vali Acc: 0.496 Test Loss: 271.699 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 33539077
model size : 136.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 251.5925807952881
Epoch: 1, Steps: 32 | Train Loss: 12.790 Vali Loss: 13.695 Vali Acc: 0.252 Test Loss: 13.695 Test Acc: 0.252
Validation loss decreased (inf --> -0.251771).  Saving model ...
Epoch: 2 cost time: 249.81088829040527
Epoch: 2, Steps: 32 | Train Loss: 6.794 Vali Loss: 22.148 Vali Acc: 0.527 Test Loss: 22.148 Test Acc: 0.527
Validation loss decreased (-0.251771 --> -0.526496).  Saving model ...
Epoch: 3 cost time: 248.4835307598114
Epoch: 3, Steps: 32 | Train Loss: 14.917 Vali Loss: 40.213 Vali Acc: 0.275 Test Loss: 40.213 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 248.605473279953
Epoch: 4, Steps: 32 | Train Loss: 21.198 Vali Loss: 61.316 Vali Acc: 0.321 Test Loss: 61.316 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 247.46095395088196
Epoch: 5, Steps: 32 | Train Loss: 13.305 Vali Loss: 79.154 Vali Acc: 0.252 Test Loss: 79.154 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 247.57720065116882
Epoch: 6, Steps: 32 | Train Loss: 11.117 Vali Loss: 98.746 Vali Acc: 0.244 Test Loss: 98.746 Test Acc: 0.244
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 247.73171257972717
Epoch: 7, Steps: 32 | Train Loss: 14.792 Vali Loss: 106.395 Vali Acc: 0.519 Test Loss: 106.395 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 246.66474795341492
Epoch: 8, Steps: 32 | Train Loss: 8.787 Vali Loss: 126.537 Vali Acc: 0.481 Test Loss: 126.537 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 246.86342787742615
Epoch: 9, Steps: 32 | Train Loss: 8.057 Vali Loss: 60.355 Vali Acc: 0.450 Test Loss: 60.355 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 246.8190324306488
Epoch: 10, Steps: 32 | Train Loss: 3.310 Vali Loss: 131.181 Vali Acc: 0.412 Test Loss: 131.181 Test Acc: 0.412
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 246.66734671592712
Epoch: 11, Steps: 32 | Train Loss: 8.142 Vali Loss: 87.416 Vali Acc: 0.351 Test Loss: 87.416 Test Acc: 0.351
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 246.66302728652954
Epoch: 12, Steps: 32 | Train Loss: 8.532 Vali Loss: 153.371 Vali Acc: 0.443 Test Loss: 153.371 Test Acc: 0.443
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 86495237
model size : 338.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 78.84660291671753
Epoch: 1, Steps: 32 | Train Loss: 10.423 Vali Loss: 37.509 Vali Acc: 0.137 Test Loss: 37.509 Test Acc: 0.137
Validation loss decreased (inf --> -0.137029).  Saving model ...
Epoch: 2 cost time: 77.64601945877075
Epoch: 2, Steps: 32 | Train Loss: 10.211 Vali Loss: 26.644 Vali Acc: 0.313 Test Loss: 26.644 Test Acc: 0.313
Validation loss decreased (-0.137029 --> -0.312711).  Saving model ...
Epoch: 3 cost time: 77.4763674736023
Epoch: 3, Steps: 32 | Train Loss: 11.104 Vali Loss: 72.520 Vali Acc: 0.290 Test Loss: 72.520 Test Acc: 0.290
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 76.91781663894653
Epoch: 4, Steps: 32 | Train Loss: 22.792 Vali Loss: 57.602 Vali Acc: 0.534 Test Loss: 57.602 Test Acc: 0.534
Validation loss decreased (-0.312711 --> -0.533775).  Saving model ...
Epoch: 5 cost time: 76.37815690040588
Epoch: 5, Steps: 32 | Train Loss: 8.284 Vali Loss: 47.139 Vali Acc: 0.496 Test Loss: 47.139 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 75.98507404327393
Epoch: 6, Steps: 32 | Train Loss: 7.056 Vali Loss: 85.841 Vali Acc: 0.519 Test Loss: 85.841 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 76.30583262443542
Epoch: 7, Steps: 32 | Train Loss: 6.877 Vali Loss: 165.169 Vali Acc: 0.191 Test Loss: 165.169 Test Acc: 0.191
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 76.38723421096802
Epoch: 8, Steps: 32 | Train Loss: 10.997 Vali Loss: 112.624 Vali Acc: 0.458 Test Loss: 112.624 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 76.09047770500183
Epoch: 9, Steps: 32 | Train Loss: 11.949 Vali Loss: 67.035 Vali Acc: 0.527 Test Loss: 67.035 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 76.04897165298462
Epoch: 10, Steps: 32 | Train Loss: 3.672 Vali Loss: 102.095 Vali Acc: 0.588 Test Loss: 102.095 Test Acc: 0.588
Validation loss decreased (-0.533775 --> -0.586765).  Saving model ...
Epoch: 11 cost time: 76.15484356880188
Epoch: 11, Steps: 32 | Train Loss: 8.311 Vali Loss: 87.369 Vali Acc: 0.511 Test Loss: 87.369 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 75.85034394264221
Epoch: 12, Steps: 32 | Train Loss: 8.016 Vali Loss: 173.077 Vali Acc: 0.275 Test Loss: 173.077 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 76.36122059822083
Epoch: 13, Steps: 32 | Train Loss: 13.920 Vali Loss: 135.883 Vali Acc: 0.336 Test Loss: 135.883 Test Acc: 0.336
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 76.22649550437927
Epoch: 14, Steps: 32 | Train Loss: 11.833 Vali Loss: 126.035 Vali Acc: 0.427 Test Loss: 126.035 Test Acc: 0.427
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 76.12275648117065
Epoch: 15, Steps: 32 | Train Loss: 12.373 Vali Loss: 109.727 Vali Acc: 0.588 Test Loss: 109.727 Test Acc: 0.588
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 76.13541626930237
Epoch: 16, Steps: 32 | Train Loss: 5.273 Vali Loss: 242.469 Vali Acc: 0.305 Test Loss: 242.469 Test Acc: 0.305
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 76.31090593338013
Epoch: 17, Steps: 32 | Train Loss: 17.748 Vali Loss: 238.883 Vali Acc: 0.489 Test Loss: 238.883 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 76.17444705963135
Epoch: 18, Steps: 32 | Train Loss: 19.986 Vali Loss: 263.030 Vali Acc: 0.313 Test Loss: 263.030 Test Acc: 0.313
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 75.95210218429565
Epoch: 19, Steps: 32 | Train Loss: 27.389 Vali Loss: 255.332 Vali Acc: 0.450 Test Loss: 255.332 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 76.0297691822052
Epoch: 20, Steps: 32 | Train Loss: 18.800 Vali Loss: 166.411 Vali Acc: 0.496 Test Loss: 166.411 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 33539077
model size : 136.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 355.5694811344147
Epoch: 1, Steps: 32 | Train Loss: 12.475 Vali Loss: 22.955 Vali Acc: 0.176 Test Loss: 22.955 Test Acc: 0.176
Validation loss decreased (inf --> -0.175343).  Saving model ...
Epoch: 2 cost time: 354.0707983970642
Epoch: 2, Steps: 32 | Train Loss: 7.709 Vali Loss: 45.788 Vali Acc: 0.290 Test Loss: 45.788 Test Acc: 0.290
Validation loss decreased (-0.175343 --> -0.289618).  Saving model ...
Epoch: 3 cost time: 352.0401358604431
Epoch: 3, Steps: 32 | Train Loss: 22.221 Vali Loss: 50.069 Vali Acc: 0.282 Test Loss: 50.069 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 352.6029849052429
Epoch: 4, Steps: 32 | Train Loss: 12.308 Vali Loss: 33.304 Vali Acc: 0.565 Test Loss: 33.304 Test Acc: 0.565
Validation loss decreased (-0.289618 --> -0.564552).  Saving model ...
Epoch: 5 cost time: 351.67934703826904
Epoch: 5, Steps: 32 | Train Loss: 15.665 Vali Loss: 48.992 Vali Acc: 0.321 Test Loss: 48.992 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 350.46542382240295
Epoch: 6, Steps: 32 | Train Loss: 8.804 Vali Loss: 118.915 Vali Acc: 0.221 Test Loss: 118.915 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 349.9311900138855
Epoch: 7, Steps: 32 | Train Loss: 5.276 Vali Loss: 74.193 Vali Acc: 0.420 Test Loss: 74.193 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 352.67258858680725
Epoch: 8, Steps: 32 | Train Loss: 21.493 Vali Loss: 124.844 Vali Acc: 0.321 Test Loss: 124.844 Test Acc: 0.321
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 350.3997097015381
Epoch: 9, Steps: 32 | Train Loss: 5.223 Vali Loss: 103.950 Vali Acc: 0.504 Test Loss: 103.950 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 353.08587622642517
Epoch: 10, Steps: 32 | Train Loss: 9.074 Vali Loss: 173.227 Vali Acc: 0.221 Test Loss: 173.227 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 353.404337644577
Epoch: 11, Steps: 32 | Train Loss: 15.033 Vali Loss: 126.686 Vali Acc: 0.473 Test Loss: 126.686 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 351.3355522155762
Epoch: 12, Steps: 32 | Train Loss: 6.480 Vali Loss: 134.052 Vali Acc: 0.389 Test Loss: 134.052 Test Acc: 0.389
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 349.49419832229614
Epoch: 13, Steps: 32 | Train Loss: 18.261 Vali Loss: 251.012 Vali Acc: 0.237 Test Loss: 251.012 Test Acc: 0.237
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 351.245245218277
Epoch: 14, Steps: 32 | Train Loss: 3.945 Vali Loss: 159.819 Vali Acc: 0.481 Test Loss: 159.819 Test Acc: 0.481
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 49005573
model size : 195.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 194.21544861793518
Epoch: 1, Steps: 64 | Train Loss: 21.654 Vali Loss: 23.194 Vali Acc: 0.344 Test Loss: 23.194 Test Acc: 0.344
Validation loss decreased (inf --> -0.343280).  Saving model ...
Epoch: 2 cost time: 190.851868391037
Epoch: 2, Steps: 64 | Train Loss: 34.690 Vali Loss: 87.061 Vali Acc: 0.214 Test Loss: 87.061 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 190.00418257713318
Epoch: 3, Steps: 64 | Train Loss: 17.473 Vali Loss: 75.438 Vali Acc: 0.435 Test Loss: 75.438 Test Acc: 0.435
Validation loss decreased (-0.343280 --> -0.434360).  Saving model ...
Epoch: 4 cost time: 190.23813319206238
Epoch: 4, Steps: 64 | Train Loss: 12.842 Vali Loss: 57.602 Vali Acc: 0.466 Test Loss: 57.602 Test Acc: 0.466
Validation loss decreased (-0.434360 --> -0.465073).  Saving model ...
Epoch: 5 cost time: 190.24381136894226
Epoch: 5, Steps: 64 | Train Loss: 31.544 Vali Loss: 155.679 Vali Acc: 0.344 Test Loss: 155.679 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 190.6268322467804
Epoch: 6, Steps: 64 | Train Loss: 32.898 Vali Loss: 126.998 Vali Acc: 0.496 Test Loss: 126.998 Test Acc: 0.496
Validation loss decreased (-0.465073 --> -0.494913).  Saving model ...
Epoch: 7 cost time: 188.0604441165924
Epoch: 7, Steps: 64 | Train Loss: 8.549 Vali Loss: 175.719 Vali Acc: 0.565 Test Loss: 175.719 Test Acc: 0.565
Validation loss decreased (-0.494913 --> -0.563128).  Saving model ...
Epoch: 8 cost time: 188.4785816669464
Epoch: 8, Steps: 64 | Train Loss: 13.832 Vali Loss: 172.893 Vali Acc: 0.519 Test Loss: 172.893 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 189.89990663528442
Epoch: 9, Steps: 64 | Train Loss: 2.415 Vali Loss: 197.136 Vali Acc: 0.511 Test Loss: 197.136 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 189.21901297569275
Epoch: 10, Steps: 64 | Train Loss: 25.530 Vali Loss: 198.324 Vali Acc: 0.450 Test Loss: 198.324 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 189.94118881225586
Epoch: 11, Steps: 64 | Train Loss: 20.909 Vali Loss: 236.580 Vali Acc: 0.450 Test Loss: 236.580 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 189.61544919013977
Epoch: 12, Steps: 64 | Train Loss: 21.547 Vali Loss: 268.011 Vali Acc: 0.336 Test Loss: 268.011 Test Acc: 0.336
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 189.05230140686035
Epoch: 13, Steps: 64 | Train Loss: 21.033 Vali Loss: 193.452 Vali Acc: 0.366 Test Loss: 193.452 Test Acc: 0.366
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 189.23785138130188
Epoch: 14, Steps: 64 | Train Loss: 5.969 Vali Loss: 205.122 Vali Acc: 0.328 Test Loss: 205.122 Test Acc: 0.328
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 189.40629267692566
Epoch: 15, Steps: 64 | Train Loss: 12.634 Vali Loss: 226.513 Vali Acc: 0.458 Test Loss: 226.513 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 189.1114628314972
Epoch: 16, Steps: 64 | Train Loss: 12.035 Vali Loss: 262.038 Vali Acc: 0.550 Test Loss: 262.038 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 188.4896228313446
Epoch: 17, Steps: 64 | Train Loss: 13.325 Vali Loss: 242.587 Vali Acc: 0.412 Test Loss: 242.587 Test Acc: 0.412
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 22526981
model size : 94.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 230.80908608436584
Epoch: 1, Steps: 32 | Train Loss: 12.529 Vali Loss: 22.953 Vali Acc: 0.168 Test Loss: 22.953 Test Acc: 0.168
Validation loss decreased (inf --> -0.167709).  Saving model ...
Epoch: 2 cost time: 231.10517597198486
Epoch: 2, Steps: 32 | Train Loss: 9.106 Vali Loss: 48.757 Vali Acc: 0.298 Test Loss: 48.757 Test Acc: 0.298
Validation loss decreased (-0.167709 --> -0.297222).  Saving model ...
Epoch: 3 cost time: 231.78699779510498
Epoch: 3, Steps: 32 | Train Loss: 20.545 Vali Loss: 38.471 Vali Acc: 0.511 Test Loss: 38.471 Test Acc: 0.511
Validation loss decreased (-0.297222 --> -0.511066).  Saving model ...
Epoch: 4 cost time: 229.72331976890564
Epoch: 4, Steps: 32 | Train Loss: 9.354 Vali Loss: 41.717 Vali Acc: 0.389 Test Loss: 41.717 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 229.02754497528076
Epoch: 5, Steps: 32 | Train Loss: 9.717 Vali Loss: 51.754 Vali Acc: 0.366 Test Loss: 51.754 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 228.1417052745819
Epoch: 6, Steps: 32 | Train Loss: 7.140 Vali Loss: 106.283 Vali Acc: 0.489 Test Loss: 106.283 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 229.20296812057495
Epoch: 7, Steps: 32 | Train Loss: 11.608 Vali Loss: 111.236 Vali Acc: 0.229 Test Loss: 111.236 Test Acc: 0.229
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 228.24607753753662
Epoch: 8, Steps: 32 | Train Loss: 5.554 Vali Loss: 91.410 Vali Acc: 0.382 Test Loss: 91.410 Test Acc: 0.382
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 228.0888340473175
Epoch: 9, Steps: 32 | Train Loss: 6.234 Vali Loss: 145.059 Vali Acc: 0.313 Test Loss: 145.059 Test Acc: 0.313
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 228.7264175415039
Epoch: 10, Steps: 32 | Train Loss: 18.542 Vali Loss: 134.192 Vali Acc: 0.290 Test Loss: 134.192 Test Acc: 0.290
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 229.41812539100647
Epoch: 11, Steps: 32 | Train Loss: 28.531 Vali Loss: 117.124 Vali Acc: 0.412 Test Loss: 117.124 Test Acc: 0.412
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 230.71255779266357
Epoch: 12, Steps: 32 | Train Loss: 13.913 Vali Loss: 207.714 Vali Acc: 0.450 Test Loss: 207.714 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 227.01351189613342
Epoch: 13, Steps: 32 | Train Loss: 9.452 Vali Loss: 131.798 Vali Acc: 0.450 Test Loss: 131.798 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 49005573
model size : 195.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 141.55187487602234
Epoch: 1, Steps: 64 | Train Loss: 30.403 Vali Loss: 24.993 Vali Acc: 0.305 Test Loss: 24.993 Test Acc: 0.305
Validation loss decreased (inf --> -0.305094).  Saving model ...
Epoch: 2 cost time: 138.55425810813904
Epoch: 2, Steps: 64 | Train Loss: 29.025 Vali Loss: 115.165 Vali Acc: 0.214 Test Loss: 115.165 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 138.5640730857849
Epoch: 3, Steps: 64 | Train Loss: 36.662 Vali Loss: 118.405 Vali Acc: 0.260 Test Loss: 118.405 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 138.57202434539795
Epoch: 4, Steps: 64 | Train Loss: 26.850 Vali Loss: 254.655 Vali Acc: 0.214 Test Loss: 254.655 Test Acc: 0.214
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 138.87436819076538
Epoch: 5, Steps: 64 | Train Loss: 11.178 Vali Loss: 96.055 Vali Acc: 0.519 Test Loss: 96.055 Test Acc: 0.519
Validation loss decreased (-0.305094 --> -0.518123).  Saving model ...
Epoch: 6 cost time: 138.2230715751648
Epoch: 6, Steps: 64 | Train Loss: 7.373 Vali Loss: 93.713 Vali Acc: 0.565 Test Loss: 93.713 Test Acc: 0.565
Validation loss decreased (-0.518123 --> -0.563948).  Saving model ...
Epoch: 7 cost time: 138.68037939071655
Epoch: 7, Steps: 64 | Train Loss: 12.941 Vali Loss: 294.381 Vali Acc: 0.458 Test Loss: 294.381 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 137.85025715827942
Epoch: 8, Steps: 64 | Train Loss: 25.889 Vali Loss: 118.808 Vali Acc: 0.511 Test Loss: 118.808 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 137.79485058784485
Epoch: 9, Steps: 64 | Train Loss: 35.468 Vali Loss: 189.479 Vali Acc: 0.450 Test Loss: 189.479 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 138.16554307937622
Epoch: 10, Steps: 64 | Train Loss: 25.318 Vali Loss: 223.342 Vali Acc: 0.496 Test Loss: 223.342 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 138.1916310787201
Epoch: 11, Steps: 64 | Train Loss: 33.241 Vali Loss: 299.369 Vali Acc: 0.298 Test Loss: 299.369 Test Acc: 0.298
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 138.7391972541809
Epoch: 12, Steps: 64 | Train Loss: 42.366 Vali Loss: 194.177 Vali Acc: 0.359 Test Loss: 194.177 Test Acc: 0.359
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 138.02884554862976
Epoch: 13, Steps: 64 | Train Loss: 25.523 Vali Loss: 224.760 Vali Acc: 0.344 Test Loss: 224.760 Test Acc: 0.344
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 138.0597710609436
Epoch: 14, Steps: 64 | Train Loss: 11.249 Vali Loss: 217.566 Vali Acc: 0.389 Test Loss: 217.566 Test Acc: 0.389
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 137.79492378234863
Epoch: 15, Steps: 64 | Train Loss: 5.701 Vali Loss: 420.543 Vali Acc: 0.229 Test Loss: 420.543 Test Acc: 0.229
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 138.96310949325562
Epoch: 16, Steps: 64 | Train Loss: 22.916 Vali Loss: 344.674 Vali Acc: 0.481 Test Loss: 344.674 Test Acc: 0.481
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 22526981
model size : 94.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 133.82326126098633
Epoch: 1, Steps: 32 | Train Loss: 12.447 Vali Loss: 19.600 Vali Acc: 0.206 Test Loss: 19.600 Test Acc: 0.206
Validation loss decreased (inf --> -0.205911).  Saving model ...
Epoch: 2 cost time: 132.06912279129028
Epoch: 2, Steps: 32 | Train Loss: 10.325 Vali Loss: 41.450 Vali Acc: 0.321 Test Loss: 41.450 Test Acc: 0.321
Validation loss decreased (-0.205911 --> -0.320196).  Saving model ...
Epoch: 3 cost time: 131.4919629096985
Epoch: 3, Steps: 32 | Train Loss: 15.511 Vali Loss: 40.719 Vali Acc: 0.298 Test Loss: 40.719 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 131.78631353378296
Epoch: 4, Steps: 32 | Train Loss: 12.901 Vali Loss: 57.918 Vali Acc: 0.527 Test Loss: 57.918 Test Acc: 0.527
Validation loss decreased (-0.320196 --> -0.526138).  Saving model ...
Epoch: 5 cost time: 131.42090249061584
Epoch: 5, Steps: 32 | Train Loss: 25.613 Vali Loss: 75.321 Vali Acc: 0.298 Test Loss: 75.321 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 130.6558337211609
Epoch: 6, Steps: 32 | Train Loss: 8.913 Vali Loss: 66.544 Vali Acc: 0.519 Test Loss: 66.544 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 130.34068965911865
Epoch: 7, Steps: 32 | Train Loss: 8.407 Vali Loss: 85.528 Vali Acc: 0.466 Test Loss: 85.528 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 130.25538110733032
Epoch: 8, Steps: 32 | Train Loss: 6.864 Vali Loss: 97.494 Vali Acc: 0.450 Test Loss: 97.494 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 130.0523862838745
Epoch: 9, Steps: 32 | Train Loss: 5.655 Vali Loss: 96.979 Vali Acc: 0.351 Test Loss: 96.979 Test Acc: 0.351
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 129.68853759765625
Epoch: 10, Steps: 32 | Train Loss: 9.258 Vali Loss: 65.281 Vali Acc: 0.481 Test Loss: 65.281 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 129.69053030014038
Epoch: 11, Steps: 32 | Train Loss: 1.323 Vali Loss: 77.976 Vali Acc: 0.412 Test Loss: 77.976 Test Acc: 0.412
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 130.25710129737854
Epoch: 12, Steps: 32 | Train Loss: 8.109 Vali Loss: 133.198 Vali Acc: 0.511 Test Loss: 133.198 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 130.25179600715637
Epoch: 13, Steps: 32 | Train Loss: 8.606 Vali Loss: 204.956 Vali Acc: 0.534 Test Loss: 204.956 Test Acc: 0.534
Validation loss decreased (-0.526138 --> -0.532302).  Saving model ...
Epoch: 14 cost time: 129.60160851478577
Epoch: 14, Steps: 32 | Train Loss: 10.865 Vali Loss: 126.870 Vali Acc: 0.481 Test Loss: 126.870 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 130.0444622039795
Epoch: 15, Steps: 32 | Train Loss: 9.688 Vali Loss: 209.431 Vali Acc: 0.580 Test Loss: 209.431 Test Acc: 0.580
Validation loss decreased (-0.532302 --> -0.578058).  Saving model ...
Epoch: 16 cost time: 129.72327995300293
Epoch: 16, Steps: 32 | Train Loss: 4.283 Vali Loss: 199.932 Vali Acc: 0.489 Test Loss: 199.932 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 130.050297498703
Epoch: 17, Steps: 32 | Train Loss: 6.126 Vali Loss: 225.550 Vali Acc: 0.557 Test Loss: 225.550 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 129.71580958366394
Epoch: 18, Steps: 32 | Train Loss: 0.767 Vali Loss: 185.456 Vali Acc: 0.397 Test Loss: 185.456 Test Acc: 0.397
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 129.7516975402832
Epoch: 19, Steps: 32 | Train Loss: 1.482 Vali Loss: 227.235 Vali Acc: 0.405 Test Loss: 227.235 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 129.60700011253357
Epoch: 20, Steps: 32 | Train Loss: 2.684 Vali Loss: 188.792 Vali Acc: 0.489 Test Loss: 188.792 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 129.97706151008606
Epoch: 21, Steps: 32 | Train Loss: 3.199 Vali Loss: 149.003 Vali Acc: 0.504 Test Loss: 149.003 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 130.05019974708557
Epoch: 22, Steps: 32 | Train Loss: 4.765 Vali Loss: 158.378 Vali Acc: 0.511 Test Loss: 158.378 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 129.9318552017212
Epoch: 23, Steps: 32 | Train Loss: 11.207 Vali Loss: 225.470 Vali Acc: 0.412 Test Loss: 225.470 Test Acc: 0.412
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 129.60979056358337
Epoch: 24, Steps: 32 | Train Loss: 9.137 Vali Loss: 247.030 Vali Acc: 0.473 Test Loss: 247.030 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 130.08352756500244
Epoch: 25, Steps: 32 | Train Loss: 4.257 Vali Loss: 188.017 Vali Acc: 0.351 Test Loss: 188.017 Test Acc: 0.351
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 49005573
model size : 195.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 42.72213625907898
Epoch: 1, Steps: 64 | Train Loss: 32.422 Vali Loss: 43.503 Vali Acc: 0.427 Test Loss: 43.503 Test Acc: 0.427
Validation loss decreased (inf --> -0.427046).  Saving model ...
Epoch: 2 cost time: 41.50439524650574
Epoch: 2, Steps: 64 | Train Loss: 25.414 Vali Loss: 37.090 Vali Acc: 0.458 Test Loss: 37.090 Test Acc: 0.458
Validation loss decreased (-0.427046 --> -0.457644).  Saving model ...
Epoch: 3 cost time: 40.63049077987671
Epoch: 3, Steps: 64 | Train Loss: 29.498 Vali Loss: 69.846 Vali Acc: 0.534 Test Loss: 69.846 Test Acc: 0.534
Validation loss decreased (-0.457644 --> -0.533653).  Saving model ...
Epoch: 4 cost time: 41.05832576751709
Epoch: 4, Steps: 64 | Train Loss: 17.802 Vali Loss: 74.514 Vali Acc: 0.389 Test Loss: 74.514 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 41.380675315856934
Epoch: 5, Steps: 64 | Train Loss: 36.910 Vali Loss: 180.766 Vali Acc: 0.252 Test Loss: 180.766 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 40.39973473548889
Epoch: 6, Steps: 64 | Train Loss: 16.056 Vali Loss: 206.375 Vali Acc: 0.221 Test Loss: 206.375 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 40.535414934158325
Epoch: 7, Steps: 64 | Train Loss: 22.615 Vali Loss: 232.990 Vali Acc: 0.473 Test Loss: 232.990 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 40.40295720100403
Epoch: 8, Steps: 64 | Train Loss: 20.101 Vali Loss: 247.153 Vali Acc: 0.466 Test Loss: 247.153 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 40.94340658187866
Epoch: 9, Steps: 64 | Train Loss: 16.916 Vali Loss: 221.779 Vali Acc: 0.489 Test Loss: 221.779 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 40.40027451515198
Epoch: 10, Steps: 64 | Train Loss: 1.971 Vali Loss: 329.885 Vali Acc: 0.198 Test Loss: 329.885 Test Acc: 0.198
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 40.562255859375
Epoch: 11, Steps: 64 | Train Loss: 19.445 Vali Loss: 214.485 Vali Acc: 0.519 Test Loss: 214.485 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 40.230284690856934
Epoch: 12, Steps: 64 | Train Loss: 14.598 Vali Loss: 202.128 Vali Acc: 0.527 Test Loss: 202.128 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 40.394179582595825
Epoch: 13, Steps: 64 | Train Loss: 20.063 Vali Loss: 292.896 Vali Acc: 0.275 Test Loss: 292.896 Test Acc: 0.275
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 22526981
model size : 94.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 411.0940010547638
Epoch: 1, Steps: 32 | Train Loss: 9.880 Vali Loss: 13.077 Vali Acc: 0.160 Test Loss: 13.077 Test Acc: 0.160
Validation loss decreased (inf --> -0.160175).  Saving model ...
Epoch: 2 cost time: 404.40271258354187
Epoch: 2, Steps: 32 | Train Loss: 4.598 Vali Loss: 12.120 Vali Acc: 0.565 Test Loss: 12.120 Test Acc: 0.565
Validation loss decreased (-0.160175 --> -0.564764).  Saving model ...
Epoch: 3 cost time: 404.2130341529846
Epoch: 3, Steps: 32 | Train Loss: 6.874 Vali Loss: 13.522 Vali Acc: 0.519 Test Loss: 13.522 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 400.56132531166077
Epoch: 4, Steps: 32 | Train Loss: 5.111 Vali Loss: 55.766 Vali Acc: 0.229 Test Loss: 55.766 Test Acc: 0.229
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 401.5089554786682
Epoch: 5, Steps: 32 | Train Loss: 6.043 Vali Loss: 27.070 Vali Acc: 0.489 Test Loss: 27.070 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 402.7335891723633
Epoch: 6, Steps: 32 | Train Loss: 1.046 Vali Loss: 36.149 Vali Acc: 0.557 Test Loss: 36.149 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 404.49531292915344
Epoch: 7, Steps: 32 | Train Loss: 4.417 Vali Loss: 56.396 Vali Acc: 0.550 Test Loss: 56.396 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 401.81100487709045
Epoch: 8, Steps: 32 | Train Loss: 6.546 Vali Loss: 49.015 Vali Acc: 0.496 Test Loss: 49.015 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 400.4961178302765
Epoch: 9, Steps: 32 | Train Loss: 3.579 Vali Loss: 44.914 Vali Acc: 0.489 Test Loss: 44.914 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 399.12662649154663
Epoch: 10, Steps: 32 | Train Loss: 9.330 Vali Loss: 83.710 Vali Acc: 0.275 Test Loss: 83.710 Test Acc: 0.275
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 397.5311121940613
Epoch: 11, Steps: 32 | Train Loss: 8.119 Vali Loss: 59.810 Vali Acc: 0.305 Test Loss: 59.810 Test Acc: 0.305
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 398.48548913002014
Epoch: 12, Steps: 32 | Train Loss: 2.944 Vali Loss: 63.724 Vali Acc: 0.397 Test Loss: 63.724 Test Acc: 0.397
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 43250693
model size : 169.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 147.99867033958435
Epoch: 1, Steps: 32 | Train Loss: 5.380 Vali Loss: 6.627 Vali Acc: 0.244 Test Loss: 6.627 Test Acc: 0.244
Validation loss decreased (inf --> -0.244209).  Saving model ...
Epoch: 2 cost time: 143.44329643249512
Epoch: 2, Steps: 32 | Train Loss: 3.512 Vali Loss: 8.541 Vali Acc: 0.412 Test Loss: 8.541 Test Acc: 0.412
Validation loss decreased (-0.244209 --> -0.412128).  Saving model ...
Epoch: 3 cost time: 143.35558795928955
Epoch: 3, Steps: 32 | Train Loss: 4.190 Vali Loss: 22.560 Vali Acc: 0.382 Test Loss: 22.560 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 143.04241824150085
Epoch: 4, Steps: 32 | Train Loss: 4.292 Vali Loss: 30.363 Vali Acc: 0.252 Test Loss: 30.363 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 142.29531168937683
Epoch: 5, Steps: 32 | Train Loss: 2.993 Vali Loss: 22.598 Vali Acc: 0.405 Test Loss: 22.598 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 143.2474946975708
Epoch: 6, Steps: 32 | Train Loss: 6.236 Vali Loss: 36.857 Vali Acc: 0.573 Test Loss: 36.857 Test Acc: 0.573
Validation loss decreased (-0.412128 --> -0.572151).  Saving model ...
Epoch: 7 cost time: 141.6173815727234
Epoch: 7, Steps: 32 | Train Loss: 9.782 Vali Loss: 45.960 Vali Acc: 0.496 Test Loss: 45.960 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 139.36914730072021
Epoch: 8, Steps: 32 | Train Loss: 4.167 Vali Loss: 54.138 Vali Acc: 0.351 Test Loss: 54.138 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 140.3556990623474
Epoch: 9, Steps: 32 | Train Loss: 2.220 Vali Loss: 44.035 Vali Acc: 0.489 Test Loss: 44.035 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 140.30838060379028
Epoch: 10, Steps: 32 | Train Loss: 2.485 Vali Loss: 68.317 Vali Acc: 0.450 Test Loss: 68.317 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 139.32414031028748
Epoch: 11, Steps: 32 | Train Loss: 5.527 Vali Loss: 44.098 Vali Acc: 0.435 Test Loss: 44.098 Test Acc: 0.435
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 139.52971577644348
Epoch: 12, Steps: 32 | Train Loss: 3.070 Vali Loss: 80.192 Vali Acc: 0.519 Test Loss: 80.192 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 139.86467838287354
Epoch: 13, Steps: 32 | Train Loss: 3.856 Vali Loss: 91.183 Vali Acc: 0.267 Test Loss: 91.183 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 137.82831859588623
Epoch: 14, Steps: 32 | Train Loss: 5.462 Vali Loss: 67.440 Vali Acc: 0.534 Test Loss: 67.440 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 139.36570167541504
Epoch: 15, Steps: 32 | Train Loss: 6.131 Vali Loss: 67.754 Vali Acc: 0.443 Test Loss: 67.754 Test Acc: 0.443
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 139.1255202293396
Epoch: 16, Steps: 32 | Train Loss: 5.821 Vali Loss: 61.380 Vali Acc: 0.481 Test Loss: 61.380 Test Acc: 0.481
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 16771589
model size : 68.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 258.31649684906006
Epoch: 1, Steps: 32 | Train Loss: 10.226 Vali Loss: 6.168 Vali Acc: 0.420 Test Loss: 6.168 Test Acc: 0.420
Validation loss decreased (inf --> -0.419786).  Saving model ...
Epoch: 2 cost time: 257.5637412071228
Epoch: 2, Steps: 32 | Train Loss: 3.290 Vali Loss: 11.905 Vali Acc: 0.550 Test Loss: 11.905 Test Acc: 0.550
Validation loss decreased (-0.419786 --> -0.549499).  Saving model ...
Epoch: 3 cost time: 258.0283682346344
Epoch: 3, Steps: 32 | Train Loss: 6.951 Vali Loss: 21.178 Vali Acc: 0.344 Test Loss: 21.178 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 256.48327565193176
Epoch: 4, Steps: 32 | Train Loss: 5.092 Vali Loss: 25.428 Vali Acc: 0.290 Test Loss: 25.428 Test Acc: 0.290
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 259.65249276161194
Epoch: 5, Steps: 32 | Train Loss: 3.984 Vali Loss: 37.727 Vali Acc: 0.550 Test Loss: 37.727 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 259.098060131073
Epoch: 6, Steps: 32 | Train Loss: 5.825 Vali Loss: 19.765 Vali Acc: 0.519 Test Loss: 19.765 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 257.7437036037445
Epoch: 7, Steps: 32 | Train Loss: 2.384 Vali Loss: 29.508 Vali Acc: 0.366 Test Loss: 29.508 Test Acc: 0.366
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 256.8458800315857
Epoch: 8, Steps: 32 | Train Loss: 5.457 Vali Loss: 53.917 Vali Acc: 0.496 Test Loss: 53.917 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 260.0125813484192
Epoch: 9, Steps: 32 | Train Loss: 2.580 Vali Loss: 45.409 Vali Acc: 0.466 Test Loss: 45.409 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 263.6689238548279
Epoch: 10, Steps: 32 | Train Loss: 11.974 Vali Loss: 57.630 Vali Acc: 0.344 Test Loss: 57.630 Test Acc: 0.344
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 265.0298500061035
Epoch: 11, Steps: 32 | Train Loss: 6.437 Vali Loss: 50.992 Vali Acc: 0.458 Test Loss: 50.992 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 263.5677025318146
Epoch: 12, Steps: 32 | Train Loss: 5.946 Vali Loss: 121.159 Vali Acc: 0.237 Test Loss: 121.159 Test Acc: 0.237
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 43250693
model size : 169.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 91.6952211856842
Epoch: 1, Steps: 32 | Train Loss: 5.300 Vali Loss: 6.779 Vali Acc: 0.298 Test Loss: 6.779 Test Acc: 0.298
Validation loss decreased (inf --> -0.297642).  Saving model ...
Epoch: 2 cost time: 89.73501920700073
Epoch: 2, Steps: 32 | Train Loss: 2.947 Vali Loss: 12.678 Vali Acc: 0.252 Test Loss: 12.678 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 89.99697017669678
Epoch: 3, Steps: 32 | Train Loss: 6.445 Vali Loss: 14.037 Vali Acc: 0.366 Test Loss: 14.037 Test Acc: 0.366
Validation loss decreased (-0.297642 --> -0.366272).  Saving model ...
Epoch: 4 cost time: 89.49782204627991
Epoch: 4, Steps: 32 | Train Loss: 2.156 Vali Loss: 26.724 Vali Acc: 0.458 Test Loss: 26.724 Test Acc: 0.458
Validation loss decreased (-0.366272 --> -0.457748).  Saving model ...
Epoch: 5 cost time: 90.21753549575806
Epoch: 5, Steps: 32 | Train Loss: 10.030 Vali Loss: 34.111 Vali Acc: 0.458 Test Loss: 34.111 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 89.86672902107239
Epoch: 6, Steps: 32 | Train Loss: 5.609 Vali Loss: 53.888 Vali Acc: 0.542 Test Loss: 53.888 Test Acc: 0.542
Validation loss decreased (-0.457748 --> -0.541446).  Saving model ...
Epoch: 7 cost time: 88.91759967803955
Epoch: 7, Steps: 32 | Train Loss: 11.339 Vali Loss: 41.074 Vali Acc: 0.359 Test Loss: 41.074 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 89.20680832862854
Epoch: 8, Steps: 32 | Train Loss: 4.229 Vali Loss: 41.276 Vali Acc: 0.542 Test Loss: 41.276 Test Acc: 0.542
Validation loss decreased (-0.541446 --> -0.541572).  Saving model ...
Epoch: 9 cost time: 88.65163135528564
Epoch: 9, Steps: 32 | Train Loss: 2.952 Vali Loss: 54.792 Vali Acc: 0.382 Test Loss: 54.792 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 88.98393225669861
Epoch: 10, Steps: 32 | Train Loss: 5.186 Vali Loss: 58.235 Vali Acc: 0.397 Test Loss: 58.235 Test Acc: 0.397
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 89.70942687988281
Epoch: 11, Steps: 32 | Train Loss: 1.978 Vali Loss: 63.492 Vali Acc: 0.298 Test Loss: 63.492 Test Acc: 0.298
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 88.77668452262878
Epoch: 12, Steps: 32 | Train Loss: 3.171 Vali Loss: 56.025 Vali Acc: 0.450 Test Loss: 56.025 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 89.66367626190186
Epoch: 13, Steps: 32 | Train Loss: 3.646 Vali Loss: 75.711 Vali Acc: 0.344 Test Loss: 75.711 Test Acc: 0.344
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 89.44485306739807
Epoch: 14, Steps: 32 | Train Loss: 2.329 Vali Loss: 88.617 Vali Acc: 0.466 Test Loss: 88.617 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 89.95906710624695
Epoch: 15, Steps: 32 | Train Loss: 9.641 Vali Loss: 83.499 Vali Acc: 0.397 Test Loss: 83.499 Test Acc: 0.397
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 89.77572822570801
Epoch: 16, Steps: 32 | Train Loss: 6.962 Vali Loss: 146.780 Vali Acc: 0.214 Test Loss: 146.780 Test Acc: 0.214
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 90.60621380805969
Epoch: 17, Steps: 32 | Train Loss: 8.653 Vali Loss: 102.726 Vali Acc: 0.481 Test Loss: 102.726 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 89.77372193336487
Epoch: 18, Steps: 32 | Train Loss: 1.911 Vali Loss: 78.823 Vali Acc: 0.511 Test Loss: 78.823 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 16771589
model size : 68.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 139.1927535533905
Epoch: 1, Steps: 32 | Train Loss: 10.205 Vali Loss: 5.861 Vali Acc: 0.427 Test Loss: 5.861 Test Acc: 0.427
Validation loss decreased (inf --> -0.427422).  Saving model ...
Epoch: 2 cost time: 137.91741943359375
Epoch: 2, Steps: 32 | Train Loss: 4.081 Vali Loss: 13.731 Vali Acc: 0.519 Test Loss: 13.731 Test Acc: 0.519
Validation loss decreased (-0.427422 --> -0.518947).  Saving model ...
Epoch: 3 cost time: 137.6296694278717
Epoch: 3, Steps: 32 | Train Loss: 5.556 Vali Loss: 12.940 Vali Acc: 0.588 Test Loss: 12.940 Test Acc: 0.588
Validation loss decreased (-0.518947 --> -0.587657).  Saving model ...
Epoch: 4 cost time: 137.03397917747498
Epoch: 4, Steps: 32 | Train Loss: 6.365 Vali Loss: 46.082 Vali Acc: 0.237 Test Loss: 46.082 Test Acc: 0.237
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 136.43412065505981
Epoch: 5, Steps: 32 | Train Loss: 4.053 Vali Loss: 38.334 Vali Acc: 0.450 Test Loss: 38.334 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 136.63916635513306
Epoch: 6, Steps: 32 | Train Loss: 10.236 Vali Loss: 35.298 Vali Acc: 0.450 Test Loss: 35.298 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 136.3182189464569
Epoch: 7, Steps: 32 | Train Loss: 2.219 Vali Loss: 39.971 Vali Acc: 0.366 Test Loss: 39.971 Test Acc: 0.366
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 136.00852608680725
Epoch: 8, Steps: 32 | Train Loss: 1.679 Vali Loss: 66.985 Vali Acc: 0.176 Test Loss: 66.985 Test Acc: 0.176
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 136.35897207260132
Epoch: 9, Steps: 32 | Train Loss: 4.491 Vali Loss: 54.359 Vali Acc: 0.489 Test Loss: 54.359 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 136.39893913269043
Epoch: 10, Steps: 32 | Train Loss: 8.844 Vali Loss: 47.369 Vali Acc: 0.351 Test Loss: 47.369 Test Acc: 0.351
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 135.76586031913757
Epoch: 11, Steps: 32 | Train Loss: 2.774 Vali Loss: 61.535 Vali Acc: 0.313 Test Loss: 61.535 Test Acc: 0.313
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 135.51065158843994
Epoch: 12, Steps: 32 | Train Loss: 3.250 Vali Loss: 47.482 Vali Acc: 0.504 Test Loss: 47.482 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 136.73901414871216
Epoch: 13, Steps: 32 | Train Loss: 9.751 Vali Loss: 116.592 Vali Acc: 0.511 Test Loss: 116.592 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 43250693
model size : 169.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 46.747684478759766
Epoch: 1, Steps: 32 | Train Loss: 5.294 Vali Loss: 6.898 Vali Acc: 0.298 Test Loss: 6.898 Test Acc: 0.298
Validation loss decreased (inf --> -0.297641).  Saving model ...
Epoch: 2 cost time: 45.7011034488678
Epoch: 2, Steps: 32 | Train Loss: 3.564 Vali Loss: 7.869 Vali Acc: 0.550 Test Loss: 7.869 Test Acc: 0.550
Validation loss decreased (-0.297641 --> -0.549540).  Saving model ...
Epoch: 3 cost time: 45.94730544090271
Epoch: 3, Steps: 32 | Train Loss: 4.313 Vali Loss: 22.088 Vali Acc: 0.305 Test Loss: 22.088 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 45.77224636077881
Epoch: 4, Steps: 32 | Train Loss: 7.660 Vali Loss: 42.164 Vali Acc: 0.504 Test Loss: 42.164 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 45.832252979278564
Epoch: 5, Steps: 32 | Train Loss: 6.842 Vali Loss: 45.062 Vali Acc: 0.252 Test Loss: 45.062 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 45.84375858306885
Epoch: 6, Steps: 32 | Train Loss: 2.960 Vali Loss: 62.430 Vali Acc: 0.519 Test Loss: 62.430 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 45.67207717895508
Epoch: 7, Steps: 32 | Train Loss: 11.194 Vali Loss: 37.681 Vali Acc: 0.481 Test Loss: 37.681 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 45.92312574386597
Epoch: 8, Steps: 32 | Train Loss: 4.756 Vali Loss: 39.139 Vali Acc: 0.435 Test Loss: 39.139 Test Acc: 0.435
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 45.307982444763184
Epoch: 9, Steps: 32 | Train Loss: 5.141 Vali Loss: 56.838 Vali Acc: 0.389 Test Loss: 56.838 Test Acc: 0.389
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 45.43530774116516
Epoch: 10, Steps: 32 | Train Loss: 2.334 Vali Loss: 37.192 Vali Acc: 0.496 Test Loss: 37.192 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 45.874003887176514
Epoch: 11, Steps: 32 | Train Loss: 2.323 Vali Loss: 54.421 Vali Acc: 0.351 Test Loss: 54.421 Test Acc: 0.351
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 45.64576745033264
Epoch: 12, Steps: 32 | Train Loss: 1.754 Vali Loss: 62.026 Vali Acc: 0.550 Test Loss: 62.026 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 16771589
model size : 68.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 242.9464569091797
Epoch: 1, Steps: 32 | Train Loss: 5.994 Vali Loss: 17.037 Vali Acc: 0.176 Test Loss: 17.037 Test Acc: 0.176
Validation loss decreased (inf --> -0.175402).  Saving model ...
Epoch: 2 cost time: 240.07714772224426
Epoch: 2, Steps: 32 | Train Loss: 8.623 Vali Loss: 22.085 Vali Acc: 0.527 Test Loss: 22.085 Test Acc: 0.527
Validation loss decreased (-0.175402 --> -0.526497).  Saving model ...
Epoch: 3 cost time: 238.55486941337585
Epoch: 3, Steps: 32 | Train Loss: 3.779 Vali Loss: 30.353 Vali Acc: 0.481 Test Loss: 30.353 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 238.51510787010193
Epoch: 4, Steps: 32 | Train Loss: 5.479 Vali Loss: 21.020 Vali Acc: 0.481 Test Loss: 21.020 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 238.02330613136292
Epoch: 5, Steps: 32 | Train Loss: 7.470 Vali Loss: 35.997 Vali Acc: 0.282 Test Loss: 35.997 Test Acc: 0.282
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 238.41367268562317
Epoch: 6, Steps: 32 | Train Loss: 5.042 Vali Loss: 53.247 Vali Acc: 0.260 Test Loss: 53.247 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 236.33503031730652
Epoch: 7, Steps: 32 | Train Loss: 4.712 Vali Loss: 51.126 Vali Acc: 0.427 Test Loss: 51.126 Test Acc: 0.427
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 237.88523650169373
Epoch: 8, Steps: 32 | Train Loss: 3.560 Vali Loss: 57.233 Vali Acc: 0.359 Test Loss: 57.233 Test Acc: 0.359
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 236.66573023796082
Epoch: 9, Steps: 32 | Train Loss: 2.399 Vali Loss: 56.141 Vali Acc: 0.427 Test Loss: 56.141 Test Acc: 0.427
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 236.4494698047638
Epoch: 10, Steps: 32 | Train Loss: 13.000 Vali Loss: 98.119 Vali Acc: 0.237 Test Loss: 98.119 Test Acc: 0.237
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 236.54944562911987
Epoch: 11, Steps: 32 | Train Loss: 9.235 Vali Loss: 86.741 Vali Acc: 0.405 Test Loss: 86.741 Test Acc: 0.405
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 238.0324821472168
Epoch: 12, Steps: 32 | Train Loss: 11.109 Vali Loss: 83.416 Vali Acc: 0.481 Test Loss: 83.416 Test Acc: 0.481
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 24504325
model size : 97.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 105.61692833900452
Epoch: 1, Steps: 32 | Train Loss: 6.363 Vali Loss: 11.226 Vali Acc: 0.427 Test Loss: 11.226 Test Acc: 0.427
Validation loss decreased (inf --> -0.427369).  Saving model ...
Epoch: 2 cost time: 103.51076674461365
Epoch: 2, Steps: 32 | Train Loss: 6.065 Vali Loss: 20.063 Vali Acc: 0.260 Test Loss: 20.063 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 104.0058205127716
Epoch: 3, Steps: 32 | Train Loss: 10.278 Vali Loss: 25.890 Vali Acc: 0.473 Test Loss: 25.890 Test Acc: 0.473
Validation loss decreased (-0.427369 --> -0.473024).  Saving model ...
Epoch: 4 cost time: 103.253910779953
Epoch: 4, Steps: 32 | Train Loss: 4.887 Vali Loss: 17.617 Vali Acc: 0.489 Test Loss: 17.617 Test Acc: 0.489
Validation loss decreased (-0.473024 --> -0.488373).  Saving model ...
Epoch: 5 cost time: 102.18600535392761
Epoch: 5, Steps: 32 | Train Loss: 2.729 Vali Loss: 34.902 Vali Acc: 0.305 Test Loss: 34.902 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 102.11886882781982
Epoch: 6, Steps: 32 | Train Loss: 2.780 Vali Loss: 39.334 Vali Acc: 0.504 Test Loss: 39.334 Test Acc: 0.504
Validation loss decreased (-0.488373 --> -0.503423).  Saving model ...
Epoch: 7 cost time: 102.14591431617737
Epoch: 7, Steps: 32 | Train Loss: 3.709 Vali Loss: 59.191 Vali Acc: 0.511 Test Loss: 59.191 Test Acc: 0.511
Validation loss decreased (-0.503423 --> -0.510858).  Saving model ...
Epoch: 8 cost time: 102.05939245223999
Epoch: 8, Steps: 32 | Train Loss: 3.489 Vali Loss: 49.165 Vali Acc: 0.374 Test Loss: 49.165 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 102.29554200172424
Epoch: 9, Steps: 32 | Train Loss: 3.098 Vali Loss: 52.401 Vali Acc: 0.305 Test Loss: 52.401 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 102.35548400878906
Epoch: 10, Steps: 32 | Train Loss: 5.712 Vali Loss: 49.581 Vali Acc: 0.405 Test Loss: 49.581 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 102.61501145362854
Epoch: 11, Steps: 32 | Train Loss: 2.862 Vali Loss: 59.833 Vali Acc: 0.344 Test Loss: 59.833 Test Acc: 0.344
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 101.24172759056091
Epoch: 12, Steps: 32 | Train Loss: 0.473 Vali Loss: 55.393 Vali Acc: 0.450 Test Loss: 55.393 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 101.00327110290527
Epoch: 13, Steps: 32 | Train Loss: 3.357 Vali Loss: 101.748 Vali Acc: 0.527 Test Loss: 101.748 Test Acc: 0.527
Validation loss decreased (-0.510858 --> -0.525700).  Saving model ...
Epoch: 14 cost time: 101.89902234077454
Epoch: 14, Steps: 32 | Train Loss: 0.175 Vali Loss: 79.528 Vali Acc: 0.489 Test Loss: 79.528 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 101.26987528800964
Epoch: 15, Steps: 32 | Train Loss: 2.157 Vali Loss: 78.955 Vali Acc: 0.527 Test Loss: 78.955 Test Acc: 0.527
Validation loss decreased (-0.525700 --> -0.525928).  Saving model ...
Epoch: 16 cost time: 102.15651607513428
Epoch: 16, Steps: 32 | Train Loss: 3.965 Vali Loss: 71.651 Vali Acc: 0.466 Test Loss: 71.651 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 102.04123210906982
Epoch: 17, Steps: 32 | Train Loss: 1.660 Vali Loss: 76.922 Vali Acc: 0.511 Test Loss: 76.922 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 100.90442633628845
Epoch: 18, Steps: 32 | Train Loss: 4.036 Vali Loss: 103.054 Vali Acc: 0.534 Test Loss: 103.054 Test Acc: 0.534
Validation loss decreased (-0.525928 --> -0.533321).  Saving model ...
Epoch: 19 cost time: 101.02280735969543
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 67.017 Vali Acc: 0.435 Test Loss: 67.017 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 100.86687922477722
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 67.705 Vali Acc: 0.427 Test Loss: 67.705 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 100.97216081619263
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 67.501 Vali Acc: 0.427 Test Loss: 67.501 Test Acc: 0.427
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 100.7318754196167
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 67.495 Vali Acc: 0.435 Test Loss: 67.495 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 100.80554175376892
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 67.494 Vali Acc: 0.435 Test Loss: 67.494 Test Acc: 0.435
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 100.7649655342102
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 67.494 Vali Acc: 0.435 Test Loss: 67.494 Test Acc: 0.435
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 100.67864751815796
Epoch: 25, Steps: 32 | Train Loss: 0.000 Vali Loss: 67.494 Vali Acc: 0.435 Test Loss: 67.494 Test Acc: 0.435
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 100.55550575256348
Epoch: 26, Steps: 32 | Train Loss: 0.000 Vali Loss: 67.494 Vali Acc: 0.435 Test Loss: 67.494 Test Acc: 0.435
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 100.80873990058899
Epoch: 27, Steps: 32 | Train Loss: 0.000 Vali Loss: 67.494 Vali Acc: 0.435 Test Loss: 67.494 Test Acc: 0.435
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 101.56957077980042
Epoch: 28, Steps: 32 | Train Loss: 0.000 Vali Loss: 67.494 Vali Acc: 0.435 Test Loss: 67.494 Test Acc: 0.435
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 11264517
model size : 47.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 162.1591033935547
Epoch: 1, Steps: 32 | Train Loss: 5.760 Vali Loss: 16.223 Vali Acc: 0.198 Test Loss: 16.223 Test Acc: 0.198
Validation loss decreased (inf --> -0.198311).  Saving model ...
Epoch: 2 cost time: 162.42850804328918
Epoch: 2, Steps: 32 | Train Loss: 8.212 Vali Loss: 19.749 Vali Acc: 0.550 Test Loss: 19.749 Test Acc: 0.550
Validation loss decreased (-0.198311 --> -0.549421).  Saving model ...
Epoch: 3 cost time: 163.4380931854248
Epoch: 3, Steps: 32 | Train Loss: 5.557 Vali Loss: 22.765 Vali Acc: 0.481 Test Loss: 22.765 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 161.302307844162
Epoch: 4, Steps: 32 | Train Loss: 9.967 Vali Loss: 40.486 Vali Acc: 0.275 Test Loss: 40.486 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 161.5387921333313
Epoch: 5, Steps: 32 | Train Loss: 6.490 Vali Loss: 43.799 Vali Acc: 0.282 Test Loss: 43.799 Test Acc: 0.282
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 161.96576571464539
Epoch: 6, Steps: 32 | Train Loss: 2.545 Vali Loss: 36.705 Vali Acc: 0.458 Test Loss: 36.705 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 160.85864901542664
Epoch: 7, Steps: 32 | Train Loss: 3.829 Vali Loss: 54.119 Vali Acc: 0.542 Test Loss: 54.119 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 161.89808630943298
Epoch: 8, Steps: 32 | Train Loss: 7.722 Vali Loss: 56.759 Vali Acc: 0.458 Test Loss: 56.759 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 161.94391322135925
Epoch: 9, Steps: 32 | Train Loss: 6.388 Vali Loss: 33.009 Vali Acc: 0.473 Test Loss: 33.009 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 163.00701594352722
Epoch: 10, Steps: 32 | Train Loss: 11.175 Vali Loss: 80.603 Vali Acc: 0.519 Test Loss: 80.603 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 162.5217730998993
Epoch: 11, Steps: 32 | Train Loss: 9.822 Vali Loss: 60.319 Vali Acc: 0.336 Test Loss: 60.319 Test Acc: 0.336
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 161.14777278900146
Epoch: 12, Steps: 32 | Train Loss: 7.696 Vali Loss: 61.300 Vali Acc: 0.542 Test Loss: 61.300 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 24504325
model size : 97.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 75.25490212440491
Epoch: 1, Steps: 32 | Train Loss: 6.153 Vali Loss: 7.753 Vali Acc: 0.397 Test Loss: 7.753 Test Acc: 0.397
Validation loss decreased (inf --> -0.396869).  Saving model ...
Epoch: 2 cost time: 74.56125569343567
Epoch: 2, Steps: 32 | Train Loss: 6.582 Vali Loss: 8.258 Vali Acc: 0.466 Test Loss: 8.258 Test Acc: 0.466
Validation loss decreased (-0.396869 --> -0.465566).  Saving model ...
Epoch: 3 cost time: 75.2457435131073
Epoch: 3, Steps: 32 | Train Loss: 8.996 Vali Loss: 16.417 Vali Acc: 0.389 Test Loss: 16.417 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 74.94799780845642
Epoch: 4, Steps: 32 | Train Loss: 4.888 Vali Loss: 21.806 Vali Acc: 0.534 Test Loss: 21.806 Test Acc: 0.534
Validation loss decreased (-0.465566 --> -0.534133).  Saving model ...
Epoch: 5 cost time: 74.90735387802124
Epoch: 5, Steps: 32 | Train Loss: 4.412 Vali Loss: 26.003 Vali Acc: 0.473 Test Loss: 26.003 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 74.28143286705017
Epoch: 6, Steps: 32 | Train Loss: 5.251 Vali Loss: 52.212 Vali Acc: 0.550 Test Loss: 52.212 Test Acc: 0.550
Validation loss decreased (-0.534133 --> -0.549096).  Saving model ...
Epoch: 7 cost time: 74.59222364425659
Epoch: 7, Steps: 32 | Train Loss: 4.745 Vali Loss: 53.437 Vali Acc: 0.481 Test Loss: 53.437 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 74.96207880973816
Epoch: 8, Steps: 32 | Train Loss: 1.871 Vali Loss: 31.479 Vali Acc: 0.466 Test Loss: 31.479 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 74.42553877830505
Epoch: 9, Steps: 32 | Train Loss: 1.872 Vali Loss: 60.905 Vali Acc: 0.336 Test Loss: 60.905 Test Acc: 0.336
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 74.32018899917603
Epoch: 10, Steps: 32 | Train Loss: 1.920 Vali Loss: 61.948 Vali Acc: 0.496 Test Loss: 61.948 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 73.75520253181458
Epoch: 11, Steps: 32 | Train Loss: 2.915 Vali Loss: 86.141 Vali Acc: 0.267 Test Loss: 86.141 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 74.62902069091797
Epoch: 12, Steps: 32 | Train Loss: 0.313 Vali Loss: 43.931 Vali Acc: 0.473 Test Loss: 43.931 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 74.22219729423523
Epoch: 13, Steps: 32 | Train Loss: 2.346 Vali Loss: 69.311 Vali Acc: 0.580 Test Loss: 69.311 Test Acc: 0.580
Validation loss decreased (-0.549096 --> -0.579460).  Saving model ...
Epoch: 14 cost time: 74.12395691871643
Epoch: 14, Steps: 32 | Train Loss: 2.199 Vali Loss: 62.471 Vali Acc: 0.580 Test Loss: 62.471 Test Acc: 0.580
Validation loss decreased (-0.579460 --> -0.579528).  Saving model ...
Epoch: 15 cost time: 73.90680241584778
Epoch: 15, Steps: 32 | Train Loss: 2.536 Vali Loss: 70.411 Vali Acc: 0.573 Test Loss: 70.411 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 73.6367335319519
Epoch: 16, Steps: 32 | Train Loss: 1.829 Vali Loss: 67.258 Vali Acc: 0.412 Test Loss: 67.258 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 74.23294258117676
Epoch: 17, Steps: 32 | Train Loss: 3.849 Vali Loss: 106.072 Vali Acc: 0.344 Test Loss: 106.072 Test Acc: 0.344
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 73.77748823165894
Epoch: 18, Steps: 32 | Train Loss: 1.994 Vali Loss: 116.206 Vali Acc: 0.321 Test Loss: 116.206 Test Acc: 0.321
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 73.81234455108643
Epoch: 19, Steps: 32 | Train Loss: 10.598 Vali Loss: 112.938 Vali Acc: 0.450 Test Loss: 112.938 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 73.97082757949829
Epoch: 20, Steps: 32 | Train Loss: 10.603 Vali Loss: 105.822 Vali Acc: 0.244 Test Loss: 105.822 Test Acc: 0.244
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 74.32624650001526
Epoch: 21, Steps: 32 | Train Loss: 7.520 Vali Loss: 97.785 Vali Acc: 0.427 Test Loss: 97.785 Test Acc: 0.427
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 74.0403459072113
Epoch: 22, Steps: 32 | Train Loss: 1.693 Vali Loss: 96.979 Vali Acc: 0.397 Test Loss: 96.979 Test Acc: 0.397
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 73.97106647491455
Epoch: 23, Steps: 32 | Train Loss: 6.042 Vali Loss: 77.115 Vali Acc: 0.527 Test Loss: 77.115 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 73.86550235748291
Epoch: 24, Steps: 32 | Train Loss: 3.185 Vali Loss: 111.678 Vali Acc: 0.412 Test Loss: 111.678 Test Acc: 0.412
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 11264517
model size : 47.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 102.49868607521057
Epoch: 1, Steps: 32 | Train Loss: 5.646 Vali Loss: 18.061 Vali Acc: 0.191 Test Loss: 18.061 Test Acc: 0.191
Validation loss decreased (inf --> -0.190659).  Saving model ...
Epoch: 2 cost time: 100.9719889163971
Epoch: 2, Steps: 32 | Train Loss: 7.613 Vali Loss: 16.356 Vali Acc: 0.305 Test Loss: 16.356 Test Acc: 0.305
Validation loss decreased (-0.190659 --> -0.305180).  Saving model ...
Epoch: 3 cost time: 101.1622884273529
Epoch: 3, Steps: 32 | Train Loss: 3.979 Vali Loss: 28.352 Vali Acc: 0.321 Test Loss: 28.352 Test Acc: 0.321
Validation loss decreased (-0.305180 --> -0.320327).  Saving model ...
Epoch: 4 cost time: 100.62432074546814
Epoch: 4, Steps: 32 | Train Loss: 6.162 Vali Loss: 22.340 Vali Acc: 0.565 Test Loss: 22.340 Test Acc: 0.565
Validation loss decreased (-0.320327 --> -0.564662).  Saving model ...
Epoch: 5 cost time: 99.50712871551514
Epoch: 5, Steps: 32 | Train Loss: 8.695 Vali Loss: 46.144 Vali Acc: 0.374 Test Loss: 46.144 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 100.03321838378906
Epoch: 6, Steps: 32 | Train Loss: 5.546 Vali Loss: 38.372 Vali Acc: 0.321 Test Loss: 38.372 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 100.20638680458069
Epoch: 7, Steps: 32 | Train Loss: 3.141 Vali Loss: 38.294 Vali Acc: 0.588 Test Loss: 38.294 Test Acc: 0.588
Validation loss decreased (-0.564662 --> -0.587403).  Saving model ...
Epoch: 8 cost time: 98.63411259651184
Epoch: 8, Steps: 32 | Train Loss: 0.583 Vali Loss: 33.484 Vali Acc: 0.397 Test Loss: 33.484 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 99.37659001350403
Epoch: 9, Steps: 32 | Train Loss: 3.213 Vali Loss: 64.799 Vali Acc: 0.550 Test Loss: 64.799 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 100.18464803695679
Epoch: 10, Steps: 32 | Train Loss: 6.265 Vali Loss: 125.606 Vali Acc: 0.221 Test Loss: 125.606 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 99.76333546638489
Epoch: 11, Steps: 32 | Train Loss: 10.993 Vali Loss: 77.443 Vali Acc: 0.374 Test Loss: 77.443 Test Acc: 0.374
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 100.27923560142517
Epoch: 12, Steps: 32 | Train Loss: 3.537 Vali Loss: 87.408 Vali Acc: 0.443 Test Loss: 87.408 Test Acc: 0.443
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 98.9509003162384
Epoch: 13, Steps: 32 | Train Loss: 2.091 Vali Loss: 125.011 Vali Acc: 0.489 Test Loss: 125.011 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 99.58683371543884
Epoch: 14, Steps: 32 | Train Loss: 7.461 Vali Loss: 92.103 Vali Acc: 0.344 Test Loss: 92.103 Test Acc: 0.344
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 99.51294159889221
Epoch: 15, Steps: 32 | Train Loss: 3.089 Vali Loss: 66.789 Vali Acc: 0.527 Test Loss: 66.789 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 98.53276300430298
Epoch: 16, Steps: 32 | Train Loss: 3.544 Vali Loss: 75.077 Vali Acc: 0.405 Test Loss: 75.077 Test Acc: 0.405
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 99.05544805526733
Epoch: 17, Steps: 32 | Train Loss: 2.890 Vali Loss: 97.919 Vali Acc: 0.565 Test Loss: 97.919 Test Acc: 0.565
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 24504325
model size : 97.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 51.60218667984009
Epoch: 1, Steps: 32 | Train Loss: 5.346 Vali Loss: 8.518 Vali Acc: 0.351 Test Loss: 8.518 Test Acc: 0.351
Validation loss decreased (inf --> -0.351060).  Saving model ...
Epoch: 2 cost time: 51.11629843711853
Epoch: 2, Steps: 32 | Train Loss: 5.018 Vali Loss: 12.777 Vali Acc: 0.267 Test Loss: 12.777 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 50.63594627380371
Epoch: 3, Steps: 32 | Train Loss: 3.103 Vali Loss: 22.376 Vali Acc: 0.458 Test Loss: 22.376 Test Acc: 0.458
Validation loss decreased (-0.351060 --> -0.457792).  Saving model ...
Epoch: 4 cost time: 50.50664401054382
Epoch: 4, Steps: 32 | Train Loss: 5.064 Vali Loss: 27.884 Vali Acc: 0.397 Test Loss: 27.884 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 50.5524640083313
Epoch: 5, Steps: 32 | Train Loss: 6.648 Vali Loss: 34.852 Vali Acc: 0.481 Test Loss: 34.852 Test Acc: 0.481
Validation loss decreased (-0.457792 --> -0.480568).  Saving model ...
Epoch: 6 cost time: 50.47189283370972
Epoch: 6, Steps: 32 | Train Loss: 7.346 Vali Loss: 40.296 Vali Acc: 0.458 Test Loss: 40.296 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 50.210240602493286
Epoch: 7, Steps: 32 | Train Loss: 0.319 Vali Loss: 49.963 Vali Acc: 0.489 Test Loss: 49.963 Test Acc: 0.489
Validation loss decreased (-0.480568 --> -0.488050).  Saving model ...
Epoch: 8 cost time: 49.629441022872925
Epoch: 8, Steps: 32 | Train Loss: 0.698 Vali Loss: 57.390 Vali Acc: 0.527 Test Loss: 57.390 Test Acc: 0.527
Validation loss decreased (-0.488050 --> -0.526144).  Saving model ...
Epoch: 9 cost time: 49.75846266746521
Epoch: 9, Steps: 32 | Train Loss: 5.750 Vali Loss: 47.450 Vali Acc: 0.412 Test Loss: 47.450 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 49.555978298187256
Epoch: 10, Steps: 32 | Train Loss: 3.205 Vali Loss: 47.036 Vali Acc: 0.473 Test Loss: 47.036 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 50.12618350982666
Epoch: 11, Steps: 32 | Train Loss: 2.715 Vali Loss: 58.376 Vali Acc: 0.405 Test Loss: 58.376 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 49.715367555618286
Epoch: 12, Steps: 32 | Train Loss: 0.432 Vali Loss: 57.374 Vali Acc: 0.489 Test Loss: 57.374 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 50.190701484680176
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 52.977 Vali Acc: 0.496 Test Loss: 52.977 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 49.989450216293335
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 52.871 Vali Acc: 0.511 Test Loss: 52.871 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 49.45257329940796
Epoch: 15, Steps: 32 | Train Loss: 0.903 Vali Loss: 76.113 Vali Acc: 0.542 Test Loss: 76.113 Test Acc: 0.542
Validation loss decreased (-0.526144 --> -0.541224).  Saving model ...
Epoch: 16 cost time: 49.582563638687134
Epoch: 16, Steps: 32 | Train Loss: 6.412 Vali Loss: 90.684 Vali Acc: 0.519 Test Loss: 90.684 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 49.88243365287781
Epoch: 17, Steps: 32 | Train Loss: 17.750 Vali Loss: 140.852 Vali Acc: 0.260 Test Loss: 140.852 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 49.898170471191406
Epoch: 18, Steps: 32 | Train Loss: 2.660 Vali Loss: 143.264 Vali Acc: 0.176 Test Loss: 143.264 Test Acc: 0.176
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 49.92095184326172
Epoch: 19, Steps: 32 | Train Loss: 4.242 Vali Loss: 84.736 Vali Acc: 0.397 Test Loss: 84.736 Test Acc: 0.397
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 50.26316547393799
Epoch: 20, Steps: 32 | Train Loss: 0.680 Vali Loss: 62.233 Vali Acc: 0.458 Test Loss: 62.233 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 49.963507890701294
Epoch: 21, Steps: 32 | Train Loss: 0.355 Vali Loss: 93.935 Vali Acc: 0.496 Test Loss: 93.935 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 50.22865629196167
Epoch: 22, Steps: 32 | Train Loss: 2.380 Vali Loss: 82.287 Vali Acc: 0.420 Test Loss: 82.287 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 50.28882074356079
Epoch: 23, Steps: 32 | Train Loss: 4.385 Vali Loss: 94.685 Vali Acc: 0.412 Test Loss: 94.685 Test Acc: 0.412
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 50.32141613960266
Epoch: 24, Steps: 32 | Train Loss: 0.330 Vali Loss: 137.960 Vali Acc: 0.298 Test Loss: 137.960 Test Acc: 0.298
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 49.69940447807312
Epoch: 25, Steps: 32 | Train Loss: 2.911 Vali Loss: 166.968 Vali Acc: 0.275 Test Loss: 166.968 Test Acc: 0.275
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 11264517
model size : 47.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 146.9651916027069
Epoch: 1, Steps: 32 | Train Loss: 8.945 Vali Loss: 4.955 Vali Acc: 0.214 Test Loss: 4.955 Test Acc: 0.214
Validation loss decreased (inf --> -0.213691).  Saving model ...
Epoch: 2 cost time: 146.93642783164978
Epoch: 2, Steps: 32 | Train Loss: 7.428 Vali Loss: 23.590 Vali Acc: 0.275 Test Loss: 23.590 Test Acc: 0.275
Validation loss decreased (-0.213691 --> -0.274573).  Saving model ...
Epoch: 3 cost time: 145.20707821846008
Epoch: 3, Steps: 32 | Train Loss: 7.915 Vali Loss: 21.791 Vali Acc: 0.282 Test Loss: 21.791 Test Acc: 0.282
Validation loss decreased (-0.274573 --> -0.282225).  Saving model ...
Epoch: 4 cost time: 144.05143237113953
Epoch: 4, Steps: 32 | Train Loss: 5.131 Vali Loss: 19.247 Vali Acc: 0.489 Test Loss: 19.247 Test Acc: 0.489
Validation loss decreased (-0.282225 --> -0.488357).  Saving model ...
Epoch: 5 cost time: 143.6775290966034
Epoch: 5, Steps: 32 | Train Loss: 3.829 Vali Loss: 30.711 Vali Acc: 0.473 Test Loss: 30.711 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 144.62132954597473
Epoch: 6, Steps: 32 | Train Loss: 4.634 Vali Loss: 34.854 Vali Acc: 0.458 Test Loss: 34.854 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 142.92605185508728
Epoch: 7, Steps: 32 | Train Loss: 3.574 Vali Loss: 36.371 Vali Acc: 0.458 Test Loss: 36.371 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 142.14549612998962
Epoch: 8, Steps: 32 | Train Loss: 1.798 Vali Loss: 38.838 Vali Acc: 0.557 Test Loss: 38.838 Test Acc: 0.557
Validation loss decreased (-0.488357 --> -0.556864).  Saving model ...
Epoch: 9 cost time: 142.0667757987976
Epoch: 9, Steps: 32 | Train Loss: 1.031 Vali Loss: 50.863 Vali Acc: 0.481 Test Loss: 50.863 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 143.93795371055603
Epoch: 10, Steps: 32 | Train Loss: 1.708 Vali Loss: 59.031 Vali Acc: 0.344 Test Loss: 59.031 Test Acc: 0.344
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 144.25056791305542
Epoch: 11, Steps: 32 | Train Loss: 2.979 Vali Loss: 50.041 Vali Acc: 0.550 Test Loss: 50.041 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 144.7698838710785
Epoch: 12, Steps: 32 | Train Loss: 0.833 Vali Loss: 58.162 Vali Acc: 0.427 Test Loss: 58.162 Test Acc: 0.427
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 145.04200434684753
Epoch: 13, Steps: 32 | Train Loss: 3.933 Vali Loss: 83.217 Vali Acc: 0.214 Test Loss: 83.217 Test Acc: 0.214
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 145.35752773284912
Epoch: 14, Steps: 32 | Train Loss: 7.694 Vali Loss: 53.523 Vali Acc: 0.473 Test Loss: 53.523 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 144.22866654396057
Epoch: 15, Steps: 32 | Train Loss: 5.045 Vali Loss: 93.630 Vali Acc: 0.450 Test Loss: 93.630 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 143.70728039741516
Epoch: 16, Steps: 32 | Train Loss: 8.598 Vali Loss: 133.584 Vali Acc: 0.260 Test Loss: 133.584 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 142.0656452178955
Epoch: 17, Steps: 32 | Train Loss: 5.228 Vali Loss: 77.535 Vali Acc: 0.481 Test Loss: 77.535 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 142.23763489723206
Epoch: 18, Steps: 32 | Train Loss: 0.961 Vali Loss: 104.824 Vali Acc: 0.588 Test Loss: 104.824 Test Acc: 0.588
Validation loss decreased (-0.556864 --> -0.586738).  Saving model ...
Epoch: 19 cost time: 142.4326732158661
Epoch: 19, Steps: 32 | Train Loss: 1.504 Vali Loss: 115.752 Vali Acc: 0.519 Test Loss: 115.752 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 141.37810754776
Epoch: 20, Steps: 32 | Train Loss: 2.412 Vali Loss: 77.940 Vali Acc: 0.489 Test Loss: 77.940 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 142.40464448928833
Epoch: 21, Steps: 32 | Train Loss: 3.226 Vali Loss: 88.915 Vali Acc: 0.481 Test Loss: 88.915 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 141.90361213684082
Epoch: 22, Steps: 32 | Train Loss: 5.187 Vali Loss: 108.495 Vali Acc: 0.374 Test Loss: 108.495 Test Acc: 0.374
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 142.2322552204132
Epoch: 23, Steps: 32 | Train Loss: 7.124 Vali Loss: 168.895 Vali Acc: 0.282 Test Loss: 168.895 Test Acc: 0.282
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 142.22532653808594
Epoch: 24, Steps: 32 | Train Loss: 6.191 Vali Loss: 152.960 Vali Acc: 0.374 Test Loss: 152.960 Test Acc: 0.374
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 143.0643026828766
Epoch: 25, Steps: 32 | Train Loss: 3.836 Vali Loss: 217.353 Vali Acc: 0.237 Test Loss: 217.353 Test Acc: 0.237
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 143.40029311180115
Epoch: 26, Steps: 32 | Train Loss: 8.862 Vali Loss: 169.348 Vali Acc: 0.397 Test Loss: 169.348 Test Acc: 0.397
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 142.87622666358948
Epoch: 27, Steps: 32 | Train Loss: 13.131 Vali Loss: 171.853 Vali Acc: 0.527 Test Loss: 171.853 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 140.85356211662292
Epoch: 28, Steps: 32 | Train Loss: 2.337 Vali Loss: 174.585 Vali Acc: 0.275 Test Loss: 174.585 Test Acc: 0.275
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 15131141
model size : 62.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 68.24903202056885
Epoch: 1, Steps: 32 | Train Loss: 5.703 Vali Loss: 10.411 Vali Acc: 0.244 Test Loss: 10.411 Test Acc: 0.244
Validation loss decreased (inf --> -0.244171).  Saving model ...
Epoch: 2 cost time: 67.55051517486572
Epoch: 2, Steps: 32 | Train Loss: 4.489 Vali Loss: 21.740 Vali Acc: 0.160 Test Loss: 21.740 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 68.04518461227417
Epoch: 3, Steps: 32 | Train Loss: 8.079 Vali Loss: 19.172 Vali Acc: 0.359 Test Loss: 19.172 Test Acc: 0.359
Validation loss decreased (-0.244171 --> -0.358587).  Saving model ...
Epoch: 4 cost time: 67.17203259468079
Epoch: 4, Steps: 32 | Train Loss: 5.219 Vali Loss: 16.850 Vali Acc: 0.481 Test Loss: 16.850 Test Acc: 0.481
Validation loss decreased (-0.358587 --> -0.480748).  Saving model ...
Epoch: 5 cost time: 66.80938673019409
Epoch: 5, Steps: 32 | Train Loss: 5.382 Vali Loss: 24.929 Vali Acc: 0.374 Test Loss: 24.929 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 67.27255606651306
Epoch: 6, Steps: 32 | Train Loss: 0.654 Vali Loss: 30.140 Vali Acc: 0.359 Test Loss: 30.140 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 67.96062850952148
Epoch: 7, Steps: 32 | Train Loss: 2.412 Vali Loss: 58.140 Vali Acc: 0.534 Test Loss: 58.140 Test Acc: 0.534
Validation loss decreased (-0.480748 --> -0.533770).  Saving model ...
Epoch: 8 cost time: 66.67013478279114
Epoch: 8, Steps: 32 | Train Loss: 11.589 Vali Loss: 60.491 Vali Acc: 0.565 Test Loss: 60.491 Test Acc: 0.565
Validation loss decreased (-0.533770 --> -0.564281).  Saving model ...
Epoch: 9 cost time: 65.99700403213501
Epoch: 9, Steps: 32 | Train Loss: 4.496 Vali Loss: 127.237 Vali Acc: 0.229 Test Loss: 127.237 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 66.69700217247009
Epoch: 10, Steps: 32 | Train Loss: 8.084 Vali Loss: 69.470 Vali Acc: 0.519 Test Loss: 69.470 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 67.58819651603699
Epoch: 11, Steps: 32 | Train Loss: 4.362 Vali Loss: 103.461 Vali Acc: 0.573 Test Loss: 103.461 Test Acc: 0.573
Validation loss decreased (-0.564281 --> -0.571484).  Saving model ...
Epoch: 12 cost time: 67.02479600906372
Epoch: 12, Steps: 32 | Train Loss: 6.802 Vali Loss: 68.614 Vali Acc: 0.336 Test Loss: 68.614 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 67.89476108551025
Epoch: 13, Steps: 32 | Train Loss: 4.284 Vali Loss: 65.747 Vali Acc: 0.344 Test Loss: 65.747 Test Acc: 0.344
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 67.2790596485138
Epoch: 14, Steps: 32 | Train Loss: 4.884 Vali Loss: 69.363 Vali Acc: 0.565 Test Loss: 69.363 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 67.6125123500824
Epoch: 15, Steps: 32 | Train Loss: 0.931 Vali Loss: 71.156 Vali Acc: 0.336 Test Loss: 71.156 Test Acc: 0.336
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 67.44799876213074
Epoch: 16, Steps: 32 | Train Loss: 3.155 Vali Loss: 66.965 Vali Acc: 0.534 Test Loss: 66.965 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 66.59155321121216
Epoch: 17, Steps: 32 | Train Loss: 2.582 Vali Loss: 66.267 Vali Acc: 0.420 Test Loss: 66.267 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 67.04794645309448
Epoch: 18, Steps: 32 | Train Loss: 3.363 Vali Loss: 73.560 Vali Acc: 0.382 Test Loss: 73.560 Test Acc: 0.382
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 67.71157360076904
Epoch: 19, Steps: 32 | Train Loss: 3.149 Vali Loss: 68.615 Vali Acc: 0.450 Test Loss: 68.615 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 66.74158763885498
Epoch: 20, Steps: 32 | Train Loss: 3.165 Vali Loss: 112.752 Vali Acc: 0.557 Test Loss: 112.752 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 66.55892276763916
Epoch: 21, Steps: 32 | Train Loss: 5.412 Vali Loss: 84.492 Vali Acc: 0.496 Test Loss: 84.492 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 8510981
model size : 36.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 98.34330701828003
Epoch: 1, Steps: 32 | Train Loss: 8.878 Vali Loss: 3.780 Vali Acc: 0.313 Test Loss: 3.780 Test Acc: 0.313
Validation loss decreased (inf --> -0.312939).  Saving model ...
Epoch: 2 cost time: 95.86667895317078
Epoch: 2, Steps: 32 | Train Loss: 4.900 Vali Loss: 22.697 Vali Acc: 0.252 Test Loss: 22.697 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 97.25492525100708
Epoch: 3, Steps: 32 | Train Loss: 6.047 Vali Loss: 16.439 Vali Acc: 0.611 Test Loss: 16.439 Test Acc: 0.611
Validation loss decreased (-0.312939 --> -0.610523).  Saving model ...
Epoch: 4 cost time: 96.0710346698761
Epoch: 4, Steps: 32 | Train Loss: 5.663 Vali Loss: 24.276 Vali Acc: 0.359 Test Loss: 24.276 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 96.76174902915955
Epoch: 5, Steps: 32 | Train Loss: 2.505 Vali Loss: 37.798 Vali Acc: 0.443 Test Loss: 37.798 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 96.28590083122253
Epoch: 6, Steps: 32 | Train Loss: 4.498 Vali Loss: 41.038 Vali Acc: 0.420 Test Loss: 41.038 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 96.57650971412659
Epoch: 7, Steps: 32 | Train Loss: 3.957 Vali Loss: 40.920 Vali Acc: 0.336 Test Loss: 40.920 Test Acc: 0.336
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 96.31408858299255
Epoch: 8, Steps: 32 | Train Loss: 4.610 Vali Loss: 59.784 Vali Acc: 0.267 Test Loss: 59.784 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 96.15703654289246
Epoch: 9, Steps: 32 | Train Loss: 7.812 Vali Loss: 82.791 Vali Acc: 0.275 Test Loss: 82.791 Test Acc: 0.275
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 96.06740021705627
Epoch: 10, Steps: 32 | Train Loss: 6.715 Vali Loss: 77.333 Vali Acc: 0.450 Test Loss: 77.333 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 95.72634768486023
Epoch: 11, Steps: 32 | Train Loss: 2.471 Vali Loss: 81.797 Vali Acc: 0.229 Test Loss: 81.797 Test Acc: 0.229
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 96.03162980079651
Epoch: 12, Steps: 32 | Train Loss: 2.256 Vali Loss: 64.643 Vali Acc: 0.519 Test Loss: 64.643 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 96.62990546226501
Epoch: 13, Steps: 32 | Train Loss: 4.875 Vali Loss: 95.864 Vali Acc: 0.405 Test Loss: 95.864 Test Acc: 0.405
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6106870229007634
model parameter : 15131141
model size : 62.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 47.8766074180603
Epoch: 1, Steps: 32 | Train Loss: 5.701 Vali Loss: 10.501 Vali Acc: 0.229 Test Loss: 10.501 Test Acc: 0.229
Validation loss decreased (inf --> -0.228903).  Saving model ...
Epoch: 2 cost time: 47.249754667282104
Epoch: 2, Steps: 32 | Train Loss: 6.530 Vali Loss: 6.793 Vali Acc: 0.420 Test Loss: 6.793 Test Acc: 0.420
Validation loss decreased (-0.228903 --> -0.419779).  Saving model ...
Epoch: 3 cost time: 47.03798151016235
Epoch: 3, Steps: 32 | Train Loss: 2.915 Vali Loss: 25.580 Vali Acc: 0.519 Test Loss: 25.580 Test Acc: 0.519
Validation loss decreased (-0.419779 --> -0.518828).  Saving model ...
Epoch: 4 cost time: 47.49454927444458
Epoch: 4, Steps: 32 | Train Loss: 3.722 Vali Loss: 41.636 Vali Acc: 0.290 Test Loss: 41.636 Test Acc: 0.290
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 47.42082214355469
Epoch: 5, Steps: 32 | Train Loss: 7.069 Vali Loss: 22.165 Vali Acc: 0.542 Test Loss: 22.165 Test Acc: 0.542
Validation loss decreased (-0.518828 --> -0.541763).  Saving model ...
Epoch: 6 cost time: 47.395859718322754
Epoch: 6, Steps: 32 | Train Loss: 4.943 Vali Loss: 25.165 Vali Acc: 0.603 Test Loss: 25.165 Test Acc: 0.603
Validation loss decreased (-0.541763 --> -0.602802).  Saving model ...
Epoch: 7 cost time: 47.26179599761963
Epoch: 7, Steps: 32 | Train Loss: 4.454 Vali Loss: 44.679 Vali Acc: 0.443 Test Loss: 44.679 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 47.37317895889282
Epoch: 8, Steps: 32 | Train Loss: 1.833 Vali Loss: 47.351 Vali Acc: 0.366 Test Loss: 47.351 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 46.75629138946533
Epoch: 9, Steps: 32 | Train Loss: 1.296 Vali Loss: 63.352 Vali Acc: 0.305 Test Loss: 63.352 Test Acc: 0.305
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 46.93356513977051
Epoch: 10, Steps: 32 | Train Loss: 1.856 Vali Loss: 48.233 Vali Acc: 0.397 Test Loss: 48.233 Test Acc: 0.397
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 47.12909269332886
Epoch: 11, Steps: 32 | Train Loss: 4.278 Vali Loss: 42.596 Vali Acc: 0.511 Test Loss: 42.596 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 47.6602303981781
Epoch: 12, Steps: 32 | Train Loss: 1.255 Vali Loss: 92.506 Vali Acc: 0.458 Test Loss: 92.506 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 47.1383318901062
Epoch: 13, Steps: 32 | Train Loss: 1.572 Vali Loss: 52.472 Vali Acc: 0.550 Test Loss: 52.472 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 46.82187557220459
Epoch: 14, Steps: 32 | Train Loss: 3.703 Vali Loss: 100.754 Vali Acc: 0.458 Test Loss: 100.754 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 47.03355312347412
Epoch: 15, Steps: 32 | Train Loss: 8.223 Vali Loss: 62.350 Vali Acc: 0.405 Test Loss: 62.350 Test Acc: 0.405
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 47.13502645492554
Epoch: 16, Steps: 32 | Train Loss: 1.653 Vali Loss: 103.339 Vali Acc: 0.527 Test Loss: 103.339 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6030534351145038
model parameter : 8510981
model size : 36.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 61.209238052368164
Epoch: 1, Steps: 32 | Train Loss: 8.765 Vali Loss: 4.982 Vali Acc: 0.321 Test Loss: 4.982 Test Acc: 0.321
Validation loss decreased (inf --> -0.320561).  Saving model ...
Epoch: 2 cost time: 59.96992039680481
Epoch: 2, Steps: 32 | Train Loss: 4.625 Vali Loss: 11.186 Vali Acc: 0.580 Test Loss: 11.186 Test Acc: 0.580
Validation loss decreased (-0.320561 --> -0.580041).  Saving model ...
Epoch: 3 cost time: 59.79994606971741
Epoch: 3, Steps: 32 | Train Loss: 3.382 Vali Loss: 14.008 Vali Acc: 0.527 Test Loss: 14.008 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 59.45534157752991
Epoch: 4, Steps: 32 | Train Loss: 4.082 Vali Loss: 19.950 Vali Acc: 0.382 Test Loss: 19.950 Test Acc: 0.382
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 59.203784704208374
Epoch: 5, Steps: 32 | Train Loss: 5.952 Vali Loss: 43.123 Vali Acc: 0.328 Test Loss: 43.123 Test Acc: 0.328
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 59.37593746185303
Epoch: 6, Steps: 32 | Train Loss: 5.484 Vali Loss: 33.518 Vali Acc: 0.298 Test Loss: 33.518 Test Acc: 0.298
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 58.8161883354187
Epoch: 7, Steps: 32 | Train Loss: 14.439 Vali Loss: 64.273 Vali Acc: 0.275 Test Loss: 64.273 Test Acc: 0.275
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 58.8016300201416
Epoch: 8, Steps: 32 | Train Loss: 1.567 Vali Loss: 31.840 Vali Acc: 0.427 Test Loss: 31.840 Test Acc: 0.427
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 58.981452226638794
Epoch: 9, Steps: 32 | Train Loss: 3.360 Vali Loss: 44.339 Vali Acc: 0.534 Test Loss: 44.339 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 58.51630401611328
Epoch: 10, Steps: 32 | Train Loss: 3.419 Vali Loss: 70.473 Vali Acc: 0.344 Test Loss: 70.473 Test Acc: 0.344
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 58.5823814868927
Epoch: 11, Steps: 32 | Train Loss: 0.443 Vali Loss: 73.855 Vali Acc: 0.321 Test Loss: 73.855 Test Acc: 0.321
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 58.64216375350952
Epoch: 12, Steps: 32 | Train Loss: 0.825 Vali Loss: 56.655 Vali Acc: 0.573 Test Loss: 56.655 Test Acc: 0.573
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 15131141
model size : 62.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 32.971919536590576
Epoch: 1, Steps: 32 | Train Loss: 5.283 Vali Loss: 10.180 Vali Acc: 0.275 Test Loss: 10.180 Test Acc: 0.275
Validation loss decreased (inf --> -0.274707).  Saving model ...
Epoch: 2 cost time: 32.49665975570679
Epoch: 2, Steps: 32 | Train Loss: 3.489 Vali Loss: 8.517 Vali Acc: 0.420 Test Loss: 8.517 Test Acc: 0.420
Validation loss decreased (-0.274707 --> -0.419762).  Saving model ...
Epoch: 3 cost time: 32.40320301055908
Epoch: 3, Steps: 32 | Train Loss: 2.574 Vali Loss: 15.334 Vali Acc: 0.458 Test Loss: 15.334 Test Acc: 0.458
Validation loss decreased (-0.419762 --> -0.457862).  Saving model ...
Epoch: 4 cost time: 32.17653512954712
Epoch: 4, Steps: 32 | Train Loss: 4.110 Vali Loss: 22.206 Vali Acc: 0.298 Test Loss: 22.206 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 32.21180820465088
Epoch: 5, Steps: 32 | Train Loss: 3.795 Vali Loss: 30.273 Vali Acc: 0.542 Test Loss: 30.273 Test Acc: 0.542
Validation loss decreased (-0.457862 --> -0.541682).  Saving model ...
Epoch: 6 cost time: 31.97550678253174
Epoch: 6, Steps: 32 | Train Loss: 7.660 Vali Loss: 43.783 Vali Acc: 0.542 Test Loss: 43.783 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 31.921952486038208
Epoch: 7, Steps: 32 | Train Loss: 4.507 Vali Loss: 27.350 Vali Acc: 0.534 Test Loss: 27.350 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 31.84195065498352
Epoch: 8, Steps: 32 | Train Loss: 0.937 Vali Loss: 36.390 Vali Acc: 0.603 Test Loss: 36.390 Test Acc: 0.603
Validation loss decreased (-0.541682 --> -0.602690).  Saving model ...
Epoch: 9 cost time: 31.965977668762207
Epoch: 9, Steps: 32 | Train Loss: 2.295 Vali Loss: 63.970 Vali Acc: 0.321 Test Loss: 63.970 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 31.881420373916626
Epoch: 10, Steps: 32 | Train Loss: 2.094 Vali Loss: 48.747 Vali Acc: 0.351 Test Loss: 48.747 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 32.032970666885376
Epoch: 11, Steps: 32 | Train Loss: 6.998 Vali Loss: 88.221 Vali Acc: 0.550 Test Loss: 88.221 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 31.97570776939392
Epoch: 12, Steps: 32 | Train Loss: 4.645 Vali Loss: 72.448 Vali Acc: 0.298 Test Loss: 72.448 Test Acc: 0.298
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 32.29251217842102
Epoch: 13, Steps: 32 | Train Loss: 6.188 Vali Loss: 78.380 Vali Acc: 0.443 Test Loss: 78.380 Test Acc: 0.443
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 32.19896125793457
Epoch: 14, Steps: 32 | Train Loss: 4.303 Vali Loss: 73.885 Vali Acc: 0.519 Test Loss: 73.885 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 32.19882369041443
Epoch: 15, Steps: 32 | Train Loss: 2.940 Vali Loss: 93.374 Vali Acc: 0.534 Test Loss: 93.374 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 32.29753613471985
Epoch: 16, Steps: 32 | Train Loss: 3.819 Vali Loss: 82.011 Vali Acc: 0.489 Test Loss: 82.011 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 32.18820667266846
Epoch: 17, Steps: 32 | Train Loss: 1.236 Vali Loss: 141.653 Vali Acc: 0.527 Test Loss: 141.653 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 32.03892636299133
Epoch: 18, Steps: 32 | Train Loss: 2.206 Vali Loss: 106.697 Vali Acc: 0.542 Test Loss: 106.697 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6030534351145038
model parameter : 8510981
model size : 36.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 148.9853584766388
Epoch: 1, Steps: 32 | Train Loss: 4.327 Vali Loss: 7.234 Vali Acc: 0.198 Test Loss: 7.234 Test Acc: 0.198
Validation loss decreased (inf --> -0.198401).  Saving model ...
Epoch: 2 cost time: 148.295884847641
Epoch: 2, Steps: 32 | Train Loss: 3.571 Vali Loss: 6.306 Vali Acc: 0.344 Test Loss: 6.306 Test Acc: 0.344
Validation loss decreased (-0.198401 --> -0.343448).  Saving model ...
Epoch: 3 cost time: 147.15726900100708
Epoch: 3, Steps: 32 | Train Loss: 4.043 Vali Loss: 10.621 Vali Acc: 0.412 Test Loss: 10.621 Test Acc: 0.412
Validation loss decreased (-0.343448 --> -0.412108).  Saving model ...
Epoch: 4 cost time: 146.1717767715454
Epoch: 4, Steps: 32 | Train Loss: 2.964 Vali Loss: 10.854 Vali Acc: 0.405 Test Loss: 10.854 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 147.17628931999207
Epoch: 5, Steps: 32 | Train Loss: 5.438 Vali Loss: 25.484 Vali Acc: 0.504 Test Loss: 25.484 Test Acc: 0.504
Validation loss decreased (-0.412108 --> -0.503562).  Saving model ...
Epoch: 6 cost time: 146.99281430244446
Epoch: 6, Steps: 32 | Train Loss: 4.396 Vali Loss: 19.884 Vali Acc: 0.527 Test Loss: 19.884 Test Acc: 0.527
Validation loss decreased (-0.503562 --> -0.526519).  Saving model ...
Epoch: 7 cost time: 146.0859498977661
Epoch: 7, Steps: 32 | Train Loss: 0.432 Vali Loss: 28.689 Vali Acc: 0.397 Test Loss: 28.689 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 144.76764225959778
Epoch: 8, Steps: 32 | Train Loss: 2.637 Vali Loss: 24.418 Vali Acc: 0.489 Test Loss: 24.418 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 145.59595108032227
Epoch: 9, Steps: 32 | Train Loss: 3.261 Vali Loss: 37.892 Vali Acc: 0.511 Test Loss: 37.892 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 145.50352120399475
Epoch: 10, Steps: 32 | Train Loss: 1.484 Vali Loss: 27.338 Vali Acc: 0.351 Test Loss: 27.338 Test Acc: 0.351
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 146.57607316970825
Epoch: 11, Steps: 32 | Train Loss: 1.366 Vali Loss: 31.857 Vali Acc: 0.534 Test Loss: 31.857 Test Acc: 0.534
Validation loss decreased (-0.526519 --> -0.534033).  Saving model ...
Epoch: 12 cost time: 145.16597771644592
Epoch: 12, Steps: 32 | Train Loss: 1.267 Vali Loss: 38.706 Vali Acc: 0.397 Test Loss: 38.706 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 143.90986371040344
Epoch: 13, Steps: 32 | Train Loss: 3.830 Vali Loss: 36.930 Vali Acc: 0.359 Test Loss: 36.930 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 144.88060927391052
Epoch: 14, Steps: 32 | Train Loss: 4.850 Vali Loss: 37.437 Vali Acc: 0.344 Test Loss: 37.437 Test Acc: 0.344
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 145.6235327720642
Epoch: 15, Steps: 32 | Train Loss: 0.699 Vali Loss: 31.997 Vali Acc: 0.427 Test Loss: 31.997 Test Acc: 0.427
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 145.53500747680664
Epoch: 16, Steps: 32 | Train Loss: 1.264 Vali Loss: 37.314 Vali Acc: 0.397 Test Loss: 37.314 Test Acc: 0.397
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 144.17708110809326
Epoch: 17, Steps: 32 | Train Loss: 1.493 Vali Loss: 38.971 Vali Acc: 0.420 Test Loss: 38.971 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 144.21604776382446
Epoch: 18, Steps: 32 | Train Loss: 4.495 Vali Loss: 58.817 Vali Acc: 0.267 Test Loss: 58.817 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 143.32570219039917
Epoch: 19, Steps: 32 | Train Loss: 5.595 Vali Loss: 63.277 Vali Acc: 0.290 Test Loss: 63.277 Test Acc: 0.290
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 143.83592224121094
Epoch: 20, Steps: 32 | Train Loss: 4.489 Vali Loss: 50.855 Vali Acc: 0.366 Test Loss: 50.855 Test Acc: 0.366
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 142.93106627464294
Epoch: 21, Steps: 32 | Train Loss: 2.994 Vali Loss: 58.541 Vali Acc: 0.466 Test Loss: 58.541 Test Acc: 0.466
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 12253701
model size : 48.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 73.80016469955444
Epoch: 1, Steps: 32 | Train Loss: 4.003 Vali Loss: 3.422 Vali Acc: 0.466 Test Loss: 3.422 Test Acc: 0.466
Validation loss decreased (inf --> -0.465615).  Saving model ...
Epoch: 2 cost time: 72.87415838241577
Epoch: 2, Steps: 32 | Train Loss: 2.910 Vali Loss: 5.711 Vali Acc: 0.489 Test Loss: 5.711 Test Acc: 0.489
Validation loss decreased (-0.465615 --> -0.488493).  Saving model ...
Epoch: 3 cost time: 72.96154236793518
Epoch: 3, Steps: 32 | Train Loss: 2.922 Vali Loss: 9.742 Vali Acc: 0.542 Test Loss: 9.742 Test Acc: 0.542
Validation loss decreased (-0.488493 --> -0.541887).  Saving model ...
Epoch: 4 cost time: 72.6334490776062
Epoch: 4, Steps: 32 | Train Loss: 2.578 Vali Loss: 15.963 Vali Acc: 0.588 Test Loss: 15.963 Test Acc: 0.588
Validation loss decreased (-0.541887 --> -0.587627).  Saving model ...
Epoch: 5 cost time: 71.69333553314209
Epoch: 5, Steps: 32 | Train Loss: 2.156 Vali Loss: 15.556 Vali Acc: 0.344 Test Loss: 15.556 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 71.74647545814514
Epoch: 6, Steps: 32 | Train Loss: 1.574 Vali Loss: 21.495 Vali Acc: 0.336 Test Loss: 21.495 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 72.0005476474762
Epoch: 7, Steps: 32 | Train Loss: 1.619 Vali Loss: 28.145 Vali Acc: 0.382 Test Loss: 28.145 Test Acc: 0.382
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 71.88365936279297
Epoch: 8, Steps: 32 | Train Loss: 0.666 Vali Loss: 23.515 Vali Acc: 0.557 Test Loss: 23.515 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 71.31940484046936
Epoch: 9, Steps: 32 | Train Loss: 0.440 Vali Loss: 18.396 Vali Acc: 0.450 Test Loss: 18.396 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 72.00280046463013
Epoch: 10, Steps: 32 | Train Loss: 0.441 Vali Loss: 20.444 Vali Acc: 0.481 Test Loss: 20.444 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 72.16795539855957
Epoch: 11, Steps: 32 | Train Loss: 1.518 Vali Loss: 33.481 Vali Acc: 0.290 Test Loss: 33.481 Test Acc: 0.290
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 71.8179886341095
Epoch: 12, Steps: 32 | Train Loss: 1.202 Vali Loss: 37.645 Vali Acc: 0.481 Test Loss: 37.645 Test Acc: 0.481
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 71.43943643569946
Epoch: 13, Steps: 32 | Train Loss: 0.671 Vali Loss: 35.437 Vali Acc: 0.519 Test Loss: 35.437 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 71.75665140151978
Epoch: 14, Steps: 32 | Train Loss: 0.712 Vali Loss: 42.920 Vali Acc: 0.260 Test Loss: 42.920 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 5633285
model size : 23.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 108.983478307724
Epoch: 1, Steps: 32 | Train Loss: 4.335 Vali Loss: 7.328 Vali Acc: 0.198 Test Loss: 7.328 Test Acc: 0.198
Validation loss decreased (inf --> -0.198400).  Saving model ...
Epoch: 2 cost time: 107.19233012199402
Epoch: 2, Steps: 32 | Train Loss: 3.261 Vali Loss: 4.073 Vali Acc: 0.542 Test Loss: 4.073 Test Acc: 0.542
Validation loss decreased (-0.198400 --> -0.541944).  Saving model ...
Epoch: 3 cost time: 105.77379155158997
Epoch: 3, Steps: 32 | Train Loss: 2.069 Vali Loss: 10.174 Vali Acc: 0.382 Test Loss: 10.174 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 104.55867195129395
Epoch: 4, Steps: 32 | Train Loss: 4.287 Vali Loss: 13.820 Vali Acc: 0.359 Test Loss: 13.820 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 104.53405714035034
Epoch: 5, Steps: 32 | Train Loss: 6.619 Vali Loss: 24.919 Vali Acc: 0.260 Test Loss: 24.919 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 103.76716566085815
Epoch: 6, Steps: 32 | Train Loss: 0.868 Vali Loss: 16.911 Vali Acc: 0.420 Test Loss: 16.911 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 104.54227471351624
Epoch: 7, Steps: 32 | Train Loss: 0.504 Vali Loss: 23.385 Vali Acc: 0.443 Test Loss: 23.385 Test Acc: 0.443
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 104.47414755821228
Epoch: 8, Steps: 32 | Train Loss: 0.246 Vali Loss: 32.564 Vali Acc: 0.458 Test Loss: 32.564 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 104.22856497764587
Epoch: 9, Steps: 32 | Train Loss: 1.194 Vali Loss: 18.384 Vali Acc: 0.496 Test Loss: 18.384 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 102.93921422958374
Epoch: 10, Steps: 32 | Train Loss: 4.337 Vali Loss: 45.562 Vali Acc: 0.504 Test Loss: 45.562 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 105.16769552230835
Epoch: 11, Steps: 32 | Train Loss: 4.222 Vali Loss: 48.841 Vali Acc: 0.336 Test Loss: 48.841 Test Acc: 0.336
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 104.05599594116211
Epoch: 12, Steps: 32 | Train Loss: 6.808 Vali Loss: 31.137 Vali Acc: 0.466 Test Loss: 31.137 Test Acc: 0.466
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 12253701
model size : 48.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 56.36610531806946
Epoch: 1, Steps: 32 | Train Loss: 4.017 Vali Loss: 3.309 Vali Acc: 0.489 Test Loss: 3.309 Test Acc: 0.489
Validation loss decreased (inf --> -0.488517).  Saving model ...
Epoch: 2 cost time: 55.66914749145508
Epoch: 2, Steps: 32 | Train Loss: 3.673 Vali Loss: 5.496 Vali Acc: 0.427 Test Loss: 5.496 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 55.38462734222412
Epoch: 3, Steps: 32 | Train Loss: 1.784 Vali Loss: 11.439 Vali Acc: 0.351 Test Loss: 11.439 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 55.5470552444458
Epoch: 4, Steps: 32 | Train Loss: 2.655 Vali Loss: 17.368 Vali Acc: 0.511 Test Loss: 17.368 Test Acc: 0.511
Validation loss decreased (-0.488517 --> -0.511277).  Saving model ...
Epoch: 5 cost time: 55.190349102020264
Epoch: 5, Steps: 32 | Train Loss: 5.815 Vali Loss: 15.497 Vali Acc: 0.382 Test Loss: 15.497 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 55.60147023200989
Epoch: 6, Steps: 32 | Train Loss: 1.978 Vali Loss: 15.295 Vali Acc: 0.397 Test Loss: 15.295 Test Acc: 0.397
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 55.826088428497314
Epoch: 7, Steps: 32 | Train Loss: 2.812 Vali Loss: 12.900 Vali Acc: 0.542 Test Loss: 12.900 Test Acc: 0.542
Validation loss decreased (-0.511277 --> -0.541856).  Saving model ...
Epoch: 8 cost time: 54.97893214225769
Epoch: 8, Steps: 32 | Train Loss: 4.172 Vali Loss: 24.855 Vali Acc: 0.511 Test Loss: 24.855 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 54.448466300964355
Epoch: 9, Steps: 32 | Train Loss: 1.531 Vali Loss: 35.113 Vali Acc: 0.450 Test Loss: 35.113 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 55.098623514175415
Epoch: 10, Steps: 32 | Train Loss: 0.365 Vali Loss: 34.912 Vali Acc: 0.328 Test Loss: 34.912 Test Acc: 0.328
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 55.51926374435425
Epoch: 11, Steps: 32 | Train Loss: 1.478 Vali Loss: 41.151 Vali Acc: 0.244 Test Loss: 41.151 Test Acc: 0.244
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 55.24024963378906
Epoch: 12, Steps: 32 | Train Loss: 2.716 Vali Loss: 32.011 Vali Acc: 0.527 Test Loss: 32.011 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 54.643351793289185
Epoch: 13, Steps: 32 | Train Loss: 0.339 Vali Loss: 33.042 Vali Acc: 0.542 Test Loss: 33.042 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 55.16780734062195
Epoch: 14, Steps: 32 | Train Loss: 0.322 Vali Loss: 31.488 Vali Acc: 0.405 Test Loss: 31.488 Test Acc: 0.405
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 54.93888831138611
Epoch: 15, Steps: 32 | Train Loss: 1.679 Vali Loss: 44.006 Vali Acc: 0.534 Test Loss: 44.006 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 55.494142055511475
Epoch: 16, Steps: 32 | Train Loss: 1.923 Vali Loss: 30.041 Vali Acc: 0.481 Test Loss: 30.041 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 54.853739738464355
Epoch: 17, Steps: 32 | Train Loss: 2.063 Vali Loss: 39.888 Vali Acc: 0.427 Test Loss: 39.888 Test Acc: 0.427
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 5633285
model size : 23.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 64.91242861747742
Epoch: 1, Steps: 32 | Train Loss: 4.289 Vali Loss: 7.203 Vali Acc: 0.206 Test Loss: 7.203 Test Acc: 0.206
Validation loss decreased (inf --> -0.206035).  Saving model ...
Epoch: 2 cost time: 64.07922530174255
Epoch: 2, Steps: 32 | Train Loss: 3.715 Vali Loss: 13.268 Vali Acc: 0.229 Test Loss: 13.268 Test Acc: 0.229
Validation loss decreased (-0.206035 --> -0.228875).  Saving model ...
Epoch: 3 cost time: 63.4050190448761
Epoch: 3, Steps: 32 | Train Loss: 4.421 Vali Loss: 8.487 Vali Acc: 0.450 Test Loss: 8.487 Test Acc: 0.450
Validation loss decreased (-0.228875 --> -0.450297).  Saving model ...
Epoch: 4 cost time: 63.563138246536255
Epoch: 4, Steps: 32 | Train Loss: 2.570 Vali Loss: 14.722 Vali Acc: 0.527 Test Loss: 14.722 Test Acc: 0.527
Validation loss decreased (-0.450297 --> -0.526570).  Saving model ...
Epoch: 5 cost time: 63.59462022781372
Epoch: 5, Steps: 32 | Train Loss: 2.710 Vali Loss: 22.298 Vali Acc: 0.504 Test Loss: 22.298 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 62.676027059555054
Epoch: 6, Steps: 32 | Train Loss: 3.284 Vali Loss: 19.930 Vali Acc: 0.534 Test Loss: 19.930 Test Acc: 0.534
Validation loss decreased (-0.526570 --> -0.534152).  Saving model ...
Epoch: 7 cost time: 63.35156035423279
Epoch: 7, Steps: 32 | Train Loss: 3.499 Vali Loss: 22.862 Vali Acc: 0.359 Test Loss: 22.862 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 62.30872941017151
Epoch: 8, Steps: 32 | Train Loss: 0.799 Vali Loss: 28.553 Vali Acc: 0.481 Test Loss: 28.553 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 62.872289419174194
Epoch: 9, Steps: 32 | Train Loss: 2.865 Vali Loss: 19.812 Vali Acc: 0.504 Test Loss: 19.812 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 63.10329985618591
Epoch: 10, Steps: 32 | Train Loss: 2.975 Vali Loss: 26.443 Vali Acc: 0.496 Test Loss: 26.443 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 62.95426297187805
Epoch: 11, Steps: 32 | Train Loss: 0.140 Vali Loss: 27.432 Vali Acc: 0.473 Test Loss: 27.432 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 63.305394887924194
Epoch: 12, Steps: 32 | Train Loss: 0.461 Vali Loss: 30.581 Vali Acc: 0.565 Test Loss: 30.581 Test Acc: 0.565
Validation loss decreased (-0.534152 --> -0.564580).  Saving model ...
Epoch: 13 cost time: 63.238659143447876
Epoch: 13, Steps: 32 | Train Loss: 0.651 Vali Loss: 41.988 Vali Acc: 0.542 Test Loss: 41.988 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 63.26778721809387
Epoch: 14, Steps: 32 | Train Loss: 2.617 Vali Loss: 26.823 Vali Acc: 0.504 Test Loss: 26.823 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 63.28511190414429
Epoch: 15, Steps: 32 | Train Loss: 2.303 Vali Loss: 24.309 Vali Acc: 0.466 Test Loss: 24.309 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 63.32152199745178
Epoch: 16, Steps: 32 | Train Loss: 1.470 Vali Loss: 35.848 Vali Acc: 0.511 Test Loss: 35.848 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 63.11068296432495
Epoch: 17, Steps: 32 | Train Loss: 1.306 Vali Loss: 41.939 Vali Acc: 0.466 Test Loss: 41.939 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 62.791380882263184
Epoch: 18, Steps: 32 | Train Loss: 0.695 Vali Loss: 55.875 Vali Acc: 0.527 Test Loss: 55.875 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 62.482763051986694
Epoch: 19, Steps: 32 | Train Loss: 4.935 Vali Loss: 56.069 Vali Acc: 0.550 Test Loss: 56.069 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 63.202423334121704
Epoch: 20, Steps: 32 | Train Loss: 3.023 Vali Loss: 54.958 Vali Acc: 0.321 Test Loss: 54.958 Test Acc: 0.321
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 63.57870364189148
Epoch: 21, Steps: 32 | Train Loss: 0.695 Vali Loss: 51.067 Vali Acc: 0.458 Test Loss: 51.067 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 62.95512318611145
Epoch: 22, Steps: 32 | Train Loss: 0.684 Vali Loss: 55.950 Vali Acc: 0.397 Test Loss: 55.950 Test Acc: 0.397
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 12253701
model size : 48.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 38.45679306983948
Epoch: 1, Steps: 32 | Train Loss: 4.173 Vali Loss: 3.854 Vali Acc: 0.504 Test Loss: 3.854 Test Acc: 0.504
Validation loss decreased (inf --> -0.503778).  Saving model ...
Epoch: 2 cost time: 38.07719612121582
Epoch: 2, Steps: 32 | Train Loss: 2.105 Vali Loss: 7.330 Vali Acc: 0.412 Test Loss: 7.330 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 37.82518553733826
Epoch: 3, Steps: 32 | Train Loss: 4.292 Vali Loss: 7.280 Vali Acc: 0.489 Test Loss: 7.280 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 37.309624910354614
Epoch: 4, Steps: 32 | Train Loss: 1.593 Vali Loss: 14.217 Vali Acc: 0.504 Test Loss: 14.217 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 37.58256411552429
Epoch: 5, Steps: 32 | Train Loss: 1.274 Vali Loss: 16.753 Vali Acc: 0.328 Test Loss: 16.753 Test Acc: 0.328
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 37.35531234741211
Epoch: 6, Steps: 32 | Train Loss: 1.011 Vali Loss: 14.559 Vali Acc: 0.458 Test Loss: 14.559 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 37.73011493682861
Epoch: 7, Steps: 32 | Train Loss: 2.466 Vali Loss: 22.667 Vali Acc: 0.573 Test Loss: 22.667 Test Acc: 0.573
Validation loss decreased (-0.503778 --> -0.572292).  Saving model ...
Epoch: 8 cost time: 37.41231036186218
Epoch: 8, Steps: 32 | Train Loss: 3.283 Vali Loss: 21.472 Vali Acc: 0.565 Test Loss: 21.472 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 37.43946075439453
Epoch: 9, Steps: 32 | Train Loss: 1.852 Vali Loss: 36.363 Vali Acc: 0.527 Test Loss: 36.363 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 37.46336078643799
Epoch: 10, Steps: 32 | Train Loss: 3.157 Vali Loss: 18.644 Vali Acc: 0.557 Test Loss: 18.644 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 36.44956111907959
Epoch: 11, Steps: 32 | Train Loss: 1.814 Vali Loss: 27.316 Vali Acc: 0.481 Test Loss: 27.316 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 36.97919011116028
Epoch: 12, Steps: 32 | Train Loss: 4.693 Vali Loss: 25.635 Vali Acc: 0.504 Test Loss: 25.635 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 37.22608995437622
Epoch: 13, Steps: 32 | Train Loss: 0.930 Vali Loss: 27.853 Vali Acc: 0.473 Test Loss: 27.853 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 37.3113272190094
Epoch: 14, Steps: 32 | Train Loss: 0.526 Vali Loss: 30.925 Vali Acc: 0.466 Test Loss: 30.925 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 37.26271963119507
Epoch: 15, Steps: 32 | Train Loss: 1.063 Vali Loss: 43.121 Vali Acc: 0.321 Test Loss: 43.121 Test Acc: 0.321
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 36.56097936630249
Epoch: 16, Steps: 32 | Train Loss: 1.816 Vali Loss: 33.056 Vali Acc: 0.366 Test Loss: 33.056 Test Acc: 0.366
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 37.380595445632935
Epoch: 17, Steps: 32 | Train Loss: 2.077 Vali Loss: 40.054 Vali Acc: 0.458 Test Loss: 40.054 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 5633285
model size : 23.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 83.51024341583252
Epoch: 1, Steps: 32 | Train Loss: 4.627 Vali Loss: 4.749 Vali Acc: 0.298 Test Loss: 4.749 Test Acc: 0.298
Validation loss decreased (inf --> -0.297662).  Saving model ...
Epoch: 2 cost time: 82.04848098754883
Epoch: 2, Steps: 32 | Train Loss: 2.979 Vali Loss: 6.288 Vali Acc: 0.420 Test Loss: 6.288 Test Acc: 0.420
Validation loss decreased (-0.297662 --> -0.419784).  Saving model ...
Epoch: 3 cost time: 82.33442521095276
Epoch: 3, Steps: 32 | Train Loss: 1.533 Vali Loss: 10.669 Vali Acc: 0.565 Test Loss: 10.669 Test Acc: 0.565
Validation loss decreased (-0.419784 --> -0.564779).  Saving model ...
Epoch: 4 cost time: 82.48961329460144
Epoch: 4, Steps: 32 | Train Loss: 0.639 Vali Loss: 14.780 Vali Acc: 0.542 Test Loss: 14.780 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 82.02824091911316
Epoch: 5, Steps: 32 | Train Loss: 2.459 Vali Loss: 16.604 Vali Acc: 0.519 Test Loss: 16.604 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 81.77118301391602
Epoch: 6, Steps: 32 | Train Loss: 2.489 Vali Loss: 15.047 Vali Acc: 0.588 Test Loss: 15.047 Test Acc: 0.588
Validation loss decreased (-0.564779 --> -0.587636).  Saving model ...
Epoch: 7 cost time: 80.95486211776733
Epoch: 7, Steps: 32 | Train Loss: 2.071 Vali Loss: 12.277 Vali Acc: 0.473 Test Loss: 12.277 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 80.98148226737976
Epoch: 8, Steps: 32 | Train Loss: 1.788 Vali Loss: 22.524 Vali Acc: 0.511 Test Loss: 22.524 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 81.5422101020813
Epoch: 9, Steps: 32 | Train Loss: 1.187 Vali Loss: 22.866 Vali Acc: 0.412 Test Loss: 22.866 Test Acc: 0.412
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 81.1033239364624
Epoch: 10, Steps: 32 | Train Loss: 0.672 Vali Loss: 36.611 Vali Acc: 0.450 Test Loss: 36.611 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 80.77714347839355
Epoch: 11, Steps: 32 | Train Loss: 3.617 Vali Loss: 38.947 Vali Acc: 0.542 Test Loss: 38.947 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 80.50895714759827
Epoch: 12, Steps: 32 | Train Loss: 3.341 Vali Loss: 32.011 Vali Acc: 0.458 Test Loss: 32.011 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 80.63980340957642
Epoch: 13, Steps: 32 | Train Loss: 3.274 Vali Loss: 58.838 Vali Acc: 0.511 Test Loss: 58.838 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 81.48903393745422
Epoch: 14, Steps: 32 | Train Loss: 3.093 Vali Loss: 51.085 Vali Acc: 0.397 Test Loss: 51.085 Test Acc: 0.397
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 81.02294611930847
Epoch: 15, Steps: 32 | Train Loss: 2.527 Vali Loss: 66.547 Vali Acc: 0.527 Test Loss: 66.547 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 81.56528949737549
Epoch: 16, Steps: 32 | Train Loss: 1.692 Vali Loss: 37.434 Vali Acc: 0.450 Test Loss: 37.434 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 7566341
model size : 31.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 42.0791175365448
Epoch: 1, Steps: 32 | Train Loss: 3.603 Vali Loss: 3.692 Vali Acc: 0.206 Test Loss: 3.692 Test Acc: 0.206
Validation loss decreased (inf --> -0.206070).  Saving model ...
Epoch: 2 cost time: 42.328691482543945
Epoch: 2, Steps: 32 | Train Loss: 3.960 Vali Loss: 6.557 Vali Acc: 0.344 Test Loss: 6.557 Test Acc: 0.344
Validation loss decreased (-0.206070 --> -0.343446).  Saving model ...
Epoch: 3 cost time: 41.70689654350281
Epoch: 3, Steps: 32 | Train Loss: 2.901 Vali Loss: 10.547 Vali Acc: 0.282 Test Loss: 10.547 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 41.949928283691406
Epoch: 4, Steps: 32 | Train Loss: 2.608 Vali Loss: 10.700 Vali Acc: 0.458 Test Loss: 10.700 Test Acc: 0.458
Validation loss decreased (-0.343446 --> -0.457908).  Saving model ...
Epoch: 5 cost time: 41.685969829559326
Epoch: 5, Steps: 32 | Train Loss: 2.503 Vali Loss: 20.624 Vali Acc: 0.328 Test Loss: 20.624 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 40.78041076660156
Epoch: 6, Steps: 32 | Train Loss: 2.663 Vali Loss: 21.180 Vali Acc: 0.366 Test Loss: 21.180 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 40.00013041496277
Epoch: 7, Steps: 32 | Train Loss: 1.373 Vali Loss: 26.311 Vali Acc: 0.550 Test Loss: 26.311 Test Acc: 0.550
Validation loss decreased (-0.457908 --> -0.549355).  Saving model ...
Epoch: 8 cost time: 40.308005809783936
Epoch: 8, Steps: 32 | Train Loss: 2.265 Vali Loss: 33.727 Vali Acc: 0.252 Test Loss: 33.727 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 40.77305340766907
Epoch: 9, Steps: 32 | Train Loss: 1.703 Vali Loss: 38.916 Vali Acc: 0.267 Test Loss: 38.916 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 41.0712354183197
Epoch: 10, Steps: 32 | Train Loss: 1.411 Vali Loss: 51.476 Vali Acc: 0.267 Test Loss: 51.476 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 40.49453592300415
Epoch: 11, Steps: 32 | Train Loss: 1.415 Vali Loss: 32.063 Vali Acc: 0.397 Test Loss: 32.063 Test Acc: 0.397
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 40.67730402946472
Epoch: 12, Steps: 32 | Train Loss: 2.418 Vali Loss: 55.310 Vali Acc: 0.260 Test Loss: 55.310 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 40.98119115829468
Epoch: 13, Steps: 32 | Train Loss: 1.997 Vali Loss: 55.943 Vali Acc: 0.275 Test Loss: 55.943 Test Acc: 0.275
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 41.000311851501465
Epoch: 14, Steps: 32 | Train Loss: 2.650 Vali Loss: 46.924 Vali Acc: 0.557 Test Loss: 46.924 Test Acc: 0.557
Validation loss decreased (-0.549355 --> -0.556783).  Saving model ...
Epoch: 15 cost time: 40.29571580886841
Epoch: 15, Steps: 32 | Train Loss: 2.614 Vali Loss: 40.152 Vali Acc: 0.397 Test Loss: 40.152 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 40.85419702529907
Epoch: 16, Steps: 32 | Train Loss: 0.010 Vali Loss: 36.395 Vali Acc: 0.374 Test Loss: 36.395 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 40.87902021408081
Epoch: 17, Steps: 32 | Train Loss: 0.119 Vali Loss: 38.629 Vali Acc: 0.496 Test Loss: 38.629 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 40.55265665054321
Epoch: 18, Steps: 32 | Train Loss: 0.921 Vali Loss: 44.152 Vali Acc: 0.557 Test Loss: 44.152 Test Acc: 0.557
Validation loss decreased (-0.556783 --> -0.556810).  Saving model ...
Epoch: 19 cost time: 40.431668519973755
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 37.092 Vali Acc: 0.435 Test Loss: 37.092 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 40.65653371810913
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 37.097 Vali Acc: 0.427 Test Loss: 37.097 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 40.73536968231201
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 37.097 Vali Acc: 0.427 Test Loss: 37.097 Test Acc: 0.427
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 40.53420877456665
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 37.097 Vali Acc: 0.427 Test Loss: 37.097 Test Acc: 0.427
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 40.44867753982544
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 37.097 Vali Acc: 0.427 Test Loss: 37.097 Test Acc: 0.427
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 40.57035255432129
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 37.097 Vali Acc: 0.427 Test Loss: 37.097 Test Acc: 0.427
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 40.6943793296814
Epoch: 25, Steps: 32 | Train Loss: 0.000 Vali Loss: 37.097 Vali Acc: 0.427 Test Loss: 37.097 Test Acc: 0.427
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 41.15261960029602
Epoch: 26, Steps: 32 | Train Loss: 0.000 Vali Loss: 37.097 Vali Acc: 0.427 Test Loss: 37.097 Test Acc: 0.427
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 40.94357371330261
Epoch: 27, Steps: 32 | Train Loss: 0.000 Vali Loss: 37.097 Vali Acc: 0.427 Test Loss: 37.097 Test Acc: 0.427
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 40.606791257858276
Epoch: 28, Steps: 32 | Train Loss: 0.000 Vali Loss: 37.097 Vali Acc: 0.427 Test Loss: 37.097 Test Acc: 0.427
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 4256005
model size : 18.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 59.48493552207947
Epoch: 1, Steps: 32 | Train Loss: 4.628 Vali Loss: 4.761 Vali Acc: 0.282 Test Loss: 4.761 Test Acc: 0.282
Validation loss decreased (inf --> -0.282395).  Saving model ...
Epoch: 2 cost time: 58.20029664039612
Epoch: 2, Steps: 32 | Train Loss: 3.079 Vali Loss: 4.532 Vali Acc: 0.496 Test Loss: 4.532 Test Acc: 0.496
Validation loss decreased (-0.282395 --> -0.496138).  Saving model ...
Epoch: 3 cost time: 57.98117542266846
Epoch: 3, Steps: 32 | Train Loss: 2.736 Vali Loss: 16.969 Vali Acc: 0.534 Test Loss: 16.969 Test Acc: 0.534
Validation loss decreased (-0.496138 --> -0.534181).  Saving model ...
Epoch: 4 cost time: 57.62977886199951
Epoch: 4, Steps: 32 | Train Loss: 3.183 Vali Loss: 13.143 Vali Acc: 0.527 Test Loss: 13.143 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 57.14732336997986
Epoch: 5, Steps: 32 | Train Loss: 1.556 Vali Loss: 12.978 Vali Acc: 0.534 Test Loss: 12.978 Test Acc: 0.534
Validation loss decreased (-0.534181 --> -0.534221).  Saving model ...
Epoch: 6 cost time: 56.64263868331909
Epoch: 6, Steps: 32 | Train Loss: 0.948 Vali Loss: 24.103 Vali Acc: 0.511 Test Loss: 24.103 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 56.277148485183716
Epoch: 7, Steps: 32 | Train Loss: 0.550 Vali Loss: 17.848 Vali Acc: 0.519 Test Loss: 17.848 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 56.60193395614624
Epoch: 8, Steps: 32 | Train Loss: 2.624 Vali Loss: 28.099 Vali Acc: 0.542 Test Loss: 28.099 Test Acc: 0.542
Validation loss decreased (-0.534221 --> -0.541704).  Saving model ...
Epoch: 9 cost time: 56.64177894592285
Epoch: 9, Steps: 32 | Train Loss: 0.671 Vali Loss: 26.896 Vali Acc: 0.405 Test Loss: 26.896 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 57.181907415390015
Epoch: 10, Steps: 32 | Train Loss: 0.698 Vali Loss: 19.583 Vali Acc: 0.511 Test Loss: 19.583 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 56.76844930648804
Epoch: 11, Steps: 32 | Train Loss: 0.430 Vali Loss: 21.543 Vali Acc: 0.573 Test Loss: 21.543 Test Acc: 0.573
Validation loss decreased (-0.541704 --> -0.572304).  Saving model ...
Epoch: 12 cost time: 57.12309765815735
Epoch: 12, Steps: 32 | Train Loss: 4.795 Vali Loss: 43.522 Vali Acc: 0.511 Test Loss: 43.522 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 56.240092277526855
Epoch: 13, Steps: 32 | Train Loss: 4.568 Vali Loss: 42.462 Vali Acc: 0.466 Test Loss: 42.462 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 57.09421968460083
Epoch: 14, Steps: 32 | Train Loss: 2.361 Vali Loss: 40.481 Vali Acc: 0.527 Test Loss: 40.481 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 57.01451230049133
Epoch: 15, Steps: 32 | Train Loss: 1.928 Vali Loss: 50.047 Vali Acc: 0.389 Test Loss: 50.047 Test Acc: 0.389
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 56.189279079437256
Epoch: 16, Steps: 32 | Train Loss: 1.770 Vali Loss: 35.831 Vali Acc: 0.496 Test Loss: 35.831 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 56.58332586288452
Epoch: 17, Steps: 32 | Train Loss: 2.644 Vali Loss: 39.921 Vali Acc: 0.519 Test Loss: 39.921 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 55.53471088409424
Epoch: 18, Steps: 32 | Train Loss: 0.628 Vali Loss: 39.446 Vali Acc: 0.374 Test Loss: 39.446 Test Acc: 0.374
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 55.82113599777222
Epoch: 19, Steps: 32 | Train Loss: 2.489 Vali Loss: 93.115 Vali Acc: 0.221 Test Loss: 93.115 Test Acc: 0.221
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 56.412456035614014
Epoch: 20, Steps: 32 | Train Loss: 6.519 Vali Loss: 65.896 Vali Acc: 0.511 Test Loss: 65.896 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 56.015294551849365
Epoch: 21, Steps: 32 | Train Loss: 1.955 Vali Loss: 57.076 Vali Acc: 0.366 Test Loss: 57.076 Test Acc: 0.366
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 7566341
model size : 31.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 31.33066415786743
Epoch: 1, Steps: 32 | Train Loss: 3.593 Vali Loss: 3.258 Vali Acc: 0.198 Test Loss: 3.258 Test Acc: 0.198
Validation loss decreased (inf --> -0.198441).  Saving model ...
Epoch: 2 cost time: 30.80763053894043
Epoch: 2, Steps: 32 | Train Loss: 2.846 Vali Loss: 3.562 Vali Acc: 0.405 Test Loss: 3.562 Test Acc: 0.405
Validation loss decreased (-0.198441 --> -0.404545).  Saving model ...
Epoch: 3 cost time: 30.530251502990723
Epoch: 3, Steps: 32 | Train Loss: 4.368 Vali Loss: 11.617 Vali Acc: 0.237 Test Loss: 11.617 Test Acc: 0.237
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 30.018298625946045
Epoch: 4, Steps: 32 | Train Loss: 0.992 Vali Loss: 9.607 Vali Acc: 0.351 Test Loss: 9.607 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 30.316104650497437
Epoch: 5, Steps: 32 | Train Loss: 0.961 Vali Loss: 12.104 Vali Acc: 0.473 Test Loss: 12.104 Test Acc: 0.473
Validation loss decreased (-0.404545 --> -0.473161).  Saving model ...
Epoch: 6 cost time: 29.672714233398438
Epoch: 6, Steps: 32 | Train Loss: 3.500 Vali Loss: 17.697 Vali Acc: 0.389 Test Loss: 17.697 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 30.0263671875
Epoch: 7, Steps: 32 | Train Loss: 2.091 Vali Loss: 25.878 Vali Acc: 0.489 Test Loss: 25.878 Test Acc: 0.489
Validation loss decreased (-0.473161 --> -0.488291).  Saving model ...
Epoch: 8 cost time: 29.82333469390869
Epoch: 8, Steps: 32 | Train Loss: 2.717 Vali Loss: 37.333 Vali Acc: 0.198 Test Loss: 37.333 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 29.793559312820435
Epoch: 9, Steps: 32 | Train Loss: 4.262 Vali Loss: 24.486 Vali Acc: 0.565 Test Loss: 24.486 Test Acc: 0.565
Validation loss decreased (-0.488291 --> -0.564641).  Saving model ...
Epoch: 10 cost time: 29.80786442756653
Epoch: 10, Steps: 32 | Train Loss: 1.486 Vali Loss: 29.525 Vali Acc: 0.534 Test Loss: 29.525 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 28.979439735412598
Epoch: 11, Steps: 32 | Train Loss: 0.439 Vali Loss: 46.011 Vali Acc: 0.496 Test Loss: 46.011 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 29.240938901901245
Epoch: 12, Steps: 32 | Train Loss: 2.436 Vali Loss: 35.736 Vali Acc: 0.496 Test Loss: 35.736 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 29.409059286117554
Epoch: 13, Steps: 32 | Train Loss: 1.226 Vali Loss: 24.783 Vali Acc: 0.489 Test Loss: 24.783 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 29.795586585998535
Epoch: 14, Steps: 32 | Train Loss: 2.656 Vali Loss: 75.789 Vali Acc: 0.221 Test Loss: 75.789 Test Acc: 0.221
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 29.629743576049805
Epoch: 15, Steps: 32 | Train Loss: 1.334 Vali Loss: 75.395 Vali Acc: 0.237 Test Loss: 75.395 Test Acc: 0.237
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 29.441537380218506
Epoch: 16, Steps: 32 | Train Loss: 0.473 Vali Loss: 54.792 Vali Acc: 0.366 Test Loss: 54.792 Test Acc: 0.366
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 29.582927227020264
Epoch: 17, Steps: 32 | Train Loss: 1.779 Vali Loss: 56.361 Vali Acc: 0.313 Test Loss: 56.361 Test Acc: 0.313
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 28.98432159423828
Epoch: 18, Steps: 32 | Train Loss: 0.233 Vali Loss: 53.767 Vali Acc: 0.336 Test Loss: 53.767 Test Acc: 0.336
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 29.464824438095093
Epoch: 19, Steps: 32 | Train Loss: 1.669 Vali Loss: 39.971 Vali Acc: 0.481 Test Loss: 39.971 Test Acc: 0.481
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 4256005
model size : 18.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 33.90818166732788
Epoch: 1, Steps: 32 | Train Loss: 4.676 Vali Loss: 5.268 Vali Acc: 0.267 Test Loss: 5.268 Test Acc: 0.267
Validation loss decreased (inf --> -0.267123).  Saving model ...
Epoch: 2 cost time: 33.23854684829712
Epoch: 2, Steps: 32 | Train Loss: 2.746 Vali Loss: 8.596 Vali Acc: 0.313 Test Loss: 8.596 Test Acc: 0.313
Validation loss decreased (-0.267123 --> -0.312891).  Saving model ...
Epoch: 3 cost time: 33.21628022193909
Epoch: 3, Steps: 32 | Train Loss: 2.243 Vali Loss: 16.963 Vali Acc: 0.519 Test Loss: 16.963 Test Acc: 0.519
Validation loss decreased (-0.312891 --> -0.518914).  Saving model ...
Epoch: 4 cost time: 33.10470509529114
Epoch: 4, Steps: 32 | Train Loss: 2.656 Vali Loss: 12.966 Vali Acc: 0.534 Test Loss: 12.966 Test Acc: 0.534
Validation loss decreased (-0.518914 --> -0.534221).  Saving model ...
Epoch: 5 cost time: 32.88452506065369
Epoch: 5, Steps: 32 | Train Loss: 2.020 Vali Loss: 16.087 Vali Acc: 0.511 Test Loss: 16.087 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 32.63079810142517
Epoch: 6, Steps: 32 | Train Loss: 1.202 Vali Loss: 15.560 Vali Acc: 0.550 Test Loss: 15.560 Test Acc: 0.550
Validation loss decreased (-0.534221 --> -0.549463).  Saving model ...
Epoch: 7 cost time: 32.627686977386475
Epoch: 7, Steps: 32 | Train Loss: 0.475 Vali Loss: 17.095 Vali Acc: 0.588 Test Loss: 17.095 Test Acc: 0.588
Validation loss decreased (-0.549463 --> -0.587615).  Saving model ...
Epoch: 8 cost time: 32.78270959854126
Epoch: 8, Steps: 32 | Train Loss: 0.121 Vali Loss: 19.187 Vali Acc: 0.504 Test Loss: 19.187 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 32.63500666618347
Epoch: 9, Steps: 32 | Train Loss: 1.025 Vali Loss: 17.552 Vali Acc: 0.557 Test Loss: 17.552 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 32.68020033836365
Epoch: 10, Steps: 32 | Train Loss: 1.932 Vali Loss: 26.089 Vali Acc: 0.473 Test Loss: 26.089 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 32.650243043899536
Epoch: 11, Steps: 32 | Train Loss: 1.441 Vali Loss: 25.433 Vali Acc: 0.550 Test Loss: 25.433 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 32.480672121047974
Epoch: 12, Steps: 32 | Train Loss: 0.919 Vali Loss: 22.594 Vali Acc: 0.527 Test Loss: 22.594 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 32.39796018600464
Epoch: 13, Steps: 32 | Train Loss: 1.613 Vali Loss: 28.853 Vali Acc: 0.519 Test Loss: 28.853 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 32.28634977340698
Epoch: 14, Steps: 32 | Train Loss: 1.648 Vali Loss: 34.744 Vali Acc: 0.481 Test Loss: 34.744 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 33.02508807182312
Epoch: 15, Steps: 32 | Train Loss: 1.676 Vali Loss: 35.477 Vali Acc: 0.542 Test Loss: 35.477 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 32.75910425186157
Epoch: 16, Steps: 32 | Train Loss: 0.957 Vali Loss: 38.921 Vali Acc: 0.489 Test Loss: 38.921 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 32.06182527542114
Epoch: 17, Steps: 32 | Train Loss: 2.179 Vali Loss: 41.645 Vali Acc: 0.336 Test Loss: 41.645 Test Acc: 0.336
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 7566341
model size : 31.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 19.96198296546936
Epoch: 1, Steps: 32 | Train Loss: 3.571 Vali Loss: 3.434 Vali Acc: 0.198 Test Loss: 3.434 Test Acc: 0.198
Validation loss decreased (inf --> -0.198439).  Saving model ...
Epoch: 2 cost time: 19.31916379928589
Epoch: 2, Steps: 32 | Train Loss: 3.149 Vali Loss: 3.087 Vali Acc: 0.466 Test Loss: 3.087 Test Acc: 0.466
Validation loss decreased (-0.198439 --> -0.465618).  Saving model ...
Epoch: 3 cost time: 18.956637144088745
Epoch: 3, Steps: 32 | Train Loss: 1.407 Vali Loss: 15.211 Vali Acc: 0.290 Test Loss: 15.211 Test Acc: 0.290
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 19.139021158218384
Epoch: 4, Steps: 32 | Train Loss: 2.695 Vali Loss: 6.272 Vali Acc: 0.489 Test Loss: 6.272 Test Acc: 0.489
Validation loss decreased (-0.465618 --> -0.488487).  Saving model ...
Epoch: 5 cost time: 19.011225938796997
Epoch: 5, Steps: 32 | Train Loss: 0.970 Vali Loss: 12.662 Vali Acc: 0.565 Test Loss: 12.662 Test Acc: 0.565
Validation loss decreased (-0.488487 --> -0.564759).  Saving model ...
Epoch: 6 cost time: 19.096813440322876
Epoch: 6, Steps: 32 | Train Loss: 1.866 Vali Loss: 20.322 Vali Acc: 0.359 Test Loss: 20.322 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 19.17375349998474
Epoch: 7, Steps: 32 | Train Loss: 1.595 Vali Loss: 18.375 Vali Acc: 0.573 Test Loss: 18.375 Test Acc: 0.573
Validation loss decreased (-0.564759 --> -0.572335).  Saving model ...
Epoch: 8 cost time: 19.229487895965576
Epoch: 8, Steps: 32 | Train Loss: 0.724 Vali Loss: 18.932 Vali Acc: 0.519 Test Loss: 18.932 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 18.74992084503174
Epoch: 9, Steps: 32 | Train Loss: 1.808 Vali Loss: 29.272 Vali Acc: 0.275 Test Loss: 29.272 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 18.724488735198975
Epoch: 10, Steps: 32 | Train Loss: 1.892 Vali Loss: 43.500 Vali Acc: 0.275 Test Loss: 43.500 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 18.97256588935852
Epoch: 11, Steps: 32 | Train Loss: 2.834 Vali Loss: 43.591 Vali Acc: 0.351 Test Loss: 43.591 Test Acc: 0.351
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 18.713648557662964
Epoch: 12, Steps: 32 | Train Loss: 1.352 Vali Loss: 30.273 Vali Acc: 0.374 Test Loss: 30.273 Test Acc: 0.374
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 18.655290126800537
Epoch: 13, Steps: 32 | Train Loss: 1.170 Vali Loss: 35.522 Vali Acc: 0.573 Test Loss: 35.522 Test Acc: 0.573
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 18.666978359222412
Epoch: 14, Steps: 32 | Train Loss: 0.624 Vali Loss: 36.415 Vali Acc: 0.397 Test Loss: 36.415 Test Acc: 0.397
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 18.417563915252686
Epoch: 15, Steps: 32 | Train Loss: 1.956 Vali Loss: 68.867 Vali Acc: 0.252 Test Loss: 68.867 Test Acc: 0.252
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 18.642480611801147
Epoch: 16, Steps: 32 | Train Loss: 1.804 Vali Loss: 52.127 Vali Acc: 0.305 Test Loss: 52.127 Test Acc: 0.305
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 18.889124155044556
Epoch: 17, Steps: 32 | Train Loss: 2.504 Vali Loss: 48.238 Vali Acc: 0.374 Test Loss: 48.238 Test Acc: 0.374
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 4256005
model size : 18.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 49.68291687965393
Epoch: 1, Steps: 32 | Train Loss: 5.643 Vali Loss: 10.275 Vali Acc: 0.351 Test Loss: 10.275 Test Acc: 0.351
Validation loss decreased (inf --> -0.351042).  Saving model ...
Epoch: 2 cost time: 48.57184314727783
Epoch: 2, Steps: 32 | Train Loss: 5.424 Vali Loss: 6.283 Vali Acc: 0.443 Test Loss: 6.283 Test Acc: 0.443
Validation loss decreased (-0.351042 --> -0.442685).  Saving model ...
Epoch: 3 cost time: 48.1172513961792
Epoch: 3, Steps: 32 | Train Loss: 1.495 Vali Loss: 7.329 Vali Acc: 0.473 Test Loss: 7.329 Test Acc: 0.473
Validation loss decreased (-0.442685 --> -0.473209).  Saving model ...
Epoch: 4 cost time: 47.577338457107544
Epoch: 4, Steps: 32 | Train Loss: 2.572 Vali Loss: 22.735 Vali Acc: 0.550 Test Loss: 22.735 Test Acc: 0.550
Validation loss decreased (-0.473209 --> -0.549391).  Saving model ...
Epoch: 5 cost time: 47.44391131401062
Epoch: 5, Steps: 32 | Train Loss: 5.898 Vali Loss: 21.877 Vali Acc: 0.359 Test Loss: 21.877 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 48.17655158042908
Epoch: 6, Steps: 32 | Train Loss: 2.421 Vali Loss: 26.320 Vali Acc: 0.336 Test Loss: 26.320 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 48.04999804496765
Epoch: 7, Steps: 32 | Train Loss: 1.712 Vali Loss: 16.923 Vali Acc: 0.405 Test Loss: 16.923 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 47.771329402923584
Epoch: 8, Steps: 32 | Train Loss: 1.980 Vali Loss: 32.390 Vali Acc: 0.313 Test Loss: 32.390 Test Acc: 0.313
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 47.253497838974
Epoch: 9, Steps: 32 | Train Loss: 1.449 Vali Loss: 22.098 Vali Acc: 0.519 Test Loss: 22.098 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 46.83220601081848
Epoch: 10, Steps: 32 | Train Loss: 1.052 Vali Loss: 40.725 Vali Acc: 0.359 Test Loss: 40.725 Test Acc: 0.359
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 47.01419758796692
Epoch: 11, Steps: 32 | Train Loss: 2.518 Vali Loss: 30.653 Vali Acc: 0.321 Test Loss: 30.653 Test Acc: 0.321
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 46.70424437522888
Epoch: 12, Steps: 32 | Train Loss: 1.081 Vali Loss: 45.650 Vali Acc: 0.382 Test Loss: 45.650 Test Acc: 0.382
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 46.7997350692749
Epoch: 13, Steps: 32 | Train Loss: 2.868 Vali Loss: 47.416 Vali Acc: 0.519 Test Loss: 47.416 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 46.91848969459534
Epoch: 14, Steps: 32 | Train Loss: 1.657 Vali Loss: 49.388 Vali Acc: 0.603 Test Loss: 49.388 Test Acc: 0.603
Validation loss decreased (-0.549391 --> -0.602560).  Saving model ...
Epoch: 15 cost time: 47.53478765487671
Epoch: 15, Steps: 32 | Train Loss: 0.712 Vali Loss: 42.531 Vali Acc: 0.504 Test Loss: 42.531 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 46.65660262107849
Epoch: 16, Steps: 32 | Train Loss: 0.835 Vali Loss: 38.565 Vali Acc: 0.443 Test Loss: 38.565 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 47.191205978393555
Epoch: 17, Steps: 32 | Train Loss: 1.285 Vali Loss: 74.609 Vali Acc: 0.290 Test Loss: 74.609 Test Acc: 0.290
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 47.6623592376709
Epoch: 18, Steps: 32 | Train Loss: 0.090 Vali Loss: 58.461 Vali Acc: 0.397 Test Loss: 58.461 Test Acc: 0.397
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 47.18310809135437
Epoch: 19, Steps: 32 | Train Loss: 1.432 Vali Loss: 53.924 Vali Acc: 0.550 Test Loss: 53.924 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 46.92201638221741
Epoch: 20, Steps: 32 | Train Loss: 0.148 Vali Loss: 55.097 Vali Acc: 0.412 Test Loss: 55.097 Test Acc: 0.412
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 47.23981714248657
Epoch: 21, Steps: 32 | Train Loss: 1.382 Vali Loss: 67.158 Vali Acc: 0.366 Test Loss: 67.158 Test Acc: 0.366
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 47.75089931488037
Epoch: 22, Steps: 32 | Train Loss: 0.842 Vali Loss: 57.748 Vali Acc: 0.397 Test Loss: 57.748 Test Acc: 0.397
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 47.48465657234192
Epoch: 23, Steps: 32 | Train Loss: 0.198 Vali Loss: 61.715 Vali Acc: 0.504 Test Loss: 61.715 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 47.36471724510193
Epoch: 24, Steps: 32 | Train Loss: 0.457 Vali Loss: 63.668 Vali Acc: 0.481 Test Loss: 63.668 Test Acc: 0.481
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6030534351145038
model parameter : 5222661
model size : 22.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 26.012061595916748
Epoch: 1, Steps: 32 | Train Loss: 4.866 Vali Loss: 8.182 Vali Acc: 0.221 Test Loss: 8.182 Test Acc: 0.221
Validation loss decreased (inf --> -0.221292).  Saving model ...
Epoch: 2 cost time: 25.437591552734375
Epoch: 2, Steps: 32 | Train Loss: 2.813 Vali Loss: 9.148 Vali Acc: 0.328 Test Loss: 9.148 Test Acc: 0.328
Validation loss decreased (-0.221292 --> -0.328153).  Saving model ...
Epoch: 3 cost time: 25.32526421546936
Epoch: 3, Steps: 32 | Train Loss: 3.290 Vali Loss: 11.619 Vali Acc: 0.565 Test Loss: 11.619 Test Acc: 0.565
Validation loss decreased (-0.328153 --> -0.564769).  Saving model ...
Epoch: 4 cost time: 25.295207738876343
Epoch: 4, Steps: 32 | Train Loss: 2.903 Vali Loss: 22.246 Vali Acc: 0.420 Test Loss: 22.246 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 25.071927785873413
Epoch: 5, Steps: 32 | Train Loss: 3.708 Vali Loss: 14.691 Vali Acc: 0.412 Test Loss: 14.691 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 25.187767267227173
Epoch: 6, Steps: 32 | Train Loss: 2.145 Vali Loss: 20.619 Vali Acc: 0.527 Test Loss: 20.619 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 25.012593030929565
Epoch: 7, Steps: 32 | Train Loss: 2.024 Vali Loss: 20.644 Vali Acc: 0.466 Test Loss: 20.644 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 25.130562782287598
Epoch: 8, Steps: 32 | Train Loss: 1.634 Vali Loss: 21.987 Vali Acc: 0.405 Test Loss: 21.987 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 25.216604471206665
Epoch: 9, Steps: 32 | Train Loss: 0.463 Vali Loss: 27.064 Vali Acc: 0.511 Test Loss: 27.064 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 25.28172540664673
Epoch: 10, Steps: 32 | Train Loss: 0.791 Vali Loss: 20.746 Vali Acc: 0.397 Test Loss: 20.746 Test Acc: 0.397
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 25.259825706481934
Epoch: 11, Steps: 32 | Train Loss: 0.038 Vali Loss: 25.746 Vali Acc: 0.389 Test Loss: 25.746 Test Acc: 0.389
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 24.96329641342163
Epoch: 12, Steps: 32 | Train Loss: 0.520 Vali Loss: 23.835 Vali Acc: 0.435 Test Loss: 23.835 Test Acc: 0.435
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 25.10791301727295
Epoch: 13, Steps: 32 | Train Loss: 1.225 Vali Loss: 35.999 Vali Acc: 0.496 Test Loss: 35.999 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 3567365
model size : 15.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 34.51469445228577
Epoch: 1, Steps: 32 | Train Loss: 5.640 Vali Loss: 10.313 Vali Acc: 0.344 Test Loss: 10.313 Test Acc: 0.344
Validation loss decreased (inf --> -0.343408).  Saving model ...
Epoch: 2 cost time: 33.55355620384216
Epoch: 2, Steps: 32 | Train Loss: 5.344 Vali Loss: 6.319 Vali Acc: 0.527 Test Loss: 6.319 Test Acc: 0.527
Validation loss decreased (-0.343408 --> -0.526654).  Saving model ...
Epoch: 3 cost time: 32.756126403808594
Epoch: 3, Steps: 32 | Train Loss: 1.948 Vali Loss: 12.417 Vali Acc: 0.267 Test Loss: 12.417 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 32.04809808731079
Epoch: 4, Steps: 32 | Train Loss: 2.490 Vali Loss: 11.032 Vali Acc: 0.504 Test Loss: 11.032 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 31.933148622512817
Epoch: 5, Steps: 32 | Train Loss: 0.923 Vali Loss: 10.901 Vali Acc: 0.389 Test Loss: 10.901 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 32.31752419471741
Epoch: 6, Steps: 32 | Train Loss: 0.516 Vali Loss: 20.078 Vali Acc: 0.237 Test Loss: 20.078 Test Acc: 0.237
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 31.787065982818604
Epoch: 7, Steps: 32 | Train Loss: 1.134 Vali Loss: 19.953 Vali Acc: 0.542 Test Loss: 19.953 Test Acc: 0.542
Validation loss decreased (-0.526654 --> -0.541785).  Saving model ...
Epoch: 8 cost time: 31.886104583740234
Epoch: 8, Steps: 32 | Train Loss: 1.425 Vali Loss: 17.907 Vali Acc: 0.458 Test Loss: 17.907 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 31.724387407302856
Epoch: 9, Steps: 32 | Train Loss: 4.124 Vali Loss: 25.050 Vali Acc: 0.328 Test Loss: 25.050 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 31.81839609146118
Epoch: 10, Steps: 32 | Train Loss: 1.651 Vali Loss: 27.504 Vali Acc: 0.374 Test Loss: 27.504 Test Acc: 0.374
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 32.256704807281494
Epoch: 11, Steps: 32 | Train Loss: 1.147 Vali Loss: 37.806 Vali Acc: 0.511 Test Loss: 37.806 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 31.951942443847656
Epoch: 12, Steps: 32 | Train Loss: 0.750 Vali Loss: 29.813 Vali Acc: 0.374 Test Loss: 29.813 Test Acc: 0.374
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 32.19700336456299
Epoch: 13, Steps: 32 | Train Loss: 0.869 Vali Loss: 28.953 Vali Acc: 0.443 Test Loss: 28.953 Test Acc: 0.443
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 31.99470281600952
Epoch: 14, Steps: 32 | Train Loss: 3.028 Vali Loss: 46.765 Vali Acc: 0.511 Test Loss: 46.765 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 32.20332431793213
Epoch: 15, Steps: 32 | Train Loss: 1.377 Vali Loss: 45.975 Vali Acc: 0.595 Test Loss: 45.975 Test Acc: 0.595
Validation loss decreased (-0.541785 --> -0.594960).  Saving model ...
Epoch: 16 cost time: 31.990734338760376
Epoch: 16, Steps: 32 | Train Loss: 3.385 Vali Loss: 40.894 Vali Acc: 0.504 Test Loss: 40.894 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 31.93449115753174
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 39.881 Vali Acc: 0.481 Test Loss: 39.881 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 32.64011859893799
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 40.095 Vali Acc: 0.466 Test Loss: 40.095 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 32.122188329696655
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 40.056 Vali Acc: 0.466 Test Loss: 40.056 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 32.08628511428833
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 40.025 Vali Acc: 0.466 Test Loss: 40.025 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 32.29214334487915
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 40.024 Vali Acc: 0.466 Test Loss: 40.024 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 31.569361448287964
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 40.023 Vali Acc: 0.466 Test Loss: 40.023 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 31.483846187591553
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 40.022 Vali Acc: 0.466 Test Loss: 40.022 Test Acc: 0.466
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 31.985525131225586
Epoch: 24, Steps: 32 | Train Loss: 1.153 Vali Loss: 38.165 Vali Acc: 0.481 Test Loss: 38.165 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 31.497255325317383
Epoch: 25, Steps: 32 | Train Loss: 5.036 Vali Loss: 71.508 Vali Acc: 0.298 Test Loss: 71.508 Test Acc: 0.298
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5954198473282443
model parameter : 5222661
model size : 22.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 18.947180032730103
Epoch: 1, Steps: 32 | Train Loss: 4.894 Vali Loss: 7.915 Vali Acc: 0.229 Test Loss: 7.915 Test Acc: 0.229
Validation loss decreased (inf --> -0.228928).  Saving model ...
Epoch: 2 cost time: 18.128080368041992
Epoch: 2, Steps: 32 | Train Loss: 3.627 Vali Loss: 16.649 Vali Acc: 0.511 Test Loss: 16.649 Test Acc: 0.511
Validation loss decreased (-0.228928 --> -0.511284).  Saving model ...
Epoch: 3 cost time: 18.027438163757324
Epoch: 3, Steps: 32 | Train Loss: 7.231 Vali Loss: 15.759 Vali Acc: 0.496 Test Loss: 15.759 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 18.491082429885864
Epoch: 4, Steps: 32 | Train Loss: 1.703 Vali Loss: 10.450 Vali Acc: 0.534 Test Loss: 10.450 Test Acc: 0.534
Validation loss decreased (-0.511284 --> -0.534247).  Saving model ...
Epoch: 5 cost time: 18.35594391822815
Epoch: 5, Steps: 32 | Train Loss: 0.891 Vali Loss: 6.638 Vali Acc: 0.595 Test Loss: 6.638 Test Acc: 0.595
Validation loss decreased (-0.534247 --> -0.595353).  Saving model ...
Epoch: 6 cost time: 17.8945152759552
Epoch: 6, Steps: 32 | Train Loss: 1.585 Vali Loss: 10.625 Vali Acc: 0.542 Test Loss: 10.625 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 18.402182817459106
Epoch: 7, Steps: 32 | Train Loss: 2.827 Vali Loss: 20.603 Vali Acc: 0.427 Test Loss: 20.603 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 18.31502389907837
Epoch: 8, Steps: 32 | Train Loss: 1.158 Vali Loss: 17.563 Vali Acc: 0.534 Test Loss: 17.563 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 18.151779890060425
Epoch: 9, Steps: 32 | Train Loss: 0.777 Vali Loss: 25.768 Vali Acc: 0.573 Test Loss: 25.768 Test Acc: 0.573
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 17.908711433410645
Epoch: 10, Steps: 32 | Train Loss: 1.666 Vali Loss: 35.322 Vali Acc: 0.397 Test Loss: 35.322 Test Acc: 0.397
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 18.352203845977783
Epoch: 11, Steps: 32 | Train Loss: 0.762 Vali Loss: 24.509 Vali Acc: 0.588 Test Loss: 24.509 Test Acc: 0.588
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 18.154744625091553
Epoch: 12, Steps: 32 | Train Loss: 0.410 Vali Loss: 24.570 Vali Acc: 0.481 Test Loss: 24.570 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 18.10838794708252
Epoch: 13, Steps: 32 | Train Loss: 0.112 Vali Loss: 29.703 Vali Acc: 0.588 Test Loss: 29.703 Test Acc: 0.588
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 17.991803646087646
Epoch: 14, Steps: 32 | Train Loss: 2.137 Vali Loss: 39.715 Vali Acc: 0.565 Test Loss: 39.715 Test Acc: 0.565
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 17.742411613464355
Epoch: 15, Steps: 32 | Train Loss: 2.139 Vali Loss: 46.162 Vali Acc: 0.542 Test Loss: 46.162 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5954198473282443
model parameter : 3567365
model size : 15.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 17.782634258270264
Epoch: 1, Steps: 32 | Train Loss: 5.591 Vali Loss: 11.095 Vali Acc: 0.313 Test Loss: 11.095 Test Acc: 0.313
Validation loss decreased (inf --> -0.312866).  Saving model ...
Epoch: 2 cost time: 17.090831995010376
Epoch: 2, Steps: 32 | Train Loss: 5.056 Vali Loss: 7.193 Vali Acc: 0.550 Test Loss: 7.193 Test Acc: 0.550
Validation loss decreased (-0.312866 --> -0.549546).  Saving model ...
Epoch: 3 cost time: 16.91552710533142
Epoch: 3, Steps: 32 | Train Loss: 1.562 Vali Loss: 15.293 Vali Acc: 0.313 Test Loss: 15.293 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 16.95055651664734
Epoch: 4, Steps: 32 | Train Loss: 1.121 Vali Loss: 19.919 Vali Acc: 0.542 Test Loss: 19.919 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 17.180643558502197
Epoch: 5, Steps: 32 | Train Loss: 2.469 Vali Loss: 15.823 Vali Acc: 0.359 Test Loss: 15.823 Test Acc: 0.359
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 17.095878839492798
Epoch: 6, Steps: 32 | Train Loss: 2.536 Vali Loss: 14.521 Vali Acc: 0.435 Test Loss: 14.521 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 16.779276132583618
Epoch: 7, Steps: 32 | Train Loss: 0.197 Vali Loss: 15.520 Vali Acc: 0.588 Test Loss: 15.520 Test Acc: 0.588
Validation loss decreased (-0.549546 --> -0.587631).  Saving model ...
Epoch: 8 cost time: 16.911662578582764
Epoch: 8, Steps: 32 | Train Loss: 2.029 Vali Loss: 22.224 Vali Acc: 0.420 Test Loss: 22.224 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 17.25509524345398
Epoch: 9, Steps: 32 | Train Loss: 0.528 Vali Loss: 22.860 Vali Acc: 0.542 Test Loss: 22.860 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 16.872875928878784
Epoch: 10, Steps: 32 | Train Loss: 1.324 Vali Loss: 50.536 Vali Acc: 0.206 Test Loss: 50.536 Test Acc: 0.206
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 16.84420108795166
Epoch: 11, Steps: 32 | Train Loss: 5.920 Vali Loss: 24.338 Vali Acc: 0.466 Test Loss: 24.338 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 17.143855571746826
Epoch: 12, Steps: 32 | Train Loss: 3.003 Vali Loss: 39.402 Vali Acc: 0.305 Test Loss: 39.402 Test Acc: 0.305
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 17.30364179611206
Epoch: 13, Steps: 32 | Train Loss: 1.476 Vali Loss: 43.694 Vali Acc: 0.344 Test Loss: 43.694 Test Acc: 0.344
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 16.844920873641968
Epoch: 14, Steps: 32 | Train Loss: 0.319 Vali Loss: 34.007 Vali Acc: 0.374 Test Loss: 34.007 Test Acc: 0.374
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 16.940845727920532
Epoch: 15, Steps: 32 | Train Loss: 0.341 Vali Loss: 40.255 Vali Acc: 0.466 Test Loss: 40.255 Test Acc: 0.466
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 17.03558874130249
Epoch: 16, Steps: 32 | Train Loss: 0.938 Vali Loss: 40.764 Vali Acc: 0.405 Test Loss: 40.764 Test Acc: 0.405
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 16.947583436965942
Epoch: 17, Steps: 32 | Train Loss: 2.346 Vali Loss: 73.276 Vali Acc: 0.229 Test Loss: 73.276 Test Acc: 0.229
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 5222661
model size : 22.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 11.664387941360474
Epoch: 1, Steps: 32 | Train Loss: 4.939 Vali Loss: 5.685 Vali Acc: 0.328 Test Loss: 5.685 Test Acc: 0.328
Validation loss decreased (inf --> -0.328187).  Saving model ...
Epoch: 2 cost time: 10.39073657989502
Epoch: 2, Steps: 32 | Train Loss: 3.352 Vali Loss: 14.163 Vali Acc: 0.344 Test Loss: 14.163 Test Acc: 0.344
Validation loss decreased (-0.328187 --> -0.343370).  Saving model ...
Epoch: 3 cost time: 10.574822902679443
Epoch: 3, Steps: 32 | Train Loss: 4.607 Vali Loss: 9.765 Vali Acc: 0.466 Test Loss: 9.765 Test Acc: 0.466
Validation loss decreased (-0.343370 --> -0.465551).  Saving model ...
Epoch: 4 cost time: 10.59619140625
Epoch: 4, Steps: 32 | Train Loss: 3.543 Vali Loss: 36.091 Vali Acc: 0.130 Test Loss: 36.091 Test Acc: 0.130
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.684612512588501
Epoch: 5, Steps: 32 | Train Loss: 2.749 Vali Loss: 10.591 Vali Acc: 0.511 Test Loss: 10.591 Test Acc: 0.511
Validation loss decreased (-0.465551 --> -0.511344).  Saving model ...
Epoch: 6 cost time: 10.448237895965576
Epoch: 6, Steps: 32 | Train Loss: 1.139 Vali Loss: 15.347 Vali Acc: 0.397 Test Loss: 15.347 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.42678689956665
Epoch: 7, Steps: 32 | Train Loss: 0.852 Vali Loss: 27.746 Vali Acc: 0.328 Test Loss: 27.746 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 10.585532903671265
Epoch: 8, Steps: 32 | Train Loss: 1.877 Vali Loss: 39.261 Vali Acc: 0.519 Test Loss: 39.261 Test Acc: 0.519
Validation loss decreased (-0.511344 --> -0.518691).  Saving model ...
Epoch: 9 cost time: 10.54066276550293
Epoch: 9, Steps: 32 | Train Loss: 1.910 Vali Loss: 22.431 Vali Acc: 0.527 Test Loss: 22.431 Test Acc: 0.527
Validation loss decreased (-0.518691 --> -0.526493).  Saving model ...
Epoch: 10 cost time: 10.522618293762207
Epoch: 10, Steps: 32 | Train Loss: 0.795 Vali Loss: 24.649 Vali Acc: 0.519 Test Loss: 24.649 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 10.629284381866455
Epoch: 11, Steps: 32 | Train Loss: 1.037 Vali Loss: 33.680 Vali Acc: 0.542 Test Loss: 33.680 Test Acc: 0.542
Validation loss decreased (-0.526493 --> -0.541648).  Saving model ...
Epoch: 12 cost time: 10.644538640975952
Epoch: 12, Steps: 32 | Train Loss: 0.703 Vali Loss: 27.126 Vali Acc: 0.481 Test Loss: 27.126 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 10.796489953994751
Epoch: 13, Steps: 32 | Train Loss: 2.521 Vali Loss: 37.682 Vali Acc: 0.450 Test Loss: 37.682 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 10.83382272720337
Epoch: 14, Steps: 32 | Train Loss: 1.818 Vali Loss: 31.629 Vali Acc: 0.557 Test Loss: 31.629 Test Acc: 0.557
Validation loss decreased (-0.541648 --> -0.556936).  Saving model ...
Epoch: 15 cost time: 10.621551990509033
Epoch: 15, Steps: 32 | Train Loss: 5.065 Vali Loss: 28.152 Vali Acc: 0.557 Test Loss: 28.152 Test Acc: 0.557
Validation loss decreased (-0.556936 --> -0.556970).  Saving model ...
Epoch: 16 cost time: 10.644179582595825
Epoch: 16, Steps: 32 | Train Loss: 0.730 Vali Loss: 27.718 Vali Acc: 0.534 Test Loss: 27.718 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 10.656245708465576
Epoch: 17, Steps: 32 | Train Loss: 0.053 Vali Loss: 40.084 Vali Acc: 0.473 Test Loss: 40.084 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 10.717551469802856
Epoch: 18, Steps: 32 | Train Loss: 0.284 Vali Loss: 39.210 Vali Acc: 0.542 Test Loss: 39.210 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 10.712942600250244
Epoch: 19, Steps: 32 | Train Loss: 1.206 Vali Loss: 45.337 Vali Acc: 0.496 Test Loss: 45.337 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 10.731385946273804
Epoch: 20, Steps: 32 | Train Loss: 2.341 Vali Loss: 31.371 Vali Acc: 0.496 Test Loss: 31.371 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 10.764249563217163
Epoch: 21, Steps: 32 | Train Loss: 1.554 Vali Loss: 25.708 Vali Acc: 0.588 Test Loss: 25.708 Test Acc: 0.588
Validation loss decreased (-0.556970 --> -0.587529).  Saving model ...
Epoch: 22 cost time: 10.595359802246094
Epoch: 22, Steps: 32 | Train Loss: 0.134 Vali Loss: 50.815 Vali Acc: 0.519 Test Loss: 50.815 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 10.574390649795532
Epoch: 23, Steps: 32 | Train Loss: 2.342 Vali Loss: 41.521 Vali Acc: 0.473 Test Loss: 41.521 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 10.903338432312012
Epoch: 24, Steps: 32 | Train Loss: 2.074 Vali Loss: 60.944 Vali Acc: 0.496 Test Loss: 60.944 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 10.512566089630127
Epoch: 25, Steps: 32 | Train Loss: 0.034 Vali Loss: 58.775 Vali Acc: 0.481 Test Loss: 58.775 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 10.806549310684204
Epoch: 26, Steps: 32 | Train Loss: 0.000 Vali Loss: 50.002 Vali Acc: 0.473 Test Loss: 50.002 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 10.878580570220947
Epoch: 27, Steps: 32 | Train Loss: 0.000 Vali Loss: 50.696 Vali Acc: 0.458 Test Loss: 50.696 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 10.701607704162598
Epoch: 28, Steps: 32 | Train Loss: 0.000 Vali Loss: 50.721 Vali Acc: 0.458 Test Loss: 50.721 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 10.56412124633789
Epoch: 29, Steps: 32 | Train Loss: 0.000 Vali Loss: 50.721 Vali Acc: 0.458 Test Loss: 50.721 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 10.884663343429565
Epoch: 30, Steps: 32 | Train Loss: 0.000 Vali Loss: 50.656 Vali Acc: 0.458 Test Loss: 50.656 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 3567365
model size : 15.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 72.8132712841034
Epoch: 1, Steps: 32 | Train Loss: 2.839 Vali Loss: 4.355 Vali Acc: 0.237 Test Loss: 4.355 Test Acc: 0.237
Validation loss decreased (inf --> -0.236598).  Saving model ...
Epoch: 2 cost time: 71.81259751319885
Epoch: 2, Steps: 32 | Train Loss: 1.656 Vali Loss: 3.631 Vali Acc: 0.534 Test Loss: 3.631 Test Acc: 0.534
Validation loss decreased (-0.236598 --> -0.534315).  Saving model ...
Epoch: 3 cost time: 71.24131941795349
Epoch: 3, Steps: 32 | Train Loss: 0.772 Vali Loss: 5.077 Vali Acc: 0.321 Test Loss: 5.077 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 70.66444444656372
Epoch: 4, Steps: 32 | Train Loss: 1.540 Vali Loss: 6.543 Vali Acc: 0.473 Test Loss: 6.543 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 70.21125173568726
Epoch: 5, Steps: 32 | Train Loss: 1.397 Vali Loss: 8.132 Vali Acc: 0.244 Test Loss: 8.132 Test Acc: 0.244
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 71.34513521194458
Epoch: 6, Steps: 32 | Train Loss: 0.391 Vali Loss: 8.132 Vali Acc: 0.496 Test Loss: 8.132 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 71.19935965538025
Epoch: 7, Steps: 32 | Train Loss: 0.264 Vali Loss: 9.584 Vali Acc: 0.527 Test Loss: 9.584 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 70.76203536987305
Epoch: 8, Steps: 32 | Train Loss: 0.578 Vali Loss: 9.613 Vali Acc: 0.450 Test Loss: 9.613 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 70.74790978431702
Epoch: 9, Steps: 32 | Train Loss: 0.792 Vali Loss: 17.491 Vali Acc: 0.382 Test Loss: 17.491 Test Acc: 0.382
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 70.27212977409363
Epoch: 10, Steps: 32 | Train Loss: 1.354 Vali Loss: 20.258 Vali Acc: 0.519 Test Loss: 20.258 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 70.56890821456909
Epoch: 11, Steps: 32 | Train Loss: 1.530 Vali Loss: 20.599 Vali Acc: 0.481 Test Loss: 20.599 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 70.8997061252594
Epoch: 12, Steps: 32 | Train Loss: 2.364 Vali Loss: 19.305 Vali Acc: 0.405 Test Loss: 19.305 Test Acc: 0.405
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 3783941
model size : 15.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 41.54755449295044
Epoch: 1, Steps: 32 | Train Loss: 2.200 Vali Loss: 2.910 Vali Acc: 0.137 Test Loss: 2.910 Test Acc: 0.137
Validation loss decreased (inf --> -0.137375).  Saving model ...
Epoch: 2 cost time: 39.9640953540802
Epoch: 2, Steps: 32 | Train Loss: 2.122 Vali Loss: 3.499 Vali Acc: 0.382 Test Loss: 3.499 Test Acc: 0.382
Validation loss decreased (-0.137375 --> -0.381644).  Saving model ...
Epoch: 3 cost time: 39.930716037750244
Epoch: 3, Steps: 32 | Train Loss: 1.568 Vali Loss: 6.480 Vali Acc: 0.252 Test Loss: 6.480 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 40.10624122619629
Epoch: 4, Steps: 32 | Train Loss: 1.602 Vali Loss: 4.015 Vali Acc: 0.458 Test Loss: 4.015 Test Acc: 0.458
Validation loss decreased (-0.381644 --> -0.457975).  Saving model ...
Epoch: 5 cost time: 40.14732384681702
Epoch: 5, Steps: 32 | Train Loss: 0.636 Vali Loss: 8.525 Vali Acc: 0.573 Test Loss: 8.525 Test Acc: 0.573
Validation loss decreased (-0.457975 --> -0.572434).  Saving model ...
Epoch: 6 cost time: 40.53344988822937
Epoch: 6, Steps: 32 | Train Loss: 0.346 Vali Loss: 7.059 Vali Acc: 0.496 Test Loss: 7.059 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 40.32631492614746
Epoch: 7, Steps: 32 | Train Loss: 0.122 Vali Loss: 10.374 Vali Acc: 0.382 Test Loss: 10.374 Test Acc: 0.382
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 40.81632089614868
Epoch: 8, Steps: 32 | Train Loss: 0.273 Vali Loss: 8.878 Vali Acc: 0.366 Test Loss: 8.878 Test Acc: 0.366
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 40.997411489486694
Epoch: 9, Steps: 32 | Train Loss: 1.621 Vali Loss: 11.862 Vali Acc: 0.466 Test Loss: 11.862 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 40.24907302856445
Epoch: 10, Steps: 32 | Train Loss: 2.397 Vali Loss: 16.368 Vali Acc: 0.321 Test Loss: 16.368 Test Acc: 0.321
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 40.669609785079956
Epoch: 11, Steps: 32 | Train Loss: 1.367 Vali Loss: 13.994 Vali Acc: 0.519 Test Loss: 13.994 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 40.5304217338562
Epoch: 12, Steps: 32 | Train Loss: 0.764 Vali Loss: 16.618 Vali Acc: 0.504 Test Loss: 16.618 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 40.67803883552551
Epoch: 13, Steps: 32 | Train Loss: 0.290 Vali Loss: 21.159 Vali Acc: 0.504 Test Loss: 21.159 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 40.82743453979492
Epoch: 14, Steps: 32 | Train Loss: 0.937 Vali Loss: 25.628 Vali Acc: 0.252 Test Loss: 25.628 Test Acc: 0.252
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 41.16837668418884
Epoch: 15, Steps: 32 | Train Loss: 1.255 Vali Loss: 24.562 Vali Acc: 0.420 Test Loss: 24.562 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 2128517
model size : 9.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 53.9841628074646
Epoch: 1, Steps: 32 | Train Loss: 2.840 Vali Loss: 4.500 Vali Acc: 0.252 Test Loss: 4.500 Test Acc: 0.252
Validation loss decreased (inf --> -0.251863).  Saving model ...
Epoch: 2 cost time: 53.66107535362244
Epoch: 2, Steps: 32 | Train Loss: 1.526 Vali Loss: 3.506 Vali Acc: 0.573 Test Loss: 3.506 Test Acc: 0.573
Validation loss decreased (-0.251863 --> -0.572484).  Saving model ...
Epoch: 3 cost time: 52.26160383224487
Epoch: 3, Steps: 32 | Train Loss: 1.704 Vali Loss: 6.225 Vali Acc: 0.496 Test Loss: 6.225 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 52.9869544506073
Epoch: 4, Steps: 32 | Train Loss: 0.845 Vali Loss: 6.806 Vali Acc: 0.412 Test Loss: 6.806 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 52.92278504371643
Epoch: 5, Steps: 32 | Train Loss: 0.840 Vali Loss: 5.050 Vali Acc: 0.489 Test Loss: 5.050 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 53.55269265174866
Epoch: 6, Steps: 32 | Train Loss: 0.825 Vali Loss: 8.936 Vali Acc: 0.458 Test Loss: 8.936 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 51.640095233917236
Epoch: 7, Steps: 32 | Train Loss: 0.979 Vali Loss: 10.468 Vali Acc: 0.313 Test Loss: 10.468 Test Acc: 0.313
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 51.48379588127136
Epoch: 8, Steps: 32 | Train Loss: 3.344 Vali Loss: 15.827 Vali Acc: 0.527 Test Loss: 15.827 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 52.14423584938049
Epoch: 9, Steps: 32 | Train Loss: 1.758 Vali Loss: 17.638 Vali Acc: 0.321 Test Loss: 17.638 Test Acc: 0.321
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 52.14274573326111
Epoch: 10, Steps: 32 | Train Loss: 0.868 Vali Loss: 15.531 Vali Acc: 0.466 Test Loss: 15.531 Test Acc: 0.466
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 52.177287101745605
Epoch: 11, Steps: 32 | Train Loss: 0.498 Vali Loss: 16.013 Vali Acc: 0.534 Test Loss: 16.013 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 53.04429244995117
Epoch: 12, Steps: 32 | Train Loss: 0.347 Vali Loss: 17.936 Vali Acc: 0.504 Test Loss: 17.936 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 3783941
model size : 15.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 33.600738286972046
Epoch: 1, Steps: 32 | Train Loss: 2.245 Vali Loss: 2.975 Vali Acc: 0.137 Test Loss: 2.975 Test Acc: 0.137
Validation loss decreased (inf --> -0.137375).  Saving model ...
Epoch: 2 cost time: 32.7576858997345
Epoch: 2, Steps: 32 | Train Loss: 1.196 Vali Loss: 2.227 Vali Acc: 0.336 Test Loss: 2.227 Test Acc: 0.336
Validation loss decreased (-0.137375 --> -0.335856).  Saving model ...
Epoch: 3 cost time: 32.41386151313782
Epoch: 3, Steps: 32 | Train Loss: 2.171 Vali Loss: 5.562 Vali Acc: 0.298 Test Loss: 5.562 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 32.63585948944092
Epoch: 4, Steps: 32 | Train Loss: 1.694 Vali Loss: 5.475 Vali Acc: 0.374 Test Loss: 5.475 Test Acc: 0.374
Validation loss decreased (-0.335856 --> -0.373991).  Saving model ...
Epoch: 5 cost time: 32.49764943122864
Epoch: 5, Steps: 32 | Train Loss: 1.462 Vali Loss: 8.065 Vali Acc: 0.466 Test Loss: 8.065 Test Acc: 0.466
Validation loss decreased (-0.373991 --> -0.465568).  Saving model ...
Epoch: 6 cost time: 32.79534721374512
Epoch: 6, Steps: 32 | Train Loss: 0.490 Vali Loss: 7.097 Vali Acc: 0.481 Test Loss: 7.097 Test Acc: 0.481
Validation loss decreased (-0.465568 --> -0.480845).  Saving model ...
Epoch: 7 cost time: 32.67530131340027
Epoch: 7, Steps: 32 | Train Loss: 0.132 Vali Loss: 6.465 Vali Acc: 0.466 Test Loss: 6.465 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 32.76287245750427
Epoch: 8, Steps: 32 | Train Loss: 1.597 Vali Loss: 18.953 Vali Acc: 0.206 Test Loss: 18.953 Test Acc: 0.206
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 32.80171871185303
Epoch: 9, Steps: 32 | Train Loss: 0.924 Vali Loss: 17.777 Vali Acc: 0.305 Test Loss: 17.777 Test Acc: 0.305
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 32.07958936691284
Epoch: 10, Steps: 32 | Train Loss: 0.742 Vali Loss: 16.791 Vali Acc: 0.489 Test Loss: 16.791 Test Acc: 0.489
Validation loss decreased (-0.480845 --> -0.488382).  Saving model ...
Epoch: 11 cost time: 31.553022146224976
Epoch: 11, Steps: 32 | Train Loss: 2.663 Vali Loss: 30.308 Vali Acc: 0.237 Test Loss: 30.308 Test Acc: 0.237
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 32.10458326339722
Epoch: 12, Steps: 32 | Train Loss: 1.991 Vali Loss: 33.113 Vali Acc: 0.366 Test Loss: 33.113 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 32.34050703048706
Epoch: 13, Steps: 32 | Train Loss: 2.014 Vali Loss: 33.668 Vali Acc: 0.252 Test Loss: 33.668 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 32.099786043167114
Epoch: 14, Steps: 32 | Train Loss: 0.922 Vali Loss: 18.522 Vali Acc: 0.397 Test Loss: 18.522 Test Acc: 0.397
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 32.74726986885071
Epoch: 15, Steps: 32 | Train Loss: 0.680 Vali Loss: 27.323 Vali Acc: 0.534 Test Loss: 27.323 Test Acc: 0.534
Validation loss decreased (-0.488382 --> -0.534078).  Saving model ...
Epoch: 16 cost time: 32.2663779258728
Epoch: 16, Steps: 32 | Train Loss: 1.347 Vali Loss: 20.821 Vali Acc: 0.458 Test Loss: 20.821 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 32.54289484024048
Epoch: 17, Steps: 32 | Train Loss: 0.161 Vali Loss: 39.265 Vali Acc: 0.282 Test Loss: 39.265 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 32.5758273601532
Epoch: 18, Steps: 32 | Train Loss: 2.439 Vali Loss: 31.301 Vali Acc: 0.252 Test Loss: 31.301 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 32.412081480026245
Epoch: 19, Steps: 32 | Train Loss: 0.688 Vali Loss: 22.109 Vali Acc: 0.557 Test Loss: 22.109 Test Acc: 0.557
Validation loss decreased (-0.534078 --> -0.557031).  Saving model ...
Epoch: 20 cost time: 31.6334068775177
Epoch: 20, Steps: 32 | Train Loss: 0.086 Vali Loss: 23.244 Vali Acc: 0.466 Test Loss: 23.244 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 32.40517234802246
Epoch: 21, Steps: 32 | Train Loss: 0.201 Vali Loss: 29.619 Vali Acc: 0.519 Test Loss: 29.619 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 32.21051645278931
Epoch: 22, Steps: 32 | Train Loss: 0.603 Vali Loss: 34.157 Vali Acc: 0.382 Test Loss: 34.157 Test Acc: 0.382
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 32.46953296661377
Epoch: 23, Steps: 32 | Train Loss: 0.063 Vali Loss: 26.554 Vali Acc: 0.458 Test Loss: 26.554 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 32.46931076049805
Epoch: 24, Steps: 32 | Train Loss: 0.100 Vali Loss: 36.056 Vali Acc: 0.313 Test Loss: 36.056 Test Acc: 0.313
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 32.2076370716095
Epoch: 25, Steps: 32 | Train Loss: 1.124 Vali Loss: 41.023 Vali Acc: 0.359 Test Loss: 41.023 Test Acc: 0.359
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 32.849883794784546
Epoch: 26, Steps: 32 | Train Loss: 0.847 Vali Loss: 31.103 Vali Acc: 0.466 Test Loss: 31.103 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 32.71422266960144
Epoch: 27, Steps: 32 | Train Loss: 0.051 Vali Loss: 32.571 Vali Acc: 0.519 Test Loss: 32.571 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 32.574668407440186
Epoch: 28, Steps: 32 | Train Loss: 1.008 Vali Loss: 33.570 Vali Acc: 0.504 Test Loss: 33.570 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 32.2842001914978
Epoch: 29, Steps: 32 | Train Loss: 2.860 Vali Loss: 56.994 Vali Acc: 0.298 Test Loss: 56.994 Test Acc: 0.298
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 2128517
model size : 9.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 32.972923040390015
Epoch: 1, Steps: 32 | Train Loss: 2.801 Vali Loss: 3.947 Vali Acc: 0.252 Test Loss: 3.947 Test Acc: 0.252
Validation loss decreased (inf --> -0.251869).  Saving model ...
Epoch: 2 cost time: 31.524630308151245
Epoch: 2, Steps: 32 | Train Loss: 1.705 Vali Loss: 4.159 Vali Acc: 0.542 Test Loss: 4.159 Test Acc: 0.542
Validation loss decreased (-0.251869 --> -0.541943).  Saving model ...
Epoch: 3 cost time: 30.46545910835266
Epoch: 3, Steps: 32 | Train Loss: 0.842 Vali Loss: 3.412 Vali Acc: 0.496 Test Loss: 3.412 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 30.53458046913147
Epoch: 4, Steps: 32 | Train Loss: 1.850 Vali Loss: 12.713 Vali Acc: 0.275 Test Loss: 12.713 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 30.8783278465271
Epoch: 5, Steps: 32 | Train Loss: 2.358 Vali Loss: 12.534 Vali Acc: 0.481 Test Loss: 12.534 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 30.678332567214966
Epoch: 6, Steps: 32 | Train Loss: 0.700 Vali Loss: 9.175 Vali Acc: 0.489 Test Loss: 9.175 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 31.1571843624115
Epoch: 7, Steps: 32 | Train Loss: 0.418 Vali Loss: 8.004 Vali Acc: 0.420 Test Loss: 8.004 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 31.235132217407227
Epoch: 8, Steps: 32 | Train Loss: 0.654 Vali Loss: 9.104 Vali Acc: 0.389 Test Loss: 9.104 Test Acc: 0.389
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 30.805456399917603
Epoch: 9, Steps: 32 | Train Loss: 0.442 Vali Loss: 10.446 Vali Acc: 0.420 Test Loss: 10.446 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 30.903852939605713
Epoch: 10, Steps: 32 | Train Loss: 0.916 Vali Loss: 16.045 Vali Acc: 0.519 Test Loss: 16.045 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 31.180578470230103
Epoch: 11, Steps: 32 | Train Loss: 0.771 Vali Loss: 12.028 Vali Acc: 0.382 Test Loss: 12.028 Test Acc: 0.382
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 30.816668033599854
Epoch: 12, Steps: 32 | Train Loss: 1.458 Vali Loss: 20.043 Vali Acc: 0.405 Test Loss: 20.043 Test Acc: 0.405
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 3783941
model size : 15.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 22.82706117630005
Epoch: 1, Steps: 32 | Train Loss: 2.262 Vali Loss: 2.902 Vali Acc: 0.160 Test Loss: 2.902 Test Acc: 0.160
Validation loss decreased (inf --> -0.160276).  Saving model ...
Epoch: 2 cost time: 22.305304765701294
Epoch: 2, Steps: 32 | Train Loss: 1.283 Vali Loss: 3.676 Vali Acc: 0.290 Test Loss: 3.676 Test Acc: 0.290
Validation loss decreased (-0.160276 --> -0.290040).  Saving model ...
Epoch: 3 cost time: 21.73661780357361
Epoch: 3, Steps: 32 | Train Loss: 0.883 Vali Loss: 4.951 Vali Acc: 0.313 Test Loss: 4.951 Test Acc: 0.313
Validation loss decreased (-0.290040 --> -0.312928).  Saving model ...
Epoch: 4 cost time: 22.287694692611694
Epoch: 4, Steps: 32 | Train Loss: 0.765 Vali Loss: 5.224 Vali Acc: 0.389 Test Loss: 5.224 Test Acc: 0.389
Validation loss decreased (-0.312928 --> -0.389261).  Saving model ...
Epoch: 5 cost time: 22.449212551116943
Epoch: 5, Steps: 32 | Train Loss: 0.976 Vali Loss: 6.899 Vali Acc: 0.405 Test Loss: 6.899 Test Acc: 0.405
Validation loss decreased (-0.389261 --> -0.404511).  Saving model ...
Epoch: 6 cost time: 22.69959807395935
Epoch: 6, Steps: 32 | Train Loss: 1.784 Vali Loss: 8.394 Vali Acc: 0.511 Test Loss: 8.394 Test Acc: 0.511
Validation loss decreased (-0.404511 --> -0.511366).  Saving model ...
Epoch: 7 cost time: 22.64136004447937
Epoch: 7, Steps: 32 | Train Loss: 2.016 Vali Loss: 11.533 Vali Acc: 0.374 Test Loss: 11.533 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 22.78231906890869
Epoch: 8, Steps: 32 | Train Loss: 0.324 Vali Loss: 10.544 Vali Acc: 0.450 Test Loss: 10.544 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 21.84580087661743
Epoch: 9, Steps: 32 | Train Loss: 0.449 Vali Loss: 15.071 Vali Acc: 0.481 Test Loss: 15.071 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 22.032702445983887
Epoch: 10, Steps: 32 | Train Loss: 0.217 Vali Loss: 17.263 Vali Acc: 0.389 Test Loss: 17.263 Test Acc: 0.389
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 21.86587882041931
Epoch: 11, Steps: 32 | Train Loss: 0.920 Vali Loss: 16.491 Vali Acc: 0.473 Test Loss: 16.491 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 22.18746519088745
Epoch: 12, Steps: 32 | Train Loss: 0.730 Vali Loss: 18.013 Vali Acc: 0.542 Test Loss: 18.013 Test Acc: 0.542
Validation loss decreased (-0.511366 --> -0.541805).  Saving model ...
Epoch: 13 cost time: 22.586581230163574
Epoch: 13, Steps: 32 | Train Loss: 0.531 Vali Loss: 27.460 Vali Acc: 0.527 Test Loss: 27.460 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 22.743935108184814
Epoch: 14, Steps: 32 | Train Loss: 1.032 Vali Loss: 24.521 Vali Acc: 0.252 Test Loss: 24.521 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 22.7391037940979
Epoch: 15, Steps: 32 | Train Loss: 0.617 Vali Loss: 18.794 Vali Acc: 0.550 Test Loss: 18.794 Test Acc: 0.550
Validation loss decreased (-0.541805 --> -0.549430).  Saving model ...
Epoch: 16 cost time: 22.630816221237183
Epoch: 16, Steps: 32 | Train Loss: 0.622 Vali Loss: 26.666 Vali Acc: 0.313 Test Loss: 26.666 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 22.444387197494507
Epoch: 17, Steps: 32 | Train Loss: 0.516 Vali Loss: 31.773 Vali Acc: 0.313 Test Loss: 31.773 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 21.95571231842041
Epoch: 18, Steps: 32 | Train Loss: 0.523 Vali Loss: 27.774 Vali Acc: 0.351 Test Loss: 27.774 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 23.03932785987854
Epoch: 19, Steps: 32 | Train Loss: 0.470 Vali Loss: 26.835 Vali Acc: 0.580 Test Loss: 26.835 Test Acc: 0.580
Validation loss decreased (-0.549430 --> -0.579884).  Saving model ...
Epoch: 20 cost time: 22.616804122924805
Epoch: 20, Steps: 32 | Train Loss: 2.520 Vali Loss: 21.213 Vali Acc: 0.481 Test Loss: 21.213 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 21.978146076202393
Epoch: 21, Steps: 32 | Train Loss: 0.671 Vali Loss: 42.975 Vali Acc: 0.504 Test Loss: 42.975 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 22.06598401069641
Epoch: 22, Steps: 32 | Train Loss: 2.226 Vali Loss: 34.253 Vali Acc: 0.435 Test Loss: 34.253 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 22.412510871887207
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 33.341 Vali Acc: 0.412 Test Loss: 33.341 Test Acc: 0.412
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 22.69522786140442
Epoch: 24, Steps: 32 | Train Loss: 1.015 Vali Loss: 24.570 Vali Acc: 0.489 Test Loss: 24.570 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 22.38223886489868
Epoch: 25, Steps: 32 | Train Loss: 0.491 Vali Loss: 24.132 Vali Acc: 0.458 Test Loss: 24.132 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 22.399881839752197
Epoch: 26, Steps: 32 | Train Loss: 0.682 Vali Loss: 31.785 Vali Acc: 0.397 Test Loss: 31.785 Test Acc: 0.397
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 22.766172409057617
Epoch: 27, Steps: 32 | Train Loss: 0.128 Vali Loss: 34.436 Vali Acc: 0.366 Test Loss: 34.436 Test Acc: 0.366
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 23.183366775512695
Epoch: 28, Steps: 32 | Train Loss: 0.000 Vali Loss: 40.297 Vali Acc: 0.305 Test Loss: 40.297 Test Acc: 0.305
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 22.643502473831177
Epoch: 29, Steps: 32 | Train Loss: 0.264 Vali Loss: 42.420 Vali Acc: 0.313 Test Loss: 42.420 Test Acc: 0.313
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 2128517
model size : 9.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 35.90542149543762
Epoch: 1, Steps: 32 | Train Loss: 2.230 Vali Loss: 2.940 Vali Acc: 0.305 Test Loss: 2.940 Test Acc: 0.305
Validation loss decreased (inf --> -0.305314).  Saving model ...
Epoch: 2 cost time: 35.32522940635681
Epoch: 2, Steps: 32 | Train Loss: 0.817 Vali Loss: 5.006 Vali Acc: 0.267 Test Loss: 5.006 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 35.06500840187073
Epoch: 3, Steps: 32 | Train Loss: 0.798 Vali Loss: 3.788 Vali Acc: 0.519 Test Loss: 3.788 Test Acc: 0.519
Validation loss decreased (-0.305314 --> -0.519046).  Saving model ...
Epoch: 4 cost time: 34.56130599975586
Epoch: 4, Steps: 32 | Train Loss: 2.524 Vali Loss: 16.909 Vali Acc: 0.252 Test Loss: 16.909 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 35.001381397247314
Epoch: 5, Steps: 32 | Train Loss: 2.656 Vali Loss: 19.311 Vali Acc: 0.244 Test Loss: 19.311 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 34.87754440307617
Epoch: 6, Steps: 32 | Train Loss: 1.536 Vali Loss: 14.825 Vali Acc: 0.534 Test Loss: 14.825 Test Acc: 0.534
Validation loss decreased (-0.519046 --> -0.534203).  Saving model ...
Epoch: 7 cost time: 34.81424689292908
Epoch: 7, Steps: 32 | Train Loss: 0.348 Vali Loss: 11.320 Vali Acc: 0.550 Test Loss: 11.320 Test Acc: 0.550
Validation loss decreased (-0.534203 --> -0.549505).  Saving model ...
Epoch: 8 cost time: 34.69505214691162
Epoch: 8, Steps: 32 | Train Loss: 0.263 Vali Loss: 12.540 Vali Acc: 0.496 Test Loss: 12.540 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 34.81863284111023
Epoch: 9, Steps: 32 | Train Loss: 0.629 Vali Loss: 14.538 Vali Acc: 0.473 Test Loss: 14.538 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 34.96271014213562
Epoch: 10, Steps: 32 | Train Loss: 0.436 Vali Loss: 11.390 Vali Acc: 0.565 Test Loss: 11.390 Test Acc: 0.565
Validation loss decreased (-0.549505 --> -0.564772).  Saving model ...
Epoch: 11 cost time: 34.711390256881714
Epoch: 11, Steps: 32 | Train Loss: 0.354 Vali Loss: 18.172 Vali Acc: 0.466 Test Loss: 18.172 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 35.011709690093994
Epoch: 12, Steps: 32 | Train Loss: 1.583 Vali Loss: 22.132 Vali Acc: 0.519 Test Loss: 22.132 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 34.999375343322754
Epoch: 13, Steps: 32 | Train Loss: 0.503 Vali Loss: 16.352 Vali Acc: 0.519 Test Loss: 16.352 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 34.78866362571716
Epoch: 14, Steps: 32 | Train Loss: 0.088 Vali Loss: 15.078 Vali Acc: 0.466 Test Loss: 15.078 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 34.92370390892029
Epoch: 15, Steps: 32 | Train Loss: 0.412 Vali Loss: 22.127 Vali Acc: 0.504 Test Loss: 22.127 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 35.206077337265015
Epoch: 16, Steps: 32 | Train Loss: 0.648 Vali Loss: 20.917 Vali Acc: 0.489 Test Loss: 20.917 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 34.84687399864197
Epoch: 17, Steps: 32 | Train Loss: 0.843 Vali Loss: 26.532 Vali Acc: 0.565 Test Loss: 26.532 Test Acc: 0.565
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 34.569435834884644
Epoch: 18, Steps: 32 | Train Loss: 0.382 Vali Loss: 20.763 Vali Acc: 0.412 Test Loss: 20.763 Test Acc: 0.412
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 34.8404061794281
Epoch: 19, Steps: 32 | Train Loss: 0.865 Vali Loss: 24.935 Vali Acc: 0.412 Test Loss: 24.935 Test Acc: 0.412
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 35.02812051773071
Epoch: 20, Steps: 32 | Train Loss: 1.176 Vali Loss: 22.361 Vali Acc: 0.382 Test Loss: 22.361 Test Acc: 0.382
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 2611717
model size : 11.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 18.3766827583313
Epoch: 1, Steps: 32 | Train Loss: 2.940 Vali Loss: 2.185 Vali Acc: 0.481 Test Loss: 2.185 Test Acc: 0.481
Validation loss decreased (inf --> -0.480894).  Saving model ...
Epoch: 2 cost time: 16.98867964744568
Epoch: 2, Steps: 32 | Train Loss: 2.378 Vali Loss: 3.304 Vali Acc: 0.282 Test Loss: 3.304 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 17.282228231430054
Epoch: 3, Steps: 32 | Train Loss: 3.683 Vali Loss: 5.685 Vali Acc: 0.450 Test Loss: 5.685 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 17.031532764434814
Epoch: 4, Steps: 32 | Train Loss: 2.123 Vali Loss: 13.943 Vali Acc: 0.206 Test Loss: 13.943 Test Acc: 0.206
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 16.9030020236969
Epoch: 5, Steps: 32 | Train Loss: 0.916 Vali Loss: 7.331 Vali Acc: 0.328 Test Loss: 7.331 Test Acc: 0.328
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 16.956794023513794
Epoch: 6, Steps: 32 | Train Loss: 0.180 Vali Loss: 8.003 Vali Acc: 0.374 Test Loss: 8.003 Test Acc: 0.374
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 16.42078137397766
Epoch: 7, Steps: 32 | Train Loss: 0.140 Vali Loss: 8.855 Vali Acc: 0.344 Test Loss: 8.855 Test Acc: 0.344
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 16.026841640472412
Epoch: 8, Steps: 32 | Train Loss: 0.258 Vali Loss: 5.711 Vali Acc: 0.511 Test Loss: 5.711 Test Acc: 0.511
Validation loss decreased (-0.480894 --> -0.511393).  Saving model ...
Epoch: 9 cost time: 16.02153253555298
Epoch: 9, Steps: 32 | Train Loss: 0.675 Vali Loss: 22.391 Vali Acc: 0.305 Test Loss: 22.391 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 15.999438047409058
Epoch: 10, Steps: 32 | Train Loss: 0.846 Vali Loss: 9.544 Vali Acc: 0.611 Test Loss: 9.544 Test Acc: 0.611
Validation loss decreased (-0.511393 --> -0.610592).  Saving model ...
Epoch: 11 cost time: 16.46443486213684
Epoch: 11, Steps: 32 | Train Loss: 0.261 Vali Loss: 19.876 Vali Acc: 0.305 Test Loss: 19.876 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 16.454275608062744
Epoch: 12, Steps: 32 | Train Loss: 2.040 Vali Loss: 19.684 Vali Acc: 0.534 Test Loss: 19.684 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 16.232243061065674
Epoch: 13, Steps: 32 | Train Loss: 0.767 Vali Loss: 12.070 Vali Acc: 0.565 Test Loss: 12.070 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 16.197513818740845
Epoch: 14, Steps: 32 | Train Loss: 0.714 Vali Loss: 20.893 Vali Acc: 0.374 Test Loss: 20.893 Test Acc: 0.374
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 16.16495442390442
Epoch: 15, Steps: 32 | Train Loss: 0.279 Vali Loss: 18.074 Vali Acc: 0.473 Test Loss: 18.074 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 16.45414686203003
Epoch: 16, Steps: 32 | Train Loss: 0.608 Vali Loss: 19.491 Vali Acc: 0.511 Test Loss: 19.491 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 16.327415943145752
Epoch: 17, Steps: 32 | Train Loss: 1.357 Vali Loss: 15.839 Vali Acc: 0.473 Test Loss: 15.839 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 16.33260154724121
Epoch: 18, Steps: 32 | Train Loss: 0.327 Vali Loss: 21.272 Vali Acc: 0.473 Test Loss: 21.272 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 16.44097638130188
Epoch: 19, Steps: 32 | Train Loss: 0.624 Vali Loss: 20.137 Vali Acc: 0.611 Test Loss: 20.137 Test Acc: 0.611
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 16.51007080078125
Epoch: 20, Steps: 32 | Train Loss: 0.232 Vali Loss: 19.497 Vali Acc: 0.511 Test Loss: 19.497 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6106870229007634
model parameter : 1783941
model size : 7.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 26.011468410491943
Epoch: 1, Steps: 32 | Train Loss: 2.229 Vali Loss: 2.901 Vali Acc: 0.298 Test Loss: 2.901 Test Acc: 0.298
Validation loss decreased (inf --> -0.297681).  Saving model ...
Epoch: 2 cost time: 25.058974504470825
Epoch: 2, Steps: 32 | Train Loss: 0.813 Vali Loss: 4.078 Vali Acc: 0.397 Test Loss: 4.078 Test Acc: 0.397
Validation loss decreased (-0.297681 --> -0.396906).  Saving model ...
Epoch: 3 cost time: 24.227466583251953
Epoch: 3, Steps: 32 | Train Loss: 0.795 Vali Loss: 6.484 Vali Acc: 0.267 Test Loss: 6.484 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 24.277970790863037
Epoch: 4, Steps: 32 | Train Loss: 1.210 Vali Loss: 8.740 Vali Acc: 0.504 Test Loss: 8.740 Test Acc: 0.504
Validation loss decreased (-0.396906 --> -0.503729).  Saving model ...
Epoch: 5 cost time: 24.40673828125
Epoch: 5, Steps: 32 | Train Loss: 1.293 Vali Loss: 11.987 Vali Acc: 0.282 Test Loss: 11.987 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 24.52057719230652
Epoch: 6, Steps: 32 | Train Loss: 1.246 Vali Loss: 12.420 Vali Acc: 0.534 Test Loss: 12.420 Test Acc: 0.534
Validation loss decreased (-0.503729 --> -0.534227).  Saving model ...
Epoch: 7 cost time: 24.303025722503662
Epoch: 7, Steps: 32 | Train Loss: 1.396 Vali Loss: 16.527 Vali Acc: 0.313 Test Loss: 16.527 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 23.988328218460083
Epoch: 8, Steps: 32 | Train Loss: 1.432 Vali Loss: 32.023 Vali Acc: 0.206 Test Loss: 32.023 Test Acc: 0.206
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 24.259201288223267
Epoch: 9, Steps: 32 | Train Loss: 1.497 Vali Loss: 12.213 Vali Acc: 0.519 Test Loss: 12.213 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 24.07716703414917
Epoch: 10, Steps: 32 | Train Loss: 0.353 Vali Loss: 24.293 Vali Acc: 0.542 Test Loss: 24.293 Test Acc: 0.542
Validation loss decreased (-0.534227 --> -0.541742).  Saving model ...
Epoch: 11 cost time: 24.115959644317627
Epoch: 11, Steps: 32 | Train Loss: 0.872 Vali Loss: 15.821 Vali Acc: 0.534 Test Loss: 15.821 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 24.29702877998352
Epoch: 12, Steps: 32 | Train Loss: 0.243 Vali Loss: 20.309 Vali Acc: 0.580 Test Loss: 20.309 Test Acc: 0.580
Validation loss decreased (-0.541742 --> -0.579950).  Saving model ...
Epoch: 13 cost time: 24.24189257621765
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 20.276 Vali Acc: 0.580 Test Loss: 20.276 Test Acc: 0.580
Validation loss decreased (-0.579950 --> -0.579950).  Saving model ...
Epoch: 14 cost time: 24.192975521087646
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 19.898 Vali Acc: 0.573 Test Loss: 19.898 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 24.37692666053772
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 19.857 Vali Acc: 0.573 Test Loss: 19.857 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 24.267651557922363
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 19.805 Vali Acc: 0.565 Test Loss: 19.805 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 24.018741369247437
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 19.598 Vali Acc: 0.565 Test Loss: 19.598 Test Acc: 0.565
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 24.340550899505615
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 19.561 Vali Acc: 0.565 Test Loss: 19.561 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 24.085145473480225
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 19.560 Vali Acc: 0.565 Test Loss: 19.560 Test Acc: 0.565
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 23.761353969573975
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 19.554 Vali Acc: 0.565 Test Loss: 19.554 Test Acc: 0.565
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 24.150421857833862
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 19.553 Vali Acc: 0.565 Test Loss: 19.553 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 24.11841368675232
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 19.551 Vali Acc: 0.565 Test Loss: 19.551 Test Acc: 0.565
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 23.889949321746826
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 19.551 Vali Acc: 0.565 Test Loss: 19.551 Test Acc: 0.565
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 2611717
model size : 11.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 13.869070053100586
Epoch: 1, Steps: 32 | Train Loss: 3.012 Vali Loss: 1.978 Vali Acc: 0.412 Test Loss: 1.978 Test Acc: 0.412
Validation loss decreased (inf --> -0.412194).  Saving model ...
Epoch: 2 cost time: 12.219307899475098
Epoch: 2, Steps: 32 | Train Loss: 1.687 Vali Loss: 4.007 Vali Acc: 0.542 Test Loss: 4.007 Test Acc: 0.542
Validation loss decreased (-0.412194 --> -0.541945).  Saving model ...
Epoch: 3 cost time: 12.48810338973999
Epoch: 3, Steps: 32 | Train Loss: 3.289 Vali Loss: 4.427 Vali Acc: 0.504 Test Loss: 4.427 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 12.888325929641724
Epoch: 4, Steps: 32 | Train Loss: 2.367 Vali Loss: 11.113 Vali Acc: 0.214 Test Loss: 11.113 Test Acc: 0.214
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 12.737679958343506
Epoch: 5, Steps: 32 | Train Loss: 0.643 Vali Loss: 7.725 Vali Acc: 0.366 Test Loss: 7.725 Test Acc: 0.366
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 12.656292915344238
Epoch: 6, Steps: 32 | Train Loss: 0.226 Vali Loss: 9.079 Vali Acc: 0.359 Test Loss: 9.079 Test Acc: 0.359
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 12.671454906463623
Epoch: 7, Steps: 32 | Train Loss: 0.854 Vali Loss: 10.799 Vali Acc: 0.504 Test Loss: 10.799 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 12.912045001983643
Epoch: 8, Steps: 32 | Train Loss: 0.771 Vali Loss: 11.418 Vali Acc: 0.321 Test Loss: 11.418 Test Acc: 0.321
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 12.852178573608398
Epoch: 9, Steps: 32 | Train Loss: 0.291 Vali Loss: 10.958 Vali Acc: 0.504 Test Loss: 10.958 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 12.81923532485962
Epoch: 10, Steps: 32 | Train Loss: 0.169 Vali Loss: 7.646 Vali Acc: 0.496 Test Loss: 7.646 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 12.745515823364258
Epoch: 11, Steps: 32 | Train Loss: 0.185 Vali Loss: 8.656 Vali Acc: 0.611 Test Loss: 8.656 Test Acc: 0.611
Validation loss decreased (-0.541945 --> -0.610600).  Saving model ...
Epoch: 12 cost time: 12.8917555809021
Epoch: 12, Steps: 32 | Train Loss: 0.149 Vali Loss: 13.673 Vali Acc: 0.580 Test Loss: 13.673 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 12.350377798080444
Epoch: 13, Steps: 32 | Train Loss: 1.065 Vali Loss: 13.420 Vali Acc: 0.450 Test Loss: 13.420 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 11.955564260482788
Epoch: 14, Steps: 32 | Train Loss: 1.242 Vali Loss: 17.516 Vali Acc: 0.573 Test Loss: 17.516 Test Acc: 0.573
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 12.006520986557007
Epoch: 15, Steps: 32 | Train Loss: 0.846 Vali Loss: 25.395 Vali Acc: 0.389 Test Loss: 25.395 Test Acc: 0.389
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 12.266465425491333
Epoch: 16, Steps: 32 | Train Loss: 1.086 Vali Loss: 16.362 Vali Acc: 0.527 Test Loss: 16.362 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 12.155024528503418
Epoch: 17, Steps: 32 | Train Loss: 0.240 Vali Loss: 31.880 Vali Acc: 0.267 Test Loss: 31.880 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 11.916170835494995
Epoch: 18, Steps: 32 | Train Loss: 0.746 Vali Loss: 17.192 Vali Acc: 0.542 Test Loss: 17.192 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 12.138202667236328
Epoch: 19, Steps: 32 | Train Loss: 0.138 Vali Loss: 16.443 Vali Acc: 0.511 Test Loss: 16.443 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 12.150391578674316
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 18.802 Vali Acc: 0.542 Test Loss: 18.802 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 12.004742860794067
Epoch: 21, Steps: 32 | Train Loss: 0.011 Vali Loss: 16.952 Vali Acc: 0.496 Test Loss: 16.952 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6106870229007634
model parameter : 1783941
model size : 7.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 13.461992740631104
Epoch: 1, Steps: 32 | Train Loss: 2.222 Vali Loss: 2.903 Vali Acc: 0.298 Test Loss: 2.903 Test Acc: 0.298
Validation loss decreased (inf --> -0.297681).  Saving model ...
Epoch: 2 cost time: 12.401121139526367
Epoch: 2, Steps: 32 | Train Loss: 0.967 Vali Loss: 5.661 Vali Acc: 0.321 Test Loss: 5.661 Test Acc: 0.321
Validation loss decreased (-0.297681 --> -0.320554).  Saving model ...
Epoch: 3 cost time: 12.594604015350342
Epoch: 3, Steps: 32 | Train Loss: 0.852 Vali Loss: 5.986 Vali Acc: 0.534 Test Loss: 5.986 Test Acc: 0.534
Validation loss decreased (-0.320554 --> -0.534291).  Saving model ...
Epoch: 4 cost time: 12.556357145309448
Epoch: 4, Steps: 32 | Train Loss: 0.490 Vali Loss: 9.062 Vali Acc: 0.527 Test Loss: 9.062 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.394593715667725
Epoch: 5, Steps: 32 | Train Loss: 1.022 Vali Loss: 6.424 Vali Acc: 0.573 Test Loss: 6.424 Test Acc: 0.573
Validation loss decreased (-0.534291 --> -0.572455).  Saving model ...
Epoch: 6 cost time: 12.434905290603638
Epoch: 6, Steps: 32 | Train Loss: 0.755 Vali Loss: 6.561 Vali Acc: 0.466 Test Loss: 6.561 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 12.291080951690674
Epoch: 7, Steps: 32 | Train Loss: 1.375 Vali Loss: 17.231 Vali Acc: 0.260 Test Loss: 17.231 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 12.652977466583252
Epoch: 8, Steps: 32 | Train Loss: 1.081 Vali Loss: 12.580 Vali Acc: 0.534 Test Loss: 12.580 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 12.661892175674438
Epoch: 9, Steps: 32 | Train Loss: 0.960 Vali Loss: 14.505 Vali Acc: 0.443 Test Loss: 14.505 Test Acc: 0.443
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 12.587764739990234
Epoch: 10, Steps: 32 | Train Loss: 0.762 Vali Loss: 18.968 Vali Acc: 0.519 Test Loss: 18.968 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 12.248727321624756
Epoch: 11, Steps: 32 | Train Loss: 0.775 Vali Loss: 21.880 Vali Acc: 0.527 Test Loss: 21.880 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 12.570435047149658
Epoch: 12, Steps: 32 | Train Loss: 0.703 Vali Loss: 14.842 Vali Acc: 0.458 Test Loss: 14.842 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 12.314413785934448
Epoch: 13, Steps: 32 | Train Loss: 0.277 Vali Loss: 22.181 Vali Acc: 0.542 Test Loss: 22.181 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 12.42299485206604
Epoch: 14, Steps: 32 | Train Loss: 0.547 Vali Loss: 18.583 Vali Acc: 0.565 Test Loss: 18.583 Test Acc: 0.565
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 12.869560241699219
Epoch: 15, Steps: 32 | Train Loss: 0.780 Vali Loss: 30.407 Vali Acc: 0.519 Test Loss: 30.407 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 2611717
model size : 11.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 8.79936170578003
Epoch: 1, Steps: 32 | Train Loss: 2.765 Vali Loss: 3.780 Vali Acc: 0.183 Test Loss: 3.780 Test Acc: 0.183
Validation loss decreased (inf --> -0.183168).  Saving model ...
Epoch: 2 cost time: 7.6895434856414795
Epoch: 2, Steps: 32 | Train Loss: 2.835 Vali Loss: 3.499 Vali Acc: 0.458 Test Loss: 3.499 Test Acc: 0.458
Validation loss decreased (-0.183168 --> -0.457980).  Saving model ...
Epoch: 3 cost time: 7.544150114059448
Epoch: 3, Steps: 32 | Train Loss: 3.574 Vali Loss: 4.805 Vali Acc: 0.420 Test Loss: 4.805 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.511077165603638
Epoch: 4, Steps: 32 | Train Loss: 2.278 Vali Loss: 6.980 Vali Acc: 0.275 Test Loss: 6.980 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.677437782287598
Epoch: 5, Steps: 32 | Train Loss: 0.512 Vali Loss: 7.424 Vali Acc: 0.435 Test Loss: 7.424 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 7.807278633117676
Epoch: 6, Steps: 32 | Train Loss: 0.746 Vali Loss: 9.006 Vali Acc: 0.382 Test Loss: 9.006 Test Acc: 0.382
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 7.62581467628479
Epoch: 7, Steps: 32 | Train Loss: 1.012 Vali Loss: 13.844 Vali Acc: 0.321 Test Loss: 13.844 Test Acc: 0.321
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 7.5100178718566895
Epoch: 8, Steps: 32 | Train Loss: 1.514 Vali Loss: 15.490 Vali Acc: 0.458 Test Loss: 15.490 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 7.709299802780151
Epoch: 9, Steps: 32 | Train Loss: 1.622 Vali Loss: 11.124 Vali Acc: 0.542 Test Loss: 11.124 Test Acc: 0.542
Validation loss decreased (-0.457980 --> -0.541873).  Saving model ...
Epoch: 10 cost time: 7.613288640975952
Epoch: 10, Steps: 32 | Train Loss: 0.177 Vali Loss: 12.424 Vali Acc: 0.550 Test Loss: 12.424 Test Acc: 0.550
Validation loss decreased (-0.541873 --> -0.549494).  Saving model ...
Epoch: 11 cost time: 7.580605983734131
Epoch: 11, Steps: 32 | Train Loss: 0.000 Vali Loss: 12.311 Vali Acc: 0.496 Test Loss: 12.311 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.65286111831665
Epoch: 12, Steps: 32 | Train Loss: 0.071 Vali Loss: 16.008 Vali Acc: 0.550 Test Loss: 16.008 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 7.5916221141815186
Epoch: 13, Steps: 32 | Train Loss: 0.969 Vali Loss: 9.076 Vali Acc: 0.511 Test Loss: 9.076 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 7.6599509716033936
Epoch: 14, Steps: 32 | Train Loss: 0.113 Vali Loss: 11.221 Vali Acc: 0.511 Test Loss: 11.221 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 7.554414510726929
Epoch: 15, Steps: 32 | Train Loss: 0.542 Vali Loss: 23.757 Vali Acc: 0.519 Test Loss: 23.757 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 7.52926778793335
Epoch: 16, Steps: 32 | Train Loss: 0.539 Vali Loss: 17.505 Vali Acc: 0.565 Test Loss: 17.505 Test Acc: 0.565
Validation loss decreased (-0.549494 --> -0.564710).  Saving model ...
Epoch: 17 cost time: 7.834579229354858
Epoch: 17, Steps: 32 | Train Loss: 0.394 Vali Loss: 19.861 Vali Acc: 0.534 Test Loss: 19.861 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 7.693134069442749
Epoch: 18, Steps: 32 | Train Loss: 0.326 Vali Loss: 22.469 Vali Acc: 0.405 Test Loss: 22.469 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 7.745032548904419
Epoch: 19, Steps: 32 | Train Loss: 0.078 Vali Loss: 15.938 Vali Acc: 0.397 Test Loss: 15.938 Test Acc: 0.397
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 7.703613042831421
Epoch: 20, Steps: 32 | Train Loss: 0.395 Vali Loss: 24.448 Vali Acc: 0.374 Test Loss: 24.448 Test Acc: 0.374
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 7.908496856689453
Epoch: 21, Steps: 32 | Train Loss: 1.029 Vali Loss: 39.636 Vali Acc: 0.214 Test Loss: 39.636 Test Acc: 0.214
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 7.857322692871094
Epoch: 22, Steps: 32 | Train Loss: 1.271 Vali Loss: 41.678 Vali Acc: 0.489 Test Loss: 41.678 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 7.660513877868652
Epoch: 23, Steps: 32 | Train Loss: 1.175 Vali Loss: 41.483 Vali Acc: 0.427 Test Loss: 41.483 Test Acc: 0.427
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 7.976927280426025
Epoch: 24, Steps: 32 | Train Loss: 1.061 Vali Loss: 30.803 Vali Acc: 0.550 Test Loss: 30.803 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 7.75555157661438
Epoch: 25, Steps: 32 | Train Loss: 2.310 Vali Loss: 32.032 Vali Acc: 0.321 Test Loss: 32.032 Test Acc: 0.321
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 7.6234612464904785
Epoch: 26, Steps: 32 | Train Loss: 1.185 Vali Loss: 43.131 Vali Acc: 0.504 Test Loss: 43.131 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 1783941
model size : 7.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 23.676512718200684
Epoch: 1, Steps: 32 | Train Loss: 2.654 Vali Loss: 3.260 Vali Acc: 0.412 Test Loss: 3.260 Test Acc: 0.412
Validation loss decreased (inf --> -0.412181).  Saving model ...
Epoch: 2 cost time: 23.261162281036377
Epoch: 2, Steps: 32 | Train Loss: 1.339 Vali Loss: 3.306 Vali Acc: 0.504 Test Loss: 3.306 Test Acc: 0.504
Validation loss decreased (-0.412181 --> -0.503784).  Saving model ...
Epoch: 3 cost time: 22.837747812271118
Epoch: 3, Steps: 32 | Train Loss: 0.824 Vali Loss: 7.427 Vali Acc: 0.282 Test Loss: 7.427 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 22.770583629608154
Epoch: 4, Steps: 32 | Train Loss: 0.597 Vali Loss: 6.134 Vali Acc: 0.450 Test Loss: 6.134 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 22.758561849594116
Epoch: 5, Steps: 32 | Train Loss: 0.741 Vali Loss: 11.629 Vali Acc: 0.321 Test Loss: 11.629 Test Acc: 0.321
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 22.83151626586914
Epoch: 6, Steps: 32 | Train Loss: 0.822 Vali Loss: 8.459 Vali Acc: 0.489 Test Loss: 8.459 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 22.573938608169556
Epoch: 7, Steps: 32 | Train Loss: 0.585 Vali Loss: 10.150 Vali Acc: 0.397 Test Loss: 10.150 Test Acc: 0.397
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 23.145198822021484
Epoch: 8, Steps: 32 | Train Loss: 0.136 Vali Loss: 10.884 Vali Acc: 0.496 Test Loss: 10.884 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 22.986950874328613
Epoch: 9, Steps: 32 | Train Loss: 2.221 Vali Loss: 14.169 Vali Acc: 0.450 Test Loss: 14.169 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 22.74109959602356
Epoch: 10, Steps: 32 | Train Loss: 3.475 Vali Loss: 13.114 Vali Acc: 0.351 Test Loss: 13.114 Test Acc: 0.351
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 22.984566688537598
Epoch: 11, Steps: 32 | Train Loss: 0.189 Vali Loss: 14.713 Vali Acc: 0.374 Test Loss: 14.713 Test Acc: 0.374
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 23.065325021743774
Epoch: 12, Steps: 32 | Train Loss: 0.696 Vali Loss: 16.580 Vali Acc: 0.542 Test Loss: 16.580 Test Acc: 0.542
Validation loss decreased (-0.503784 --> -0.541819).  Saving model ...
Epoch: 13 cost time: 22.63995122909546
Epoch: 13, Steps: 32 | Train Loss: 1.718 Vali Loss: 15.947 Vali Acc: 0.420 Test Loss: 15.947 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 22.520698308944702
Epoch: 14, Steps: 32 | Train Loss: 0.209 Vali Loss: 19.431 Vali Acc: 0.275 Test Loss: 19.431 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 22.52129340171814
Epoch: 15, Steps: 32 | Train Loss: 0.648 Vali Loss: 18.344 Vali Acc: 0.420 Test Loss: 18.344 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 22.952007293701172
Epoch: 16, Steps: 32 | Train Loss: 0.320 Vali Loss: 22.126 Vali Acc: 0.496 Test Loss: 22.126 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 22.928835153579712
Epoch: 17, Steps: 32 | Train Loss: 0.517 Vali Loss: 18.431 Vali Acc: 0.435 Test Loss: 18.431 Test Acc: 0.435
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 22.61680555343628
Epoch: 18, Steps: 32 | Train Loss: 1.961 Vali Loss: 27.683 Vali Acc: 0.328 Test Loss: 27.683 Test Acc: 0.328
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 22.58316159248352
Epoch: 19, Steps: 32 | Train Loss: 0.865 Vali Loss: 26.697 Vali Acc: 0.374 Test Loss: 26.697 Test Acc: 0.374
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 22.617251873016357
Epoch: 20, Steps: 32 | Train Loss: 0.838 Vali Loss: 27.111 Vali Acc: 0.374 Test Loss: 27.111 Test Acc: 0.374
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 22.62619400024414
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 25.098 Vali Acc: 0.359 Test Loss: 25.098 Test Acc: 0.359
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 22.73929190635681
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 24.700 Vali Acc: 0.351 Test Loss: 24.700 Test Acc: 0.351
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 2025605
model size : 8.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 12.550248384475708
Epoch: 1, Steps: 32 | Train Loss: 2.829 Vali Loss: 2.384 Vali Acc: 0.252 Test Loss: 2.384 Test Acc: 0.252
Validation loss decreased (inf --> -0.251885).  Saving model ...
Epoch: 2 cost time: 10.886768102645874
Epoch: 2, Steps: 32 | Train Loss: 1.305 Vali Loss: 3.419 Vali Acc: 0.351 Test Loss: 3.419 Test Acc: 0.351
Validation loss decreased (-0.251885 --> -0.351111).  Saving model ...
Epoch: 3 cost time: 10.94395399093628
Epoch: 3, Steps: 32 | Train Loss: 0.984 Vali Loss: 3.304 Vali Acc: 0.511 Test Loss: 3.304 Test Acc: 0.511
Validation loss decreased (-0.351111 --> -0.511417).  Saving model ...
Epoch: 4 cost time: 11.173159122467041
Epoch: 4, Steps: 32 | Train Loss: 1.916 Vali Loss: 8.756 Vali Acc: 0.290 Test Loss: 8.756 Test Acc: 0.290
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 11.134543180465698
Epoch: 5, Steps: 32 | Train Loss: 1.172 Vali Loss: 7.901 Vali Acc: 0.489 Test Loss: 7.901 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 11.264571905136108
Epoch: 6, Steps: 32 | Train Loss: 0.632 Vali Loss: 6.813 Vali Acc: 0.496 Test Loss: 6.813 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 11.281085968017578
Epoch: 7, Steps: 32 | Train Loss: 0.337 Vali Loss: 9.376 Vali Acc: 0.435 Test Loss: 9.376 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 11.235670804977417
Epoch: 8, Steps: 32 | Train Loss: 0.788 Vali Loss: 9.482 Vali Acc: 0.481 Test Loss: 9.482 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 11.29647970199585
Epoch: 9, Steps: 32 | Train Loss: 1.279 Vali Loss: 13.493 Vali Acc: 0.527 Test Loss: 13.493 Test Acc: 0.527
Validation loss decreased (-0.511417 --> -0.526583).  Saving model ...
Epoch: 10 cost time: 11.280451536178589
Epoch: 10, Steps: 32 | Train Loss: 1.101 Vali Loss: 11.936 Vali Acc: 0.511 Test Loss: 11.936 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 11.561047792434692
Epoch: 11, Steps: 32 | Train Loss: 0.429 Vali Loss: 17.017 Vali Acc: 0.344 Test Loss: 17.017 Test Acc: 0.344
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 11.362788677215576
Epoch: 12, Steps: 32 | Train Loss: 0.073 Vali Loss: 18.897 Vali Acc: 0.458 Test Loss: 18.897 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 11.115456104278564
Epoch: 13, Steps: 32 | Train Loss: 0.511 Vali Loss: 14.865 Vali Acc: 0.565 Test Loss: 14.865 Test Acc: 0.565
Validation loss decreased (-0.526583 --> -0.564737).  Saving model ...
Epoch: 14 cost time: 11.183539867401123
Epoch: 14, Steps: 32 | Train Loss: 0.066 Vali Loss: 23.349 Vali Acc: 0.534 Test Loss: 23.349 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 11.403600215911865
Epoch: 15, Steps: 32 | Train Loss: 0.173 Vali Loss: 17.479 Vali Acc: 0.374 Test Loss: 17.479 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 11.329383134841919
Epoch: 16, Steps: 32 | Train Loss: 0.043 Vali Loss: 14.501 Vali Acc: 0.519 Test Loss: 14.501 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 11.36464786529541
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 18.289 Vali Acc: 0.519 Test Loss: 18.289 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 10.972501277923584
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 18.353 Vali Acc: 0.519 Test Loss: 18.353 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 11.196921825408936
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 18.213 Vali Acc: 0.519 Test Loss: 18.213 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 11.336580514907837
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 18.200 Vali Acc: 0.519 Test Loss: 18.200 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 11.361643314361572
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 18.196 Vali Acc: 0.519 Test Loss: 18.196 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 11.049632549285889
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 18.192 Vali Acc: 0.519 Test Loss: 18.192 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 11.197634220123291
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 18.182 Vali Acc: 0.519 Test Loss: 18.182 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 1611653
model size : 7.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 16.279298782348633
Epoch: 1, Steps: 32 | Train Loss: 2.743 Vali Loss: 2.950 Vali Acc: 0.198 Test Loss: 2.950 Test Acc: 0.198
Validation loss decreased (inf --> -0.198444).  Saving model ...
Epoch: 2 cost time: 15.555493831634521
Epoch: 2, Steps: 32 | Train Loss: 1.418 Vali Loss: 3.496 Vali Acc: 0.420 Test Loss: 3.496 Test Acc: 0.420
Validation loss decreased (-0.198444 --> -0.419812).  Saving model ...
Epoch: 3 cost time: 15.734244108200073
Epoch: 3, Steps: 32 | Train Loss: 1.704 Vali Loss: 10.318 Vali Acc: 0.244 Test Loss: 10.318 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 15.460325241088867
Epoch: 4, Steps: 32 | Train Loss: 1.373 Vali Loss: 5.823 Vali Acc: 0.412 Test Loss: 5.823 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 15.8034508228302
Epoch: 5, Steps: 32 | Train Loss: 0.739 Vali Loss: 12.372 Vali Acc: 0.260 Test Loss: 12.372 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 15.65912938117981
Epoch: 6, Steps: 32 | Train Loss: 0.263 Vali Loss: 15.866 Vali Acc: 0.260 Test Loss: 15.866 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 15.188890933990479
Epoch: 7, Steps: 32 | Train Loss: 0.929 Vali Loss: 9.914 Vali Acc: 0.336 Test Loss: 9.914 Test Acc: 0.336
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 15.25617504119873
Epoch: 8, Steps: 32 | Train Loss: 0.512 Vali Loss: 9.281 Vali Acc: 0.435 Test Loss: 9.281 Test Acc: 0.435
Validation loss decreased (-0.419812 --> -0.435022).  Saving model ...
Epoch: 9 cost time: 15.266588687896729
Epoch: 9, Steps: 32 | Train Loss: 1.016 Vali Loss: 13.616 Vali Acc: 0.366 Test Loss: 13.616 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 15.375273942947388
Epoch: 10, Steps: 32 | Train Loss: 0.837 Vali Loss: 14.295 Vali Acc: 0.359 Test Loss: 14.295 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 15.298991203308105
Epoch: 11, Steps: 32 | Train Loss: 0.562 Vali Loss: 17.603 Vali Acc: 0.534 Test Loss: 17.603 Test Acc: 0.534
Validation loss decreased (-0.435022 --> -0.534175).  Saving model ...
Epoch: 12 cost time: 15.39487600326538
Epoch: 12, Steps: 32 | Train Loss: 0.139 Vali Loss: 20.486 Vali Acc: 0.504 Test Loss: 20.486 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 15.391281843185425
Epoch: 13, Steps: 32 | Train Loss: 1.187 Vali Loss: 16.641 Vali Acc: 0.412 Test Loss: 16.641 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 15.17322587966919
Epoch: 14, Steps: 32 | Train Loss: 0.768 Vali Loss: 30.007 Vali Acc: 0.527 Test Loss: 30.007 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 15.306098222732544
Epoch: 15, Steps: 32 | Train Loss: 2.057 Vali Loss: 31.665 Vali Acc: 0.290 Test Loss: 31.665 Test Acc: 0.290
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 15.512507438659668
Epoch: 16, Steps: 32 | Train Loss: 1.890 Vali Loss: 21.234 Vali Acc: 0.458 Test Loss: 21.234 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 15.279754877090454
Epoch: 17, Steps: 32 | Train Loss: 1.196 Vali Loss: 20.235 Vali Acc: 0.397 Test Loss: 20.235 Test Acc: 0.397
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 15.595035314559937
Epoch: 18, Steps: 32 | Train Loss: 0.652 Vali Loss: 28.784 Vali Acc: 0.336 Test Loss: 28.784 Test Acc: 0.336
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 15.650404214859009
Epoch: 19, Steps: 32 | Train Loss: 0.644 Vali Loss: 23.186 Vali Acc: 0.473 Test Loss: 23.186 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 15.441498041152954
Epoch: 20, Steps: 32 | Train Loss: 0.451 Vali Loss: 27.842 Vali Acc: 0.359 Test Loss: 27.842 Test Acc: 0.359
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 15.489877939224243
Epoch: 21, Steps: 32 | Train Loss: 0.117 Vali Loss: 26.443 Vali Acc: 0.443 Test Loss: 26.443 Test Acc: 0.443
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 2025605
model size : 8.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 9.530041933059692
Epoch: 1, Steps: 32 | Train Loss: 2.869 Vali Loss: 2.429 Vali Acc: 0.275 Test Loss: 2.429 Test Acc: 0.275
Validation loss decreased (inf --> -0.274785).  Saving model ...
Epoch: 2 cost time: 8.205344676971436
Epoch: 2, Steps: 32 | Train Loss: 1.530 Vali Loss: 5.178 Vali Acc: 0.214 Test Loss: 5.178 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.36134123802185
Epoch: 3, Steps: 32 | Train Loss: 1.194 Vali Loss: 6.455 Vali Acc: 0.511 Test Loss: 6.455 Test Acc: 0.511
Validation loss decreased (-0.274785 --> -0.511386).  Saving model ...
Epoch: 4 cost time: 8.4161057472229
Epoch: 4, Steps: 32 | Train Loss: 2.326 Vali Loss: 12.164 Vali Acc: 0.267 Test Loss: 12.164 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.419341325759888
Epoch: 5, Steps: 32 | Train Loss: 0.870 Vali Loss: 8.634 Vali Acc: 0.542 Test Loss: 8.634 Test Acc: 0.542
Validation loss decreased (-0.511386 --> -0.541898).  Saving model ...
Epoch: 6 cost time: 8.337229013442993
Epoch: 6, Steps: 32 | Train Loss: 0.792 Vali Loss: 13.462 Vali Acc: 0.389 Test Loss: 13.462 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.30830717086792
Epoch: 7, Steps: 32 | Train Loss: 1.165 Vali Loss: 9.181 Vali Acc: 0.550 Test Loss: 9.181 Test Acc: 0.550
Validation loss decreased (-0.541898 --> -0.549527).  Saving model ...
Epoch: 8 cost time: 8.335245609283447
Epoch: 8, Steps: 32 | Train Loss: 0.807 Vali Loss: 8.751 Vali Acc: 0.427 Test Loss: 8.751 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 8.412046432495117
Epoch: 9, Steps: 32 | Train Loss: 0.118 Vali Loss: 12.532 Vali Acc: 0.527 Test Loss: 12.532 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 8.271449565887451
Epoch: 10, Steps: 32 | Train Loss: 0.235 Vali Loss: 9.855 Vali Acc: 0.580 Test Loss: 9.855 Test Acc: 0.580
Validation loss decreased (-0.549527 --> -0.580054).  Saving model ...
Epoch: 11 cost time: 8.203011274337769
Epoch: 11, Steps: 32 | Train Loss: 0.153 Vali Loss: 13.148 Vali Acc: 0.504 Test Loss: 13.148 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 8.373391389846802
Epoch: 12, Steps: 32 | Train Loss: 0.610 Vali Loss: 12.767 Vali Acc: 0.519 Test Loss: 12.767 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 8.235755681991577
Epoch: 13, Steps: 32 | Train Loss: 0.548 Vali Loss: 11.188 Vali Acc: 0.573 Test Loss: 11.188 Test Acc: 0.573
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 8.063103675842285
Epoch: 14, Steps: 32 | Train Loss: 1.302 Vali Loss: 12.259 Vali Acc: 0.466 Test Loss: 12.259 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 8.488597393035889
Epoch: 15, Steps: 32 | Train Loss: 0.046 Vali Loss: 29.136 Vali Acc: 0.321 Test Loss: 29.136 Test Acc: 0.321
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 8.174556732177734
Epoch: 16, Steps: 32 | Train Loss: 3.708 Vali Loss: 18.027 Vali Acc: 0.565 Test Loss: 18.027 Test Acc: 0.565
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 8.146420955657959
Epoch: 17, Steps: 32 | Train Loss: 0.442 Vali Loss: 14.191 Vali Acc: 0.580 Test Loss: 14.191 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 8.205398559570312
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 14.896 Vali Acc: 0.557 Test Loss: 14.896 Test Acc: 0.557
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 8.229198217391968
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 14.882 Vali Acc: 0.557 Test Loss: 14.882 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 8.092896938323975
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 14.815 Vali Acc: 0.550 Test Loss: 14.815 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 1611653
model size : 7.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 9.409292697906494
Epoch: 1, Steps: 32 | Train Loss: 2.538 Vali Loss: 2.311 Vali Acc: 0.443 Test Loss: 2.311 Test Acc: 0.443
Validation loss decreased (inf --> -0.442725).  Saving model ...
Epoch: 2 cost time: 7.861276388168335
Epoch: 2, Steps: 32 | Train Loss: 2.033 Vali Loss: 2.340 Vali Acc: 0.427 Test Loss: 2.340 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.965019941329956
Epoch: 3, Steps: 32 | Train Loss: 1.291 Vali Loss: 5.689 Vali Acc: 0.344 Test Loss: 5.689 Test Acc: 0.344
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 8.015831232070923
Epoch: 4, Steps: 32 | Train Loss: 0.508 Vali Loss: 4.920 Vali Acc: 0.420 Test Loss: 4.920 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 8.033568859100342
Epoch: 5, Steps: 32 | Train Loss: 0.162 Vali Loss: 9.344 Vali Acc: 0.328 Test Loss: 9.344 Test Acc: 0.328
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 8.008204698562622
Epoch: 6, Steps: 32 | Train Loss: 1.302 Vali Loss: 11.479 Vali Acc: 0.382 Test Loss: 11.479 Test Acc: 0.382
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 7.802683115005493
Epoch: 7, Steps: 32 | Train Loss: 0.440 Vali Loss: 13.541 Vali Acc: 0.282 Test Loss: 13.541 Test Acc: 0.282
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 8.07820177078247
Epoch: 8, Steps: 32 | Train Loss: 0.397 Vali Loss: 13.960 Vali Acc: 0.573 Test Loss: 13.960 Test Acc: 0.573
Validation loss decreased (-0.442725 --> -0.572379).  Saving model ...
Epoch: 9 cost time: 8.03968858718872
Epoch: 9, Steps: 32 | Train Loss: 0.343 Vali Loss: 13.688 Vali Acc: 0.473 Test Loss: 13.688 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 8.185121774673462
Epoch: 10, Steps: 32 | Train Loss: 1.304 Vali Loss: 12.391 Vali Acc: 0.450 Test Loss: 12.391 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 8.007014513015747
Epoch: 11, Steps: 32 | Train Loss: 1.458 Vali Loss: 19.581 Vali Acc: 0.511 Test Loss: 19.581 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 8.075252771377563
Epoch: 12, Steps: 32 | Train Loss: 0.991 Vali Loss: 17.723 Vali Acc: 0.305 Test Loss: 17.723 Test Acc: 0.305
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 8.02252197265625
Epoch: 13, Steps: 32 | Train Loss: 1.602 Vali Loss: 25.599 Vali Acc: 0.519 Test Loss: 25.599 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 7.870952606201172
Epoch: 14, Steps: 32 | Train Loss: 1.995 Vali Loss: 26.851 Vali Acc: 0.336 Test Loss: 26.851 Test Acc: 0.336
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 7.9454333782196045
Epoch: 15, Steps: 32 | Train Loss: 0.298 Vali Loss: 23.674 Vali Acc: 0.489 Test Loss: 23.674 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 7.958187818527222
Epoch: 16, Steps: 32 | Train Loss: 0.881 Vali Loss: 25.089 Vali Acc: 0.519 Test Loss: 25.089 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 8.073394060134888
Epoch: 17, Steps: 32 | Train Loss: 1.639 Vali Loss: 29.314 Vali Acc: 0.496 Test Loss: 29.314 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 7.991101503372192
Epoch: 18, Steps: 32 | Train Loss: 0.001 Vali Loss: 29.191 Vali Acc: 0.405 Test Loss: 29.191 Test Acc: 0.405
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 2025605
model size : 8.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 6.479766368865967
Epoch: 1, Steps: 32 | Train Loss: 2.882 Vali Loss: 3.523 Vali Acc: 0.252 Test Loss: 3.523 Test Acc: 0.252
Validation loss decreased (inf --> -0.251873).  Saving model ...
Epoch: 2 cost time: 4.938246011734009
Epoch: 2, Steps: 32 | Train Loss: 1.826 Vali Loss: 5.306 Vali Acc: 0.206 Test Loss: 5.306 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.014180660247803
Epoch: 3, Steps: 32 | Train Loss: 1.240 Vali Loss: 5.212 Vali Acc: 0.397 Test Loss: 5.212 Test Acc: 0.397
Validation loss decreased (-0.251873 --> -0.396894).  Saving model ...
Epoch: 4 cost time: 5.004629135131836
Epoch: 4, Steps: 32 | Train Loss: 0.911 Vali Loss: 7.118 Vali Acc: 0.389 Test Loss: 7.118 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.064299583435059
Epoch: 5, Steps: 32 | Train Loss: 0.727 Vali Loss: 8.348 Vali Acc: 0.412 Test Loss: 8.348 Test Acc: 0.412
Validation loss decreased (-0.396894 --> -0.412130).  Saving model ...
Epoch: 6 cost time: 5.090878009796143
Epoch: 6, Steps: 32 | Train Loss: 1.641 Vali Loss: 11.709 Vali Acc: 0.298 Test Loss: 11.709 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.895006895065308
Epoch: 7, Steps: 32 | Train Loss: 0.025 Vali Loss: 9.879 Vali Acc: 0.573 Test Loss: 9.879 Test Acc: 0.573
Validation loss decreased (-0.412130 --> -0.572420).  Saving model ...
Epoch: 8 cost time: 4.923390626907349
Epoch: 8, Steps: 32 | Train Loss: 0.482 Vali Loss: 9.774 Vali Acc: 0.573 Test Loss: 9.774 Test Acc: 0.573
Validation loss decreased (-0.572420 --> -0.572421).  Saving model ...
Epoch: 9 cost time: 4.907200813293457
Epoch: 9, Steps: 32 | Train Loss: 0.718 Vali Loss: 12.923 Vali Acc: 0.389 Test Loss: 12.923 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.020704984664917
Epoch: 10, Steps: 32 | Train Loss: 0.550 Vali Loss: 20.968 Vali Acc: 0.496 Test Loss: 20.968 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.980194568634033
Epoch: 11, Steps: 32 | Train Loss: 0.811 Vali Loss: 17.878 Vali Acc: 0.573 Test Loss: 17.878 Test Acc: 0.573
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.997771501541138
Epoch: 12, Steps: 32 | Train Loss: 1.316 Vali Loss: 23.576 Vali Acc: 0.511 Test Loss: 23.576 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.953278541564941
Epoch: 13, Steps: 32 | Train Loss: 0.485 Vali Loss: 13.630 Vali Acc: 0.450 Test Loss: 13.630 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.043551921844482
Epoch: 14, Steps: 32 | Train Loss: 0.427 Vali Loss: 21.459 Vali Acc: 0.527 Test Loss: 21.459 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.0364766120910645
Epoch: 15, Steps: 32 | Train Loss: 0.261 Vali Loss: 21.401 Vali Acc: 0.504 Test Loss: 21.401 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.987304449081421
Epoch: 16, Steps: 32 | Train Loss: 0.527 Vali Loss: 24.246 Vali Acc: 0.595 Test Loss: 24.246 Test Acc: 0.595
Validation loss decreased (-0.572421 --> -0.595177).  Saving model ...
Epoch: 17 cost time: 5.003424644470215
Epoch: 17, Steps: 32 | Train Loss: 0.335 Vali Loss: 14.613 Vali Acc: 0.565 Test Loss: 14.613 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.043695449829102
Epoch: 18, Steps: 32 | Train Loss: 0.001 Vali Loss: 23.596 Vali Acc: 0.573 Test Loss: 23.596 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.970484256744385
Epoch: 19, Steps: 32 | Train Loss: 0.222 Vali Loss: 22.590 Vali Acc: 0.573 Test Loss: 22.590 Test Acc: 0.573
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.934135437011719
Epoch: 20, Steps: 32 | Train Loss: 0.147 Vali Loss: 23.585 Vali Acc: 0.481 Test Loss: 23.585 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 5.063639163970947
Epoch: 21, Steps: 32 | Train Loss: 0.992 Vali Loss: 27.100 Vali Acc: 0.595 Test Loss: 27.100 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 5.249345779418945
Epoch: 22, Steps: 32 | Train Loss: 0.127 Vali Loss: 23.284 Vali Acc: 0.496 Test Loss: 23.284 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 5.062079668045044
Epoch: 23, Steps: 32 | Train Loss: 0.036 Vali Loss: 33.757 Vali Acc: 0.420 Test Loss: 33.757 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 5.299604892730713
Epoch: 24, Steps: 32 | Train Loss: 1.508 Vali Loss: 24.377 Vali Acc: 0.458 Test Loss: 24.377 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 4.980575323104858
Epoch: 25, Steps: 32 | Train Loss: 1.165 Vali Loss: 37.242 Vali Acc: 0.504 Test Loss: 37.242 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 5.018179893493652
Epoch: 26, Steps: 32 | Train Loss: 1.234 Vali Loss: 35.989 Vali Acc: 0.557 Test Loss: 35.989 Test Acc: 0.557
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5954198473282443
model parameter : 1611653
model size : 7.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 43.90023136138916
Epoch: 1, Steps: 32 | Train Loss: 2.409 Vali Loss: 1.696 Vali Acc: 0.244 Test Loss: 1.696 Test Acc: 0.244
Validation loss decreased (inf --> -0.244258).  Saving model ...
Epoch: 2 cost time: 42.302231788635254
Epoch: 2, Steps: 32 | Train Loss: 1.349 Vali Loss: 4.083 Vali Acc: 0.496 Test Loss: 4.083 Test Acc: 0.496
Validation loss decreased (-0.244258 --> -0.496142).  Saving model ...
Epoch: 3 cost time: 42.99701428413391
Epoch: 3, Steps: 32 | Train Loss: 1.082 Vali Loss: 5.335 Vali Acc: 0.420 Test Loss: 5.335 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 43.35341429710388
Epoch: 4, Steps: 32 | Train Loss: 1.232 Vali Loss: 4.411 Vali Acc: 0.527 Test Loss: 4.411 Test Acc: 0.527
Validation loss decreased (-0.496142 --> -0.526673).  Saving model ...
Epoch: 5 cost time: 43.601717948913574
Epoch: 5, Steps: 32 | Train Loss: 0.143 Vali Loss: 4.143 Vali Acc: 0.557 Test Loss: 4.143 Test Acc: 0.557
Validation loss decreased (-0.526673 --> -0.557210).  Saving model ...
Epoch: 6 cost time: 42.943456411361694
Epoch: 6, Steps: 32 | Train Loss: 0.047 Vali Loss: 8.342 Vali Acc: 0.275 Test Loss: 8.342 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 43.62845540046692
Epoch: 7, Steps: 32 | Train Loss: 0.485 Vali Loss: 6.367 Vali Acc: 0.473 Test Loss: 6.367 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 43.221007108688354
Epoch: 8, Steps: 32 | Train Loss: 0.070 Vali Loss: 5.702 Vali Acc: 0.511 Test Loss: 5.702 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 42.661248445510864
Epoch: 9, Steps: 32 | Train Loss: 0.089 Vali Loss: 7.747 Vali Acc: 0.466 Test Loss: 7.747 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 42.91240215301514
Epoch: 10, Steps: 32 | Train Loss: 0.293 Vali Loss: 6.735 Vali Acc: 0.382 Test Loss: 6.735 Test Acc: 0.382
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 42.807384967803955
Epoch: 11, Steps: 32 | Train Loss: 0.374 Vali Loss: 8.572 Vali Acc: 0.435 Test Loss: 8.572 Test Acc: 0.435
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 43.31864953041077
Epoch: 12, Steps: 32 | Train Loss: 0.387 Vali Loss: 6.683 Vali Acc: 0.473 Test Loss: 6.683 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 44.200724601745605
Epoch: 13, Steps: 32 | Train Loss: 0.588 Vali Loss: 9.953 Vali Acc: 0.405 Test Loss: 9.953 Test Acc: 0.405
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 44.57841944694519
Epoch: 14, Steps: 32 | Train Loss: 0.180 Vali Loss: 12.873 Vali Acc: 0.344 Test Loss: 12.873 Test Acc: 0.344
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 45.39738917350769
Epoch: 15, Steps: 32 | Train Loss: 0.228 Vali Loss: 12.890 Vali Acc: 0.504 Test Loss: 12.890 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 1892741
model size : 7.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 19.458372831344604
Epoch: 1, Steps: 32 | Train Loss: 2.289 Vali Loss: 2.461 Vali Acc: 0.298 Test Loss: 2.461 Test Acc: 0.298
Validation loss decreased (inf --> -0.297685).  Saving model ...
Epoch: 2 cost time: 18.331809282302856
Epoch: 2, Steps: 32 | Train Loss: 2.204 Vali Loss: 3.948 Vali Acc: 0.519 Test Loss: 3.948 Test Acc: 0.519
Validation loss decreased (-0.297685 --> -0.519044).  Saving model ...
Epoch: 3 cost time: 18.19972562789917
Epoch: 3, Steps: 32 | Train Loss: 1.275 Vali Loss: 3.808 Vali Acc: 0.405 Test Loss: 3.808 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 18.11439871788025
Epoch: 4, Steps: 32 | Train Loss: 0.220 Vali Loss: 6.159 Vali Acc: 0.229 Test Loss: 6.159 Test Acc: 0.229
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 18.437395334243774
Epoch: 5, Steps: 32 | Train Loss: 0.109 Vali Loss: 5.226 Vali Acc: 0.458 Test Loss: 5.226 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 18.69741153717041
Epoch: 6, Steps: 32 | Train Loss: 0.376 Vali Loss: 6.436 Vali Acc: 0.511 Test Loss: 6.436 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 18.786014556884766
Epoch: 7, Steps: 32 | Train Loss: 0.090 Vali Loss: 5.540 Vali Acc: 0.443 Test Loss: 5.540 Test Acc: 0.443
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 18.173513889312744
Epoch: 8, Steps: 32 | Train Loss: 1.002 Vali Loss: 5.114 Vali Acc: 0.511 Test Loss: 5.114 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 17.55330538749695
Epoch: 9, Steps: 32 | Train Loss: 0.058 Vali Loss: 6.275 Vali Acc: 0.412 Test Loss: 6.275 Test Acc: 0.412
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 18.247121572494507
Epoch: 10, Steps: 32 | Train Loss: 0.286 Vali Loss: 7.989 Vali Acc: 0.481 Test Loss: 7.989 Test Acc: 0.481
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 18.593940258026123
Epoch: 11, Steps: 32 | Train Loss: 0.330 Vali Loss: 7.340 Vali Acc: 0.519 Test Loss: 7.340 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 18.556257724761963
Epoch: 12, Steps: 32 | Train Loss: 0.226 Vali Loss: 6.923 Vali Acc: 0.473 Test Loss: 6.923 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 1064773
model size : 4.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 31.465919971466064
Epoch: 1, Steps: 32 | Train Loss: 2.397 Vali Loss: 1.675 Vali Acc: 0.244 Test Loss: 1.675 Test Acc: 0.244
Validation loss decreased (inf --> -0.244258).  Saving model ...
Epoch: 2 cost time: 29.756428241729736
Epoch: 2, Steps: 32 | Train Loss: 1.271 Vali Loss: 3.978 Vali Acc: 0.496 Test Loss: 3.978 Test Acc: 0.496
Validation loss decreased (-0.244258 --> -0.496143).  Saving model ...
Epoch: 3 cost time: 30.034892559051514
Epoch: 3, Steps: 32 | Train Loss: 0.775 Vali Loss: 4.404 Vali Acc: 0.427 Test Loss: 4.404 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 30.366958379745483
Epoch: 4, Steps: 32 | Train Loss: 1.170 Vali Loss: 6.520 Vali Acc: 0.496 Test Loss: 6.520 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 30.716455459594727
Epoch: 5, Steps: 32 | Train Loss: 0.297 Vali Loss: 6.374 Vali Acc: 0.534 Test Loss: 6.374 Test Acc: 0.534
Validation loss decreased (-0.496143 --> -0.534287).  Saving model ...
Epoch: 6 cost time: 30.804051160812378
Epoch: 6, Steps: 32 | Train Loss: 0.213 Vali Loss: 4.750 Vali Acc: 0.496 Test Loss: 4.750 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 30.90577268600464
Epoch: 7, Steps: 32 | Train Loss: 0.226 Vali Loss: 7.307 Vali Acc: 0.519 Test Loss: 7.307 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 30.521159172058105
Epoch: 8, Steps: 32 | Train Loss: 0.172 Vali Loss: 6.960 Vali Acc: 0.534 Test Loss: 6.960 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 31.8499972820282
Epoch: 9, Steps: 32 | Train Loss: 0.061 Vali Loss: 9.046 Vali Acc: 0.496 Test Loss: 9.046 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 31.174453735351562
Epoch: 10, Steps: 32 | Train Loss: 0.118 Vali Loss: 7.554 Vali Acc: 0.427 Test Loss: 7.554 Test Acc: 0.427
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 31.427592515945435
Epoch: 11, Steps: 32 | Train Loss: 0.269 Vali Loss: 7.234 Vali Acc: 0.489 Test Loss: 7.234 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 31.988373517990112
Epoch: 12, Steps: 32 | Train Loss: 0.021 Vali Loss: 7.052 Vali Acc: 0.435 Test Loss: 7.052 Test Acc: 0.435
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 32.16953754425049
Epoch: 13, Steps: 32 | Train Loss: 0.510 Vali Loss: 11.093 Vali Acc: 0.397 Test Loss: 11.093 Test Acc: 0.397
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 31.905451774597168
Epoch: 14, Steps: 32 | Train Loss: 0.333 Vali Loss: 9.981 Vali Acc: 0.542 Test Loss: 9.981 Test Acc: 0.542
Validation loss decreased (-0.534287 --> -0.541885).  Saving model ...
Epoch: 15 cost time: 32.75247645378113
Epoch: 15, Steps: 32 | Train Loss: 0.889 Vali Loss: 9.531 Vali Acc: 0.473 Test Loss: 9.531 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 30.206562280654907
Epoch: 16, Steps: 32 | Train Loss: 2.508 Vali Loss: 15.315 Vali Acc: 0.511 Test Loss: 15.315 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 31.395473957061768
Epoch: 17, Steps: 32 | Train Loss: 1.420 Vali Loss: 20.032 Vali Acc: 0.489 Test Loss: 20.032 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 31.77582335472107
Epoch: 18, Steps: 32 | Train Loss: 1.359 Vali Loss: 11.622 Vali Acc: 0.481 Test Loss: 11.622 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 33.33423590660095
Epoch: 19, Steps: 32 | Train Loss: 0.365 Vali Loss: 13.712 Vali Acc: 0.542 Test Loss: 13.712 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 30.658546686172485
Epoch: 20, Steps: 32 | Train Loss: 0.894 Vali Loss: 15.917 Vali Acc: 0.504 Test Loss: 15.917 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 30.3466534614563
Epoch: 21, Steps: 32 | Train Loss: 1.476 Vali Loss: 15.038 Vali Acc: 0.473 Test Loss: 15.038 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 32.593897342681885
Epoch: 22, Steps: 32 | Train Loss: 0.867 Vali Loss: 14.307 Vali Acc: 0.542 Test Loss: 14.307 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 33.38758969306946
Epoch: 23, Steps: 32 | Train Loss: 0.487 Vali Loss: 19.195 Vali Acc: 0.542 Test Loss: 19.195 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 34.11273121833801
Epoch: 24, Steps: 32 | Train Loss: 0.125 Vali Loss: 19.108 Vali Acc: 0.489 Test Loss: 19.108 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 1892741
model size : 7.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 14.696607112884521
Epoch: 1, Steps: 32 | Train Loss: 2.272 Vali Loss: 2.288 Vali Acc: 0.290 Test Loss: 2.288 Test Acc: 0.290
Validation loss decreased (inf --> -0.290053).  Saving model ...
Epoch: 2 cost time: 12.692237138748169
Epoch: 2, Steps: 32 | Train Loss: 2.305 Vali Loss: 3.889 Vali Acc: 0.496 Test Loss: 3.889 Test Acc: 0.496
Validation loss decreased (-0.290053 --> -0.496144).  Saving model ...
Epoch: 3 cost time: 13.309664964675903
Epoch: 3, Steps: 32 | Train Loss: 1.134 Vali Loss: 3.653 Vali Acc: 0.374 Test Loss: 3.653 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 13.604687452316284
Epoch: 4, Steps: 32 | Train Loss: 0.632 Vali Loss: 3.510 Vali Acc: 0.466 Test Loss: 3.510 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 13.300610542297363
Epoch: 5, Steps: 32 | Train Loss: 0.406 Vali Loss: 4.217 Vali Acc: 0.511 Test Loss: 4.217 Test Acc: 0.511
Validation loss decreased (-0.496144 --> -0.511408).  Saving model ...
Epoch: 6 cost time: 13.447558403015137
Epoch: 6, Steps: 32 | Train Loss: 0.096 Vali Loss: 3.494 Vali Acc: 0.466 Test Loss: 3.494 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 13.710003137588501
Epoch: 7, Steps: 32 | Train Loss: 0.059 Vali Loss: 5.482 Vali Acc: 0.504 Test Loss: 5.482 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 14.279396772384644
Epoch: 8, Steps: 32 | Train Loss: 0.076 Vali Loss: 7.087 Vali Acc: 0.504 Test Loss: 7.087 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 13.84089970588684
Epoch: 9, Steps: 32 | Train Loss: 0.125 Vali Loss: 6.447 Vali Acc: 0.466 Test Loss: 6.447 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 13.702662944793701
Epoch: 10, Steps: 32 | Train Loss: 0.429 Vali Loss: 7.928 Vali Acc: 0.527 Test Loss: 7.928 Test Acc: 0.527
Validation loss decreased (-0.511408 --> -0.526638).  Saving model ...
Epoch: 11 cost time: 13.657028913497925
Epoch: 11, Steps: 32 | Train Loss: 0.263 Vali Loss: 7.627 Vali Acc: 0.412 Test Loss: 7.627 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 13.714983224868774
Epoch: 12, Steps: 32 | Train Loss: 0.709 Vali Loss: 10.883 Vali Acc: 0.389 Test Loss: 10.883 Test Acc: 0.389
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 13.540969848632812
Epoch: 13, Steps: 32 | Train Loss: 1.182 Vali Loss: 12.657 Vali Acc: 0.496 Test Loss: 12.657 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 12.470359086990356
Epoch: 14, Steps: 32 | Train Loss: 0.298 Vali Loss: 12.352 Vali Acc: 0.481 Test Loss: 12.352 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 13.017969608306885
Epoch: 15, Steps: 32 | Train Loss: 0.347 Vali Loss: 12.544 Vali Acc: 0.489 Test Loss: 12.544 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 12.850977420806885
Epoch: 16, Steps: 32 | Train Loss: 0.055 Vali Loss: 14.798 Vali Acc: 0.496 Test Loss: 14.798 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 13.2083580493927
Epoch: 17, Steps: 32 | Train Loss: 0.501 Vali Loss: 12.132 Vali Acc: 0.420 Test Loss: 12.132 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 12.889431476593018
Epoch: 18, Steps: 32 | Train Loss: 0.011 Vali Loss: 13.973 Vali Acc: 0.382 Test Loss: 13.973 Test Acc: 0.382
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 13.26529860496521
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 14.684 Vali Acc: 0.466 Test Loss: 14.684 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 13.356134176254272
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 14.416 Vali Acc: 0.527 Test Loss: 14.416 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 1064773
model size : 4.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 19.110400915145874
Epoch: 1, Steps: 32 | Train Loss: 2.392 Vali Loss: 1.649 Vali Acc: 0.252 Test Loss: 1.649 Test Acc: 0.252
Validation loss decreased (inf --> -0.251892).  Saving model ...
Epoch: 2 cost time: 19.287930488586426
Epoch: 2, Steps: 32 | Train Loss: 1.226 Vali Loss: 3.840 Vali Acc: 0.496 Test Loss: 3.840 Test Acc: 0.496
Validation loss decreased (-0.251892 --> -0.496145).  Saving model ...
Epoch: 3 cost time: 19.06073307991028
Epoch: 3, Steps: 32 | Train Loss: 0.756 Vali Loss: 5.052 Vali Acc: 0.351 Test Loss: 5.052 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 18.611282348632812
Epoch: 4, Steps: 32 | Train Loss: 0.882 Vali Loss: 5.546 Vali Acc: 0.504 Test Loss: 5.546 Test Acc: 0.504
Validation loss decreased (-0.496145 --> -0.503761).  Saving model ...
Epoch: 5 cost time: 18.52268409729004
Epoch: 5, Steps: 32 | Train Loss: 0.182 Vali Loss: 5.693 Vali Acc: 0.550 Test Loss: 5.693 Test Acc: 0.550
Validation loss decreased (-0.503761 --> -0.549561).  Saving model ...
Epoch: 6 cost time: 18.890465021133423
Epoch: 6, Steps: 32 | Train Loss: 0.356 Vali Loss: 6.285 Vali Acc: 0.466 Test Loss: 6.285 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 19.114238023757935
Epoch: 7, Steps: 32 | Train Loss: 0.080 Vali Loss: 5.693 Vali Acc: 0.427 Test Loss: 5.693 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 19.398446559906006
Epoch: 8, Steps: 32 | Train Loss: 0.285 Vali Loss: 5.407 Vali Acc: 0.542 Test Loss: 5.407 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 18.887537002563477
Epoch: 9, Steps: 32 | Train Loss: 0.367 Vali Loss: 11.237 Vali Acc: 0.496 Test Loss: 11.237 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 19.299144744873047
Epoch: 10, Steps: 32 | Train Loss: 0.491 Vali Loss: 9.511 Vali Acc: 0.496 Test Loss: 9.511 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 19.45588493347168
Epoch: 11, Steps: 32 | Train Loss: 0.234 Vali Loss: 8.552 Vali Acc: 0.473 Test Loss: 8.552 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 19.658310174942017
Epoch: 12, Steps: 32 | Train Loss: 0.473 Vali Loss: 9.429 Vali Acc: 0.565 Test Loss: 9.429 Test Acc: 0.565
Validation loss decreased (-0.549561 --> -0.564791).  Saving model ...
Epoch: 13 cost time: 19.29071617126465
Epoch: 13, Steps: 32 | Train Loss: 0.242 Vali Loss: 14.338 Vali Acc: 0.527 Test Loss: 14.338 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 19.49802255630493
Epoch: 14, Steps: 32 | Train Loss: 0.279 Vali Loss: 14.437 Vali Acc: 0.542 Test Loss: 14.437 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 19.408238649368286
Epoch: 15, Steps: 32 | Train Loss: 0.088 Vali Loss: 14.504 Vali Acc: 0.237 Test Loss: 14.504 Test Acc: 0.237
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 19.481937408447266
Epoch: 16, Steps: 32 | Train Loss: 0.618 Vali Loss: 13.569 Vali Acc: 0.443 Test Loss: 13.569 Test Acc: 0.443
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 18.850486755371094
Epoch: 17, Steps: 32 | Train Loss: 0.907 Vali Loss: 13.050 Vali Acc: 0.496 Test Loss: 13.050 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 18.251580238342285
Epoch: 18, Steps: 32 | Train Loss: 0.223 Vali Loss: 12.644 Vali Acc: 0.397 Test Loss: 12.644 Test Acc: 0.397
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 18.25174617767334
Epoch: 19, Steps: 32 | Train Loss: 1.622 Vali Loss: 22.589 Vali Acc: 0.496 Test Loss: 22.589 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 18.86598801612854
Epoch: 20, Steps: 32 | Train Loss: 1.148 Vali Loss: 13.401 Vali Acc: 0.565 Test Loss: 13.401 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 19.755170345306396
Epoch: 21, Steps: 32 | Train Loss: 0.244 Vali Loss: 14.225 Vali Acc: 0.481 Test Loss: 14.225 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 19.609639883041382
Epoch: 22, Steps: 32 | Train Loss: 1.653 Vali Loss: 24.146 Vali Acc: 0.504 Test Loss: 24.146 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 1892741
model size : 7.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 9.910204410552979
Epoch: 1, Steps: 32 | Train Loss: 2.191 Vali Loss: 1.951 Vali Acc: 0.450 Test Loss: 1.951 Test Acc: 0.450
Validation loss decreased (inf --> -0.450362).  Saving model ...
Epoch: 2 cost time: 8.282941818237305
Epoch: 2, Steps: 32 | Train Loss: 2.135 Vali Loss: 3.533 Vali Acc: 0.519 Test Loss: 3.533 Test Acc: 0.519
Validation loss decreased (-0.450362 --> -0.519049).  Saving model ...
Epoch: 3 cost time: 8.079748153686523
Epoch: 3, Steps: 32 | Train Loss: 1.126 Vali Loss: 4.201 Vali Acc: 0.267 Test Loss: 4.201 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.97149920463562
Epoch: 4, Steps: 32 | Train Loss: 0.372 Vali Loss: 5.398 Vali Acc: 0.473 Test Loss: 5.398 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 9.614743947982788
Epoch: 5, Steps: 32 | Train Loss: 0.559 Vali Loss: 5.954 Vali Acc: 0.382 Test Loss: 5.954 Test Acc: 0.382
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 8.720317840576172
Epoch: 6, Steps: 32 | Train Loss: 0.295 Vali Loss: 5.775 Vali Acc: 0.496 Test Loss: 5.775 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 8.465850353240967
Epoch: 7, Steps: 32 | Train Loss: 0.217 Vali Loss: 6.658 Vali Acc: 0.389 Test Loss: 6.658 Test Acc: 0.389
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 7.821471452713013
Epoch: 8, Steps: 32 | Train Loss: 0.277 Vali Loss: 5.923 Vali Acc: 0.466 Test Loss: 5.923 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 8.827316045761108
Epoch: 9, Steps: 32 | Train Loss: 0.276 Vali Loss: 7.630 Vali Acc: 0.397 Test Loss: 7.630 Test Acc: 0.397
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 9.350802421569824
Epoch: 10, Steps: 32 | Train Loss: 0.155 Vali Loss: 9.136 Vali Acc: 0.496 Test Loss: 9.136 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 8.205954790115356
Epoch: 11, Steps: 32 | Train Loss: 0.581 Vali Loss: 11.910 Vali Acc: 0.504 Test Loss: 11.910 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 8.238835334777832
Epoch: 12, Steps: 32 | Train Loss: 0.286 Vali Loss: 7.295 Vali Acc: 0.412 Test Loss: 7.295 Test Acc: 0.412
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 1064773
model size : 4.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 24.782429218292236
Epoch: 1, Steps: 32 | Train Loss: 1.940 Vali Loss: 1.773 Vali Acc: 0.511 Test Loss: 1.773 Test Acc: 0.511
Validation loss decreased (inf --> -0.511433).  Saving model ...
Epoch: 2 cost time: 23.34208059310913
Epoch: 2, Steps: 32 | Train Loss: 0.833 Vali Loss: 1.575 Vali Acc: 0.527 Test Loss: 1.575 Test Acc: 0.527
Validation loss decreased (-0.511433 --> -0.526702).  Saving model ...
Epoch: 3 cost time: 23.643361568450928
Epoch: 3, Steps: 32 | Train Loss: 0.223 Vali Loss: 2.360 Vali Acc: 0.427 Test Loss: 2.360 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 23.55826687812805
Epoch: 4, Steps: 32 | Train Loss: 0.355 Vali Loss: 4.504 Vali Acc: 0.328 Test Loss: 4.504 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 23.78026556968689
Epoch: 5, Steps: 32 | Train Loss: 0.475 Vali Loss: 5.656 Vali Acc: 0.351 Test Loss: 5.656 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 23.729447841644287
Epoch: 6, Steps: 32 | Train Loss: 0.227 Vali Loss: 4.809 Vali Acc: 0.351 Test Loss: 4.809 Test Acc: 0.351
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 24.33973526954651
Epoch: 7, Steps: 32 | Train Loss: 0.326 Vali Loss: 6.245 Vali Acc: 0.473 Test Loss: 6.245 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 23.803465127944946
Epoch: 8, Steps: 32 | Train Loss: 0.362 Vali Loss: 7.420 Vali Acc: 0.366 Test Loss: 7.420 Test Acc: 0.366
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 23.903305053710938
Epoch: 9, Steps: 32 | Train Loss: 0.276 Vali Loss: 6.354 Vali Acc: 0.481 Test Loss: 6.354 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 23.904828786849976
Epoch: 10, Steps: 32 | Train Loss: 0.081 Vali Loss: 7.232 Vali Acc: 0.328 Test Loss: 7.232 Test Acc: 0.328
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 23.489835500717163
Epoch: 11, Steps: 32 | Train Loss: 0.324 Vali Loss: 8.190 Vali Acc: 0.496 Test Loss: 8.190 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 23.420958757400513
Epoch: 12, Steps: 32 | Train Loss: 0.293 Vali Loss: 8.039 Vali Acc: 0.366 Test Loss: 8.039 Test Acc: 0.366
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 1306245
model size : 5.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 11.740519762039185
Epoch: 1, Steps: 32 | Train Loss: 2.230 Vali Loss: 1.422 Vali Acc: 0.504 Test Loss: 1.422 Test Acc: 0.504
Validation loss decreased (inf --> -0.503803).  Saving model ...
Epoch: 2 cost time: 10.161094665527344
Epoch: 2, Steps: 32 | Train Loss: 0.944 Vali Loss: 2.296 Vali Acc: 0.519 Test Loss: 2.296 Test Acc: 0.519
Validation loss decreased (-0.503803 --> -0.519061).  Saving model ...
Epoch: 3 cost time: 9.964306116104126
Epoch: 3, Steps: 32 | Train Loss: 0.576 Vali Loss: 2.117 Vali Acc: 0.504 Test Loss: 2.117 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.801026105880737
Epoch: 4, Steps: 32 | Train Loss: 0.180 Vali Loss: 4.886 Vali Acc: 0.527 Test Loss: 4.886 Test Acc: 0.527
Validation loss decreased (-0.519061 --> -0.526669).  Saving model ...
Epoch: 5 cost time: 10.163229703903198
Epoch: 5, Steps: 32 | Train Loss: 0.332 Vali Loss: 6.768 Vali Acc: 0.504 Test Loss: 6.768 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.947489500045776
Epoch: 6, Steps: 32 | Train Loss: 0.466 Vali Loss: 5.158 Vali Acc: 0.435 Test Loss: 5.158 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 9.738419771194458
Epoch: 7, Steps: 32 | Train Loss: 0.046 Vali Loss: 6.695 Vali Acc: 0.473 Test Loss: 6.695 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 9.413779735565186
Epoch: 8, Steps: 32 | Train Loss: 0.053 Vali Loss: 4.355 Vali Acc: 0.481 Test Loss: 4.355 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 9.480876207351685
Epoch: 9, Steps: 32 | Train Loss: 0.161 Vali Loss: 4.595 Vali Acc: 0.443 Test Loss: 4.595 Test Acc: 0.443
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 9.476212739944458
Epoch: 10, Steps: 32 | Train Loss: 0.170 Vali Loss: 5.925 Vali Acc: 0.481 Test Loss: 5.925 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 9.775201320648193
Epoch: 11, Steps: 32 | Train Loss: 0.545 Vali Loss: 10.055 Vali Acc: 0.519 Test Loss: 10.055 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 9.690778493881226
Epoch: 12, Steps: 32 | Train Loss: 0.513 Vali Loss: 9.629 Vali Acc: 0.489 Test Loss: 9.629 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 10.077697038650513
Epoch: 13, Steps: 32 | Train Loss: 0.154 Vali Loss: 10.657 Vali Acc: 0.328 Test Loss: 10.657 Test Acc: 0.328
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 9.99139142036438
Epoch: 14, Steps: 32 | Train Loss: 0.158 Vali Loss: 7.785 Vali Acc: 0.382 Test Loss: 7.785 Test Acc: 0.382
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 892229
model size : 3.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 18.28510093688965
Epoch: 1, Steps: 32 | Train Loss: 1.936 Vali Loss: 1.794 Vali Acc: 0.504 Test Loss: 1.794 Test Acc: 0.504
Validation loss decreased (inf --> -0.503799).  Saving model ...
Epoch: 2 cost time: 17.227173328399658
Epoch: 2, Steps: 32 | Train Loss: 0.831 Vali Loss: 1.580 Vali Acc: 0.527 Test Loss: 1.580 Test Acc: 0.527
Validation loss decreased (-0.503799 --> -0.526702).  Saving model ...
Epoch: 3 cost time: 17.213826656341553
Epoch: 3, Steps: 32 | Train Loss: 0.254 Vali Loss: 1.890 Vali Acc: 0.542 Test Loss: 1.890 Test Acc: 0.542
Validation loss decreased (-0.526702 --> -0.541966).  Saving model ...
Epoch: 4 cost time: 17.11420512199402
Epoch: 4, Steps: 32 | Train Loss: 0.493 Vali Loss: 3.607 Vali Acc: 0.397 Test Loss: 3.607 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 16.84467887878418
Epoch: 5, Steps: 32 | Train Loss: 0.160 Vali Loss: 3.843 Vali Acc: 0.496 Test Loss: 3.843 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 16.290499925613403
Epoch: 6, Steps: 32 | Train Loss: 0.310 Vali Loss: 5.122 Vali Acc: 0.359 Test Loss: 5.122 Test Acc: 0.359
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 16.135387897491455
Epoch: 7, Steps: 32 | Train Loss: 0.170 Vali Loss: 4.410 Vali Acc: 0.382 Test Loss: 4.410 Test Acc: 0.382
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 16.399710416793823
Epoch: 8, Steps: 32 | Train Loss: 0.137 Vali Loss: 7.673 Vali Acc: 0.252 Test Loss: 7.673 Test Acc: 0.252
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 15.683902502059937
Epoch: 9, Steps: 32 | Train Loss: 0.045 Vali Loss: 8.301 Vali Acc: 0.366 Test Loss: 8.301 Test Acc: 0.366
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 15.743083715438843
Epoch: 10, Steps: 32 | Train Loss: 0.158 Vali Loss: 9.645 Vali Acc: 0.282 Test Loss: 9.645 Test Acc: 0.282
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 15.783953189849854
Epoch: 11, Steps: 32 | Train Loss: 0.136 Vali Loss: 7.261 Vali Acc: 0.557 Test Loss: 7.261 Test Acc: 0.557
Validation loss decreased (-0.541966 --> -0.557179).  Saving model ...
Epoch: 12 cost time: 15.974205255508423
Epoch: 12, Steps: 32 | Train Loss: 0.041 Vali Loss: 7.538 Vali Acc: 0.450 Test Loss: 7.538 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 15.41123342514038
Epoch: 13, Steps: 32 | Train Loss: 0.353 Vali Loss: 15.723 Vali Acc: 0.267 Test Loss: 15.723 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 16.109567880630493
Epoch: 14, Steps: 32 | Train Loss: 0.664 Vali Loss: 8.928 Vali Acc: 0.412 Test Loss: 8.928 Test Acc: 0.412
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 15.563366413116455
Epoch: 15, Steps: 32 | Train Loss: 0.135 Vali Loss: 8.991 Vali Acc: 0.405 Test Loss: 8.991 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 15.0028235912323
Epoch: 16, Steps: 32 | Train Loss: 0.391 Vali Loss: 13.489 Vali Acc: 0.519 Test Loss: 13.489 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 15.510212421417236
Epoch: 17, Steps: 32 | Train Loss: 0.248 Vali Loss: 11.708 Vali Acc: 0.458 Test Loss: 11.708 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 16.167987823486328
Epoch: 18, Steps: 32 | Train Loss: 0.177 Vali Loss: 13.447 Vali Acc: 0.351 Test Loss: 13.447 Test Acc: 0.351
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 15.261703252792358
Epoch: 19, Steps: 32 | Train Loss: 0.724 Vali Loss: 12.159 Vali Acc: 0.405 Test Loss: 12.159 Test Acc: 0.405
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 15.798913717269897
Epoch: 20, Steps: 32 | Train Loss: 0.411 Vali Loss: 13.616 Vali Acc: 0.534 Test Loss: 13.616 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 16.113450527191162
Epoch: 21, Steps: 32 | Train Loss: 0.354 Vali Loss: 14.047 Vali Acc: 0.427 Test Loss: 14.047 Test Acc: 0.427
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 1306245
model size : 5.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 9.43867301940918
Epoch: 1, Steps: 32 | Train Loss: 2.230 Vali Loss: 1.422 Vali Acc: 0.496 Test Loss: 1.422 Test Acc: 0.496
Validation loss decreased (inf --> -0.496169).  Saving model ...
Epoch: 2 cost time: 7.635518789291382
Epoch: 2, Steps: 32 | Train Loss: 0.944 Vali Loss: 2.300 Vali Acc: 0.519 Test Loss: 2.300 Test Acc: 0.519
Validation loss decreased (-0.496169 --> -0.519061).  Saving model ...
Epoch: 3 cost time: 7.44243597984314
Epoch: 3, Steps: 32 | Train Loss: 0.604 Vali Loss: 2.451 Vali Acc: 0.557 Test Loss: 2.451 Test Acc: 0.557
Validation loss decreased (-0.519061 --> -0.557227).  Saving model ...
Epoch: 4 cost time: 7.582880973815918
Epoch: 4, Steps: 32 | Train Loss: 0.339 Vali Loss: 4.924 Vali Acc: 0.504 Test Loss: 4.924 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.578356981277466
Epoch: 5, Steps: 32 | Train Loss: 0.264 Vali Loss: 8.075 Vali Acc: 0.443 Test Loss: 8.075 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.368134498596191
Epoch: 6, Steps: 32 | Train Loss: 0.050 Vali Loss: 5.315 Vali Acc: 0.588 Test Loss: 5.315 Test Acc: 0.588
Validation loss decreased (-0.557227 --> -0.587733).  Saving model ...
Epoch: 7 cost time: 6.933495998382568
Epoch: 7, Steps: 32 | Train Loss: 0.433 Vali Loss: 6.556 Vali Acc: 0.290 Test Loss: 6.556 Test Acc: 0.290
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.8083226680755615
Epoch: 8, Steps: 32 | Train Loss: 0.243 Vali Loss: 6.199 Vali Acc: 0.496 Test Loss: 6.199 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.458383798599243
Epoch: 9, Steps: 32 | Train Loss: 0.126 Vali Loss: 6.320 Vali Acc: 0.427 Test Loss: 6.320 Test Acc: 0.427
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.303454875946045
Epoch: 10, Steps: 32 | Train Loss: 0.028 Vali Loss: 6.430 Vali Acc: 0.489 Test Loss: 6.430 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.369778156280518
Epoch: 11, Steps: 32 | Train Loss: 0.022 Vali Loss: 8.129 Vali Acc: 0.519 Test Loss: 8.129 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 6.426180124282837
Epoch: 12, Steps: 32 | Train Loss: 0.070 Vali Loss: 11.315 Vali Acc: 0.527 Test Loss: 11.315 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 6.538522958755493
Epoch: 13, Steps: 32 | Train Loss: 0.054 Vali Loss: 8.812 Vali Acc: 0.527 Test Loss: 8.812 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 6.531357288360596
Epoch: 14, Steps: 32 | Train Loss: 0.001 Vali Loss: 6.988 Vali Acc: 0.458 Test Loss: 6.988 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 7.010399580001831
Epoch: 15, Steps: 32 | Train Loss: 0.376 Vali Loss: 9.542 Vali Acc: 0.534 Test Loss: 9.542 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 7.522913455963135
Epoch: 16, Steps: 32 | Train Loss: 0.204 Vali Loss: 10.258 Vali Acc: 0.550 Test Loss: 10.258 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 892229
model size : 3.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 11.89709186553955
Epoch: 1, Steps: 32 | Train Loss: 1.937 Vali Loss: 1.804 Vali Acc: 0.504 Test Loss: 1.804 Test Acc: 0.504
Validation loss decreased (inf --> -0.503799).  Saving model ...
Epoch: 2 cost time: 10.780457973480225
Epoch: 2, Steps: 32 | Train Loss: 0.823 Vali Loss: 1.749 Vali Acc: 0.542 Test Loss: 1.749 Test Acc: 0.542
Validation loss decreased (-0.503799 --> -0.541967).  Saving model ...
Epoch: 3 cost time: 10.921461343765259
Epoch: 3, Steps: 32 | Train Loss: 0.291 Vali Loss: 2.864 Vali Acc: 0.382 Test Loss: 2.864 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 10.968356370925903
Epoch: 4, Steps: 32 | Train Loss: 0.624 Vali Loss: 3.939 Vali Acc: 0.397 Test Loss: 3.939 Test Acc: 0.397
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 10.71068263053894
Epoch: 5, Steps: 32 | Train Loss: 0.516 Vali Loss: 4.949 Vali Acc: 0.397 Test Loss: 4.949 Test Acc: 0.397
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 10.591966390609741
Epoch: 6, Steps: 32 | Train Loss: 0.419 Vali Loss: 5.144 Vali Acc: 0.351 Test Loss: 5.144 Test Acc: 0.351
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 10.145328283309937
Epoch: 7, Steps: 32 | Train Loss: 0.001 Vali Loss: 5.453 Vali Acc: 0.504 Test Loss: 5.453 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 10.106231212615967
Epoch: 8, Steps: 32 | Train Loss: 0.394 Vali Loss: 4.294 Vali Acc: 0.489 Test Loss: 4.294 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 9.696494817733765
Epoch: 9, Steps: 32 | Train Loss: 0.690 Vali Loss: 7.224 Vali Acc: 0.504 Test Loss: 7.224 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 10.087663650512695
Epoch: 10, Steps: 32 | Train Loss: 0.181 Vali Loss: 7.922 Vali Acc: 0.405 Test Loss: 7.922 Test Acc: 0.405
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 10.437815189361572
Epoch: 11, Steps: 32 | Train Loss: 0.352 Vali Loss: 8.228 Vali Acc: 0.420 Test Loss: 8.228 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 10.290618419647217
Epoch: 12, Steps: 32 | Train Loss: 0.138 Vali Loss: 9.187 Vali Acc: 0.336 Test Loss: 9.187 Test Acc: 0.336
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 1306245
model size : 5.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 6.265135288238525
Epoch: 1, Steps: 32 | Train Loss: 2.222 Vali Loss: 1.417 Vali Acc: 0.496 Test Loss: 1.417 Test Acc: 0.496
Validation loss decreased (inf --> -0.496169).  Saving model ...
Epoch: 2 cost time: 4.9168477058410645
Epoch: 2, Steps: 32 | Train Loss: 0.900 Vali Loss: 2.797 Vali Acc: 0.504 Test Loss: 2.797 Test Acc: 0.504
Validation loss decreased (-0.496169 --> -0.503789).  Saving model ...
Epoch: 3 cost time: 4.393402338027954
Epoch: 3, Steps: 32 | Train Loss: 0.572 Vali Loss: 2.148 Vali Acc: 0.458 Test Loss: 2.148 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.225239038467407
Epoch: 4, Steps: 32 | Train Loss: 0.174 Vali Loss: 3.903 Vali Acc: 0.550 Test Loss: 3.903 Test Acc: 0.550
Validation loss decreased (-0.503789 --> -0.549579).  Saving model ...
Epoch: 5 cost time: 4.12659764289856
Epoch: 5, Steps: 32 | Train Loss: 0.279 Vali Loss: 7.956 Vali Acc: 0.336 Test Loss: 7.956 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.110593557357788
Epoch: 6, Steps: 32 | Train Loss: 0.322 Vali Loss: 6.616 Vali Acc: 0.374 Test Loss: 6.616 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.115538835525513
Epoch: 7, Steps: 32 | Train Loss: 0.367 Vali Loss: 5.629 Vali Acc: 0.420 Test Loss: 5.629 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.095116853713989
Epoch: 8, Steps: 32 | Train Loss: 0.160 Vali Loss: 7.251 Vali Acc: 0.366 Test Loss: 7.251 Test Acc: 0.366
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.061689138412476
Epoch: 9, Steps: 32 | Train Loss: 0.012 Vali Loss: 7.236 Vali Acc: 0.504 Test Loss: 7.236 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.9895949363708496
Epoch: 10, Steps: 32 | Train Loss: 0.070 Vali Loss: 10.077 Vali Acc: 0.519 Test Loss: 10.077 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.027925729751587
Epoch: 11, Steps: 32 | Train Loss: 0.012 Vali Loss: 9.683 Vali Acc: 0.519 Test Loss: 9.683 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.083314657211304
Epoch: 12, Steps: 32 | Train Loss: 0.046 Vali Loss: 8.657 Vali Acc: 0.313 Test Loss: 8.657 Test Acc: 0.313
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.023108243942261
Epoch: 13, Steps: 32 | Train Loss: 0.037 Vali Loss: 7.815 Vali Acc: 0.519 Test Loss: 7.815 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.129700422286987
Epoch: 14, Steps: 32 | Train Loss: 0.573 Vali Loss: 10.116 Vali Acc: 0.366 Test Loss: 10.116 Test Acc: 0.366
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 892229
model size : 3.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 17.65497136116028
Epoch: 1, Steps: 32 | Train Loss: 2.062 Vali Loss: 1.317 Vali Acc: 0.519 Test Loss: 1.317 Test Acc: 0.519
Validation loss decreased (inf --> -0.519071).  Saving model ...
Epoch: 2 cost time: 16.641786813735962
Epoch: 2, Steps: 32 | Train Loss: 0.947 Vali Loss: 2.344 Vali Acc: 0.405 Test Loss: 2.344 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 16.32565474510193
Epoch: 3, Steps: 32 | Train Loss: 0.593 Vali Loss: 2.904 Vali Acc: 0.519 Test Loss: 2.904 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 16.45001530647278
Epoch: 4, Steps: 32 | Train Loss: 0.221 Vali Loss: 3.889 Vali Acc: 0.473 Test Loss: 3.889 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 16.09815526008606
Epoch: 5, Steps: 32 | Train Loss: 0.133 Vali Loss: 3.749 Vali Acc: 0.458 Test Loss: 3.749 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 16.087864637374878
Epoch: 6, Steps: 32 | Train Loss: 0.001 Vali Loss: 4.697 Vali Acc: 0.412 Test Loss: 4.697 Test Acc: 0.412
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 16.112037897109985
Epoch: 7, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.973 Vali Acc: 0.519 Test Loss: 3.973 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 16.248279094696045
Epoch: 8, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.929 Vali Acc: 0.511 Test Loss: 3.929 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 16.24286389350891
Epoch: 9, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.884 Vali Acc: 0.519 Test Loss: 3.884 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 15.99451994895935
Epoch: 10, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.858 Vali Acc: 0.527 Test Loss: 3.858 Test Acc: 0.527
Validation loss decreased (-0.519071 --> -0.526679).  Saving model ...
Epoch: 11 cost time: 16.49907088279724
Epoch: 11, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.844 Vali Acc: 0.534 Test Loss: 3.844 Test Acc: 0.534
Validation loss decreased (-0.526679 --> -0.534313).  Saving model ...
Epoch: 12 cost time: 16.273350954055786
Epoch: 12, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.831 Vali Acc: 0.527 Test Loss: 3.831 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 16.26893448829651
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.834 Vali Acc: 0.527 Test Loss: 3.834 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 16.071993112564087
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.830 Vali Acc: 0.534 Test Loss: 3.830 Test Acc: 0.534
Validation loss decreased (-0.534313 --> -0.534313).  Saving model ...
Epoch: 15 cost time: 16.054980039596558
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.832 Vali Acc: 0.534 Test Loss: 3.832 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 16.24065589904785
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.849 Vali Acc: 0.527 Test Loss: 3.849 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 15.84384560585022
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.854 Vali Acc: 0.527 Test Loss: 3.854 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 16.447815895080566
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.870 Vali Acc: 0.534 Test Loss: 3.870 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 16.14244771003723
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.872 Vali Acc: 0.519 Test Loss: 3.872 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 16.383126735687256
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.875 Vali Acc: 0.519 Test Loss: 3.875 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 15.980432748794556
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.875 Vali Acc: 0.519 Test Loss: 3.875 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 15.886909008026123
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.854 Vali Acc: 0.519 Test Loss: 3.854 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 16.25989007949829
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.853 Vali Acc: 0.519 Test Loss: 3.853 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 15.940846920013428
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.859 Vali Acc: 0.519 Test Loss: 3.859 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 1012997
model size : 4.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 8.40208101272583
Epoch: 1, Steps: 32 | Train Loss: 1.831 Vali Loss: 1.431 Vali Acc: 0.504 Test Loss: 1.431 Test Acc: 0.504
Validation loss decreased (inf --> -0.503802).  Saving model ...
Epoch: 2 cost time: 6.8496527671813965
Epoch: 2, Steps: 32 | Train Loss: 0.882 Vali Loss: 5.479 Vali Acc: 0.122 Test Loss: 5.479 Test Acc: 0.122
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.832441329956055
Epoch: 3, Steps: 32 | Train Loss: 0.590 Vali Loss: 5.209 Vali Acc: 0.206 Test Loss: 5.209 Test Acc: 0.206
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.77007794380188
Epoch: 4, Steps: 32 | Train Loss: 0.421 Vali Loss: 6.288 Vali Acc: 0.229 Test Loss: 6.288 Test Acc: 0.229
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.9588305950164795
Epoch: 5, Steps: 32 | Train Loss: 0.467 Vali Loss: 5.418 Vali Acc: 0.305 Test Loss: 5.418 Test Acc: 0.305
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.8738696575164795
Epoch: 6, Steps: 32 | Train Loss: 0.204 Vali Loss: 4.544 Vali Acc: 0.443 Test Loss: 4.544 Test Acc: 0.443
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.859245538711548
Epoch: 7, Steps: 32 | Train Loss: 0.241 Vali Loss: 5.547 Vali Acc: 0.351 Test Loss: 5.547 Test Acc: 0.351
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 6.834517002105713
Epoch: 8, Steps: 32 | Train Loss: 0.166 Vali Loss: 6.136 Vali Acc: 0.389 Test Loss: 6.136 Test Acc: 0.389
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.9894092082977295
Epoch: 9, Steps: 32 | Train Loss: 0.149 Vali Loss: 8.445 Vali Acc: 0.290 Test Loss: 8.445 Test Acc: 0.290
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 7.108376741409302
Epoch: 10, Steps: 32 | Train Loss: 0.129 Vali Loss: 8.025 Vali Acc: 0.511 Test Loss: 8.025 Test Acc: 0.511
Validation loss decreased (-0.503802 --> -0.511370).  Saving model ...
Epoch: 11 cost time: 6.782177448272705
Epoch: 11, Steps: 32 | Train Loss: 0.248 Vali Loss: 8.246 Vali Acc: 0.450 Test Loss: 8.246 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.041799545288086
Epoch: 12, Steps: 32 | Train Loss: 0.156 Vali Loss: 9.178 Vali Acc: 0.527 Test Loss: 9.178 Test Acc: 0.527
Validation loss decreased (-0.511370 --> -0.526626).  Saving model ...
Epoch: 13 cost time: 7.084100961685181
Epoch: 13, Steps: 32 | Train Loss: 0.105 Vali Loss: 8.474 Vali Acc: 0.481 Test Loss: 8.474 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 7.239836692810059
Epoch: 14, Steps: 32 | Train Loss: 0.104 Vali Loss: 11.287 Vali Acc: 0.305 Test Loss: 11.287 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 7.07244610786438
Epoch: 15, Steps: 32 | Train Loss: 0.124 Vali Loss: 8.243 Vali Acc: 0.420 Test Loss: 8.243 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 7.181429862976074
Epoch: 16, Steps: 32 | Train Loss: 0.013 Vali Loss: 8.471 Vali Acc: 0.481 Test Loss: 8.471 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 7.010352849960327
Epoch: 17, Steps: 32 | Train Loss: 0.054 Vali Loss: 18.993 Vali Acc: 0.260 Test Loss: 18.993 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 6.964622735977173
Epoch: 18, Steps: 32 | Train Loss: 0.144 Vali Loss: 14.461 Vali Acc: 0.359 Test Loss: 14.461 Test Acc: 0.359
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 7.0495452880859375
Epoch: 19, Steps: 32 | Train Loss: 0.014 Vali Loss: 16.716 Vali Acc: 0.282 Test Loss: 16.716 Test Acc: 0.282
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 6.843124866485596
Epoch: 20, Steps: 32 | Train Loss: 0.133 Vali Loss: 15.481 Vali Acc: 0.298 Test Loss: 15.481 Test Acc: 0.298
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 6.788466691970825
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 15.162 Vali Acc: 0.359 Test Loss: 15.162 Test Acc: 0.359
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 6.840428829193115
Epoch: 22, Steps: 32 | Train Loss: 0.120 Vali Loss: 16.324 Vali Acc: 0.374 Test Loss: 16.324 Test Acc: 0.374
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 805957
model size : 3.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 12.456192970275879
Epoch: 1, Steps: 32 | Train Loss: 2.061 Vali Loss: 1.270 Vali Acc: 0.519 Test Loss: 1.270 Test Acc: 0.519
Validation loss decreased (inf --> -0.519071).  Saving model ...
Epoch: 2 cost time: 11.337337732315063
Epoch: 2, Steps: 32 | Train Loss: 0.884 Vali Loss: 2.426 Vali Acc: 0.443 Test Loss: 2.426 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.834869623184204
Epoch: 3, Steps: 32 | Train Loss: 0.376 Vali Loss: 2.435 Vali Acc: 0.534 Test Loss: 2.435 Test Acc: 0.534
Validation loss decreased (-0.519071 --> -0.534327).  Saving model ...
Epoch: 4 cost time: 11.0377938747406
Epoch: 4, Steps: 32 | Train Loss: 0.370 Vali Loss: 3.888 Vali Acc: 0.496 Test Loss: 3.888 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.74281644821167
Epoch: 5, Steps: 32 | Train Loss: 0.187 Vali Loss: 6.275 Vali Acc: 0.290 Test Loss: 6.275 Test Acc: 0.290
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 10.724918603897095
Epoch: 6, Steps: 32 | Train Loss: 0.088 Vali Loss: 3.926 Vali Acc: 0.595 Test Loss: 3.926 Test Acc: 0.595
Validation loss decreased (-0.534327 --> -0.595381).  Saving model ...
Epoch: 7 cost time: 10.753073692321777
Epoch: 7, Steps: 32 | Train Loss: 0.083 Vali Loss: 3.356 Vali Acc: 0.511 Test Loss: 3.356 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 10.805875062942505
Epoch: 8, Steps: 32 | Train Loss: 0.009 Vali Loss: 4.622 Vali Acc: 0.496 Test Loss: 4.622 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 10.768598556518555
Epoch: 9, Steps: 32 | Train Loss: 0.102 Vali Loss: 5.330 Vali Acc: 0.473 Test Loss: 5.330 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 11.171521663665771
Epoch: 10, Steps: 32 | Train Loss: 0.415 Vali Loss: 6.331 Vali Acc: 0.481 Test Loss: 6.331 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 11.068940162658691
Epoch: 11, Steps: 32 | Train Loss: 0.022 Vali Loss: 6.536 Vali Acc: 0.489 Test Loss: 6.536 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 11.072160482406616
Epoch: 12, Steps: 32 | Train Loss: 0.175 Vali Loss: 9.450 Vali Acc: 0.443 Test Loss: 9.450 Test Acc: 0.443
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 10.96450662612915
Epoch: 13, Steps: 32 | Train Loss: 0.539 Vali Loss: 15.661 Vali Acc: 0.229 Test Loss: 15.661 Test Acc: 0.229
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 11.50234055519104
Epoch: 14, Steps: 32 | Train Loss: 0.455 Vali Loss: 8.194 Vali Acc: 0.435 Test Loss: 8.194 Test Acc: 0.435
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 11.347239017486572
Epoch: 15, Steps: 32 | Train Loss: 0.933 Vali Loss: 13.799 Vali Acc: 0.473 Test Loss: 13.799 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 11.345561742782593
Epoch: 16, Steps: 32 | Train Loss: 0.449 Vali Loss: 17.092 Vali Acc: 0.305 Test Loss: 17.092 Test Acc: 0.305
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5954198473282443
model parameter : 1012997
model size : 4.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 7.0809407234191895
Epoch: 1, Steps: 32 | Train Loss: 1.831 Vali Loss: 1.429 Vali Acc: 0.504 Test Loss: 1.429 Test Acc: 0.504
Validation loss decreased (inf --> -0.503802).  Saving model ...
Epoch: 2 cost time: 5.473511219024658
Epoch: 2, Steps: 32 | Train Loss: 0.871 Vali Loss: 5.360 Vali Acc: 0.130 Test Loss: 5.360 Test Acc: 0.130
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.253979921340942
Epoch: 3, Steps: 32 | Train Loss: 0.573 Vali Loss: 4.360 Vali Acc: 0.267 Test Loss: 4.360 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.515988826751709
Epoch: 4, Steps: 32 | Train Loss: 0.231 Vali Loss: 6.102 Vali Acc: 0.275 Test Loss: 6.102 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.226149320602417
Epoch: 5, Steps: 32 | Train Loss: 0.421 Vali Loss: 5.794 Vali Acc: 0.313 Test Loss: 5.794 Test Acc: 0.313
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.465910911560059
Epoch: 6, Steps: 32 | Train Loss: 0.383 Vali Loss: 5.535 Vali Acc: 0.412 Test Loss: 5.535 Test Acc: 0.412
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.35253381729126
Epoch: 7, Steps: 32 | Train Loss: 0.206 Vali Loss: 4.119 Vali Acc: 0.557 Test Loss: 4.119 Test Acc: 0.557
Validation loss decreased (-0.503802 --> -0.557211).  Saving model ...
Epoch: 8 cost time: 5.2396204471588135
Epoch: 8, Steps: 32 | Train Loss: 0.166 Vali Loss: 4.274 Vali Acc: 0.504 Test Loss: 4.274 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.474486827850342
Epoch: 9, Steps: 32 | Train Loss: 0.347 Vali Loss: 6.252 Vali Acc: 0.550 Test Loss: 6.252 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.6890106201171875
Epoch: 10, Steps: 32 | Train Loss: 0.149 Vali Loss: 6.909 Vali Acc: 0.527 Test Loss: 6.909 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.543745040893555
Epoch: 11, Steps: 32 | Train Loss: 0.322 Vali Loss: 11.475 Vali Acc: 0.313 Test Loss: 11.475 Test Acc: 0.313
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.64832878112793
Epoch: 12, Steps: 32 | Train Loss: 0.213 Vali Loss: 15.743 Vali Acc: 0.282 Test Loss: 15.743 Test Acc: 0.282
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.755958795547485
Epoch: 13, Steps: 32 | Train Loss: 0.255 Vali Loss: 8.776 Vali Acc: 0.427 Test Loss: 8.776 Test Acc: 0.427
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.720465421676636
Epoch: 14, Steps: 32 | Train Loss: 0.095 Vali Loss: 13.093 Vali Acc: 0.328 Test Loss: 13.093 Test Acc: 0.328
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.8706769943237305
Epoch: 15, Steps: 32 | Train Loss: 0.031 Vali Loss: 12.855 Vali Acc: 0.351 Test Loss: 12.855 Test Acc: 0.351
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.838587760925293
Epoch: 16, Steps: 32 | Train Loss: 0.275 Vali Loss: 11.955 Vali Acc: 0.389 Test Loss: 11.955 Test Acc: 0.389
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.74644923210144
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 13.691 Vali Acc: 0.305 Test Loss: 13.691 Test Acc: 0.305
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 805957
model size : 3.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 8.408740043640137
Epoch: 1, Steps: 32 | Train Loss: 2.069 Vali Loss: 1.315 Vali Acc: 0.504 Test Loss: 1.315 Test Acc: 0.504
Validation loss decreased (inf --> -0.503804).  Saving model ...
Epoch: 2 cost time: 6.6613593101501465
Epoch: 2, Steps: 32 | Train Loss: 0.959 Vali Loss: 1.908 Vali Acc: 0.504 Test Loss: 1.908 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.997481346130371
Epoch: 3, Steps: 32 | Train Loss: 0.480 Vali Loss: 3.458 Vali Acc: 0.527 Test Loss: 3.458 Test Acc: 0.527
Validation loss decreased (-0.503804 --> -0.526683).  Saving model ...
Epoch: 4 cost time: 7.118737697601318
Epoch: 4, Steps: 32 | Train Loss: 0.171 Vali Loss: 3.385 Vali Acc: 0.496 Test Loss: 3.385 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.209000110626221
Epoch: 5, Steps: 32 | Train Loss: 0.161 Vali Loss: 3.781 Vali Acc: 0.489 Test Loss: 3.781 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.180823564529419
Epoch: 6, Steps: 32 | Train Loss: 0.262 Vali Loss: 4.802 Vali Acc: 0.504 Test Loss: 4.802 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 7.1205973625183105
Epoch: 7, Steps: 32 | Train Loss: 0.243 Vali Loss: 5.513 Vali Acc: 0.359 Test Loss: 5.513 Test Acc: 0.359
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 6.74348258972168
Epoch: 8, Steps: 32 | Train Loss: 0.674 Vali Loss: 6.205 Vali Acc: 0.466 Test Loss: 6.205 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 6.986311674118042
Epoch: 9, Steps: 32 | Train Loss: 0.159 Vali Loss: 7.546 Vali Acc: 0.351 Test Loss: 7.546 Test Acc: 0.351
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 6.833212852478027
Epoch: 10, Steps: 32 | Train Loss: 0.148 Vali Loss: 8.221 Vali Acc: 0.382 Test Loss: 8.221 Test Acc: 0.382
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 7.048722505569458
Epoch: 11, Steps: 32 | Train Loss: 0.242 Vali Loss: 9.354 Vali Acc: 0.511 Test Loss: 9.354 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 6.789132595062256
Epoch: 12, Steps: 32 | Train Loss: 0.164 Vali Loss: 10.944 Vali Acc: 0.336 Test Loss: 10.944 Test Acc: 0.336
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 6.988040924072266
Epoch: 13, Steps: 32 | Train Loss: 0.087 Vali Loss: 10.371 Vali Acc: 0.374 Test Loss: 10.371 Test Acc: 0.374
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 1012997
model size : 4.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.483060359954834
Epoch: 1, Steps: 32 | Train Loss: 1.828 Vali Loss: 1.450 Vali Acc: 0.534 Test Loss: 1.450 Test Acc: 0.534
Validation loss decreased (inf --> -0.534337).  Saving model ...
Epoch: 2 cost time: 3.754215955734253
Epoch: 2, Steps: 32 | Train Loss: 0.897 Vali Loss: 5.460 Vali Acc: 0.183 Test Loss: 5.460 Test Acc: 0.183
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.990176200866699
Epoch: 3, Steps: 32 | Train Loss: 0.854 Vali Loss: 3.836 Vali Acc: 0.534 Test Loss: 3.836 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.73348331451416
Epoch: 4, Steps: 32 | Train Loss: 1.239 Vali Loss: 3.649 Vali Acc: 0.534 Test Loss: 3.649 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.909978151321411
Epoch: 5, Steps: 32 | Train Loss: 0.286 Vali Loss: 4.541 Vali Acc: 0.328 Test Loss: 4.541 Test Acc: 0.328
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.152024745941162
Epoch: 6, Steps: 32 | Train Loss: 0.208 Vali Loss: 6.275 Vali Acc: 0.351 Test Loss: 6.275 Test Acc: 0.351
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.8695802688598633
Epoch: 7, Steps: 32 | Train Loss: 0.133 Vali Loss: 5.482 Vali Acc: 0.466 Test Loss: 5.482 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.8176662921905518
Epoch: 8, Steps: 32 | Train Loss: 0.060 Vali Loss: 5.702 Vali Acc: 0.504 Test Loss: 5.702 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.784914016723633
Epoch: 9, Steps: 32 | Train Loss: 0.025 Vali Loss: 5.931 Vali Acc: 0.389 Test Loss: 5.931 Test Acc: 0.389
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.7868826389312744
Epoch: 10, Steps: 32 | Train Loss: 0.087 Vali Loss: 7.141 Vali Acc: 0.542 Test Loss: 7.141 Test Acc: 0.542
Validation loss decreased (-0.534337 --> -0.541913).  Saving model ...
Epoch: 11 cost time: 3.626479387283325
Epoch: 11, Steps: 32 | Train Loss: 0.559 Vali Loss: 10.258 Vali Acc: 0.282 Test Loss: 10.258 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.435533285140991
Epoch: 12, Steps: 32 | Train Loss: 0.248 Vali Loss: 10.217 Vali Acc: 0.374 Test Loss: 10.217 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.8170993328094482
Epoch: 13, Steps: 32 | Train Loss: 0.376 Vali Loss: 12.028 Vali Acc: 0.382 Test Loss: 12.028 Test Acc: 0.382
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.1855618953704834
Epoch: 14, Steps: 32 | Train Loss: 0.448 Vali Loss: 16.944 Vali Acc: 0.221 Test Loss: 16.944 Test Acc: 0.221
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.096735954284668
Epoch: 15, Steps: 32 | Train Loss: 0.119 Vali Loss: 15.350 Vali Acc: 0.359 Test Loss: 15.350 Test Acc: 0.359
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.135951519012451
Epoch: 16, Steps: 32 | Train Loss: 0.306 Vali Loss: 14.113 Vali Acc: 0.458 Test Loss: 14.113 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.0792129039764404
Epoch: 17, Steps: 32 | Train Loss: 0.034 Vali Loss: 15.061 Vali Acc: 0.305 Test Loss: 15.061 Test Acc: 0.305
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.151160717010498
Epoch: 18, Steps: 32 | Train Loss: 0.258 Vali Loss: 17.487 Vali Acc: 0.252 Test Loss: 17.487 Test Acc: 0.252
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.28562331199646
Epoch: 19, Steps: 32 | Train Loss: 0.696 Vali Loss: 12.079 Vali Acc: 0.366 Test Loss: 12.079 Test Acc: 0.366
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.149026393890381
Epoch: 20, Steps: 32 | Train Loss: 0.205 Vali Loss: 14.779 Vali Acc: 0.466 Test Loss: 14.779 Test Acc: 0.466
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el4_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 805957
model size : 3.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 497.2892208099365
Epoch: 1, Steps: 32 | Train Loss: 10.172 Vali Loss: 11.402 Vali Acc: 0.527 Test Loss: 11.402 Test Acc: 0.527
Validation loss decreased (inf --> -0.526604).  Saving model ...
Epoch: 2 cost time: 495.77381682395935
Epoch: 2, Steps: 32 | Train Loss: 10.369 Vali Loss: 28.339 Vali Acc: 0.252 Test Loss: 28.339 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 491.65753054618835
Epoch: 3, Steps: 32 | Train Loss: 13.362 Vali Loss: 34.624 Vali Acc: 0.496 Test Loss: 34.624 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 494.0058469772339
Epoch: 4, Steps: 32 | Train Loss: 21.773 Vali Loss: 86.469 Vali Acc: 0.450 Test Loss: 86.469 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 492.41214418411255
Epoch: 5, Steps: 32 | Train Loss: 17.786 Vali Loss: 79.604 Vali Acc: 0.504 Test Loss: 79.604 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 490.3216631412506
Epoch: 6, Steps: 32 | Train Loss: 22.091 Vali Loss: 82.060 Vali Acc: 0.244 Test Loss: 82.060 Test Acc: 0.244
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 493.9637942314148
Epoch: 7, Steps: 32 | Train Loss: 10.559 Vali Loss: 71.991 Vali Acc: 0.374 Test Loss: 71.991 Test Acc: 0.374
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 487.5859372615814
Epoch: 8, Steps: 32 | Train Loss: 3.042 Vali Loss: 114.332 Vali Acc: 0.405 Test Loss: 114.332 Test Acc: 0.405
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 488.8088219165802
Epoch: 9, Steps: 32 | Train Loss: 3.281 Vali Loss: 77.587 Vali Acc: 0.458 Test Loss: 77.587 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 489.0625150203705
Epoch: 10, Steps: 32 | Train Loss: 5.903 Vali Loss: 173.118 Vali Acc: 0.244 Test Loss: 173.118 Test Acc: 0.244
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 489.14592003822327
Epoch: 11, Steps: 32 | Train Loss: 10.983 Vali Loss: 116.156 Vali Acc: 0.473 Test Loss: 116.156 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 67749637
model size : 267.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 168.03329968452454
Epoch: 1, Steps: 32 | Train Loss: 12.308 Vali Loss: 22.641 Vali Acc: 0.504 Test Loss: 22.641 Test Acc: 0.504
Validation loss decreased (inf --> -0.503590).  Saving model ...
Epoch: 2 cost time: 167.15796279907227
Epoch: 2, Steps: 32 | Train Loss: 14.241 Vali Loss: 19.066 Vali Acc: 0.473 Test Loss: 19.066 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 165.82347631454468
Epoch: 3, Steps: 32 | Train Loss: 6.213 Vali Loss: 33.142 Vali Acc: 0.496 Test Loss: 33.142 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 165.44985270500183
Epoch: 4, Steps: 32 | Train Loss: 15.815 Vali Loss: 90.490 Vali Acc: 0.504 Test Loss: 90.490 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 164.9690763950348
Epoch: 5, Steps: 32 | Train Loss: 10.993 Vali Loss: 58.933 Vali Acc: 0.435 Test Loss: 58.933 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 164.86123943328857
Epoch: 6, Steps: 32 | Train Loss: 3.297 Vali Loss: 41.325 Vali Acc: 0.489 Test Loss: 41.325 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 164.36365127563477
Epoch: 7, Steps: 32 | Train Loss: 5.029 Vali Loss: 63.857 Vali Acc: 0.489 Test Loss: 63.857 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 163.64875555038452
Epoch: 8, Steps: 32 | Train Loss: 4.354 Vali Loss: 67.403 Vali Acc: 0.427 Test Loss: 67.403 Test Acc: 0.427
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 164.61899161338806
Epoch: 9, Steps: 32 | Train Loss: 11.360 Vali Loss: 131.443 Vali Acc: 0.260 Test Loss: 131.443 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 164.4025595188141
Epoch: 10, Steps: 32 | Train Loss: 27.141 Vali Loss: 196.758 Vali Acc: 0.275 Test Loss: 196.758 Test Acc: 0.275
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 166.13144826889038
Epoch: 11, Steps: 32 | Train Loss: 14.128 Vali Loss: 140.036 Vali Acc: 0.351 Test Loss: 140.036 Test Acc: 0.351
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5038167938931297
model parameter : 28032517
model size : 115.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 322.36279368400574
Epoch: 1, Steps: 32 | Train Loss: 11.300 Vali Loss: 12.645 Vali Acc: 0.282 Test Loss: 12.645 Test Acc: 0.282
Validation loss decreased (inf --> -0.282316).  Saving model ...
Epoch: 2 cost time: 324.51324701309204
Epoch: 2, Steps: 32 | Train Loss: 14.866 Vali Loss: 41.943 Vali Acc: 0.214 Test Loss: 41.943 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 324.83853459358215
Epoch: 3, Steps: 32 | Train Loss: 10.969 Vali Loss: 25.546 Vali Acc: 0.481 Test Loss: 25.546 Test Acc: 0.481
Validation loss decreased (-0.282316 --> -0.480661).  Saving model ...
Epoch: 4 cost time: 324.2304365634918
Epoch: 4, Steps: 32 | Train Loss: 13.042 Vali Loss: 54.903 Vali Acc: 0.359 Test Loss: 54.903 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 322.5681345462799
Epoch: 5, Steps: 32 | Train Loss: 7.067 Vali Loss: 61.344 Vali Acc: 0.382 Test Loss: 61.344 Test Acc: 0.382
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 322.34257650375366
Epoch: 6, Steps: 32 | Train Loss: 14.910 Vali Loss: 116.219 Vali Acc: 0.267 Test Loss: 116.219 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 320.0291600227356
Epoch: 7, Steps: 32 | Train Loss: 11.960 Vali Loss: 110.350 Vali Acc: 0.534 Test Loss: 110.350 Test Acc: 0.534
Validation loss decreased (-0.480661 --> -0.533248).  Saving model ...
Epoch: 8 cost time: 321.106454372406
Epoch: 8, Steps: 32 | Train Loss: 8.666 Vali Loss: 92.045 Vali Acc: 0.542 Test Loss: 92.045 Test Acc: 0.542
Validation loss decreased (-0.533248 --> -0.541064).  Saving model ...
Epoch: 9 cost time: 323.0382995605469
Epoch: 9, Steps: 32 | Train Loss: 4.134 Vali Loss: 77.233 Vali Acc: 0.420 Test Loss: 77.233 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 320.8053741455078
Epoch: 10, Steps: 32 | Train Loss: 8.258 Vali Loss: 132.276 Vali Acc: 0.275 Test Loss: 132.276 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 319.17364597320557
Epoch: 11, Steps: 32 | Train Loss: 14.590 Vali Loss: 92.533 Vali Acc: 0.427 Test Loss: 92.533 Test Acc: 0.427
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 319.23357343673706
Epoch: 12, Steps: 32 | Train Loss: 12.203 Vali Loss: 92.251 Vali Acc: 0.450 Test Loss: 92.251 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 320.23661518096924
Epoch: 13, Steps: 32 | Train Loss: 19.718 Vali Loss: 210.850 Vali Acc: 0.214 Test Loss: 210.850 Test Acc: 0.214
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 323.332391500473
Epoch: 14, Steps: 32 | Train Loss: 25.092 Vali Loss: 189.839 Vali Acc: 0.473 Test Loss: 189.839 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 324.2180645465851
Epoch: 15, Steps: 32 | Train Loss: 25.060 Vali Loss: 185.315 Vali Acc: 0.328 Test Loss: 185.315 Test Acc: 0.328
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 324.286536693573
Epoch: 16, Steps: 32 | Train Loss: 36.286 Vali Loss: 237.225 Vali Acc: 0.443 Test Loss: 237.225 Test Acc: 0.443
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 323.18459916114807
Epoch: 17, Steps: 32 | Train Loss: 16.802 Vali Loss: 286.436 Vali Acc: 0.519 Test Loss: 286.436 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 323.0482716560364
Epoch: 18, Steps: 32 | Train Loss: 6.273 Vali Loss: 229.811 Vali Acc: 0.534 Test Loss: 229.811 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 67749637
model size : 267.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 110.99811601638794
Epoch: 1, Steps: 32 | Train Loss: 11.291 Vali Loss: 32.568 Vali Acc: 0.473 Test Loss: 32.568 Test Acc: 0.473
Validation loss decreased (inf --> -0.472957).  Saving model ...
Epoch: 2 cost time: 108.46664929389954
Epoch: 2, Steps: 32 | Train Loss: 12.561 Vali Loss: 44.624 Vali Acc: 0.183 Test Loss: 44.624 Test Acc: 0.183
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 108.08728075027466
Epoch: 3, Steps: 32 | Train Loss: 7.979 Vali Loss: 25.888 Vali Acc: 0.473 Test Loss: 25.888 Test Acc: 0.473
Validation loss decreased (-0.472957 --> -0.473024).  Saving model ...
Epoch: 4 cost time: 108.28891611099243
Epoch: 4, Steps: 32 | Train Loss: 11.996 Vali Loss: 91.136 Vali Acc: 0.481 Test Loss: 91.136 Test Acc: 0.481
Validation loss decreased (-0.473024 --> -0.480005).  Saving model ...
Epoch: 5 cost time: 108.3324294090271
Epoch: 5, Steps: 32 | Train Loss: 9.183 Vali Loss: 91.768 Vali Acc: 0.511 Test Loss: 91.768 Test Acc: 0.511
Validation loss decreased (-0.480005 --> -0.510533).  Saving model ...
Epoch: 6 cost time: 107.76968002319336
Epoch: 6, Steps: 32 | Train Loss: 10.785 Vali Loss: 72.139 Vali Acc: 0.489 Test Loss: 72.139 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 108.14767646789551
Epoch: 7, Steps: 32 | Train Loss: 9.661 Vali Loss: 104.226 Vali Acc: 0.435 Test Loss: 104.226 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 108.85898661613464
Epoch: 8, Steps: 32 | Train Loss: 2.343 Vali Loss: 99.264 Vali Acc: 0.473 Test Loss: 99.264 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 108.82248401641846
Epoch: 9, Steps: 32 | Train Loss: 12.172 Vali Loss: 124.134 Vali Acc: 0.229 Test Loss: 124.134 Test Acc: 0.229
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 108.3208281993866
Epoch: 10, Steps: 32 | Train Loss: 9.344 Vali Loss: 78.011 Vali Acc: 0.374 Test Loss: 78.011 Test Acc: 0.374
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 107.94918298721313
Epoch: 11, Steps: 32 | Train Loss: 18.511 Vali Loss: 182.982 Vali Acc: 0.275 Test Loss: 182.982 Test Acc: 0.275
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 108.67665767669678
Epoch: 12, Steps: 32 | Train Loss: 14.861 Vali Loss: 157.295 Vali Acc: 0.496 Test Loss: 157.295 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 108.6798107624054
Epoch: 13, Steps: 32 | Train Loss: 6.445 Vali Loss: 135.614 Vali Acc: 0.565 Test Loss: 135.614 Test Acc: 0.565
Validation loss decreased (-0.510533 --> -0.563529).  Saving model ...
Epoch: 14 cost time: 108.76501250267029
Epoch: 14, Steps: 32 | Train Loss: 5.214 Vali Loss: 197.675 Vali Acc: 0.519 Test Loss: 197.675 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 108.45137429237366
Epoch: 15, Steps: 32 | Train Loss: 7.190 Vali Loss: 133.970 Vali Acc: 0.473 Test Loss: 133.970 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 109.18285894393921
Epoch: 16, Steps: 32 | Train Loss: 2.851 Vali Loss: 184.623 Vali Acc: 0.405 Test Loss: 184.623 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 108.65464758872986
Epoch: 17, Steps: 32 | Train Loss: 3.379 Vali Loss: 180.062 Vali Acc: 0.542 Test Loss: 180.062 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 109.30678749084473
Epoch: 18, Steps: 32 | Train Loss: 2.542 Vali Loss: 247.651 Vali Acc: 0.481 Test Loss: 247.651 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 108.87115025520325
Epoch: 19, Steps: 32 | Train Loss: 15.267 Vali Loss: 161.210 Vali Acc: 0.420 Test Loss: 161.210 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 109.7547881603241
Epoch: 20, Steps: 32 | Train Loss: 5.466 Vali Loss: 157.915 Vali Acc: 0.458 Test Loss: 157.915 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 109.99582123756409
Epoch: 21, Steps: 32 | Train Loss: 3.583 Vali Loss: 291.935 Vali Acc: 0.519 Test Loss: 291.935 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 109.44103741645813
Epoch: 22, Steps: 32 | Train Loss: 8.479 Vali Loss: 267.188 Vali Acc: 0.511 Test Loss: 267.188 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 110.11310005187988
Epoch: 23, Steps: 32 | Train Loss: 14.775 Vali Loss: 284.481 Vali Acc: 0.534 Test Loss: 284.481 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 28032517
model size : 115.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 189.67265367507935
Epoch: 1, Steps: 32 | Train Loss: 10.443 Vali Loss: 16.844 Vali Acc: 0.473 Test Loss: 16.844 Test Acc: 0.473
Validation loss decreased (inf --> -0.473114).  Saving model ...
Epoch: 2 cost time: 187.96197772026062
Epoch: 2, Steps: 32 | Train Loss: 14.611 Vali Loss: 41.867 Vali Acc: 0.237 Test Loss: 41.867 Test Acc: 0.237
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 187.27514696121216
Epoch: 3, Steps: 32 | Train Loss: 10.482 Vali Loss: 39.094 Vali Acc: 0.511 Test Loss: 39.094 Test Acc: 0.511
Validation loss decreased (-0.473114 --> -0.511059).  Saving model ...
Epoch: 4 cost time: 186.84299564361572
Epoch: 4, Steps: 32 | Train Loss: 13.168 Vali Loss: 57.004 Vali Acc: 0.511 Test Loss: 57.004 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 186.38361763954163
Epoch: 5, Steps: 32 | Train Loss: 13.032 Vali Loss: 56.317 Vali Acc: 0.374 Test Loss: 56.317 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 186.33014631271362
Epoch: 6, Steps: 32 | Train Loss: 16.595 Vali Loss: 93.689 Vali Acc: 0.214 Test Loss: 93.689 Test Acc: 0.214
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 185.84932255744934
Epoch: 7, Steps: 32 | Train Loss: 5.030 Vali Loss: 88.609 Vali Acc: 0.450 Test Loss: 88.609 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 185.89630365371704
Epoch: 8, Steps: 32 | Train Loss: 4.142 Vali Loss: 77.629 Vali Acc: 0.366 Test Loss: 77.629 Test Acc: 0.366
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 186.02377319335938
Epoch: 9, Steps: 32 | Train Loss: 7.346 Vali Loss: 140.249 Vali Acc: 0.267 Test Loss: 140.249 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 185.88512444496155
Epoch: 10, Steps: 32 | Train Loss: 11.872 Vali Loss: 83.887 Vali Acc: 0.519 Test Loss: 83.887 Test Acc: 0.519
Validation loss decreased (-0.511059 --> -0.518245).  Saving model ...
Epoch: 11 cost time: 185.425621509552
Epoch: 11, Steps: 32 | Train Loss: 16.764 Vali Loss: 108.816 Vali Acc: 0.542 Test Loss: 108.816 Test Acc: 0.542
Validation loss decreased (-0.518245 --> -0.540897).  Saving model ...
Epoch: 12 cost time: 185.47878503799438
Epoch: 12, Steps: 32 | Train Loss: 32.223 Vali Loss: 90.778 Vali Acc: 0.443 Test Loss: 90.778 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 185.1855115890503
Epoch: 13, Steps: 32 | Train Loss: 3.927 Vali Loss: 313.592 Vali Acc: 0.229 Test Loss: 313.592 Test Acc: 0.229
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 184.74496865272522
Epoch: 14, Steps: 32 | Train Loss: 24.751 Vali Loss: 180.447 Vali Acc: 0.328 Test Loss: 180.447 Test Acc: 0.328
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 185.49348521232605
Epoch: 15, Steps: 32 | Train Loss: 12.013 Vali Loss: 191.862 Vali Acc: 0.466 Test Loss: 191.862 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 184.64927792549133
Epoch: 16, Steps: 32 | Train Loss: 12.289 Vali Loss: 154.574 Vali Acc: 0.336 Test Loss: 154.574 Test Acc: 0.336
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 184.93197321891785
Epoch: 17, Steps: 32 | Train Loss: 32.602 Vali Loss: 286.423 Vali Acc: 0.244 Test Loss: 286.423 Test Acc: 0.244
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 179.9870822429657
Epoch: 18, Steps: 32 | Train Loss: 26.860 Vali Loss: 194.081 Vali Acc: 0.420 Test Loss: 194.081 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 181.5680112838745
Epoch: 19, Steps: 32 | Train Loss: 11.183 Vali Loss: 226.744 Vali Acc: 0.374 Test Loss: 226.744 Test Acc: 0.374
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 182.18384432792664
Epoch: 20, Steps: 32 | Train Loss: 13.264 Vali Loss: 277.480 Vali Acc: 0.359 Test Loss: 277.480 Test Acc: 0.359
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 183.23644256591797
Epoch: 21, Steps: 32 | Train Loss: 14.732 Vali Loss: 283.310 Vali Acc: 0.450 Test Loss: 283.310 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 67749637
model size : 267.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 59.97201180458069
Epoch: 1, Steps: 32 | Train Loss: 12.893 Vali Loss: 25.132 Vali Acc: 0.344 Test Loss: 25.132 Test Acc: 0.344
Validation loss decreased (inf --> -0.343260).  Saving model ...
Epoch: 2 cost time: 58.6027512550354
Epoch: 2, Steps: 32 | Train Loss: 22.459 Vali Loss: 47.889 Vali Acc: 0.534 Test Loss: 47.889 Test Acc: 0.534
Validation loss decreased (-0.343260 --> -0.533872).  Saving model ...
Epoch: 3 cost time: 58.324161529541016
Epoch: 3, Steps: 32 | Train Loss: 17.614 Vali Loss: 32.594 Vali Acc: 0.382 Test Loss: 32.594 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 58.14371132850647
Epoch: 4, Steps: 32 | Train Loss: 10.002 Vali Loss: 50.300 Vali Acc: 0.511 Test Loss: 50.300 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 58.048418283462524
Epoch: 5, Steps: 32 | Train Loss: 6.251 Vali Loss: 62.182 Vali Acc: 0.511 Test Loss: 62.182 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 58.09437918663025
Epoch: 6, Steps: 32 | Train Loss: 2.809 Vali Loss: 72.227 Vali Acc: 0.290 Test Loss: 72.227 Test Acc: 0.290
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 57.82110333442688
Epoch: 7, Steps: 32 | Train Loss: 3.457 Vali Loss: 148.897 Vali Acc: 0.489 Test Loss: 148.897 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 58.16453313827515
Epoch: 8, Steps: 32 | Train Loss: 8.082 Vali Loss: 118.721 Vali Acc: 0.244 Test Loss: 118.721 Test Acc: 0.244
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 57.913729667663574
Epoch: 9, Steps: 32 | Train Loss: 11.017 Vali Loss: 67.131 Vali Acc: 0.351 Test Loss: 67.131 Test Acc: 0.351
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 58.06945276260376
Epoch: 10, Steps: 32 | Train Loss: 3.627 Vali Loss: 92.579 Vali Acc: 0.351 Test Loss: 92.579 Test Acc: 0.351
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 57.92015266418457
Epoch: 11, Steps: 32 | Train Loss: 11.870 Vali Loss: 102.034 Vali Acc: 0.420 Test Loss: 102.034 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 58.03603172302246
Epoch: 12, Steps: 32 | Train Loss: 7.924 Vali Loss: 137.603 Vali Acc: 0.534 Test Loss: 137.603 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 28032517
model size : 115.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 268.30481219291687
Epoch: 1, Steps: 32 | Train Loss: 10.917 Vali Loss: 20.058 Vali Acc: 0.481 Test Loss: 20.058 Test Acc: 0.481
Validation loss decreased (inf --> -0.480715).  Saving model ...
Epoch: 2 cost time: 265.76446557044983
Epoch: 2, Steps: 32 | Train Loss: 5.861 Vali Loss: 28.856 Vali Acc: 0.519 Test Loss: 28.856 Test Acc: 0.519
Validation loss decreased (-0.480715 --> -0.518795).  Saving model ...
Epoch: 3 cost time: 264.9648633003235
Epoch: 3, Steps: 32 | Train Loss: 11.072 Vali Loss: 32.114 Vali Acc: 0.374 Test Loss: 32.114 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 262.0790593624115
Epoch: 4, Steps: 32 | Train Loss: 18.435 Vali Loss: 56.240 Vali Acc: 0.328 Test Loss: 56.240 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 263.92939734458923
Epoch: 5, Steps: 32 | Train Loss: 8.037 Vali Loss: 111.528 Vali Acc: 0.221 Test Loss: 111.528 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 264.22702836990356
Epoch: 6, Steps: 32 | Train Loss: 13.165 Vali Loss: 67.830 Vali Acc: 0.405 Test Loss: 67.830 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 264.3613176345825
Epoch: 7, Steps: 32 | Train Loss: 9.436 Vali Loss: 76.106 Vali Acc: 0.321 Test Loss: 76.106 Test Acc: 0.321
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 264.1317346096039
Epoch: 8, Steps: 32 | Train Loss: 4.537 Vali Loss: 60.378 Vali Acc: 0.511 Test Loss: 60.378 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 262.73910117149353
Epoch: 9, Steps: 32 | Train Loss: 10.387 Vali Loss: 123.473 Vali Acc: 0.473 Test Loss: 123.473 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 263.6578702926636
Epoch: 10, Steps: 32 | Train Loss: 9.894 Vali Loss: 102.420 Vali Acc: 0.275 Test Loss: 102.420 Test Acc: 0.275
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 263.7226982116699
Epoch: 11, Steps: 32 | Train Loss: 12.282 Vali Loss: 89.140 Vali Acc: 0.397 Test Loss: 89.140 Test Acc: 0.397
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 263.3981113433838
Epoch: 12, Steps: 32 | Train Loss: 6.475 Vali Loss: 137.404 Vali Acc: 0.336 Test Loss: 137.404 Test Acc: 0.336
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 39632389
model size : 159.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 122.14529061317444
Epoch: 1, Steps: 32 | Train Loss: 12.618 Vali Loss: 7.242 Vali Acc: 0.534 Test Loss: 7.242 Test Acc: 0.534
Validation loss decreased (inf --> -0.534279).  Saving model ...
Epoch: 2 cost time: 120.98625183105469
Epoch: 2, Steps: 32 | Train Loss: 11.821 Vali Loss: 21.800 Vali Acc: 0.542 Test Loss: 21.800 Test Acc: 0.542
Validation loss decreased (-0.534279 --> -0.541767).  Saving model ...
Epoch: 3 cost time: 120.18995571136475
Epoch: 3, Steps: 32 | Train Loss: 12.639 Vali Loss: 51.541 Vali Acc: 0.313 Test Loss: 51.541 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 120.33253383636475
Epoch: 4, Steps: 32 | Train Loss: 9.288 Vali Loss: 41.729 Vali Acc: 0.527 Test Loss: 41.729 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 120.33570146560669
Epoch: 5, Steps: 32 | Train Loss: 12.107 Vali Loss: 53.346 Vali Acc: 0.595 Test Loss: 53.346 Test Acc: 0.595
Validation loss decreased (-0.541767 --> -0.594886).  Saving model ...
Epoch: 6 cost time: 120.15629243850708
Epoch: 6, Steps: 32 | Train Loss: 1.895 Vali Loss: 53.200 Vali Acc: 0.557 Test Loss: 53.200 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 119.87919998168945
Epoch: 7, Steps: 32 | Train Loss: 3.276 Vali Loss: 97.646 Vali Acc: 0.542 Test Loss: 97.646 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 118.954913854599
Epoch: 8, Steps: 32 | Train Loss: 1.588 Vali Loss: 65.520 Vali Acc: 0.557 Test Loss: 65.520 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 119.81089639663696
Epoch: 9, Steps: 32 | Train Loss: 13.018 Vali Loss: 122.094 Vali Acc: 0.260 Test Loss: 122.094 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 119.0647497177124
Epoch: 10, Steps: 32 | Train Loss: 7.465 Vali Loss: 107.338 Vali Acc: 0.565 Test Loss: 107.338 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 119.05439758300781
Epoch: 11, Steps: 32 | Train Loss: 8.694 Vali Loss: 203.562 Vali Acc: 0.397 Test Loss: 203.562 Test Acc: 0.397
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 118.96579575538635
Epoch: 12, Steps: 32 | Train Loss: 6.016 Vali Loss: 103.065 Vali Acc: 0.504 Test Loss: 103.065 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 120.1563413143158
Epoch: 13, Steps: 32 | Train Loss: 7.726 Vali Loss: 101.297 Vali Acc: 0.405 Test Loss: 101.297 Test Acc: 0.405
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 119.43966436386108
Epoch: 14, Steps: 32 | Train Loss: 5.508 Vali Loss: 222.539 Vali Acc: 0.298 Test Loss: 222.539 Test Acc: 0.298
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 118.62390398979187
Epoch: 15, Steps: 32 | Train Loss: 23.879 Vali Loss: 179.794 Vali Acc: 0.443 Test Loss: 179.794 Test Acc: 0.443
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5954198473282443
model parameter : 19773445
model size : 84.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 174.38578343391418
Epoch: 1, Steps: 32 | Train Loss: 10.926 Vali Loss: 19.970 Vali Acc: 0.481 Test Loss: 19.970 Test Acc: 0.481
Validation loss decreased (inf --> -0.480716).  Saving model ...
Epoch: 2 cost time: 174.06554412841797
Epoch: 2, Steps: 32 | Train Loss: 4.430 Vali Loss: 45.461 Vali Acc: 0.481 Test Loss: 45.461 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 172.9074583053589
Epoch: 3, Steps: 32 | Train Loss: 10.730 Vali Loss: 25.125 Vali Acc: 0.420 Test Loss: 25.125 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 173.18695545196533
Epoch: 4, Steps: 32 | Train Loss: 9.349 Vali Loss: 29.537 Vali Acc: 0.458 Test Loss: 29.537 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 174.82656359672546
Epoch: 5, Steps: 32 | Train Loss: 15.794 Vali Loss: 108.866 Vali Acc: 0.237 Test Loss: 108.866 Test Acc: 0.237
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 174.1204617023468
Epoch: 6, Steps: 32 | Train Loss: 18.799 Vali Loss: 61.352 Vali Acc: 0.450 Test Loss: 61.352 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 171.6740484237671
Epoch: 7, Steps: 32 | Train Loss: 8.905 Vali Loss: 77.843 Vali Acc: 0.466 Test Loss: 77.843 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 171.66370797157288
Epoch: 8, Steps: 32 | Train Loss: 8.911 Vali Loss: 94.656 Vali Acc: 0.405 Test Loss: 94.656 Test Acc: 0.405
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 171.3135211467743
Epoch: 9, Steps: 32 | Train Loss: 6.785 Vali Loss: 91.857 Vali Acc: 0.321 Test Loss: 91.857 Test Acc: 0.321
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 172.64944458007812
Epoch: 10, Steps: 32 | Train Loss: 27.613 Vali Loss: 166.521 Vali Acc: 0.458 Test Loss: 166.521 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 172.58299779891968
Epoch: 11, Steps: 32 | Train Loss: 10.575 Vali Loss: 140.202 Vali Acc: 0.580 Test Loss: 140.202 Test Acc: 0.580
Validation loss decreased (-0.480716 --> -0.578751).  Saving model ...
Epoch: 12 cost time: 172.91920018196106
Epoch: 12, Steps: 32 | Train Loss: 6.076 Vali Loss: 158.504 Vali Acc: 0.473 Test Loss: 158.504 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 172.63923048973083
Epoch: 13, Steps: 32 | Train Loss: 14.020 Vali Loss: 93.914 Vali Acc: 0.618 Test Loss: 93.914 Test Acc: 0.618
Validation loss decreased (-0.578751 --> -0.617381).  Saving model ...
Epoch: 14 cost time: 171.2641565799713
Epoch: 14, Steps: 32 | Train Loss: 3.087 Vali Loss: 137.362 Vali Acc: 0.504 Test Loss: 137.362 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 172.75390434265137
Epoch: 15, Steps: 32 | Train Loss: 13.896 Vali Loss: 223.483 Vali Acc: 0.527 Test Loss: 223.483 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 171.7429337501526
Epoch: 16, Steps: 32 | Train Loss: 5.459 Vali Loss: 221.971 Vali Acc: 0.466 Test Loss: 221.971 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 172.3379406929016
Epoch: 17, Steps: 32 | Train Loss: 7.587 Vali Loss: 203.947 Vali Acc: 0.496 Test Loss: 203.947 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 174.03365850448608
Epoch: 18, Steps: 32 | Train Loss: 2.786 Vali Loss: 218.730 Vali Acc: 0.458 Test Loss: 218.730 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 172.30722188949585
Epoch: 19, Steps: 32 | Train Loss: 8.408 Vali Loss: 146.384 Vali Acc: 0.336 Test Loss: 146.384 Test Acc: 0.336
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 172.29725050926208
Epoch: 20, Steps: 32 | Train Loss: 2.893 Vali Loss: 165.608 Vali Acc: 0.374 Test Loss: 165.608 Test Acc: 0.374
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 172.67024993896484
Epoch: 21, Steps: 32 | Train Loss: 3.023 Vali Loss: 198.836 Vali Acc: 0.366 Test Loss: 198.836 Test Acc: 0.366
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 172.10188841819763
Epoch: 22, Steps: 32 | Train Loss: 6.903 Vali Loss: 279.854 Vali Acc: 0.527 Test Loss: 279.854 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 172.93717312812805
Epoch: 23, Steps: 32 | Train Loss: 5.802 Vali Loss: 139.052 Vali Acc: 0.550 Test Loss: 139.052 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6183206106870229
model parameter : 39632389
model size : 159.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 89.44225931167603
Epoch: 1, Steps: 32 | Train Loss: 15.330 Vali Loss: 9.811 Vali Acc: 0.298 Test Loss: 9.811 Test Acc: 0.298
Validation loss decreased (inf --> -0.297612).  Saving model ...
Epoch: 2 cost time: 87.5163254737854
Epoch: 2, Steps: 32 | Train Loss: 17.142 Vali Loss: 18.926 Vali Acc: 0.542 Test Loss: 18.926 Test Acc: 0.542
Validation loss decreased (-0.297612 --> -0.541795).  Saving model ...
Epoch: 3 cost time: 87.9468936920166
Epoch: 3, Steps: 32 | Train Loss: 14.411 Vali Loss: 37.879 Vali Acc: 0.466 Test Loss: 37.879 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 87.64369130134583
Epoch: 4, Steps: 32 | Train Loss: 17.228 Vali Loss: 64.919 Vali Acc: 0.305 Test Loss: 64.919 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 87.71403503417969
Epoch: 5, Steps: 32 | Train Loss: 10.238 Vali Loss: 125.142 Vali Acc: 0.267 Test Loss: 125.142 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 87.70195126533508
Epoch: 6, Steps: 32 | Train Loss: 8.037 Vali Loss: 102.673 Vali Acc: 0.290 Test Loss: 102.673 Test Acc: 0.290
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 88.2366406917572
Epoch: 7, Steps: 32 | Train Loss: 5.879 Vali Loss: 73.750 Vali Acc: 0.527 Test Loss: 73.750 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 87.51452469825745
Epoch: 8, Steps: 32 | Train Loss: 3.775 Vali Loss: 108.938 Vali Acc: 0.519 Test Loss: 108.938 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 88.20039820671082
Epoch: 9, Steps: 32 | Train Loss: 7.714 Vali Loss: 168.625 Vali Acc: 0.267 Test Loss: 168.625 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 88.18332481384277
Epoch: 10, Steps: 32 | Train Loss: 8.293 Vali Loss: 104.726 Vali Acc: 0.427 Test Loss: 104.726 Test Acc: 0.427
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 87.85721015930176
Epoch: 11, Steps: 32 | Train Loss: 3.404 Vali Loss: 139.947 Vali Acc: 0.328 Test Loss: 139.947 Test Acc: 0.328
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 88.08846831321716
Epoch: 12, Steps: 32 | Train Loss: 4.900 Vali Loss: 155.382 Vali Acc: 0.473 Test Loss: 155.382 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 19773445
model size : 84.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 100.92195200920105
Epoch: 1, Steps: 32 | Train Loss: 10.945 Vali Loss: 19.769 Vali Acc: 0.489 Test Loss: 19.769 Test Acc: 0.489
Validation loss decreased (inf --> -0.488352).  Saving model ...
Epoch: 2 cost time: 99.75347781181335
Epoch: 2, Steps: 32 | Train Loss: 5.825 Vali Loss: 19.724 Vali Acc: 0.580 Test Loss: 19.724 Test Acc: 0.580
Validation loss decreased (-0.488352 --> -0.579955).  Saving model ...
Epoch: 3 cost time: 99.26819229125977
Epoch: 3, Steps: 32 | Train Loss: 10.863 Vali Loss: 78.806 Vali Acc: 0.267 Test Loss: 78.806 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 98.83190894126892
Epoch: 4, Steps: 32 | Train Loss: 13.178 Vali Loss: 35.920 Vali Acc: 0.466 Test Loss: 35.920 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 98.24271273612976
Epoch: 5, Steps: 32 | Train Loss: 3.148 Vali Loss: 39.536 Vali Acc: 0.580 Test Loss: 39.536 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 98.32270956039429
Epoch: 6, Steps: 32 | Train Loss: 7.925 Vali Loss: 38.350 Vali Acc: 0.496 Test Loss: 38.350 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 98.26847052574158
Epoch: 7, Steps: 32 | Train Loss: 12.939 Vali Loss: 91.358 Vali Acc: 0.466 Test Loss: 91.358 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 98.34643220901489
Epoch: 8, Steps: 32 | Train Loss: 9.171 Vali Loss: 79.509 Vali Acc: 0.496 Test Loss: 79.509 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 98.09240317344666
Epoch: 9, Steps: 32 | Train Loss: 3.766 Vali Loss: 81.974 Vali Acc: 0.580 Test Loss: 81.974 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 97.5291953086853
Epoch: 10, Steps: 32 | Train Loss: 2.320 Vali Loss: 125.498 Vali Acc: 0.260 Test Loss: 125.498 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 97.77170133590698
Epoch: 11, Steps: 32 | Train Loss: 2.825 Vali Loss: 116.225 Vali Acc: 0.435 Test Loss: 116.225 Test Acc: 0.435
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 98.18192529678345
Epoch: 12, Steps: 32 | Train Loss: 8.493 Vali Loss: 172.683 Vali Acc: 0.435 Test Loss: 172.683 Test Acc: 0.435
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 39632389
model size : 159.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 61.598252058029175
Epoch: 1, Steps: 32 | Train Loss: 12.800 Vali Loss: 24.433 Vali Acc: 0.168 Test Loss: 24.433 Test Acc: 0.168
Validation loss decreased (inf --> -0.167695).  Saving model ...
Epoch: 2 cost time: 60.85705614089966
Epoch: 2, Steps: 32 | Train Loss: 16.971 Vali Loss: 23.221 Vali Acc: 0.496 Test Loss: 23.221 Test Acc: 0.496
Validation loss decreased (-0.167695 --> -0.495951).  Saving model ...
Epoch: 3 cost time: 60.79746770858765
Epoch: 3, Steps: 32 | Train Loss: 8.516 Vali Loss: 75.403 Vali Acc: 0.221 Test Loss: 75.403 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 60.6705858707428
Epoch: 4, Steps: 32 | Train Loss: 23.425 Vali Loss: 62.491 Vali Acc: 0.344 Test Loss: 62.491 Test Acc: 0.344
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 60.035202741622925
Epoch: 5, Steps: 32 | Train Loss: 5.539 Vali Loss: 47.623 Vali Acc: 0.374 Test Loss: 47.623 Test Acc: 0.374
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 60.33836007118225
Epoch: 6, Steps: 32 | Train Loss: 3.714 Vali Loss: 62.125 Vali Acc: 0.473 Test Loss: 62.125 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 59.86657118797302
Epoch: 7, Steps: 32 | Train Loss: 1.833 Vali Loss: 43.229 Vali Acc: 0.550 Test Loss: 43.229 Test Acc: 0.550
Validation loss decreased (-0.495951 --> -0.549186).  Saving model ...
Epoch: 8 cost time: 60.13134455680847
Epoch: 8, Steps: 32 | Train Loss: 5.905 Vali Loss: 73.176 Vali Acc: 0.550 Test Loss: 73.176 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 59.67012691497803
Epoch: 9, Steps: 32 | Train Loss: 8.212 Vali Loss: 80.419 Vali Acc: 0.565 Test Loss: 80.419 Test Acc: 0.565
Validation loss decreased (-0.549186 --> -0.564081).  Saving model ...
Epoch: 10 cost time: 60.04771113395691
Epoch: 10, Steps: 32 | Train Loss: 9.156 Vali Loss: 83.103 Vali Acc: 0.389 Test Loss: 83.103 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 59.916391372680664
Epoch: 11, Steps: 32 | Train Loss: 5.974 Vali Loss: 95.525 Vali Acc: 0.496 Test Loss: 95.525 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 59.988067865371704
Epoch: 12, Steps: 32 | Train Loss: 20.307 Vali Loss: 141.998 Vali Acc: 0.412 Test Loss: 141.998 Test Acc: 0.412
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 60.2638783454895
Epoch: 13, Steps: 32 | Train Loss: 9.152 Vali Loss: 157.736 Vali Acc: 0.443 Test Loss: 157.736 Test Acc: 0.443
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 60.11644792556763
Epoch: 14, Steps: 32 | Train Loss: 9.227 Vali Loss: 168.784 Vali Acc: 0.344 Test Loss: 168.784 Test Acc: 0.344
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 60.1091628074646
Epoch: 15, Steps: 32 | Train Loss: 3.674 Vali Loss: 133.011 Vali Acc: 0.519 Test Loss: 133.011 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 59.834938764572144
Epoch: 16, Steps: 32 | Train Loss: 0.083 Vali Loss: 152.105 Vali Acc: 0.542 Test Loss: 152.105 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 60.150251626968384
Epoch: 17, Steps: 32 | Train Loss: 4.549 Vali Loss: 171.012 Vali Acc: 0.397 Test Loss: 171.012 Test Acc: 0.397
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 60.243728160858154
Epoch: 18, Steps: 32 | Train Loss: 1.900 Vali Loss: 177.826 Vali Acc: 0.580 Test Loss: 177.826 Test Acc: 0.580
Validation loss decreased (-0.564081 --> -0.578374).  Saving model ...
Epoch: 19 cost time: 60.318631410598755
Epoch: 19, Steps: 32 | Train Loss: 7.583 Vali Loss: 183.967 Vali Acc: 0.557 Test Loss: 183.967 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 60.47661089897156
Epoch: 20, Steps: 32 | Train Loss: 1.389 Vali Loss: 307.762 Vali Acc: 0.267 Test Loss: 307.762 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 60.14783549308777
Epoch: 21, Steps: 32 | Train Loss: 4.054 Vali Loss: 126.742 Vali Acc: 0.573 Test Loss: 126.742 Test Acc: 0.573
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 60.31442093849182
Epoch: 22, Steps: 32 | Train Loss: 1.285 Vali Loss: 215.221 Vali Acc: 0.374 Test Loss: 215.221 Test Acc: 0.374
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 59.63327693939209
Epoch: 23, Steps: 32 | Train Loss: 26.536 Vali Loss: 170.582 Vali Acc: 0.481 Test Loss: 170.582 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 60.042181730270386
Epoch: 24, Steps: 32 | Train Loss: 3.145 Vali Loss: 210.067 Vali Acc: 0.489 Test Loss: 210.067 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 60.03292155265808
Epoch: 25, Steps: 32 | Train Loss: 8.470 Vali Loss: 401.021 Vali Acc: 0.160 Test Loss: 401.021 Test Acc: 0.160
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 60.21802115440369
Epoch: 26, Steps: 32 | Train Loss: 6.002 Vali Loss: 188.446 Vali Acc: 0.511 Test Loss: 188.446 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 60.20154690742493
Epoch: 27, Steps: 32 | Train Loss: 30.455 Vali Loss: 267.504 Vali Acc: 0.351 Test Loss: 267.504 Test Acc: 0.351
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 60.00071334838867
Epoch: 28, Steps: 32 | Train Loss: 1.968 Vali Loss: 338.675 Vali Acc: 0.359 Test Loss: 338.675 Test Acc: 0.359
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 19773445
model size : 84.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 307.4872236251831
Epoch: 1, Steps: 32 | Train Loss: 7.378 Vali Loss: 11.304 Vali Acc: 0.244 Test Loss: 11.304 Test Acc: 0.244
Validation loss decreased (inf --> -0.244162).  Saving model ...
Epoch: 2 cost time: 304.0790071487427
Epoch: 2, Steps: 32 | Train Loss: 5.713 Vali Loss: 23.373 Vali Acc: 0.244 Test Loss: 23.373 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 303.5417742729187
Epoch: 3, Steps: 32 | Train Loss: 5.627 Vali Loss: 32.711 Vali Acc: 0.504 Test Loss: 32.711 Test Acc: 0.504
Validation loss decreased (-0.244162 --> -0.503490).  Saving model ...
Epoch: 4 cost time: 304.7431559562683
Epoch: 4, Steps: 32 | Train Loss: 6.200 Vali Loss: 24.852 Vali Acc: 0.450 Test Loss: 24.852 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 300.3331105709076
Epoch: 5, Steps: 32 | Train Loss: 6.501 Vali Loss: 36.590 Vali Acc: 0.534 Test Loss: 36.590 Test Acc: 0.534
Validation loss decreased (-0.503490 --> -0.533985).  Saving model ...
Epoch: 6 cost time: 300.5440537929535
Epoch: 6, Steps: 32 | Train Loss: 3.499 Vali Loss: 37.541 Vali Acc: 0.588 Test Loss: 37.541 Test Acc: 0.588
Validation loss decreased (-0.533985 --> -0.587411).  Saving model ...
Epoch: 7 cost time: 298.2716100215912
Epoch: 7, Steps: 32 | Train Loss: 4.782 Vali Loss: 42.906 Vali Acc: 0.366 Test Loss: 42.906 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 300.02782368659973
Epoch: 8, Steps: 32 | Train Loss: 7.557 Vali Loss: 69.376 Vali Acc: 0.542 Test Loss: 69.376 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 299.67113995552063
Epoch: 9, Steps: 32 | Train Loss: 11.479 Vali Loss: 72.421 Vali Acc: 0.260 Test Loss: 72.421 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 301.625057220459
Epoch: 10, Steps: 32 | Train Loss: 2.140 Vali Loss: 56.790 Vali Acc: 0.397 Test Loss: 56.790 Test Acc: 0.397
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 302.84460949897766
Epoch: 11, Steps: 32 | Train Loss: 11.463 Vali Loss: 80.275 Vali Acc: 0.252 Test Loss: 80.275 Test Acc: 0.252
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 301.9967498779297
Epoch: 12, Steps: 32 | Train Loss: 16.879 Vali Loss: 67.516 Vali Acc: 0.397 Test Loss: 67.516 Test Acc: 0.397
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 302.5238265991211
Epoch: 13, Steps: 32 | Train Loss: 7.036 Vali Loss: 89.368 Vali Acc: 0.435 Test Loss: 89.368 Test Acc: 0.435
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 302.55013704299927
Epoch: 14, Steps: 32 | Train Loss: 6.281 Vali Loss: 114.812 Vali Acc: 0.389 Test Loss: 114.812 Test Acc: 0.389
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 302.0916895866394
Epoch: 15, Steps: 32 | Train Loss: 6.171 Vali Loss: 99.167 Vali Acc: 0.527 Test Loss: 99.167 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 301.606778383255
Epoch: 16, Steps: 32 | Train Loss: 3.913 Vali Loss: 72.523 Vali Acc: 0.580 Test Loss: 72.523 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 33877125
model size : 133.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 109.18854713439941
Epoch: 1, Steps: 32 | Train Loss: 9.443 Vali Loss: 20.303 Vali Acc: 0.198 Test Loss: 20.303 Test Acc: 0.198
Validation loss decreased (inf --> -0.198270).  Saving model ...
Epoch: 2 cost time: 108.4578628540039
Epoch: 2, Steps: 32 | Train Loss: 6.037 Vali Loss: 17.412 Vali Acc: 0.260 Test Loss: 17.412 Test Acc: 0.260
Validation loss decreased (-0.198270 --> -0.259368).  Saving model ...
Epoch: 3 cost time: 108.09795212745667
Epoch: 3, Steps: 32 | Train Loss: 2.616 Vali Loss: 30.020 Vali Acc: 0.282 Test Loss: 30.020 Test Acc: 0.282
Validation loss decreased (-0.259368 --> -0.282143).  Saving model ...
Epoch: 4 cost time: 107.99626922607422
Epoch: 4, Steps: 32 | Train Loss: 3.880 Vali Loss: 12.989 Vali Acc: 0.542 Test Loss: 12.989 Test Acc: 0.542
Validation loss decreased (-0.282143 --> -0.541855).  Saving model ...
Epoch: 5 cost time: 107.61804986000061
Epoch: 5, Steps: 32 | Train Loss: 3.890 Vali Loss: 24.412 Vali Acc: 0.573 Test Loss: 24.412 Test Acc: 0.573
Validation loss decreased (-0.541855 --> -0.572275).  Saving model ...
Epoch: 6 cost time: 107.29493546485901
Epoch: 6, Steps: 32 | Train Loss: 1.182 Vali Loss: 34.423 Vali Acc: 0.420 Test Loss: 34.423 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 107.26447987556458
Epoch: 7, Steps: 32 | Train Loss: 3.205 Vali Loss: 59.422 Vali Acc: 0.481 Test Loss: 59.422 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 108.11703038215637
Epoch: 8, Steps: 32 | Train Loss: 4.677 Vali Loss: 42.100 Vali Acc: 0.481 Test Loss: 42.100 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 107.6743996143341
Epoch: 9, Steps: 32 | Train Loss: 2.185 Vali Loss: 41.004 Vali Acc: 0.534 Test Loss: 41.004 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 105.97147393226624
Epoch: 10, Steps: 32 | Train Loss: 2.604 Vali Loss: 67.581 Vali Acc: 0.344 Test Loss: 67.581 Test Acc: 0.344
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 106.48964619636536
Epoch: 11, Steps: 32 | Train Loss: 13.232 Vali Loss: 69.123 Vali Acc: 0.450 Test Loss: 69.123 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 106.36370015144348
Epoch: 12, Steps: 32 | Train Loss: 5.802 Vali Loss: 110.403 Vali Acc: 0.466 Test Loss: 110.403 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 105.72886681556702
Epoch: 13, Steps: 32 | Train Loss: 6.840 Vali Loss: 70.781 Vali Acc: 0.328 Test Loss: 70.781 Test Acc: 0.328
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 107.2463641166687
Epoch: 14, Steps: 32 | Train Loss: 2.464 Vali Loss: 81.786 Vali Acc: 0.412 Test Loss: 81.786 Test Acc: 0.412
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 106.21038460731506
Epoch: 15, Steps: 32 | Train Loss: 3.445 Vali Loss: 77.352 Vali Acc: 0.489 Test Loss: 77.352 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 14017797
model size : 57.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 194.45634627342224
Epoch: 1, Steps: 32 | Train Loss: 7.412 Vali Loss: 11.173 Vali Acc: 0.229 Test Loss: 11.173 Test Acc: 0.229
Validation loss decreased (inf --> -0.228896).  Saving model ...
Epoch: 2 cost time: 192.05119681358337
Epoch: 2, Steps: 32 | Train Loss: 4.478 Vali Loss: 16.659 Vali Acc: 0.374 Test Loss: 16.659 Test Acc: 0.374
Validation loss decreased (-0.228896 --> -0.373879).  Saving model ...
Epoch: 3 cost time: 192.0238902568817
Epoch: 3, Steps: 32 | Train Loss: 4.980 Vali Loss: 10.646 Vali Acc: 0.565 Test Loss: 10.646 Test Acc: 0.565
Validation loss decreased (-0.373879 --> -0.564779).  Saving model ...
Epoch: 4 cost time: 193.13241982460022
Epoch: 4, Steps: 32 | Train Loss: 7.329 Vali Loss: 29.814 Vali Acc: 0.244 Test Loss: 29.814 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 191.47983479499817
Epoch: 5, Steps: 32 | Train Loss: 2.405 Vali Loss: 22.255 Vali Acc: 0.588 Test Loss: 22.255 Test Acc: 0.588
Validation loss decreased (-0.564779 --> -0.587564).  Saving model ...
Epoch: 6 cost time: 191.0713131427765
Epoch: 6, Steps: 32 | Train Loss: 0.465 Vali Loss: 19.005 Vali Acc: 0.527 Test Loss: 19.005 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 191.05939888954163
Epoch: 7, Steps: 32 | Train Loss: 0.700 Vali Loss: 23.922 Vali Acc: 0.519 Test Loss: 23.922 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 191.04344058036804
Epoch: 8, Steps: 32 | Train Loss: 4.823 Vali Loss: 28.432 Vali Acc: 0.550 Test Loss: 28.432 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 191.51077270507812
Epoch: 9, Steps: 32 | Train Loss: 5.480 Vali Loss: 42.063 Vali Acc: 0.519 Test Loss: 42.063 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 190.91456723213196
Epoch: 10, Steps: 32 | Train Loss: 12.350 Vali Loss: 80.397 Vali Acc: 0.252 Test Loss: 80.397 Test Acc: 0.252
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 189.98187589645386
Epoch: 11, Steps: 32 | Train Loss: 11.829 Vali Loss: 92.183 Vali Acc: 0.511 Test Loss: 92.183 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 191.52099013328552
Epoch: 12, Steps: 32 | Train Loss: 11.199 Vali Loss: 108.512 Vali Acc: 0.298 Test Loss: 108.512 Test Acc: 0.298
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 191.2202751636505
Epoch: 13, Steps: 32 | Train Loss: 16.259 Vali Loss: 70.209 Vali Acc: 0.374 Test Loss: 70.209 Test Acc: 0.374
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 192.97800278663635
Epoch: 14, Steps: 32 | Train Loss: 12.639 Vali Loss: 115.357 Vali Acc: 0.321 Test Loss: 115.357 Test Acc: 0.321
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 190.16026043891907
Epoch: 15, Steps: 32 | Train Loss: 6.086 Vali Loss: 168.771 Vali Acc: 0.290 Test Loss: 168.771 Test Acc: 0.290
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 33877125
model size : 133.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 68.54759645462036
Epoch: 1, Steps: 32 | Train Loss: 9.575 Vali Loss: 19.651 Vali Acc: 0.221 Test Loss: 19.651 Test Acc: 0.221
Validation loss decreased (inf --> -0.221178).  Saving model ...
Epoch: 2 cost time: 67.97106552124023
Epoch: 2, Steps: 32 | Train Loss: 6.418 Vali Loss: 14.450 Vali Acc: 0.237 Test Loss: 14.450 Test Acc: 0.237
Validation loss decreased (-0.221178 --> -0.236497).  Saving model ...
Epoch: 3 cost time: 67.74602270126343
Epoch: 3, Steps: 32 | Train Loss: 3.968 Vali Loss: 33.995 Vali Acc: 0.328 Test Loss: 33.995 Test Acc: 0.328
Validation loss decreased (-0.236497 --> -0.327904).  Saving model ...
Epoch: 4 cost time: 68.42851114273071
Epoch: 4, Steps: 32 | Train Loss: 4.661 Vali Loss: 16.788 Vali Acc: 0.550 Test Loss: 16.788 Test Acc: 0.550
Validation loss decreased (-0.327904 --> -0.549450).  Saving model ...
Epoch: 5 cost time: 67.6377944946289
Epoch: 5, Steps: 32 | Train Loss: 3.543 Vali Loss: 21.903 Vali Acc: 0.527 Test Loss: 21.903 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 67.68954658508301
Epoch: 6, Steps: 32 | Train Loss: 4.483 Vali Loss: 26.730 Vali Acc: 0.450 Test Loss: 26.730 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 68.32216334342957
Epoch: 7, Steps: 32 | Train Loss: 5.027 Vali Loss: 48.332 Vali Acc: 0.328 Test Loss: 48.332 Test Acc: 0.328
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 67.80515813827515
Epoch: 8, Steps: 32 | Train Loss: 3.653 Vali Loss: 43.222 Vali Acc: 0.496 Test Loss: 43.222 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 67.99646949768066
Epoch: 9, Steps: 32 | Train Loss: 4.147 Vali Loss: 79.780 Vali Acc: 0.427 Test Loss: 79.780 Test Acc: 0.427
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 67.97983622550964
Epoch: 10, Steps: 32 | Train Loss: 4.861 Vali Loss: 38.740 Vali Acc: 0.450 Test Loss: 38.740 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 67.87463617324829
Epoch: 11, Steps: 32 | Train Loss: 2.521 Vali Loss: 48.924 Vali Acc: 0.427 Test Loss: 48.924 Test Acc: 0.427
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 67.49630618095398
Epoch: 12, Steps: 32 | Train Loss: 2.598 Vali Loss: 54.989 Vali Acc: 0.557 Test Loss: 54.989 Test Acc: 0.557
Validation loss decreased (-0.549450 --> -0.556702).  Saving model ...
Epoch: 13 cost time: 67.17285394668579
Epoch: 13, Steps: 32 | Train Loss: 1.247 Vali Loss: 46.685 Vali Acc: 0.473 Test Loss: 46.685 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 67.8410267829895
Epoch: 14, Steps: 32 | Train Loss: 5.061 Vali Loss: 90.219 Vali Acc: 0.351 Test Loss: 90.219 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 68.16092896461487
Epoch: 15, Steps: 32 | Train Loss: 8.022 Vali Loss: 80.581 Vali Acc: 0.443 Test Loss: 80.581 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 67.6457211971283
Epoch: 16, Steps: 32 | Train Loss: 3.993 Vali Loss: 104.820 Vali Acc: 0.397 Test Loss: 104.820 Test Acc: 0.397
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 67.31477212905884
Epoch: 17, Steps: 32 | Train Loss: 7.155 Vali Loss: 86.003 Vali Acc: 0.504 Test Loss: 86.003 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 67.71571350097656
Epoch: 18, Steps: 32 | Train Loss: 5.227 Vali Loss: 61.476 Vali Acc: 0.496 Test Loss: 61.476 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 67.37643957138062
Epoch: 19, Steps: 32 | Train Loss: 7.599 Vali Loss: 106.633 Vali Acc: 0.389 Test Loss: 106.633 Test Acc: 0.389
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 67.7521800994873
Epoch: 20, Steps: 32 | Train Loss: 0.832 Vali Loss: 100.660 Vali Acc: 0.527 Test Loss: 100.660 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 67.2712230682373
Epoch: 21, Steps: 32 | Train Loss: 0.935 Vali Loss: 94.440 Vali Acc: 0.496 Test Loss: 94.440 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 67.21281385421753
Epoch: 22, Steps: 32 | Train Loss: 0.051 Vali Loss: 155.699 Vali Acc: 0.336 Test Loss: 155.699 Test Acc: 0.336
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 14017797
model size : 57.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 104.79051971435547
Epoch: 1, Steps: 32 | Train Loss: 7.424 Vali Loss: 5.082 Vali Acc: 0.534 Test Loss: 5.082 Test Acc: 0.534
Validation loss decreased (inf --> -0.534300).  Saving model ...
Epoch: 2 cost time: 103.2054181098938
Epoch: 2, Steps: 32 | Train Loss: 4.033 Vali Loss: 13.075 Vali Acc: 0.435 Test Loss: 13.075 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 103.47630262374878
Epoch: 3, Steps: 32 | Train Loss: 5.591 Vali Loss: 27.935 Vali Acc: 0.489 Test Loss: 27.935 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 103.4960446357727
Epoch: 4, Steps: 32 | Train Loss: 6.146 Vali Loss: 43.860 Vali Acc: 0.282 Test Loss: 43.860 Test Acc: 0.282
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 103.23967385292053
Epoch: 5, Steps: 32 | Train Loss: 6.869 Vali Loss: 21.092 Vali Acc: 0.435 Test Loss: 21.092 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 102.80536389350891
Epoch: 6, Steps: 32 | Train Loss: 1.497 Vali Loss: 27.771 Vali Acc: 0.427 Test Loss: 27.771 Test Acc: 0.427
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 103.5701072216034
Epoch: 7, Steps: 32 | Train Loss: 4.479 Vali Loss: 54.235 Vali Acc: 0.298 Test Loss: 54.235 Test Acc: 0.298
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 102.99796843528748
Epoch: 8, Steps: 32 | Train Loss: 5.141 Vali Loss: 39.202 Vali Acc: 0.458 Test Loss: 39.202 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 102.64967942237854
Epoch: 9, Steps: 32 | Train Loss: 1.740 Vali Loss: 75.614 Vali Acc: 0.313 Test Loss: 75.614 Test Acc: 0.313
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 102.31588363647461
Epoch: 10, Steps: 32 | Train Loss: 3.959 Vali Loss: 62.362 Vali Acc: 0.351 Test Loss: 62.362 Test Acc: 0.351
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 102.34061288833618
Epoch: 11, Steps: 32 | Train Loss: 2.060 Vali Loss: 87.560 Vali Acc: 0.481 Test Loss: 87.560 Test Acc: 0.481
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 33877125
model size : 133.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 35.59478163719177
Epoch: 1, Steps: 32 | Train Loss: 9.359 Vali Loss: 19.684 Vali Acc: 0.206 Test Loss: 19.684 Test Acc: 0.206
Validation loss decreased (inf --> -0.205910).  Saving model ...
Epoch: 2 cost time: 34.89720153808594
Epoch: 2, Steps: 32 | Train Loss: 5.781 Vali Loss: 16.049 Vali Acc: 0.244 Test Loss: 16.049 Test Acc: 0.244
Validation loss decreased (-0.205910 --> -0.244114).  Saving model ...
Epoch: 3 cost time: 34.66579842567444
Epoch: 3, Steps: 32 | Train Loss: 2.547 Vali Loss: 10.649 Vali Acc: 0.534 Test Loss: 10.649 Test Acc: 0.534
Validation loss decreased (-0.244114 --> -0.534245).  Saving model ...
Epoch: 4 cost time: 34.951701641082764
Epoch: 4, Steps: 32 | Train Loss: 7.026 Vali Loss: 21.972 Vali Acc: 0.542 Test Loss: 21.972 Test Acc: 0.542
Validation loss decreased (-0.534245 --> -0.541765).  Saving model ...
Epoch: 5 cost time: 34.795016288757324
Epoch: 5, Steps: 32 | Train Loss: 0.775 Vali Loss: 27.283 Vali Acc: 0.557 Test Loss: 27.283 Test Acc: 0.557
Validation loss decreased (-0.541765 --> -0.556979).  Saving model ...
Epoch: 6 cost time: 34.680713176727295
Epoch: 6, Steps: 32 | Train Loss: 7.913 Vali Loss: 30.983 Vali Acc: 0.542 Test Loss: 30.983 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 34.75129580497742
Epoch: 7, Steps: 32 | Train Loss: 5.804 Vali Loss: 31.266 Vali Acc: 0.634 Test Loss: 31.266 Test Acc: 0.634
Validation loss decreased (-0.556979 --> -0.633275).  Saving model ...
Epoch: 8 cost time: 34.62486672401428
Epoch: 8, Steps: 32 | Train Loss: 3.525 Vali Loss: 30.737 Vali Acc: 0.481 Test Loss: 30.737 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 34.58604669570923
Epoch: 9, Steps: 32 | Train Loss: 4.103 Vali Loss: 34.782 Vali Acc: 0.504 Test Loss: 34.782 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 34.62801504135132
Epoch: 10, Steps: 32 | Train Loss: 3.325 Vali Loss: 96.351 Vali Acc: 0.229 Test Loss: 96.351 Test Acc: 0.229
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 34.49631953239441
Epoch: 11, Steps: 32 | Train Loss: 2.348 Vali Loss: 67.681 Vali Acc: 0.489 Test Loss: 67.681 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 34.81385898590088
Epoch: 12, Steps: 32 | Train Loss: 6.769 Vali Loss: 63.765 Vali Acc: 0.527 Test Loss: 63.765 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 34.57267761230469
Epoch: 13, Steps: 32 | Train Loss: 6.012 Vali Loss: 58.955 Vali Acc: 0.489 Test Loss: 58.955 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 34.5973436832428
Epoch: 14, Steps: 32 | Train Loss: 5.549 Vali Loss: 87.398 Vali Acc: 0.504 Test Loss: 87.398 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 34.78511023521423
Epoch: 15, Steps: 32 | Train Loss: 7.535 Vali Loss: 71.694 Vali Acc: 0.405 Test Loss: 71.694 Test Acc: 0.405
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 34.8424289226532
Epoch: 16, Steps: 32 | Train Loss: 0.924 Vali Loss: 123.691 Vali Acc: 0.519 Test Loss: 123.691 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 34.578534841537476
Epoch: 17, Steps: 32 | Train Loss: 0.919 Vali Loss: 108.565 Vali Acc: 0.504 Test Loss: 108.565 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6335877862595419
model parameter : 14017797
model size : 57.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 182.33508324623108
Epoch: 1, Steps: 32 | Train Loss: 5.578 Vali Loss: 9.096 Vali Acc: 0.206 Test Loss: 9.096 Test Acc: 0.206
Validation loss decreased (inf --> -0.206016).  Saving model ...
Epoch: 2 cost time: 181.21831393241882
Epoch: 2, Steps: 32 | Train Loss: 6.493 Vali Loss: 20.820 Vali Acc: 0.260 Test Loss: 20.820 Test Acc: 0.260
Validation loss decreased (-0.206016 --> -0.259334).  Saving model ...
Epoch: 3 cost time: 179.21851515769958
Epoch: 3, Steps: 32 | Train Loss: 4.940 Vali Loss: 18.013 Vali Acc: 0.321 Test Loss: 18.013 Test Acc: 0.321
Validation loss decreased (-0.259334 --> -0.320431).  Saving model ...
Epoch: 4 cost time: 178.56770777702332
Epoch: 4, Steps: 32 | Train Loss: 8.413 Vali Loss: 19.444 Vali Acc: 0.427 Test Loss: 19.444 Test Acc: 0.427
Validation loss decreased (-0.320431 --> -0.427286).  Saving model ...
Epoch: 5 cost time: 178.87022423744202
Epoch: 5, Steps: 32 | Train Loss: 10.169 Vali Loss: 32.488 Vali Acc: 0.534 Test Loss: 32.488 Test Acc: 0.534
Validation loss decreased (-0.427286 --> -0.534026).  Saving model ...
Epoch: 6 cost time: 177.6470046043396
Epoch: 6, Steps: 32 | Train Loss: 2.688 Vali Loss: 27.022 Vali Acc: 0.595 Test Loss: 27.022 Test Acc: 0.595
Validation loss decreased (-0.534026 --> -0.595150).  Saving model ...
Epoch: 7 cost time: 177.8881368637085
Epoch: 7, Steps: 32 | Train Loss: 0.426 Vali Loss: 26.262 Vali Acc: 0.527 Test Loss: 26.262 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 178.5429711341858
Epoch: 8, Steps: 32 | Train Loss: 3.578 Vali Loss: 38.798 Vali Acc: 0.550 Test Loss: 38.798 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 178.35607838630676
Epoch: 9, Steps: 32 | Train Loss: 0.485 Vali Loss: 47.343 Vali Acc: 0.458 Test Loss: 47.343 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 179.39452528953552
Epoch: 10, Steps: 32 | Train Loss: 6.441 Vali Loss: 68.021 Vali Acc: 0.473 Test Loss: 68.021 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 179.65636229515076
Epoch: 11, Steps: 32 | Train Loss: 13.670 Vali Loss: 107.924 Vali Acc: 0.267 Test Loss: 107.924 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 178.52329182624817
Epoch: 12, Steps: 32 | Train Loss: 4.842 Vali Loss: 98.972 Vali Acc: 0.244 Test Loss: 98.972 Test Acc: 0.244
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 179.8462779521942
Epoch: 13, Steps: 32 | Train Loss: 8.309 Vali Loss: 75.282 Vali Acc: 0.481 Test Loss: 75.282 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 180.32669925689697
Epoch: 14, Steps: 32 | Train Loss: 4.112 Vali Loss: 63.613 Vali Acc: 0.489 Test Loss: 63.613 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 179.94103288650513
Epoch: 15, Steps: 32 | Train Loss: 1.086 Vali Loss: 85.287 Vali Acc: 0.359 Test Loss: 85.287 Test Acc: 0.359
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 179.55189776420593
Epoch: 16, Steps: 32 | Train Loss: 3.609 Vali Loss: 107.112 Vali Acc: 0.550 Test Loss: 107.112 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5954198473282443
model parameter : 19817349
model size : 80.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 78.6399176120758
Epoch: 1, Steps: 32 | Train Loss: 8.681 Vali Loss: 9.141 Vali Acc: 0.260 Test Loss: 9.141 Test Acc: 0.260
Validation loss decreased (inf --> -0.259451).  Saving model ...
Epoch: 2 cost time: 77.48619389533997
Epoch: 2, Steps: 32 | Train Loss: 3.786 Vali Loss: 13.971 Vali Acc: 0.374 Test Loss: 13.971 Test Acc: 0.374
Validation loss decreased (-0.259451 --> -0.373906).  Saving model ...
Epoch: 3 cost time: 77.5679886341095
Epoch: 3, Steps: 32 | Train Loss: 6.679 Vali Loss: 32.513 Vali Acc: 0.496 Test Loss: 32.513 Test Acc: 0.496
Validation loss decreased (-0.373906 --> -0.495858).  Saving model ...
Epoch: 4 cost time: 77.52513599395752
Epoch: 4, Steps: 32 | Train Loss: 8.063 Vali Loss: 17.510 Vali Acc: 0.435 Test Loss: 17.510 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 77.16108059883118
Epoch: 5, Steps: 32 | Train Loss: 3.234 Vali Loss: 35.921 Vali Acc: 0.321 Test Loss: 35.921 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 77.10446643829346
Epoch: 6, Steps: 32 | Train Loss: 2.017 Vali Loss: 38.869 Vali Acc: 0.481 Test Loss: 38.869 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 76.80190110206604
Epoch: 7, Steps: 32 | Train Loss: 3.162 Vali Loss: 43.721 Vali Acc: 0.374 Test Loss: 43.721 Test Acc: 0.374
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 77.42791724205017
Epoch: 8, Steps: 32 | Train Loss: 2.260 Vali Loss: 42.048 Vali Acc: 0.450 Test Loss: 42.048 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 76.65929841995239
Epoch: 9, Steps: 32 | Train Loss: 4.365 Vali Loss: 67.458 Vali Acc: 0.450 Test Loss: 67.458 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 77.42944288253784
Epoch: 10, Steps: 32 | Train Loss: 5.275 Vali Loss: 42.461 Vali Acc: 0.466 Test Loss: 42.461 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 77.06066989898682
Epoch: 11, Steps: 32 | Train Loss: 3.003 Vali Loss: 67.036 Vali Acc: 0.321 Test Loss: 67.036 Test Acc: 0.321
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 76.38055920600891
Epoch: 12, Steps: 32 | Train Loss: 4.993 Vali Loss: 76.836 Vali Acc: 0.336 Test Loss: 76.836 Test Acc: 0.336
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 77.0194501876831
Epoch: 13, Steps: 32 | Train Loss: 4.530 Vali Loss: 95.720 Vali Acc: 0.290 Test Loss: 95.720 Test Acc: 0.290
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4961832061068702
model parameter : 9887493
model size : 42.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 122.59194159507751
Epoch: 1, Steps: 32 | Train Loss: 5.440 Vali Loss: 10.614 Vali Acc: 0.214 Test Loss: 10.614 Test Acc: 0.214
Validation loss decreased (inf --> -0.213634).  Saving model ...
Epoch: 2 cost time: 121.51443147659302
Epoch: 2, Steps: 32 | Train Loss: 4.406 Vali Loss: 11.757 Vali Acc: 0.374 Test Loss: 11.757 Test Acc: 0.374
Validation loss decreased (-0.213634 --> -0.373928).  Saving model ...
Epoch: 3 cost time: 122.36814069747925
Epoch: 3, Steps: 32 | Train Loss: 3.009 Vali Loss: 19.176 Vali Acc: 0.328 Test Loss: 19.176 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 122.11946821212769
Epoch: 4, Steps: 32 | Train Loss: 8.842 Vali Loss: 18.273 Vali Acc: 0.534 Test Loss: 18.273 Test Acc: 0.534
Validation loss decreased (-0.373928 --> -0.534168).  Saving model ...
Epoch: 5 cost time: 121.79646921157837
Epoch: 5, Steps: 32 | Train Loss: 3.888 Vali Loss: 37.431 Vali Acc: 0.420 Test Loss: 37.431 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 121.0483033657074
Epoch: 6, Steps: 32 | Train Loss: 4.154 Vali Loss: 36.287 Vali Acc: 0.527 Test Loss: 36.287 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 122.32817888259888
Epoch: 7, Steps: 32 | Train Loss: 2.626 Vali Loss: 35.721 Vali Acc: 0.496 Test Loss: 35.721 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 121.56313133239746
Epoch: 8, Steps: 32 | Train Loss: 4.738 Vali Loss: 60.625 Vali Acc: 0.267 Test Loss: 60.625 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 122.57365131378174
Epoch: 9, Steps: 32 | Train Loss: 6.624 Vali Loss: 60.046 Vali Acc: 0.534 Test Loss: 60.046 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 120.82768154144287
Epoch: 10, Steps: 32 | Train Loss: 6.511 Vali Loss: 76.876 Vali Acc: 0.366 Test Loss: 76.876 Test Acc: 0.366
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 121.3961386680603
Epoch: 11, Steps: 32 | Train Loss: 14.311 Vali Loss: 86.197 Vali Acc: 0.305 Test Loss: 86.197 Test Acc: 0.305
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 121.49861860275269
Epoch: 12, Steps: 32 | Train Loss: 9.819 Vali Loss: 92.292 Vali Acc: 0.473 Test Loss: 92.292 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 121.78586173057556
Epoch: 13, Steps: 32 | Train Loss: 6.852 Vali Loss: 60.635 Vali Acc: 0.511 Test Loss: 60.635 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 120.42288875579834
Epoch: 14, Steps: 32 | Train Loss: 4.155 Vali Loss: 73.082 Vali Acc: 0.420 Test Loss: 73.082 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 19817349
model size : 80.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 57.05341625213623
Epoch: 1, Steps: 32 | Train Loss: 6.739 Vali Loss: 9.296 Vali Acc: 0.466 Test Loss: 9.296 Test Acc: 0.466
Validation loss decreased (inf --> -0.465556).  Saving model ...
Epoch: 2 cost time: 56.409164905548096
Epoch: 2, Steps: 32 | Train Loss: 6.029 Vali Loss: 9.957 Vali Acc: 0.374 Test Loss: 9.957 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 56.226847887039185
Epoch: 3, Steps: 32 | Train Loss: 6.766 Vali Loss: 18.846 Vali Acc: 0.328 Test Loss: 18.846 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 56.372780561447144
Epoch: 4, Steps: 32 | Train Loss: 3.915 Vali Loss: 28.369 Vali Acc: 0.198 Test Loss: 28.369 Test Acc: 0.198
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 55.78148627281189
Epoch: 5, Steps: 32 | Train Loss: 3.827 Vali Loss: 23.395 Vali Acc: 0.450 Test Loss: 23.395 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 56.134347438812256
Epoch: 6, Steps: 32 | Train Loss: 2.011 Vali Loss: 43.207 Vali Acc: 0.405 Test Loss: 43.207 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 55.377963066101074
Epoch: 7, Steps: 32 | Train Loss: 2.650 Vali Loss: 60.618 Vali Acc: 0.252 Test Loss: 60.618 Test Acc: 0.252
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 55.90053963661194
Epoch: 8, Steps: 32 | Train Loss: 3.189 Vali Loss: 68.695 Vali Acc: 0.206 Test Loss: 68.695 Test Acc: 0.206
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 55.87674689292908
Epoch: 9, Steps: 32 | Train Loss: 3.752 Vali Loss: 45.377 Vali Acc: 0.397 Test Loss: 45.377 Test Acc: 0.397
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 56.00906443595886
Epoch: 10, Steps: 32 | Train Loss: 6.653 Vali Loss: 60.024 Vali Acc: 0.534 Test Loss: 60.024 Test Acc: 0.534
Validation loss decreased (-0.465556 --> -0.533751).  Saving model ...
Epoch: 11 cost time: 55.68844246864319
Epoch: 11, Steps: 32 | Train Loss: 1.975 Vali Loss: 67.290 Vali Acc: 0.321 Test Loss: 67.290 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 55.410930156707764
Epoch: 12, Steps: 32 | Train Loss: 0.585 Vali Loss: 82.147 Vali Acc: 0.221 Test Loss: 82.147 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 55.51529788970947
Epoch: 13, Steps: 32 | Train Loss: 1.615 Vali Loss: 51.681 Vali Acc: 0.527 Test Loss: 51.681 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 55.609498500823975
Epoch: 14, Steps: 32 | Train Loss: 7.528 Vali Loss: 70.605 Vali Acc: 0.344 Test Loss: 70.605 Test Acc: 0.344
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 55.268001079559326
Epoch: 15, Steps: 32 | Train Loss: 3.818 Vali Loss: 71.855 Vali Acc: 0.557 Test Loss: 71.855 Test Acc: 0.557
Validation loss decreased (-0.533751 --> -0.556533).  Saving model ...
Epoch: 16 cost time: 56.07148027420044
Epoch: 16, Steps: 32 | Train Loss: 7.550 Vali Loss: 116.279 Vali Acc: 0.336 Test Loss: 116.279 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 55.977028608322144
Epoch: 17, Steps: 32 | Train Loss: 1.148 Vali Loss: 72.464 Vali Acc: 0.443 Test Loss: 72.464 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 56.176204681396484
Epoch: 18, Steps: 32 | Train Loss: 0.073 Vali Loss: 114.816 Vali Acc: 0.282 Test Loss: 114.816 Test Acc: 0.282
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 55.66900610923767
Epoch: 19, Steps: 32 | Train Loss: 0.302 Vali Loss: 65.627 Vali Acc: 0.397 Test Loss: 65.627 Test Acc: 0.397
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 56.031171560287476
Epoch: 20, Steps: 32 | Train Loss: 3.401 Vali Loss: 104.072 Vali Acc: 0.336 Test Loss: 104.072 Test Acc: 0.336
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 55.728094816207886
Epoch: 21, Steps: 32 | Train Loss: 3.556 Vali Loss: 110.083 Vali Acc: 0.275 Test Loss: 110.083 Test Acc: 0.275
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 56.41217875480652
Epoch: 22, Steps: 32 | Train Loss: 3.490 Vali Loss: 100.183 Vali Acc: 0.382 Test Loss: 100.183 Test Acc: 0.382
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 56.10018730163574
Epoch: 23, Steps: 32 | Train Loss: 3.762 Vali Loss: 165.960 Vali Acc: 0.496 Test Loss: 165.960 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 55.56668138504028
Epoch: 24, Steps: 32 | Train Loss: 5.111 Vali Loss: 103.994 Vali Acc: 0.481 Test Loss: 103.994 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 56.26982092857361
Epoch: 25, Steps: 32 | Train Loss: 5.895 Vali Loss: 111.611 Vali Acc: 0.427 Test Loss: 111.611 Test Acc: 0.427
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 9887493
model size : 42.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 76.9270920753479
Epoch: 1, Steps: 32 | Train Loss: 5.271 Vali Loss: 9.244 Vali Acc: 0.229 Test Loss: 9.244 Test Acc: 0.229
Validation loss decreased (inf --> -0.228915).  Saving model ...
Epoch: 2 cost time: 76.31807327270508
Epoch: 2, Steps: 32 | Train Loss: 5.992 Vali Loss: 10.939 Vali Acc: 0.275 Test Loss: 10.939 Test Acc: 0.275
Validation loss decreased (-0.228915 --> -0.274700).  Saving model ...
Epoch: 3 cost time: 76.4298882484436
Epoch: 3, Steps: 32 | Train Loss: 4.843 Vali Loss: 19.032 Vali Acc: 0.496 Test Loss: 19.032 Test Acc: 0.496
Validation loss decreased (-0.274700 --> -0.495993).  Saving model ...
Epoch: 4 cost time: 75.7762815952301
Epoch: 4, Steps: 32 | Train Loss: 6.223 Vali Loss: 21.725 Vali Acc: 0.504 Test Loss: 21.725 Test Acc: 0.504
Validation loss decreased (-0.495993 --> -0.503600).  Saving model ...
Epoch: 5 cost time: 75.92147207260132
Epoch: 5, Steps: 32 | Train Loss: 3.513 Vali Loss: 26.057 Vali Acc: 0.550 Test Loss: 26.057 Test Acc: 0.550
Validation loss decreased (-0.503600 --> -0.549358).  Saving model ...
Epoch: 6 cost time: 75.57423210144043
Epoch: 6, Steps: 32 | Train Loss: 0.566 Vali Loss: 22.345 Vali Acc: 0.595 Test Loss: 22.345 Test Acc: 0.595
Validation loss decreased (-0.549358 --> -0.595196).  Saving model ...
Epoch: 7 cost time: 75.08423113822937
Epoch: 7, Steps: 32 | Train Loss: 0.837 Vali Loss: 27.020 Vali Acc: 0.359 Test Loss: 27.020 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 75.86096358299255
Epoch: 8, Steps: 32 | Train Loss: 2.544 Vali Loss: 64.530 Vali Acc: 0.214 Test Loss: 64.530 Test Acc: 0.214
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 75.28284978866577
Epoch: 9, Steps: 32 | Train Loss: 2.710 Vali Loss: 42.200 Vali Acc: 0.496 Test Loss: 42.200 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 75.34386706352234
Epoch: 10, Steps: 32 | Train Loss: 2.875 Vali Loss: 35.028 Vali Acc: 0.427 Test Loss: 35.028 Test Acc: 0.427
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 75.0407965183258
Epoch: 11, Steps: 32 | Train Loss: 8.778 Vali Loss: 28.585 Vali Acc: 0.557 Test Loss: 28.585 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 74.90259861946106
Epoch: 12, Steps: 32 | Train Loss: 6.340 Vali Loss: 72.707 Vali Acc: 0.298 Test Loss: 72.707 Test Acc: 0.298
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 74.66335272789001
Epoch: 13, Steps: 32 | Train Loss: 9.114 Vali Loss: 87.507 Vali Acc: 0.550 Test Loss: 87.507 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 74.96316814422607
Epoch: 14, Steps: 32 | Train Loss: 3.744 Vali Loss: 88.097 Vali Acc: 0.412 Test Loss: 88.097 Test Acc: 0.412
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 74.87452435493469
Epoch: 15, Steps: 32 | Train Loss: 6.823 Vali Loss: 115.942 Vali Acc: 0.267 Test Loss: 115.942 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 74.8739264011383
Epoch: 16, Steps: 32 | Train Loss: 5.222 Vali Loss: 123.178 Vali Acc: 0.244 Test Loss: 123.178 Test Acc: 0.244
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5954198473282443
model parameter : 19817349
model size : 80.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 38.92702102661133
Epoch: 1, Steps: 32 | Train Loss: 9.378 Vali Loss: 13.872 Vali Acc: 0.229 Test Loss: 13.872 Test Acc: 0.229
Validation loss decreased (inf --> -0.228869).  Saving model ...
Epoch: 2 cost time: 38.688183546066284
Epoch: 2, Steps: 32 | Train Loss: 5.309 Vali Loss: 8.870 Vali Acc: 0.557 Test Loss: 8.870 Test Acc: 0.557
Validation loss decreased (-0.228869 --> -0.557163).  Saving model ...
Epoch: 3 cost time: 38.35609030723572
Epoch: 3, Steps: 32 | Train Loss: 3.990 Vali Loss: 31.201 Vali Acc: 0.519 Test Loss: 31.201 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 38.21372747421265
Epoch: 4, Steps: 32 | Train Loss: 8.482 Vali Loss: 17.019 Vali Acc: 0.511 Test Loss: 17.019 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 38.106977462768555
Epoch: 5, Steps: 32 | Train Loss: 0.986 Vali Loss: 29.280 Vali Acc: 0.389 Test Loss: 29.280 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 37.79776906967163
Epoch: 6, Steps: 32 | Train Loss: 2.925 Vali Loss: 57.382 Vali Acc: 0.305 Test Loss: 57.382 Test Acc: 0.305
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 38.178945541381836
Epoch: 7, Steps: 32 | Train Loss: 4.846 Vali Loss: 49.407 Vali Acc: 0.244 Test Loss: 49.407 Test Acc: 0.244
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 38.084418535232544
Epoch: 8, Steps: 32 | Train Loss: 2.395 Vali Loss: 54.859 Vali Acc: 0.237 Test Loss: 54.859 Test Acc: 0.237
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 38.17113637924194
Epoch: 9, Steps: 32 | Train Loss: 4.438 Vali Loss: 67.904 Vali Acc: 0.328 Test Loss: 67.904 Test Acc: 0.328
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 38.04396390914917
Epoch: 10, Steps: 32 | Train Loss: 6.667 Vali Loss: 81.318 Vali Acc: 0.519 Test Loss: 81.318 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 37.75517463684082
Epoch: 11, Steps: 32 | Train Loss: 3.991 Vali Loss: 110.156 Vali Acc: 0.267 Test Loss: 110.156 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 38.144399881362915
Epoch: 12, Steps: 32 | Train Loss: 0.948 Vali Loss: 115.225 Vali Acc: 0.198 Test Loss: 115.225 Test Acc: 0.198
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 9887493
model size : 42.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 110.1319010257721
Epoch: 1, Steps: 32 | Train Loss: 6.168 Vali Loss: 18.211 Vali Acc: 0.153 Test Loss: 18.211 Test Acc: 0.153
Validation loss decreased (inf --> -0.152490).  Saving model ...
Epoch: 2 cost time: 108.89023733139038
Epoch: 2, Steps: 32 | Train Loss: 9.757 Vali Loss: 9.535 Vali Acc: 0.374 Test Loss: 9.535 Test Acc: 0.374
Validation loss decreased (-0.152490 --> -0.373950).  Saving model ...
Epoch: 3 cost time: 108.7666187286377
Epoch: 3, Steps: 32 | Train Loss: 3.580 Vali Loss: 28.622 Vali Acc: 0.489 Test Loss: 28.622 Test Acc: 0.489
Validation loss decreased (-0.373950 --> -0.488263).  Saving model ...
Epoch: 4 cost time: 108.65368866920471
Epoch: 4, Steps: 32 | Train Loss: 11.985 Vali Loss: 20.714 Vali Acc: 0.412 Test Loss: 20.714 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 107.7541253566742
Epoch: 5, Steps: 32 | Train Loss: 6.528 Vali Loss: 43.822 Vali Acc: 0.511 Test Loss: 43.822 Test Acc: 0.511
Validation loss decreased (-0.488263 --> -0.511012).  Saving model ...
Epoch: 6 cost time: 108.20187592506409
Epoch: 6, Steps: 32 | Train Loss: 4.923 Vali Loss: 32.045 Vali Acc: 0.328 Test Loss: 32.045 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 108.00843119621277
Epoch: 7, Steps: 32 | Train Loss: 4.226 Vali Loss: 56.178 Vali Acc: 0.565 Test Loss: 56.178 Test Acc: 0.565
Validation loss decreased (-0.511012 --> -0.564324).  Saving model ...
Epoch: 8 cost time: 107.69607448577881
Epoch: 8, Steps: 32 | Train Loss: 2.966 Vali Loss: 38.717 Vali Acc: 0.557 Test Loss: 38.717 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 107.75984525680542
Epoch: 9, Steps: 32 | Train Loss: 0.000 Vali Loss: 28.301 Vali Acc: 0.511 Test Loss: 28.301 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 108.11891579627991
Epoch: 10, Steps: 32 | Train Loss: 0.000 Vali Loss: 28.586 Vali Acc: 0.527 Test Loss: 28.586 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 107.92209649085999
Epoch: 11, Steps: 32 | Train Loss: 0.000 Vali Loss: 28.603 Vali Acc: 0.527 Test Loss: 28.603 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 107.37095618247986
Epoch: 12, Steps: 32 | Train Loss: 0.000 Vali Loss: 28.603 Vali Acc: 0.527 Test Loss: 28.603 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 107.16400456428528
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 28.603 Vali Acc: 0.527 Test Loss: 28.603 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 107.68058466911316
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 28.603 Vali Acc: 0.527 Test Loss: 28.603 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 108.04168677330017
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 28.603 Vali Acc: 0.527 Test Loss: 28.603 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 107.28357338905334
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 28.603 Vali Acc: 0.527 Test Loss: 28.603 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 109.49308824539185
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 28.603 Vali Acc: 0.527 Test Loss: 28.603 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 12787461
model size : 53.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 52.16409945487976
Epoch: 1, Steps: 32 | Train Loss: 6.544 Vali Loss: 7.575 Vali Acc: 0.527 Test Loss: 7.575 Test Acc: 0.527
Validation loss decreased (inf --> -0.526642).  Saving model ...
Epoch: 2 cost time: 51.08557105064392
Epoch: 2, Steps: 32 | Train Loss: 6.611 Vali Loss: 20.652 Vali Acc: 0.267 Test Loss: 20.652 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 51.05876874923706
Epoch: 3, Steps: 32 | Train Loss: 8.807 Vali Loss: 21.754 Vali Acc: 0.344 Test Loss: 21.754 Test Acc: 0.344
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 50.29504132270813
Epoch: 4, Steps: 32 | Train Loss: 5.592 Vali Loss: 41.804 Vali Acc: 0.206 Test Loss: 41.804 Test Acc: 0.206
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 50.55498957633972
Epoch: 5, Steps: 32 | Train Loss: 5.590 Vali Loss: 35.619 Vali Acc: 0.389 Test Loss: 35.619 Test Acc: 0.389
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 51.03992056846619
Epoch: 6, Steps: 32 | Train Loss: 1.451 Vali Loss: 36.646 Vali Acc: 0.382 Test Loss: 36.646 Test Acc: 0.382
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 51.20448541641235
Epoch: 7, Steps: 32 | Train Loss: 2.366 Vali Loss: 38.117 Vali Acc: 0.412 Test Loss: 38.117 Test Acc: 0.412
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 51.280823945999146
Epoch: 8, Steps: 32 | Train Loss: 1.784 Vali Loss: 34.803 Vali Acc: 0.511 Test Loss: 34.803 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 51.05532121658325
Epoch: 9, Steps: 32 | Train Loss: 1.921 Vali Loss: 58.922 Vali Acc: 0.282 Test Loss: 58.922 Test Acc: 0.282
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 50.90776062011719
Epoch: 10, Steps: 32 | Train Loss: 2.220 Vali Loss: 42.643 Vali Acc: 0.450 Test Loss: 42.643 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 51.318907260894775
Epoch: 11, Steps: 32 | Train Loss: 5.983 Vali Loss: 44.404 Vali Acc: 0.435 Test Loss: 44.404 Test Acc: 0.435
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 7822341
model size : 34.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 73.72519373893738
Epoch: 1, Steps: 32 | Train Loss: 6.283 Vali Loss: 19.173 Vali Acc: 0.153 Test Loss: 19.173 Test Acc: 0.153
Validation loss decreased (inf --> -0.152480).  Saving model ...
Epoch: 2 cost time: 71.94372487068176
Epoch: 2, Steps: 32 | Train Loss: 12.106 Vali Loss: 10.440 Vali Acc: 0.351 Test Loss: 10.440 Test Acc: 0.351
Validation loss decreased (-0.152480 --> -0.351041).  Saving model ...
Epoch: 3 cost time: 72.81675958633423
Epoch: 3, Steps: 32 | Train Loss: 4.566 Vali Loss: 22.003 Vali Acc: 0.580 Test Loss: 22.003 Test Acc: 0.580
Validation loss decreased (-0.351041 --> -0.579933).  Saving model ...
Epoch: 4 cost time: 73.20047497749329
Epoch: 4, Steps: 32 | Train Loss: 1.777 Vali Loss: 23.540 Vali Acc: 0.313 Test Loss: 23.540 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 72.67776393890381
Epoch: 5, Steps: 32 | Train Loss: 5.110 Vali Loss: 48.022 Vali Acc: 0.443 Test Loss: 48.022 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 72.4898054599762
Epoch: 6, Steps: 32 | Train Loss: 7.993 Vali Loss: 66.403 Vali Acc: 0.237 Test Loss: 66.403 Test Acc: 0.237
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 72.5817060470581
Epoch: 7, Steps: 32 | Train Loss: 4.916 Vali Loss: 59.821 Vali Acc: 0.550 Test Loss: 59.821 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 72.59497499465942
Epoch: 8, Steps: 32 | Train Loss: 1.206 Vali Loss: 61.601 Vali Acc: 0.466 Test Loss: 61.601 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 72.2317247390747
Epoch: 9, Steps: 32 | Train Loss: 1.224 Vali Loss: 70.758 Vali Acc: 0.519 Test Loss: 70.758 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 72.21099829673767
Epoch: 10, Steps: 32 | Train Loss: 2.618 Vali Loss: 74.249 Vali Acc: 0.534 Test Loss: 74.249 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 72.89819812774658
Epoch: 11, Steps: 32 | Train Loss: 2.993 Vali Loss: 98.507 Vali Acc: 0.542 Test Loss: 98.507 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 72.47040033340454
Epoch: 12, Steps: 32 | Train Loss: 1.653 Vali Loss: 72.104 Vali Acc: 0.550 Test Loss: 72.104 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 72.74120712280273
Epoch: 13, Steps: 32 | Train Loss: 0.151 Vali Loss: 55.669 Vali Acc: 0.550 Test Loss: 55.669 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 12787461
model size : 53.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 36.01253390312195
Epoch: 1, Steps: 32 | Train Loss: 6.697 Vali Loss: 9.853 Vali Acc: 0.473 Test Loss: 9.853 Test Acc: 0.473
Validation loss decreased (inf --> -0.473184).  Saving model ...
Epoch: 2 cost time: 35.81478023529053
Epoch: 2, Steps: 32 | Train Loss: 4.540 Vali Loss: 12.690 Vali Acc: 0.305 Test Loss: 12.690 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 35.35865044593811
Epoch: 3, Steps: 32 | Train Loss: 6.149 Vali Loss: 13.163 Vali Acc: 0.466 Test Loss: 13.163 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 35.56745648384094
Epoch: 4, Steps: 32 | Train Loss: 3.682 Vali Loss: 19.125 Vali Acc: 0.450 Test Loss: 19.125 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 35.8855185508728
Epoch: 5, Steps: 32 | Train Loss: 3.480 Vali Loss: 25.124 Vali Acc: 0.443 Test Loss: 25.124 Test Acc: 0.443
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 35.67697477340698
Epoch: 6, Steps: 32 | Train Loss: 2.266 Vali Loss: 28.075 Vali Acc: 0.580 Test Loss: 28.075 Test Acc: 0.580
Validation loss decreased (-0.473184 --> -0.579872).  Saving model ...
Epoch: 7 cost time: 35.94391870498657
Epoch: 7, Steps: 32 | Train Loss: 4.088 Vali Loss: 55.098 Vali Acc: 0.305 Test Loss: 55.098 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 35.393569231033325
Epoch: 8, Steps: 32 | Train Loss: 0.970 Vali Loss: 58.305 Vali Acc: 0.252 Test Loss: 58.305 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 35.97449064254761
Epoch: 9, Steps: 32 | Train Loss: 3.777 Vali Loss: 48.173 Vali Acc: 0.466 Test Loss: 48.173 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 35.76754641532898
Epoch: 10, Steps: 32 | Train Loss: 1.464 Vali Loss: 65.614 Vali Acc: 0.267 Test Loss: 65.614 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 35.62219476699829
Epoch: 11, Steps: 32 | Train Loss: 3.887 Vali Loss: 65.590 Vali Acc: 0.473 Test Loss: 65.590 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 35.53418493270874
Epoch: 12, Steps: 32 | Train Loss: 2.842 Vali Loss: 64.323 Vali Acc: 0.412 Test Loss: 64.323 Test Acc: 0.412
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 35.30047416687012
Epoch: 13, Steps: 32 | Train Loss: 2.504 Vali Loss: 104.432 Vali Acc: 0.359 Test Loss: 104.432 Test Acc: 0.359
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 35.89755582809448
Epoch: 14, Steps: 32 | Train Loss: 1.484 Vali Loss: 64.725 Vali Acc: 0.389 Test Loss: 64.725 Test Acc: 0.389
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 35.45884346961975
Epoch: 15, Steps: 32 | Train Loss: 3.983 Vali Loss: 85.534 Vali Acc: 0.550 Test Loss: 85.534 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 35.55825686454773
Epoch: 16, Steps: 32 | Train Loss: 2.978 Vali Loss: 108.121 Vali Acc: 0.260 Test Loss: 108.121 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 7822341
model size : 34.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 45.923264026641846
Epoch: 1, Steps: 32 | Train Loss: 6.376 Vali Loss: 21.152 Vali Acc: 0.153 Test Loss: 21.152 Test Acc: 0.153
Validation loss decreased (inf --> -0.152460).  Saving model ...
Epoch: 2 cost time: 45.32028245925903
Epoch: 2, Steps: 32 | Train Loss: 7.678 Vali Loss: 12.748 Vali Acc: 0.305 Test Loss: 12.748 Test Acc: 0.305
Validation loss decreased (-0.152460 --> -0.305216).  Saving model ...
Epoch: 3 cost time: 45.03161144256592
Epoch: 3, Steps: 32 | Train Loss: 9.364 Vali Loss: 20.825 Vali Acc: 0.565 Test Loss: 20.825 Test Acc: 0.565
Validation loss decreased (-0.305216 --> -0.564677).  Saving model ...
Epoch: 4 cost time: 45.05836367607117
Epoch: 4, Steps: 32 | Train Loss: 4.504 Vali Loss: 22.236 Vali Acc: 0.336 Test Loss: 22.236 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 44.90562033653259
Epoch: 5, Steps: 32 | Train Loss: 2.883 Vali Loss: 28.174 Vali Acc: 0.450 Test Loss: 28.174 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 44.8799307346344
Epoch: 6, Steps: 32 | Train Loss: 1.609 Vali Loss: 48.324 Vali Acc: 0.290 Test Loss: 48.324 Test Acc: 0.290
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 45.201231718063354
Epoch: 7, Steps: 32 | Train Loss: 4.615 Vali Loss: 58.046 Vali Acc: 0.519 Test Loss: 58.046 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 44.61100435256958
Epoch: 8, Steps: 32 | Train Loss: 4.927 Vali Loss: 39.404 Vali Acc: 0.481 Test Loss: 39.404 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 44.71178150177002
Epoch: 9, Steps: 32 | Train Loss: 2.221 Vali Loss: 51.634 Vali Acc: 0.573 Test Loss: 51.634 Test Acc: 0.573
Validation loss decreased (-0.564677 --> -0.572003).  Saving model ...
Epoch: 10 cost time: 44.51160407066345
Epoch: 10, Steps: 32 | Train Loss: 3.781 Vali Loss: 49.386 Vali Acc: 0.389 Test Loss: 49.386 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 43.883095026016235
Epoch: 11, Steps: 32 | Train Loss: 0.142 Vali Loss: 60.234 Vali Acc: 0.366 Test Loss: 60.234 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 44.416741132736206
Epoch: 12, Steps: 32 | Train Loss: 0.825 Vali Loss: 39.736 Vali Acc: 0.458 Test Loss: 39.736 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 44.33344888687134
Epoch: 13, Steps: 32 | Train Loss: 1.073 Vali Loss: 50.214 Vali Acc: 0.603 Test Loss: 50.214 Test Acc: 0.603
Validation loss decreased (-0.572003 --> -0.602551).  Saving model ...
Epoch: 14 cost time: 44.806808948516846
Epoch: 14, Steps: 32 | Train Loss: 1.594 Vali Loss: 74.031 Vali Acc: 0.565 Test Loss: 74.031 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 44.649004220962524
Epoch: 15, Steps: 32 | Train Loss: 4.690 Vali Loss: 55.946 Vali Acc: 0.496 Test Loss: 55.946 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 44.61882019042969
Epoch: 16, Steps: 32 | Train Loss: 6.144 Vali Loss: 62.400 Vali Acc: 0.420 Test Loss: 62.400 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 44.779887199401855
Epoch: 17, Steps: 32 | Train Loss: 6.875 Vali Loss: 125.212 Vali Acc: 0.527 Test Loss: 125.212 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 44.72932171821594
Epoch: 18, Steps: 32 | Train Loss: 5.413 Vali Loss: 87.320 Vali Acc: 0.573 Test Loss: 87.320 Test Acc: 0.573
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 44.68104839324951
Epoch: 19, Steps: 32 | Train Loss: 2.265 Vali Loss: 90.816 Vali Acc: 0.443 Test Loss: 90.816 Test Acc: 0.443
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 44.62015438079834
Epoch: 20, Steps: 32 | Train Loss: 7.559 Vali Loss: 132.666 Vali Acc: 0.313 Test Loss: 132.666 Test Acc: 0.313
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 44.510292291641235
Epoch: 21, Steps: 32 | Train Loss: 8.673 Vali Loss: 172.966 Vali Acc: 0.282 Test Loss: 172.966 Test Acc: 0.282
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 44.35487985610962
Epoch: 22, Steps: 32 | Train Loss: 5.679 Vali Loss: 170.591 Vali Acc: 0.282 Test Loss: 170.591 Test Acc: 0.282
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 44.70189809799194
Epoch: 23, Steps: 32 | Train Loss: 3.914 Vali Loss: 86.348 Vali Acc: 0.534 Test Loss: 86.348 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6030534351145038
model parameter : 12787461
model size : 53.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 25.122347831726074
Epoch: 1, Steps: 32 | Train Loss: 6.765 Vali Loss: 10.194 Vali Acc: 0.481 Test Loss: 10.194 Test Acc: 0.481
Validation loss decreased (inf --> -0.480814).  Saving model ...
Epoch: 2 cost time: 24.140183448791504
Epoch: 2, Steps: 32 | Train Loss: 6.955 Vali Loss: 35.342 Vali Acc: 0.198 Test Loss: 35.342 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 24.239289045333862
Epoch: 3, Steps: 32 | Train Loss: 9.621 Vali Loss: 16.985 Vali Acc: 0.557 Test Loss: 16.985 Test Acc: 0.557
Validation loss decreased (-0.480814 --> -0.557082).  Saving model ...
Epoch: 4 cost time: 24.155585527420044
Epoch: 4, Steps: 32 | Train Loss: 4.206 Vali Loss: 21.325 Vali Acc: 0.573 Test Loss: 21.325 Test Acc: 0.573
Validation loss decreased (-0.557082 --> -0.572306).  Saving model ...
Epoch: 5 cost time: 24.35167670249939
Epoch: 5, Steps: 32 | Train Loss: 4.580 Vali Loss: 23.825 Vali Acc: 0.511 Test Loss: 23.825 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 24.250933170318604
Epoch: 6, Steps: 32 | Train Loss: 2.805 Vali Loss: 45.472 Vali Acc: 0.351 Test Loss: 45.472 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 24.293912887573242
Epoch: 7, Steps: 32 | Train Loss: 1.519 Vali Loss: 25.912 Vali Acc: 0.550 Test Loss: 25.912 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 24.07870054244995
Epoch: 8, Steps: 32 | Train Loss: 2.143 Vali Loss: 40.697 Vali Acc: 0.336 Test Loss: 40.697 Test Acc: 0.336
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 24.314775466918945
Epoch: 9, Steps: 32 | Train Loss: 5.980 Vali Loss: 39.565 Vali Acc: 0.542 Test Loss: 39.565 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 24.112160682678223
Epoch: 10, Steps: 32 | Train Loss: 3.462 Vali Loss: 68.585 Vali Acc: 0.374 Test Loss: 68.585 Test Acc: 0.374
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 24.20098567008972
Epoch: 11, Steps: 32 | Train Loss: 4.013 Vali Loss: 48.417 Vali Acc: 0.557 Test Loss: 48.417 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 24.322166442871094
Epoch: 12, Steps: 32 | Train Loss: 4.775 Vali Loss: 73.090 Vali Acc: 0.389 Test Loss: 73.090 Test Acc: 0.389
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 24.39416193962097
Epoch: 13, Steps: 32 | Train Loss: 8.562 Vali Loss: 87.912 Vali Acc: 0.573 Test Loss: 87.912 Test Acc: 0.573
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 24.18608283996582
Epoch: 14, Steps: 32 | Train Loss: 5.346 Vali Loss: 52.394 Vali Acc: 0.519 Test Loss: 52.394 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 7822341
model size : 34.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 111.72996997833252
Epoch: 1, Steps: 32 | Train Loss: 3.405 Vali Loss: 5.895 Vali Acc: 0.496 Test Loss: 5.895 Test Acc: 0.496
Validation loss decreased (inf --> -0.496124).  Saving model ...
Epoch: 2 cost time: 110.5358464717865
Epoch: 2, Steps: 32 | Train Loss: 1.706 Vali Loss: 4.954 Vali Acc: 0.450 Test Loss: 4.954 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 110.91808080673218
Epoch: 3, Steps: 32 | Train Loss: 1.619 Vali Loss: 10.147 Vali Acc: 0.389 Test Loss: 10.147 Test Acc: 0.389
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 109.69385838508606
Epoch: 4, Steps: 32 | Train Loss: 1.980 Vali Loss: 11.398 Vali Acc: 0.351 Test Loss: 11.398 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 108.92601323127747
Epoch: 5, Steps: 32 | Train Loss: 1.442 Vali Loss: 12.779 Vali Acc: 0.435 Test Loss: 12.779 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 110.09067678451538
Epoch: 6, Steps: 32 | Train Loss: 2.329 Vali Loss: 44.190 Vali Acc: 0.473 Test Loss: 44.190 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 108.81202745437622
Epoch: 7, Steps: 32 | Train Loss: 3.077 Vali Loss: 25.551 Vali Acc: 0.466 Test Loss: 25.551 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 109.50459504127502
Epoch: 8, Steps: 32 | Train Loss: 1.223 Vali Loss: 23.052 Vali Acc: 0.450 Test Loss: 23.052 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 108.13101029396057
Epoch: 9, Steps: 32 | Train Loss: 3.011 Vali Loss: 26.058 Vali Acc: 0.511 Test Loss: 26.058 Test Acc: 0.511
Validation loss decreased (-0.496124 --> -0.511190).  Saving model ...
Epoch: 10 cost time: 108.9207911491394
Epoch: 10, Steps: 32 | Train Loss: 1.913 Vali Loss: 35.428 Vali Acc: 0.420 Test Loss: 35.428 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 108.66070365905762
Epoch: 11, Steps: 32 | Train Loss: 1.212 Vali Loss: 24.940 Vali Acc: 0.473 Test Loss: 24.940 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 109.07010841369629
Epoch: 12, Steps: 32 | Train Loss: 0.438 Vali Loss: 34.642 Vali Acc: 0.382 Test Loss: 34.642 Test Acc: 0.382
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 109.17569398880005
Epoch: 13, Steps: 32 | Train Loss: 3.677 Vali Loss: 45.028 Vali Acc: 0.534 Test Loss: 45.028 Test Acc: 0.534
Validation loss decreased (-0.511190 --> -0.533901).  Saving model ...
Epoch: 14 cost time: 108.64999747276306
Epoch: 14, Steps: 32 | Train Loss: 1.944 Vali Loss: 39.349 Vali Acc: 0.542 Test Loss: 39.349 Test Acc: 0.542
Validation loss decreased (-0.533901 --> -0.541591).  Saving model ...
Epoch: 15 cost time: 107.2996609210968
Epoch: 15, Steps: 32 | Train Loss: 2.933 Vali Loss: 52.274 Vali Acc: 0.504 Test Loss: 52.274 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 108.65453696250916
Epoch: 16, Steps: 32 | Train Loss: 2.237 Vali Loss: 46.894 Vali Acc: 0.420 Test Loss: 46.894 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 107.73375535011292
Epoch: 17, Steps: 32 | Train Loss: 1.842 Vali Loss: 36.138 Vali Acc: 0.427 Test Loss: 36.138 Test Acc: 0.427
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 109.7373435497284
Epoch: 18, Steps: 32 | Train Loss: 1.135 Vali Loss: 40.720 Vali Acc: 0.290 Test Loss: 40.720 Test Acc: 0.290
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 108.9512186050415
Epoch: 19, Steps: 32 | Train Loss: 1.703 Vali Loss: 42.813 Vali Acc: 0.351 Test Loss: 42.813 Test Acc: 0.351
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 108.02652788162231
Epoch: 20, Steps: 32 | Train Loss: 3.043 Vali Loss: 58.205 Vali Acc: 0.458 Test Loss: 58.205 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 107.83787178993225
Epoch: 21, Steps: 32 | Train Loss: 3.970 Vali Loss: 93.279 Vali Acc: 0.405 Test Loss: 93.279 Test Acc: 0.405
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 108.33107781410217
Epoch: 22, Steps: 32 | Train Loss: 4.692 Vali Loss: 42.687 Vali Acc: 0.450 Test Loss: 42.687 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 108.6389377117157
Epoch: 23, Steps: 32 | Train Loss: 1.817 Vali Loss: 60.684 Vali Acc: 0.534 Test Loss: 60.684 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 108.19874548912048
Epoch: 24, Steps: 32 | Train Loss: 6.994 Vali Loss: 56.095 Vali Acc: 0.511 Test Loss: 56.095 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 9909829
model size : 40.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 56.02529191970825
Epoch: 1, Steps: 32 | Train Loss: 3.526 Vali Loss: 3.966 Vali Acc: 0.237 Test Loss: 3.966 Test Acc: 0.237
Validation loss decreased (inf --> -0.236602).  Saving model ...
Epoch: 2 cost time: 54.70775294303894
Epoch: 2, Steps: 32 | Train Loss: 1.348 Vali Loss: 6.991 Vali Acc: 0.527 Test Loss: 6.991 Test Acc: 0.527
Validation loss decreased (-0.236602 --> -0.526648).  Saving model ...
Epoch: 3 cost time: 54.409363985061646
Epoch: 3, Steps: 32 | Train Loss: 3.042 Vali Loss: 11.457 Vali Acc: 0.481 Test Loss: 11.457 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 54.6841766834259
Epoch: 4, Steps: 32 | Train Loss: 1.695 Vali Loss: 13.088 Vali Acc: 0.420 Test Loss: 13.088 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 54.772308588027954
Epoch: 5, Steps: 32 | Train Loss: 2.882 Vali Loss: 16.613 Vali Acc: 0.489 Test Loss: 16.613 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 54.05611991882324
Epoch: 6, Steps: 32 | Train Loss: 1.533 Vali Loss: 24.565 Vali Acc: 0.458 Test Loss: 24.565 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 54.317261934280396
Epoch: 7, Steps: 32 | Train Loss: 2.542 Vali Loss: 14.711 Vali Acc: 0.557 Test Loss: 14.711 Test Acc: 0.557
Validation loss decreased (-0.526648 --> -0.557105).  Saving model ...
Epoch: 8 cost time: 53.898982763290405
Epoch: 8, Steps: 32 | Train Loss: 5.920 Vali Loss: 27.541 Vali Acc: 0.550 Test Loss: 27.541 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 54.856847524642944
Epoch: 9, Steps: 32 | Train Loss: 1.166 Vali Loss: 44.842 Vali Acc: 0.534 Test Loss: 44.842 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 54.289939165115356
Epoch: 10, Steps: 32 | Train Loss: 0.490 Vali Loss: 32.035 Vali Acc: 0.473 Test Loss: 32.035 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 53.813920974731445
Epoch: 11, Steps: 32 | Train Loss: 1.067 Vali Loss: 20.530 Vali Acc: 0.565 Test Loss: 20.530 Test Acc: 0.565
Validation loss decreased (-0.557105 --> -0.564680).  Saving model ...
Epoch: 12 cost time: 54.049604177474976
Epoch: 12, Steps: 32 | Train Loss: 0.814 Vali Loss: 23.552 Vali Acc: 0.527 Test Loss: 23.552 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 53.66247773170471
Epoch: 13, Steps: 32 | Train Loss: 0.388 Vali Loss: 24.419 Vali Acc: 0.527 Test Loss: 24.419 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 53.653594732284546
Epoch: 14, Steps: 32 | Train Loss: 3.015 Vali Loss: 45.608 Vali Acc: 0.519 Test Loss: 45.608 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 53.18340611457825
Epoch: 15, Steps: 32 | Train Loss: 6.634 Vali Loss: 45.210 Vali Acc: 0.412 Test Loss: 45.210 Test Acc: 0.412
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 52.73315930366516
Epoch: 16, Steps: 32 | Train Loss: 1.926 Vali Loss: 48.704 Vali Acc: 0.328 Test Loss: 48.704 Test Acc: 0.328
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 52.58553171157837
Epoch: 17, Steps: 32 | Train Loss: 5.683 Vali Loss: 35.886 Vali Acc: 0.504 Test Loss: 35.886 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 53.3603515625
Epoch: 18, Steps: 32 | Train Loss: 1.432 Vali Loss: 48.338 Vali Acc: 0.328 Test Loss: 48.338 Test Acc: 0.328
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 53.56892228126526
Epoch: 19, Steps: 32 | Train Loss: 0.775 Vali Loss: 33.400 Vali Acc: 0.450 Test Loss: 33.400 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 53.75898766517639
Epoch: 20, Steps: 32 | Train Loss: 0.390 Vali Loss: 54.264 Vali Acc: 0.534 Test Loss: 54.264 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 53.29992318153381
Epoch: 21, Steps: 32 | Train Loss: 1.241 Vali Loss: 72.748 Vali Acc: 0.565 Test Loss: 72.748 Test Acc: 0.565
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 4944517
model size : 21.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 81.92879843711853
Epoch: 1, Steps: 32 | Train Loss: 3.393 Vali Loss: 5.890 Vali Acc: 0.496 Test Loss: 5.890 Test Acc: 0.496
Validation loss decreased (inf --> -0.496124).  Saving model ...
Epoch: 2 cost time: 79.78388047218323
Epoch: 2, Steps: 32 | Train Loss: 2.234 Vali Loss: 11.030 Vali Acc: 0.221 Test Loss: 11.030 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 78.8493115901947
Epoch: 3, Steps: 32 | Train Loss: 0.832 Vali Loss: 5.742 Vali Acc: 0.511 Test Loss: 5.742 Test Acc: 0.511
Validation loss decreased (-0.496124 --> -0.511393).  Saving model ...
Epoch: 4 cost time: 79.43765020370483
Epoch: 4, Steps: 32 | Train Loss: 2.172 Vali Loss: 12.904 Vali Acc: 0.359 Test Loss: 12.904 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 78.3928804397583
Epoch: 5, Steps: 32 | Train Loss: 2.712 Vali Loss: 10.755 Vali Acc: 0.603 Test Loss: 10.755 Test Acc: 0.603
Validation loss decreased (-0.511393 --> -0.602946).  Saving model ...
Epoch: 6 cost time: 78.90052032470703
Epoch: 6, Steps: 32 | Train Loss: 0.829 Vali Loss: 28.828 Vali Acc: 0.450 Test Loss: 28.828 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 78.63904762268066
Epoch: 7, Steps: 32 | Train Loss: 5.576 Vali Loss: 20.796 Vali Acc: 0.382 Test Loss: 20.796 Test Acc: 0.382
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 78.1626467704773
Epoch: 8, Steps: 32 | Train Loss: 0.837 Vali Loss: 14.995 Vali Acc: 0.427 Test Loss: 14.995 Test Acc: 0.427
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 77.75595545768738
Epoch: 9, Steps: 32 | Train Loss: 2.079 Vali Loss: 15.423 Vali Acc: 0.519 Test Loss: 15.423 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 77.94851422309875
Epoch: 10, Steps: 32 | Train Loss: 2.927 Vali Loss: 26.258 Vali Acc: 0.466 Test Loss: 26.258 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 79.21271276473999
Epoch: 11, Steps: 32 | Train Loss: 2.338 Vali Loss: 50.813 Vali Acc: 0.328 Test Loss: 50.813 Test Acc: 0.328
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 78.63344931602478
Epoch: 12, Steps: 32 | Train Loss: 3.109 Vali Loss: 41.377 Vali Acc: 0.389 Test Loss: 41.377 Test Acc: 0.389
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 78.4793770313263
Epoch: 13, Steps: 32 | Train Loss: 2.220 Vali Loss: 29.655 Vali Acc: 0.496 Test Loss: 29.655 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 78.26477384567261
Epoch: 14, Steps: 32 | Train Loss: 4.507 Vali Loss: 35.600 Vali Acc: 0.481 Test Loss: 35.600 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 77.28559041023254
Epoch: 15, Steps: 32 | Train Loss: 2.573 Vali Loss: 34.155 Vali Acc: 0.336 Test Loss: 34.155 Test Acc: 0.336
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6030534351145038
model parameter : 9909829
model size : 40.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 42.389724016189575
Epoch: 1, Steps: 32 | Train Loss: 3.503 Vali Loss: 4.521 Vali Acc: 0.237 Test Loss: 4.521 Test Acc: 0.237
Validation loss decreased (inf --> -0.236596).  Saving model ...
Epoch: 2 cost time: 42.04885983467102
Epoch: 2, Steps: 32 | Train Loss: 2.385 Vali Loss: 6.444 Vali Acc: 0.504 Test Loss: 6.444 Test Acc: 0.504
Validation loss decreased (-0.236596 --> -0.503752).  Saving model ...
Epoch: 3 cost time: 41.23172879219055
Epoch: 3, Steps: 32 | Train Loss: 2.902 Vali Loss: 10.579 Vali Acc: 0.466 Test Loss: 10.579 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 41.556928873062134
Epoch: 4, Steps: 32 | Train Loss: 1.100 Vali Loss: 9.879 Vali Acc: 0.450 Test Loss: 9.879 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 41.40480327606201
Epoch: 5, Steps: 32 | Train Loss: 1.081 Vali Loss: 12.930 Vali Acc: 0.481 Test Loss: 12.930 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 40.88206100463867
Epoch: 6, Steps: 32 | Train Loss: 4.162 Vali Loss: 23.231 Vali Acc: 0.527 Test Loss: 23.231 Test Acc: 0.527
Validation loss decreased (-0.503752 --> -0.526485).  Saving model ...
Epoch: 7 cost time: 41.29736685752869
Epoch: 7, Steps: 32 | Train Loss: 3.016 Vali Loss: 22.223 Vali Acc: 0.435 Test Loss: 22.223 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 41.39468741416931
Epoch: 8, Steps: 32 | Train Loss: 7.261 Vali Loss: 44.504 Vali Acc: 0.534 Test Loss: 44.504 Test Acc: 0.534
Validation loss decreased (-0.526485 --> -0.533906).  Saving model ...
Epoch: 9 cost time: 41.18790602684021
Epoch: 9, Steps: 32 | Train Loss: 4.053 Vali Loss: 41.708 Vali Acc: 0.542 Test Loss: 41.708 Test Acc: 0.542
Validation loss decreased (-0.533906 --> -0.541568).  Saving model ...
Epoch: 10 cost time: 41.87610864639282
Epoch: 10, Steps: 32 | Train Loss: 1.130 Vali Loss: 27.109 Vali Acc: 0.504 Test Loss: 27.109 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 42.5319926738739
Epoch: 11, Steps: 32 | Train Loss: 0.761 Vali Loss: 33.608 Vali Acc: 0.573 Test Loss: 33.608 Test Acc: 0.573
Validation loss decreased (-0.541568 --> -0.572183).  Saving model ...
Epoch: 12 cost time: 41.992918491363525
Epoch: 12, Steps: 32 | Train Loss: 0.000 Vali Loss: 30.202 Vali Acc: 0.450 Test Loss: 30.202 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 41.4758996963501
Epoch: 13, Steps: 32 | Train Loss: 0.361 Vali Loss: 56.009 Vali Acc: 0.534 Test Loss: 56.009 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 41.16955542564392
Epoch: 14, Steps: 32 | Train Loss: 2.804 Vali Loss: 34.419 Vali Acc: 0.527 Test Loss: 34.419 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 40.81959128379822
Epoch: 15, Steps: 32 | Train Loss: 4.321 Vali Loss: 55.529 Vali Acc: 0.336 Test Loss: 55.529 Test Acc: 0.336
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 41.06447911262512
Epoch: 16, Steps: 32 | Train Loss: 1.416 Vali Loss: 40.194 Vali Acc: 0.504 Test Loss: 40.194 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 41.016361951828
Epoch: 17, Steps: 32 | Train Loss: 1.289 Vali Loss: 38.351 Vali Acc: 0.519 Test Loss: 38.351 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 40.85305190086365
Epoch: 18, Steps: 32 | Train Loss: 0.816 Vali Loss: 46.139 Vali Acc: 0.542 Test Loss: 46.139 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 40.84119129180908
Epoch: 19, Steps: 32 | Train Loss: 3.278 Vali Loss: 65.717 Vali Acc: 0.527 Test Loss: 65.717 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 40.6438524723053
Epoch: 20, Steps: 32 | Train Loss: 1.288 Vali Loss: 56.851 Vali Acc: 0.450 Test Loss: 56.851 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 40.57342576980591
Epoch: 21, Steps: 32 | Train Loss: 3.850 Vali Loss: 75.664 Vali Acc: 0.275 Test Loss: 75.664 Test Acc: 0.275
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 4944517
model size : 21.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 48.710369348526
Epoch: 1, Steps: 32 | Train Loss: 3.427 Vali Loss: 5.736 Vali Acc: 0.496 Test Loss: 5.736 Test Acc: 0.496
Validation loss decreased (inf --> -0.496126).  Saving model ...
Epoch: 2 cost time: 48.05841422080994
Epoch: 2, Steps: 32 | Train Loss: 1.477 Vali Loss: 6.756 Vali Acc: 0.321 Test Loss: 6.756 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 48.17102384567261
Epoch: 3, Steps: 32 | Train Loss: 2.275 Vali Loss: 11.688 Vali Acc: 0.420 Test Loss: 11.688 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 47.851465463638306
Epoch: 4, Steps: 32 | Train Loss: 3.254 Vali Loss: 17.472 Vali Acc: 0.511 Test Loss: 17.472 Test Acc: 0.511
Validation loss decreased (-0.496126 --> -0.511276).  Saving model ...
Epoch: 5 cost time: 48.05905508995056
Epoch: 5, Steps: 32 | Train Loss: 1.989 Vali Loss: 14.214 Vali Acc: 0.435 Test Loss: 14.214 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 47.973525047302246
Epoch: 6, Steps: 32 | Train Loss: 1.054 Vali Loss: 21.987 Vali Acc: 0.580 Test Loss: 21.987 Test Acc: 0.580
Validation loss decreased (-0.511276 --> -0.579933).  Saving model ...
Epoch: 7 cost time: 48.021196126937866
Epoch: 7, Steps: 32 | Train Loss: 2.756 Vali Loss: 13.270 Vali Acc: 0.550 Test Loss: 13.270 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 47.44318389892578
Epoch: 8, Steps: 32 | Train Loss: 1.966 Vali Loss: 24.905 Vali Acc: 0.557 Test Loss: 24.905 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 47.51830506324768
Epoch: 9, Steps: 32 | Train Loss: 1.526 Vali Loss: 21.298 Vali Acc: 0.489 Test Loss: 21.298 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 47.49109745025635
Epoch: 10, Steps: 32 | Train Loss: 0.796 Vali Loss: 26.401 Vali Acc: 0.397 Test Loss: 26.401 Test Acc: 0.397
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 47.50627636909485
Epoch: 11, Steps: 32 | Train Loss: 1.600 Vali Loss: 53.213 Vali Acc: 0.466 Test Loss: 53.213 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 47.64413094520569
Epoch: 12, Steps: 32 | Train Loss: 4.762 Vali Loss: 31.136 Vali Acc: 0.450 Test Loss: 31.136 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 47.55378198623657
Epoch: 13, Steps: 32 | Train Loss: 2.327 Vali Loss: 46.670 Vali Acc: 0.504 Test Loss: 46.670 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 47.37755513191223
Epoch: 14, Steps: 32 | Train Loss: 1.996 Vali Loss: 39.808 Vali Acc: 0.489 Test Loss: 39.808 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 47.267101526260376
Epoch: 15, Steps: 32 | Train Loss: 0.652 Vali Loss: 56.557 Vali Acc: 0.527 Test Loss: 56.557 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 47.28477120399475
Epoch: 16, Steps: 32 | Train Loss: 0.224 Vali Loss: 48.903 Vali Acc: 0.542 Test Loss: 48.903 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 9909829
model size : 40.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 28.682783365249634
Epoch: 1, Steps: 32 | Train Loss: 3.585 Vali Loss: 3.914 Vali Acc: 0.198 Test Loss: 3.914 Test Acc: 0.198
Validation loss decreased (inf --> -0.198434).  Saving model ...
Epoch: 2 cost time: 28.072462797164917
Epoch: 2, Steps: 32 | Train Loss: 1.962 Vali Loss: 8.026 Vali Acc: 0.450 Test Loss: 8.026 Test Acc: 0.450
Validation loss decreased (-0.198434 --> -0.450301).  Saving model ...
Epoch: 3 cost time: 27.86290168762207
Epoch: 3, Steps: 32 | Train Loss: 1.338 Vali Loss: 5.169 Vali Acc: 0.397 Test Loss: 5.169 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 28.012345552444458
Epoch: 4, Steps: 32 | Train Loss: 2.455 Vali Loss: 10.727 Vali Acc: 0.366 Test Loss: 10.727 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 27.833157777786255
Epoch: 5, Steps: 32 | Train Loss: 0.946 Vali Loss: 16.133 Vali Acc: 0.527 Test Loss: 16.133 Test Acc: 0.527
Validation loss decreased (-0.450301 --> -0.526556).  Saving model ...
Epoch: 6 cost time: 27.8818142414093
Epoch: 6, Steps: 32 | Train Loss: 1.846 Vali Loss: 22.579 Vali Acc: 0.282 Test Loss: 22.579 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 28.081741094589233
Epoch: 7, Steps: 32 | Train Loss: 1.182 Vali Loss: 24.283 Vali Acc: 0.527 Test Loss: 24.283 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 27.829508543014526
Epoch: 8, Steps: 32 | Train Loss: 1.007 Vali Loss: 20.516 Vali Acc: 0.588 Test Loss: 20.516 Test Acc: 0.588
Validation loss decreased (-0.526556 --> -0.587581).  Saving model ...
Epoch: 9 cost time: 27.625113248825073
Epoch: 9, Steps: 32 | Train Loss: 1.096 Vali Loss: 30.158 Vali Acc: 0.542 Test Loss: 30.158 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 28.025965452194214
Epoch: 10, Steps: 32 | Train Loss: 4.131 Vali Loss: 41.878 Vali Acc: 0.244 Test Loss: 41.878 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 27.10828185081482
Epoch: 11, Steps: 32 | Train Loss: 1.834 Vali Loss: 30.397 Vali Acc: 0.504 Test Loss: 30.397 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 27.680739879608154
Epoch: 12, Steps: 32 | Train Loss: 1.794 Vali Loss: 42.245 Vali Acc: 0.328 Test Loss: 42.245 Test Acc: 0.328
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 27.977319478988647
Epoch: 13, Steps: 32 | Train Loss: 1.465 Vali Loss: 34.875 Vali Acc: 0.344 Test Loss: 34.875 Test Acc: 0.344
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 28.022237300872803
Epoch: 14, Steps: 32 | Train Loss: 0.020 Vali Loss: 38.867 Vali Acc: 0.282 Test Loss: 38.867 Test Acc: 0.282
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 27.67265796661377
Epoch: 15, Steps: 32 | Train Loss: 0.378 Vali Loss: 40.570 Vali Acc: 0.359 Test Loss: 40.570 Test Acc: 0.359
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 27.831798315048218
Epoch: 16, Steps: 32 | Train Loss: 2.325 Vali Loss: 29.884 Vali Acc: 0.511 Test Loss: 29.884 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 27.989395141601562
Epoch: 17, Steps: 32 | Train Loss: 0.015 Vali Loss: 41.277 Vali Acc: 0.565 Test Loss: 41.277 Test Acc: 0.565
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 27.46077251434326
Epoch: 18, Steps: 32 | Train Loss: 0.293 Vali Loss: 56.068 Vali Acc: 0.359 Test Loss: 56.068 Test Acc: 0.359
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 4944517
model size : 21.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 62.464614152908325
Epoch: 1, Steps: 32 | Train Loss: 4.852 Vali Loss: 9.760 Vali Acc: 0.206 Test Loss: 9.760 Test Acc: 0.206
Validation loss decreased (inf --> -0.206009).  Saving model ...
Epoch: 2 cost time: 61.49268412590027
Epoch: 2, Steps: 32 | Train Loss: 4.700 Vali Loss: 12.875 Vali Acc: 0.183 Test Loss: 12.875 Test Acc: 0.183
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 61.903284549713135
Epoch: 3, Steps: 32 | Train Loss: 2.967 Vali Loss: 8.197 Vali Acc: 0.588 Test Loss: 8.197 Test Acc: 0.588
Validation loss decreased (-0.206009 --> -0.587704).  Saving model ...
Epoch: 4 cost time: 62.17248725891113
Epoch: 4, Steps: 32 | Train Loss: 2.670 Vali Loss: 9.983 Vali Acc: 0.336 Test Loss: 9.983 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 62.540056467056274
Epoch: 5, Steps: 32 | Train Loss: 2.061 Vali Loss: 17.644 Vali Acc: 0.580 Test Loss: 17.644 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 62.46147441864014
Epoch: 6, Steps: 32 | Train Loss: 0.398 Vali Loss: 10.537 Vali Acc: 0.519 Test Loss: 10.537 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 62.080464124679565
Epoch: 7, Steps: 32 | Train Loss: 1.715 Vali Loss: 20.671 Vali Acc: 0.466 Test Loss: 20.671 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 61.80543255805969
Epoch: 8, Steps: 32 | Train Loss: 3.263 Vali Loss: 22.925 Vali Acc: 0.344 Test Loss: 22.925 Test Acc: 0.344
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 61.488354444503784
Epoch: 9, Steps: 32 | Train Loss: 0.582 Vali Loss: 21.552 Vali Acc: 0.565 Test Loss: 21.552 Test Acc: 0.565
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 61.77396202087402
Epoch: 10, Steps: 32 | Train Loss: 1.546 Vali Loss: 27.344 Vali Acc: 0.321 Test Loss: 27.344 Test Acc: 0.321
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 61.509061336517334
Epoch: 11, Steps: 32 | Train Loss: 2.411 Vali Loss: 26.595 Vali Acc: 0.595 Test Loss: 26.595 Test Acc: 0.595
Validation loss decreased (-0.587704 --> -0.595154).  Saving model ...
Epoch: 12 cost time: 61.3426456451416
Epoch: 12, Steps: 32 | Train Loss: 1.063 Vali Loss: 60.752 Vali Acc: 0.504 Test Loss: 60.752 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 61.77902412414551
Epoch: 13, Steps: 32 | Train Loss: 6.075 Vali Loss: 26.749 Vali Acc: 0.443 Test Loss: 26.749 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 61.50611686706543
Epoch: 14, Steps: 32 | Train Loss: 2.713 Vali Loss: 35.424 Vali Acc: 0.382 Test Loss: 35.424 Test Acc: 0.382
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 61.891693115234375
Epoch: 15, Steps: 32 | Train Loss: 1.564 Vali Loss: 31.261 Vali Acc: 0.412 Test Loss: 31.261 Test Acc: 0.412
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 60.94975519180298
Epoch: 16, Steps: 32 | Train Loss: 0.706 Vali Loss: 35.477 Vali Acc: 0.382 Test Loss: 35.477 Test Acc: 0.382
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 60.807204484939575
Epoch: 17, Steps: 32 | Train Loss: 0.735 Vali Loss: 47.977 Vali Acc: 0.435 Test Loss: 47.977 Test Acc: 0.435
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 61.023712158203125
Epoch: 18, Steps: 32 | Train Loss: 2.849 Vali Loss: 95.007 Vali Acc: 0.229 Test Loss: 95.007 Test Acc: 0.229
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 61.580923557281494
Epoch: 19, Steps: 32 | Train Loss: 5.543 Vali Loss: 58.938 Vali Acc: 0.290 Test Loss: 58.938 Test Acc: 0.290
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 61.572893142700195
Epoch: 20, Steps: 32 | Train Loss: 0.399 Vali Loss: 55.250 Vali Acc: 0.519 Test Loss: 55.250 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 61.92776560783386
Epoch: 21, Steps: 32 | Train Loss: 0.557 Vali Loss: 44.220 Vali Acc: 0.466 Test Loss: 44.220 Test Acc: 0.466
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5954198473282443
model parameter : 6394309
model size : 26.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 31.624600172042847
Epoch: 1, Steps: 32 | Train Loss: 6.834 Vali Loss: 3.965 Vali Acc: 0.267 Test Loss: 3.965 Test Acc: 0.267
Validation loss decreased (inf --> -0.267136).  Saving model ...
Epoch: 2 cost time: 30.900336027145386
Epoch: 2, Steps: 32 | Train Loss: 1.939 Vali Loss: 4.462 Vali Acc: 0.557 Test Loss: 4.462 Test Acc: 0.557
Validation loss decreased (-0.267136 --> -0.557207).  Saving model ...
Epoch: 3 cost time: 31.10563039779663
Epoch: 3, Steps: 32 | Train Loss: 2.071 Vali Loss: 9.599 Vali Acc: 0.527 Test Loss: 9.599 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 31.120715618133545
Epoch: 4, Steps: 32 | Train Loss: 1.817 Vali Loss: 12.304 Vali Acc: 0.573 Test Loss: 12.304 Test Acc: 0.573
Validation loss decreased (-0.557207 --> -0.572396).  Saving model ...
Epoch: 5 cost time: 30.668233633041382
Epoch: 5, Steps: 32 | Train Loss: 3.910 Vali Loss: 16.045 Vali Acc: 0.374 Test Loss: 16.045 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 30.68245244026184
Epoch: 6, Steps: 32 | Train Loss: 1.484 Vali Loss: 16.847 Vali Acc: 0.527 Test Loss: 16.847 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 30.7577486038208
Epoch: 7, Steps: 32 | Train Loss: 2.471 Vali Loss: 25.179 Vali Acc: 0.366 Test Loss: 25.179 Test Acc: 0.366
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 30.367040395736694
Epoch: 8, Steps: 32 | Train Loss: 2.864 Vali Loss: 26.781 Vali Acc: 0.557 Test Loss: 26.781 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 30.832069635391235
Epoch: 9, Steps: 32 | Train Loss: 3.960 Vali Loss: 17.531 Vali Acc: 0.542 Test Loss: 17.531 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 30.494168758392334
Epoch: 10, Steps: 32 | Train Loss: 0.736 Vali Loss: 24.178 Vali Acc: 0.550 Test Loss: 24.178 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 30.519005060195923
Epoch: 11, Steps: 32 | Train Loss: 0.939 Vali Loss: 22.128 Vali Acc: 0.565 Test Loss: 22.128 Test Acc: 0.565
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 30.14134192466736
Epoch: 12, Steps: 32 | Train Loss: 0.214 Vali Loss: 31.826 Vali Acc: 0.481 Test Loss: 31.826 Test Acc: 0.481
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 30.733192682266235
Epoch: 13, Steps: 32 | Train Loss: 1.854 Vali Loss: 20.026 Vali Acc: 0.565 Test Loss: 20.026 Test Acc: 0.565
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 30.314064025878906
Epoch: 14, Steps: 32 | Train Loss: 0.697 Vali Loss: 21.429 Vali Acc: 0.595 Test Loss: 21.429 Test Acc: 0.595
Validation loss decreased (-0.572396 --> -0.595206).  Saving model ...
Epoch: 15 cost time: 30.621862411499023
Epoch: 15, Steps: 32 | Train Loss: 0.586 Vali Loss: 26.952 Vali Acc: 0.504 Test Loss: 26.952 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 30.848382711410522
Epoch: 16, Steps: 32 | Train Loss: 1.630 Vali Loss: 43.672 Vali Acc: 0.405 Test Loss: 43.672 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 31.184924364089966
Epoch: 17, Steps: 32 | Train Loss: 0.603 Vali Loss: 54.805 Vali Acc: 0.366 Test Loss: 54.805 Test Acc: 0.366
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 30.74815535545349
Epoch: 18, Steps: 32 | Train Loss: 4.096 Vali Loss: 34.572 Vali Acc: 0.481 Test Loss: 34.572 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 30.979968070983887
Epoch: 19, Steps: 32 | Train Loss: 1.905 Vali Loss: 55.107 Vali Acc: 0.527 Test Loss: 55.107 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 31.034560918807983
Epoch: 20, Steps: 32 | Train Loss: 2.535 Vali Loss: 38.615 Vali Acc: 0.527 Test Loss: 38.615 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 30.993532180786133
Epoch: 21, Steps: 32 | Train Loss: 3.630 Vali Loss: 74.898 Vali Acc: 0.534 Test Loss: 74.898 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 30.873876810073853
Epoch: 22, Steps: 32 | Train Loss: 1.444 Vali Loss: 44.826 Vali Acc: 0.511 Test Loss: 44.826 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 31.18565011024475
Epoch: 23, Steps: 32 | Train Loss: 0.429 Vali Loss: 43.601 Vali Acc: 0.382 Test Loss: 43.601 Test Acc: 0.382
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 30.83347725868225
Epoch: 24, Steps: 32 | Train Loss: 1.571 Vali Loss: 44.036 Vali Acc: 0.481 Test Loss: 44.036 Test Acc: 0.481
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5954198473282443
model parameter : 3911557
model size : 17.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 45.338637590408325
Epoch: 1, Steps: 32 | Train Loss: 4.866 Vali Loss: 9.738 Vali Acc: 0.206 Test Loss: 9.738 Test Acc: 0.206
Validation loss decreased (inf --> -0.206009).  Saving model ...
Epoch: 2 cost time: 44.24764919281006
Epoch: 2, Steps: 32 | Train Loss: 4.667 Vali Loss: 11.518 Vali Acc: 0.229 Test Loss: 11.518 Test Acc: 0.229
Validation loss decreased (-0.206009 --> -0.228892).  Saving model ...
Epoch: 3 cost time: 43.93791675567627
Epoch: 3, Steps: 32 | Train Loss: 1.429 Vali Loss: 4.741 Vali Acc: 0.527 Test Loss: 4.741 Test Acc: 0.527
Validation loss decreased (-0.228892 --> -0.526670).  Saving model ...
Epoch: 4 cost time: 44.08983087539673
Epoch: 4, Steps: 32 | Train Loss: 2.657 Vali Loss: 25.647 Vali Acc: 0.221 Test Loss: 25.647 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 43.730326890945435
Epoch: 5, Steps: 32 | Train Loss: 3.311 Vali Loss: 15.456 Vali Acc: 0.420 Test Loss: 15.456 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 43.82359576225281
Epoch: 6, Steps: 32 | Train Loss: 2.614 Vali Loss: 15.912 Vali Acc: 0.298 Test Loss: 15.912 Test Acc: 0.298
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 44.01715564727783
Epoch: 7, Steps: 32 | Train Loss: 1.188 Vali Loss: 18.168 Vali Acc: 0.550 Test Loss: 18.168 Test Acc: 0.550
Validation loss decreased (-0.526670 --> -0.549437).  Saving model ...
Epoch: 8 cost time: 43.979923725128174
Epoch: 8, Steps: 32 | Train Loss: 0.631 Vali Loss: 14.813 Vali Acc: 0.527 Test Loss: 14.813 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 43.451977252960205
Epoch: 9, Steps: 32 | Train Loss: 3.254 Vali Loss: 28.244 Vali Acc: 0.328 Test Loss: 28.244 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 43.587955951690674
Epoch: 10, Steps: 32 | Train Loss: 1.130 Vali Loss: 24.048 Vali Acc: 0.519 Test Loss: 24.048 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 43.78492760658264
Epoch: 11, Steps: 32 | Train Loss: 0.476 Vali Loss: 29.146 Vali Acc: 0.573 Test Loss: 29.146 Test Acc: 0.573
Validation loss decreased (-0.549437 --> -0.572228).  Saving model ...
Epoch: 12 cost time: 43.26616430282593
Epoch: 12, Steps: 32 | Train Loss: 2.918 Vali Loss: 22.290 Vali Acc: 0.489 Test Loss: 22.290 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 43.99904680252075
Epoch: 13, Steps: 32 | Train Loss: 4.348 Vali Loss: 50.046 Vali Acc: 0.321 Test Loss: 50.046 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 43.78976511955261
Epoch: 14, Steps: 32 | Train Loss: 3.293 Vali Loss: 47.345 Vali Acc: 0.466 Test Loss: 47.345 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 43.70640254020691
Epoch: 15, Steps: 32 | Train Loss: 3.037 Vali Loss: 41.627 Vali Acc: 0.511 Test Loss: 41.627 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 43.83177089691162
Epoch: 16, Steps: 32 | Train Loss: 3.878 Vali Loss: 41.424 Vali Acc: 0.359 Test Loss: 41.424 Test Acc: 0.359
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 44.09995460510254
Epoch: 17, Steps: 32 | Train Loss: 5.637 Vali Loss: 65.199 Vali Acc: 0.489 Test Loss: 65.199 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 42.806527614593506
Epoch: 18, Steps: 32 | Train Loss: 3.736 Vali Loss: 72.388 Vali Acc: 0.237 Test Loss: 72.388 Test Acc: 0.237
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 43.43883275985718
Epoch: 19, Steps: 32 | Train Loss: 1.821 Vali Loss: 36.680 Vali Acc: 0.397 Test Loss: 36.680 Test Acc: 0.397
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 43.64384078979492
Epoch: 20, Steps: 32 | Train Loss: 0.203 Vali Loss: 35.664 Vali Acc: 0.496 Test Loss: 35.664 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 43.134267807006836
Epoch: 21, Steps: 32 | Train Loss: 0.280 Vali Loss: 39.294 Vali Acc: 0.511 Test Loss: 39.294 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 6394309
model size : 26.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 23.531346797943115
Epoch: 1, Steps: 32 | Train Loss: 6.831 Vali Loss: 3.891 Vali Acc: 0.282 Test Loss: 3.891 Test Acc: 0.282
Validation loss decreased (inf --> -0.282404).  Saving model ...
Epoch: 2 cost time: 22.760461807250977
Epoch: 2, Steps: 32 | Train Loss: 2.030 Vali Loss: 4.433 Vali Acc: 0.519 Test Loss: 4.433 Test Acc: 0.519
Validation loss decreased (-0.282404 --> -0.519040).  Saving model ...
Epoch: 3 cost time: 22.870643854141235
Epoch: 3, Steps: 32 | Train Loss: 2.179 Vali Loss: 14.033 Vali Acc: 0.198 Test Loss: 14.033 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 22.862375020980835
Epoch: 4, Steps: 32 | Train Loss: 2.822 Vali Loss: 11.641 Vali Acc: 0.573 Test Loss: 11.641 Test Acc: 0.573
Validation loss decreased (-0.519040 --> -0.572403).  Saving model ...
Epoch: 5 cost time: 22.618335008621216
Epoch: 5, Steps: 32 | Train Loss: 0.177 Vali Loss: 12.994 Vali Acc: 0.489 Test Loss: 12.994 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 22.6792573928833
Epoch: 6, Steps: 32 | Train Loss: 1.276 Vali Loss: 15.890 Vali Acc: 0.557 Test Loss: 15.890 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 22.735745906829834
Epoch: 7, Steps: 32 | Train Loss: 1.387 Vali Loss: 19.336 Vali Acc: 0.466 Test Loss: 19.336 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 22.433953285217285
Epoch: 8, Steps: 32 | Train Loss: 0.304 Vali Loss: 21.191 Vali Acc: 0.542 Test Loss: 21.191 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 22.653654098510742
Epoch: 9, Steps: 32 | Train Loss: 2.648 Vali Loss: 21.394 Vali Acc: 0.473 Test Loss: 21.394 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 22.220370292663574
Epoch: 10, Steps: 32 | Train Loss: 1.276 Vali Loss: 25.239 Vali Acc: 0.458 Test Loss: 25.239 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 22.15417170524597
Epoch: 11, Steps: 32 | Train Loss: 1.842 Vali Loss: 38.500 Vali Acc: 0.534 Test Loss: 38.500 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 22.227294921875
Epoch: 12, Steps: 32 | Train Loss: 0.253 Vali Loss: 42.622 Vali Acc: 0.542 Test Loss: 42.622 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 22.25073003768921
Epoch: 13, Steps: 32 | Train Loss: 1.634 Vali Loss: 39.195 Vali Acc: 0.489 Test Loss: 39.195 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 22.303651571273804
Epoch: 14, Steps: 32 | Train Loss: 0.584 Vali Loss: 45.219 Vali Acc: 0.557 Test Loss: 45.219 Test Acc: 0.557
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 3911557
model size : 17.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 25.901135206222534
Epoch: 1, Steps: 32 | Train Loss: 4.752 Vali Loss: 9.548 Vali Acc: 0.206 Test Loss: 9.548 Test Acc: 0.206
Validation loss decreased (inf --> -0.206011).  Saving model ...
Epoch: 2 cost time: 25.00212073326111
Epoch: 2, Steps: 32 | Train Loss: 4.216 Vali Loss: 3.850 Vali Acc: 0.382 Test Loss: 3.850 Test Acc: 0.382
Validation loss decreased (-0.206011 --> -0.381641).  Saving model ...
Epoch: 3 cost time: 24.72952628135681
Epoch: 3, Steps: 32 | Train Loss: 1.398 Vali Loss: 10.324 Vali Acc: 0.473 Test Loss: 10.324 Test Acc: 0.473
Validation loss decreased (-0.381641 --> -0.473179).  Saving model ...
Epoch: 4 cost time: 24.862485647201538
Epoch: 4, Steps: 32 | Train Loss: 4.762 Vali Loss: 15.804 Vali Acc: 0.382 Test Loss: 15.804 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 24.75151014328003
Epoch: 5, Steps: 32 | Train Loss: 2.227 Vali Loss: 10.003 Vali Acc: 0.519 Test Loss: 10.003 Test Acc: 0.519
Validation loss decreased (-0.473179 --> -0.518984).  Saving model ...
Epoch: 6 cost time: 25.067018747329712
Epoch: 6, Steps: 32 | Train Loss: 4.300 Vali Loss: 16.892 Vali Acc: 0.580 Test Loss: 16.892 Test Acc: 0.580
Validation loss decreased (-0.518984 --> -0.579984).  Saving model ...
Epoch: 7 cost time: 24.806840896606445
Epoch: 7, Steps: 32 | Train Loss: 3.393 Vali Loss: 24.004 Vali Acc: 0.595 Test Loss: 24.004 Test Acc: 0.595
Validation loss decreased (-0.579984 --> -0.595180).  Saving model ...
Epoch: 8 cost time: 24.997829914093018
Epoch: 8, Steps: 32 | Train Loss: 2.305 Vali Loss: 14.189 Vali Acc: 0.573 Test Loss: 14.189 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 24.78525400161743
Epoch: 9, Steps: 32 | Train Loss: 2.331 Vali Loss: 20.625 Vali Acc: 0.412 Test Loss: 20.625 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 24.82689929008484
Epoch: 10, Steps: 32 | Train Loss: 0.120 Vali Loss: 16.960 Vali Acc: 0.466 Test Loss: 16.960 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 24.771735906600952
Epoch: 11, Steps: 32 | Train Loss: 0.580 Vali Loss: 39.635 Vali Acc: 0.244 Test Loss: 39.635 Test Acc: 0.244
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 24.951362371444702
Epoch: 12, Steps: 32 | Train Loss: 0.846 Vali Loss: 30.920 Vali Acc: 0.397 Test Loss: 30.920 Test Acc: 0.397
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 24.938130140304565
Epoch: 13, Steps: 32 | Train Loss: 0.140 Vali Loss: 24.414 Vali Acc: 0.603 Test Loss: 24.414 Test Acc: 0.603
Validation loss decreased (-0.595180 --> -0.602809).  Saving model ...
Epoch: 14 cost time: 24.705249071121216
Epoch: 14, Steps: 32 | Train Loss: 2.343 Vali Loss: 21.120 Vali Acc: 0.595 Test Loss: 21.120 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 24.916093826293945
Epoch: 15, Steps: 32 | Train Loss: 6.308 Vali Loss: 43.953 Vali Acc: 0.359 Test Loss: 43.953 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 24.57613778114319
Epoch: 16, Steps: 32 | Train Loss: 0.626 Vali Loss: 38.972 Vali Acc: 0.382 Test Loss: 38.972 Test Acc: 0.382
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 24.68365478515625
Epoch: 17, Steps: 32 | Train Loss: 3.302 Vali Loss: 30.571 Vali Acc: 0.412 Test Loss: 30.571 Test Acc: 0.412
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 24.785674571990967
Epoch: 18, Steps: 32 | Train Loss: 2.846 Vali Loss: 50.589 Vali Acc: 0.511 Test Loss: 50.589 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 24.660411834716797
Epoch: 19, Steps: 32 | Train Loss: 2.073 Vali Loss: 46.581 Vali Acc: 0.397 Test Loss: 46.581 Test Acc: 0.397
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 24.813472032546997
Epoch: 20, Steps: 32 | Train Loss: 1.785 Vali Loss: 50.206 Vali Acc: 0.534 Test Loss: 50.206 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 24.541757106781006
Epoch: 21, Steps: 32 | Train Loss: 0.990 Vali Loss: 46.003 Vali Acc: 0.344 Test Loss: 46.003 Test Acc: 0.344
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 24.80583643913269
Epoch: 22, Steps: 32 | Train Loss: 0.175 Vali Loss: 56.211 Vali Acc: 0.496 Test Loss: 56.211 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 24.461486101150513
Epoch: 23, Steps: 32 | Train Loss: 0.319 Vali Loss: 58.974 Vali Acc: 0.550 Test Loss: 58.974 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6030534351145038
model parameter : 6394309
model size : 26.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 15.347493171691895
Epoch: 1, Steps: 32 | Train Loss: 6.835 Vali Loss: 4.018 Vali Acc: 0.267 Test Loss: 4.018 Test Acc: 0.267
Validation loss decreased (inf --> -0.267135).  Saving model ...
Epoch: 2 cost time: 14.557424306869507
Epoch: 2, Steps: 32 | Train Loss: 1.869 Vali Loss: 4.297 Vali Acc: 0.550 Test Loss: 4.297 Test Acc: 0.550
Validation loss decreased (-0.267135 --> -0.549575).  Saving model ...
Epoch: 3 cost time: 14.444324016571045
Epoch: 3, Steps: 32 | Train Loss: 2.984 Vali Loss: 9.908 Vali Acc: 0.290 Test Loss: 9.908 Test Acc: 0.290
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 14.407103538513184
Epoch: 4, Steps: 32 | Train Loss: 1.738 Vali Loss: 13.334 Vali Acc: 0.489 Test Loss: 13.334 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 14.51812195777893
Epoch: 5, Steps: 32 | Train Loss: 1.629 Vali Loss: 11.401 Vali Acc: 0.496 Test Loss: 11.401 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 14.358758449554443
Epoch: 6, Steps: 32 | Train Loss: 0.483 Vali Loss: 13.901 Vali Acc: 0.443 Test Loss: 13.901 Test Acc: 0.443
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 14.284424781799316
Epoch: 7, Steps: 32 | Train Loss: 2.852 Vali Loss: 21.704 Vali Acc: 0.450 Test Loss: 21.704 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 14.4073646068573
Epoch: 8, Steps: 32 | Train Loss: 2.202 Vali Loss: 17.836 Vali Acc: 0.580 Test Loss: 17.836 Test Acc: 0.580
Validation loss decreased (-0.549575 --> -0.579974).  Saving model ...
Epoch: 9 cost time: 14.36140751838684
Epoch: 9, Steps: 32 | Train Loss: 1.135 Vali Loss: 29.821 Vali Acc: 0.557 Test Loss: 29.821 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 14.277992486953735
Epoch: 10, Steps: 32 | Train Loss: 0.854 Vali Loss: 29.361 Vali Acc: 0.557 Test Loss: 29.361 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 14.262234926223755
Epoch: 11, Steps: 32 | Train Loss: 1.134 Vali Loss: 21.645 Vali Acc: 0.466 Test Loss: 21.645 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 14.371047019958496
Epoch: 12, Steps: 32 | Train Loss: 1.041 Vali Loss: 37.846 Vali Acc: 0.519 Test Loss: 37.846 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 14.317683458328247
Epoch: 13, Steps: 32 | Train Loss: 3.107 Vali Loss: 50.438 Vali Acc: 0.366 Test Loss: 50.438 Test Acc: 0.366
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 14.53984808921814
Epoch: 14, Steps: 32 | Train Loss: 1.846 Vali Loss: 43.559 Vali Acc: 0.366 Test Loss: 43.559 Test Acc: 0.366
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 14.463233709335327
Epoch: 15, Steps: 32 | Train Loss: 5.174 Vali Loss: 41.116 Vali Acc: 0.427 Test Loss: 41.116 Test Acc: 0.427
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 14.37761926651001
Epoch: 16, Steps: 32 | Train Loss: 0.177 Vali Loss: 48.289 Vali Acc: 0.435 Test Loss: 48.289 Test Acc: 0.435
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 14.274967908859253
Epoch: 17, Steps: 32 | Train Loss: 2.845 Vali Loss: 51.298 Vali Acc: 0.534 Test Loss: 51.298 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 14.331225395202637
Epoch: 18, Steps: 32 | Train Loss: 1.726 Vali Loss: 41.492 Vali Acc: 0.504 Test Loss: 41.492 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 3911557
model size : 17.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 37.53094792366028
Epoch: 1, Steps: 32 | Train Loss: 4.269 Vali Loss: 4.510 Vali Acc: 0.229 Test Loss: 4.510 Test Acc: 0.229
Validation loss decreased (inf --> -0.228963).  Saving model ...
Epoch: 2 cost time: 36.25707173347473
Epoch: 2, Steps: 32 | Train Loss: 2.922 Vali Loss: 4.163 Vali Acc: 0.382 Test Loss: 4.163 Test Acc: 0.382
Validation loss decreased (-0.228963 --> -0.381638).  Saving model ...
Epoch: 3 cost time: 35.945051193237305
Epoch: 3, Steps: 32 | Train Loss: 3.593 Vali Loss: 7.093 Vali Acc: 0.542 Test Loss: 7.093 Test Acc: 0.542
Validation loss decreased (-0.381638 --> -0.541914).  Saving model ...
Epoch: 4 cost time: 36.42525029182434
Epoch: 4, Steps: 32 | Train Loss: 2.179 Vali Loss: 19.477 Vali Acc: 0.534 Test Loss: 19.477 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 35.85292458534241
Epoch: 5, Steps: 32 | Train Loss: 3.341 Vali Loss: 12.299 Vali Acc: 0.489 Test Loss: 12.299 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 36.09142017364502
Epoch: 6, Steps: 32 | Train Loss: 0.968 Vali Loss: 16.618 Vali Acc: 0.550 Test Loss: 16.618 Test Acc: 0.550
Validation loss decreased (-0.541914 --> -0.549452).  Saving model ...
Epoch: 7 cost time: 35.78494834899902
Epoch: 7, Steps: 32 | Train Loss: 1.145 Vali Loss: 25.849 Vali Acc: 0.336 Test Loss: 25.849 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 35.707523345947266
Epoch: 8, Steps: 32 | Train Loss: 1.450 Vali Loss: 33.179 Vali Acc: 0.519 Test Loss: 33.179 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 36.086061000823975
Epoch: 9, Steps: 32 | Train Loss: 2.465 Vali Loss: 51.723 Vali Acc: 0.481 Test Loss: 51.723 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 35.181495666503906
Epoch: 10, Steps: 32 | Train Loss: 3.047 Vali Loss: 28.143 Vali Acc: 0.473 Test Loss: 28.143 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 36.195371866226196
Epoch: 11, Steps: 32 | Train Loss: 0.506 Vali Loss: 44.892 Vali Acc: 0.420 Test Loss: 44.892 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 35.34800887107849
Epoch: 12, Steps: 32 | Train Loss: 0.957 Vali Loss: 32.386 Vali Acc: 0.466 Test Loss: 32.386 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 35.2458930015564
Epoch: 13, Steps: 32 | Train Loss: 1.613 Vali Loss: 27.302 Vali Acc: 0.565 Test Loss: 27.302 Test Acc: 0.565
Validation loss decreased (-0.549452 --> -0.564612).  Saving model ...
Epoch: 14 cost time: 35.90771269798279
Epoch: 14, Steps: 32 | Train Loss: 1.512 Vali Loss: 41.671 Vali Acc: 0.412 Test Loss: 41.671 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 35.56636571884155
Epoch: 15, Steps: 32 | Train Loss: 0.892 Vali Loss: 57.962 Vali Acc: 0.534 Test Loss: 57.962 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 35.67008090019226
Epoch: 16, Steps: 32 | Train Loss: 4.531 Vali Loss: 38.317 Vali Acc: 0.473 Test Loss: 38.317 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 35.669158935546875
Epoch: 17, Steps: 32 | Train Loss: 2.097 Vali Loss: 57.245 Vali Acc: 0.397 Test Loss: 57.245 Test Acc: 0.397
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 35.49104046821594
Epoch: 18, Steps: 32 | Train Loss: 1.409 Vali Loss: 47.732 Vali Acc: 0.405 Test Loss: 47.732 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 35.276857137680054
Epoch: 19, Steps: 32 | Train Loss: 0.208 Vali Loss: 54.783 Vali Acc: 0.519 Test Loss: 54.783 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 35.83115267753601
Epoch: 20, Steps: 32 | Train Loss: 1.900 Vali Loss: 52.877 Vali Acc: 0.405 Test Loss: 52.877 Test Acc: 0.405
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 36.081087589263916
Epoch: 21, Steps: 32 | Train Loss: 1.855 Vali Loss: 40.144 Vali Acc: 0.427 Test Loss: 40.144 Test Acc: 0.427
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 36.26475763320923
Epoch: 22, Steps: 32 | Train Loss: 2.276 Vali Loss: 45.518 Vali Acc: 0.550 Test Loss: 45.518 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 35.65910530090332
Epoch: 23, Steps: 32 | Train Loss: 3.075 Vali Loss: 43.078 Vali Acc: 0.466 Test Loss: 43.078 Test Acc: 0.466
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 4636549
model size : 19.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 19.58276128768921
Epoch: 1, Steps: 32 | Train Loss: 3.058 Vali Loss: 8.703 Vali Acc: 0.160 Test Loss: 8.703 Test Acc: 0.160
Validation loss decreased (inf --> -0.160218).  Saving model ...
Epoch: 2 cost time: 19.01982545852661
Epoch: 2, Steps: 32 | Train Loss: 2.114 Vali Loss: 3.322 Vali Acc: 0.435 Test Loss: 3.322 Test Acc: 0.435
Validation loss decreased (-0.160218 --> -0.435081).  Saving model ...
Epoch: 3 cost time: 19.0040385723114
Epoch: 3, Steps: 32 | Train Loss: 2.567 Vali Loss: 9.208 Vali Acc: 0.550 Test Loss: 9.208 Test Acc: 0.550
Validation loss decreased (-0.435081 --> -0.549526).  Saving model ...
Epoch: 4 cost time: 19.198636770248413
Epoch: 4, Steps: 32 | Train Loss: 1.879 Vali Loss: 13.477 Vali Acc: 0.206 Test Loss: 13.477 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 18.91707444190979
Epoch: 5, Steps: 32 | Train Loss: 0.968 Vali Loss: 12.302 Vali Acc: 0.328 Test Loss: 12.302 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 18.88605809211731
Epoch: 6, Steps: 32 | Train Loss: 2.848 Vali Loss: 27.299 Vali Acc: 0.374 Test Loss: 27.299 Test Acc: 0.374
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 19.0594961643219
Epoch: 7, Steps: 32 | Train Loss: 3.168 Vali Loss: 15.849 Vali Acc: 0.450 Test Loss: 15.849 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 18.841770887374878
Epoch: 8, Steps: 32 | Train Loss: 1.226 Vali Loss: 20.196 Vali Acc: 0.405 Test Loss: 20.196 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 18.580143213272095
Epoch: 9, Steps: 32 | Train Loss: 0.051 Vali Loss: 18.733 Vali Acc: 0.519 Test Loss: 18.733 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 18.783255577087402
Epoch: 10, Steps: 32 | Train Loss: 0.086 Vali Loss: 25.619 Vali Acc: 0.275 Test Loss: 25.619 Test Acc: 0.275
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 18.722604751586914
Epoch: 11, Steps: 32 | Train Loss: 0.000 Vali Loss: 18.775 Vali Acc: 0.573 Test Loss: 18.775 Test Acc: 0.573
Validation loss decreased (-0.549526 --> -0.572331).  Saving model ...
Epoch: 12 cost time: 18.986401081085205
Epoch: 12, Steps: 32 | Train Loss: 0.029 Vali Loss: 15.545 Vali Acc: 0.481 Test Loss: 15.545 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 19.063748121261597
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 16.835 Vali Acc: 0.473 Test Loss: 16.835 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 18.613998651504517
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 16.923 Vali Acc: 0.473 Test Loss: 16.923 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 18.817129611968994
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 21.320 Vali Acc: 0.573 Test Loss: 21.320 Test Acc: 0.573
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 18.735907316207886
Epoch: 16, Steps: 32 | Train Loss: 0.667 Vali Loss: 18.183 Vali Acc: 0.435 Test Loss: 18.183 Test Acc: 0.435
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 18.62670660018921
Epoch: 17, Steps: 32 | Train Loss: 0.354 Vali Loss: 21.119 Vali Acc: 0.534 Test Loss: 21.119 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 19.014493942260742
Epoch: 18, Steps: 32 | Train Loss: 1.646 Vali Loss: 22.896 Vali Acc: 0.481 Test Loss: 22.896 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 18.784085750579834
Epoch: 19, Steps: 32 | Train Loss: 1.102 Vali Loss: 25.151 Vali Acc: 0.511 Test Loss: 25.151 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 18.617161512374878
Epoch: 20, Steps: 32 | Train Loss: 3.204 Vali Loss: 68.247 Vali Acc: 0.397 Test Loss: 68.247 Test Acc: 0.397
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 18.49371314048767
Epoch: 21, Steps: 32 | Train Loss: 5.714 Vali Loss: 65.735 Vali Acc: 0.374 Test Loss: 65.735 Test Acc: 0.374
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 3395077
model size : 15.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 25.901400327682495
Epoch: 1, Steps: 32 | Train Loss: 4.267 Vali Loss: 4.565 Vali Acc: 0.221 Test Loss: 4.565 Test Acc: 0.221
Validation loss decreased (inf --> -0.221328).  Saving model ...
Epoch: 2 cost time: 24.991578102111816
Epoch: 2, Steps: 32 | Train Loss: 3.174 Vali Loss: 8.099 Vali Acc: 0.504 Test Loss: 8.099 Test Acc: 0.504
Validation loss decreased (-0.221328 --> -0.503736).  Saving model ...
Epoch: 3 cost time: 25.00160574913025
Epoch: 3, Steps: 32 | Train Loss: 1.877 Vali Loss: 6.823 Vali Acc: 0.573 Test Loss: 6.823 Test Acc: 0.573
Validation loss decreased (-0.503736 --> -0.572451).  Saving model ...
Epoch: 4 cost time: 24.59816265106201
Epoch: 4, Steps: 32 | Train Loss: 3.242 Vali Loss: 13.021 Vali Acc: 0.504 Test Loss: 13.021 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 24.19630265235901
Epoch: 5, Steps: 32 | Train Loss: 3.684 Vali Loss: 9.524 Vali Acc: 0.473 Test Loss: 9.524 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 24.43824291229248
Epoch: 6, Steps: 32 | Train Loss: 2.614 Vali Loss: 21.736 Vali Acc: 0.527 Test Loss: 21.736 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 24.09217405319214
Epoch: 7, Steps: 32 | Train Loss: 1.297 Vali Loss: 27.380 Vali Acc: 0.321 Test Loss: 27.380 Test Acc: 0.321
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 24.52366614341736
Epoch: 8, Steps: 32 | Train Loss: 4.062 Vali Loss: 25.679 Vali Acc: 0.336 Test Loss: 25.679 Test Acc: 0.336
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 23.69588041305542
Epoch: 9, Steps: 32 | Train Loss: 5.112 Vali Loss: 36.609 Vali Acc: 0.466 Test Loss: 36.609 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 24.669408798217773
Epoch: 10, Steps: 32 | Train Loss: 1.108 Vali Loss: 36.962 Vali Acc: 0.511 Test Loss: 36.962 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 24.19408082962036
Epoch: 11, Steps: 32 | Train Loss: 1.261 Vali Loss: 28.126 Vali Acc: 0.542 Test Loss: 28.126 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 24.507508993148804
Epoch: 12, Steps: 32 | Train Loss: 0.002 Vali Loss: 36.192 Vali Acc: 0.481 Test Loss: 36.192 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 23.678934574127197
Epoch: 13, Steps: 32 | Train Loss: 1.570 Vali Loss: 26.949 Vali Acc: 0.450 Test Loss: 26.949 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 4636549
model size : 19.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 14.758562326431274
Epoch: 1, Steps: 32 | Train Loss: 3.059 Vali Loss: 8.709 Vali Acc: 0.160 Test Loss: 8.709 Test Acc: 0.160
Validation loss decreased (inf --> -0.160218).  Saving model ...
Epoch: 2 cost time: 13.876013278961182
Epoch: 2, Steps: 32 | Train Loss: 2.172 Vali Loss: 3.096 Vali Acc: 0.405 Test Loss: 3.096 Test Acc: 0.405
Validation loss decreased (-0.160218 --> -0.404549).  Saving model ...
Epoch: 3 cost time: 13.755614519119263
Epoch: 3, Steps: 32 | Train Loss: 3.695 Vali Loss: 13.806 Vali Acc: 0.260 Test Loss: 13.806 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 13.697803497314453
Epoch: 4, Steps: 32 | Train Loss: 4.535 Vali Loss: 9.335 Vali Acc: 0.542 Test Loss: 9.335 Test Acc: 0.542
Validation loss decreased (-0.404549 --> -0.541891).  Saving model ...
Epoch: 5 cost time: 13.852072477340698
Epoch: 5, Steps: 32 | Train Loss: 2.193 Vali Loss: 15.514 Vali Acc: 0.275 Test Loss: 15.514 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 13.391117334365845
Epoch: 6, Steps: 32 | Train Loss: 1.021 Vali Loss: 23.676 Vali Acc: 0.534 Test Loss: 23.676 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 13.429438352584839
Epoch: 7, Steps: 32 | Train Loss: 2.699 Vali Loss: 17.509 Vali Acc: 0.481 Test Loss: 17.509 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 13.219217300415039
Epoch: 8, Steps: 32 | Train Loss: 1.088 Vali Loss: 23.599 Vali Acc: 0.534 Test Loss: 23.599 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 13.564632892608643
Epoch: 9, Steps: 32 | Train Loss: 0.466 Vali Loss: 25.553 Vali Acc: 0.305 Test Loss: 25.553 Test Acc: 0.305
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 13.590164184570312
Epoch: 10, Steps: 32 | Train Loss: 1.650 Vali Loss: 18.098 Vali Acc: 0.496 Test Loss: 18.098 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 13.365655660629272
Epoch: 11, Steps: 32 | Train Loss: 1.879 Vali Loss: 26.899 Vali Acc: 0.557 Test Loss: 26.899 Test Acc: 0.557
Validation loss decreased (-0.541891 --> -0.556983).  Saving model ...
Epoch: 12 cost time: 13.338935613632202
Epoch: 12, Steps: 32 | Train Loss: 1.589 Vali Loss: 35.005 Vali Acc: 0.542 Test Loss: 35.005 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 13.327370643615723
Epoch: 13, Steps: 32 | Train Loss: 3.180 Vali Loss: 42.601 Vali Acc: 0.275 Test Loss: 42.601 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 13.108443975448608
Epoch: 14, Steps: 32 | Train Loss: 0.762 Vali Loss: 28.504 Vali Acc: 0.496 Test Loss: 28.504 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 13.303858518600464
Epoch: 15, Steps: 32 | Train Loss: 0.038 Vali Loss: 31.203 Vali Acc: 0.351 Test Loss: 31.203 Test Acc: 0.351
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 13.357009172439575
Epoch: 16, Steps: 32 | Train Loss: 0.489 Vali Loss: 37.917 Vali Acc: 0.374 Test Loss: 37.917 Test Acc: 0.374
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 13.450611114501953
Epoch: 17, Steps: 32 | Train Loss: 0.702 Vali Loss: 30.876 Vali Acc: 0.504 Test Loss: 30.876 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 13.261355876922607
Epoch: 18, Steps: 32 | Train Loss: 1.407 Vali Loss: 60.626 Vali Acc: 0.252 Test Loss: 60.626 Test Acc: 0.252
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 13.160064935684204
Epoch: 19, Steps: 32 | Train Loss: 0.047 Vali Loss: 43.972 Vali Acc: 0.412 Test Loss: 43.972 Test Acc: 0.412
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 13.300859928131104
Epoch: 20, Steps: 32 | Train Loss: 0.291 Vali Loss: 39.485 Vali Acc: 0.519 Test Loss: 39.485 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 13.05664324760437
Epoch: 21, Steps: 32 | Train Loss: 1.213 Vali Loss: 60.894 Vali Acc: 0.542 Test Loss: 60.894 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 3395077
model size : 15.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 13.519529819488525
Epoch: 1, Steps: 32 | Train Loss: 4.225 Vali Loss: 4.339 Vali Acc: 0.229 Test Loss: 4.339 Test Acc: 0.229
Validation loss decreased (inf --> -0.228964).  Saving model ...
Epoch: 2 cost time: 12.83837366104126
Epoch: 2, Steps: 32 | Train Loss: 2.320 Vali Loss: 3.307 Vali Acc: 0.427 Test Loss: 3.307 Test Acc: 0.427
Validation loss decreased (-0.228964 --> -0.427448).  Saving model ...
Epoch: 3 cost time: 12.987284421920776
Epoch: 3, Steps: 32 | Train Loss: 2.619 Vali Loss: 7.817 Vali Acc: 0.359 Test Loss: 7.817 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 12.841294765472412
Epoch: 4, Steps: 32 | Train Loss: 1.115 Vali Loss: 9.019 Vali Acc: 0.458 Test Loss: 9.019 Test Acc: 0.458
Validation loss decreased (-0.427448 --> -0.457925).  Saving model ...
Epoch: 5 cost time: 12.985340356826782
Epoch: 5, Steps: 32 | Train Loss: 1.955 Vali Loss: 15.076 Vali Acc: 0.519 Test Loss: 15.076 Test Acc: 0.519
Validation loss decreased (-0.457925 --> -0.518933).  Saving model ...
Epoch: 6 cost time: 13.031142234802246
Epoch: 6, Steps: 32 | Train Loss: 6.181 Vali Loss: 25.220 Vali Acc: 0.405 Test Loss: 25.220 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 13.07111144065857
Epoch: 7, Steps: 32 | Train Loss: 1.971 Vali Loss: 24.089 Vali Acc: 0.473 Test Loss: 24.089 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 13.171804904937744
Epoch: 8, Steps: 32 | Train Loss: 1.128 Vali Loss: 29.992 Vali Acc: 0.420 Test Loss: 29.992 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 12.902490139007568
Epoch: 9, Steps: 32 | Train Loss: 3.522 Vali Loss: 57.625 Vali Acc: 0.481 Test Loss: 57.625 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 13.024786233901978
Epoch: 10, Steps: 32 | Train Loss: 1.387 Vali Loss: 30.475 Vali Acc: 0.504 Test Loss: 30.475 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 13.284703731536865
Epoch: 11, Steps: 32 | Train Loss: 0.922 Vali Loss: 28.448 Vali Acc: 0.389 Test Loss: 28.448 Test Acc: 0.389
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 13.122246980667114
Epoch: 12, Steps: 32 | Train Loss: 0.555 Vali Loss: 49.733 Vali Acc: 0.305 Test Loss: 49.733 Test Acc: 0.305
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 12.796608924865723
Epoch: 13, Steps: 32 | Train Loss: 0.602 Vali Loss: 42.419 Vali Acc: 0.489 Test Loss: 42.419 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 12.686842441558838
Epoch: 14, Steps: 32 | Train Loss: 0.870 Vali Loss: 28.541 Vali Acc: 0.511 Test Loss: 28.541 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 12.943471670150757
Epoch: 15, Steps: 32 | Train Loss: 0.424 Vali Loss: 41.400 Vali Acc: 0.420 Test Loss: 41.400 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 4636549
model size : 19.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 9.075280904769897
Epoch: 1, Steps: 32 | Train Loss: 3.046 Vali Loss: 8.529 Vali Acc: 0.160 Test Loss: 8.529 Test Acc: 0.160
Validation loss decreased (inf --> -0.160220).  Saving model ...
Epoch: 2 cost time: 7.8651275634765625
Epoch: 2, Steps: 32 | Train Loss: 2.235 Vali Loss: 3.332 Vali Acc: 0.374 Test Loss: 3.332 Test Acc: 0.374
Validation loss decreased (-0.160220 --> -0.374012).  Saving model ...
Epoch: 3 cost time: 7.998192071914673
Epoch: 3, Steps: 32 | Train Loss: 3.687 Vali Loss: 10.862 Vali Acc: 0.527 Test Loss: 10.862 Test Acc: 0.527
Validation loss decreased (-0.374012 --> -0.526609).  Saving model ...
Epoch: 4 cost time: 8.111462593078613
Epoch: 4, Steps: 32 | Train Loss: 4.603 Vali Loss: 16.718 Vali Acc: 0.275 Test Loss: 16.718 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.22316312789917
Epoch: 5, Steps: 32 | Train Loss: 0.693 Vali Loss: 8.579 Vali Acc: 0.542 Test Loss: 8.579 Test Acc: 0.542
Validation loss decreased (-0.526609 --> -0.541899).  Saving model ...
Epoch: 6 cost time: 7.9808855056762695
Epoch: 6, Steps: 32 | Train Loss: 1.152 Vali Loss: 13.540 Vali Acc: 0.542 Test Loss: 13.540 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.9772303104400635
Epoch: 7, Steps: 32 | Train Loss: 2.767 Vali Loss: 9.612 Vali Acc: 0.557 Test Loss: 9.612 Test Acc: 0.557
Validation loss decreased (-0.541899 --> -0.557156).  Saving model ...
Epoch: 8 cost time: 8.042219638824463
Epoch: 8, Steps: 32 | Train Loss: 3.052 Vali Loss: 29.540 Vali Acc: 0.282 Test Loss: 29.540 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 8.19290041923523
Epoch: 9, Steps: 32 | Train Loss: 1.579 Vali Loss: 23.958 Vali Acc: 0.489 Test Loss: 23.958 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 8.081822872161865
Epoch: 10, Steps: 32 | Train Loss: 0.662 Vali Loss: 23.663 Vali Acc: 0.473 Test Loss: 23.663 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 7.915958642959595
Epoch: 11, Steps: 32 | Train Loss: 0.628 Vali Loss: 20.396 Vali Acc: 0.504 Test Loss: 20.396 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 8.010825634002686
Epoch: 12, Steps: 32 | Train Loss: 0.639 Vali Loss: 23.108 Vali Acc: 0.466 Test Loss: 23.108 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 8.082919120788574
Epoch: 13, Steps: 32 | Train Loss: 0.775 Vali Loss: 36.395 Vali Acc: 0.305 Test Loss: 36.395 Test Acc: 0.305
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 7.9446001052856445
Epoch: 14, Steps: 32 | Train Loss: 1.062 Vali Loss: 24.926 Vali Acc: 0.573 Test Loss: 24.926 Test Acc: 0.573
Validation loss decreased (-0.557156 --> -0.572270).  Saving model ...
Epoch: 15 cost time: 8.13242483139038
Epoch: 15, Steps: 32 | Train Loss: 0.202 Vali Loss: 36.919 Vali Acc: 0.382 Test Loss: 36.919 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 7.995088338851929
Epoch: 16, Steps: 32 | Train Loss: 1.762 Vali Loss: 42.464 Vali Acc: 0.359 Test Loss: 42.464 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 7.97602915763855
Epoch: 17, Steps: 32 | Train Loss: 1.115 Vali Loss: 33.363 Vali Acc: 0.580 Test Loss: 33.363 Test Acc: 0.580
Validation loss decreased (-0.572270 --> -0.579819).  Saving model ...
Epoch: 18 cost time: 7.967261791229248
Epoch: 18, Steps: 32 | Train Loss: 2.106 Vali Loss: 49.486 Vali Acc: 0.305 Test Loss: 49.486 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 8.077697038650513
Epoch: 19, Steps: 32 | Train Loss: 0.856 Vali Loss: 50.719 Vali Acc: 0.321 Test Loss: 50.719 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 7.9986913204193115
Epoch: 20, Steps: 32 | Train Loss: 2.476 Vali Loss: 37.425 Vali Acc: 0.595 Test Loss: 37.425 Test Acc: 0.595
Validation loss decreased (-0.579819 --> -0.595046).  Saving model ...
Epoch: 21 cost time: 7.977565050125122
Epoch: 21, Steps: 32 | Train Loss: 2.749 Vali Loss: 89.639 Vali Acc: 0.244 Test Loss: 89.639 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 7.927035093307495
Epoch: 22, Steps: 32 | Train Loss: 0.699 Vali Loss: 50.260 Vali Acc: 0.427 Test Loss: 50.260 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 7.906398057937622
Epoch: 23, Steps: 32 | Train Loss: 0.489 Vali Loss: 37.324 Vali Acc: 0.550 Test Loss: 37.324 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 8.088738918304443
Epoch: 24, Steps: 32 | Train Loss: 0.165 Vali Loss: 44.941 Vali Acc: 0.550 Test Loss: 44.941 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 7.948941469192505
Epoch: 25, Steps: 32 | Train Loss: 0.579 Vali Loss: 78.495 Vali Acc: 0.275 Test Loss: 78.495 Test Acc: 0.275
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 7.978980541229248
Epoch: 26, Steps: 32 | Train Loss: 0.097 Vali Loss: 47.138 Vali Acc: 0.527 Test Loss: 47.138 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 8.04641842842102
Epoch: 27, Steps: 32 | Train Loss: 2.476 Vali Loss: 61.303 Vali Acc: 0.580 Test Loss: 61.303 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 7.993765592575073
Epoch: 28, Steps: 32 | Train Loss: 0.521 Vali Loss: 45.401 Vali Acc: 0.588 Test Loss: 45.401 Test Acc: 0.588
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 8.031352996826172
Epoch: 29, Steps: 32 | Train Loss: 0.268 Vali Loss: 63.661 Vali Acc: 0.603 Test Loss: 63.661 Test Acc: 0.603
Validation loss decreased (-0.595046 --> -0.602417).  Saving model ...
Epoch: 30 cost time: 8.090649604797363
Epoch: 30, Steps: 32 | Train Loss: 0.856 Vali Loss: 46.133 Vali Acc: 0.412 Test Loss: 46.133 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6030534351145038
model parameter : 3395077
model size : 15.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 53.75149607658386
Epoch: 1, Steps: 32 | Train Loss: 2.560 Vali Loss: 1.706 Vali Acc: 0.397 Test Loss: 1.706 Test Acc: 0.397
Validation loss decreased (inf --> -0.396930).  Saving model ...
Epoch: 2 cost time: 52.74223780632019
Epoch: 2, Steps: 32 | Train Loss: 2.002 Vali Loss: 5.965 Vali Acc: 0.504 Test Loss: 5.965 Test Acc: 0.504
Validation loss decreased (-0.396930 --> -0.503757).  Saving model ...
Epoch: 3 cost time: 52.759872913360596
Epoch: 3, Steps: 32 | Train Loss: 1.022 Vali Loss: 3.731 Vali Acc: 0.550 Test Loss: 3.731 Test Acc: 0.550
Validation loss decreased (-0.503757 --> -0.549581).  Saving model ...
Epoch: 4 cost time: 53.328473806381226
Epoch: 4, Steps: 32 | Train Loss: 3.499 Vali Loss: 14.731 Vali Acc: 0.267 Test Loss: 14.731 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 53.56546139717102
Epoch: 5, Steps: 32 | Train Loss: 2.704 Vali Loss: 12.597 Vali Acc: 0.519 Test Loss: 12.597 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 53.495094537734985
Epoch: 6, Steps: 32 | Train Loss: 1.174 Vali Loss: 11.258 Vali Acc: 0.519 Test Loss: 11.258 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 53.12436032295227
Epoch: 7, Steps: 32 | Train Loss: 0.859 Vali Loss: 10.150 Vali Acc: 0.366 Test Loss: 10.150 Test Acc: 0.366
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 52.87585473060608
Epoch: 8, Steps: 32 | Train Loss: 0.315 Vali Loss: 11.465 Vali Acc: 0.359 Test Loss: 11.465 Test Acc: 0.359
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 53.29241681098938
Epoch: 9, Steps: 32 | Train Loss: 0.427 Vali Loss: 20.148 Vali Acc: 0.504 Test Loss: 20.148 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 53.11986780166626
Epoch: 10, Steps: 32 | Train Loss: 0.326 Vali Loss: 12.039 Vali Acc: 0.496 Test Loss: 12.039 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 53.14266276359558
Epoch: 11, Steps: 32 | Train Loss: 0.329 Vali Loss: 13.617 Vali Acc: 0.565 Test Loss: 13.617 Test Acc: 0.565
Validation loss decreased (-0.549581 --> -0.564749).  Saving model ...
Epoch: 12 cost time: 53.07972240447998
Epoch: 12, Steps: 32 | Train Loss: 0.488 Vali Loss: 16.325 Vali Acc: 0.527 Test Loss: 16.325 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 52.65068173408508
Epoch: 13, Steps: 32 | Train Loss: 1.551 Vali Loss: 21.261 Vali Acc: 0.519 Test Loss: 21.261 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 52.50834560394287
Epoch: 14, Steps: 32 | Train Loss: 0.540 Vali Loss: 28.932 Vali Acc: 0.458 Test Loss: 28.932 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 52.34877943992615
Epoch: 15, Steps: 32 | Train Loss: 0.940 Vali Loss: 26.747 Vali Acc: 0.443 Test Loss: 26.747 Test Acc: 0.443
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 52.52743482589722
Epoch: 16, Steps: 32 | Train Loss: 0.409 Vali Loss: 22.812 Vali Acc: 0.427 Test Loss: 22.812 Test Acc: 0.427
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 52.954463958740234
Epoch: 17, Steps: 32 | Train Loss: 0.976 Vali Loss: 29.212 Vali Acc: 0.527 Test Loss: 29.212 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 52.671231269836426
Epoch: 18, Steps: 32 | Train Loss: 0.775 Vali Loss: 36.383 Vali Acc: 0.504 Test Loss: 36.383 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 52.95764684677124
Epoch: 19, Steps: 32 | Train Loss: 0.865 Vali Loss: 29.837 Vali Acc: 0.359 Test Loss: 29.837 Test Acc: 0.359
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 52.93175148963928
Epoch: 20, Steps: 32 | Train Loss: 2.813 Vali Loss: 48.288 Vali Acc: 0.511 Test Loss: 48.288 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 52.67892384529114
Epoch: 21, Steps: 32 | Train Loss: 1.998 Vali Loss: 42.070 Vali Acc: 0.466 Test Loss: 42.070 Test Acc: 0.466
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 3197733
model size : 13.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 30.973599195480347
Epoch: 1, Steps: 32 | Train Loss: 2.411 Vali Loss: 1.980 Vali Acc: 0.450 Test Loss: 1.980 Test Acc: 0.450
Validation loss decreased (inf --> -0.450362).  Saving model ...
Epoch: 2 cost time: 30.47444462776184
Epoch: 2, Steps: 32 | Train Loss: 1.295 Vali Loss: 3.035 Vali Acc: 0.382 Test Loss: 3.035 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 30.546271324157715
Epoch: 3, Steps: 32 | Train Loss: 0.434 Vali Loss: 3.400 Vali Acc: 0.534 Test Loss: 3.400 Test Acc: 0.534
Validation loss decreased (-0.450362 --> -0.534317).  Saving model ...
Epoch: 4 cost time: 30.376157522201538
Epoch: 4, Steps: 32 | Train Loss: 0.701 Vali Loss: 6.543 Vali Acc: 0.489 Test Loss: 6.543 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 30.44611096382141
Epoch: 5, Steps: 32 | Train Loss: 0.493 Vali Loss: 10.913 Vali Acc: 0.527 Test Loss: 10.913 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 30.51488733291626
Epoch: 6, Steps: 32 | Train Loss: 1.249 Vali Loss: 7.991 Vali Acc: 0.542 Test Loss: 7.991 Test Acc: 0.542
Validation loss decreased (-0.534317 --> -0.541905).  Saving model ...
Epoch: 7 cost time: 30.424086332321167
Epoch: 7, Steps: 32 | Train Loss: 0.524 Vali Loss: 10.134 Vali Acc: 0.481 Test Loss: 10.134 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 30.21271538734436
Epoch: 8, Steps: 32 | Train Loss: 1.696 Vali Loss: 13.559 Vali Acc: 0.450 Test Loss: 13.559 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 30.20461344718933
Epoch: 9, Steps: 32 | Train Loss: 0.410 Vali Loss: 12.451 Vali Acc: 0.435 Test Loss: 12.451 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 30.308600187301636
Epoch: 10, Steps: 32 | Train Loss: 0.313 Vali Loss: 12.863 Vali Acc: 0.458 Test Loss: 12.863 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 29.869547367095947
Epoch: 11, Steps: 32 | Train Loss: 0.150 Vali Loss: 13.689 Vali Acc: 0.504 Test Loss: 13.689 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 30.11629581451416
Epoch: 12, Steps: 32 | Train Loss: 0.685 Vali Loss: 17.284 Vali Acc: 0.504 Test Loss: 17.284 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 30.191505432128906
Epoch: 13, Steps: 32 | Train Loss: 0.479 Vali Loss: 23.340 Vali Acc: 0.496 Test Loss: 23.340 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 30.33434009552002
Epoch: 14, Steps: 32 | Train Loss: 0.836 Vali Loss: 19.586 Vali Acc: 0.504 Test Loss: 19.586 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 30.3833224773407
Epoch: 15, Steps: 32 | Train Loss: 0.661 Vali Loss: 16.629 Vali Acc: 0.534 Test Loss: 16.629 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 30.401668071746826
Epoch: 16, Steps: 32 | Train Loss: 0.894 Vali Loss: 17.213 Vali Acc: 0.527 Test Loss: 17.213 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 1956165
model size : 8.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 41.32759976387024
Epoch: 1, Steps: 32 | Train Loss: 2.585 Vali Loss: 1.655 Vali Acc: 0.405 Test Loss: 1.655 Test Acc: 0.405
Validation loss decreased (inf --> -0.404564).  Saving model ...
Epoch: 2 cost time: 40.34264349937439
Epoch: 2, Steps: 32 | Train Loss: 1.910 Vali Loss: 4.359 Vali Acc: 0.511 Test Loss: 4.359 Test Acc: 0.511
Validation loss decreased (-0.404564 --> -0.511407).  Saving model ...
Epoch: 3 cost time: 39.9680757522583
Epoch: 3, Steps: 32 | Train Loss: 1.268 Vali Loss: 4.102 Vali Acc: 0.511 Test Loss: 4.102 Test Acc: 0.511
Validation loss decreased (-0.511407 --> -0.511409).  Saving model ...
Epoch: 4 cost time: 39.87992000579834
Epoch: 4, Steps: 32 | Train Loss: 1.985 Vali Loss: 6.591 Vali Acc: 0.489 Test Loss: 6.591 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 40.019399881362915
Epoch: 5, Steps: 32 | Train Loss: 1.169 Vali Loss: 6.448 Vali Acc: 0.359 Test Loss: 6.448 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 39.96187949180603
Epoch: 6, Steps: 32 | Train Loss: 1.354 Vali Loss: 11.540 Vali Acc: 0.489 Test Loss: 11.540 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 40.08277940750122
Epoch: 7, Steps: 32 | Train Loss: 0.789 Vali Loss: 12.448 Vali Acc: 0.435 Test Loss: 12.448 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 39.955981731414795
Epoch: 8, Steps: 32 | Train Loss: 0.756 Vali Loss: 12.858 Vali Acc: 0.504 Test Loss: 12.858 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 39.67019701004028
Epoch: 9, Steps: 32 | Train Loss: 0.696 Vali Loss: 17.295 Vali Acc: 0.397 Test Loss: 17.295 Test Acc: 0.397
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 39.77628993988037
Epoch: 10, Steps: 32 | Train Loss: 0.679 Vali Loss: 15.282 Vali Acc: 0.351 Test Loss: 15.282 Test Acc: 0.351
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 39.61016535758972
Epoch: 11, Steps: 32 | Train Loss: 0.233 Vali Loss: 18.405 Vali Acc: 0.351 Test Loss: 18.405 Test Acc: 0.351
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 38.98623466491699
Epoch: 12, Steps: 32 | Train Loss: 1.691 Vali Loss: 20.495 Vali Acc: 0.366 Test Loss: 20.495 Test Acc: 0.366
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 39.76529049873352
Epoch: 13, Steps: 32 | Train Loss: 1.852 Vali Loss: 18.789 Vali Acc: 0.374 Test Loss: 18.789 Test Acc: 0.374
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 3197733
model size : 13.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 25.025102615356445
Epoch: 1, Steps: 32 | Train Loss: 2.386 Vali Loss: 1.881 Vali Acc: 0.305 Test Loss: 1.881 Test Acc: 0.305
Validation loss decreased (inf --> -0.305325).  Saving model ...
Epoch: 2 cost time: 24.576995134353638
Epoch: 2, Steps: 32 | Train Loss: 1.059 Vali Loss: 3.264 Vali Acc: 0.328 Test Loss: 3.264 Test Acc: 0.328
Validation loss decreased (-0.305325 --> -0.328212).  Saving model ...
Epoch: 3 cost time: 24.472429513931274
Epoch: 3, Steps: 32 | Train Loss: 0.827 Vali Loss: 5.460 Vali Acc: 0.260 Test Loss: 5.460 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 24.687849521636963
Epoch: 4, Steps: 32 | Train Loss: 0.163 Vali Loss: 7.821 Vali Acc: 0.336 Test Loss: 7.821 Test Acc: 0.336
Validation loss decreased (-0.328212 --> -0.335800).  Saving model ...
Epoch: 5 cost time: 24.473109006881714
Epoch: 5, Steps: 32 | Train Loss: 1.001 Vali Loss: 8.676 Vali Acc: 0.366 Test Loss: 8.676 Test Acc: 0.366
Validation loss decreased (-0.335800 --> -0.366325).  Saving model ...
Epoch: 6 cost time: 24.4359347820282
Epoch: 6, Steps: 32 | Train Loss: 1.143 Vali Loss: 13.899 Vali Acc: 0.420 Test Loss: 13.899 Test Acc: 0.420
Validation loss decreased (-0.366325 --> -0.419708).  Saving model ...
Epoch: 7 cost time: 24.37451696395874
Epoch: 7, Steps: 32 | Train Loss: 2.854 Vali Loss: 10.630 Vali Acc: 0.504 Test Loss: 10.630 Test Acc: 0.504
Validation loss decreased (-0.419708 --> -0.503710).  Saving model ...
Epoch: 8 cost time: 24.60996127128601
Epoch: 8, Steps: 32 | Train Loss: 2.345 Vali Loss: 16.035 Vali Acc: 0.374 Test Loss: 16.035 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 24.299229621887207
Epoch: 9, Steps: 32 | Train Loss: 0.961 Vali Loss: 15.128 Vali Acc: 0.458 Test Loss: 15.128 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 24.46648931503296
Epoch: 10, Steps: 32 | Train Loss: 0.169 Vali Loss: 13.365 Vali Acc: 0.489 Test Loss: 13.365 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 24.21431612968445
Epoch: 11, Steps: 32 | Train Loss: 0.291 Vali Loss: 15.834 Vali Acc: 0.450 Test Loss: 15.834 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 24.209040880203247
Epoch: 12, Steps: 32 | Train Loss: 0.909 Vali Loss: 24.448 Vali Acc: 0.496 Test Loss: 24.448 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 24.263954401016235
Epoch: 13, Steps: 32 | Train Loss: 0.707 Vali Loss: 15.657 Vali Acc: 0.427 Test Loss: 15.657 Test Acc: 0.427
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 24.23607563972473
Epoch: 14, Steps: 32 | Train Loss: 0.662 Vali Loss: 15.424 Vali Acc: 0.504 Test Loss: 15.424 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 24.2336323261261
Epoch: 15, Steps: 32 | Train Loss: 0.068 Vali Loss: 14.078 Vali Acc: 0.519 Test Loss: 14.078 Test Acc: 0.519
Validation loss decreased (-0.503710 --> -0.518943).  Saving model ...
Epoch: 16 cost time: 24.194722175598145
Epoch: 16, Steps: 32 | Train Loss: 0.714 Vali Loss: 14.598 Vali Acc: 0.504 Test Loss: 14.598 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 24.25425410270691
Epoch: 17, Steps: 32 | Train Loss: 0.046 Vali Loss: 23.616 Vali Acc: 0.534 Test Loss: 23.616 Test Acc: 0.534
Validation loss decreased (-0.518943 --> -0.534115).  Saving model ...
Epoch: 18 cost time: 24.392608880996704
Epoch: 18, Steps: 32 | Train Loss: 0.206 Vali Loss: 26.170 Vali Acc: 0.336 Test Loss: 26.170 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 24.26741099357605
Epoch: 19, Steps: 32 | Train Loss: 0.002 Vali Loss: 20.572 Vali Acc: 0.374 Test Loss: 20.572 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 24.17501163482666
Epoch: 20, Steps: 32 | Train Loss: 0.910 Vali Loss: 40.469 Vali Acc: 0.519 Test Loss: 40.469 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 24.321125268936157
Epoch: 21, Steps: 32 | Train Loss: 0.328 Vali Loss: 31.985 Vali Acc: 0.313 Test Loss: 31.985 Test Acc: 0.313
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 24.240981101989746
Epoch: 22, Steps: 32 | Train Loss: 0.484 Vali Loss: 31.705 Vali Acc: 0.412 Test Loss: 31.705 Test Acc: 0.412
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 24.164297342300415
Epoch: 23, Steps: 32 | Train Loss: 0.518 Vali Loss: 30.357 Vali Acc: 0.534 Test Loss: 30.357 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 24.3071608543396
Epoch: 24, Steps: 32 | Train Loss: 0.728 Vali Loss: 32.047 Vali Acc: 0.466 Test Loss: 32.047 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 24.19059181213379
Epoch: 25, Steps: 32 | Train Loss: 0.284 Vali Loss: 38.932 Vali Acc: 0.443 Test Loss: 38.932 Test Acc: 0.443
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 24.346696376800537
Epoch: 26, Steps: 32 | Train Loss: 1.986 Vali Loss: 36.818 Vali Acc: 0.420 Test Loss: 36.818 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 24.057375192642212
Epoch: 27, Steps: 32 | Train Loss: 0.886 Vali Loss: 39.318 Vali Acc: 0.511 Test Loss: 39.318 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 1956165
model size : 8.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 23.71688461303711
Epoch: 1, Steps: 32 | Train Loss: 2.609 Vali Loss: 1.859 Vali Acc: 0.344 Test Loss: 1.859 Test Acc: 0.344
Validation loss decreased (inf --> -0.343493).  Saving model ...
Epoch: 2 cost time: 23.605369091033936
Epoch: 2, Steps: 32 | Train Loss: 1.914 Vali Loss: 7.135 Vali Acc: 0.443 Test Loss: 7.135 Test Acc: 0.443
Validation loss decreased (-0.343493 --> -0.442677).  Saving model ...
Epoch: 3 cost time: 23.69066023826599
Epoch: 3, Steps: 32 | Train Loss: 1.135 Vali Loss: 3.510 Vali Acc: 0.405 Test Loss: 3.510 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 23.539648294448853
Epoch: 4, Steps: 32 | Train Loss: 1.902 Vali Loss: 13.149 Vali Acc: 0.466 Test Loss: 13.149 Test Acc: 0.466
Validation loss decreased (-0.442677 --> -0.465517).  Saving model ...
Epoch: 5 cost time: 23.15023636817932
Epoch: 5, Steps: 32 | Train Loss: 3.191 Vali Loss: 6.674 Vali Acc: 0.527 Test Loss: 6.674 Test Acc: 0.527
Validation loss decreased (-0.465517 --> -0.526651).  Saving model ...
Epoch: 6 cost time: 23.415148735046387
Epoch: 6, Steps: 32 | Train Loss: 1.979 Vali Loss: 11.800 Vali Acc: 0.504 Test Loss: 11.800 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 23.512715578079224
Epoch: 7, Steps: 32 | Train Loss: 1.000 Vali Loss: 12.802 Vali Acc: 0.435 Test Loss: 12.802 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 23.892433166503906
Epoch: 8, Steps: 32 | Train Loss: 0.974 Vali Loss: 12.762 Vali Acc: 0.542 Test Loss: 12.762 Test Acc: 0.542
Validation loss decreased (-0.526651 --> -0.541857).  Saving model ...
Epoch: 9 cost time: 23.527719974517822
Epoch: 9, Steps: 32 | Train Loss: 0.391 Vali Loss: 14.378 Vali Acc: 0.557 Test Loss: 14.378 Test Acc: 0.557
Validation loss decreased (-0.541857 --> -0.557108).  Saving model ...
Epoch: 10 cost time: 24.05470085144043
Epoch: 10, Steps: 32 | Train Loss: 0.801 Vali Loss: 15.525 Vali Acc: 0.527 Test Loss: 15.525 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 23.696503400802612
Epoch: 11, Steps: 32 | Train Loss: 1.308 Vali Loss: 19.363 Vali Acc: 0.389 Test Loss: 19.363 Test Acc: 0.389
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 23.054022550582886
Epoch: 12, Steps: 32 | Train Loss: 0.301 Vali Loss: 20.671 Vali Acc: 0.519 Test Loss: 20.671 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 23.519301176071167
Epoch: 13, Steps: 32 | Train Loss: 1.148 Vali Loss: 25.033 Vali Acc: 0.534 Test Loss: 25.033 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 23.67925763130188
Epoch: 14, Steps: 32 | Train Loss: 0.729 Vali Loss: 23.307 Vali Acc: 0.489 Test Loss: 23.307 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 22.463724613189697
Epoch: 15, Steps: 32 | Train Loss: 1.572 Vali Loss: 16.701 Vali Acc: 0.473 Test Loss: 16.701 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 23.278318405151367
Epoch: 16, Steps: 32 | Train Loss: 0.536 Vali Loss: 17.508 Vali Acc: 0.458 Test Loss: 17.508 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 23.419291734695435
Epoch: 17, Steps: 32 | Train Loss: 1.073 Vali Loss: 23.629 Vali Acc: 0.489 Test Loss: 23.629 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 23.005091905593872
Epoch: 18, Steps: 32 | Train Loss: 0.211 Vali Loss: 30.108 Vali Acc: 0.328 Test Loss: 30.108 Test Acc: 0.328
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 23.23865294456482
Epoch: 19, Steps: 32 | Train Loss: 1.029 Vali Loss: 26.676 Vali Acc: 0.496 Test Loss: 26.676 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 3197733
model size : 13.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 16.507744312286377
Epoch: 1, Steps: 32 | Train Loss: 2.349 Vali Loss: 1.552 Vali Acc: 0.405 Test Loss: 1.552 Test Acc: 0.405
Validation loss decreased (inf --> -0.404565).  Saving model ...
Epoch: 2 cost time: 16.871087074279785
Epoch: 2, Steps: 32 | Train Loss: 1.459 Vali Loss: 3.222 Vali Acc: 0.527 Test Loss: 3.222 Test Acc: 0.527
Validation loss decreased (-0.404565 --> -0.526685).  Saving model ...
Epoch: 3 cost time: 16.890471935272217
Epoch: 3, Steps: 32 | Train Loss: 0.723 Vali Loss: 4.548 Vali Acc: 0.588 Test Loss: 4.548 Test Acc: 0.588
Validation loss decreased (-0.526685 --> -0.587741).  Saving model ...
Epoch: 4 cost time: 16.543152809143066
Epoch: 4, Steps: 32 | Train Loss: 1.290 Vali Loss: 5.922 Vali Acc: 0.473 Test Loss: 5.922 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 16.76863408088684
Epoch: 5, Steps: 32 | Train Loss: 0.338 Vali Loss: 7.901 Vali Acc: 0.359 Test Loss: 7.901 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 16.14591693878174
Epoch: 6, Steps: 32 | Train Loss: 0.217 Vali Loss: 7.113 Vali Acc: 0.511 Test Loss: 7.113 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 15.987898588180542
Epoch: 7, Steps: 32 | Train Loss: 0.821 Vali Loss: 8.835 Vali Acc: 0.389 Test Loss: 8.835 Test Acc: 0.389
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 16.529061555862427
Epoch: 8, Steps: 32 | Train Loss: 0.060 Vali Loss: 6.890 Vali Acc: 0.573 Test Loss: 6.890 Test Acc: 0.573
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 16.627608060836792
Epoch: 9, Steps: 32 | Train Loss: 0.327 Vali Loss: 11.017 Vali Acc: 0.542 Test Loss: 11.017 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 16.57985806465149
Epoch: 10, Steps: 32 | Train Loss: 1.224 Vali Loss: 11.427 Vali Acc: 0.458 Test Loss: 11.427 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 16.492127656936646
Epoch: 11, Steps: 32 | Train Loss: 0.486 Vali Loss: 11.103 Vali Acc: 0.595 Test Loss: 11.103 Test Acc: 0.595
Validation loss decreased (-0.587741 --> -0.595309).  Saving model ...
Epoch: 12 cost time: 16.46549153327942
Epoch: 12, Steps: 32 | Train Loss: 1.228 Vali Loss: 27.191 Vali Acc: 0.351 Test Loss: 27.191 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 16.257785081863403
Epoch: 13, Steps: 32 | Train Loss: 3.240 Vali Loss: 19.926 Vali Acc: 0.427 Test Loss: 19.926 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 17.262746334075928
Epoch: 14, Steps: 32 | Train Loss: 1.185 Vali Loss: 13.195 Vali Acc: 0.527 Test Loss: 13.195 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 16.08731985092163
Epoch: 15, Steps: 32 | Train Loss: 0.902 Vali Loss: 17.336 Vali Acc: 0.443 Test Loss: 17.336 Test Acc: 0.443
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 16.06437039375305
Epoch: 16, Steps: 32 | Train Loss: 0.426 Vali Loss: 27.348 Vali Acc: 0.206 Test Loss: 27.348 Test Acc: 0.206
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 16.5835177898407
Epoch: 17, Steps: 32 | Train Loss: 1.621 Vali Loss: 26.467 Vali Acc: 0.542 Test Loss: 26.467 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 16.299596786499023
Epoch: 18, Steps: 32 | Train Loss: 0.927 Vali Loss: 18.870 Vali Acc: 0.412 Test Loss: 18.870 Test Acc: 0.412
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 16.49550724029541
Epoch: 19, Steps: 32 | Train Loss: 0.032 Vali Loss: 20.166 Vali Acc: 0.580 Test Loss: 20.166 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 15.85246205329895
Epoch: 20, Steps: 32 | Train Loss: 0.223 Vali Loss: 19.962 Vali Acc: 0.427 Test Loss: 19.962 Test Acc: 0.427
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 16.516077280044556
Epoch: 21, Steps: 32 | Train Loss: 0.049 Vali Loss: 24.510 Vali Acc: 0.504 Test Loss: 24.510 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5954198473282443
model parameter : 1956165
model size : 8.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 26.80553436279297
Epoch: 1, Steps: 32 | Train Loss: 2.153 Vali Loss: 2.251 Vali Acc: 0.473 Test Loss: 2.251 Test Acc: 0.473
Validation loss decreased (inf --> -0.473260).  Saving model ...
Epoch: 2 cost time: 26.334207773208618
Epoch: 2, Steps: 32 | Train Loss: 2.231 Vali Loss: 3.845 Vali Acc: 0.450 Test Loss: 3.845 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 26.224029302597046
Epoch: 3, Steps: 32 | Train Loss: 1.018 Vali Loss: 4.158 Vali Acc: 0.321 Test Loss: 4.158 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 26.105761528015137
Epoch: 4, Steps: 32 | Train Loss: 0.791 Vali Loss: 8.332 Vali Acc: 0.557 Test Loss: 8.332 Test Acc: 0.557
Validation loss decreased (-0.473260 --> -0.557169).  Saving model ...
Epoch: 5 cost time: 26.401344776153564
Epoch: 5, Steps: 32 | Train Loss: 1.178 Vali Loss: 4.444 Vali Acc: 0.534 Test Loss: 4.444 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 26.126863956451416
Epoch: 6, Steps: 32 | Train Loss: 0.845 Vali Loss: 10.295 Vali Acc: 0.534 Test Loss: 10.295 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 26.028217554092407
Epoch: 7, Steps: 32 | Train Loss: 0.671 Vali Loss: 12.577 Vali Acc: 0.565 Test Loss: 12.577 Test Acc: 0.565
Validation loss decreased (-0.557169 --> -0.564760).  Saving model ...
Epoch: 8 cost time: 26.09613585472107
Epoch: 8, Steps: 32 | Train Loss: 0.234 Vali Loss: 12.213 Vali Acc: 0.573 Test Loss: 12.213 Test Acc: 0.573
Validation loss decreased (-0.564760 --> -0.572397).  Saving model ...
Epoch: 9 cost time: 26.10423493385315
Epoch: 9, Steps: 32 | Train Loss: 0.318 Vali Loss: 14.511 Vali Acc: 0.405 Test Loss: 14.511 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 25.867218494415283
Epoch: 10, Steps: 32 | Train Loss: 1.303 Vali Loss: 15.609 Vali Acc: 0.359 Test Loss: 15.609 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 26.144614934921265
Epoch: 11, Steps: 32 | Train Loss: 2.228 Vali Loss: 11.671 Vali Acc: 0.527 Test Loss: 11.671 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 26.115905046463013
Epoch: 12, Steps: 32 | Train Loss: 1.555 Vali Loss: 21.172 Vali Acc: 0.527 Test Loss: 21.172 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 26.08343815803528
Epoch: 13, Steps: 32 | Train Loss: 2.975 Vali Loss: 19.570 Vali Acc: 0.412 Test Loss: 19.570 Test Acc: 0.412
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 25.706921815872192
Epoch: 14, Steps: 32 | Train Loss: 0.798 Vali Loss: 20.450 Vali Acc: 0.397 Test Loss: 20.450 Test Acc: 0.397
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 25.80031132698059
Epoch: 15, Steps: 32 | Train Loss: 0.882 Vali Loss: 20.600 Vali Acc: 0.496 Test Loss: 20.600 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 25.7831449508667
Epoch: 16, Steps: 32 | Train Loss: 0.095 Vali Loss: 20.690 Vali Acc: 0.527 Test Loss: 20.690 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 25.775868892669678
Epoch: 17, Steps: 32 | Train Loss: 0.680 Vali Loss: 22.341 Vali Acc: 0.473 Test Loss: 22.341 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 26.00907325744629
Epoch: 18, Steps: 32 | Train Loss: 0.326 Vali Loss: 32.232 Vali Acc: 0.405 Test Loss: 32.232 Test Acc: 0.405
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 2318565
model size : 9.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 13.427589654922485
Epoch: 1, Steps: 32 | Train Loss: 2.897 Vali Loss: 4.324 Vali Acc: 0.191 Test Loss: 4.324 Test Acc: 0.191
Validation loss decreased (inf --> -0.190796).  Saving model ...
Epoch: 2 cost time: 12.335264682769775
Epoch: 2, Steps: 32 | Train Loss: 1.345 Vali Loss: 2.523 Vali Acc: 0.527 Test Loss: 2.523 Test Acc: 0.527
Validation loss decreased (-0.190796 --> -0.526692).  Saving model ...
Epoch: 3 cost time: 12.615650415420532
Epoch: 3, Steps: 32 | Train Loss: 1.129 Vali Loss: 5.315 Vali Acc: 0.542 Test Loss: 5.315 Test Acc: 0.542
Validation loss decreased (-0.526692 --> -0.541932).  Saving model ...
Epoch: 4 cost time: 12.377865076065063
Epoch: 4, Steps: 32 | Train Loss: 0.662 Vali Loss: 4.377 Vali Acc: 0.527 Test Loss: 4.377 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.549310445785522
Epoch: 5, Steps: 32 | Train Loss: 0.966 Vali Loss: 6.774 Vali Acc: 0.458 Test Loss: 6.774 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 12.457340002059937
Epoch: 6, Steps: 32 | Train Loss: 0.540 Vali Loss: 6.769 Vali Acc: 0.550 Test Loss: 6.769 Test Acc: 0.550
Validation loss decreased (-0.541932 --> -0.549551).  Saving model ...
Epoch: 7 cost time: 12.489702939987183
Epoch: 7, Steps: 32 | Train Loss: 0.439 Vali Loss: 8.443 Vali Acc: 0.427 Test Loss: 8.443 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 12.536138534545898
Epoch: 8, Steps: 32 | Train Loss: 0.316 Vali Loss: 11.735 Vali Acc: 0.366 Test Loss: 11.735 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 12.484537363052368
Epoch: 9, Steps: 32 | Train Loss: 0.774 Vali Loss: 17.400 Vali Acc: 0.198 Test Loss: 17.400 Test Acc: 0.198
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 12.629110336303711
Epoch: 10, Steps: 32 | Train Loss: 0.848 Vali Loss: 13.419 Vali Acc: 0.542 Test Loss: 13.419 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 12.688241720199585
Epoch: 11, Steps: 32 | Train Loss: 0.176 Vali Loss: 14.050 Vali Acc: 0.466 Test Loss: 14.050 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 12.700631380081177
Epoch: 12, Steps: 32 | Train Loss: 1.747 Vali Loss: 12.665 Vali Acc: 0.527 Test Loss: 12.665 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 12.680479288101196
Epoch: 13, Steps: 32 | Train Loss: 0.567 Vali Loss: 17.907 Vali Acc: 0.534 Test Loss: 17.907 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 12.774848699569702
Epoch: 14, Steps: 32 | Train Loss: 0.512 Vali Loss: 16.895 Vali Acc: 0.534 Test Loss: 16.895 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 12.621736764907837
Epoch: 15, Steps: 32 | Train Loss: 0.537 Vali Loss: 16.945 Vali Acc: 0.565 Test Loss: 16.945 Test Acc: 0.565
Validation loss decreased (-0.549551 --> -0.564716).  Saving model ...
Epoch: 16 cost time: 12.867352962493896
Epoch: 16, Steps: 32 | Train Loss: 0.780 Vali Loss: 19.963 Vali Acc: 0.473 Test Loss: 19.963 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 12.466294050216675
Epoch: 17, Steps: 32 | Train Loss: 0.958 Vali Loss: 19.048 Vali Acc: 0.458 Test Loss: 19.048 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 12.630961894989014
Epoch: 18, Steps: 32 | Train Loss: 0.806 Vali Loss: 34.264 Vali Acc: 0.221 Test Loss: 34.264 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 12.660136938095093
Epoch: 19, Steps: 32 | Train Loss: 0.402 Vali Loss: 35.857 Vali Acc: 0.527 Test Loss: 35.857 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 12.624655723571777
Epoch: 20, Steps: 32 | Train Loss: 0.559 Vali Loss: 32.651 Vali Acc: 0.534 Test Loss: 32.651 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 12.469896793365479
Epoch: 21, Steps: 32 | Train Loss: 1.200 Vali Loss: 38.132 Vali Acc: 0.313 Test Loss: 38.132 Test Acc: 0.313
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 12.443642377853394
Epoch: 22, Steps: 32 | Train Loss: 0.477 Vali Loss: 27.886 Vali Acc: 0.550 Test Loss: 27.886 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 12.514182567596436
Epoch: 23, Steps: 32 | Train Loss: 0.169 Vali Loss: 26.147 Vali Acc: 0.565 Test Loss: 26.147 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 12.663779020309448
Epoch: 24, Steps: 32 | Train Loss: 0.387 Vali Loss: 23.220 Vali Acc: 0.573 Test Loss: 23.220 Test Acc: 0.573
Validation loss decreased (-0.564716 --> -0.572287).  Saving model ...
Epoch: 25 cost time: 12.631165981292725
Epoch: 25, Steps: 32 | Train Loss: 0.348 Vali Loss: 29.803 Vali Acc: 0.542 Test Loss: 29.803 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 12.6622633934021
Epoch: 26, Steps: 32 | Train Loss: 0.238 Vali Loss: 24.649 Vali Acc: 0.550 Test Loss: 24.649 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 12.693910121917725
Epoch: 27, Steps: 32 | Train Loss: 0.001 Vali Loss: 27.735 Vali Acc: 0.573 Test Loss: 27.735 Test Acc: 0.573
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 12.627371311187744
Epoch: 28, Steps: 32 | Train Loss: 1.994 Vali Loss: 35.507 Vali Acc: 0.550 Test Loss: 35.507 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 12.677743911743164
Epoch: 29, Steps: 32 | Train Loss: 0.464 Vali Loss: 30.747 Vali Acc: 0.542 Test Loss: 30.747 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 12.602060317993164
Epoch: 30, Steps: 32 | Train Loss: 0.000 Vali Loss: 34.930 Vali Acc: 0.550 Test Loss: 34.930 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 1697733
model size : 7.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 19.226106643676758
Epoch: 1, Steps: 32 | Train Loss: 2.166 Vali Loss: 2.140 Vali Acc: 0.405 Test Loss: 2.140 Test Acc: 0.405
Validation loss decreased (inf --> -0.404559).  Saving model ...
Epoch: 2 cost time: 18.2812340259552
Epoch: 2, Steps: 32 | Train Loss: 1.357 Vali Loss: 5.252 Vali Acc: 0.427 Test Loss: 5.252 Test Acc: 0.427
Validation loss decreased (-0.404559 --> -0.427428).  Saving model ...
Epoch: 3 cost time: 18.20570707321167
Epoch: 3, Steps: 32 | Train Loss: 1.084 Vali Loss: 6.109 Vali Acc: 0.267 Test Loss: 6.109 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 17.98435664176941
Epoch: 4, Steps: 32 | Train Loss: 0.391 Vali Loss: 5.319 Vali Acc: 0.443 Test Loss: 5.319 Test Acc: 0.443
Validation loss decreased (-0.427428 --> -0.442695).  Saving model ...
Epoch: 5 cost time: 18.11451029777527
Epoch: 5, Steps: 32 | Train Loss: 0.978 Vali Loss: 8.242 Vali Acc: 0.466 Test Loss: 8.242 Test Acc: 0.466
Validation loss decreased (-0.442695 --> -0.465566).  Saving model ...
Epoch: 6 cost time: 18.193024158477783
Epoch: 6, Steps: 32 | Train Loss: 0.911 Vali Loss: 11.477 Vali Acc: 0.534 Test Loss: 11.477 Test Acc: 0.534
Validation loss decreased (-0.465566 --> -0.534236).  Saving model ...
Epoch: 7 cost time: 18.197405338287354
Epoch: 7, Steps: 32 | Train Loss: 0.308 Vali Loss: 11.358 Vali Acc: 0.351 Test Loss: 11.358 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 18.33803677558899
Epoch: 8, Steps: 32 | Train Loss: 0.164 Vali Loss: 9.850 Vali Acc: 0.565 Test Loss: 9.850 Test Acc: 0.565
Validation loss decreased (-0.534236 --> -0.564787).  Saving model ...
Epoch: 9 cost time: 18.038787126541138
Epoch: 9, Steps: 32 | Train Loss: 0.045 Vali Loss: 8.590 Vali Acc: 0.458 Test Loss: 8.590 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 18.317977905273438
Epoch: 10, Steps: 32 | Train Loss: 1.102 Vali Loss: 16.685 Vali Acc: 0.534 Test Loss: 16.685 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 18.023602724075317
Epoch: 11, Steps: 32 | Train Loss: 1.699 Vali Loss: 16.917 Vali Acc: 0.298 Test Loss: 16.917 Test Acc: 0.298
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 18.099827527999878
Epoch: 12, Steps: 32 | Train Loss: 0.735 Vali Loss: 23.424 Vali Acc: 0.252 Test Loss: 23.424 Test Acc: 0.252
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 17.975017786026
Epoch: 13, Steps: 32 | Train Loss: 1.025 Vali Loss: 15.798 Vali Acc: 0.405 Test Loss: 15.798 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 18.101556301116943
Epoch: 14, Steps: 32 | Train Loss: 0.194 Vali Loss: 19.449 Vali Acc: 0.504 Test Loss: 19.449 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 17.99569034576416
Epoch: 15, Steps: 32 | Train Loss: 0.327 Vali Loss: 22.487 Vali Acc: 0.427 Test Loss: 22.487 Test Acc: 0.427
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 17.874672174453735
Epoch: 16, Steps: 32 | Train Loss: 1.402 Vali Loss: 20.423 Vali Acc: 0.427 Test Loss: 20.423 Test Acc: 0.427
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 17.901533842086792
Epoch: 17, Steps: 32 | Train Loss: 1.244 Vali Loss: 28.083 Vali Acc: 0.519 Test Loss: 28.083 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 17.89174747467041
Epoch: 18, Steps: 32 | Train Loss: 0.095 Vali Loss: 26.461 Vali Acc: 0.305 Test Loss: 26.461 Test Acc: 0.305
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 2318565
model size : 9.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 10.347466945648193
Epoch: 1, Steps: 32 | Train Loss: 2.897 Vali Loss: 4.524 Vali Acc: 0.191 Test Loss: 4.524 Test Acc: 0.191
Validation loss decreased (inf --> -0.190794).  Saving model ...
Epoch: 2 cost time: 9.12144136428833
Epoch: 2, Steps: 32 | Train Loss: 1.170 Vali Loss: 2.717 Vali Acc: 0.412 Test Loss: 2.717 Test Acc: 0.412
Validation loss decreased (-0.190794 --> -0.412187).  Saving model ...
Epoch: 3 cost time: 9.298230648040771
Epoch: 3, Steps: 32 | Train Loss: 1.002 Vali Loss: 4.024 Vali Acc: 0.565 Test Loss: 4.024 Test Acc: 0.565
Validation loss decreased (-0.412187 --> -0.564845).  Saving model ...
Epoch: 4 cost time: 9.513403415679932
Epoch: 4, Steps: 32 | Train Loss: 0.414 Vali Loss: 9.823 Vali Acc: 0.374 Test Loss: 9.823 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.556237697601318
Epoch: 5, Steps: 32 | Train Loss: 2.844 Vali Loss: 9.334 Vali Acc: 0.389 Test Loss: 9.334 Test Acc: 0.389
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 9.629198551177979
Epoch: 6, Steps: 32 | Train Loss: 0.371 Vali Loss: 6.890 Vali Acc: 0.435 Test Loss: 6.890 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 9.525017261505127
Epoch: 7, Steps: 32 | Train Loss: 0.565 Vali Loss: 12.183 Vali Acc: 0.427 Test Loss: 12.183 Test Acc: 0.427
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 9.616353750228882
Epoch: 8, Steps: 32 | Train Loss: 0.373 Vali Loss: 13.734 Vali Acc: 0.481 Test Loss: 13.734 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 9.74332857131958
Epoch: 9, Steps: 32 | Train Loss: 1.372 Vali Loss: 13.917 Vali Acc: 0.489 Test Loss: 13.917 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 9.563120365142822
Epoch: 10, Steps: 32 | Train Loss: 1.621 Vali Loss: 14.366 Vali Acc: 0.519 Test Loss: 14.366 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 9.523658990859985
Epoch: 11, Steps: 32 | Train Loss: 0.015 Vali Loss: 16.849 Vali Acc: 0.527 Test Loss: 16.849 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 9.706756591796875
Epoch: 12, Steps: 32 | Train Loss: 0.215 Vali Loss: 14.394 Vali Acc: 0.504 Test Loss: 14.394 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 9.5589919090271
Epoch: 13, Steps: 32 | Train Loss: 0.091 Vali Loss: 19.028 Vali Acc: 0.328 Test Loss: 19.028 Test Acc: 0.328
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 1697733
model size : 7.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 9.967322826385498
Epoch: 1, Steps: 32 | Train Loss: 2.147 Vali Loss: 2.015 Vali Acc: 0.397 Test Loss: 2.015 Test Acc: 0.397
Validation loss decreased (inf --> -0.396926).  Saving model ...
Epoch: 2 cost time: 9.43254566192627
Epoch: 2, Steps: 32 | Train Loss: 1.229 Vali Loss: 3.451 Vali Acc: 0.557 Test Loss: 3.451 Test Acc: 0.557
Validation loss decreased (-0.396926 --> -0.557217).  Saving model ...
Epoch: 3 cost time: 9.20911169052124
Epoch: 3, Steps: 32 | Train Loss: 0.906 Vali Loss: 4.892 Vali Acc: 0.412 Test Loss: 4.892 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.534093856811523
Epoch: 4, Steps: 32 | Train Loss: 0.387 Vali Loss: 6.244 Vali Acc: 0.519 Test Loss: 6.244 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 9.11061978340149
Epoch: 5, Steps: 32 | Train Loss: 1.045 Vali Loss: 6.811 Vali Acc: 0.504 Test Loss: 6.811 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 9.541788101196289
Epoch: 6, Steps: 32 | Train Loss: 1.352 Vali Loss: 12.764 Vali Acc: 0.534 Test Loss: 12.764 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 9.268341779708862
Epoch: 7, Steps: 32 | Train Loss: 0.800 Vali Loss: 10.830 Vali Acc: 0.527 Test Loss: 10.830 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 9.49431324005127
Epoch: 8, Steps: 32 | Train Loss: 0.270 Vali Loss: 8.966 Vali Acc: 0.580 Test Loss: 8.966 Test Acc: 0.580
Validation loss decreased (-0.557217 --> -0.580063).  Saving model ...
Epoch: 9 cost time: 8.838125944137573
Epoch: 9, Steps: 32 | Train Loss: 0.076 Vali Loss: 7.247 Vali Acc: 0.573 Test Loss: 7.247 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 9.177390575408936
Epoch: 10, Steps: 32 | Train Loss: 0.099 Vali Loss: 12.684 Vali Acc: 0.534 Test Loss: 12.684 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 8.997875928878784
Epoch: 11, Steps: 32 | Train Loss: 0.196 Vali Loss: 9.335 Vali Acc: 0.412 Test Loss: 9.335 Test Acc: 0.412
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 9.18462610244751
Epoch: 12, Steps: 32 | Train Loss: 0.527 Vali Loss: 15.149 Vali Acc: 0.328 Test Loss: 15.149 Test Acc: 0.328
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 8.986004114151001
Epoch: 13, Steps: 32 | Train Loss: 1.131 Vali Loss: 15.018 Vali Acc: 0.397 Test Loss: 15.018 Test Acc: 0.397
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 8.863487720489502
Epoch: 14, Steps: 32 | Train Loss: 0.284 Vali Loss: 20.183 Vali Acc: 0.542 Test Loss: 20.183 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 8.998484373092651
Epoch: 15, Steps: 32 | Train Loss: 1.897 Vali Loss: 17.610 Vali Acc: 0.435 Test Loss: 17.610 Test Acc: 0.435
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 9.209915161132812
Epoch: 16, Steps: 32 | Train Loss: 0.913 Vali Loss: 25.635 Vali Acc: 0.397 Test Loss: 25.635 Test Acc: 0.397
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 8.967955827713013
Epoch: 17, Steps: 32 | Train Loss: 0.992 Vali Loss: 24.663 Vali Acc: 0.580 Test Loss: 24.663 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 9.080106973648071
Epoch: 18, Steps: 32 | Train Loss: 0.830 Vali Loss: 21.519 Vali Acc: 0.588 Test Loss: 21.519 Test Acc: 0.588
Validation loss decreased (-0.580063 --> -0.587571).  Saving model ...
Epoch: 19 cost time: 8.994938850402832
Epoch: 19, Steps: 32 | Train Loss: 0.051 Vali Loss: 30.417 Vali Acc: 0.351 Test Loss: 30.417 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 8.97999119758606
Epoch: 20, Steps: 32 | Train Loss: 0.899 Vali Loss: 22.863 Vali Acc: 0.458 Test Loss: 22.863 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 8.841984510421753
Epoch: 21, Steps: 32 | Train Loss: 0.208 Vali Loss: 28.249 Vali Acc: 0.466 Test Loss: 28.249 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 9.061754703521729
Epoch: 22, Steps: 32 | Train Loss: 0.938 Vali Loss: 23.228 Vali Acc: 0.519 Test Loss: 23.228 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 8.852259159088135
Epoch: 23, Steps: 32 | Train Loss: 0.227 Vali Loss: 30.421 Vali Acc: 0.344 Test Loss: 30.421 Test Acc: 0.344
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 9.04471492767334
Epoch: 24, Steps: 32 | Train Loss: 0.975 Vali Loss: 36.485 Vali Acc: 0.542 Test Loss: 36.485 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 9.127323865890503
Epoch: 25, Steps: 32 | Train Loss: 1.301 Vali Loss: 25.582 Vali Acc: 0.527 Test Loss: 25.582 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 9.208044528961182
Epoch: 26, Steps: 32 | Train Loss: 1.057 Vali Loss: 26.556 Vali Acc: 0.481 Test Loss: 26.556 Test Acc: 0.481
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 9.219690561294556
Epoch: 27, Steps: 32 | Train Loss: 0.200 Vali Loss: 30.210 Vali Acc: 0.458 Test Loss: 30.210 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 9.189035654067993
Epoch: 28, Steps: 32 | Train Loss: 1.770 Vali Loss: 29.130 Vali Acc: 0.489 Test Loss: 29.130 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 2318565
model size : 9.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 6.7337493896484375
Epoch: 1, Steps: 32 | Train Loss: 2.913 Vali Loss: 4.309 Vali Acc: 0.183 Test Loss: 4.309 Test Acc: 0.183
Validation loss decreased (inf --> -0.183163).  Saving model ...
Epoch: 2 cost time: 5.564853668212891
Epoch: 2, Steps: 32 | Train Loss: 1.248 Vali Loss: 3.447 Vali Acc: 0.260 Test Loss: 3.447 Test Acc: 0.260
Validation loss decreased (-0.183163 --> -0.259508).  Saving model ...
Epoch: 3 cost time: 5.514962434768677
Epoch: 3, Steps: 32 | Train Loss: 2.242 Vali Loss: 9.364 Vali Acc: 0.489 Test Loss: 9.364 Test Acc: 0.489
Validation loss decreased (-0.259508 --> -0.488456).  Saving model ...
Epoch: 4 cost time: 5.689736604690552
Epoch: 4, Steps: 32 | Train Loss: 1.271 Vali Loss: 4.416 Vali Acc: 0.519 Test Loss: 4.416 Test Acc: 0.519
Validation loss decreased (-0.488456 --> -0.519040).  Saving model ...
Epoch: 5 cost time: 5.643683910369873
Epoch: 5, Steps: 32 | Train Loss: 0.655 Vali Loss: 5.095 Vali Acc: 0.580 Test Loss: 5.095 Test Acc: 0.580
Validation loss decreased (-0.519040 --> -0.580102).  Saving model ...
Epoch: 6 cost time: 5.806766986846924
Epoch: 6, Steps: 32 | Train Loss: 0.281 Vali Loss: 9.812 Vali Acc: 0.298 Test Loss: 9.812 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.771397829055786
Epoch: 7, Steps: 32 | Train Loss: 0.126 Vali Loss: 8.039 Vali Acc: 0.473 Test Loss: 8.039 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.615340232849121
Epoch: 8, Steps: 32 | Train Loss: 1.241 Vali Loss: 10.640 Vali Acc: 0.511 Test Loss: 10.640 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.735750675201416
Epoch: 9, Steps: 32 | Train Loss: 1.256 Vali Loss: 11.777 Vali Acc: 0.496 Test Loss: 11.777 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.69836163520813
Epoch: 10, Steps: 32 | Train Loss: 0.634 Vali Loss: 15.845 Vali Acc: 0.351 Test Loss: 15.845 Test Acc: 0.351
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.690273761749268
Epoch: 11, Steps: 32 | Train Loss: 0.398 Vali Loss: 15.193 Vali Acc: 0.473 Test Loss: 15.193 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.736731290817261
Epoch: 12, Steps: 32 | Train Loss: 1.565 Vali Loss: 16.441 Vali Acc: 0.511 Test Loss: 16.441 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 5.662899494171143
Epoch: 13, Steps: 32 | Train Loss: 0.291 Vali Loss: 16.214 Vali Acc: 0.359 Test Loss: 16.214 Test Acc: 0.359
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 5.535431146621704
Epoch: 14, Steps: 32 | Train Loss: 0.598 Vali Loss: 15.369 Vali Acc: 0.527 Test Loss: 15.369 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 5.79969048500061
Epoch: 15, Steps: 32 | Train Loss: 0.146 Vali Loss: 17.468 Vali Acc: 0.527 Test Loss: 17.468 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 1697733
model size : 7.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 17.455057621002197
Epoch: 1, Steps: 32 | Train Loss: 2.107 Vali Loss: 2.078 Vali Acc: 0.344 Test Loss: 2.078 Test Acc: 0.344
Validation loss decreased (inf --> -0.343491).  Saving model ...
Epoch: 2 cost time: 17.486062049865723
Epoch: 2, Steps: 32 | Train Loss: 1.378 Vali Loss: 3.362 Vali Acc: 0.489 Test Loss: 3.362 Test Acc: 0.489
Validation loss decreased (-0.343491 --> -0.488516).  Saving model ...
Epoch: 3 cost time: 17.317286014556885
Epoch: 3, Steps: 32 | Train Loss: 2.645 Vali Loss: 5.350 Vali Acc: 0.534 Test Loss: 5.350 Test Acc: 0.534
Validation loss decreased (-0.488516 --> -0.534298).  Saving model ...
Epoch: 4 cost time: 17.231746912002563
Epoch: 4, Steps: 32 | Train Loss: 0.422 Vali Loss: 5.506 Vali Acc: 0.519 Test Loss: 5.506 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 16.927514791488647
Epoch: 5, Steps: 32 | Train Loss: 0.757 Vali Loss: 8.342 Vali Acc: 0.519 Test Loss: 8.342 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 17.074712991714478
Epoch: 6, Steps: 32 | Train Loss: 1.012 Vali Loss: 8.847 Vali Acc: 0.580 Test Loss: 8.847 Test Acc: 0.580
Validation loss decreased (-0.534298 --> -0.580064).  Saving model ...
Epoch: 7 cost time: 16.81007194519043
Epoch: 7, Steps: 32 | Train Loss: 0.745 Vali Loss: 11.583 Vali Acc: 0.282 Test Loss: 11.583 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 17.260554313659668
Epoch: 8, Steps: 32 | Train Loss: 0.173 Vali Loss: 6.269 Vali Acc: 0.534 Test Loss: 6.269 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 16.943553924560547
Epoch: 9, Steps: 32 | Train Loss: 0.576 Vali Loss: 9.668 Vali Acc: 0.504 Test Loss: 9.668 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 17.295802354812622
Epoch: 10, Steps: 32 | Train Loss: 0.861 Vali Loss: 37.195 Vali Acc: 0.214 Test Loss: 37.195 Test Acc: 0.214
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 16.82965874671936
Epoch: 11, Steps: 32 | Train Loss: 2.240 Vali Loss: 24.425 Vali Acc: 0.359 Test Loss: 24.425 Test Acc: 0.359
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 17.169548749923706
Epoch: 12, Steps: 32 | Train Loss: 0.312 Vali Loss: 15.377 Vali Acc: 0.580 Test Loss: 15.377 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 17.215196132659912
Epoch: 13, Steps: 32 | Train Loss: 0.570 Vali Loss: 13.968 Vali Acc: 0.534 Test Loss: 13.968 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 16.95608878135681
Epoch: 14, Steps: 32 | Train Loss: 1.764 Vali Loss: 29.831 Vali Acc: 0.282 Test Loss: 29.831 Test Acc: 0.282
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 16.896925449371338
Epoch: 15, Steps: 32 | Train Loss: 1.055 Vali Loss: 19.281 Vali Acc: 0.573 Test Loss: 19.281 Test Acc: 0.573
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 17.06853151321411
Epoch: 16, Steps: 32 | Train Loss: 0.535 Vali Loss: 19.196 Vali Acc: 0.557 Test Loss: 19.196 Test Acc: 0.557
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 1878981
model size : 8.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 8.755542755126953
Epoch: 1, Steps: 32 | Train Loss: 2.706 Vali Loss: 4.991 Vali Acc: 0.443 Test Loss: 4.991 Test Acc: 0.443
Validation loss decreased (inf --> -0.442698).  Saving model ...
Epoch: 2 cost time: 7.8381829261779785
Epoch: 2, Steps: 32 | Train Loss: 2.628 Vali Loss: 3.931 Vali Acc: 0.244 Test Loss: 3.931 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.0639328956604
Epoch: 3, Steps: 32 | Train Loss: 1.382 Vali Loss: 3.484 Vali Acc: 0.542 Test Loss: 3.484 Test Acc: 0.542
Validation loss decreased (-0.442698 --> -0.541950).  Saving model ...
Epoch: 4 cost time: 8.010762691497803
Epoch: 4, Steps: 32 | Train Loss: 0.613 Vali Loss: 3.513 Vali Acc: 0.550 Test Loss: 3.513 Test Acc: 0.550
Validation loss decreased (-0.541950 --> -0.549583).  Saving model ...
Epoch: 5 cost time: 8.131995916366577
Epoch: 5, Steps: 32 | Train Loss: 1.189 Vali Loss: 7.446 Vali Acc: 0.290 Test Loss: 7.446 Test Acc: 0.290
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.203762531280518
Epoch: 6, Steps: 32 | Train Loss: 0.829 Vali Loss: 6.834 Vali Acc: 0.519 Test Loss: 6.834 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 8.115001916885376
Epoch: 7, Steps: 32 | Train Loss: 1.584 Vali Loss: 14.541 Vali Acc: 0.298 Test Loss: 14.541 Test Acc: 0.298
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 8.297144174575806
Epoch: 8, Steps: 32 | Train Loss: 0.628 Vali Loss: 11.845 Vali Acc: 0.321 Test Loss: 11.845 Test Acc: 0.321
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 8.117751836776733
Epoch: 9, Steps: 32 | Train Loss: 0.546 Vali Loss: 7.759 Vali Acc: 0.427 Test Loss: 7.759 Test Acc: 0.427
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 8.046246767044067
Epoch: 10, Steps: 32 | Train Loss: 0.183 Vali Loss: 15.899 Vali Acc: 0.389 Test Loss: 15.899 Test Acc: 0.389
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 8.103142738342285
Epoch: 11, Steps: 32 | Train Loss: 0.830 Vali Loss: 15.030 Vali Acc: 0.565 Test Loss: 15.030 Test Acc: 0.565
Validation loss decreased (-0.549583 --> -0.564735).  Saving model ...
Epoch: 12 cost time: 8.025461196899414
Epoch: 12, Steps: 32 | Train Loss: 0.953 Vali Loss: 22.514 Vali Acc: 0.534 Test Loss: 22.514 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 8.07058835029602
Epoch: 13, Steps: 32 | Train Loss: 1.089 Vali Loss: 25.352 Vali Acc: 0.313 Test Loss: 25.352 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 8.297927618026733
Epoch: 14, Steps: 32 | Train Loss: 2.856 Vali Loss: 26.093 Vali Acc: 0.351 Test Loss: 26.093 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 8.051120042800903
Epoch: 15, Steps: 32 | Train Loss: 1.376 Vali Loss: 28.015 Vali Acc: 0.267 Test Loss: 28.015 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 8.094443798065186
Epoch: 16, Steps: 32 | Train Loss: 0.591 Vali Loss: 22.738 Vali Acc: 0.519 Test Loss: 22.738 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 8.056969404220581
Epoch: 17, Steps: 32 | Train Loss: 0.173 Vali Loss: 30.377 Vali Acc: 0.473 Test Loss: 30.377 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 8.12622332572937
Epoch: 18, Steps: 32 | Train Loss: 0.162 Vali Loss: 23.583 Vali Acc: 0.298 Test Loss: 23.583 Test Acc: 0.298
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 8.165716886520386
Epoch: 19, Steps: 32 | Train Loss: 0.546 Vali Loss: 20.432 Vali Acc: 0.496 Test Loss: 20.432 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 8.09739875793457
Epoch: 20, Steps: 32 | Train Loss: 2.442 Vali Loss: 26.607 Vali Acc: 0.527 Test Loss: 26.607 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 8.07104229927063
Epoch: 21, Steps: 32 | Train Loss: 0.188 Vali Loss: 27.159 Vali Acc: 0.542 Test Loss: 27.159 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 1568517
model size : 7.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 11.98442268371582
Epoch: 1, Steps: 32 | Train Loss: 2.118 Vali Loss: 1.955 Vali Acc: 0.382 Test Loss: 1.955 Test Acc: 0.382
Validation loss decreased (inf --> -0.381660).  Saving model ...
Epoch: 2 cost time: 11.451202869415283
Epoch: 2, Steps: 32 | Train Loss: 1.300 Vali Loss: 2.639 Vali Acc: 0.565 Test Loss: 2.639 Test Acc: 0.565
Validation loss decreased (-0.381660 --> -0.564859).  Saving model ...
Epoch: 3 cost time: 11.736924171447754
Epoch: 3, Steps: 32 | Train Loss: 3.785 Vali Loss: 6.304 Vali Acc: 0.496 Test Loss: 6.304 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.67896294593811
Epoch: 4, Steps: 32 | Train Loss: 1.625 Vali Loss: 6.716 Vali Acc: 0.489 Test Loss: 6.716 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 11.730204820632935
Epoch: 5, Steps: 32 | Train Loss: 2.225 Vali Loss: 11.945 Vali Acc: 0.557 Test Loss: 11.945 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 11.856148958206177
Epoch: 6, Steps: 32 | Train Loss: 0.601 Vali Loss: 9.013 Vali Acc: 0.626 Test Loss: 9.013 Test Acc: 0.626
Validation loss decreased (-0.564859 --> -0.625864).  Saving model ...
Epoch: 7 cost time: 11.297260522842407
Epoch: 7, Steps: 32 | Train Loss: 1.636 Vali Loss: 8.188 Vali Acc: 0.511 Test Loss: 8.188 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 11.281121969223022
Epoch: 8, Steps: 32 | Train Loss: 0.464 Vali Loss: 9.424 Vali Acc: 0.588 Test Loss: 9.424 Test Acc: 0.588
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 11.22957968711853
Epoch: 9, Steps: 32 | Train Loss: 0.106 Vali Loss: 11.594 Vali Acc: 0.557 Test Loss: 11.594 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 11.370914936065674
Epoch: 10, Steps: 32 | Train Loss: 0.104 Vali Loss: 11.033 Vali Acc: 0.504 Test Loss: 11.033 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 11.349924802780151
Epoch: 11, Steps: 32 | Train Loss: 0.242 Vali Loss: 9.733 Vali Acc: 0.573 Test Loss: 9.733 Test Acc: 0.573
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 11.381107091903687
Epoch: 12, Steps: 32 | Train Loss: 0.394 Vali Loss: 11.241 Vali Acc: 0.603 Test Loss: 11.241 Test Acc: 0.603
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 11.666682243347168
Epoch: 13, Steps: 32 | Train Loss: 0.298 Vali Loss: 15.685 Vali Acc: 0.412 Test Loss: 15.685 Test Acc: 0.412
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 11.488272905349731
Epoch: 14, Steps: 32 | Train Loss: 0.751 Vali Loss: 13.993 Vali Acc: 0.397 Test Loss: 13.993 Test Acc: 0.397
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 11.420289754867554
Epoch: 15, Steps: 32 | Train Loss: 0.067 Vali Loss: 18.962 Vali Acc: 0.565 Test Loss: 18.962 Test Acc: 0.565
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 11.531328916549683
Epoch: 16, Steps: 32 | Train Loss: 0.339 Vali Loss: 15.855 Vali Acc: 0.496 Test Loss: 15.855 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6259541984732825
model parameter : 1878981
model size : 8.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 6.988135576248169
Epoch: 1, Steps: 32 | Train Loss: 2.787 Vali Loss: 5.134 Vali Acc: 0.443 Test Loss: 5.134 Test Acc: 0.443
Validation loss decreased (inf --> -0.442697).  Saving model ...
Epoch: 2 cost time: 5.766982316970825
Epoch: 2, Steps: 32 | Train Loss: 2.546 Vali Loss: 3.670 Vali Acc: 0.237 Test Loss: 3.670 Test Acc: 0.237
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.849250078201294
Epoch: 3, Steps: 32 | Train Loss: 1.498 Vali Loss: 2.382 Vali Acc: 0.534 Test Loss: 2.382 Test Acc: 0.534
Validation loss decreased (-0.442697 --> -0.534327).  Saving model ...
Epoch: 4 cost time: 6.002340316772461
Epoch: 4, Steps: 32 | Train Loss: 0.923 Vali Loss: 6.543 Vali Acc: 0.519 Test Loss: 6.543 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.232020378112793
Epoch: 5, Steps: 32 | Train Loss: 1.359 Vali Loss: 5.521 Vali Acc: 0.511 Test Loss: 5.521 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.071685314178467
Epoch: 6, Steps: 32 | Train Loss: 0.569 Vali Loss: 9.925 Vali Acc: 0.542 Test Loss: 9.925 Test Acc: 0.542
Validation loss decreased (-0.534327 --> -0.541885).  Saving model ...
Epoch: 7 cost time: 6.042647838592529
Epoch: 7, Steps: 32 | Train Loss: 0.405 Vali Loss: 5.871 Vali Acc: 0.466 Test Loss: 5.871 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.243969440460205
Epoch: 8, Steps: 32 | Train Loss: 0.182 Vali Loss: 9.064 Vali Acc: 0.550 Test Loss: 9.064 Test Acc: 0.550
Validation loss decreased (-0.541885 --> -0.549528).  Saving model ...
Epoch: 9 cost time: 6.039339303970337
Epoch: 9, Steps: 32 | Train Loss: 0.325 Vali Loss: 7.860 Vali Acc: 0.542 Test Loss: 7.860 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.259872913360596
Epoch: 10, Steps: 32 | Train Loss: 0.096 Vali Loss: 10.319 Vali Acc: 0.427 Test Loss: 10.319 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.1734209060668945
Epoch: 11, Steps: 32 | Train Loss: 0.480 Vali Loss: 10.997 Vali Acc: 0.504 Test Loss: 10.997 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.105852127075195
Epoch: 12, Steps: 32 | Train Loss: 0.183 Vali Loss: 13.916 Vali Acc: 0.534 Test Loss: 13.916 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.245590925216675
Epoch: 13, Steps: 32 | Train Loss: 0.194 Vali Loss: 10.060 Vali Acc: 0.542 Test Loss: 10.060 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.050999402999878
Epoch: 14, Steps: 32 | Train Loss: 1.707 Vali Loss: 12.576 Vali Acc: 0.542 Test Loss: 12.576 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.921699523925781
Epoch: 15, Steps: 32 | Train Loss: 0.406 Vali Loss: 20.714 Vali Acc: 0.313 Test Loss: 20.714 Test Acc: 0.313
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 6.2662928104400635
Epoch: 16, Steps: 32 | Train Loss: 0.813 Vali Loss: 21.025 Vali Acc: 0.542 Test Loss: 21.025 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 6.050047874450684
Epoch: 17, Steps: 32 | Train Loss: 1.975 Vali Loss: 20.624 Vali Acc: 0.511 Test Loss: 20.624 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 5.988975524902344
Epoch: 18, Steps: 32 | Train Loss: 0.992 Vali Loss: 23.990 Vali Acc: 0.282 Test Loss: 23.990 Test Acc: 0.282
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 1568517
model size : 7.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 6.78084921836853
Epoch: 1, Steps: 32 | Train Loss: 2.119 Vali Loss: 1.929 Vali Acc: 0.405 Test Loss: 1.929 Test Acc: 0.405
Validation loss decreased (inf --> -0.404561).  Saving model ...
Epoch: 2 cost time: 5.859248638153076
Epoch: 2, Steps: 32 | Train Loss: 1.334 Vali Loss: 2.589 Vali Acc: 0.511 Test Loss: 2.589 Test Acc: 0.511
Validation loss decreased (-0.404561 --> -0.511424).  Saving model ...
Epoch: 3 cost time: 6.1075439453125
Epoch: 3, Steps: 32 | Train Loss: 1.577 Vali Loss: 5.185 Vali Acc: 0.527 Test Loss: 5.185 Test Acc: 0.527
Validation loss decreased (-0.511424 --> -0.526666).  Saving model ...
Epoch: 4 cost time: 6.351135730743408
Epoch: 4, Steps: 32 | Train Loss: 0.833 Vali Loss: 5.421 Vali Acc: 0.519 Test Loss: 5.421 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.0669472217559814
Epoch: 5, Steps: 32 | Train Loss: 0.695 Vali Loss: 7.461 Vali Acc: 0.527 Test Loss: 7.461 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.239810228347778
Epoch: 6, Steps: 32 | Train Loss: 0.916 Vali Loss: 7.249 Vali Acc: 0.519 Test Loss: 7.249 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.356997489929199
Epoch: 7, Steps: 32 | Train Loss: 1.247 Vali Loss: 13.341 Vali Acc: 0.305 Test Loss: 13.341 Test Acc: 0.305
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 6.228788375854492
Epoch: 8, Steps: 32 | Train Loss: 0.586 Vali Loss: 8.743 Vali Acc: 0.542 Test Loss: 8.743 Test Acc: 0.542
Validation loss decreased (-0.526666 --> -0.541897).  Saving model ...
Epoch: 9 cost time: 6.170554161071777
Epoch: 9, Steps: 32 | Train Loss: 0.185 Vali Loss: 13.250 Vali Acc: 0.336 Test Loss: 13.250 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.140733242034912
Epoch: 10, Steps: 32 | Train Loss: 0.427 Vali Loss: 9.337 Vali Acc: 0.603 Test Loss: 9.337 Test Acc: 0.603
Validation loss decreased (-0.541897 --> -0.602960).  Saving model ...
Epoch: 11 cost time: 6.2029852867126465
Epoch: 11, Steps: 32 | Train Loss: 1.021 Vali Loss: 9.399 Vali Acc: 0.542 Test Loss: 9.399 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.439773082733154
Epoch: 12, Steps: 32 | Train Loss: 0.870 Vali Loss: 13.238 Vali Acc: 0.573 Test Loss: 13.238 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.386382341384888
Epoch: 13, Steps: 32 | Train Loss: 0.333 Vali Loss: 12.937 Vali Acc: 0.481 Test Loss: 12.937 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.0710365772247314
Epoch: 14, Steps: 32 | Train Loss: 0.312 Vali Loss: 22.819 Vali Acc: 0.290 Test Loss: 22.819 Test Acc: 0.290
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.21677041053772
Epoch: 15, Steps: 32 | Train Loss: 1.133 Vali Loss: 12.687 Vali Acc: 0.504 Test Loss: 12.687 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 6.175511121749878
Epoch: 16, Steps: 32 | Train Loss: 0.593 Vali Loss: 19.987 Vali Acc: 0.435 Test Loss: 19.987 Test Acc: 0.435
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 6.358587741851807
Epoch: 17, Steps: 32 | Train Loss: 1.143 Vali Loss: 26.092 Vali Acc: 0.420 Test Loss: 26.092 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 6.334442138671875
Epoch: 18, Steps: 32 | Train Loss: 1.268 Vali Loss: 17.923 Vali Acc: 0.550 Test Loss: 17.923 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 6.09537672996521
Epoch: 19, Steps: 32 | Train Loss: 1.010 Vali Loss: 31.774 Vali Acc: 0.458 Test Loss: 31.774 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 6.0365941524505615
Epoch: 20, Steps: 32 | Train Loss: 1.032 Vali Loss: 25.867 Vali Acc: 0.397 Test Loss: 25.867 Test Acc: 0.397
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6030534351145038
model parameter : 1878981
model size : 8.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.94165563583374
Epoch: 1, Steps: 32 | Train Loss: 2.652 Vali Loss: 4.887 Vali Acc: 0.198 Test Loss: 4.887 Test Acc: 0.198
Validation loss decreased (inf --> -0.198424).  Saving model ...
Epoch: 2 cost time: 3.647613286972046
Epoch: 2, Steps: 32 | Train Loss: 2.679 Vali Loss: 6.214 Vali Acc: 0.206 Test Loss: 6.214 Test Acc: 0.206
Validation loss decreased (-0.198424 --> -0.206045).  Saving model ...
Epoch: 3 cost time: 3.675699472427368
Epoch: 3, Steps: 32 | Train Loss: 1.838 Vali Loss: 3.929 Vali Acc: 0.344 Test Loss: 3.929 Test Acc: 0.344
Validation loss decreased (-0.206045 --> -0.343472).  Saving model ...
Epoch: 4 cost time: 3.6624250411987305
Epoch: 4, Steps: 32 | Train Loss: 1.422 Vali Loss: 5.475 Vali Acc: 0.313 Test Loss: 5.475 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.641981840133667
Epoch: 5, Steps: 32 | Train Loss: 0.613 Vali Loss: 5.330 Vali Acc: 0.527 Test Loss: 5.330 Test Acc: 0.527
Validation loss decreased (-0.343472 --> -0.526664).  Saving model ...
Epoch: 6 cost time: 3.622764825820923
Epoch: 6, Steps: 32 | Train Loss: 1.272 Vali Loss: 11.235 Vali Acc: 0.237 Test Loss: 11.235 Test Acc: 0.237
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.7284438610076904
Epoch: 7, Steps: 32 | Train Loss: 0.965 Vali Loss: 11.104 Vali Acc: 0.397 Test Loss: 11.104 Test Acc: 0.397
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.6901745796203613
Epoch: 8, Steps: 32 | Train Loss: 0.225 Vali Loss: 9.198 Vali Acc: 0.550 Test Loss: 9.198 Test Acc: 0.550
Validation loss decreased (-0.526664 --> -0.549526).  Saving model ...
Epoch: 9 cost time: 3.7284181118011475
Epoch: 9, Steps: 32 | Train Loss: 0.508 Vali Loss: 12.627 Vali Acc: 0.305 Test Loss: 12.627 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.7919013500213623
Epoch: 10, Steps: 32 | Train Loss: 0.466 Vali Loss: 10.713 Vali Acc: 0.405 Test Loss: 10.713 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.593411445617676
Epoch: 11, Steps: 32 | Train Loss: 1.730 Vali Loss: 18.151 Vali Acc: 0.557 Test Loss: 18.151 Test Acc: 0.557
Validation loss decreased (-0.549526 --> -0.557070).  Saving model ...
Epoch: 12 cost time: 3.690164089202881
Epoch: 12, Steps: 32 | Train Loss: 0.593 Vali Loss: 13.303 Vali Acc: 0.542 Test Loss: 13.303 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.9159884452819824
Epoch: 13, Steps: 32 | Train Loss: 0.554 Vali Loss: 20.564 Vali Acc: 0.588 Test Loss: 20.564 Test Acc: 0.588
Validation loss decreased (-0.557070 --> -0.587581).  Saving model ...
Epoch: 14 cost time: 3.6026220321655273
Epoch: 14, Steps: 32 | Train Loss: 0.081 Vali Loss: 19.468 Vali Acc: 0.626 Test Loss: 19.468 Test Acc: 0.626
Validation loss decreased (-0.587581 --> -0.625760).  Saving model ...
Epoch: 15 cost time: 3.7703664302825928
Epoch: 15, Steps: 32 | Train Loss: 0.235 Vali Loss: 17.882 Vali Acc: 0.580 Test Loss: 17.882 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.749089241027832
Epoch: 16, Steps: 32 | Train Loss: 0.201 Vali Loss: 14.542 Vali Acc: 0.450 Test Loss: 14.542 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.6162467002868652
Epoch: 17, Steps: 32 | Train Loss: 0.254 Vali Loss: 21.043 Vali Acc: 0.573 Test Loss: 21.043 Test Acc: 0.573
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.6513214111328125
Epoch: 18, Steps: 32 | Train Loss: 0.081 Vali Loss: 25.349 Vali Acc: 0.313 Test Loss: 25.349 Test Acc: 0.313
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.76568603515625
Epoch: 19, Steps: 32 | Train Loss: 1.996 Vali Loss: 15.171 Vali Acc: 0.435 Test Loss: 15.171 Test Acc: 0.435
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.603159189224243
Epoch: 20, Steps: 32 | Train Loss: 2.017 Vali Loss: 29.015 Vali Acc: 0.557 Test Loss: 29.015 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.6662492752075195
Epoch: 21, Steps: 32 | Train Loss: 0.326 Vali Loss: 31.239 Vali Acc: 0.588 Test Loss: 31.239 Test Acc: 0.588
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.6778156757354736
Epoch: 22, Steps: 32 | Train Loss: 0.461 Vali Loss: 34.341 Vali Acc: 0.573 Test Loss: 34.341 Test Acc: 0.573
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.6002931594848633
Epoch: 23, Steps: 32 | Train Loss: 0.611 Vali Loss: 23.111 Vali Acc: 0.374 Test Loss: 23.111 Test Acc: 0.374
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.745570659637451
Epoch: 24, Steps: 32 | Train Loss: 0.292 Vali Loss: 35.657 Vali Acc: 0.282 Test Loss: 35.657 Test Acc: 0.282
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6259541984732825
model parameter : 1568517
model size : 7.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 32.60526084899902
Epoch: 1, Steps: 32 | Train Loss: 1.854 Vali Loss: 1.735 Vali Acc: 0.382 Test Loss: 1.735 Test Acc: 0.382
Validation loss decreased (inf --> -0.381662).  Saving model ...
Epoch: 2 cost time: 31.872020721435547
Epoch: 2, Steps: 32 | Train Loss: 0.742 Vali Loss: 3.156 Vali Acc: 0.267 Test Loss: 3.156 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 31.982653856277466
Epoch: 3, Steps: 32 | Train Loss: 0.379 Vali Loss: 5.532 Vali Acc: 0.260 Test Loss: 5.532 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 31.723296403884888
Epoch: 4, Steps: 32 | Train Loss: 0.244 Vali Loss: 6.374 Vali Acc: 0.496 Test Loss: 6.374 Test Acc: 0.496
Validation loss decreased (-0.381662 --> -0.496119).  Saving model ...
Epoch: 5 cost time: 31.910381317138672
Epoch: 5, Steps: 32 | Train Loss: 0.319 Vali Loss: 5.591 Vali Acc: 0.534 Test Loss: 5.591 Test Acc: 0.534
Validation loss decreased (-0.496119 --> -0.534295).  Saving model ...
Epoch: 6 cost time: 31.52089762687683
Epoch: 6, Steps: 32 | Train Loss: 0.347 Vali Loss: 5.599 Vali Acc: 0.405 Test Loss: 5.599 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 31.98892307281494
Epoch: 7, Steps: 32 | Train Loss: 0.085 Vali Loss: 6.772 Vali Acc: 0.450 Test Loss: 6.772 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 32.21506190299988
Epoch: 8, Steps: 32 | Train Loss: 0.019 Vali Loss: 5.803 Vali Acc: 0.412 Test Loss: 5.803 Test Acc: 0.412
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 32.40006613731384
Epoch: 9, Steps: 32 | Train Loss: 0.194 Vali Loss: 9.186 Vali Acc: 0.511 Test Loss: 9.186 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 31.987019777297974
Epoch: 10, Steps: 32 | Train Loss: 0.434 Vali Loss: 12.330 Vali Acc: 0.313 Test Loss: 12.330 Test Acc: 0.313
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 31.78095316886902
Epoch: 11, Steps: 32 | Train Loss: 0.534 Vali Loss: 12.108 Vali Acc: 0.473 Test Loss: 12.108 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 32.358054399490356
Epoch: 12, Steps: 32 | Train Loss: 1.020 Vali Loss: 13.917 Vali Acc: 0.290 Test Loss: 13.917 Test Acc: 0.290
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 33.09629511833191
Epoch: 13, Steps: 32 | Train Loss: 1.052 Vali Loss: 12.472 Vali Acc: 0.405 Test Loss: 12.472 Test Acc: 0.405
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 32.87604379653931
Epoch: 14, Steps: 32 | Train Loss: 0.469 Vali Loss: 18.412 Vali Acc: 0.504 Test Loss: 18.412 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 33.52289795875549
Epoch: 15, Steps: 32 | Train Loss: 0.251 Vali Loss: 15.517 Vali Acc: 0.489 Test Loss: 15.517 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 1599445
model size : 6.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 15.029908418655396
Epoch: 1, Steps: 32 | Train Loss: 1.938 Vali Loss: 1.691 Vali Acc: 0.542 Test Loss: 1.691 Test Acc: 0.542
Validation loss decreased (inf --> -0.541968).  Saving model ...
Epoch: 2 cost time: 13.95633840560913
Epoch: 2, Steps: 32 | Train Loss: 0.896 Vali Loss: 2.283 Vali Acc: 0.321 Test Loss: 2.283 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 14.050343036651611
Epoch: 3, Steps: 32 | Train Loss: 1.186 Vali Loss: 4.974 Vali Acc: 0.267 Test Loss: 4.974 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 13.858378171920776
Epoch: 4, Steps: 32 | Train Loss: 0.757 Vali Loss: 4.714 Vali Acc: 0.344 Test Loss: 4.714 Test Acc: 0.344
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 14.376064538955688
Epoch: 5, Steps: 32 | Train Loss: 0.341 Vali Loss: 7.996 Vali Acc: 0.351 Test Loss: 7.996 Test Acc: 0.351
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 14.430240631103516
Epoch: 6, Steps: 32 | Train Loss: 0.401 Vali Loss: 6.187 Vali Acc: 0.405 Test Loss: 6.187 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 14.370877742767334
Epoch: 7, Steps: 32 | Train Loss: 0.071 Vali Loss: 6.330 Vali Acc: 0.450 Test Loss: 6.330 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 14.29245901107788
Epoch: 8, Steps: 32 | Train Loss: 0.474 Vali Loss: 7.817 Vali Acc: 0.389 Test Loss: 7.817 Test Acc: 0.389
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 14.379765272140503
Epoch: 9, Steps: 32 | Train Loss: 1.598 Vali Loss: 11.075 Vali Acc: 0.481 Test Loss: 11.075 Test Acc: 0.481
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 15.237051248550415
Epoch: 10, Steps: 32 | Train Loss: 0.502 Vali Loss: 10.031 Vali Acc: 0.443 Test Loss: 10.031 Test Acc: 0.443
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 15.245131969451904
Epoch: 11, Steps: 32 | Train Loss: 0.002 Vali Loss: 8.843 Vali Acc: 0.466 Test Loss: 8.843 Test Acc: 0.466
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 978469
model size : 4.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 24.523617029190063
Epoch: 1, Steps: 32 | Train Loss: 1.862 Vali Loss: 1.726 Vali Acc: 0.397 Test Loss: 1.726 Test Acc: 0.397
Validation loss decreased (inf --> -0.396929).  Saving model ...
Epoch: 2 cost time: 23.07951831817627
Epoch: 2, Steps: 32 | Train Loss: 0.712 Vali Loss: 2.760 Vali Acc: 0.298 Test Loss: 2.760 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 23.10897397994995
Epoch: 3, Steps: 32 | Train Loss: 0.512 Vali Loss: 3.493 Vali Acc: 0.382 Test Loss: 3.493 Test Acc: 0.382
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 23.095805644989014
Epoch: 4, Steps: 32 | Train Loss: 0.147 Vali Loss: 5.515 Vali Acc: 0.527 Test Loss: 5.515 Test Acc: 0.527
Validation loss decreased (-0.396929 --> -0.526662).  Saving model ...
Epoch: 5 cost time: 23.47452402114868
Epoch: 5, Steps: 32 | Train Loss: 0.124 Vali Loss: 5.801 Vali Acc: 0.481 Test Loss: 5.801 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 23.352900743484497
Epoch: 6, Steps: 32 | Train Loss: 0.145 Vali Loss: 8.794 Vali Acc: 0.321 Test Loss: 8.794 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 24.100581169128418
Epoch: 7, Steps: 32 | Train Loss: 0.231 Vali Loss: 7.351 Vali Acc: 0.496 Test Loss: 7.351 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 24.125709772109985
Epoch: 8, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.458 Vali Acc: 0.443 Test Loss: 6.458 Test Acc: 0.443
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 23.856282711029053
Epoch: 9, Steps: 32 | Train Loss: 0.118 Vali Loss: 8.997 Vali Acc: 0.435 Test Loss: 8.997 Test Acc: 0.435
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 23.496370553970337
Epoch: 10, Steps: 32 | Train Loss: 0.253 Vali Loss: 8.235 Vali Acc: 0.435 Test Loss: 8.235 Test Acc: 0.435
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 23.78181004524231
Epoch: 11, Steps: 32 | Train Loss: 0.270 Vali Loss: 8.475 Vali Acc: 0.489 Test Loss: 8.475 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 24.16829776763916
Epoch: 12, Steps: 32 | Train Loss: 0.678 Vali Loss: 7.774 Vali Acc: 0.344 Test Loss: 7.774 Test Acc: 0.344
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 24.429365396499634
Epoch: 13, Steps: 32 | Train Loss: 0.174 Vali Loss: 12.657 Vali Acc: 0.473 Test Loss: 12.657 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 23.429254293441772
Epoch: 14, Steps: 32 | Train Loss: 0.101 Vali Loss: 8.599 Vali Acc: 0.473 Test Loss: 8.599 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 1599445
model size : 6.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 10.716926097869873
Epoch: 1, Steps: 32 | Train Loss: 1.954 Vali Loss: 2.061 Vali Acc: 0.481 Test Loss: 2.061 Test Acc: 0.481
Validation loss decreased (inf --> -0.480895).  Saving model ...
Epoch: 2 cost time: 9.537302494049072
Epoch: 2, Steps: 32 | Train Loss: 0.871 Vali Loss: 1.650 Vali Acc: 0.420 Test Loss: 1.650 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.88479471206665
Epoch: 3, Steps: 32 | Train Loss: 0.191 Vali Loss: 3.961 Vali Acc: 0.344 Test Loss: 3.961 Test Acc: 0.344
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.865866422653198
Epoch: 4, Steps: 32 | Train Loss: 0.228 Vali Loss: 3.331 Vali Acc: 0.542 Test Loss: 3.331 Test Acc: 0.542
Validation loss decreased (-0.480895 --> -0.541951).  Saving model ...
Epoch: 5 cost time: 9.895134449005127
Epoch: 5, Steps: 32 | Train Loss: 0.189 Vali Loss: 6.123 Vali Acc: 0.466 Test Loss: 6.123 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 10.012155532836914
Epoch: 6, Steps: 32 | Train Loss: 0.615 Vali Loss: 6.690 Vali Acc: 0.511 Test Loss: 6.690 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 10.322904348373413
Epoch: 7, Steps: 32 | Train Loss: 0.590 Vali Loss: 5.767 Vali Acc: 0.366 Test Loss: 5.767 Test Acc: 0.366
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 10.487109899520874
Epoch: 8, Steps: 32 | Train Loss: 0.218 Vali Loss: 6.517 Vali Acc: 0.450 Test Loss: 6.517 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 10.943729162216187
Epoch: 9, Steps: 32 | Train Loss: 0.092 Vali Loss: 6.149 Vali Acc: 0.450 Test Loss: 6.149 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 11.275399923324585
Epoch: 10, Steps: 32 | Train Loss: 0.100 Vali Loss: 8.981 Vali Acc: 0.405 Test Loss: 8.981 Test Acc: 0.405
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 11.19966435432434
Epoch: 11, Steps: 32 | Train Loss: 0.921 Vali Loss: 10.309 Vali Acc: 0.427 Test Loss: 10.309 Test Acc: 0.427
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 10.590951204299927
Epoch: 12, Steps: 32 | Train Loss: 0.072 Vali Loss: 13.165 Vali Acc: 0.405 Test Loss: 13.165 Test Acc: 0.405
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 10.924108982086182
Epoch: 13, Steps: 32 | Train Loss: 0.295 Vali Loss: 9.704 Vali Acc: 0.351 Test Loss: 9.704 Test Acc: 0.351
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 10.825175046920776
Epoch: 14, Steps: 32 | Train Loss: 0.333 Vali Loss: 14.481 Vali Acc: 0.305 Test Loss: 14.481 Test Acc: 0.305
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 978469
model size : 4.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 14.900956153869629
Epoch: 1, Steps: 32 | Train Loss: 1.874 Vali Loss: 1.728 Vali Acc: 0.366 Test Loss: 1.728 Test Acc: 0.366
Validation loss decreased (inf --> -0.366395).  Saving model ...
Epoch: 2 cost time: 14.215484857559204
Epoch: 2, Steps: 32 | Train Loss: 0.768 Vali Loss: 2.686 Vali Acc: 0.252 Test Loss: 2.686 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 14.280745029449463
Epoch: 3, Steps: 32 | Train Loss: 0.406 Vali Loss: 4.518 Vali Acc: 0.267 Test Loss: 4.518 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 13.925588130950928
Epoch: 4, Steps: 32 | Train Loss: 0.178 Vali Loss: 6.549 Vali Acc: 0.496 Test Loss: 6.549 Test Acc: 0.496
Validation loss decreased (-0.366395 --> -0.496118).  Saving model ...
Epoch: 5 cost time: 14.077107906341553
Epoch: 5, Steps: 32 | Train Loss: 0.184 Vali Loss: 7.766 Vali Acc: 0.496 Test Loss: 7.766 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 13.910144090652466
Epoch: 6, Steps: 32 | Train Loss: 0.385 Vali Loss: 4.755 Vali Acc: 0.420 Test Loss: 4.755 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 13.979033470153809
Epoch: 7, Steps: 32 | Train Loss: 0.217 Vali Loss: 8.034 Vali Acc: 0.519 Test Loss: 8.034 Test Acc: 0.519
Validation loss decreased (-0.496118 --> -0.519004).  Saving model ...
Epoch: 8 cost time: 13.760018348693848
Epoch: 8, Steps: 32 | Train Loss: 0.063 Vali Loss: 10.632 Vali Acc: 0.344 Test Loss: 10.632 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 14.242950916290283
Epoch: 9, Steps: 32 | Train Loss: 1.125 Vali Loss: 9.782 Vali Acc: 0.405 Test Loss: 9.782 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 14.017529726028442
Epoch: 10, Steps: 32 | Train Loss: 0.432 Vali Loss: 8.244 Vali Acc: 0.481 Test Loss: 8.244 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 13.920256853103638
Epoch: 11, Steps: 32 | Train Loss: 0.253 Vali Loss: 18.998 Vali Acc: 0.496 Test Loss: 18.998 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 13.466263771057129
Epoch: 12, Steps: 32 | Train Loss: 0.153 Vali Loss: 16.188 Vali Acc: 0.519 Test Loss: 16.188 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 12.165722608566284
Epoch: 13, Steps: 32 | Train Loss: 0.031 Vali Loss: 15.280 Vali Acc: 0.473 Test Loss: 15.280 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 11.136814832687378
Epoch: 14, Steps: 32 | Train Loss: 0.410 Vali Loss: 12.723 Vali Acc: 0.305 Test Loss: 12.723 Test Acc: 0.305
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 13.071712255477905
Epoch: 15, Steps: 32 | Train Loss: 0.278 Vali Loss: 14.760 Vali Acc: 0.321 Test Loss: 14.760 Test Acc: 0.321
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 13.693184614181519
Epoch: 16, Steps: 32 | Train Loss: 0.460 Vali Loss: 19.836 Vali Acc: 0.366 Test Loss: 19.836 Test Acc: 0.366
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 14.240012168884277
Epoch: 17, Steps: 32 | Train Loss: 0.966 Vali Loss: 19.366 Vali Acc: 0.511 Test Loss: 19.366 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 1599445
model size : 6.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 7.679638385772705
Epoch: 1, Steps: 32 | Train Loss: 1.987 Vali Loss: 2.237 Vali Acc: 0.458 Test Loss: 2.237 Test Acc: 0.458
Validation loss decreased (inf --> -0.457993).  Saving model ...
Epoch: 2 cost time: 6.414997339248657
Epoch: 2, Steps: 32 | Train Loss: 0.934 Vali Loss: 2.922 Vali Acc: 0.267 Test Loss: 2.922 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.678465366363525
Epoch: 3, Steps: 32 | Train Loss: 0.506 Vali Loss: 3.814 Vali Acc: 0.412 Test Loss: 3.814 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.809762001037598
Epoch: 4, Steps: 32 | Train Loss: 0.745 Vali Loss: 7.564 Vali Acc: 0.244 Test Loss: 7.564 Test Acc: 0.244
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.680333375930786
Epoch: 5, Steps: 32 | Train Loss: 0.141 Vali Loss: 8.397 Vali Acc: 0.321 Test Loss: 8.397 Test Acc: 0.321
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.709451198577881
Epoch: 6, Steps: 32 | Train Loss: 0.242 Vali Loss: 6.338 Vali Acc: 0.328 Test Loss: 6.338 Test Acc: 0.328
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.819763660430908
Epoch: 7, Steps: 32 | Train Loss: 0.106 Vali Loss: 7.654 Vali Acc: 0.298 Test Loss: 7.654 Test Acc: 0.298
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 7.187033176422119
Epoch: 8, Steps: 32 | Train Loss: 0.100 Vali Loss: 6.930 Vali Acc: 0.489 Test Loss: 6.930 Test Acc: 0.489
Validation loss decreased (-0.457993 --> -0.488480).  Saving model ...
Epoch: 9 cost time: 7.02370285987854
Epoch: 9, Steps: 32 | Train Loss: 0.374 Vali Loss: 12.209 Vali Acc: 0.214 Test Loss: 12.209 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.085917711257935
Epoch: 10, Steps: 32 | Train Loss: 0.028 Vali Loss: 9.953 Vali Acc: 0.405 Test Loss: 9.953 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.916881561279297
Epoch: 11, Steps: 32 | Train Loss: 0.198 Vali Loss: 11.256 Vali Acc: 0.420 Test Loss: 11.256 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.725790739059448
Epoch: 12, Steps: 32 | Train Loss: 0.026 Vali Loss: 10.693 Vali Acc: 0.527 Test Loss: 10.693 Test Acc: 0.527
Validation loss decreased (-0.488480 --> -0.526611).  Saving model ...
Epoch: 13 cost time: 6.869645357131958
Epoch: 13, Steps: 32 | Train Loss: 0.044 Vali Loss: 10.979 Vali Acc: 0.496 Test Loss: 10.979 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.722519397735596
Epoch: 14, Steps: 32 | Train Loss: 0.240 Vali Loss: 15.160 Vali Acc: 0.237 Test Loss: 15.160 Test Acc: 0.237
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.852819204330444
Epoch: 15, Steps: 32 | Train Loss: 0.399 Vali Loss: 13.171 Vali Acc: 0.458 Test Loss: 13.171 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.416703462600708
Epoch: 16, Steps: 32 | Train Loss: 0.442 Vali Loss: 13.789 Vali Acc: 0.351 Test Loss: 13.789 Test Acc: 0.351
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 7.056453227996826
Epoch: 17, Steps: 32 | Train Loss: 0.443 Vali Loss: 13.010 Vali Acc: 0.344 Test Loss: 13.010 Test Acc: 0.344
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 7.086174249649048
Epoch: 18, Steps: 32 | Train Loss: 0.662 Vali Loss: 21.216 Vali Acc: 0.344 Test Loss: 21.216 Test Acc: 0.344
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 7.1118834018707275
Epoch: 19, Steps: 32 | Train Loss: 1.062 Vali Loss: 14.709 Vali Acc: 0.427 Test Loss: 14.709 Test Acc: 0.427
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 6.994591236114502
Epoch: 20, Steps: 32 | Train Loss: 0.665 Vali Loss: 18.371 Vali Acc: 0.260 Test Loss: 18.371 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 7.411739349365234
Epoch: 21, Steps: 32 | Train Loss: 0.053 Vali Loss: 16.690 Vali Acc: 0.466 Test Loss: 16.690 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 7.044104099273682
Epoch: 22, Steps: 32 | Train Loss: 0.368 Vali Loss: 18.222 Vali Acc: 0.405 Test Loss: 18.222 Test Acc: 0.405
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 978469
model size : 4.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 17.698649644851685
Epoch: 1, Steps: 32 | Train Loss: 2.005 Vali Loss: 1.621 Vali Acc: 0.511 Test Loss: 1.621 Test Acc: 0.511
Validation loss decreased (inf --> -0.511434).  Saving model ...
Epoch: 2 cost time: 17.269028902053833
Epoch: 2, Steps: 32 | Train Loss: 1.756 Vali Loss: 1.532 Vali Acc: 0.511 Test Loss: 1.532 Test Acc: 0.511
Validation loss decreased (-0.511434 --> -0.511435).  Saving model ...
Epoch: 3 cost time: 17.24830198287964
Epoch: 3, Steps: 32 | Train Loss: 0.610 Vali Loss: 2.725 Vali Acc: 0.496 Test Loss: 2.725 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 17.182848930358887
Epoch: 4, Steps: 32 | Train Loss: 0.565 Vali Loss: 3.395 Vali Acc: 0.412 Test Loss: 3.395 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 16.95170783996582
Epoch: 5, Steps: 32 | Train Loss: 0.137 Vali Loss: 3.989 Vali Acc: 0.496 Test Loss: 3.989 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 17.182857513427734
Epoch: 6, Steps: 32 | Train Loss: 0.215 Vali Loss: 7.232 Vali Acc: 0.244 Test Loss: 7.232 Test Acc: 0.244
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 17.29553246498108
Epoch: 7, Steps: 32 | Train Loss: 0.096 Vali Loss: 5.164 Vali Acc: 0.412 Test Loss: 5.164 Test Acc: 0.412
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 17.277665376663208
Epoch: 8, Steps: 32 | Train Loss: 0.412 Vali Loss: 8.380 Vali Acc: 0.435 Test Loss: 8.380 Test Acc: 0.435
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 17.18712615966797
Epoch: 9, Steps: 32 | Train Loss: 0.910 Vali Loss: 8.391 Vali Acc: 0.405 Test Loss: 8.391 Test Acc: 0.405
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 17.35209083557129
Epoch: 10, Steps: 32 | Train Loss: 0.360 Vali Loss: 8.723 Vali Acc: 0.481 Test Loss: 8.723 Test Acc: 0.481
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 17.38954472541809
Epoch: 11, Steps: 32 | Train Loss: 0.580 Vali Loss: 10.346 Vali Acc: 0.458 Test Loss: 10.346 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 17.33733034133911
Epoch: 12, Steps: 32 | Train Loss: 0.430 Vali Loss: 13.626 Vali Acc: 0.519 Test Loss: 13.626 Test Acc: 0.519
Validation loss decreased (-0.511435 --> -0.518948).  Saving model ...
Epoch: 13 cost time: 17.116971969604492
Epoch: 13, Steps: 32 | Train Loss: 0.181 Vali Loss: 9.558 Vali Acc: 0.496 Test Loss: 9.558 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 17.336674451828003
Epoch: 14, Steps: 32 | Train Loss: 0.111 Vali Loss: 9.209 Vali Acc: 0.382 Test Loss: 9.209 Test Acc: 0.382
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 17.24466323852539
Epoch: 15, Steps: 32 | Train Loss: 0.053 Vali Loss: 11.089 Vali Acc: 0.389 Test Loss: 11.089 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 17.612913608551025
Epoch: 16, Steps: 32 | Train Loss: 0.027 Vali Loss: 11.961 Vali Acc: 0.519 Test Loss: 11.961 Test Acc: 0.519
Validation loss decreased (-0.518948 --> -0.518964).  Saving model ...
Epoch: 17 cost time: 17.137406587600708
Epoch: 17, Steps: 32 | Train Loss: 0.288 Vali Loss: 16.949 Vali Acc: 0.290 Test Loss: 16.949 Test Acc: 0.290
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 17.62768840789795
Epoch: 18, Steps: 32 | Train Loss: 0.309 Vali Loss: 18.762 Vali Acc: 0.382 Test Loss: 18.762 Test Acc: 0.382
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 17.341331720352173
Epoch: 19, Steps: 32 | Train Loss: 0.557 Vali Loss: 15.495 Vali Acc: 0.473 Test Loss: 15.495 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 17.627930879592896
Epoch: 20, Steps: 32 | Train Loss: 0.795 Vali Loss: 17.676 Vali Acc: 0.328 Test Loss: 17.676 Test Acc: 0.328
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 17.36813449859619
Epoch: 21, Steps: 32 | Train Loss: 0.375 Vali Loss: 17.718 Vali Acc: 0.359 Test Loss: 17.718 Test Acc: 0.359
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 17.145153284072876
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 17.671 Vali Acc: 0.305 Test Loss: 17.671 Test Acc: 0.305
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 16.97005605697632
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 16.834 Vali Acc: 0.473 Test Loss: 16.834 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 17.102821826934814
Epoch: 24, Steps: 32 | Train Loss: 0.001 Vali Loss: 17.461 Vali Acc: 0.336 Test Loss: 17.461 Test Acc: 0.336
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 17.265387058258057
Epoch: 25, Steps: 32 | Train Loss: 0.247 Vali Loss: 16.899 Vali Acc: 0.527 Test Loss: 16.899 Test Acc: 0.527
Validation loss decreased (-0.518964 --> -0.526549).  Saving model ...
Epoch: 26 cost time: 17.216770887374878
Epoch: 26, Steps: 32 | Train Loss: 0.000 Vali Loss: 16.793 Vali Acc: 0.511 Test Loss: 16.793 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 17.14381456375122
Epoch: 27, Steps: 32 | Train Loss: 0.472 Vali Loss: 17.342 Vali Acc: 0.374 Test Loss: 17.342 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 17.33253002166748
Epoch: 28, Steps: 32 | Train Loss: 0.108 Vali Loss: 19.402 Vali Acc: 0.527 Test Loss: 19.402 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 17.4319748878479
Epoch: 29, Steps: 32 | Train Loss: 0.424 Vali Loss: 17.397 Vali Acc: 0.412 Test Loss: 17.397 Test Acc: 0.412
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 17.879004955291748
Epoch: 30, Steps: 32 | Train Loss: 0.242 Vali Loss: 18.492 Vali Acc: 0.466 Test Loss: 18.492 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 1159573
model size : 5.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 8.326933145523071
Epoch: 1, Steps: 32 | Train Loss: 2.077 Vali Loss: 1.620 Vali Acc: 0.328 Test Loss: 1.620 Test Acc: 0.328
Validation loss decreased (inf --> -0.328228).  Saving model ...
Epoch: 2 cost time: 7.21541953086853
Epoch: 2, Steps: 32 | Train Loss: 0.759 Vali Loss: 2.146 Vali Acc: 0.542 Test Loss: 2.146 Test Acc: 0.542
Validation loss decreased (-0.328228 --> -0.541963).  Saving model ...
Epoch: 3 cost time: 7.219350099563599
Epoch: 3, Steps: 32 | Train Loss: 0.286 Vali Loss: 2.397 Vali Acc: 0.511 Test Loss: 2.397 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.346741676330566
Epoch: 4, Steps: 32 | Train Loss: 0.184 Vali Loss: 6.189 Vali Acc: 0.321 Test Loss: 6.189 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.520412445068359
Epoch: 5, Steps: 32 | Train Loss: 0.230 Vali Loss: 4.986 Vali Acc: 0.351 Test Loss: 4.986 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 7.484775543212891
Epoch: 6, Steps: 32 | Train Loss: 0.726 Vali Loss: 5.149 Vali Acc: 0.435 Test Loss: 5.149 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 7.701822280883789
Epoch: 7, Steps: 32 | Train Loss: 0.188 Vali Loss: 7.266 Vali Acc: 0.351 Test Loss: 7.266 Test Acc: 0.351
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 7.665431499481201
Epoch: 8, Steps: 32 | Train Loss: 0.066 Vali Loss: 7.041 Vali Acc: 0.435 Test Loss: 7.041 Test Acc: 0.435
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 7.598975658416748
Epoch: 9, Steps: 32 | Train Loss: 0.189 Vali Loss: 7.219 Vali Acc: 0.420 Test Loss: 7.219 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 7.726876258850098
Epoch: 10, Steps: 32 | Train Loss: 0.014 Vali Loss: 7.993 Vali Acc: 0.588 Test Loss: 7.993 Test Acc: 0.588
Validation loss decreased (-0.541963 --> -0.587706).  Saving model ...
Epoch: 11 cost time: 7.861200571060181
Epoch: 11, Steps: 32 | Train Loss: 0.245 Vali Loss: 9.507 Vali Acc: 0.328 Test Loss: 9.507 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 8.042593240737915
Epoch: 12, Steps: 32 | Train Loss: 0.327 Vali Loss: 6.761 Vali Acc: 0.481 Test Loss: 6.761 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 7.796241283416748
Epoch: 13, Steps: 32 | Train Loss: 0.066 Vali Loss: 7.938 Vali Acc: 0.473 Test Loss: 7.938 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 8.041914939880371
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 8.162 Vali Acc: 0.435 Test Loss: 8.162 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 8.076411247253418
Epoch: 15, Steps: 32 | Train Loss: 0.180 Vali Loss: 9.295 Vali Acc: 0.420 Test Loss: 9.295 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 7.9515767097473145
Epoch: 16, Steps: 32 | Train Loss: 0.019 Vali Loss: 10.594 Vali Acc: 0.435 Test Loss: 10.594 Test Acc: 0.435
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 7.771986722946167
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 9.913 Vali Acc: 0.458 Test Loss: 9.913 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 7.797746658325195
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 9.901 Vali Acc: 0.458 Test Loss: 9.901 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 8.047040462493896
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 9.870 Vali Acc: 0.458 Test Loss: 9.870 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 8.088733911514282
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 9.874 Vali Acc: 0.458 Test Loss: 9.874 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 849061
model size : 3.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 13.130764245986938
Epoch: 1, Steps: 32 | Train Loss: 2.005 Vali Loss: 1.618 Vali Acc: 0.511 Test Loss: 1.618 Test Acc: 0.511
Validation loss decreased (inf --> -0.511434).  Saving model ...
Epoch: 2 cost time: 12.656785249710083
Epoch: 2, Steps: 32 | Train Loss: 1.755 Vali Loss: 1.521 Vali Acc: 0.527 Test Loss: 1.521 Test Acc: 0.527
Validation loss decreased (-0.511434 --> -0.526702).  Saving model ...
Epoch: 3 cost time: 12.404517650604248
Epoch: 3, Steps: 32 | Train Loss: 0.607 Vali Loss: 2.310 Vali Acc: 0.458 Test Loss: 2.310 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 12.50806999206543
Epoch: 4, Steps: 32 | Train Loss: 0.387 Vali Loss: 3.316 Vali Acc: 0.412 Test Loss: 3.316 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 12.561269998550415
Epoch: 5, Steps: 32 | Train Loss: 0.239 Vali Loss: 3.217 Vali Acc: 0.458 Test Loss: 3.217 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 12.262338399887085
Epoch: 6, Steps: 32 | Train Loss: 0.011 Vali Loss: 7.758 Vali Acc: 0.282 Test Loss: 7.758 Test Acc: 0.282
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 12.827571153640747
Epoch: 7, Steps: 32 | Train Loss: 0.137 Vali Loss: 5.972 Vali Acc: 0.511 Test Loss: 5.972 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 12.98216986656189
Epoch: 8, Steps: 32 | Train Loss: 0.526 Vali Loss: 5.359 Vali Acc: 0.389 Test Loss: 5.359 Test Acc: 0.389
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 12.605243444442749
Epoch: 9, Steps: 32 | Train Loss: 0.298 Vali Loss: 6.827 Vali Acc: 0.443 Test Loss: 6.827 Test Acc: 0.443
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 13.071534156799316
Epoch: 10, Steps: 32 | Train Loss: 0.311 Vali Loss: 5.535 Vali Acc: 0.496 Test Loss: 5.535 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 12.850913047790527
Epoch: 11, Steps: 32 | Train Loss: 0.129 Vali Loss: 7.599 Vali Acc: 0.443 Test Loss: 7.599 Test Acc: 0.443
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 13.129480838775635
Epoch: 12, Steps: 32 | Train Loss: 0.100 Vali Loss: 7.260 Vali Acc: 0.450 Test Loss: 7.260 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 1159573
model size : 5.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 6.986540079116821
Epoch: 1, Steps: 32 | Train Loss: 2.076 Vali Loss: 1.609 Vali Acc: 0.321 Test Loss: 1.609 Test Acc: 0.321
Validation loss decreased (inf --> -0.320595).  Saving model ...
Epoch: 2 cost time: 5.532361745834351
Epoch: 2, Steps: 32 | Train Loss: 0.775 Vali Loss: 2.162 Vali Acc: 0.557 Test Loss: 2.162 Test Acc: 0.557
Validation loss decreased (-0.320595 --> -0.557230).  Saving model ...
Epoch: 3 cost time: 5.385167598724365
Epoch: 3, Steps: 32 | Train Loss: 0.288 Vali Loss: 3.354 Vali Acc: 0.336 Test Loss: 3.354 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.534132242202759
Epoch: 4, Steps: 32 | Train Loss: 0.341 Vali Loss: 5.357 Vali Acc: 0.328 Test Loss: 5.357 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.72394585609436
Epoch: 5, Steps: 32 | Train Loss: 0.196 Vali Loss: 5.021 Vali Acc: 0.328 Test Loss: 5.021 Test Acc: 0.328
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.724974870681763
Epoch: 6, Steps: 32 | Train Loss: 0.227 Vali Loss: 7.107 Vali Acc: 0.511 Test Loss: 7.107 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.700149774551392
Epoch: 7, Steps: 32 | Train Loss: 0.066 Vali Loss: 5.598 Vali Acc: 0.420 Test Loss: 5.598 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.6984193325042725
Epoch: 8, Steps: 32 | Train Loss: 0.178 Vali Loss: 6.759 Vali Acc: 0.359 Test Loss: 6.759 Test Acc: 0.359
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.741988182067871
Epoch: 9, Steps: 32 | Train Loss: 0.033 Vali Loss: 6.325 Vali Acc: 0.519 Test Loss: 6.325 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.623778343200684
Epoch: 10, Steps: 32 | Train Loss: 0.083 Vali Loss: 6.751 Vali Acc: 0.504 Test Loss: 6.751 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.774374723434448
Epoch: 11, Steps: 32 | Train Loss: 0.387 Vali Loss: 9.895 Vali Acc: 0.511 Test Loss: 9.895 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.641809463500977
Epoch: 12, Steps: 32 | Train Loss: 0.261 Vali Loss: 14.328 Vali Acc: 0.244 Test Loss: 14.328 Test Acc: 0.244
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 849061
model size : 3.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 9.000183820724487
Epoch: 1, Steps: 32 | Train Loss: 2.004 Vali Loss: 1.620 Vali Acc: 0.496 Test Loss: 1.620 Test Acc: 0.496
Validation loss decreased (inf --> -0.496167).  Saving model ...
Epoch: 2 cost time: 7.896875619888306
Epoch: 2, Steps: 32 | Train Loss: 1.757 Vali Loss: 1.480 Vali Acc: 0.534 Test Loss: 1.480 Test Acc: 0.534
Validation loss decreased (-0.496167 --> -0.534336).  Saving model ...
Epoch: 3 cost time: 7.89203143119812
Epoch: 3, Steps: 32 | Train Loss: 0.569 Vali Loss: 2.646 Vali Acc: 0.496 Test Loss: 2.646 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.124929189682007
Epoch: 4, Steps: 32 | Train Loss: 0.536 Vali Loss: 3.289 Vali Acc: 0.412 Test Loss: 3.289 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 8.168310165405273
Epoch: 5, Steps: 32 | Train Loss: 0.202 Vali Loss: 7.697 Vali Acc: 0.252 Test Loss: 7.697 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 8.119227886199951
Epoch: 6, Steps: 32 | Train Loss: 0.388 Vali Loss: 4.566 Vali Acc: 0.412 Test Loss: 4.566 Test Acc: 0.412
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 7.940117120742798
Epoch: 7, Steps: 32 | Train Loss: 0.125 Vali Loss: 8.045 Vali Acc: 0.511 Test Loss: 8.045 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 8.015846729278564
Epoch: 8, Steps: 32 | Train Loss: 0.528 Vali Loss: 5.586 Vali Acc: 0.420 Test Loss: 5.586 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 7.699305295944214
Epoch: 9, Steps: 32 | Train Loss: 0.215 Vali Loss: 6.970 Vali Acc: 0.489 Test Loss: 6.970 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 7.719138860702515
Epoch: 10, Steps: 32 | Train Loss: 0.332 Vali Loss: 6.989 Vali Acc: 0.405 Test Loss: 6.989 Test Acc: 0.405
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 7.972200155258179
Epoch: 11, Steps: 32 | Train Loss: 0.041 Vali Loss: 10.115 Vali Acc: 0.305 Test Loss: 10.115 Test Acc: 0.305
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 7.338117361068726
Epoch: 12, Steps: 32 | Train Loss: 0.653 Vali Loss: 10.095 Vali Acc: 0.290 Test Loss: 10.095 Test Acc: 0.290
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 1159573
model size : 5.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.953643321990967
Epoch: 1, Steps: 32 | Train Loss: 2.076 Vali Loss: 1.616 Vali Acc: 0.328 Test Loss: 1.616 Test Acc: 0.328
Validation loss decreased (inf --> -0.328228).  Saving model ...
Epoch: 2 cost time: 3.749274253845215
Epoch: 2, Steps: 32 | Train Loss: 0.747 Vali Loss: 1.995 Vali Acc: 0.550 Test Loss: 1.995 Test Acc: 0.550
Validation loss decreased (-0.328228 --> -0.549598).  Saving model ...
Epoch: 3 cost time: 3.7458996772766113
Epoch: 3, Steps: 32 | Train Loss: 0.388 Vali Loss: 3.002 Vali Acc: 0.435 Test Loss: 3.002 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.708007574081421
Epoch: 4, Steps: 32 | Train Loss: 0.747 Vali Loss: 4.624 Vali Acc: 0.344 Test Loss: 4.624 Test Acc: 0.344
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.7278671264648438
Epoch: 5, Steps: 32 | Train Loss: 0.084 Vali Loss: 4.998 Vali Acc: 0.382 Test Loss: 4.998 Test Acc: 0.382
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.7954635620117188
Epoch: 6, Steps: 32 | Train Loss: 0.163 Vali Loss: 4.741 Vali Acc: 0.496 Test Loss: 4.741 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.824096202850342
Epoch: 7, Steps: 32 | Train Loss: 0.007 Vali Loss: 5.996 Vali Acc: 0.542 Test Loss: 5.996 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.7971763610839844
Epoch: 8, Steps: 32 | Train Loss: 0.047 Vali Loss: 7.246 Vali Acc: 0.405 Test Loss: 7.246 Test Acc: 0.405
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.7901923656463623
Epoch: 9, Steps: 32 | Train Loss: 0.718 Vali Loss: 6.876 Vali Acc: 0.489 Test Loss: 6.876 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.819756269454956
Epoch: 10, Steps: 32 | Train Loss: 0.241 Vali Loss: 10.471 Vali Acc: 0.405 Test Loss: 10.471 Test Acc: 0.405
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.786248207092285
Epoch: 11, Steps: 32 | Train Loss: 0.722 Vali Loss: 11.874 Vali Acc: 0.496 Test Loss: 11.874 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.7760169506073
Epoch: 12, Steps: 32 | Train Loss: 0.618 Vali Loss: 9.538 Vali Acc: 0.473 Test Loss: 9.538 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 849061
model size : 3.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 12.885474681854248
Epoch: 1, Steps: 32 | Train Loss: 2.064 Vali Loss: 1.879 Vali Acc: 0.351 Test Loss: 1.879 Test Acc: 0.351
Validation loss decreased (inf --> -0.351126).  Saving model ...
Epoch: 2 cost time: 12.202223300933838
Epoch: 2, Steps: 32 | Train Loss: 1.452 Vali Loss: 2.220 Vali Acc: 0.534 Test Loss: 2.220 Test Acc: 0.534
Validation loss decreased (-0.351126 --> -0.534329).  Saving model ...
Epoch: 3 cost time: 12.437278032302856
Epoch: 3, Steps: 32 | Train Loss: 0.764 Vali Loss: 5.861 Vali Acc: 0.489 Test Loss: 5.861 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 12.683749437332153
Epoch: 4, Steps: 32 | Train Loss: 1.042 Vali Loss: 4.031 Vali Acc: 0.397 Test Loss: 4.031 Test Acc: 0.397
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 12.73185110092163
Epoch: 5, Steps: 32 | Train Loss: 0.474 Vali Loss: 4.321 Vali Acc: 0.435 Test Loss: 4.321 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 12.55971884727478
Epoch: 6, Steps: 32 | Train Loss: 0.147 Vali Loss: 6.008 Vali Acc: 0.557 Test Loss: 6.008 Test Acc: 0.557
Validation loss decreased (-0.534329 --> -0.557192).  Saving model ...
Epoch: 7 cost time: 12.36205005645752
Epoch: 7, Steps: 32 | Train Loss: 0.311 Vali Loss: 4.636 Vali Acc: 0.542 Test Loss: 4.636 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 12.173137426376343
Epoch: 8, Steps: 32 | Train Loss: 0.348 Vali Loss: 5.413 Vali Acc: 0.450 Test Loss: 5.413 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 12.058396577835083
Epoch: 9, Steps: 32 | Train Loss: 0.578 Vali Loss: 8.132 Vali Acc: 0.573 Test Loss: 8.132 Test Acc: 0.573
Validation loss decreased (-0.557192 --> -0.572438).  Saving model ...
Epoch: 10 cost time: 12.290327787399292
Epoch: 10, Steps: 32 | Train Loss: 0.642 Vali Loss: 5.544 Vali Acc: 0.565 Test Loss: 5.544 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 12.44319486618042
Epoch: 11, Steps: 32 | Train Loss: 0.584 Vali Loss: 11.757 Vali Acc: 0.519 Test Loss: 11.757 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 12.20609998703003
Epoch: 12, Steps: 32 | Train Loss: 0.208 Vali Loss: 10.339 Vali Acc: 0.473 Test Loss: 10.339 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 12.087371349334717
Epoch: 13, Steps: 32 | Train Loss: 0.408 Vali Loss: 10.488 Vali Acc: 0.496 Test Loss: 10.488 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 12.046059608459473
Epoch: 14, Steps: 32 | Train Loss: 0.281 Vali Loss: 10.957 Vali Acc: 0.382 Test Loss: 10.957 Test Acc: 0.382
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 12.412791013717651
Epoch: 15, Steps: 32 | Train Loss: 0.329 Vali Loss: 10.514 Vali Acc: 0.450 Test Loss: 10.514 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 12.279459953308105
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 12.382 Vali Acc: 0.534 Test Loss: 12.382 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 12.156076192855835
Epoch: 17, Steps: 32 | Train Loss: 0.121 Vali Loss: 11.325 Vali Acc: 0.481 Test Loss: 11.325 Test Acc: 0.481
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 12.63229775428772
Epoch: 18, Steps: 32 | Train Loss: 0.003 Vali Loss: 10.033 Vali Acc: 0.534 Test Loss: 10.033 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 12.313830614089966
Epoch: 19, Steps: 32 | Train Loss: 0.007 Vali Loss: 10.968 Vali Acc: 0.504 Test Loss: 10.968 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 939637
model size : 4.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.99625039100647
Epoch: 1, Steps: 32 | Train Loss: 2.138 Vali Loss: 2.410 Vali Acc: 0.206 Test Loss: 2.410 Test Acc: 0.206
Validation loss decreased (inf --> -0.206083).  Saving model ...
Epoch: 2 cost time: 4.868370532989502
Epoch: 2, Steps: 32 | Train Loss: 1.327 Vali Loss: 2.299 Vali Acc: 0.290 Test Loss: 2.299 Test Acc: 0.290
Validation loss decreased (-0.206083 --> -0.290053).  Saving model ...
Epoch: 3 cost time: 4.863434076309204
Epoch: 3, Steps: 32 | Train Loss: 0.746 Vali Loss: 2.275 Vali Acc: 0.527 Test Loss: 2.275 Test Acc: 0.527
Validation loss decreased (-0.290053 --> -0.526695).  Saving model ...
Epoch: 4 cost time: 4.829173564910889
Epoch: 4, Steps: 32 | Train Loss: 0.362 Vali Loss: 3.066 Vali Acc: 0.389 Test Loss: 3.066 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.913965225219727
Epoch: 5, Steps: 32 | Train Loss: 0.283 Vali Loss: 3.831 Vali Acc: 0.420 Test Loss: 3.831 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.950116157531738
Epoch: 6, Steps: 32 | Train Loss: 0.107 Vali Loss: 6.168 Vali Acc: 0.336 Test Loss: 6.168 Test Acc: 0.336
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.923321008682251
Epoch: 7, Steps: 32 | Train Loss: 0.097 Vali Loss: 7.346 Vali Acc: 0.450 Test Loss: 7.346 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.035057544708252
Epoch: 8, Steps: 32 | Train Loss: 0.129 Vali Loss: 7.090 Vali Acc: 0.473 Test Loss: 7.090 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.187948226928711
Epoch: 9, Steps: 32 | Train Loss: 0.090 Vali Loss: 6.890 Vali Acc: 0.344 Test Loss: 6.890 Test Acc: 0.344
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.905351400375366
Epoch: 10, Steps: 32 | Train Loss: 0.426 Vali Loss: 8.761 Vali Acc: 0.450 Test Loss: 8.761 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.172610759735107
Epoch: 11, Steps: 32 | Train Loss: 0.180 Vali Loss: 10.058 Vali Acc: 0.305 Test Loss: 10.058 Test Acc: 0.305
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.053033113479614
Epoch: 12, Steps: 32 | Train Loss: 0.474 Vali Loss: 7.817 Vali Acc: 0.450 Test Loss: 7.817 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.993152141571045
Epoch: 13, Steps: 32 | Train Loss: 0.013 Vali Loss: 10.262 Vali Acc: 0.504 Test Loss: 10.262 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 784357
model size : 3.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 9.098717451095581
Epoch: 1, Steps: 32 | Train Loss: 2.074 Vali Loss: 1.889 Vali Acc: 0.328 Test Loss: 1.889 Test Acc: 0.328
Validation loss decreased (inf --> -0.328225).  Saving model ...
Epoch: 2 cost time: 8.67684555053711
Epoch: 2, Steps: 32 | Train Loss: 1.503 Vali Loss: 2.121 Vali Acc: 0.519 Test Loss: 2.121 Test Acc: 0.519
Validation loss decreased (-0.328225 --> -0.519063).  Saving model ...
Epoch: 3 cost time: 8.822301149368286
Epoch: 3, Steps: 32 | Train Loss: 0.756 Vali Loss: 5.078 Vali Acc: 0.489 Test Loss: 5.078 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.171644926071167
Epoch: 4, Steps: 32 | Train Loss: 0.626 Vali Loss: 3.576 Vali Acc: 0.489 Test Loss: 3.576 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 8.851218223571777
Epoch: 5, Steps: 32 | Train Loss: 1.055 Vali Loss: 4.705 Vali Acc: 0.443 Test Loss: 4.705 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 8.907766580581665
Epoch: 6, Steps: 32 | Train Loss: 0.151 Vali Loss: 5.160 Vali Acc: 0.359 Test Loss: 5.160 Test Acc: 0.359
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 8.89774203300476
Epoch: 7, Steps: 32 | Train Loss: 0.056 Vali Loss: 5.852 Vali Acc: 0.443 Test Loss: 5.852 Test Acc: 0.443
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 8.84701943397522
Epoch: 8, Steps: 32 | Train Loss: 0.172 Vali Loss: 6.244 Vali Acc: 0.420 Test Loss: 6.244 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 8.657007455825806
Epoch: 9, Steps: 32 | Train Loss: 0.123 Vali Loss: 6.138 Vali Acc: 0.359 Test Loss: 6.138 Test Acc: 0.359
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 8.87582778930664
Epoch: 10, Steps: 32 | Train Loss: 0.008 Vali Loss: 10.811 Vali Acc: 0.214 Test Loss: 10.811 Test Acc: 0.214
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 8.671411275863647
Epoch: 11, Steps: 32 | Train Loss: 0.088 Vali Loss: 8.063 Vali Acc: 0.511 Test Loss: 8.063 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 9.063272476196289
Epoch: 12, Steps: 32 | Train Loss: 0.480 Vali Loss: 9.222 Vali Acc: 0.328 Test Loss: 9.222 Test Acc: 0.328
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 939637
model size : 4.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.848027467727661
Epoch: 1, Steps: 32 | Train Loss: 2.140 Vali Loss: 2.431 Vali Acc: 0.191 Test Loss: 2.431 Test Acc: 0.191
Validation loss decreased (inf --> -0.190815).  Saving model ...
Epoch: 2 cost time: 3.6287875175476074
Epoch: 2, Steps: 32 | Train Loss: 1.326 Vali Loss: 2.260 Vali Acc: 0.298 Test Loss: 2.260 Test Acc: 0.298
Validation loss decreased (-0.190815 --> -0.297687).  Saving model ...
Epoch: 3 cost time: 3.6339457035064697
Epoch: 3, Steps: 32 | Train Loss: 0.805 Vali Loss: 2.421 Vali Acc: 0.504 Test Loss: 2.421 Test Acc: 0.504
Validation loss decreased (-0.297687 --> -0.503793).  Saving model ...
Epoch: 4 cost time: 3.629382848739624
Epoch: 4, Steps: 32 | Train Loss: 0.374 Vali Loss: 2.981 Vali Acc: 0.366 Test Loss: 2.981 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.7288014888763428
Epoch: 5, Steps: 32 | Train Loss: 0.287 Vali Loss: 3.160 Vali Acc: 0.443 Test Loss: 3.160 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.7370128631591797
Epoch: 6, Steps: 32 | Train Loss: 0.173 Vali Loss: 7.169 Vali Acc: 0.351 Test Loss: 7.169 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.72957181930542
Epoch: 7, Steps: 32 | Train Loss: 0.169 Vali Loss: 8.560 Vali Acc: 0.313 Test Loss: 8.560 Test Acc: 0.313
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.9063382148742676
Epoch: 8, Steps: 32 | Train Loss: 0.007 Vali Loss: 6.001 Vali Acc: 0.489 Test Loss: 6.001 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.001519680023193
Epoch: 9, Steps: 32 | Train Loss: 0.177 Vali Loss: 7.888 Vali Acc: 0.366 Test Loss: 7.888 Test Acc: 0.366
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.22585654258728
Epoch: 10, Steps: 32 | Train Loss: 0.170 Vali Loss: 7.274 Vali Acc: 0.443 Test Loss: 7.274 Test Acc: 0.443
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.856236696243286
Epoch: 11, Steps: 32 | Train Loss: 0.150 Vali Loss: 6.814 Vali Acc: 0.496 Test Loss: 6.814 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.822542667388916
Epoch: 12, Steps: 32 | Train Loss: 0.051 Vali Loss: 6.360 Vali Acc: 0.489 Test Loss: 6.360 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.8551251888275146
Epoch: 13, Steps: 32 | Train Loss: 0.057 Vali Loss: 9.571 Vali Acc: 0.382 Test Loss: 9.571 Test Acc: 0.382
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5038167938931297
model parameter : 784357
model size : 3.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.781322002410889
Epoch: 1, Steps: 32 | Train Loss: 2.083 Vali Loss: 1.795 Vali Acc: 0.397 Test Loss: 1.795 Test Acc: 0.397
Validation loss decreased (inf --> -0.396929).  Saving model ...
Epoch: 2 cost time: 4.618213176727295
Epoch: 2, Steps: 32 | Train Loss: 1.521 Vali Loss: 1.790 Vali Acc: 0.527 Test Loss: 1.790 Test Acc: 0.527
Validation loss decreased (-0.396929 --> -0.526700).  Saving model ...
Epoch: 3 cost time: 4.608457088470459
Epoch: 3, Steps: 32 | Train Loss: 0.820 Vali Loss: 5.554 Vali Acc: 0.504 Test Loss: 5.554 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.8237340450286865
Epoch: 4, Steps: 32 | Train Loss: 0.595 Vali Loss: 4.143 Vali Acc: 0.504 Test Loss: 4.143 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.645249128341675
Epoch: 5, Steps: 32 | Train Loss: 0.092 Vali Loss: 4.815 Vali Acc: 0.427 Test Loss: 4.815 Test Acc: 0.427
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.914917469024658
Epoch: 6, Steps: 32 | Train Loss: 0.237 Vali Loss: 7.254 Vali Acc: 0.336 Test Loss: 7.254 Test Acc: 0.336
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.622264862060547
Epoch: 7, Steps: 32 | Train Loss: 0.200 Vali Loss: 6.850 Vali Acc: 0.282 Test Loss: 6.850 Test Acc: 0.282
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.728527307510376
Epoch: 8, Steps: 32 | Train Loss: 0.304 Vali Loss: 7.425 Vali Acc: 0.344 Test Loss: 7.425 Test Acc: 0.344
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.683047533035278
Epoch: 9, Steps: 32 | Train Loss: 0.340 Vali Loss: 7.303 Vali Acc: 0.450 Test Loss: 7.303 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.012725353240967
Epoch: 10, Steps: 32 | Train Loss: 0.455 Vali Loss: 7.277 Vali Acc: 0.527 Test Loss: 7.277 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.738158226013184
Epoch: 11, Steps: 32 | Train Loss: 0.291 Vali Loss: 8.896 Vali Acc: 0.542 Test Loss: 8.896 Test Acc: 0.542
Validation loss decreased (-0.526700 --> -0.541896).  Saving model ...
Epoch: 12 cost time: 4.762697458267212
Epoch: 12, Steps: 32 | Train Loss: 0.067 Vali Loss: 11.281 Vali Acc: 0.282 Test Loss: 11.281 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.7404608726501465
Epoch: 13, Steps: 32 | Train Loss: 0.188 Vali Loss: 11.843 Vali Acc: 0.290 Test Loss: 11.843 Test Acc: 0.290
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.76021671295166
Epoch: 14, Steps: 32 | Train Loss: 0.124 Vali Loss: 8.999 Vali Acc: 0.389 Test Loss: 8.999 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.927318811416626
Epoch: 15, Steps: 32 | Train Loss: 0.341 Vali Loss: 9.346 Vali Acc: 0.496 Test Loss: 9.346 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.7055017948150635
Epoch: 16, Steps: 32 | Train Loss: 0.147 Vali Loss: 12.509 Vali Acc: 0.382 Test Loss: 12.509 Test Acc: 0.382
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.031936407089233
Epoch: 17, Steps: 32 | Train Loss: 0.221 Vali Loss: 11.249 Vali Acc: 0.534 Test Loss: 11.249 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.695173025131226
Epoch: 18, Steps: 32 | Train Loss: 0.151 Vali Loss: 15.044 Vali Acc: 0.389 Test Loss: 15.044 Test Acc: 0.389
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.0281407833099365
Epoch: 19, Steps: 32 | Train Loss: 0.101 Vali Loss: 16.388 Vali Acc: 0.313 Test Loss: 16.388 Test Acc: 0.313
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.935673475265503
Epoch: 20, Steps: 32 | Train Loss: 0.088 Vali Loss: 14.588 Vali Acc: 0.443 Test Loss: 14.588 Test Acc: 0.443
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.717025518417358
Epoch: 21, Steps: 32 | Train Loss: 0.551 Vali Loss: 13.961 Vali Acc: 0.481 Test Loss: 13.961 Test Acc: 0.481
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 939637
model size : 4.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.552034616470337
Epoch: 1, Steps: 32 | Train Loss: 2.133 Vali Loss: 2.386 Vali Acc: 0.183 Test Loss: 2.386 Test Acc: 0.183
Validation loss decreased (inf --> -0.183182).  Saving model ...
Epoch: 2 cost time: 2.438814640045166
Epoch: 2, Steps: 32 | Train Loss: 1.300 Vali Loss: 2.522 Vali Acc: 0.282 Test Loss: 2.522 Test Acc: 0.282
Validation loss decreased (-0.183182 --> -0.282418).  Saving model ...
Epoch: 3 cost time: 2.470937728881836
Epoch: 3, Steps: 32 | Train Loss: 0.731 Vali Loss: 3.574 Vali Acc: 0.504 Test Loss: 3.574 Test Acc: 0.504
Validation loss decreased (-0.282418 --> -0.503781).  Saving model ...
Epoch: 4 cost time: 2.360358238220215
Epoch: 4, Steps: 32 | Train Loss: 0.644 Vali Loss: 4.690 Vali Acc: 0.237 Test Loss: 4.690 Test Acc: 0.237
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.3591673374176025
Epoch: 5, Steps: 32 | Train Loss: 0.147 Vali Loss: 3.443 Vali Acc: 0.427 Test Loss: 3.443 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.423693895339966
Epoch: 6, Steps: 32 | Train Loss: 0.171 Vali Loss: 5.119 Vali Acc: 0.496 Test Loss: 5.119 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.395448684692383
Epoch: 7, Steps: 32 | Train Loss: 0.260 Vali Loss: 5.972 Vali Acc: 0.519 Test Loss: 5.972 Test Acc: 0.519
Validation loss decreased (-0.503781 --> -0.519024).  Saving model ...
Epoch: 8 cost time: 2.397740125656128
Epoch: 8, Steps: 32 | Train Loss: 0.186 Vali Loss: 6.969 Vali Acc: 0.344 Test Loss: 6.969 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.4266390800476074
Epoch: 9, Steps: 32 | Train Loss: 0.055 Vali Loss: 8.995 Vali Acc: 0.481 Test Loss: 8.995 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.4766533374786377
Epoch: 10, Steps: 32 | Train Loss: 0.597 Vali Loss: 9.219 Vali Acc: 0.313 Test Loss: 9.219 Test Acc: 0.313
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.455678939819336
Epoch: 11, Steps: 32 | Train Loss: 0.549 Vali Loss: 8.693 Vali Acc: 0.420 Test Loss: 8.693 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.4669716358184814
Epoch: 12, Steps: 32 | Train Loss: 0.849 Vali Loss: 10.563 Vali Acc: 0.389 Test Loss: 10.563 Test Acc: 0.389
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.4920401573181152
Epoch: 13, Steps: 32 | Train Loss: 0.185 Vali Loss: 10.112 Vali Acc: 0.405 Test Loss: 10.112 Test Acc: 0.405
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.541579246520996
Epoch: 14, Steps: 32 | Train Loss: 0.156 Vali Loss: 10.849 Vali Acc: 0.450 Test Loss: 10.849 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.411759376525879
Epoch: 15, Steps: 32 | Train Loss: 0.017 Vali Loss: 10.080 Vali Acc: 0.420 Test Loss: 10.080 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.4558331966400146
Epoch: 16, Steps: 32 | Train Loss: 0.001 Vali Loss: 14.896 Vali Acc: 0.344 Test Loss: 14.896 Test Acc: 0.344
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.4615323543548584
Epoch: 17, Steps: 32 | Train Loss: 0.001 Vali Loss: 10.199 Vali Acc: 0.443 Test Loss: 10.199 Test Acc: 0.443
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el3_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 784357
model size : 3.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 335.5558898448944
Epoch: 1, Steps: 32 | Train Loss: 19.973 Vali Loss: 36.633 Vali Acc: 0.489 Test Loss: 36.633 Test Acc: 0.489
Validation loss decreased (inf --> -0.488183).  Saving model ...
Epoch: 2 cost time: 334.04384088516235
Epoch: 2, Steps: 32 | Train Loss: 12.696 Vali Loss: 14.989 Vali Acc: 0.397 Test Loss: 14.989 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 333.3517179489136
Epoch: 3, Steps: 32 | Train Loss: 14.621 Vali Loss: 49.523 Vali Acc: 0.557 Test Loss: 49.523 Test Acc: 0.557
Validation loss decreased (-0.488183 --> -0.556757).  Saving model ...
Epoch: 4 cost time: 330.203577041626
Epoch: 4, Steps: 32 | Train Loss: 27.466 Vali Loss: 37.336 Vali Acc: 0.511 Test Loss: 37.336 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 333.1116199493408
Epoch: 5, Steps: 32 | Train Loss: 12.332 Vali Loss: 75.931 Vali Acc: 0.534 Test Loss: 75.931 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 329.12961602211
Epoch: 6, Steps: 32 | Train Loss: 15.441 Vali Loss: 104.256 Vali Acc: 0.489 Test Loss: 104.256 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 331.35427927970886
Epoch: 7, Steps: 32 | Train Loss: 13.459 Vali Loss: 74.703 Vali Acc: 0.450 Test Loss: 74.703 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 330.0990159511566
Epoch: 8, Steps: 32 | Train Loss: 16.945 Vali Loss: 110.881 Vali Acc: 0.366 Test Loss: 110.881 Test Acc: 0.366
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 330.3505313396454
Epoch: 9, Steps: 32 | Train Loss: 4.784 Vali Loss: 111.201 Vali Acc: 0.489 Test Loss: 111.201 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 327.49699091911316
Epoch: 10, Steps: 32 | Train Loss: 3.069 Vali Loss: 114.429 Vali Acc: 0.328 Test Loss: 114.429 Test Acc: 0.328
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 329.178484916687
Epoch: 11, Steps: 32 | Train Loss: 1.945 Vali Loss: 211.252 Vali Acc: 0.229 Test Loss: 211.252 Test Acc: 0.229
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 330.4603774547577
Epoch: 12, Steps: 32 | Train Loss: 6.541 Vali Loss: 120.990 Vali Acc: 0.550 Test Loss: 120.990 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 327.8044617176056
Epoch: 13, Steps: 32 | Train Loss: 15.229 Vali Loss: 169.054 Vali Acc: 0.359 Test Loss: 169.054 Test Acc: 0.359
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 49004037
model size : 195.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 112.42534637451172
Epoch: 1, Steps: 32 | Train Loss: 10.149 Vali Loss: 21.079 Vali Acc: 0.534 Test Loss: 21.079 Test Acc: 0.534
Validation loss decreased (inf --> -0.534140).  Saving model ...
Epoch: 2 cost time: 111.53344750404358
Epoch: 2, Steps: 32 | Train Loss: 10.353 Vali Loss: 30.314 Vali Acc: 0.237 Test Loss: 30.314 Test Acc: 0.237
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 110.7488853931427
Epoch: 3, Steps: 32 | Train Loss: 16.670 Vali Loss: 37.469 Vali Acc: 0.298 Test Loss: 37.469 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 110.66801142692566
Epoch: 4, Steps: 32 | Train Loss: 20.715 Vali Loss: 90.030 Vali Acc: 0.298 Test Loss: 90.030 Test Acc: 0.298
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 109.52614760398865
Epoch: 5, Steps: 32 | Train Loss: 9.417 Vali Loss: 64.416 Vali Acc: 0.443 Test Loss: 64.416 Test Acc: 0.443
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 110.55873680114746
Epoch: 6, Steps: 32 | Train Loss: 9.873 Vali Loss: 103.547 Vali Acc: 0.511 Test Loss: 103.547 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 110.0116126537323
Epoch: 7, Steps: 32 | Train Loss: 12.275 Vali Loss: 82.344 Vali Acc: 0.466 Test Loss: 82.344 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 109.74698853492737
Epoch: 8, Steps: 32 | Train Loss: 6.043 Vali Loss: 82.377 Vali Acc: 0.481 Test Loss: 82.377 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 109.47030401229858
Epoch: 9, Steps: 32 | Train Loss: 2.570 Vali Loss: 93.789 Vali Acc: 0.504 Test Loss: 93.789 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 109.8901891708374
Epoch: 10, Steps: 32 | Train Loss: 4.243 Vali Loss: 158.627 Vali Acc: 0.496 Test Loss: 158.627 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 108.82538342475891
Epoch: 11, Steps: 32 | Train Loss: 1.708 Vali Loss: 124.476 Vali Acc: 0.504 Test Loss: 124.476 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 22525957
model size : 94.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 219.71987438201904
Epoch: 1, Steps: 32 | Train Loss: 19.954 Vali Loss: 36.316 Vali Acc: 0.489 Test Loss: 36.316 Test Acc: 0.489
Validation loss decreased (inf --> -0.488186).  Saving model ...
Epoch: 2 cost time: 220.2707543373108
Epoch: 2, Steps: 32 | Train Loss: 10.956 Vali Loss: 49.955 Vali Acc: 0.527 Test Loss: 49.955 Test Acc: 0.527
Validation loss decreased (-0.488186 --> -0.526218).  Saving model ...
Epoch: 3 cost time: 218.1931529045105
Epoch: 3, Steps: 32 | Train Loss: 16.413 Vali Loss: 39.062 Vali Acc: 0.420 Test Loss: 39.062 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 216.62402629852295
Epoch: 4, Steps: 32 | Train Loss: 11.221 Vali Loss: 52.447 Vali Acc: 0.313 Test Loss: 52.447 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 218.46537160873413
Epoch: 5, Steps: 32 | Train Loss: 5.808 Vali Loss: 105.026 Vali Acc: 0.542 Test Loss: 105.026 Test Acc: 0.542
Validation loss decreased (-0.526218 --> -0.540934).  Saving model ...
Epoch: 6 cost time: 218.00622868537903
Epoch: 6, Steps: 32 | Train Loss: 7.047 Vali Loss: 65.846 Vali Acc: 0.412 Test Loss: 65.846 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 218.6224753856659
Epoch: 7, Steps: 32 | Train Loss: 17.889 Vali Loss: 147.699 Vali Acc: 0.496 Test Loss: 147.699 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 218.98412680625916
Epoch: 8, Steps: 32 | Train Loss: 17.627 Vali Loss: 106.422 Vali Acc: 0.260 Test Loss: 106.422 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 219.33885169029236
Epoch: 9, Steps: 32 | Train Loss: 4.692 Vali Loss: 79.808 Vali Acc: 0.412 Test Loss: 79.808 Test Acc: 0.412
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 219.4162881374359
Epoch: 10, Steps: 32 | Train Loss: 15.625 Vali Loss: 213.456 Vali Acc: 0.252 Test Loss: 213.456 Test Acc: 0.252
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 217.96583557128906
Epoch: 11, Steps: 32 | Train Loss: 9.365 Vali Loss: 159.564 Vali Acc: 0.473 Test Loss: 159.564 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 218.3271300792694
Epoch: 12, Steps: 32 | Train Loss: 15.439 Vali Loss: 190.073 Vali Acc: 0.481 Test Loss: 190.073 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 217.00439429283142
Epoch: 13, Steps: 32 | Train Loss: 1.324 Vali Loss: 200.566 Vali Acc: 0.405 Test Loss: 200.566 Test Acc: 0.405
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 219.3925211429596
Epoch: 14, Steps: 32 | Train Loss: 12.818 Vali Loss: 156.732 Vali Acc: 0.443 Test Loss: 156.732 Test Acc: 0.443
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 218.70694851875305
Epoch: 15, Steps: 32 | Train Loss: 3.938 Vali Loss: 152.575 Vali Acc: 0.489 Test Loss: 152.575 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 49004037
model size : 195.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 73.62245273590088
Epoch: 1, Steps: 32 | Train Loss: 10.107 Vali Loss: 28.856 Vali Acc: 0.206 Test Loss: 28.856 Test Acc: 0.206
Validation loss decreased (inf --> -0.205818).  Saving model ...
Epoch: 2 cost time: 72.33108139038086
Epoch: 2, Steps: 32 | Train Loss: 17.726 Vali Loss: 50.144 Vali Acc: 0.527 Test Loss: 50.144 Test Acc: 0.527
Validation loss decreased (-0.205818 --> -0.526216).  Saving model ...
Epoch: 3 cost time: 72.40597248077393
Epoch: 3, Steps: 32 | Train Loss: 11.044 Vali Loss: 52.751 Vali Acc: 0.252 Test Loss: 52.751 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 72.42491555213928
Epoch: 4, Steps: 32 | Train Loss: 11.187 Vali Loss: 70.270 Vali Acc: 0.405 Test Loss: 70.270 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 72.24988865852356
Epoch: 5, Steps: 32 | Train Loss: 9.845 Vali Loss: 80.360 Vali Acc: 0.504 Test Loss: 80.360 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 72.37006187438965
Epoch: 6, Steps: 32 | Train Loss: 4.252 Vali Loss: 109.545 Vali Acc: 0.282 Test Loss: 109.545 Test Acc: 0.282
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 72.6138641834259
Epoch: 7, Steps: 32 | Train Loss: 7.169 Vali Loss: 101.756 Vali Acc: 0.527 Test Loss: 101.756 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 71.61980891227722
Epoch: 8, Steps: 32 | Train Loss: 5.359 Vali Loss: 106.501 Vali Acc: 0.511 Test Loss: 106.501 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 72.28954839706421
Epoch: 9, Steps: 32 | Train Loss: 5.875 Vali Loss: 142.055 Vali Acc: 0.473 Test Loss: 142.055 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 72.71811962127686
Epoch: 10, Steps: 32 | Train Loss: 8.701 Vali Loss: 106.685 Vali Acc: 0.427 Test Loss: 106.685 Test Acc: 0.427
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 72.53317856788635
Epoch: 11, Steps: 32 | Train Loss: 15.526 Vali Loss: 158.574 Vali Acc: 0.481 Test Loss: 158.574 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 72.26778936386108
Epoch: 12, Steps: 32 | Train Loss: 8.185 Vali Loss: 152.559 Vali Acc: 0.389 Test Loss: 152.559 Test Acc: 0.389
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 22525957
model size : 94.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 126.86549925804138
Epoch: 1, Steps: 32 | Train Loss: 19.945 Vali Loss: 36.218 Vali Acc: 0.489 Test Loss: 36.218 Test Acc: 0.489
Validation loss decreased (inf --> -0.488187).  Saving model ...
Epoch: 2 cost time: 125.78621339797974
Epoch: 2, Steps: 32 | Train Loss: 11.239 Vali Loss: 37.666 Vali Acc: 0.489 Test Loss: 37.666 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 125.06007170677185
Epoch: 3, Steps: 32 | Train Loss: 8.825 Vali Loss: 45.190 Vali Acc: 0.427 Test Loss: 45.190 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 124.75093007087708
Epoch: 4, Steps: 32 | Train Loss: 18.237 Vali Loss: 39.543 Vali Acc: 0.397 Test Loss: 39.543 Test Acc: 0.397
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 124.45971584320068
Epoch: 5, Steps: 32 | Train Loss: 5.539 Vali Loss: 71.798 Vali Acc: 0.473 Test Loss: 71.798 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 123.98366570472717
Epoch: 6, Steps: 32 | Train Loss: 9.072 Vali Loss: 88.881 Vali Acc: 0.519 Test Loss: 88.881 Test Acc: 0.519
Validation loss decreased (-0.488187 --> -0.518195).  Saving model ...
Epoch: 7 cost time: 123.60111498832703
Epoch: 7, Steps: 32 | Train Loss: 14.383 Vali Loss: 130.676 Vali Acc: 0.244 Test Loss: 130.676 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 124.22198033332825
Epoch: 8, Steps: 32 | Train Loss: 15.486 Vali Loss: 65.338 Vali Acc: 0.389 Test Loss: 65.338 Test Acc: 0.389
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 123.54067873954773
Epoch: 9, Steps: 32 | Train Loss: 4.252 Vali Loss: 63.220 Vali Acc: 0.496 Test Loss: 63.220 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 123.5319447517395
Epoch: 10, Steps: 32 | Train Loss: 3.318 Vali Loss: 82.363 Vali Acc: 0.580 Test Loss: 82.363 Test Acc: 0.580
Validation loss decreased (-0.518195 --> -0.579329).  Saving model ...
Epoch: 11 cost time: 123.5011682510376
Epoch: 11, Steps: 32 | Train Loss: 2.389 Vali Loss: 160.479 Vali Acc: 0.298 Test Loss: 160.479 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 123.14912939071655
Epoch: 12, Steps: 32 | Train Loss: 4.540 Vali Loss: 87.600 Vali Acc: 0.519 Test Loss: 87.600 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 123.3624222278595
Epoch: 13, Steps: 32 | Train Loss: 2.682 Vali Loss: 76.203 Vali Acc: 0.458 Test Loss: 76.203 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 123.84620666503906
Epoch: 14, Steps: 32 | Train Loss: 13.419 Vali Loss: 164.907 Vali Acc: 0.313 Test Loss: 164.907 Test Acc: 0.313
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 123.24288606643677
Epoch: 15, Steps: 32 | Train Loss: 14.977 Vali Loss: 130.703 Vali Acc: 0.527 Test Loss: 130.703 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 123.9259831905365
Epoch: 16, Steps: 32 | Train Loss: 9.555 Vali Loss: 111.117 Vali Acc: 0.603 Test Loss: 111.117 Test Acc: 0.603
Validation loss decreased (-0.579329 --> -0.601942).  Saving model ...
Epoch: 17 cost time: 123.508141040802
Epoch: 17, Steps: 32 | Train Loss: 6.302 Vali Loss: 136.935 Vali Acc: 0.397 Test Loss: 136.935 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 123.65037798881531
Epoch: 18, Steps: 32 | Train Loss: 10.972 Vali Loss: 191.784 Vali Acc: 0.595 Test Loss: 191.784 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 123.19883418083191
Epoch: 19, Steps: 32 | Train Loss: 18.725 Vali Loss: 145.125 Vali Acc: 0.328 Test Loss: 145.125 Test Acc: 0.328
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 122.83360242843628
Epoch: 20, Steps: 32 | Train Loss: 3.053 Vali Loss: 216.065 Vali Acc: 0.504 Test Loss: 216.065 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 122.80331373214722
Epoch: 21, Steps: 32 | Train Loss: 2.501 Vali Loss: 156.724 Vali Acc: 0.382 Test Loss: 156.724 Test Acc: 0.382
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 122.85460829734802
Epoch: 22, Steps: 32 | Train Loss: 29.134 Vali Loss: 158.769 Vali Acc: 0.351 Test Loss: 158.769 Test Acc: 0.351
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 123.27307319641113
Epoch: 23, Steps: 32 | Train Loss: 11.391 Vali Loss: 375.592 Vali Acc: 0.275 Test Loss: 375.592 Test Acc: 0.275
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 123.23203539848328
Epoch: 24, Steps: 32 | Train Loss: 0.551 Vali Loss: 168.926 Vali Acc: 0.527 Test Loss: 168.926 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 122.78236413002014
Epoch: 25, Steps: 32 | Train Loss: 51.602 Vali Loss: 165.749 Vali Acc: 0.557 Test Loss: 165.749 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 123.76987028121948
Epoch: 26, Steps: 32 | Train Loss: 18.736 Vali Loss: 233.130 Vali Acc: 0.450 Test Loss: 233.130 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6030534351145038
model parameter : 49004037
model size : 195.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 40.518662214279175
Epoch: 1, Steps: 32 | Train Loss: 9.362 Vali Loss: 11.880 Vali Acc: 0.252 Test Loss: 11.880 Test Acc: 0.252
Validation loss decreased (inf --> -0.251790).  Saving model ...
Epoch: 2 cost time: 39.16039037704468
Epoch: 2, Steps: 32 | Train Loss: 8.068 Vali Loss: 29.199 Vali Acc: 0.237 Test Loss: 29.199 Test Acc: 0.237
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 39.12534546852112
Epoch: 3, Steps: 32 | Train Loss: 12.490 Vali Loss: 31.762 Vali Acc: 0.359 Test Loss: 31.762 Test Acc: 0.359
Validation loss decreased (-0.251790 --> -0.358461).  Saving model ...
Epoch: 4 cost time: 39.09364414215088
Epoch: 4, Steps: 32 | Train Loss: 13.093 Vali Loss: 47.369 Vali Acc: 0.420 Test Loss: 47.369 Test Acc: 0.420
Validation loss decreased (-0.358461 --> -0.419374).  Saving model ...
Epoch: 5 cost time: 38.84435701370239
Epoch: 5, Steps: 32 | Train Loss: 8.440 Vali Loss: 52.072 Vali Acc: 0.519 Test Loss: 52.072 Test Acc: 0.519
Validation loss decreased (-0.419374 --> -0.518563).  Saving model ...
Epoch: 6 cost time: 38.89743733406067
Epoch: 6, Steps: 32 | Train Loss: 4.057 Vali Loss: 114.050 Vali Acc: 0.557 Test Loss: 114.050 Test Acc: 0.557
Validation loss decreased (-0.518563 --> -0.556111).  Saving model ...
Epoch: 7 cost time: 38.79652738571167
Epoch: 7, Steps: 32 | Train Loss: 17.907 Vali Loss: 54.219 Vali Acc: 0.534 Test Loss: 54.219 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 38.7594108581543
Epoch: 8, Steps: 32 | Train Loss: 2.634 Vali Loss: 91.679 Vali Acc: 0.489 Test Loss: 91.679 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 38.89537501335144
Epoch: 9, Steps: 32 | Train Loss: 7.526 Vali Loss: 179.876 Vali Acc: 0.260 Test Loss: 179.876 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 38.9871039390564
Epoch: 10, Steps: 32 | Train Loss: 3.191 Vali Loss: 96.044 Vali Acc: 0.450 Test Loss: 96.044 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 38.63177299499512
Epoch: 11, Steps: 32 | Train Loss: 0.456 Vali Loss: 127.508 Vali Acc: 0.527 Test Loss: 127.508 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 38.835846185684204
Epoch: 12, Steps: 32 | Train Loss: 3.872 Vali Loss: 120.853 Vali Acc: 0.519 Test Loss: 120.853 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 38.73472261428833
Epoch: 13, Steps: 32 | Train Loss: 1.087 Vali Loss: 102.624 Vali Acc: 0.496 Test Loss: 102.624 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 38.6672899723053
Epoch: 14, Steps: 32 | Train Loss: 2.582 Vali Loss: 111.887 Vali Acc: 0.412 Test Loss: 111.887 Test Acc: 0.412
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 38.937973499298096
Epoch: 15, Steps: 32 | Train Loss: 14.213 Vali Loss: 120.143 Vali Acc: 0.519 Test Loss: 120.143 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 38.84284591674805
Epoch: 16, Steps: 32 | Train Loss: 24.487 Vali Loss: 139.000 Vali Acc: 0.481 Test Loss: 139.000 Test Acc: 0.481
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 22525957
model size : 94.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 216.33423280715942
Epoch: 1, Steps: 64 | Train Loss: 22.326 Vali Loss: 31.150 Vali Acc: 0.450 Test Loss: 31.150 Test Acc: 0.450
Validation loss decreased (inf --> -0.450070).  Saving model ...
Epoch: 2 cost time: 214.16905546188354
Epoch: 2, Steps: 64 | Train Loss: 21.111 Vali Loss: 60.960 Vali Acc: 0.458 Test Loss: 60.960 Test Acc: 0.458
Validation loss decreased (-0.450070 --> -0.457406).  Saving model ...
Epoch: 3 cost time: 212.34237551689148
Epoch: 3, Steps: 64 | Train Loss: 25.472 Vali Loss: 60.121 Vali Acc: 0.511 Test Loss: 60.121 Test Acc: 0.511
Validation loss decreased (-0.457406 --> -0.510849).  Saving model ...
Epoch: 4 cost time: 214.09636616706848
Epoch: 4, Steps: 64 | Train Loss: 33.604 Vali Loss: 98.123 Vali Acc: 0.328 Test Loss: 98.123 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 215.48312377929688
Epoch: 5, Steps: 64 | Train Loss: 13.223 Vali Loss: 106.086 Vali Acc: 0.458 Test Loss: 106.086 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 214.5549771785736
Epoch: 6, Steps: 64 | Train Loss: 22.946 Vali Loss: 177.295 Vali Acc: 0.489 Test Loss: 177.295 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 214.05026412010193
Epoch: 7, Steps: 64 | Train Loss: 39.725 Vali Loss: 151.877 Vali Acc: 0.405 Test Loss: 151.877 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 213.76004028320312
Epoch: 8, Steps: 64 | Train Loss: 11.143 Vali Loss: 239.917 Vali Acc: 0.405 Test Loss: 239.917 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 213.5421917438507
Epoch: 9, Steps: 64 | Train Loss: 8.808 Vali Loss: 157.158 Vali Acc: 0.389 Test Loss: 157.158 Test Acc: 0.389
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 214.13704681396484
Epoch: 10, Steps: 64 | Train Loss: 8.089 Vali Loss: 222.211 Vali Acc: 0.382 Test Loss: 222.211 Test Acc: 0.382
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 212.91575169563293
Epoch: 11, Steps: 64 | Train Loss: 19.643 Vali Loss: 363.489 Vali Acc: 0.298 Test Loss: 363.489 Test Acc: 0.298
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 214.53501749038696
Epoch: 12, Steps: 64 | Train Loss: 26.088 Vali Loss: 223.221 Vali Acc: 0.443 Test Loss: 223.221 Test Acc: 0.443
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 213.53556728363037
Epoch: 13, Steps: 64 | Train Loss: 46.193 Vali Loss: 271.418 Vali Acc: 0.427 Test Loss: 271.418 Test Acc: 0.427
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 30259205
model size : 124.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 81.29110550880432
Epoch: 1, Steps: 32 | Train Loss: 15.696 Vali Loss: 22.223 Vali Acc: 0.206 Test Loss: 22.223 Test Acc: 0.206
Validation loss decreased (inf --> -0.205885).  Saving model ...
Epoch: 2 cost time: 80.78986978530884
Epoch: 2, Steps: 32 | Train Loss: 16.664 Vali Loss: 22.885 Vali Acc: 0.344 Test Loss: 22.885 Test Acc: 0.344
Validation loss decreased (-0.205885 --> -0.343283).  Saving model ...
Epoch: 3 cost time: 80.81601762771606
Epoch: 3, Steps: 32 | Train Loss: 15.246 Vali Loss: 89.870 Vali Acc: 0.237 Test Loss: 89.870 Test Acc: 0.237
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 80.19625639915466
Epoch: 4, Steps: 32 | Train Loss: 14.216 Vali Loss: 54.438 Vali Acc: 0.573 Test Loss: 54.438 Test Acc: 0.573
Validation loss decreased (-0.343283 --> -0.571975).  Saving model ...
Epoch: 5 cost time: 80.30467891693115
Epoch: 5, Steps: 32 | Train Loss: 8.726 Vali Loss: 99.272 Vali Acc: 0.290 Test Loss: 99.272 Test Acc: 0.290
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 80.90812063217163
Epoch: 6, Steps: 32 | Train Loss: 8.373 Vali Loss: 88.072 Vali Acc: 0.557 Test Loss: 88.072 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 80.40211057662964
Epoch: 7, Steps: 32 | Train Loss: 5.094 Vali Loss: 67.533 Vali Acc: 0.389 Test Loss: 67.533 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 79.78595542907715
Epoch: 8, Steps: 32 | Train Loss: 5.081 Vali Loss: 55.130 Vali Acc: 0.427 Test Loss: 55.130 Test Acc: 0.427
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 80.11800265312195
Epoch: 9, Steps: 32 | Train Loss: 2.839 Vali Loss: 73.619 Vali Acc: 0.427 Test Loss: 73.619 Test Acc: 0.427
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 80.2222032546997
Epoch: 10, Steps: 32 | Train Loss: 7.520 Vali Loss: 61.039 Vali Acc: 0.519 Test Loss: 61.039 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 80.22477197647095
Epoch: 11, Steps: 32 | Train Loss: 5.109 Vali Loss: 151.243 Vali Acc: 0.275 Test Loss: 151.243 Test Acc: 0.275
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 79.9646246433258
Epoch: 12, Steps: 32 | Train Loss: 0.448 Vali Loss: 110.787 Vali Acc: 0.489 Test Loss: 110.787 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 79.91984701156616
Epoch: 13, Steps: 32 | Train Loss: 7.982 Vali Loss: 132.966 Vali Acc: 0.511 Test Loss: 132.966 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 80.07835268974304
Epoch: 14, Steps: 32 | Train Loss: 2.472 Vali Loss: 110.592 Vali Acc: 0.542 Test Loss: 110.592 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 17019909
model size : 73.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 145.49611902236938
Epoch: 1, Steps: 64 | Train Loss: 22.155 Vali Loss: 28.675 Vali Acc: 0.374 Test Loss: 28.675 Test Acc: 0.374
Validation loss decreased (inf --> -0.373759).  Saving model ...
Epoch: 2 cost time: 143.23837900161743
Epoch: 2, Steps: 64 | Train Loss: 23.124 Vali Loss: 66.623 Vali Acc: 0.336 Test Loss: 66.623 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 142.7186141014099
Epoch: 3, Steps: 64 | Train Loss: 23.094 Vali Loss: 122.174 Vali Acc: 0.176 Test Loss: 122.174 Test Acc: 0.176
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 141.00171422958374
Epoch: 4, Steps: 64 | Train Loss: 26.183 Vali Loss: 82.375 Vali Acc: 0.489 Test Loss: 82.375 Test Acc: 0.489
Validation loss decreased (-0.373759 --> -0.487726).  Saving model ...
Epoch: 5 cost time: 143.7985167503357
Epoch: 5, Steps: 64 | Train Loss: 16.265 Vali Loss: 130.284 Vali Acc: 0.527 Test Loss: 130.284 Test Acc: 0.527
Validation loss decreased (-0.487726 --> -0.525415).  Saving model ...
Epoch: 6 cost time: 143.45193934440613
Epoch: 6, Steps: 64 | Train Loss: 33.571 Vali Loss: 223.888 Vali Acc: 0.405 Test Loss: 223.888 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 143.69941520690918
Epoch: 7, Steps: 64 | Train Loss: 17.671 Vali Loss: 234.959 Vali Acc: 0.481 Test Loss: 234.959 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 140.80944991111755
Epoch: 8, Steps: 64 | Train Loss: 20.570 Vali Loss: 204.525 Vali Acc: 0.504 Test Loss: 204.525 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 143.33754563331604
Epoch: 9, Steps: 64 | Train Loss: 48.841 Vali Loss: 234.123 Vali Acc: 0.466 Test Loss: 234.123 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 142.23043751716614
Epoch: 10, Steps: 64 | Train Loss: 21.128 Vali Loss: 188.879 Vali Acc: 0.328 Test Loss: 188.879 Test Acc: 0.328
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 142.43842673301697
Epoch: 11, Steps: 64 | Train Loss: 2.819 Vali Loss: 211.552 Vali Acc: 0.504 Test Loss: 211.552 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 142.64070391654968
Epoch: 12, Steps: 64 | Train Loss: 7.299 Vali Loss: 198.692 Vali Acc: 0.412 Test Loss: 198.692 Test Acc: 0.412
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 142.90975785255432
Epoch: 13, Steps: 64 | Train Loss: 16.182 Vali Loss: 237.790 Vali Acc: 0.435 Test Loss: 237.790 Test Acc: 0.435
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 142.8024353981018
Epoch: 14, Steps: 64 | Train Loss: 10.505 Vali Loss: 284.365 Vali Acc: 0.290 Test Loss: 284.365 Test Acc: 0.290
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 142.91998887062073
Epoch: 15, Steps: 64 | Train Loss: 6.636 Vali Loss: 268.477 Vali Acc: 0.550 Test Loss: 268.477 Test Acc: 0.550
Validation loss decreased (-0.525415 --> -0.546934).  Saving model ...
Epoch: 16 cost time: 142.3058729171753
Epoch: 16, Steps: 64 | Train Loss: 10.146 Vali Loss: 305.383 Vali Acc: 0.427 Test Loss: 305.383 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 142.56683325767517
Epoch: 17, Steps: 64 | Train Loss: 7.330 Vali Loss: 238.558 Vali Acc: 0.351 Test Loss: 238.558 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 142.9857280254364
Epoch: 18, Steps: 64 | Train Loss: 17.512 Vali Loss: 286.560 Vali Acc: 0.374 Test Loss: 286.560 Test Acc: 0.374
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 142.5795452594757
Epoch: 19, Steps: 64 | Train Loss: 30.825 Vali Loss: 437.078 Vali Acc: 0.473 Test Loss: 437.078 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 141.6344666481018
Epoch: 20, Steps: 64 | Train Loss: 41.914 Vali Loss: 302.271 Vali Acc: 0.366 Test Loss: 302.271 Test Acc: 0.366
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 143.541442155838
Epoch: 21, Steps: 64 | Train Loss: 15.984 Vali Loss: 521.496 Vali Acc: 0.450 Test Loss: 521.496 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 142.42725563049316
Epoch: 22, Steps: 64 | Train Loss: 28.772 Vali Loss: 731.691 Vali Acc: 0.229 Test Loss: 731.691 Test Acc: 0.229
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 142.06709909439087
Epoch: 23, Steps: 64 | Train Loss: 22.645 Vali Loss: 808.014 Vali Acc: 0.206 Test Loss: 808.014 Test Acc: 0.206
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 142.4088478088379
Epoch: 24, Steps: 64 | Train Loss: 25.348 Vali Loss: 491.672 Vali Acc: 0.267 Test Loss: 491.672 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 141.13474655151367
Epoch: 25, Steps: 64 | Train Loss: 10.369 Vali Loss: 400.557 Vali Acc: 0.412 Test Loss: 400.557 Test Acc: 0.412
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 30259205
model size : 124.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 59.086750745773315
Epoch: 1, Steps: 32 | Train Loss: 16.515 Vali Loss: 28.738 Vali Acc: 0.198 Test Loss: 28.738 Test Acc: 0.198
Validation loss decreased (inf --> -0.198186).  Saving model ...
Epoch: 2 cost time: 58.30352425575256
Epoch: 2, Steps: 32 | Train Loss: 11.656 Vali Loss: 15.456 Vali Acc: 0.366 Test Loss: 15.456 Test Acc: 0.366
Validation loss decreased (-0.198186 --> -0.366258).  Saving model ...
Epoch: 3 cost time: 58.41886520385742
Epoch: 3, Steps: 32 | Train Loss: 8.786 Vali Loss: 36.151 Vali Acc: 0.305 Test Loss: 36.151 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 58.80277705192566
Epoch: 4, Steps: 32 | Train Loss: 7.898 Vali Loss: 44.142 Vali Acc: 0.351 Test Loss: 44.142 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 58.686789751052856
Epoch: 5, Steps: 32 | Train Loss: 4.940 Vali Loss: 49.585 Vali Acc: 0.382 Test Loss: 49.585 Test Acc: 0.382
Validation loss decreased (-0.366258 --> -0.381184).  Saving model ...
Epoch: 6 cost time: 58.689107179641724
Epoch: 6, Steps: 32 | Train Loss: 9.712 Vali Loss: 63.815 Vali Acc: 0.466 Test Loss: 63.815 Test Acc: 0.466
Validation loss decreased (-0.381184 --> -0.465011).  Saving model ...
Epoch: 7 cost time: 58.68931794166565
Epoch: 7, Steps: 32 | Train Loss: 10.391 Vali Loss: 109.579 Vali Acc: 0.275 Test Loss: 109.579 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 58.95114994049072
Epoch: 8, Steps: 32 | Train Loss: 6.991 Vali Loss: 89.899 Vali Acc: 0.321 Test Loss: 89.899 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 58.558507204055786
Epoch: 9, Steps: 32 | Train Loss: 3.680 Vali Loss: 128.061 Vali Acc: 0.557 Test Loss: 128.061 Test Acc: 0.557
Validation loss decreased (-0.465011 --> -0.555971).  Saving model ...
Epoch: 10 cost time: 58.68137288093567
Epoch: 10, Steps: 32 | Train Loss: 7.378 Vali Loss: 87.962 Vali Acc: 0.557 Test Loss: 87.962 Test Acc: 0.557
Validation loss decreased (-0.555971 --> -0.556372).  Saving model ...
Epoch: 11 cost time: 58.506287574768066
Epoch: 11, Steps: 32 | Train Loss: 3.125 Vali Loss: 94.261 Vali Acc: 0.321 Test Loss: 94.261 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 58.38939929008484
Epoch: 12, Steps: 32 | Train Loss: 6.751 Vali Loss: 122.242 Vali Acc: 0.412 Test Loss: 122.242 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 58.58911108970642
Epoch: 13, Steps: 32 | Train Loss: 4.659 Vali Loss: 143.514 Vali Acc: 0.595 Test Loss: 143.514 Test Acc: 0.595
Validation loss decreased (-0.556372 --> -0.593985).  Saving model ...
Epoch: 14 cost time: 58.5840380191803
Epoch: 14, Steps: 32 | Train Loss: 3.728 Vali Loss: 164.313 Vali Acc: 0.328 Test Loss: 164.313 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 58.66125130653381
Epoch: 15, Steps: 32 | Train Loss: 4.996 Vali Loss: 161.140 Vali Acc: 0.443 Test Loss: 161.140 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 58.78711223602295
Epoch: 16, Steps: 32 | Train Loss: 10.391 Vali Loss: 129.447 Vali Acc: 0.519 Test Loss: 129.447 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 59.01205778121948
Epoch: 17, Steps: 32 | Train Loss: 4.980 Vali Loss: 170.658 Vali Acc: 0.336 Test Loss: 170.658 Test Acc: 0.336
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 59.06346273422241
Epoch: 18, Steps: 32 | Train Loss: 0.339 Vali Loss: 209.662 Vali Acc: 0.336 Test Loss: 209.662 Test Acc: 0.336
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 58.59135913848877
Epoch: 19, Steps: 32 | Train Loss: 8.044 Vali Loss: 161.758 Vali Acc: 0.489 Test Loss: 161.758 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 58.598607778549194
Epoch: 20, Steps: 32 | Train Loss: 2.269 Vali Loss: 197.806 Vali Acc: 0.435 Test Loss: 197.806 Test Acc: 0.435
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 59.00999712944031
Epoch: 21, Steps: 32 | Train Loss: 3.819 Vali Loss: 168.503 Vali Acc: 0.450 Test Loss: 168.503 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 58.350311279296875
Epoch: 22, Steps: 32 | Train Loss: 2.136 Vali Loss: 170.831 Vali Acc: 0.382 Test Loss: 170.831 Test Acc: 0.382
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 58.50880837440491
Epoch: 23, Steps: 32 | Train Loss: 7.591 Vali Loss: 278.757 Vali Acc: 0.519 Test Loss: 278.757 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5954198473282443
model parameter : 17019909
model size : 73.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 62.511067390441895
Epoch: 1, Steps: 64 | Train Loss: 21.465 Vali Loss: 33.772 Vali Acc: 0.504 Test Loss: 33.772 Test Acc: 0.504
Validation loss decreased (inf --> -0.503479).  Saving model ...
Epoch: 2 cost time: 60.960065603256226
Epoch: 2, Steps: 64 | Train Loss: 28.015 Vali Loss: 70.526 Vali Acc: 0.527 Test Loss: 70.526 Test Acc: 0.527
Validation loss decreased (-0.503479 --> -0.526012).  Saving model ...
Epoch: 3 cost time: 60.730921030044556
Epoch: 3, Steps: 64 | Train Loss: 21.296 Vali Loss: 79.162 Vali Acc: 0.298 Test Loss: 79.162 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 60.7274444103241
Epoch: 4, Steps: 64 | Train Loss: 27.589 Vali Loss: 136.378 Vali Acc: 0.260 Test Loss: 136.378 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 61.26700139045715
Epoch: 5, Steps: 64 | Train Loss: 17.690 Vali Loss: 115.724 Vali Acc: 0.244 Test Loss: 115.724 Test Acc: 0.244
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 60.64366602897644
Epoch: 6, Steps: 64 | Train Loss: 27.009 Vali Loss: 236.686 Vali Acc: 0.237 Test Loss: 236.686 Test Acc: 0.237
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 60.43239760398865
Epoch: 7, Steps: 64 | Train Loss: 17.905 Vali Loss: 264.732 Vali Acc: 0.244 Test Loss: 264.732 Test Acc: 0.244
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 60.691869258880615
Epoch: 8, Steps: 64 | Train Loss: 11.510 Vali Loss: 204.677 Vali Acc: 0.374 Test Loss: 204.677 Test Acc: 0.374
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 59.99965953826904
Epoch: 9, Steps: 64 | Train Loss: 25.330 Vali Loss: 174.864 Vali Acc: 0.511 Test Loss: 174.864 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 60.17894387245178
Epoch: 10, Steps: 64 | Train Loss: 48.157 Vali Loss: 193.622 Vali Acc: 0.580 Test Loss: 193.622 Test Acc: 0.580
Validation loss decreased (-0.526012 --> -0.578216).  Saving model ...
Epoch: 11 cost time: 61.08717489242554
Epoch: 11, Steps: 64 | Train Loss: 25.473 Vali Loss: 193.627 Vali Acc: 0.374 Test Loss: 193.627 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 60.20278215408325
Epoch: 12, Steps: 64 | Train Loss: 7.545 Vali Loss: 386.122 Vali Acc: 0.244 Test Loss: 386.122 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 60.46354341506958
Epoch: 13, Steps: 64 | Train Loss: 14.245 Vali Loss: 286.689 Vali Acc: 0.519 Test Loss: 286.689 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 60.248023986816406
Epoch: 14, Steps: 64 | Train Loss: 26.614 Vali Loss: 317.350 Vali Acc: 0.473 Test Loss: 317.350 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 60.12581753730774
Epoch: 15, Steps: 64 | Train Loss: 20.407 Vali Loss: 349.646 Vali Acc: 0.519 Test Loss: 349.646 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 60.202091693878174
Epoch: 16, Steps: 64 | Train Loss: 18.071 Vali Loss: 313.002 Vali Acc: 0.252 Test Loss: 313.002 Test Acc: 0.252
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 60.231683015823364
Epoch: 17, Steps: 64 | Train Loss: 19.865 Vali Loss: 285.175 Vali Acc: 0.527 Test Loss: 285.175 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 60.82627201080322
Epoch: 18, Steps: 64 | Train Loss: 9.619 Vali Loss: 214.816 Vali Acc: 0.496 Test Loss: 214.816 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 60.58724665641785
Epoch: 19, Steps: 64 | Train Loss: 3.890 Vali Loss: 339.950 Vali Acc: 0.328 Test Loss: 339.950 Test Acc: 0.328
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 60.224905014038086
Epoch: 20, Steps: 64 | Train Loss: 7.068 Vali Loss: 438.420 Vali Acc: 0.534 Test Loss: 438.420 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 30259205
model size : 124.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 41.28273916244507
Epoch: 1, Steps: 32 | Train Loss: 15.932 Vali Loss: 19.419 Vali Acc: 0.221 Test Loss: 19.419 Test Acc: 0.221
Validation loss decreased (inf --> -0.221180).  Saving model ...
Epoch: 2 cost time: 40.690399408340454
Epoch: 2, Steps: 32 | Train Loss: 11.818 Vali Loss: 34.179 Vali Acc: 0.260 Test Loss: 34.179 Test Acc: 0.260
Validation loss decreased (-0.221180 --> -0.259200).  Saving model ...
Epoch: 3 cost time: 40.5191695690155
Epoch: 3, Steps: 32 | Train Loss: 6.095 Vali Loss: 37.328 Vali Acc: 0.359 Test Loss: 37.328 Test Acc: 0.359
Validation loss decreased (-0.259200 --> -0.358405).  Saving model ...
Epoch: 4 cost time: 40.74699020385742
Epoch: 4, Steps: 32 | Train Loss: 18.117 Vali Loss: 83.455 Vali Acc: 0.305 Test Loss: 83.455 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 40.76136302947998
Epoch: 5, Steps: 32 | Train Loss: 13.423 Vali Loss: 59.551 Vali Acc: 0.580 Test Loss: 59.551 Test Acc: 0.580
Validation loss decreased (-0.358405 --> -0.579557).  Saving model ...
Epoch: 6 cost time: 40.45026969909668
Epoch: 6, Steps: 32 | Train Loss: 6.213 Vali Loss: 80.141 Vali Acc: 0.496 Test Loss: 80.141 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 40.40753936767578
Epoch: 7, Steps: 32 | Train Loss: 10.000 Vali Loss: 129.374 Vali Acc: 0.267 Test Loss: 129.374 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 40.49034762382507
Epoch: 8, Steps: 32 | Train Loss: 9.983 Vali Loss: 83.758 Vali Acc: 0.458 Test Loss: 83.758 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 39.913695096969604
Epoch: 9, Steps: 32 | Train Loss: 12.067 Vali Loss: 138.639 Vali Acc: 0.267 Test Loss: 138.639 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 40.525044679641724
Epoch: 10, Steps: 32 | Train Loss: 6.619 Vali Loss: 79.509 Vali Acc: 0.504 Test Loss: 79.509 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 40.506972789764404
Epoch: 11, Steps: 32 | Train Loss: 1.456 Vali Loss: 151.478 Vali Acc: 0.527 Test Loss: 151.478 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 40.47947406768799
Epoch: 12, Steps: 32 | Train Loss: 5.554 Vali Loss: 115.590 Vali Acc: 0.412 Test Loss: 115.590 Test Acc: 0.412
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 40.45728659629822
Epoch: 13, Steps: 32 | Train Loss: 1.784 Vali Loss: 168.704 Vali Acc: 0.466 Test Loss: 168.704 Test Acc: 0.466
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 40.239078998565674
Epoch: 14, Steps: 32 | Train Loss: 12.096 Vali Loss: 99.877 Vali Acc: 0.351 Test Loss: 99.877 Test Acc: 0.351
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 40.339717388153076
Epoch: 15, Steps: 32 | Train Loss: 6.162 Vali Loss: 112.482 Vali Acc: 0.397 Test Loss: 112.482 Test Acc: 0.397
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 17019909
model size : 73.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 204.36554098129272
Epoch: 1, Steps: 32 | Train Loss: 4.759 Vali Loss: 5.112 Vali Acc: 0.519 Test Loss: 5.112 Test Acc: 0.519
Validation loss decreased (inf --> -0.519033).  Saving model ...
Epoch: 2 cost time: 201.72206020355225
Epoch: 2, Steps: 32 | Train Loss: 4.705 Vali Loss: 19.800 Vali Acc: 0.313 Test Loss: 19.800 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 203.71305894851685
Epoch: 3, Steps: 32 | Train Loss: 5.487 Vali Loss: 17.268 Vali Acc: 0.489 Test Loss: 17.268 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 201.78762102127075
Epoch: 4, Steps: 32 | Train Loss: 3.854 Vali Loss: 15.190 Vali Acc: 0.542 Test Loss: 15.190 Test Acc: 0.542
Validation loss decreased (-0.519033 --> -0.541833).  Saving model ...
Epoch: 5 cost time: 199.6144769191742
Epoch: 5, Steps: 32 | Train Loss: 9.509 Vali Loss: 37.556 Vali Acc: 0.305 Test Loss: 37.556 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 201.12265181541443
Epoch: 6, Steps: 32 | Train Loss: 3.056 Vali Loss: 19.593 Vali Acc: 0.511 Test Loss: 19.593 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 198.89864349365234
Epoch: 7, Steps: 32 | Train Loss: 2.311 Vali Loss: 29.138 Vali Acc: 0.504 Test Loss: 29.138 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 200.39599895477295
Epoch: 8, Steps: 32 | Train Loss: 3.050 Vali Loss: 49.804 Vali Acc: 0.382 Test Loss: 49.804 Test Acc: 0.382
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 199.2872428894043
Epoch: 9, Steps: 32 | Train Loss: 7.855 Vali Loss: 78.188 Vali Acc: 0.305 Test Loss: 78.188 Test Acc: 0.305
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 198.4821138381958
Epoch: 10, Steps: 32 | Train Loss: 7.445 Vali Loss: 49.201 Vali Acc: 0.511 Test Loss: 49.201 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 199.34940838813782
Epoch: 11, Steps: 32 | Train Loss: 2.785 Vali Loss: 76.134 Vali Acc: 0.534 Test Loss: 76.134 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 197.71424460411072
Epoch: 12, Steps: 32 | Train Loss: 7.404 Vali Loss: 69.092 Vali Acc: 0.366 Test Loss: 69.092 Test Acc: 0.366
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 197.79469776153564
Epoch: 13, Steps: 32 | Train Loss: 2.845 Vali Loss: 76.302 Vali Acc: 0.519 Test Loss: 76.302 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 197.4285864830017
Epoch: 14, Steps: 32 | Train Loss: 4.026 Vali Loss: 120.682 Vali Acc: 0.282 Test Loss: 120.682 Test Acc: 0.282
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 24503557
model size : 97.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 72.85823726654053
Epoch: 1, Steps: 32 | Train Loss: 7.706 Vali Loss: 9.267 Vali Acc: 0.176 Test Loss: 9.267 Test Acc: 0.176
Validation loss decreased (inf --> -0.175480).  Saving model ...
Epoch: 2 cost time: 71.9276750087738
Epoch: 2, Steps: 32 | Train Loss: 5.570 Vali Loss: 8.265 Vali Acc: 0.473 Test Loss: 8.265 Test Acc: 0.473
Validation loss decreased (-0.175480 --> -0.473200).  Saving model ...
Epoch: 3 cost time: 71.84173798561096
Epoch: 3, Steps: 32 | Train Loss: 4.814 Vali Loss: 25.046 Vali Acc: 0.298 Test Loss: 25.046 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 72.1135458946228
Epoch: 4, Steps: 32 | Train Loss: 5.070 Vali Loss: 20.930 Vali Acc: 0.420 Test Loss: 20.930 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 71.31771230697632
Epoch: 5, Steps: 32 | Train Loss: 7.742 Vali Loss: 31.529 Vali Acc: 0.519 Test Loss: 31.529 Test Acc: 0.519
Validation loss decreased (-0.473200 --> -0.518769).  Saving model ...
Epoch: 6 cost time: 71.22113800048828
Epoch: 6, Steps: 32 | Train Loss: 6.919 Vali Loss: 29.799 Vali Acc: 0.420 Test Loss: 29.799 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 70.63023924827576
Epoch: 7, Steps: 32 | Train Loss: 4.365 Vali Loss: 37.192 Vali Acc: 0.519 Test Loss: 37.192 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 71.52180480957031
Epoch: 8, Steps: 32 | Train Loss: 7.911 Vali Loss: 54.469 Vali Acc: 0.504 Test Loss: 54.469 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 71.20623540878296
Epoch: 9, Steps: 32 | Train Loss: 6.835 Vali Loss: 48.187 Vali Acc: 0.504 Test Loss: 48.187 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 71.028564453125
Epoch: 10, Steps: 32 | Train Loss: 10.975 Vali Loss: 77.569 Vali Acc: 0.305 Test Loss: 77.569 Test Acc: 0.305
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 70.94651556015015
Epoch: 11, Steps: 32 | Train Loss: 4.868 Vali Loss: 67.526 Vali Acc: 0.542 Test Loss: 67.526 Test Acc: 0.542
Validation loss decreased (-0.518769 --> -0.541309).  Saving model ...
Epoch: 12 cost time: 71.01947045326233
Epoch: 12, Steps: 32 | Train Loss: 3.655 Vali Loss: 49.523 Vali Acc: 0.496 Test Loss: 49.523 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 70.53813123703003
Epoch: 13, Steps: 32 | Train Loss: 7.887 Vali Loss: 67.931 Vali Acc: 0.511 Test Loss: 67.931 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 71.32038521766663
Epoch: 14, Steps: 32 | Train Loss: 2.555 Vali Loss: 89.382 Vali Acc: 0.504 Test Loss: 89.382 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 70.7601969242096
Epoch: 15, Steps: 32 | Train Loss: 4.515 Vali Loss: 78.085 Vali Acc: 0.466 Test Loss: 78.085 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 71.9187695980072
Epoch: 16, Steps: 32 | Train Loss: 2.468 Vali Loss: 105.005 Vali Acc: 0.389 Test Loss: 105.005 Test Acc: 0.389
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 71.80355381965637
Epoch: 17, Steps: 32 | Train Loss: 3.115 Vali Loss: 116.766 Vali Acc: 0.496 Test Loss: 116.766 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 71.8127269744873
Epoch: 18, Steps: 32 | Train Loss: 3.020 Vali Loss: 121.330 Vali Acc: 0.313 Test Loss: 121.330 Test Acc: 0.313
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 70.8655948638916
Epoch: 19, Steps: 32 | Train Loss: 2.117 Vali Loss: 100.399 Vali Acc: 0.443 Test Loss: 100.399 Test Acc: 0.443
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 70.86223149299622
Epoch: 20, Steps: 32 | Train Loss: 0.216 Vali Loss: 100.517 Vali Acc: 0.313 Test Loss: 100.517 Test Acc: 0.313
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 71.52666115760803
Epoch: 21, Steps: 32 | Train Loss: 0.957 Vali Loss: 201.970 Vali Acc: 0.275 Test Loss: 201.970 Test Acc: 0.275
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 11264005
model size : 47.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 129.7996015548706
Epoch: 1, Steps: 32 | Train Loss: 5.165 Vali Loss: 5.864 Vali Acc: 0.244 Test Loss: 5.864 Test Acc: 0.244
Validation loss decreased (inf --> -0.244216).  Saving model ...
Epoch: 2 cost time: 127.58776807785034
Epoch: 2, Steps: 32 | Train Loss: 3.829 Vali Loss: 9.066 Vali Acc: 0.557 Test Loss: 9.066 Test Acc: 0.557
Validation loss decreased (-0.244216 --> -0.557161).  Saving model ...
Epoch: 3 cost time: 127.22193050384521
Epoch: 3, Steps: 32 | Train Loss: 7.570 Vali Loss: 31.561 Vali Acc: 0.221 Test Loss: 31.561 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 128.31041383743286
Epoch: 4, Steps: 32 | Train Loss: 4.948 Vali Loss: 43.498 Vali Acc: 0.282 Test Loss: 43.498 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 127.54833149909973
Epoch: 5, Steps: 32 | Train Loss: 3.361 Vali Loss: 24.536 Vali Acc: 0.481 Test Loss: 24.536 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 127.84117341041565
Epoch: 6, Steps: 32 | Train Loss: 2.074 Vali Loss: 35.356 Vali Acc: 0.397 Test Loss: 35.356 Test Acc: 0.397
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 127.03023195266724
Epoch: 7, Steps: 32 | Train Loss: 3.186 Vali Loss: 37.963 Vali Acc: 0.542 Test Loss: 37.963 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 126.61708307266235
Epoch: 8, Steps: 32 | Train Loss: 0.861 Vali Loss: 60.124 Vali Acc: 0.511 Test Loss: 60.124 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 127.74676752090454
Epoch: 9, Steps: 32 | Train Loss: 4.182 Vali Loss: 47.692 Vali Acc: 0.382 Test Loss: 47.692 Test Acc: 0.382
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 126.73391127586365
Epoch: 10, Steps: 32 | Train Loss: 4.526 Vali Loss: 51.606 Vali Acc: 0.534 Test Loss: 51.606 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 127.57904386520386
Epoch: 11, Steps: 32 | Train Loss: 6.864 Vali Loss: 50.058 Vali Acc: 0.496 Test Loss: 50.058 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 126.86949920654297
Epoch: 12, Steps: 32 | Train Loss: 5.514 Vali Loss: 67.103 Vali Acc: 0.473 Test Loss: 67.103 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 24503557
model size : 97.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 46.18637442588806
Epoch: 1, Steps: 32 | Train Loss: 7.329 Vali Loss: 8.163 Vali Acc: 0.176 Test Loss: 8.163 Test Acc: 0.176
Validation loss decreased (inf --> -0.175491).  Saving model ...
Epoch: 2 cost time: 45.75324535369873
Epoch: 2, Steps: 32 | Train Loss: 6.965 Vali Loss: 11.649 Vali Acc: 0.496 Test Loss: 11.649 Test Acc: 0.496
Validation loss decreased (-0.175491 --> -0.496067).  Saving model ...
Epoch: 3 cost time: 46.070245027542114
Epoch: 3, Steps: 32 | Train Loss: 6.202 Vali Loss: 22.455 Vali Acc: 0.405 Test Loss: 22.455 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 46.52575063705444
Epoch: 4, Steps: 32 | Train Loss: 3.244 Vali Loss: 26.410 Vali Acc: 0.305 Test Loss: 26.410 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 45.351709604263306
Epoch: 5, Steps: 32 | Train Loss: 2.565 Vali Loss: 33.764 Vali Acc: 0.519 Test Loss: 33.764 Test Acc: 0.519
Validation loss decreased (-0.496067 --> -0.518746).  Saving model ...
Epoch: 6 cost time: 45.82477617263794
Epoch: 6, Steps: 32 | Train Loss: 5.717 Vali Loss: 61.103 Vali Acc: 0.336 Test Loss: 61.103 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 45.52972149848938
Epoch: 7, Steps: 32 | Train Loss: 10.303 Vali Loss: 46.280 Vali Acc: 0.466 Test Loss: 46.280 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 45.37294006347656
Epoch: 8, Steps: 32 | Train Loss: 10.092 Vali Loss: 79.079 Vali Acc: 0.252 Test Loss: 79.079 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 45.75514817237854
Epoch: 9, Steps: 32 | Train Loss: 6.396 Vali Loss: 53.608 Vali Acc: 0.527 Test Loss: 53.608 Test Acc: 0.527
Validation loss decreased (-0.518746 --> -0.526181).  Saving model ...
Epoch: 10 cost time: 44.973525524139404
Epoch: 10, Steps: 32 | Train Loss: 2.972 Vali Loss: 55.473 Vali Acc: 0.534 Test Loss: 55.473 Test Acc: 0.534
Validation loss decreased (-0.526181 --> -0.533796).  Saving model ...
Epoch: 11 cost time: 45.680399894714355
Epoch: 11, Steps: 32 | Train Loss: 1.581 Vali Loss: 47.413 Vali Acc: 0.496 Test Loss: 47.413 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 45.64824390411377
Epoch: 12, Steps: 32 | Train Loss: 1.343 Vali Loss: 85.208 Vali Acc: 0.328 Test Loss: 85.208 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 45.17723369598389
Epoch: 13, Steps: 32 | Train Loss: 1.597 Vali Loss: 112.961 Vali Acc: 0.290 Test Loss: 112.961 Test Acc: 0.290
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 45.109708309173584
Epoch: 14, Steps: 32 | Train Loss: 6.401 Vali Loss: 72.714 Vali Acc: 0.397 Test Loss: 72.714 Test Acc: 0.397
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 45.19128108024597
Epoch: 15, Steps: 32 | Train Loss: 0.758 Vali Loss: 70.700 Vali Acc: 0.519 Test Loss: 70.700 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 45.599870920181274
Epoch: 16, Steps: 32 | Train Loss: 0.004 Vali Loss: 114.804 Vali Acc: 0.435 Test Loss: 114.804 Test Acc: 0.435
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 45.56836295127869
Epoch: 17, Steps: 32 | Train Loss: 4.036 Vali Loss: 105.590 Vali Acc: 0.351 Test Loss: 105.590 Test Acc: 0.351
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 45.38034653663635
Epoch: 18, Steps: 32 | Train Loss: 5.583 Vali Loss: 106.895 Vali Acc: 0.557 Test Loss: 106.895 Test Acc: 0.557
Validation loss decreased (-0.533796 --> -0.556183).  Saving model ...
Epoch: 19 cost time: 45.44389224052429
Epoch: 19, Steps: 32 | Train Loss: 2.022 Vali Loss: 106.612 Vali Acc: 0.481 Test Loss: 106.612 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 44.80396509170532
Epoch: 20, Steps: 32 | Train Loss: 4.904 Vali Loss: 144.635 Vali Acc: 0.252 Test Loss: 144.635 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 45.40961265563965
Epoch: 21, Steps: 32 | Train Loss: 5.633 Vali Loss: 156.406 Vali Acc: 0.374 Test Loss: 156.406 Test Acc: 0.374
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 45.56518006324768
Epoch: 22, Steps: 32 | Train Loss: 11.376 Vali Loss: 95.686 Vali Acc: 0.458 Test Loss: 95.686 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 45.9673273563385
Epoch: 23, Steps: 32 | Train Loss: 2.711 Vali Loss: 112.103 Vali Acc: 0.359 Test Loss: 112.103 Test Acc: 0.359
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 45.71704053878784
Epoch: 24, Steps: 32 | Train Loss: 4.994 Vali Loss: 141.100 Vali Acc: 0.557 Test Loss: 141.100 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 45.36441206932068
Epoch: 25, Steps: 32 | Train Loss: 3.277 Vali Loss: 147.079 Vali Acc: 0.397 Test Loss: 147.079 Test Acc: 0.397
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 45.60182476043701
Epoch: 26, Steps: 32 | Train Loss: 3.009 Vali Loss: 103.380 Vali Acc: 0.473 Test Loss: 103.380 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 45.41502833366394
Epoch: 27, Steps: 32 | Train Loss: 1.046 Vali Loss: 137.295 Vali Acc: 0.527 Test Loss: 137.295 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 45.204251289367676
Epoch: 28, Steps: 32 | Train Loss: 2.106 Vali Loss: 129.419 Vali Acc: 0.534 Test Loss: 129.419 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 11264005
model size : 47.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 70.66842365264893
Epoch: 1, Steps: 32 | Train Loss: 5.101 Vali Loss: 6.261 Vali Acc: 0.260 Test Loss: 6.261 Test Acc: 0.260
Validation loss decreased (inf --> -0.259479).  Saving model ...
Epoch: 2 cost time: 69.34757399559021
Epoch: 2, Steps: 32 | Train Loss: 3.224 Vali Loss: 16.218 Vali Acc: 0.260 Test Loss: 16.218 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 69.56144142150879
Epoch: 3, Steps: 32 | Train Loss: 6.564 Vali Loss: 38.188 Vali Acc: 0.160 Test Loss: 38.188 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 69.27666163444519
Epoch: 4, Steps: 32 | Train Loss: 7.395 Vali Loss: 21.019 Vali Acc: 0.565 Test Loss: 21.019 Test Acc: 0.565
Validation loss decreased (-0.259479 --> -0.564675).  Saving model ...
Epoch: 5 cost time: 69.11642742156982
Epoch: 5, Steps: 32 | Train Loss: 2.135 Vali Loss: 33.295 Vali Acc: 0.397 Test Loss: 33.295 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 68.64021039009094
Epoch: 6, Steps: 32 | Train Loss: 2.584 Vali Loss: 48.366 Vali Acc: 0.511 Test Loss: 48.366 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 68.42879366874695
Epoch: 7, Steps: 32 | Train Loss: 5.681 Vali Loss: 43.029 Vali Acc: 0.344 Test Loss: 43.029 Test Acc: 0.344
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 68.73278665542603
Epoch: 8, Steps: 32 | Train Loss: 3.094 Vali Loss: 60.319 Vali Acc: 0.542 Test Loss: 60.319 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 68.48188662528992
Epoch: 9, Steps: 32 | Train Loss: 4.213 Vali Loss: 34.776 Vali Acc: 0.473 Test Loss: 34.776 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 68.23638558387756
Epoch: 10, Steps: 32 | Train Loss: 4.329 Vali Loss: 66.418 Vali Acc: 0.489 Test Loss: 66.418 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 68.28135180473328
Epoch: 11, Steps: 32 | Train Loss: 3.711 Vali Loss: 70.626 Vali Acc: 0.527 Test Loss: 70.626 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 68.21511697769165
Epoch: 12, Steps: 32 | Train Loss: 3.447 Vali Loss: 84.150 Vali Acc: 0.527 Test Loss: 84.150 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 68.27708554267883
Epoch: 13, Steps: 32 | Train Loss: 1.595 Vali Loss: 77.114 Vali Acc: 0.504 Test Loss: 77.114 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 68.32036638259888
Epoch: 14, Steps: 32 | Train Loss: 5.817 Vali Loss: 90.292 Vali Acc: 0.534 Test Loss: 90.292 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 24503557
model size : 97.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 23.973838329315186
Epoch: 1, Steps: 32 | Train Loss: 7.711 Vali Loss: 11.428 Vali Acc: 0.168 Test Loss: 11.428 Test Acc: 0.168
Validation loss decreased (inf --> -0.167825).  Saving model ...
Epoch: 2 cost time: 23.438864946365356
Epoch: 2, Steps: 32 | Train Loss: 4.856 Vali Loss: 9.770 Vali Acc: 0.496 Test Loss: 9.770 Test Acc: 0.496
Validation loss decreased (-0.167825 --> -0.496086).  Saving model ...
Epoch: 3 cost time: 23.190550088882446
Epoch: 3, Steps: 32 | Train Loss: 4.656 Vali Loss: 34.209 Vali Acc: 0.244 Test Loss: 34.209 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 23.105257749557495
Epoch: 4, Steps: 32 | Train Loss: 6.008 Vali Loss: 22.344 Vali Acc: 0.427 Test Loss: 22.344 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 23.23311996459961
Epoch: 5, Steps: 32 | Train Loss: 2.512 Vali Loss: 49.219 Vali Acc: 0.252 Test Loss: 49.219 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 23.166601181030273
Epoch: 6, Steps: 32 | Train Loss: 9.228 Vali Loss: 40.687 Vali Acc: 0.542 Test Loss: 40.687 Test Acc: 0.542
Validation loss decreased (-0.496086 --> -0.541578).  Saving model ...
Epoch: 7 cost time: 23.237584829330444
Epoch: 7, Steps: 32 | Train Loss: 4.264 Vali Loss: 44.379 Vali Acc: 0.420 Test Loss: 44.379 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 23.227969646453857
Epoch: 8, Steps: 32 | Train Loss: 3.485 Vali Loss: 36.505 Vali Acc: 0.527 Test Loss: 36.505 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 23.08362102508545
Epoch: 9, Steps: 32 | Train Loss: 1.609 Vali Loss: 39.173 Vali Acc: 0.580 Test Loss: 39.173 Test Acc: 0.580
Validation loss decreased (-0.541578 --> -0.579761).  Saving model ...
Epoch: 10 cost time: 22.966251611709595
Epoch: 10, Steps: 32 | Train Loss: 2.228 Vali Loss: 41.428 Vali Acc: 0.435 Test Loss: 41.428 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 23.222187995910645
Epoch: 11, Steps: 32 | Train Loss: 0.493 Vali Loss: 71.739 Vali Acc: 0.359 Test Loss: 71.739 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 23.546685457229614
Epoch: 12, Steps: 32 | Train Loss: 6.054 Vali Loss: 53.514 Vali Acc: 0.588 Test Loss: 53.514 Test Acc: 0.588
Validation loss decreased (-0.579761 --> -0.587251).  Saving model ...
Epoch: 13 cost time: 23.21436333656311
Epoch: 13, Steps: 32 | Train Loss: 4.557 Vali Loss: 54.803 Vali Acc: 0.397 Test Loss: 54.803 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 23.262473821640015
Epoch: 14, Steps: 32 | Train Loss: 0.357 Vali Loss: 85.343 Vali Acc: 0.366 Test Loss: 85.343 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 23.208611249923706
Epoch: 15, Steps: 32 | Train Loss: 3.698 Vali Loss: 85.310 Vali Acc: 0.336 Test Loss: 85.310 Test Acc: 0.336
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 23.180898427963257
Epoch: 16, Steps: 32 | Train Loss: 16.287 Vali Loss: 79.395 Vali Acc: 0.389 Test Loss: 79.395 Test Acc: 0.389
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 23.35047197341919
Epoch: 17, Steps: 32 | Train Loss: 6.386 Vali Loss: 102.904 Vali Acc: 0.542 Test Loss: 102.904 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 22.854081630706787
Epoch: 18, Steps: 32 | Train Loss: 2.916 Vali Loss: 84.611 Vali Acc: 0.511 Test Loss: 84.611 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 23.137386798858643
Epoch: 19, Steps: 32 | Train Loss: 4.546 Vali Loss: 65.040 Vali Acc: 0.397 Test Loss: 65.040 Test Acc: 0.397
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 23.16913414001465
Epoch: 20, Steps: 32 | Train Loss: 9.840 Vali Loss: 103.820 Vali Acc: 0.282 Test Loss: 103.820 Test Acc: 0.282
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 23.031147956848145
Epoch: 21, Steps: 32 | Train Loss: 5.999 Vali Loss: 72.062 Vali Acc: 0.542 Test Loss: 72.062 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 23.161681413650513
Epoch: 22, Steps: 32 | Train Loss: 0.798 Vali Loss: 64.640 Vali Acc: 0.557 Test Loss: 64.640 Test Acc: 0.557
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 11264005
model size : 47.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 122.26702427864075
Epoch: 1, Steps: 32 | Train Loss: 6.391 Vali Loss: 9.617 Vali Acc: 0.168 Test Loss: 9.617 Test Acc: 0.168
Validation loss decreased (inf --> -0.167843).  Saving model ...
Epoch: 2 cost time: 120.16426157951355
Epoch: 2, Steps: 32 | Train Loss: 4.911 Vali Loss: 5.605 Vali Acc: 0.534 Test Loss: 5.605 Test Acc: 0.534
Validation loss decreased (-0.167843 --> -0.534295).  Saving model ...
Epoch: 3 cost time: 118.78372025489807
Epoch: 3, Steps: 32 | Train Loss: 2.830 Vali Loss: 10.303 Vali Acc: 0.427 Test Loss: 10.303 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 119.9753954410553
Epoch: 4, Steps: 32 | Train Loss: 4.848 Vali Loss: 13.053 Vali Acc: 0.557 Test Loss: 13.053 Test Acc: 0.557
Validation loss decreased (-0.534295 --> -0.557121).  Saving model ...
Epoch: 5 cost time: 119.79182481765747
Epoch: 5, Steps: 32 | Train Loss: 3.672 Vali Loss: 27.411 Vali Acc: 0.557 Test Loss: 27.411 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 119.56382727622986
Epoch: 6, Steps: 32 | Train Loss: 1.984 Vali Loss: 61.318 Vali Acc: 0.275 Test Loss: 61.318 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 119.34416890144348
Epoch: 7, Steps: 32 | Train Loss: 4.685 Vali Loss: 56.610 Vali Acc: 0.305 Test Loss: 56.610 Test Acc: 0.305
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 119.68551731109619
Epoch: 8, Steps: 32 | Train Loss: 5.378 Vali Loss: 44.451 Vali Acc: 0.405 Test Loss: 44.451 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 119.48196697235107
Epoch: 9, Steps: 32 | Train Loss: 7.500 Vali Loss: 50.694 Vali Acc: 0.450 Test Loss: 50.694 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 119.61077809333801
Epoch: 10, Steps: 32 | Train Loss: 4.488 Vali Loss: 56.795 Vali Acc: 0.496 Test Loss: 56.795 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 119.08503270149231
Epoch: 11, Steps: 32 | Train Loss: 5.885 Vali Loss: 53.990 Vali Acc: 0.359 Test Loss: 53.990 Test Acc: 0.359
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 118.91848111152649
Epoch: 12, Steps: 32 | Train Loss: 1.490 Vali Loss: 54.849 Vali Acc: 0.473 Test Loss: 54.849 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 118.85709953308105
Epoch: 13, Steps: 32 | Train Loss: 3.829 Vali Loss: 101.012 Vali Acc: 0.519 Test Loss: 101.012 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 119.86518692970276
Epoch: 14, Steps: 32 | Train Loss: 3.453 Vali Loss: 78.473 Vali Acc: 0.473 Test Loss: 78.473 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 15130373
model size : 62.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 52.518322706222534
Epoch: 1, Steps: 32 | Train Loss: 7.007 Vali Loss: 7.771 Vali Acc: 0.412 Test Loss: 7.771 Test Acc: 0.412
Validation loss decreased (inf --> -0.412136).  Saving model ...
Epoch: 2 cost time: 52.09697484970093
Epoch: 2, Steps: 32 | Train Loss: 5.123 Vali Loss: 18.289 Vali Acc: 0.221 Test Loss: 18.289 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 52.380767822265625
Epoch: 3, Steps: 32 | Train Loss: 6.949 Vali Loss: 14.146 Vali Acc: 0.412 Test Loss: 14.146 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 51.84490156173706
Epoch: 4, Steps: 32 | Train Loss: 5.319 Vali Loss: 15.753 Vali Acc: 0.496 Test Loss: 15.753 Test Acc: 0.496
Validation loss decreased (-0.412136 --> -0.496026).  Saving model ...
Epoch: 5 cost time: 51.770620822906494
Epoch: 5, Steps: 32 | Train Loss: 3.481 Vali Loss: 20.733 Vali Acc: 0.580 Test Loss: 20.733 Test Acc: 0.580
Validation loss decreased (-0.496026 --> -0.579945).  Saving model ...
Epoch: 6 cost time: 51.737712144851685
Epoch: 6, Steps: 32 | Train Loss: 2.449 Vali Loss: 17.576 Vali Acc: 0.603 Test Loss: 17.576 Test Acc: 0.603
Validation loss decreased (-0.579945 --> -0.602878).  Saving model ...
Epoch: 7 cost time: 51.427011251449585
Epoch: 7, Steps: 32 | Train Loss: 0.578 Vali Loss: 36.588 Vali Acc: 0.412 Test Loss: 36.588 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 51.69520807266235
Epoch: 8, Steps: 32 | Train Loss: 1.195 Vali Loss: 28.127 Vali Acc: 0.634 Test Loss: 28.127 Test Acc: 0.634
Validation loss decreased (-0.602878 --> -0.633307).  Saving model ...
Epoch: 9 cost time: 52.02302384376526
Epoch: 9, Steps: 32 | Train Loss: 5.366 Vali Loss: 26.909 Vali Acc: 0.443 Test Loss: 26.909 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 51.32819938659668
Epoch: 10, Steps: 32 | Train Loss: 5.353 Vali Loss: 65.291 Vali Acc: 0.534 Test Loss: 65.291 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 51.629966020584106
Epoch: 11, Steps: 32 | Train Loss: 7.864 Vali Loss: 66.581 Vali Acc: 0.489 Test Loss: 66.581 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 51.43917751312256
Epoch: 12, Steps: 32 | Train Loss: 6.073 Vali Loss: 58.415 Vali Acc: 0.435 Test Loss: 58.415 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 51.3735466003418
Epoch: 13, Steps: 32 | Train Loss: 3.487 Vali Loss: 68.059 Vali Acc: 0.557 Test Loss: 68.059 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 51.381351470947266
Epoch: 14, Steps: 32 | Train Loss: 1.729 Vali Loss: 94.888 Vali Acc: 0.412 Test Loss: 94.888 Test Acc: 0.412
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 51.65982007980347
Epoch: 15, Steps: 32 | Train Loss: 2.084 Vali Loss: 111.967 Vali Acc: 0.267 Test Loss: 111.967 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 51.49562215805054
Epoch: 16, Steps: 32 | Train Loss: 4.584 Vali Loss: 67.432 Vali Acc: 0.603 Test Loss: 67.432 Test Acc: 0.603
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 50.84768509864807
Epoch: 17, Steps: 32 | Train Loss: 4.379 Vali Loss: 98.738 Vali Acc: 0.557 Test Loss: 98.738 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 51.12944436073303
Epoch: 18, Steps: 32 | Train Loss: 3.909 Vali Loss: 110.472 Vali Acc: 0.496 Test Loss: 110.472 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6335877862595419
model parameter : 8510469
model size : 36.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 82.33800864219666
Epoch: 1, Steps: 32 | Train Loss: 6.334 Vali Loss: 12.040 Vali Acc: 0.176 Test Loss: 12.040 Test Acc: 0.176
Validation loss decreased (inf --> -0.175452).  Saving model ...
Epoch: 2 cost time: 81.51982474327087
Epoch: 2, Steps: 32 | Train Loss: 4.095 Vali Loss: 8.237 Vali Acc: 0.573 Test Loss: 8.237 Test Acc: 0.573
Validation loss decreased (-0.175452 --> -0.572437).  Saving model ...
Epoch: 3 cost time: 81.3594982624054
Epoch: 3, Steps: 32 | Train Loss: 4.108 Vali Loss: 14.415 Vali Acc: 0.534 Test Loss: 14.415 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 82.10881209373474
Epoch: 4, Steps: 32 | Train Loss: 5.827 Vali Loss: 21.196 Vali Acc: 0.489 Test Loss: 21.196 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 81.86575222015381
Epoch: 5, Steps: 32 | Train Loss: 3.876 Vali Loss: 39.883 Vali Acc: 0.481 Test Loss: 39.883 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 82.15466213226318
Epoch: 6, Steps: 32 | Train Loss: 5.247 Vali Loss: 43.257 Vali Acc: 0.519 Test Loss: 43.257 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 81.32998657226562
Epoch: 7, Steps: 32 | Train Loss: 3.677 Vali Loss: 40.068 Vali Acc: 0.328 Test Loss: 40.068 Test Acc: 0.328
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 81.00637292861938
Epoch: 8, Steps: 32 | Train Loss: 4.258 Vali Loss: 41.650 Vali Acc: 0.504 Test Loss: 41.650 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 81.52338981628418
Epoch: 9, Steps: 32 | Train Loss: 5.145 Vali Loss: 56.644 Vali Acc: 0.244 Test Loss: 56.644 Test Acc: 0.244
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 80.98493766784668
Epoch: 10, Steps: 32 | Train Loss: 2.467 Vali Loss: 75.694 Vali Acc: 0.328 Test Loss: 75.694 Test Acc: 0.328
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 80.48378872871399
Epoch: 11, Steps: 32 | Train Loss: 7.752 Vali Loss: 91.725 Vali Acc: 0.282 Test Loss: 91.725 Test Acc: 0.282
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 81.12576127052307
Epoch: 12, Steps: 32 | Train Loss: 6.365 Vali Loss: 77.513 Vali Acc: 0.450 Test Loss: 77.513 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 15130373
model size : 62.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 37.92635703086853
Epoch: 1, Steps: 32 | Train Loss: 6.863 Vali Loss: 8.615 Vali Acc: 0.481 Test Loss: 8.615 Test Acc: 0.481
Validation loss decreased (inf --> -0.480830).  Saving model ...
Epoch: 2 cost time: 37.77114176750183
Epoch: 2, Steps: 32 | Train Loss: 6.891 Vali Loss: 13.213 Vali Acc: 0.481 Test Loss: 13.213 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 37.52598595619202
Epoch: 3, Steps: 32 | Train Loss: 4.117 Vali Loss: 22.972 Vali Acc: 0.275 Test Loss: 22.972 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 37.74624490737915
Epoch: 4, Steps: 32 | Train Loss: 4.513 Vali Loss: 17.032 Vali Acc: 0.427 Test Loss: 17.032 Test Acc: 0.427
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 37.415820598602295
Epoch: 5, Steps: 32 | Train Loss: 4.565 Vali Loss: 33.298 Vali Acc: 0.328 Test Loss: 33.298 Test Acc: 0.328
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 37.446216106414795
Epoch: 6, Steps: 32 | Train Loss: 5.524 Vali Loss: 39.573 Vali Acc: 0.473 Test Loss: 39.573 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 37.45566463470459
Epoch: 7, Steps: 32 | Train Loss: 2.616 Vali Loss: 30.263 Vali Acc: 0.534 Test Loss: 30.263 Test Acc: 0.534
Validation loss decreased (-0.480830 --> -0.534049).  Saving model ...
Epoch: 8 cost time: 37.24692106246948
Epoch: 8, Steps: 32 | Train Loss: 1.612 Vali Loss: 44.045 Vali Acc: 0.473 Test Loss: 44.045 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 37.75371074676514
Epoch: 9, Steps: 32 | Train Loss: 2.481 Vali Loss: 52.944 Vali Acc: 0.527 Test Loss: 52.944 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 37.62410545349121
Epoch: 10, Steps: 32 | Train Loss: 3.679 Vali Loss: 64.765 Vali Acc: 0.328 Test Loss: 64.765 Test Acc: 0.328
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 37.35309600830078
Epoch: 11, Steps: 32 | Train Loss: 7.947 Vali Loss: 102.287 Vali Acc: 0.267 Test Loss: 102.287 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 37.50434494018555
Epoch: 12, Steps: 32 | Train Loss: 3.546 Vali Loss: 49.309 Vali Acc: 0.366 Test Loss: 49.309 Test Acc: 0.366
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 37.263569593429565
Epoch: 13, Steps: 32 | Train Loss: 9.291 Vali Loss: 74.230 Vali Acc: 0.481 Test Loss: 74.230 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 37.224579095840454
Epoch: 14, Steps: 32 | Train Loss: 9.499 Vali Loss: 132.492 Vali Acc: 0.282 Test Loss: 132.492 Test Acc: 0.282
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 37.46040201187134
Epoch: 15, Steps: 32 | Train Loss: 8.570 Vali Loss: 116.251 Vali Acc: 0.534 Test Loss: 116.251 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 37.619378089904785
Epoch: 16, Steps: 32 | Train Loss: 3.357 Vali Loss: 82.427 Vali Acc: 0.473 Test Loss: 82.427 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 37.228633642196655
Epoch: 17, Steps: 32 | Train Loss: 1.676 Vali Loss: 129.724 Vali Acc: 0.580 Test Loss: 129.724 Test Acc: 0.580
Validation loss decreased (-0.534049 --> -0.578855).  Saving model ...
Epoch: 18 cost time: 37.66338396072388
Epoch: 18, Steps: 32 | Train Loss: 4.125 Vali Loss: 67.049 Vali Acc: 0.489 Test Loss: 67.049 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 37.196104526519775
Epoch: 19, Steps: 32 | Train Loss: 1.763 Vali Loss: 99.932 Vali Acc: 0.374 Test Loss: 99.932 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 37.03701877593994
Epoch: 20, Steps: 32 | Train Loss: 0.690 Vali Loss: 108.456 Vali Acc: 0.366 Test Loss: 108.456 Test Acc: 0.366
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 37.11039400100708
Epoch: 21, Steps: 32 | Train Loss: 0.208 Vali Loss: 109.319 Vali Acc: 0.389 Test Loss: 109.319 Test Acc: 0.389
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 37.71409773826599
Epoch: 22, Steps: 32 | Train Loss: 2.489 Vali Loss: 150.245 Vali Acc: 0.527 Test Loss: 150.245 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 37.63041138648987
Epoch: 23, Steps: 32 | Train Loss: 2.429 Vali Loss: 128.119 Vali Acc: 0.466 Test Loss: 128.119 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 37.35359311103821
Epoch: 24, Steps: 32 | Train Loss: 0.979 Vali Loss: 140.844 Vali Acc: 0.481 Test Loss: 140.844 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 37.12557029724121
Epoch: 25, Steps: 32 | Train Loss: 0.337 Vali Loss: 150.037 Vali Acc: 0.496 Test Loss: 150.037 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 37.67702102661133
Epoch: 26, Steps: 32 | Train Loss: 4.006 Vali Loss: 163.627 Vali Acc: 0.290 Test Loss: 163.627 Test Acc: 0.290
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 37.34151339530945
Epoch: 27, Steps: 32 | Train Loss: 2.365 Vali Loss: 123.515 Vali Acc: 0.374 Test Loss: 123.515 Test Acc: 0.374
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 8510469
model size : 36.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 52.00482225418091
Epoch: 1, Steps: 32 | Train Loss: 6.394 Vali Loss: 10.283 Vali Acc: 0.176 Test Loss: 10.283 Test Acc: 0.176
Validation loss decreased (inf --> -0.175470).  Saving model ...
Epoch: 2 cost time: 51.31802749633789
Epoch: 2, Steps: 32 | Train Loss: 4.598 Vali Loss: 13.098 Vali Acc: 0.443 Test Loss: 13.098 Test Acc: 0.443
Validation loss decreased (-0.175470 --> -0.442617).  Saving model ...
Epoch: 3 cost time: 51.12268137931824
Epoch: 3, Steps: 32 | Train Loss: 5.525 Vali Loss: 27.971 Vali Acc: 0.191 Test Loss: 27.971 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 51.01127243041992
Epoch: 4, Steps: 32 | Train Loss: 3.743 Vali Loss: 29.507 Vali Acc: 0.244 Test Loss: 29.507 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 50.89612936973572
Epoch: 5, Steps: 32 | Train Loss: 1.936 Vali Loss: 20.391 Vali Acc: 0.550 Test Loss: 20.391 Test Acc: 0.550
Validation loss decreased (-0.442617 --> -0.549414).  Saving model ...
Epoch: 6 cost time: 50.830281019210815
Epoch: 6, Steps: 32 | Train Loss: 5.991 Vali Loss: 46.054 Vali Acc: 0.519 Test Loss: 46.054 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 50.49852514266968
Epoch: 7, Steps: 32 | Train Loss: 4.165 Vali Loss: 60.727 Vali Acc: 0.244 Test Loss: 60.727 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 50.81663537025452
Epoch: 8, Steps: 32 | Train Loss: 5.239 Vali Loss: 53.064 Vali Acc: 0.565 Test Loss: 53.064 Test Acc: 0.565
Validation loss decreased (-0.549414 --> -0.564355).  Saving model ...
Epoch: 9 cost time: 50.63648223876953
Epoch: 9, Steps: 32 | Train Loss: 4.390 Vali Loss: 66.229 Vali Acc: 0.496 Test Loss: 66.229 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 50.54863452911377
Epoch: 10, Steps: 32 | Train Loss: 7.650 Vali Loss: 71.277 Vali Acc: 0.344 Test Loss: 71.277 Test Acc: 0.344
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 50.61532258987427
Epoch: 11, Steps: 32 | Train Loss: 3.424 Vali Loss: 84.000 Vali Acc: 0.206 Test Loss: 84.000 Test Acc: 0.206
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 50.44849896430969
Epoch: 12, Steps: 32 | Train Loss: 2.146 Vali Loss: 68.893 Vali Acc: 0.374 Test Loss: 68.893 Test Acc: 0.374
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 50.37400555610657
Epoch: 13, Steps: 32 | Train Loss: 5.411 Vali Loss: 52.714 Vali Acc: 0.466 Test Loss: 52.714 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 49.73297619819641
Epoch: 14, Steps: 32 | Train Loss: 2.410 Vali Loss: 81.410 Vali Acc: 0.443 Test Loss: 81.410 Test Acc: 0.443
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 50.611119747161865
Epoch: 15, Steps: 32 | Train Loss: 1.687 Vali Loss: 75.774 Vali Acc: 0.534 Test Loss: 75.774 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 50.61531686782837
Epoch: 16, Steps: 32 | Train Loss: 0.294 Vali Loss: 122.148 Vali Acc: 0.397 Test Loss: 122.148 Test Acc: 0.397
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 50.59653663635254
Epoch: 17, Steps: 32 | Train Loss: 0.807 Vali Loss: 124.816 Vali Acc: 0.351 Test Loss: 124.816 Test Acc: 0.351
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 50.33612680435181
Epoch: 18, Steps: 32 | Train Loss: 2.816 Vali Loss: 77.663 Vali Acc: 0.489 Test Loss: 77.663 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 15130373
model size : 62.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 26.178454160690308
Epoch: 1, Steps: 32 | Train Loss: 6.891 Vali Loss: 8.155 Vali Acc: 0.489 Test Loss: 8.155 Test Acc: 0.489
Validation loss decreased (inf --> -0.488468).  Saving model ...
Epoch: 2 cost time: 25.769697666168213
Epoch: 2, Steps: 32 | Train Loss: 5.317 Vali Loss: 20.801 Vali Acc: 0.260 Test Loss: 20.801 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 25.73783540725708
Epoch: 3, Steps: 32 | Train Loss: 7.780 Vali Loss: 30.115 Vali Acc: 0.351 Test Loss: 30.115 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 25.5568208694458
Epoch: 4, Steps: 32 | Train Loss: 3.809 Vali Loss: 36.897 Vali Acc: 0.382 Test Loss: 36.897 Test Acc: 0.382
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 25.309990644454956
Epoch: 5, Steps: 32 | Train Loss: 4.497 Vali Loss: 35.910 Vali Acc: 0.481 Test Loss: 35.910 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 25.518662929534912
Epoch: 6, Steps: 32 | Train Loss: 3.887 Vali Loss: 46.414 Vali Acc: 0.534 Test Loss: 46.414 Test Acc: 0.534
Validation loss decreased (-0.488468 --> -0.533887).  Saving model ...
Epoch: 7 cost time: 25.630685329437256
Epoch: 7, Steps: 32 | Train Loss: 4.490 Vali Loss: 34.994 Vali Acc: 0.420 Test Loss: 34.994 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 25.556061267852783
Epoch: 8, Steps: 32 | Train Loss: 3.156 Vali Loss: 63.730 Vali Acc: 0.542 Test Loss: 63.730 Test Acc: 0.542
Validation loss decreased (-0.533887 --> -0.541347).  Saving model ...
Epoch: 9 cost time: 25.499265670776367
Epoch: 9, Steps: 32 | Train Loss: 4.154 Vali Loss: 52.765 Vali Acc: 0.290 Test Loss: 52.765 Test Acc: 0.290
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 25.602062463760376
Epoch: 10, Steps: 32 | Train Loss: 3.440 Vali Loss: 47.596 Vali Acc: 0.435 Test Loss: 47.596 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 25.487661600112915
Epoch: 11, Steps: 32 | Train Loss: 0.679 Vali Loss: 44.495 Vali Acc: 0.573 Test Loss: 44.495 Test Acc: 0.573
Validation loss decreased (-0.541347 --> -0.572074).  Saving model ...
Epoch: 12 cost time: 25.5464448928833
Epoch: 12, Steps: 32 | Train Loss: 1.836 Vali Loss: 41.127 Vali Acc: 0.557 Test Loss: 41.127 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 25.56988787651062
Epoch: 13, Steps: 32 | Train Loss: 1.196 Vali Loss: 38.636 Vali Acc: 0.542 Test Loss: 38.636 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 25.592153549194336
Epoch: 14, Steps: 32 | Train Loss: 0.277 Vali Loss: 74.095 Vali Acc: 0.435 Test Loss: 74.095 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 25.44105100631714
Epoch: 15, Steps: 32 | Train Loss: 0.558 Vali Loss: 113.808 Vali Acc: 0.542 Test Loss: 113.808 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 25.412278175354004
Epoch: 16, Steps: 32 | Train Loss: 7.380 Vali Loss: 131.234 Vali Acc: 0.198 Test Loss: 131.234 Test Acc: 0.198
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 25.49944567680359
Epoch: 17, Steps: 32 | Train Loss: 5.016 Vali Loss: 102.000 Vali Acc: 0.275 Test Loss: 102.000 Test Acc: 0.275
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 25.635347604751587
Epoch: 18, Steps: 32 | Train Loss: 0.603 Vali Loss: 83.318 Vali Acc: 0.405 Test Loss: 83.318 Test Acc: 0.405
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 25.26823854446411
Epoch: 19, Steps: 32 | Train Loss: 3.266 Vali Loss: 106.132 Vali Acc: 0.244 Test Loss: 106.132 Test Acc: 0.244
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 25.588674068450928
Epoch: 20, Steps: 32 | Train Loss: 2.459 Vali Loss: 114.402 Vali Acc: 0.328 Test Loss: 114.402 Test Acc: 0.328
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 25.3377685546875
Epoch: 21, Steps: 32 | Train Loss: 0.290 Vali Loss: 124.722 Vali Acc: 0.542 Test Loss: 124.722 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 8510469
model size : 36.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 72.6514413356781
Epoch: 1, Steps: 32 | Train Loss: 4.781 Vali Loss: 12.813 Vali Acc: 0.198 Test Loss: 12.813 Test Acc: 0.198
Validation loss decreased (inf --> -0.198345).  Saving model ...
Epoch: 2 cost time: 71.7760238647461
Epoch: 2, Steps: 32 | Train Loss: 4.651 Vali Loss: 25.880 Vali Acc: 0.244 Test Loss: 25.880 Test Acc: 0.244
Validation loss decreased (-0.198345 --> -0.244016).  Saving model ...
Epoch: 3 cost time: 71.7059633731842
Epoch: 3, Steps: 32 | Train Loss: 4.943 Vali Loss: 15.173 Vali Acc: 0.397 Test Loss: 15.173 Test Acc: 0.397
Validation loss decreased (-0.244016 --> -0.396795).  Saving model ...
Epoch: 4 cost time: 71.93611335754395
Epoch: 4, Steps: 32 | Train Loss: 2.302 Vali Loss: 25.580 Vali Acc: 0.344 Test Loss: 25.580 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 71.57142305374146
Epoch: 5, Steps: 32 | Train Loss: 3.901 Vali Loss: 26.295 Vali Acc: 0.321 Test Loss: 26.295 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 72.6814079284668
Epoch: 6, Steps: 32 | Train Loss: 7.207 Vali Loss: 56.002 Vali Acc: 0.298 Test Loss: 56.002 Test Acc: 0.298
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 71.12830901145935
Epoch: 7, Steps: 32 | Train Loss: 8.155 Vali Loss: 42.789 Vali Acc: 0.405 Test Loss: 42.789 Test Acc: 0.405
Validation loss decreased (-0.396795 --> -0.404152).  Saving model ...
Epoch: 8 cost time: 71.04161977767944
Epoch: 8, Steps: 32 | Train Loss: 3.091 Vali Loss: 53.041 Vali Acc: 0.290 Test Loss: 53.041 Test Acc: 0.290
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 70.33477783203125
Epoch: 9, Steps: 32 | Train Loss: 0.380 Vali Loss: 38.071 Vali Acc: 0.473 Test Loss: 38.071 Test Acc: 0.473
Validation loss decreased (-0.404152 --> -0.472902).  Saving model ...
Epoch: 10 cost time: 71.26574325561523
Epoch: 10, Steps: 32 | Train Loss: 2.039 Vali Loss: 49.164 Vali Acc: 0.542 Test Loss: 49.164 Test Acc: 0.542
Validation loss decreased (-0.472902 --> -0.541493).  Saving model ...
Epoch: 11 cost time: 71.5196373462677
Epoch: 11, Steps: 32 | Train Loss: 1.605 Vali Loss: 54.178 Vali Acc: 0.573 Test Loss: 54.178 Test Acc: 0.573
Validation loss decreased (-0.541493 --> -0.571977).  Saving model ...
Epoch: 12 cost time: 70.90276193618774
Epoch: 12, Steps: 32 | Train Loss: 2.038 Vali Loss: 48.547 Vali Acc: 0.557 Test Loss: 48.547 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 70.5947253704071
Epoch: 13, Steps: 32 | Train Loss: 2.569 Vali Loss: 83.975 Vali Acc: 0.328 Test Loss: 83.975 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 71.34902954101562
Epoch: 14, Steps: 32 | Train Loss: 1.594 Vali Loss: 41.884 Vali Acc: 0.550 Test Loss: 41.884 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 70.9804790019989
Epoch: 15, Steps: 32 | Train Loss: 0.386 Vali Loss: 83.388 Vali Acc: 0.397 Test Loss: 83.388 Test Acc: 0.397
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 71.05254912376404
Epoch: 16, Steps: 32 | Train Loss: 6.027 Vali Loss: 82.311 Vali Acc: 0.328 Test Loss: 82.311 Test Acc: 0.328
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 70.55497336387634
Epoch: 17, Steps: 32 | Train Loss: 4.757 Vali Loss: 66.484 Vali Acc: 0.466 Test Loss: 66.484 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 70.17383670806885
Epoch: 18, Steps: 32 | Train Loss: 6.625 Vali Loss: 57.860 Vali Acc: 0.481 Test Loss: 57.860 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 70.92710781097412
Epoch: 19, Steps: 32 | Train Loss: 13.004 Vali Loss: 104.904 Vali Acc: 0.588 Test Loss: 104.904 Test Acc: 0.588
Validation loss decreased (-0.571977 --> -0.586737).  Saving model ...
Epoch: 20 cost time: 71.3084545135498
Epoch: 20, Steps: 32 | Train Loss: 8.739 Vali Loss: 131.934 Vali Acc: 0.542 Test Loss: 131.934 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 71.53284406661987
Epoch: 21, Steps: 32 | Train Loss: 5.291 Vali Loss: 103.284 Vali Acc: 0.542 Test Loss: 103.284 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 70.70909667015076
Epoch: 22, Steps: 32 | Train Loss: 3.463 Vali Loss: 175.556 Vali Acc: 0.267 Test Loss: 175.556 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 71.80757427215576
Epoch: 23, Steps: 32 | Train Loss: 1.012 Vali Loss: 104.979 Vali Acc: 0.527 Test Loss: 104.979 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 71.0324182510376
Epoch: 24, Steps: 32 | Train Loss: 0.201 Vali Loss: 103.670 Vali Acc: 0.504 Test Loss: 103.670 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 70.77015852928162
Epoch: 25, Steps: 32 | Train Loss: 0.000 Vali Loss: 110.761 Vali Acc: 0.481 Test Loss: 110.761 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 71.24286580085754
Epoch: 26, Steps: 32 | Train Loss: 0.000 Vali Loss: 111.103 Vali Acc: 0.473 Test Loss: 111.103 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 71.0294816493988
Epoch: 27, Steps: 32 | Train Loss: 0.000 Vali Loss: 111.115 Vali Acc: 0.473 Test Loss: 111.115 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 71.08971381187439
Epoch: 28, Steps: 32 | Train Loss: 0.000 Vali Loss: 111.116 Vali Acc: 0.473 Test Loss: 111.116 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 71.01492977142334
Epoch: 29, Steps: 32 | Train Loss: 0.000 Vali Loss: 111.116 Vali Acc: 0.473 Test Loss: 111.116 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 10443781
model size : 44.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 34.740498304367065
Epoch: 1, Steps: 32 | Train Loss: 7.165 Vali Loss: 8.851 Vali Acc: 0.221 Test Loss: 8.851 Test Acc: 0.221
Validation loss decreased (inf --> -0.221286).  Saving model ...
Epoch: 2 cost time: 34.0929639339447
Epoch: 2, Steps: 32 | Train Loss: 4.990 Vali Loss: 7.496 Vali Acc: 0.458 Test Loss: 7.496 Test Acc: 0.458
Validation loss decreased (-0.221286 --> -0.457940).  Saving model ...
Epoch: 3 cost time: 34.227558612823486
Epoch: 3, Steps: 32 | Train Loss: 3.750 Vali Loss: 22.501 Vali Acc: 0.290 Test Loss: 22.501 Test Acc: 0.290
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 33.84633922576904
Epoch: 4, Steps: 32 | Train Loss: 3.324 Vali Loss: 23.531 Vali Acc: 0.321 Test Loss: 23.531 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 34.16497087478638
Epoch: 5, Steps: 32 | Train Loss: 5.279 Vali Loss: 18.229 Vali Acc: 0.527 Test Loss: 18.229 Test Acc: 0.527
Validation loss decreased (-0.457940 --> -0.526535).  Saving model ...
Epoch: 6 cost time: 34.34119915962219
Epoch: 6, Steps: 32 | Train Loss: 3.893 Vali Loss: 17.922 Vali Acc: 0.519 Test Loss: 17.922 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 34.49244046211243
Epoch: 7, Steps: 32 | Train Loss: 1.310 Vali Loss: 40.659 Vali Acc: 0.366 Test Loss: 40.659 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 34.07434868812561
Epoch: 8, Steps: 32 | Train Loss: 5.344 Vali Loss: 36.780 Vali Acc: 0.336 Test Loss: 36.780 Test Acc: 0.336
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 33.78190064430237
Epoch: 9, Steps: 32 | Train Loss: 1.097 Vali Loss: 35.811 Vali Acc: 0.527 Test Loss: 35.811 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 33.88951921463013
Epoch: 10, Steps: 32 | Train Loss: 0.618 Vali Loss: 43.420 Vali Acc: 0.427 Test Loss: 43.420 Test Acc: 0.427
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 33.71954846382141
Epoch: 11, Steps: 32 | Train Loss: 0.866 Vali Loss: 44.077 Vali Acc: 0.366 Test Loss: 44.077 Test Acc: 0.366
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 33.51632070541382
Epoch: 12, Steps: 32 | Train Loss: 0.361 Vali Loss: 44.335 Vali Acc: 0.534 Test Loss: 44.335 Test Acc: 0.534
Validation loss decreased (-0.526535 --> -0.533908).  Saving model ...
Epoch: 13 cost time: 33.94259762763977
Epoch: 13, Steps: 32 | Train Loss: 3.823 Vali Loss: 57.422 Vali Acc: 0.542 Test Loss: 57.422 Test Acc: 0.542
Validation loss decreased (-0.533908 --> -0.541411).  Saving model ...
Epoch: 14 cost time: 33.97197675704956
Epoch: 14, Steps: 32 | Train Loss: 1.132 Vali Loss: 41.411 Vali Acc: 0.534 Test Loss: 41.411 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 33.3239266872406
Epoch: 15, Steps: 32 | Train Loss: 2.370 Vali Loss: 75.744 Vali Acc: 0.359 Test Loss: 75.744 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 34.036683082580566
Epoch: 16, Steps: 32 | Train Loss: 7.067 Vali Loss: 120.250 Vali Acc: 0.336 Test Loss: 120.250 Test Acc: 0.336
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 33.63324952125549
Epoch: 17, Steps: 32 | Train Loss: 6.145 Vali Loss: 74.885 Vali Acc: 0.542 Test Loss: 74.885 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 34.06827926635742
Epoch: 18, Steps: 32 | Train Loss: 4.971 Vali Loss: 172.653 Vali Acc: 0.534 Test Loss: 172.653 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 33.71270298957825
Epoch: 19, Steps: 32 | Train Loss: 19.830 Vali Loss: 89.143 Vali Acc: 0.450 Test Loss: 89.143 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 33.10324478149414
Epoch: 20, Steps: 32 | Train Loss: 5.234 Vali Loss: 89.599 Vali Acc: 0.443 Test Loss: 89.599 Test Acc: 0.443
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 34.05267810821533
Epoch: 21, Steps: 32 | Train Loss: 2.486 Vali Loss: 127.399 Vali Acc: 0.290 Test Loss: 127.399 Test Acc: 0.290
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 33.89455533027649
Epoch: 22, Steps: 32 | Train Loss: 4.940 Vali Loss: 98.680 Vali Acc: 0.435 Test Loss: 98.680 Test Acc: 0.435
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 34.078486919403076
Epoch: 23, Steps: 32 | Train Loss: 10.305 Vali Loss: 150.564 Vali Acc: 0.267 Test Loss: 150.564 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 7133701
model size : 31.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 49.13248252868652
Epoch: 1, Steps: 32 | Train Loss: 4.787 Vali Loss: 12.273 Vali Acc: 0.198 Test Loss: 12.273 Test Acc: 0.198
Validation loss decreased (inf --> -0.198351).  Saving model ...
Epoch: 2 cost time: 48.154550552368164
Epoch: 2, Steps: 32 | Train Loss: 6.711 Vali Loss: 29.473 Vali Acc: 0.244 Test Loss: 29.473 Test Acc: 0.244
Validation loss decreased (-0.198351 --> -0.243980).  Saving model ...
Epoch: 3 cost time: 48.39143252372742
Epoch: 3, Steps: 32 | Train Loss: 8.214 Vali Loss: 15.799 Vali Acc: 0.351 Test Loss: 15.799 Test Acc: 0.351
Validation loss decreased (-0.243980 --> -0.350987).  Saving model ...
Epoch: 4 cost time: 48.52993297576904
Epoch: 4, Steps: 32 | Train Loss: 4.285 Vali Loss: 25.746 Vali Acc: 0.603 Test Loss: 25.746 Test Acc: 0.603
Validation loss decreased (-0.350987 --> -0.602796).  Saving model ...
Epoch: 5 cost time: 48.099048137664795
Epoch: 5, Steps: 32 | Train Loss: 8.939 Vali Loss: 57.764 Vali Acc: 0.183 Test Loss: 57.764 Test Acc: 0.183
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 48.237913608551025
Epoch: 6, Steps: 32 | Train Loss: 3.617 Vali Loss: 48.892 Vali Acc: 0.405 Test Loss: 48.892 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 48.22371816635132
Epoch: 7, Steps: 32 | Train Loss: 6.612 Vali Loss: 35.204 Vali Acc: 0.405 Test Loss: 35.204 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 48.41964673995972
Epoch: 8, Steps: 32 | Train Loss: 1.379 Vali Loss: 48.641 Vali Acc: 0.366 Test Loss: 48.641 Test Acc: 0.366
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 48.49223470687866
Epoch: 9, Steps: 32 | Train Loss: 1.255 Vali Loss: 39.073 Vali Acc: 0.427 Test Loss: 39.073 Test Acc: 0.427
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 48.582993507385254
Epoch: 10, Steps: 32 | Train Loss: 3.891 Vali Loss: 59.213 Vali Acc: 0.565 Test Loss: 59.213 Test Acc: 0.565
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 48.40871810913086
Epoch: 11, Steps: 32 | Train Loss: 2.880 Vali Loss: 60.547 Vali Acc: 0.542 Test Loss: 60.547 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 48.686732053756714
Epoch: 12, Steps: 32 | Train Loss: 0.000 Vali Loss: 45.238 Vali Acc: 0.603 Test Loss: 45.238 Test Acc: 0.603
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 48.38262605667114
Epoch: 13, Steps: 32 | Train Loss: 1.283 Vali Loss: 84.604 Vali Acc: 0.542 Test Loss: 84.604 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 48.31176161766052
Epoch: 14, Steps: 32 | Train Loss: 6.985 Vali Loss: 63.205 Vali Acc: 0.550 Test Loss: 63.205 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6030534351145038
model parameter : 10443781
model size : 44.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 24.621355772018433
Epoch: 1, Steps: 32 | Train Loss: 7.331 Vali Loss: 6.101 Vali Acc: 0.305 Test Loss: 6.101 Test Acc: 0.305
Validation loss decreased (inf --> -0.305283).  Saving model ...
Epoch: 2 cost time: 24.08773183822632
Epoch: 2, Steps: 32 | Train Loss: 4.622 Vali Loss: 6.882 Vali Acc: 0.489 Test Loss: 6.882 Test Acc: 0.489
Validation loss decreased (-0.305283 --> -0.488481).  Saving model ...
Epoch: 3 cost time: 24.145453214645386
Epoch: 3, Steps: 32 | Train Loss: 3.540 Vali Loss: 10.212 Vali Acc: 0.557 Test Loss: 10.212 Test Acc: 0.557
Validation loss decreased (-0.488481 --> -0.557150).  Saving model ...
Epoch: 4 cost time: 23.74587345123291
Epoch: 4, Steps: 32 | Train Loss: 6.039 Vali Loss: 23.919 Vali Acc: 0.374 Test Loss: 23.919 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 24.10281729698181
Epoch: 5, Steps: 32 | Train Loss: 5.229 Vali Loss: 34.565 Vali Acc: 0.336 Test Loss: 34.565 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 24.167476415634155
Epoch: 6, Steps: 32 | Train Loss: 1.616 Vali Loss: 41.444 Vali Acc: 0.573 Test Loss: 41.444 Test Acc: 0.573
Validation loss decreased (-0.557150 --> -0.572105).  Saving model ...
Epoch: 7 cost time: 23.980763912200928
Epoch: 7, Steps: 32 | Train Loss: 12.334 Vali Loss: 34.141 Vali Acc: 0.412 Test Loss: 34.141 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 24.275715589523315
Epoch: 8, Steps: 32 | Train Loss: 4.570 Vali Loss: 42.034 Vali Acc: 0.366 Test Loss: 42.034 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 24.16699981689453
Epoch: 9, Steps: 32 | Train Loss: 2.940 Vali Loss: 41.383 Vali Acc: 0.359 Test Loss: 41.383 Test Acc: 0.359
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 23.98650312423706
Epoch: 10, Steps: 32 | Train Loss: 1.610 Vali Loss: 55.525 Vali Acc: 0.550 Test Loss: 55.525 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 23.72748041152954
Epoch: 11, Steps: 32 | Train Loss: 1.445 Vali Loss: 46.399 Vali Acc: 0.473 Test Loss: 46.399 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 24.079183340072632
Epoch: 12, Steps: 32 | Train Loss: 1.781 Vali Loss: 74.197 Vali Acc: 0.420 Test Loss: 74.197 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 23.76029872894287
Epoch: 13, Steps: 32 | Train Loss: 7.145 Vali Loss: 57.224 Vali Acc: 0.443 Test Loss: 57.224 Test Acc: 0.443
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 24.11489725112915
Epoch: 14, Steps: 32 | Train Loss: 5.896 Vali Loss: 101.995 Vali Acc: 0.313 Test Loss: 101.995 Test Acc: 0.313
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 24.1004376411438
Epoch: 15, Steps: 32 | Train Loss: 3.574 Vali Loss: 103.630 Vali Acc: 0.290 Test Loss: 103.630 Test Acc: 0.290
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 24.09929847717285
Epoch: 16, Steps: 32 | Train Loss: 0.828 Vali Loss: 108.707 Vali Acc: 0.550 Test Loss: 108.707 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 7133701
model size : 31.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 30.852514266967773
Epoch: 1, Steps: 32 | Train Loss: 4.788 Vali Loss: 12.510 Vali Acc: 0.198 Test Loss: 12.510 Test Acc: 0.198
Validation loss decreased (inf --> -0.198348).  Saving model ...
Epoch: 2 cost time: 30.49504804611206
Epoch: 2, Steps: 32 | Train Loss: 7.462 Vali Loss: 19.101 Vali Acc: 0.321 Test Loss: 19.101 Test Acc: 0.321
Validation loss decreased (-0.198348 --> -0.320420).  Saving model ...
Epoch: 3 cost time: 30.249544382095337
Epoch: 3, Steps: 32 | Train Loss: 7.965 Vali Loss: 8.930 Vali Acc: 0.557 Test Loss: 8.930 Test Acc: 0.557
Validation loss decreased (-0.320420 --> -0.557163).  Saving model ...
Epoch: 4 cost time: 30.128538370132446
Epoch: 4, Steps: 32 | Train Loss: 4.381 Vali Loss: 19.720 Vali Acc: 0.321 Test Loss: 19.720 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 29.87960910797119
Epoch: 5, Steps: 32 | Train Loss: 4.848 Vali Loss: 24.507 Vali Acc: 0.573 Test Loss: 24.507 Test Acc: 0.573
Validation loss decreased (-0.557163 --> -0.572274).  Saving model ...
Epoch: 6 cost time: 29.959617853164673
Epoch: 6, Steps: 32 | Train Loss: 2.933 Vali Loss: 29.681 Vali Acc: 0.573 Test Loss: 29.681 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 30.228228330612183
Epoch: 7, Steps: 32 | Train Loss: 4.960 Vali Loss: 101.129 Vali Acc: 0.160 Test Loss: 101.129 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 29.96344494819641
Epoch: 8, Steps: 32 | Train Loss: 5.904 Vali Loss: 47.280 Vali Acc: 0.336 Test Loss: 47.280 Test Acc: 0.336
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 29.947798490524292
Epoch: 9, Steps: 32 | Train Loss: 3.290 Vali Loss: 53.471 Vali Acc: 0.550 Test Loss: 53.471 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 29.944604635238647
Epoch: 10, Steps: 32 | Train Loss: 2.236 Vali Loss: 33.465 Vali Acc: 0.550 Test Loss: 33.465 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 29.938987970352173
Epoch: 11, Steps: 32 | Train Loss: 7.112 Vali Loss: 68.058 Vali Acc: 0.290 Test Loss: 68.058 Test Acc: 0.290
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 29.75770878791809
Epoch: 12, Steps: 32 | Train Loss: 3.087 Vali Loss: 68.691 Vali Acc: 0.336 Test Loss: 68.691 Test Acc: 0.336
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 29.8912353515625
Epoch: 13, Steps: 32 | Train Loss: 1.511 Vali Loss: 112.122 Vali Acc: 0.282 Test Loss: 112.122 Test Acc: 0.282
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 29.842400550842285
Epoch: 14, Steps: 32 | Train Loss: 5.098 Vali Loss: 67.017 Vali Acc: 0.595 Test Loss: 67.017 Test Acc: 0.595
Validation loss decreased (-0.572274 --> -0.594750).  Saving model ...
Epoch: 15 cost time: 29.884660005569458
Epoch: 15, Steps: 32 | Train Loss: 1.139 Vali Loss: 37.369 Vali Acc: 0.573 Test Loss: 37.369 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 29.728065967559814
Epoch: 16, Steps: 32 | Train Loss: 3.166 Vali Loss: 58.908 Vali Acc: 0.534 Test Loss: 58.908 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 29.95925736427307
Epoch: 17, Steps: 32 | Train Loss: 1.785 Vali Loss: 98.937 Vali Acc: 0.328 Test Loss: 98.937 Test Acc: 0.328
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 30.16360592842102
Epoch: 18, Steps: 32 | Train Loss: 0.396 Vali Loss: 47.841 Vali Acc: 0.527 Test Loss: 47.841 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 29.895644426345825
Epoch: 19, Steps: 32 | Train Loss: 2.285 Vali Loss: 63.072 Vali Acc: 0.611 Test Loss: 63.072 Test Acc: 0.611
Validation loss decreased (-0.594750 --> -0.610056).  Saving model ...
Epoch: 20 cost time: 29.89461398124695
Epoch: 20, Steps: 32 | Train Loss: 0.251 Vali Loss: 56.631 Vali Acc: 0.573 Test Loss: 56.631 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 29.589940547943115
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 57.037 Vali Acc: 0.557 Test Loss: 57.037 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 29.84252643585205
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 57.058 Vali Acc: 0.557 Test Loss: 57.058 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 29.47867202758789
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 57.059 Vali Acc: 0.557 Test Loss: 57.059 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 29.61593246459961
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 57.059 Vali Acc: 0.557 Test Loss: 57.059 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 29.606360912322998
Epoch: 25, Steps: 32 | Train Loss: 0.000 Vali Loss: 57.059 Vali Acc: 0.557 Test Loss: 57.059 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 29.865554571151733
Epoch: 26, Steps: 32 | Train Loss: 0.000 Vali Loss: 57.059 Vali Acc: 0.557 Test Loss: 57.059 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 29.62071990966797
Epoch: 27, Steps: 32 | Train Loss: 0.000 Vali Loss: 57.059 Vali Acc: 0.557 Test Loss: 57.059 Test Acc: 0.557
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 29.76053786277771
Epoch: 28, Steps: 32 | Train Loss: 0.000 Vali Loss: 57.059 Vali Acc: 0.557 Test Loss: 57.059 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 29.838852167129517
Epoch: 29, Steps: 32 | Train Loss: 0.000 Vali Loss: 57.059 Vali Acc: 0.557 Test Loss: 57.059 Test Acc: 0.557
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6106870229007634
model parameter : 10443781
model size : 44.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 17.268495559692383
Epoch: 1, Steps: 32 | Train Loss: 7.367 Vali Loss: 9.967 Vali Acc: 0.244 Test Loss: 9.967 Test Acc: 0.244
Validation loss decreased (inf --> -0.244175).  Saving model ...
Epoch: 2 cost time: 16.493775367736816
Epoch: 2, Steps: 32 | Train Loss: 5.500 Vali Loss: 8.368 Vali Acc: 0.412 Test Loss: 8.368 Test Acc: 0.412
Validation loss decreased (-0.244175 --> -0.412130).  Saving model ...
Epoch: 3 cost time: 16.355169773101807
Epoch: 3, Steps: 32 | Train Loss: 2.399 Vali Loss: 16.162 Vali Acc: 0.313 Test Loss: 16.162 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 16.32625436782837
Epoch: 4, Steps: 32 | Train Loss: 5.930 Vali Loss: 33.650 Vali Acc: 0.267 Test Loss: 33.650 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 16.34339737892151
Epoch: 5, Steps: 32 | Train Loss: 2.958 Vali Loss: 28.624 Vali Acc: 0.290 Test Loss: 28.624 Test Acc: 0.290
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 16.334476470947266
Epoch: 6, Steps: 32 | Train Loss: 3.099 Vali Loss: 42.931 Vali Acc: 0.267 Test Loss: 42.931 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 16.473860263824463
Epoch: 7, Steps: 32 | Train Loss: 4.760 Vali Loss: 41.350 Vali Acc: 0.374 Test Loss: 41.350 Test Acc: 0.374
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 16.391249656677246
Epoch: 8, Steps: 32 | Train Loss: 5.882 Vali Loss: 43.545 Vali Acc: 0.366 Test Loss: 43.545 Test Acc: 0.366
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 16.313671112060547
Epoch: 9, Steps: 32 | Train Loss: 9.015 Vali Loss: 32.657 Vali Acc: 0.450 Test Loss: 32.657 Test Acc: 0.450
Validation loss decreased (-0.412130 --> -0.450055).  Saving model ...
Epoch: 10 cost time: 16.34803080558777
Epoch: 10, Steps: 32 | Train Loss: 2.351 Vali Loss: 78.274 Vali Acc: 0.321 Test Loss: 78.274 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 16.633305311203003
Epoch: 11, Steps: 32 | Train Loss: 2.844 Vali Loss: 35.874 Vali Acc: 0.557 Test Loss: 35.874 Test Acc: 0.557
Validation loss decreased (-0.450055 --> -0.556893).  Saving model ...
Epoch: 12 cost time: 16.469995498657227
Epoch: 12, Steps: 32 | Train Loss: 1.420 Vali Loss: 62.704 Vali Acc: 0.527 Test Loss: 62.704 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 16.553783893585205
Epoch: 13, Steps: 32 | Train Loss: 1.705 Vali Loss: 85.005 Vali Acc: 0.435 Test Loss: 85.005 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 16.44836115837097
Epoch: 14, Steps: 32 | Train Loss: 3.320 Vali Loss: 59.772 Vali Acc: 0.489 Test Loss: 59.772 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 16.272139072418213
Epoch: 15, Steps: 32 | Train Loss: 2.307 Vali Loss: 53.317 Vali Acc: 0.565 Test Loss: 53.317 Test Acc: 0.565
Validation loss decreased (-0.556893 --> -0.564352).  Saving model ...
Epoch: 16 cost time: 16.319488525390625
Epoch: 16, Steps: 32 | Train Loss: 0.322 Vali Loss: 96.465 Vali Acc: 0.359 Test Loss: 96.465 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 16.509785890579224
Epoch: 17, Steps: 32 | Train Loss: 0.059 Vali Loss: 65.743 Vali Acc: 0.420 Test Loss: 65.743 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 16.561681270599365
Epoch: 18, Steps: 32 | Train Loss: 0.999 Vali Loss: 73.697 Vali Acc: 0.473 Test Loss: 73.697 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 16.354902744293213
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 75.643 Vali Acc: 0.481 Test Loss: 75.643 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 16.548423290252686
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 75.744 Vali Acc: 0.481 Test Loss: 75.744 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 16.63501811027527
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 75.299 Vali Acc: 0.481 Test Loss: 75.299 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 16.38847303390503
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 75.251 Vali Acc: 0.481 Test Loss: 75.251 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 16.465973138809204
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 75.250 Vali Acc: 0.481 Test Loss: 75.250 Test Acc: 0.481
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 16.34647274017334
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 75.250 Vali Acc: 0.481 Test Loss: 75.250 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 16.477850437164307
Epoch: 25, Steps: 32 | Train Loss: 0.000 Vali Loss: 75.250 Vali Acc: 0.481 Test Loss: 75.250 Test Acc: 0.481
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 7133701
model size : 31.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 73.86633849143982
Epoch: 1, Steps: 32 | Train Loss: 2.999 Vali Loss: 4.361 Vali Acc: 0.260 Test Loss: 4.361 Test Acc: 0.260
Validation loss decreased (inf --> -0.259498).  Saving model ...
Epoch: 2 cost time: 74.04749965667725
Epoch: 2, Steps: 32 | Train Loss: 4.044 Vali Loss: 6.136 Vali Acc: 0.344 Test Loss: 6.136 Test Acc: 0.344
Validation loss decreased (-0.259498 --> -0.343450).  Saving model ...
Epoch: 3 cost time: 72.58947277069092
Epoch: 3, Steps: 32 | Train Loss: 1.471 Vali Loss: 14.050 Vali Acc: 0.282 Test Loss: 14.050 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 72.7293746471405
Epoch: 4, Steps: 32 | Train Loss: 2.646 Vali Loss: 10.719 Vali Acc: 0.473 Test Loss: 10.719 Test Acc: 0.473
Validation loss decreased (-0.343450 --> -0.473175).  Saving model ...
Epoch: 5 cost time: 73.59642577171326
Epoch: 5, Steps: 32 | Train Loss: 1.835 Vali Loss: 14.100 Vali Acc: 0.466 Test Loss: 14.100 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 73.42845034599304
Epoch: 6, Steps: 32 | Train Loss: 1.346 Vali Loss: 16.697 Vali Acc: 0.473 Test Loss: 16.697 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 72.6368339061737
Epoch: 7, Steps: 32 | Train Loss: 0.918 Vali Loss: 26.676 Vali Acc: 0.519 Test Loss: 26.676 Test Acc: 0.519
Validation loss decreased (-0.473175 --> -0.518817).  Saving model ...
Epoch: 8 cost time: 72.97893285751343
Epoch: 8, Steps: 32 | Train Loss: 1.284 Vali Loss: 22.766 Vali Acc: 0.550 Test Loss: 22.766 Test Acc: 0.550
Validation loss decreased (-0.518817 --> -0.549391).  Saving model ...
Epoch: 9 cost time: 72.6909122467041
Epoch: 9, Steps: 32 | Train Loss: 1.705 Vali Loss: 16.987 Vali Acc: 0.473 Test Loss: 16.987 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 73.40135192871094
Epoch: 10, Steps: 32 | Train Loss: 2.862 Vali Loss: 18.586 Vali Acc: 0.588 Test Loss: 18.586 Test Acc: 0.588
Validation loss decreased (-0.549391 --> -0.587600).  Saving model ...
Epoch: 11 cost time: 72.82288551330566
Epoch: 11, Steps: 32 | Train Loss: 0.569 Vali Loss: 52.046 Vali Acc: 0.511 Test Loss: 52.046 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 72.87914156913757
Epoch: 12, Steps: 32 | Train Loss: 2.586 Vali Loss: 33.192 Vali Acc: 0.550 Test Loss: 33.192 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 72.79128170013428
Epoch: 13, Steps: 32 | Train Loss: 2.714 Vali Loss: 45.580 Vali Acc: 0.527 Test Loss: 45.580 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 72.62153339385986
Epoch: 14, Steps: 32 | Train Loss: 1.618 Vali Loss: 42.774 Vali Acc: 0.389 Test Loss: 42.774 Test Acc: 0.389
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 73.08184504508972
Epoch: 15, Steps: 32 | Train Loss: 1.940 Vali Loss: 38.946 Vali Acc: 0.458 Test Loss: 38.946 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 72.5718047618866
Epoch: 16, Steps: 32 | Train Loss: 0.348 Vali Loss: 37.615 Vali Acc: 0.466 Test Loss: 37.615 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 73.10248827934265
Epoch: 17, Steps: 32 | Train Loss: 0.462 Vali Loss: 34.276 Vali Acc: 0.458 Test Loss: 34.276 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 72.85691285133362
Epoch: 18, Steps: 32 | Train Loss: 0.732 Vali Loss: 41.766 Vali Acc: 0.519 Test Loss: 41.766 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 72.44626784324646
Epoch: 19, Steps: 32 | Train Loss: 0.674 Vali Loss: 84.275 Vali Acc: 0.183 Test Loss: 84.275 Test Acc: 0.183
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 72.42705035209656
Epoch: 20, Steps: 32 | Train Loss: 1.902 Vali Loss: 48.812 Vali Acc: 0.519 Test Loss: 48.812 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 7565957
model size : 31.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 37.23467564582825
Epoch: 1, Steps: 32 | Train Loss: 4.633 Vali Loss: 3.133 Vali Acc: 0.534 Test Loss: 3.133 Test Acc: 0.534
Validation loss decreased (inf --> -0.534320).  Saving model ...
Epoch: 2 cost time: 36.8439781665802
Epoch: 2, Steps: 32 | Train Loss: 1.680 Vali Loss: 5.555 Vali Acc: 0.550 Test Loss: 5.555 Test Acc: 0.550
Validation loss decreased (-0.534320 --> -0.549563).  Saving model ...
Epoch: 3 cost time: 36.50272989273071
Epoch: 3, Steps: 32 | Train Loss: 3.524 Vali Loss: 7.432 Vali Acc: 0.420 Test Loss: 7.432 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 36.35667657852173
Epoch: 4, Steps: 32 | Train Loss: 1.838 Vali Loss: 12.833 Vali Acc: 0.405 Test Loss: 12.833 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 36.610957860946655
Epoch: 5, Steps: 32 | Train Loss: 2.745 Vali Loss: 20.554 Vali Acc: 0.344 Test Loss: 20.554 Test Acc: 0.344
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 36.53428101539612
Epoch: 6, Steps: 32 | Train Loss: 2.193 Vali Loss: 18.367 Vali Acc: 0.374 Test Loss: 18.367 Test Acc: 0.374
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 36.439306020736694
Epoch: 7, Steps: 32 | Train Loss: 1.312 Vali Loss: 24.246 Vali Acc: 0.534 Test Loss: 24.246 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 36.52439332008362
Epoch: 8, Steps: 32 | Train Loss: 0.817 Vali Loss: 24.328 Vali Acc: 0.565 Test Loss: 24.328 Test Acc: 0.565
Validation loss decreased (-0.549563 --> -0.564642).  Saving model ...
Epoch: 9 cost time: 36.184171199798584
Epoch: 9, Steps: 32 | Train Loss: 0.269 Vali Loss: 20.039 Vali Acc: 0.466 Test Loss: 20.039 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 36.23633170127869
Epoch: 10, Steps: 32 | Train Loss: 0.095 Vali Loss: 20.848 Vali Acc: 0.573 Test Loss: 20.848 Test Acc: 0.573
Validation loss decreased (-0.564642 --> -0.572311).  Saving model ...
Epoch: 11 cost time: 36.4509654045105
Epoch: 11, Steps: 32 | Train Loss: 0.002 Vali Loss: 28.032 Vali Acc: 0.382 Test Loss: 28.032 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 36.36548566818237
Epoch: 12, Steps: 32 | Train Loss: 0.600 Vali Loss: 20.118 Vali Acc: 0.527 Test Loss: 20.118 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 36.5805459022522
Epoch: 13, Steps: 32 | Train Loss: 0.153 Vali Loss: 32.647 Vali Acc: 0.557 Test Loss: 32.647 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 36.27221965789795
Epoch: 14, Steps: 32 | Train Loss: 0.674 Vali Loss: 47.931 Vali Acc: 0.260 Test Loss: 47.931 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 36.30786061286926
Epoch: 15, Steps: 32 | Train Loss: 0.961 Vali Loss: 53.787 Vali Acc: 0.282 Test Loss: 53.787 Test Acc: 0.282
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 36.60244631767273
Epoch: 16, Steps: 32 | Train Loss: 4.691 Vali Loss: 32.458 Vali Acc: 0.542 Test Loss: 32.458 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 36.16159796714783
Epoch: 17, Steps: 32 | Train Loss: 4.534 Vali Loss: 79.759 Vali Acc: 0.290 Test Loss: 79.759 Test Acc: 0.290
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 36.22649359703064
Epoch: 18, Steps: 32 | Train Loss: 3.266 Vali Loss: 76.698 Vali Acc: 0.527 Test Loss: 76.698 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 36.16727828979492
Epoch: 19, Steps: 32 | Train Loss: 2.138 Vali Loss: 73.647 Vali Acc: 0.267 Test Loss: 73.647 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 36.14043736457825
Epoch: 20, Steps: 32 | Train Loss: 4.227 Vali Loss: 77.600 Vali Acc: 0.298 Test Loss: 77.600 Test Acc: 0.298
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 4255749
model size : 18.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 54.246739625930786
Epoch: 1, Steps: 32 | Train Loss: 2.999 Vali Loss: 4.370 Vali Acc: 0.260 Test Loss: 4.370 Test Acc: 0.260
Validation loss decreased (inf --> -0.259498).  Saving model ...
Epoch: 2 cost time: 53.0125458240509
Epoch: 2, Steps: 32 | Train Loss: 2.774 Vali Loss: 8.101 Vali Acc: 0.542 Test Loss: 8.101 Test Acc: 0.542
Validation loss decreased (-0.259498 --> -0.541904).  Saving model ...
Epoch: 3 cost time: 52.88667345046997
Epoch: 3, Steps: 32 | Train Loss: 1.591 Vali Loss: 8.602 Vali Acc: 0.313 Test Loss: 8.602 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 52.57202959060669
Epoch: 4, Steps: 32 | Train Loss: 3.205 Vali Loss: 12.305 Vali Acc: 0.397 Test Loss: 12.305 Test Acc: 0.397
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 53.150564193725586
Epoch: 5, Steps: 32 | Train Loss: 1.167 Vali Loss: 15.762 Vali Acc: 0.534 Test Loss: 15.762 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 52.78753447532654
Epoch: 6, Steps: 32 | Train Loss: 1.044 Vali Loss: 19.015 Vali Acc: 0.565 Test Loss: 19.015 Test Acc: 0.565
Validation loss decreased (-0.541904 --> -0.564695).  Saving model ...
Epoch: 7 cost time: 52.77681279182434
Epoch: 7, Steps: 32 | Train Loss: 3.362 Vali Loss: 22.835 Vali Acc: 0.527 Test Loss: 22.835 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 52.9420325756073
Epoch: 8, Steps: 32 | Train Loss: 3.350 Vali Loss: 21.823 Vali Acc: 0.382 Test Loss: 21.823 Test Acc: 0.382
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 52.48062348365784
Epoch: 9, Steps: 32 | Train Loss: 0.784 Vali Loss: 26.383 Vali Acc: 0.405 Test Loss: 26.383 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 52.57538294792175
Epoch: 10, Steps: 32 | Train Loss: 2.675 Vali Loss: 25.072 Vali Acc: 0.588 Test Loss: 25.072 Test Acc: 0.588
Validation loss decreased (-0.564695 --> -0.587536).  Saving model ...
Epoch: 11 cost time: 51.88729214668274
Epoch: 11, Steps: 32 | Train Loss: 1.845 Vali Loss: 22.452 Vali Acc: 0.511 Test Loss: 22.452 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 52.47940397262573
Epoch: 12, Steps: 32 | Train Loss: 0.986 Vali Loss: 36.289 Vali Acc: 0.542 Test Loss: 36.289 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 52.66286611557007
Epoch: 13, Steps: 32 | Train Loss: 1.925 Vali Loss: 24.691 Vali Acc: 0.519 Test Loss: 24.691 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 52.40472054481506
Epoch: 14, Steps: 32 | Train Loss: 2.983 Vali Loss: 37.502 Vali Acc: 0.473 Test Loss: 37.502 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 52.22571587562561
Epoch: 15, Steps: 32 | Train Loss: 2.835 Vali Loss: 37.920 Vali Acc: 0.534 Test Loss: 37.920 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 52.68740463256836
Epoch: 16, Steps: 32 | Train Loss: 1.571 Vali Loss: 48.221 Vali Acc: 0.420 Test Loss: 48.221 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 52.49340534210205
Epoch: 17, Steps: 32 | Train Loss: 2.539 Vali Loss: 51.984 Vali Acc: 0.450 Test Loss: 51.984 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 52.63511943817139
Epoch: 18, Steps: 32 | Train Loss: 0.077 Vali Loss: 74.506 Vali Acc: 0.351 Test Loss: 74.506 Test Acc: 0.351
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 52.60381507873535
Epoch: 19, Steps: 32 | Train Loss: 0.058 Vali Loss: 47.820 Vali Acc: 0.405 Test Loss: 47.820 Test Acc: 0.405
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 52.56731367111206
Epoch: 20, Steps: 32 | Train Loss: 0.496 Vali Loss: 52.264 Vali Acc: 0.557 Test Loss: 52.264 Test Acc: 0.557
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 7565957
model size : 31.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 28.614581823349
Epoch: 1, Steps: 32 | Train Loss: 4.615 Vali Loss: 3.113 Vali Acc: 0.542 Test Loss: 3.113 Test Acc: 0.542
Validation loss decreased (inf --> -0.541954).  Saving model ...
Epoch: 2 cost time: 27.861103773117065
Epoch: 2, Steps: 32 | Train Loss: 1.466 Vali Loss: 5.867 Vali Acc: 0.496 Test Loss: 5.867 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 27.766934156417847
Epoch: 3, Steps: 32 | Train Loss: 1.570 Vali Loss: 6.694 Vali Acc: 0.504 Test Loss: 6.694 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 27.712172031402588
Epoch: 4, Steps: 32 | Train Loss: 1.089 Vali Loss: 25.650 Vali Acc: 0.198 Test Loss: 25.650 Test Acc: 0.198
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 27.76495051383972
Epoch: 5, Steps: 32 | Train Loss: 2.918 Vali Loss: 19.030 Vali Acc: 0.443 Test Loss: 19.030 Test Acc: 0.443
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 27.4709370136261
Epoch: 6, Steps: 32 | Train Loss: 3.784 Vali Loss: 27.041 Vali Acc: 0.298 Test Loss: 27.041 Test Acc: 0.298
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 27.666785717010498
Epoch: 7, Steps: 32 | Train Loss: 3.509 Vali Loss: 22.542 Vali Acc: 0.397 Test Loss: 22.542 Test Acc: 0.397
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 27.75422430038452
Epoch: 8, Steps: 32 | Train Loss: 1.644 Vali Loss: 27.404 Vali Acc: 0.412 Test Loss: 27.404 Test Acc: 0.412
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 27.738611936569214
Epoch: 9, Steps: 32 | Train Loss: 2.314 Vali Loss: 30.195 Vali Acc: 0.458 Test Loss: 30.195 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 27.746639013290405
Epoch: 10, Steps: 32 | Train Loss: 0.111 Vali Loss: 28.150 Vali Acc: 0.405 Test Loss: 28.150 Test Acc: 0.405
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 28.04519295692444
Epoch: 11, Steps: 32 | Train Loss: 1.281 Vali Loss: 19.125 Vali Acc: 0.534 Test Loss: 19.125 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 4255749
model size : 18.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 32.922802209854126
Epoch: 1, Steps: 32 | Train Loss: 2.992 Vali Loss: 4.498 Vali Acc: 0.267 Test Loss: 4.498 Test Acc: 0.267
Validation loss decreased (inf --> -0.267131).  Saving model ...
Epoch: 2 cost time: 32.630680322647095
Epoch: 2, Steps: 32 | Train Loss: 1.928 Vali Loss: 6.494 Vali Acc: 0.519 Test Loss: 6.494 Test Acc: 0.519
Validation loss decreased (-0.267131 --> -0.519019).  Saving model ...
Epoch: 3 cost time: 32.365965366363525
Epoch: 3, Steps: 32 | Train Loss: 2.420 Vali Loss: 17.972 Vali Acc: 0.214 Test Loss: 17.972 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 32.37323355674744
Epoch: 4, Steps: 32 | Train Loss: 4.694 Vali Loss: 14.806 Vali Acc: 0.328 Test Loss: 14.806 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 32.170750856399536
Epoch: 5, Steps: 32 | Train Loss: 2.402 Vali Loss: 12.906 Vali Acc: 0.626 Test Loss: 12.906 Test Acc: 0.626
Validation loss decreased (-0.519019 --> -0.625825).  Saving model ...
Epoch: 6 cost time: 32.27213382720947
Epoch: 6, Steps: 32 | Train Loss: 1.104 Vali Loss: 15.754 Vali Acc: 0.534 Test Loss: 15.754 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 32.31613802909851
Epoch: 7, Steps: 32 | Train Loss: 2.927 Vali Loss: 21.296 Vali Acc: 0.366 Test Loss: 21.296 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 32.282634258270264
Epoch: 8, Steps: 32 | Train Loss: 2.793 Vali Loss: 27.494 Vali Acc: 0.542 Test Loss: 27.494 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 32.34831118583679
Epoch: 9, Steps: 32 | Train Loss: 3.369 Vali Loss: 41.185 Vali Acc: 0.260 Test Loss: 41.185 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 32.23792886734009
Epoch: 10, Steps: 32 | Train Loss: 7.185 Vali Loss: 42.638 Vali Acc: 0.229 Test Loss: 42.638 Test Acc: 0.229
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 32.013463497161865
Epoch: 11, Steps: 32 | Train Loss: 1.698 Vali Loss: 31.344 Vali Acc: 0.313 Test Loss: 31.344 Test Acc: 0.313
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 32.165937662124634
Epoch: 12, Steps: 32 | Train Loss: 0.000 Vali Loss: 33.226 Vali Acc: 0.550 Test Loss: 33.226 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 32.13068246841431
Epoch: 13, Steps: 32 | Train Loss: 0.512 Vali Loss: 43.577 Vali Acc: 0.542 Test Loss: 43.577 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 31.71809411048889
Epoch: 14, Steps: 32 | Train Loss: 0.129 Vali Loss: 40.852 Vali Acc: 0.496 Test Loss: 40.852 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 31.604084253311157
Epoch: 15, Steps: 32 | Train Loss: 0.293 Vali Loss: 55.299 Vali Acc: 0.534 Test Loss: 55.299 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6259541984732825
model parameter : 7565957
model size : 31.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 19.79493284225464
Epoch: 1, Steps: 32 | Train Loss: 4.594 Vali Loss: 3.252 Vali Acc: 0.519 Test Loss: 3.252 Test Acc: 0.519
Validation loss decreased (inf --> -0.519051).  Saving model ...
Epoch: 2 cost time: 19.38788628578186
Epoch: 2, Steps: 32 | Train Loss: 2.447 Vali Loss: 6.618 Vali Acc: 0.504 Test Loss: 6.618 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 19.457302808761597
Epoch: 3, Steps: 32 | Train Loss: 2.667 Vali Loss: 9.195 Vali Acc: 0.351 Test Loss: 9.195 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 18.840595245361328
Epoch: 4, Steps: 32 | Train Loss: 0.818 Vali Loss: 9.623 Vali Acc: 0.542 Test Loss: 9.623 Test Acc: 0.542
Validation loss decreased (-0.519051 --> -0.541889).  Saving model ...
Epoch: 5 cost time: 19.093087911605835
Epoch: 5, Steps: 32 | Train Loss: 2.143 Vali Loss: 10.383 Vali Acc: 0.580 Test Loss: 10.383 Test Acc: 0.580
Validation loss decreased (-0.541889 --> -0.580049).  Saving model ...
Epoch: 6 cost time: 19.038379669189453
Epoch: 6, Steps: 32 | Train Loss: 1.151 Vali Loss: 19.612 Vali Acc: 0.290 Test Loss: 19.612 Test Acc: 0.290
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 19.363781929016113
Epoch: 7, Steps: 32 | Train Loss: 7.751 Vali Loss: 37.138 Vali Acc: 0.252 Test Loss: 37.138 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 19.20405864715576
Epoch: 8, Steps: 32 | Train Loss: 2.772 Vali Loss: 29.767 Vali Acc: 0.527 Test Loss: 29.767 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 19.132898807525635
Epoch: 9, Steps: 32 | Train Loss: 0.746 Vali Loss: 23.589 Vali Acc: 0.557 Test Loss: 23.589 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 19.06986165046692
Epoch: 10, Steps: 32 | Train Loss: 0.644 Vali Loss: 27.689 Vali Acc: 0.550 Test Loss: 27.689 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 19.236689567565918
Epoch: 11, Steps: 32 | Train Loss: 0.286 Vali Loss: 27.486 Vali Acc: 0.489 Test Loss: 27.486 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 19.1065354347229
Epoch: 12, Steps: 32 | Train Loss: 0.394 Vali Loss: 30.727 Vali Acc: 0.573 Test Loss: 30.727 Test Acc: 0.573
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 18.9827880859375
Epoch: 13, Steps: 32 | Train Loss: 2.153 Vali Loss: 32.773 Vali Acc: 0.443 Test Loss: 32.773 Test Acc: 0.443
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 19.152730226516724
Epoch: 14, Steps: 32 | Train Loss: 2.120 Vali Loss: 40.452 Vali Acc: 0.313 Test Loss: 40.452 Test Acc: 0.313
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 19.21573758125305
Epoch: 15, Steps: 32 | Train Loss: 0.709 Vali Loss: 32.129 Vali Acc: 0.534 Test Loss: 32.129 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 4255749
model size : 18.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 41.600170373916626
Epoch: 1, Steps: 32 | Train Loss: 3.064 Vali Loss: 4.379 Vali Acc: 0.183 Test Loss: 4.379 Test Acc: 0.183
Validation loss decreased (inf --> -0.183162).  Saving model ...
Epoch: 2 cost time: 41.3387348651886
Epoch: 2, Steps: 32 | Train Loss: 4.373 Vali Loss: 8.540 Vali Acc: 0.267 Test Loss: 8.540 Test Acc: 0.267
Validation loss decreased (-0.183162 --> -0.267090).  Saving model ...
Epoch: 3 cost time: 41.191545724868774
Epoch: 3, Steps: 32 | Train Loss: 2.788 Vali Loss: 10.404 Vali Acc: 0.382 Test Loss: 10.404 Test Acc: 0.382
Validation loss decreased (-0.267090 --> -0.381575).  Saving model ...
Epoch: 4 cost time: 40.92350125312805
Epoch: 4, Steps: 32 | Train Loss: 3.239 Vali Loss: 14.662 Vali Acc: 0.374 Test Loss: 14.662 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 40.9390652179718
Epoch: 5, Steps: 32 | Train Loss: 2.135 Vali Loss: 13.254 Vali Acc: 0.542 Test Loss: 13.254 Test Acc: 0.542
Validation loss decreased (-0.381575 --> -0.541852).  Saving model ...
Epoch: 6 cost time: 41.0105664730072
Epoch: 6, Steps: 32 | Train Loss: 1.220 Vali Loss: 11.004 Vali Acc: 0.458 Test Loss: 11.004 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 40.743770599365234
Epoch: 7, Steps: 32 | Train Loss: 2.451 Vali Loss: 24.689 Vali Acc: 0.489 Test Loss: 24.689 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 41.0837082862854
Epoch: 8, Steps: 32 | Train Loss: 1.595 Vali Loss: 14.843 Vali Acc: 0.473 Test Loss: 14.843 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 41.20193552970886
Epoch: 9, Steps: 32 | Train Loss: 1.776 Vali Loss: 20.506 Vali Acc: 0.481 Test Loss: 20.506 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 40.533793926239014
Epoch: 10, Steps: 32 | Train Loss: 0.819 Vali Loss: 20.474 Vali Acc: 0.557 Test Loss: 20.474 Test Acc: 0.557
Validation loss decreased (-0.541852 --> -0.557047).  Saving model ...
Epoch: 11 cost time: 41.00049114227295
Epoch: 11, Steps: 32 | Train Loss: 0.806 Vali Loss: 22.985 Vali Acc: 0.420 Test Loss: 22.985 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 41.26121735572815
Epoch: 12, Steps: 32 | Train Loss: 3.112 Vali Loss: 33.822 Vali Acc: 0.527 Test Loss: 33.822 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 40.763790130615234
Epoch: 13, Steps: 32 | Train Loss: 1.622 Vali Loss: 35.647 Vali Acc: 0.427 Test Loss: 35.647 Test Acc: 0.427
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 41.1976854801178
Epoch: 14, Steps: 32 | Train Loss: 1.217 Vali Loss: 48.638 Vali Acc: 0.534 Test Loss: 48.638 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 40.56116032600403
Epoch: 15, Steps: 32 | Train Loss: 5.700 Vali Loss: 49.997 Vali Acc: 0.565 Test Loss: 49.997 Test Acc: 0.565
Validation loss decreased (-0.557047 --> -0.564386).  Saving model ...
Epoch: 16 cost time: 40.27594447135925
Epoch: 16, Steps: 32 | Train Loss: 0.864 Vali Loss: 52.824 Vali Acc: 0.527 Test Loss: 52.824 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 40.51430153846741
Epoch: 17, Steps: 32 | Train Loss: 1.667 Vali Loss: 47.644 Vali Acc: 0.313 Test Loss: 47.644 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 40.48611068725586
Epoch: 18, Steps: 32 | Train Loss: 1.250 Vali Loss: 60.417 Vali Acc: 0.443 Test Loss: 60.417 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 40.19516348838806
Epoch: 19, Steps: 32 | Train Loss: 1.836 Vali Loss: 64.810 Vali Acc: 0.443 Test Loss: 64.810 Test Acc: 0.443
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 40.11026906967163
Epoch: 20, Steps: 32 | Train Loss: 1.202 Vali Loss: 39.346 Vali Acc: 0.550 Test Loss: 39.346 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 40.57564330101013
Epoch: 21, Steps: 32 | Train Loss: 1.059 Vali Loss: 37.159 Vali Acc: 0.527 Test Loss: 37.159 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 40.55471754074097
Epoch: 22, Steps: 32 | Train Loss: 0.131 Vali Loss: 49.605 Vali Acc: 0.397 Test Loss: 49.605 Test Acc: 0.397
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 40.6247398853302
Epoch: 23, Steps: 32 | Train Loss: 0.063 Vali Loss: 46.005 Vali Acc: 0.511 Test Loss: 46.005 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 40.62156558036804
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 46.063 Vali Acc: 0.511 Test Loss: 46.063 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 40.499149322509766
Epoch: 25, Steps: 32 | Train Loss: 0.000 Vali Loss: 46.067 Vali Acc: 0.511 Test Loss: 46.067 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 5222277
model size : 22.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 21.473849296569824
Epoch: 1, Steps: 32 | Train Loss: 3.330 Vali Loss: 4.093 Vali Acc: 0.336 Test Loss: 4.093 Test Acc: 0.336
Validation loss decreased (inf --> -0.335837).  Saving model ...
Epoch: 2 cost time: 20.91745400428772
Epoch: 2, Steps: 32 | Train Loss: 2.470 Vali Loss: 10.343 Vali Acc: 0.252 Test Loss: 10.343 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 20.57232928276062
Epoch: 3, Steps: 32 | Train Loss: 2.741 Vali Loss: 9.811 Vali Acc: 0.328 Test Loss: 9.811 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 20.766730070114136
Epoch: 4, Steps: 32 | Train Loss: 3.578 Vali Loss: 16.637 Vali Acc: 0.511 Test Loss: 16.637 Test Acc: 0.511
Validation loss decreased (-0.335837 --> -0.511284).  Saving model ...
Epoch: 5 cost time: 20.58796453475952
Epoch: 5, Steps: 32 | Train Loss: 3.243 Vali Loss: 16.336 Vali Acc: 0.511 Test Loss: 16.336 Test Acc: 0.511
Validation loss decreased (-0.511284 --> -0.511287).  Saving model ...
Epoch: 6 cost time: 20.777430295944214
Epoch: 6, Steps: 32 | Train Loss: 2.212 Vali Loss: 22.232 Vali Acc: 0.351 Test Loss: 22.232 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 20.856412172317505
Epoch: 7, Steps: 32 | Train Loss: 0.946 Vali Loss: 25.542 Vali Acc: 0.588 Test Loss: 25.542 Test Acc: 0.588
Validation loss decreased (-0.511287 --> -0.587531).  Saving model ...
Epoch: 8 cost time: 20.879835605621338
Epoch: 8, Steps: 32 | Train Loss: 1.956 Vali Loss: 17.878 Vali Acc: 0.420 Test Loss: 17.878 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 20.74397087097168
Epoch: 9, Steps: 32 | Train Loss: 1.574 Vali Loss: 22.926 Vali Acc: 0.511 Test Loss: 22.926 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 20.60189461708069
Epoch: 10, Steps: 32 | Train Loss: 0.326 Vali Loss: 30.726 Vali Acc: 0.397 Test Loss: 30.726 Test Acc: 0.397
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 20.52975296974182
Epoch: 11, Steps: 32 | Train Loss: 2.142 Vali Loss: 32.866 Vali Acc: 0.580 Test Loss: 32.866 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 20.370628595352173
Epoch: 12, Steps: 32 | Train Loss: 2.731 Vali Loss: 26.096 Vali Acc: 0.557 Test Loss: 26.096 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 20.568026542663574
Epoch: 13, Steps: 32 | Train Loss: 0.790 Vali Loss: 33.240 Vali Acc: 0.565 Test Loss: 33.240 Test Acc: 0.565
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 20.7831289768219
Epoch: 14, Steps: 32 | Train Loss: 0.291 Vali Loss: 36.845 Vali Acc: 0.527 Test Loss: 36.845 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 20.5835919380188
Epoch: 15, Steps: 32 | Train Loss: 1.451 Vali Loss: 44.484 Vali Acc: 0.267 Test Loss: 44.484 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 20.70188021659851
Epoch: 16, Steps: 32 | Train Loss: 1.852 Vali Loss: 37.629 Vali Acc: 0.397 Test Loss: 37.629 Test Acc: 0.397
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 20.68692398071289
Epoch: 17, Steps: 32 | Train Loss: 2.668 Vali Loss: 29.828 Vali Acc: 0.557 Test Loss: 29.828 Test Acc: 0.557
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 3567109
model size : 15.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 30.07983374595642
Epoch: 1, Steps: 32 | Train Loss: 3.069 Vali Loss: 4.416 Vali Acc: 0.191 Test Loss: 4.416 Test Acc: 0.191
Validation loss decreased (inf --> -0.190796).  Saving model ...
Epoch: 2 cost time: 29.84877586364746
Epoch: 2, Steps: 32 | Train Loss: 3.260 Vali Loss: 6.535 Vali Acc: 0.382 Test Loss: 6.535 Test Acc: 0.382
Validation loss decreased (-0.190796 --> -0.381614).  Saving model ...
Epoch: 3 cost time: 29.29460048675537
Epoch: 3, Steps: 32 | Train Loss: 2.643 Vali Loss: 10.169 Vali Acc: 0.519 Test Loss: 10.169 Test Acc: 0.519
Validation loss decreased (-0.381614 --> -0.518982).  Saving model ...
Epoch: 4 cost time: 29.175808429718018
Epoch: 4, Steps: 32 | Train Loss: 1.430 Vali Loss: 12.472 Vali Acc: 0.496 Test Loss: 12.472 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 29.079049110412598
Epoch: 5, Steps: 32 | Train Loss: 4.516 Vali Loss: 15.122 Vali Acc: 0.427 Test Loss: 15.122 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 29.506534099578857
Epoch: 6, Steps: 32 | Train Loss: 0.702 Vali Loss: 16.741 Vali Acc: 0.290 Test Loss: 16.741 Test Acc: 0.290
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 28.89682650566101
Epoch: 7, Steps: 32 | Train Loss: 0.643 Vali Loss: 25.435 Vali Acc: 0.275 Test Loss: 25.435 Test Acc: 0.275
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 29.216183185577393
Epoch: 8, Steps: 32 | Train Loss: 2.808 Vali Loss: 27.863 Vali Acc: 0.366 Test Loss: 27.863 Test Acc: 0.366
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 28.521789073944092
Epoch: 9, Steps: 32 | Train Loss: 1.511 Vali Loss: 20.012 Vali Acc: 0.542 Test Loss: 20.012 Test Acc: 0.542
Validation loss decreased (-0.518982 --> -0.541785).  Saving model ...
Epoch: 10 cost time: 28.475460052490234
Epoch: 10, Steps: 32 | Train Loss: 3.153 Vali Loss: 34.099 Vali Acc: 0.595 Test Loss: 34.099 Test Acc: 0.595
Validation loss decreased (-0.541785 --> -0.595079).  Saving model ...
Epoch: 11 cost time: 28.36416721343994
Epoch: 11, Steps: 32 | Train Loss: 1.978 Vali Loss: 37.751 Vali Acc: 0.527 Test Loss: 37.751 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 29.258716821670532
Epoch: 12, Steps: 32 | Train Loss: 1.444 Vali Loss: 35.619 Vali Acc: 0.321 Test Loss: 35.619 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 28.92009162902832
Epoch: 13, Steps: 32 | Train Loss: 1.067 Vali Loss: 41.689 Vali Acc: 0.519 Test Loss: 41.689 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 28.67007303237915
Epoch: 14, Steps: 32 | Train Loss: 3.857 Vali Loss: 41.950 Vali Acc: 0.511 Test Loss: 41.950 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 28.702399969100952
Epoch: 15, Steps: 32 | Train Loss: 0.863 Vali Loss: 32.517 Vali Acc: 0.519 Test Loss: 32.517 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 28.73323917388916
Epoch: 16, Steps: 32 | Train Loss: 0.001 Vali Loss: 28.399 Vali Acc: 0.481 Test Loss: 28.399 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 28.855823516845703
Epoch: 17, Steps: 32 | Train Loss: 0.394 Vali Loss: 36.512 Vali Acc: 0.420 Test Loss: 36.512 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 28.318718671798706
Epoch: 18, Steps: 32 | Train Loss: 0.157 Vali Loss: 31.441 Vali Acc: 0.473 Test Loss: 31.441 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 29.018746376037598
Epoch: 19, Steps: 32 | Train Loss: 0.117 Vali Loss: 44.884 Vali Acc: 0.458 Test Loss: 44.884 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 28.6460018157959
Epoch: 20, Steps: 32 | Train Loss: 0.548 Vali Loss: 38.808 Vali Acc: 0.458 Test Loss: 38.808 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5954198473282443
model parameter : 5222277
model size : 22.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 16.534693479537964
Epoch: 1, Steps: 32 | Train Loss: 3.311 Vali Loss: 4.027 Vali Acc: 0.405 Test Loss: 4.027 Test Acc: 0.405
Validation loss decreased (inf --> -0.404540).  Saving model ...
Epoch: 2 cost time: 15.63179874420166
Epoch: 2, Steps: 32 | Train Loss: 3.854 Vali Loss: 15.182 Vali Acc: 0.183 Test Loss: 15.182 Test Acc: 0.183
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 15.491676330566406
Epoch: 3, Steps: 32 | Train Loss: 0.690 Vali Loss: 7.299 Vali Acc: 0.527 Test Loss: 7.299 Test Acc: 0.527
Validation loss decreased (-0.404540 --> -0.526645).  Saving model ...
Epoch: 4 cost time: 15.6778724193573
Epoch: 4, Steps: 32 | Train Loss: 1.184 Vali Loss: 6.718 Vali Acc: 0.481 Test Loss: 6.718 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 15.39432430267334
Epoch: 5, Steps: 32 | Train Loss: 2.553 Vali Loss: 13.557 Vali Acc: 0.321 Test Loss: 13.557 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 15.496586084365845
Epoch: 6, Steps: 32 | Train Loss: 4.098 Vali Loss: 21.026 Vali Acc: 0.412 Test Loss: 21.026 Test Acc: 0.412
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 15.515956163406372
Epoch: 7, Steps: 32 | Train Loss: 3.023 Vali Loss: 22.315 Vali Acc: 0.511 Test Loss: 22.315 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 15.23078179359436
Epoch: 8, Steps: 32 | Train Loss: 1.975 Vali Loss: 30.206 Vali Acc: 0.527 Test Loss: 30.206 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 15.507314920425415
Epoch: 9, Steps: 32 | Train Loss: 3.042 Vali Loss: 32.205 Vali Acc: 0.359 Test Loss: 32.205 Test Acc: 0.359
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 15.239910364151001
Epoch: 10, Steps: 32 | Train Loss: 0.000 Vali Loss: 24.961 Vali Acc: 0.511 Test Loss: 24.961 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 15.090819835662842
Epoch: 11, Steps: 32 | Train Loss: 0.221 Vali Loss: 23.259 Vali Acc: 0.595 Test Loss: 23.259 Test Acc: 0.595
Validation loss decreased (-0.526645 --> -0.595187).  Saving model ...
Epoch: 12 cost time: 15.152154445648193
Epoch: 12, Steps: 32 | Train Loss: 0.000 Vali Loss: 27.411 Vali Acc: 0.519 Test Loss: 27.411 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 15.348504781723022
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 27.656 Vali Acc: 0.519 Test Loss: 27.656 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 15.070326089859009
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 27.665 Vali Acc: 0.519 Test Loss: 27.665 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 15.313790559768677
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 27.665 Vali Acc: 0.519 Test Loss: 27.665 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 15.473306894302368
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 27.665 Vali Acc: 0.519 Test Loss: 27.665 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 15.439147472381592
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 27.665 Vali Acc: 0.519 Test Loss: 27.665 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 15.433973789215088
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 27.665 Vali Acc: 0.519 Test Loss: 27.665 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 15.578664064407349
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 27.665 Vali Acc: 0.519 Test Loss: 27.665 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 15.406898498535156
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 27.665 Vali Acc: 0.519 Test Loss: 27.665 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 15.35498046875
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 27.665 Vali Acc: 0.519 Test Loss: 27.665 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5954198473282443
model parameter : 3567109
model size : 15.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 17.579089641571045
Epoch: 1, Steps: 32 | Train Loss: 3.085 Vali Loss: 4.389 Vali Acc: 0.191 Test Loss: 4.389 Test Acc: 0.191
Validation loss decreased (inf --> -0.190796).  Saving model ...
Epoch: 2 cost time: 16.945128202438354
Epoch: 2, Steps: 32 | Train Loss: 3.330 Vali Loss: 3.613 Vali Acc: 0.496 Test Loss: 3.613 Test Acc: 0.496
Validation loss decreased (-0.190796 --> -0.496147).  Saving model ...
Epoch: 3 cost time: 17.015565633773804
Epoch: 3, Steps: 32 | Train Loss: 3.991 Vali Loss: 13.097 Vali Acc: 0.519 Test Loss: 13.097 Test Acc: 0.519
Validation loss decreased (-0.496147 --> -0.518953).  Saving model ...
Epoch: 4 cost time: 16.73714566230774
Epoch: 4, Steps: 32 | Train Loss: 1.650 Vali Loss: 9.957 Vali Acc: 0.573 Test Loss: 9.957 Test Acc: 0.573
Validation loss decreased (-0.518953 --> -0.572420).  Saving model ...
Epoch: 5 cost time: 16.64362382888794
Epoch: 5, Steps: 32 | Train Loss: 0.764 Vali Loss: 8.674 Vali Acc: 0.557 Test Loss: 8.674 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 16.7369441986084
Epoch: 6, Steps: 32 | Train Loss: 1.054 Vali Loss: 26.294 Vali Acc: 0.511 Test Loss: 26.294 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 16.63248920440674
Epoch: 7, Steps: 32 | Train Loss: 2.733 Vali Loss: 18.989 Vali Acc: 0.626 Test Loss: 18.989 Test Acc: 0.626
Validation loss decreased (-0.572420 --> -0.625764).  Saving model ...
Epoch: 8 cost time: 16.736299514770508
Epoch: 8, Steps: 32 | Train Loss: 1.196 Vali Loss: 31.733 Vali Acc: 0.374 Test Loss: 31.733 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 16.792970418930054
Epoch: 9, Steps: 32 | Train Loss: 2.438 Vali Loss: 31.871 Vali Acc: 0.504 Test Loss: 31.871 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 16.688596963882446
Epoch: 10, Steps: 32 | Train Loss: 1.067 Vali Loss: 19.523 Vali Acc: 0.473 Test Loss: 19.523 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 16.57661771774292
Epoch: 11, Steps: 32 | Train Loss: 0.436 Vali Loss: 28.532 Vali Acc: 0.450 Test Loss: 28.532 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 16.531577587127686
Epoch: 12, Steps: 32 | Train Loss: 2.289 Vali Loss: 32.241 Vali Acc: 0.450 Test Loss: 32.241 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 16.645472764968872
Epoch: 13, Steps: 32 | Train Loss: 0.769 Vali Loss: 26.347 Vali Acc: 0.504 Test Loss: 26.347 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 16.5158953666687
Epoch: 14, Steps: 32 | Train Loss: 0.756 Vali Loss: 21.107 Vali Acc: 0.511 Test Loss: 21.107 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 16.728796243667603
Epoch: 15, Steps: 32 | Train Loss: 1.009 Vali Loss: 65.373 Vali Acc: 0.504 Test Loss: 65.373 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 16.90639901161194
Epoch: 16, Steps: 32 | Train Loss: 2.348 Vali Loss: 28.707 Vali Acc: 0.511 Test Loss: 28.707 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 16.407203435897827
Epoch: 17, Steps: 32 | Train Loss: 0.589 Vali Loss: 58.649 Vali Acc: 0.534 Test Loss: 58.649 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6259541984732825
model parameter : 5222277
model size : 22.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 10.712654829025269
Epoch: 1, Steps: 32 | Train Loss: 3.304 Vali Loss: 4.066 Vali Acc: 0.366 Test Loss: 4.066 Test Acc: 0.366
Validation loss decreased (inf --> -0.366372).  Saving model ...
Epoch: 2 cost time: 9.776004314422607
Epoch: 2, Steps: 32 | Train Loss: 2.659 Vali Loss: 16.787 Vali Acc: 0.183 Test Loss: 16.787 Test Acc: 0.183
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.922586917877197
Epoch: 3, Steps: 32 | Train Loss: 2.202 Vali Loss: 9.448 Vali Acc: 0.328 Test Loss: 9.448 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.966952085494995
Epoch: 4, Steps: 32 | Train Loss: 1.768 Vali Loss: 9.419 Vali Acc: 0.504 Test Loss: 9.419 Test Acc: 0.504
Validation loss decreased (-0.366372 --> -0.503723).  Saving model ...
Epoch: 5 cost time: 9.931013822555542
Epoch: 5, Steps: 32 | Train Loss: 1.674 Vali Loss: 17.140 Vali Acc: 0.359 Test Loss: 17.140 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.721943378448486
Epoch: 6, Steps: 32 | Train Loss: 1.371 Vali Loss: 24.923 Vali Acc: 0.557 Test Loss: 24.923 Test Acc: 0.557
Validation loss decreased (-0.503723 --> -0.557003).  Saving model ...
Epoch: 7 cost time: 9.93130350112915
Epoch: 7, Steps: 32 | Train Loss: 0.499 Vali Loss: 18.292 Vali Acc: 0.443 Test Loss: 18.292 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.822499752044678
Epoch: 8, Steps: 32 | Train Loss: 3.632 Vali Loss: 23.242 Vali Acc: 0.336 Test Loss: 23.242 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 9.70165729522705
Epoch: 9, Steps: 32 | Train Loss: 2.854 Vali Loss: 36.397 Vali Acc: 0.450 Test Loss: 36.397 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 9.786184310913086
Epoch: 10, Steps: 32 | Train Loss: 1.611 Vali Loss: 43.242 Vali Acc: 0.252 Test Loss: 43.242 Test Acc: 0.252
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 9.80224323272705
Epoch: 11, Steps: 32 | Train Loss: 3.368 Vali Loss: 41.309 Vali Acc: 0.336 Test Loss: 41.309 Test Acc: 0.336
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 9.878237247467041
Epoch: 12, Steps: 32 | Train Loss: 5.290 Vali Loss: 52.452 Vali Acc: 0.565 Test Loss: 52.452 Test Acc: 0.565
Validation loss decreased (-0.557003 --> -0.564361).  Saving model ...
Epoch: 13 cost time: 9.838056564331055
Epoch: 13, Steps: 32 | Train Loss: 2.667 Vali Loss: 39.150 Vali Acc: 0.450 Test Loss: 39.150 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 9.722501516342163
Epoch: 14, Steps: 32 | Train Loss: 1.476 Vali Loss: 100.582 Vali Acc: 0.191 Test Loss: 100.582 Test Acc: 0.191
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 9.583057165145874
Epoch: 15, Steps: 32 | Train Loss: 3.071 Vali Loss: 40.211 Vali Acc: 0.458 Test Loss: 40.211 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 9.667044878005981
Epoch: 16, Steps: 32 | Train Loss: 0.059 Vali Loss: 50.932 Vali Acc: 0.412 Test Loss: 50.932 Test Acc: 0.412
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 9.757091045379639
Epoch: 17, Steps: 32 | Train Loss: 0.479 Vali Loss: 52.401 Vali Acc: 0.282 Test Loss: 52.401 Test Acc: 0.282
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 9.661620378494263
Epoch: 18, Steps: 32 | Train Loss: 2.519 Vali Loss: 73.548 Vali Acc: 0.511 Test Loss: 73.548 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 9.789137840270996
Epoch: 19, Steps: 32 | Train Loss: 0.233 Vali Loss: 56.124 Vali Acc: 0.542 Test Loss: 56.124 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 9.699062585830688
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 60.531 Vali Acc: 0.458 Test Loss: 60.531 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 9.734606266021729
Epoch: 21, Steps: 32 | Train Loss: 0.415 Vali Loss: 50.884 Vali Acc: 0.443 Test Loss: 50.884 Test Acc: 0.443
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 9.75536060333252
Epoch: 22, Steps: 32 | Train Loss: 0.494 Vali Loss: 74.288 Vali Acc: 0.458 Test Loss: 74.288 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 3567109
model size : 15.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 24.849160194396973
Epoch: 1, Steps: 32 | Train Loss: 3.379 Vali Loss: 5.600 Vali Acc: 0.435 Test Loss: 5.600 Test Acc: 0.435
Validation loss decreased (inf --> -0.435059).  Saving model ...
Epoch: 2 cost time: 24.662778615951538
Epoch: 2, Steps: 32 | Train Loss: 3.679 Vali Loss: 6.508 Vali Acc: 0.458 Test Loss: 6.508 Test Acc: 0.458
Validation loss decreased (-0.435059 --> -0.457950).  Saving model ...
Epoch: 3 cost time: 24.76262593269348
Epoch: 3, Steps: 32 | Train Loss: 1.799 Vali Loss: 8.457 Vali Acc: 0.527 Test Loss: 8.457 Test Acc: 0.527
Validation loss decreased (-0.457950 --> -0.526633).  Saving model ...
Epoch: 4 cost time: 24.204813718795776
Epoch: 4, Steps: 32 | Train Loss: 0.637 Vali Loss: 8.011 Vali Acc: 0.397 Test Loss: 8.011 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 24.573121786117554
Epoch: 5, Steps: 32 | Train Loss: 2.456 Vali Loss: 14.274 Vali Acc: 0.504 Test Loss: 14.274 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 24.241665840148926
Epoch: 6, Steps: 32 | Train Loss: 1.683 Vali Loss: 12.794 Vali Acc: 0.489 Test Loss: 12.794 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 24.24633812904358
Epoch: 7, Steps: 32 | Train Loss: 3.683 Vali Loss: 26.413 Vali Acc: 0.298 Test Loss: 26.413 Test Acc: 0.298
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 24.139464855194092
Epoch: 8, Steps: 32 | Train Loss: 2.395 Vali Loss: 28.414 Vali Acc: 0.443 Test Loss: 28.414 Test Acc: 0.443
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 23.957703113555908
Epoch: 9, Steps: 32 | Train Loss: 2.130 Vali Loss: 27.295 Vali Acc: 0.511 Test Loss: 27.295 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 24.020666360855103
Epoch: 10, Steps: 32 | Train Loss: 0.339 Vali Loss: 25.047 Vali Acc: 0.450 Test Loss: 25.047 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 24.119192600250244
Epoch: 11, Steps: 32 | Train Loss: 2.720 Vali Loss: 65.160 Vali Acc: 0.237 Test Loss: 65.160 Test Acc: 0.237
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 24.264501094818115
Epoch: 12, Steps: 32 | Train Loss: 9.667 Vali Loss: 26.936 Vali Acc: 0.435 Test Loss: 26.936 Test Acc: 0.435
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 24.065446615219116
Epoch: 13, Steps: 32 | Train Loss: 3.140 Vali Loss: 30.230 Vali Acc: 0.458 Test Loss: 30.230 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 4050437
model size : 17.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 13.558353185653687
Epoch: 1, Steps: 32 | Train Loss: 4.501 Vali Loss: 5.684 Vali Acc: 0.481 Test Loss: 5.684 Test Acc: 0.481
Validation loss decreased (inf --> -0.480859).  Saving model ...
Epoch: 2 cost time: 12.361298322677612
Epoch: 2, Steps: 32 | Train Loss: 3.014 Vali Loss: 3.933 Vali Acc: 0.511 Test Loss: 3.933 Test Acc: 0.511
Validation loss decreased (-0.480859 --> -0.511411).  Saving model ...
Epoch: 3 cost time: 12.6650550365448
Epoch: 3, Steps: 32 | Train Loss: 3.269 Vali Loss: 15.523 Vali Acc: 0.534 Test Loss: 15.523 Test Acc: 0.534
Validation loss decreased (-0.511411 --> -0.534196).  Saving model ...
Epoch: 4 cost time: 12.631046533584595
Epoch: 4, Steps: 32 | Train Loss: 4.065 Vali Loss: 8.075 Vali Acc: 0.496 Test Loss: 8.075 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.767135620117188
Epoch: 5, Steps: 32 | Train Loss: 0.134 Vali Loss: 13.787 Vali Acc: 0.328 Test Loss: 13.787 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 12.576985359191895
Epoch: 6, Steps: 32 | Train Loss: 0.154 Vali Loss: 14.342 Vali Acc: 0.328 Test Loss: 14.342 Test Acc: 0.328
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 12.9212064743042
Epoch: 7, Steps: 32 | Train Loss: 1.729 Vali Loss: 14.900 Vali Acc: 0.534 Test Loss: 14.900 Test Acc: 0.534
Validation loss decreased (-0.534196 --> -0.534202).  Saving model ...
Epoch: 8 cost time: 12.571029424667358
Epoch: 8, Steps: 32 | Train Loss: 1.063 Vali Loss: 30.764 Vali Acc: 0.328 Test Loss: 30.764 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 12.625486612319946
Epoch: 9, Steps: 32 | Train Loss: 4.683 Vali Loss: 53.048 Vali Acc: 0.489 Test Loss: 53.048 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 12.478464603424072
Epoch: 10, Steps: 32 | Train Loss: 4.617 Vali Loss: 20.367 Vali Acc: 0.542 Test Loss: 20.367 Test Acc: 0.542
Validation loss decreased (-0.534202 --> -0.541781).  Saving model ...
Epoch: 11 cost time: 12.65648341178894
Epoch: 11, Steps: 32 | Train Loss: 0.000 Vali Loss: 23.330 Vali Acc: 0.481 Test Loss: 23.330 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 12.408157110214233
Epoch: 12, Steps: 32 | Train Loss: 0.000 Vali Loss: 21.922 Vali Acc: 0.557 Test Loss: 21.922 Test Acc: 0.557
Validation loss decreased (-0.541781 --> -0.557033).  Saving model ...
Epoch: 13 cost time: 12.447739124298096
Epoch: 13, Steps: 32 | Train Loss: 0.023 Vali Loss: 21.821 Vali Acc: 0.557 Test Loss: 21.821 Test Acc: 0.557
Validation loss decreased (-0.557033 --> -0.557034).  Saving model ...
Epoch: 14 cost time: 12.612685680389404
Epoch: 14, Steps: 32 | Train Loss: 0.349 Vali Loss: 30.873 Vali Acc: 0.542 Test Loss: 30.873 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 12.616397142410278
Epoch: 15, Steps: 32 | Train Loss: 0.682 Vali Loss: 41.358 Vali Acc: 0.550 Test Loss: 41.358 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 12.467987775802612
Epoch: 16, Steps: 32 | Train Loss: 4.057 Vali Loss: 49.852 Vali Acc: 0.359 Test Loss: 49.852 Test Acc: 0.359
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 12.59523344039917
Epoch: 17, Steps: 32 | Train Loss: 1.529 Vali Loss: 59.816 Vali Acc: 0.542 Test Loss: 59.816 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 12.43303894996643
Epoch: 18, Steps: 32 | Train Loss: 1.844 Vali Loss: 57.063 Vali Acc: 0.580 Test Loss: 57.063 Test Acc: 0.580
Validation loss decreased (-0.557034 --> -0.579582).  Saving model ...
Epoch: 19 cost time: 12.385850191116333
Epoch: 19, Steps: 32 | Train Loss: 2.885 Vali Loss: 43.555 Vali Acc: 0.580 Test Loss: 43.555 Test Acc: 0.580
Validation loss decreased (-0.579582 --> -0.579717).  Saving model ...
Epoch: 20 cost time: 12.463786602020264
Epoch: 20, Steps: 32 | Train Loss: 1.133 Vali Loss: 70.079 Vali Acc: 0.542 Test Loss: 70.079 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 12.636249542236328
Epoch: 21, Steps: 32 | Train Loss: 0.550 Vali Loss: 75.643 Vali Acc: 0.534 Test Loss: 75.643 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 12.358686923980713
Epoch: 22, Steps: 32 | Train Loss: 1.033 Vali Loss: 44.670 Vali Acc: 0.580 Test Loss: 44.670 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 12.497298002243042
Epoch: 23, Steps: 32 | Train Loss: 0.039 Vali Loss: 55.655 Vali Acc: 0.557 Test Loss: 55.655 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 12.56076455116272
Epoch: 24, Steps: 32 | Train Loss: 1.780 Vali Loss: 32.922 Vali Acc: 0.458 Test Loss: 32.922 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 12.420911073684692
Epoch: 25, Steps: 32 | Train Loss: 0.058 Vali Loss: 53.107 Vali Acc: 0.534 Test Loss: 53.107 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 12.33531641960144
Epoch: 26, Steps: 32 | Train Loss: 1.210 Vali Loss: 51.177 Vali Acc: 0.458 Test Loss: 51.177 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 12.423211097717285
Epoch: 27, Steps: 32 | Train Loss: 0.242 Vali Loss: 73.829 Vali Acc: 0.527 Test Loss: 73.829 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 12.693071365356445
Epoch: 28, Steps: 32 | Train Loss: 0.611 Vali Loss: 65.402 Vali Acc: 0.534 Test Loss: 65.402 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 12.643768787384033
Epoch: 29, Steps: 32 | Train Loss: 3.457 Vali Loss: 83.019 Vali Acc: 0.382 Test Loss: 83.019 Test Acc: 0.382
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 3222789
model size : 14.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 17.40259575843811
Epoch: 1, Steps: 32 | Train Loss: 3.320 Vali Loss: 5.248 Vali Acc: 0.435 Test Loss: 5.248 Test Acc: 0.435
Validation loss decreased (inf --> -0.435062).  Saving model ...
Epoch: 2 cost time: 17.022375345230103
Epoch: 2, Steps: 32 | Train Loss: 3.091 Vali Loss: 7.610 Vali Acc: 0.504 Test Loss: 7.610 Test Acc: 0.504
Validation loss decreased (-0.435062 --> -0.503741).  Saving model ...
Epoch: 3 cost time: 16.830756902694702
Epoch: 3, Steps: 32 | Train Loss: 3.059 Vali Loss: 10.151 Vali Acc: 0.305 Test Loss: 10.151 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 16.68931293487549
Epoch: 4, Steps: 32 | Train Loss: 2.431 Vali Loss: 14.068 Vali Acc: 0.321 Test Loss: 14.068 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 16.794400215148926
Epoch: 5, Steps: 32 | Train Loss: 1.633 Vali Loss: 13.015 Vali Acc: 0.412 Test Loss: 13.015 Test Acc: 0.412
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 16.529603481292725
Epoch: 6, Steps: 32 | Train Loss: 1.064 Vali Loss: 17.889 Vali Acc: 0.588 Test Loss: 17.889 Test Acc: 0.588
Validation loss decreased (-0.503741 --> -0.587607).  Saving model ...
Epoch: 7 cost time: 16.817588090896606
Epoch: 7, Steps: 32 | Train Loss: 2.556 Vali Loss: 20.822 Vali Acc: 0.489 Test Loss: 20.822 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 16.586433172225952
Epoch: 8, Steps: 32 | Train Loss: 1.593 Vali Loss: 16.412 Vali Acc: 0.496 Test Loss: 16.412 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 16.81532621383667
Epoch: 9, Steps: 32 | Train Loss: 1.195 Vali Loss: 37.032 Vali Acc: 0.496 Test Loss: 37.032 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 16.368472576141357
Epoch: 10, Steps: 32 | Train Loss: 2.936 Vali Loss: 28.774 Vali Acc: 0.344 Test Loss: 28.774 Test Acc: 0.344
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 16.812011003494263
Epoch: 11, Steps: 32 | Train Loss: 3.042 Vali Loss: 49.913 Vali Acc: 0.282 Test Loss: 49.913 Test Acc: 0.282
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 16.649354934692383
Epoch: 12, Steps: 32 | Train Loss: 0.600 Vali Loss: 40.046 Vali Acc: 0.328 Test Loss: 40.046 Test Acc: 0.328
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 16.195457458496094
Epoch: 13, Steps: 32 | Train Loss: 0.722 Vali Loss: 32.280 Vali Acc: 0.328 Test Loss: 32.280 Test Acc: 0.328
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 16.108961582183838
Epoch: 14, Steps: 32 | Train Loss: 0.480 Vali Loss: 48.396 Vali Acc: 0.305 Test Loss: 48.396 Test Acc: 0.305
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 16.102105617523193
Epoch: 15, Steps: 32 | Train Loss: 0.340 Vali Loss: 39.459 Vali Acc: 0.321 Test Loss: 39.459 Test Acc: 0.321
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 16.688140153884888
Epoch: 16, Steps: 32 | Train Loss: 0.377 Vali Loss: 55.379 Vali Acc: 0.298 Test Loss: 55.379 Test Acc: 0.298
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 4050437
model size : 17.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 10.150864601135254
Epoch: 1, Steps: 32 | Train Loss: 4.536 Vali Loss: 5.907 Vali Acc: 0.458 Test Loss: 5.907 Test Acc: 0.458
Validation loss decreased (inf --> -0.457956).  Saving model ...
Epoch: 2 cost time: 8.984071493148804
Epoch: 2, Steps: 32 | Train Loss: 2.840 Vali Loss: 5.148 Vali Acc: 0.527 Test Loss: 5.148 Test Acc: 0.527
Validation loss decreased (-0.457956 --> -0.526666).  Saving model ...
Epoch: 3 cost time: 9.070201635360718
Epoch: 3, Steps: 32 | Train Loss: 2.289 Vali Loss: 9.708 Vali Acc: 0.473 Test Loss: 9.708 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.995195150375366
Epoch: 4, Steps: 32 | Train Loss: 2.657 Vali Loss: 14.606 Vali Acc: 0.321 Test Loss: 14.606 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 9.217949390411377
Epoch: 5, Steps: 32 | Train Loss: 3.072 Vali Loss: 26.377 Vali Acc: 0.321 Test Loss: 26.377 Test Acc: 0.321
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 9.112436532974243
Epoch: 6, Steps: 32 | Train Loss: 1.964 Vali Loss: 25.181 Vali Acc: 0.496 Test Loss: 25.181 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 9.325204610824585
Epoch: 7, Steps: 32 | Train Loss: 3.010 Vali Loss: 19.156 Vali Acc: 0.511 Test Loss: 19.156 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 9.085736274719238
Epoch: 8, Steps: 32 | Train Loss: 2.724 Vali Loss: 28.372 Vali Acc: 0.382 Test Loss: 28.372 Test Acc: 0.382
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 9.208804607391357
Epoch: 9, Steps: 32 | Train Loss: 2.486 Vali Loss: 31.015 Vali Acc: 0.565 Test Loss: 31.015 Test Acc: 0.565
Validation loss decreased (-0.526666 --> -0.564575).  Saving model ...
Epoch: 10 cost time: 9.23179006576538
Epoch: 10, Steps: 32 | Train Loss: 0.136 Vali Loss: 43.067 Vali Acc: 0.534 Test Loss: 43.067 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 9.132119417190552
Epoch: 11, Steps: 32 | Train Loss: 0.643 Vali Loss: 22.631 Vali Acc: 0.466 Test Loss: 22.631 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 9.267988681793213
Epoch: 12, Steps: 32 | Train Loss: 0.124 Vali Loss: 21.648 Vali Acc: 0.534 Test Loss: 21.648 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 9.079310417175293
Epoch: 13, Steps: 32 | Train Loss: 0.296 Vali Loss: 21.201 Vali Acc: 0.466 Test Loss: 21.201 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 9.057709455490112
Epoch: 14, Steps: 32 | Train Loss: 0.510 Vali Loss: 27.263 Vali Acc: 0.511 Test Loss: 27.263 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 9.077844619750977
Epoch: 15, Steps: 32 | Train Loss: 0.482 Vali Loss: 29.159 Vali Acc: 0.550 Test Loss: 29.159 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 9.280433654785156
Epoch: 16, Steps: 32 | Train Loss: 0.044 Vali Loss: 33.853 Vali Acc: 0.542 Test Loss: 33.853 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 9.073457717895508
Epoch: 17, Steps: 32 | Train Loss: 3.329 Vali Loss: 37.698 Vali Acc: 0.496 Test Loss: 37.698 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 9.027057409286499
Epoch: 18, Steps: 32 | Train Loss: 0.839 Vali Loss: 38.286 Vali Acc: 0.466 Test Loss: 38.286 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 9.256508588790894
Epoch: 19, Steps: 32 | Train Loss: 0.591 Vali Loss: 39.621 Vali Acc: 0.481 Test Loss: 39.621 Test Acc: 0.481
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 3222789
model size : 14.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 9.75799822807312
Epoch: 1, Steps: 32 | Train Loss: 3.259 Vali Loss: 4.873 Vali Acc: 0.450 Test Loss: 4.873 Test Acc: 0.450
Validation loss decreased (inf --> -0.450333).  Saving model ...
Epoch: 2 cost time: 8.740637063980103
Epoch: 2, Steps: 32 | Train Loss: 3.160 Vali Loss: 6.057 Vali Acc: 0.557 Test Loss: 6.057 Test Acc: 0.557
Validation loss decreased (-0.450333 --> -0.557191).  Saving model ...
Epoch: 3 cost time: 8.727273941040039
Epoch: 3, Steps: 32 | Train Loss: 2.765 Vali Loss: 8.403 Vali Acc: 0.511 Test Loss: 8.403 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.878652334213257
Epoch: 4, Steps: 32 | Train Loss: 2.844 Vali Loss: 13.364 Vali Acc: 0.481 Test Loss: 13.364 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 9.277407169342041
Epoch: 5, Steps: 32 | Train Loss: 2.945 Vali Loss: 15.232 Vali Acc: 0.336 Test Loss: 15.232 Test Acc: 0.336
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 8.744642734527588
Epoch: 6, Steps: 32 | Train Loss: 0.897 Vali Loss: 26.809 Vali Acc: 0.489 Test Loss: 26.809 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 8.75468111038208
Epoch: 7, Steps: 32 | Train Loss: 5.334 Vali Loss: 24.148 Vali Acc: 0.389 Test Loss: 24.148 Test Acc: 0.389
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 8.855850219726562
Epoch: 8, Steps: 32 | Train Loss: 1.484 Vali Loss: 25.285 Vali Acc: 0.344 Test Loss: 25.285 Test Acc: 0.344
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 8.91604232788086
Epoch: 9, Steps: 32 | Train Loss: 1.062 Vali Loss: 23.993 Vali Acc: 0.466 Test Loss: 23.993 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 8.816107749938965
Epoch: 10, Steps: 32 | Train Loss: 0.757 Vali Loss: 24.582 Vali Acc: 0.397 Test Loss: 24.582 Test Acc: 0.397
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 8.653578281402588
Epoch: 11, Steps: 32 | Train Loss: 0.850 Vali Loss: 24.645 Vali Acc: 0.557 Test Loss: 24.645 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 8.779375314712524
Epoch: 12, Steps: 32 | Train Loss: 1.463 Vali Loss: 40.348 Vali Acc: 0.519 Test Loss: 40.348 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 4050437
model size : 17.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 6.521890163421631
Epoch: 1, Steps: 32 | Train Loss: 4.536 Vali Loss: 6.128 Vali Acc: 0.450 Test Loss: 6.128 Test Acc: 0.450
Validation loss decreased (inf --> -0.450320).  Saving model ...
Epoch: 2 cost time: 5.454671621322632
Epoch: 2, Steps: 32 | Train Loss: 2.510 Vali Loss: 4.378 Vali Acc: 0.427 Test Loss: 4.378 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.4589033126831055
Epoch: 3, Steps: 32 | Train Loss: 6.250 Vali Loss: 13.402 Vali Acc: 0.489 Test Loss: 13.402 Test Acc: 0.489
Validation loss decreased (-0.450320 --> -0.488416).  Saving model ...
Epoch: 4 cost time: 5.678221225738525
Epoch: 4, Steps: 32 | Train Loss: 4.686 Vali Loss: 16.535 Vali Acc: 0.313 Test Loss: 16.535 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.532434940338135
Epoch: 5, Steps: 32 | Train Loss: 1.271 Vali Loss: 12.864 Vali Acc: 0.344 Test Loss: 12.864 Test Acc: 0.344
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.592898368835449
Epoch: 6, Steps: 32 | Train Loss: 1.711 Vali Loss: 27.821 Vali Acc: 0.374 Test Loss: 27.821 Test Acc: 0.374
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.599573373794556
Epoch: 7, Steps: 32 | Train Loss: 3.100 Vali Loss: 17.898 Vali Acc: 0.397 Test Loss: 17.898 Test Acc: 0.397
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.569769859313965
Epoch: 8, Steps: 32 | Train Loss: 0.253 Vali Loss: 18.169 Vali Acc: 0.534 Test Loss: 18.169 Test Acc: 0.534
Validation loss decreased (-0.488416 --> -0.534169).  Saving model ...
Epoch: 9 cost time: 5.544337034225464
Epoch: 9, Steps: 32 | Train Loss: 0.927 Vali Loss: 18.508 Vali Acc: 0.481 Test Loss: 18.508 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.637808322906494
Epoch: 10, Steps: 32 | Train Loss: 0.390 Vali Loss: 31.024 Vali Acc: 0.542 Test Loss: 31.024 Test Acc: 0.542
Validation loss decreased (-0.534169 --> -0.541674).  Saving model ...
Epoch: 11 cost time: 5.627722263336182
Epoch: 11, Steps: 32 | Train Loss: 0.131 Vali Loss: 25.499 Vali Acc: 0.588 Test Loss: 25.499 Test Acc: 0.588
Validation loss decreased (-0.541674 --> -0.587531).  Saving model ...
Epoch: 12 cost time: 5.544750452041626
Epoch: 12, Steps: 32 | Train Loss: 0.382 Vali Loss: 20.726 Vali Acc: 0.511 Test Loss: 20.726 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.7984232902526855
Epoch: 13, Steps: 32 | Train Loss: 0.052 Vali Loss: 22.652 Vali Acc: 0.573 Test Loss: 22.652 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.711185932159424
Epoch: 14, Steps: 32 | Train Loss: 0.324 Vali Loss: 31.362 Vali Acc: 0.588 Test Loss: 31.362 Test Acc: 0.588
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.596832752227783
Epoch: 15, Steps: 32 | Train Loss: 0.758 Vali Loss: 23.046 Vali Acc: 0.527 Test Loss: 23.046 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.599783182144165
Epoch: 16, Steps: 32 | Train Loss: 0.125 Vali Loss: 29.041 Vali Acc: 0.527 Test Loss: 29.041 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.646708011627197
Epoch: 17, Steps: 32 | Train Loss: 1.352 Vali Loss: 31.198 Vali Acc: 0.550 Test Loss: 31.198 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.620904922485352
Epoch: 18, Steps: 32 | Train Loss: 0.929 Vali Loss: 50.747 Vali Acc: 0.458 Test Loss: 50.747 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.722275018692017
Epoch: 19, Steps: 32 | Train Loss: 2.095 Vali Loss: 43.601 Vali Acc: 0.542 Test Loss: 43.601 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.563432216644287
Epoch: 20, Steps: 32 | Train Loss: 6.635 Vali Loss: 58.616 Vali Acc: 0.580 Test Loss: 58.616 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.5363922119140625
Epoch: 21, Steps: 32 | Train Loss: 2.014 Vali Loss: 43.658 Vali Acc: 0.595 Test Loss: 43.658 Test Acc: 0.595
Validation loss decreased (-0.587531 --> -0.594983).  Saving model ...
Epoch: 22 cost time: 5.512438058853149
Epoch: 22, Steps: 32 | Train Loss: 2.817 Vali Loss: 42.979 Vali Acc: 0.466 Test Loss: 42.979 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.499436140060425
Epoch: 23, Steps: 32 | Train Loss: 1.626 Vali Loss: 44.278 Vali Acc: 0.527 Test Loss: 44.278 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 5.567745208740234
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 45.157 Vali Acc: 0.450 Test Loss: 45.157 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 5.537686109542847
Epoch: 25, Steps: 32 | Train Loss: 0.000 Vali Loss: 45.397 Vali Acc: 0.450 Test Loss: 45.397 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 5.5655529499053955
Epoch: 26, Steps: 32 | Train Loss: 0.000 Vali Loss: 45.406 Vali Acc: 0.450 Test Loss: 45.406 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 5.704132556915283
Epoch: 27, Steps: 32 | Train Loss: 0.000 Vali Loss: 45.404 Vali Acc: 0.450 Test Loss: 45.404 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 5.575937509536743
Epoch: 28, Steps: 32 | Train Loss: 0.000 Vali Loss: 45.383 Vali Acc: 0.450 Test Loss: 45.383 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 5.50597882270813
Epoch: 29, Steps: 32 | Train Loss: 0.000 Vali Loss: 45.380 Vali Acc: 0.450 Test Loss: 45.380 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 5.7497217655181885
Epoch: 30, Steps: 32 | Train Loss: 0.000 Vali Loss: 45.379 Vali Acc: 0.450 Test Loss: 45.379 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5954198473282443
model parameter : 3222789
model size : 14.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 36.64109992980957
Epoch: 1, Steps: 32 | Train Loss: 2.379 Vali Loss: 5.997 Vali Acc: 0.198 Test Loss: 5.997 Test Acc: 0.198
Validation loss decreased (inf --> -0.198413).  Saving model ...
Epoch: 2 cost time: 36.18520975112915
Epoch: 2, Steps: 32 | Train Loss: 1.910 Vali Loss: 5.087 Vali Acc: 0.328 Test Loss: 5.087 Test Acc: 0.328
Validation loss decreased (-0.198413 --> -0.328193).  Saving model ...
Epoch: 3 cost time: 35.50644397735596
Epoch: 3, Steps: 32 | Train Loss: 0.985 Vali Loss: 3.770 Vali Acc: 0.397 Test Loss: 3.770 Test Acc: 0.397
Validation loss decreased (-0.328193 --> -0.396909).  Saving model ...
Epoch: 4 cost time: 35.70649003982544
Epoch: 4, Steps: 32 | Train Loss: 0.511 Vali Loss: 6.495 Vali Acc: 0.588 Test Loss: 6.495 Test Acc: 0.588
Validation loss decreased (-0.396909 --> -0.587721).  Saving model ...
Epoch: 5 cost time: 35.690929651260376
Epoch: 5, Steps: 32 | Train Loss: 0.848 Vali Loss: 11.449 Vali Acc: 0.305 Test Loss: 11.449 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 35.444873332977295
Epoch: 6, Steps: 32 | Train Loss: 1.144 Vali Loss: 9.208 Vali Acc: 0.435 Test Loss: 9.208 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 35.47313904762268
Epoch: 7, Steps: 32 | Train Loss: 0.499 Vali Loss: 10.479 Vali Acc: 0.336 Test Loss: 10.479 Test Acc: 0.336
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 35.69245171546936
Epoch: 8, Steps: 32 | Train Loss: 0.068 Vali Loss: 8.753 Vali Acc: 0.557 Test Loss: 8.753 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 35.88914394378662
Epoch: 9, Steps: 32 | Train Loss: 0.239 Vali Loss: 15.196 Vali Acc: 0.565 Test Loss: 15.196 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 35.63756966590881
Epoch: 10, Steps: 32 | Train Loss: 0.806 Vali Loss: 12.345 Vali Acc: 0.565 Test Loss: 12.345 Test Acc: 0.565
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 35.96479797363281
Epoch: 11, Steps: 32 | Train Loss: 0.466 Vali Loss: 16.932 Vali Acc: 0.450 Test Loss: 16.932 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 35.310521841049194
Epoch: 12, Steps: 32 | Train Loss: 1.170 Vali Loss: 19.084 Vali Acc: 0.511 Test Loss: 19.084 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 35.912577629089355
Epoch: 13, Steps: 32 | Train Loss: 1.359 Vali Loss: 15.937 Vali Acc: 0.405 Test Loss: 15.937 Test Acc: 0.405
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 35.652867794036865
Epoch: 14, Steps: 32 | Train Loss: 1.285 Vali Loss: 18.998 Vali Acc: 0.412 Test Loss: 18.998 Test Acc: 0.412
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 2611525
model size : 11.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 20.887537717819214
Epoch: 1, Steps: 32 | Train Loss: 2.574 Vali Loss: 3.239 Vali Acc: 0.496 Test Loss: 3.239 Test Acc: 0.496
Validation loss decreased (inf --> -0.496151).  Saving model ...
Epoch: 2 cost time: 20.354795932769775
Epoch: 2, Steps: 32 | Train Loss: 3.403 Vali Loss: 5.335 Vali Acc: 0.244 Test Loss: 5.335 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 20.39959454536438
Epoch: 3, Steps: 32 | Train Loss: 1.698 Vali Loss: 6.468 Vali Acc: 0.435 Test Loss: 6.468 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 19.929685354232788
Epoch: 4, Steps: 32 | Train Loss: 0.488 Vali Loss: 4.655 Vali Acc: 0.580 Test Loss: 4.655 Test Acc: 0.580
Validation loss decreased (-0.496151 --> -0.580106).  Saving model ...
Epoch: 5 cost time: 20.0438232421875
Epoch: 5, Steps: 32 | Train Loss: 1.641 Vali Loss: 8.284 Vali Acc: 0.397 Test Loss: 8.284 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 19.9186110496521
Epoch: 6, Steps: 32 | Train Loss: 0.372 Vali Loss: 7.998 Vali Acc: 0.374 Test Loss: 7.998 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 19.834758758544922
Epoch: 7, Steps: 32 | Train Loss: 0.435 Vali Loss: 11.108 Vali Acc: 0.481 Test Loss: 11.108 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 19.93978476524353
Epoch: 8, Steps: 32 | Train Loss: 0.535 Vali Loss: 9.068 Vali Acc: 0.443 Test Loss: 9.068 Test Acc: 0.443
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 19.881619930267334
Epoch: 9, Steps: 32 | Train Loss: 1.364 Vali Loss: 6.865 Vali Acc: 0.550 Test Loss: 6.865 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 19.70029067993164
Epoch: 10, Steps: 32 | Train Loss: 0.565 Vali Loss: 15.789 Vali Acc: 0.397 Test Loss: 15.789 Test Acc: 0.397
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 19.654812574386597
Epoch: 11, Steps: 32 | Train Loss: 0.291 Vali Loss: 17.892 Vali Acc: 0.412 Test Loss: 17.892 Test Acc: 0.412
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 19.757453203201294
Epoch: 12, Steps: 32 | Train Loss: 0.308 Vali Loss: 20.305 Vali Acc: 0.382 Test Loss: 20.305 Test Acc: 0.382
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 19.916748046875
Epoch: 13, Steps: 32 | Train Loss: 0.206 Vali Loss: 14.788 Vali Acc: 0.374 Test Loss: 14.788 Test Acc: 0.374
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 20.170936584472656
Epoch: 14, Steps: 32 | Train Loss: 0.235 Vali Loss: 13.936 Vali Acc: 0.481 Test Loss: 13.936 Test Acc: 0.481
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 1783813
model size : 7.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 27.37556552886963
Epoch: 1, Steps: 32 | Train Loss: 2.441 Vali Loss: 6.072 Vali Acc: 0.252 Test Loss: 6.072 Test Acc: 0.252
Validation loss decreased (inf --> -0.251848).  Saving model ...
Epoch: 2 cost time: 27.104682207107544
Epoch: 2, Steps: 32 | Train Loss: 2.965 Vali Loss: 4.446 Vali Acc: 0.481 Test Loss: 4.446 Test Acc: 0.481
Validation loss decreased (-0.251848 --> -0.480872).  Saving model ...
Epoch: 3 cost time: 26.746663808822632
Epoch: 3, Steps: 32 | Train Loss: 2.469 Vali Loss: 4.342 Vali Acc: 0.420 Test Loss: 4.342 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 26.62691569328308
Epoch: 4, Steps: 32 | Train Loss: 2.030 Vali Loss: 7.846 Vali Acc: 0.305 Test Loss: 7.846 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 26.446153163909912
Epoch: 5, Steps: 32 | Train Loss: 1.542 Vali Loss: 7.733 Vali Acc: 0.435 Test Loss: 7.733 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 26.28316640853882
Epoch: 6, Steps: 32 | Train Loss: 0.413 Vali Loss: 11.893 Vali Acc: 0.282 Test Loss: 11.893 Test Acc: 0.282
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 26.593247652053833
Epoch: 7, Steps: 32 | Train Loss: 0.943 Vali Loss: 9.047 Vali Acc: 0.420 Test Loss: 9.047 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 26.560664415359497
Epoch: 8, Steps: 32 | Train Loss: 0.337 Vali Loss: 12.731 Vali Acc: 0.435 Test Loss: 12.731 Test Acc: 0.435
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 26.855731964111328
Epoch: 9, Steps: 32 | Train Loss: 0.000 Vali Loss: 8.154 Vali Acc: 0.511 Test Loss: 8.154 Test Acc: 0.511
Validation loss decreased (-0.480872 --> -0.511369).  Saving model ...
Epoch: 10 cost time: 26.529497623443604
Epoch: 10, Steps: 32 | Train Loss: 0.000 Vali Loss: 8.115 Vali Acc: 0.519 Test Loss: 8.115 Test Acc: 0.519
Validation loss decreased (-0.511369 --> -0.519003).  Saving model ...
Epoch: 11 cost time: 26.49695348739624
Epoch: 11, Steps: 32 | Train Loss: 0.000 Vali Loss: 8.135 Vali Acc: 0.511 Test Loss: 8.135 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 26.71074676513672
Epoch: 12, Steps: 32 | Train Loss: 0.000 Vali Loss: 8.120 Vali Acc: 0.527 Test Loss: 8.120 Test Acc: 0.527
Validation loss decreased (-0.519003 --> -0.526636).  Saving model ...
Epoch: 13 cost time: 26.47318720817566
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 8.113 Vali Acc: 0.527 Test Loss: 8.113 Test Acc: 0.527
Validation loss decreased (-0.526636 --> -0.526636).  Saving model ...
Epoch: 14 cost time: 26.522905826568604
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 8.111 Vali Acc: 0.511 Test Loss: 8.111 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 26.85799217224121
Epoch: 15, Steps: 32 | Train Loss: 2.537 Vali Loss: 16.063 Vali Acc: 0.511 Test Loss: 16.063 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 27.117906093597412
Epoch: 16, Steps: 32 | Train Loss: 2.966 Vali Loss: 24.483 Vali Acc: 0.336 Test Loss: 24.483 Test Acc: 0.336
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 26.47646141052246
Epoch: 17, Steps: 32 | Train Loss: 3.052 Vali Loss: 23.204 Vali Acc: 0.412 Test Loss: 23.204 Test Acc: 0.412
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 26.691532135009766
Epoch: 18, Steps: 32 | Train Loss: 2.969 Vali Loss: 42.023 Vali Acc: 0.229 Test Loss: 42.023 Test Acc: 0.229
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 26.81073570251465
Epoch: 19, Steps: 32 | Train Loss: 2.895 Vali Loss: 23.388 Vali Acc: 0.519 Test Loss: 23.388 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 26.7224862575531
Epoch: 20, Steps: 32 | Train Loss: 1.258 Vali Loss: 28.616 Vali Acc: 0.366 Test Loss: 28.616 Test Acc: 0.366
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 26.334410667419434
Epoch: 21, Steps: 32 | Train Loss: 2.034 Vali Loss: 32.553 Vali Acc: 0.359 Test Loss: 32.553 Test Acc: 0.359
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 26.389334201812744
Epoch: 22, Steps: 32 | Train Loss: 0.690 Vali Loss: 30.004 Vali Acc: 0.511 Test Loss: 30.004 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 26.481309175491333
Epoch: 23, Steps: 32 | Train Loss: 0.413 Vali Loss: 38.970 Vali Acc: 0.511 Test Loss: 38.970 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 2611525
model size : 11.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 17.14522385597229
Epoch: 1, Steps: 32 | Train Loss: 2.790 Vali Loss: 2.873 Vali Acc: 0.527 Test Loss: 2.873 Test Acc: 0.527
Validation loss decreased (inf --> -0.526689).  Saving model ...
Epoch: 2 cost time: 16.42255210876465
Epoch: 2, Steps: 32 | Train Loss: 3.817 Vali Loss: 3.868 Vali Acc: 0.458 Test Loss: 3.868 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 16.30168080329895
Epoch: 3, Steps: 32 | Train Loss: 1.910 Vali Loss: 5.263 Vali Acc: 0.466 Test Loss: 5.263 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 15.83245849609375
Epoch: 4, Steps: 32 | Train Loss: 1.318 Vali Loss: 9.287 Vali Acc: 0.351 Test Loss: 9.287 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 15.98354196548462
Epoch: 5, Steps: 32 | Train Loss: 1.522 Vali Loss: 11.621 Vali Acc: 0.336 Test Loss: 11.621 Test Acc: 0.336
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 15.606320142745972
Epoch: 6, Steps: 32 | Train Loss: 1.403 Vali Loss: 16.960 Vali Acc: 0.290 Test Loss: 16.960 Test Acc: 0.290
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 15.856417417526245
Epoch: 7, Steps: 32 | Train Loss: 0.385 Vali Loss: 7.422 Vali Acc: 0.450 Test Loss: 7.422 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 15.747981786727905
Epoch: 8, Steps: 32 | Train Loss: 0.501 Vali Loss: 8.242 Vali Acc: 0.397 Test Loss: 8.242 Test Acc: 0.397
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 15.569141626358032
Epoch: 9, Steps: 32 | Train Loss: 0.006 Vali Loss: 8.123 Vali Acc: 0.427 Test Loss: 8.123 Test Acc: 0.427
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 15.983205556869507
Epoch: 10, Steps: 32 | Train Loss: 0.089 Vali Loss: 17.401 Vali Acc: 0.550 Test Loss: 17.401 Test Acc: 0.550
Validation loss decreased (-0.526689 --> -0.549444).  Saving model ...
Epoch: 11 cost time: 16.01137089729309
Epoch: 11, Steps: 32 | Train Loss: 1.160 Vali Loss: 12.928 Vali Acc: 0.443 Test Loss: 12.928 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 16.3473117351532
Epoch: 12, Steps: 32 | Train Loss: 0.989 Vali Loss: 13.533 Vali Acc: 0.458 Test Loss: 13.533 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 16.18021869659424
Epoch: 13, Steps: 32 | Train Loss: 1.427 Vali Loss: 14.052 Vali Acc: 0.466 Test Loss: 14.052 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 16.238141536712646
Epoch: 14, Steps: 32 | Train Loss: 1.047 Vali Loss: 13.942 Vali Acc: 0.450 Test Loss: 13.942 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 16.174108505249023
Epoch: 15, Steps: 32 | Train Loss: 0.087 Vali Loss: 17.091 Vali Acc: 0.397 Test Loss: 17.091 Test Acc: 0.397
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 16.109609365463257
Epoch: 16, Steps: 32 | Train Loss: 0.569 Vali Loss: 15.761 Vali Acc: 0.405 Test Loss: 15.761 Test Acc: 0.405
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 16.046074151992798
Epoch: 17, Steps: 32 | Train Loss: 0.750 Vali Loss: 19.503 Vali Acc: 0.466 Test Loss: 19.503 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 16.14340305328369
Epoch: 18, Steps: 32 | Train Loss: 0.003 Vali Loss: 18.398 Vali Acc: 0.565 Test Loss: 18.398 Test Acc: 0.565
Validation loss decreased (-0.549444 --> -0.564702).  Saving model ...
Epoch: 19 cost time: 15.98743200302124
Epoch: 19, Steps: 32 | Train Loss: 0.069 Vali Loss: 14.186 Vali Acc: 0.534 Test Loss: 14.186 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 15.9939546585083
Epoch: 20, Steps: 32 | Train Loss: 0.250 Vali Loss: 18.819 Vali Acc: 0.573 Test Loss: 18.819 Test Acc: 0.573
Validation loss decreased (-0.564702 --> -0.572331).  Saving model ...
Epoch: 21 cost time: 15.752564907073975
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 16.898 Vali Acc: 0.588 Test Loss: 16.898 Test Acc: 0.588
Validation loss decreased (-0.572331 --> -0.587617).  Saving model ...
Epoch: 22 cost time: 16.016027212142944
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 16.847 Vali Acc: 0.588 Test Loss: 16.847 Test Acc: 0.588
Validation loss decreased (-0.587617 --> -0.587618).  Saving model ...
Epoch: 23 cost time: 16.322970867156982
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 16.845 Vali Acc: 0.588 Test Loss: 16.845 Test Acc: 0.588
Validation loss decreased (-0.587618 --> -0.587618).  Saving model ...
Epoch: 24 cost time: 16.202808380126953
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 16.845 Vali Acc: 0.588 Test Loss: 16.845 Test Acc: 0.588
Validation loss decreased (-0.587618 --> -0.587618).  Saving model ...
Epoch: 25 cost time: 16.156784296035767
Epoch: 25, Steps: 32 | Train Loss: 0.000 Vali Loss: 16.845 Vali Acc: 0.588 Test Loss: 16.845 Test Acc: 0.588
Validation loss decreased (-0.587618 --> -0.587618).  Saving model ...
Epoch: 26 cost time: 16.390663385391235
Epoch: 26, Steps: 32 | Train Loss: 0.000 Vali Loss: 16.845 Vali Acc: 0.588 Test Loss: 16.845 Test Acc: 0.588
Validation loss decreased (-0.587618 --> -0.587618).  Saving model ...
Epoch: 27 cost time: 16.14154577255249
Epoch: 27, Steps: 32 | Train Loss: 0.000 Vali Loss: 16.845 Vali Acc: 0.588 Test Loss: 16.845 Test Acc: 0.588
Validation loss decreased (-0.587618 --> -0.587618).  Saving model ...
Epoch: 28 cost time: 16.29190182685852
Epoch: 28, Steps: 32 | Train Loss: 0.000 Vali Loss: 16.755 Vali Acc: 0.588 Test Loss: 16.755 Test Acc: 0.588
Validation loss decreased (-0.587618 --> -0.587619).  Saving model ...
Epoch: 29 cost time: 15.915489196777344
Epoch: 29, Steps: 32 | Train Loss: 0.000 Vali Loss: 16.746 Vali Acc: 0.588 Test Loss: 16.746 Test Acc: 0.588
Validation loss decreased (-0.587619 --> -0.587619).  Saving model ...
Epoch: 30 cost time: 15.904195547103882
Epoch: 30, Steps: 32 | Train Loss: 0.000 Vali Loss: 16.746 Vali Acc: 0.588 Test Loss: 16.746 Test Acc: 0.588
Validation loss decreased (-0.587619 --> -0.587619).  Saving model ...
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 1783813
model size : 7.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 16.050108909606934
Epoch: 1, Steps: 32 | Train Loss: 2.431 Vali Loss: 5.979 Vali Acc: 0.313 Test Loss: 5.979 Test Acc: 0.313
Validation loss decreased (inf --> -0.312917).  Saving model ...
Epoch: 2 cost time: 15.209628820419312
Epoch: 2, Steps: 32 | Train Loss: 2.946 Vali Loss: 4.998 Vali Acc: 0.328 Test Loss: 4.998 Test Acc: 0.328
Validation loss decreased (-0.312917 --> -0.328194).  Saving model ...
Epoch: 3 cost time: 15.155526638031006
Epoch: 3, Steps: 32 | Train Loss: 1.485 Vali Loss: 3.506 Vali Acc: 0.405 Test Loss: 3.506 Test Acc: 0.405
Validation loss decreased (-0.328194 --> -0.404545).  Saving model ...
Epoch: 4 cost time: 15.77425217628479
Epoch: 4, Steps: 32 | Train Loss: 0.612 Vali Loss: 5.056 Vali Acc: 0.374 Test Loss: 5.056 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 15.594735860824585
Epoch: 5, Steps: 32 | Train Loss: 0.918 Vali Loss: 5.822 Vali Acc: 0.466 Test Loss: 5.822 Test Acc: 0.466
Validation loss decreased (-0.404545 --> -0.465591).  Saving model ...
Epoch: 6 cost time: 15.322037696838379
Epoch: 6, Steps: 32 | Train Loss: 0.351 Vali Loss: 6.637 Vali Acc: 0.573 Test Loss: 6.637 Test Acc: 0.573
Validation loss decreased (-0.465591 --> -0.572453).  Saving model ...
Epoch: 7 cost time: 16.0387122631073
Epoch: 7, Steps: 32 | Train Loss: 0.066 Vali Loss: 6.364 Vali Acc: 0.427 Test Loss: 6.364 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 17.569313526153564
Epoch: 8, Steps: 32 | Train Loss: 0.131 Vali Loss: 8.208 Vali Acc: 0.458 Test Loss: 8.208 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 17.769101858139038
Epoch: 9, Steps: 32 | Train Loss: 0.161 Vali Loss: 18.906 Vali Acc: 0.282 Test Loss: 18.906 Test Acc: 0.282
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 17.5182147026062
Epoch: 10, Steps: 32 | Train Loss: 0.184 Vali Loss: 12.971 Vali Acc: 0.481 Test Loss: 12.971 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 17.634713888168335
Epoch: 11, Steps: 32 | Train Loss: 1.533 Vali Loss: 16.019 Vali Acc: 0.336 Test Loss: 16.019 Test Acc: 0.336
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 17.246068954467773
Epoch: 12, Steps: 32 | Train Loss: 0.476 Vali Loss: 18.911 Vali Acc: 0.397 Test Loss: 18.911 Test Acc: 0.397
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 17.391488790512085
Epoch: 13, Steps: 32 | Train Loss: 1.305 Vali Loss: 22.620 Vali Acc: 0.389 Test Loss: 22.620 Test Acc: 0.389
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 17.519335985183716
Epoch: 14, Steps: 32 | Train Loss: 1.333 Vali Loss: 25.021 Vali Acc: 0.504 Test Loss: 25.021 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 17.658075094223022
Epoch: 15, Steps: 32 | Train Loss: 1.383 Vali Loss: 24.329 Vali Acc: 0.466 Test Loss: 24.329 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 17.990054845809937
Epoch: 16, Steps: 32 | Train Loss: 0.199 Vali Loss: 21.470 Vali Acc: 0.420 Test Loss: 21.470 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 2611525
model size : 11.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 13.525876760482788
Epoch: 1, Steps: 32 | Train Loss: 2.731 Vali Loss: 2.916 Vali Acc: 0.527 Test Loss: 2.916 Test Acc: 0.527
Validation loss decreased (inf --> -0.526688).  Saving model ...
Epoch: 2 cost time: 12.334719896316528
Epoch: 2, Steps: 32 | Train Loss: 3.365 Vali Loss: 3.113 Vali Acc: 0.344 Test Loss: 3.113 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.93477201461792
Epoch: 3, Steps: 32 | Train Loss: 1.490 Vali Loss: 4.171 Vali Acc: 0.473 Test Loss: 4.171 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 11.562730550765991
Epoch: 4, Steps: 32 | Train Loss: 0.549 Vali Loss: 5.158 Vali Acc: 0.366 Test Loss: 5.158 Test Acc: 0.366
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 11.633467435836792
Epoch: 5, Steps: 32 | Train Loss: 0.360 Vali Loss: 13.026 Vali Acc: 0.260 Test Loss: 13.026 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 11.093761444091797
Epoch: 6, Steps: 32 | Train Loss: 0.577 Vali Loss: 12.771 Vali Acc: 0.244 Test Loss: 12.771 Test Acc: 0.244
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 11.730456590652466
Epoch: 7, Steps: 32 | Train Loss: 0.780 Vali Loss: 6.586 Vali Acc: 0.557 Test Loss: 6.586 Test Acc: 0.557
Validation loss decreased (-0.526688 --> -0.557186).  Saving model ...
Epoch: 8 cost time: 12.40494990348816
Epoch: 8, Steps: 32 | Train Loss: 0.514 Vali Loss: 7.678 Vali Acc: 0.511 Test Loss: 7.678 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 11.982980728149414
Epoch: 9, Steps: 32 | Train Loss: 0.687 Vali Loss: 10.113 Vali Acc: 0.420 Test Loss: 10.113 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 11.988210678100586
Epoch: 10, Steps: 32 | Train Loss: 1.103 Vali Loss: 17.956 Vali Acc: 0.336 Test Loss: 17.956 Test Acc: 0.336
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 11.882675647735596
Epoch: 11, Steps: 32 | Train Loss: 0.942 Vali Loss: 15.869 Vali Acc: 0.504 Test Loss: 15.869 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 11.546872615814209
Epoch: 12, Steps: 32 | Train Loss: 0.942 Vali Loss: 11.855 Vali Acc: 0.527 Test Loss: 11.855 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 11.812231302261353
Epoch: 13, Steps: 32 | Train Loss: 0.733 Vali Loss: 20.320 Vali Acc: 0.443 Test Loss: 20.320 Test Acc: 0.443
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 11.765722751617432
Epoch: 14, Steps: 32 | Train Loss: 0.547 Vali Loss: 28.917 Vali Acc: 0.290 Test Loss: 28.917 Test Acc: 0.290
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 11.726739168167114
Epoch: 15, Steps: 32 | Train Loss: 0.434 Vali Loss: 15.031 Vali Acc: 0.435 Test Loss: 15.031 Test Acc: 0.435
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 11.584511756896973
Epoch: 16, Steps: 32 | Train Loss: 0.048 Vali Loss: 16.716 Vali Acc: 0.405 Test Loss: 16.716 Test Acc: 0.405
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 10.71297812461853
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 17.398 Vali Acc: 0.527 Test Loss: 17.398 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 1783813
model size : 7.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 21.70798349380493
Epoch: 1, Steps: 32 | Train Loss: 2.230 Vali Loss: 1.848 Vali Acc: 0.405 Test Loss: 1.848 Test Acc: 0.405
Validation loss decreased (inf --> -0.404562).  Saving model ...
Epoch: 2 cost time: 21.856021642684937
Epoch: 2, Steps: 32 | Train Loss: 0.919 Vali Loss: 6.000 Vali Acc: 0.321 Test Loss: 6.000 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 21.138956546783447
Epoch: 3, Steps: 32 | Train Loss: 1.249 Vali Loss: 8.314 Vali Acc: 0.244 Test Loss: 8.314 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 21.142570734024048
Epoch: 4, Steps: 32 | Train Loss: 1.003 Vali Loss: 8.355 Vali Acc: 0.511 Test Loss: 8.355 Test Acc: 0.511
Validation loss decreased (-0.404562 --> -0.511367).  Saving model ...
Epoch: 5 cost time: 20.785569190979004
Epoch: 5, Steps: 32 | Train Loss: 0.864 Vali Loss: 10.480 Vali Acc: 0.359 Test Loss: 10.480 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 20.269110918045044
Epoch: 6, Steps: 32 | Train Loss: 0.625 Vali Loss: 7.423 Vali Acc: 0.550 Test Loss: 7.423 Test Acc: 0.550
Validation loss decreased (-0.511367 --> -0.549544).  Saving model ...
Epoch: 7 cost time: 18.680235624313354
Epoch: 7, Steps: 32 | Train Loss: 0.216 Vali Loss: 9.178 Vali Acc: 0.450 Test Loss: 9.178 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 18.257967233657837
Epoch: 8, Steps: 32 | Train Loss: 0.428 Vali Loss: 13.395 Vali Acc: 0.359 Test Loss: 13.395 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 17.91256332397461
Epoch: 9, Steps: 32 | Train Loss: 0.708 Vali Loss: 18.247 Vali Acc: 0.321 Test Loss: 18.247 Test Acc: 0.321
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 18.904481649398804
Epoch: 10, Steps: 32 | Train Loss: 0.187 Vali Loss: 17.313 Vali Acc: 0.351 Test Loss: 17.313 Test Acc: 0.351
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 18.87678337097168
Epoch: 11, Steps: 32 | Train Loss: 0.604 Vali Loss: 15.542 Vali Acc: 0.466 Test Loss: 15.542 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 18.81438660621643
Epoch: 12, Steps: 32 | Train Loss: 0.429 Vali Loss: 15.171 Vali Acc: 0.466 Test Loss: 15.171 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 18.83060383796692
Epoch: 13, Steps: 32 | Train Loss: 1.212 Vali Loss: 18.724 Vali Acc: 0.550 Test Loss: 18.724 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 18.87378716468811
Epoch: 14, Steps: 32 | Train Loss: 0.564 Vali Loss: 20.305 Vali Acc: 0.527 Test Loss: 20.305 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 18.72782301902771
Epoch: 15, Steps: 32 | Train Loss: 0.083 Vali Loss: 14.771 Vali Acc: 0.519 Test Loss: 14.771 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 18.928791046142578
Epoch: 16, Steps: 32 | Train Loss: 0.880 Vali Loss: 22.198 Vali Acc: 0.504 Test Loss: 22.198 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 2025413
model size : 8.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 10.19593358039856
Epoch: 1, Steps: 32 | Train Loss: 3.318 Vali Loss: 2.909 Vali Acc: 0.458 Test Loss: 2.909 Test Acc: 0.458
Validation loss decreased (inf --> -0.457986).  Saving model ...
Epoch: 2 cost time: 8.997207641601562
Epoch: 2, Steps: 32 | Train Loss: 1.393 Vali Loss: 2.362 Vali Acc: 0.519 Test Loss: 2.362 Test Acc: 0.519
Validation loss decreased (-0.457986 --> -0.519060).  Saving model ...
Epoch: 3 cost time: 9.223597526550293
Epoch: 3, Steps: 32 | Train Loss: 1.772 Vali Loss: 6.254 Vali Acc: 0.496 Test Loss: 6.254 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.429882287979126
Epoch: 4, Steps: 32 | Train Loss: 1.008 Vali Loss: 5.385 Vali Acc: 0.557 Test Loss: 5.385 Test Acc: 0.557
Validation loss decreased (-0.519060 --> -0.557198).  Saving model ...
Epoch: 5 cost time: 9.21049427986145
Epoch: 5, Steps: 32 | Train Loss: 0.465 Vali Loss: 9.243 Vali Acc: 0.534 Test Loss: 9.243 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.441388845443726
Epoch: 6, Steps: 32 | Train Loss: 0.497 Vali Loss: 5.290 Vali Acc: 0.511 Test Loss: 5.290 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 9.1034836769104
Epoch: 7, Steps: 32 | Train Loss: 0.528 Vali Loss: 10.469 Vali Acc: 0.550 Test Loss: 10.469 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 9.288966417312622
Epoch: 8, Steps: 32 | Train Loss: 0.399 Vali Loss: 8.579 Vali Acc: 0.565 Test Loss: 8.579 Test Acc: 0.565
Validation loss decreased (-0.557198 --> -0.564800).  Saving model ...
Epoch: 9 cost time: 9.253151178359985
Epoch: 9, Steps: 32 | Train Loss: 0.078 Vali Loss: 5.298 Vali Acc: 0.542 Test Loss: 5.298 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 9.391406536102295
Epoch: 10, Steps: 32 | Train Loss: 0.722 Vali Loss: 9.914 Vali Acc: 0.527 Test Loss: 9.914 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 9.360691785812378
Epoch: 11, Steps: 32 | Train Loss: 0.106 Vali Loss: 15.997 Vali Acc: 0.313 Test Loss: 15.997 Test Acc: 0.313
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 9.426401615142822
Epoch: 12, Steps: 32 | Train Loss: 1.507 Vali Loss: 17.408 Vali Acc: 0.496 Test Loss: 17.408 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 9.289761781692505
Epoch: 13, Steps: 32 | Train Loss: 1.278 Vali Loss: 16.721 Vali Acc: 0.496 Test Loss: 16.721 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 9.214829683303833
Epoch: 14, Steps: 32 | Train Loss: 0.236 Vali Loss: 14.422 Vali Acc: 0.466 Test Loss: 14.422 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 8.799370765686035
Epoch: 15, Steps: 32 | Train Loss: 0.679 Vali Loss: 18.892 Vali Acc: 0.519 Test Loss: 18.892 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 9.332872867584229
Epoch: 16, Steps: 32 | Train Loss: 0.980 Vali Loss: 23.398 Vali Acc: 0.336 Test Loss: 23.398 Test Acc: 0.336
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 9.342252254486084
Epoch: 17, Steps: 32 | Train Loss: 4.740 Vali Loss: 30.605 Vali Acc: 0.557 Test Loss: 30.605 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 9.374820470809937
Epoch: 18, Steps: 32 | Train Loss: 0.175 Vali Loss: 33.177 Vali Acc: 0.550 Test Loss: 33.177 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 1611525
model size : 7.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 14.266232013702393
Epoch: 1, Steps: 32 | Train Loss: 2.260 Vali Loss: 1.824 Vali Acc: 0.336 Test Loss: 1.824 Test Acc: 0.336
Validation loss decreased (inf --> -0.335860).  Saving model ...
Epoch: 2 cost time: 13.325937986373901
Epoch: 2, Steps: 32 | Train Loss: 0.717 Vali Loss: 1.826 Vali Acc: 0.580 Test Loss: 1.826 Test Acc: 0.580
Validation loss decreased (-0.335860 --> -0.580134).  Saving model ...
Epoch: 3 cost time: 13.646706104278564
Epoch: 3, Steps: 32 | Train Loss: 0.514 Vali Loss: 8.607 Vali Acc: 0.198 Test Loss: 8.607 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 13.671480894088745
Epoch: 4, Steps: 32 | Train Loss: 0.217 Vali Loss: 5.914 Vali Acc: 0.443 Test Loss: 5.914 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 13.572160720825195
Epoch: 5, Steps: 32 | Train Loss: 1.165 Vali Loss: 8.553 Vali Acc: 0.443 Test Loss: 8.553 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 13.07339334487915
Epoch: 6, Steps: 32 | Train Loss: 1.794 Vali Loss: 14.761 Vali Acc: 0.260 Test Loss: 14.761 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 13.148478746414185
Epoch: 7, Steps: 32 | Train Loss: 1.392 Vali Loss: 11.828 Vali Acc: 0.389 Test Loss: 11.828 Test Acc: 0.389
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 13.267000436782837
Epoch: 8, Steps: 32 | Train Loss: 0.588 Vali Loss: 16.647 Vali Acc: 0.511 Test Loss: 16.647 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 13.366891622543335
Epoch: 9, Steps: 32 | Train Loss: 0.586 Vali Loss: 16.116 Vali Acc: 0.496 Test Loss: 16.116 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 13.236229181289673
Epoch: 10, Steps: 32 | Train Loss: 0.418 Vali Loss: 12.723 Vali Acc: 0.359 Test Loss: 12.723 Test Acc: 0.359
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 12.984258651733398
Epoch: 11, Steps: 32 | Train Loss: 0.608 Vali Loss: 14.000 Vali Acc: 0.557 Test Loss: 14.000 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 12.42842435836792
Epoch: 12, Steps: 32 | Train Loss: 0.339 Vali Loss: 13.283 Vali Acc: 0.450 Test Loss: 13.283 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 2025413
model size : 8.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 8.181893587112427
Epoch: 1, Steps: 32 | Train Loss: 3.318 Vali Loss: 2.928 Vali Acc: 0.443 Test Loss: 2.928 Test Acc: 0.443
Validation loss decreased (inf --> -0.442719).  Saving model ...
Epoch: 2 cost time: 6.734650135040283
Epoch: 2, Steps: 32 | Train Loss: 1.129 Vali Loss: 3.404 Vali Acc: 0.191 Test Loss: 3.404 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.841736316680908
Epoch: 3, Steps: 32 | Train Loss: 1.145 Vali Loss: 3.306 Vali Acc: 0.573 Test Loss: 3.306 Test Acc: 0.573
Validation loss decreased (-0.442719 --> -0.572486).  Saving model ...
Epoch: 4 cost time: 6.763692617416382
Epoch: 4, Steps: 32 | Train Loss: 1.270 Vali Loss: 4.408 Vali Acc: 0.504 Test Loss: 4.408 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.931514739990234
Epoch: 5, Steps: 32 | Train Loss: 0.224 Vali Loss: 4.854 Vali Acc: 0.466 Test Loss: 4.854 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.977538585662842
Epoch: 6, Steps: 32 | Train Loss: 1.748 Vali Loss: 9.347 Vali Acc: 0.328 Test Loss: 9.347 Test Acc: 0.328
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.780102491378784
Epoch: 7, Steps: 32 | Train Loss: 0.170 Vali Loss: 9.382 Vali Acc: 0.412 Test Loss: 9.382 Test Acc: 0.412
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 6.720777273178101
Epoch: 8, Steps: 32 | Train Loss: 0.445 Vali Loss: 11.511 Vali Acc: 0.511 Test Loss: 11.511 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 6.898676156997681
Epoch: 9, Steps: 32 | Train Loss: 1.311 Vali Loss: 10.795 Vali Acc: 0.504 Test Loss: 10.795 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 6.861534118652344
Epoch: 10, Steps: 32 | Train Loss: 0.662 Vali Loss: 8.674 Vali Acc: 0.534 Test Loss: 8.674 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 6.78734278678894
Epoch: 11, Steps: 32 | Train Loss: 0.696 Vali Loss: 8.942 Vali Acc: 0.565 Test Loss: 8.942 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 6.78466010093689
Epoch: 12, Steps: 32 | Train Loss: 0.200 Vali Loss: 9.932 Vali Acc: 0.595 Test Loss: 9.932 Test Acc: 0.595
Validation loss decreased (-0.572486 --> -0.595321).  Saving model ...
Epoch: 13 cost time: 6.696488618850708
Epoch: 13, Steps: 32 | Train Loss: 0.309 Vali Loss: 19.776 Vali Acc: 0.603 Test Loss: 19.776 Test Acc: 0.603
Validation loss decreased (-0.595321 --> -0.602856).  Saving model ...
Epoch: 14 cost time: 6.807586669921875
Epoch: 14, Steps: 32 | Train Loss: 0.287 Vali Loss: 12.090 Vali Acc: 0.550 Test Loss: 12.090 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.925884008407593
Epoch: 15, Steps: 32 | Train Loss: 0.135 Vali Loss: 15.442 Vali Acc: 0.550 Test Loss: 15.442 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.768156290054321
Epoch: 16, Steps: 32 | Train Loss: 0.009 Vali Loss: 21.056 Vali Acc: 0.565 Test Loss: 21.056 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 6.846229791641235
Epoch: 17, Steps: 32 | Train Loss: 1.569 Vali Loss: 14.391 Vali Acc: 0.542 Test Loss: 14.391 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.752718210220337
Epoch: 18, Steps: 32 | Train Loss: 0.671 Vali Loss: 24.234 Vali Acc: 0.450 Test Loss: 24.234 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 6.899333477020264
Epoch: 19, Steps: 32 | Train Loss: 0.245 Vali Loss: 23.204 Vali Acc: 0.519 Test Loss: 23.204 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 6.8276543617248535
Epoch: 20, Steps: 32 | Train Loss: 0.746 Vali Loss: 28.724 Vali Acc: 0.374 Test Loss: 28.724 Test Acc: 0.374
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 6.579599142074585
Epoch: 21, Steps: 32 | Train Loss: 0.855 Vali Loss: 24.056 Vali Acc: 0.366 Test Loss: 24.056 Test Acc: 0.366
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 6.532186508178711
Epoch: 22, Steps: 32 | Train Loss: 1.760 Vali Loss: 33.248 Vali Acc: 0.420 Test Loss: 33.248 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 6.901238203048706
Epoch: 23, Steps: 32 | Train Loss: 0.933 Vali Loss: 19.450 Vali Acc: 0.573 Test Loss: 19.450 Test Acc: 0.573
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6030534351145038
model parameter : 1611525
model size : 7.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 8.046351194381714
Epoch: 1, Steps: 32 | Train Loss: 2.251 Vali Loss: 1.862 Vali Acc: 0.344 Test Loss: 1.862 Test Acc: 0.344
Validation loss decreased (inf --> -0.343493).  Saving model ...
Epoch: 2 cost time: 6.825000047683716
Epoch: 2, Steps: 32 | Train Loss: 0.745 Vali Loss: 1.821 Vali Acc: 0.511 Test Loss: 1.821 Test Acc: 0.511
Validation loss decreased (-0.343493 --> -0.511432).  Saving model ...
Epoch: 3 cost time: 7.119213342666626
Epoch: 3, Steps: 32 | Train Loss: 1.554 Vali Loss: 5.223 Vali Acc: 0.481 Test Loss: 5.223 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.835508108139038
Epoch: 4, Steps: 32 | Train Loss: 1.101 Vali Loss: 8.958 Vali Acc: 0.519 Test Loss: 8.958 Test Acc: 0.519
Validation loss decreased (-0.511432 --> -0.518994).  Saving model ...
Epoch: 5 cost time: 6.77864670753479
Epoch: 5, Steps: 32 | Train Loss: 0.583 Vali Loss: 8.340 Vali Acc: 0.511 Test Loss: 8.340 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.914474725723267
Epoch: 6, Steps: 32 | Train Loss: 0.532 Vali Loss: 11.887 Vali Acc: 0.267 Test Loss: 11.887 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.818036794662476
Epoch: 7, Steps: 32 | Train Loss: 0.512 Vali Loss: 10.346 Vali Acc: 0.481 Test Loss: 10.346 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.68236780166626
Epoch: 8, Steps: 32 | Train Loss: 0.170 Vali Loss: 10.940 Vali Acc: 0.565 Test Loss: 10.940 Test Acc: 0.565
Validation loss decreased (-0.518994 --> -0.564776).  Saving model ...
Epoch: 9 cost time: 7.032451868057251
Epoch: 9, Steps: 32 | Train Loss: 0.340 Vali Loss: 9.482 Vali Acc: 0.542 Test Loss: 9.482 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.765791177749634
Epoch: 10, Steps: 32 | Train Loss: 0.332 Vali Loss: 19.496 Vali Acc: 0.427 Test Loss: 19.496 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.851142883300781
Epoch: 11, Steps: 32 | Train Loss: 0.344 Vali Loss: 18.731 Vali Acc: 0.313 Test Loss: 18.731 Test Acc: 0.313
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.639262914657593
Epoch: 12, Steps: 32 | Train Loss: 0.831 Vali Loss: 25.245 Vali Acc: 0.282 Test Loss: 25.245 Test Acc: 0.282
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.7042670249938965
Epoch: 13, Steps: 32 | Train Loss: 1.484 Vali Loss: 21.572 Vali Acc: 0.344 Test Loss: 21.572 Test Acc: 0.344
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.7241973876953125
Epoch: 14, Steps: 32 | Train Loss: 1.128 Vali Loss: 17.030 Vali Acc: 0.511 Test Loss: 17.030 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 6.881065368652344
Epoch: 15, Steps: 32 | Train Loss: 0.526 Vali Loss: 12.477 Vali Acc: 0.534 Test Loss: 12.477 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 6.791420221328735
Epoch: 16, Steps: 32 | Train Loss: 0.806 Vali Loss: 16.219 Vali Acc: 0.466 Test Loss: 16.219 Test Acc: 0.466
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 6.8629090785980225
Epoch: 17, Steps: 32 | Train Loss: 1.169 Vali Loss: 30.030 Vali Acc: 0.527 Test Loss: 30.030 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 6.59846043586731
Epoch: 18, Steps: 32 | Train Loss: 0.162 Vali Loss: 27.564 Vali Acc: 0.420 Test Loss: 27.564 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 2025413
model size : 8.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.35919451713562
Epoch: 1, Steps: 32 | Train Loss: 3.144 Vali Loss: 2.969 Vali Acc: 0.435 Test Loss: 2.969 Test Acc: 0.435
Validation loss decreased (inf --> -0.435085).  Saving model ...
Epoch: 2 cost time: 4.196513891220093
Epoch: 2, Steps: 32 | Train Loss: 1.560 Vali Loss: 5.134 Vali Acc: 0.496 Test Loss: 5.134 Test Acc: 0.496
Validation loss decreased (-0.435085 --> -0.496132).  Saving model ...
Epoch: 3 cost time: 4.179095506668091
Epoch: 3, Steps: 32 | Train Loss: 2.205 Vali Loss: 3.663 Vali Acc: 0.519 Test Loss: 3.663 Test Acc: 0.519
Validation loss decreased (-0.496132 --> -0.519047).  Saving model ...
Epoch: 4 cost time: 4.2353808879852295
Epoch: 4, Steps: 32 | Train Loss: 1.499 Vali Loss: 5.325 Vali Acc: 0.519 Test Loss: 5.325 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.124428033828735
Epoch: 5, Steps: 32 | Train Loss: 0.652 Vali Loss: 5.096 Vali Acc: 0.557 Test Loss: 5.096 Test Acc: 0.557
Validation loss decreased (-0.519047 --> -0.557201).  Saving model ...
Epoch: 6 cost time: 4.268430948257446
Epoch: 6, Steps: 32 | Train Loss: 0.140 Vali Loss: 7.737 Vali Acc: 0.557 Test Loss: 7.737 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.105675220489502
Epoch: 7, Steps: 32 | Train Loss: 0.452 Vali Loss: 8.487 Vali Acc: 0.511 Test Loss: 8.487 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.2305426597595215
Epoch: 8, Steps: 32 | Train Loss: 0.820 Vali Loss: 9.559 Vali Acc: 0.481 Test Loss: 9.559 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.263906240463257
Epoch: 9, Steps: 32 | Train Loss: 0.714 Vali Loss: 13.241 Vali Acc: 0.519 Test Loss: 13.241 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.222680330276489
Epoch: 10, Steps: 32 | Train Loss: 1.163 Vali Loss: 22.221 Vali Acc: 0.412 Test Loss: 22.221 Test Acc: 0.412
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.219472169876099
Epoch: 11, Steps: 32 | Train Loss: 1.254 Vali Loss: 13.467 Vali Acc: 0.580 Test Loss: 13.467 Test Acc: 0.580
Validation loss decreased (-0.557201 --> -0.580018).  Saving model ...
Epoch: 12 cost time: 4.230561971664429
Epoch: 12, Steps: 32 | Train Loss: 1.006 Vali Loss: 15.348 Vali Acc: 0.573 Test Loss: 15.348 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.127671480178833
Epoch: 13, Steps: 32 | Train Loss: 0.361 Vali Loss: 12.541 Vali Acc: 0.519 Test Loss: 12.541 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.084252119064331
Epoch: 14, Steps: 32 | Train Loss: 0.173 Vali Loss: 15.664 Vali Acc: 0.588 Test Loss: 15.664 Test Acc: 0.588
Validation loss decreased (-0.580018 --> -0.587630).  Saving model ...
Epoch: 15 cost time: 3.9338457584381104
Epoch: 15, Steps: 32 | Train Loss: 0.290 Vali Loss: 18.902 Vali Acc: 0.565 Test Loss: 18.902 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.385190725326538
Epoch: 16, Steps: 32 | Train Loss: 0.319 Vali Loss: 15.997 Vali Acc: 0.534 Test Loss: 15.997 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.355438232421875
Epoch: 17, Steps: 32 | Train Loss: 0.116 Vali Loss: 18.057 Vali Acc: 0.573 Test Loss: 18.057 Test Acc: 0.573
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.362102270126343
Epoch: 18, Steps: 32 | Train Loss: 0.124 Vali Loss: 14.137 Vali Acc: 0.573 Test Loss: 14.137 Test Acc: 0.573
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.314694404602051
Epoch: 19, Steps: 32 | Train Loss: 0.154 Vali Loss: 14.994 Vali Acc: 0.557 Test Loss: 14.994 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.2227208614349365
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 23.017 Vali Acc: 0.557 Test Loss: 23.017 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.201345443725586
Epoch: 21, Steps: 32 | Train Loss: 0.021 Vali Loss: 22.669 Vali Acc: 0.542 Test Loss: 22.669 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.157680511474609
Epoch: 22, Steps: 32 | Train Loss: 3.066 Vali Loss: 18.177 Vali Acc: 0.550 Test Loss: 18.177 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.454751491546631
Epoch: 23, Steps: 32 | Train Loss: 2.340 Vali Loss: 18.760 Vali Acc: 0.550 Test Loss: 18.760 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 4.3376452922821045
Epoch: 24, Steps: 32 | Train Loss: 0.015 Vali Loss: 18.985 Vali Acc: 0.466 Test Loss: 18.985 Test Acc: 0.466
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 1611525
model size : 7.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 12.801751375198364
Epoch: 1, Steps: 32 | Train Loss: 2.433 Vali Loss: 3.120 Vali Acc: 0.214 Test Loss: 3.120 Test Acc: 0.214
Validation loss decreased (inf --> -0.213709).  Saving model ...
Epoch: 2 cost time: 12.455430746078491
Epoch: 2, Steps: 32 | Train Loss: 1.561 Vali Loss: 4.061 Vali Acc: 0.275 Test Loss: 4.061 Test Acc: 0.275
Validation loss decreased (-0.213709 --> -0.274769).  Saving model ...
Epoch: 3 cost time: 12.628703355789185
Epoch: 3, Steps: 32 | Train Loss: 1.319 Vali Loss: 4.367 Vali Acc: 0.298 Test Loss: 4.367 Test Acc: 0.298
Validation loss decreased (-0.274769 --> -0.297666).  Saving model ...
Epoch: 4 cost time: 12.322388172149658
Epoch: 4, Steps: 32 | Train Loss: 0.743 Vali Loss: 5.731 Vali Acc: 0.527 Test Loss: 5.731 Test Acc: 0.527
Validation loss decreased (-0.297666 --> -0.526660).  Saving model ...
Epoch: 5 cost time: 12.001232385635376
Epoch: 5, Steps: 32 | Train Loss: 1.212 Vali Loss: 5.013 Vali Acc: 0.473 Test Loss: 5.013 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 12.390733003616333
Epoch: 6, Steps: 32 | Train Loss: 0.651 Vali Loss: 8.449 Vali Acc: 0.374 Test Loss: 8.449 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 12.40410566329956
Epoch: 7, Steps: 32 | Train Loss: 1.579 Vali Loss: 13.008 Vali Acc: 0.328 Test Loss: 13.008 Test Acc: 0.328
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 12.180491209030151
Epoch: 8, Steps: 32 | Train Loss: 0.386 Vali Loss: 9.213 Vali Acc: 0.427 Test Loss: 9.213 Test Acc: 0.427
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 12.35725450515747
Epoch: 9, Steps: 32 | Train Loss: 0.014 Vali Loss: 21.148 Vali Acc: 0.290 Test Loss: 21.148 Test Acc: 0.290
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 12.440670728683472
Epoch: 10, Steps: 32 | Train Loss: 0.840 Vali Loss: 12.001 Vali Acc: 0.313 Test Loss: 12.001 Test Acc: 0.313
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 12.249996662139893
Epoch: 11, Steps: 32 | Train Loss: 0.353 Vali Loss: 14.470 Vali Acc: 0.382 Test Loss: 14.470 Test Acc: 0.382
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 12.376385927200317
Epoch: 12, Steps: 32 | Train Loss: 1.493 Vali Loss: 24.072 Vali Acc: 0.206 Test Loss: 24.072 Test Acc: 0.206
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 11.940838098526001
Epoch: 13, Steps: 32 | Train Loss: 0.579 Vali Loss: 25.333 Vali Acc: 0.336 Test Loss: 25.333 Test Acc: 0.336
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 12.351937294006348
Epoch: 14, Steps: 32 | Train Loss: 0.512 Vali Loss: 17.910 Vali Acc: 0.496 Test Loss: 17.910 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 1732357
model size : 7.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 7.268099069595337
Epoch: 1, Steps: 32 | Train Loss: 3.005 Vali Loss: 1.722 Vali Acc: 0.443 Test Loss: 1.722 Test Acc: 0.443
Validation loss decreased (inf --> -0.442731).  Saving model ...
Epoch: 2 cost time: 5.776099443435669
Epoch: 2, Steps: 32 | Train Loss: 1.578 Vali Loss: 4.189 Vali Acc: 0.244 Test Loss: 4.189 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.845058917999268
Epoch: 3, Steps: 32 | Train Loss: 2.063 Vali Loss: 3.501 Vali Acc: 0.550 Test Loss: 3.501 Test Acc: 0.550
Validation loss decreased (-0.442731 --> -0.549583).  Saving model ...
Epoch: 4 cost time: 5.6145617961883545
Epoch: 4, Steps: 32 | Train Loss: 1.267 Vali Loss: 3.587 Vali Acc: 0.611 Test Loss: 3.587 Test Acc: 0.611
Validation loss decreased (-0.549583 --> -0.610651).  Saving model ...
Epoch: 5 cost time: 5.9033331871032715
Epoch: 5, Steps: 32 | Train Loss: 0.561 Vali Loss: 7.192 Vali Acc: 0.344 Test Loss: 7.192 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.122588157653809
Epoch: 6, Steps: 32 | Train Loss: 0.645 Vali Loss: 5.350 Vali Acc: 0.527 Test Loss: 5.350 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.957585096359253
Epoch: 7, Steps: 32 | Train Loss: 0.431 Vali Loss: 9.059 Vali Acc: 0.534 Test Loss: 9.059 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.831213474273682
Epoch: 8, Steps: 32 | Train Loss: 0.871 Vali Loss: 11.867 Vali Acc: 0.351 Test Loss: 11.867 Test Acc: 0.351
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.9675867557525635
Epoch: 9, Steps: 32 | Train Loss: 1.795 Vali Loss: 13.110 Vali Acc: 0.542 Test Loss: 13.110 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 6.01397967338562
Epoch: 10, Steps: 32 | Train Loss: 0.157 Vali Loss: 11.676 Vali Acc: 0.450 Test Loss: 11.676 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.954135417938232
Epoch: 11, Steps: 32 | Train Loss: 0.316 Vali Loss: 12.482 Vali Acc: 0.504 Test Loss: 12.482 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.899138927459717
Epoch: 12, Steps: 32 | Train Loss: 0.092 Vali Loss: 11.189 Vali Acc: 0.458 Test Loss: 11.189 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.973074197769165
Epoch: 13, Steps: 32 | Train Loss: 0.722 Vali Loss: 17.597 Vali Acc: 0.412 Test Loss: 17.597 Test Acc: 0.412
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 5.989591360092163
Epoch: 14, Steps: 32 | Train Loss: 0.822 Vali Loss: 16.372 Vali Acc: 0.603 Test Loss: 16.372 Test Acc: 0.603
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6106870229007634
model parameter : 1525381
model size : 6.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 9.17106580734253
Epoch: 1, Steps: 32 | Train Loss: 2.380 Vali Loss: 2.573 Vali Acc: 0.267 Test Loss: 2.573 Test Acc: 0.267
Validation loss decreased (inf --> -0.267150).  Saving model ...
Epoch: 2 cost time: 8.170061111450195
Epoch: 2, Steps: 32 | Train Loss: 1.468 Vali Loss: 3.448 Vali Acc: 0.267 Test Loss: 3.448 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.403740406036377
Epoch: 3, Steps: 32 | Train Loss: 2.024 Vali Loss: 5.344 Vali Acc: 0.542 Test Loss: 5.344 Test Acc: 0.542
Validation loss decreased (-0.267150 --> -0.541931).  Saving model ...
Epoch: 4 cost time: 8.480623960494995
Epoch: 4, Steps: 32 | Train Loss: 0.856 Vali Loss: 7.392 Vali Acc: 0.542 Test Loss: 7.392 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.52211880683899
Epoch: 5, Steps: 32 | Train Loss: 1.440 Vali Loss: 6.165 Vali Acc: 0.550 Test Loss: 6.165 Test Acc: 0.550
Validation loss decreased (-0.541931 --> -0.549557).  Saving model ...
Epoch: 6 cost time: 8.538191795349121
Epoch: 6, Steps: 32 | Train Loss: 0.637 Vali Loss: 11.391 Vali Acc: 0.481 Test Loss: 11.391 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.453583240509033
Epoch: 7, Steps: 32 | Train Loss: 0.412 Vali Loss: 12.679 Vali Acc: 0.458 Test Loss: 12.679 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 8.277706623077393
Epoch: 8, Steps: 32 | Train Loss: 0.262 Vali Loss: 15.877 Vali Acc: 0.305 Test Loss: 15.877 Test Acc: 0.305
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 8.037749290466309
Epoch: 9, Steps: 32 | Train Loss: 1.415 Vali Loss: 17.845 Vali Acc: 0.305 Test Loss: 17.845 Test Acc: 0.305
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 8.256093263626099
Epoch: 10, Steps: 32 | Train Loss: 1.707 Vali Loss: 19.258 Vali Acc: 0.351 Test Loss: 19.258 Test Acc: 0.351
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 8.445497274398804
Epoch: 11, Steps: 32 | Train Loss: 0.887 Vali Loss: 13.753 Vali Acc: 0.412 Test Loss: 13.753 Test Acc: 0.412
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 8.600764751434326
Epoch: 12, Steps: 32 | Train Loss: 0.000 Vali Loss: 14.065 Vali Acc: 0.511 Test Loss: 14.065 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 8.544101476669312
Epoch: 13, Steps: 32 | Train Loss: 0.375 Vali Loss: 23.525 Vali Acc: 0.267 Test Loss: 23.525 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 8.304998397827148
Epoch: 14, Steps: 32 | Train Loss: 0.644 Vali Loss: 19.714 Vali Acc: 0.473 Test Loss: 19.714 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 8.516034126281738
Epoch: 15, Steps: 32 | Train Loss: 1.591 Vali Loss: 19.159 Vali Acc: 0.359 Test Loss: 19.159 Test Acc: 0.359
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 1732357
model size : 7.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.775181531906128
Epoch: 1, Steps: 32 | Train Loss: 3.038 Vali Loss: 1.789 Vali Acc: 0.374 Test Loss: 1.789 Test Acc: 0.374
Validation loss decreased (inf --> -0.374028).  Saving model ...
Epoch: 2 cost time: 4.438620328903198
Epoch: 2, Steps: 32 | Train Loss: 1.612 Vali Loss: 7.599 Vali Acc: 0.198 Test Loss: 7.599 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.443785905838013
Epoch: 3, Steps: 32 | Train Loss: 1.912 Vali Loss: 7.105 Vali Acc: 0.427 Test Loss: 7.105 Test Acc: 0.427
Validation loss decreased (-0.374028 --> -0.427410).  Saving model ...
Epoch: 4 cost time: 4.40426230430603
Epoch: 4, Steps: 32 | Train Loss: 1.192 Vali Loss: 6.207 Vali Acc: 0.443 Test Loss: 6.207 Test Acc: 0.443
Validation loss decreased (-0.427410 --> -0.442686).  Saving model ...
Epoch: 5 cost time: 4.475123882293701
Epoch: 5, Steps: 32 | Train Loss: 0.928 Vali Loss: 8.954 Vali Acc: 0.534 Test Loss: 8.954 Test Acc: 0.534
Validation loss decreased (-0.442686 --> -0.534262).  Saving model ...
Epoch: 6 cost time: 4.553952932357788
Epoch: 6, Steps: 32 | Train Loss: 1.051 Vali Loss: 10.329 Vali Acc: 0.374 Test Loss: 10.329 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.503616094589233
Epoch: 7, Steps: 32 | Train Loss: 0.407 Vali Loss: 17.926 Vali Acc: 0.221 Test Loss: 17.926 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.472566843032837
Epoch: 8, Steps: 32 | Train Loss: 0.458 Vali Loss: 8.018 Vali Acc: 0.382 Test Loss: 8.018 Test Acc: 0.382
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.256935119628906
Epoch: 9, Steps: 32 | Train Loss: 0.063 Vali Loss: 19.342 Vali Acc: 0.282 Test Loss: 19.342 Test Acc: 0.282
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.509636640548706
Epoch: 10, Steps: 32 | Train Loss: 0.902 Vali Loss: 23.797 Vali Acc: 0.389 Test Loss: 23.797 Test Acc: 0.389
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.562572002410889
Epoch: 11, Steps: 32 | Train Loss: 1.677 Vali Loss: 16.710 Vali Acc: 0.344 Test Loss: 16.710 Test Acc: 0.344
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.511668920516968
Epoch: 12, Steps: 32 | Train Loss: 2.142 Vali Loss: 16.350 Vali Acc: 0.557 Test Loss: 16.350 Test Acc: 0.557
Validation loss decreased (-0.534262 --> -0.557088).  Saving model ...
Epoch: 13 cost time: 4.499181747436523
Epoch: 13, Steps: 32 | Train Loss: 0.648 Vali Loss: 14.482 Vali Acc: 0.527 Test Loss: 14.482 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.59322714805603
Epoch: 14, Steps: 32 | Train Loss: 0.140 Vali Loss: 36.294 Vali Acc: 0.504 Test Loss: 36.294 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.497083902359009
Epoch: 15, Steps: 32 | Train Loss: 2.941 Vali Loss: 15.229 Vali Acc: 0.557 Test Loss: 15.229 Test Acc: 0.557
Validation loss decreased (-0.557088 --> -0.557100).  Saving model ...
Epoch: 16 cost time: 4.533386707305908
Epoch: 16, Steps: 32 | Train Loss: 0.462 Vali Loss: 22.966 Vali Acc: 0.366 Test Loss: 22.966 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.548926115036011
Epoch: 17, Steps: 32 | Train Loss: 0.270 Vali Loss: 21.582 Vali Acc: 0.557 Test Loss: 21.582 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.423128366470337
Epoch: 18, Steps: 32 | Train Loss: 0.470 Vali Loss: 25.038 Vali Acc: 0.504 Test Loss: 25.038 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.362698793411255
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 21.079 Vali Acc: 0.420 Test Loss: 21.079 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.557395935058594
Epoch: 20, Steps: 32 | Train Loss: 0.135 Vali Loss: 16.787 Vali Acc: 0.519 Test Loss: 16.787 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.5264668464660645
Epoch: 21, Steps: 32 | Train Loss: 0.444 Vali Loss: 19.708 Vali Acc: 0.557 Test Loss: 19.708 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.510940313339233
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 17.101 Vali Acc: 0.519 Test Loss: 17.101 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.604468107223511
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 17.199 Vali Acc: 0.519 Test Loss: 17.199 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.475935697555542
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 17.202 Vali Acc: 0.519 Test Loss: 17.202 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 4.485875129699707
Epoch: 25, Steps: 32 | Train Loss: 0.000 Vali Loss: 17.202 Vali Acc: 0.519 Test Loss: 17.202 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 1525381
model size : 6.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.547036170959473
Epoch: 1, Steps: 32 | Train Loss: 2.385 Vali Loss: 2.614 Vali Acc: 0.252 Test Loss: 2.614 Test Acc: 0.252
Validation loss decreased (inf --> -0.251882).  Saving model ...
Epoch: 2 cost time: 4.4149439334869385
Epoch: 2, Steps: 32 | Train Loss: 1.475 Vali Loss: 3.365 Vali Acc: 0.321 Test Loss: 3.365 Test Acc: 0.321
Validation loss decreased (-0.251882 --> -0.320577).  Saving model ...
Epoch: 3 cost time: 4.508275270462036
Epoch: 3, Steps: 32 | Train Loss: 1.981 Vali Loss: 8.357 Vali Acc: 0.214 Test Loss: 8.357 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.423985481262207
Epoch: 4, Steps: 32 | Train Loss: 0.445 Vali Loss: 7.940 Vali Acc: 0.603 Test Loss: 7.940 Test Acc: 0.603
Validation loss decreased (-0.320577 --> -0.602974).  Saving model ...
Epoch: 5 cost time: 4.38112473487854
Epoch: 5, Steps: 32 | Train Loss: 1.609 Vali Loss: 5.544 Vali Acc: 0.519 Test Loss: 5.544 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.4344642162323
Epoch: 6, Steps: 32 | Train Loss: 0.737 Vali Loss: 13.998 Vali Acc: 0.305 Test Loss: 13.998 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.576826333999634
Epoch: 7, Steps: 32 | Train Loss: 0.253 Vali Loss: 9.442 Vali Acc: 0.504 Test Loss: 9.442 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.739330291748047
Epoch: 8, Steps: 32 | Train Loss: 1.288 Vali Loss: 24.541 Vali Acc: 0.267 Test Loss: 24.541 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.4460132122039795
Epoch: 9, Steps: 32 | Train Loss: 3.650 Vali Loss: 21.121 Vali Acc: 0.321 Test Loss: 21.121 Test Acc: 0.321
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.424706697463989
Epoch: 10, Steps: 32 | Train Loss: 1.528 Vali Loss: 27.142 Vali Acc: 0.305 Test Loss: 27.142 Test Acc: 0.305
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.431930303573608
Epoch: 11, Steps: 32 | Train Loss: 0.281 Vali Loss: 22.480 Vali Acc: 0.389 Test Loss: 22.480 Test Acc: 0.389
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.506897211074829
Epoch: 12, Steps: 32 | Train Loss: 0.466 Vali Loss: 32.000 Vali Acc: 0.237 Test Loss: 32.000 Test Acc: 0.237
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.567990779876709
Epoch: 13, Steps: 32 | Train Loss: 0.452 Vali Loss: 16.377 Vali Acc: 0.504 Test Loss: 16.377 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.475161790847778
Epoch: 14, Steps: 32 | Train Loss: 0.283 Vali Loss: 12.595 Vali Acc: 0.519 Test Loss: 12.595 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6030534351145038
model parameter : 1732357
model size : 7.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.951599597930908
Epoch: 1, Steps: 32 | Train Loss: 3.018 Vali Loss: 1.675 Vali Acc: 0.496 Test Loss: 1.675 Test Acc: 0.496
Validation loss decreased (inf --> -0.496166).  Saving model ...
Epoch: 2 cost time: 2.7811198234558105
Epoch: 2, Steps: 32 | Train Loss: 2.050 Vali Loss: 6.125 Vali Acc: 0.160 Test Loss: 6.125 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.759443521499634
Epoch: 3, Steps: 32 | Train Loss: 2.491 Vali Loss: 2.247 Vali Acc: 0.557 Test Loss: 2.247 Test Acc: 0.557
Validation loss decreased (-0.496166 --> -0.557229).  Saving model ...
Epoch: 4 cost time: 2.852374315261841
Epoch: 4, Steps: 32 | Train Loss: 1.261 Vali Loss: 8.186 Vali Acc: 0.511 Test Loss: 8.186 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.8986456394195557
Epoch: 5, Steps: 32 | Train Loss: 0.877 Vali Loss: 8.725 Vali Acc: 0.573 Test Loss: 8.725 Test Acc: 0.573
Validation loss decreased (-0.557229 --> -0.572432).  Saving model ...
Epoch: 6 cost time: 2.7076103687286377
Epoch: 6, Steps: 32 | Train Loss: 0.571 Vali Loss: 6.044 Vali Acc: 0.496 Test Loss: 6.044 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.612140655517578
Epoch: 7, Steps: 32 | Train Loss: 0.223 Vali Loss: 8.957 Vali Acc: 0.580 Test Loss: 8.957 Test Acc: 0.580
Validation loss decreased (-0.572432 --> -0.580063).  Saving model ...
Epoch: 8 cost time: 2.9374639987945557
Epoch: 8, Steps: 32 | Train Loss: 0.572 Vali Loss: 10.703 Vali Acc: 0.580 Test Loss: 10.703 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.8539462089538574
Epoch: 9, Steps: 32 | Train Loss: 1.604 Vali Loss: 12.217 Vali Acc: 0.573 Test Loss: 12.217 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.9365642070770264
Epoch: 10, Steps: 32 | Train Loss: 0.433 Vali Loss: 13.199 Vali Acc: 0.336 Test Loss: 13.199 Test Acc: 0.336
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.8555972576141357
Epoch: 11, Steps: 32 | Train Loss: 0.179 Vali Loss: 11.780 Vali Acc: 0.412 Test Loss: 11.780 Test Acc: 0.412
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.9572701454162598
Epoch: 12, Steps: 32 | Train Loss: 0.275 Vali Loss: 13.406 Vali Acc: 0.481 Test Loss: 13.406 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.903972864151001
Epoch: 13, Steps: 32 | Train Loss: 0.219 Vali Loss: 11.233 Vali Acc: 0.489 Test Loss: 11.233 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.8815903663635254
Epoch: 14, Steps: 32 | Train Loss: 0.257 Vali Loss: 16.948 Vali Acc: 0.588 Test Loss: 16.948 Test Acc: 0.588
Validation loss decreased (-0.580063 --> -0.587617).  Saving model ...
Epoch: 15 cost time: 2.9651567935943604
Epoch: 15, Steps: 32 | Train Loss: 0.872 Vali Loss: 15.165 Vali Acc: 0.573 Test Loss: 15.165 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.8356363773345947
Epoch: 16, Steps: 32 | Train Loss: 1.379 Vali Loss: 27.861 Vali Acc: 0.557 Test Loss: 27.861 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.9568920135498047
Epoch: 17, Steps: 32 | Train Loss: 0.882 Vali Loss: 22.203 Vali Acc: 0.374 Test Loss: 22.203 Test Acc: 0.374
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.907170057296753
Epoch: 18, Steps: 32 | Train Loss: 0.270 Vali Loss: 14.748 Vali Acc: 0.511 Test Loss: 14.748 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.8633041381835938
Epoch: 19, Steps: 32 | Train Loss: 0.526 Vali Loss: 26.563 Vali Acc: 0.550 Test Loss: 26.563 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.875222682952881
Epoch: 20, Steps: 32 | Train Loss: 0.693 Vali Loss: 48.150 Vali Acc: 0.267 Test Loss: 48.150 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.8442134857177734
Epoch: 21, Steps: 32 | Train Loss: 0.997 Vali Loss: 17.527 Vali Acc: 0.511 Test Loss: 17.527 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.9684641361236572
Epoch: 22, Steps: 32 | Train Loss: 0.283 Vali Loss: 28.585 Vali Acc: 0.527 Test Loss: 28.585 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.8633053302764893
Epoch: 23, Steps: 32 | Train Loss: 0.691 Vali Loss: 31.443 Vali Acc: 0.313 Test Loss: 31.443 Test Acc: 0.313
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.9569950103759766
Epoch: 24, Steps: 32 | Train Loss: 0.058 Vali Loss: 23.884 Vali Acc: 0.519 Test Loss: 23.884 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 1525381
model size : 6.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 24.06911873817444
Epoch: 1, Steps: 32 | Train Loss: 1.806 Vali Loss: 1.865 Vali Acc: 0.214 Test Loss: 1.865 Test Acc: 0.214
Validation loss decreased (inf --> -0.213722).  Saving model ...
Epoch: 2 cost time: 23.506178617477417
Epoch: 2, Steps: 32 | Train Loss: 0.795 Vali Loss: 2.658 Vali Acc: 0.244 Test Loss: 2.658 Test Acc: 0.244
Validation loss decreased (-0.213722 --> -0.244248).  Saving model ...
Epoch: 3 cost time: 21.975409507751465
Epoch: 3, Steps: 32 | Train Loss: 0.599 Vali Loss: 3.764 Vali Acc: 0.275 Test Loss: 3.764 Test Acc: 0.275
Validation loss decreased (-0.244248 --> -0.274772).  Saving model ...
Epoch: 4 cost time: 23.442073822021484
Epoch: 4, Steps: 32 | Train Loss: 0.164 Vali Loss: 4.618 Vali Acc: 0.321 Test Loss: 4.618 Test Acc: 0.321
Validation loss decreased (-0.274772 --> -0.320565).  Saving model ...
Epoch: 5 cost time: 23.055729866027832
Epoch: 5, Steps: 32 | Train Loss: 0.310 Vali Loss: 4.654 Vali Acc: 0.519 Test Loss: 4.654 Test Acc: 0.519
Validation loss decreased (-0.320565 --> -0.519037).  Saving model ...
Epoch: 6 cost time: 23.28763461112976
Epoch: 6, Steps: 32 | Train Loss: 0.294 Vali Loss: 4.256 Vali Acc: 0.511 Test Loss: 4.256 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 23.62906312942505
Epoch: 7, Steps: 32 | Train Loss: 0.142 Vali Loss: 6.179 Vali Acc: 0.534 Test Loss: 6.179 Test Acc: 0.534
Validation loss decreased (-0.519037 --> -0.534289).  Saving model ...
Epoch: 8 cost time: 23.2250235080719
Epoch: 8, Steps: 32 | Train Loss: 0.289 Vali Loss: 5.947 Vali Acc: 0.458 Test Loss: 5.947 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 23.809541702270508
Epoch: 9, Steps: 32 | Train Loss: 0.278 Vali Loss: 6.154 Vali Acc: 0.504 Test Loss: 6.154 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 24.201953649520874
Epoch: 10, Steps: 32 | Train Loss: 0.178 Vali Loss: 6.768 Vali Acc: 0.481 Test Loss: 6.768 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 23.488762140274048
Epoch: 11, Steps: 32 | Train Loss: 0.017 Vali Loss: 6.634 Vali Acc: 0.496 Test Loss: 6.634 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 24.02696466445923
Epoch: 12, Steps: 32 | Train Loss: 0.031 Vali Loss: 10.080 Vali Acc: 0.405 Test Loss: 10.080 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 24.215342044830322
Epoch: 13, Steps: 32 | Train Loss: 0.206 Vali Loss: 9.465 Vali Acc: 0.427 Test Loss: 9.465 Test Acc: 0.427
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 24.074849605560303
Epoch: 14, Steps: 32 | Train Loss: 0.366 Vali Loss: 9.367 Vali Acc: 0.450 Test Loss: 9.367 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 24.87955069541931
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 10.265 Vali Acc: 0.489 Test Loss: 10.265 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 24.289889097213745
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 9.697 Vali Acc: 0.496 Test Loss: 9.697 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 24.39432382583618
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 9.756 Vali Acc: 0.496 Test Loss: 9.756 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 1306149
model size : 5.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 12.20450472831726
Epoch: 1, Steps: 32 | Train Loss: 1.650 Vali Loss: 1.794 Vali Acc: 0.244 Test Loss: 1.794 Test Acc: 0.244
Validation loss decreased (inf --> -0.244257).  Saving model ...
Epoch: 2 cost time: 10.31682014465332
Epoch: 2, Steps: 32 | Train Loss: 1.315 Vali Loss: 3.601 Vali Acc: 0.221 Test Loss: 3.601 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.629060745239258
Epoch: 3, Steps: 32 | Train Loss: 0.941 Vali Loss: 2.727 Vali Acc: 0.496 Test Loss: 2.727 Test Acc: 0.496
Validation loss decreased (-0.244257 --> -0.496156).  Saving model ...
Epoch: 4 cost time: 10.802605152130127
Epoch: 4, Steps: 32 | Train Loss: 0.223 Vali Loss: 4.052 Vali Acc: 0.511 Test Loss: 4.052 Test Acc: 0.511
Validation loss decreased (-0.496156 --> -0.511410).  Saving model ...
Epoch: 5 cost time: 10.428005456924438
Epoch: 5, Steps: 32 | Train Loss: 0.452 Vali Loss: 3.789 Vali Acc: 0.504 Test Loss: 3.789 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 10.565823554992676
Epoch: 6, Steps: 32 | Train Loss: 0.146 Vali Loss: 3.556 Vali Acc: 0.489 Test Loss: 3.556 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 10.717288970947266
Epoch: 7, Steps: 32 | Train Loss: 0.003 Vali Loss: 4.379 Vali Acc: 0.527 Test Loss: 4.379 Test Acc: 0.527
Validation loss decreased (-0.511410 --> -0.526674).  Saving model ...
Epoch: 8 cost time: 10.699039459228516
Epoch: 8, Steps: 32 | Train Loss: 0.000 Vali Loss: 4.292 Vali Acc: 0.450 Test Loss: 4.292 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 10.24455213546753
Epoch: 9, Steps: 32 | Train Loss: 0.017 Vali Loss: 5.357 Vali Acc: 0.359 Test Loss: 5.357 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 10.498839378356934
Epoch: 10, Steps: 32 | Train Loss: 0.001 Vali Loss: 5.916 Vali Acc: 0.504 Test Loss: 5.916 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 10.562757015228271
Epoch: 11, Steps: 32 | Train Loss: 0.099 Vali Loss: 8.885 Vali Acc: 0.359 Test Loss: 8.885 Test Acc: 0.359
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 10.680278539657593
Epoch: 12, Steps: 32 | Train Loss: 0.497 Vali Loss: 7.533 Vali Acc: 0.458 Test Loss: 7.533 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 10.079885244369507
Epoch: 13, Steps: 32 | Train Loss: 0.274 Vali Loss: 9.444 Vali Acc: 0.420 Test Loss: 9.444 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 10.63634443283081
Epoch: 14, Steps: 32 | Train Loss: 0.893 Vali Loss: 13.247 Vali Acc: 0.557 Test Loss: 13.247 Test Acc: 0.557
Validation loss decreased (-0.526674 --> -0.557119).  Saving model ...
Epoch: 15 cost time: 10.726652383804321
Epoch: 15, Steps: 32 | Train Loss: 0.062 Vali Loss: 9.561 Vali Acc: 0.595 Test Loss: 9.561 Test Acc: 0.595
Validation loss decreased (-0.557119 --> -0.595324).  Saving model ...
Epoch: 16 cost time: 9.725206851959229
Epoch: 16, Steps: 32 | Train Loss: 0.521 Vali Loss: 14.077 Vali Acc: 0.542 Test Loss: 14.077 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 10.869116067886353
Epoch: 17, Steps: 32 | Train Loss: 1.146 Vali Loss: 15.913 Vali Acc: 0.351 Test Loss: 15.913 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 10.849616765975952
Epoch: 18, Steps: 32 | Train Loss: 0.865 Vali Loss: 13.602 Vali Acc: 0.550 Test Loss: 13.602 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 10.089231729507446
Epoch: 19, Steps: 32 | Train Loss: 0.108 Vali Loss: 14.556 Vali Acc: 0.443 Test Loss: 14.556 Test Acc: 0.443
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 10.928732633590698
Epoch: 20, Steps: 32 | Train Loss: 0.242 Vali Loss: 17.757 Vali Acc: 0.313 Test Loss: 17.757 Test Acc: 0.313
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 10.810134410858154
Epoch: 21, Steps: 32 | Train Loss: 0.022 Vali Loss: 11.487 Vali Acc: 0.527 Test Loss: 11.487 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 10.551883697509766
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 11.812 Vali Acc: 0.534 Test Loss: 11.812 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 10.177021741867065
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 11.823 Vali Acc: 0.534 Test Loss: 11.823 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 10.768954515457153
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 11.822 Vali Acc: 0.534 Test Loss: 11.822 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 10.458956003189087
Epoch: 25, Steps: 32 | Train Loss: 0.000 Vali Loss: 11.818 Vali Acc: 0.534 Test Loss: 11.818 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5954198473282443
model parameter : 892165
model size : 3.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 18.236949682235718
Epoch: 1, Steps: 32 | Train Loss: 1.805 Vali Loss: 1.857 Vali Acc: 0.214 Test Loss: 1.857 Test Acc: 0.214
Validation loss decreased (inf --> -0.213722).  Saving model ...
Epoch: 2 cost time: 17.317198276519775
Epoch: 2, Steps: 32 | Train Loss: 0.772 Vali Loss: 2.632 Vali Acc: 0.260 Test Loss: 2.632 Test Acc: 0.260
Validation loss decreased (-0.213722 --> -0.259516).  Saving model ...
Epoch: 3 cost time: 16.20219349861145
Epoch: 3, Steps: 32 | Train Loss: 0.613 Vali Loss: 4.842 Vali Acc: 0.244 Test Loss: 4.842 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 17.184855222702026
Epoch: 4, Steps: 32 | Train Loss: 0.177 Vali Loss: 3.429 Vali Acc: 0.481 Test Loss: 3.429 Test Acc: 0.481
Validation loss decreased (-0.259516 --> -0.480882).  Saving model ...
Epoch: 5 cost time: 16.6350314617157
Epoch: 5, Steps: 32 | Train Loss: 0.238 Vali Loss: 6.123 Vali Acc: 0.397 Test Loss: 6.123 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 17.074089288711548
Epoch: 6, Steps: 32 | Train Loss: 0.176 Vali Loss: 4.552 Vali Acc: 0.427 Test Loss: 4.552 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 16.935574769973755
Epoch: 7, Steps: 32 | Train Loss: 0.365 Vali Loss: 7.158 Vali Acc: 0.496 Test Loss: 7.158 Test Acc: 0.496
Validation loss decreased (-0.480882 --> -0.496112).  Saving model ...
Epoch: 8 cost time: 17.92236876487732
Epoch: 8, Steps: 32 | Train Loss: 0.065 Vali Loss: 8.928 Vali Acc: 0.557 Test Loss: 8.928 Test Acc: 0.557
Validation loss decreased (-0.496112 --> -0.557163).  Saving model ...
Epoch: 9 cost time: 17.42853093147278
Epoch: 9, Steps: 32 | Train Loss: 0.145 Vali Loss: 9.056 Vali Acc: 0.573 Test Loss: 9.056 Test Acc: 0.573
Validation loss decreased (-0.557163 --> -0.572429).  Saving model ...
Epoch: 10 cost time: 18.700032472610474
Epoch: 10, Steps: 32 | Train Loss: 0.103 Vali Loss: 10.483 Vali Acc: 0.527 Test Loss: 10.483 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 18.61289358139038
Epoch: 11, Steps: 32 | Train Loss: 0.192 Vali Loss: 9.312 Vali Acc: 0.573 Test Loss: 9.312 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 17.550387859344482
Epoch: 12, Steps: 32 | Train Loss: 0.023 Vali Loss: 7.686 Vali Acc: 0.573 Test Loss: 7.686 Test Acc: 0.573
Validation loss decreased (-0.572429 --> -0.572442).  Saving model ...
Epoch: 13 cost time: 18.69846773147583
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.266 Vali Acc: 0.466 Test Loss: 6.266 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 17.935550212860107
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.111 Vali Acc: 0.489 Test Loss: 6.111 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 19.38939070701599
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.257 Vali Acc: 0.519 Test Loss: 6.257 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 18.236836433410645
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.345 Vali Acc: 0.527 Test Loss: 6.345 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 18.505409717559814
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.232 Vali Acc: 0.527 Test Loss: 6.232 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 18.16374945640564
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.205 Vali Acc: 0.527 Test Loss: 6.205 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 18.121313333511353
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.202 Vali Acc: 0.527 Test Loss: 6.202 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 18.40285038948059
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.201 Vali Acc: 0.527 Test Loss: 6.201 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 18.620100498199463
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.199 Vali Acc: 0.527 Test Loss: 6.199 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 18.548677921295166
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 6.198 Vali Acc: 0.527 Test Loss: 6.198 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 1306149
model size : 5.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 8.689540386199951
Epoch: 1, Steps: 32 | Train Loss: 1.650 Vali Loss: 1.796 Vali Acc: 0.244 Test Loss: 1.796 Test Acc: 0.244
Validation loss decreased (inf --> -0.244257).  Saving model ...
Epoch: 2 cost time: 7.436716318130493
Epoch: 2, Steps: 32 | Train Loss: 1.299 Vali Loss: 3.543 Vali Acc: 0.221 Test Loss: 3.543 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.620590448379517
Epoch: 3, Steps: 32 | Train Loss: 0.902 Vali Loss: 2.775 Vali Acc: 0.473 Test Loss: 2.775 Test Acc: 0.473
Validation loss decreased (-0.244257 --> -0.473255).  Saving model ...
Epoch: 4 cost time: 8.00870394706726
Epoch: 4, Steps: 32 | Train Loss: 0.230 Vali Loss: 3.446 Vali Acc: 0.534 Test Loss: 3.446 Test Acc: 0.534
Validation loss decreased (-0.473255 --> -0.534317).  Saving model ...
Epoch: 5 cost time: 8.01615047454834
Epoch: 5, Steps: 32 | Train Loss: 0.097 Vali Loss: 3.283 Vali Acc: 0.519 Test Loss: 3.283 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.692378282546997
Epoch: 6, Steps: 32 | Train Loss: 0.087 Vali Loss: 4.047 Vali Acc: 0.382 Test Loss: 4.047 Test Acc: 0.382
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 8.013624429702759
Epoch: 7, Steps: 32 | Train Loss: 0.054 Vali Loss: 3.387 Vali Acc: 0.511 Test Loss: 3.387 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 7.576191663742065
Epoch: 8, Steps: 32 | Train Loss: 0.003 Vali Loss: 4.402 Vali Acc: 0.565 Test Loss: 4.402 Test Acc: 0.565
Validation loss decreased (-0.534317 --> -0.564841).  Saving model ...
Epoch: 9 cost time: 7.9958484172821045
Epoch: 9, Steps: 32 | Train Loss: 0.237 Vali Loss: 6.596 Vali Acc: 0.275 Test Loss: 6.596 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 8.388588428497314
Epoch: 10, Steps: 32 | Train Loss: 0.589 Vali Loss: 7.621 Vali Acc: 0.405 Test Loss: 7.621 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 8.758156776428223
Epoch: 11, Steps: 32 | Train Loss: 0.000 Vali Loss: 9.014 Vali Acc: 0.511 Test Loss: 9.014 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 8.764812707901001
Epoch: 12, Steps: 32 | Train Loss: 0.133 Vali Loss: 7.747 Vali Acc: 0.420 Test Loss: 7.747 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 8.611650705337524
Epoch: 13, Steps: 32 | Train Loss: 0.238 Vali Loss: 8.365 Vali Acc: 0.321 Test Loss: 8.365 Test Acc: 0.321
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 8.605385065078735
Epoch: 14, Steps: 32 | Train Loss: 1.479 Vali Loss: 12.335 Vali Acc: 0.542 Test Loss: 12.335 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 8.073893547058105
Epoch: 15, Steps: 32 | Train Loss: 0.640 Vali Loss: 12.237 Vali Acc: 0.511 Test Loss: 12.237 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 8.233482599258423
Epoch: 16, Steps: 32 | Train Loss: 0.605 Vali Loss: 11.057 Vali Acc: 0.527 Test Loss: 11.057 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 8.565466165542603
Epoch: 17, Steps: 32 | Train Loss: 1.721 Vali Loss: 21.948 Vali Acc: 0.389 Test Loss: 21.948 Test Acc: 0.389
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 8.319700002670288
Epoch: 18, Steps: 32 | Train Loss: 1.008 Vali Loss: 12.071 Vali Acc: 0.374 Test Loss: 12.071 Test Acc: 0.374
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 892165
model size : 3.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 11.526121854782104
Epoch: 1, Steps: 32 | Train Loss: 1.799 Vali Loss: 1.883 Vali Acc: 0.206 Test Loss: 1.883 Test Acc: 0.206
Validation loss decreased (inf --> -0.206088).  Saving model ...
Epoch: 2 cost time: 10.777606964111328
Epoch: 2, Steps: 32 | Train Loss: 0.802 Vali Loss: 2.595 Vali Acc: 0.244 Test Loss: 2.595 Test Acc: 0.244
Validation loss decreased (-0.206088 --> -0.244249).  Saving model ...
Epoch: 3 cost time: 10.652384519577026
Epoch: 3, Steps: 32 | Train Loss: 0.679 Vali Loss: 2.488 Vali Acc: 0.458 Test Loss: 2.488 Test Acc: 0.458
Validation loss decreased (-0.244249 --> -0.457990).  Saving model ...
Epoch: 4 cost time: 10.953567028045654
Epoch: 4, Steps: 32 | Train Loss: 0.175 Vali Loss: 4.888 Vali Acc: 0.511 Test Loss: 4.888 Test Acc: 0.511
Validation loss decreased (-0.457990 --> -0.511402).  Saving model ...
Epoch: 5 cost time: 10.76593017578125
Epoch: 5, Steps: 32 | Train Loss: 0.084 Vali Loss: 5.721 Vali Acc: 0.336 Test Loss: 5.721 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 10.936264038085938
Epoch: 6, Steps: 32 | Train Loss: 0.395 Vali Loss: 4.660 Vali Acc: 0.489 Test Loss: 4.660 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 10.72264575958252
Epoch: 7, Steps: 32 | Train Loss: 0.101 Vali Loss: 5.596 Vali Acc: 0.427 Test Loss: 5.596 Test Acc: 0.427
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 10.244422912597656
Epoch: 8, Steps: 32 | Train Loss: 0.006 Vali Loss: 6.324 Vali Acc: 0.542 Test Loss: 6.324 Test Acc: 0.542
Validation loss decreased (-0.511402 --> -0.541921).  Saving model ...
Epoch: 9 cost time: 10.70043134689331
Epoch: 9, Steps: 32 | Train Loss: 0.046 Vali Loss: 5.733 Vali Acc: 0.344 Test Loss: 5.733 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 10.37351107597351
Epoch: 10, Steps: 32 | Train Loss: 0.003 Vali Loss: 6.249 Vali Acc: 0.405 Test Loss: 6.249 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 10.598977088928223
Epoch: 11, Steps: 32 | Train Loss: 0.300 Vali Loss: 10.127 Vali Acc: 0.305 Test Loss: 10.127 Test Acc: 0.305
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 10.461978912353516
Epoch: 12, Steps: 32 | Train Loss: 0.086 Vali Loss: 7.707 Vali Acc: 0.489 Test Loss: 7.707 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 10.727715969085693
Epoch: 13, Steps: 32 | Train Loss: 0.377 Vali Loss: 12.166 Vali Acc: 0.336 Test Loss: 12.166 Test Acc: 0.336
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 10.048436641693115
Epoch: 14, Steps: 32 | Train Loss: 0.570 Vali Loss: 11.041 Vali Acc: 0.427 Test Loss: 11.041 Test Acc: 0.427
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 9.790215492248535
Epoch: 15, Steps: 32 | Train Loss: 0.686 Vali Loss: 11.630 Vali Acc: 0.359 Test Loss: 11.630 Test Acc: 0.359
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 9.681037187576294
Epoch: 16, Steps: 32 | Train Loss: 1.079 Vali Loss: 11.931 Vali Acc: 0.466 Test Loss: 11.931 Test Acc: 0.466
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 10.40456223487854
Epoch: 17, Steps: 32 | Train Loss: 0.414 Vali Loss: 12.953 Vali Acc: 0.427 Test Loss: 12.953 Test Acc: 0.427
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 10.750975131988525
Epoch: 18, Steps: 32 | Train Loss: 0.139 Vali Loss: 15.831 Vali Acc: 0.344 Test Loss: 15.831 Test Acc: 0.344
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 1306149
model size : 5.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.629531621932983
Epoch: 1, Steps: 32 | Train Loss: 1.681 Vali Loss: 1.777 Vali Acc: 0.244 Test Loss: 1.777 Test Acc: 0.244
Validation loss decreased (inf --> -0.244257).  Saving model ...
Epoch: 2 cost time: 4.362957000732422
Epoch: 2, Steps: 32 | Train Loss: 1.167 Vali Loss: 2.470 Vali Acc: 0.282 Test Loss: 2.470 Test Acc: 0.282
Validation loss decreased (-0.244257 --> -0.282418).  Saving model ...
Epoch: 3 cost time: 4.822368621826172
Epoch: 3, Steps: 32 | Train Loss: 0.815 Vali Loss: 3.885 Vali Acc: 0.420 Test Loss: 3.885 Test Acc: 0.420
Validation loss decreased (-0.282418 --> -0.419808).  Saving model ...
Epoch: 4 cost time: 5.237356662750244
Epoch: 4, Steps: 32 | Train Loss: 0.310 Vali Loss: 4.493 Vali Acc: 0.519 Test Loss: 4.493 Test Acc: 0.519
Validation loss decreased (-0.419808 --> -0.519039).  Saving model ...
Epoch: 5 cost time: 5.228200435638428
Epoch: 5, Steps: 32 | Train Loss: 0.075 Vali Loss: 3.972 Vali Acc: 0.496 Test Loss: 3.972 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.071977376937866
Epoch: 6, Steps: 32 | Train Loss: 0.059 Vali Loss: 3.748 Vali Acc: 0.542 Test Loss: 3.748 Test Acc: 0.542
Validation loss decreased (-0.519039 --> -0.541947).  Saving model ...
Epoch: 7 cost time: 5.2156267166137695
Epoch: 7, Steps: 32 | Train Loss: 0.063 Vali Loss: 5.346 Vali Acc: 0.382 Test Loss: 5.346 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.251927852630615
Epoch: 8, Steps: 32 | Train Loss: 0.048 Vali Loss: 8.708 Vali Acc: 0.519 Test Loss: 8.708 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.34526252746582
Epoch: 9, Steps: 32 | Train Loss: 0.333 Vali Loss: 8.817 Vali Acc: 0.298 Test Loss: 8.817 Test Acc: 0.298
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.3153767585754395
Epoch: 10, Steps: 32 | Train Loss: 0.083 Vali Loss: 7.696 Vali Acc: 0.511 Test Loss: 7.696 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.993995904922485
Epoch: 11, Steps: 32 | Train Loss: 0.044 Vali Loss: 7.091 Vali Acc: 0.450 Test Loss: 7.091 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.559518098831177
Epoch: 12, Steps: 32 | Train Loss: 0.433 Vali Loss: 9.642 Vali Acc: 0.550 Test Loss: 9.642 Test Acc: 0.550
Validation loss decreased (-0.541947 --> -0.549522).  Saving model ...
Epoch: 13 cost time: 5.321460485458374
Epoch: 13, Steps: 32 | Train Loss: 0.172 Vali Loss: 8.869 Vali Acc: 0.473 Test Loss: 8.869 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.297182321548462
Epoch: 14, Steps: 32 | Train Loss: 0.643 Vali Loss: 13.858 Vali Acc: 0.534 Test Loss: 13.858 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.195148944854736
Epoch: 15, Steps: 32 | Train Loss: 0.600 Vali Loss: 13.172 Vali Acc: 0.397 Test Loss: 13.172 Test Acc: 0.397
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.3138508796691895
Epoch: 16, Steps: 32 | Train Loss: 0.154 Vali Loss: 13.593 Vali Acc: 0.435 Test Loss: 13.593 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.608245849609375
Epoch: 17, Steps: 32 | Train Loss: 0.073 Vali Loss: 13.148 Vali Acc: 0.534 Test Loss: 13.148 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.3712944984436035
Epoch: 18, Steps: 32 | Train Loss: 0.052 Vali Loss: 14.995 Vali Acc: 0.458 Test Loss: 14.995 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 5.37301230430603
Epoch: 19, Steps: 32 | Train Loss: 0.096 Vali Loss: 15.295 Vali Acc: 0.351 Test Loss: 15.295 Test Acc: 0.351
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 5.43781590461731
Epoch: 20, Steps: 32 | Train Loss: 0.011 Vali Loss: 18.104 Vali Acc: 0.382 Test Loss: 18.104 Test Acc: 0.382
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 5.066985607147217
Epoch: 21, Steps: 32 | Train Loss: 0.041 Vali Loss: 13.112 Vali Acc: 0.466 Test Loss: 13.112 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 5.363142251968384
Epoch: 22, Steps: 32 | Train Loss: 0.001 Vali Loss: 12.779 Vali Acc: 0.435 Test Loss: 12.779 Test Acc: 0.435
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 892165
model size : 3.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 14.136844158172607
Epoch: 1, Steps: 32 | Train Loss: 2.476 Vali Loss: 3.569 Vali Acc: 0.481 Test Loss: 3.569 Test Acc: 0.481
Validation loss decreased (inf --> -0.480880).  Saving model ...
Epoch: 2 cost time: 13.224247455596924
Epoch: 2, Steps: 32 | Train Loss: 1.613 Vali Loss: 3.809 Vali Acc: 0.290 Test Loss: 3.809 Test Acc: 0.290
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 13.84108018875122
Epoch: 3, Steps: 32 | Train Loss: 0.554 Vali Loss: 2.538 Vali Acc: 0.481 Test Loss: 2.538 Test Acc: 0.481
Validation loss decreased (-0.480880 --> -0.480891).  Saving model ...
Epoch: 4 cost time: 13.531279563903809
Epoch: 4, Steps: 32 | Train Loss: 0.462 Vali Loss: 3.835 Vali Acc: 0.359 Test Loss: 3.835 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 13.594545125961304
Epoch: 5, Steps: 32 | Train Loss: 0.088 Vali Loss: 4.575 Vali Acc: 0.336 Test Loss: 4.575 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 13.556318759918213
Epoch: 6, Steps: 32 | Train Loss: 0.316 Vali Loss: 4.321 Vali Acc: 0.412 Test Loss: 4.321 Test Acc: 0.412
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 13.528493642807007
Epoch: 7, Steps: 32 | Train Loss: 0.043 Vali Loss: 5.350 Vali Acc: 0.420 Test Loss: 5.350 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 13.601236581802368
Epoch: 8, Steps: 32 | Train Loss: 0.021 Vali Loss: 6.364 Vali Acc: 0.466 Test Loss: 6.364 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 12.979398727416992
Epoch: 9, Steps: 32 | Train Loss: 0.049 Vali Loss: 8.343 Vali Acc: 0.481 Test Loss: 8.343 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 22.483420372009277
Epoch: 10, Steps: 32 | Train Loss: 0.416 Vali Loss: 7.611 Vali Acc: 0.496 Test Loss: 7.611 Test Acc: 0.496
Validation loss decreased (-0.480891 --> -0.496107).  Saving model ...
Epoch: 11 cost time: 20.81847858428955
Epoch: 11, Steps: 32 | Train Loss: 0.241 Vali Loss: 8.236 Vali Acc: 0.435 Test Loss: 8.236 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 22.73081684112549
Epoch: 12, Steps: 32 | Train Loss: 0.612 Vali Loss: 10.097 Vali Acc: 0.527 Test Loss: 10.097 Test Acc: 0.527
Validation loss decreased (-0.496107 --> -0.526617).  Saving model ...
Epoch: 13 cost time: 23.460788011550903
Epoch: 13, Steps: 32 | Train Loss: 0.210 Vali Loss: 9.172 Vali Acc: 0.359 Test Loss: 9.172 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 22.396406173706055
Epoch: 14, Steps: 32 | Train Loss: 0.431 Vali Loss: 11.150 Vali Acc: 0.252 Test Loss: 11.150 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 12.136981964111328
Epoch: 15, Steps: 32 | Train Loss: 0.774 Vali Loss: 9.751 Vali Acc: 0.389 Test Loss: 9.751 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 12.782479524612427
Epoch: 16, Steps: 32 | Train Loss: 0.509 Vali Loss: 15.044 Vali Acc: 0.359 Test Loss: 15.044 Test Acc: 0.359
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 12.699789047241211
Epoch: 17, Steps: 32 | Train Loss: 0.301 Vali Loss: 15.317 Vali Acc: 0.481 Test Loss: 15.317 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 12.910146713256836
Epoch: 18, Steps: 32 | Train Loss: 0.598 Vali Loss: 16.718 Vali Acc: 0.527 Test Loss: 16.718 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 12.571503162384033
Epoch: 19, Steps: 32 | Train Loss: 0.243 Vali Loss: 15.063 Vali Acc: 0.351 Test Loss: 15.063 Test Acc: 0.351
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 12.697959184646606
Epoch: 20, Steps: 32 | Train Loss: 0.513 Vali Loss: 22.917 Vali Acc: 0.542 Test Loss: 22.917 Test Acc: 0.542
Validation loss decreased (-0.526617 --> -0.541756).  Saving model ...
Epoch: 21 cost time: 12.816943883895874
Epoch: 21, Steps: 32 | Train Loss: 0.456 Vali Loss: 18.062 Vali Acc: 0.366 Test Loss: 18.062 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 12.700786113739014
Epoch: 22, Steps: 32 | Train Loss: 0.341 Vali Loss: 20.690 Vali Acc: 0.519 Test Loss: 20.690 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 13.620903253555298
Epoch: 23, Steps: 32 | Train Loss: 0.384 Vali Loss: 17.910 Vali Acc: 0.420 Test Loss: 17.910 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 13.70086669921875
Epoch: 24, Steps: 32 | Train Loss: 0.358 Vali Loss: 24.518 Vali Acc: 0.504 Test Loss: 24.518 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 14.341495513916016
Epoch: 25, Steps: 32 | Train Loss: 0.126 Vali Loss: 17.797 Vali Acc: 0.405 Test Loss: 17.797 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 14.285693407058716
Epoch: 26, Steps: 32 | Train Loss: 0.194 Vali Loss: 22.066 Vali Acc: 0.450 Test Loss: 22.066 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 14.002272844314575
Epoch: 27, Steps: 32 | Train Loss: 0.028 Vali Loss: 31.322 Vali Acc: 0.527 Test Loss: 31.322 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 14.16353154182434
Epoch: 28, Steps: 32 | Train Loss: 0.081 Vali Loss: 24.568 Vali Acc: 0.511 Test Loss: 24.568 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 14.837316274642944
Epoch: 29, Steps: 32 | Train Loss: 0.002 Vali Loss: 26.818 Vali Acc: 0.473 Test Loss: 26.818 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 14.097507953643799
Epoch: 30, Steps: 32 | Train Loss: 0.104 Vali Loss: 23.462 Vali Acc: 0.397 Test Loss: 23.462 Test Acc: 0.397
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 1012901
model size : 4.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 6.938372611999512
Epoch: 1, Steps: 32 | Train Loss: 2.099 Vali Loss: 2.647 Vali Acc: 0.183 Test Loss: 2.647 Test Acc: 0.183
Validation loss decreased (inf --> -0.183180).  Saving model ...
Epoch: 2 cost time: 4.923218011856079
Epoch: 2, Steps: 32 | Train Loss: 1.326 Vali Loss: 3.192 Vali Acc: 0.221 Test Loss: 3.192 Test Acc: 0.221
Validation loss decreased (-0.183180 --> -0.221342).  Saving model ...
Epoch: 3 cost time: 5.914048671722412
Epoch: 3, Steps: 32 | Train Loss: 0.823 Vali Loss: 2.804 Vali Acc: 0.450 Test Loss: 2.804 Test Acc: 0.450
Validation loss decreased (-0.221342 --> -0.450354).  Saving model ...
Epoch: 4 cost time: 5.923474311828613
Epoch: 4, Steps: 32 | Train Loss: 0.529 Vali Loss: 7.189 Vali Acc: 0.221 Test Loss: 7.189 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.851594924926758
Epoch: 5, Steps: 32 | Train Loss: 0.129 Vali Loss: 7.320 Vali Acc: 0.237 Test Loss: 7.320 Test Acc: 0.237
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.9553751945495605
Epoch: 6, Steps: 32 | Train Loss: 0.189 Vali Loss: 6.636 Vali Acc: 0.374 Test Loss: 6.636 Test Acc: 0.374
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.0775206089019775
Epoch: 7, Steps: 32 | Train Loss: 0.161 Vali Loss: 5.873 Vali Acc: 0.420 Test Loss: 5.873 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.652304172515869
Epoch: 8, Steps: 32 | Train Loss: 0.180 Vali Loss: 6.849 Vali Acc: 0.489 Test Loss: 6.849 Test Acc: 0.489
Validation loss decreased (-0.450354 --> -0.488481).  Saving model ...
Epoch: 9 cost time: 5.972423553466797
Epoch: 9, Steps: 32 | Train Loss: 0.129 Vali Loss: 8.244 Vali Acc: 0.275 Test Loss: 8.244 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.909036874771118
Epoch: 10, Steps: 32 | Train Loss: 0.000 Vali Loss: 7.723 Vali Acc: 0.359 Test Loss: 7.723 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.053849935531616
Epoch: 11, Steps: 32 | Train Loss: 0.000 Vali Loss: 7.415 Vali Acc: 0.374 Test Loss: 7.415 Test Acc: 0.374
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.307859420776367
Epoch: 12, Steps: 32 | Train Loss: 0.000 Vali Loss: 7.263 Vali Acc: 0.374 Test Loss: 7.263 Test Acc: 0.374
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.100617170333862
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 7.194 Vali Acc: 0.374 Test Loss: 7.194 Test Acc: 0.374
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.043999433517456
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 7.118 Vali Acc: 0.382 Test Loss: 7.118 Test Acc: 0.382
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.834390878677368
Epoch: 15, Steps: 32 | Train Loss: 0.182 Vali Loss: 5.983 Vali Acc: 0.443 Test Loss: 5.983 Test Acc: 0.443
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 6.00411057472229
Epoch: 16, Steps: 32 | Train Loss: 1.364 Vali Loss: 11.322 Vali Acc: 0.305 Test Loss: 11.322 Test Acc: 0.305
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 5.926779508590698
Epoch: 17, Steps: 32 | Train Loss: 0.802 Vali Loss: 10.431 Vali Acc: 0.389 Test Loss: 10.431 Test Acc: 0.389
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 5.919139623641968
Epoch: 18, Steps: 32 | Train Loss: 0.345 Vali Loss: 12.751 Vali Acc: 0.435 Test Loss: 12.751 Test Acc: 0.435
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48854961832061067
model parameter : 805893
model size : 3.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 11.196295976638794
Epoch: 1, Steps: 32 | Train Loss: 2.476 Vali Loss: 3.569 Vali Acc: 0.481 Test Loss: 3.569 Test Acc: 0.481
Validation loss decreased (inf --> -0.480880).  Saving model ...
Epoch: 2 cost time: 10.349788665771484
Epoch: 2, Steps: 32 | Train Loss: 1.613 Vali Loss: 3.808 Vali Acc: 0.290 Test Loss: 3.808 Test Acc: 0.290
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.729294776916504
Epoch: 3, Steps: 32 | Train Loss: 0.594 Vali Loss: 2.979 Vali Acc: 0.328 Test Loss: 2.979 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 8.441722631454468
Epoch: 4, Steps: 32 | Train Loss: 0.379 Vali Loss: 3.139 Vali Acc: 0.527 Test Loss: 3.139 Test Acc: 0.527
Validation loss decreased (-0.480880 --> -0.526686).  Saving model ...
Epoch: 5 cost time: 9.483792781829834
Epoch: 5, Steps: 32 | Train Loss: 0.692 Vali Loss: 6.350 Vali Acc: 0.267 Test Loss: 6.350 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.605757474899292
Epoch: 6, Steps: 32 | Train Loss: 0.072 Vali Loss: 5.016 Vali Acc: 0.366 Test Loss: 5.016 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 9.171565771102905
Epoch: 7, Steps: 32 | Train Loss: 0.005 Vali Loss: 8.816 Vali Acc: 0.229 Test Loss: 8.816 Test Acc: 0.229
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 9.304864645004272
Epoch: 8, Steps: 32 | Train Loss: 0.106 Vali Loss: 6.371 Vali Acc: 0.542 Test Loss: 6.371 Test Acc: 0.542
Validation loss decreased (-0.526686 --> -0.541921).  Saving model ...
Epoch: 9 cost time: 9.493987321853638
Epoch: 9, Steps: 32 | Train Loss: 0.149 Vali Loss: 6.521 Vali Acc: 0.374 Test Loss: 6.521 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 9.480295181274414
Epoch: 10, Steps: 32 | Train Loss: 0.515 Vali Loss: 11.158 Vali Acc: 0.374 Test Loss: 11.158 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 8.759664297103882
Epoch: 11, Steps: 32 | Train Loss: 0.362 Vali Loss: 8.551 Vali Acc: 0.351 Test Loss: 8.551 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 8.507224798202515
Epoch: 12, Steps: 32 | Train Loss: 0.918 Vali Loss: 10.233 Vali Acc: 0.542 Test Loss: 10.233 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 8.787275075912476
Epoch: 13, Steps: 32 | Train Loss: 0.345 Vali Loss: 9.123 Vali Acc: 0.443 Test Loss: 9.123 Test Acc: 0.443
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 8.610971450805664
Epoch: 14, Steps: 32 | Train Loss: 0.172 Vali Loss: 10.033 Vali Acc: 0.389 Test Loss: 10.033 Test Acc: 0.389
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 8.824873685836792
Epoch: 15, Steps: 32 | Train Loss: 0.365 Vali Loss: 15.250 Vali Acc: 0.344 Test Loss: 15.250 Test Acc: 0.344
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 8.040497064590454
Epoch: 16, Steps: 32 | Train Loss: 0.425 Vali Loss: 14.398 Vali Acc: 0.489 Test Loss: 14.398 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 8.672383308410645
Epoch: 17, Steps: 32 | Train Loss: 0.012 Vali Loss: 19.794 Vali Acc: 0.534 Test Loss: 19.794 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 8.8412024974823
Epoch: 18, Steps: 32 | Train Loss: 0.108 Vali Loss: 15.240 Vali Acc: 0.489 Test Loss: 15.240 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 1012901
model size : 4.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.265106916427612
Epoch: 1, Steps: 32 | Train Loss: 2.102 Vali Loss: 2.644 Vali Acc: 0.183 Test Loss: 2.644 Test Acc: 0.183
Validation loss decreased (inf --> -0.183180).  Saving model ...
Epoch: 2 cost time: 4.1612443923950195
Epoch: 2, Steps: 32 | Train Loss: 1.328 Vali Loss: 3.144 Vali Acc: 0.237 Test Loss: 3.144 Test Acc: 0.237
Validation loss decreased (-0.183180 --> -0.236610).  Saving model ...
Epoch: 3 cost time: 4.213932752609253
Epoch: 3, Steps: 32 | Train Loss: 0.776 Vali Loss: 2.873 Vali Acc: 0.443 Test Loss: 2.873 Test Acc: 0.443
Validation loss decreased (-0.236610 --> -0.442719).  Saving model ...
Epoch: 4 cost time: 4.241330862045288
Epoch: 4, Steps: 32 | Train Loss: 0.451 Vali Loss: 5.720 Vali Acc: 0.252 Test Loss: 5.720 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.316425323486328
Epoch: 5, Steps: 32 | Train Loss: 0.139 Vali Loss: 8.481 Vali Acc: 0.229 Test Loss: 8.481 Test Acc: 0.229
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.28493070602417
Epoch: 6, Steps: 32 | Train Loss: 0.239 Vali Loss: 5.354 Vali Acc: 0.336 Test Loss: 5.354 Test Acc: 0.336
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.340441465377808
Epoch: 7, Steps: 32 | Train Loss: 0.130 Vali Loss: 6.880 Vali Acc: 0.359 Test Loss: 6.880 Test Acc: 0.359
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.355536937713623
Epoch: 8, Steps: 32 | Train Loss: 0.129 Vali Loss: 8.612 Vali Acc: 0.481 Test Loss: 8.612 Test Acc: 0.481
Validation loss decreased (-0.442719 --> -0.480830).  Saving model ...
Epoch: 9 cost time: 4.300868272781372
Epoch: 9, Steps: 32 | Train Loss: 0.140 Vali Loss: 8.067 Vali Acc: 0.305 Test Loss: 8.067 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.256861448287964
Epoch: 10, Steps: 32 | Train Loss: 0.409 Vali Loss: 7.644 Vali Acc: 0.397 Test Loss: 7.644 Test Acc: 0.397
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.248522758483887
Epoch: 11, Steps: 32 | Train Loss: 0.064 Vali Loss: 10.253 Vali Acc: 0.252 Test Loss: 10.253 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.295716047286987
Epoch: 12, Steps: 32 | Train Loss: 0.137 Vali Loss: 10.038 Vali Acc: 0.336 Test Loss: 10.038 Test Acc: 0.336
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.201439619064331
Epoch: 13, Steps: 32 | Train Loss: 0.267 Vali Loss: 11.473 Vali Acc: 0.328 Test Loss: 11.473 Test Acc: 0.328
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.261376619338989
Epoch: 14, Steps: 32 | Train Loss: 0.004 Vali Loss: 17.453 Vali Acc: 0.237 Test Loss: 17.453 Test Acc: 0.237
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.146050214767456
Epoch: 15, Steps: 32 | Train Loss: 0.376 Vali Loss: 10.569 Vali Acc: 0.489 Test Loss: 10.569 Test Acc: 0.489
Validation loss decreased (-0.480830 --> -0.488444).  Saving model ...
Epoch: 16 cost time: 4.220468759536743
Epoch: 16, Steps: 32 | Train Loss: 0.098 Vali Loss: 11.105 Vali Acc: 0.466 Test Loss: 11.105 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.338156223297119
Epoch: 17, Steps: 32 | Train Loss: 0.129 Vali Loss: 10.249 Vali Acc: 0.427 Test Loss: 10.249 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.348055362701416
Epoch: 18, Steps: 32 | Train Loss: 0.264 Vali Loss: 16.909 Vali Acc: 0.328 Test Loss: 16.909 Test Acc: 0.328
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.179586410522461
Epoch: 19, Steps: 32 | Train Loss: 0.368 Vali Loss: 17.411 Vali Acc: 0.305 Test Loss: 17.411 Test Acc: 0.305
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.08405876159668
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 14.089 Vali Acc: 0.504 Test Loss: 14.089 Test Acc: 0.504
Validation loss decreased (-0.488444 --> -0.503676).  Saving model ...
Epoch: 21 cost time: 3.950359344482422
Epoch: 21, Steps: 32 | Train Loss: 0.071 Vali Loss: 13.006 Vali Acc: 0.466 Test Loss: 13.006 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.307388544082642
Epoch: 22, Steps: 32 | Train Loss: 0.021 Vali Loss: 13.446 Vali Acc: 0.435 Test Loss: 13.446 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.294667482376099
Epoch: 23, Steps: 32 | Train Loss: 0.103 Vali Loss: 18.603 Vali Acc: 0.374 Test Loss: 18.603 Test Acc: 0.374
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.360885143280029
Epoch: 24, Steps: 32 | Train Loss: 0.084 Vali Loss: 14.102 Vali Acc: 0.511 Test Loss: 14.102 Test Acc: 0.511
Validation loss decreased (-0.503676 --> -0.511309).  Saving model ...
Epoch: 25 cost time: 4.267085075378418
Epoch: 25, Steps: 32 | Train Loss: 0.006 Vali Loss: 24.939 Vali Acc: 0.275 Test Loss: 24.939 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.227734565734863
Epoch: 26, Steps: 32 | Train Loss: 0.015 Vali Loss: 18.608 Vali Acc: 0.313 Test Loss: 18.608 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 4.244584798812866
Epoch: 27, Steps: 32 | Train Loss: 0.115 Vali Loss: 16.096 Vali Acc: 0.443 Test Loss: 16.096 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 4.157173156738281
Epoch: 28, Steps: 32 | Train Loss: 0.235 Vali Loss: 21.181 Vali Acc: 0.336 Test Loss: 21.181 Test Acc: 0.336
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 4.186857223510742
Epoch: 29, Steps: 32 | Train Loss: 0.319 Vali Loss: 26.406 Vali Acc: 0.313 Test Loss: 26.406 Test Acc: 0.313
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 4.009779691696167
Epoch: 30, Steps: 32 | Train Loss: 1.028 Vali Loss: 19.866 Vali Acc: 0.321 Test Loss: 19.866 Test Acc: 0.321
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 805893
model size : 3.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 7.067711591720581
Epoch: 1, Steps: 32 | Train Loss: 2.490 Vali Loss: 3.629 Vali Acc: 0.466 Test Loss: 3.629 Test Acc: 0.466
Validation loss decreased (inf --> -0.465613).  Saving model ...
Epoch: 2 cost time: 5.879548072814941
Epoch: 2, Steps: 32 | Train Loss: 1.615 Vali Loss: 3.652 Vali Acc: 0.275 Test Loss: 3.652 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.980007648468018
Epoch: 3, Steps: 32 | Train Loss: 0.515 Vali Loss: 2.594 Vali Acc: 0.481 Test Loss: 2.594 Test Acc: 0.481
Validation loss decreased (-0.465613 --> -0.480890).  Saving model ...
Epoch: 4 cost time: 5.939785718917847
Epoch: 4, Steps: 32 | Train Loss: 0.285 Vali Loss: 4.103 Vali Acc: 0.481 Test Loss: 4.103 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.99255633354187
Epoch: 5, Steps: 32 | Train Loss: 0.061 Vali Loss: 4.734 Vali Acc: 0.305 Test Loss: 4.734 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.763338088989258
Epoch: 6, Steps: 32 | Train Loss: 0.219 Vali Loss: 6.314 Vali Acc: 0.397 Test Loss: 6.314 Test Acc: 0.397
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.208314418792725
Epoch: 7, Steps: 32 | Train Loss: 0.448 Vali Loss: 6.279 Vali Acc: 0.366 Test Loss: 6.279 Test Acc: 0.366
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.5026328563690186
Epoch: 8, Steps: 32 | Train Loss: 0.600 Vali Loss: 6.977 Vali Acc: 0.412 Test Loss: 6.977 Test Acc: 0.412
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.823974847793579
Epoch: 9, Steps: 32 | Train Loss: 0.200 Vali Loss: 7.754 Vali Acc: 0.443 Test Loss: 7.754 Test Acc: 0.443
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.900118350982666
Epoch: 10, Steps: 32 | Train Loss: 0.082 Vali Loss: 7.750 Vali Acc: 0.473 Test Loss: 7.750 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 6.127084970474243
Epoch: 11, Steps: 32 | Train Loss: 0.000 Vali Loss: 8.427 Vali Acc: 0.366 Test Loss: 8.427 Test Acc: 0.366
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.765783071517944
Epoch: 12, Steps: 32 | Train Loss: 0.072 Vali Loss: 8.738 Vali Acc: 0.405 Test Loss: 8.738 Test Acc: 0.405
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.771026134490967
Epoch: 13, Steps: 32 | Train Loss: 0.040 Vali Loss: 8.052 Vali Acc: 0.443 Test Loss: 8.052 Test Acc: 0.443
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48091603053435117
model parameter : 1012901
model size : 4.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.125192403793335
Epoch: 1, Steps: 32 | Train Loss: 2.095 Vali Loss: 2.603 Vali Acc: 0.176 Test Loss: 2.603 Test Acc: 0.176
Validation loss decreased (inf --> -0.175546).  Saving model ...
Epoch: 2 cost time: 2.9380903244018555
Epoch: 2, Steps: 32 | Train Loss: 1.326 Vali Loss: 3.007 Vali Acc: 0.237 Test Loss: 3.007 Test Acc: 0.237
Validation loss decreased (-0.175546 --> -0.236611).  Saving model ...
Epoch: 3 cost time: 2.901639699935913
Epoch: 3, Steps: 32 | Train Loss: 0.782 Vali Loss: 3.209 Vali Acc: 0.496 Test Loss: 3.209 Test Acc: 0.496
Validation loss decreased (-0.236611 --> -0.496151).  Saving model ...
Epoch: 4 cost time: 2.9548499584198
Epoch: 4, Steps: 32 | Train Loss: 0.652 Vali Loss: 5.886 Vali Acc: 0.313 Test Loss: 5.886 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.8758385181427
Epoch: 5, Steps: 32 | Train Loss: 0.311 Vali Loss: 9.339 Vali Acc: 0.267 Test Loss: 9.339 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.87141752243042
Epoch: 6, Steps: 32 | Train Loss: 0.146 Vali Loss: 5.513 Vali Acc: 0.351 Test Loss: 5.513 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.8958263397216797
Epoch: 7, Steps: 32 | Train Loss: 0.236 Vali Loss: 6.763 Vali Acc: 0.511 Test Loss: 6.763 Test Acc: 0.511
Validation loss decreased (-0.496151 --> -0.511383).  Saving model ...
Epoch: 8 cost time: 2.8127849102020264
Epoch: 8, Steps: 32 | Train Loss: 0.400 Vali Loss: 6.893 Vali Acc: 0.344 Test Loss: 6.893 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.7969987392425537
Epoch: 9, Steps: 32 | Train Loss: 0.015 Vali Loss: 7.871 Vali Acc: 0.397 Test Loss: 7.871 Test Acc: 0.397
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.88053035736084
Epoch: 10, Steps: 32 | Train Loss: 0.030 Vali Loss: 7.604 Vali Acc: 0.374 Test Loss: 7.604 Test Acc: 0.374
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.832077980041504
Epoch: 11, Steps: 32 | Train Loss: 0.137 Vali Loss: 9.109 Vali Acc: 0.382 Test Loss: 9.109 Test Acc: 0.382
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.8618526458740234
Epoch: 12, Steps: 32 | Train Loss: 0.381 Vali Loss: 8.605 Vali Acc: 0.527 Test Loss: 8.605 Test Acc: 0.527
Validation loss decreased (-0.511383 --> -0.526632).  Saving model ...
Epoch: 13 cost time: 2.6299140453338623
Epoch: 13, Steps: 32 | Train Loss: 0.262 Vali Loss: 10.696 Vali Acc: 0.519 Test Loss: 10.696 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.843005895614624
Epoch: 14, Steps: 32 | Train Loss: 0.240 Vali Loss: 9.624 Vali Acc: 0.496 Test Loss: 9.624 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.6578848361968994
Epoch: 15, Steps: 32 | Train Loss: 0.001 Vali Loss: 11.845 Vali Acc: 0.290 Test Loss: 11.845 Test Acc: 0.290
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.6834752559661865
Epoch: 16, Steps: 32 | Train Loss: 0.025 Vali Loss: 9.658 Vali Acc: 0.450 Test Loss: 9.658 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.7584798336029053
Epoch: 17, Steps: 32 | Train Loss: 0.044 Vali Loss: 10.927 Vali Acc: 0.435 Test Loss: 10.927 Test Acc: 0.435
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.7240304946899414
Epoch: 18, Steps: 32 | Train Loss: 0.014 Vali Loss: 12.709 Vali Acc: 0.481 Test Loss: 12.709 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.8275537490844727
Epoch: 19, Steps: 32 | Train Loss: 0.164 Vali Loss: 11.816 Vali Acc: 0.420 Test Loss: 11.816 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.813053846359253
Epoch: 20, Steps: 32 | Train Loss: 0.658 Vali Loss: 11.123 Vali Acc: 0.405 Test Loss: 11.123 Test Acc: 0.405
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.84493088722229
Epoch: 21, Steps: 32 | Train Loss: 0.083 Vali Loss: 12.994 Vali Acc: 0.443 Test Loss: 12.994 Test Acc: 0.443
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.7368087768554688
Epoch: 22, Steps: 32 | Train Loss: 0.205 Vali Loss: 14.661 Vali Acc: 0.344 Test Loss: 14.661 Test Acc: 0.344
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 805893
model size : 3.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 9.755984544754028
Epoch: 1, Steps: 32 | Train Loss: 1.932 Vali Loss: 1.512 Vali Acc: 0.466 Test Loss: 1.512 Test Acc: 0.466
Validation loss decreased (inf --> -0.465634).  Saving model ...
Epoch: 2 cost time: 8.78300404548645
Epoch: 2, Steps: 32 | Train Loss: 0.933 Vali Loss: 2.196 Vali Acc: 0.450 Test Loss: 2.196 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.98392367362976
Epoch: 3, Steps: 32 | Train Loss: 0.560 Vali Loss: 2.755 Vali Acc: 0.466 Test Loss: 2.755 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 11.817445278167725
Epoch: 4, Steps: 32 | Train Loss: 0.324 Vali Loss: 5.815 Vali Acc: 0.206 Test Loss: 5.815 Test Acc: 0.206
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 13.27951431274414
Epoch: 5, Steps: 32 | Train Loss: 0.481 Vali Loss: 4.090 Vali Acc: 0.466 Test Loss: 4.090 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 13.98609972000122
Epoch: 6, Steps: 32 | Train Loss: 0.149 Vali Loss: 6.846 Vali Acc: 0.328 Test Loss: 6.846 Test Acc: 0.328
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 13.218014240264893
Epoch: 7, Steps: 32 | Train Loss: 0.344 Vali Loss: 4.887 Vali Acc: 0.382 Test Loss: 4.887 Test Acc: 0.382
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 14.215311765670776
Epoch: 8, Steps: 32 | Train Loss: 0.123 Vali Loss: 7.155 Vali Acc: 0.557 Test Loss: 7.155 Test Acc: 0.557
Validation loss decreased (-0.465634 --> -0.557180).  Saving model ...
Epoch: 9 cost time: 13.167160272598267
Epoch: 9, Steps: 32 | Train Loss: 0.603 Vali Loss: 7.928 Vali Acc: 0.366 Test Loss: 7.928 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 13.497836589813232
Epoch: 10, Steps: 32 | Train Loss: 0.621 Vali Loss: 11.198 Vali Acc: 0.282 Test Loss: 11.198 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 14.304410457611084
Epoch: 11, Steps: 32 | Train Loss: 0.064 Vali Loss: 8.482 Vali Acc: 0.435 Test Loss: 8.482 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 13.14021372795105
Epoch: 12, Steps: 32 | Train Loss: 0.203 Vali Loss: 11.341 Vali Acc: 0.321 Test Loss: 11.341 Test Acc: 0.321
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 13.074697017669678
Epoch: 13, Steps: 32 | Train Loss: 0.410 Vali Loss: 12.385 Vali Acc: 0.443 Test Loss: 12.385 Test Acc: 0.443
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 13.350760459899902
Epoch: 14, Steps: 32 | Train Loss: 0.108 Vali Loss: 8.854 Vali Acc: 0.420 Test Loss: 8.854 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 13.590635538101196
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 8.728 Vali Acc: 0.443 Test Loss: 8.728 Test Acc: 0.443
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 13.208906650543213
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 8.834 Vali Acc: 0.435 Test Loss: 8.834 Test Acc: 0.435
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 9.010620355606079
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 8.848 Vali Acc: 0.435 Test Loss: 8.848 Test Acc: 0.435
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 8.243303775787354
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 8.849 Vali Acc: 0.435 Test Loss: 8.849 Test Acc: 0.435
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 866277
model size : 3.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.992922306060791
Epoch: 1, Steps: 32 | Train Loss: 2.125 Vali Loss: 2.949 Vali Acc: 0.176 Test Loss: 2.949 Test Acc: 0.176
Validation loss decreased (inf --> -0.175543).  Saving model ...
Epoch: 2 cost time: 4.6240761280059814
Epoch: 2, Steps: 32 | Train Loss: 1.609 Vali Loss: 3.203 Vali Acc: 0.275 Test Loss: 3.203 Test Acc: 0.275
Validation loss decreased (-0.175543 --> -0.274777).  Saving model ...
Epoch: 3 cost time: 4.562062978744507
Epoch: 3, Steps: 32 | Train Loss: 1.266 Vali Loss: 2.487 Vali Acc: 0.511 Test Loss: 2.487 Test Acc: 0.511
Validation loss decreased (-0.274777 --> -0.511426).  Saving model ...
Epoch: 4 cost time: 4.629615068435669
Epoch: 4, Steps: 32 | Train Loss: 0.307 Vali Loss: 3.090 Vali Acc: 0.435 Test Loss: 3.090 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.70945930480957
Epoch: 5, Steps: 32 | Train Loss: 0.476 Vali Loss: 4.461 Vali Acc: 0.481 Test Loss: 4.461 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.6832897663116455
Epoch: 6, Steps: 32 | Train Loss: 0.333 Vali Loss: 5.605 Vali Acc: 0.496 Test Loss: 5.605 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.578565835952759
Epoch: 7, Steps: 32 | Train Loss: 0.600 Vali Loss: 3.701 Vali Acc: 0.511 Test Loss: 3.701 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.705348014831543
Epoch: 8, Steps: 32 | Train Loss: 0.064 Vali Loss: 5.296 Vali Acc: 0.496 Test Loss: 5.296 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.653250694274902
Epoch: 9, Steps: 32 | Train Loss: 0.000 Vali Loss: 4.006 Vali Acc: 0.550 Test Loss: 4.006 Test Acc: 0.550
Validation loss decreased (-0.511426 --> -0.549578).  Saving model ...
Epoch: 10 cost time: 4.611345529556274
Epoch: 10, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.824 Vali Acc: 0.527 Test Loss: 3.824 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.336509466171265
Epoch: 11, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.835 Vali Acc: 0.527 Test Loss: 3.835 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.256403684616089
Epoch: 12, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.835 Vali Acc: 0.527 Test Loss: 3.835 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.354874849319458
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.836 Vali Acc: 0.527 Test Loss: 3.836 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.30780816078186
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.834 Vali Acc: 0.527 Test Loss: 3.834 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.634289026260376
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.833 Vali Acc: 0.527 Test Loss: 3.833 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.664705991744995
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.832 Vali Acc: 0.527 Test Loss: 3.832 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.544925928115845
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.832 Vali Acc: 0.527 Test Loss: 3.832 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.611333608627319
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.832 Vali Acc: 0.527 Test Loss: 3.832 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.71651816368103
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 3.831 Vali Acc: 0.527 Test Loss: 3.831 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 762757
model size : 3.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 8.687313795089722
Epoch: 1, Steps: 32 | Train Loss: 1.932 Vali Loss: 1.514 Vali Acc: 0.466 Test Loss: 1.514 Test Acc: 0.466
Validation loss decreased (inf --> -0.465634).  Saving model ...
Epoch: 2 cost time: 7.5005998611450195
Epoch: 2, Steps: 32 | Train Loss: 0.933 Vali Loss: 2.184 Vali Acc: 0.450 Test Loss: 2.184 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.670583009719849
Epoch: 3, Steps: 32 | Train Loss: 0.561 Vali Loss: 2.706 Vali Acc: 0.466 Test Loss: 2.706 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.841352462768555
Epoch: 4, Steps: 32 | Train Loss: 0.354 Vali Loss: 5.760 Vali Acc: 0.221 Test Loss: 5.760 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.803173542022705
Epoch: 5, Steps: 32 | Train Loss: 0.303 Vali Loss: 4.671 Vali Acc: 0.389 Test Loss: 4.671 Test Acc: 0.389
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.177046298980713
Epoch: 6, Steps: 32 | Train Loss: 0.460 Vali Loss: 4.771 Vali Acc: 0.504 Test Loss: 4.771 Test Acc: 0.504
Validation loss decreased (-0.465634 --> -0.503769).  Saving model ...
Epoch: 7 cost time: 7.779842853546143
Epoch: 7, Steps: 32 | Train Loss: 0.167 Vali Loss: 6.361 Vali Acc: 0.344 Test Loss: 6.361 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.656477928161621
Epoch: 8, Steps: 32 | Train Loss: 0.238 Vali Loss: 7.164 Vali Acc: 0.351 Test Loss: 7.164 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.800656080245972
Epoch: 9, Steps: 32 | Train Loss: 0.123 Vali Loss: 7.201 Vali Acc: 0.443 Test Loss: 7.201 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 7.9398462772369385
Epoch: 10, Steps: 32 | Train Loss: 0.175 Vali Loss: 7.632 Vali Acc: 0.405 Test Loss: 7.632 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 7.971564769744873
Epoch: 11, Steps: 32 | Train Loss: 0.092 Vali Loss: 8.359 Vali Acc: 0.420 Test Loss: 8.359 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 7.564195156097412
Epoch: 12, Steps: 32 | Train Loss: 0.145 Vali Loss: 8.057 Vali Acc: 0.511 Test Loss: 8.057 Test Acc: 0.511
Validation loss decreased (-0.503769 --> -0.511370).  Saving model ...
Epoch: 13 cost time: 8.142779111862183
Epoch: 13, Steps: 32 | Train Loss: 0.057 Vali Loss: 13.461 Vali Acc: 0.244 Test Loss: 13.461 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 7.421374559402466
Epoch: 14, Steps: 32 | Train Loss: 0.148 Vali Loss: 12.614 Vali Acc: 0.328 Test Loss: 12.614 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 7.028382778167725
Epoch: 15, Steps: 32 | Train Loss: 0.112 Vali Loss: 13.803 Vali Acc: 0.275 Test Loss: 13.803 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.915618181228638
Epoch: 16, Steps: 32 | Train Loss: 0.114 Vali Loss: 9.296 Vali Acc: 0.435 Test Loss: 9.296 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 7.842648983001709
Epoch: 17, Steps: 32 | Train Loss: 0.096 Vali Loss: 13.720 Vali Acc: 0.359 Test Loss: 13.720 Test Acc: 0.359
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 7.814723968505859
Epoch: 18, Steps: 32 | Train Loss: 0.004 Vali Loss: 14.666 Vali Acc: 0.504 Test Loss: 14.666 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 7.652503967285156
Epoch: 19, Steps: 32 | Train Loss: 0.183 Vali Loss: 27.979 Vali Acc: 0.214 Test Loss: 27.979 Test Acc: 0.214
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 7.716532468795776
Epoch: 20, Steps: 32 | Train Loss: 0.768 Vali Loss: 19.535 Vali Acc: 0.282 Test Loss: 19.535 Test Acc: 0.282
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 7.7393693923950195
Epoch: 21, Steps: 32 | Train Loss: 0.027 Vali Loss: 17.594 Vali Acc: 0.466 Test Loss: 17.594 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 7.73557710647583
Epoch: 22, Steps: 32 | Train Loss: 0.164 Vali Loss: 23.559 Vali Acc: 0.260 Test Loss: 23.559 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 866277
model size : 3.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.417206048965454
Epoch: 1, Steps: 32 | Train Loss: 2.123 Vali Loss: 2.949 Vali Acc: 0.176 Test Loss: 2.949 Test Acc: 0.176
Validation loss decreased (inf --> -0.175543).  Saving model ...
Epoch: 2 cost time: 3.161527395248413
Epoch: 2, Steps: 32 | Train Loss: 1.615 Vali Loss: 3.165 Vali Acc: 0.275 Test Loss: 3.165 Test Acc: 0.275
Validation loss decreased (-0.175543 --> -0.274778).  Saving model ...
Epoch: 3 cost time: 3.102325677871704
Epoch: 3, Steps: 32 | Train Loss: 1.223 Vali Loss: 2.277 Vali Acc: 0.519 Test Loss: 2.277 Test Acc: 0.519
Validation loss decreased (-0.274778 --> -0.519061).  Saving model ...
Epoch: 4 cost time: 3.250322103500366
Epoch: 4, Steps: 32 | Train Loss: 0.429 Vali Loss: 3.448 Vali Acc: 0.336 Test Loss: 3.448 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.197883129119873
Epoch: 5, Steps: 32 | Train Loss: 0.227 Vali Loss: 3.925 Vali Acc: 0.420 Test Loss: 3.925 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.4753222465515137
Epoch: 6, Steps: 32 | Train Loss: 0.188 Vali Loss: 3.952 Vali Acc: 0.443 Test Loss: 3.952 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.4328439235687256
Epoch: 7, Steps: 32 | Train Loss: 0.181 Vali Loss: 7.506 Vali Acc: 0.511 Test Loss: 7.506 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.481895685195923
Epoch: 8, Steps: 32 | Train Loss: 0.168 Vali Loss: 5.087 Vali Acc: 0.557 Test Loss: 5.087 Test Acc: 0.557
Validation loss decreased (-0.519061 --> -0.557201).  Saving model ...
Epoch: 9 cost time: 3.455200433731079
Epoch: 9, Steps: 32 | Train Loss: 0.114 Vali Loss: 4.676 Vali Acc: 0.489 Test Loss: 4.676 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.498961925506592
Epoch: 10, Steps: 32 | Train Loss: 0.339 Vali Loss: 5.909 Vali Acc: 0.504 Test Loss: 5.909 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.484269857406616
Epoch: 11, Steps: 32 | Train Loss: 0.250 Vali Loss: 7.498 Vali Acc: 0.397 Test Loss: 7.498 Test Acc: 0.397
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.399498462677002
Epoch: 12, Steps: 32 | Train Loss: 0.050 Vali Loss: 6.830 Vali Acc: 0.420 Test Loss: 6.830 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.4777753353118896
Epoch: 13, Steps: 32 | Train Loss: 0.226 Vali Loss: 7.510 Vali Acc: 0.450 Test Loss: 7.510 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.513298511505127
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 7.233 Vali Acc: 0.511 Test Loss: 7.233 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.4626896381378174
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 7.103 Vali Acc: 0.496 Test Loss: 7.103 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.4677934646606445
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 7.039 Vali Acc: 0.496 Test Loss: 7.039 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.4939756393432617
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 7.025 Vali Acc: 0.496 Test Loss: 7.025 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.451881170272827
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 7.017 Vali Acc: 0.496 Test Loss: 7.017 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 762757
model size : 3.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.033495187759399
Epoch: 1, Steps: 32 | Train Loss: 1.926 Vali Loss: 1.488 Vali Acc: 0.466 Test Loss: 1.488 Test Acc: 0.466
Validation loss decreased (inf --> -0.465634).  Saving model ...
Epoch: 2 cost time: 4.029911756515503
Epoch: 2, Steps: 32 | Train Loss: 0.849 Vali Loss: 1.868 Vali Acc: 0.458 Test Loss: 1.868 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.977243661880493
Epoch: 3, Steps: 32 | Train Loss: 0.539 Vali Loss: 2.829 Vali Acc: 0.481 Test Loss: 2.829 Test Acc: 0.481
Validation loss decreased (-0.465634 --> -0.480888).  Saving model ...
Epoch: 4 cost time: 4.089797496795654
Epoch: 4, Steps: 32 | Train Loss: 0.332 Vali Loss: 4.976 Vali Acc: 0.313 Test Loss: 4.976 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.9738519191741943
Epoch: 5, Steps: 32 | Train Loss: 0.709 Vali Loss: 4.088 Vali Acc: 0.458 Test Loss: 4.088 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.3741254806518555
Epoch: 6, Steps: 32 | Train Loss: 0.127 Vali Loss: 7.102 Vali Acc: 0.229 Test Loss: 7.102 Test Acc: 0.229
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.465035676956177
Epoch: 7, Steps: 32 | Train Loss: 0.090 Vali Loss: 5.304 Vali Acc: 0.473 Test Loss: 5.304 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.341389417648315
Epoch: 8, Steps: 32 | Train Loss: 0.116 Vali Loss: 7.230 Vali Acc: 0.298 Test Loss: 7.230 Test Acc: 0.298
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.4033308029174805
Epoch: 9, Steps: 32 | Train Loss: 0.171 Vali Loss: 8.150 Vali Acc: 0.489 Test Loss: 8.150 Test Acc: 0.489
Validation loss decreased (-0.480888 --> -0.488468).  Saving model ...
Epoch: 10 cost time: 4.396252155303955
Epoch: 10, Steps: 32 | Train Loss: 0.099 Vali Loss: 7.338 Vali Acc: 0.534 Test Loss: 7.338 Test Acc: 0.534
Validation loss decreased (-0.488468 --> -0.534278).  Saving model ...
Epoch: 11 cost time: 4.479631185531616
Epoch: 11, Steps: 32 | Train Loss: 0.015 Vali Loss: 7.211 Vali Acc: 0.511 Test Loss: 7.211 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.462237119674683
Epoch: 12, Steps: 32 | Train Loss: 0.056 Vali Loss: 12.216 Vali Acc: 0.504 Test Loss: 12.216 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.424068450927734
Epoch: 13, Steps: 32 | Train Loss: 0.763 Vali Loss: 9.159 Vali Acc: 0.412 Test Loss: 9.159 Test Acc: 0.412
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.377296447753906
Epoch: 14, Steps: 32 | Train Loss: 0.548 Vali Loss: 10.734 Vali Acc: 0.351 Test Loss: 10.734 Test Acc: 0.351
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.678804874420166
Epoch: 15, Steps: 32 | Train Loss: 0.434 Vali Loss: 11.885 Vali Acc: 0.412 Test Loss: 11.885 Test Acc: 0.412
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.295217037200928
Epoch: 16, Steps: 32 | Train Loss: 0.269 Vali Loss: 14.002 Vali Acc: 0.282 Test Loss: 14.002 Test Acc: 0.282
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.371487617492676
Epoch: 17, Steps: 32 | Train Loss: 0.224 Vali Loss: 12.662 Vali Acc: 0.397 Test Loss: 12.662 Test Acc: 0.397
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.094056844711304
Epoch: 18, Steps: 32 | Train Loss: 0.302 Vali Loss: 17.365 Vali Acc: 0.534 Test Loss: 17.365 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.283079147338867
Epoch: 19, Steps: 32 | Train Loss: 0.580 Vali Loss: 18.237 Vali Acc: 0.351 Test Loss: 18.237 Test Acc: 0.351
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.9595441818237305
Epoch: 20, Steps: 32 | Train Loss: 0.180 Vali Loss: 19.464 Vali Acc: 0.374 Test Loss: 19.464 Test Acc: 0.374
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 866277
model size : 3.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.518712043762207
Epoch: 1, Steps: 32 | Train Loss: 2.128 Vali Loss: 3.011 Vali Acc: 0.176 Test Loss: 3.011 Test Acc: 0.176
Validation loss decreased (inf --> -0.175542).  Saving model ...
Epoch: 2 cost time: 2.2308297157287598
Epoch: 2, Steps: 32 | Train Loss: 1.591 Vali Loss: 3.243 Vali Acc: 0.275 Test Loss: 3.243 Test Acc: 0.275
Validation loss decreased (-0.175542 --> -0.274777).  Saving model ...
Epoch: 3 cost time: 2.262054681777954
Epoch: 3, Steps: 32 | Train Loss: 1.213 Vali Loss: 2.412 Vali Acc: 0.466 Test Loss: 2.412 Test Acc: 0.466
Validation loss decreased (-0.274777 --> -0.465625).  Saving model ...
Epoch: 4 cost time: 2.252441883087158
Epoch: 4, Steps: 32 | Train Loss: 0.419 Vali Loss: 2.752 Vali Acc: 0.481 Test Loss: 2.752 Test Acc: 0.481
Validation loss decreased (-0.465625 --> -0.480889).  Saving model ...
Epoch: 5 cost time: 2.3030054569244385
Epoch: 5, Steps: 32 | Train Loss: 0.784 Vali Loss: 8.307 Vali Acc: 0.275 Test Loss: 8.307 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.2892792224884033
Epoch: 6, Steps: 32 | Train Loss: 0.220 Vali Loss: 3.811 Vali Acc: 0.397 Test Loss: 3.811 Test Acc: 0.397
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.2244863510131836
Epoch: 7, Steps: 32 | Train Loss: 0.124 Vali Loss: 4.153 Vali Acc: 0.489 Test Loss: 4.153 Test Acc: 0.489
Validation loss decreased (-0.480889 --> -0.488508).  Saving model ...
Epoch: 8 cost time: 2.377622127532959
Epoch: 8, Steps: 32 | Train Loss: 0.029 Vali Loss: 5.581 Vali Acc: 0.511 Test Loss: 5.581 Test Acc: 0.511
Validation loss decreased (-0.488508 --> -0.511395).  Saving model ...
Epoch: 9 cost time: 2.290949821472168
Epoch: 9, Steps: 32 | Train Loss: 0.044 Vali Loss: 7.281 Vali Acc: 0.427 Test Loss: 7.281 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.2716352939605713
Epoch: 10, Steps: 32 | Train Loss: 0.006 Vali Loss: 5.872 Vali Acc: 0.443 Test Loss: 5.872 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.1834487915039062
Epoch: 11, Steps: 32 | Train Loss: 0.406 Vali Loss: 9.202 Vali Acc: 0.481 Test Loss: 9.202 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.2313225269317627
Epoch: 12, Steps: 32 | Train Loss: 0.078 Vali Loss: 6.672 Vali Acc: 0.511 Test Loss: 6.672 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.247899055480957
Epoch: 13, Steps: 32 | Train Loss: 0.090 Vali Loss: 7.544 Vali Acc: 0.511 Test Loss: 7.544 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.4388108253479004
Epoch: 14, Steps: 32 | Train Loss: 0.335 Vali Loss: 11.063 Vali Acc: 0.458 Test Loss: 11.063 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.2497003078460693
Epoch: 15, Steps: 32 | Train Loss: 0.183 Vali Loss: 10.655 Vali Acc: 0.374 Test Loss: 10.655 Test Acc: 0.374
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.222865581512451
Epoch: 16, Steps: 32 | Train Loss: 0.164 Vali Loss: 10.975 Vali Acc: 0.481 Test Loss: 10.975 Test Acc: 0.481
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.1845898628234863
Epoch: 17, Steps: 32 | Train Loss: 0.005 Vali Loss: 9.740 Vali Acc: 0.496 Test Loss: 9.740 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.259256362915039
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 9.090 Vali Acc: 0.473 Test Loss: 9.090 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_TimesNet_UEA_ftM_sl17984_ll0_pl0_el2_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 762757
model size : 3.47MB
