Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 103.51778650283813
Epoch: 1, Steps: 13 | Train Loss: 0.581 Vali Loss: 0.556 Vali Acc: 0.741 Test Loss: 0.556 Test Acc: 0.741
Validation loss decreased (inf --> -0.741458).  Saving model ...
Epoch: 2 cost time: 98.63937878608704
Epoch: 2, Steps: 13 | Train Loss: 0.514 Vali Loss: 0.502 Vali Acc: 0.732 Test Loss: 0.502 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 97.31640791893005
Epoch: 3, Steps: 13 | Train Loss: 0.393 Vali Loss: 0.532 Vali Acc: 0.776 Test Loss: 0.532 Test Acc: 0.776
Validation loss decreased (-0.741458 --> -0.775604).  Saving model ...
Epoch: 4 cost time: 101.16964173316956
Epoch: 4, Steps: 13 | Train Loss: 0.370 Vali Loss: 0.592 Vali Acc: 0.683 Test Loss: 0.592 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 101.04817986488342
Epoch: 5, Steps: 13 | Train Loss: 0.214 Vali Loss: 0.572 Vali Acc: 0.771 Test Loss: 0.572 Test Acc: 0.771
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 95.87175035476685
Epoch: 6, Steps: 13 | Train Loss: 0.196 Vali Loss: 0.907 Vali Acc: 0.502 Test Loss: 0.907 Test Acc: 0.502
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 99.06030869483948
Epoch: 7, Steps: 13 | Train Loss: 0.288 Vali Loss: 1.222 Vali Acc: 0.732 Test Loss: 1.222 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 99.64501333236694
Epoch: 8, Steps: 13 | Train Loss: 0.174 Vali Loss: 0.696 Vali Acc: 0.712 Test Loss: 0.696 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 103.56714463233948
Epoch: 9, Steps: 13 | Train Loss: 0.129 Vali Loss: 0.921 Vali Acc: 0.756 Test Loss: 0.921 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 107.41268968582153
Epoch: 10, Steps: 13 | Train Loss: 0.064 Vali Loss: 0.785 Vali Acc: 0.707 Test Loss: 0.785 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 99.57836842536926
Epoch: 11, Steps: 13 | Train Loss: 0.086 Vali Loss: 1.310 Vali Acc: 0.727 Test Loss: 1.310 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 103.94939112663269
Epoch: 12, Steps: 13 | Train Loss: 0.112 Vali Loss: 0.838 Vali Acc: 0.702 Test Loss: 0.838 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 103.3905816078186
Epoch: 13, Steps: 13 | Train Loss: 0.085 Vali Loss: 0.834 Vali Acc: 0.707 Test Loss: 0.834 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 75110274
model size : 289.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 39.2501654624939
Epoch: 1, Steps: 13 | Train Loss: 0.614 Vali Loss: 0.556 Vali Acc: 0.712 Test Loss: 0.556 Test Acc: 0.712
Validation loss decreased (inf --> -0.712190).  Saving model ...
Epoch: 2 cost time: 37.34487724304199
Epoch: 2, Steps: 13 | Train Loss: 0.457 Vali Loss: 0.529 Vali Acc: 0.746 Test Loss: 0.529 Test Acc: 0.746
Validation loss decreased (-0.712190 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 38.95241069793701
Epoch: 3, Steps: 13 | Train Loss: 0.389 Vali Loss: 0.687 Vali Acc: 0.600 Test Loss: 0.687 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 35.49221992492676
Epoch: 4, Steps: 13 | Train Loss: 0.293 Vali Loss: 0.557 Vali Acc: 0.717 Test Loss: 0.557 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 35.818161964416504
Epoch: 5, Steps: 13 | Train Loss: 0.222 Vali Loss: 0.742 Vali Acc: 0.595 Test Loss: 0.742 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 33.83725905418396
Epoch: 6, Steps: 13 | Train Loss: 0.317 Vali Loss: 0.624 Vali Acc: 0.732 Test Loss: 0.624 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 37.52243685722351
Epoch: 7, Steps: 13 | Train Loss: 0.122 Vali Loss: 0.653 Vali Acc: 0.712 Test Loss: 0.653 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 34.24201226234436
Epoch: 8, Steps: 13 | Train Loss: 0.096 Vali Loss: 0.756 Vali Acc: 0.707 Test Loss: 0.756 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 35.29153084754944
Epoch: 9, Steps: 13 | Train Loss: 0.055 Vali Loss: 0.770 Vali Acc: 0.702 Test Loss: 0.770 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 39.27357530593872
Epoch: 10, Steps: 13 | Train Loss: 0.070 Vali Loss: 0.934 Vali Acc: 0.590 Test Loss: 0.934 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 37.64574408531189
Epoch: 11, Steps: 13 | Train Loss: 0.046 Vali Loss: 1.469 Vali Acc: 0.727 Test Loss: 1.469 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 36.95897150039673
Epoch: 12, Steps: 13 | Train Loss: 0.093 Vali Loss: 1.043 Vali Acc: 0.668 Test Loss: 1.043 Test Acc: 0.668
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 22154114
model size : 86.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 83.85470795631409
Epoch: 1, Steps: 13 | Train Loss: 0.579 Vali Loss: 0.556 Vali Acc: 0.737 Test Loss: 0.556 Test Acc: 0.737
Validation loss decreased (inf --> -0.736580).  Saving model ...
Epoch: 2 cost time: 76.12426781654358
Epoch: 2, Steps: 13 | Train Loss: 0.528 Vali Loss: 0.499 Vali Acc: 0.761 Test Loss: 0.499 Test Acc: 0.761
Validation loss decreased (-0.736580 --> -0.760971).  Saving model ...
Epoch: 3 cost time: 76.5555202960968
Epoch: 3, Steps: 13 | Train Loss: 0.429 Vali Loss: 0.518 Vali Acc: 0.737 Test Loss: 0.518 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 75.83134078979492
Epoch: 4, Steps: 13 | Train Loss: 0.412 Vali Loss: 0.570 Vali Acc: 0.746 Test Loss: 0.570 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 71.63918209075928
Epoch: 5, Steps: 13 | Train Loss: 0.278 Vali Loss: 0.566 Vali Acc: 0.717 Test Loss: 0.566 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 75.44428849220276
Epoch: 6, Steps: 13 | Train Loss: 0.199 Vali Loss: 0.685 Vali Acc: 0.741 Test Loss: 0.685 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 73.39527153968811
Epoch: 7, Steps: 13 | Train Loss: 0.194 Vali Loss: 0.649 Vali Acc: 0.771 Test Loss: 0.649 Test Acc: 0.771
Validation loss decreased (-0.760971 --> -0.770725).  Saving model ...
Epoch: 8 cost time: 74.05789494514465
Epoch: 8, Steps: 13 | Train Loss: 0.068 Vali Loss: 0.659 Vali Acc: 0.688 Test Loss: 0.659 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 77.03909659385681
Epoch: 9, Steps: 13 | Train Loss: 0.109 Vali Loss: 1.086 Vali Acc: 0.741 Test Loss: 1.086 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 74.68294334411621
Epoch: 10, Steps: 13 | Train Loss: 0.050 Vali Loss: 0.711 Vali Acc: 0.727 Test Loss: 0.711 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 78.40350604057312
Epoch: 11, Steps: 13 | Train Loss: 0.023 Vali Loss: 0.867 Vali Acc: 0.732 Test Loss: 0.867 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 72.2622606754303
Epoch: 12, Steps: 13 | Train Loss: 0.012 Vali Loss: 0.839 Vali Acc: 0.741 Test Loss: 0.839 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 72.97053146362305
Epoch: 13, Steps: 13 | Train Loss: 0.019 Vali Loss: 0.867 Vali Acc: 0.717 Test Loss: 0.867 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 71.52019906044006
Epoch: 14, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.552 Vali Acc: 0.737 Test Loss: 1.552 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 77.87212085723877
Epoch: 15, Steps: 13 | Train Loss: 0.023 Vali Loss: 1.121 Vali Acc: 0.741 Test Loss: 1.121 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 77.65898871421814
Epoch: 16, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.018 Vali Acc: 0.717 Test Loss: 1.018 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 71.88294053077698
Epoch: 17, Steps: 13 | Train Loss: 0.031 Vali Loss: 1.099 Vali Acc: 0.683 Test Loss: 1.099 Test Acc: 0.683
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 75110274
model size : 289.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 30.38891863822937
Epoch: 1, Steps: 13 | Train Loss: 0.611 Vali Loss: 0.555 Vali Acc: 0.712 Test Loss: 0.555 Test Acc: 0.712
Validation loss decreased (inf --> -0.712190).  Saving model ...
Epoch: 2 cost time: 25.986509561538696
Epoch: 2, Steps: 13 | Train Loss: 0.458 Vali Loss: 0.538 Vali Acc: 0.712 Test Loss: 0.538 Test Acc: 0.712
Validation loss decreased (-0.712190 --> -0.712190).  Saving model ...
Epoch: 3 cost time: 28.29533362388611
Epoch: 3, Steps: 13 | Train Loss: 0.395 Vali Loss: 0.631 Vali Acc: 0.639 Test Loss: 0.631 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 28.812604904174805
Epoch: 4, Steps: 13 | Train Loss: 0.285 Vali Loss: 0.543 Vali Acc: 0.727 Test Loss: 0.543 Test Acc: 0.727
Validation loss decreased (-0.712190 --> -0.726824).  Saving model ...
Epoch: 5 cost time: 26.411689519882202
Epoch: 5, Steps: 13 | Train Loss: 0.219 Vali Loss: 0.877 Vali Acc: 0.537 Test Loss: 0.877 Test Acc: 0.537
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 27.342358589172363
Epoch: 6, Steps: 13 | Train Loss: 0.365 Vali Loss: 0.652 Vali Acc: 0.673 Test Loss: 0.652 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 27.558738470077515
Epoch: 7, Steps: 13 | Train Loss: 0.171 Vali Loss: 0.660 Vali Acc: 0.727 Test Loss: 0.660 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 28.759872436523438
Epoch: 8, Steps: 13 | Train Loss: 0.126 Vali Loss: 0.669 Vali Acc: 0.698 Test Loss: 0.669 Test Acc: 0.698
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 27.06620955467224
Epoch: 9, Steps: 13 | Train Loss: 0.096 Vali Loss: 0.917 Vali Acc: 0.756 Test Loss: 0.917 Test Acc: 0.756
Validation loss decreased (-0.726824 --> -0.756088).  Saving model ...
Epoch: 10 cost time: 25.5675528049469
Epoch: 10, Steps: 13 | Train Loss: 0.062 Vali Loss: 0.915 Vali Acc: 0.712 Test Loss: 0.915 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 28.22617745399475
Epoch: 11, Steps: 13 | Train Loss: 0.078 Vali Loss: 0.924 Vali Acc: 0.737 Test Loss: 0.924 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 27.949853897094727
Epoch: 12, Steps: 13 | Train Loss: 0.054 Vali Loss: 1.148 Vali Acc: 0.537 Test Loss: 1.148 Test Acc: 0.537
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 27.404375076293945
Epoch: 13, Steps: 13 | Train Loss: 0.105 Vali Loss: 2.209 Vali Acc: 0.429 Test Loss: 2.209 Test Acc: 0.429
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 27.74724841117859
Epoch: 14, Steps: 13 | Train Loss: 0.044 Vali Loss: 1.270 Vali Acc: 0.746 Test Loss: 1.270 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 27.822115659713745
Epoch: 15, Steps: 13 | Train Loss: 0.031 Vali Loss: 1.138 Vali Acc: 0.732 Test Loss: 1.138 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 28.490514039993286
Epoch: 16, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.091 Vali Acc: 0.702 Test Loss: 1.091 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 26.57032608985901
Epoch: 17, Steps: 13 | Train Loss: 0.020 Vali Loss: 1.099 Vali Acc: 0.702 Test Loss: 1.099 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 27.796990633010864
Epoch: 18, Steps: 13 | Train Loss: 0.037 Vali Loss: 1.241 Vali Acc: 0.659 Test Loss: 1.241 Test Acc: 0.659
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 29.30250310897827
Epoch: 19, Steps: 13 | Train Loss: 0.116 Vali Loss: 1.505 Vali Acc: 0.746 Test Loss: 1.505 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 22154114
model size : 86.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 44.340498208999634
Epoch: 1, Steps: 13 | Train Loss: 0.580 Vali Loss: 0.556 Vali Acc: 0.732 Test Loss: 0.556 Test Acc: 0.732
Validation loss decreased (inf --> -0.731702).  Saving model ...
Epoch: 2 cost time: 41.78449296951294
Epoch: 2, Steps: 13 | Train Loss: 0.522 Vali Loss: 0.505 Vali Acc: 0.766 Test Loss: 0.505 Test Acc: 0.766
Validation loss decreased (-0.731702 --> -0.765849).  Saving model ...
Epoch: 3 cost time: 42.217360734939575
Epoch: 3, Steps: 13 | Train Loss: 0.826 Vali Loss: 0.585 Vali Acc: 0.668 Test Loss: 0.585 Test Acc: 0.668
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 40.22608518600464
Epoch: 4, Steps: 13 | Train Loss: 0.344 Vali Loss: 0.750 Vali Acc: 0.546 Test Loss: 0.750 Test Acc: 0.546
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 42.785510301589966
Epoch: 5, Steps: 13 | Train Loss: 0.231 Vali Loss: 0.555 Vali Acc: 0.766 Test Loss: 0.555 Test Acc: 0.766
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 40.51194620132446
Epoch: 6, Steps: 13 | Train Loss: 0.126 Vali Loss: 1.075 Vali Acc: 0.727 Test Loss: 1.075 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 41.35284638404846
Epoch: 7, Steps: 13 | Train Loss: 0.125 Vali Loss: 0.689 Vali Acc: 0.746 Test Loss: 0.689 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 43.75165104866028
Epoch: 8, Steps: 13 | Train Loss: 0.096 Vali Loss: 0.952 Vali Acc: 0.746 Test Loss: 0.952 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 41.574339389801025
Epoch: 9, Steps: 13 | Train Loss: 0.569 Vali Loss: 1.251 Vali Acc: 0.722 Test Loss: 1.251 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 44.27194118499756
Epoch: 10, Steps: 13 | Train Loss: 0.475 Vali Loss: 1.037 Vali Acc: 0.737 Test Loss: 1.037 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 41.06353425979614
Epoch: 11, Steps: 13 | Train Loss: 0.325 Vali Loss: 0.823 Vali Acc: 0.707 Test Loss: 0.823 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 41.36211681365967
Epoch: 12, Steps: 13 | Train Loss: 0.274 Vali Loss: 0.970 Vali Acc: 0.717 Test Loss: 0.970 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 75110274
model size : 289.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 18.73369264602661
Epoch: 1, Steps: 13 | Train Loss: 0.611 Vali Loss: 0.557 Vali Acc: 0.712 Test Loss: 0.557 Test Acc: 0.712
Validation loss decreased (inf --> -0.712190).  Saving model ...
Epoch: 2 cost time: 16.286481380462646
Epoch: 2, Steps: 13 | Train Loss: 0.464 Vali Loss: 0.546 Vali Acc: 0.712 Test Loss: 0.546 Test Acc: 0.712
Validation loss decreased (-0.712190 --> -0.712190).  Saving model ...
Epoch: 3 cost time: 17.030710220336914
Epoch: 3, Steps: 13 | Train Loss: 0.404 Vali Loss: 0.679 Vali Acc: 0.605 Test Loss: 0.679 Test Acc: 0.605
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 16.89988136291504
Epoch: 4, Steps: 13 | Train Loss: 0.288 Vali Loss: 0.540 Vali Acc: 0.717 Test Loss: 0.540 Test Acc: 0.717
Validation loss decreased (-0.712190 --> -0.717068).  Saving model ...
Epoch: 5 cost time: 15.223998546600342
Epoch: 5, Steps: 13 | Train Loss: 0.204 Vali Loss: 0.854 Vali Acc: 0.532 Test Loss: 0.854 Test Acc: 0.532
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 14.91129732131958
Epoch: 6, Steps: 13 | Train Loss: 0.519 Vali Loss: 0.615 Vali Acc: 0.707 Test Loss: 0.615 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 13.98108696937561
Epoch: 7, Steps: 13 | Train Loss: 0.246 Vali Loss: 1.470 Vali Acc: 0.717 Test Loss: 1.470 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 15.997101783752441
Epoch: 8, Steps: 13 | Train Loss: 0.242 Vali Loss: 0.901 Vali Acc: 0.551 Test Loss: 0.901 Test Acc: 0.551
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 16.25107455253601
Epoch: 9, Steps: 13 | Train Loss: 0.198 Vali Loss: 1.360 Vali Acc: 0.717 Test Loss: 1.360 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 14.78659462928772
Epoch: 10, Steps: 13 | Train Loss: 0.486 Vali Loss: 1.309 Vali Acc: 0.732 Test Loss: 1.309 Test Acc: 0.732
Validation loss decreased (-0.717068 --> -0.731694).  Saving model ...
Epoch: 11 cost time: 15.97214674949646
Epoch: 11, Steps: 13 | Train Loss: 0.104 Vali Loss: 0.813 Vali Acc: 0.702 Test Loss: 0.813 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 16.536250352859497
Epoch: 12, Steps: 13 | Train Loss: 0.056 Vali Loss: 0.881 Vali Acc: 0.707 Test Loss: 0.881 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 15.443697452545166
Epoch: 13, Steps: 13 | Train Loss: 0.054 Vali Loss: 1.054 Vali Acc: 0.624 Test Loss: 1.054 Test Acc: 0.624
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 15.690246105194092
Epoch: 14, Steps: 13 | Train Loss: 0.058 Vali Loss: 1.055 Vali Acc: 0.673 Test Loss: 1.055 Test Acc: 0.673
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 15.620821237564087
Epoch: 15, Steps: 13 | Train Loss: 0.037 Vali Loss: 1.362 Vali Acc: 0.737 Test Loss: 1.362 Test Acc: 0.737
Validation loss decreased (-0.731694 --> -0.736572).  Saving model ...
Epoch: 16 cost time: 15.727875471115112
Epoch: 16, Steps: 13 | Train Loss: 0.018 Vali Loss: 1.027 Vali Acc: 0.688 Test Loss: 1.027 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 14.679304122924805
Epoch: 17, Steps: 13 | Train Loss: 0.062 Vali Loss: 1.690 Vali Acc: 0.746 Test Loss: 1.690 Test Acc: 0.746
Validation loss decreased (-0.736572 --> -0.746325).  Saving model ...
Epoch: 18 cost time: 15.324106216430664
Epoch: 18, Steps: 13 | Train Loss: 0.057 Vali Loss: 1.758 Vali Acc: 0.741 Test Loss: 1.758 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 15.85117244720459
Epoch: 19, Steps: 13 | Train Loss: 0.034 Vali Loss: 1.339 Vali Acc: 0.678 Test Loss: 1.339 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 15.194604635238647
Epoch: 20, Steps: 13 | Train Loss: 0.031 Vali Loss: 1.608 Vali Acc: 0.585 Test Loss: 1.608 Test Acc: 0.585
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 15.967919111251831
Epoch: 21, Steps: 13 | Train Loss: 0.059 Vali Loss: 1.331 Vali Acc: 0.678 Test Loss: 1.331 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 15.804213285446167
Epoch: 22, Steps: 13 | Train Loss: 0.036 Vali Loss: 1.269 Vali Acc: 0.688 Test Loss: 1.269 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 15.61080527305603
Epoch: 23, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.323 Vali Acc: 0.654 Test Loss: 1.323 Test Acc: 0.654
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 15.719200611114502
Epoch: 24, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.485 Vali Acc: 0.634 Test Loss: 1.485 Test Acc: 0.634
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 15.826919794082642
Epoch: 25, Steps: 13 | Train Loss: 0.014 Vali Loss: 1.435 Vali Acc: 0.702 Test Loss: 1.435 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 15.915759086608887
Epoch: 26, Steps: 13 | Train Loss: 0.010 Vali Loss: 2.252 Vali Acc: 0.737 Test Loss: 2.252 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 15.607276916503906
Epoch: 27, Steps: 13 | Train Loss: 0.063 Vali Loss: 1.838 Vali Acc: 0.717 Test Loss: 1.838 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 22154114
model size : 86.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 52.25372815132141
Epoch: 1, Steps: 13 | Train Loss: 0.604 Vali Loss: 0.531 Vali Acc: 0.746 Test Loss: 0.531 Test Acc: 0.746
Validation loss decreased (inf --> -0.746336).  Saving model ...
Epoch: 2 cost time: 52.07345509529114
Epoch: 2, Steps: 13 | Train Loss: 0.497 Vali Loss: 0.652 Vali Acc: 0.595 Test Loss: 0.652 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 51.919172048568726
Epoch: 3, Steps: 13 | Train Loss: 0.470 Vali Loss: 0.523 Vali Acc: 0.771 Test Loss: 0.523 Test Acc: 0.771
Validation loss decreased (-0.746336 --> -0.770726).  Saving model ...
Epoch: 4 cost time: 48.49727487564087
Epoch: 4, Steps: 13 | Train Loss: 0.805 Vali Loss: 0.924 Vali Acc: 0.478 Test Loss: 0.924 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 46.81959247589111
Epoch: 5, Steps: 13 | Train Loss: 0.404 Vali Loss: 0.542 Vali Acc: 0.785 Test Loss: 0.542 Test Acc: 0.785
Validation loss decreased (-0.770726 --> -0.785360).  Saving model ...
Epoch: 6 cost time: 47.710750341415405
Epoch: 6, Steps: 13 | Train Loss: 0.409 Vali Loss: 0.842 Vali Acc: 0.741 Test Loss: 0.842 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 49.94651198387146
Epoch: 7, Steps: 13 | Train Loss: 0.178 Vali Loss: 0.686 Vali Acc: 0.659 Test Loss: 0.686 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 51.36138200759888
Epoch: 8, Steps: 13 | Train Loss: 0.275 Vali Loss: 0.790 Vali Acc: 0.761 Test Loss: 0.790 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 51.42192459106445
Epoch: 9, Steps: 13 | Train Loss: 0.162 Vali Loss: 0.740 Vali Acc: 0.727 Test Loss: 0.740 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 45.11033630371094
Epoch: 10, Steps: 13 | Train Loss: 0.071 Vali Loss: 0.684 Vali Acc: 0.751 Test Loss: 0.684 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 49.51597023010254
Epoch: 11, Steps: 13 | Train Loss: 0.067 Vali Loss: 0.768 Vali Acc: 0.712 Test Loss: 0.768 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 49.85218620300293
Epoch: 12, Steps: 13 | Train Loss: 0.051 Vali Loss: 0.889 Vali Acc: 0.746 Test Loss: 0.889 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 51.67487931251526
Epoch: 13, Steps: 13 | Train Loss: 0.068 Vali Loss: 0.856 Vali Acc: 0.712 Test Loss: 0.856 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 51.22923445701599
Epoch: 14, Steps: 13 | Train Loss: 0.025 Vali Loss: 0.959 Vali Acc: 0.722 Test Loss: 0.959 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 49.63257575035095
Epoch: 15, Steps: 13 | Train Loss: 0.075 Vali Loss: 1.409 Vali Acc: 0.741 Test Loss: 1.409 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7853658536585366
model parameter : 37620610
model size : 145.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 21.384297609329224
Epoch: 1, Steps: 13 | Train Loss: 0.666 Vali Loss: 0.577 Vali Acc: 0.702 Test Loss: 0.577 Test Acc: 0.702
Validation loss decreased (inf --> -0.702433).  Saving model ...
Epoch: 2 cost time: 19.53070902824402
Epoch: 2, Steps: 13 | Train Loss: 0.528 Vali Loss: 0.550 Vali Acc: 0.717 Test Loss: 0.550 Test Acc: 0.717
Validation loss decreased (-0.702433 --> -0.717068).  Saving model ...
Epoch: 3 cost time: 18.45165467262268
Epoch: 3, Steps: 13 | Train Loss: 0.455 Vali Loss: 0.512 Vali Acc: 0.780 Test Loss: 0.512 Test Acc: 0.780
Validation loss decreased (-0.717068 --> -0.780483).  Saving model ...
Epoch: 4 cost time: 18.018996238708496
Epoch: 4, Steps: 13 | Train Loss: 0.578 Vali Loss: 0.585 Vali Acc: 0.766 Test Loss: 0.585 Test Acc: 0.766
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 18.722384452819824
Epoch: 5, Steps: 13 | Train Loss: 0.404 Vali Loss: 1.159 Vali Acc: 0.722 Test Loss: 1.159 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 18.523660898208618
Epoch: 6, Steps: 13 | Train Loss: 0.262 Vali Loss: 0.621 Vali Acc: 0.741 Test Loss: 0.621 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 18.455422401428223
Epoch: 7, Steps: 13 | Train Loss: 0.148 Vali Loss: 0.650 Vali Acc: 0.732 Test Loss: 0.650 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 19.027196884155273
Epoch: 8, Steps: 13 | Train Loss: 0.109 Vali Loss: 0.713 Vali Acc: 0.732 Test Loss: 0.713 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 17.800872564315796
Epoch: 9, Steps: 13 | Train Loss: 0.052 Vali Loss: 0.725 Vali Acc: 0.663 Test Loss: 0.725 Test Acc: 0.663
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 19.22174620628357
Epoch: 10, Steps: 13 | Train Loss: 0.072 Vali Loss: 1.283 Vali Acc: 0.537 Test Loss: 1.283 Test Acc: 0.537
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 19.144773244857788
Epoch: 11, Steps: 13 | Train Loss: 0.029 Vali Loss: 0.962 Vali Acc: 0.722 Test Loss: 0.962 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 18.25611925125122
Epoch: 12, Steps: 13 | Train Loss: 0.018 Vali Loss: 0.931 Vali Acc: 0.624 Test Loss: 0.931 Test Acc: 0.624
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 18.97543168067932
Epoch: 13, Steps: 13 | Train Loss: 0.017 Vali Loss: 1.013 Vali Acc: 0.654 Test Loss: 1.013 Test Acc: 0.654
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7804878048780488
model parameter : 11142018
model size : 44.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 40.03255105018616
Epoch: 1, Steps: 13 | Train Loss: 0.607 Vali Loss: 0.528 Vali Acc: 0.751 Test Loss: 0.528 Test Acc: 0.751
Validation loss decreased (inf --> -0.751214).  Saving model ...
Epoch: 2 cost time: 37.97413516044617
Epoch: 2, Steps: 13 | Train Loss: 0.518 Vali Loss: 0.582 Vali Acc: 0.649 Test Loss: 0.582 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 38.757461071014404
Epoch: 3, Steps: 13 | Train Loss: 0.466 Vali Loss: 0.503 Vali Acc: 0.780 Test Loss: 0.503 Test Acc: 0.780
Validation loss decreased (-0.751214 --> -0.780483).  Saving model ...
Epoch: 4 cost time: 38.369121074676514
Epoch: 4, Steps: 13 | Train Loss: 0.849 Vali Loss: 1.061 Vali Acc: 0.415 Test Loss: 1.061 Test Acc: 0.415
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 35.83824610710144
Epoch: 5, Steps: 13 | Train Loss: 0.368 Vali Loss: 0.515 Vali Acc: 0.776 Test Loss: 0.515 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 36.12628126144409
Epoch: 6, Steps: 13 | Train Loss: 0.201 Vali Loss: 0.964 Vali Acc: 0.502 Test Loss: 0.964 Test Acc: 0.502
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 36.877814531326294
Epoch: 7, Steps: 13 | Train Loss: 0.397 Vali Loss: 1.203 Vali Acc: 0.488 Test Loss: 1.203 Test Acc: 0.488
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 36.38976693153381
Epoch: 8, Steps: 13 | Train Loss: 0.337 Vali Loss: 0.943 Vali Acc: 0.532 Test Loss: 0.943 Test Acc: 0.532
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 35.74010920524597
Epoch: 9, Steps: 13 | Train Loss: 0.112 Vali Loss: 0.689 Vali Acc: 0.688 Test Loss: 0.689 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 38.19480323791504
Epoch: 10, Steps: 13 | Train Loss: 0.051 Vali Loss: 0.742 Vali Acc: 0.659 Test Loss: 0.742 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 38.98678660392761
Epoch: 11, Steps: 13 | Train Loss: 0.037 Vali Loss: 0.880 Vali Acc: 0.595 Test Loss: 0.880 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 37.446810483932495
Epoch: 12, Steps: 13 | Train Loss: 0.039 Vali Loss: 0.974 Vali Acc: 0.585 Test Loss: 0.974 Test Acc: 0.585
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 38.092554569244385
Epoch: 13, Steps: 13 | Train Loss: 0.016 Vali Loss: 0.947 Vali Acc: 0.717 Test Loss: 0.947 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7804878048780488
model parameter : 37620610
model size : 145.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 17.206963062286377
Epoch: 1, Steps: 13 | Train Loss: 0.665 Vali Loss: 0.578 Vali Acc: 0.712 Test Loss: 0.578 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 14.739211559295654
Epoch: 2, Steps: 13 | Train Loss: 0.529 Vali Loss: 0.554 Vali Acc: 0.712 Test Loss: 0.554 Test Acc: 0.712
Validation loss decreased (-0.712189 --> -0.712190).  Saving model ...
Epoch: 3 cost time: 15.385270595550537
Epoch: 3, Steps: 13 | Train Loss: 0.457 Vali Loss: 0.510 Vali Acc: 0.776 Test Loss: 0.510 Test Acc: 0.776
Validation loss decreased (-0.712190 --> -0.775605).  Saving model ...
Epoch: 4 cost time: 15.490819454193115
Epoch: 4, Steps: 13 | Train Loss: 0.583 Vali Loss: 0.605 Vali Acc: 0.751 Test Loss: 0.605 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 14.800815105438232
Epoch: 5, Steps: 13 | Train Loss: 0.427 Vali Loss: 1.095 Vali Acc: 0.727 Test Loss: 1.095 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 14.889953136444092
Epoch: 6, Steps: 13 | Train Loss: 0.271 Vali Loss: 0.622 Vali Acc: 0.761 Test Loss: 0.622 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 17.364441394805908
Epoch: 7, Steps: 13 | Train Loss: 0.153 Vali Loss: 0.673 Vali Acc: 0.741 Test Loss: 0.673 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 17.08853793144226
Epoch: 8, Steps: 13 | Train Loss: 0.143 Vali Loss: 0.810 Vali Acc: 0.751 Test Loss: 0.810 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 17.059810400009155
Epoch: 9, Steps: 13 | Train Loss: 0.058 Vali Loss: 0.698 Vali Acc: 0.722 Test Loss: 0.698 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 16.39820170402527
Epoch: 10, Steps: 13 | Train Loss: 0.093 Vali Loss: 1.140 Vali Acc: 0.566 Test Loss: 1.140 Test Acc: 0.566
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 17.10575580596924
Epoch: 11, Steps: 13 | Train Loss: 0.036 Vali Loss: 0.904 Vali Acc: 0.717 Test Loss: 0.904 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 15.950011253356934
Epoch: 12, Steps: 13 | Train Loss: 0.024 Vali Loss: 0.881 Vali Acc: 0.654 Test Loss: 0.881 Test Acc: 0.654
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 15.886590957641602
Epoch: 13, Steps: 13 | Train Loss: 0.017 Vali Loss: 0.867 Vali Acc: 0.683 Test Loss: 0.867 Test Acc: 0.683
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 11142018
model size : 44.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 26.706819534301758
Epoch: 1, Steps: 13 | Train Loss: 0.603 Vali Loss: 0.529 Vali Acc: 0.746 Test Loss: 0.529 Test Acc: 0.746
Validation loss decreased (inf --> -0.746336).  Saving model ...
Epoch: 2 cost time: 24.619192838668823
Epoch: 2, Steps: 13 | Train Loss: 0.524 Vali Loss: 0.574 Vali Acc: 0.663 Test Loss: 0.574 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 24.361850261688232
Epoch: 3, Steps: 13 | Train Loss: 0.455 Vali Loss: 0.533 Vali Acc: 0.746 Test Loss: 0.533 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 22.139594078063965
Epoch: 4, Steps: 13 | Train Loss: 0.675 Vali Loss: 0.558 Vali Acc: 0.732 Test Loss: 0.558 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 23.764028549194336
Epoch: 5, Steps: 13 | Train Loss: 0.909 Vali Loss: 2.318 Vali Acc: 0.322 Test Loss: 2.318 Test Acc: 0.322
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 24.79666519165039
Epoch: 6, Steps: 13 | Train Loss: 0.873 Vali Loss: 0.624 Vali Acc: 0.659 Test Loss: 0.624 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 24.55920672416687
Epoch: 7, Steps: 13 | Train Loss: 0.610 Vali Loss: 0.659 Vali Acc: 0.629 Test Loss: 0.659 Test Acc: 0.629
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 23.377554416656494
Epoch: 8, Steps: 13 | Train Loss: 0.259 Vali Loss: 0.646 Vali Acc: 0.737 Test Loss: 0.646 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 23.18927526473999
Epoch: 9, Steps: 13 | Train Loss: 0.287 Vali Loss: 0.818 Vali Acc: 0.776 Test Loss: 0.818 Test Acc: 0.776
Validation loss decreased (-0.746336 --> -0.775602).  Saving model ...
Epoch: 10 cost time: 24.693578243255615
Epoch: 10, Steps: 13 | Train Loss: 0.295 Vali Loss: 0.743 Vali Acc: 0.717 Test Loss: 0.743 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 24.434903383255005
Epoch: 11, Steps: 13 | Train Loss: 0.081 Vali Loss: 0.866 Vali Acc: 0.624 Test Loss: 0.866 Test Acc: 0.624
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 24.503424167633057
Epoch: 12, Steps: 13 | Train Loss: 0.472 Vali Loss: 0.925 Vali Acc: 0.580 Test Loss: 0.925 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 22.869445323944092
Epoch: 13, Steps: 13 | Train Loss: 0.485 Vali Loss: 1.388 Vali Acc: 0.737 Test Loss: 1.388 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 24.030718326568604
Epoch: 14, Steps: 13 | Train Loss: 0.223 Vali Loss: 0.949 Vali Acc: 0.610 Test Loss: 0.949 Test Acc: 0.610
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 25.111897945404053
Epoch: 15, Steps: 13 | Train Loss: 0.608 Vali Loss: 1.090 Vali Acc: 0.746 Test Loss: 1.090 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 25.13886785507202
Epoch: 16, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.385 Vali Acc: 0.751 Test Loss: 1.385 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 24.73804783821106
Epoch: 17, Steps: 13 | Train Loss: 0.437 Vali Loss: 1.044 Vali Acc: 0.644 Test Loss: 1.044 Test Acc: 0.644
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 23.03943371772766
Epoch: 18, Steps: 13 | Train Loss: 0.115 Vali Loss: 1.322 Vali Acc: 0.605 Test Loss: 1.322 Test Acc: 0.605
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 24.274048805236816
Epoch: 19, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.129 Vali Acc: 0.654 Test Loss: 1.129 Test Acc: 0.654
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 37620610
model size : 145.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 12.432258605957031
Epoch: 1, Steps: 13 | Train Loss: 0.664 Vali Loss: 0.576 Vali Acc: 0.722 Test Loss: 0.576 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 10.73912763595581
Epoch: 2, Steps: 13 | Train Loss: 0.529 Vali Loss: 0.553 Vali Acc: 0.712 Test Loss: 0.553 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.685246467590332
Epoch: 3, Steps: 13 | Train Loss: 0.456 Vali Loss: 0.518 Vali Acc: 0.771 Test Loss: 0.518 Test Acc: 0.771
Validation loss decreased (-0.721945 --> -0.770727).  Saving model ...
Epoch: 4 cost time: 10.658417224884033
Epoch: 4, Steps: 13 | Train Loss: 0.467 Vali Loss: 0.891 Vali Acc: 0.727 Test Loss: 0.891 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.861592769622803
Epoch: 5, Steps: 13 | Train Loss: 0.465 Vali Loss: 1.367 Vali Acc: 0.722 Test Loss: 1.367 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 9.66537618637085
Epoch: 6, Steps: 13 | Train Loss: 0.605 Vali Loss: 0.650 Vali Acc: 0.761 Test Loss: 0.650 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 10.174155950546265
Epoch: 7, Steps: 13 | Train Loss: 0.296 Vali Loss: 0.658 Vali Acc: 0.746 Test Loss: 0.658 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 10.763254404067993
Epoch: 8, Steps: 13 | Train Loss: 0.114 Vali Loss: 0.769 Vali Acc: 0.610 Test Loss: 0.769 Test Acc: 0.610
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 10.730494022369385
Epoch: 9, Steps: 13 | Train Loss: 0.109 Vali Loss: 0.896 Vali Acc: 0.761 Test Loss: 0.896 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 10.647747039794922
Epoch: 10, Steps: 13 | Train Loss: 0.100 Vali Loss: 0.947 Vali Acc: 0.610 Test Loss: 0.947 Test Acc: 0.610
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 10.489057779312134
Epoch: 11, Steps: 13 | Train Loss: 0.515 Vali Loss: 0.893 Vali Acc: 0.683 Test Loss: 0.893 Test Acc: 0.683
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 10.677909135818481
Epoch: 12, Steps: 13 | Train Loss: 0.081 Vali Loss: 0.824 Vali Acc: 0.746 Test Loss: 0.824 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 10.6334068775177
Epoch: 13, Steps: 13 | Train Loss: 0.037 Vali Loss: 1.135 Vali Acc: 0.751 Test Loss: 1.135 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 11142018
model size : 44.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 63.16154146194458
Epoch: 1, Steps: 13 | Train Loss: 0.587 Vali Loss: 0.546 Vali Acc: 0.741 Test Loss: 0.546 Test Acc: 0.741
Validation loss decreased (inf --> -0.741458).  Saving model ...
Epoch: 2 cost time: 65.52822422981262
Epoch: 2, Steps: 13 | Train Loss: 0.510 Vali Loss: 0.515 Vali Acc: 0.761 Test Loss: 0.515 Test Acc: 0.761
Validation loss decreased (-0.741458 --> -0.760970).  Saving model ...
Epoch: 3 cost time: 60.98413133621216
Epoch: 3, Steps: 13 | Train Loss: 0.406 Vali Loss: 0.503 Vali Acc: 0.776 Test Loss: 0.503 Test Acc: 0.776
Validation loss decreased (-0.760970 --> -0.775605).  Saving model ...
Epoch: 4 cost time: 63.812782287597656
Epoch: 4, Steps: 13 | Train Loss: 0.335 Vali Loss: 0.510 Vali Acc: 0.771 Test Loss: 0.510 Test Acc: 0.771
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 59.505085706710815
Epoch: 5, Steps: 13 | Train Loss: 0.312 Vali Loss: 0.670 Vali Acc: 0.746 Test Loss: 0.670 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 58.436116456985474
Epoch: 6, Steps: 13 | Train Loss: 0.269 Vali Loss: 0.580 Vali Acc: 0.751 Test Loss: 0.580 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 57.357746601104736
Epoch: 7, Steps: 13 | Train Loss: 0.203 Vali Loss: 0.750 Vali Acc: 0.756 Test Loss: 0.750 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 62.65407919883728
Epoch: 8, Steps: 13 | Train Loss: 0.199 Vali Loss: 0.614 Vali Acc: 0.717 Test Loss: 0.614 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 58.21261715888977
Epoch: 9, Steps: 13 | Train Loss: 0.119 Vali Loss: 0.649 Vali Acc: 0.766 Test Loss: 0.649 Test Acc: 0.766
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 61.23534154891968
Epoch: 10, Steps: 13 | Train Loss: 0.103 Vali Loss: 0.992 Vali Acc: 0.527 Test Loss: 0.992 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 59.51929521560669
Epoch: 11, Steps: 13 | Train Loss: 0.111 Vali Loss: 0.701 Vali Acc: 0.649 Test Loss: 0.701 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 63.04927659034729
Epoch: 12, Steps: 13 | Train Loss: 0.088 Vali Loss: 0.925 Vali Acc: 0.746 Test Loss: 0.925 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 59.60064101219177
Epoch: 13, Steps: 13 | Train Loss: 0.058 Vali Loss: 0.725 Vali Acc: 0.702 Test Loss: 0.725 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 37558210
model size : 144.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 26.03753924369812
Epoch: 1, Steps: 13 | Train Loss: 0.611 Vali Loss: 0.591 Vali Acc: 0.722 Test Loss: 0.591 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 24.42150092124939
Epoch: 2, Steps: 13 | Train Loss: 0.560 Vali Loss: 0.773 Vali Acc: 0.722 Test Loss: 0.773 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 23.20140266418457
Epoch: 3, Steps: 13 | Train Loss: 0.551 Vali Loss: 0.630 Vali Acc: 0.727 Test Loss: 0.630 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726823).  Saving model ...
Epoch: 4 cost time: 22.849700212478638
Epoch: 4, Steps: 13 | Train Loss: 0.421 Vali Loss: 0.694 Vali Acc: 0.722 Test Loss: 0.694 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 23.97945761680603
Epoch: 5, Steps: 13 | Train Loss: 0.480 Vali Loss: 0.716 Vali Acc: 0.727 Test Loss: 0.716 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 23.51140260696411
Epoch: 6, Steps: 13 | Train Loss: 0.317 Vali Loss: 0.540 Vali Acc: 0.717 Test Loss: 0.540 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 22.998683214187622
Epoch: 7, Steps: 13 | Train Loss: 0.244 Vali Loss: 0.571 Vali Acc: 0.702 Test Loss: 0.571 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 22.2632839679718
Epoch: 8, Steps: 13 | Train Loss: 0.162 Vali Loss: 0.581 Vali Acc: 0.776 Test Loss: 0.581 Test Acc: 0.776
Validation loss decreased (-0.726823 --> -0.775604).  Saving model ...
Epoch: 9 cost time: 21.3908371925354
Epoch: 9, Steps: 13 | Train Loss: 0.134 Vali Loss: 0.581 Vali Acc: 0.717 Test Loss: 0.581 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 23.633132219314575
Epoch: 10, Steps: 13 | Train Loss: 0.083 Vali Loss: 0.715 Vali Acc: 0.756 Test Loss: 0.715 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 22.945472955703735
Epoch: 11, Steps: 13 | Train Loss: 0.072 Vali Loss: 0.682 Vali Acc: 0.727 Test Loss: 0.682 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 23.67512059211731
Epoch: 12, Steps: 13 | Train Loss: 0.078 Vali Loss: 0.823 Vali Acc: 0.756 Test Loss: 0.823 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 21.587934970855713
Epoch: 13, Steps: 13 | Train Loss: 0.058 Vali Loss: 0.796 Vali Acc: 0.620 Test Loss: 0.796 Test Acc: 0.620
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 21.08772850036621
Epoch: 14, Steps: 13 | Train Loss: 0.024 Vali Loss: 0.848 Vali Acc: 0.751 Test Loss: 0.848 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 24.030102729797363
Epoch: 15, Steps: 13 | Train Loss: 0.023 Vali Loss: 0.743 Vali Acc: 0.698 Test Loss: 0.743 Test Acc: 0.698
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 24.694134950637817
Epoch: 16, Steps: 13 | Train Loss: 0.014 Vali Loss: 0.896 Vali Acc: 0.746 Test Loss: 0.896 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 24.27021360397339
Epoch: 17, Steps: 13 | Train Loss: 0.014 Vali Loss: 0.882 Vali Acc: 0.722 Test Loss: 0.882 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 22.894084930419922
Epoch: 18, Steps: 13 | Train Loss: 0.044 Vali Loss: 0.796 Vali Acc: 0.741 Test Loss: 0.796 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 11079106
model size : 43.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 51.55057072639465
Epoch: 1, Steps: 13 | Train Loss: 0.588 Vali Loss: 0.553 Vali Acc: 0.732 Test Loss: 0.553 Test Acc: 0.732
Validation loss decreased (inf --> -0.731702).  Saving model ...
Epoch: 2 cost time: 48.677953004837036
Epoch: 2, Steps: 13 | Train Loss: 0.513 Vali Loss: 0.532 Vali Acc: 0.746 Test Loss: 0.532 Test Acc: 0.746
Validation loss decreased (-0.731702 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 45.23463320732117
Epoch: 3, Steps: 13 | Train Loss: 0.426 Vali Loss: 0.510 Vali Acc: 0.780 Test Loss: 0.510 Test Acc: 0.780
Validation loss decreased (-0.746336 --> -0.780483).  Saving model ...
Epoch: 4 cost time: 48.319435358047485
Epoch: 4, Steps: 13 | Train Loss: 0.347 Vali Loss: 0.508 Vali Acc: 0.756 Test Loss: 0.508 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 46.57637619972229
Epoch: 5, Steps: 13 | Train Loss: 0.322 Vali Loss: 0.722 Vali Acc: 0.727 Test Loss: 0.722 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 46.65249037742615
Epoch: 6, Steps: 13 | Train Loss: 0.309 Vali Loss: 0.629 Vali Acc: 0.746 Test Loss: 0.629 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 48.254910945892334
Epoch: 7, Steps: 13 | Train Loss: 0.178 Vali Loss: 0.582 Vali Acc: 0.707 Test Loss: 0.582 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 43.69569396972656
Epoch: 8, Steps: 13 | Train Loss: 0.133 Vali Loss: 0.582 Vali Acc: 0.717 Test Loss: 0.582 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 47.91318392753601
Epoch: 9, Steps: 13 | Train Loss: 0.099 Vali Loss: 0.628 Vali Acc: 0.673 Test Loss: 0.628 Test Acc: 0.673
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 46.954620122909546
Epoch: 10, Steps: 13 | Train Loss: 0.130 Vali Loss: 1.179 Vali Acc: 0.493 Test Loss: 1.179 Test Acc: 0.493
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 46.268426179885864
Epoch: 11, Steps: 13 | Train Loss: 0.101 Vali Loss: 0.700 Vali Acc: 0.712 Test Loss: 0.700 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 48.88791012763977
Epoch: 12, Steps: 13 | Train Loss: 0.047 Vali Loss: 0.727 Vali Acc: 0.717 Test Loss: 0.727 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 45.71676826477051
Epoch: 13, Steps: 13 | Train Loss: 0.038 Vali Loss: 0.767 Vali Acc: 0.663 Test Loss: 0.767 Test Acc: 0.663
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7804878048780488
model parameter : 37558210
model size : 144.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 21.19810700416565
Epoch: 1, Steps: 13 | Train Loss: 0.609 Vali Loss: 0.588 Vali Acc: 0.722 Test Loss: 0.588 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 19.39130163192749
Epoch: 2, Steps: 13 | Train Loss: 0.563 Vali Loss: 0.790 Vali Acc: 0.722 Test Loss: 0.790 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 19.458006858825684
Epoch: 3, Steps: 13 | Train Loss: 0.575 Vali Loss: 0.621 Vali Acc: 0.727 Test Loss: 0.621 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726823).  Saving model ...
Epoch: 4 cost time: 18.832671403884888
Epoch: 4, Steps: 13 | Train Loss: 0.434 Vali Loss: 0.708 Vali Acc: 0.727 Test Loss: 0.708 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 17.97612762451172
Epoch: 5, Steps: 13 | Train Loss: 0.433 Vali Loss: 0.576 Vali Acc: 0.737 Test Loss: 0.576 Test Acc: 0.737
Validation loss decreased (-0.726823 --> -0.736580).  Saving model ...
Epoch: 6 cost time: 19.32340097427368
Epoch: 6, Steps: 13 | Train Loss: 0.316 Vali Loss: 0.579 Vali Acc: 0.673 Test Loss: 0.579 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 19.607490062713623
Epoch: 7, Steps: 13 | Train Loss: 0.222 Vali Loss: 0.522 Vali Acc: 0.741 Test Loss: 0.522 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741458).  Saving model ...
Epoch: 8 cost time: 19.675318241119385
Epoch: 8, Steps: 13 | Train Loss: 0.168 Vali Loss: 0.592 Vali Acc: 0.712 Test Loss: 0.592 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 19.00989580154419
Epoch: 9, Steps: 13 | Train Loss: 0.111 Vali Loss: 0.667 Vali Acc: 0.649 Test Loss: 0.667 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 17.583641290664673
Epoch: 10, Steps: 13 | Train Loss: 0.091 Vali Loss: 0.826 Vali Acc: 0.761 Test Loss: 0.826 Test Acc: 0.761
Validation loss decreased (-0.741458 --> -0.760967).  Saving model ...
Epoch: 11 cost time: 17.322927236557007
Epoch: 11, Steps: 13 | Train Loss: 0.099 Vali Loss: 0.693 Vali Acc: 0.717 Test Loss: 0.693 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 18.88418459892273
Epoch: 12, Steps: 13 | Train Loss: 0.054 Vali Loss: 0.808 Vali Acc: 0.702 Test Loss: 0.808 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 18.683953762054443
Epoch: 13, Steps: 13 | Train Loss: 0.057 Vali Loss: 0.762 Vali Acc: 0.673 Test Loss: 0.762 Test Acc: 0.673
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 18.278647661209106
Epoch: 14, Steps: 13 | Train Loss: 0.018 Vali Loss: 0.784 Vali Acc: 0.732 Test Loss: 0.784 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 18.737558603286743
Epoch: 15, Steps: 13 | Train Loss: 0.017 Vali Loss: 0.766 Vali Acc: 0.722 Test Loss: 0.766 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 17.69261932373047
Epoch: 16, Steps: 13 | Train Loss: 0.016 Vali Loss: 0.909 Vali Acc: 0.737 Test Loss: 0.909 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 16.770740747451782
Epoch: 17, Steps: 13 | Train Loss: 0.012 Vali Loss: 0.801 Vali Acc: 0.712 Test Loss: 0.801 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 18.411449670791626
Epoch: 18, Steps: 13 | Train Loss: 0.006 Vali Loss: 0.793 Vali Acc: 0.693 Test Loss: 0.793 Test Acc: 0.693
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 18.8013277053833
Epoch: 19, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.837 Vali Acc: 0.678 Test Loss: 0.837 Test Acc: 0.678
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 18.057367086410522
Epoch: 20, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.960 Vali Acc: 0.717 Test Loss: 0.960 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 11079106
model size : 43.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 28.940321922302246
Epoch: 1, Steps: 13 | Train Loss: 0.588 Vali Loss: 0.552 Vali Acc: 0.732 Test Loss: 0.552 Test Acc: 0.732
Validation loss decreased (inf --> -0.731702).  Saving model ...
Epoch: 2 cost time: 26.76287317276001
Epoch: 2, Steps: 13 | Train Loss: 0.520 Vali Loss: 0.527 Vali Acc: 0.751 Test Loss: 0.527 Test Acc: 0.751
Validation loss decreased (-0.731702 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 28.2846622467041
Epoch: 3, Steps: 13 | Train Loss: 0.425 Vali Loss: 0.516 Vali Acc: 0.766 Test Loss: 0.516 Test Acc: 0.766
Validation loss decreased (-0.751214 --> -0.765848).  Saving model ...
Epoch: 4 cost time: 28.48956847190857
Epoch: 4, Steps: 13 | Train Loss: 0.353 Vali Loss: 0.507 Vali Acc: 0.771 Test Loss: 0.507 Test Acc: 0.771
Validation loss decreased (-0.765848 --> -0.770727).  Saving model ...
Epoch: 5 cost time: 27.921152114868164
Epoch: 5, Steps: 13 | Train Loss: 0.287 Vali Loss: 0.594 Vali Acc: 0.751 Test Loss: 0.594 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 25.490800142288208
Epoch: 6, Steps: 13 | Train Loss: 0.529 Vali Loss: 0.747 Vali Acc: 0.741 Test Loss: 0.747 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 27.931282997131348
Epoch: 7, Steps: 13 | Train Loss: 0.192 Vali Loss: 0.582 Vali Acc: 0.717 Test Loss: 0.582 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 27.836541652679443
Epoch: 8, Steps: 13 | Train Loss: 0.160 Vali Loss: 0.568 Vali Acc: 0.717 Test Loss: 0.568 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 27.90108633041382
Epoch: 9, Steps: 13 | Train Loss: 0.105 Vali Loss: 0.602 Vali Acc: 0.732 Test Loss: 0.602 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 26.116576671600342
Epoch: 10, Steps: 13 | Train Loss: 0.083 Vali Loss: 0.816 Vali Acc: 0.615 Test Loss: 0.816 Test Acc: 0.615
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 27.67152500152588
Epoch: 11, Steps: 13 | Train Loss: 0.227 Vali Loss: 0.797 Vali Acc: 0.712 Test Loss: 0.797 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 27.08814239501953
Epoch: 12, Steps: 13 | Train Loss: 0.211 Vali Loss: 0.713 Vali Acc: 0.698 Test Loss: 0.713 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 23.908973693847656
Epoch: 13, Steps: 13 | Train Loss: 0.039 Vali Loss: 0.727 Vali Acc: 0.722 Test Loss: 0.727 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 25.38687539100647
Epoch: 14, Steps: 13 | Train Loss: 0.229 Vali Loss: 1.060 Vali Acc: 0.751 Test Loss: 1.060 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 37558210
model size : 144.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 13.541032314300537
Epoch: 1, Steps: 13 | Train Loss: 0.612 Vali Loss: 0.590 Vali Acc: 0.722 Test Loss: 0.590 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 12.246650218963623
Epoch: 2, Steps: 13 | Train Loss: 0.569 Vali Loss: 0.776 Vali Acc: 0.722 Test Loss: 0.776 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.523199319839478
Epoch: 3, Steps: 13 | Train Loss: 0.552 Vali Loss: 0.756 Vali Acc: 0.727 Test Loss: 0.756 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726822).  Saving model ...
Epoch: 4 cost time: 12.0036461353302
Epoch: 4, Steps: 13 | Train Loss: 0.504 Vali Loss: 0.532 Vali Acc: 0.766 Test Loss: 0.532 Test Acc: 0.766
Validation loss decreased (-0.726822 --> -0.765848).  Saving model ...
Epoch: 5 cost time: 11.891459226608276
Epoch: 5, Steps: 13 | Train Loss: 0.447 Vali Loss: 0.634 Vali Acc: 0.737 Test Loss: 0.634 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 11.461960792541504
Epoch: 6, Steps: 13 | Train Loss: 0.360 Vali Loss: 0.888 Vali Acc: 0.498 Test Loss: 0.888 Test Acc: 0.498
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 11.134436130523682
Epoch: 7, Steps: 13 | Train Loss: 0.382 Vali Loss: 0.599 Vali Acc: 0.654 Test Loss: 0.599 Test Acc: 0.654
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 10.471910953521729
Epoch: 8, Steps: 13 | Train Loss: 0.215 Vali Loss: 0.763 Vali Acc: 0.761 Test Loss: 0.763 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 10.648088693618774
Epoch: 9, Steps: 13 | Train Loss: 0.230 Vali Loss: 0.587 Vali Acc: 0.722 Test Loss: 0.587 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 9.986981868743896
Epoch: 10, Steps: 13 | Train Loss: 0.135 Vali Loss: 0.673 Vali Acc: 0.756 Test Loss: 0.673 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 10.828797817230225
Epoch: 11, Steps: 13 | Train Loss: 0.101 Vali Loss: 0.639 Vali Acc: 0.737 Test Loss: 0.639 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 10.93340015411377
Epoch: 12, Steps: 13 | Train Loss: 0.262 Vali Loss: 0.752 Vali Acc: 0.615 Test Loss: 0.752 Test Acc: 0.615
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 10.709716081619263
Epoch: 13, Steps: 13 | Train Loss: 0.246 Vali Loss: 0.862 Vali Acc: 0.585 Test Loss: 0.862 Test Acc: 0.585
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 10.841621160507202
Epoch: 14, Steps: 13 | Train Loss: 0.033 Vali Loss: 0.859 Vali Acc: 0.722 Test Loss: 0.859 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 11079106
model size : 43.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 31.94698977470398
Epoch: 1, Steps: 13 | Train Loss: 0.628 Vali Loss: 0.559 Vali Acc: 0.727 Test Loss: 0.559 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 32.401538133621216
Epoch: 2, Steps: 13 | Train Loss: 0.521 Vali Loss: 0.526 Vali Acc: 0.746 Test Loss: 0.526 Test Acc: 0.746
Validation loss decreased (-0.726824 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 32.79443311691284
Epoch: 3, Steps: 13 | Train Loss: 0.434 Vali Loss: 0.541 Vali Acc: 0.702 Test Loss: 0.541 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 33.16559147834778
Epoch: 4, Steps: 13 | Train Loss: 0.370 Vali Loss: 0.520 Vali Acc: 0.766 Test Loss: 0.520 Test Acc: 0.766
Validation loss decreased (-0.746336 --> -0.765848).  Saving model ...
Epoch: 5 cost time: 34.312204122543335
Epoch: 5, Steps: 13 | Train Loss: 0.358 Vali Loss: 0.714 Vali Acc: 0.741 Test Loss: 0.714 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 32.53470826148987
Epoch: 6, Steps: 13 | Train Loss: 0.262 Vali Loss: 0.578 Vali Acc: 0.668 Test Loss: 0.578 Test Acc: 0.668
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 34.016417026519775
Epoch: 7, Steps: 13 | Train Loss: 0.187 Vali Loss: 0.595 Vali Acc: 0.756 Test Loss: 0.595 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 31.081982612609863
Epoch: 8, Steps: 13 | Train Loss: 0.177 Vali Loss: 0.612 Vali Acc: 0.673 Test Loss: 0.612 Test Acc: 0.673
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 32.123995542526245
Epoch: 9, Steps: 13 | Train Loss: 0.154 Vali Loss: 0.636 Vali Acc: 0.761 Test Loss: 0.636 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 34.22993469238281
Epoch: 10, Steps: 13 | Train Loss: 0.076 Vali Loss: 0.840 Vali Acc: 0.741 Test Loss: 0.840 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 33.35094404220581
Epoch: 11, Steps: 13 | Train Loss: 0.106 Vali Loss: 1.253 Vali Acc: 0.468 Test Loss: 1.253 Test Acc: 0.468
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 32.783339977264404
Epoch: 12, Steps: 13 | Train Loss: 0.119 Vali Loss: 0.761 Vali Acc: 0.737 Test Loss: 0.761 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 33.91961693763733
Epoch: 13, Steps: 13 | Train Loss: 0.083 Vali Loss: 0.839 Vali Acc: 0.761 Test Loss: 0.839 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 31.48545551300049
Epoch: 14, Steps: 13 | Train Loss: 0.042 Vali Loss: 0.957 Vali Acc: 0.629 Test Loss: 0.957 Test Acc: 0.629
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 18811842
model size : 73.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 15.568028926849365
Epoch: 1, Steps: 13 | Train Loss: 0.601 Vali Loss: 0.573 Vali Acc: 0.722 Test Loss: 0.573 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 13.763593673706055
Epoch: 2, Steps: 13 | Train Loss: 0.520 Vali Loss: 0.575 Vali Acc: 0.732 Test Loss: 0.575 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 13.807072401046753
Epoch: 3, Steps: 13 | Train Loss: 0.440 Vali Loss: 0.608 Vali Acc: 0.732 Test Loss: 0.608 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 12.872377634048462
Epoch: 4, Steps: 13 | Train Loss: 0.381 Vali Loss: 0.499 Vali Acc: 0.776 Test Loss: 0.499 Test Acc: 0.776
Validation loss decreased (-0.731702 --> -0.775605).  Saving model ...
Epoch: 5 cost time: 12.477747917175293
Epoch: 5, Steps: 13 | Train Loss: 0.336 Vali Loss: 0.572 Vali Acc: 0.659 Test Loss: 0.572 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 13.667871236801147
Epoch: 6, Steps: 13 | Train Loss: 0.315 Vali Loss: 0.552 Vali Acc: 0.732 Test Loss: 0.552 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 13.823073148727417
Epoch: 7, Steps: 13 | Train Loss: 0.271 Vali Loss: 0.623 Vali Acc: 0.771 Test Loss: 0.623 Test Acc: 0.771
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 13.814003467559814
Epoch: 8, Steps: 13 | Train Loss: 0.187 Vali Loss: 0.598 Vali Acc: 0.766 Test Loss: 0.598 Test Acc: 0.766
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 13.885695695877075
Epoch: 9, Steps: 13 | Train Loss: 0.212 Vali Loss: 0.660 Vali Acc: 0.624 Test Loss: 0.660 Test Acc: 0.624
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 12.989848375320435
Epoch: 10, Steps: 13 | Train Loss: 0.163 Vali Loss: 0.656 Vali Acc: 0.702 Test Loss: 0.656 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 12.532358169555664
Epoch: 11, Steps: 13 | Train Loss: 0.103 Vali Loss: 0.655 Vali Acc: 0.722 Test Loss: 0.655 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 13.193016290664673
Epoch: 12, Steps: 13 | Train Loss: 0.055 Vali Loss: 0.714 Vali Acc: 0.683 Test Loss: 0.714 Test Acc: 0.683
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 13.832080125808716
Epoch: 13, Steps: 13 | Train Loss: 0.040 Vali Loss: 0.746 Vali Acc: 0.732 Test Loss: 0.746 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 13.92042326927185
Epoch: 14, Steps: 13 | Train Loss: 0.049 Vali Loss: 0.783 Vali Acc: 0.712 Test Loss: 0.783 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 5572034
model size : 22.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 26.427045583724976
Epoch: 1, Steps: 13 | Train Loss: 0.628 Vali Loss: 0.562 Vali Acc: 0.712 Test Loss: 0.562 Test Acc: 0.712
Validation loss decreased (inf --> -0.712190).  Saving model ...
Epoch: 2 cost time: 25.681164741516113
Epoch: 2, Steps: 13 | Train Loss: 0.529 Vali Loss: 0.532 Vali Acc: 0.741 Test Loss: 0.532 Test Acc: 0.741
Validation loss decreased (-0.712190 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 26.0599308013916
Epoch: 3, Steps: 13 | Train Loss: 0.442 Vali Loss: 0.552 Vali Acc: 0.693 Test Loss: 0.552 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 25.780131578445435
Epoch: 4, Steps: 13 | Train Loss: 0.388 Vali Loss: 0.541 Vali Acc: 0.756 Test Loss: 0.541 Test Acc: 0.756
Validation loss decreased (-0.741458 --> -0.756092).  Saving model ...
Epoch: 5 cost time: 25.298247814178467
Epoch: 5, Steps: 13 | Train Loss: 0.377 Vali Loss: 0.720 Vali Acc: 0.737 Test Loss: 0.720 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 26.384936094284058
Epoch: 6, Steps: 13 | Train Loss: 0.265 Vali Loss: 0.556 Vali Acc: 0.707 Test Loss: 0.556 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 26.902143478393555
Epoch: 7, Steps: 13 | Train Loss: 0.196 Vali Loss: 0.603 Vali Acc: 0.756 Test Loss: 0.603 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 25.147908687591553
Epoch: 8, Steps: 13 | Train Loss: 0.188 Vali Loss: 0.642 Vali Acc: 0.644 Test Loss: 0.642 Test Acc: 0.644
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 26.810497522354126
Epoch: 9, Steps: 13 | Train Loss: 0.196 Vali Loss: 0.590 Vali Acc: 0.717 Test Loss: 0.590 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 26.5909686088562
Epoch: 10, Steps: 13 | Train Loss: 0.105 Vali Loss: 0.934 Vali Acc: 0.732 Test Loss: 0.934 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 25.087478399276733
Epoch: 11, Steps: 13 | Train Loss: 0.085 Vali Loss: 0.749 Vali Acc: 0.620 Test Loss: 0.749 Test Acc: 0.620
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 24.93266201019287
Epoch: 12, Steps: 13 | Train Loss: 0.106 Vali Loss: 0.796 Vali Acc: 0.766 Test Loss: 0.796 Test Acc: 0.766
Validation loss decreased (-0.756092 --> -0.765846).  Saving model ...
Epoch: 13 cost time: 25.572876930236816
Epoch: 13, Steps: 13 | Train Loss: 0.056 Vali Loss: 0.794 Vali Acc: 0.732 Test Loss: 0.794 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 25.00932240486145
Epoch: 14, Steps: 13 | Train Loss: 0.021 Vali Loss: 0.815 Vali Acc: 0.668 Test Loss: 0.815 Test Acc: 0.668
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 23.269080877304077
Epoch: 15, Steps: 13 | Train Loss: 0.028 Vali Loss: 1.016 Vali Acc: 0.737 Test Loss: 1.016 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 25.728652238845825
Epoch: 16, Steps: 13 | Train Loss: 0.028 Vali Loss: 0.831 Vali Acc: 0.644 Test Loss: 0.831 Test Acc: 0.644
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 25.56225275993347
Epoch: 17, Steps: 13 | Train Loss: 0.030 Vali Loss: 0.932 Vali Acc: 0.605 Test Loss: 0.932 Test Acc: 0.605
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 23.689428329467773
Epoch: 18, Steps: 13 | Train Loss: 0.017 Vali Loss: 0.943 Vali Acc: 0.712 Test Loss: 0.943 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 24.84834337234497
Epoch: 19, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.096 Vali Acc: 0.737 Test Loss: 1.096 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 25.70887064933777
Epoch: 20, Steps: 13 | Train Loss: 0.019 Vali Loss: 0.963 Vali Acc: 0.751 Test Loss: 0.963 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 24.755974292755127
Epoch: 21, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.107 Vali Acc: 0.727 Test Loss: 1.107 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 25.51002025604248
Epoch: 22, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.933 Vali Acc: 0.717 Test Loss: 0.933 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 18811842
model size : 73.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 13.026029348373413
Epoch: 1, Steps: 13 | Train Loss: 0.600 Vali Loss: 0.573 Vali Acc: 0.717 Test Loss: 0.573 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 11.36191439628601
Epoch: 2, Steps: 13 | Train Loss: 0.525 Vali Loss: 0.579 Vali Acc: 0.727 Test Loss: 0.579 Test Acc: 0.727
Validation loss decreased (-0.717067 --> -0.726823).  Saving model ...
Epoch: 3 cost time: 11.09439730644226
Epoch: 3, Steps: 13 | Train Loss: 0.448 Vali Loss: 0.614 Vali Acc: 0.732 Test Loss: 0.614 Test Acc: 0.732
Validation loss decreased (-0.726823 --> -0.731701).  Saving model ...
Epoch: 4 cost time: 10.757187843322754
Epoch: 4, Steps: 13 | Train Loss: 0.387 Vali Loss: 0.524 Vali Acc: 0.766 Test Loss: 0.524 Test Acc: 0.766
Validation loss decreased (-0.731701 --> -0.765848).  Saving model ...
Epoch: 5 cost time: 10.868688344955444
Epoch: 5, Steps: 13 | Train Loss: 0.345 Vali Loss: 0.612 Vali Acc: 0.624 Test Loss: 0.612 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 11.093012809753418
Epoch: 6, Steps: 13 | Train Loss: 0.381 Vali Loss: 0.646 Vali Acc: 0.629 Test Loss: 0.646 Test Acc: 0.629
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 10.925588369369507
Epoch: 7, Steps: 13 | Train Loss: 0.316 Vali Loss: 0.647 Vali Acc: 0.741 Test Loss: 0.647 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 11.110854148864746
Epoch: 8, Steps: 13 | Train Loss: 0.195 Vali Loss: 0.681 Vali Acc: 0.771 Test Loss: 0.681 Test Acc: 0.771
Validation loss decreased (-0.765848 --> -0.770725).  Saving model ...
Epoch: 9 cost time: 10.865526676177979
Epoch: 9, Steps: 13 | Train Loss: 0.178 Vali Loss: 0.609 Vali Acc: 0.737 Test Loss: 0.609 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 10.791443824768066
Epoch: 10, Steps: 13 | Train Loss: 0.139 Vali Loss: 0.678 Vali Acc: 0.761 Test Loss: 0.678 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 10.587110042572021
Epoch: 11, Steps: 13 | Train Loss: 0.093 Vali Loss: 0.735 Vali Acc: 0.644 Test Loss: 0.735 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 10.731794357299805
Epoch: 12, Steps: 13 | Train Loss: 0.057 Vali Loss: 0.707 Vali Acc: 0.717 Test Loss: 0.707 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 11.255905628204346
Epoch: 13, Steps: 13 | Train Loss: 0.060 Vali Loss: 0.723 Vali Acc: 0.683 Test Loss: 0.723 Test Acc: 0.683
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 11.069775104522705
Epoch: 14, Steps: 13 | Train Loss: 0.057 Vali Loss: 0.811 Vali Acc: 0.727 Test Loss: 0.811 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 11.203319072723389
Epoch: 15, Steps: 13 | Train Loss: 0.028 Vali Loss: 0.812 Vali Acc: 0.707 Test Loss: 0.812 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 11.112110614776611
Epoch: 16, Steps: 13 | Train Loss: 0.014 Vali Loss: 0.843 Vali Acc: 0.639 Test Loss: 0.843 Test Acc: 0.639
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 10.521856546401978
Epoch: 17, Steps: 13 | Train Loss: 0.028 Vali Loss: 1.064 Vali Acc: 0.737 Test Loss: 1.064 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 10.521660089492798
Epoch: 18, Steps: 13 | Train Loss: 0.013 Vali Loss: 0.912 Vali Acc: 0.727 Test Loss: 0.912 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 5572034
model size : 22.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 17.250503540039062
Epoch: 1, Steps: 13 | Train Loss: 0.629 Vali Loss: 0.561 Vali Acc: 0.717 Test Loss: 0.561 Test Acc: 0.717
Validation loss decreased (inf --> -0.717068).  Saving model ...
Epoch: 2 cost time: 15.758632898330688
Epoch: 2, Steps: 13 | Train Loss: 0.532 Vali Loss: 0.532 Vali Acc: 0.746 Test Loss: 0.532 Test Acc: 0.746
Validation loss decreased (-0.717068 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 15.73555588722229
Epoch: 3, Steps: 13 | Train Loss: 0.446 Vali Loss: 0.552 Vali Acc: 0.727 Test Loss: 0.552 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 14.578126668930054
Epoch: 4, Steps: 13 | Train Loss: 0.391 Vali Loss: 0.535 Vali Acc: 0.756 Test Loss: 0.535 Test Acc: 0.756
Validation loss decreased (-0.746336 --> -0.756092).  Saving model ...
Epoch: 5 cost time: 14.389650106430054
Epoch: 5, Steps: 13 | Train Loss: 0.384 Vali Loss: 0.719 Vali Acc: 0.737 Test Loss: 0.719 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 15.576589822769165
Epoch: 6, Steps: 13 | Train Loss: 0.270 Vali Loss: 0.545 Vali Acc: 0.712 Test Loss: 0.545 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 15.430301904678345
Epoch: 7, Steps: 13 | Train Loss: 0.197 Vali Loss: 0.558 Vali Acc: 0.717 Test Loss: 0.558 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 15.607562065124512
Epoch: 8, Steps: 13 | Train Loss: 0.166 Vali Loss: 0.616 Vali Acc: 0.663 Test Loss: 0.616 Test Acc: 0.663
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 14.928499937057495
Epoch: 9, Steps: 13 | Train Loss: 0.143 Vali Loss: 0.625 Vali Acc: 0.751 Test Loss: 0.625 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 14.213369846343994
Epoch: 10, Steps: 13 | Train Loss: 0.310 Vali Loss: 0.900 Vali Acc: 0.732 Test Loss: 0.900 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 15.077913999557495
Epoch: 11, Steps: 13 | Train Loss: 0.274 Vali Loss: 1.244 Vali Acc: 0.463 Test Loss: 1.244 Test Acc: 0.463
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 15.180652856826782
Epoch: 12, Steps: 13 | Train Loss: 0.110 Vali Loss: 0.757 Vali Acc: 0.741 Test Loss: 0.757 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 15.074176788330078
Epoch: 13, Steps: 13 | Train Loss: 0.106 Vali Loss: 1.049 Vali Acc: 0.746 Test Loss: 1.049 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 15.072278261184692
Epoch: 14, Steps: 13 | Train Loss: 0.143 Vali Loss: 0.856 Vali Acc: 0.644 Test Loss: 0.856 Test Acc: 0.644
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 18811842
model size : 73.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.064427614212036
Epoch: 1, Steps: 13 | Train Loss: 0.600 Vali Loss: 0.577 Vali Acc: 0.712 Test Loss: 0.577 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 6.921846389770508
Epoch: 2, Steps: 13 | Train Loss: 0.531 Vali Loss: 0.588 Vali Acc: 0.722 Test Loss: 0.588 Test Acc: 0.722
Validation loss decreased (-0.712189 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 6.899782657623291
Epoch: 3, Steps: 13 | Train Loss: 0.452 Vali Loss: 0.621 Vali Acc: 0.722 Test Loss: 0.621 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.053722620010376
Epoch: 4, Steps: 13 | Train Loss: 0.394 Vali Loss: 0.526 Vali Acc: 0.751 Test Loss: 0.526 Test Acc: 0.751
Validation loss decreased (-0.721945 --> -0.751214).  Saving model ...
Epoch: 5 cost time: 6.95192551612854
Epoch: 5, Steps: 13 | Train Loss: 0.342 Vali Loss: 0.609 Vali Acc: 0.624 Test Loss: 0.609 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.244583368301392
Epoch: 6, Steps: 13 | Train Loss: 0.386 Vali Loss: 0.668 Vali Acc: 0.610 Test Loss: 0.668 Test Acc: 0.610
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.234971046447754
Epoch: 7, Steps: 13 | Train Loss: 0.286 Vali Loss: 0.642 Vali Acc: 0.737 Test Loss: 0.642 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.9637227058410645
Epoch: 8, Steps: 13 | Train Loss: 0.236 Vali Loss: 0.703 Vali Acc: 0.756 Test Loss: 0.703 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756091).  Saving model ...
Epoch: 9 cost time: 6.868554592132568
Epoch: 9, Steps: 13 | Train Loss: 0.179 Vali Loss: 0.686 Vali Acc: 0.600 Test Loss: 0.686 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.747800827026367
Epoch: 10, Steps: 13 | Train Loss: 0.174 Vali Loss: 0.713 Vali Acc: 0.654 Test Loss: 0.713 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.77225661277771
Epoch: 11, Steps: 13 | Train Loss: 0.095 Vali Loss: 0.647 Vali Acc: 0.712 Test Loss: 0.647 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 7.101850509643555
Epoch: 12, Steps: 13 | Train Loss: 0.073 Vali Loss: 0.771 Vali Acc: 0.605 Test Loss: 0.771 Test Acc: 0.605
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 7.134089231491089
Epoch: 13, Steps: 13 | Train Loss: 0.043 Vali Loss: 0.854 Vali Acc: 0.737 Test Loss: 0.854 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 7.20550012588501
Epoch: 14, Steps: 13 | Train Loss: 0.040 Vali Loss: 0.768 Vali Acc: 0.722 Test Loss: 0.768 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 7.082581996917725
Epoch: 15, Steps: 13 | Train Loss: 0.044 Vali Loss: 0.801 Vali Acc: 0.717 Test Loss: 0.801 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 7.226253986358643
Epoch: 16, Steps: 13 | Train Loss: 0.018 Vali Loss: 0.859 Vali Acc: 0.644 Test Loss: 0.859 Test Acc: 0.644
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 7.298795938491821
Epoch: 17, Steps: 13 | Train Loss: 0.030 Vali Loss: 0.929 Vali Acc: 0.722 Test Loss: 0.929 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 7.130487442016602
Epoch: 18, Steps: 13 | Train Loss: 0.025 Vali Loss: 0.915 Vali Acc: 0.717 Test Loss: 0.915 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 5572034
model size : 22.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 23.530691862106323
Epoch: 1, Steps: 13 | Train Loss: 0.564 Vali Loss: 0.537 Vali Acc: 0.741 Test Loss: 0.537 Test Acc: 0.741
Validation loss decreased (inf --> -0.741458).  Saving model ...
Epoch: 2 cost time: 22.509297132492065
Epoch: 2, Steps: 13 | Train Loss: 0.511 Vali Loss: 0.509 Vali Acc: 0.785 Test Loss: 0.509 Test Acc: 0.785
Validation loss decreased (-0.741458 --> -0.785361).  Saving model ...
Epoch: 3 cost time: 22.481181144714355
Epoch: 3, Steps: 13 | Train Loss: 0.440 Vali Loss: 0.594 Vali Acc: 0.751 Test Loss: 0.594 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 21.45486283302307
Epoch: 4, Steps: 13 | Train Loss: 0.361 Vali Loss: 0.517 Vali Acc: 0.732 Test Loss: 0.517 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 22.011090993881226
Epoch: 5, Steps: 13 | Train Loss: 0.298 Vali Loss: 0.534 Vali Acc: 0.771 Test Loss: 0.534 Test Acc: 0.771
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 22.78943181037903
Epoch: 6, Steps: 13 | Train Loss: 0.276 Vali Loss: 0.569 Vali Acc: 0.722 Test Loss: 0.569 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 22.26946210861206
Epoch: 7, Steps: 13 | Train Loss: 0.219 Vali Loss: 0.707 Vali Acc: 0.610 Test Loss: 0.707 Test Acc: 0.610
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 20.737313985824585
Epoch: 8, Steps: 13 | Train Loss: 0.204 Vali Loss: 0.737 Vali Acc: 0.761 Test Loss: 0.737 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 21.99021029472351
Epoch: 9, Steps: 13 | Train Loss: 0.220 Vali Loss: 0.817 Vali Acc: 0.751 Test Loss: 0.817 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 22.20931315422058
Epoch: 10, Steps: 13 | Train Loss: 0.144 Vali Loss: 0.641 Vali Acc: 0.673 Test Loss: 0.641 Test Acc: 0.673
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 21.63408613204956
Epoch: 11, Steps: 13 | Train Loss: 0.087 Vali Loss: 0.636 Vali Acc: 0.727 Test Loss: 0.636 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 19.74031090736389
Epoch: 12, Steps: 13 | Train Loss: 0.086 Vali Loss: 0.843 Vali Acc: 0.590 Test Loss: 0.843 Test Acc: 0.590
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7853658536585366
model parameter : 9438658
model size : 37.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 11.000714778900146
Epoch: 1, Steps: 13 | Train Loss: 0.612 Vali Loss: 0.540 Vali Acc: 0.737 Test Loss: 0.540 Test Acc: 0.737
Validation loss decreased (inf --> -0.736580).  Saving model ...
Epoch: 2 cost time: 9.38274097442627
Epoch: 2, Steps: 13 | Train Loss: 0.518 Vali Loss: 0.620 Vali Acc: 0.605 Test Loss: 0.620 Test Acc: 0.605
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.374633550643921
Epoch: 3, Steps: 13 | Train Loss: 0.505 Vali Loss: 0.580 Vali Acc: 0.688 Test Loss: 0.580 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.442747592926025
Epoch: 4, Steps: 13 | Train Loss: 0.445 Vali Loss: 0.658 Vali Acc: 0.595 Test Loss: 0.658 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 8.846561908721924
Epoch: 5, Steps: 13 | Train Loss: 0.363 Vali Loss: 0.535 Vali Acc: 0.727 Test Loss: 0.535 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 8.65401029586792
Epoch: 6, Steps: 13 | Train Loss: 0.313 Vali Loss: 0.556 Vali Acc: 0.785 Test Loss: 0.556 Test Acc: 0.785
Validation loss decreased (-0.736580 --> -0.785360).  Saving model ...
Epoch: 7 cost time: 8.684088230133057
Epoch: 7, Steps: 13 | Train Loss: 0.240 Vali Loss: 0.696 Vali Acc: 0.629 Test Loss: 0.696 Test Acc: 0.629
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.260955333709717
Epoch: 8, Steps: 13 | Train Loss: 0.185 Vali Loss: 0.553 Vali Acc: 0.722 Test Loss: 0.553 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 9.367964506149292
Epoch: 9, Steps: 13 | Train Loss: 0.211 Vali Loss: 0.894 Vali Acc: 0.741 Test Loss: 0.894 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 9.42688512802124
Epoch: 10, Steps: 13 | Train Loss: 0.166 Vali Loss: 0.699 Vali Acc: 0.737 Test Loss: 0.699 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 9.380696773529053
Epoch: 11, Steps: 13 | Train Loss: 0.240 Vali Loss: 0.956 Vali Acc: 0.498 Test Loss: 0.956 Test Acc: 0.498
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 9.388033866882324
Epoch: 12, Steps: 13 | Train Loss: 0.164 Vali Loss: 0.829 Vali Acc: 0.615 Test Loss: 0.829 Test Acc: 0.615
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 8.767942905426025
Epoch: 13, Steps: 13 | Train Loss: 0.107 Vali Loss: 0.668 Vali Acc: 0.702 Test Loss: 0.668 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 8.813551664352417
Epoch: 14, Steps: 13 | Train Loss: 0.077 Vali Loss: 0.727 Vali Acc: 0.737 Test Loss: 0.727 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 8.583458185195923
Epoch: 15, Steps: 13 | Train Loss: 0.030 Vali Loss: 0.707 Vali Acc: 0.727 Test Loss: 0.707 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 9.061805009841919
Epoch: 16, Steps: 13 | Train Loss: 0.022 Vali Loss: 0.787 Vali Acc: 0.663 Test Loss: 0.787 Test Acc: 0.663
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7853658536585366
model parameter : 2818498
model size : 12.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 18.90522599220276
Epoch: 1, Steps: 13 | Train Loss: 0.563 Vali Loss: 0.540 Vali Acc: 0.732 Test Loss: 0.540 Test Acc: 0.732
Validation loss decreased (inf --> -0.731702).  Saving model ...
Epoch: 2 cost time: 17.286125659942627
Epoch: 2, Steps: 13 | Train Loss: 0.512 Vali Loss: 0.514 Vali Acc: 0.780 Test Loss: 0.514 Test Acc: 0.780
Validation loss decreased (-0.731702 --> -0.780483).  Saving model ...
Epoch: 3 cost time: 13.299556493759155
Epoch: 3, Steps: 13 | Train Loss: 0.448 Vali Loss: 0.613 Vali Acc: 0.737 Test Loss: 0.613 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 17.112385034561157
Epoch: 4, Steps: 13 | Train Loss: 0.383 Vali Loss: 0.539 Vali Acc: 0.717 Test Loss: 0.539 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 16.72802710533142
Epoch: 5, Steps: 13 | Train Loss: 0.364 Vali Loss: 0.509 Vali Acc: 0.776 Test Loss: 0.509 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 17.17300271987915
Epoch: 6, Steps: 13 | Train Loss: 0.266 Vali Loss: 0.571 Vali Acc: 0.688 Test Loss: 0.571 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 16.691674947738647
Epoch: 7, Steps: 13 | Train Loss: 0.229 Vali Loss: 0.609 Vali Acc: 0.663 Test Loss: 0.609 Test Acc: 0.663
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 15.76187014579773
Epoch: 8, Steps: 13 | Train Loss: 0.228 Vali Loss: 0.642 Vali Acc: 0.790 Test Loss: 0.642 Test Acc: 0.790
Validation loss decreased (-0.780483 --> -0.790237).  Saving model ...
Epoch: 9 cost time: 16.14332866668701
Epoch: 9, Steps: 13 | Train Loss: 0.193 Vali Loss: 0.692 Vali Acc: 0.776 Test Loss: 0.692 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 17.13611364364624
Epoch: 10, Steps: 13 | Train Loss: 0.156 Vali Loss: 0.871 Vali Acc: 0.546 Test Loss: 0.871 Test Acc: 0.546
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 17.714994192123413
Epoch: 11, Steps: 13 | Train Loss: 0.099 Vali Loss: 0.634 Vali Acc: 0.751 Test Loss: 0.634 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 17.25209093093872
Epoch: 12, Steps: 13 | Train Loss: 0.056 Vali Loss: 0.657 Vali Acc: 0.698 Test Loss: 0.657 Test Acc: 0.698
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 17.35330295562744
Epoch: 13, Steps: 13 | Train Loss: 0.055 Vali Loss: 0.680 Vali Acc: 0.717 Test Loss: 0.680 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 16.389939785003662
Epoch: 14, Steps: 13 | Train Loss: 0.035 Vali Loss: 0.734 Vali Acc: 0.717 Test Loss: 0.734 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 16.25632882118225
Epoch: 15, Steps: 13 | Train Loss: 0.033 Vali Loss: 0.998 Vali Acc: 0.761 Test Loss: 0.998 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 17.441444396972656
Epoch: 16, Steps: 13 | Train Loss: 0.022 Vali Loss: 0.891 Vali Acc: 0.756 Test Loss: 0.891 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 17.229974031448364
Epoch: 17, Steps: 13 | Train Loss: 0.031 Vali Loss: 0.976 Vali Acc: 0.746 Test Loss: 0.976 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 17.313083171844482
Epoch: 18, Steps: 13 | Train Loss: 0.018 Vali Loss: 0.790 Vali Acc: 0.732 Test Loss: 0.790 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7902439024390244
model parameter : 9438658
model size : 37.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.529889822006226
Epoch: 1, Steps: 13 | Train Loss: 0.611 Vali Loss: 0.542 Vali Acc: 0.732 Test Loss: 0.542 Test Acc: 0.732
Validation loss decreased (inf --> -0.731702).  Saving model ...
Epoch: 2 cost time: 7.041679382324219
Epoch: 2, Steps: 13 | Train Loss: 0.519 Vali Loss: 0.627 Vali Acc: 0.610 Test Loss: 0.627 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.80718731880188
Epoch: 3, Steps: 13 | Train Loss: 0.511 Vali Loss: 0.599 Vali Acc: 0.654 Test Loss: 0.599 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.765560865402222
Epoch: 4, Steps: 13 | Train Loss: 0.457 Vali Loss: 0.648 Vali Acc: 0.585 Test Loss: 0.648 Test Acc: 0.585
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.607196569442749
Epoch: 5, Steps: 13 | Train Loss: 0.381 Vali Loss: 0.548 Vali Acc: 0.722 Test Loss: 0.548 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.277265548706055
Epoch: 6, Steps: 13 | Train Loss: 0.312 Vali Loss: 0.519 Vali Acc: 0.761 Test Loss: 0.519 Test Acc: 0.761
Validation loss decreased (-0.731702 --> -0.760970).  Saving model ...
Epoch: 7 cost time: 7.311150789260864
Epoch: 7, Steps: 13 | Train Loss: 0.233 Vali Loss: 0.582 Vali Acc: 0.663 Test Loss: 0.582 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.812613010406494
Epoch: 8, Steps: 13 | Train Loss: 0.173 Vali Loss: 0.660 Vali Acc: 0.771 Test Loss: 0.660 Test Acc: 0.771
Validation loss decreased (-0.760970 --> -0.770725).  Saving model ...
Epoch: 9 cost time: 7.740121841430664
Epoch: 9, Steps: 13 | Train Loss: 0.255 Vali Loss: 0.643 Vali Acc: 0.766 Test Loss: 0.643 Test Acc: 0.766
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.960861921310425
Epoch: 10, Steps: 13 | Train Loss: 0.190 Vali Loss: 0.591 Vali Acc: 0.717 Test Loss: 0.591 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.792619466781616
Epoch: 11, Steps: 13 | Train Loss: 0.193 Vali Loss: 0.848 Vali Acc: 0.522 Test Loss: 0.848 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.872055530548096
Epoch: 12, Steps: 13 | Train Loss: 0.145 Vali Loss: 0.709 Vali Acc: 0.688 Test Loss: 0.709 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 7.649229526519775
Epoch: 13, Steps: 13 | Train Loss: 0.101 Vali Loss: 0.644 Vali Acc: 0.732 Test Loss: 0.644 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 7.736084222793579
Epoch: 14, Steps: 13 | Train Loss: 0.045 Vali Loss: 0.681 Vali Acc: 0.727 Test Loss: 0.681 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 7.546506643295288
Epoch: 15, Steps: 13 | Train Loss: 0.040 Vali Loss: 0.700 Vali Acc: 0.727 Test Loss: 0.700 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 7.564011096954346
Epoch: 16, Steps: 13 | Train Loss: 0.025 Vali Loss: 0.762 Vali Acc: 0.698 Test Loss: 0.762 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 7.629346132278442
Epoch: 17, Steps: 13 | Train Loss: 0.028 Vali Loss: 0.858 Vali Acc: 0.727 Test Loss: 0.858 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 7.690921783447266
Epoch: 18, Steps: 13 | Train Loss: 0.013 Vali Loss: 0.869 Vali Acc: 0.741 Test Loss: 0.869 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 2818498
model size : 12.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 10.477683305740356
Epoch: 1, Steps: 13 | Train Loss: 0.564 Vali Loss: 0.541 Vali Acc: 0.727 Test Loss: 0.541 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 9.011934518814087
Epoch: 2, Steps: 13 | Train Loss: 0.515 Vali Loss: 0.516 Vali Acc: 0.780 Test Loss: 0.516 Test Acc: 0.780
Validation loss decreased (-0.726824 --> -0.780483).  Saving model ...
Epoch: 3 cost time: 9.821927070617676
Epoch: 3, Steps: 13 | Train Loss: 0.450 Vali Loss: 0.616 Vali Acc: 0.732 Test Loss: 0.616 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.828169822692871
Epoch: 4, Steps: 13 | Train Loss: 0.399 Vali Loss: 0.535 Vali Acc: 0.722 Test Loss: 0.535 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 9.512176513671875
Epoch: 5, Steps: 13 | Train Loss: 0.411 Vali Loss: 0.768 Vali Acc: 0.722 Test Loss: 0.768 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 10.118136167526245
Epoch: 6, Steps: 13 | Train Loss: 0.375 Vali Loss: 0.531 Vali Acc: 0.790 Test Loss: 0.531 Test Acc: 0.790
Validation loss decreased (-0.780483 --> -0.790239).  Saving model ...
Epoch: 7 cost time: 10.33549976348877
Epoch: 7, Steps: 13 | Train Loss: 0.263 Vali Loss: 0.534 Vali Acc: 0.727 Test Loss: 0.534 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 10.02757453918457
Epoch: 8, Steps: 13 | Train Loss: 0.204 Vali Loss: 0.578 Vali Acc: 0.688 Test Loss: 0.578 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 9.371201038360596
Epoch: 9, Steps: 13 | Train Loss: 0.454 Vali Loss: 0.756 Vali Acc: 0.746 Test Loss: 0.756 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 9.615783214569092
Epoch: 10, Steps: 13 | Train Loss: 0.129 Vali Loss: 0.646 Vali Acc: 0.678 Test Loss: 0.646 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 9.702335834503174
Epoch: 11, Steps: 13 | Train Loss: 0.155 Vali Loss: 0.612 Vali Acc: 0.722 Test Loss: 0.612 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 10.027473449707031
Epoch: 12, Steps: 13 | Train Loss: 0.100 Vali Loss: 0.796 Vali Acc: 0.605 Test Loss: 0.796 Test Acc: 0.605
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 10.077998876571655
Epoch: 13, Steps: 13 | Train Loss: 0.090 Vali Loss: 0.738 Vali Acc: 0.659 Test Loss: 0.738 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 10.276203870773315
Epoch: 14, Steps: 13 | Train Loss: 0.036 Vali Loss: 0.830 Vali Acc: 0.751 Test Loss: 0.830 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 10.129138708114624
Epoch: 15, Steps: 13 | Train Loss: 0.035 Vali Loss: 0.888 Vali Acc: 0.741 Test Loss: 0.888 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 9.97925591468811
Epoch: 16, Steps: 13 | Train Loss: 0.039 Vali Loss: 0.982 Vali Acc: 0.751 Test Loss: 0.982 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7902439024390244
model parameter : 9438658
model size : 37.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.511305809020996
Epoch: 1, Steps: 13 | Train Loss: 0.611 Vali Loss: 0.543 Vali Acc: 0.732 Test Loss: 0.543 Test Acc: 0.732
Validation loss decreased (inf --> -0.731702).  Saving model ...
Epoch: 2 cost time: 4.76702880859375
Epoch: 2, Steps: 13 | Train Loss: 0.522 Vali Loss: 0.626 Vali Acc: 0.615 Test Loss: 0.626 Test Acc: 0.615
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.834230661392212
Epoch: 3, Steps: 13 | Train Loss: 0.514 Vali Loss: 0.604 Vali Acc: 0.649 Test Loss: 0.604 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.898811101913452
Epoch: 4, Steps: 13 | Train Loss: 0.462 Vali Loss: 0.657 Vali Acc: 0.580 Test Loss: 0.657 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.133261203765869
Epoch: 5, Steps: 13 | Train Loss: 0.385 Vali Loss: 0.550 Vali Acc: 0.722 Test Loss: 0.550 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.16758131980896
Epoch: 6, Steps: 13 | Train Loss: 0.317 Vali Loss: 0.523 Vali Acc: 0.771 Test Loss: 0.523 Test Acc: 0.771
Validation loss decreased (-0.731702 --> -0.770726).  Saving model ...
Epoch: 7 cost time: 4.992595911026001
Epoch: 7, Steps: 13 | Train Loss: 0.242 Vali Loss: 0.536 Vali Acc: 0.727 Test Loss: 0.536 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.275145053863525
Epoch: 8, Steps: 13 | Train Loss: 0.178 Vali Loss: 0.562 Vali Acc: 0.717 Test Loss: 0.562 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.1909096240997314
Epoch: 9, Steps: 13 | Train Loss: 0.276 Vali Loss: 0.630 Vali Acc: 0.751 Test Loss: 0.630 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.241292953491211
Epoch: 10, Steps: 13 | Train Loss: 0.116 Vali Loss: 0.615 Vali Acc: 0.678 Test Loss: 0.615 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.11879825592041
Epoch: 11, Steps: 13 | Train Loss: 0.087 Vali Loss: 0.658 Vali Acc: 0.673 Test Loss: 0.658 Test Acc: 0.673
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.138920068740845
Epoch: 12, Steps: 13 | Train Loss: 0.100 Vali Loss: 0.696 Vali Acc: 0.698 Test Loss: 0.696 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.110986948013306
Epoch: 13, Steps: 13 | Train Loss: 0.116 Vali Loss: 0.668 Vali Acc: 0.707 Test Loss: 0.668 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.125808954238892
Epoch: 14, Steps: 13 | Train Loss: 0.048 Vali Loss: 0.707 Vali Acc: 0.737 Test Loss: 0.707 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.949260950088501
Epoch: 15, Steps: 13 | Train Loss: 0.030 Vali Loss: 0.852 Vali Acc: 0.741 Test Loss: 0.852 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.011747360229492
Epoch: 16, Steps: 13 | Train Loss: 0.018 Vali Loss: 0.748 Vali Acc: 0.737 Test Loss: 0.748 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 2818498
model size : 12.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 31.905126094818115
Epoch: 1, Steps: 13 | Train Loss: 0.605 Vali Loss: 0.585 Vali Acc: 0.712 Test Loss: 0.585 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 29.242630004882812
Epoch: 2, Steps: 13 | Train Loss: 0.564 Vali Loss: 0.555 Vali Acc: 0.712 Test Loss: 0.555 Test Acc: 0.712
Validation loss decreased (-0.712189 --> -0.712190).  Saving model ...
Epoch: 3 cost time: 30.593843698501587
Epoch: 3, Steps: 13 | Train Loss: 0.489 Vali Loss: 0.548 Vali Acc: 0.717 Test Loss: 0.548 Test Acc: 0.717
Validation loss decreased (-0.712190 --> -0.717068).  Saving model ...
Epoch: 4 cost time: 28.272157669067383
Epoch: 4, Steps: 13 | Train Loss: 0.437 Vali Loss: 0.542 Vali Acc: 0.722 Test Loss: 0.542 Test Acc: 0.722
Validation loss decreased (-0.717068 --> -0.721946).  Saving model ...
Epoch: 5 cost time: 30.461470127105713
Epoch: 5, Steps: 13 | Train Loss: 0.402 Vali Loss: 0.510 Vali Acc: 0.771 Test Loss: 0.510 Test Acc: 0.771
Validation loss decreased (-0.721946 --> -0.770727).  Saving model ...
Epoch: 6 cost time: 30.49908137321472
Epoch: 6, Steps: 13 | Train Loss: 0.327 Vali Loss: 0.574 Vali Acc: 0.746 Test Loss: 0.574 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 28.017657995224
Epoch: 7, Steps: 13 | Train Loss: 0.314 Vali Loss: 0.614 Vali Acc: 0.737 Test Loss: 0.614 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 30.41166067123413
Epoch: 8, Steps: 13 | Train Loss: 0.257 Vali Loss: 0.595 Vali Acc: 0.732 Test Loss: 0.595 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 29.70835542678833
Epoch: 9, Steps: 13 | Train Loss: 0.248 Vali Loss: 0.554 Vali Acc: 0.732 Test Loss: 0.554 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 28.604676246643066
Epoch: 10, Steps: 13 | Train Loss: 0.223 Vali Loss: 0.542 Vali Acc: 0.751 Test Loss: 0.542 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 28.275251150131226
Epoch: 11, Steps: 13 | Train Loss: 0.162 Vali Loss: 0.642 Vali Acc: 0.688 Test Loss: 0.642 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 29.236244440078735
Epoch: 12, Steps: 13 | Train Loss: 0.154 Vali Loss: 0.752 Vali Acc: 0.649 Test Loss: 0.752 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 29.591813325881958
Epoch: 13, Steps: 13 | Train Loss: 0.120 Vali Loss: 0.616 Vali Acc: 0.737 Test Loss: 0.616 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 28.636969327926636
Epoch: 14, Steps: 13 | Train Loss: 0.097 Vali Loss: 0.763 Vali Acc: 0.732 Test Loss: 0.763 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 30.349883794784546
Epoch: 15, Steps: 13 | Train Loss: 0.087 Vali Loss: 0.659 Vali Acc: 0.717 Test Loss: 0.659 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 9407458
model size : 36.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 17.35776138305664
Epoch: 1, Steps: 13 | Train Loss: 0.644 Vali Loss: 0.591 Vali Acc: 0.717 Test Loss: 0.591 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 15.792705297470093
Epoch: 2, Steps: 13 | Train Loss: 0.559 Vali Loss: 0.531 Vali Acc: 0.732 Test Loss: 0.531 Test Acc: 0.732
Validation loss decreased (-0.717067 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 14.861957788467407
Epoch: 3, Steps: 13 | Train Loss: 0.497 Vali Loss: 0.597 Vali Acc: 0.673 Test Loss: 0.597 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 14.745477676391602
Epoch: 4, Steps: 13 | Train Loss: 0.461 Vali Loss: 0.510 Vali Acc: 0.766 Test Loss: 0.510 Test Acc: 0.766
Validation loss decreased (-0.731702 --> -0.765849).  Saving model ...
Epoch: 5 cost time: 15.829779863357544
Epoch: 5, Steps: 13 | Train Loss: 0.415 Vali Loss: 0.665 Vali Acc: 0.741 Test Loss: 0.665 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 15.937653303146362
Epoch: 6, Steps: 13 | Train Loss: 0.409 Vali Loss: 0.704 Vali Acc: 0.741 Test Loss: 0.704 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 15.943272113800049
Epoch: 7, Steps: 13 | Train Loss: 0.359 Vali Loss: 0.517 Vali Acc: 0.776 Test Loss: 0.517 Test Acc: 0.776
Validation loss decreased (-0.765849 --> -0.775605).  Saving model ...
Epoch: 8 cost time: 15.971426486968994
Epoch: 8, Steps: 13 | Train Loss: 0.295 Vali Loss: 0.623 Vali Acc: 0.639 Test Loss: 0.623 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 14.617494344711304
Epoch: 9, Steps: 13 | Train Loss: 0.278 Vali Loss: 0.730 Vali Acc: 0.576 Test Loss: 0.730 Test Acc: 0.576
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 14.594104528427124
Epoch: 10, Steps: 13 | Train Loss: 0.220 Vali Loss: 0.605 Vali Acc: 0.761 Test Loss: 0.605 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 15.950801372528076
Epoch: 11, Steps: 13 | Train Loss: 0.258 Vali Loss: 0.576 Vali Acc: 0.707 Test Loss: 0.576 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 16.02248191833496
Epoch: 12, Steps: 13 | Train Loss: 0.178 Vali Loss: 0.561 Vali Acc: 0.751 Test Loss: 0.561 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 15.637983560562134
Epoch: 13, Steps: 13 | Train Loss: 0.127 Vali Loss: 0.597 Vali Acc: 0.693 Test Loss: 0.597 Test Acc: 0.693
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 15.888400793075562
Epoch: 14, Steps: 13 | Train Loss: 0.108 Vali Loss: 0.764 Vali Acc: 0.766 Test Loss: 0.764 Test Acc: 0.766
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 14.737433671951294
Epoch: 15, Steps: 13 | Train Loss: 0.103 Vali Loss: 0.746 Vali Acc: 0.771 Test Loss: 0.746 Test Acc: 0.771
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 14.920756101608276
Epoch: 16, Steps: 13 | Train Loss: 0.089 Vali Loss: 0.668 Vali Acc: 0.737 Test Loss: 0.668 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 16.03900408744812
Epoch: 17, Steps: 13 | Train Loss: 0.062 Vali Loss: 0.675 Vali Acc: 0.678 Test Loss: 0.675 Test Acc: 0.678
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 2787042
model size : 11.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 20.00841522216797
Epoch: 1, Steps: 13 | Train Loss: 0.604 Vali Loss: 0.586 Vali Acc: 0.707 Test Loss: 0.586 Test Acc: 0.707
Validation loss decreased (inf --> -0.707311).  Saving model ...
Epoch: 2 cost time: 17.99068570137024
Epoch: 2, Steps: 13 | Train Loss: 0.570 Vali Loss: 0.548 Vali Acc: 0.751 Test Loss: 0.548 Test Acc: 0.751
Validation loss decreased (-0.707311 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 17.071962594985962
Epoch: 3, Steps: 13 | Train Loss: 0.494 Vali Loss: 0.523 Vali Acc: 0.746 Test Loss: 0.523 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 18.03960871696472
Epoch: 4, Steps: 13 | Train Loss: 0.456 Vali Loss: 0.540 Vali Acc: 0.732 Test Loss: 0.540 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 18.041686534881592
Epoch: 5, Steps: 13 | Train Loss: 0.431 Vali Loss: 0.528 Vali Acc: 0.737 Test Loss: 0.528 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 18.024791955947876
Epoch: 6, Steps: 13 | Train Loss: 0.326 Vali Loss: 0.535 Vali Acc: 0.756 Test Loss: 0.535 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756092).  Saving model ...
Epoch: 7 cost time: 18.465415954589844
Epoch: 7, Steps: 13 | Train Loss: 0.318 Vali Loss: 0.557 Vali Acc: 0.746 Test Loss: 0.557 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 17.018784999847412
Epoch: 8, Steps: 13 | Train Loss: 0.268 Vali Loss: 0.569 Vali Acc: 0.766 Test Loss: 0.569 Test Acc: 0.766
Validation loss decreased (-0.756092 --> -0.765848).  Saving model ...
Epoch: 9 cost time: 18.13827872276306
Epoch: 9, Steps: 13 | Train Loss: 0.255 Vali Loss: 0.544 Vali Acc: 0.766 Test Loss: 0.544 Test Acc: 0.766
Validation loss decreased (-0.765848 --> -0.765848).  Saving model ...
Epoch: 10 cost time: 18.095800638198853
Epoch: 10, Steps: 13 | Train Loss: 0.191 Vali Loss: 0.663 Vali Acc: 0.756 Test Loss: 0.663 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 18.309840202331543
Epoch: 11, Steps: 13 | Train Loss: 0.181 Vali Loss: 0.736 Vali Acc: 0.585 Test Loss: 0.736 Test Acc: 0.585
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 17.88263726234436
Epoch: 12, Steps: 13 | Train Loss: 0.211 Vali Loss: 0.723 Vali Acc: 0.610 Test Loss: 0.723 Test Acc: 0.610
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 17.370052337646484
Epoch: 13, Steps: 13 | Train Loss: 0.126 Vali Loss: 0.730 Vali Acc: 0.639 Test Loss: 0.730 Test Acc: 0.639
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 16.85185694694519
Epoch: 14, Steps: 13 | Train Loss: 0.098 Vali Loss: 0.693 Vali Acc: 0.751 Test Loss: 0.693 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 18.529598474502563
Epoch: 15, Steps: 13 | Train Loss: 0.088 Vali Loss: 0.654 Vali Acc: 0.717 Test Loss: 0.654 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 18.529741287231445
Epoch: 16, Steps: 13 | Train Loss: 0.079 Vali Loss: 0.826 Vali Acc: 0.595 Test Loss: 0.826 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 18.17328405380249
Epoch: 17, Steps: 13 | Train Loss: 0.108 Vali Loss: 0.993 Vali Acc: 0.571 Test Loss: 0.993 Test Acc: 0.571
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 17.254695177078247
Epoch: 18, Steps: 13 | Train Loss: 0.083 Vali Loss: 0.709 Vali Acc: 0.707 Test Loss: 0.709 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 18.644985675811768
Epoch: 19, Steps: 13 | Train Loss: 0.037 Vali Loss: 0.755 Vali Acc: 0.683 Test Loss: 0.755 Test Acc: 0.683
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 9407458
model size : 36.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 10.60795283317566
Epoch: 1, Steps: 13 | Train Loss: 0.643 Vali Loss: 0.594 Vali Acc: 0.717 Test Loss: 0.594 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 8.594735622406006
Epoch: 2, Steps: 13 | Train Loss: 0.562 Vali Loss: 0.536 Vali Acc: 0.737 Test Loss: 0.536 Test Acc: 0.737
Validation loss decreased (-0.717067 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 8.205029487609863
Epoch: 3, Steps: 13 | Train Loss: 0.498 Vali Loss: 0.605 Vali Acc: 0.649 Test Loss: 0.605 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.054624795913696
Epoch: 4, Steps: 13 | Train Loss: 0.470 Vali Loss: 0.510 Vali Acc: 0.756 Test Loss: 0.510 Test Acc: 0.756
Validation loss decreased (-0.736580 --> -0.756092).  Saving model ...
Epoch: 5 cost time: 8.821891784667969
Epoch: 5, Steps: 13 | Train Loss: 0.424 Vali Loss: 0.699 Vali Acc: 0.741 Test Loss: 0.699 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.798490285873413
Epoch: 6, Steps: 13 | Train Loss: 0.418 Vali Loss: 0.596 Vali Acc: 0.746 Test Loss: 0.596 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 8.703807353973389
Epoch: 7, Steps: 13 | Train Loss: 0.343 Vali Loss: 0.505 Vali Acc: 0.766 Test Loss: 0.505 Test Acc: 0.766
Validation loss decreased (-0.756092 --> -0.765849).  Saving model ...
Epoch: 8 cost time: 8.776232719421387
Epoch: 8, Steps: 13 | Train Loss: 0.316 Vali Loss: 0.605 Vali Acc: 0.620 Test Loss: 0.605 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 8.648335695266724
Epoch: 9, Steps: 13 | Train Loss: 0.286 Vali Loss: 0.720 Vali Acc: 0.590 Test Loss: 0.720 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 7.958316326141357
Epoch: 10, Steps: 13 | Train Loss: 0.210 Vali Loss: 0.604 Vali Acc: 0.761 Test Loss: 0.604 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 8.26010799407959
Epoch: 11, Steps: 13 | Train Loss: 0.234 Vali Loss: 0.562 Vali Acc: 0.751 Test Loss: 0.562 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 8.722600936889648
Epoch: 12, Steps: 13 | Train Loss: 0.169 Vali Loss: 0.592 Vali Acc: 0.771 Test Loss: 0.592 Test Acc: 0.771
Validation loss decreased (-0.765849 --> -0.770726).  Saving model ...
Epoch: 13 cost time: 8.800506830215454
Epoch: 13, Steps: 13 | Train Loss: 0.123 Vali Loss: 0.644 Vali Acc: 0.644 Test Loss: 0.644 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 8.83512020111084
Epoch: 14, Steps: 13 | Train Loss: 0.099 Vali Loss: 0.712 Vali Acc: 0.756 Test Loss: 0.712 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 8.821852207183838
Epoch: 15, Steps: 13 | Train Loss: 0.082 Vali Loss: 0.655 Vali Acc: 0.693 Test Loss: 0.655 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 8.377307176589966
Epoch: 16, Steps: 13 | Train Loss: 0.079 Vali Loss: 0.696 Vali Acc: 0.717 Test Loss: 0.696 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 7.881209373474121
Epoch: 17, Steps: 13 | Train Loss: 0.050 Vali Loss: 0.693 Vali Acc: 0.702 Test Loss: 0.693 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 7.857583522796631
Epoch: 18, Steps: 13 | Train Loss: 0.033 Vali Loss: 0.706 Vali Acc: 0.698 Test Loss: 0.706 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 7.7891905307769775
Epoch: 19, Steps: 13 | Train Loss: 0.028 Vali Loss: 0.829 Vali Acc: 0.663 Test Loss: 0.829 Test Acc: 0.663
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 8.239323616027832
Epoch: 20, Steps: 13 | Train Loss: 0.023 Vali Loss: 0.811 Vali Acc: 0.707 Test Loss: 0.811 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 8.460551977157593
Epoch: 21, Steps: 13 | Train Loss: 0.033 Vali Loss: 0.818 Vali Acc: 0.707 Test Loss: 0.818 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 8.284260988235474
Epoch: 22, Steps: 13 | Train Loss: 0.017 Vali Loss: 0.830 Vali Acc: 0.712 Test Loss: 0.830 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 2787042
model size : 11.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 11.017588376998901
Epoch: 1, Steps: 13 | Train Loss: 0.604 Vali Loss: 0.588 Vali Acc: 0.707 Test Loss: 0.588 Test Acc: 0.707
Validation loss decreased (inf --> -0.707311).  Saving model ...
Epoch: 2 cost time: 9.708585023880005
Epoch: 2, Steps: 13 | Train Loss: 0.571 Vali Loss: 0.548 Vali Acc: 0.741 Test Loss: 0.548 Test Acc: 0.741
Validation loss decreased (-0.707311 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 10.381137132644653
Epoch: 3, Steps: 13 | Train Loss: 0.505 Vali Loss: 0.528 Vali Acc: 0.746 Test Loss: 0.528 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 10.327109575271606
Epoch: 4, Steps: 13 | Train Loss: 0.455 Vali Loss: 0.542 Vali Acc: 0.737 Test Loss: 0.542 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.403086185455322
Epoch: 5, Steps: 13 | Train Loss: 0.437 Vali Loss: 0.512 Vali Acc: 0.766 Test Loss: 0.512 Test Acc: 0.766
Validation loss decreased (-0.746336 --> -0.765849).  Saving model ...
Epoch: 6 cost time: 10.168457984924316
Epoch: 6, Steps: 13 | Train Loss: 0.333 Vali Loss: 0.548 Vali Acc: 0.751 Test Loss: 0.548 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.017836332321167
Epoch: 7, Steps: 13 | Train Loss: 0.320 Vali Loss: 0.573 Vali Acc: 0.746 Test Loss: 0.573 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 9.624929189682007
Epoch: 8, Steps: 13 | Train Loss: 0.502 Vali Loss: 0.573 Vali Acc: 0.751 Test Loss: 0.573 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 10.201524019241333
Epoch: 9, Steps: 13 | Train Loss: 0.253 Vali Loss: 0.559 Vali Acc: 0.746 Test Loss: 0.559 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 10.390593767166138
Epoch: 10, Steps: 13 | Train Loss: 0.254 Vali Loss: 0.675 Vali Acc: 0.751 Test Loss: 0.675 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 10.338366270065308
Epoch: 11, Steps: 13 | Train Loss: 0.184 Vali Loss: 0.662 Vali Acc: 0.620 Test Loss: 0.662 Test Acc: 0.620
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 10.397159337997437
Epoch: 12, Steps: 13 | Train Loss: 0.186 Vali Loss: 0.734 Vali Acc: 0.605 Test Loss: 0.734 Test Acc: 0.605
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 10.123621940612793
Epoch: 13, Steps: 13 | Train Loss: 0.128 Vali Loss: 0.756 Vali Acc: 0.624 Test Loss: 0.756 Test Acc: 0.624
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 9.38090968132019
Epoch: 14, Steps: 13 | Train Loss: 0.140 Vali Loss: 0.676 Vali Acc: 0.727 Test Loss: 0.676 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 9.724308013916016
Epoch: 15, Steps: 13 | Train Loss: 0.121 Vali Loss: 0.655 Vali Acc: 0.727 Test Loss: 0.655 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 9407458
model size : 36.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.000987768173218
Epoch: 1, Steps: 13 | Train Loss: 0.643 Vali Loss: 0.594 Vali Acc: 0.717 Test Loss: 0.594 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 5.572814226150513
Epoch: 2, Steps: 13 | Train Loss: 0.566 Vali Loss: 0.538 Vali Acc: 0.732 Test Loss: 0.538 Test Acc: 0.732
Validation loss decreased (-0.717067 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 5.607286691665649
Epoch: 3, Steps: 13 | Train Loss: 0.504 Vali Loss: 0.608 Vali Acc: 0.649 Test Loss: 0.608 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.561133146286011
Epoch: 4, Steps: 13 | Train Loss: 0.475 Vali Loss: 0.511 Vali Acc: 0.756 Test Loss: 0.511 Test Acc: 0.756
Validation loss decreased (-0.731702 --> -0.756092).  Saving model ...
Epoch: 5 cost time: 5.570641279220581
Epoch: 5, Steps: 13 | Train Loss: 0.422 Vali Loss: 0.700 Vali Acc: 0.737 Test Loss: 0.700 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.2150797843933105
Epoch: 6, Steps: 13 | Train Loss: 0.417 Vali Loss: 0.591 Vali Acc: 0.746 Test Loss: 0.591 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.279485702514648
Epoch: 7, Steps: 13 | Train Loss: 0.368 Vali Loss: 0.576 Vali Acc: 0.751 Test Loss: 0.576 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.217364311218262
Epoch: 8, Steps: 13 | Train Loss: 0.300 Vali Loss: 0.559 Vali Acc: 0.678 Test Loss: 0.559 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.6384007930755615
Epoch: 9, Steps: 13 | Train Loss: 0.327 Vali Loss: 0.651 Vali Acc: 0.610 Test Loss: 0.651 Test Acc: 0.610
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.613658905029297
Epoch: 10, Steps: 13 | Train Loss: 0.204 Vali Loss: 0.620 Vali Acc: 0.756 Test Loss: 0.620 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.638843536376953
Epoch: 11, Steps: 13 | Train Loss: 0.195 Vali Loss: 0.661 Vali Acc: 0.761 Test Loss: 0.661 Test Acc: 0.761
Validation loss decreased (-0.756092 --> -0.760969).  Saving model ...
Epoch: 12 cost time: 5.650164604187012
Epoch: 12, Steps: 13 | Train Loss: 0.312 Vali Loss: 0.663 Vali Acc: 0.761 Test Loss: 0.663 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.581925630569458
Epoch: 13, Steps: 13 | Train Loss: 0.128 Vali Loss: 0.588 Vali Acc: 0.712 Test Loss: 0.588 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.6706624031066895
Epoch: 14, Steps: 13 | Train Loss: 0.098 Vali Loss: 0.618 Vali Acc: 0.717 Test Loss: 0.618 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.561589956283569
Epoch: 15, Steps: 13 | Train Loss: 0.102 Vali Loss: 0.661 Vali Acc: 0.722 Test Loss: 0.661 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.272956371307373
Epoch: 16, Steps: 13 | Train Loss: 0.139 Vali Loss: 0.666 Vali Acc: 0.707 Test Loss: 0.666 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.072391986846924
Epoch: 17, Steps: 13 | Train Loss: 0.084 Vali Loss: 0.701 Vali Acc: 0.712 Test Loss: 0.701 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.244098424911499
Epoch: 18, Steps: 13 | Train Loss: 0.039 Vali Loss: 0.734 Vali Acc: 0.702 Test Loss: 0.734 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.226975202560425
Epoch: 19, Steps: 13 | Train Loss: 0.026 Vali Loss: 0.762 Vali Acc: 0.693 Test Loss: 0.762 Test Acc: 0.693
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.600235462188721
Epoch: 20, Steps: 13 | Train Loss: 0.033 Vali Loss: 0.798 Vali Acc: 0.678 Test Loss: 0.798 Test Acc: 0.678
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.386714935302734
Epoch: 21, Steps: 13 | Train Loss: 0.083 Vali Loss: 0.933 Vali Acc: 0.615 Test Loss: 0.933 Test Acc: 0.615
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 2787042
model size : 11.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 18.247244596481323
Epoch: 1, Steps: 13 | Train Loss: 0.617 Vali Loss: 0.571 Vali Acc: 0.707 Test Loss: 0.571 Test Acc: 0.707
Validation loss decreased (inf --> -0.707311).  Saving model ...
Epoch: 2 cost time: 14.965356349945068
Epoch: 2, Steps: 13 | Train Loss: 0.535 Vali Loss: 0.545 Vali Acc: 0.746 Test Loss: 0.545 Test Acc: 0.746
Validation loss decreased (-0.707311 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 15.779737949371338
Epoch: 3, Steps: 13 | Train Loss: 0.473 Vali Loss: 0.535 Vali Acc: 0.741 Test Loss: 0.535 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 15.888760328292847
Epoch: 4, Steps: 13 | Train Loss: 0.405 Vali Loss: 0.531 Vali Acc: 0.741 Test Loss: 0.531 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 16.489497900009155
Epoch: 5, Steps: 13 | Train Loss: 0.403 Vali Loss: 0.706 Vali Acc: 0.620 Test Loss: 0.706 Test Acc: 0.620
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 15.829041481018066
Epoch: 6, Steps: 13 | Train Loss: 0.338 Vali Loss: 0.541 Vali Acc: 0.737 Test Loss: 0.541 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 15.462285280227661
Epoch: 7, Steps: 13 | Train Loss: 0.310 Vali Loss: 0.531 Vali Acc: 0.727 Test Loss: 0.531 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 15.826900005340576
Epoch: 8, Steps: 13 | Train Loss: 0.249 Vali Loss: 0.546 Vali Acc: 0.712 Test Loss: 0.546 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 16.45309853553772
Epoch: 9, Steps: 13 | Train Loss: 0.221 Vali Loss: 0.645 Vali Acc: 0.732 Test Loss: 0.645 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 15.914011478424072
Epoch: 10, Steps: 13 | Train Loss: 0.246 Vali Loss: 0.627 Vali Acc: 0.761 Test Loss: 0.627 Test Acc: 0.761
Validation loss decreased (-0.746336 --> -0.760969).  Saving model ...
Epoch: 11 cost time: 15.200226306915283
Epoch: 11, Steps: 13 | Train Loss: 0.175 Vali Loss: 0.652 Vali Acc: 0.756 Test Loss: 0.652 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 14.538131952285767
Epoch: 12, Steps: 13 | Train Loss: 0.163 Vali Loss: 0.682 Vali Acc: 0.756 Test Loss: 0.682 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 16.022182941436768
Epoch: 13, Steps: 13 | Train Loss: 0.094 Vali Loss: 0.647 Vali Acc: 0.702 Test Loss: 0.647 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 15.424247980117798
Epoch: 14, Steps: 13 | Train Loss: 0.079 Vali Loss: 0.668 Vali Acc: 0.737 Test Loss: 0.668 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 15.923985242843628
Epoch: 15, Steps: 13 | Train Loss: 0.068 Vali Loss: 0.654 Vali Acc: 0.727 Test Loss: 0.654 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 14.373658418655396
Epoch: 16, Steps: 13 | Train Loss: 0.068 Vali Loss: 0.779 Vali Acc: 0.688 Test Loss: 0.779 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 15.908944129943848
Epoch: 17, Steps: 13 | Train Loss: 0.103 Vali Loss: 0.808 Vali Acc: 0.615 Test Loss: 0.808 Test Acc: 0.615
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 15.686800003051758
Epoch: 18, Steps: 13 | Train Loss: 0.039 Vali Loss: 0.844 Vali Acc: 0.624 Test Loss: 0.844 Test Acc: 0.624
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 16.57718539237976
Epoch: 19, Steps: 13 | Train Loss: 0.038 Vali Loss: 0.793 Vali Acc: 0.717 Test Loss: 0.793 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 15.394808053970337
Epoch: 20, Steps: 13 | Train Loss: 0.025 Vali Loss: 0.802 Vali Acc: 0.683 Test Loss: 0.802 Test Acc: 0.683
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 4720098
model size : 18.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 10.143974542617798
Epoch: 1, Steps: 13 | Train Loss: 0.674 Vali Loss: 0.625 Vali Acc: 0.722 Test Loss: 0.625 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 8.446043968200684
Epoch: 2, Steps: 13 | Train Loss: 0.566 Vali Loss: 0.542 Vali Acc: 0.737 Test Loss: 0.542 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 8.636794567108154
Epoch: 3, Steps: 13 | Train Loss: 0.506 Vali Loss: 0.518 Vali Acc: 0.741 Test Loss: 0.518 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741458).  Saving model ...
Epoch: 4 cost time: 8.623833417892456
Epoch: 4, Steps: 13 | Train Loss: 0.442 Vali Loss: 0.511 Vali Acc: 0.741 Test Loss: 0.511 Test Acc: 0.741
Validation loss decreased (-0.741458 --> -0.741458).  Saving model ...
Epoch: 5 cost time: 8.168468713760376
Epoch: 5, Steps: 13 | Train Loss: 0.401 Vali Loss: 0.522 Vali Acc: 0.761 Test Loss: 0.522 Test Acc: 0.761
Validation loss decreased (-0.741458 --> -0.760970).  Saving model ...
Epoch: 6 cost time: 7.7348504066467285
Epoch: 6, Steps: 13 | Train Loss: 0.351 Vali Loss: 0.509 Vali Acc: 0.776 Test Loss: 0.509 Test Acc: 0.776
Validation loss decreased (-0.760970 --> -0.775605).  Saving model ...
Epoch: 7 cost time: 7.948509216308594
Epoch: 7, Steps: 13 | Train Loss: 0.309 Vali Loss: 0.606 Vali Acc: 0.727 Test Loss: 0.606 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.084529161453247
Epoch: 8, Steps: 13 | Train Loss: 0.286 Vali Loss: 0.652 Vali Acc: 0.746 Test Loss: 0.652 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 8.655077934265137
Epoch: 9, Steps: 13 | Train Loss: 0.236 Vali Loss: 0.608 Vali Acc: 0.751 Test Loss: 0.608 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 8.81452226638794
Epoch: 10, Steps: 13 | Train Loss: 0.187 Vali Loss: 0.626 Vali Acc: 0.746 Test Loss: 0.626 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 8.877416610717773
Epoch: 11, Steps: 13 | Train Loss: 0.214 Vali Loss: 0.563 Vali Acc: 0.727 Test Loss: 0.563 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 8.483693599700928
Epoch: 12, Steps: 13 | Train Loss: 0.144 Vali Loss: 0.561 Vali Acc: 0.756 Test Loss: 0.561 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 8.52986216545105
Epoch: 13, Steps: 13 | Train Loss: 0.125 Vali Loss: 0.590 Vali Acc: 0.717 Test Loss: 0.590 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 8.334697246551514
Epoch: 14, Steps: 13 | Train Loss: 0.094 Vali Loss: 0.628 Vali Acc: 0.688 Test Loss: 0.628 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 8.071651697158813
Epoch: 15, Steps: 13 | Train Loss: 0.090 Vali Loss: 0.643 Vali Acc: 0.707 Test Loss: 0.643 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 8.241416692733765
Epoch: 16, Steps: 13 | Train Loss: 0.078 Vali Loss: 0.795 Vali Acc: 0.751 Test Loss: 0.795 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 1409762
model size : 6.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 12.734023332595825
Epoch: 1, Steps: 13 | Train Loss: 0.615 Vali Loss: 0.572 Vali Acc: 0.707 Test Loss: 0.572 Test Acc: 0.707
Validation loss decreased (inf --> -0.707311).  Saving model ...
Epoch: 2 cost time: 10.753717184066772
Epoch: 2, Steps: 13 | Train Loss: 0.537 Vali Loss: 0.543 Vali Acc: 0.737 Test Loss: 0.543 Test Acc: 0.737
Validation loss decreased (-0.707311 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 11.140653133392334
Epoch: 3, Steps: 13 | Train Loss: 0.475 Vali Loss: 0.527 Vali Acc: 0.737 Test Loss: 0.527 Test Acc: 0.737
Validation loss decreased (-0.736580 --> -0.736580).  Saving model ...
Epoch: 4 cost time: 10.026604652404785
Epoch: 4, Steps: 13 | Train Loss: 0.415 Vali Loss: 0.503 Vali Acc: 0.776 Test Loss: 0.503 Test Acc: 0.776
Validation loss decreased (-0.736580 --> -0.775605).  Saving model ...
Epoch: 5 cost time: 9.85743236541748
Epoch: 5, Steps: 13 | Train Loss: 0.412 Vali Loss: 0.635 Vali Acc: 0.620 Test Loss: 0.635 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 10.800316095352173
Epoch: 6, Steps: 13 | Train Loss: 0.365 Vali Loss: 0.513 Vali Acc: 0.776 Test Loss: 0.513 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 10.360256910324097
Epoch: 7, Steps: 13 | Train Loss: 0.318 Vali Loss: 0.504 Vali Acc: 0.756 Test Loss: 0.504 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 10.581357955932617
Epoch: 8, Steps: 13 | Train Loss: 0.277 Vali Loss: 0.517 Vali Acc: 0.746 Test Loss: 0.517 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 8.07702088356018
Epoch: 9, Steps: 13 | Train Loss: 0.220 Vali Loss: 0.591 Vali Acc: 0.756 Test Loss: 0.591 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 10.29963994026184
Epoch: 10, Steps: 13 | Train Loss: 0.247 Vali Loss: 0.647 Vali Acc: 0.785 Test Loss: 0.647 Test Acc: 0.785
Validation loss decreased (-0.775605 --> -0.785359).  Saving model ...
Epoch: 11 cost time: 10.324316024780273
Epoch: 11, Steps: 13 | Train Loss: 0.166 Vali Loss: 0.599 Vali Acc: 0.746 Test Loss: 0.599 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 10.734895944595337
Epoch: 12, Steps: 13 | Train Loss: 0.185 Vali Loss: 0.765 Vali Acc: 0.761 Test Loss: 0.765 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 10.636353254318237
Epoch: 13, Steps: 13 | Train Loss: 0.105 Vali Loss: 0.626 Vali Acc: 0.737 Test Loss: 0.626 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 10.939915895462036
Epoch: 14, Steps: 13 | Train Loss: 0.076 Vali Loss: 0.666 Vali Acc: 0.712 Test Loss: 0.666 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 10.891052484512329
Epoch: 15, Steps: 13 | Train Loss: 0.073 Vali Loss: 0.668 Vali Acc: 0.732 Test Loss: 0.668 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 10.160293102264404
Epoch: 16, Steps: 13 | Train Loss: 0.056 Vali Loss: 0.690 Vali Acc: 0.702 Test Loss: 0.690 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 10.11268401145935
Epoch: 17, Steps: 13 | Train Loss: 0.048 Vali Loss: 0.780 Vali Acc: 0.629 Test Loss: 0.780 Test Acc: 0.629
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 10.383861064910889
Epoch: 18, Steps: 13 | Train Loss: 0.045 Vali Loss: 0.818 Vali Acc: 0.615 Test Loss: 0.818 Test Acc: 0.615
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 9.983857870101929
Epoch: 19, Steps: 13 | Train Loss: 0.029 Vali Loss: 0.771 Vali Acc: 0.707 Test Loss: 0.771 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 10.576225280761719
Epoch: 20, Steps: 13 | Train Loss: 0.024 Vali Loss: 0.816 Vali Acc: 0.722 Test Loss: 0.816 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7853658536585366
model parameter : 4720098
model size : 18.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.263966798782349
Epoch: 1, Steps: 13 | Train Loss: 0.675 Vali Loss: 0.626 Vali Acc: 0.717 Test Loss: 0.626 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 5.638331890106201
Epoch: 2, Steps: 13 | Train Loss: 0.567 Vali Loss: 0.548 Vali Acc: 0.732 Test Loss: 0.548 Test Acc: 0.732
Validation loss decreased (-0.717067 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 5.225266695022583
Epoch: 3, Steps: 13 | Train Loss: 0.510 Vali Loss: 0.519 Vali Acc: 0.741 Test Loss: 0.519 Test Acc: 0.741
Validation loss decreased (-0.731702 --> -0.741458).  Saving model ...
Epoch: 4 cost time: 5.113817930221558
Epoch: 4, Steps: 13 | Train Loss: 0.446 Vali Loss: 0.508 Vali Acc: 0.761 Test Loss: 0.508 Test Acc: 0.761
Validation loss decreased (-0.741458 --> -0.760971).  Saving model ...
Epoch: 5 cost time: 5.141592502593994
Epoch: 5, Steps: 13 | Train Loss: 0.406 Vali Loss: 0.504 Vali Acc: 0.766 Test Loss: 0.504 Test Acc: 0.766
Validation loss decreased (-0.760971 --> -0.765849).  Saving model ...
Epoch: 6 cost time: 5.410815477371216
Epoch: 6, Steps: 13 | Train Loss: 0.357 Vali Loss: 0.495 Vali Acc: 0.780 Test Loss: 0.495 Test Acc: 0.780
Validation loss decreased (-0.765849 --> -0.780483).  Saving model ...
Epoch: 7 cost time: 5.685603618621826
Epoch: 7, Steps: 13 | Train Loss: 0.313 Vali Loss: 0.593 Vali Acc: 0.737 Test Loss: 0.593 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.714297771453857
Epoch: 8, Steps: 13 | Train Loss: 0.287 Vali Loss: 0.658 Vali Acc: 0.737 Test Loss: 0.658 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.678285360336304
Epoch: 9, Steps: 13 | Train Loss: 0.261 Vali Loss: 0.533 Vali Acc: 0.771 Test Loss: 0.533 Test Acc: 0.771
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.512606859207153
Epoch: 10, Steps: 13 | Train Loss: 0.185 Vali Loss: 0.565 Vali Acc: 0.766 Test Loss: 0.565 Test Acc: 0.766
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.5333216190338135
Epoch: 11, Steps: 13 | Train Loss: 0.159 Vali Loss: 0.558 Vali Acc: 0.741 Test Loss: 0.558 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.413909196853638
Epoch: 12, Steps: 13 | Train Loss: 0.171 Vali Loss: 0.628 Vali Acc: 0.741 Test Loss: 0.628 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.955016136169434
Epoch: 13, Steps: 13 | Train Loss: 0.139 Vali Loss: 0.646 Vali Acc: 0.698 Test Loss: 0.646 Test Acc: 0.698
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.233416795730591
Epoch: 14, Steps: 13 | Train Loss: 0.116 Vali Loss: 0.716 Vali Acc: 0.659 Test Loss: 0.716 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.679992914199829
Epoch: 15, Steps: 13 | Train Loss: 0.127 Vali Loss: 0.654 Vali Acc: 0.702 Test Loss: 0.654 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.639326572418213
Epoch: 16, Steps: 13 | Train Loss: 0.084 Vali Loss: 0.640 Vali Acc: 0.751 Test Loss: 0.640 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7804878048780488
model parameter : 1409762
model size : 6.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.211900472640991
Epoch: 1, Steps: 13 | Train Loss: 0.614 Vali Loss: 0.572 Vali Acc: 0.712 Test Loss: 0.572 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 6.986592054367065
Epoch: 2, Steps: 13 | Train Loss: 0.538 Vali Loss: 0.544 Vali Acc: 0.732 Test Loss: 0.544 Test Acc: 0.732
Validation loss decreased (-0.712189 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 6.625056028366089
Epoch: 3, Steps: 13 | Train Loss: 0.474 Vali Loss: 0.528 Vali Acc: 0.737 Test Loss: 0.528 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736580).  Saving model ...
Epoch: 4 cost time: 6.314340114593506
Epoch: 4, Steps: 13 | Train Loss: 0.419 Vali Loss: 0.506 Vali Acc: 0.776 Test Loss: 0.506 Test Acc: 0.776
Validation loss decreased (-0.736580 --> -0.775605).  Saving model ...
Epoch: 5 cost time: 6.1333653926849365
Epoch: 5, Steps: 13 | Train Loss: 0.418 Vali Loss: 0.641 Vali Acc: 0.605 Test Loss: 0.641 Test Acc: 0.605
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.351163625717163
Epoch: 6, Steps: 13 | Train Loss: 0.402 Vali Loss: 0.513 Vali Acc: 0.771 Test Loss: 0.513 Test Acc: 0.771
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.619819641113281
Epoch: 7, Steps: 13 | Train Loss: 0.334 Vali Loss: 0.512 Vali Acc: 0.746 Test Loss: 0.512 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.703732252120972
Epoch: 8, Steps: 13 | Train Loss: 0.269 Vali Loss: 0.516 Vali Acc: 0.741 Test Loss: 0.516 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.681490659713745
Epoch: 9, Steps: 13 | Train Loss: 0.236 Vali Loss: 0.658 Vali Acc: 0.746 Test Loss: 0.658 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 6.688960552215576
Epoch: 10, Steps: 13 | Train Loss: 0.274 Vali Loss: 0.666 Vali Acc: 0.771 Test Loss: 0.666 Test Acc: 0.771
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 6.537212371826172
Epoch: 11, Steps: 13 | Train Loss: 0.182 Vali Loss: 0.573 Vali Acc: 0.751 Test Loss: 0.573 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 6.195749282836914
Epoch: 12, Steps: 13 | Train Loss: 0.176 Vali Loss: 0.667 Vali Acc: 0.766 Test Loss: 0.667 Test Acc: 0.766
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 6.315107345581055
Epoch: 13, Steps: 13 | Train Loss: 0.110 Vali Loss: 0.606 Vali Acc: 0.727 Test Loss: 0.606 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 6.879134178161621
Epoch: 14, Steps: 13 | Train Loss: 0.083 Vali Loss: 0.638 Vali Acc: 0.712 Test Loss: 0.638 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 4720098
model size : 18.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.4289891719818115
Epoch: 1, Steps: 13 | Train Loss: 0.674 Vali Loss: 0.625 Vali Acc: 0.722 Test Loss: 0.625 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 3.8428940773010254
Epoch: 2, Steps: 13 | Train Loss: 0.566 Vali Loss: 0.546 Vali Acc: 0.732 Test Loss: 0.546 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 3.839484930038452
Epoch: 3, Steps: 13 | Train Loss: 0.511 Vali Loss: 0.518 Vali Acc: 0.741 Test Loss: 0.518 Test Acc: 0.741
Validation loss decreased (-0.731702 --> -0.741458).  Saving model ...
Epoch: 4 cost time: 3.8940818309783936
Epoch: 4, Steps: 13 | Train Loss: 0.448 Vali Loss: 0.509 Vali Acc: 0.746 Test Loss: 0.509 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746336).  Saving model ...
Epoch: 5 cost time: 3.8767144680023193
Epoch: 5, Steps: 13 | Train Loss: 0.405 Vali Loss: 0.508 Vali Acc: 0.766 Test Loss: 0.508 Test Acc: 0.766
Validation loss decreased (-0.746336 --> -0.765849).  Saving model ...
Epoch: 6 cost time: 3.635962963104248
Epoch: 6, Steps: 13 | Train Loss: 0.357 Vali Loss: 0.497 Vali Acc: 0.771 Test Loss: 0.497 Test Acc: 0.771
Validation loss decreased (-0.765849 --> -0.770727).  Saving model ...
Epoch: 7 cost time: 3.64986515045166
Epoch: 7, Steps: 13 | Train Loss: 0.316 Vali Loss: 0.604 Vali Acc: 0.732 Test Loss: 0.604 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.656764268875122
Epoch: 8, Steps: 13 | Train Loss: 0.287 Vali Loss: 0.663 Vali Acc: 0.737 Test Loss: 0.663 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.6492412090301514
Epoch: 9, Steps: 13 | Train Loss: 0.248 Vali Loss: 0.535 Vali Acc: 0.761 Test Loss: 0.535 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.8835978507995605
Epoch: 10, Steps: 13 | Train Loss: 0.283 Vali Loss: 0.617 Vali Acc: 0.756 Test Loss: 0.617 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.884221315383911
Epoch: 11, Steps: 13 | Train Loss: 0.173 Vali Loss: 0.577 Vali Acc: 0.751 Test Loss: 0.577 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.7534048557281494
Epoch: 12, Steps: 13 | Train Loss: 0.241 Vali Loss: 0.924 Vali Acc: 0.737 Test Loss: 0.924 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.845611333847046
Epoch: 13, Steps: 13 | Train Loss: 0.164 Vali Loss: 0.641 Vali Acc: 0.771 Test Loss: 0.641 Test Acc: 0.771
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.7745187282562256
Epoch: 14, Steps: 13 | Train Loss: 0.119 Vali Loss: 0.610 Vali Acc: 0.702 Test Loss: 0.610 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.8880159854888916
Epoch: 15, Steps: 13 | Train Loss: 0.101 Vali Loss: 0.627 Vali Acc: 0.722 Test Loss: 0.627 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.9168150424957275
Epoch: 16, Steps: 13 | Train Loss: 0.102 Vali Loss: 0.736 Vali Acc: 0.741 Test Loss: 0.736 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 1409762
model size : 6.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 10.83262848854065
Epoch: 1, Steps: 13 | Train Loss: 0.660 Vali Loss: 0.607 Vali Acc: 0.717 Test Loss: 0.607 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 9.28510856628418
Epoch: 2, Steps: 13 | Train Loss: 0.571 Vali Loss: 0.533 Vali Acc: 0.751 Test Loss: 0.533 Test Acc: 0.751
Validation loss decreased (-0.717067 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 9.62576174736023
Epoch: 3, Steps: 13 | Train Loss: 0.505 Vali Loss: 0.529 Vali Acc: 0.746 Test Loss: 0.529 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 10.079142808914185
Epoch: 4, Steps: 13 | Train Loss: 0.451 Vali Loss: 0.521 Vali Acc: 0.732 Test Loss: 0.521 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 10.007136344909668
Epoch: 5, Steps: 13 | Train Loss: 0.391 Vali Loss: 0.594 Vali Acc: 0.746 Test Loss: 0.594 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 9.709800958633423
Epoch: 6, Steps: 13 | Train Loss: 0.431 Vali Loss: 0.510 Vali Acc: 0.776 Test Loss: 0.510 Test Acc: 0.776
Validation loss decreased (-0.751214 --> -0.775605).  Saving model ...
Epoch: 7 cost time: 9.009352445602417
Epoch: 7, Steps: 13 | Train Loss: 0.360 Vali Loss: 0.583 Vali Acc: 0.668 Test Loss: 0.583 Test Acc: 0.668
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.66521430015564
Epoch: 8, Steps: 13 | Train Loss: 0.283 Vali Loss: 0.528 Vali Acc: 0.741 Test Loss: 0.528 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 9.978923797607422
Epoch: 9, Steps: 13 | Train Loss: 0.247 Vali Loss: 0.597 Vali Acc: 0.663 Test Loss: 0.597 Test Acc: 0.663
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 9.936497926712036
Epoch: 10, Steps: 13 | Train Loss: 0.186 Vali Loss: 0.619 Vali Acc: 0.659 Test Loss: 0.619 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 9.952933073043823
Epoch: 11, Steps: 13 | Train Loss: 0.169 Vali Loss: 0.783 Vali Acc: 0.620 Test Loss: 0.783 Test Acc: 0.620
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 10.192439079284668
Epoch: 12, Steps: 13 | Train Loss: 0.162 Vali Loss: 0.687 Vali Acc: 0.639 Test Loss: 0.687 Test Acc: 0.639
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 9.334335088729858
Epoch: 13, Steps: 13 | Train Loss: 0.157 Vali Loss: 0.590 Vali Acc: 0.712 Test Loss: 0.590 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 9.541149139404297
Epoch: 14, Steps: 13 | Train Loss: 0.115 Vali Loss: 0.612 Vali Acc: 0.737 Test Loss: 0.612 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 10.173156261444092
Epoch: 15, Steps: 13 | Train Loss: 0.095 Vali Loss: 0.678 Vali Acc: 0.654 Test Loss: 0.678 Test Acc: 0.654
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 10.245009183883667
Epoch: 16, Steps: 13 | Train Loss: 0.094 Vali Loss: 0.809 Vali Acc: 0.639 Test Loss: 0.809 Test Acc: 0.639
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 2376418
model size : 9.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.3586437702178955
Epoch: 1, Steps: 13 | Train Loss: 0.646 Vali Loss: 0.585 Vali Acc: 0.712 Test Loss: 0.585 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 5.076688051223755
Epoch: 2, Steps: 13 | Train Loss: 0.562 Vali Loss: 0.549 Vali Acc: 0.727 Test Loss: 0.549 Test Acc: 0.727
Validation loss decreased (-0.712189 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 4.980274438858032
Epoch: 3, Steps: 13 | Train Loss: 0.517 Vali Loss: 0.531 Vali Acc: 0.741 Test Loss: 0.531 Test Acc: 0.741
Validation loss decreased (-0.726824 --> -0.741458).  Saving model ...
Epoch: 4 cost time: 5.199663162231445
Epoch: 4, Steps: 13 | Train Loss: 0.450 Vali Loss: 0.519 Vali Acc: 0.717 Test Loss: 0.519 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.5344812870025635
Epoch: 5, Steps: 13 | Train Loss: 0.406 Vali Loss: 0.519 Vali Acc: 0.727 Test Loss: 0.519 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.489347457885742
Epoch: 6, Steps: 13 | Train Loss: 0.389 Vali Loss: 0.544 Vali Acc: 0.722 Test Loss: 0.544 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.550301551818848
Epoch: 7, Steps: 13 | Train Loss: 0.337 Vali Loss: 0.601 Vali Acc: 0.654 Test Loss: 0.601 Test Acc: 0.654
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.498756408691406
Epoch: 8, Steps: 13 | Train Loss: 0.287 Vali Loss: 0.521 Vali Acc: 0.751 Test Loss: 0.521 Test Acc: 0.751
Validation loss decreased (-0.741458 --> -0.751214).  Saving model ...
Epoch: 9 cost time: 5.436836242675781
Epoch: 9, Steps: 13 | Train Loss: 0.251 Vali Loss: 0.529 Vali Acc: 0.737 Test Loss: 0.529 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.382179021835327
Epoch: 10, Steps: 13 | Train Loss: 0.226 Vali Loss: 0.561 Vali Acc: 0.727 Test Loss: 0.561 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.853532552719116
Epoch: 11, Steps: 13 | Train Loss: 0.187 Vali Loss: 0.658 Vali Acc: 0.629 Test Loss: 0.658 Test Acc: 0.629
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.11764669418335
Epoch: 12, Steps: 13 | Train Loss: 0.183 Vali Loss: 0.588 Vali Acc: 0.702 Test Loss: 0.588 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.128171920776367
Epoch: 13, Steps: 13 | Train Loss: 0.140 Vali Loss: 0.999 Vali Acc: 0.502 Test Loss: 0.999 Test Acc: 0.502
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.5525758266448975
Epoch: 14, Steps: 13 | Train Loss: 0.187 Vali Loss: 0.675 Vali Acc: 0.605 Test Loss: 0.675 Test Acc: 0.605
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.45879340171814
Epoch: 15, Steps: 13 | Train Loss: 0.101 Vali Loss: 0.711 Vali Acc: 0.610 Test Loss: 0.711 Test Acc: 0.610
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.410753011703491
Epoch: 16, Steps: 13 | Train Loss: 0.101 Vali Loss: 0.619 Vali Acc: 0.698 Test Loss: 0.619 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 5.460396766662598
Epoch: 17, Steps: 13 | Train Loss: 0.109 Vali Loss: 0.670 Vali Acc: 0.756 Test Loss: 0.670 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756091).  Saving model ...
Epoch: 18 cost time: 5.300975322723389
Epoch: 18, Steps: 13 | Train Loss: 0.093 Vali Loss: 0.650 Vali Acc: 0.698 Test Loss: 0.650 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.63161563873291
Epoch: 19, Steps: 13 | Train Loss: 0.060 Vali Loss: 0.803 Vali Acc: 0.590 Test Loss: 0.803 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.2544333934783936
Epoch: 20, Steps: 13 | Train Loss: 0.038 Vali Loss: 0.669 Vali Acc: 0.717 Test Loss: 0.669 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.166196584701538
Epoch: 21, Steps: 13 | Train Loss: 0.028 Vali Loss: 0.680 Vali Acc: 0.722 Test Loss: 0.680 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 5.112379789352417
Epoch: 22, Steps: 13 | Train Loss: 0.024 Vali Loss: 0.762 Vali Acc: 0.727 Test Loss: 0.762 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 5.28893780708313
Epoch: 23, Steps: 13 | Train Loss: 0.039 Vali Loss: 0.732 Vali Acc: 0.732 Test Loss: 0.732 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 5.419474840164185
Epoch: 24, Steps: 13 | Train Loss: 0.022 Vali Loss: 0.712 Vali Acc: 0.727 Test Loss: 0.712 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 5.528799057006836
Epoch: 25, Steps: 13 | Train Loss: 0.016 Vali Loss: 0.787 Vali Acc: 0.727 Test Loss: 0.787 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 5.614129543304443
Epoch: 26, Steps: 13 | Train Loss: 0.017 Vali Loss: 0.816 Vali Acc: 0.741 Test Loss: 0.816 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 5.589326620101929
Epoch: 27, Steps: 13 | Train Loss: 0.017 Vali Loss: 0.806 Vali Acc: 0.741 Test Loss: 0.806 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 721122
model size : 3.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.655287027359009
Epoch: 1, Steps: 13 | Train Loss: 0.659 Vali Loss: 0.607 Vali Acc: 0.717 Test Loss: 0.607 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 6.935698509216309
Epoch: 2, Steps: 13 | Train Loss: 0.572 Vali Loss: 0.536 Vali Acc: 0.746 Test Loss: 0.536 Test Acc: 0.746
Validation loss decreased (-0.717067 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 7.836595296859741
Epoch: 3, Steps: 13 | Train Loss: 0.511 Vali Loss: 0.531 Vali Acc: 0.746 Test Loss: 0.531 Test Acc: 0.746
Validation loss decreased (-0.746336 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 7.53689169883728
Epoch: 4, Steps: 13 | Train Loss: 0.463 Vali Loss: 0.524 Vali Acc: 0.746 Test Loss: 0.524 Test Acc: 0.746
Validation loss decreased (-0.746336 --> -0.746336).  Saving model ...
Epoch: 5 cost time: 7.25544810295105
Epoch: 5, Steps: 13 | Train Loss: 0.406 Vali Loss: 0.599 Vali Acc: 0.737 Test Loss: 0.599 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.577631235122681
Epoch: 6, Steps: 13 | Train Loss: 0.417 Vali Loss: 0.526 Vali Acc: 0.766 Test Loss: 0.526 Test Acc: 0.766
Validation loss decreased (-0.746336 --> -0.765848).  Saving model ...
Epoch: 7 cost time: 7.706022500991821
Epoch: 7, Steps: 13 | Train Loss: 0.363 Vali Loss: 0.575 Vali Acc: 0.673 Test Loss: 0.575 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.3799238204956055
Epoch: 8, Steps: 13 | Train Loss: 0.282 Vali Loss: 0.531 Vali Acc: 0.737 Test Loss: 0.531 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.215745687484741
Epoch: 9, Steps: 13 | Train Loss: 0.243 Vali Loss: 0.554 Vali Acc: 0.717 Test Loss: 0.554 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 7.503549098968506
Epoch: 10, Steps: 13 | Train Loss: 0.192 Vali Loss: 0.571 Vali Acc: 0.698 Test Loss: 0.571 Test Acc: 0.698
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 7.609608888626099
Epoch: 11, Steps: 13 | Train Loss: 0.163 Vali Loss: 0.656 Vali Acc: 0.634 Test Loss: 0.656 Test Acc: 0.634
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 7.621686935424805
Epoch: 12, Steps: 13 | Train Loss: 0.155 Vali Loss: 0.662 Vali Acc: 0.615 Test Loss: 0.662 Test Acc: 0.615
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 7.6767449378967285
Epoch: 13, Steps: 13 | Train Loss: 0.123 Vali Loss: 0.625 Vali Acc: 0.673 Test Loss: 0.625 Test Acc: 0.673
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 6.2215869426727295
Epoch: 14, Steps: 13 | Train Loss: 0.109 Vali Loss: 0.656 Vali Acc: 0.727 Test Loss: 0.656 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 6.551155090332031
Epoch: 15, Steps: 13 | Train Loss: 0.091 Vali Loss: 0.673 Vali Acc: 0.678 Test Loss: 0.673 Test Acc: 0.678
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 7.09372353553772
Epoch: 16, Steps: 13 | Train Loss: 0.070 Vali Loss: 0.739 Vali Acc: 0.678 Test Loss: 0.739 Test Acc: 0.678
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 2376418
model size : 9.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.207935333251953
Epoch: 1, Steps: 13 | Train Loss: 0.646 Vali Loss: 0.583 Vali Acc: 0.712 Test Loss: 0.583 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 4.313856601715088
Epoch: 2, Steps: 13 | Train Loss: 0.562 Vali Loss: 0.548 Vali Acc: 0.727 Test Loss: 0.548 Test Acc: 0.727
Validation loss decreased (-0.712189 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 4.313079357147217
Epoch: 3, Steps: 13 | Train Loss: 0.518 Vali Loss: 0.529 Vali Acc: 0.741 Test Loss: 0.529 Test Acc: 0.741
Validation loss decreased (-0.726824 --> -0.741458).  Saving model ...
Epoch: 4 cost time: 4.427225589752197
Epoch: 4, Steps: 13 | Train Loss: 0.454 Vali Loss: 0.518 Vali Acc: 0.732 Test Loss: 0.518 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.459433078765869
Epoch: 5, Steps: 13 | Train Loss: 0.421 Vali Loss: 0.514 Vali Acc: 0.751 Test Loss: 0.514 Test Acc: 0.751
Validation loss decreased (-0.741458 --> -0.751214).  Saving model ...
Epoch: 6 cost time: 4.191580533981323
Epoch: 6, Steps: 13 | Train Loss: 0.401 Vali Loss: 0.515 Vali Acc: 0.751 Test Loss: 0.515 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.023059844970703
Epoch: 7, Steps: 13 | Train Loss: 0.341 Vali Loss: 0.571 Vali Acc: 0.668 Test Loss: 0.571 Test Acc: 0.668
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.095149040222168
Epoch: 8, Steps: 13 | Train Loss: 0.295 Vali Loss: 0.514 Vali Acc: 0.761 Test Loss: 0.514 Test Acc: 0.761
Validation loss decreased (-0.751214 --> -0.760970).  Saving model ...
Epoch: 9 cost time: 3.960157871246338
Epoch: 9, Steps: 13 | Train Loss: 0.256 Vali Loss: 0.531 Vali Acc: 0.771 Test Loss: 0.531 Test Acc: 0.771
Validation loss decreased (-0.760970 --> -0.770726).  Saving model ...
Epoch: 10 cost time: 3.987736463546753
Epoch: 10, Steps: 13 | Train Loss: 0.225 Vali Loss: 0.571 Vali Acc: 0.702 Test Loss: 0.571 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.42851996421814
Epoch: 11, Steps: 13 | Train Loss: 0.169 Vali Loss: 0.728 Vali Acc: 0.576 Test Loss: 0.728 Test Acc: 0.576
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.435600519180298
Epoch: 12, Steps: 13 | Train Loss: 0.187 Vali Loss: 0.572 Vali Acc: 0.707 Test Loss: 0.572 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.322425127029419
Epoch: 13, Steps: 13 | Train Loss: 0.138 Vali Loss: 1.075 Vali Acc: 0.488 Test Loss: 1.075 Test Acc: 0.488
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.296576261520386
Epoch: 14, Steps: 13 | Train Loss: 0.200 Vali Loss: 0.673 Vali Acc: 0.620 Test Loss: 0.673 Test Acc: 0.620
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.46251654624939
Epoch: 15, Steps: 13 | Train Loss: 0.099 Vali Loss: 0.783 Vali Acc: 0.556 Test Loss: 0.783 Test Acc: 0.556
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.374319076538086
Epoch: 16, Steps: 13 | Train Loss: 0.102 Vali Loss: 0.652 Vali Acc: 0.668 Test Loss: 0.652 Test Acc: 0.668
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.118582010269165
Epoch: 17, Steps: 13 | Train Loss: 0.095 Vali Loss: 0.674 Vali Acc: 0.741 Test Loss: 0.674 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.9407360553741455
Epoch: 18, Steps: 13 | Train Loss: 0.062 Vali Loss: 0.651 Vali Acc: 0.737 Test Loss: 0.651 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.138869524002075
Epoch: 19, Steps: 13 | Train Loss: 0.044 Vali Loss: 0.779 Vali Acc: 0.600 Test Loss: 0.779 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 721122
model size : 3.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.4402289390563965
Epoch: 1, Steps: 13 | Train Loss: 0.659 Vali Loss: 0.608 Vali Acc: 0.717 Test Loss: 0.608 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 4.938690185546875
Epoch: 2, Steps: 13 | Train Loss: 0.573 Vali Loss: 0.536 Vali Acc: 0.746 Test Loss: 0.536 Test Acc: 0.746
Validation loss decreased (-0.717067 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 4.812318563461304
Epoch: 3, Steps: 13 | Train Loss: 0.512 Vali Loss: 0.532 Vali Acc: 0.746 Test Loss: 0.532 Test Acc: 0.746
Validation loss decreased (-0.746336 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 4.608296632766724
Epoch: 4, Steps: 13 | Train Loss: 0.465 Vali Loss: 0.526 Vali Acc: 0.737 Test Loss: 0.526 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.899480104446411
Epoch: 5, Steps: 13 | Train Loss: 0.408 Vali Loss: 0.595 Vali Acc: 0.737 Test Loss: 0.595 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.80059289932251
Epoch: 6, Steps: 13 | Train Loss: 0.415 Vali Loss: 0.538 Vali Acc: 0.751 Test Loss: 0.538 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751214).  Saving model ...
Epoch: 7 cost time: 4.793660640716553
Epoch: 7, Steps: 13 | Train Loss: 0.368 Vali Loss: 0.584 Vali Acc: 0.668 Test Loss: 0.584 Test Acc: 0.668
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.661919116973877
Epoch: 8, Steps: 13 | Train Loss: 0.283 Vali Loss: 0.522 Vali Acc: 0.746 Test Loss: 0.522 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.6216206550598145
Epoch: 9, Steps: 13 | Train Loss: 0.354 Vali Loss: 0.546 Vali Acc: 0.707 Test Loss: 0.546 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.444593191146851
Epoch: 10, Steps: 13 | Train Loss: 0.234 Vali Loss: 0.568 Vali Acc: 0.712 Test Loss: 0.568 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.663893461227417
Epoch: 11, Steps: 13 | Train Loss: 0.179 Vali Loss: 0.671 Vali Acc: 0.620 Test Loss: 0.671 Test Acc: 0.620
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.937203884124756
Epoch: 12, Steps: 13 | Train Loss: 0.168 Vali Loss: 0.710 Vali Acc: 0.624 Test Loss: 0.710 Test Acc: 0.624
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.773931980133057
Epoch: 13, Steps: 13 | Train Loss: 0.133 Vali Loss: 0.624 Vali Acc: 0.683 Test Loss: 0.624 Test Acc: 0.683
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.804504156112671
Epoch: 14, Steps: 13 | Train Loss: 0.111 Vali Loss: 0.635 Vali Acc: 0.732 Test Loss: 0.635 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.81721043586731
Epoch: 15, Steps: 13 | Train Loss: 0.096 Vali Loss: 0.684 Vali Acc: 0.683 Test Loss: 0.684 Test Acc: 0.683
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.760138988494873
Epoch: 16, Steps: 13 | Train Loss: 0.128 Vali Loss: 0.814 Vali Acc: 0.610 Test Loss: 0.814 Test Acc: 0.610
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 2376418
model size : 9.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.501222133636475
Epoch: 1, Steps: 13 | Train Loss: 0.647 Vali Loss: 0.584 Vali Acc: 0.712 Test Loss: 0.584 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 2.684556007385254
Epoch: 2, Steps: 13 | Train Loss: 0.559 Vali Loss: 0.546 Vali Acc: 0.727 Test Loss: 0.546 Test Acc: 0.727
Validation loss decreased (-0.712189 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 2.9293220043182373
Epoch: 3, Steps: 13 | Train Loss: 0.520 Vali Loss: 0.532 Vali Acc: 0.737 Test Loss: 0.532 Test Acc: 0.737
Validation loss decreased (-0.726824 --> -0.736580).  Saving model ...
Epoch: 4 cost time: 3.053333282470703
Epoch: 4, Steps: 13 | Train Loss: 0.456 Vali Loss: 0.524 Vali Acc: 0.741 Test Loss: 0.524 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741458).  Saving model ...
Epoch: 5 cost time: 3.024139881134033
Epoch: 5, Steps: 13 | Train Loss: 0.433 Vali Loss: 0.513 Vali Acc: 0.766 Test Loss: 0.513 Test Acc: 0.766
Validation loss decreased (-0.741458 --> -0.765849).  Saving model ...
Epoch: 6 cost time: 2.9831509590148926
Epoch: 6, Steps: 13 | Train Loss: 0.416 Vali Loss: 0.545 Vali Acc: 0.673 Test Loss: 0.545 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.887763500213623
Epoch: 7, Steps: 13 | Train Loss: 0.352 Vali Loss: 0.557 Vali Acc: 0.663 Test Loss: 0.557 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.9236340522766113
Epoch: 8, Steps: 13 | Train Loss: 0.318 Vali Loss: 0.521 Vali Acc: 0.761 Test Loss: 0.521 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.0242650508880615
Epoch: 9, Steps: 13 | Train Loss: 0.265 Vali Loss: 0.525 Vali Acc: 0.766 Test Loss: 0.525 Test Acc: 0.766
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.0398004055023193
Epoch: 10, Steps: 13 | Train Loss: 0.239 Vali Loss: 0.740 Vali Acc: 0.551 Test Loss: 0.740 Test Acc: 0.551
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.8990209102630615
Epoch: 11, Steps: 13 | Train Loss: 0.180 Vali Loss: 0.781 Vali Acc: 0.566 Test Loss: 0.781 Test Acc: 0.566
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.922605276107788
Epoch: 12, Steps: 13 | Train Loss: 0.230 Vali Loss: 0.579 Vali Acc: 0.693 Test Loss: 0.579 Test Acc: 0.693
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.6978015899658203
Epoch: 13, Steps: 13 | Train Loss: 0.215 Vali Loss: 0.609 Vali Acc: 0.668 Test Loss: 0.609 Test Acc: 0.668
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.7185356616973877
Epoch: 14, Steps: 13 | Train Loss: 0.129 Vali Loss: 0.650 Vali Acc: 0.644 Test Loss: 0.650 Test Acc: 0.644
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.7729032039642334
Epoch: 15, Steps: 13 | Train Loss: 0.119 Vali Loss: 0.898 Vali Acc: 0.502 Test Loss: 0.898 Test Acc: 0.502
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 721122
model size : 3.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 14.33357858657837
Epoch: 1, Steps: 13 | Train Loss: 0.637 Vali Loss: 0.602 Vali Acc: 0.722 Test Loss: 0.602 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 12.20511269569397
Epoch: 2, Steps: 13 | Train Loss: 0.597 Vali Loss: 0.550 Vali Acc: 0.722 Test Loss: 0.550 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721946).  Saving model ...
Epoch: 3 cost time: 12.498265266418457
Epoch: 3, Steps: 13 | Train Loss: 0.524 Vali Loss: 0.522 Vali Acc: 0.746 Test Loss: 0.522 Test Acc: 0.746
Validation loss decreased (-0.721946 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 10.537422180175781
Epoch: 4, Steps: 13 | Train Loss: 0.484 Vali Loss: 0.513 Vali Acc: 0.751 Test Loss: 0.513 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751214).  Saving model ...
Epoch: 5 cost time: 10.051681280136108
Epoch: 5, Steps: 13 | Train Loss: 0.449 Vali Loss: 0.520 Vali Acc: 0.751 Test Loss: 0.520 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 11.686534643173218
Epoch: 6, Steps: 13 | Train Loss: 0.386 Vali Loss: 0.522 Vali Acc: 0.771 Test Loss: 0.522 Test Acc: 0.771
Validation loss decreased (-0.751214 --> -0.770726).  Saving model ...
Epoch: 7 cost time: 12.00397276878357
Epoch: 7, Steps: 13 | Train Loss: 0.355 Vali Loss: 0.559 Vali Acc: 0.761 Test Loss: 0.559 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 12.052377939224243
Epoch: 8, Steps: 13 | Train Loss: 0.331 Vali Loss: 0.677 Vali Acc: 0.732 Test Loss: 0.677 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 11.937222719192505
Epoch: 9, Steps: 13 | Train Loss: 0.315 Vali Loss: 0.735 Vali Acc: 0.737 Test Loss: 0.735 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 11.79363489151001
Epoch: 10, Steps: 13 | Train Loss: 0.292 Vali Loss: 0.539 Vali Acc: 0.737 Test Loss: 0.539 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 12.408295154571533
Epoch: 11, Steps: 13 | Train Loss: 0.239 Vali Loss: 0.560 Vali Acc: 0.688 Test Loss: 0.560 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 12.445663213729858
Epoch: 12, Steps: 13 | Train Loss: 0.210 Vali Loss: 0.546 Vali Acc: 0.717 Test Loss: 0.546 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 12.236241579055786
Epoch: 13, Steps: 13 | Train Loss: 0.167 Vali Loss: 0.623 Vali Acc: 0.761 Test Loss: 0.623 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 11.58150315284729
Epoch: 14, Steps: 13 | Train Loss: 0.158 Vali Loss: 0.606 Vali Acc: 0.707 Test Loss: 0.606 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 12.108362913131714
Epoch: 15, Steps: 13 | Train Loss: 0.123 Vali Loss: 0.625 Vali Acc: 0.712 Test Loss: 0.625 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 12.075590133666992
Epoch: 16, Steps: 13 | Train Loss: 0.147 Vali Loss: 0.899 Vali Acc: 0.561 Test Loss: 0.899 Test Acc: 0.561
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 2360818
model size : 9.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.086352586746216
Epoch: 1, Steps: 13 | Train Loss: 0.631 Vali Loss: 0.590 Vali Acc: 0.717 Test Loss: 0.590 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 5.962026357650757
Epoch: 2, Steps: 13 | Train Loss: 0.579 Vali Loss: 0.569 Vali Acc: 0.717 Test Loss: 0.569 Test Acc: 0.717
Validation loss decreased (-0.717067 --> -0.717067).  Saving model ...
Epoch: 3 cost time: 6.777023077011108
Epoch: 3, Steps: 13 | Train Loss: 0.537 Vali Loss: 0.539 Vali Acc: 0.741 Test Loss: 0.539 Test Acc: 0.741
Validation loss decreased (-0.717067 --> -0.741458).  Saving model ...
Epoch: 4 cost time: 6.71799635887146
Epoch: 4, Steps: 13 | Train Loss: 0.527 Vali Loss: 0.593 Vali Acc: 0.741 Test Loss: 0.593 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.535733938217163
Epoch: 5, Steps: 13 | Train Loss: 0.456 Vali Loss: 0.517 Vali Acc: 0.737 Test Loss: 0.517 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.839458703994751
Epoch: 6, Steps: 13 | Train Loss: 0.423 Vali Loss: 0.517 Vali Acc: 0.756 Test Loss: 0.517 Test Acc: 0.756
Validation loss decreased (-0.741458 --> -0.756092).  Saving model ...
Epoch: 7 cost time: 6.805956602096558
Epoch: 7, Steps: 13 | Train Loss: 0.365 Vali Loss: 0.516 Vali Acc: 0.766 Test Loss: 0.516 Test Acc: 0.766
Validation loss decreased (-0.756092 --> -0.765848).  Saving model ...
Epoch: 8 cost time: 6.570736885070801
Epoch: 8, Steps: 13 | Train Loss: 0.371 Vali Loss: 0.530 Vali Acc: 0.737 Test Loss: 0.530 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.691742181777954
Epoch: 9, Steps: 13 | Train Loss: 0.306 Vali Loss: 0.533 Vali Acc: 0.717 Test Loss: 0.533 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 7.013753414154053
Epoch: 10, Steps: 13 | Train Loss: 0.311 Vali Loss: 0.548 Vali Acc: 0.693 Test Loss: 0.548 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 7.140040159225464
Epoch: 11, Steps: 13 | Train Loss: 0.391 Vali Loss: 0.730 Vali Acc: 0.746 Test Loss: 0.730 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.882529020309448
Epoch: 12, Steps: 13 | Train Loss: 0.265 Vali Loss: 0.535 Vali Acc: 0.751 Test Loss: 0.535 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.944856643676758
Epoch: 13, Steps: 13 | Train Loss: 0.234 Vali Loss: 0.663 Vali Acc: 0.644 Test Loss: 0.663 Test Acc: 0.644
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.949157476425171
Epoch: 14, Steps: 13 | Train Loss: 0.218 Vali Loss: 0.598 Vali Acc: 0.761 Test Loss: 0.598 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 6.330219030380249
Epoch: 15, Steps: 13 | Train Loss: 0.161 Vali Loss: 0.693 Vali Acc: 0.751 Test Loss: 0.693 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 6.550814151763916
Epoch: 16, Steps: 13 | Train Loss: 0.208 Vali Loss: 0.630 Vali Acc: 0.766 Test Loss: 0.630 Test Acc: 0.766
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 6.858836650848389
Epoch: 17, Steps: 13 | Train Loss: 0.180 Vali Loss: 0.608 Vali Acc: 0.712 Test Loss: 0.608 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 705394
model size : 3.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 11.268012762069702
Epoch: 1, Steps: 13 | Train Loss: 0.638 Vali Loss: 0.603 Vali Acc: 0.722 Test Loss: 0.603 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 9.643623352050781
Epoch: 2, Steps: 13 | Train Loss: 0.601 Vali Loss: 0.550 Vali Acc: 0.722 Test Loss: 0.550 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721946).  Saving model ...
Epoch: 3 cost time: 9.204477787017822
Epoch: 3, Steps: 13 | Train Loss: 0.530 Vali Loss: 0.524 Vali Acc: 0.741 Test Loss: 0.524 Test Acc: 0.741
Validation loss decreased (-0.721946 --> -0.741458).  Saving model ...
Epoch: 4 cost time: 9.158109188079834
Epoch: 4, Steps: 13 | Train Loss: 0.490 Vali Loss: 0.519 Vali Acc: 0.766 Test Loss: 0.519 Test Acc: 0.766
Validation loss decreased (-0.741458 --> -0.765848).  Saving model ...
Epoch: 5 cost time: 9.600837707519531
Epoch: 5, Steps: 13 | Train Loss: 0.451 Vali Loss: 0.520 Vali Acc: 0.722 Test Loss: 0.520 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.257297277450562
Epoch: 6, Steps: 13 | Train Loss: 0.405 Vali Loss: 0.505 Vali Acc: 0.766 Test Loss: 0.505 Test Acc: 0.766
Validation loss decreased (-0.765848 --> -0.765849).  Saving model ...
Epoch: 7 cost time: 8.373666524887085
Epoch: 7, Steps: 13 | Train Loss: 0.380 Vali Loss: 0.595 Vali Acc: 0.741 Test Loss: 0.595 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.5985267162323
Epoch: 8, Steps: 13 | Train Loss: 0.345 Vali Loss: 0.615 Vali Acc: 0.746 Test Loss: 0.615 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 8.150693655014038
Epoch: 9, Steps: 13 | Train Loss: 0.320 Vali Loss: 0.609 Vali Acc: 0.756 Test Loss: 0.609 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 9.03653335571289
Epoch: 10, Steps: 13 | Train Loss: 0.294 Vali Loss: 0.543 Vali Acc: 0.756 Test Loss: 0.543 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 9.14992880821228
Epoch: 11, Steps: 13 | Train Loss: 0.252 Vali Loss: 0.560 Vali Acc: 0.683 Test Loss: 0.560 Test Acc: 0.683
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 9.057260990142822
Epoch: 12, Steps: 13 | Train Loss: 0.222 Vali Loss: 0.568 Vali Acc: 0.766 Test Loss: 0.568 Test Acc: 0.766
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 8.79925274848938
Epoch: 13, Steps: 13 | Train Loss: 0.157 Vali Loss: 0.679 Vali Acc: 0.780 Test Loss: 0.679 Test Acc: 0.780
Validation loss decreased (-0.765849 --> -0.780481).  Saving model ...
Epoch: 14 cost time: 8.155137538909912
Epoch: 14, Steps: 13 | Train Loss: 0.162 Vali Loss: 0.604 Vali Acc: 0.712 Test Loss: 0.604 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 7.937688589096069
Epoch: 15, Steps: 13 | Train Loss: 0.125 Vali Loss: 0.623 Vali Acc: 0.737 Test Loss: 0.623 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 8.689390659332275
Epoch: 16, Steps: 13 | Train Loss: 0.113 Vali Loss: 0.670 Vali Acc: 0.712 Test Loss: 0.670 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 8.45703649520874
Epoch: 17, Steps: 13 | Train Loss: 0.119 Vali Loss: 0.795 Vali Acc: 0.761 Test Loss: 0.795 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 8.294321537017822
Epoch: 18, Steps: 13 | Train Loss: 0.129 Vali Loss: 0.779 Vali Acc: 0.751 Test Loss: 0.779 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 8.25165581703186
Epoch: 19, Steps: 13 | Train Loss: 0.097 Vali Loss: 0.774 Vali Acc: 0.702 Test Loss: 0.774 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 8.630163669586182
Epoch: 20, Steps: 13 | Train Loss: 0.094 Vali Loss: 0.756 Vali Acc: 0.722 Test Loss: 0.756 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 9.00281572341919
Epoch: 21, Steps: 13 | Train Loss: 0.073 Vali Loss: 0.785 Vali Acc: 0.727 Test Loss: 0.785 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 9.05713152885437
Epoch: 22, Steps: 13 | Train Loss: 0.051 Vali Loss: 0.818 Vali Acc: 0.634 Test Loss: 0.818 Test Acc: 0.634
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 8.684259176254272
Epoch: 23, Steps: 13 | Train Loss: 0.032 Vali Loss: 0.826 Vali Acc: 0.702 Test Loss: 0.826 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7804878048780488
model parameter : 2360818
model size : 9.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.273008108139038
Epoch: 1, Steps: 13 | Train Loss: 0.630 Vali Loss: 0.593 Vali Acc: 0.707 Test Loss: 0.593 Test Acc: 0.707
Validation loss decreased (inf --> -0.707311).  Saving model ...
Epoch: 2 cost time: 4.591320276260376
Epoch: 2, Steps: 13 | Train Loss: 0.574 Vali Loss: 0.572 Vali Acc: 0.717 Test Loss: 0.572 Test Acc: 0.717
Validation loss decreased (-0.707311 --> -0.717067).  Saving model ...
Epoch: 3 cost time: 4.651155233383179
Epoch: 3, Steps: 13 | Train Loss: 0.535 Vali Loss: 0.543 Vali Acc: 0.727 Test Loss: 0.543 Test Acc: 0.727
Validation loss decreased (-0.717067 --> -0.726824).  Saving model ...
Epoch: 4 cost time: 4.853525876998901
Epoch: 4, Steps: 13 | Train Loss: 0.531 Vali Loss: 0.605 Vali Acc: 0.741 Test Loss: 0.605 Test Acc: 0.741
Validation loss decreased (-0.726824 --> -0.741457).  Saving model ...
Epoch: 5 cost time: 4.8649513721466064
Epoch: 5, Steps: 13 | Train Loss: 0.455 Vali Loss: 0.512 Vali Acc: 0.746 Test Loss: 0.512 Test Acc: 0.746
Validation loss decreased (-0.741457 --> -0.746336).  Saving model ...
Epoch: 6 cost time: 4.459555387496948
Epoch: 6, Steps: 13 | Train Loss: 0.423 Vali Loss: 0.531 Vali Acc: 0.751 Test Loss: 0.531 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751214).  Saving model ...
Epoch: 7 cost time: 4.870729446411133
Epoch: 7, Steps: 13 | Train Loss: 0.378 Vali Loss: 0.528 Vali Acc: 0.751 Test Loss: 0.528 Test Acc: 0.751
Validation loss decreased (-0.751214 --> -0.751214).  Saving model ...
Epoch: 8 cost time: 4.724510431289673
Epoch: 8, Steps: 13 | Train Loss: 0.361 Vali Loss: 0.513 Vali Acc: 0.761 Test Loss: 0.513 Test Acc: 0.761
Validation loss decreased (-0.751214 --> -0.760970).  Saving model ...
Epoch: 9 cost time: 4.368077039718628
Epoch: 9, Steps: 13 | Train Loss: 0.315 Vali Loss: 0.511 Vali Acc: 0.771 Test Loss: 0.511 Test Acc: 0.771
Validation loss decreased (-0.760970 --> -0.770727).  Saving model ...
Epoch: 10 cost time: 4.33144998550415
Epoch: 10, Steps: 13 | Train Loss: 0.324 Vali Loss: 0.510 Vali Acc: 0.766 Test Loss: 0.510 Test Acc: 0.766
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.713834524154663
Epoch: 11, Steps: 13 | Train Loss: 0.366 Vali Loss: 0.800 Vali Acc: 0.741 Test Loss: 0.800 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.735487461090088
Epoch: 12, Steps: 13 | Train Loss: 0.252 Vali Loss: 0.573 Vali Acc: 0.756 Test Loss: 0.573 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.858538627624512
Epoch: 13, Steps: 13 | Train Loss: 0.229 Vali Loss: 0.581 Vali Acc: 0.722 Test Loss: 0.581 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.879041433334351
Epoch: 14, Steps: 13 | Train Loss: 0.183 Vali Loss: 0.612 Vali Acc: 0.776 Test Loss: 0.612 Test Acc: 0.776
Validation loss decreased (-0.770727 --> -0.775604).  Saving model ...
Epoch: 15 cost time: 4.902772903442383
Epoch: 15, Steps: 13 | Train Loss: 0.139 Vali Loss: 0.736 Vali Acc: 0.766 Test Loss: 0.736 Test Acc: 0.766
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.8634209632873535
Epoch: 16, Steps: 13 | Train Loss: 0.157 Vali Loss: 0.630 Vali Acc: 0.746 Test Loss: 0.630 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.699196100234985
Epoch: 17, Steps: 13 | Train Loss: 0.107 Vali Loss: 0.663 Vali Acc: 0.717 Test Loss: 0.663 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.642292737960815
Epoch: 18, Steps: 13 | Train Loss: 0.081 Vali Loss: 0.676 Vali Acc: 0.712 Test Loss: 0.676 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.6611168384552
Epoch: 19, Steps: 13 | Train Loss: 0.065 Vali Loss: 0.770 Vali Acc: 0.756 Test Loss: 0.770 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.977316617965698
Epoch: 20, Steps: 13 | Train Loss: 0.091 Vali Loss: 0.754 Vali Acc: 0.746 Test Loss: 0.754 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.960376262664795
Epoch: 21, Steps: 13 | Train Loss: 0.051 Vali Loss: 0.782 Vali Acc: 0.766 Test Loss: 0.782 Test Acc: 0.766
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 5.035240173339844
Epoch: 22, Steps: 13 | Train Loss: 0.055 Vali Loss: 0.835 Vali Acc: 0.659 Test Loss: 0.835 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 5.087677955627441
Epoch: 23, Steps: 13 | Train Loss: 0.043 Vali Loss: 0.753 Vali Acc: 0.683 Test Loss: 0.753 Test Acc: 0.683
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 5.0238165855407715
Epoch: 24, Steps: 13 | Train Loss: 0.037 Vali Loss: 0.796 Vali Acc: 0.766 Test Loss: 0.796 Test Acc: 0.766
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 705394
model size : 3.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.452114105224609
Epoch: 1, Steps: 13 | Train Loss: 0.640 Vali Loss: 0.607 Vali Acc: 0.722 Test Loss: 0.607 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.8122217655181885
Epoch: 2, Steps: 13 | Train Loss: 0.603 Vali Loss: 0.553 Vali Acc: 0.722 Test Loss: 0.553 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721946).  Saving model ...
Epoch: 3 cost time: 5.001952409744263
Epoch: 3, Steps: 13 | Train Loss: 0.533 Vali Loss: 0.528 Vali Acc: 0.746 Test Loss: 0.528 Test Acc: 0.746
Validation loss decreased (-0.721946 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 4.962482690811157
Epoch: 4, Steps: 13 | Train Loss: 0.493 Vali Loss: 0.514 Vali Acc: 0.746 Test Loss: 0.514 Test Acc: 0.746
Validation loss decreased (-0.746336 --> -0.746336).  Saving model ...
Epoch: 5 cost time: 4.926503658294678
Epoch: 5, Steps: 13 | Train Loss: 0.448 Vali Loss: 0.533 Vali Acc: 0.737 Test Loss: 0.533 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.988627672195435
Epoch: 6, Steps: 13 | Train Loss: 0.393 Vali Loss: 0.532 Vali Acc: 0.761 Test Loss: 0.532 Test Acc: 0.761
Validation loss decreased (-0.746336 --> -0.760970).  Saving model ...
Epoch: 7 cost time: 4.958052158355713
Epoch: 7, Steps: 13 | Train Loss: 0.380 Vali Loss: 0.594 Vali Acc: 0.751 Test Loss: 0.594 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.808430910110474
Epoch: 8, Steps: 13 | Train Loss: 0.339 Vali Loss: 0.654 Vali Acc: 0.741 Test Loss: 0.654 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.7109222412109375
Epoch: 9, Steps: 13 | Train Loss: 0.338 Vali Loss: 0.521 Vali Acc: 0.790 Test Loss: 0.521 Test Acc: 0.790
Validation loss decreased (-0.760970 --> -0.790239).  Saving model ...
Epoch: 10 cost time: 4.6955671310424805
Epoch: 10, Steps: 13 | Train Loss: 0.282 Vali Loss: 0.551 Vali Acc: 0.717 Test Loss: 0.551 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.896069288253784
Epoch: 11, Steps: 13 | Train Loss: 0.249 Vali Loss: 0.641 Vali Acc: 0.610 Test Loss: 0.641 Test Acc: 0.610
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.964707851409912
Epoch: 12, Steps: 13 | Train Loss: 0.256 Vali Loss: 0.582 Vali Acc: 0.771 Test Loss: 0.582 Test Acc: 0.771
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.955615520477295
Epoch: 13, Steps: 13 | Train Loss: 0.161 Vali Loss: 0.717 Vali Acc: 0.751 Test Loss: 0.717 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.025183200836182
Epoch: 14, Steps: 13 | Train Loss: 0.161 Vali Loss: 0.634 Vali Acc: 0.702 Test Loss: 0.634 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.0076329708099365
Epoch: 15, Steps: 13 | Train Loss: 0.123 Vali Loss: 0.629 Vali Acc: 0.732 Test Loss: 0.629 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.051671266555786
Epoch: 16, Steps: 13 | Train Loss: 0.143 Vali Loss: 1.146 Vali Acc: 0.488 Test Loss: 1.146 Test Acc: 0.488
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.837067604064941
Epoch: 17, Steps: 13 | Train Loss: 0.150 Vali Loss: 0.691 Vali Acc: 0.659 Test Loss: 0.691 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.799348592758179
Epoch: 18, Steps: 13 | Train Loss: 0.088 Vali Loss: 0.695 Vali Acc: 0.712 Test Loss: 0.695 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.872740268707275
Epoch: 19, Steps: 13 | Train Loss: 0.060 Vali Loss: 0.802 Vali Acc: 0.761 Test Loss: 0.802 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7902439024390244
model parameter : 2360818
model size : 9.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.8006885051727295
Epoch: 1, Steps: 13 | Train Loss: 0.627 Vali Loss: 0.589 Vali Acc: 0.717 Test Loss: 0.589 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 2.8798298835754395
Epoch: 2, Steps: 13 | Train Loss: 0.572 Vali Loss: 0.567 Vali Acc: 0.722 Test Loss: 0.567 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721946).  Saving model ...
Epoch: 3 cost time: 3.103809356689453
Epoch: 3, Steps: 13 | Train Loss: 0.539 Vali Loss: 0.538 Vali Acc: 0.732 Test Loss: 0.538 Test Acc: 0.732
Validation loss decreased (-0.721946 --> -0.731702).  Saving model ...
Epoch: 4 cost time: 3.1139838695526123
Epoch: 4, Steps: 13 | Train Loss: 0.538 Vali Loss: 0.613 Vali Acc: 0.732 Test Loss: 0.613 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.1570160388946533
Epoch: 5, Steps: 13 | Train Loss: 0.465 Vali Loss: 0.505 Vali Acc: 0.751 Test Loss: 0.505 Test Acc: 0.751
Validation loss decreased (-0.731702 --> -0.751214).  Saving model ...
Epoch: 6 cost time: 2.980397939682007
Epoch: 6, Steps: 13 | Train Loss: 0.429 Vali Loss: 0.511 Vali Acc: 0.751 Test Loss: 0.511 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.0306456089019775
Epoch: 7, Steps: 13 | Train Loss: 0.379 Vali Loss: 0.519 Vali Acc: 0.776 Test Loss: 0.519 Test Acc: 0.776
Validation loss decreased (-0.751214 --> -0.775605).  Saving model ...
Epoch: 8 cost time: 3.0713984966278076
Epoch: 8, Steps: 13 | Train Loss: 0.386 Vali Loss: 0.517 Vali Acc: 0.771 Test Loss: 0.517 Test Acc: 0.771
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.1688477993011475
Epoch: 9, Steps: 13 | Train Loss: 0.305 Vali Loss: 0.525 Vali Acc: 0.756 Test Loss: 0.525 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.0794172286987305
Epoch: 10, Steps: 13 | Train Loss: 0.352 Vali Loss: 0.509 Vali Acc: 0.751 Test Loss: 0.509 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.128066301345825
Epoch: 11, Steps: 13 | Train Loss: 0.401 Vali Loss: 0.867 Vali Acc: 0.717 Test Loss: 0.867 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.148420572280884
Epoch: 12, Steps: 13 | Train Loss: 0.259 Vali Loss: 0.586 Vali Acc: 0.756 Test Loss: 0.586 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.03739595413208
Epoch: 13, Steps: 13 | Train Loss: 0.222 Vali Loss: 0.676 Vali Acc: 0.668 Test Loss: 0.676 Test Acc: 0.668
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.044943332672119
Epoch: 14, Steps: 13 | Train Loss: 0.185 Vali Loss: 0.607 Vali Acc: 0.746 Test Loss: 0.607 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.000680923461914
Epoch: 15, Steps: 13 | Train Loss: 0.142 Vali Loss: 0.641 Vali Acc: 0.741 Test Loss: 0.641 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.0468478202819824
Epoch: 16, Steps: 13 | Train Loss: 0.142 Vali Loss: 0.864 Vali Acc: 0.756 Test Loss: 0.864 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.959278106689453
Epoch: 17, Steps: 13 | Train Loss: 0.138 Vali Loss: 0.628 Vali Acc: 0.741 Test Loss: 0.628 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 705394
model size : 3.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 9.665201187133789
Epoch: 1, Steps: 13 | Train Loss: 0.611 Vali Loss: 0.590 Vali Acc: 0.717 Test Loss: 0.590 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 7.805386543273926
Epoch: 2, Steps: 13 | Train Loss: 0.564 Vali Loss: 0.571 Vali Acc: 0.722 Test Loss: 0.571 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721946).  Saving model ...
Epoch: 3 cost time: 7.873690843582153
Epoch: 3, Steps: 13 | Train Loss: 0.541 Vali Loss: 0.549 Vali Acc: 0.746 Test Loss: 0.549 Test Acc: 0.746
Validation loss decreased (-0.721946 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 7.896226167678833
Epoch: 4, Steps: 13 | Train Loss: 0.502 Vali Loss: 0.538 Vali Acc: 0.732 Test Loss: 0.538 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.493947982788086
Epoch: 5, Steps: 13 | Train Loss: 0.478 Vali Loss: 0.554 Vali Acc: 0.732 Test Loss: 0.554 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.641984462738037
Epoch: 6, Steps: 13 | Train Loss: 0.443 Vali Loss: 0.576 Vali Acc: 0.741 Test Loss: 0.576 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 7.930476427078247
Epoch: 7, Steps: 13 | Train Loss: 0.374 Vali Loss: 0.585 Vali Acc: 0.756 Test Loss: 0.585 Test Acc: 0.756
Validation loss decreased (-0.746336 --> -0.756092).  Saving model ...
Epoch: 8 cost time: 7.991168975830078
Epoch: 8, Steps: 13 | Train Loss: 0.360 Vali Loss: 0.518 Vali Acc: 0.761 Test Loss: 0.518 Test Acc: 0.761
Validation loss decreased (-0.756092 --> -0.760970).  Saving model ...
Epoch: 9 cost time: 7.9264562129974365
Epoch: 9, Steps: 13 | Train Loss: 0.312 Vali Loss: 0.513 Vali Acc: 0.722 Test Loss: 0.513 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.680011510848999
Epoch: 10, Steps: 13 | Train Loss: 0.295 Vali Loss: 0.550 Vali Acc: 0.766 Test Loss: 0.550 Test Acc: 0.766
Validation loss decreased (-0.760970 --> -0.765848).  Saving model ...
Epoch: 11 cost time: 7.389998435974121
Epoch: 11, Steps: 13 | Train Loss: 0.304 Vali Loss: 0.551 Vali Acc: 0.751 Test Loss: 0.551 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.690340042114258
Epoch: 12, Steps: 13 | Train Loss: 0.236 Vali Loss: 0.668 Vali Acc: 0.727 Test Loss: 0.668 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 7.682309627532959
Epoch: 13, Steps: 13 | Train Loss: 0.217 Vali Loss: 0.556 Vali Acc: 0.741 Test Loss: 0.556 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 7.416607618331909
Epoch: 14, Steps: 13 | Train Loss: 0.194 Vali Loss: 0.634 Vali Acc: 0.644 Test Loss: 0.634 Test Acc: 0.644
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 7.732123851776123
Epoch: 15, Steps: 13 | Train Loss: 0.164 Vali Loss: 0.583 Vali Acc: 0.741 Test Loss: 0.583 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 7.351757287979126
Epoch: 16, Steps: 13 | Train Loss: 0.141 Vali Loss: 0.605 Vali Acc: 0.746 Test Loss: 0.605 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 7.757875680923462
Epoch: 17, Steps: 13 | Train Loss: 0.128 Vali Loss: 0.617 Vali Acc: 0.732 Test Loss: 0.617 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 7.709689378738403
Epoch: 18, Steps: 13 | Train Loss: 0.116 Vali Loss: 0.631 Vali Acc: 0.693 Test Loss: 0.631 Test Acc: 0.693
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 7.4543843269348145
Epoch: 19, Steps: 13 | Train Loss: 0.091 Vali Loss: 0.642 Vali Acc: 0.683 Test Loss: 0.642 Test Acc: 0.683
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 8.735057592391968
Epoch: 20, Steps: 13 | Train Loss: 0.094 Vali Loss: 0.669 Vali Acc: 0.712 Test Loss: 0.669 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 1188594
model size : 4.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.838098764419556
Epoch: 1, Steps: 13 | Train Loss: 0.585 Vali Loss: 0.574 Vali Acc: 0.722 Test Loss: 0.574 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 5.15824818611145
Epoch: 2, Steps: 13 | Train Loss: 0.567 Vali Loss: 0.566 Vali Acc: 0.741 Test Loss: 0.566 Test Acc: 0.741
Validation loss decreased (-0.721945 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 5.080467224121094
Epoch: 3, Steps: 13 | Train Loss: 0.522 Vali Loss: 0.538 Vali Acc: 0.771 Test Loss: 0.538 Test Acc: 0.771
Validation loss decreased (-0.741458 --> -0.770726).  Saving model ...
Epoch: 4 cost time: 4.956543207168579
Epoch: 4, Steps: 13 | Train Loss: 0.488 Vali Loss: 0.522 Vali Acc: 0.766 Test Loss: 0.522 Test Acc: 0.766
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.184263467788696
Epoch: 5, Steps: 13 | Train Loss: 0.446 Vali Loss: 0.520 Vali Acc: 0.766 Test Loss: 0.520 Test Acc: 0.766
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.099491119384766
Epoch: 6, Steps: 13 | Train Loss: 0.401 Vali Loss: 0.506 Vali Acc: 0.737 Test Loss: 0.506 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.0917932987213135
Epoch: 7, Steps: 13 | Train Loss: 0.388 Vali Loss: 0.496 Vali Acc: 0.776 Test Loss: 0.496 Test Acc: 0.776
Validation loss decreased (-0.770726 --> -0.775605).  Saving model ...
Epoch: 8 cost time: 4.9151201248168945
Epoch: 8, Steps: 13 | Train Loss: 0.344 Vali Loss: 0.494 Vali Acc: 0.756 Test Loss: 0.494 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.782822132110596
Epoch: 9, Steps: 13 | Train Loss: 0.303 Vali Loss: 0.502 Vali Acc: 0.751 Test Loss: 0.502 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.738312244415283
Epoch: 10, Steps: 13 | Train Loss: 0.277 Vali Loss: 0.508 Vali Acc: 0.737 Test Loss: 0.508 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.7911317348480225
Epoch: 11, Steps: 13 | Train Loss: 0.301 Vali Loss: 0.648 Vali Acc: 0.732 Test Loss: 0.648 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.822620391845703
Epoch: 12, Steps: 13 | Train Loss: 0.260 Vali Loss: 0.589 Vali Acc: 0.751 Test Loss: 0.589 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.015301704406738
Epoch: 13, Steps: 13 | Train Loss: 0.197 Vali Loss: 0.542 Vali Acc: 0.737 Test Loss: 0.542 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.116140127182007
Epoch: 14, Steps: 13 | Train Loss: 0.196 Vali Loss: 0.555 Vali Acc: 0.722 Test Loss: 0.555 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.987760305404663
Epoch: 15, Steps: 13 | Train Loss: 0.200 Vali Loss: 0.576 Vali Acc: 0.727 Test Loss: 0.576 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.6577417850494385
Epoch: 16, Steps: 13 | Train Loss: 0.159 Vali Loss: 0.582 Vali Acc: 0.741 Test Loss: 0.582 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.460395574569702
Epoch: 17, Steps: 13 | Train Loss: 0.145 Vali Loss: 0.598 Vali Acc: 0.693 Test Loss: 0.598 Test Acc: 0.693
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 360818
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.748521089553833
Epoch: 1, Steps: 13 | Train Loss: 0.611 Vali Loss: 0.589 Vali Acc: 0.717 Test Loss: 0.589 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 7.322837591171265
Epoch: 2, Steps: 13 | Train Loss: 0.563 Vali Loss: 0.569 Vali Acc: 0.717 Test Loss: 0.569 Test Acc: 0.717
Validation loss decreased (-0.717067 --> -0.717067).  Saving model ...
Epoch: 3 cost time: 7.253786087036133
Epoch: 3, Steps: 13 | Train Loss: 0.543 Vali Loss: 0.551 Vali Acc: 0.751 Test Loss: 0.551 Test Acc: 0.751
Validation loss decreased (-0.717067 --> -0.751214).  Saving model ...
Epoch: 4 cost time: 6.799010515213013
Epoch: 4, Steps: 13 | Train Loss: 0.502 Vali Loss: 0.537 Vali Acc: 0.746 Test Loss: 0.537 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.832988023757935
Epoch: 5, Steps: 13 | Train Loss: 0.475 Vali Loss: 0.557 Vali Acc: 0.732 Test Loss: 0.557 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.7377800941467285
Epoch: 6, Steps: 13 | Train Loss: 0.449 Vali Loss: 0.561 Vali Acc: 0.751 Test Loss: 0.561 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.810983180999756
Epoch: 7, Steps: 13 | Train Loss: 0.382 Vali Loss: 0.557 Vali Acc: 0.771 Test Loss: 0.557 Test Acc: 0.771
Validation loss decreased (-0.751214 --> -0.770726).  Saving model ...
Epoch: 8 cost time: 7.195781946182251
Epoch: 8, Steps: 13 | Train Loss: 0.376 Vali Loss: 0.567 Vali Acc: 0.761 Test Loss: 0.567 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.1821417808532715
Epoch: 9, Steps: 13 | Train Loss: 0.326 Vali Loss: 0.510 Vali Acc: 0.761 Test Loss: 0.510 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.727550029754639
Epoch: 10, Steps: 13 | Train Loss: 0.294 Vali Loss: 0.538 Vali Acc: 0.785 Test Loss: 0.538 Test Acc: 0.785
Validation loss decreased (-0.770726 --> -0.785360).  Saving model ...
Epoch: 11 cost time: 6.923461675643921
Epoch: 11, Steps: 13 | Train Loss: 0.332 Vali Loss: 0.556 Vali Acc: 0.790 Test Loss: 0.556 Test Acc: 0.790
Validation loss decreased (-0.785360 --> -0.790238).  Saving model ...
Epoch: 12 cost time: 6.875922203063965
Epoch: 12, Steps: 13 | Train Loss: 0.252 Vali Loss: 0.738 Vali Acc: 0.737 Test Loss: 0.738 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.858340263366699
Epoch: 13, Steps: 13 | Train Loss: 0.219 Vali Loss: 0.568 Vali Acc: 0.746 Test Loss: 0.568 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.744406223297119
Epoch: 14, Steps: 13 | Train Loss: 0.186 Vali Loss: 0.642 Vali Acc: 0.654 Test Loss: 0.642 Test Acc: 0.654
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.7057225704193115
Epoch: 15, Steps: 13 | Train Loss: 0.188 Vali Loss: 0.569 Vali Acc: 0.732 Test Loss: 0.569 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 6.564766883850098
Epoch: 16, Steps: 13 | Train Loss: 0.137 Vali Loss: 0.613 Vali Acc: 0.761 Test Loss: 0.613 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 6.462322950363159
Epoch: 17, Steps: 13 | Train Loss: 0.127 Vali Loss: 0.602 Vali Acc: 0.741 Test Loss: 0.602 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 6.430582523345947
Epoch: 18, Steps: 13 | Train Loss: 0.139 Vali Loss: 0.629 Vali Acc: 0.737 Test Loss: 0.629 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 6.346144437789917
Epoch: 19, Steps: 13 | Train Loss: 0.130 Vali Loss: 0.679 Vali Acc: 0.678 Test Loss: 0.679 Test Acc: 0.678
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 6.9649152755737305
Epoch: 20, Steps: 13 | Train Loss: 0.093 Vali Loss: 0.672 Vali Acc: 0.717 Test Loss: 0.672 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 6.866345643997192
Epoch: 21, Steps: 13 | Train Loss: 0.080 Vali Loss: 0.713 Vali Acc: 0.712 Test Loss: 0.713 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7902439024390244
model parameter : 1188594
model size : 4.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.649117946624756
Epoch: 1, Steps: 13 | Train Loss: 0.583 Vali Loss: 0.573 Vali Acc: 0.722 Test Loss: 0.573 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.1001691818237305
Epoch: 2, Steps: 13 | Train Loss: 0.564 Vali Loss: 0.566 Vali Acc: 0.741 Test Loss: 0.566 Test Acc: 0.741
Validation loss decreased (-0.721945 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 4.040579557418823
Epoch: 3, Steps: 13 | Train Loss: 0.523 Vali Loss: 0.539 Vali Acc: 0.766 Test Loss: 0.539 Test Acc: 0.766
Validation loss decreased (-0.741458 --> -0.765848).  Saving model ...
Epoch: 4 cost time: 4.068101167678833
Epoch: 4, Steps: 13 | Train Loss: 0.488 Vali Loss: 0.524 Vali Acc: 0.766 Test Loss: 0.524 Test Acc: 0.766
Validation loss decreased (-0.765848 --> -0.765848).  Saving model ...
Epoch: 5 cost time: 4.137467384338379
Epoch: 5, Steps: 13 | Train Loss: 0.454 Vali Loss: 0.530 Vali Acc: 0.751 Test Loss: 0.530 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.09229040145874
Epoch: 6, Steps: 13 | Train Loss: 0.411 Vali Loss: 0.538 Vali Acc: 0.727 Test Loss: 0.538 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.9109139442443848
Epoch: 7, Steps: 13 | Train Loss: 0.391 Vali Loss: 0.501 Vali Acc: 0.780 Test Loss: 0.501 Test Acc: 0.780
Validation loss decreased (-0.765848 --> -0.780483).  Saving model ...
Epoch: 8 cost time: 3.91585373878479
Epoch: 8, Steps: 13 | Train Loss: 0.348 Vali Loss: 0.498 Vali Acc: 0.766 Test Loss: 0.498 Test Acc: 0.766
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.7571303844451904
Epoch: 9, Steps: 13 | Train Loss: 0.315 Vali Loss: 0.499 Vali Acc: 0.761 Test Loss: 0.499 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.7634024620056152
Epoch: 10, Steps: 13 | Train Loss: 0.289 Vali Loss: 0.502 Vali Acc: 0.761 Test Loss: 0.502 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.7131574153900146
Epoch: 11, Steps: 13 | Train Loss: 0.293 Vali Loss: 0.555 Vali Acc: 0.771 Test Loss: 0.555 Test Acc: 0.771
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.7775886058807373
Epoch: 12, Steps: 13 | Train Loss: 0.263 Vali Loss: 0.550 Vali Acc: 0.756 Test Loss: 0.550 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.059224605560303
Epoch: 13, Steps: 13 | Train Loss: 0.191 Vali Loss: 0.594 Vali Acc: 0.698 Test Loss: 0.594 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.118199348449707
Epoch: 14, Steps: 13 | Train Loss: 0.192 Vali Loss: 0.571 Vali Acc: 0.717 Test Loss: 0.571 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.035642385482788
Epoch: 15, Steps: 13 | Train Loss: 0.229 Vali Loss: 0.591 Vali Acc: 0.673 Test Loss: 0.591 Test Acc: 0.673
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.9971678256988525
Epoch: 16, Steps: 13 | Train Loss: 0.149 Vali Loss: 0.565 Vali Acc: 0.712 Test Loss: 0.565 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.0687220096588135
Epoch: 17, Steps: 13 | Train Loss: 0.141 Vali Loss: 0.597 Vali Acc: 0.712 Test Loss: 0.597 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7804878048780488
model parameter : 360818
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.41903018951416
Epoch: 1, Steps: 13 | Train Loss: 0.614 Vali Loss: 0.593 Vali Acc: 0.717 Test Loss: 0.593 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 3.8380002975463867
Epoch: 2, Steps: 13 | Train Loss: 0.564 Vali Loss: 0.574 Vali Acc: 0.722 Test Loss: 0.574 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 3.9485762119293213
Epoch: 3, Steps: 13 | Train Loss: 0.545 Vali Loss: 0.553 Vali Acc: 0.746 Test Loss: 0.553 Test Acc: 0.746
Validation loss decreased (-0.721945 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 3.999875545501709
Epoch: 4, Steps: 13 | Train Loss: 0.508 Vali Loss: 0.543 Vali Acc: 0.741 Test Loss: 0.543 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.5799622535705566
Epoch: 5, Steps: 13 | Train Loss: 0.474 Vali Loss: 0.555 Vali Acc: 0.741 Test Loss: 0.555 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.3620083332061768
Epoch: 6, Steps: 13 | Train Loss: 0.442 Vali Loss: 0.548 Vali Acc: 0.737 Test Loss: 0.548 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.4655983448028564
Epoch: 7, Steps: 13 | Train Loss: 0.385 Vali Loss: 0.577 Vali Acc: 0.766 Test Loss: 0.577 Test Acc: 0.766
Validation loss decreased (-0.746336 --> -0.765848).  Saving model ...
Epoch: 8 cost time: 3.7342898845672607
Epoch: 8, Steps: 13 | Train Loss: 0.404 Vali Loss: 0.555 Vali Acc: 0.746 Test Loss: 0.555 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.7336080074310303
Epoch: 9, Steps: 13 | Train Loss: 0.332 Vali Loss: 0.505 Vali Acc: 0.756 Test Loss: 0.505 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.7454912662506104
Epoch: 10, Steps: 13 | Train Loss: 0.301 Vali Loss: 0.528 Vali Acc: 0.790 Test Loss: 0.528 Test Acc: 0.790
Validation loss decreased (-0.765848 --> -0.790239).  Saving model ...
Epoch: 11 cost time: 4.036572456359863
Epoch: 11, Steps: 13 | Train Loss: 0.316 Vali Loss: 0.532 Vali Acc: 0.766 Test Loss: 0.532 Test Acc: 0.766
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.9495766162872314
Epoch: 12, Steps: 13 | Train Loss: 0.257 Vali Loss: 0.740 Vali Acc: 0.732 Test Loss: 0.740 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.6069135665893555
Epoch: 13, Steps: 13 | Train Loss: 0.232 Vali Loss: 0.583 Vali Acc: 0.761 Test Loss: 0.583 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.0045013427734375
Epoch: 14, Steps: 13 | Train Loss: 0.189 Vali Loss: 0.673 Vali Acc: 0.615 Test Loss: 0.673 Test Acc: 0.615
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.843310832977295
Epoch: 15, Steps: 13 | Train Loss: 0.167 Vali Loss: 0.570 Vali Acc: 0.751 Test Loss: 0.570 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.045447826385498
Epoch: 16, Steps: 13 | Train Loss: 0.156 Vali Loss: 0.584 Vali Acc: 0.732 Test Loss: 0.584 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.019010066986084
Epoch: 17, Steps: 13 | Train Loss: 0.168 Vali Loss: 0.613 Vali Acc: 0.741 Test Loss: 0.613 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.079941272735596
Epoch: 18, Steps: 13 | Train Loss: 0.129 Vali Loss: 0.623 Vali Acc: 0.712 Test Loss: 0.623 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.083252191543579
Epoch: 19, Steps: 13 | Train Loss: 0.132 Vali Loss: 0.827 Vali Acc: 0.771 Test Loss: 0.827 Test Acc: 0.771
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.097757816314697
Epoch: 20, Steps: 13 | Train Loss: 0.165 Vali Loss: 0.770 Vali Acc: 0.776 Test Loss: 0.770 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7902439024390244
model parameter : 1188594
model size : 4.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.931487560272217
Epoch: 1, Steps: 13 | Train Loss: 0.580 Vali Loss: 0.569 Vali Acc: 0.722 Test Loss: 0.569 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 2.470888614654541
Epoch: 2, Steps: 13 | Train Loss: 0.559 Vali Loss: 0.556 Vali Acc: 0.746 Test Loss: 0.556 Test Acc: 0.746
Validation loss decreased (-0.721946 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 2.4679198265075684
Epoch: 3, Steps: 13 | Train Loss: 0.521 Vali Loss: 0.531 Vali Acc: 0.771 Test Loss: 0.531 Test Acc: 0.771
Validation loss decreased (-0.746336 --> -0.770726).  Saving model ...
Epoch: 4 cost time: 2.463087558746338
Epoch: 4, Steps: 13 | Train Loss: 0.483 Vali Loss: 0.515 Vali Acc: 0.766 Test Loss: 0.515 Test Acc: 0.766
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.4538533687591553
Epoch: 5, Steps: 13 | Train Loss: 0.451 Vali Loss: 0.520 Vali Acc: 0.756 Test Loss: 0.520 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.5618367195129395
Epoch: 6, Steps: 13 | Train Loss: 0.417 Vali Loss: 0.547 Vali Acc: 0.698 Test Loss: 0.547 Test Acc: 0.698
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.5225772857666016
Epoch: 7, Steps: 13 | Train Loss: 0.398 Vali Loss: 0.519 Vali Acc: 0.751 Test Loss: 0.519 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.5810017585754395
Epoch: 8, Steps: 13 | Train Loss: 0.373 Vali Loss: 0.536 Vali Acc: 0.785 Test Loss: 0.536 Test Acc: 0.785
Validation loss decreased (-0.770726 --> -0.785360).  Saving model ...
Epoch: 9 cost time: 2.575805187225342
Epoch: 9, Steps: 13 | Train Loss: 0.316 Vali Loss: 0.562 Vali Acc: 0.712 Test Loss: 0.562 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.6427671909332275
Epoch: 10, Steps: 13 | Train Loss: 0.291 Vali Loss: 0.623 Vali Acc: 0.639 Test Loss: 0.623 Test Acc: 0.639
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.5802013874053955
Epoch: 11, Steps: 13 | Train Loss: 0.365 Vali Loss: 0.767 Vali Acc: 0.737 Test Loss: 0.767 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.564793586730957
Epoch: 12, Steps: 13 | Train Loss: 0.315 Vali Loss: 0.577 Vali Acc: 0.780 Test Loss: 0.577 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.5824167728424072
Epoch: 13, Steps: 13 | Train Loss: 0.215 Vali Loss: 0.604 Vali Acc: 0.663 Test Loss: 0.604 Test Acc: 0.663
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.6561906337738037
Epoch: 14, Steps: 13 | Train Loss: 0.226 Vali Loss: 0.641 Vali Acc: 0.639 Test Loss: 0.641 Test Acc: 0.639
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.617913007736206
Epoch: 15, Steps: 13 | Train Loss: 0.199 Vali Loss: 0.581 Vali Acc: 0.746 Test Loss: 0.581 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.629300117492676
Epoch: 16, Steps: 13 | Train Loss: 0.141 Vali Loss: 0.619 Vali Acc: 0.732 Test Loss: 0.619 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.6427536010742188
Epoch: 17, Steps: 13 | Train Loss: 0.141 Vali Loss: 0.609 Vali Acc: 0.722 Test Loss: 0.609 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.6381869316101074
Epoch: 18, Steps: 13 | Train Loss: 0.116 Vali Loss: 0.644 Vali Acc: 0.698 Test Loss: 0.644 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7853658536585366
model parameter : 360818
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.49460244178772
Epoch: 1, Steps: 13 | Train Loss: 0.619 Vali Loss: 0.600 Vali Acc: 0.722 Test Loss: 0.600 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 6.9267168045043945
Epoch: 2, Steps: 13 | Train Loss: 0.595 Vali Loss: 0.579 Vali Acc: 0.722 Test Loss: 0.579 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 6.613075256347656
Epoch: 3, Steps: 13 | Train Loss: 0.540 Vali Loss: 0.552 Vali Acc: 0.732 Test Loss: 0.552 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 4 cost time: 6.448108911514282
Epoch: 4, Steps: 13 | Train Loss: 0.487 Vali Loss: 0.543 Vali Acc: 0.732 Test Loss: 0.543 Test Acc: 0.732
Validation loss decreased (-0.731702 --> -0.731702).  Saving model ...
Epoch: 5 cost time: 6.476176738739014
Epoch: 5, Steps: 13 | Train Loss: 0.475 Vali Loss: 0.541 Vali Acc: 0.712 Test Loss: 0.541 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.997893571853638
Epoch: 6, Steps: 13 | Train Loss: 0.434 Vali Loss: 0.545 Vali Acc: 0.746 Test Loss: 0.545 Test Acc: 0.746
Validation loss decreased (-0.731702 --> -0.746336).  Saving model ...
Epoch: 7 cost time: 7.04831600189209
Epoch: 7, Steps: 13 | Train Loss: 0.418 Vali Loss: 0.552 Vali Acc: 0.746 Test Loss: 0.552 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.182532072067261
Epoch: 8, Steps: 13 | Train Loss: 0.388 Vali Loss: 0.560 Vali Acc: 0.741 Test Loss: 0.560 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.1763458251953125
Epoch: 9, Steps: 13 | Train Loss: 0.344 Vali Loss: 0.554 Vali Acc: 0.722 Test Loss: 0.554 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.962661027908325
Epoch: 10, Steps: 13 | Train Loss: 0.331 Vali Loss: 0.555 Vali Acc: 0.727 Test Loss: 0.555 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.979768753051758
Epoch: 11, Steps: 13 | Train Loss: 0.292 Vali Loss: 0.552 Vali Acc: 0.761 Test Loss: 0.552 Test Acc: 0.761
Validation loss decreased (-0.746336 --> -0.760970).  Saving model ...
Epoch: 12 cost time: 6.673778533935547
Epoch: 12, Steps: 13 | Train Loss: 0.255 Vali Loss: 0.536 Vali Acc: 0.741 Test Loss: 0.536 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 7.0572075843811035
Epoch: 13, Steps: 13 | Train Loss: 0.221 Vali Loss: 0.642 Vali Acc: 0.751 Test Loss: 0.642 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.6165971755981445
Epoch: 14, Steps: 13 | Train Loss: 0.194 Vali Loss: 0.581 Vali Acc: 0.722 Test Loss: 0.581 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.391463041305542
Epoch: 15, Steps: 13 | Train Loss: 0.178 Vali Loss: 0.588 Vali Acc: 0.712 Test Loss: 0.588 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 6.169166326522827
Epoch: 16, Steps: 13 | Train Loss: 0.164 Vali Loss: 0.769 Vali Acc: 0.751 Test Loss: 0.769 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 6.802000045776367
Epoch: 17, Steps: 13 | Train Loss: 0.155 Vali Loss: 0.749 Vali Acc: 0.741 Test Loss: 0.749 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 7.009398460388184
Epoch: 18, Steps: 13 | Train Loss: 0.121 Vali Loss: 0.643 Vali Acc: 0.751 Test Loss: 0.643 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 7.009357213973999
Epoch: 19, Steps: 13 | Train Loss: 0.093 Vali Loss: 0.690 Vali Acc: 0.756 Test Loss: 0.690 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 6.901290416717529
Epoch: 20, Steps: 13 | Train Loss: 0.083 Vali Loss: 0.878 Vali Acc: 0.741 Test Loss: 0.878 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 6.8164989948272705
Epoch: 21, Steps: 13 | Train Loss: 0.101 Vali Loss: 0.733 Vali Acc: 0.688 Test Loss: 0.733 Test Acc: 0.688
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 602482
model size : 2.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.1977057456970215
Epoch: 1, Steps: 13 | Train Loss: 0.645 Vali Loss: 0.588 Vali Acc: 0.717 Test Loss: 0.588 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 4.215759038925171
Epoch: 2, Steps: 13 | Train Loss: 0.582 Vali Loss: 0.571 Vali Acc: 0.722 Test Loss: 0.571 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721946).  Saving model ...
Epoch: 3 cost time: 4.001680612564087
Epoch: 3, Steps: 13 | Train Loss: 0.538 Vali Loss: 0.561 Vali Acc: 0.712 Test Loss: 0.561 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.839878797531128
Epoch: 4, Steps: 13 | Train Loss: 0.500 Vali Loss: 0.551 Vali Acc: 0.732 Test Loss: 0.551 Test Acc: 0.732
Validation loss decreased (-0.721946 --> -0.731702).  Saving model ...
Epoch: 5 cost time: 3.5607423782348633
Epoch: 5, Steps: 13 | Train Loss: 0.479 Vali Loss: 0.562 Vali Acc: 0.756 Test Loss: 0.562 Test Acc: 0.756
Validation loss decreased (-0.731702 --> -0.756092).  Saving model ...
Epoch: 6 cost time: 3.781061887741089
Epoch: 6, Steps: 13 | Train Loss: 0.462 Vali Loss: 0.552 Vali Acc: 0.751 Test Loss: 0.552 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.8879969120025635
Epoch: 7, Steps: 13 | Train Loss: 0.404 Vali Loss: 0.543 Vali Acc: 0.741 Test Loss: 0.543 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.30942177772522
Epoch: 8, Steps: 13 | Train Loss: 0.377 Vali Loss: 0.534 Vali Acc: 0.751 Test Loss: 0.534 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.557565212249756
Epoch: 9, Steps: 13 | Train Loss: 0.337 Vali Loss: 0.539 Vali Acc: 0.751 Test Loss: 0.539 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.526808738708496
Epoch: 10, Steps: 13 | Train Loss: 0.300 Vali Loss: 0.538 Vali Acc: 0.737 Test Loss: 0.538 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.35306453704834
Epoch: 11, Steps: 13 | Train Loss: 0.285 Vali Loss: 0.654 Vali Acc: 0.615 Test Loss: 0.654 Test Acc: 0.615
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.327260494232178
Epoch: 12, Steps: 13 | Train Loss: 0.282 Vali Loss: 0.535 Vali Acc: 0.746 Test Loss: 0.535 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.367574691772461
Epoch: 13, Steps: 13 | Train Loss: 0.229 Vali Loss: 0.584 Vali Acc: 0.737 Test Loss: 0.584 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.367536544799805
Epoch: 14, Steps: 13 | Train Loss: 0.204 Vali Loss: 0.560 Vali Acc: 0.722 Test Loss: 0.560 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.476867437362671
Epoch: 15, Steps: 13 | Train Loss: 0.210 Vali Loss: 0.577 Vali Acc: 0.698 Test Loss: 0.577 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 188530
model size : 1.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.176300048828125
Epoch: 1, Steps: 13 | Train Loss: 0.619 Vali Loss: 0.602 Vali Acc: 0.722 Test Loss: 0.602 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 6.171731233596802
Epoch: 2, Steps: 13 | Train Loss: 0.596 Vali Loss: 0.580 Vali Acc: 0.717 Test Loss: 0.580 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.4278810024261475
Epoch: 3, Steps: 13 | Train Loss: 0.542 Vali Loss: 0.552 Vali Acc: 0.732 Test Loss: 0.552 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 4 cost time: 5.560102224349976
Epoch: 4, Steps: 13 | Train Loss: 0.490 Vali Loss: 0.545 Vali Acc: 0.737 Test Loss: 0.545 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736580).  Saving model ...
Epoch: 5 cost time: 5.910783052444458
Epoch: 5, Steps: 13 | Train Loss: 0.477 Vali Loss: 0.542 Vali Acc: 0.712 Test Loss: 0.542 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.058616399765015
Epoch: 6, Steps: 13 | Train Loss: 0.438 Vali Loss: 0.550 Vali Acc: 0.746 Test Loss: 0.550 Test Acc: 0.746
Validation loss decreased (-0.736580 --> -0.746336).  Saving model ...
Epoch: 7 cost time: 6.291144132614136
Epoch: 7, Steps: 13 | Train Loss: 0.429 Vali Loss: 0.561 Vali Acc: 0.746 Test Loss: 0.561 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.125248193740845
Epoch: 8, Steps: 13 | Train Loss: 0.401 Vali Loss: 0.557 Vali Acc: 0.751 Test Loss: 0.557 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751214).  Saving model ...
Epoch: 9 cost time: 5.916341781616211
Epoch: 9, Steps: 13 | Train Loss: 0.352 Vali Loss: 0.535 Vali Acc: 0.722 Test Loss: 0.535 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.117602586746216
Epoch: 10, Steps: 13 | Train Loss: 0.327 Vali Loss: 0.546 Vali Acc: 0.727 Test Loss: 0.546 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.308544158935547
Epoch: 11, Steps: 13 | Train Loss: 0.295 Vali Loss: 0.551 Vali Acc: 0.732 Test Loss: 0.551 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.2569053173065186
Epoch: 12, Steps: 13 | Train Loss: 0.266 Vali Loss: 0.554 Vali Acc: 0.727 Test Loss: 0.554 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.259081602096558
Epoch: 13, Steps: 13 | Train Loss: 0.226 Vali Loss: 0.614 Vali Acc: 0.751 Test Loss: 0.614 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.088239669799805
Epoch: 14, Steps: 13 | Train Loss: 0.197 Vali Loss: 0.591 Vali Acc: 0.727 Test Loss: 0.591 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.7426393032073975
Epoch: 15, Steps: 13 | Train Loss: 0.172 Vali Loss: 0.613 Vali Acc: 0.737 Test Loss: 0.613 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.324544668197632
Epoch: 16, Steps: 13 | Train Loss: 0.177 Vali Loss: 0.752 Vali Acc: 0.751 Test Loss: 0.752 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 5.692548036575317
Epoch: 17, Steps: 13 | Train Loss: 0.155 Vali Loss: 0.673 Vali Acc: 0.722 Test Loss: 0.673 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 5.86259651184082
Epoch: 18, Steps: 13 | Train Loss: 0.124 Vali Loss: 0.699 Vali Acc: 0.722 Test Loss: 0.699 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 602482
model size : 2.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.485936641693115
Epoch: 1, Steps: 13 | Train Loss: 0.647 Vali Loss: 0.587 Vali Acc: 0.712 Test Loss: 0.587 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 3.8078043460845947
Epoch: 2, Steps: 13 | Train Loss: 0.577 Vali Loss: 0.571 Vali Acc: 0.717 Test Loss: 0.571 Test Acc: 0.717
Validation loss decreased (-0.712189 --> -0.717067).  Saving model ...
Epoch: 3 cost time: 3.8562657833099365
Epoch: 3, Steps: 13 | Train Loss: 0.539 Vali Loss: 0.561 Vali Acc: 0.732 Test Loss: 0.561 Test Acc: 0.732
Validation loss decreased (-0.717067 --> -0.731702).  Saving model ...
Epoch: 4 cost time: 3.8504111766815186
Epoch: 4, Steps: 13 | Train Loss: 0.502 Vali Loss: 0.548 Vali Acc: 0.746 Test Loss: 0.548 Test Acc: 0.746
Validation loss decreased (-0.731702 --> -0.746336).  Saving model ...
Epoch: 5 cost time: 3.766601800918579
Epoch: 5, Steps: 13 | Train Loss: 0.482 Vali Loss: 0.559 Vali Acc: 0.751 Test Loss: 0.559 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751214).  Saving model ...
Epoch: 6 cost time: 3.680508613586426
Epoch: 6, Steps: 13 | Train Loss: 0.462 Vali Loss: 0.540 Vali Acc: 0.746 Test Loss: 0.540 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.7313616275787354
Epoch: 7, Steps: 13 | Train Loss: 0.408 Vali Loss: 0.537 Vali Acc: 0.771 Test Loss: 0.537 Test Acc: 0.771
Validation loss decreased (-0.751214 --> -0.770726).  Saving model ...
Epoch: 8 cost time: 3.715121269226074
Epoch: 8, Steps: 13 | Train Loss: 0.381 Vali Loss: 0.531 Vali Acc: 0.761 Test Loss: 0.531 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.7274513244628906
Epoch: 9, Steps: 13 | Train Loss: 0.342 Vali Loss: 0.530 Vali Acc: 0.761 Test Loss: 0.530 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.6172738075256348
Epoch: 10, Steps: 13 | Train Loss: 0.321 Vali Loss: 0.524 Vali Acc: 0.756 Test Loss: 0.524 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.555986166000366
Epoch: 11, Steps: 13 | Train Loss: 0.297 Vali Loss: 0.690 Vali Acc: 0.566 Test Loss: 0.690 Test Acc: 0.566
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.5666730403900146
Epoch: 12, Steps: 13 | Train Loss: 0.275 Vali Loss: 0.538 Vali Acc: 0.766 Test Loss: 0.538 Test Acc: 0.766
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.4833242893218994
Epoch: 13, Steps: 13 | Train Loss: 0.241 Vali Loss: 0.597 Vali Acc: 0.761 Test Loss: 0.597 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.4090592861175537
Epoch: 14, Steps: 13 | Train Loss: 0.220 Vali Loss: 0.568 Vali Acc: 0.761 Test Loss: 0.568 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.359154224395752
Epoch: 15, Steps: 13 | Train Loss: 0.205 Vali Loss: 0.655 Vali Acc: 0.698 Test Loss: 0.655 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.395496129989624
Epoch: 16, Steps: 13 | Train Loss: 0.160 Vali Loss: 0.644 Vali Acc: 0.693 Test Loss: 0.644 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.3651809692382812
Epoch: 17, Steps: 13 | Train Loss: 0.142 Vali Loss: 0.634 Vali Acc: 0.698 Test Loss: 0.634 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 188530
model size : 1.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.98088812828064
Epoch: 1, Steps: 13 | Train Loss: 0.620 Vali Loss: 0.601 Vali Acc: 0.722 Test Loss: 0.601 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 3.428267002105713
Epoch: 2, Steps: 13 | Train Loss: 0.596 Vali Loss: 0.580 Vali Acc: 0.717 Test Loss: 0.580 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.3969414234161377
Epoch: 3, Steps: 13 | Train Loss: 0.542 Vali Loss: 0.552 Vali Acc: 0.732 Test Loss: 0.552 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 4 cost time: 3.3863346576690674
Epoch: 4, Steps: 13 | Train Loss: 0.491 Vali Loss: 0.545 Vali Acc: 0.737 Test Loss: 0.545 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736580).  Saving model ...
Epoch: 5 cost time: 3.3602311611175537
Epoch: 5, Steps: 13 | Train Loss: 0.473 Vali Loss: 0.542 Vali Acc: 0.712 Test Loss: 0.542 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.268845558166504
Epoch: 6, Steps: 13 | Train Loss: 0.443 Vali Loss: 0.559 Vali Acc: 0.746 Test Loss: 0.559 Test Acc: 0.746
Validation loss decreased (-0.736580 --> -0.746336).  Saving model ...
Epoch: 7 cost time: 3.3556101322174072
Epoch: 7, Steps: 13 | Train Loss: 0.439 Vali Loss: 0.574 Vali Acc: 0.746 Test Loss: 0.574 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.1063685417175293
Epoch: 8, Steps: 13 | Train Loss: 0.407 Vali Loss: 0.561 Vali Acc: 0.751 Test Loss: 0.561 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751214).  Saving model ...
Epoch: 9 cost time: 3.3385510444641113
Epoch: 9, Steps: 13 | Train Loss: 0.350 Vali Loss: 0.535 Vali Acc: 0.722 Test Loss: 0.535 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.1605124473571777
Epoch: 10, Steps: 13 | Train Loss: 0.345 Vali Loss: 0.541 Vali Acc: 0.737 Test Loss: 0.541 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.3129329681396484
Epoch: 11, Steps: 13 | Train Loss: 0.296 Vali Loss: 0.543 Vali Acc: 0.737 Test Loss: 0.543 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.1409902572631836
Epoch: 12, Steps: 13 | Train Loss: 0.271 Vali Loss: 0.545 Vali Acc: 0.727 Test Loss: 0.545 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.2021119594573975
Epoch: 13, Steps: 13 | Train Loss: 0.233 Vali Loss: 0.618 Vali Acc: 0.746 Test Loss: 0.618 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.2715814113616943
Epoch: 14, Steps: 13 | Train Loss: 0.219 Vali Loss: 0.590 Vali Acc: 0.693 Test Loss: 0.590 Test Acc: 0.693
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.765308141708374
Epoch: 15, Steps: 13 | Train Loss: 0.216 Vali Loss: 0.615 Vali Acc: 0.668 Test Loss: 0.615 Test Acc: 0.668
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.2166836261749268
Epoch: 16, Steps: 13 | Train Loss: 0.162 Vali Loss: 0.664 Vali Acc: 0.727 Test Loss: 0.664 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.482131242752075
Epoch: 17, Steps: 13 | Train Loss: 0.153 Vali Loss: 0.729 Vali Acc: 0.727 Test Loss: 0.729 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.4574923515319824
Epoch: 18, Steps: 13 | Train Loss: 0.137 Vali Loss: 0.650 Vali Acc: 0.717 Test Loss: 0.650 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 602482
model size : 2.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.089512586593628
Epoch: 1, Steps: 13 | Train Loss: 0.643 Vali Loss: 0.584 Vali Acc: 0.717 Test Loss: 0.584 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 2.5508384704589844
Epoch: 2, Steps: 13 | Train Loss: 0.583 Vali Loss: 0.568 Vali Acc: 0.712 Test Loss: 0.568 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.534644603729248
Epoch: 3, Steps: 13 | Train Loss: 0.541 Vali Loss: 0.559 Vali Acc: 0.722 Test Loss: 0.559 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721946).  Saving model ...
Epoch: 4 cost time: 2.4294321537017822
Epoch: 4, Steps: 13 | Train Loss: 0.508 Vali Loss: 0.540 Vali Acc: 0.727 Test Loss: 0.540 Test Acc: 0.727
Validation loss decreased (-0.721946 --> -0.726824).  Saving model ...
Epoch: 5 cost time: 2.5118234157562256
Epoch: 5, Steps: 13 | Train Loss: 0.474 Vali Loss: 0.580 Vali Acc: 0.707 Test Loss: 0.580 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.4956886768341064
Epoch: 6, Steps: 13 | Train Loss: 0.481 Vali Loss: 0.548 Vali Acc: 0.727 Test Loss: 0.548 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.5690510272979736
Epoch: 7, Steps: 13 | Train Loss: 0.420 Vali Loss: 0.545 Vali Acc: 0.751 Test Loss: 0.545 Test Acc: 0.751
Validation loss decreased (-0.726824 --> -0.751214).  Saving model ...
Epoch: 8 cost time: 2.520004987716675
Epoch: 8, Steps: 13 | Train Loss: 0.392 Vali Loss: 0.577 Vali Acc: 0.727 Test Loss: 0.577 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.3367156982421875
Epoch: 9, Steps: 13 | Train Loss: 0.366 Vali Loss: 0.569 Vali Acc: 0.746 Test Loss: 0.569 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.53808331489563
Epoch: 10, Steps: 13 | Train Loss: 0.332 Vali Loss: 0.596 Vali Acc: 0.727 Test Loss: 0.596 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.5588505268096924
Epoch: 11, Steps: 13 | Train Loss: 0.308 Vali Loss: 0.794 Vali Acc: 0.522 Test Loss: 0.794 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.3335793018341064
Epoch: 12, Steps: 13 | Train Loss: 0.301 Vali Loss: 0.623 Vali Acc: 0.746 Test Loss: 0.623 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.391792058944702
Epoch: 13, Steps: 13 | Train Loss: 0.254 Vali Loss: 0.643 Vali Acc: 0.756 Test Loss: 0.643 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756091).  Saving model ...
Epoch: 14 cost time: 2.350583791732788
Epoch: 14, Steps: 13 | Train Loss: 0.216 Vali Loss: 0.607 Vali Acc: 0.756 Test Loss: 0.607 Test Acc: 0.756
Validation loss decreased (-0.756091 --> -0.756091).  Saving model ...
Epoch: 15 cost time: 2.264749526977539
Epoch: 15, Steps: 13 | Train Loss: 0.201 Vali Loss: 0.617 Vali Acc: 0.722 Test Loss: 0.617 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.3573389053344727
Epoch: 16, Steps: 13 | Train Loss: 0.168 Vali Loss: 0.686 Vali Acc: 0.668 Test Loss: 0.686 Test Acc: 0.668
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.1709396839141846
Epoch: 17, Steps: 13 | Train Loss: 0.138 Vali Loss: 0.706 Vali Acc: 0.654 Test Loss: 0.706 Test Acc: 0.654
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.3589999675750732
Epoch: 18, Steps: 13 | Train Loss: 0.136 Vali Loss: 0.690 Vali Acc: 0.678 Test Loss: 0.690 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.505002975463867
Epoch: 19, Steps: 13 | Train Loss: 0.117 Vali Loss: 0.690 Vali Acc: 0.717 Test Loss: 0.690 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.5326242446899414
Epoch: 20, Steps: 13 | Train Loss: 0.082 Vali Loss: 0.651 Vali Acc: 0.751 Test Loss: 0.651 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.565809488296509
Epoch: 21, Steps: 13 | Train Loss: 0.094 Vali Loss: 0.715 Vali Acc: 0.654 Test Loss: 0.715 Test Acc: 0.654
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.5603466033935547
Epoch: 22, Steps: 13 | Train Loss: 0.117 Vali Loss: 0.729 Vali Acc: 0.722 Test Loss: 0.729 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.550807237625122
Epoch: 23, Steps: 13 | Train Loss: 0.091 Vali Loss: 0.781 Vali Acc: 0.629 Test Loss: 0.781 Test Acc: 0.629
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.5782370567321777
Epoch: 24, Steps: 13 | Train Loss: 0.069 Vali Loss: 0.683 Vali Acc: 0.668 Test Loss: 0.683 Test Acc: 0.668
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 188530
model size : 1.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 12.503246307373047
Epoch: 1, Steps: 13 | Train Loss: 0.632 Vali Loss: 0.582 Vali Acc: 0.712 Test Loss: 0.582 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 10.577650308609009
Epoch: 2, Steps: 13 | Train Loss: 0.577 Vali Loss: 0.575 Vali Acc: 0.712 Test Loss: 0.575 Test Acc: 0.712
Validation loss decreased (-0.712189 --> -0.712189).  Saving model ...
Epoch: 3 cost time: 7.902413368225098
Epoch: 3, Steps: 13 | Train Loss: 0.555 Vali Loss: 0.568 Vali Acc: 0.722 Test Loss: 0.568 Test Acc: 0.722
Validation loss decreased (-0.712189 --> -0.721946).  Saving model ...
Epoch: 4 cost time: 10.240480899810791
Epoch: 4, Steps: 13 | Train Loss: 0.508 Vali Loss: 0.582 Vali Acc: 0.722 Test Loss: 0.582 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.331483602523804
Epoch: 5, Steps: 13 | Train Loss: 0.542 Vali Loss: 0.555 Vali Acc: 0.737 Test Loss: 0.555 Test Acc: 0.737
Validation loss decreased (-0.721946 --> -0.736580).  Saving model ...
Epoch: 6 cost time: 11.034974813461304
Epoch: 6, Steps: 13 | Train Loss: 0.482 Vali Loss: 0.571 Vali Acc: 0.741 Test Loss: 0.571 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741458).  Saving model ...
Epoch: 7 cost time: 11.151851177215576
Epoch: 7, Steps: 13 | Train Loss: 0.478 Vali Loss: 0.548 Vali Acc: 0.741 Test Loss: 0.548 Test Acc: 0.741
Validation loss decreased (-0.741458 --> -0.741458).  Saving model ...
Epoch: 8 cost time: 11.064758539199829
Epoch: 8, Steps: 13 | Train Loss: 0.430 Vali Loss: 0.534 Vali Acc: 0.732 Test Loss: 0.534 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 10.396313428878784
Epoch: 9, Steps: 13 | Train Loss: 0.426 Vali Loss: 0.532 Vali Acc: 0.746 Test Loss: 0.532 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746336).  Saving model ...
Epoch: 10 cost time: 10.882822275161743
Epoch: 10, Steps: 13 | Train Loss: 0.396 Vali Loss: 0.527 Vali Acc: 0.741 Test Loss: 0.527 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 10.945083856582642
Epoch: 11, Steps: 13 | Train Loss: 0.379 Vali Loss: 0.528 Vali Acc: 0.722 Test Loss: 0.528 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 10.630382299423218
Epoch: 12, Steps: 13 | Train Loss: 0.350 Vali Loss: 0.577 Vali Acc: 0.698 Test Loss: 0.577 Test Acc: 0.698
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 10.176734209060669
Epoch: 13, Steps: 13 | Train Loss: 0.337 Vali Loss: 0.536 Vali Acc: 0.746 Test Loss: 0.536 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 10.006174564361572
Epoch: 14, Steps: 13 | Train Loss: 0.295 Vali Loss: 0.551 Vali Acc: 0.746 Test Loss: 0.551 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 10.828600645065308
Epoch: 15, Steps: 13 | Train Loss: 0.310 Vali Loss: 0.548 Vali Acc: 0.702 Test Loss: 0.548 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 10.838616609573364
Epoch: 16, Steps: 13 | Train Loss: 0.269 Vali Loss: 0.539 Vali Acc: 0.712 Test Loss: 0.539 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 10.575029134750366
Epoch: 17, Steps: 13 | Train Loss: 0.251 Vali Loss: 0.618 Vali Acc: 0.732 Test Loss: 0.618 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 11.020710945129395
Epoch: 18, Steps: 13 | Train Loss: 0.261 Vali Loss: 0.578 Vali Acc: 0.732 Test Loss: 0.578 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 10.895067691802979
Epoch: 19, Steps: 13 | Train Loss: 0.230 Vali Loss: 0.586 Vali Acc: 0.761 Test Loss: 0.586 Test Acc: 0.761
Validation loss decreased (-0.746336 --> -0.760970).  Saving model ...
Epoch: 20 cost time: 10.966468095779419
Epoch: 20, Steps: 13 | Train Loss: 0.205 Vali Loss: 0.628 Vali Acc: 0.756 Test Loss: 0.628 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 10.176783800125122
Epoch: 21, Steps: 13 | Train Loss: 0.210 Vali Loss: 0.648 Vali Acc: 0.741 Test Loss: 0.648 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 9.838887453079224
Epoch: 22, Steps: 13 | Train Loss: 0.218 Vali Loss: 0.616 Vali Acc: 0.683 Test Loss: 0.616 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 10.298617124557495
Epoch: 23, Steps: 13 | Train Loss: 0.177 Vali Loss: 0.665 Vali Acc: 0.712 Test Loss: 0.665 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 11.119004726409912
Epoch: 24, Steps: 13 | Train Loss: 0.165 Vali Loss: 0.663 Vali Acc: 0.717 Test Loss: 0.663 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 11.309221744537354
Epoch: 25, Steps: 13 | Train Loss: 0.167 Vali Loss: 0.633 Vali Acc: 0.707 Test Loss: 0.633 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 11.210553646087646
Epoch: 26, Steps: 13 | Train Loss: 0.138 Vali Loss: 0.629 Vali Acc: 0.727 Test Loss: 0.629 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 11.199546575546265
Epoch: 27, Steps: 13 | Train Loss: 0.124 Vali Loss: 0.786 Vali Acc: 0.732 Test Loss: 0.786 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 10.97232460975647
Epoch: 28, Steps: 13 | Train Loss: 0.139 Vali Loss: 0.714 Vali Acc: 0.659 Test Loss: 0.714 Test Acc: 0.659
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 11.068965196609497
Epoch: 29, Steps: 13 | Train Loss: 0.119 Vali Loss: 0.806 Vali Acc: 0.712 Test Loss: 0.806 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 1181178
model size : 4.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.286752939224243
Epoch: 1, Steps: 13 | Train Loss: 0.599 Vali Loss: 0.564 Vali Acc: 0.727 Test Loss: 0.564 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 5.585735082626343
Epoch: 2, Steps: 13 | Train Loss: 0.597 Vali Loss: 0.577 Vali Acc: 0.722 Test Loss: 0.577 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.976238012313843
Epoch: 3, Steps: 13 | Train Loss: 0.544 Vali Loss: 0.534 Vali Acc: 0.751 Test Loss: 0.534 Test Acc: 0.751
Validation loss decreased (-0.726824 --> -0.751214).  Saving model ...
Epoch: 4 cost time: 5.964711427688599
Epoch: 4, Steps: 13 | Train Loss: 0.512 Vali Loss: 0.529 Vali Acc: 0.741 Test Loss: 0.529 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.990039587020874
Epoch: 5, Steps: 13 | Train Loss: 0.483 Vali Loss: 0.554 Vali Acc: 0.737 Test Loss: 0.554 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.944880485534668
Epoch: 6, Steps: 13 | Train Loss: 0.463 Vali Loss: 0.559 Vali Acc: 0.746 Test Loss: 0.559 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.8855016231536865
Epoch: 7, Steps: 13 | Train Loss: 0.461 Vali Loss: 0.516 Vali Acc: 0.761 Test Loss: 0.516 Test Acc: 0.761
Validation loss decreased (-0.751214 --> -0.760970).  Saving model ...
Epoch: 8 cost time: 5.9311652183532715
Epoch: 8, Steps: 13 | Train Loss: 0.410 Vali Loss: 0.517 Vali Acc: 0.732 Test Loss: 0.517 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.70830225944519
Epoch: 9, Steps: 13 | Train Loss: 0.396 Vali Loss: 0.557 Vali Acc: 0.751 Test Loss: 0.557 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.941917896270752
Epoch: 10, Steps: 13 | Train Loss: 0.368 Vali Loss: 0.545 Vali Acc: 0.727 Test Loss: 0.545 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.030883550643921
Epoch: 11, Steps: 13 | Train Loss: 0.327 Vali Loss: 0.633 Vali Acc: 0.741 Test Loss: 0.633 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.000416994094849
Epoch: 12, Steps: 13 | Train Loss: 0.326 Vali Loss: 0.706 Vali Acc: 0.761 Test Loss: 0.706 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.741924285888672
Epoch: 13, Steps: 13 | Train Loss: 0.297 Vali Loss: 0.567 Vali Acc: 0.741 Test Loss: 0.567 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.772136211395264
Epoch: 14, Steps: 13 | Train Loss: 0.279 Vali Loss: 0.597 Vali Acc: 0.727 Test Loss: 0.597 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.699599981307983
Epoch: 15, Steps: 13 | Train Loss: 0.228 Vali Loss: 0.575 Vali Acc: 0.727 Test Loss: 0.575 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.720165729522705
Epoch: 16, Steps: 13 | Train Loss: 0.199 Vali Loss: 0.710 Vali Acc: 0.751 Test Loss: 0.710 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 6.069172620773315
Epoch: 17, Steps: 13 | Train Loss: 0.183 Vali Loss: 0.664 Vali Acc: 0.732 Test Loss: 0.664 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 353210
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 10.401862621307373
Epoch: 1, Steps: 13 | Train Loss: 0.632 Vali Loss: 0.583 Vali Acc: 0.712 Test Loss: 0.583 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 8.400320053100586
Epoch: 2, Steps: 13 | Train Loss: 0.579 Vali Loss: 0.573 Vali Acc: 0.712 Test Loss: 0.573 Test Acc: 0.712
Validation loss decreased (-0.712189 --> -0.712189).  Saving model ...
Epoch: 3 cost time: 8.454598188400269
Epoch: 3, Steps: 13 | Train Loss: 0.559 Vali Loss: 0.562 Vali Acc: 0.722 Test Loss: 0.562 Test Acc: 0.722
Validation loss decreased (-0.712189 --> -0.721946).  Saving model ...
Epoch: 4 cost time: 8.404079914093018
Epoch: 4, Steps: 13 | Train Loss: 0.521 Vali Loss: 0.553 Vali Acc: 0.722 Test Loss: 0.553 Test Acc: 0.722
Validation loss decreased (-0.721946 --> -0.721946).  Saving model ...
Epoch: 5 cost time: 8.46740436553955
Epoch: 5, Steps: 13 | Train Loss: 0.509 Vali Loss: 0.552 Vali Acc: 0.741 Test Loss: 0.552 Test Acc: 0.741
Validation loss decreased (-0.721946 --> -0.741458).  Saving model ...
Epoch: 6 cost time: 8.572914600372314
Epoch: 6, Steps: 13 | Train Loss: 0.488 Vali Loss: 0.549 Vali Acc: 0.722 Test Loss: 0.549 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.102956295013428
Epoch: 7, Steps: 13 | Train Loss: 0.495 Vali Loss: 0.543 Vali Acc: 0.741 Test Loss: 0.543 Test Acc: 0.741
Validation loss decreased (-0.741458 --> -0.741458).  Saving model ...
Epoch: 8 cost time: 7.913076639175415
Epoch: 8, Steps: 13 | Train Loss: 0.444 Vali Loss: 0.536 Vali Acc: 0.732 Test Loss: 0.536 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.738229513168335
Epoch: 9, Steps: 13 | Train Loss: 0.439 Vali Loss: 0.537 Vali Acc: 0.732 Test Loss: 0.537 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 7.619696855545044
Epoch: 10, Steps: 13 | Train Loss: 0.429 Vali Loss: 0.517 Vali Acc: 0.746 Test Loss: 0.517 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746336).  Saving model ...
Epoch: 11 cost time: 8.2088041305542
Epoch: 11, Steps: 13 | Train Loss: 0.396 Vali Loss: 0.518 Vali Acc: 0.746 Test Loss: 0.518 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 8.357265949249268
Epoch: 12, Steps: 13 | Train Loss: 0.373 Vali Loss: 0.521 Vali Acc: 0.751 Test Loss: 0.521 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751214).  Saving model ...
Epoch: 13 cost time: 8.496106624603271
Epoch: 13, Steps: 13 | Train Loss: 0.375 Vali Loss: 0.638 Vali Acc: 0.727 Test Loss: 0.638 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 8.507781028747559
Epoch: 14, Steps: 13 | Train Loss: 0.332 Vali Loss: 0.551 Vali Acc: 0.746 Test Loss: 0.551 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 8.450173616409302
Epoch: 15, Steps: 13 | Train Loss: 0.339 Vali Loss: 0.539 Vali Acc: 0.727 Test Loss: 0.539 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 8.390441656112671
Epoch: 16, Steps: 13 | Train Loss: 0.307 Vali Loss: 0.526 Vali Acc: 0.746 Test Loss: 0.526 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 8.397399663925171
Epoch: 17, Steps: 13 | Train Loss: 0.282 Vali Loss: 0.595 Vali Acc: 0.741 Test Loss: 0.595 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 8.318563222885132
Epoch: 18, Steps: 13 | Train Loss: 0.283 Vali Loss: 0.548 Vali Acc: 0.717 Test Loss: 0.548 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 7.722592115402222
Epoch: 19, Steps: 13 | Train Loss: 0.232 Vali Loss: 0.545 Vali Acc: 0.766 Test Loss: 0.545 Test Acc: 0.766
Validation loss decreased (-0.751214 --> -0.765848).  Saving model ...
Epoch: 20 cost time: 7.306374549865723
Epoch: 20, Steps: 13 | Train Loss: 0.232 Vali Loss: 0.579 Vali Acc: 0.756 Test Loss: 0.579 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 7.976411581039429
Epoch: 21, Steps: 13 | Train Loss: 0.227 Vali Loss: 0.645 Vali Acc: 0.746 Test Loss: 0.645 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 8.355450630187988
Epoch: 22, Steps: 13 | Train Loss: 0.243 Vali Loss: 0.646 Vali Acc: 0.663 Test Loss: 0.646 Test Acc: 0.663
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 8.675431489944458
Epoch: 23, Steps: 13 | Train Loss: 0.200 Vali Loss: 0.699 Vali Acc: 0.732 Test Loss: 0.699 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 8.640410900115967
Epoch: 24, Steps: 13 | Train Loss: 0.172 Vali Loss: 0.599 Vali Acc: 0.707 Test Loss: 0.599 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 8.591451644897461
Epoch: 25, Steps: 13 | Train Loss: 0.233 Vali Loss: 0.617 Vali Acc: 0.693 Test Loss: 0.617 Test Acc: 0.693
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 8.64352011680603
Epoch: 26, Steps: 13 | Train Loss: 0.173 Vali Loss: 0.632 Vali Acc: 0.737 Test Loss: 0.632 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 8.250306844711304
Epoch: 27, Steps: 13 | Train Loss: 0.138 Vali Loss: 0.617 Vali Acc: 0.746 Test Loss: 0.617 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 8.330815315246582
Epoch: 28, Steps: 13 | Train Loss: 0.208 Vali Loss: 0.617 Vali Acc: 0.702 Test Loss: 0.617 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 8.070087671279907
Epoch: 29, Steps: 13 | Train Loss: 0.133 Vali Loss: 0.601 Vali Acc: 0.722 Test Loss: 0.601 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 1181178
model size : 4.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.201178550720215
Epoch: 1, Steps: 13 | Train Loss: 0.597 Vali Loss: 0.564 Vali Acc: 0.722 Test Loss: 0.564 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 4.607345104217529
Epoch: 2, Steps: 13 | Train Loss: 0.595 Vali Loss: 0.578 Vali Acc: 0.717 Test Loss: 0.578 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.620601415634155
Epoch: 3, Steps: 13 | Train Loss: 0.544 Vali Loss: 0.535 Vali Acc: 0.741 Test Loss: 0.535 Test Acc: 0.741
Validation loss decreased (-0.721946 --> -0.741458).  Saving model ...
Epoch: 4 cost time: 4.814052104949951
Epoch: 4, Steps: 13 | Train Loss: 0.515 Vali Loss: 0.522 Vali Acc: 0.761 Test Loss: 0.522 Test Acc: 0.761
Validation loss decreased (-0.741458 --> -0.760970).  Saving model ...
Epoch: 5 cost time: 4.9265782833099365
Epoch: 5, Steps: 13 | Train Loss: 0.484 Vali Loss: 0.534 Vali Acc: 0.746 Test Loss: 0.534 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.974600791931152
Epoch: 6, Steps: 13 | Train Loss: 0.476 Vali Loss: 0.551 Vali Acc: 0.751 Test Loss: 0.551 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.886556386947632
Epoch: 7, Steps: 13 | Train Loss: 0.450 Vali Loss: 0.512 Vali Acc: 0.741 Test Loss: 0.512 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.7239670753479
Epoch: 8, Steps: 13 | Train Loss: 0.416 Vali Loss: 0.529 Vali Acc: 0.737 Test Loss: 0.529 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.759348392486572
Epoch: 9, Steps: 13 | Train Loss: 0.367 Vali Loss: 0.568 Vali Acc: 0.756 Test Loss: 0.568 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.8979151248931885
Epoch: 10, Steps: 13 | Train Loss: 0.382 Vali Loss: 0.583 Vali Acc: 0.751 Test Loss: 0.583 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.586000442504883
Epoch: 11, Steps: 13 | Train Loss: 0.362 Vali Loss: 0.535 Vali Acc: 0.756 Test Loss: 0.535 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.819836139678955
Epoch: 12, Steps: 13 | Train Loss: 0.321 Vali Loss: 0.722 Vali Acc: 0.751 Test Loss: 0.722 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.828133821487427
Epoch: 13, Steps: 13 | Train Loss: 0.289 Vali Loss: 0.615 Vali Acc: 0.727 Test Loss: 0.615 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.505893230438232
Epoch: 14, Steps: 13 | Train Loss: 0.275 Vali Loss: 0.610 Vali Acc: 0.741 Test Loss: 0.610 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 353210
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.333667755126953
Epoch: 1, Steps: 13 | Train Loss: 0.633 Vali Loss: 0.588 Vali Acc: 0.712 Test Loss: 0.588 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 4.616504192352295
Epoch: 2, Steps: 13 | Train Loss: 0.582 Vali Loss: 0.569 Vali Acc: 0.717 Test Loss: 0.569 Test Acc: 0.717
Validation loss decreased (-0.712189 --> -0.717067).  Saving model ...
Epoch: 3 cost time: 4.617939472198486
Epoch: 3, Steps: 13 | Train Loss: 0.567 Vali Loss: 0.562 Vali Acc: 0.727 Test Loss: 0.562 Test Acc: 0.727
Validation loss decreased (-0.717067 --> -0.726824).  Saving model ...
Epoch: 4 cost time: 4.614101409912109
Epoch: 4, Steps: 13 | Train Loss: 0.530 Vali Loss: 0.552 Vali Acc: 0.727 Test Loss: 0.552 Test Acc: 0.727
Validation loss decreased (-0.726824 --> -0.726824).  Saving model ...
Epoch: 5 cost time: 4.929631233215332
Epoch: 5, Steps: 13 | Train Loss: 0.527 Vali Loss: 0.551 Vali Acc: 0.741 Test Loss: 0.551 Test Acc: 0.741
Validation loss decreased (-0.726824 --> -0.741458).  Saving model ...
Epoch: 6 cost time: 4.907047510147095
Epoch: 6, Steps: 13 | Train Loss: 0.510 Vali Loss: 0.576 Vali Acc: 0.732 Test Loss: 0.576 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.925989866256714
Epoch: 7, Steps: 13 | Train Loss: 0.496 Vali Loss: 0.578 Vali Acc: 0.732 Test Loss: 0.578 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.878293514251709
Epoch: 8, Steps: 13 | Train Loss: 0.452 Vali Loss: 0.526 Vali Acc: 0.766 Test Loss: 0.526 Test Acc: 0.766
Validation loss decreased (-0.741458 --> -0.765848).  Saving model ...
Epoch: 9 cost time: 4.967014312744141
Epoch: 9, Steps: 13 | Train Loss: 0.471 Vali Loss: 0.541 Vali Acc: 0.741 Test Loss: 0.541 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.74953556060791
Epoch: 10, Steps: 13 | Train Loss: 0.435 Vali Loss: 0.453 Vali Acc: 0.795 Test Loss: 0.453 Test Acc: 0.795
Validation loss decreased (-0.765848 --> -0.795117).  Saving model ...
Epoch: 11 cost time: 4.557163953781128
Epoch: 11, Steps: 13 | Train Loss: 0.427 Vali Loss: 0.412 Vali Acc: 0.805 Test Loss: 0.412 Test Acc: 0.805
Validation loss decreased (-0.795117 --> -0.804874).  Saving model ...
Epoch: 12 cost time: 4.851293087005615
Epoch: 12, Steps: 13 | Train Loss: 0.482 Vali Loss: 0.417 Vali Acc: 0.805 Test Loss: 0.417 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.834119558334351
Epoch: 13, Steps: 13 | Train Loss: 0.437 Vali Loss: 0.608 Vali Acc: 0.732 Test Loss: 0.608 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.853812217712402
Epoch: 14, Steps: 13 | Train Loss: 0.378 Vali Loss: 0.473 Vali Acc: 0.766 Test Loss: 0.473 Test Acc: 0.766
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.929285287857056
Epoch: 15, Steps: 13 | Train Loss: 0.361 Vali Loss: 0.495 Vali Acc: 0.751 Test Loss: 0.495 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.885030508041382
Epoch: 16, Steps: 13 | Train Loss: 0.393 Vali Loss: 0.654 Vali Acc: 0.668 Test Loss: 0.654 Test Acc: 0.668
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.56631875038147
Epoch: 17, Steps: 13 | Train Loss: 0.313 Vali Loss: 0.470 Vali Acc: 0.780 Test Loss: 0.470 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.597142457962036
Epoch: 18, Steps: 13 | Train Loss: 0.318 Vali Loss: 0.556 Vali Acc: 0.693 Test Loss: 0.556 Test Acc: 0.693
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.426299571990967
Epoch: 19, Steps: 13 | Train Loss: 0.287 Vali Loss: 0.569 Vali Acc: 0.746 Test Loss: 0.569 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.4772961139678955
Epoch: 20, Steps: 13 | Train Loss: 0.253 Vali Loss: 0.763 Vali Acc: 0.727 Test Loss: 0.763 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.4397923946380615
Epoch: 21, Steps: 13 | Train Loss: 0.329 Vali Loss: 0.605 Vali Acc: 0.741 Test Loss: 0.605 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.8048780487804879
model parameter : 1181178
model size : 4.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.601933240890503
Epoch: 1, Steps: 13 | Train Loss: 0.610 Vali Loss: 0.590 Vali Acc: 0.717 Test Loss: 0.590 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 3.1583235263824463
Epoch: 2, Steps: 13 | Train Loss: 0.593 Vali Loss: 0.576 Vali Acc: 0.717 Test Loss: 0.576 Test Acc: 0.717
Validation loss decreased (-0.717067 --> -0.717067).  Saving model ...
Epoch: 3 cost time: 3.2769665718078613
Epoch: 3, Steps: 13 | Train Loss: 0.562 Vali Loss: 0.556 Vali Acc: 0.727 Test Loss: 0.556 Test Acc: 0.727
Validation loss decreased (-0.717067 --> -0.726824).  Saving model ...
Epoch: 4 cost time: 3.154122829437256
Epoch: 4, Steps: 13 | Train Loss: 0.523 Vali Loss: 0.543 Vali Acc: 0.727 Test Loss: 0.543 Test Acc: 0.727
Validation loss decreased (-0.726824 --> -0.726824).  Saving model ...
Epoch: 5 cost time: 3.1602132320404053
Epoch: 5, Steps: 13 | Train Loss: 0.519 Vali Loss: 0.580 Vali Acc: 0.727 Test Loss: 0.580 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.2164504528045654
Epoch: 6, Steps: 13 | Train Loss: 0.483 Vali Loss: 0.438 Vali Acc: 0.839 Test Loss: 0.438 Test Acc: 0.839
Validation loss decreased (-0.726824 --> -0.839020).  Saving model ...
Epoch: 7 cost time: 3.1606476306915283
Epoch: 7, Steps: 13 | Train Loss: 0.514 Vali Loss: 0.442 Vali Acc: 0.771 Test Loss: 0.442 Test Acc: 0.771
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.1487929821014404
Epoch: 8, Steps: 13 | Train Loss: 0.452 Vali Loss: 0.529 Vali Acc: 0.737 Test Loss: 0.529 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.16759991645813
Epoch: 9, Steps: 13 | Train Loss: 0.455 Vali Loss: 0.567 Vali Acc: 0.751 Test Loss: 0.567 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.247483491897583
Epoch: 10, Steps: 13 | Train Loss: 0.468 Vali Loss: 0.430 Vali Acc: 0.839 Test Loss: 0.430 Test Acc: 0.839
Validation loss decreased (-0.839020 --> -0.839020).  Saving model ...
Epoch: 11 cost time: 3.1896610260009766
Epoch: 11, Steps: 13 | Train Loss: 0.425 Vali Loss: 0.535 Vali Acc: 0.741 Test Loss: 0.535 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.2739992141723633
Epoch: 12, Steps: 13 | Train Loss: 0.386 Vali Loss: 0.649 Vali Acc: 0.722 Test Loss: 0.649 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.94118595123291
Epoch: 13, Steps: 13 | Train Loss: 0.367 Vali Loss: 0.569 Vali Acc: 0.732 Test Loss: 0.569 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.5830984115600586
Epoch: 14, Steps: 13 | Train Loss: 0.332 Vali Loss: 0.564 Vali Acc: 0.722 Test Loss: 0.564 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.798048973083496
Epoch: 15, Steps: 13 | Train Loss: 0.290 Vali Loss: 0.618 Vali Acc: 0.693 Test Loss: 0.618 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.0261380672454834
Epoch: 16, Steps: 13 | Train Loss: 0.266 Vali Loss: 0.672 Vali Acc: 0.761 Test Loss: 0.672 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.027984142303467
Epoch: 17, Steps: 13 | Train Loss: 0.270 Vali Loss: 0.542 Vali Acc: 0.732 Test Loss: 0.542 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.026129961013794
Epoch: 18, Steps: 13 | Train Loss: 0.243 Vali Loss: 0.638 Vali Acc: 0.746 Test Loss: 0.638 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.294440984725952
Epoch: 19, Steps: 13 | Train Loss: 0.252 Vali Loss: 0.649 Vali Acc: 0.727 Test Loss: 0.649 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.29081654548645
Epoch: 20, Steps: 13 | Train Loss: 0.177 Vali Loss: 0.692 Vali Acc: 0.702 Test Loss: 0.692 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.8390243902439024
model parameter : 353210
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.58898639678955
Epoch: 1, Steps: 13 | Train Loss: 0.607 Vali Loss: 0.594 Vali Acc: 0.712 Test Loss: 0.594 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 6.816564321517944
Epoch: 2, Steps: 13 | Train Loss: 0.588 Vali Loss: 0.589 Vali Acc: 0.712 Test Loss: 0.589 Test Acc: 0.712
Validation loss decreased (-0.712189 --> -0.712189).  Saving model ...
Epoch: 3 cost time: 6.756659269332886
Epoch: 3, Steps: 13 | Train Loss: 0.577 Vali Loss: 0.578 Vali Acc: 0.712 Test Loss: 0.578 Test Acc: 0.712
Validation loss decreased (-0.712189 --> -0.712189).  Saving model ...
Epoch: 4 cost time: 6.694299936294556
Epoch: 4, Steps: 13 | Train Loss: 0.573 Vali Loss: 0.574 Vali Acc: 0.717 Test Loss: 0.574 Test Acc: 0.717
Validation loss decreased (-0.712189 --> -0.717067).  Saving model ...
Epoch: 5 cost time: 6.800119638442993
Epoch: 5, Steps: 13 | Train Loss: 0.506 Vali Loss: 0.563 Vali Acc: 0.727 Test Loss: 0.563 Test Acc: 0.727
Validation loss decreased (-0.717067 --> -0.726824).  Saving model ...
Epoch: 6 cost time: 6.738628149032593
Epoch: 6, Steps: 13 | Train Loss: 0.495 Vali Loss: 0.556 Vali Acc: 0.737 Test Loss: 0.556 Test Acc: 0.737
Validation loss decreased (-0.726824 --> -0.736580).  Saving model ...
Epoch: 7 cost time: 6.418668985366821
Epoch: 7, Steps: 13 | Train Loss: 0.469 Vali Loss: 0.537 Vali Acc: 0.756 Test Loss: 0.537 Test Acc: 0.756
Validation loss decreased (-0.736580 --> -0.756092).  Saving model ...
Epoch: 8 cost time: 6.386631727218628
Epoch: 8, Steps: 13 | Train Loss: 0.441 Vali Loss: 0.538 Vali Acc: 0.761 Test Loss: 0.538 Test Acc: 0.761
Validation loss decreased (-0.756092 --> -0.760970).  Saving model ...
Epoch: 9 cost time: 6.293628692626953
Epoch: 9, Steps: 13 | Train Loss: 0.405 Vali Loss: 0.529 Vali Acc: 0.761 Test Loss: 0.529 Test Acc: 0.761
Validation loss decreased (-0.760970 --> -0.760970).  Saving model ...
Epoch: 10 cost time: 6.246417760848999
Epoch: 10, Steps: 13 | Train Loss: 0.395 Vali Loss: 0.543 Vali Acc: 0.771 Test Loss: 0.543 Test Acc: 0.771
Validation loss decreased (-0.760970 --> -0.770726).  Saving model ...
Epoch: 11 cost time: 6.702926874160767
Epoch: 11, Steps: 13 | Train Loss: 0.375 Vali Loss: 0.518 Vali Acc: 0.766 Test Loss: 0.518 Test Acc: 0.766
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.737645387649536
Epoch: 12, Steps: 13 | Train Loss: 0.386 Vali Loss: 0.605 Vali Acc: 0.654 Test Loss: 0.605 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.830341577529907
Epoch: 13, Steps: 13 | Train Loss: 0.379 Vali Loss: 0.607 Vali Acc: 0.756 Test Loss: 0.607 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.640434503555298
Epoch: 14, Steps: 13 | Train Loss: 0.324 Vali Loss: 0.508 Vali Acc: 0.790 Test Loss: 0.508 Test Acc: 0.790
Validation loss decreased (-0.770726 --> -0.790239).  Saving model ...
Epoch: 15 cost time: 6.705704212188721
Epoch: 15, Steps: 13 | Train Loss: 0.319 Vali Loss: 0.533 Vali Acc: 0.732 Test Loss: 0.533 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.7151103019714355
Epoch: 16, Steps: 13 | Train Loss: 0.295 Vali Loss: 0.560 Vali Acc: 0.732 Test Loss: 0.560 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.732550859451294
Epoch: 17, Steps: 13 | Train Loss: 0.289 Vali Loss: 0.540 Vali Acc: 0.785 Test Loss: 0.540 Test Acc: 0.785
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 6.564981698989868
Epoch: 18, Steps: 13 | Train Loss: 0.282 Vali Loss: 0.589 Vali Acc: 0.771 Test Loss: 0.589 Test Acc: 0.771
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 6.712861061096191
Epoch: 19, Steps: 13 | Train Loss: 0.249 Vali Loss: 0.599 Vali Acc: 0.766 Test Loss: 0.599 Test Acc: 0.766
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 6.111138582229614
Epoch: 20, Steps: 13 | Train Loss: 0.244 Vali Loss: 0.587 Vali Acc: 0.785 Test Loss: 0.587 Test Acc: 0.785
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 6.1328277587890625
Epoch: 21, Steps: 13 | Train Loss: 0.225 Vali Loss: 0.621 Vali Acc: 0.732 Test Loss: 0.621 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 6.21154260635376
Epoch: 22, Steps: 13 | Train Loss: 0.215 Vali Loss: 0.636 Vali Acc: 0.702 Test Loss: 0.636 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 6.167098760604858
Epoch: 23, Steps: 13 | Train Loss: 0.188 Vali Loss: 0.639 Vali Acc: 0.746 Test Loss: 0.639 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 6.462000608444214
Epoch: 24, Steps: 13 | Train Loss: 0.169 Vali Loss: 0.721 Vali Acc: 0.756 Test Loss: 0.721 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7902439024390244
model parameter : 594682
model size : 2.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.9073710441589355
Epoch: 1, Steps: 13 | Train Loss: 0.654 Vali Loss: 0.576 Vali Acc: 0.717 Test Loss: 0.576 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 4.144448280334473
Epoch: 2, Steps: 13 | Train Loss: 0.594 Vali Loss: 0.579 Vali Acc: 0.717 Test Loss: 0.579 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.7930986881256104
Epoch: 3, Steps: 13 | Train Loss: 0.574 Vali Loss: 0.564 Vali Acc: 0.707 Test Loss: 0.564 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.960031032562256
Epoch: 4, Steps: 13 | Train Loss: 0.540 Vali Loss: 0.558 Vali Acc: 0.717 Test Loss: 0.558 Test Acc: 0.717
Validation loss decreased (-0.717067 --> -0.717068).  Saving model ...
Epoch: 5 cost time: 3.9909164905548096
Epoch: 5, Steps: 13 | Train Loss: 0.522 Vali Loss: 0.557 Vali Acc: 0.698 Test Loss: 0.557 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.985992431640625
Epoch: 6, Steps: 13 | Train Loss: 0.486 Vali Loss: 0.578 Vali Acc: 0.717 Test Loss: 0.578 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.6271133422851562
Epoch: 7, Steps: 13 | Train Loss: 0.473 Vali Loss: 0.560 Vali Acc: 0.707 Test Loss: 0.560 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.684894323348999
Epoch: 8, Steps: 13 | Train Loss: 0.462 Vali Loss: 0.553 Vali Acc: 0.712 Test Loss: 0.553 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.725710153579712
Epoch: 9, Steps: 13 | Train Loss: 0.417 Vali Loss: 0.543 Vali Acc: 0.717 Test Loss: 0.543 Test Acc: 0.717
Validation loss decreased (-0.717068 --> -0.717068).  Saving model ...
Epoch: 10 cost time: 3.8328161239624023
Epoch: 10, Steps: 13 | Train Loss: 0.393 Vali Loss: 0.563 Vali Acc: 0.717 Test Loss: 0.563 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.660623550415039
Epoch: 11, Steps: 13 | Train Loss: 0.387 Vali Loss: 0.537 Vali Acc: 0.717 Test Loss: 0.537 Test Acc: 0.717
Validation loss decreased (-0.717068 --> -0.717068).  Saving model ...
Epoch: 12 cost time: 3.381455421447754
Epoch: 12, Steps: 13 | Train Loss: 0.370 Vali Loss: 0.532 Vali Acc: 0.741 Test Loss: 0.532 Test Acc: 0.741
Validation loss decreased (-0.717068 --> -0.741458).  Saving model ...
Epoch: 13 cost time: 3.594998598098755
Epoch: 13, Steps: 13 | Train Loss: 0.339 Vali Loss: 0.540 Vali Acc: 0.746 Test Loss: 0.540 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746336).  Saving model ...
Epoch: 14 cost time: 3.548415422439575
Epoch: 14, Steps: 13 | Train Loss: 0.329 Vali Loss: 0.536 Vali Acc: 0.717 Test Loss: 0.536 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.5274009704589844
Epoch: 15, Steps: 13 | Train Loss: 0.323 Vali Loss: 0.573 Vali Acc: 0.727 Test Loss: 0.573 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.2535250186920166
Epoch: 16, Steps: 13 | Train Loss: 0.305 Vali Loss: 0.577 Vali Acc: 0.732 Test Loss: 0.577 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.3782708644866943
Epoch: 17, Steps: 13 | Train Loss: 0.269 Vali Loss: 0.629 Vali Acc: 0.678 Test Loss: 0.629 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.6180083751678467
Epoch: 18, Steps: 13 | Train Loss: 0.270 Vali Loss: 0.567 Vali Acc: 0.741 Test Loss: 0.567 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.655028820037842
Epoch: 19, Steps: 13 | Train Loss: 0.240 Vali Loss: 0.631 Vali Acc: 0.673 Test Loss: 0.631 Test Acc: 0.673
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.7261013984680176
Epoch: 20, Steps: 13 | Train Loss: 0.215 Vali Loss: 0.587 Vali Acc: 0.698 Test Loss: 0.587 Test Acc: 0.698
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.5349583625793457
Epoch: 21, Steps: 13 | Train Loss: 0.215 Vali Loss: 0.634 Vali Acc: 0.668 Test Loss: 0.634 Test Acc: 0.668
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.7361629009246826
Epoch: 22, Steps: 13 | Train Loss: 0.215 Vali Loss: 0.591 Vali Acc: 0.727 Test Loss: 0.591 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.70904541015625
Epoch: 23, Steps: 13 | Train Loss: 0.189 Vali Loss: 0.582 Vali Acc: 0.712 Test Loss: 0.582 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 180666
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.509833097457886
Epoch: 1, Steps: 13 | Train Loss: 0.607 Vali Loss: 0.594 Vali Acc: 0.712 Test Loss: 0.594 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 4.739067554473877
Epoch: 2, Steps: 13 | Train Loss: 0.587 Vali Loss: 0.589 Vali Acc: 0.712 Test Loss: 0.589 Test Acc: 0.712
Validation loss decreased (-0.712189 --> -0.712189).  Saving model ...
Epoch: 3 cost time: 4.592450857162476
Epoch: 3, Steps: 13 | Train Loss: 0.578 Vali Loss: 0.578 Vali Acc: 0.712 Test Loss: 0.578 Test Acc: 0.712
Validation loss decreased (-0.712189 --> -0.712189).  Saving model ...
Epoch: 4 cost time: 4.794787645339966
Epoch: 4, Steps: 13 | Train Loss: 0.574 Vali Loss: 0.575 Vali Acc: 0.717 Test Loss: 0.575 Test Acc: 0.717
Validation loss decreased (-0.712189 --> -0.717067).  Saving model ...
Epoch: 5 cost time: 4.483521223068237
Epoch: 5, Steps: 13 | Train Loss: 0.507 Vali Loss: 0.563 Vali Acc: 0.732 Test Loss: 0.563 Test Acc: 0.732
Validation loss decreased (-0.717067 --> -0.731702).  Saving model ...
Epoch: 6 cost time: 4.561809301376343
Epoch: 6, Steps: 13 | Train Loss: 0.495 Vali Loss: 0.558 Vali Acc: 0.737 Test Loss: 0.558 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736580).  Saving model ...
Epoch: 7 cost time: 4.860739707946777
Epoch: 7, Steps: 13 | Train Loss: 0.472 Vali Loss: 0.548 Vali Acc: 0.751 Test Loss: 0.548 Test Acc: 0.751
Validation loss decreased (-0.736580 --> -0.751214).  Saving model ...
Epoch: 8 cost time: 5.125328302383423
Epoch: 8, Steps: 13 | Train Loss: 0.449 Vali Loss: 0.532 Vali Acc: 0.751 Test Loss: 0.532 Test Acc: 0.751
Validation loss decreased (-0.751214 --> -0.751214).  Saving model ...
Epoch: 9 cost time: 5.083330869674683
Epoch: 9, Steps: 13 | Train Loss: 0.437 Vali Loss: 0.525 Vali Acc: 0.751 Test Loss: 0.525 Test Acc: 0.751
Validation loss decreased (-0.751214 --> -0.751214).  Saving model ...
Epoch: 10 cost time: 5.153507232666016
Epoch: 10, Steps: 13 | Train Loss: 0.424 Vali Loss: 0.542 Vali Acc: 0.746 Test Loss: 0.542 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.90791654586792
Epoch: 11, Steps: 13 | Train Loss: 0.394 Vali Loss: 0.522 Vali Acc: 0.756 Test Loss: 0.522 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756092).  Saving model ...
Epoch: 12 cost time: 4.857381105422974
Epoch: 12, Steps: 13 | Train Loss: 0.378 Vali Loss: 0.588 Vali Acc: 0.654 Test Loss: 0.588 Test Acc: 0.654
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.980370283126831
Epoch: 13, Steps: 13 | Train Loss: 0.381 Vali Loss: 0.519 Vali Acc: 0.761 Test Loss: 0.519 Test Acc: 0.761
Validation loss decreased (-0.756092 --> -0.760970).  Saving model ...
Epoch: 14 cost time: 5.037474155426025
Epoch: 14, Steps: 13 | Train Loss: 0.322 Vali Loss: 0.504 Vali Acc: 0.761 Test Loss: 0.504 Test Acc: 0.761
Validation loss decreased (-0.760970 --> -0.760971).  Saving model ...
Epoch: 15 cost time: 4.989189386367798
Epoch: 15, Steps: 13 | Train Loss: 0.299 Vali Loss: 0.528 Vali Acc: 0.693 Test Loss: 0.528 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.886035680770874
Epoch: 16, Steps: 13 | Train Loss: 0.311 Vali Loss: 0.543 Vali Acc: 0.702 Test Loss: 0.543 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.684873580932617
Epoch: 17, Steps: 13 | Train Loss: 0.283 Vali Loss: 0.567 Vali Acc: 0.756 Test Loss: 0.567 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.711527585983276
Epoch: 18, Steps: 13 | Train Loss: 0.262 Vali Loss: 0.564 Vali Acc: 0.751 Test Loss: 0.564 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.544523239135742
Epoch: 19, Steps: 13 | Train Loss: 0.241 Vali Loss: 0.606 Vali Acc: 0.751 Test Loss: 0.606 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.942660808563232
Epoch: 20, Steps: 13 | Train Loss: 0.253 Vali Loss: 0.579 Vali Acc: 0.751 Test Loss: 0.579 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 5.043396472930908
Epoch: 21, Steps: 13 | Train Loss: 0.259 Vali Loss: 0.598 Vali Acc: 0.678 Test Loss: 0.598 Test Acc: 0.678
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.955215930938721
Epoch: 22, Steps: 13 | Train Loss: 0.216 Vali Loss: 0.574 Vali Acc: 0.688 Test Loss: 0.574 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.9386208057403564
Epoch: 23, Steps: 13 | Train Loss: 0.205 Vali Loss: 0.594 Vali Acc: 0.683 Test Loss: 0.594 Test Acc: 0.683
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 4.940544366836548
Epoch: 24, Steps: 13 | Train Loss: 0.163 Vali Loss: 0.602 Vali Acc: 0.722 Test Loss: 0.602 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 594682
model size : 2.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.092499494552612
Epoch: 1, Steps: 13 | Train Loss: 0.651 Vali Loss: 0.576 Vali Acc: 0.712 Test Loss: 0.576 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 3.273784875869751
Epoch: 2, Steps: 13 | Train Loss: 0.593 Vali Loss: 0.579 Vali Acc: 0.717 Test Loss: 0.579 Test Acc: 0.717
Validation loss decreased (-0.712189 --> -0.717067).  Saving model ...
Epoch: 3 cost time: 3.232283115386963
Epoch: 3, Steps: 13 | Train Loss: 0.575 Vali Loss: 0.563 Vali Acc: 0.702 Test Loss: 0.563 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.8293302059173584
Epoch: 4, Steps: 13 | Train Loss: 0.541 Vali Loss: 0.558 Vali Acc: 0.707 Test Loss: 0.558 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.110525369644165
Epoch: 5, Steps: 13 | Train Loss: 0.524 Vali Loss: 0.554 Vali Acc: 0.702 Test Loss: 0.554 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.1233785152435303
Epoch: 6, Steps: 13 | Train Loss: 0.489 Vali Loss: 0.564 Vali Acc: 0.727 Test Loss: 0.564 Test Acc: 0.727
Validation loss decreased (-0.717067 --> -0.726824).  Saving model ...
Epoch: 7 cost time: 3.0892839431762695
Epoch: 7, Steps: 13 | Train Loss: 0.469 Vali Loss: 0.554 Vali Acc: 0.707 Test Loss: 0.554 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.0898828506469727
Epoch: 8, Steps: 13 | Train Loss: 0.467 Vali Loss: 0.545 Vali Acc: 0.737 Test Loss: 0.545 Test Acc: 0.737
Validation loss decreased (-0.726824 --> -0.736580).  Saving model ...
Epoch: 9 cost time: 3.104388952255249
Epoch: 9, Steps: 13 | Train Loss: 0.419 Vali Loss: 0.537 Vali Acc: 0.712 Test Loss: 0.537 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.2266581058502197
Epoch: 10, Steps: 13 | Train Loss: 0.401 Vali Loss: 0.572 Vali Acc: 0.732 Test Loss: 0.572 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.2429721355438232
Epoch: 11, Steps: 13 | Train Loss: 0.405 Vali Loss: 0.537 Vali Acc: 0.717 Test Loss: 0.537 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.2893667221069336
Epoch: 12, Steps: 13 | Train Loss: 0.366 Vali Loss: 0.540 Vali Acc: 0.746 Test Loss: 0.540 Test Acc: 0.746
Validation loss decreased (-0.736580 --> -0.746336).  Saving model ...
Epoch: 13 cost time: 3.209202289581299
Epoch: 13, Steps: 13 | Train Loss: 0.341 Vali Loss: 0.545 Vali Acc: 0.751 Test Loss: 0.545 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751214).  Saving model ...
Epoch: 14 cost time: 3.3511269092559814
Epoch: 14, Steps: 13 | Train Loss: 0.333 Vali Loss: 0.537 Vali Acc: 0.741 Test Loss: 0.537 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.351006507873535
Epoch: 15, Steps: 13 | Train Loss: 0.331 Vali Loss: 0.574 Vali Acc: 0.746 Test Loss: 0.574 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.3655340671539307
Epoch: 16, Steps: 13 | Train Loss: 0.324 Vali Loss: 0.541 Vali Acc: 0.746 Test Loss: 0.541 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.3662211894989014
Epoch: 17, Steps: 13 | Train Loss: 0.280 Vali Loss: 0.605 Vali Acc: 0.673 Test Loss: 0.605 Test Acc: 0.673
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.181577444076538
Epoch: 18, Steps: 13 | Train Loss: 0.283 Vali Loss: 0.557 Vali Acc: 0.732 Test Loss: 0.557 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.248246669769287
Epoch: 19, Steps: 13 | Train Loss: 0.252 Vali Loss: 0.572 Vali Acc: 0.688 Test Loss: 0.572 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.137640953063965
Epoch: 20, Steps: 13 | Train Loss: 0.226 Vali Loss: 0.564 Vali Acc: 0.737 Test Loss: 0.564 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.7681174278259277
Epoch: 21, Steps: 13 | Train Loss: 0.199 Vali Loss: 0.622 Vali Acc: 0.659 Test Loss: 0.622 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.9496610164642334
Epoch: 22, Steps: 13 | Train Loss: 0.195 Vali Loss: 0.570 Vali Acc: 0.737 Test Loss: 0.570 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.8730297088623047
Epoch: 23, Steps: 13 | Train Loss: 0.181 Vali Loss: 0.583 Vali Acc: 0.712 Test Loss: 0.583 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 180666
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.988231897354126
Epoch: 1, Steps: 13 | Train Loss: 0.607 Vali Loss: 0.592 Vali Acc: 0.712 Test Loss: 0.592 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 3.133817434310913
Epoch: 2, Steps: 13 | Train Loss: 0.589 Vali Loss: 0.583 Vali Acc: 0.712 Test Loss: 0.583 Test Acc: 0.712
Validation loss decreased (-0.712189 --> -0.712189).  Saving model ...
Epoch: 3 cost time: 3.512627601623535
Epoch: 3, Steps: 13 | Train Loss: 0.581 Vali Loss: 0.570 Vali Acc: 0.712 Test Loss: 0.570 Test Acc: 0.712
Validation loss decreased (-0.712189 --> -0.712189).  Saving model ...
Epoch: 4 cost time: 3.4576423168182373
Epoch: 4, Steps: 13 | Train Loss: 0.582 Vali Loss: 0.566 Vali Acc: 0.722 Test Loss: 0.566 Test Acc: 0.722
Validation loss decreased (-0.712189 --> -0.721946).  Saving model ...
Epoch: 5 cost time: 3.4970293045043945
Epoch: 5, Steps: 13 | Train Loss: 0.521 Vali Loss: 0.574 Vali Acc: 0.727 Test Loss: 0.574 Test Acc: 0.727
Validation loss decreased (-0.721946 --> -0.726824).  Saving model ...
Epoch: 6 cost time: 3.4066524505615234
Epoch: 6, Steps: 13 | Train Loss: 0.512 Vali Loss: 0.576 Vali Acc: 0.737 Test Loss: 0.576 Test Acc: 0.737
Validation loss decreased (-0.726824 --> -0.736580).  Saving model ...
Epoch: 7 cost time: 3.392943859100342
Epoch: 7, Steps: 13 | Train Loss: 0.485 Vali Loss: 0.580 Vali Acc: 0.737 Test Loss: 0.580 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.4386396408081055
Epoch: 8, Steps: 13 | Train Loss: 0.470 Vali Loss: 0.565 Vali Acc: 0.746 Test Loss: 0.565 Test Acc: 0.746
Validation loss decreased (-0.736580 --> -0.746336).  Saving model ...
Epoch: 9 cost time: 3.3912057876586914
Epoch: 9, Steps: 13 | Train Loss: 0.435 Vali Loss: 0.602 Vali Acc: 0.741 Test Loss: 0.602 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.266747236251831
Epoch: 10, Steps: 13 | Train Loss: 0.463 Vali Loss: 0.514 Vali Acc: 0.761 Test Loss: 0.514 Test Acc: 0.761
Validation loss decreased (-0.746336 --> -0.760970).  Saving model ...
Epoch: 11 cost time: 3.448383092880249
Epoch: 11, Steps: 13 | Train Loss: 0.406 Vali Loss: 0.500 Vali Acc: 0.776 Test Loss: 0.500 Test Acc: 0.776
Validation loss decreased (-0.760970 --> -0.775605).  Saving model ...
Epoch: 12 cost time: 3.3243443965911865
Epoch: 12, Steps: 13 | Train Loss: 0.417 Vali Loss: 0.574 Vali Acc: 0.707 Test Loss: 0.574 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.26757550239563
Epoch: 13, Steps: 13 | Train Loss: 0.379 Vali Loss: 0.522 Vali Acc: 0.741 Test Loss: 0.522 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.213503360748291
Epoch: 14, Steps: 13 | Train Loss: 0.349 Vali Loss: 0.433 Vali Acc: 0.815 Test Loss: 0.433 Test Acc: 0.815
Validation loss decreased (-0.775605 --> -0.814630).  Saving model ...
Epoch: 15 cost time: 2.792590856552124
Epoch: 15, Steps: 13 | Train Loss: 0.364 Vali Loss: 0.543 Vali Acc: 0.741 Test Loss: 0.543 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.121152877807617
Epoch: 16, Steps: 13 | Train Loss: 0.342 Vali Loss: 0.530 Vali Acc: 0.751 Test Loss: 0.530 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.1140565872192383
Epoch: 17, Steps: 13 | Train Loss: 0.322 Vali Loss: 0.540 Vali Acc: 0.741 Test Loss: 0.540 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.3569464683532715
Epoch: 18, Steps: 13 | Train Loss: 0.290 Vali Loss: 0.522 Vali Acc: 0.766 Test Loss: 0.522 Test Acc: 0.766
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.399345874786377
Epoch: 19, Steps: 13 | Train Loss: 0.252 Vali Loss: 0.558 Vali Acc: 0.746 Test Loss: 0.558 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.3754873275756836
Epoch: 20, Steps: 13 | Train Loss: 0.244 Vali Loss: 0.564 Vali Acc: 0.766 Test Loss: 0.564 Test Acc: 0.766
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.289344549179077
Epoch: 21, Steps: 13 | Train Loss: 0.224 Vali Loss: 0.619 Vali Acc: 0.751 Test Loss: 0.619 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.1688778400421143
Epoch: 22, Steps: 13 | Train Loss: 0.231 Vali Loss: 0.676 Vali Acc: 0.649 Test Loss: 0.676 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.1680192947387695
Epoch: 23, Steps: 13 | Train Loss: 0.197 Vali Loss: 0.518 Vali Acc: 0.761 Test Loss: 0.518 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.0321104526519775
Epoch: 24, Steps: 13 | Train Loss: 0.161 Vali Loss: 0.570 Vali Acc: 0.776 Test Loss: 0.570 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.8146341463414634
model parameter : 594682
model size : 2.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.103593111038208
Epoch: 1, Steps: 13 | Train Loss: 0.653 Vali Loss: 0.576 Vali Acc: 0.707 Test Loss: 0.576 Test Acc: 0.707
Validation loss decreased (inf --> -0.707311).  Saving model ...
Epoch: 2 cost time: 2.3696699142456055
Epoch: 2, Steps: 13 | Train Loss: 0.597 Vali Loss: 0.582 Vali Acc: 0.717 Test Loss: 0.582 Test Acc: 0.717
Validation loss decreased (-0.707311 --> -0.717067).  Saving model ...
Epoch: 3 cost time: 2.4138031005859375
Epoch: 3, Steps: 13 | Train Loss: 0.580 Vali Loss: 0.566 Vali Acc: 0.702 Test Loss: 0.566 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9762353897094727
Epoch: 4, Steps: 13 | Train Loss: 0.548 Vali Loss: 0.554 Vali Acc: 0.707 Test Loss: 0.554 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.2540621757507324
Epoch: 5, Steps: 13 | Train Loss: 0.530 Vali Loss: 0.544 Vali Acc: 0.712 Test Loss: 0.544 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.0333080291748047
Epoch: 6, Steps: 13 | Train Loss: 0.501 Vali Loss: 0.543 Vali Acc: 0.766 Test Loss: 0.543 Test Acc: 0.766
Validation loss decreased (-0.717067 --> -0.765848).  Saving model ...
Epoch: 7 cost time: 2.3227858543395996
Epoch: 7, Steps: 13 | Train Loss: 0.490 Vali Loss: 0.514 Vali Acc: 0.717 Test Loss: 0.514 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.302639961242676
Epoch: 8, Steps: 13 | Train Loss: 0.470 Vali Loss: 0.506 Vali Acc: 0.780 Test Loss: 0.506 Test Acc: 0.780
Validation loss decreased (-0.765848 --> -0.780483).  Saving model ...
Epoch: 9 cost time: 2.3311352729797363
Epoch: 9, Steps: 13 | Train Loss: 0.454 Vali Loss: 0.508 Vali Acc: 0.756 Test Loss: 0.508 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.4828720092773438
Epoch: 10, Steps: 13 | Train Loss: 0.437 Vali Loss: 0.542 Vali Acc: 0.737 Test Loss: 0.542 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.3482186794281006
Epoch: 11, Steps: 13 | Train Loss: 0.406 Vali Loss: 0.574 Vali Acc: 0.717 Test Loss: 0.574 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.4090981483459473
Epoch: 12, Steps: 13 | Train Loss: 0.395 Vali Loss: 0.585 Vali Acc: 0.707 Test Loss: 0.585 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.20162296295166
Epoch: 13, Steps: 13 | Train Loss: 0.365 Vali Loss: 0.591 Vali Acc: 0.737 Test Loss: 0.591 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.3833887577056885
Epoch: 14, Steps: 13 | Train Loss: 0.375 Vali Loss: 0.594 Vali Acc: 0.688 Test Loss: 0.594 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.500774621963501
Epoch: 15, Steps: 13 | Train Loss: 0.383 Vali Loss: 0.628 Vali Acc: 0.727 Test Loss: 0.628 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.5730361938476562
Epoch: 16, Steps: 13 | Train Loss: 0.360 Vali Loss: 0.514 Vali Acc: 0.741 Test Loss: 0.514 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.4919540882110596
Epoch: 17, Steps: 13 | Train Loss: 0.323 Vali Loss: 0.646 Vali Acc: 0.678 Test Loss: 0.646 Test Acc: 0.678
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.4796385765075684
Epoch: 18, Steps: 13 | Train Loss: 0.316 Vali Loss: 0.570 Vali Acc: 0.741 Test Loss: 0.570 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7804878048780488
model parameter : 180666
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.10551905632019
Epoch: 1, Steps: 13 | Train Loss: 0.689 Vali Loss: 0.604 Vali Acc: 0.717 Test Loss: 0.604 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 5.292697191238403
Epoch: 2, Steps: 13 | Train Loss: 0.586 Vali Loss: 0.607 Vali Acc: 0.712 Test Loss: 0.607 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.272507905960083
Epoch: 3, Steps: 13 | Train Loss: 0.565 Vali Loss: 0.569 Vali Acc: 0.712 Test Loss: 0.569 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.210305213928223
Epoch: 4, Steps: 13 | Train Loss: 0.545 Vali Loss: 0.555 Vali Acc: 0.737 Test Loss: 0.555 Test Acc: 0.737
Validation loss decreased (-0.717067 --> -0.736580).  Saving model ...
Epoch: 5 cost time: 5.329701662063599
Epoch: 5, Steps: 13 | Train Loss: 0.504 Vali Loss: 0.541 Vali Acc: 0.741 Test Loss: 0.541 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741458).  Saving model ...
Epoch: 6 cost time: 5.42831563949585
Epoch: 6, Steps: 13 | Train Loss: 0.486 Vali Loss: 0.527 Vali Acc: 0.751 Test Loss: 0.527 Test Acc: 0.751
Validation loss decreased (-0.741458 --> -0.751214).  Saving model ...
Epoch: 7 cost time: 5.611232042312622
Epoch: 7, Steps: 13 | Train Loss: 0.466 Vali Loss: 0.536 Vali Acc: 0.756 Test Loss: 0.536 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756092).  Saving model ...
Epoch: 8 cost time: 5.570263147354126
Epoch: 8, Steps: 13 | Train Loss: 0.440 Vali Loss: 0.524 Vali Acc: 0.766 Test Loss: 0.524 Test Acc: 0.766
Validation loss decreased (-0.756092 --> -0.765848).  Saving model ...
Epoch: 9 cost time: 5.6212263107299805
Epoch: 9, Steps: 13 | Train Loss: 0.426 Vali Loss: 0.529 Vali Acc: 0.751 Test Loss: 0.529 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.5003674030303955
Epoch: 10, Steps: 13 | Train Loss: 0.408 Vali Loss: 0.526 Vali Acc: 0.785 Test Loss: 0.526 Test Acc: 0.785
Validation loss decreased (-0.765848 --> -0.785361).  Saving model ...
Epoch: 11 cost time: 5.495492935180664
Epoch: 11, Steps: 13 | Train Loss: 0.398 Vali Loss: 0.534 Vali Acc: 0.785 Test Loss: 0.534 Test Acc: 0.785
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.552547216415405
Epoch: 12, Steps: 13 | Train Loss: 0.387 Vali Loss: 0.557 Vali Acc: 0.766 Test Loss: 0.557 Test Acc: 0.766
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.266218423843384
Epoch: 13, Steps: 13 | Train Loss: 0.361 Vali Loss: 0.536 Vali Acc: 0.766 Test Loss: 0.536 Test Acc: 0.766
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.162755966186523
Epoch: 14, Steps: 13 | Train Loss: 0.348 Vali Loss: 0.564 Vali Acc: 0.756 Test Loss: 0.564 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.056760787963867
Epoch: 15, Steps: 13 | Train Loss: 0.331 Vali Loss: 0.550 Vali Acc: 0.727 Test Loss: 0.550 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.163405179977417
Epoch: 16, Steps: 13 | Train Loss: 0.308 Vali Loss: 0.559 Vali Acc: 0.751 Test Loss: 0.559 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 5.599560499191284
Epoch: 17, Steps: 13 | Train Loss: 0.293 Vali Loss: 0.569 Vali Acc: 0.761 Test Loss: 0.569 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 5.6558287143707275
Epoch: 18, Steps: 13 | Train Loss: 0.285 Vali Loss: 0.572 Vali Acc: 0.746 Test Loss: 0.572 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 5.558637380599976
Epoch: 19, Steps: 13 | Train Loss: 0.248 Vali Loss: 0.569 Vali Acc: 0.722 Test Loss: 0.569 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.964559555053711
Epoch: 20, Steps: 13 | Train Loss: 0.238 Vali Loss: 0.610 Vali Acc: 0.702 Test Loss: 0.610 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7853658536585366
model parameter : 301434
model size : 1.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.043137311935425
Epoch: 1, Steps: 13 | Train Loss: 0.608 Vali Loss: 0.582 Vali Acc: 0.712 Test Loss: 0.582 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 1.9841504096984863
Epoch: 2, Steps: 13 | Train Loss: 0.598 Vali Loss: 0.565 Vali Acc: 0.712 Test Loss: 0.565 Test Acc: 0.712
Validation loss decreased (-0.712189 --> -0.712189).  Saving model ...
Epoch: 3 cost time: 3.0912997722625732
Epoch: 3, Steps: 13 | Train Loss: 0.574 Vali Loss: 0.550 Vali Acc: 0.727 Test Loss: 0.550 Test Acc: 0.727
Validation loss decreased (-0.712189 --> -0.726824).  Saving model ...
Epoch: 4 cost time: 3.231459856033325
Epoch: 4, Steps: 13 | Train Loss: 0.528 Vali Loss: 0.538 Vali Acc: 0.737 Test Loss: 0.538 Test Acc: 0.737
Validation loss decreased (-0.726824 --> -0.736580).  Saving model ...
Epoch: 5 cost time: 3.1894984245300293
Epoch: 5, Steps: 13 | Train Loss: 0.499 Vali Loss: 0.533 Vali Acc: 0.751 Test Loss: 0.533 Test Acc: 0.751
Validation loss decreased (-0.736580 --> -0.751214).  Saving model ...
Epoch: 6 cost time: 3.246466875076294
Epoch: 6, Steps: 13 | Train Loss: 0.470 Vali Loss: 0.545 Vali Acc: 0.727 Test Loss: 0.545 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.4189655780792236
Epoch: 7, Steps: 13 | Train Loss: 0.465 Vali Loss: 0.535 Vali Acc: 0.751 Test Loss: 0.535 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.401768684387207
Epoch: 8, Steps: 13 | Train Loss: 0.457 Vali Loss: 0.546 Vali Acc: 0.717 Test Loss: 0.546 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.3736813068389893
Epoch: 9, Steps: 13 | Train Loss: 0.462 Vali Loss: 0.531 Vali Acc: 0.741 Test Loss: 0.531 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.4147558212280273
Epoch: 10, Steps: 13 | Train Loss: 0.392 Vali Loss: 0.584 Vali Acc: 0.654 Test Loss: 0.584 Test Acc: 0.654
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.390742778778076
Epoch: 11, Steps: 13 | Train Loss: 0.392 Vali Loss: 0.547 Vali Acc: 0.727 Test Loss: 0.547 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.416872978210449
Epoch: 12, Steps: 13 | Train Loss: 0.382 Vali Loss: 0.573 Vali Acc: 0.649 Test Loss: 0.573 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.410374641418457
Epoch: 13, Steps: 13 | Train Loss: 0.363 Vali Loss: 0.565 Vali Acc: 0.771 Test Loss: 0.565 Test Acc: 0.771
Validation loss decreased (-0.751214 --> -0.770726).  Saving model ...
Epoch: 14 cost time: 3.426025390625
Epoch: 14, Steps: 13 | Train Loss: 0.322 Vali Loss: 0.586 Vali Acc: 0.654 Test Loss: 0.586 Test Acc: 0.654
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.4678964614868164
Epoch: 15, Steps: 13 | Train Loss: 0.314 Vali Loss: 0.600 Vali Acc: 0.683 Test Loss: 0.600 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.440117835998535
Epoch: 16, Steps: 13 | Train Loss: 0.301 Vali Loss: 0.574 Vali Acc: 0.746 Test Loss: 0.574 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.232372760772705
Epoch: 17, Steps: 13 | Train Loss: 0.277 Vali Loss: 0.634 Vali Acc: 0.620 Test Loss: 0.634 Test Acc: 0.620
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.1537768840789795
Epoch: 18, Steps: 13 | Train Loss: 0.264 Vali Loss: 0.602 Vali Acc: 0.732 Test Loss: 0.602 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.1873180866241455
Epoch: 19, Steps: 13 | Train Loss: 0.239 Vali Loss: 0.623 Vali Acc: 0.712 Test Loss: 0.623 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.9439280033111572
Epoch: 20, Steps: 13 | Train Loss: 0.229 Vali Loss: 0.708 Vali Acc: 0.654 Test Loss: 0.708 Test Acc: 0.654
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.2509946823120117
Epoch: 21, Steps: 13 | Train Loss: 0.230 Vali Loss: 0.704 Vali Acc: 0.620 Test Loss: 0.704 Test Acc: 0.620
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.404672145843506
Epoch: 22, Steps: 13 | Train Loss: 0.231 Vali Loss: 0.702 Vali Acc: 0.776 Test Loss: 0.702 Test Acc: 0.776
Validation loss decreased (-0.770726 --> -0.775603).  Saving model ...
Epoch: 23 cost time: 3.4203901290893555
Epoch: 23, Steps: 13 | Train Loss: 0.237 Vali Loss: 0.640 Vali Acc: 0.678 Test Loss: 0.640 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.263430595397949
Epoch: 24, Steps: 13 | Train Loss: 0.195 Vali Loss: 0.689 Vali Acc: 0.624 Test Loss: 0.689 Test Acc: 0.624
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.435810089111328
Epoch: 25, Steps: 13 | Train Loss: 0.169 Vali Loss: 0.664 Vali Acc: 0.712 Test Loss: 0.664 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.4756510257720947
Epoch: 26, Steps: 13 | Train Loss: 0.159 Vali Loss: 0.698 Vali Acc: 0.668 Test Loss: 0.698 Test Acc: 0.668
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.3049545288085938
Epoch: 27, Steps: 13 | Train Loss: 0.167 Vali Loss: 0.696 Vali Acc: 0.683 Test Loss: 0.696 Test Acc: 0.683
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.442750930786133
Epoch: 28, Steps: 13 | Train Loss: 0.136 Vali Loss: 0.743 Vali Acc: 0.644 Test Loss: 0.743 Test Acc: 0.644
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.306088447570801
Epoch: 29, Steps: 13 | Train Loss: 0.125 Vali Loss: 0.733 Vali Acc: 0.639 Test Loss: 0.733 Test Acc: 0.639
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.524904727935791
Epoch: 30, Steps: 13 | Train Loss: 0.125 Vali Loss: 0.755 Vali Acc: 0.654 Test Loss: 0.755 Test Acc: 0.654
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 94394
model size : 0.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.9008190631866455
Epoch: 1, Steps: 13 | Train Loss: 0.689 Vali Loss: 0.604 Vali Acc: 0.717 Test Loss: 0.604 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 4.16666316986084
Epoch: 2, Steps: 13 | Train Loss: 0.587 Vali Loss: 0.606 Vali Acc: 0.712 Test Loss: 0.606 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.215594530105591
Epoch: 3, Steps: 13 | Train Loss: 0.566 Vali Loss: 0.569 Vali Acc: 0.712 Test Loss: 0.569 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.445679426193237
Epoch: 4, Steps: 13 | Train Loss: 0.548 Vali Loss: 0.556 Vali Acc: 0.727 Test Loss: 0.556 Test Acc: 0.727
Validation loss decreased (-0.717067 --> -0.726824).  Saving model ...
Epoch: 5 cost time: 4.198930263519287
Epoch: 5, Steps: 13 | Train Loss: 0.507 Vali Loss: 0.541 Vali Acc: 0.741 Test Loss: 0.541 Test Acc: 0.741
Validation loss decreased (-0.726824 --> -0.741458).  Saving model ...
Epoch: 6 cost time: 4.535536289215088
Epoch: 6, Steps: 13 | Train Loss: 0.495 Vali Loss: 0.530 Vali Acc: 0.741 Test Loss: 0.530 Test Acc: 0.741
Validation loss decreased (-0.741458 --> -0.741458).  Saving model ...
Epoch: 7 cost time: 4.495223045349121
Epoch: 7, Steps: 13 | Train Loss: 0.467 Vali Loss: 0.528 Vali Acc: 0.751 Test Loss: 0.528 Test Acc: 0.751
Validation loss decreased (-0.741458 --> -0.751214).  Saving model ...
Epoch: 8 cost time: 4.612347841262817
Epoch: 8, Steps: 13 | Train Loss: 0.447 Vali Loss: 0.530 Vali Acc: 0.751 Test Loss: 0.530 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.580407381057739
Epoch: 9, Steps: 13 | Train Loss: 0.428 Vali Loss: 0.539 Vali Acc: 0.746 Test Loss: 0.539 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.4376420974731445
Epoch: 10, Steps: 13 | Train Loss: 0.412 Vali Loss: 0.535 Vali Acc: 0.761 Test Loss: 0.535 Test Acc: 0.761
Validation loss decreased (-0.751214 --> -0.760970).  Saving model ...
Epoch: 11 cost time: 4.44959282875061
Epoch: 11, Steps: 13 | Train Loss: 0.398 Vali Loss: 0.557 Vali Acc: 0.776 Test Loss: 0.557 Test Acc: 0.776
Validation loss decreased (-0.760970 --> -0.775604).  Saving model ...
Epoch: 12 cost time: 4.358585357666016
Epoch: 12, Steps: 13 | Train Loss: 0.391 Vali Loss: 0.572 Vali Acc: 0.766 Test Loss: 0.572 Test Acc: 0.766
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.9596049785614014
Epoch: 13, Steps: 13 | Train Loss: 0.349 Vali Loss: 0.555 Vali Acc: 0.776 Test Loss: 0.555 Test Acc: 0.776
Validation loss decreased (-0.775604 --> -0.775604).  Saving model ...
Epoch: 14 cost time: 4.181865692138672
Epoch: 14, Steps: 13 | Train Loss: 0.345 Vali Loss: 0.621 Vali Acc: 0.766 Test Loss: 0.621 Test Acc: 0.766
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.305507183074951
Epoch: 15, Steps: 13 | Train Loss: 0.336 Vali Loss: 0.565 Vali Acc: 0.732 Test Loss: 0.565 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.328657865524292
Epoch: 16, Steps: 13 | Train Loss: 0.298 Vali Loss: 0.609 Vali Acc: 0.751 Test Loss: 0.609 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.265534162521362
Epoch: 17, Steps: 13 | Train Loss: 0.288 Vali Loss: 0.658 Vali Acc: 0.751 Test Loss: 0.658 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.475749969482422
Epoch: 18, Steps: 13 | Train Loss: 0.283 Vali Loss: 0.592 Vali Acc: 0.766 Test Loss: 0.592 Test Acc: 0.766
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.464752674102783
Epoch: 19, Steps: 13 | Train Loss: 0.242 Vali Loss: 0.577 Vali Acc: 0.712 Test Loss: 0.577 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.41306209564209
Epoch: 20, Steps: 13 | Train Loss: 0.240 Vali Loss: 0.637 Vali Acc: 0.698 Test Loss: 0.637 Test Acc: 0.698
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.506275177001953
Epoch: 21, Steps: 13 | Train Loss: 0.224 Vali Loss: 0.621 Vali Acc: 0.707 Test Loss: 0.621 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.443472385406494
Epoch: 22, Steps: 13 | Train Loss: 0.225 Vali Loss: 0.670 Vali Acc: 0.712 Test Loss: 0.670 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.48211407661438
Epoch: 23, Steps: 13 | Train Loss: 0.172 Vali Loss: 0.644 Vali Acc: 0.717 Test Loss: 0.644 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 301434
model size : 1.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.818381071090698
Epoch: 1, Steps: 13 | Train Loss: 0.608 Vali Loss: 0.582 Vali Acc: 0.717 Test Loss: 0.582 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 2.9922659397125244
Epoch: 2, Steps: 13 | Train Loss: 0.599 Vali Loss: 0.565 Vali Acc: 0.717 Test Loss: 0.565 Test Acc: 0.717
Validation loss decreased (-0.717067 --> -0.717068).  Saving model ...
Epoch: 3 cost time: 2.805570602416992
Epoch: 3, Steps: 13 | Train Loss: 0.575 Vali Loss: 0.548 Vali Acc: 0.732 Test Loss: 0.548 Test Acc: 0.732
Validation loss decreased (-0.717068 --> -0.731702).  Saving model ...
Epoch: 4 cost time: 2.8487415313720703
Epoch: 4, Steps: 13 | Train Loss: 0.527 Vali Loss: 0.536 Vali Acc: 0.746 Test Loss: 0.536 Test Acc: 0.746
Validation loss decreased (-0.731702 --> -0.746336).  Saving model ...
Epoch: 5 cost time: 2.818349838256836
Epoch: 5, Steps: 13 | Train Loss: 0.500 Vali Loss: 0.529 Vali Acc: 0.756 Test Loss: 0.529 Test Acc: 0.756
Validation loss decreased (-0.746336 --> -0.756092).  Saving model ...
Epoch: 6 cost time: 2.643098831176758
Epoch: 6, Steps: 13 | Train Loss: 0.474 Vali Loss: 0.535 Vali Acc: 0.741 Test Loss: 0.535 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.8562960624694824
Epoch: 7, Steps: 13 | Train Loss: 0.472 Vali Loss: 0.522 Vali Acc: 0.761 Test Loss: 0.522 Test Acc: 0.761
Validation loss decreased (-0.756092 --> -0.760970).  Saving model ...
Epoch: 8 cost time: 2.940002679824829
Epoch: 8, Steps: 13 | Train Loss: 0.466 Vali Loss: 0.535 Vali Acc: 0.732 Test Loss: 0.535 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.151960849761963
Epoch: 9, Steps: 13 | Train Loss: 0.466 Vali Loss: 0.518 Vali Acc: 0.756 Test Loss: 0.518 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.0049524307250977
Epoch: 10, Steps: 13 | Train Loss: 0.405 Vali Loss: 0.558 Vali Acc: 0.678 Test Loss: 0.558 Test Acc: 0.678
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.955477237701416
Epoch: 11, Steps: 13 | Train Loss: 0.412 Vali Loss: 0.522 Vali Acc: 0.732 Test Loss: 0.522 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.9176437854766846
Epoch: 12, Steps: 13 | Train Loss: 0.375 Vali Loss: 0.564 Vali Acc: 0.663 Test Loss: 0.564 Test Acc: 0.663
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.971189260482788
Epoch: 13, Steps: 13 | Train Loss: 0.349 Vali Loss: 0.567 Vali Acc: 0.776 Test Loss: 0.567 Test Acc: 0.776
Validation loss decreased (-0.760970 --> -0.775604).  Saving model ...
Epoch: 14 cost time: 2.6175429821014404
Epoch: 14, Steps: 13 | Train Loss: 0.325 Vali Loss: 0.592 Vali Acc: 0.678 Test Loss: 0.592 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.8692078590393066
Epoch: 15, Steps: 13 | Train Loss: 0.308 Vali Loss: 0.587 Vali Acc: 0.698 Test Loss: 0.587 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.9749808311462402
Epoch: 16, Steps: 13 | Train Loss: 0.298 Vali Loss: 0.564 Vali Acc: 0.746 Test Loss: 0.564 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.0119893550872803
Epoch: 17, Steps: 13 | Train Loss: 0.280 Vali Loss: 0.650 Vali Acc: 0.639 Test Loss: 0.650 Test Acc: 0.639
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.9276154041290283
Epoch: 18, Steps: 13 | Train Loss: 0.266 Vali Loss: 0.638 Vali Acc: 0.732 Test Loss: 0.638 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.936108350753784
Epoch: 19, Steps: 13 | Train Loss: 0.240 Vali Loss: 0.621 Vali Acc: 0.702 Test Loss: 0.621 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.023656129837036
Epoch: 20, Steps: 13 | Train Loss: 0.230 Vali Loss: 0.729 Vali Acc: 0.678 Test Loss: 0.729 Test Acc: 0.678
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.754232168197632
Epoch: 21, Steps: 13 | Train Loss: 0.245 Vali Loss: 0.825 Vali Acc: 0.585 Test Loss: 0.825 Test Acc: 0.585
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.7236580848693848
Epoch: 22, Steps: 13 | Train Loss: 0.279 Vali Loss: 0.746 Vali Acc: 0.780 Test Loss: 0.746 Test Acc: 0.780
Validation loss decreased (-0.775604 --> -0.780480).  Saving model ...
Epoch: 23 cost time: 2.7517597675323486
Epoch: 23, Steps: 13 | Train Loss: 0.243 Vali Loss: 0.682 Vali Acc: 0.634 Test Loss: 0.682 Test Acc: 0.634
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.7330591678619385
Epoch: 24, Steps: 13 | Train Loss: 0.208 Vali Loss: 0.635 Vali Acc: 0.668 Test Loss: 0.635 Test Acc: 0.668
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.7896196842193604
Epoch: 25, Steps: 13 | Train Loss: 0.177 Vali Loss: 0.652 Vali Acc: 0.717 Test Loss: 0.652 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.9804580211639404
Epoch: 26, Steps: 13 | Train Loss: 0.167 Vali Loss: 0.684 Vali Acc: 0.678 Test Loss: 0.684 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.1736977100372314
Epoch: 27, Steps: 13 | Train Loss: 0.163 Vali Loss: 0.661 Vali Acc: 0.673 Test Loss: 0.661 Test Acc: 0.673
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.1069586277008057
Epoch: 28, Steps: 13 | Train Loss: 0.139 Vali Loss: 0.706 Vali Acc: 0.688 Test Loss: 0.706 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.0472311973571777
Epoch: 29, Steps: 13 | Train Loss: 0.141 Vali Loss: 0.693 Vali Acc: 0.683 Test Loss: 0.693 Test Acc: 0.683
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.0204005241394043
Epoch: 30, Steps: 13 | Train Loss: 0.127 Vali Loss: 0.706 Vali Acc: 0.683 Test Loss: 0.706 Test Acc: 0.683
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7804878048780488
model parameter : 94394
model size : 0.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.026431322097778
Epoch: 1, Steps: 13 | Train Loss: 0.686 Vali Loss: 0.603 Vali Acc: 0.717 Test Loss: 0.603 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 3.329500675201416
Epoch: 2, Steps: 13 | Train Loss: 0.585 Vali Loss: 0.603 Vali Acc: 0.717 Test Loss: 0.603 Test Acc: 0.717
Validation loss decreased (-0.717067 --> -0.717067).  Saving model ...
Epoch: 3 cost time: 3.3266096115112305
Epoch: 3, Steps: 13 | Train Loss: 0.565 Vali Loss: 0.564 Vali Acc: 0.717 Test Loss: 0.564 Test Acc: 0.717
Validation loss decreased (-0.717067 --> -0.717068).  Saving model ...
Epoch: 4 cost time: 3.037905693054199
Epoch: 4, Steps: 13 | Train Loss: 0.548 Vali Loss: 0.543 Vali Acc: 0.737 Test Loss: 0.543 Test Acc: 0.737
Validation loss decreased (-0.717068 --> -0.736580).  Saving model ...
Epoch: 5 cost time: 3.3455703258514404
Epoch: 5, Steps: 13 | Train Loss: 0.512 Vali Loss: 0.532 Vali Acc: 0.746 Test Loss: 0.532 Test Acc: 0.746
Validation loss decreased (-0.736580 --> -0.746336).  Saving model ...
Epoch: 6 cost time: 3.186767339706421
Epoch: 6, Steps: 13 | Train Loss: 0.497 Vali Loss: 0.517 Vali Acc: 0.751 Test Loss: 0.517 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751214).  Saving model ...
Epoch: 7 cost time: 3.1161305904388428
Epoch: 7, Steps: 13 | Train Loss: 0.473 Vali Loss: 0.520 Vali Acc: 0.751 Test Loss: 0.520 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.133740186691284
Epoch: 8, Steps: 13 | Train Loss: 0.453 Vali Loss: 0.518 Vali Acc: 0.751 Test Loss: 0.518 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.2054615020751953
Epoch: 9, Steps: 13 | Train Loss: 0.436 Vali Loss: 0.592 Vali Acc: 0.732 Test Loss: 0.592 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.0552024841308594
Epoch: 10, Steps: 13 | Train Loss: 0.427 Vali Loss: 0.631 Vali Acc: 0.737 Test Loss: 0.631 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.245925188064575
Epoch: 11, Steps: 13 | Train Loss: 0.423 Vali Loss: 0.593 Vali Acc: 0.683 Test Loss: 0.593 Test Acc: 0.683
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.3222873210906982
Epoch: 12, Steps: 13 | Train Loss: 0.412 Vali Loss: 0.649 Vali Acc: 0.727 Test Loss: 0.649 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.2714569568634033
Epoch: 13, Steps: 13 | Train Loss: 0.373 Vali Loss: 0.547 Vali Acc: 0.732 Test Loss: 0.547 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.173431873321533
Epoch: 14, Steps: 13 | Train Loss: 0.371 Vali Loss: 0.556 Vali Acc: 0.771 Test Loss: 0.556 Test Acc: 0.771
Validation loss decreased (-0.751214 --> -0.770726).  Saving model ...
Epoch: 15 cost time: 3.3464033603668213
Epoch: 15, Steps: 13 | Train Loss: 0.354 Vali Loss: 0.556 Vali Acc: 0.707 Test Loss: 0.556 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.301331043243408
Epoch: 16, Steps: 13 | Train Loss: 0.338 Vali Loss: 0.530 Vali Acc: 0.776 Test Loss: 0.530 Test Acc: 0.776
Validation loss decreased (-0.770726 --> -0.775604).  Saving model ...
Epoch: 17 cost time: 3.3204104900360107
Epoch: 17, Steps: 13 | Train Loss: 0.321 Vali Loss: 0.505 Vali Acc: 0.780 Test Loss: 0.505 Test Acc: 0.780
Validation loss decreased (-0.775604 --> -0.780483).  Saving model ...
Epoch: 18 cost time: 3.300807476043701
Epoch: 18, Steps: 13 | Train Loss: 0.311 Vali Loss: 0.570 Vali Acc: 0.756 Test Loss: 0.570 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.3277485370635986
Epoch: 19, Steps: 13 | Train Loss: 0.272 Vali Loss: 0.560 Vali Acc: 0.722 Test Loss: 0.560 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.209876537322998
Epoch: 20, Steps: 13 | Train Loss: 0.257 Vali Loss: 0.522 Vali Acc: 0.741 Test Loss: 0.522 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.227004051208496
Epoch: 21, Steps: 13 | Train Loss: 0.250 Vali Loss: 0.574 Vali Acc: 0.771 Test Loss: 0.574 Test Acc: 0.771
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.261484146118164
Epoch: 22, Steps: 13 | Train Loss: 0.246 Vali Loss: 0.680 Vali Acc: 0.663 Test Loss: 0.680 Test Acc: 0.663
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.019853115081787
Epoch: 23, Steps: 13 | Train Loss: 0.222 Vali Loss: 0.823 Vali Acc: 0.644 Test Loss: 0.823 Test Acc: 0.644
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.882484197616577
Epoch: 24, Steps: 13 | Train Loss: 0.215 Vali Loss: 0.617 Vali Acc: 0.673 Test Loss: 0.617 Test Acc: 0.673
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.0859482288360596
Epoch: 25, Steps: 13 | Train Loss: 0.223 Vali Loss: 0.608 Vali Acc: 0.722 Test Loss: 0.608 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.1515285968780518
Epoch: 26, Steps: 13 | Train Loss: 0.176 Vali Loss: 0.644 Vali Acc: 0.678 Test Loss: 0.644 Test Acc: 0.678
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.085080146789551
Epoch: 27, Steps: 13 | Train Loss: 0.164 Vali Loss: 0.669 Vali Acc: 0.683 Test Loss: 0.669 Test Acc: 0.683
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7804878048780488
model parameter : 301434
model size : 1.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.8248543739318848
Epoch: 1, Steps: 13 | Train Loss: 0.608 Vali Loss: 0.583 Vali Acc: 0.712 Test Loss: 0.583 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 2.291109561920166
Epoch: 2, Steps: 13 | Train Loss: 0.598 Vali Loss: 0.566 Vali Acc: 0.712 Test Loss: 0.566 Test Acc: 0.712
Validation loss decreased (-0.712189 --> -0.712189).  Saving model ...
Epoch: 3 cost time: 2.3451642990112305
Epoch: 3, Steps: 13 | Train Loss: 0.575 Vali Loss: 0.549 Vali Acc: 0.727 Test Loss: 0.549 Test Acc: 0.727
Validation loss decreased (-0.712189 --> -0.726824).  Saving model ...
Epoch: 4 cost time: 2.28489089012146
Epoch: 4, Steps: 13 | Train Loss: 0.533 Vali Loss: 0.539 Vali Acc: 0.746 Test Loss: 0.539 Test Acc: 0.746
Validation loss decreased (-0.726824 --> -0.746336).  Saving model ...
Epoch: 5 cost time: 2.2776570320129395
Epoch: 5, Steps: 13 | Train Loss: 0.508 Vali Loss: 0.526 Vali Acc: 0.761 Test Loss: 0.526 Test Acc: 0.761
Validation loss decreased (-0.746336 --> -0.760970).  Saving model ...
Epoch: 6 cost time: 2.3590915203094482
Epoch: 6, Steps: 13 | Train Loss: 0.486 Vali Loss: 0.513 Vali Acc: 0.766 Test Loss: 0.513 Test Acc: 0.766
Validation loss decreased (-0.760970 --> -0.765849).  Saving model ...
Epoch: 7 cost time: 2.4111411571502686
Epoch: 7, Steps: 13 | Train Loss: 0.498 Vali Loss: 0.512 Vali Acc: 0.761 Test Loss: 0.512 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.439924716949463
Epoch: 8, Steps: 13 | Train Loss: 0.485 Vali Loss: 0.538 Vali Acc: 0.732 Test Loss: 0.538 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.3745064735412598
Epoch: 9, Steps: 13 | Train Loss: 0.479 Vali Loss: 0.543 Vali Acc: 0.756 Test Loss: 0.543 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.3929991722106934
Epoch: 10, Steps: 13 | Train Loss: 0.424 Vali Loss: 0.569 Vali Acc: 0.683 Test Loss: 0.569 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.380338191986084
Epoch: 11, Steps: 13 | Train Loss: 0.424 Vali Loss: 0.546 Vali Acc: 0.737 Test Loss: 0.546 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.3796849250793457
Epoch: 12, Steps: 13 | Train Loss: 0.403 Vali Loss: 0.581 Vali Acc: 0.654 Test Loss: 0.581 Test Acc: 0.654
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.2275919914245605
Epoch: 13, Steps: 13 | Train Loss: 0.391 Vali Loss: 0.546 Vali Acc: 0.776 Test Loss: 0.546 Test Acc: 0.776
Validation loss decreased (-0.765849 --> -0.775604).  Saving model ...
Epoch: 14 cost time: 2.200227975845337
Epoch: 14, Steps: 13 | Train Loss: 0.347 Vali Loss: 0.538 Vali Acc: 0.707 Test Loss: 0.538 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.915266990661621
Epoch: 15, Steps: 13 | Train Loss: 0.344 Vali Loss: 0.515 Vali Acc: 0.717 Test Loss: 0.515 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.280789613723755
Epoch: 16, Steps: 13 | Train Loss: 0.313 Vali Loss: 0.526 Vali Acc: 0.785 Test Loss: 0.526 Test Acc: 0.785
Validation loss decreased (-0.775604 --> -0.785361).  Saving model ...
Epoch: 17 cost time: 2.2197344303131104
Epoch: 17, Steps: 13 | Train Loss: 0.304 Vali Loss: 0.589 Vali Acc: 0.678 Test Loss: 0.589 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.1586437225341797
Epoch: 18, Steps: 13 | Train Loss: 0.305 Vali Loss: 0.546 Vali Acc: 0.756 Test Loss: 0.546 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.299013137817383
Epoch: 19, Steps: 13 | Train Loss: 0.265 Vali Loss: 0.529 Vali Acc: 0.761 Test Loss: 0.529 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.2885029315948486
Epoch: 20, Steps: 13 | Train Loss: 0.256 Vali Loss: 0.544 Vali Acc: 0.702 Test Loss: 0.544 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.2344653606414795
Epoch: 21, Steps: 13 | Train Loss: 0.282 Vali Loss: 0.665 Vali Acc: 0.629 Test Loss: 0.665 Test Acc: 0.629
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.1415371894836426
Epoch: 22, Steps: 13 | Train Loss: 0.337 Vali Loss: 0.596 Vali Acc: 0.776 Test Loss: 0.596 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.1412792205810547
Epoch: 23, Steps: 13 | Train Loss: 0.259 Vali Loss: 0.600 Vali Acc: 0.678 Test Loss: 0.600 Test Acc: 0.678
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.525824785232544
Epoch: 24, Steps: 13 | Train Loss: 0.230 Vali Loss: 0.568 Vali Acc: 0.717 Test Loss: 0.568 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.4859209060668945
Epoch: 25, Steps: 13 | Train Loss: 0.188 Vali Loss: 0.542 Vali Acc: 0.746 Test Loss: 0.542 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.505171775817871
Epoch: 26, Steps: 13 | Train Loss: 0.186 Vali Loss: 0.593 Vali Acc: 0.712 Test Loss: 0.593 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el4_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7853658536585366
model parameter : 94394
model size : 0.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 68.42094278335571
Epoch: 1, Steps: 13 | Train Loss: 0.675 Vali Loss: 0.573 Vali Acc: 0.741 Test Loss: 0.573 Test Acc: 0.741
Validation loss decreased (inf --> -0.741458).  Saving model ...
Epoch: 2 cost time: 60.62917447090149
Epoch: 2, Steps: 13 | Train Loss: 0.595 Vali Loss: 0.505 Vali Acc: 0.776 Test Loss: 0.505 Test Acc: 0.776
Validation loss decreased (-0.741458 --> -0.775605).  Saving model ...
Epoch: 3 cost time: 62.97782278060913
Epoch: 3, Steps: 13 | Train Loss: 0.433 Vali Loss: 0.589 Vali Acc: 0.756 Test Loss: 0.589 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 63.79041385650635
Epoch: 4, Steps: 13 | Train Loss: 0.369 Vali Loss: 0.552 Vali Acc: 0.712 Test Loss: 0.552 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 65.12783455848694
Epoch: 5, Steps: 13 | Train Loss: 0.264 Vali Loss: 0.714 Vali Acc: 0.751 Test Loss: 0.714 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 66.10447454452515
Epoch: 6, Steps: 13 | Train Loss: 0.197 Vali Loss: 0.831 Vali Acc: 0.654 Test Loss: 0.831 Test Acc: 0.654
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 64.61672806739807
Epoch: 7, Steps: 13 | Train Loss: 0.150 Vali Loss: 1.116 Vali Acc: 0.498 Test Loss: 1.116 Test Acc: 0.498
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 61.45363450050354
Epoch: 8, Steps: 13 | Train Loss: 0.216 Vali Loss: 1.018 Vali Acc: 0.732 Test Loss: 1.018 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 66.30833792686462
Epoch: 9, Steps: 13 | Train Loss: 0.207 Vali Loss: 0.834 Vali Acc: 0.761 Test Loss: 0.834 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 65.65579462051392
Epoch: 10, Steps: 13 | Train Loss: 0.167 Vali Loss: 1.533 Vali Acc: 0.459 Test Loss: 1.533 Test Acc: 0.459
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 69.07600951194763
Epoch: 11, Steps: 13 | Train Loss: 0.077 Vali Loss: 0.930 Vali Acc: 0.668 Test Loss: 0.930 Test Acc: 0.668
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 66.67163324356079
Epoch: 12, Steps: 13 | Train Loss: 0.151 Vali Loss: 1.176 Vali Acc: 0.741 Test Loss: 1.176 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 56364674
model size : 217.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 24.682310342788696
Epoch: 1, Steps: 13 | Train Loss: 0.600 Vali Loss: 0.555 Vali Acc: 0.737 Test Loss: 0.555 Test Acc: 0.737
Validation loss decreased (inf --> -0.736580).  Saving model ...
Epoch: 2 cost time: 24.05638813972473
Epoch: 2, Steps: 13 | Train Loss: 0.522 Vali Loss: 0.519 Vali Acc: 0.746 Test Loss: 0.519 Test Acc: 0.746
Validation loss decreased (-0.736580 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 23.960668325424194
Epoch: 3, Steps: 13 | Train Loss: 0.375 Vali Loss: 0.518 Vali Acc: 0.766 Test Loss: 0.518 Test Acc: 0.766
Validation loss decreased (-0.746336 --> -0.765848).  Saving model ...
Epoch: 4 cost time: 22.55835199356079
Epoch: 4, Steps: 13 | Train Loss: 0.333 Vali Loss: 0.617 Vali Acc: 0.746 Test Loss: 0.617 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 23.752809047698975
Epoch: 5, Steps: 13 | Train Loss: 0.307 Vali Loss: 0.956 Vali Acc: 0.732 Test Loss: 0.956 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 24.12792134284973
Epoch: 6, Steps: 13 | Train Loss: 0.207 Vali Loss: 1.047 Vali Acc: 0.502 Test Loss: 1.047 Test Acc: 0.502
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 23.15283226966858
Epoch: 7, Steps: 13 | Train Loss: 0.211 Vali Loss: 1.043 Vali Acc: 0.502 Test Loss: 1.043 Test Acc: 0.502
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 23.700743675231934
Epoch: 8, Steps: 13 | Train Loss: 0.129 Vali Loss: 0.636 Vali Acc: 0.712 Test Loss: 0.636 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 24.82630181312561
Epoch: 9, Steps: 13 | Train Loss: 0.067 Vali Loss: 0.747 Vali Acc: 0.712 Test Loss: 0.747 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 24.18517827987671
Epoch: 10, Steps: 13 | Train Loss: 0.041 Vali Loss: 0.805 Vali Acc: 0.707 Test Loss: 0.805 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 23.134666204452515
Epoch: 11, Steps: 13 | Train Loss: 0.032 Vali Loss: 0.961 Vali Acc: 0.732 Test Loss: 0.961 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 24.77135682106018
Epoch: 12, Steps: 13 | Train Loss: 0.030 Vali Loss: 0.861 Vali Acc: 0.717 Test Loss: 0.861 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 24.327990531921387
Epoch: 13, Steps: 13 | Train Loss: 0.012 Vali Loss: 0.922 Vali Acc: 0.741 Test Loss: 0.922 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 16647554
model size : 65.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 54.1564040184021
Epoch: 1, Steps: 13 | Train Loss: 0.674 Vali Loss: 0.574 Vali Acc: 0.741 Test Loss: 0.574 Test Acc: 0.741
Validation loss decreased (inf --> -0.741458).  Saving model ...
Epoch: 2 cost time: 48.86825752258301
Epoch: 2, Steps: 13 | Train Loss: 0.581 Vali Loss: 0.516 Vali Acc: 0.766 Test Loss: 0.516 Test Acc: 0.766
Validation loss decreased (-0.741458 --> -0.765848).  Saving model ...
Epoch: 3 cost time: 50.932278633117676
Epoch: 3, Steps: 13 | Train Loss: 0.420 Vali Loss: 0.690 Vali Acc: 0.737 Test Loss: 0.690 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 48.97800064086914
Epoch: 4, Steps: 13 | Train Loss: 0.435 Vali Loss: 0.523 Vali Acc: 0.722 Test Loss: 0.523 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 48.48924160003662
Epoch: 5, Steps: 13 | Train Loss: 0.363 Vali Loss: 0.835 Vali Acc: 0.546 Test Loss: 0.835 Test Acc: 0.546
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 52.634623765945435
Epoch: 6, Steps: 13 | Train Loss: 0.350 Vali Loss: 0.793 Vali Acc: 0.746 Test Loss: 0.793 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 43.46254253387451
Epoch: 7, Steps: 13 | Train Loss: 0.180 Vali Loss: 1.004 Vali Acc: 0.483 Test Loss: 1.004 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 52.635366439819336
Epoch: 8, Steps: 13 | Train Loss: 0.124 Vali Loss: 1.144 Vali Acc: 0.727 Test Loss: 1.144 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 52.288363456726074
Epoch: 9, Steps: 13 | Train Loss: 0.207 Vali Loss: 0.689 Vali Acc: 0.732 Test Loss: 0.689 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 50.40303587913513
Epoch: 10, Steps: 13 | Train Loss: 0.052 Vali Loss: 1.148 Vali Acc: 0.522 Test Loss: 1.148 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 51.837767601013184
Epoch: 11, Steps: 13 | Train Loss: 0.043 Vali Loss: 0.833 Vali Acc: 0.732 Test Loss: 0.833 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 48.30758786201477
Epoch: 12, Steps: 13 | Train Loss: 0.024 Vali Loss: 0.918 Vali Acc: 0.741 Test Loss: 0.918 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 56364674
model size : 217.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 19.185487985610962
Epoch: 1, Steps: 13 | Train Loss: 0.601 Vali Loss: 0.566 Vali Acc: 0.727 Test Loss: 0.566 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 17.781654357910156
Epoch: 2, Steps: 13 | Train Loss: 0.533 Vali Loss: 0.519 Vali Acc: 0.746 Test Loss: 0.519 Test Acc: 0.746
Validation loss decreased (-0.726824 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 19.695284843444824
Epoch: 3, Steps: 13 | Train Loss: 0.375 Vali Loss: 0.516 Vali Acc: 0.741 Test Loss: 0.516 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 19.217411279678345
Epoch: 4, Steps: 13 | Train Loss: 0.315 Vali Loss: 0.691 Vali Acc: 0.737 Test Loss: 0.691 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 17.796579122543335
Epoch: 5, Steps: 13 | Train Loss: 0.276 Vali Loss: 0.888 Vali Acc: 0.737 Test Loss: 0.888 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 18.749284267425537
Epoch: 6, Steps: 13 | Train Loss: 0.194 Vali Loss: 1.257 Vali Acc: 0.459 Test Loss: 1.257 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 18.9012508392334
Epoch: 7, Steps: 13 | Train Loss: 0.185 Vali Loss: 0.701 Vali Acc: 0.756 Test Loss: 0.701 Test Acc: 0.756
Validation loss decreased (-0.746336 --> -0.756091).  Saving model ...
Epoch: 8 cost time: 18.76836109161377
Epoch: 8, Steps: 13 | Train Loss: 0.214 Vali Loss: 0.755 Vali Acc: 0.746 Test Loss: 0.755 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 14.182931423187256
Epoch: 9, Steps: 13 | Train Loss: 0.081 Vali Loss: 0.728 Vali Acc: 0.693 Test Loss: 0.728 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 19.00526523590088
Epoch: 10, Steps: 13 | Train Loss: 0.033 Vali Loss: 0.904 Vali Acc: 0.756 Test Loss: 0.904 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 19.282501459121704
Epoch: 11, Steps: 13 | Train Loss: 0.029 Vali Loss: 0.838 Vali Acc: 0.741 Test Loss: 0.838 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 19.825857877731323
Epoch: 12, Steps: 13 | Train Loss: 0.011 Vali Loss: 0.869 Vali Acc: 0.693 Test Loss: 0.869 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 17.94612193107605
Epoch: 13, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.083 Vali Acc: 0.761 Test Loss: 1.083 Test Acc: 0.761
Validation loss decreased (-0.756091 --> -0.760965).  Saving model ...
Epoch: 14 cost time: 18.24606156349182
Epoch: 14, Steps: 13 | Train Loss: 0.034 Vali Loss: 1.077 Vali Acc: 0.649 Test Loss: 1.077 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 18.8316969871521
Epoch: 15, Steps: 13 | Train Loss: 0.017 Vali Loss: 1.066 Vali Acc: 0.727 Test Loss: 1.066 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 18.702628135681152
Epoch: 16, Steps: 13 | Train Loss: 0.074 Vali Loss: 1.200 Vali Acc: 0.732 Test Loss: 1.200 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 18.503430128097534
Epoch: 17, Steps: 13 | Train Loss: 0.042 Vali Loss: 1.197 Vali Acc: 0.722 Test Loss: 1.197 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 17.867906093597412
Epoch: 18, Steps: 13 | Train Loss: 0.091 Vali Loss: 1.008 Vali Acc: 0.702 Test Loss: 1.008 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 19.32213544845581
Epoch: 19, Steps: 13 | Train Loss: 0.019 Vali Loss: 1.677 Vali Acc: 0.741 Test Loss: 1.677 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 19.136530876159668
Epoch: 20, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.171 Vali Acc: 0.654 Test Loss: 1.171 Test Acc: 0.654
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 18.54772138595581
Epoch: 21, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.393 Vali Acc: 0.732 Test Loss: 1.393 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 18.798674821853638
Epoch: 22, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.487 Vali Acc: 0.727 Test Loss: 1.487 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 19.365190744400024
Epoch: 23, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.254 Vali Acc: 0.727 Test Loss: 1.254 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 16647554
model size : 65.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 30.460108995437622
Epoch: 1, Steps: 13 | Train Loss: 0.676 Vali Loss: 0.576 Vali Acc: 0.741 Test Loss: 0.576 Test Acc: 0.741
Validation loss decreased (inf --> -0.741458).  Saving model ...
Epoch: 2 cost time: 30.083276987075806
Epoch: 2, Steps: 13 | Train Loss: 0.602 Vali Loss: 0.524 Vali Acc: 0.756 Test Loss: 0.524 Test Acc: 0.756
Validation loss decreased (-0.741458 --> -0.756092).  Saving model ...
Epoch: 3 cost time: 30.30680513381958
Epoch: 3, Steps: 13 | Train Loss: 0.410 Vali Loss: 0.719 Vali Acc: 0.722 Test Loss: 0.719 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 26.974238872528076
Epoch: 4, Steps: 13 | Train Loss: 0.450 Vali Loss: 0.556 Vali Acc: 0.698 Test Loss: 0.556 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 30.29793381690979
Epoch: 5, Steps: 13 | Train Loss: 0.320 Vali Loss: 0.555 Vali Acc: 0.722 Test Loss: 0.555 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 29.12754201889038
Epoch: 6, Steps: 13 | Train Loss: 0.397 Vali Loss: 1.274 Vali Acc: 0.727 Test Loss: 1.274 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 27.32801604270935
Epoch: 7, Steps: 13 | Train Loss: 0.318 Vali Loss: 0.816 Vali Acc: 0.585 Test Loss: 0.816 Test Acc: 0.585
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 28.030573844909668
Epoch: 8, Steps: 13 | Train Loss: 0.827 Vali Loss: 0.956 Vali Acc: 0.737 Test Loss: 0.956 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 27.71322512626648
Epoch: 9, Steps: 13 | Train Loss: 0.666 Vali Loss: 1.412 Vali Acc: 0.732 Test Loss: 1.412 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 27.96819233894348
Epoch: 10, Steps: 13 | Train Loss: 0.302 Vali Loss: 0.846 Vali Acc: 0.756 Test Loss: 0.846 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 26.064727306365967
Epoch: 11, Steps: 13 | Train Loss: 0.370 Vali Loss: 0.779 Vali Acc: 0.688 Test Loss: 0.779 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 26.96906352043152
Epoch: 12, Steps: 13 | Train Loss: 0.048 Vali Loss: 0.900 Vali Acc: 0.746 Test Loss: 0.900 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 56364674
model size : 217.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 13.261340141296387
Epoch: 1, Steps: 13 | Train Loss: 0.603 Vali Loss: 0.564 Vali Acc: 0.727 Test Loss: 0.564 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 12.016640663146973
Epoch: 2, Steps: 13 | Train Loss: 0.534 Vali Loss: 0.530 Vali Acc: 0.746 Test Loss: 0.530 Test Acc: 0.746
Validation loss decreased (-0.726824 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 10.691368103027344
Epoch: 3, Steps: 13 | Train Loss: 0.383 Vali Loss: 0.515 Vali Acc: 0.741 Test Loss: 0.515 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.847387313842773
Epoch: 4, Steps: 13 | Train Loss: 0.321 Vali Loss: 0.690 Vali Acc: 0.737 Test Loss: 0.690 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 11.679204225540161
Epoch: 5, Steps: 13 | Train Loss: 0.289 Vali Loss: 0.928 Vali Acc: 0.741 Test Loss: 0.928 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 11.595219850540161
Epoch: 6, Steps: 13 | Train Loss: 0.283 Vali Loss: 0.632 Vali Acc: 0.707 Test Loss: 0.632 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 11.851590156555176
Epoch: 7, Steps: 13 | Train Loss: 0.174 Vali Loss: 0.634 Vali Acc: 0.712 Test Loss: 0.634 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 10.835377931594849
Epoch: 8, Steps: 13 | Train Loss: 0.105 Vali Loss: 0.714 Vali Acc: 0.668 Test Loss: 0.714 Test Acc: 0.668
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 10.975435256958008
Epoch: 9, Steps: 13 | Train Loss: 0.276 Vali Loss: 0.745 Vali Acc: 0.722 Test Loss: 0.745 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 10.870777606964111
Epoch: 10, Steps: 13 | Train Loss: 0.218 Vali Loss: 0.871 Vali Acc: 0.727 Test Loss: 0.871 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 11.394546508789062
Epoch: 11, Steps: 13 | Train Loss: 0.039 Vali Loss: 1.078 Vali Acc: 0.751 Test Loss: 1.078 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751209).  Saving model ...
Epoch: 12 cost time: 11.212696313858032
Epoch: 12, Steps: 13 | Train Loss: 0.021 Vali Loss: 1.476 Vali Acc: 0.517 Test Loss: 1.476 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 10.621716737747192
Epoch: 13, Steps: 13 | Train Loss: 0.039 Vali Loss: 1.012 Vali Acc: 0.712 Test Loss: 1.012 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 10.47441029548645
Epoch: 14, Steps: 13 | Train Loss: 0.018 Vali Loss: 1.011 Vali Acc: 0.673 Test Loss: 1.011 Test Acc: 0.673
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 10.59540867805481
Epoch: 15, Steps: 13 | Train Loss: 0.028 Vali Loss: 1.062 Vali Acc: 0.649 Test Loss: 1.062 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 11.168142557144165
Epoch: 16, Steps: 13 | Train Loss: 0.345 Vali Loss: 1.097 Vali Acc: 0.732 Test Loss: 1.097 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 10.791906118392944
Epoch: 17, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.068 Vali Acc: 0.712 Test Loss: 1.068 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 10.648400783538818
Epoch: 18, Steps: 13 | Train Loss: 0.215 Vali Loss: 1.724 Vali Acc: 0.546 Test Loss: 1.724 Test Acc: 0.546
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 9.841259002685547
Epoch: 19, Steps: 13 | Train Loss: 0.024 Vali Loss: 1.723 Vali Acc: 0.727 Test Loss: 1.723 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 10.701653718948364
Epoch: 20, Steps: 13 | Train Loss: 0.030 Vali Loss: 1.176 Vali Acc: 0.688 Test Loss: 1.176 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 11.245105266571045
Epoch: 21, Steps: 13 | Train Loss: 0.109 Vali Loss: 1.248 Vali Acc: 0.702 Test Loss: 1.248 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 16647554
model size : 65.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 30.077573776245117
Epoch: 1, Steps: 13 | Train Loss: 0.578 Vali Loss: 0.555 Vali Acc: 0.727 Test Loss: 0.555 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 36.18807005882263
Epoch: 2, Steps: 13 | Train Loss: 0.461 Vali Loss: 0.604 Vali Acc: 0.741 Test Loss: 0.604 Test Acc: 0.741
Validation loss decreased (-0.726824 --> -0.741457).  Saving model ...
Epoch: 3 cost time: 34.413811445236206
Epoch: 3, Steps: 13 | Train Loss: 0.352 Vali Loss: 0.556 Vali Acc: 0.693 Test Loss: 0.556 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 35.991016149520874
Epoch: 4, Steps: 13 | Train Loss: 0.282 Vali Loss: 0.607 Vali Acc: 0.761 Test Loss: 0.607 Test Acc: 0.761
Validation loss decreased (-0.741457 --> -0.760970).  Saving model ...
Epoch: 5 cost time: 34.14561057090759
Epoch: 5, Steps: 13 | Train Loss: 0.246 Vali Loss: 0.641 Vali Acc: 0.610 Test Loss: 0.641 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 35.72118878364563
Epoch: 6, Steps: 13 | Train Loss: 0.227 Vali Loss: 0.594 Vali Acc: 0.771 Test Loss: 0.594 Test Acc: 0.771
Validation loss decreased (-0.760970 --> -0.770726).  Saving model ...
Epoch: 7 cost time: 34.269984006881714
Epoch: 7, Steps: 13 | Train Loss: 0.179 Vali Loss: 0.838 Vali Acc: 0.585 Test Loss: 0.838 Test Acc: 0.585
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 35.287612438201904
Epoch: 8, Steps: 13 | Train Loss: 0.136 Vali Loss: 1.089 Vali Acc: 0.737 Test Loss: 1.089 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 34.08095955848694
Epoch: 9, Steps: 13 | Train Loss: 0.127 Vali Loss: 1.163 Vali Acc: 0.522 Test Loss: 1.163 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 35.31106615066528
Epoch: 10, Steps: 13 | Train Loss: 0.074 Vali Loss: 0.869 Vali Acc: 0.746 Test Loss: 0.869 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 34.03432106971741
Epoch: 11, Steps: 13 | Train Loss: 0.064 Vali Loss: 0.817 Vali Acc: 0.727 Test Loss: 0.817 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 33.70764398574829
Epoch: 12, Steps: 13 | Train Loss: 0.027 Vali Loss: 0.976 Vali Acc: 0.576 Test Loss: 0.976 Test Acc: 0.576
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 34.31754469871521
Epoch: 13, Steps: 13 | Train Loss: 0.026 Vali Loss: 0.919 Vali Acc: 0.712 Test Loss: 0.919 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 27.7278413772583
Epoch: 14, Steps: 13 | Train Loss: 0.066 Vali Loss: 0.877 Vali Acc: 0.702 Test Loss: 0.877 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 35.66510820388794
Epoch: 15, Steps: 13 | Train Loss: 0.129 Vali Loss: 0.851 Vali Acc: 0.678 Test Loss: 0.851 Test Acc: 0.678
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 35.9783992767334
Epoch: 16, Steps: 13 | Train Loss: 0.045 Vali Loss: 1.167 Vali Acc: 0.741 Test Loss: 1.167 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 28247426
model size : 110.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 15.574032545089722
Epoch: 1, Steps: 13 | Train Loss: 0.607 Vali Loss: 0.547 Vali Acc: 0.746 Test Loss: 0.547 Test Acc: 0.746
Validation loss decreased (inf --> -0.746336).  Saving model ...
Epoch: 2 cost time: 14.013701438903809
Epoch: 2, Steps: 13 | Train Loss: 0.481 Vali Loss: 0.517 Vali Acc: 0.732 Test Loss: 0.517 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 13.40659236907959
Epoch: 3, Steps: 13 | Train Loss: 0.436 Vali Loss: 0.521 Vali Acc: 0.741 Test Loss: 0.521 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 13.223373889923096
Epoch: 4, Steps: 13 | Train Loss: 0.330 Vali Loss: 0.564 Vali Acc: 0.766 Test Loss: 0.564 Test Acc: 0.766
Validation loss decreased (-0.746336 --> -0.765848).  Saving model ...
Epoch: 5 cost time: 14.033795833587646
Epoch: 5, Steps: 13 | Train Loss: 0.227 Vali Loss: 0.570 Vali Acc: 0.707 Test Loss: 0.570 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 10.490556001663208
Epoch: 6, Steps: 13 | Train Loss: 0.178 Vali Loss: 0.780 Vali Acc: 0.756 Test Loss: 0.780 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 15.006949663162231
Epoch: 7, Steps: 13 | Train Loss: 0.123 Vali Loss: 0.639 Vali Acc: 0.741 Test Loss: 0.639 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 13.771055936813354
Epoch: 8, Steps: 13 | Train Loss: 0.112 Vali Loss: 0.683 Vali Acc: 0.702 Test Loss: 0.683 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 14.24894905090332
Epoch: 9, Steps: 13 | Train Loss: 0.085 Vali Loss: 0.712 Vali Acc: 0.707 Test Loss: 0.712 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 14.827930927276611
Epoch: 10, Steps: 13 | Train Loss: 0.066 Vali Loss: 0.773 Vali Acc: 0.717 Test Loss: 0.773 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 13.890218257904053
Epoch: 11, Steps: 13 | Train Loss: 0.047 Vali Loss: 0.852 Vali Acc: 0.649 Test Loss: 0.852 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 13.241666793823242
Epoch: 12, Steps: 13 | Train Loss: 0.040 Vali Loss: 1.343 Vali Acc: 0.746 Test Loss: 1.343 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 13.215848207473755
Epoch: 13, Steps: 13 | Train Loss: 0.033 Vali Loss: 0.943 Vali Acc: 0.751 Test Loss: 0.943 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 13.465282917022705
Epoch: 14, Steps: 13 | Train Loss: 0.039 Vali Loss: 1.120 Vali Acc: 0.546 Test Loss: 1.120 Test Acc: 0.546
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 8388482
model size : 34.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 28.394547700881958
Epoch: 1, Steps: 13 | Train Loss: 0.578 Vali Loss: 0.567 Vali Acc: 0.732 Test Loss: 0.567 Test Acc: 0.732
Validation loss decreased (inf --> -0.731702).  Saving model ...
Epoch: 2 cost time: 27.208605766296387
Epoch: 2, Steps: 13 | Train Loss: 0.466 Vali Loss: 0.614 Vali Acc: 0.737 Test Loss: 0.614 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736579).  Saving model ...
Epoch: 3 cost time: 27.122005462646484
Epoch: 3, Steps: 13 | Train Loss: 0.365 Vali Loss: 0.517 Vali Acc: 0.756 Test Loss: 0.517 Test Acc: 0.756
Validation loss decreased (-0.736579 --> -0.756092).  Saving model ...
Epoch: 4 cost time: 26.092572450637817
Epoch: 4, Steps: 13 | Train Loss: 0.292 Vali Loss: 0.588 Vali Acc: 0.649 Test Loss: 0.588 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 28.626076698303223
Epoch: 5, Steps: 13 | Train Loss: 0.228 Vali Loss: 0.579 Vali Acc: 0.693 Test Loss: 0.579 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 26.978935480117798
Epoch: 6, Steps: 13 | Train Loss: 0.153 Vali Loss: 0.586 Vali Acc: 0.737 Test Loss: 0.586 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 27.7547664642334
Epoch: 7, Steps: 13 | Train Loss: 0.168 Vali Loss: 0.793 Vali Acc: 0.634 Test Loss: 0.793 Test Acc: 0.634
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 28.640729427337646
Epoch: 8, Steps: 13 | Train Loss: 0.087 Vali Loss: 0.663 Vali Acc: 0.756 Test Loss: 0.663 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 26.844780206680298
Epoch: 9, Steps: 13 | Train Loss: 0.061 Vali Loss: 0.766 Vali Acc: 0.639 Test Loss: 0.766 Test Acc: 0.639
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 27.67984652519226
Epoch: 10, Steps: 13 | Train Loss: 0.063 Vali Loss: 0.812 Vali Acc: 0.741 Test Loss: 0.812 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 27.211451530456543
Epoch: 11, Steps: 13 | Train Loss: 0.037 Vali Loss: 0.736 Vali Acc: 0.727 Test Loss: 0.736 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 28.07166862487793
Epoch: 12, Steps: 13 | Train Loss: 0.026 Vali Loss: 0.819 Vali Acc: 0.698 Test Loss: 0.819 Test Acc: 0.698
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 26.75064444541931
Epoch: 13, Steps: 13 | Train Loss: 0.014 Vali Loss: 1.068 Vali Acc: 0.615 Test Loss: 1.068 Test Acc: 0.615
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 28247426
model size : 110.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 12.982093095779419
Epoch: 1, Steps: 13 | Train Loss: 0.608 Vali Loss: 0.548 Vali Acc: 0.741 Test Loss: 0.548 Test Acc: 0.741
Validation loss decreased (inf --> -0.741458).  Saving model ...
Epoch: 2 cost time: 11.0958411693573
Epoch: 2, Steps: 13 | Train Loss: 0.478 Vali Loss: 0.521 Vali Acc: 0.737 Test Loss: 0.521 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.206831455230713
Epoch: 3, Steps: 13 | Train Loss: 0.427 Vali Loss: 0.516 Vali Acc: 0.737 Test Loss: 0.516 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 10.538376569747925
Epoch: 4, Steps: 13 | Train Loss: 0.333 Vali Loss: 0.617 Vali Acc: 0.741 Test Loss: 0.617 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 10.566189289093018
Epoch: 5, Steps: 13 | Train Loss: 0.221 Vali Loss: 0.580 Vali Acc: 0.702 Test Loss: 0.580 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 11.490807294845581
Epoch: 6, Steps: 13 | Train Loss: 0.161 Vali Loss: 0.641 Vali Acc: 0.776 Test Loss: 0.641 Test Acc: 0.776
Validation loss decreased (-0.741458 --> -0.775603).  Saving model ...
Epoch: 7 cost time: 11.237813234329224
Epoch: 7, Steps: 13 | Train Loss: 0.117 Vali Loss: 0.612 Vali Acc: 0.732 Test Loss: 0.612 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 11.34164571762085
Epoch: 8, Steps: 13 | Train Loss: 0.114 Vali Loss: 1.148 Vali Acc: 0.746 Test Loss: 1.148 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 10.91839861869812
Epoch: 9, Steps: 13 | Train Loss: 0.071 Vali Loss: 0.714 Vali Acc: 0.683 Test Loss: 0.714 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 11.040121793746948
Epoch: 10, Steps: 13 | Train Loss: 0.036 Vali Loss: 0.775 Vali Acc: 0.702 Test Loss: 0.775 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 11.478031873703003
Epoch: 11, Steps: 13 | Train Loss: 0.031 Vali Loss: 0.805 Vali Acc: 0.688 Test Loss: 0.805 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 11.67047381401062
Epoch: 12, Steps: 13 | Train Loss: 0.023 Vali Loss: 1.112 Vali Acc: 0.756 Test Loss: 1.112 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 8.480817794799805
Epoch: 13, Steps: 13 | Train Loss: 0.016 Vali Loss: 1.158 Vali Acc: 0.746 Test Loss: 1.158 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 10.92822813987732
Epoch: 14, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.001 Vali Acc: 0.668 Test Loss: 1.001 Test Acc: 0.668
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 10.6944899559021
Epoch: 15, Steps: 13 | Train Loss: 0.067 Vali Loss: 1.439 Vali Acc: 0.766 Test Loss: 1.439 Test Acc: 0.766
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 10.992527961730957
Epoch: 16, Steps: 13 | Train Loss: 0.037 Vali Loss: 0.920 Vali Acc: 0.688 Test Loss: 0.920 Test Acc: 0.688
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 8388482
model size : 34.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 17.662758588790894
Epoch: 1, Steps: 13 | Train Loss: 0.577 Vali Loss: 0.567 Vali Acc: 0.727 Test Loss: 0.567 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 15.69783067703247
Epoch: 2, Steps: 13 | Train Loss: 0.472 Vali Loss: 0.616 Vali Acc: 0.727 Test Loss: 0.616 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 15.467155456542969
Epoch: 3, Steps: 13 | Train Loss: 0.367 Vali Loss: 0.511 Vali Acc: 0.746 Test Loss: 0.511 Test Acc: 0.746
Validation loss decreased (-0.726824 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 16.12167525291443
Epoch: 4, Steps: 13 | Train Loss: 0.306 Vali Loss: 0.620 Vali Acc: 0.639 Test Loss: 0.620 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 16.488815546035767
Epoch: 5, Steps: 13 | Train Loss: 0.220 Vali Loss: 0.565 Vali Acc: 0.722 Test Loss: 0.565 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 15.830453157424927
Epoch: 6, Steps: 13 | Train Loss: 0.169 Vali Loss: 0.784 Vali Acc: 0.746 Test Loss: 0.784 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 16.500022172927856
Epoch: 7, Steps: 13 | Train Loss: 0.180 Vali Loss: 1.023 Vali Acc: 0.522 Test Loss: 1.023 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 16.29033589363098
Epoch: 8, Steps: 13 | Train Loss: 0.138 Vali Loss: 0.893 Vali Acc: 0.756 Test Loss: 0.893 Test Acc: 0.756
Validation loss decreased (-0.746336 --> -0.756089).  Saving model ...
Epoch: 9 cost time: 15.674341678619385
Epoch: 9, Steps: 13 | Train Loss: 0.620 Vali Loss: 0.742 Vali Acc: 0.644 Test Loss: 0.742 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 14.906219482421875
Epoch: 10, Steps: 13 | Train Loss: 0.101 Vali Loss: 1.212 Vali Acc: 0.741 Test Loss: 1.212 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 14.839654207229614
Epoch: 11, Steps: 13 | Train Loss: 0.391 Vali Loss: 0.793 Vali Acc: 0.668 Test Loss: 0.793 Test Acc: 0.668
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 16.52281379699707
Epoch: 12, Steps: 13 | Train Loss: 0.018 Vali Loss: 0.776 Vali Acc: 0.717 Test Loss: 0.776 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 13.324860572814941
Epoch: 13, Steps: 13 | Train Loss: 0.319 Vali Loss: 0.836 Vali Acc: 0.698 Test Loss: 0.836 Test Acc: 0.698
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 16.96555805206299
Epoch: 14, Steps: 13 | Train Loss: 0.183 Vali Loss: 1.444 Vali Acc: 0.751 Test Loss: 1.444 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 15.434803009033203
Epoch: 15, Steps: 13 | Train Loss: 0.142 Vali Loss: 1.044 Vali Acc: 0.727 Test Loss: 1.044 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 16.66712188720703
Epoch: 16, Steps: 13 | Train Loss: 0.777 Vali Loss: 1.007 Vali Acc: 0.717 Test Loss: 1.007 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 15.985984563827515
Epoch: 17, Steps: 13 | Train Loss: 0.031 Vali Loss: 0.992 Vali Acc: 0.727 Test Loss: 0.992 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 15.447988271713257
Epoch: 18, Steps: 13 | Train Loss: 0.294 Vali Loss: 0.967 Vali Acc: 0.698 Test Loss: 0.967 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 28247426
model size : 110.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 9.357954502105713
Epoch: 1, Steps: 13 | Train Loss: 0.610 Vali Loss: 0.548 Vali Acc: 0.741 Test Loss: 0.548 Test Acc: 0.741
Validation loss decreased (inf --> -0.741458).  Saving model ...
Epoch: 2 cost time: 7.578372955322266
Epoch: 2, Steps: 13 | Train Loss: 0.479 Vali Loss: 0.522 Vali Acc: 0.727 Test Loss: 0.522 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.38698935508728
Epoch: 3, Steps: 13 | Train Loss: 0.430 Vali Loss: 0.515 Vali Acc: 0.737 Test Loss: 0.515 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.386711120605469
Epoch: 4, Steps: 13 | Train Loss: 0.331 Vali Loss: 0.621 Vali Acc: 0.737 Test Loss: 0.621 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.079462051391602
Epoch: 5, Steps: 13 | Train Loss: 0.223 Vali Loss: 0.591 Vali Acc: 0.683 Test Loss: 0.591 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.047177076339722
Epoch: 6, Steps: 13 | Train Loss: 0.164 Vali Loss: 0.668 Vali Acc: 0.761 Test Loss: 0.668 Test Acc: 0.761
Validation loss decreased (-0.741458 --> -0.760969).  Saving model ...
Epoch: 7 cost time: 7.596944332122803
Epoch: 7, Steps: 13 | Train Loss: 0.117 Vali Loss: 0.665 Vali Acc: 0.741 Test Loss: 0.665 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.608400821685791
Epoch: 8, Steps: 13 | Train Loss: 0.170 Vali Loss: 0.856 Vali Acc: 0.585 Test Loss: 0.856 Test Acc: 0.585
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.519172191619873
Epoch: 9, Steps: 13 | Train Loss: 0.107 Vali Loss: 1.071 Vali Acc: 0.746 Test Loss: 1.071 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 7.6408021450042725
Epoch: 10, Steps: 13 | Train Loss: 0.291 Vali Loss: 1.161 Vali Acc: 0.737 Test Loss: 1.161 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 7.392695426940918
Epoch: 11, Steps: 13 | Train Loss: 0.078 Vali Loss: 1.295 Vali Acc: 0.522 Test Loss: 1.295 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 7.3528618812561035
Epoch: 12, Steps: 13 | Train Loss: 0.208 Vali Loss: 0.919 Vali Acc: 0.737 Test Loss: 0.919 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 7.463973760604858
Epoch: 13, Steps: 13 | Train Loss: 0.025 Vali Loss: 0.951 Vali Acc: 0.717 Test Loss: 0.951 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 7.343188524246216
Epoch: 14, Steps: 13 | Train Loss: 0.680 Vali Loss: 0.966 Vali Acc: 0.702 Test Loss: 0.966 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 7.731319904327393
Epoch: 15, Steps: 13 | Train Loss: 0.050 Vali Loss: 0.933 Vali Acc: 0.717 Test Loss: 0.933 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 7.54401421546936
Epoch: 16, Steps: 13 | Train Loss: 0.007 Vali Loss: 0.982 Vali Acc: 0.712 Test Loss: 0.982 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 8388482
model size : 34.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 43.84836220741272
Epoch: 1, Steps: 13 | Train Loss: 0.651 Vali Loss: 0.662 Vali Acc: 0.717 Test Loss: 0.662 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 40.671504497528076
Epoch: 2, Steps: 13 | Train Loss: 0.569 Vali Loss: 0.551 Vali Acc: 0.746 Test Loss: 0.551 Test Acc: 0.746
Validation loss decreased (-0.717067 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 42.019558906555176
Epoch: 3, Steps: 13 | Train Loss: 0.465 Vali Loss: 0.546 Vali Acc: 0.761 Test Loss: 0.546 Test Acc: 0.761
Validation loss decreased (-0.746336 --> -0.760970).  Saving model ...
Epoch: 4 cost time: 41.21656537055969
Epoch: 4, Steps: 13 | Train Loss: 0.375 Vali Loss: 0.532 Vali Acc: 0.761 Test Loss: 0.532 Test Acc: 0.761
Validation loss decreased (-0.760970 --> -0.760970).  Saving model ...
Epoch: 5 cost time: 39.925541162490845
Epoch: 5, Steps: 13 | Train Loss: 0.430 Vali Loss: 0.585 Vali Acc: 0.756 Test Loss: 0.585 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 41.607553243637085
Epoch: 6, Steps: 13 | Train Loss: 0.370 Vali Loss: 0.569 Vali Acc: 0.756 Test Loss: 0.569 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 37.361833572387695
Epoch: 7, Steps: 13 | Train Loss: 0.222 Vali Loss: 0.746 Vali Acc: 0.756 Test Loss: 0.746 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 40.84776258468628
Epoch: 8, Steps: 13 | Train Loss: 0.231 Vali Loss: 0.596 Vali Acc: 0.702 Test Loss: 0.596 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 41.754067182540894
Epoch: 9, Steps: 13 | Train Loss: 0.165 Vali Loss: 0.690 Vali Acc: 0.649 Test Loss: 0.690 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 40.911946296691895
Epoch: 10, Steps: 13 | Train Loss: 0.158 Vali Loss: 0.755 Vali Acc: 0.741 Test Loss: 0.755 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 40.138009786605835
Epoch: 11, Steps: 13 | Train Loss: 0.169 Vali Loss: 0.887 Vali Acc: 0.746 Test Loss: 0.887 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 41.65083384513855
Epoch: 12, Steps: 13 | Train Loss: 0.058 Vali Loss: 0.840 Vali Acc: 0.668 Test Loss: 0.840 Test Acc: 0.668
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 38.18931579589844
Epoch: 13, Steps: 13 | Train Loss: 0.040 Vali Loss: 0.812 Vali Acc: 0.707 Test Loss: 0.812 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 41.282238721847534
Epoch: 14, Steps: 13 | Train Loss: 0.071 Vali Loss: 0.939 Vali Acc: 0.712 Test Loss: 0.939 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 28184642
model size : 108.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 18.467357635498047
Epoch: 1, Steps: 13 | Train Loss: 0.600 Vali Loss: 0.562 Vali Acc: 0.722 Test Loss: 0.562 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 15.829877853393555
Epoch: 2, Steps: 13 | Train Loss: 0.509 Vali Loss: 0.527 Vali Acc: 0.746 Test Loss: 0.527 Test Acc: 0.746
Validation loss decreased (-0.721946 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 16.73424482345581
Epoch: 3, Steps: 13 | Train Loss: 0.447 Vali Loss: 0.751 Vali Acc: 0.517 Test Loss: 0.751 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 17.015197277069092
Epoch: 4, Steps: 13 | Train Loss: 0.413 Vali Loss: 0.574 Vali Acc: 0.702 Test Loss: 0.574 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 16.756164073944092
Epoch: 5, Steps: 13 | Train Loss: 0.427 Vali Loss: 0.547 Vali Acc: 0.727 Test Loss: 0.547 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 15.97652792930603
Epoch: 6, Steps: 13 | Train Loss: 0.314 Vali Loss: 0.761 Vali Acc: 0.751 Test Loss: 0.761 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751212).  Saving model ...
Epoch: 7 cost time: 17.33996033668518
Epoch: 7, Steps: 13 | Train Loss: 0.295 Vali Loss: 0.864 Vali Acc: 0.746 Test Loss: 0.864 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 17.14630103111267
Epoch: 8, Steps: 13 | Train Loss: 0.361 Vali Loss: 0.858 Vali Acc: 0.737 Test Loss: 0.858 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 15.672428369522095
Epoch: 9, Steps: 13 | Train Loss: 0.242 Vali Loss: 0.900 Vali Acc: 0.732 Test Loss: 0.900 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 16.120700120925903
Epoch: 10, Steps: 13 | Train Loss: 0.203 Vali Loss: 0.658 Vali Acc: 0.698 Test Loss: 0.658 Test Acc: 0.698
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 16.328930377960205
Epoch: 11, Steps: 13 | Train Loss: 0.182 Vali Loss: 0.722 Vali Acc: 0.668 Test Loss: 0.722 Test Acc: 0.668
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 16.562011003494263
Epoch: 12, Steps: 13 | Train Loss: 0.086 Vali Loss: 0.689 Vali Acc: 0.707 Test Loss: 0.689 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 15.55322527885437
Epoch: 13, Steps: 13 | Train Loss: 0.052 Vali Loss: 0.728 Vali Acc: 0.712 Test Loss: 0.728 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 16.296555042266846
Epoch: 14, Steps: 13 | Train Loss: 0.038 Vali Loss: 0.862 Vali Acc: 0.634 Test Loss: 0.862 Test Acc: 0.634
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 16.09826898574829
Epoch: 15, Steps: 13 | Train Loss: 0.069 Vali Loss: 0.790 Vali Acc: 0.693 Test Loss: 0.790 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 12.107830047607422
Epoch: 16, Steps: 13 | Train Loss: 0.042 Vali Loss: 1.014 Vali Acc: 0.727 Test Loss: 1.014 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 8325314
model size : 33.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 32.74073600769043
Epoch: 1, Steps: 13 | Train Loss: 0.651 Vali Loss: 0.662 Vali Acc: 0.712 Test Loss: 0.662 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 28.68437910079956
Epoch: 2, Steps: 13 | Train Loss: 0.566 Vali Loss: 0.548 Vali Acc: 0.732 Test Loss: 0.548 Test Acc: 0.732
Validation loss decreased (-0.712189 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 30.603424072265625
Epoch: 3, Steps: 13 | Train Loss: 0.460 Vali Loss: 0.498 Vali Acc: 0.761 Test Loss: 0.498 Test Acc: 0.761
Validation loss decreased (-0.731702 --> -0.760971).  Saving model ...
Epoch: 4 cost time: 28.915947198867798
Epoch: 4, Steps: 13 | Train Loss: 0.390 Vali Loss: 0.517 Vali Acc: 0.751 Test Loss: 0.517 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 27.391393899917603
Epoch: 5, Steps: 13 | Train Loss: 0.449 Vali Loss: 0.540 Vali Acc: 0.751 Test Loss: 0.540 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 31.984795570373535
Epoch: 6, Steps: 13 | Train Loss: 0.377 Vali Loss: 0.572 Vali Acc: 0.771 Test Loss: 0.572 Test Acc: 0.771
Validation loss decreased (-0.760971 --> -0.770726).  Saving model ...
Epoch: 7 cost time: 33.80900549888611
Epoch: 7, Steps: 13 | Train Loss: 0.223 Vali Loss: 0.714 Vali Acc: 0.746 Test Loss: 0.714 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 32.97443509101868
Epoch: 8, Steps: 13 | Train Loss: 0.205 Vali Loss: 0.668 Vali Acc: 0.678 Test Loss: 0.668 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 33.24262547492981
Epoch: 9, Steps: 13 | Train Loss: 0.138 Vali Loss: 0.623 Vali Acc: 0.698 Test Loss: 0.623 Test Acc: 0.698
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 31.156765937805176
Epoch: 10, Steps: 13 | Train Loss: 0.201 Vali Loss: 0.786 Vali Acc: 0.746 Test Loss: 0.786 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 31.527953386306763
Epoch: 11, Steps: 13 | Train Loss: 0.172 Vali Loss: 0.736 Vali Acc: 0.741 Test Loss: 0.736 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 32.233158826828
Epoch: 12, Steps: 13 | Train Loss: 0.061 Vali Loss: 0.834 Vali Acc: 0.561 Test Loss: 0.834 Test Acc: 0.561
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 31.011053800582886
Epoch: 13, Steps: 13 | Train Loss: 0.051 Vali Loss: 0.758 Vali Acc: 0.712 Test Loss: 0.758 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 31.415759325027466
Epoch: 14, Steps: 13 | Train Loss: 0.051 Vali Loss: 0.841 Vali Acc: 0.722 Test Loss: 0.841 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 30.259524822235107
Epoch: 15, Steps: 13 | Train Loss: 0.026 Vali Loss: 0.908 Vali Acc: 0.663 Test Loss: 0.908 Test Acc: 0.663
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 30.098971843719482
Epoch: 16, Steps: 13 | Train Loss: 0.100 Vali Loss: 1.202 Vali Acc: 0.512 Test Loss: 1.202 Test Acc: 0.512
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 28184642
model size : 108.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 14.265715837478638
Epoch: 1, Steps: 13 | Train Loss: 0.598 Vali Loss: 0.563 Vali Acc: 0.722 Test Loss: 0.563 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 12.720910787582397
Epoch: 2, Steps: 13 | Train Loss: 0.514 Vali Loss: 0.534 Vali Acc: 0.737 Test Loss: 0.534 Test Acc: 0.737
Validation loss decreased (-0.721946 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 12.996272563934326
Epoch: 3, Steps: 13 | Train Loss: 0.458 Vali Loss: 0.741 Vali Acc: 0.527 Test Loss: 0.741 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 12.488327264785767
Epoch: 4, Steps: 13 | Train Loss: 0.422 Vali Loss: 0.550 Vali Acc: 0.712 Test Loss: 0.550 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 13.094606876373291
Epoch: 5, Steps: 13 | Train Loss: 0.412 Vali Loss: 0.513 Vali Acc: 0.771 Test Loss: 0.513 Test Acc: 0.771
Validation loss decreased (-0.736580 --> -0.770727).  Saving model ...
Epoch: 6 cost time: 13.428195476531982
Epoch: 6, Steps: 13 | Train Loss: 0.306 Vali Loss: 0.733 Vali Acc: 0.727 Test Loss: 0.733 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 13.402207851409912
Epoch: 7, Steps: 13 | Train Loss: 0.233 Vali Loss: 0.588 Vali Acc: 0.712 Test Loss: 0.588 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 12.694417238235474
Epoch: 8, Steps: 13 | Train Loss: 0.162 Vali Loss: 0.595 Vali Acc: 0.698 Test Loss: 0.595 Test Acc: 0.698
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 13.200177431106567
Epoch: 9, Steps: 13 | Train Loss: 0.137 Vali Loss: 0.633 Vali Acc: 0.746 Test Loss: 0.633 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 13.583272933959961
Epoch: 10, Steps: 13 | Train Loss: 0.096 Vali Loss: 0.667 Vali Acc: 0.673 Test Loss: 0.667 Test Acc: 0.673
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 13.473675966262817
Epoch: 11, Steps: 13 | Train Loss: 0.081 Vali Loss: 0.786 Vali Acc: 0.751 Test Loss: 0.786 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 12.672117471694946
Epoch: 12, Steps: 13 | Train Loss: 0.076 Vali Loss: 0.744 Vali Acc: 0.717 Test Loss: 0.744 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 13.117900609970093
Epoch: 13, Steps: 13 | Train Loss: 0.040 Vali Loss: 0.863 Vali Acc: 0.746 Test Loss: 0.863 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 13.510236501693726
Epoch: 14, Steps: 13 | Train Loss: 0.020 Vali Loss: 0.749 Vali Acc: 0.712 Test Loss: 0.749 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 13.168724060058594
Epoch: 15, Steps: 13 | Train Loss: 0.018 Vali Loss: 0.785 Vali Acc: 0.717 Test Loss: 0.785 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 8325314
model size : 33.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 21.379550457000732
Epoch: 1, Steps: 13 | Train Loss: 0.651 Vali Loss: 0.662 Vali Acc: 0.712 Test Loss: 0.662 Test Acc: 0.712
Validation loss decreased (inf --> -0.712188).  Saving model ...
Epoch: 2 cost time: 19.382630586624146
Epoch: 2, Steps: 13 | Train Loss: 0.573 Vali Loss: 0.549 Vali Acc: 0.737 Test Loss: 0.549 Test Acc: 0.737
Validation loss decreased (-0.712188 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 17.8004207611084
Epoch: 3, Steps: 13 | Train Loss: 0.464 Vali Loss: 0.504 Vali Acc: 0.756 Test Loss: 0.504 Test Acc: 0.756
Validation loss decreased (-0.736580 --> -0.756093).  Saving model ...
Epoch: 4 cost time: 18.663551807403564
Epoch: 4, Steps: 13 | Train Loss: 0.386 Vali Loss: 0.524 Vali Acc: 0.756 Test Loss: 0.524 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 17.710062503814697
Epoch: 5, Steps: 13 | Train Loss: 0.466 Vali Loss: 0.529 Vali Acc: 0.766 Test Loss: 0.529 Test Acc: 0.766
Validation loss decreased (-0.756093 --> -0.765848).  Saving model ...
Epoch: 6 cost time: 17.417346954345703
Epoch: 6, Steps: 13 | Train Loss: 0.550 Vali Loss: 0.547 Vali Acc: 0.771 Test Loss: 0.547 Test Acc: 0.771
Validation loss decreased (-0.765848 --> -0.770726).  Saving model ...
Epoch: 7 cost time: 18.40087366104126
Epoch: 7, Steps: 13 | Train Loss: 0.259 Vali Loss: 0.713 Vali Acc: 0.746 Test Loss: 0.713 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 17.20894765853882
Epoch: 8, Steps: 13 | Train Loss: 0.238 Vali Loss: 0.572 Vali Acc: 0.717 Test Loss: 0.572 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 18.313528060913086
Epoch: 9, Steps: 13 | Train Loss: 0.187 Vali Loss: 0.734 Vali Acc: 0.629 Test Loss: 0.734 Test Acc: 0.629
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 17.837708950042725
Epoch: 10, Steps: 13 | Train Loss: 0.275 Vali Loss: 1.027 Vali Acc: 0.722 Test Loss: 1.027 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 16.802286386489868
Epoch: 11, Steps: 13 | Train Loss: 0.563 Vali Loss: 0.887 Vali Acc: 0.766 Test Loss: 0.887 Test Acc: 0.766
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 18.2264621257782
Epoch: 12, Steps: 13 | Train Loss: 0.155 Vali Loss: 0.747 Vali Acc: 0.712 Test Loss: 0.747 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 18.154252529144287
Epoch: 13, Steps: 13 | Train Loss: 0.150 Vali Loss: 0.840 Vali Acc: 0.654 Test Loss: 0.840 Test Acc: 0.654
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 17.413177013397217
Epoch: 14, Steps: 13 | Train Loss: 0.409 Vali Loss: 0.809 Vali Acc: 0.717 Test Loss: 0.809 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 17.326024055480957
Epoch: 15, Steps: 13 | Train Loss: 0.097 Vali Loss: 0.933 Vali Acc: 0.732 Test Loss: 0.933 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 17.56606388092041
Epoch: 16, Steps: 13 | Train Loss: 0.479 Vali Loss: 0.927 Vali Acc: 0.707 Test Loss: 0.927 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 28184642
model size : 108.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 9.842835903167725
Epoch: 1, Steps: 13 | Train Loss: 0.596 Vali Loss: 0.562 Vali Acc: 0.722 Test Loss: 0.562 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 7.741680145263672
Epoch: 2, Steps: 13 | Train Loss: 0.516 Vali Loss: 0.533 Vali Acc: 0.737 Test Loss: 0.533 Test Acc: 0.737
Validation loss decreased (-0.721946 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 7.761401653289795
Epoch: 3, Steps: 13 | Train Loss: 0.467 Vali Loss: 0.753 Vali Acc: 0.512 Test Loss: 0.753 Test Acc: 0.512
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.979422092437744
Epoch: 4, Steps: 13 | Train Loss: 0.410 Vali Loss: 0.550 Vali Acc: 0.702 Test Loss: 0.550 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.451390743255615
Epoch: 5, Steps: 13 | Train Loss: 0.403 Vali Loss: 0.542 Vali Acc: 0.756 Test Loss: 0.542 Test Acc: 0.756
Validation loss decreased (-0.736580 --> -0.756092).  Saving model ...
Epoch: 6 cost time: 7.988249778747559
Epoch: 6, Steps: 13 | Train Loss: 0.303 Vali Loss: 0.694 Vali Acc: 0.732 Test Loss: 0.694 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.87002420425415
Epoch: 7, Steps: 13 | Train Loss: 0.224 Vali Loss: 0.535 Vali Acc: 0.732 Test Loss: 0.535 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 7.62593936920166
Epoch: 8, Steps: 13 | Train Loss: 0.182 Vali Loss: 0.682 Vali Acc: 0.629 Test Loss: 0.682 Test Acc: 0.629
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 8.00876784324646
Epoch: 9, Steps: 13 | Train Loss: 0.443 Vali Loss: 0.632 Vali Acc: 0.698 Test Loss: 0.632 Test Acc: 0.698
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 7.5100250244140625
Epoch: 10, Steps: 13 | Train Loss: 0.139 Vali Loss: 0.791 Vali Acc: 0.746 Test Loss: 0.791 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 7.570614337921143
Epoch: 11, Steps: 13 | Train Loss: 0.118 Vali Loss: 0.660 Vali Acc: 0.693 Test Loss: 0.660 Test Acc: 0.693
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 7.784123182296753
Epoch: 12, Steps: 13 | Train Loss: 0.203 Vali Loss: 0.713 Vali Acc: 0.707 Test Loss: 0.713 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 7.66145658493042
Epoch: 13, Steps: 13 | Train Loss: 0.133 Vali Loss: 0.781 Vali Acc: 0.727 Test Loss: 0.781 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 8.148605108261108
Epoch: 14, Steps: 13 | Train Loss: 0.024 Vali Loss: 0.776 Vali Acc: 0.722 Test Loss: 0.776 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 7.642110109329224
Epoch: 15, Steps: 13 | Train Loss: 0.112 Vali Loss: 0.805 Vali Acc: 0.717 Test Loss: 0.805 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 8325314
model size : 33.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 22.804090976715088
Epoch: 1, Steps: 13 | Train Loss: 0.606 Vali Loss: 0.562 Vali Acc: 0.712 Test Loss: 0.562 Test Acc: 0.712
Validation loss decreased (inf --> -0.712190).  Saving model ...
Epoch: 2 cost time: 21.690610885620117
Epoch: 2, Steps: 13 | Train Loss: 0.518 Vali Loss: 0.552 Vali Acc: 0.741 Test Loss: 0.552 Test Acc: 0.741
Validation loss decreased (-0.712190 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 20.77281379699707
Epoch: 3, Steps: 13 | Train Loss: 0.427 Vali Loss: 0.503 Vali Acc: 0.776 Test Loss: 0.503 Test Acc: 0.776
Validation loss decreased (-0.741458 --> -0.775605).  Saving model ...
Epoch: 4 cost time: 21.551087141036987
Epoch: 4, Steps: 13 | Train Loss: 0.342 Vali Loss: 0.498 Vali Acc: 0.776 Test Loss: 0.498 Test Acc: 0.776
Validation loss decreased (-0.775605 --> -0.775605).  Saving model ...
Epoch: 5 cost time: 21.03728413581848
Epoch: 5, Steps: 13 | Train Loss: 0.311 Vali Loss: 0.512 Vali Acc: 0.756 Test Loss: 0.512 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 21.874942779541016
Epoch: 6, Steps: 13 | Train Loss: 0.234 Vali Loss: 0.561 Vali Acc: 0.766 Test Loss: 0.561 Test Acc: 0.766
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 22.125096797943115
Epoch: 7, Steps: 13 | Train Loss: 0.198 Vali Loss: 0.651 Vali Acc: 0.766 Test Loss: 0.651 Test Acc: 0.766
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 22.676229238510132
Epoch: 8, Steps: 13 | Train Loss: 0.264 Vali Loss: 0.663 Vali Acc: 0.761 Test Loss: 0.663 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 23.10203742980957
Epoch: 9, Steps: 13 | Train Loss: 0.154 Vali Loss: 0.616 Vali Acc: 0.761 Test Loss: 0.616 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 22.210309743881226
Epoch: 10, Steps: 13 | Train Loss: 0.130 Vali Loss: 0.617 Vali Acc: 0.688 Test Loss: 0.617 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 23.75212001800537
Epoch: 11, Steps: 13 | Train Loss: 0.084 Vali Loss: 0.677 Vali Acc: 0.756 Test Loss: 0.677 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 23.384060382843018
Epoch: 12, Steps: 13 | Train Loss: 0.065 Vali Loss: 0.793 Vali Acc: 0.644 Test Loss: 0.793 Test Acc: 0.644
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 23.60842204093933
Epoch: 13, Steps: 13 | Train Loss: 0.065 Vali Loss: 0.693 Vali Acc: 0.698 Test Loss: 0.693 Test Acc: 0.698
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 23.76313614845276
Epoch: 14, Steps: 13 | Train Loss: 0.030 Vali Loss: 0.843 Vali Acc: 0.737 Test Loss: 0.843 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 14124866
model size : 55.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 11.683616876602173
Epoch: 1, Steps: 13 | Train Loss: 0.624 Vali Loss: 0.557 Vali Acc: 0.722 Test Loss: 0.557 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 9.686111211776733
Epoch: 2, Steps: 13 | Train Loss: 0.503 Vali Loss: 0.567 Vali Acc: 0.732 Test Loss: 0.567 Test Acc: 0.732
Validation loss decreased (-0.721946 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 10.059154272079468
Epoch: 3, Steps: 13 | Train Loss: 0.465 Vali Loss: 0.524 Vali Acc: 0.771 Test Loss: 0.524 Test Acc: 0.771
Validation loss decreased (-0.731702 --> -0.770726).  Saving model ...
Epoch: 4 cost time: 9.18742561340332
Epoch: 4, Steps: 13 | Train Loss: 0.354 Vali Loss: 0.552 Vali Acc: 0.698 Test Loss: 0.552 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.614725112915039
Epoch: 5, Steps: 13 | Train Loss: 0.302 Vali Loss: 0.522 Vali Acc: 0.712 Test Loss: 0.522 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 9.353803157806396
Epoch: 6, Steps: 13 | Train Loss: 0.269 Vali Loss: 0.663 Vali Acc: 0.751 Test Loss: 0.663 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 9.673165082931519
Epoch: 7, Steps: 13 | Train Loss: 0.193 Vali Loss: 0.684 Vali Acc: 0.761 Test Loss: 0.684 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 9.517984390258789
Epoch: 8, Steps: 13 | Train Loss: 0.228 Vali Loss: 0.786 Vali Acc: 0.756 Test Loss: 0.786 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 8.979975700378418
Epoch: 9, Steps: 13 | Train Loss: 0.274 Vali Loss: 0.899 Vali Acc: 0.751 Test Loss: 0.899 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 9.291295766830444
Epoch: 10, Steps: 13 | Train Loss: 0.167 Vali Loss: 0.653 Vali Acc: 0.683 Test Loss: 0.653 Test Acc: 0.683
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 8.799651622772217
Epoch: 11, Steps: 13 | Train Loss: 0.098 Vali Loss: 0.790 Vali Acc: 0.751 Test Loss: 0.790 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 10.161551475524902
Epoch: 12, Steps: 13 | Train Loss: 0.061 Vali Loss: 0.760 Vali Acc: 0.727 Test Loss: 0.760 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 9.987247228622437
Epoch: 13, Steps: 13 | Train Loss: 0.050 Vali Loss: 0.724 Vali Acc: 0.693 Test Loss: 0.724 Test Acc: 0.693
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 4195010
model size : 17.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 20.082659006118774
Epoch: 1, Steps: 13 | Train Loss: 0.606 Vali Loss: 0.561 Vali Acc: 0.712 Test Loss: 0.561 Test Acc: 0.712
Validation loss decreased (inf --> -0.712190).  Saving model ...
Epoch: 2 cost time: 18.900046586990356
Epoch: 2, Steps: 13 | Train Loss: 0.521 Vali Loss: 0.558 Vali Acc: 0.737 Test Loss: 0.558 Test Acc: 0.737
Validation loss decreased (-0.712190 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 13.69051218032837
Epoch: 3, Steps: 13 | Train Loss: 0.441 Vali Loss: 0.506 Vali Acc: 0.766 Test Loss: 0.506 Test Acc: 0.766
Validation loss decreased (-0.736580 --> -0.765849).  Saving model ...
Epoch: 4 cost time: 19.08405113220215
Epoch: 4, Steps: 13 | Train Loss: 0.353 Vali Loss: 0.498 Vali Acc: 0.751 Test Loss: 0.498 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 19.58484387397766
Epoch: 5, Steps: 13 | Train Loss: 0.310 Vali Loss: 0.509 Vali Acc: 0.771 Test Loss: 0.509 Test Acc: 0.771
Validation loss decreased (-0.765849 --> -0.770727).  Saving model ...
Epoch: 6 cost time: 20.03823494911194
Epoch: 6, Steps: 13 | Train Loss: 0.242 Vali Loss: 0.511 Vali Acc: 0.761 Test Loss: 0.511 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 19.159210443496704
Epoch: 7, Steps: 13 | Train Loss: 0.216 Vali Loss: 0.647 Vali Acc: 0.766 Test Loss: 0.647 Test Acc: 0.766
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 18.694904565811157
Epoch: 8, Steps: 13 | Train Loss: 0.214 Vali Loss: 0.538 Vali Acc: 0.717 Test Loss: 0.538 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 19.367923259735107
Epoch: 9, Steps: 13 | Train Loss: 0.171 Vali Loss: 0.599 Vali Acc: 0.702 Test Loss: 0.599 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 20.056647777557373
Epoch: 10, Steps: 13 | Train Loss: 0.136 Vali Loss: 0.620 Vali Acc: 0.737 Test Loss: 0.620 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 19.66437602043152
Epoch: 11, Steps: 13 | Train Loss: 0.067 Vali Loss: 0.652 Vali Acc: 0.741 Test Loss: 0.652 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 19.343005895614624
Epoch: 12, Steps: 13 | Train Loss: 0.140 Vali Loss: 0.758 Vali Acc: 0.639 Test Loss: 0.758 Test Acc: 0.639
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 18.09169912338257
Epoch: 13, Steps: 13 | Train Loss: 0.062 Vali Loss: 0.631 Vali Acc: 0.717 Test Loss: 0.631 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 19.977922439575195
Epoch: 14, Steps: 13 | Train Loss: 0.057 Vali Loss: 0.708 Vali Acc: 0.751 Test Loss: 0.708 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 19.351141691207886
Epoch: 15, Steps: 13 | Train Loss: 0.030 Vali Loss: 0.758 Vali Acc: 0.737 Test Loss: 0.758 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 14124866
model size : 55.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 10.284759759902954
Epoch: 1, Steps: 13 | Train Loss: 0.623 Vali Loss: 0.559 Vali Acc: 0.722 Test Loss: 0.559 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 7.6734724044799805
Epoch: 2, Steps: 13 | Train Loss: 0.505 Vali Loss: 0.563 Vali Acc: 0.727 Test Loss: 0.563 Test Acc: 0.727
Validation loss decreased (-0.721946 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 7.6447365283966064
Epoch: 3, Steps: 13 | Train Loss: 0.466 Vali Loss: 0.521 Vali Acc: 0.737 Test Loss: 0.521 Test Acc: 0.737
Validation loss decreased (-0.726824 --> -0.736580).  Saving model ...
Epoch: 4 cost time: 7.831379175186157
Epoch: 4, Steps: 13 | Train Loss: 0.358 Vali Loss: 0.551 Vali Acc: 0.698 Test Loss: 0.551 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.465821504592896
Epoch: 5, Steps: 13 | Train Loss: 0.337 Vali Loss: 0.547 Vali Acc: 0.712 Test Loss: 0.547 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 8.214316606521606
Epoch: 6, Steps: 13 | Train Loss: 0.279 Vali Loss: 0.638 Vali Acc: 0.766 Test Loss: 0.638 Test Acc: 0.766
Validation loss decreased (-0.736580 --> -0.765847).  Saving model ...
Epoch: 7 cost time: 8.252441167831421
Epoch: 7, Steps: 13 | Train Loss: 0.211 Vali Loss: 0.765 Vali Acc: 0.741 Test Loss: 0.765 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.161587953567505
Epoch: 8, Steps: 13 | Train Loss: 0.235 Vali Loss: 0.664 Vali Acc: 0.776 Test Loss: 0.664 Test Acc: 0.776
Validation loss decreased (-0.765847 --> -0.775603).  Saving model ...
Epoch: 9 cost time: 8.446704149246216
Epoch: 9, Steps: 13 | Train Loss: 0.169 Vali Loss: 0.620 Vali Acc: 0.751 Test Loss: 0.620 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 8.206772327423096
Epoch: 10, Steps: 13 | Train Loss: 0.156 Vali Loss: 0.750 Vali Acc: 0.595 Test Loss: 0.750 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 8.102163553237915
Epoch: 11, Steps: 13 | Train Loss: 0.093 Vali Loss: 0.790 Vali Acc: 0.756 Test Loss: 0.790 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 7.503525257110596
Epoch: 12, Steps: 13 | Train Loss: 0.060 Vali Loss: 0.700 Vali Acc: 0.727 Test Loss: 0.700 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 7.781074047088623
Epoch: 13, Steps: 13 | Train Loss: 0.039 Vali Loss: 0.846 Vali Acc: 0.610 Test Loss: 0.846 Test Acc: 0.610
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 7.8549394607543945
Epoch: 14, Steps: 13 | Train Loss: 0.051 Vali Loss: 0.890 Vali Acc: 0.737 Test Loss: 0.890 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 8.205543041229248
Epoch: 15, Steps: 13 | Train Loss: 0.035 Vali Loss: 0.896 Vali Acc: 0.629 Test Loss: 0.896 Test Acc: 0.629
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 8.245200872421265
Epoch: 16, Steps: 13 | Train Loss: 0.030 Vali Loss: 0.825 Vali Acc: 0.712 Test Loss: 0.825 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 8.43082332611084
Epoch: 17, Steps: 13 | Train Loss: 0.016 Vali Loss: 0.880 Vali Acc: 0.712 Test Loss: 0.880 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 8.413488864898682
Epoch: 18, Steps: 13 | Train Loss: 0.010 Vali Loss: 0.988 Vali Acc: 0.722 Test Loss: 0.988 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 4195010
model size : 17.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 12.859022378921509
Epoch: 1, Steps: 13 | Train Loss: 0.606 Vali Loss: 0.561 Vali Acc: 0.712 Test Loss: 0.561 Test Acc: 0.712
Validation loss decreased (inf --> -0.712190).  Saving model ...
Epoch: 2 cost time: 11.257328510284424
Epoch: 2, Steps: 13 | Train Loss: 0.528 Vali Loss: 0.524 Vali Acc: 0.761 Test Loss: 0.524 Test Acc: 0.761
Validation loss decreased (-0.712190 --> -0.760970).  Saving model ...
Epoch: 3 cost time: 10.8865487575531
Epoch: 3, Steps: 13 | Train Loss: 0.474 Vali Loss: 0.512 Vali Acc: 0.751 Test Loss: 0.512 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.200659990310669
Epoch: 4, Steps: 13 | Train Loss: 0.368 Vali Loss: 0.495 Vali Acc: 0.766 Test Loss: 0.495 Test Acc: 0.766
Validation loss decreased (-0.760970 --> -0.765849).  Saving model ...
Epoch: 5 cost time: 12.025578022003174
Epoch: 5, Steps: 13 | Train Loss: 0.303 Vali Loss: 0.515 Vali Acc: 0.771 Test Loss: 0.515 Test Acc: 0.771
Validation loss decreased (-0.765849 --> -0.770727).  Saving model ...
Epoch: 6 cost time: 11.597770690917969
Epoch: 6, Steps: 13 | Train Loss: 0.320 Vali Loss: 0.510 Vali Acc: 0.756 Test Loss: 0.510 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 11.623002290725708
Epoch: 7, Steps: 13 | Train Loss: 0.260 Vali Loss: 0.733 Vali Acc: 0.595 Test Loss: 0.733 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 12.014840841293335
Epoch: 8, Steps: 13 | Train Loss: 0.175 Vali Loss: 0.543 Vali Acc: 0.727 Test Loss: 0.543 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 11.571557521820068
Epoch: 9, Steps: 13 | Train Loss: 0.295 Vali Loss: 0.800 Vali Acc: 0.732 Test Loss: 0.800 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 10.701349973678589
Epoch: 10, Steps: 13 | Train Loss: 0.151 Vali Loss: 0.612 Vali Acc: 0.746 Test Loss: 0.612 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 11.172200918197632
Epoch: 11, Steps: 13 | Train Loss: 0.367 Vali Loss: 0.629 Vali Acc: 0.737 Test Loss: 0.629 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 11.85811972618103
Epoch: 12, Steps: 13 | Train Loss: 0.082 Vali Loss: 0.712 Vali Acc: 0.654 Test Loss: 0.712 Test Acc: 0.654
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 11.493299007415771
Epoch: 13, Steps: 13 | Train Loss: 0.144 Vali Loss: 0.677 Vali Acc: 0.698 Test Loss: 0.677 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 11.68997311592102
Epoch: 14, Steps: 13 | Train Loss: 0.061 Vali Loss: 0.681 Vali Acc: 0.722 Test Loss: 0.681 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 11.82002878189087
Epoch: 15, Steps: 13 | Train Loss: 0.241 Vali Loss: 0.703 Vali Acc: 0.727 Test Loss: 0.703 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 14124866
model size : 55.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.455088138580322
Epoch: 1, Steps: 13 | Train Loss: 0.622 Vali Loss: 0.561 Vali Acc: 0.717 Test Loss: 0.561 Test Acc: 0.717
Validation loss decreased (inf --> -0.717068).  Saving model ...
Epoch: 2 cost time: 5.303924322128296
Epoch: 2, Steps: 13 | Train Loss: 0.510 Vali Loss: 0.557 Vali Acc: 0.761 Test Loss: 0.557 Test Acc: 0.761
Validation loss decreased (-0.717068 --> -0.760970).  Saving model ...
Epoch: 3 cost time: 5.201352119445801
Epoch: 3, Steps: 13 | Train Loss: 0.462 Vali Loss: 0.524 Vali Acc: 0.737 Test Loss: 0.524 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.492741107940674
Epoch: 4, Steps: 13 | Train Loss: 0.359 Vali Loss: 0.528 Vali Acc: 0.727 Test Loss: 0.528 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.602803945541382
Epoch: 5, Steps: 13 | Train Loss: 0.341 Vali Loss: 0.517 Vali Acc: 0.712 Test Loss: 0.517 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.504096031188965
Epoch: 6, Steps: 13 | Train Loss: 0.279 Vali Loss: 0.646 Vali Acc: 0.756 Test Loss: 0.646 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.734423398971558
Epoch: 7, Steps: 13 | Train Loss: 0.205 Vali Loss: 0.596 Vali Acc: 0.756 Test Loss: 0.596 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.674700975418091
Epoch: 8, Steps: 13 | Train Loss: 0.152 Vali Loss: 0.575 Vali Acc: 0.707 Test Loss: 0.575 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.707449197769165
Epoch: 9, Steps: 13 | Train Loss: 0.147 Vali Loss: 0.605 Vali Acc: 0.737 Test Loss: 0.605 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.359806537628174
Epoch: 10, Steps: 13 | Train Loss: 0.137 Vali Loss: 1.016 Vali Acc: 0.522 Test Loss: 1.016 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.529359579086304
Epoch: 11, Steps: 13 | Train Loss: 0.103 Vali Loss: 0.884 Vali Acc: 0.766 Test Loss: 0.884 Test Acc: 0.766
Validation loss decreased (-0.760970 --> -0.765845).  Saving model ...
Epoch: 12 cost time: 5.378004789352417
Epoch: 12, Steps: 13 | Train Loss: 0.092 Vali Loss: 0.816 Vali Acc: 0.746 Test Loss: 0.816 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.250412702560425
Epoch: 13, Steps: 13 | Train Loss: 0.072 Vali Loss: 0.819 Vali Acc: 0.644 Test Loss: 0.819 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.491863965988159
Epoch: 14, Steps: 13 | Train Loss: 0.066 Vali Loss: 0.801 Vali Acc: 0.707 Test Loss: 0.801 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.8927741050720215
Epoch: 15, Steps: 13 | Train Loss: 0.023 Vali Loss: 0.789 Vali Acc: 0.727 Test Loss: 0.789 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.76563024520874
Epoch: 16, Steps: 13 | Train Loss: 0.024 Vali Loss: 0.909 Vali Acc: 0.722 Test Loss: 0.909 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.125269889831543
Epoch: 17, Steps: 13 | Train Loss: 0.017 Vali Loss: 0.873 Vali Acc: 0.712 Test Loss: 0.873 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.905503034591675
Epoch: 18, Steps: 13 | Train Loss: 0.007 Vali Loss: 0.956 Vali Acc: 0.732 Test Loss: 0.956 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.0624470710754395
Epoch: 19, Steps: 13 | Train Loss: 0.015 Vali Loss: 0.938 Vali Acc: 0.698 Test Loss: 0.938 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.585118055343628
Epoch: 20, Steps: 13 | Train Loss: 0.041 Vali Loss: 1.099 Vali Acc: 0.624 Test Loss: 1.099 Test Acc: 0.624
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.293335437774658
Epoch: 21, Steps: 13 | Train Loss: 0.098 Vali Loss: 1.067 Vali Acc: 0.634 Test Loss: 1.067 Test Acc: 0.634
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 4195010
model size : 17.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 17.733884811401367
Epoch: 1, Steps: 13 | Train Loss: 0.664 Vali Loss: 0.577 Vali Acc: 0.732 Test Loss: 0.577 Test Acc: 0.732
Validation loss decreased (inf --> -0.731702).  Saving model ...
Epoch: 2 cost time: 16.05208110809326
Epoch: 2, Steps: 13 | Train Loss: 0.531 Vali Loss: 0.520 Vali Acc: 0.756 Test Loss: 0.520 Test Acc: 0.756
Validation loss decreased (-0.731702 --> -0.756092).  Saving model ...
Epoch: 3 cost time: 15.5062837600708
Epoch: 3, Steps: 13 | Train Loss: 0.463 Vali Loss: 0.499 Vali Acc: 0.776 Test Loss: 0.499 Test Acc: 0.776
Validation loss decreased (-0.756092 --> -0.775605).  Saving model ...
Epoch: 4 cost time: 15.38086724281311
Epoch: 4, Steps: 13 | Train Loss: 0.387 Vali Loss: 0.558 Vali Acc: 0.693 Test Loss: 0.558 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 16.216976642608643
Epoch: 5, Steps: 13 | Train Loss: 0.317 Vali Loss: 0.565 Vali Acc: 0.766 Test Loss: 0.565 Test Acc: 0.766
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 16.378339529037476
Epoch: 6, Steps: 13 | Train Loss: 0.264 Vali Loss: 0.644 Vali Acc: 0.610 Test Loss: 0.644 Test Acc: 0.610
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 16.358224391937256
Epoch: 7, Steps: 13 | Train Loss: 0.269 Vali Loss: 0.657 Vali Acc: 0.761 Test Loss: 0.657 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 16.76029372215271
Epoch: 8, Steps: 13 | Train Loss: 0.292 Vali Loss: 0.719 Vali Acc: 0.761 Test Loss: 0.719 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 15.329315423965454
Epoch: 9, Steps: 13 | Train Loss: 0.232 Vali Loss: 0.686 Vali Acc: 0.761 Test Loss: 0.686 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 15.149894952774048
Epoch: 10, Steps: 13 | Train Loss: 0.115 Vali Loss: 0.685 Vali Acc: 0.702 Test Loss: 0.685 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 15.911111116409302
Epoch: 11, Steps: 13 | Train Loss: 0.087 Vali Loss: 0.730 Vali Acc: 0.668 Test Loss: 0.730 Test Acc: 0.668
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 15.694883823394775
Epoch: 12, Steps: 13 | Train Loss: 0.073 Vali Loss: 0.783 Vali Acc: 0.756 Test Loss: 0.783 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 15.921812057495117
Epoch: 13, Steps: 13 | Train Loss: 0.045 Vali Loss: 0.918 Vali Acc: 0.698 Test Loss: 0.918 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 7094978
model size : 28.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.11358094215393
Epoch: 1, Steps: 13 | Train Loss: 0.659 Vali Loss: 0.613 Vali Acc: 0.712 Test Loss: 0.613 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 6.800984621047974
Epoch: 2, Steps: 13 | Train Loss: 0.546 Vali Loss: 0.523 Vali Acc: 0.751 Test Loss: 0.523 Test Acc: 0.751
Validation loss decreased (-0.712189 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 6.367992877960205
Epoch: 3, Steps: 13 | Train Loss: 0.433 Vali Loss: 0.502 Vali Acc: 0.776 Test Loss: 0.502 Test Acc: 0.776
Validation loss decreased (-0.751214 --> -0.775605).  Saving model ...
Epoch: 4 cost time: 7.370632886886597
Epoch: 4, Steps: 13 | Train Loss: 0.396 Vali Loss: 0.511 Vali Acc: 0.761 Test Loss: 0.511 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.0681376457214355
Epoch: 5, Steps: 13 | Train Loss: 0.334 Vali Loss: 0.514 Vali Acc: 0.741 Test Loss: 0.514 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.214009761810303
Epoch: 6, Steps: 13 | Train Loss: 0.295 Vali Loss: 0.542 Vali Acc: 0.776 Test Loss: 0.542 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 7.125748157501221
Epoch: 7, Steps: 13 | Train Loss: 0.218 Vali Loss: 0.700 Vali Acc: 0.761 Test Loss: 0.700 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 6.916869878768921
Epoch: 8, Steps: 13 | Train Loss: 0.286 Vali Loss: 0.616 Vali Acc: 0.761 Test Loss: 0.616 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 7.355071544647217
Epoch: 9, Steps: 13 | Train Loss: 0.185 Vali Loss: 0.968 Vali Acc: 0.746 Test Loss: 0.968 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 6.84840989112854
Epoch: 10, Steps: 13 | Train Loss: 0.218 Vali Loss: 0.737 Vali Acc: 0.780 Test Loss: 0.737 Test Acc: 0.780
Validation loss decreased (-0.775605 --> -0.780480).  Saving model ...
Epoch: 11 cost time: 7.3794472217559814
Epoch: 11, Steps: 13 | Train Loss: 0.130 Vali Loss: 0.640 Vali Acc: 0.717 Test Loss: 0.640 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.197546720504761
Epoch: 12, Steps: 13 | Train Loss: 0.072 Vali Loss: 0.650 Vali Acc: 0.727 Test Loss: 0.650 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.194484233856201
Epoch: 13, Steps: 13 | Train Loss: 0.088 Vali Loss: 0.863 Vali Acc: 0.600 Test Loss: 0.863 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.541519641876221
Epoch: 14, Steps: 13 | Train Loss: 0.074 Vali Loss: 0.691 Vali Acc: 0.702 Test Loss: 0.691 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.700072765350342
Epoch: 15, Steps: 13 | Train Loss: 0.044 Vali Loss: 0.893 Vali Acc: 0.761 Test Loss: 0.893 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 7.138119220733643
Epoch: 16, Steps: 13 | Train Loss: 0.066 Vali Loss: 1.189 Vali Acc: 0.776 Test Loss: 1.189 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 6.868515968322754
Epoch: 17, Steps: 13 | Train Loss: 0.087 Vali Loss: 0.966 Vali Acc: 0.751 Test Loss: 0.966 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 6.949245929718018
Epoch: 18, Steps: 13 | Train Loss: 0.019 Vali Loss: 0.810 Vali Acc: 0.712 Test Loss: 0.810 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 6.919129848480225
Epoch: 19, Steps: 13 | Train Loss: 0.036 Vali Loss: 0.871 Vali Acc: 0.717 Test Loss: 0.871 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 6.747349977493286
Epoch: 20, Steps: 13 | Train Loss: 0.028 Vali Loss: 0.966 Vali Acc: 0.717 Test Loss: 0.966 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7804878048780488
model parameter : 2129858
model size : 9.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 13.197917699813843
Epoch: 1, Steps: 13 | Train Loss: 0.665 Vali Loss: 0.579 Vali Acc: 0.732 Test Loss: 0.579 Test Acc: 0.732
Validation loss decreased (inf --> -0.731702).  Saving model ...
Epoch: 2 cost time: 10.895281076431274
Epoch: 2, Steps: 13 | Train Loss: 0.535 Vali Loss: 0.528 Vali Acc: 0.751 Test Loss: 0.528 Test Acc: 0.751
Validation loss decreased (-0.731702 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 12.113045692443848
Epoch: 3, Steps: 13 | Train Loss: 0.471 Vali Loss: 0.514 Vali Acc: 0.766 Test Loss: 0.514 Test Acc: 0.766
Validation loss decreased (-0.751214 --> -0.765849).  Saving model ...
Epoch: 4 cost time: 12.055910110473633
Epoch: 4, Steps: 13 | Train Loss: 0.402 Vali Loss: 0.555 Vali Acc: 0.717 Test Loss: 0.555 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 11.930976152420044
Epoch: 5, Steps: 13 | Train Loss: 0.342 Vali Loss: 0.602 Vali Acc: 0.756 Test Loss: 0.602 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 12.389520645141602
Epoch: 6, Steps: 13 | Train Loss: 0.268 Vali Loss: 0.575 Vali Acc: 0.688 Test Loss: 0.575 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 12.0594482421875
Epoch: 7, Steps: 13 | Train Loss: 0.287 Vali Loss: 0.584 Vali Acc: 0.780 Test Loss: 0.584 Test Acc: 0.780
Validation loss decreased (-0.765849 --> -0.780482).  Saving model ...
Epoch: 8 cost time: 11.660154342651367
Epoch: 8, Steps: 13 | Train Loss: 0.260 Vali Loss: 0.723 Vali Acc: 0.761 Test Loss: 0.723 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 9.45876407623291
Epoch: 9, Steps: 13 | Train Loss: 0.274 Vali Loss: 0.599 Vali Acc: 0.746 Test Loss: 0.599 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 12.394674062728882
Epoch: 10, Steps: 13 | Train Loss: 0.117 Vali Loss: 0.612 Vali Acc: 0.712 Test Loss: 0.612 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 12.563558340072632
Epoch: 11, Steps: 13 | Train Loss: 0.102 Vali Loss: 0.655 Vali Acc: 0.688 Test Loss: 0.655 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 13.059850454330444
Epoch: 12, Steps: 13 | Train Loss: 0.086 Vali Loss: 0.739 Vali Acc: 0.751 Test Loss: 0.739 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 12.556962490081787
Epoch: 13, Steps: 13 | Train Loss: 0.051 Vali Loss: 0.683 Vali Acc: 0.702 Test Loss: 0.683 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 12.736002445220947
Epoch: 14, Steps: 13 | Train Loss: 0.030 Vali Loss: 0.758 Vali Acc: 0.722 Test Loss: 0.758 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 12.343887090682983
Epoch: 15, Steps: 13 | Train Loss: 0.027 Vali Loss: 0.836 Vali Acc: 0.673 Test Loss: 0.836 Test Acc: 0.673
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 11.818441390991211
Epoch: 16, Steps: 13 | Train Loss: 0.029 Vali Loss: 0.862 Vali Acc: 0.727 Test Loss: 0.862 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 11.700502872467041
Epoch: 17, Steps: 13 | Train Loss: 0.015 Vali Loss: 0.838 Vali Acc: 0.668 Test Loss: 0.838 Test Acc: 0.668
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7804878048780488
model parameter : 7094978
model size : 28.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.789784669876099
Epoch: 1, Steps: 13 | Train Loss: 0.660 Vali Loss: 0.613 Vali Acc: 0.712 Test Loss: 0.613 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 5.557666778564453
Epoch: 2, Steps: 13 | Train Loss: 0.550 Vali Loss: 0.525 Vali Acc: 0.746 Test Loss: 0.525 Test Acc: 0.746
Validation loss decreased (-0.712189 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 5.701254844665527
Epoch: 3, Steps: 13 | Train Loss: 0.446 Vali Loss: 0.504 Vali Acc: 0.780 Test Loss: 0.504 Test Acc: 0.780
Validation loss decreased (-0.746336 --> -0.780483).  Saving model ...
Epoch: 4 cost time: 5.7788777351379395
Epoch: 4, Steps: 13 | Train Loss: 0.383 Vali Loss: 0.505 Vali Acc: 0.771 Test Loss: 0.505 Test Acc: 0.771
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.497560501098633
Epoch: 5, Steps: 13 | Train Loss: 0.334 Vali Loss: 0.507 Vali Acc: 0.741 Test Loss: 0.507 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.529078722000122
Epoch: 6, Steps: 13 | Train Loss: 0.292 Vali Loss: 0.522 Vali Acc: 0.771 Test Loss: 0.522 Test Acc: 0.771
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.711489200592041
Epoch: 7, Steps: 13 | Train Loss: 0.232 Vali Loss: 0.628 Vali Acc: 0.766 Test Loss: 0.628 Test Acc: 0.766
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.689458131790161
Epoch: 8, Steps: 13 | Train Loss: 0.211 Vali Loss: 0.722 Vali Acc: 0.751 Test Loss: 0.722 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.044265031814575
Epoch: 9, Steps: 13 | Train Loss: 0.214 Vali Loss: 0.779 Vali Acc: 0.746 Test Loss: 0.779 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.081970453262329
Epoch: 10, Steps: 13 | Train Loss: 0.191 Vali Loss: 0.713 Vali Acc: 0.761 Test Loss: 0.713 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.440398693084717
Epoch: 11, Steps: 13 | Train Loss: 0.115 Vali Loss: 0.632 Vali Acc: 0.707 Test Loss: 0.632 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.181382179260254
Epoch: 12, Steps: 13 | Train Loss: 0.079 Vali Loss: 0.780 Vali Acc: 0.746 Test Loss: 0.780 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.325619220733643
Epoch: 13, Steps: 13 | Train Loss: 0.070 Vali Loss: 0.656 Vali Acc: 0.702 Test Loss: 0.656 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7804878048780488
model parameter : 2129858
model size : 9.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.506626844406128
Epoch: 1, Steps: 13 | Train Loss: 0.664 Vali Loss: 0.580 Vali Acc: 0.732 Test Loss: 0.580 Test Acc: 0.732
Validation loss decreased (inf --> -0.731702).  Saving model ...
Epoch: 2 cost time: 7.015270471572876
Epoch: 2, Steps: 13 | Train Loss: 0.541 Vali Loss: 0.527 Vali Acc: 0.737 Test Loss: 0.527 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 7.1218132972717285
Epoch: 3, Steps: 13 | Train Loss: 0.475 Vali Loss: 0.513 Vali Acc: 0.741 Test Loss: 0.513 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741458).  Saving model ...
Epoch: 4 cost time: 6.8312084674835205
Epoch: 4, Steps: 13 | Train Loss: 0.408 Vali Loss: 0.568 Vali Acc: 0.717 Test Loss: 0.568 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.5362701416015625
Epoch: 5, Steps: 13 | Train Loss: 0.369 Vali Loss: 0.585 Vali Acc: 0.756 Test Loss: 0.585 Test Acc: 0.756
Validation loss decreased (-0.741458 --> -0.756092).  Saving model ...
Epoch: 6 cost time: 6.685407876968384
Epoch: 6, Steps: 13 | Train Loss: 0.282 Vali Loss: 0.703 Vali Acc: 0.585 Test Loss: 0.703 Test Acc: 0.585
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.461776971817017
Epoch: 7, Steps: 13 | Train Loss: 0.318 Vali Loss: 0.591 Vali Acc: 0.644 Test Loss: 0.591 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.918059587478638
Epoch: 8, Steps: 13 | Train Loss: 0.225 Vali Loss: 0.757 Vali Acc: 0.751 Test Loss: 0.757 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 7.171855926513672
Epoch: 9, Steps: 13 | Train Loss: 0.217 Vali Loss: 0.827 Vali Acc: 0.756 Test Loss: 0.827 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.894956588745117
Epoch: 10, Steps: 13 | Train Loss: 0.163 Vali Loss: 0.608 Vali Acc: 0.707 Test Loss: 0.608 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 7.271952867507935
Epoch: 11, Steps: 13 | Train Loss: 0.094 Vali Loss: 0.729 Vali Acc: 0.634 Test Loss: 0.729 Test Acc: 0.634
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 7.459846019744873
Epoch: 12, Steps: 13 | Train Loss: 0.094 Vali Loss: 0.732 Vali Acc: 0.741 Test Loss: 0.732 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 7.189087867736816
Epoch: 13, Steps: 13 | Train Loss: 0.055 Vali Loss: 0.729 Vali Acc: 0.702 Test Loss: 0.729 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 6.978287935256958
Epoch: 14, Steps: 13 | Train Loss: 0.033 Vali Loss: 0.781 Vali Acc: 0.722 Test Loss: 0.781 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 6.972349405288696
Epoch: 15, Steps: 13 | Train Loss: 0.059 Vali Loss: 0.797 Vali Acc: 0.717 Test Loss: 0.797 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 7094978
model size : 28.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.023109197616577
Epoch: 1, Steps: 13 | Train Loss: 0.660 Vali Loss: 0.612 Vali Acc: 0.712 Test Loss: 0.612 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 3.8125054836273193
Epoch: 2, Steps: 13 | Train Loss: 0.556 Vali Loss: 0.526 Vali Acc: 0.751 Test Loss: 0.526 Test Acc: 0.751
Validation loss decreased (-0.712189 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 3.7152178287506104
Epoch: 3, Steps: 13 | Train Loss: 0.449 Vali Loss: 0.504 Vali Acc: 0.780 Test Loss: 0.504 Test Acc: 0.780
Validation loss decreased (-0.751214 --> -0.780483).  Saving model ...
Epoch: 4 cost time: 3.6787943840026855
Epoch: 4, Steps: 13 | Train Loss: 0.387 Vali Loss: 0.503 Vali Acc: 0.771 Test Loss: 0.503 Test Acc: 0.771
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.88307785987854
Epoch: 5, Steps: 13 | Train Loss: 0.338 Vali Loss: 0.504 Vali Acc: 0.761 Test Loss: 0.504 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.674490451812744
Epoch: 6, Steps: 13 | Train Loss: 0.287 Vali Loss: 0.514 Vali Acc: 0.766 Test Loss: 0.514 Test Acc: 0.766
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.9253299236297607
Epoch: 7, Steps: 13 | Train Loss: 0.264 Vali Loss: 0.539 Vali Acc: 0.751 Test Loss: 0.539 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.9171760082244873
Epoch: 8, Steps: 13 | Train Loss: 0.195 Vali Loss: 0.584 Vali Acc: 0.751 Test Loss: 0.584 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.8026561737060547
Epoch: 9, Steps: 13 | Train Loss: 0.167 Vali Loss: 0.880 Vali Acc: 0.746 Test Loss: 0.880 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.648750066757202
Epoch: 10, Steps: 13 | Train Loss: 0.316 Vali Loss: 0.732 Vali Acc: 0.766 Test Loss: 0.732 Test Acc: 0.766
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.4190425872802734
Epoch: 11, Steps: 13 | Train Loss: 0.127 Vali Loss: 0.623 Vali Acc: 0.717 Test Loss: 0.623 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.6512508392333984
Epoch: 12, Steps: 13 | Train Loss: 0.108 Vali Loss: 0.884 Vali Acc: 0.751 Test Loss: 0.884 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.6987857818603516
Epoch: 13, Steps: 13 | Train Loss: 0.066 Vali Loss: 0.655 Vali Acc: 0.717 Test Loss: 0.655 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7804878048780488
model parameter : 2129858
model size : 9.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 19.78946852684021
Epoch: 1, Steps: 13 | Train Loss: 0.711 Vali Loss: 0.620 Vali Acc: 0.722 Test Loss: 0.620 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 20.271972179412842
Epoch: 2, Steps: 13 | Train Loss: 0.613 Vali Loss: 0.568 Vali Acc: 0.737 Test Loss: 0.568 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 20.818432331085205
Epoch: 3, Steps: 13 | Train Loss: 0.513 Vali Loss: 0.542 Vali Acc: 0.737 Test Loss: 0.542 Test Acc: 0.737
Validation loss decreased (-0.736580 --> -0.736580).  Saving model ...
Epoch: 4 cost time: 19.137420892715454
Epoch: 4, Steps: 13 | Train Loss: 0.473 Vali Loss: 0.585 Vali Acc: 0.688 Test Loss: 0.585 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 20.5432767868042
Epoch: 5, Steps: 13 | Train Loss: 0.434 Vali Loss: 0.689 Vali Acc: 0.561 Test Loss: 0.689 Test Acc: 0.561
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 20.522185564041138
Epoch: 6, Steps: 13 | Train Loss: 0.449 Vali Loss: 0.522 Vali Acc: 0.761 Test Loss: 0.522 Test Acc: 0.761
Validation loss decreased (-0.736580 --> -0.760970).  Saving model ...
Epoch: 7 cost time: 19.954597234725952
Epoch: 7, Steps: 13 | Train Loss: 0.341 Vali Loss: 0.538 Vali Acc: 0.717 Test Loss: 0.538 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 18.734723806381226
Epoch: 8, Steps: 13 | Train Loss: 0.298 Vali Loss: 0.561 Vali Acc: 0.727 Test Loss: 0.561 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 19.86336660385132
Epoch: 9, Steps: 13 | Train Loss: 0.260 Vali Loss: 0.547 Vali Acc: 0.751 Test Loss: 0.547 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 18.887266874313354
Epoch: 10, Steps: 13 | Train Loss: 0.211 Vali Loss: 0.577 Vali Acc: 0.702 Test Loss: 0.577 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 18.913294315338135
Epoch: 11, Steps: 13 | Train Loss: 0.164 Vali Loss: 0.646 Vali Acc: 0.756 Test Loss: 0.646 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 17.79108715057373
Epoch: 12, Steps: 13 | Train Loss: 0.175 Vali Loss: 0.631 Vali Acc: 0.717 Test Loss: 0.631 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 19.000327825546265
Epoch: 13, Steps: 13 | Train Loss: 0.123 Vali Loss: 0.662 Vali Acc: 0.663 Test Loss: 0.662 Test Acc: 0.663
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 19.26196527481079
Epoch: 14, Steps: 13 | Train Loss: 0.107 Vali Loss: 0.693 Vali Acc: 0.673 Test Loss: 0.693 Test Acc: 0.673
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 19.056488752365112
Epoch: 15, Steps: 13 | Train Loss: 0.112 Vali Loss: 0.854 Vali Acc: 0.756 Test Loss: 0.854 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 18.158394813537598
Epoch: 16, Steps: 13 | Train Loss: 0.063 Vali Loss: 0.768 Vali Acc: 0.688 Test Loss: 0.768 Test Acc: 0.688
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 7063586
model size : 27.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 11.531996965408325
Epoch: 1, Steps: 13 | Train Loss: 0.630 Vali Loss: 0.574 Vali Acc: 0.722 Test Loss: 0.574 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 9.743354797363281
Epoch: 2, Steps: 13 | Train Loss: 0.543 Vali Loss: 0.546 Vali Acc: 0.746 Test Loss: 0.546 Test Acc: 0.746
Validation loss decreased (-0.721945 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 8.548380136489868
Epoch: 3, Steps: 13 | Train Loss: 0.491 Vali Loss: 0.540 Vali Acc: 0.751 Test Loss: 0.540 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751214).  Saving model ...
Epoch: 4 cost time: 10.504641771316528
Epoch: 4, Steps: 13 | Train Loss: 0.443 Vali Loss: 0.552 Vali Acc: 0.741 Test Loss: 0.552 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.275794506072998
Epoch: 5, Steps: 13 | Train Loss: 0.408 Vali Loss: 0.513 Vali Acc: 0.771 Test Loss: 0.513 Test Acc: 0.771
Validation loss decreased (-0.751214 --> -0.770727).  Saving model ...
Epoch: 6 cost time: 9.781524658203125
Epoch: 6, Steps: 13 | Train Loss: 0.365 Vali Loss: 0.522 Vali Acc: 0.746 Test Loss: 0.522 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.69792103767395
Epoch: 7, Steps: 13 | Train Loss: 0.316 Vali Loss: 0.828 Vali Acc: 0.737 Test Loss: 0.828 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 9.843426942825317
Epoch: 8, Steps: 13 | Train Loss: 0.370 Vali Loss: 0.728 Vali Acc: 0.741 Test Loss: 0.728 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 7.66663122177124
Epoch: 9, Steps: 13 | Train Loss: 0.325 Vali Loss: 0.724 Vali Acc: 0.741 Test Loss: 0.724 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 9.545348167419434
Epoch: 10, Steps: 13 | Train Loss: 0.374 Vali Loss: 0.658 Vali Acc: 0.673 Test Loss: 0.658 Test Acc: 0.673
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 7.657073974609375
Epoch: 11, Steps: 13 | Train Loss: 0.196 Vali Loss: 0.612 Vali Acc: 0.761 Test Loss: 0.612 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 7.895895481109619
Epoch: 12, Steps: 13 | Train Loss: 0.174 Vali Loss: 0.591 Vali Acc: 0.771 Test Loss: 0.591 Test Acc: 0.771
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 10.714753150939941
Epoch: 13, Steps: 13 | Train Loss: 0.163 Vali Loss: 0.568 Vali Acc: 0.741 Test Loss: 0.568 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 10.709450721740723
Epoch: 14, Steps: 13 | Train Loss: 0.105 Vali Loss: 0.642 Vali Acc: 0.722 Test Loss: 0.642 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 10.796170949935913
Epoch: 15, Steps: 13 | Train Loss: 0.091 Vali Loss: 0.641 Vali Acc: 0.737 Test Loss: 0.641 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 2098274
model size : 8.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 15.02573299407959
Epoch: 1, Steps: 13 | Train Loss: 0.711 Vali Loss: 0.621 Vali Acc: 0.722 Test Loss: 0.621 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 12.944115161895752
Epoch: 2, Steps: 13 | Train Loss: 0.622 Vali Loss: 0.570 Vali Acc: 0.727 Test Loss: 0.570 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 12.856520175933838
Epoch: 3, Steps: 13 | Train Loss: 0.522 Vali Loss: 0.543 Vali Acc: 0.732 Test Loss: 0.543 Test Acc: 0.732
Validation loss decreased (-0.726824 --> -0.731702).  Saving model ...
Epoch: 4 cost time: 12.368527173995972
Epoch: 4, Steps: 13 | Train Loss: 0.474 Vali Loss: 0.587 Vali Acc: 0.698 Test Loss: 0.587 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 13.36954402923584
Epoch: 5, Steps: 13 | Train Loss: 0.441 Vali Loss: 0.663 Vali Acc: 0.566 Test Loss: 0.663 Test Acc: 0.566
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 13.085428953170776
Epoch: 6, Steps: 13 | Train Loss: 0.427 Vali Loss: 0.512 Vali Acc: 0.756 Test Loss: 0.512 Test Acc: 0.756
Validation loss decreased (-0.731702 --> -0.756092).  Saving model ...
Epoch: 7 cost time: 13.13012146949768
Epoch: 7, Steps: 13 | Train Loss: 0.341 Vali Loss: 0.587 Vali Acc: 0.668 Test Loss: 0.587 Test Acc: 0.668
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 13.295921325683594
Epoch: 8, Steps: 13 | Train Loss: 0.304 Vali Loss: 0.536 Vali Acc: 0.727 Test Loss: 0.536 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 12.273874998092651
Epoch: 9, Steps: 13 | Train Loss: 0.268 Vali Loss: 0.534 Vali Acc: 0.761 Test Loss: 0.534 Test Acc: 0.761
Validation loss decreased (-0.756092 --> -0.760970).  Saving model ...
Epoch: 10 cost time: 12.768152952194214
Epoch: 10, Steps: 13 | Train Loss: 0.228 Vali Loss: 0.568 Vali Acc: 0.698 Test Loss: 0.568 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 12.961422443389893
Epoch: 11, Steps: 13 | Train Loss: 0.174 Vali Loss: 0.607 Vali Acc: 0.776 Test Loss: 0.607 Test Acc: 0.776
Validation loss decreased (-0.760970 --> -0.775604).  Saving model ...
Epoch: 12 cost time: 13.38955307006836
Epoch: 12, Steps: 13 | Train Loss: 0.203 Vali Loss: 0.599 Vali Acc: 0.741 Test Loss: 0.599 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 13.090230941772461
Epoch: 13, Steps: 13 | Train Loss: 0.131 Vali Loss: 0.658 Vali Acc: 0.659 Test Loss: 0.658 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 13.034465312957764
Epoch: 14, Steps: 13 | Train Loss: 0.094 Vali Loss: 0.672 Vali Acc: 0.668 Test Loss: 0.672 Test Acc: 0.668
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 12.730861186981201
Epoch: 15, Steps: 13 | Train Loss: 0.084 Vali Loss: 0.719 Vali Acc: 0.746 Test Loss: 0.719 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 12.649274110794067
Epoch: 16, Steps: 13 | Train Loss: 0.060 Vali Loss: 0.660 Vali Acc: 0.698 Test Loss: 0.660 Test Acc: 0.698
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 13.409070491790771
Epoch: 17, Steps: 13 | Train Loss: 0.054 Vali Loss: 0.695 Vali Acc: 0.722 Test Loss: 0.695 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 13.173272132873535
Epoch: 18, Steps: 13 | Train Loss: 0.052 Vali Loss: 0.819 Vali Acc: 0.737 Test Loss: 0.819 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 13.44632863998413
Epoch: 19, Steps: 13 | Train Loss: 0.035 Vali Loss: 0.785 Vali Acc: 0.737 Test Loss: 0.785 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 12.633322715759277
Epoch: 20, Steps: 13 | Train Loss: 0.029 Vali Loss: 0.791 Vali Acc: 0.751 Test Loss: 0.791 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 12.374898910522461
Epoch: 21, Steps: 13 | Train Loss: 0.017 Vali Loss: 0.846 Vali Acc: 0.746 Test Loss: 0.846 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 7063586
model size : 27.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.5898916721344
Epoch: 1, Steps: 13 | Train Loss: 0.628 Vali Loss: 0.572 Vali Acc: 0.722 Test Loss: 0.572 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 6.649377107620239
Epoch: 2, Steps: 13 | Train Loss: 0.545 Vali Loss: 0.548 Vali Acc: 0.741 Test Loss: 0.548 Test Acc: 0.741
Validation loss decreased (-0.721945 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 6.665632247924805
Epoch: 3, Steps: 13 | Train Loss: 0.493 Vali Loss: 0.540 Vali Acc: 0.751 Test Loss: 0.540 Test Acc: 0.751
Validation loss decreased (-0.741458 --> -0.751214).  Saving model ...
Epoch: 4 cost time: 6.778650999069214
Epoch: 4, Steps: 13 | Train Loss: 0.448 Vali Loss: 0.556 Vali Acc: 0.741 Test Loss: 0.556 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.590667724609375
Epoch: 5, Steps: 13 | Train Loss: 0.414 Vali Loss: 0.530 Vali Acc: 0.751 Test Loss: 0.530 Test Acc: 0.751
Validation loss decreased (-0.751214 --> -0.751214).  Saving model ...
Epoch: 6 cost time: 6.501386880874634
Epoch: 6, Steps: 13 | Train Loss: 0.386 Vali Loss: 0.533 Vali Acc: 0.756 Test Loss: 0.533 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756092).  Saving model ...
Epoch: 7 cost time: 6.4368462562561035
Epoch: 7, Steps: 13 | Train Loss: 0.323 Vali Loss: 0.723 Vali Acc: 0.746 Test Loss: 0.723 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.512545347213745
Epoch: 8, Steps: 13 | Train Loss: 0.372 Vali Loss: 0.658 Vali Acc: 0.751 Test Loss: 0.658 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.19373345375061
Epoch: 9, Steps: 13 | Train Loss: 0.251 Vali Loss: 0.651 Vali Acc: 0.771 Test Loss: 0.651 Test Acc: 0.771
Validation loss decreased (-0.756092 --> -0.770725).  Saving model ...
Epoch: 10 cost time: 6.46617579460144
Epoch: 10, Steps: 13 | Train Loss: 0.219 Vali Loss: 0.729 Vali Acc: 0.756 Test Loss: 0.729 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.574164628982544
Epoch: 11, Steps: 13 | Train Loss: 0.288 Vali Loss: 0.580 Vali Acc: 0.776 Test Loss: 0.580 Test Acc: 0.776
Validation loss decreased (-0.770725 --> -0.775604).  Saving model ...
Epoch: 12 cost time: 6.803813219070435
Epoch: 12, Steps: 13 | Train Loss: 0.248 Vali Loss: 0.654 Vali Acc: 0.673 Test Loss: 0.654 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.774770975112915
Epoch: 13, Steps: 13 | Train Loss: 0.138 Vali Loss: 0.580 Vali Acc: 0.712 Test Loss: 0.580 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.616943836212158
Epoch: 14, Steps: 13 | Train Loss: 0.110 Vali Loss: 0.646 Vali Acc: 0.756 Test Loss: 0.646 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.692559480667114
Epoch: 15, Steps: 13 | Train Loss: 0.086 Vali Loss: 0.654 Vali Acc: 0.741 Test Loss: 0.654 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 6.728306531906128
Epoch: 16, Steps: 13 | Train Loss: 0.074 Vali Loss: 0.629 Vali Acc: 0.737 Test Loss: 0.629 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.571800231933594
Epoch: 17, Steps: 13 | Train Loss: 0.063 Vali Loss: 0.639 Vali Acc: 0.761 Test Loss: 0.639 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 6.346387147903442
Epoch: 18, Steps: 13 | Train Loss: 0.049 Vali Loss: 0.797 Vali Acc: 0.654 Test Loss: 0.797 Test Acc: 0.654
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 6.023046016693115
Epoch: 19, Steps: 13 | Train Loss: 0.075 Vali Loss: 0.713 Vali Acc: 0.741 Test Loss: 0.713 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 6.451452732086182
Epoch: 20, Steps: 13 | Train Loss: 0.039 Vali Loss: 0.766 Vali Acc: 0.737 Test Loss: 0.766 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 6.568113803863525
Epoch: 21, Steps: 13 | Train Loss: 0.039 Vali Loss: 0.844 Vali Acc: 0.776 Test Loss: 0.844 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 2098274
model size : 8.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 9.000808715820312
Epoch: 1, Steps: 13 | Train Loss: 0.708 Vali Loss: 0.622 Vali Acc: 0.722 Test Loss: 0.622 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 8.087515354156494
Epoch: 2, Steps: 13 | Train Loss: 0.624 Vali Loss: 0.573 Vali Acc: 0.722 Test Loss: 0.573 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 7.496670961380005
Epoch: 3, Steps: 13 | Train Loss: 0.531 Vali Loss: 0.548 Vali Acc: 0.732 Test Loss: 0.548 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 4 cost time: 7.731074094772339
Epoch: 4, Steps: 13 | Train Loss: 0.481 Vali Loss: 0.591 Vali Acc: 0.683 Test Loss: 0.591 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.117638826370239
Epoch: 5, Steps: 13 | Train Loss: 0.452 Vali Loss: 0.630 Vali Acc: 0.629 Test Loss: 0.630 Test Acc: 0.629
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.553174257278442
Epoch: 6, Steps: 13 | Train Loss: 0.445 Vali Loss: 0.521 Vali Acc: 0.776 Test Loss: 0.521 Test Acc: 0.776
Validation loss decreased (-0.731702 --> -0.775605).  Saving model ...
Epoch: 7 cost time: 7.560710906982422
Epoch: 7, Steps: 13 | Train Loss: 0.447 Vali Loss: 0.526 Vali Acc: 0.776 Test Loss: 0.526 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.0224130153656
Epoch: 8, Steps: 13 | Train Loss: 0.369 Vali Loss: 0.574 Vali Acc: 0.761 Test Loss: 0.574 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.508039712905884
Epoch: 9, Steps: 13 | Train Loss: 0.254 Vali Loss: 0.697 Vali Acc: 0.746 Test Loss: 0.697 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 7.692833423614502
Epoch: 10, Steps: 13 | Train Loss: 0.365 Vali Loss: 0.561 Vali Acc: 0.746 Test Loss: 0.561 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 7.255645990371704
Epoch: 11, Steps: 13 | Train Loss: 0.214 Vali Loss: 0.588 Vali Acc: 0.756 Test Loss: 0.588 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 7.717160940170288
Epoch: 12, Steps: 13 | Train Loss: 0.243 Vali Loss: 0.597 Vali Acc: 0.722 Test Loss: 0.597 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 6.836877107620239
Epoch: 13, Steps: 13 | Train Loss: 0.165 Vali Loss: 0.647 Vali Acc: 0.668 Test Loss: 0.647 Test Acc: 0.668
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 7.377640962600708
Epoch: 14, Steps: 13 | Train Loss: 0.376 Vali Loss: 0.710 Vali Acc: 0.663 Test Loss: 0.710 Test Acc: 0.663
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 6.851481676101685
Epoch: 15, Steps: 13 | Train Loss: 0.138 Vali Loss: 0.708 Vali Acc: 0.737 Test Loss: 0.708 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 7.691308259963989
Epoch: 16, Steps: 13 | Train Loss: 0.151 Vali Loss: 0.751 Vali Acc: 0.649 Test Loss: 0.751 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 7063586
model size : 27.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.452829599380493
Epoch: 1, Steps: 13 | Train Loss: 0.628 Vali Loss: 0.573 Vali Acc: 0.722 Test Loss: 0.573 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 3.7937662601470947
Epoch: 2, Steps: 13 | Train Loss: 0.546 Vali Loss: 0.549 Vali Acc: 0.741 Test Loss: 0.549 Test Acc: 0.741
Validation loss decreased (-0.721945 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 4.355793476104736
Epoch: 3, Steps: 13 | Train Loss: 0.495 Vali Loss: 0.541 Vali Acc: 0.756 Test Loss: 0.541 Test Acc: 0.756
Validation loss decreased (-0.741458 --> -0.756092).  Saving model ...
Epoch: 4 cost time: 4.125074863433838
Epoch: 4, Steps: 13 | Train Loss: 0.457 Vali Loss: 0.561 Vali Acc: 0.741 Test Loss: 0.561 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.8938205242156982
Epoch: 5, Steps: 13 | Train Loss: 0.449 Vali Loss: 0.524 Vali Acc: 0.756 Test Loss: 0.524 Test Acc: 0.756
Validation loss decreased (-0.756092 --> -0.756092).  Saving model ...
Epoch: 6 cost time: 4.138540506362915
Epoch: 6, Steps: 13 | Train Loss: 0.381 Vali Loss: 0.521 Vali Acc: 0.766 Test Loss: 0.521 Test Acc: 0.766
Validation loss decreased (-0.756092 --> -0.765848).  Saving model ...
Epoch: 7 cost time: 3.6735055446624756
Epoch: 7, Steps: 13 | Train Loss: 0.334 Vali Loss: 0.726 Vali Acc: 0.741 Test Loss: 0.726 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.652491569519043
Epoch: 8, Steps: 13 | Train Loss: 0.405 Vali Loss: 0.756 Vali Acc: 0.746 Test Loss: 0.756 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.048439264297485
Epoch: 9, Steps: 13 | Train Loss: 0.357 Vali Loss: 0.605 Vali Acc: 0.751 Test Loss: 0.605 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.9132471084594727
Epoch: 10, Steps: 13 | Train Loss: 0.323 Vali Loss: 0.605 Vali Acc: 0.663 Test Loss: 0.605 Test Acc: 0.663
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.892230987548828
Epoch: 11, Steps: 13 | Train Loss: 0.198 Vali Loss: 0.668 Vali Acc: 0.751 Test Loss: 0.668 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.213104248046875
Epoch: 12, Steps: 13 | Train Loss: 0.187 Vali Loss: 0.645 Vali Acc: 0.766 Test Loss: 0.645 Test Acc: 0.766
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.231048107147217
Epoch: 13, Steps: 13 | Train Loss: 0.260 Vali Loss: 0.616 Vali Acc: 0.766 Test Loss: 0.616 Test Acc: 0.766
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.8702352046966553
Epoch: 14, Steps: 13 | Train Loss: 0.134 Vali Loss: 0.629 Vali Acc: 0.751 Test Loss: 0.629 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.072921276092529
Epoch: 15, Steps: 13 | Train Loss: 0.099 Vali Loss: 0.608 Vali Acc: 0.707 Test Loss: 0.608 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.239847898483276
Epoch: 16, Steps: 13 | Train Loss: 0.072 Vali Loss: 0.613 Vali Acc: 0.698 Test Loss: 0.613 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 2098274
model size : 8.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 13.269094467163086
Epoch: 1, Steps: 13 | Train Loss: 0.596 Vali Loss: 0.567 Vali Acc: 0.722 Test Loss: 0.567 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 11.327054500579834
Epoch: 2, Steps: 13 | Train Loss: 0.538 Vali Loss: 0.550 Vali Acc: 0.722 Test Loss: 0.550 Test Acc: 0.722
Validation loss decreased (-0.721946 --> -0.721946).  Saving model ...
Epoch: 3 cost time: 10.580803871154785
Epoch: 3, Steps: 13 | Train Loss: 0.479 Vali Loss: 0.532 Vali Acc: 0.737 Test Loss: 0.532 Test Acc: 0.737
Validation loss decreased (-0.721946 --> -0.736580).  Saving model ...
Epoch: 4 cost time: 11.126303911209106
Epoch: 4, Steps: 13 | Train Loss: 0.446 Vali Loss: 0.528 Vali Acc: 0.737 Test Loss: 0.528 Test Acc: 0.737
Validation loss decreased (-0.736580 --> -0.736580).  Saving model ...
Epoch: 5 cost time: 11.87052607536316
Epoch: 5, Steps: 13 | Train Loss: 0.418 Vali Loss: 0.518 Vali Acc: 0.746 Test Loss: 0.518 Test Acc: 0.746
Validation loss decreased (-0.736580 --> -0.746336).  Saving model ...
Epoch: 6 cost time: 11.464296102523804
Epoch: 6, Steps: 13 | Train Loss: 0.345 Vali Loss: 0.510 Vali Acc: 0.756 Test Loss: 0.510 Test Acc: 0.756
Validation loss decreased (-0.746336 --> -0.756092).  Saving model ...
Epoch: 7 cost time: 11.167734861373901
Epoch: 7, Steps: 13 | Train Loss: 0.309 Vali Loss: 0.589 Vali Acc: 0.639 Test Loss: 0.589 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.561070680618286
Epoch: 8, Steps: 13 | Train Loss: 0.271 Vali Loss: 0.518 Vali Acc: 0.780 Test Loss: 0.518 Test Acc: 0.780
Validation loss decreased (-0.756092 --> -0.780483).  Saving model ...
Epoch: 9 cost time: 11.437524557113647
Epoch: 9, Steps: 13 | Train Loss: 0.222 Vali Loss: 0.553 Vali Acc: 0.766 Test Loss: 0.553 Test Acc: 0.766
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 11.319828987121582
Epoch: 10, Steps: 13 | Train Loss: 0.200 Vali Loss: 0.695 Vali Acc: 0.580 Test Loss: 0.695 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 12.068193435668945
Epoch: 11, Steps: 13 | Train Loss: 0.174 Vali Loss: 0.885 Vali Acc: 0.522 Test Loss: 0.885 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 12.050405025482178
Epoch: 12, Steps: 13 | Train Loss: 0.211 Vali Loss: 0.716 Vali Acc: 0.615 Test Loss: 0.716 Test Acc: 0.615
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 12.057170867919922
Epoch: 13, Steps: 13 | Train Loss: 0.127 Vali Loss: 0.654 Vali Acc: 0.717 Test Loss: 0.654 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 12.134305715560913
Epoch: 14, Steps: 13 | Train Loss: 0.111 Vali Loss: 0.642 Vali Acc: 0.649 Test Loss: 0.642 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 11.472862482070923
Epoch: 15, Steps: 13 | Train Loss: 0.102 Vali Loss: 0.605 Vali Acc: 0.698 Test Loss: 0.605 Test Acc: 0.698
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 11.755832195281982
Epoch: 16, Steps: 13 | Train Loss: 0.073 Vali Loss: 0.640 Vali Acc: 0.698 Test Loss: 0.640 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 11.867687702178955
Epoch: 17, Steps: 13 | Train Loss: 0.077 Vali Loss: 0.845 Vali Acc: 0.585 Test Loss: 0.845 Test Acc: 0.585
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 12.344031572341919
Epoch: 18, Steps: 13 | Train Loss: 0.070 Vali Loss: 0.793 Vali Acc: 0.615 Test Loss: 0.793 Test Acc: 0.615
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7804878048780488
model parameter : 3548066
model size : 14.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.453739881515503
Epoch: 1, Steps: 13 | Train Loss: 0.580 Vali Loss: 0.581 Vali Acc: 0.717 Test Loss: 0.581 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 6.388140916824341
Epoch: 2, Steps: 13 | Train Loss: 0.537 Vali Loss: 0.553 Vali Acc: 0.732 Test Loss: 0.553 Test Acc: 0.732
Validation loss decreased (-0.717067 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 6.249861001968384
Epoch: 3, Steps: 13 | Train Loss: 0.478 Vali Loss: 0.533 Vali Acc: 0.746 Test Loss: 0.533 Test Acc: 0.746
Validation loss decreased (-0.731702 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 6.2065863609313965
Epoch: 4, Steps: 13 | Train Loss: 0.443 Vali Loss: 0.553 Vali Acc: 0.741 Test Loss: 0.553 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.168450593948364
Epoch: 5, Steps: 13 | Train Loss: 0.423 Vali Loss: 0.533 Vali Acc: 0.732 Test Loss: 0.533 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.046110391616821
Epoch: 6, Steps: 13 | Train Loss: 0.337 Vali Loss: 0.538 Vali Acc: 0.712 Test Loss: 0.538 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.336550235748291
Epoch: 7, Steps: 13 | Train Loss: 0.342 Vali Loss: 0.545 Vali Acc: 0.683 Test Loss: 0.545 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 6.509763956069946
Epoch: 8, Steps: 13 | Train Loss: 0.279 Vali Loss: 0.527 Vali Acc: 0.751 Test Loss: 0.527 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751214).  Saving model ...
Epoch: 9 cost time: 6.299446105957031
Epoch: 9, Steps: 13 | Train Loss: 0.250 Vali Loss: 0.576 Vali Acc: 0.756 Test Loss: 0.576 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756092).  Saving model ...
Epoch: 10 cost time: 6.157472133636475
Epoch: 10, Steps: 13 | Train Loss: 0.218 Vali Loss: 0.585 Vali Acc: 0.678 Test Loss: 0.585 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.467822551727295
Epoch: 11, Steps: 13 | Train Loss: 0.189 Vali Loss: 0.729 Vali Acc: 0.571 Test Loss: 0.729 Test Acc: 0.571
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.65582799911499
Epoch: 12, Steps: 13 | Train Loss: 0.164 Vali Loss: 0.601 Vali Acc: 0.707 Test Loss: 0.601 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.322616100311279
Epoch: 13, Steps: 13 | Train Loss: 0.119 Vali Loss: 0.845 Vali Acc: 0.751 Test Loss: 0.845 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.365217447280884
Epoch: 14, Steps: 13 | Train Loss: 0.201 Vali Loss: 0.794 Vali Acc: 0.741 Test Loss: 0.794 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.167726516723633
Epoch: 15, Steps: 13 | Train Loss: 0.146 Vali Loss: 0.757 Vali Acc: 0.732 Test Loss: 0.757 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.082490921020508
Epoch: 16, Steps: 13 | Train Loss: 0.084 Vali Loss: 0.709 Vali Acc: 0.698 Test Loss: 0.709 Test Acc: 0.698
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.7087249755859375
Epoch: 17, Steps: 13 | Train Loss: 0.059 Vali Loss: 0.711 Vali Acc: 0.663 Test Loss: 0.711 Test Acc: 0.663
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 6.318912506103516
Epoch: 18, Steps: 13 | Train Loss: 0.064 Vali Loss: 0.725 Vali Acc: 0.678 Test Loss: 0.725 Test Acc: 0.678
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 6.61362099647522
Epoch: 19, Steps: 13 | Train Loss: 0.047 Vali Loss: 0.768 Vali Acc: 0.698 Test Loss: 0.768 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 1065314
model size : 4.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 9.797285556793213
Epoch: 1, Steps: 13 | Train Loss: 0.597 Vali Loss: 0.567 Vali Acc: 0.722 Test Loss: 0.567 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 8.326160907745361
Epoch: 2, Steps: 13 | Train Loss: 0.540 Vali Loss: 0.551 Vali Acc: 0.722 Test Loss: 0.551 Test Acc: 0.722
Validation loss decreased (-0.721946 --> -0.721946).  Saving model ...
Epoch: 3 cost time: 8.039644718170166
Epoch: 3, Steps: 13 | Train Loss: 0.484 Vali Loss: 0.526 Vali Acc: 0.732 Test Loss: 0.526 Test Acc: 0.732
Validation loss decreased (-0.721946 --> -0.731702).  Saving model ...
Epoch: 4 cost time: 8.15468978881836
Epoch: 4, Steps: 13 | Train Loss: 0.452 Vali Loss: 0.522 Vali Acc: 0.732 Test Loss: 0.522 Test Acc: 0.732
Validation loss decreased (-0.731702 --> -0.731702).  Saving model ...
Epoch: 5 cost time: 7.8180131912231445
Epoch: 5, Steps: 13 | Train Loss: 0.412 Vali Loss: 0.512 Vali Acc: 0.761 Test Loss: 0.512 Test Acc: 0.761
Validation loss decreased (-0.731702 --> -0.760970).  Saving model ...
Epoch: 6 cost time: 7.741098642349243
Epoch: 6, Steps: 13 | Train Loss: 0.347 Vali Loss: 0.511 Vali Acc: 0.746 Test Loss: 0.511 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.331140756607056
Epoch: 7, Steps: 13 | Train Loss: 0.322 Vali Loss: 0.548 Vali Acc: 0.702 Test Loss: 0.548 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 8.088505506515503
Epoch: 8, Steps: 13 | Train Loss: 0.265 Vali Loss: 0.545 Vali Acc: 0.766 Test Loss: 0.545 Test Acc: 0.766
Validation loss decreased (-0.760970 --> -0.765848).  Saving model ...
Epoch: 9 cost time: 7.982311725616455
Epoch: 9, Steps: 13 | Train Loss: 0.243 Vali Loss: 0.574 Vali Acc: 0.776 Test Loss: 0.574 Test Acc: 0.776
Validation loss decreased (-0.765848 --> -0.775604).  Saving model ...
Epoch: 10 cost time: 8.320816040039062
Epoch: 10, Steps: 13 | Train Loss: 0.204 Vali Loss: 0.764 Vali Acc: 0.580 Test Loss: 0.764 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 8.195757389068604
Epoch: 11, Steps: 13 | Train Loss: 0.203 Vali Loss: 1.133 Vali Acc: 0.473 Test Loss: 1.133 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 7.831726551055908
Epoch: 12, Steps: 13 | Train Loss: 0.319 Vali Loss: 0.576 Vali Acc: 0.698 Test Loss: 0.576 Test Acc: 0.698
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.6344804763793945
Epoch: 13, Steps: 13 | Train Loss: 0.182 Vali Loss: 0.595 Vali Acc: 0.746 Test Loss: 0.595 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 7.498296737670898
Epoch: 14, Steps: 13 | Train Loss: 0.136 Vali Loss: 0.593 Vali Acc: 0.712 Test Loss: 0.593 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 7.366249084472656
Epoch: 15, Steps: 13 | Train Loss: 0.089 Vali Loss: 0.605 Vali Acc: 0.698 Test Loss: 0.605 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 8.317627191543579
Epoch: 16, Steps: 13 | Train Loss: 0.075 Vali Loss: 0.642 Vali Acc: 0.717 Test Loss: 0.642 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 8.254635334014893
Epoch: 17, Steps: 13 | Train Loss: 0.078 Vali Loss: 0.934 Vali Acc: 0.551 Test Loss: 0.934 Test Acc: 0.551
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 7.9719743728637695
Epoch: 18, Steps: 13 | Train Loss: 0.078 Vali Loss: 0.784 Vali Acc: 0.610 Test Loss: 0.784 Test Acc: 0.610
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 8.147785186767578
Epoch: 19, Steps: 13 | Train Loss: 0.133 Vali Loss: 0.675 Vali Acc: 0.712 Test Loss: 0.675 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 3548066
model size : 14.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.919375658035278
Epoch: 1, Steps: 13 | Train Loss: 0.581 Vali Loss: 0.580 Vali Acc: 0.717 Test Loss: 0.580 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 4.156351327896118
Epoch: 2, Steps: 13 | Train Loss: 0.537 Vali Loss: 0.552 Vali Acc: 0.722 Test Loss: 0.552 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721946).  Saving model ...
Epoch: 3 cost time: 4.053277015686035
Epoch: 3, Steps: 13 | Train Loss: 0.479 Vali Loss: 0.532 Vali Acc: 0.746 Test Loss: 0.532 Test Acc: 0.746
Validation loss decreased (-0.721946 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 4.2237067222595215
Epoch: 4, Steps: 13 | Train Loss: 0.447 Vali Loss: 0.546 Vali Acc: 0.741 Test Loss: 0.546 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.0109028816223145
Epoch: 5, Steps: 13 | Train Loss: 0.420 Vali Loss: 0.524 Vali Acc: 0.756 Test Loss: 0.524 Test Acc: 0.756
Validation loss decreased (-0.746336 --> -0.756092).  Saving model ...
Epoch: 6 cost time: 4.249417543411255
Epoch: 6, Steps: 13 | Train Loss: 0.352 Vali Loss: 0.530 Vali Acc: 0.717 Test Loss: 0.530 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.254911422729492
Epoch: 7, Steps: 13 | Train Loss: 0.361 Vali Loss: 0.551 Vali Acc: 0.707 Test Loss: 0.551 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.168478727340698
Epoch: 8, Steps: 13 | Train Loss: 0.290 Vali Loss: 0.538 Vali Acc: 0.707 Test Loss: 0.538 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.411975860595703
Epoch: 9, Steps: 13 | Train Loss: 0.237 Vali Loss: 0.590 Vali Acc: 0.756 Test Loss: 0.590 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.119712591171265
Epoch: 10, Steps: 13 | Train Loss: 0.243 Vali Loss: 0.571 Vali Acc: 0.702 Test Loss: 0.571 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.361712217330933
Epoch: 11, Steps: 13 | Train Loss: 0.179 Vali Loss: 0.698 Vali Acc: 0.590 Test Loss: 0.698 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.261562824249268
Epoch: 12, Steps: 13 | Train Loss: 0.164 Vali Loss: 0.608 Vali Acc: 0.702 Test Loss: 0.608 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.244579315185547
Epoch: 13, Steps: 13 | Train Loss: 0.143 Vali Loss: 0.763 Vali Acc: 0.751 Test Loss: 0.763 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.442274332046509
Epoch: 14, Steps: 13 | Train Loss: 0.173 Vali Loss: 0.737 Vali Acc: 0.771 Test Loss: 0.737 Test Acc: 0.771
Validation loss decreased (-0.756092 --> -0.770724).  Saving model ...
Epoch: 15 cost time: 4.056199789047241
Epoch: 15, Steps: 13 | Train Loss: 0.117 Vali Loss: 0.733 Vali Acc: 0.761 Test Loss: 0.733 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.263813018798828
Epoch: 16, Steps: 13 | Train Loss: 0.084 Vali Loss: 0.677 Vali Acc: 0.698 Test Loss: 0.677 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.9163291454315186
Epoch: 17, Steps: 13 | Train Loss: 0.054 Vali Loss: 0.744 Vali Acc: 0.663 Test Loss: 0.744 Test Acc: 0.663
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.844357967376709
Epoch: 18, Steps: 13 | Train Loss: 0.053 Vali Loss: 0.732 Vali Acc: 0.693 Test Loss: 0.732 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.145421504974365
Epoch: 19, Steps: 13 | Train Loss: 0.078 Vali Loss: 0.776 Vali Acc: 0.698 Test Loss: 0.776 Test Acc: 0.698
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.906630516052246
Epoch: 20, Steps: 13 | Train Loss: 0.032 Vali Loss: 0.809 Vali Acc: 0.688 Test Loss: 0.809 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.342573642730713
Epoch: 21, Steps: 13 | Train Loss: 0.027 Vali Loss: 0.896 Vali Acc: 0.629 Test Loss: 0.896 Test Acc: 0.629
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.04217791557312
Epoch: 22, Steps: 13 | Train Loss: 0.023 Vali Loss: 0.881 Vali Acc: 0.649 Test Loss: 0.881 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.9893102645874023
Epoch: 23, Steps: 13 | Train Loss: 0.027 Vali Loss: 1.080 Vali Acc: 0.576 Test Loss: 1.080 Test Acc: 0.576
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 4.385069370269775
Epoch: 24, Steps: 13 | Train Loss: 0.024 Vali Loss: 0.902 Vali Acc: 0.683 Test Loss: 0.902 Test Acc: 0.683
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 1065314
model size : 4.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.50573468208313
Epoch: 1, Steps: 13 | Train Loss: 0.598 Vali Loss: 0.568 Vali Acc: 0.722 Test Loss: 0.568 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 5.0745298862457275
Epoch: 2, Steps: 13 | Train Loss: 0.543 Vali Loss: 0.552 Vali Acc: 0.722 Test Loss: 0.552 Test Acc: 0.722
Validation loss decreased (-0.721946 --> -0.721946).  Saving model ...
Epoch: 3 cost time: 4.945135116577148
Epoch: 3, Steps: 13 | Train Loss: 0.490 Vali Loss: 0.529 Vali Acc: 0.732 Test Loss: 0.529 Test Acc: 0.732
Validation loss decreased (-0.721946 --> -0.731702).  Saving model ...
Epoch: 4 cost time: 4.891970634460449
Epoch: 4, Steps: 13 | Train Loss: 0.459 Vali Loss: 0.525 Vali Acc: 0.732 Test Loss: 0.525 Test Acc: 0.732
Validation loss decreased (-0.731702 --> -0.731702).  Saving model ...
Epoch: 5 cost time: 4.719231843948364
Epoch: 5, Steps: 13 | Train Loss: 0.416 Vali Loss: 0.518 Vali Acc: 0.756 Test Loss: 0.518 Test Acc: 0.756
Validation loss decreased (-0.731702 --> -0.756092).  Saving model ...
Epoch: 6 cost time: 4.6753973960876465
Epoch: 6, Steps: 13 | Train Loss: 0.352 Vali Loss: 0.512 Vali Acc: 0.741 Test Loss: 0.512 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.835031747817993
Epoch: 7, Steps: 13 | Train Loss: 0.324 Vali Loss: 0.551 Vali Acc: 0.712 Test Loss: 0.551 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.793461799621582
Epoch: 8, Steps: 13 | Train Loss: 0.268 Vali Loss: 0.545 Vali Acc: 0.771 Test Loss: 0.545 Test Acc: 0.771
Validation loss decreased (-0.756092 --> -0.770726).  Saving model ...
Epoch: 9 cost time: 5.163696050643921
Epoch: 9, Steps: 13 | Train Loss: 0.231 Vali Loss: 0.562 Vali Acc: 0.771 Test Loss: 0.562 Test Acc: 0.771
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.754244327545166
Epoch: 10, Steps: 13 | Train Loss: 0.197 Vali Loss: 0.668 Vali Acc: 0.615 Test Loss: 0.668 Test Acc: 0.615
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.100857257843018
Epoch: 11, Steps: 13 | Train Loss: 0.169 Vali Loss: 0.815 Vali Acc: 0.576 Test Loss: 0.815 Test Acc: 0.576
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.7086262702941895
Epoch: 12, Steps: 13 | Train Loss: 0.172 Vali Loss: 0.620 Vali Acc: 0.659 Test Loss: 0.620 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.042081356048584
Epoch: 13, Steps: 13 | Train Loss: 0.177 Vali Loss: 0.632 Vali Acc: 0.654 Test Loss: 0.632 Test Acc: 0.654
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.656239986419678
Epoch: 14, Steps: 13 | Train Loss: 0.155 Vali Loss: 0.609 Vali Acc: 0.683 Test Loss: 0.609 Test Acc: 0.683
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.5830700397491455
Epoch: 15, Steps: 13 | Train Loss: 0.110 Vali Loss: 0.625 Vali Acc: 0.678 Test Loss: 0.625 Test Acc: 0.678
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.416001558303833
Epoch: 16, Steps: 13 | Train Loss: 0.093 Vali Loss: 0.656 Vali Acc: 0.688 Test Loss: 0.656 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.7363057136535645
Epoch: 17, Steps: 13 | Train Loss: 0.062 Vali Loss: 0.662 Vali Acc: 0.688 Test Loss: 0.662 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.720902442932129
Epoch: 18, Steps: 13 | Train Loss: 0.044 Vali Loss: 0.712 Vali Acc: 0.663 Test Loss: 0.712 Test Acc: 0.663
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 3548066
model size : 14.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.254398822784424
Epoch: 1, Steps: 13 | Train Loss: 0.583 Vali Loss: 0.580 Vali Acc: 0.722 Test Loss: 0.580 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.5751571655273438
Epoch: 2, Steps: 13 | Train Loss: 0.537 Vali Loss: 0.552 Vali Acc: 0.722 Test Loss: 0.552 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721946).  Saving model ...
Epoch: 3 cost time: 2.5291595458984375
Epoch: 3, Steps: 13 | Train Loss: 0.482 Vali Loss: 0.535 Vali Acc: 0.746 Test Loss: 0.535 Test Acc: 0.746
Validation loss decreased (-0.721946 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 2.9282429218292236
Epoch: 4, Steps: 13 | Train Loss: 0.451 Vali Loss: 0.551 Vali Acc: 0.737 Test Loss: 0.551 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.0816547870635986
Epoch: 5, Steps: 13 | Train Loss: 0.424 Vali Loss: 0.532 Vali Acc: 0.751 Test Loss: 0.532 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751214).  Saving model ...
Epoch: 6 cost time: 2.926492929458618
Epoch: 6, Steps: 13 | Train Loss: 0.356 Vali Loss: 0.543 Vali Acc: 0.707 Test Loss: 0.543 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.9879508018493652
Epoch: 7, Steps: 13 | Train Loss: 0.354 Vali Loss: 0.555 Vali Acc: 0.698 Test Loss: 0.555 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.1145901679992676
Epoch: 8, Steps: 13 | Train Loss: 0.287 Vali Loss: 0.544 Vali Acc: 0.712 Test Loss: 0.544 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.076544761657715
Epoch: 9, Steps: 13 | Train Loss: 0.235 Vali Loss: 0.597 Vali Acc: 0.746 Test Loss: 0.597 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.0209908485412598
Epoch: 10, Steps: 13 | Train Loss: 0.288 Vali Loss: 0.598 Vali Acc: 0.673 Test Loss: 0.598 Test Acc: 0.673
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.133157730102539
Epoch: 11, Steps: 13 | Train Loss: 0.184 Vali Loss: 0.781 Vali Acc: 0.561 Test Loss: 0.781 Test Acc: 0.561
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.098534107208252
Epoch: 12, Steps: 13 | Train Loss: 0.204 Vali Loss: 0.619 Vali Acc: 0.678 Test Loss: 0.619 Test Acc: 0.678
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.1153669357299805
Epoch: 13, Steps: 13 | Train Loss: 0.214 Vali Loss: 0.654 Vali Acc: 0.751 Test Loss: 0.654 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.008474111557007
Epoch: 14, Steps: 13 | Train Loss: 0.138 Vali Loss: 0.696 Vali Acc: 0.751 Test Loss: 0.696 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.9906973838806152
Epoch: 15, Steps: 13 | Train Loss: 0.095 Vali Loss: 0.663 Vali Acc: 0.707 Test Loss: 0.663 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 1065314
model size : 4.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.187301397323608
Epoch: 1, Steps: 13 | Train Loss: 0.646 Vali Loss: 0.618 Vali Acc: 0.722 Test Loss: 0.618 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 6.904184341430664
Epoch: 2, Steps: 13 | Train Loss: 0.592 Vali Loss: 0.578 Vali Acc: 0.732 Test Loss: 0.578 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 6.855798006057739
Epoch: 3, Steps: 13 | Train Loss: 0.526 Vali Loss: 0.556 Vali Acc: 0.746 Test Loss: 0.556 Test Acc: 0.746
Validation loss decreased (-0.731702 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 7.237285375595093
Epoch: 4, Steps: 13 | Train Loss: 0.451 Vali Loss: 0.574 Vali Acc: 0.732 Test Loss: 0.574 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.876973628997803
Epoch: 5, Steps: 13 | Train Loss: 0.436 Vali Loss: 0.644 Vali Acc: 0.722 Test Loss: 0.644 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.288634300231934
Epoch: 6, Steps: 13 | Train Loss: 0.390 Vali Loss: 0.525 Vali Acc: 0.751 Test Loss: 0.525 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751214).  Saving model ...
Epoch: 7 cost time: 6.901598215103149
Epoch: 7, Steps: 13 | Train Loss: 0.344 Vali Loss: 0.562 Vali Acc: 0.741 Test Loss: 0.562 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.986545562744141
Epoch: 8, Steps: 13 | Train Loss: 0.277 Vali Loss: 0.653 Vali Acc: 0.707 Test Loss: 0.653 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.0964577198028564
Epoch: 9, Steps: 13 | Train Loss: 0.354 Vali Loss: 0.563 Vali Acc: 0.737 Test Loss: 0.563 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.591412305831909
Epoch: 10, Steps: 13 | Train Loss: 0.413 Vali Loss: 1.005 Vali Acc: 0.449 Test Loss: 1.005 Test Acc: 0.449
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.707776308059692
Epoch: 11, Steps: 13 | Train Loss: 0.284 Vali Loss: 0.564 Vali Acc: 0.712 Test Loss: 0.564 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 6.601216077804565
Epoch: 12, Steps: 13 | Train Loss: 0.200 Vali Loss: 0.625 Vali Acc: 0.683 Test Loss: 0.625 Test Acc: 0.683
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 7.323569297790527
Epoch: 13, Steps: 13 | Train Loss: 0.158 Vali Loss: 0.582 Vali Acc: 0.737 Test Loss: 0.582 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 7.060728073120117
Epoch: 14, Steps: 13 | Train Loss: 0.139 Vali Loss: 0.593 Vali Acc: 0.737 Test Loss: 0.593 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 7.468937635421753
Epoch: 15, Steps: 13 | Train Loss: 0.104 Vali Loss: 0.662 Vali Acc: 0.741 Test Loss: 0.662 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 7.093690633773804
Epoch: 16, Steps: 13 | Train Loss: 0.115 Vali Loss: 0.889 Vali Acc: 0.751 Test Loss: 0.889 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 1790306
model size : 7.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.606507301330566
Epoch: 1, Steps: 13 | Train Loss: 0.679 Vali Loss: 0.582 Vali Acc: 0.717 Test Loss: 0.582 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 3.949140787124634
Epoch: 2, Steps: 13 | Train Loss: 0.559 Vali Loss: 0.557 Vali Acc: 0.756 Test Loss: 0.557 Test Acc: 0.756
Validation loss decreased (-0.717067 --> -0.756092).  Saving model ...
Epoch: 3 cost time: 3.9195470809936523
Epoch: 3, Steps: 13 | Train Loss: 0.522 Vali Loss: 0.547 Vali Acc: 0.756 Test Loss: 0.547 Test Acc: 0.756
Validation loss decreased (-0.756092 --> -0.756092).  Saving model ...
Epoch: 4 cost time: 3.806572914123535
Epoch: 4, Steps: 13 | Train Loss: 0.448 Vali Loss: 0.537 Vali Acc: 0.751 Test Loss: 0.537 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.661496162414551
Epoch: 5, Steps: 13 | Train Loss: 0.421 Vali Loss: 0.522 Vali Acc: 0.766 Test Loss: 0.522 Test Acc: 0.766
Validation loss decreased (-0.756092 --> -0.765848).  Saving model ...
Epoch: 6 cost time: 3.2186343669891357
Epoch: 6, Steps: 13 | Train Loss: 0.386 Vali Loss: 0.524 Vali Acc: 0.732 Test Loss: 0.524 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.0418074131011963
Epoch: 7, Steps: 13 | Train Loss: 0.311 Vali Loss: 0.517 Vali Acc: 0.780 Test Loss: 0.517 Test Acc: 0.780
Validation loss decreased (-0.765848 --> -0.780483).  Saving model ...
Epoch: 8 cost time: 3.8050758838653564
Epoch: 8, Steps: 13 | Train Loss: 0.273 Vali Loss: 0.522 Vali Acc: 0.746 Test Loss: 0.522 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.773592710494995
Epoch: 9, Steps: 13 | Train Loss: 0.232 Vali Loss: 0.582 Vali Acc: 0.776 Test Loss: 0.582 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.077000141143799
Epoch: 10, Steps: 13 | Train Loss: 0.219 Vali Loss: 0.549 Vali Acc: 0.766 Test Loss: 0.549 Test Acc: 0.766
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.7190101146698
Epoch: 11, Steps: 13 | Train Loss: 0.184 Vali Loss: 0.560 Vali Acc: 0.741 Test Loss: 0.560 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.0580127239227295
Epoch: 12, Steps: 13 | Train Loss: 0.157 Vali Loss: 0.600 Vali Acc: 0.727 Test Loss: 0.600 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.801609516143799
Epoch: 13, Steps: 13 | Train Loss: 0.125 Vali Loss: 0.587 Vali Acc: 0.746 Test Loss: 0.587 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.8758316040039062
Epoch: 14, Steps: 13 | Train Loss: 0.098 Vali Loss: 0.623 Vali Acc: 0.717 Test Loss: 0.623 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.8066134452819824
Epoch: 15, Steps: 13 | Train Loss: 0.090 Vali Loss: 0.653 Vali Acc: 0.741 Test Loss: 0.653 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.8217625617980957
Epoch: 16, Steps: 13 | Train Loss: 0.069 Vali Loss: 0.647 Vali Acc: 0.727 Test Loss: 0.647 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.8646163940429688
Epoch: 17, Steps: 13 | Train Loss: 0.070 Vali Loss: 0.665 Vali Acc: 0.712 Test Loss: 0.665 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7804878048780488
model parameter : 548834
model size : 2.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.016514539718628
Epoch: 1, Steps: 13 | Train Loss: 0.644 Vali Loss: 0.616 Vali Acc: 0.722 Test Loss: 0.616 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 5.288244962692261
Epoch: 2, Steps: 13 | Train Loss: 0.590 Vali Loss: 0.577 Vali Acc: 0.727 Test Loss: 0.577 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726823).  Saving model ...
Epoch: 3 cost time: 5.450645208358765
Epoch: 3, Steps: 13 | Train Loss: 0.530 Vali Loss: 0.559 Vali Acc: 0.746 Test Loss: 0.559 Test Acc: 0.746
Validation loss decreased (-0.726823 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 5.719839334487915
Epoch: 4, Steps: 13 | Train Loss: 0.462 Vali Loss: 0.585 Vali Acc: 0.727 Test Loss: 0.585 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.410439968109131
Epoch: 5, Steps: 13 | Train Loss: 0.444 Vali Loss: 0.565 Vali Acc: 0.737 Test Loss: 0.565 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.334964275360107
Epoch: 6, Steps: 13 | Train Loss: 0.386 Vali Loss: 0.527 Vali Acc: 0.756 Test Loss: 0.527 Test Acc: 0.756
Validation loss decreased (-0.746336 --> -0.756092).  Saving model ...
Epoch: 7 cost time: 5.621282577514648
Epoch: 7, Steps: 13 | Train Loss: 0.350 Vali Loss: 0.537 Vali Acc: 0.756 Test Loss: 0.537 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.616883754730225
Epoch: 8, Steps: 13 | Train Loss: 0.282 Vali Loss: 0.634 Vali Acc: 0.751 Test Loss: 0.634 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.335439682006836
Epoch: 9, Steps: 13 | Train Loss: 0.322 Vali Loss: 0.565 Vali Acc: 0.790 Test Loss: 0.565 Test Acc: 0.790
Validation loss decreased (-0.756092 --> -0.790238).  Saving model ...
Epoch: 10 cost time: 5.1329505443573
Epoch: 10, Steps: 13 | Train Loss: 0.434 Vali Loss: 1.057 Vali Acc: 0.434 Test Loss: 1.057 Test Acc: 0.434
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.371458530426025
Epoch: 11, Steps: 13 | Train Loss: 0.288 Vali Loss: 0.588 Vali Acc: 0.717 Test Loss: 0.588 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.218247175216675
Epoch: 12, Steps: 13 | Train Loss: 0.209 Vali Loss: 0.632 Vali Acc: 0.649 Test Loss: 0.632 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.35429048538208
Epoch: 13, Steps: 13 | Train Loss: 0.164 Vali Loss: 0.564 Vali Acc: 0.737 Test Loss: 0.564 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.517940998077393
Epoch: 14, Steps: 13 | Train Loss: 0.128 Vali Loss: 0.594 Vali Acc: 0.756 Test Loss: 0.594 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.774799823760986
Epoch: 15, Steps: 13 | Train Loss: 0.093 Vali Loss: 0.650 Vali Acc: 0.751 Test Loss: 0.650 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.406805038452148
Epoch: 16, Steps: 13 | Train Loss: 0.087 Vali Loss: 0.689 Vali Acc: 0.756 Test Loss: 0.689 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.25269889831543
Epoch: 17, Steps: 13 | Train Loss: 0.067 Vali Loss: 0.608 Vali Acc: 0.761 Test Loss: 0.608 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.64635705947876
Epoch: 18, Steps: 13 | Train Loss: 0.074 Vali Loss: 0.670 Vali Acc: 0.663 Test Loss: 0.670 Test Acc: 0.663
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.497434616088867
Epoch: 19, Steps: 13 | Train Loss: 0.058 Vali Loss: 0.669 Vali Acc: 0.698 Test Loss: 0.669 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7902439024390244
model parameter : 1790306
model size : 7.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.625472784042358
Epoch: 1, Steps: 13 | Train Loss: 0.677 Vali Loss: 0.581 Vali Acc: 0.717 Test Loss: 0.581 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 2.3355677127838135
Epoch: 2, Steps: 13 | Train Loss: 0.559 Vali Loss: 0.557 Vali Acc: 0.751 Test Loss: 0.557 Test Acc: 0.751
Validation loss decreased (-0.717067 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 2.3047707080841064
Epoch: 3, Steps: 13 | Train Loss: 0.520 Vali Loss: 0.549 Vali Acc: 0.756 Test Loss: 0.549 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756092).  Saving model ...
Epoch: 4 cost time: 3.1185808181762695
Epoch: 4, Steps: 13 | Train Loss: 0.453 Vali Loss: 0.548 Vali Acc: 0.741 Test Loss: 0.548 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.5459816455841064
Epoch: 5, Steps: 13 | Train Loss: 0.431 Vali Loss: 0.527 Vali Acc: 0.761 Test Loss: 0.527 Test Acc: 0.761
Validation loss decreased (-0.756092 --> -0.760970).  Saving model ...
Epoch: 6 cost time: 3.5873935222625732
Epoch: 6, Steps: 13 | Train Loss: 0.396 Vali Loss: 0.522 Vali Acc: 0.751 Test Loss: 0.522 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.323362112045288
Epoch: 7, Steps: 13 | Train Loss: 0.320 Vali Loss: 0.517 Vali Acc: 0.780 Test Loss: 0.517 Test Acc: 0.780
Validation loss decreased (-0.760970 --> -0.780483).  Saving model ...
Epoch: 8 cost time: 3.4679744243621826
Epoch: 8, Steps: 13 | Train Loss: 0.286 Vali Loss: 0.515 Vali Acc: 0.761 Test Loss: 0.515 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.422858238220215
Epoch: 9, Steps: 13 | Train Loss: 0.241 Vali Loss: 0.586 Vali Acc: 0.771 Test Loss: 0.586 Test Acc: 0.771
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.45583176612854
Epoch: 10, Steps: 13 | Train Loss: 0.224 Vali Loss: 0.537 Vali Acc: 0.771 Test Loss: 0.537 Test Acc: 0.771
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.476123332977295
Epoch: 11, Steps: 13 | Train Loss: 0.185 Vali Loss: 0.559 Vali Acc: 0.741 Test Loss: 0.559 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.491377353668213
Epoch: 12, Steps: 13 | Train Loss: 0.153 Vali Loss: 0.620 Vali Acc: 0.702 Test Loss: 0.620 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.3514487743377686
Epoch: 13, Steps: 13 | Train Loss: 0.125 Vali Loss: 0.589 Vali Acc: 0.732 Test Loss: 0.589 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.3716437816619873
Epoch: 14, Steps: 13 | Train Loss: 0.096 Vali Loss: 0.613 Vali Acc: 0.741 Test Loss: 0.613 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.3918488025665283
Epoch: 15, Steps: 13 | Train Loss: 0.096 Vali Loss: 0.620 Vali Acc: 0.741 Test Loss: 0.620 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.3749780654907227
Epoch: 16, Steps: 13 | Train Loss: 0.067 Vali Loss: 0.706 Vali Acc: 0.693 Test Loss: 0.706 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.3552279472351074
Epoch: 17, Steps: 13 | Train Loss: 0.057 Vali Loss: 0.663 Vali Acc: 0.741 Test Loss: 0.663 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7804878048780488
model parameter : 548834
model size : 2.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.501794099807739
Epoch: 1, Steps: 13 | Train Loss: 0.645 Vali Loss: 0.615 Vali Acc: 0.722 Test Loss: 0.615 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.046280145645142
Epoch: 2, Steps: 13 | Train Loss: 0.591 Vali Loss: 0.575 Vali Acc: 0.727 Test Loss: 0.575 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 4.0449090003967285
Epoch: 3, Steps: 13 | Train Loss: 0.532 Vali Loss: 0.557 Vali Acc: 0.751 Test Loss: 0.557 Test Acc: 0.751
Validation loss decreased (-0.726824 --> -0.751214).  Saving model ...
Epoch: 4 cost time: 4.024083137512207
Epoch: 4, Steps: 13 | Train Loss: 0.464 Vali Loss: 0.586 Vali Acc: 0.727 Test Loss: 0.586 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.972853422164917
Epoch: 5, Steps: 13 | Train Loss: 0.457 Vali Loss: 0.555 Vali Acc: 0.737 Test Loss: 0.555 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.870496988296509
Epoch: 6, Steps: 13 | Train Loss: 0.414 Vali Loss: 0.590 Vali Acc: 0.737 Test Loss: 0.590 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.692521333694458
Epoch: 7, Steps: 13 | Train Loss: 0.358 Vali Loss: 0.560 Vali Acc: 0.741 Test Loss: 0.560 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.18188738822937
Epoch: 8, Steps: 13 | Train Loss: 0.290 Vali Loss: 0.634 Vali Acc: 0.746 Test Loss: 0.634 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.209539890289307
Epoch: 9, Steps: 13 | Train Loss: 0.354 Vali Loss: 0.530 Vali Acc: 0.776 Test Loss: 0.530 Test Acc: 0.776
Validation loss decreased (-0.751214 --> -0.775604).  Saving model ...
Epoch: 10 cost time: 3.925797700881958
Epoch: 10, Steps: 13 | Train Loss: 0.430 Vali Loss: 0.967 Vali Acc: 0.444 Test Loss: 0.967 Test Acc: 0.444
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.943072557449341
Epoch: 11, Steps: 13 | Train Loss: 0.276 Vali Loss: 0.583 Vali Acc: 0.698 Test Loss: 0.583 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.844097137451172
Epoch: 12, Steps: 13 | Train Loss: 0.208 Vali Loss: 0.605 Vali Acc: 0.673 Test Loss: 0.605 Test Acc: 0.673
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.885127067565918
Epoch: 13, Steps: 13 | Train Loss: 0.171 Vali Loss: 0.573 Vali Acc: 0.761 Test Loss: 0.573 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.8925907611846924
Epoch: 14, Steps: 13 | Train Loss: 0.139 Vali Loss: 0.577 Vali Acc: 0.746 Test Loss: 0.577 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.012432336807251
Epoch: 15, Steps: 13 | Train Loss: 0.116 Vali Loss: 0.609 Vali Acc: 0.751 Test Loss: 0.609 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.8188250064849854
Epoch: 16, Steps: 13 | Train Loss: 0.098 Vali Loss: 0.850 Vali Acc: 0.737 Test Loss: 0.850 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.075515270233154
Epoch: 17, Steps: 13 | Train Loss: 0.107 Vali Loss: 0.723 Vali Acc: 0.766 Test Loss: 0.723 Test Acc: 0.766
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.255903244018555
Epoch: 18, Steps: 13 | Train Loss: 0.074 Vali Loss: 0.661 Vali Acc: 0.756 Test Loss: 0.661 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.220588684082031
Epoch: 19, Steps: 13 | Train Loss: 0.059 Vali Loss: 0.637 Vali Acc: 0.732 Test Loss: 0.637 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 1790306
model size : 7.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.065083265304565
Epoch: 1, Steps: 13 | Train Loss: 0.675 Vali Loss: 0.581 Vali Acc: 0.717 Test Loss: 0.581 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 2.4793145656585693
Epoch: 2, Steps: 13 | Train Loss: 0.561 Vali Loss: 0.557 Vali Acc: 0.751 Test Loss: 0.557 Test Acc: 0.751
Validation loss decreased (-0.717067 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 2.549968957901001
Epoch: 3, Steps: 13 | Train Loss: 0.525 Vali Loss: 0.548 Vali Acc: 0.756 Test Loss: 0.548 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756092).  Saving model ...
Epoch: 4 cost time: 2.5317211151123047
Epoch: 4, Steps: 13 | Train Loss: 0.454 Vali Loss: 0.544 Vali Acc: 0.746 Test Loss: 0.544 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.600667715072632
Epoch: 5, Steps: 13 | Train Loss: 0.441 Vali Loss: 0.523 Vali Acc: 0.756 Test Loss: 0.523 Test Acc: 0.756
Validation loss decreased (-0.756092 --> -0.756092).  Saving model ...
Epoch: 6 cost time: 2.4987096786499023
Epoch: 6, Steps: 13 | Train Loss: 0.394 Vali Loss: 0.522 Vali Acc: 0.746 Test Loss: 0.522 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.5087599754333496
Epoch: 7, Steps: 13 | Train Loss: 0.332 Vali Loss: 0.523 Vali Acc: 0.776 Test Loss: 0.523 Test Acc: 0.776
Validation loss decreased (-0.756092 --> -0.775605).  Saving model ...
Epoch: 8 cost time: 2.2570788860321045
Epoch: 8, Steps: 13 | Train Loss: 0.300 Vali Loss: 0.518 Vali Acc: 0.761 Test Loss: 0.518 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.3475112915039062
Epoch: 9, Steps: 13 | Train Loss: 0.260 Vali Loss: 0.610 Vali Acc: 0.751 Test Loss: 0.610 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.2540688514709473
Epoch: 10, Steps: 13 | Train Loss: 0.249 Vali Loss: 0.573 Vali Acc: 0.751 Test Loss: 0.573 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.361319065093994
Epoch: 11, Steps: 13 | Train Loss: 0.221 Vali Loss: 0.620 Vali Acc: 0.746 Test Loss: 0.620 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.3302464485168457
Epoch: 12, Steps: 13 | Train Loss: 0.159 Vali Loss: 0.559 Vali Acc: 0.737 Test Loss: 0.559 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.3431355953216553
Epoch: 13, Steps: 13 | Train Loss: 0.139 Vali Loss: 0.629 Vali Acc: 0.751 Test Loss: 0.629 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.3315110206604004
Epoch: 14, Steps: 13 | Train Loss: 0.111 Vali Loss: 0.624 Vali Acc: 0.761 Test Loss: 0.624 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.4203176498413086
Epoch: 15, Steps: 13 | Train Loss: 0.113 Vali Loss: 0.625 Vali Acc: 0.746 Test Loss: 0.625 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.2532119750976562
Epoch: 16, Steps: 13 | Train Loss: 0.070 Vali Loss: 0.647 Vali Acc: 0.732 Test Loss: 0.647 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.4036943912506104
Epoch: 17, Steps: 13 | Train Loss: 0.068 Vali Loss: 0.676 Vali Acc: 0.727 Test Loss: 0.676 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 548834
model size : 2.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 11.722522497177124
Epoch: 1, Steps: 13 | Train Loss: 0.596 Vali Loss: 0.576 Vali Acc: 0.722 Test Loss: 0.576 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 9.910279273986816
Epoch: 2, Steps: 13 | Train Loss: 0.564 Vali Loss: 0.552 Vali Acc: 0.722 Test Loss: 0.552 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721946).  Saving model ...
Epoch: 3 cost time: 10.097376585006714
Epoch: 3, Steps: 13 | Train Loss: 0.518 Vali Loss: 0.537 Vali Acc: 0.756 Test Loss: 0.537 Test Acc: 0.756
Validation loss decreased (-0.721946 --> -0.756092).  Saving model ...
Epoch: 4 cost time: 9.309003591537476
Epoch: 4, Steps: 13 | Train Loss: 0.490 Vali Loss: 0.527 Vali Acc: 0.766 Test Loss: 0.527 Test Acc: 0.766
Validation loss decreased (-0.756092 --> -0.765848).  Saving model ...
Epoch: 5 cost time: 9.297544479370117
Epoch: 5, Steps: 13 | Train Loss: 0.433 Vali Loss: 0.494 Vali Acc: 0.766 Test Loss: 0.494 Test Acc: 0.766
Validation loss decreased (-0.765848 --> -0.765849).  Saving model ...
Epoch: 6 cost time: 9.584476947784424
Epoch: 6, Steps: 13 | Train Loss: 0.431 Vali Loss: 0.567 Vali Acc: 0.756 Test Loss: 0.567 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.623083591461182
Epoch: 7, Steps: 13 | Train Loss: 0.378 Vali Loss: 0.563 Vali Acc: 0.766 Test Loss: 0.563 Test Acc: 0.766
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 9.747526407241821
Epoch: 8, Steps: 13 | Train Loss: 0.378 Vali Loss: 0.522 Vali Acc: 0.746 Test Loss: 0.522 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 10.252063751220703
Epoch: 9, Steps: 13 | Train Loss: 0.325 Vali Loss: 0.544 Vali Acc: 0.693 Test Loss: 0.544 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 9.784165620803833
Epoch: 10, Steps: 13 | Train Loss: 0.291 Vali Loss: 0.539 Vali Acc: 0.707 Test Loss: 0.539 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 10.092618942260742
Epoch: 11, Steps: 13 | Train Loss: 0.264 Vali Loss: 0.545 Vali Acc: 0.717 Test Loss: 0.545 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 9.146572828292847
Epoch: 12, Steps: 13 | Train Loss: 0.204 Vali Loss: 0.553 Vali Acc: 0.751 Test Loss: 0.553 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 8.91238784790039
Epoch: 13, Steps: 13 | Train Loss: 0.202 Vali Loss: 0.733 Vali Acc: 0.756 Test Loss: 0.733 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 9.970455169677734
Epoch: 14, Steps: 13 | Train Loss: 0.188 Vali Loss: 0.577 Vali Acc: 0.737 Test Loss: 0.577 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 9.609395027160645
Epoch: 15, Steps: 13 | Train Loss: 0.139 Vali Loss: 0.646 Vali Acc: 0.698 Test Loss: 0.646 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 1774610
model size : 7.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.50760555267334
Epoch: 1, Steps: 13 | Train Loss: 0.608 Vali Loss: 0.589 Vali Acc: 0.712 Test Loss: 0.589 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 3.8174917697906494
Epoch: 2, Steps: 13 | Train Loss: 0.571 Vali Loss: 0.568 Vali Acc: 0.707 Test Loss: 0.568 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.038271188735962
Epoch: 3, Steps: 13 | Train Loss: 0.532 Vali Loss: 0.543 Vali Acc: 0.727 Test Loss: 0.543 Test Acc: 0.727
Validation loss decreased (-0.712189 --> -0.726824).  Saving model ...
Epoch: 4 cost time: 4.686853647232056
Epoch: 4, Steps: 13 | Train Loss: 0.555 Vali Loss: 0.530 Vali Acc: 0.741 Test Loss: 0.530 Test Acc: 0.741
Validation loss decreased (-0.726824 --> -0.741458).  Saving model ...
Epoch: 5 cost time: 4.9028990268707275
Epoch: 5, Steps: 13 | Train Loss: 0.457 Vali Loss: 0.551 Vali Acc: 0.737 Test Loss: 0.551 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.5251243114471436
Epoch: 6, Steps: 13 | Train Loss: 0.402 Vali Loss: 0.527 Vali Acc: 0.717 Test Loss: 0.527 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.02245569229126
Epoch: 7, Steps: 13 | Train Loss: 0.401 Vali Loss: 0.541 Vali Acc: 0.693 Test Loss: 0.541 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.917126178741455
Epoch: 8, Steps: 13 | Train Loss: 0.361 Vali Loss: 0.535 Vali Acc: 0.746 Test Loss: 0.535 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746336).  Saving model ...
Epoch: 9 cost time: 4.984046459197998
Epoch: 9, Steps: 13 | Train Loss: 0.299 Vali Loss: 0.647 Vali Acc: 0.732 Test Loss: 0.647 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.966186046600342
Epoch: 10, Steps: 13 | Train Loss: 0.333 Vali Loss: 0.537 Vali Acc: 0.717 Test Loss: 0.537 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.9350903034210205
Epoch: 11, Steps: 13 | Train Loss: 0.278 Vali Loss: 0.570 Vali Acc: 0.707 Test Loss: 0.570 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.06931209564209
Epoch: 12, Steps: 13 | Train Loss: 0.294 Vali Loss: 0.572 Vali Acc: 0.702 Test Loss: 0.572 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.838101625442505
Epoch: 13, Steps: 13 | Train Loss: 0.299 Vali Loss: 0.545 Vali Acc: 0.751 Test Loss: 0.545 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751214).  Saving model ...
Epoch: 14 cost time: 5.160080194473267
Epoch: 14, Steps: 13 | Train Loss: 0.199 Vali Loss: 0.654 Vali Acc: 0.737 Test Loss: 0.654 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.123645067214966
Epoch: 15, Steps: 13 | Train Loss: 0.183 Vali Loss: 0.572 Vali Acc: 0.727 Test Loss: 0.572 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.219980478286743
Epoch: 16, Steps: 13 | Train Loss: 0.140 Vali Loss: 0.585 Vali Acc: 0.717 Test Loss: 0.585 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.55340313911438
Epoch: 17, Steps: 13 | Train Loss: 0.124 Vali Loss: 0.854 Vali Acc: 0.595 Test Loss: 0.854 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.825621843338013
Epoch: 18, Steps: 13 | Train Loss: 0.136 Vali Loss: 0.644 Vali Acc: 0.693 Test Loss: 0.644 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.507534503936768
Epoch: 19, Steps: 13 | Train Loss: 0.112 Vali Loss: 0.648 Vali Acc: 0.702 Test Loss: 0.648 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.17119836807251
Epoch: 20, Steps: 13 | Train Loss: 0.121 Vali Loss: 0.649 Vali Acc: 0.722 Test Loss: 0.649 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 5.0501604080200195
Epoch: 21, Steps: 13 | Train Loss: 0.080 Vali Loss: 0.689 Vali Acc: 0.693 Test Loss: 0.689 Test Acc: 0.693
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 5.164165735244751
Epoch: 22, Steps: 13 | Train Loss: 0.070 Vali Loss: 0.661 Vali Acc: 0.707 Test Loss: 0.661 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.828119277954102
Epoch: 23, Steps: 13 | Train Loss: 0.053 Vali Loss: 0.719 Vali Acc: 0.737 Test Loss: 0.719 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 533042
model size : 2.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.318293571472168
Epoch: 1, Steps: 13 | Train Loss: 0.595 Vali Loss: 0.575 Vali Acc: 0.722 Test Loss: 0.575 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 6.8652119636535645
Epoch: 2, Steps: 13 | Train Loss: 0.566 Vali Loss: 0.552 Vali Acc: 0.732 Test Loss: 0.552 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 6.471135377883911
Epoch: 3, Steps: 13 | Train Loss: 0.519 Vali Loss: 0.537 Vali Acc: 0.746 Test Loss: 0.537 Test Acc: 0.746
Validation loss decreased (-0.731702 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 6.356044769287109
Epoch: 4, Steps: 13 | Train Loss: 0.494 Vali Loss: 0.545 Vali Acc: 0.785 Test Loss: 0.545 Test Acc: 0.785
Validation loss decreased (-0.746336 --> -0.785360).  Saving model ...
Epoch: 5 cost time: 6.790467262268066
Epoch: 5, Steps: 13 | Train Loss: 0.445 Vali Loss: 0.501 Vali Acc: 0.756 Test Loss: 0.501 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.661102294921875
Epoch: 6, Steps: 13 | Train Loss: 0.441 Vali Loss: 0.558 Vali Acc: 0.756 Test Loss: 0.558 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.89199423789978
Epoch: 7, Steps: 13 | Train Loss: 0.388 Vali Loss: 0.574 Vali Acc: 0.771 Test Loss: 0.574 Test Acc: 0.771
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.784015893936157
Epoch: 8, Steps: 13 | Train Loss: 0.370 Vali Loss: 0.522 Vali Acc: 0.756 Test Loss: 0.522 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.656876802444458
Epoch: 9, Steps: 13 | Train Loss: 0.342 Vali Loss: 0.506 Vali Acc: 0.746 Test Loss: 0.506 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 6.984712362289429
Epoch: 10, Steps: 13 | Train Loss: 0.313 Vali Loss: 0.532 Vali Acc: 0.707 Test Loss: 0.532 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 6.616816997528076
Epoch: 11, Steps: 13 | Train Loss: 0.274 Vali Loss: 0.542 Vali Acc: 0.712 Test Loss: 0.542 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 6.931103706359863
Epoch: 12, Steps: 13 | Train Loss: 0.298 Vali Loss: 0.522 Vali Acc: 0.761 Test Loss: 0.522 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 6.154230356216431
Epoch: 13, Steps: 13 | Train Loss: 0.226 Vali Loss: 0.529 Vali Acc: 0.741 Test Loss: 0.529 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 6.50603985786438
Epoch: 14, Steps: 13 | Train Loss: 0.214 Vali Loss: 0.721 Vali Acc: 0.761 Test Loss: 0.721 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7853658536585366
model parameter : 1774610
model size : 7.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.512354850769043
Epoch: 1, Steps: 13 | Train Loss: 0.605 Vali Loss: 0.588 Vali Acc: 0.712 Test Loss: 0.588 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 3.939389228820801
Epoch: 2, Steps: 13 | Train Loss: 0.571 Vali Loss: 0.566 Vali Acc: 0.717 Test Loss: 0.566 Test Acc: 0.717
Validation loss decreased (-0.712189 --> -0.717068).  Saving model ...
Epoch: 3 cost time: 3.6774730682373047
Epoch: 3, Steps: 13 | Train Loss: 0.530 Vali Loss: 0.541 Vali Acc: 0.727 Test Loss: 0.541 Test Acc: 0.727
Validation loss decreased (-0.717068 --> -0.726824).  Saving model ...
Epoch: 4 cost time: 3.819239616394043
Epoch: 4, Steps: 13 | Train Loss: 0.559 Vali Loss: 0.530 Vali Acc: 0.737 Test Loss: 0.530 Test Acc: 0.737
Validation loss decreased (-0.726824 --> -0.736580).  Saving model ...
Epoch: 5 cost time: 3.2428395748138428
Epoch: 5, Steps: 13 | Train Loss: 0.465 Vali Loss: 0.539 Vali Acc: 0.746 Test Loss: 0.539 Test Acc: 0.746
Validation loss decreased (-0.736580 --> -0.746336).  Saving model ...
Epoch: 6 cost time: 2.931900978088379
Epoch: 6, Steps: 13 | Train Loss: 0.431 Vali Loss: 0.522 Vali Acc: 0.737 Test Loss: 0.522 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.7808597087860107
Epoch: 7, Steps: 13 | Train Loss: 0.417 Vali Loss: 0.521 Vali Acc: 0.737 Test Loss: 0.521 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.006664037704468
Epoch: 8, Steps: 13 | Train Loss: 0.387 Vali Loss: 0.543 Vali Acc: 0.751 Test Loss: 0.543 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751214).  Saving model ...
Epoch: 9 cost time: 3.9123423099517822
Epoch: 9, Steps: 13 | Train Loss: 0.328 Vali Loss: 0.660 Vali Acc: 0.737 Test Loss: 0.660 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.605203151702881
Epoch: 10, Steps: 13 | Train Loss: 0.353 Vali Loss: 0.519 Vali Acc: 0.722 Test Loss: 0.519 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.8428361415863037
Epoch: 11, Steps: 13 | Train Loss: 0.299 Vali Loss: 0.544 Vali Acc: 0.717 Test Loss: 0.544 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.868945598602295
Epoch: 12, Steps: 13 | Train Loss: 0.308 Vali Loss: 0.516 Vali Acc: 0.717 Test Loss: 0.516 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.711512565612793
Epoch: 13, Steps: 13 | Train Loss: 0.276 Vali Loss: 0.546 Vali Acc: 0.751 Test Loss: 0.546 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.762653112411499
Epoch: 14, Steps: 13 | Train Loss: 0.206 Vali Loss: 0.630 Vali Acc: 0.741 Test Loss: 0.630 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.109996318817139
Epoch: 15, Steps: 13 | Train Loss: 0.207 Vali Loss: 0.549 Vali Acc: 0.741 Test Loss: 0.549 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.141803979873657
Epoch: 16, Steps: 13 | Train Loss: 0.162 Vali Loss: 0.555 Vali Acc: 0.712 Test Loss: 0.555 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.045717716217041
Epoch: 17, Steps: 13 | Train Loss: 0.143 Vali Loss: 0.838 Vali Acc: 0.566 Test Loss: 0.838 Test Acc: 0.566
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.069892168045044
Epoch: 18, Steps: 13 | Train Loss: 0.196 Vali Loss: 0.600 Vali Acc: 0.732 Test Loss: 0.600 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 533042
model size : 2.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.688923358917236
Epoch: 1, Steps: 13 | Train Loss: 0.596 Vali Loss: 0.575 Vali Acc: 0.722 Test Loss: 0.575 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 3.9056506156921387
Epoch: 2, Steps: 13 | Train Loss: 0.565 Vali Loss: 0.551 Vali Acc: 0.732 Test Loss: 0.551 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 4.033890247344971
Epoch: 3, Steps: 13 | Train Loss: 0.522 Vali Loss: 0.536 Vali Acc: 0.746 Test Loss: 0.536 Test Acc: 0.746
Validation loss decreased (-0.731702 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 4.136383295059204
Epoch: 4, Steps: 13 | Train Loss: 0.498 Vali Loss: 0.525 Vali Acc: 0.776 Test Loss: 0.525 Test Acc: 0.776
Validation loss decreased (-0.746336 --> -0.775605).  Saving model ...
Epoch: 5 cost time: 3.789771556854248
Epoch: 5, Steps: 13 | Train Loss: 0.444 Vali Loss: 0.502 Vali Acc: 0.746 Test Loss: 0.502 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.75403094291687
Epoch: 6, Steps: 13 | Train Loss: 0.451 Vali Loss: 0.540 Vali Acc: 0.756 Test Loss: 0.540 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.9431416988372803
Epoch: 7, Steps: 13 | Train Loss: 0.386 Vali Loss: 0.577 Vali Acc: 0.771 Test Loss: 0.577 Test Acc: 0.771
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.92976975440979
Epoch: 8, Steps: 13 | Train Loss: 0.420 Vali Loss: 0.513 Vali Acc: 0.780 Test Loss: 0.513 Test Acc: 0.780
Validation loss decreased (-0.775605 --> -0.780483).  Saving model ...
Epoch: 9 cost time: 4.053726434707642
Epoch: 9, Steps: 13 | Train Loss: 0.358 Vali Loss: 0.576 Vali Acc: 0.649 Test Loss: 0.576 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.068571329116821
Epoch: 10, Steps: 13 | Train Loss: 0.303 Vali Loss: 0.579 Vali Acc: 0.639 Test Loss: 0.579 Test Acc: 0.639
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.214728832244873
Epoch: 11, Steps: 13 | Train Loss: 0.298 Vali Loss: 0.526 Vali Acc: 0.746 Test Loss: 0.526 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.079992771148682
Epoch: 12, Steps: 13 | Train Loss: 0.224 Vali Loss: 0.544 Vali Acc: 0.780 Test Loss: 0.544 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.048908233642578
Epoch: 13, Steps: 13 | Train Loss: 0.208 Vali Loss: 0.596 Vali Acc: 0.780 Test Loss: 0.596 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.0772340297698975
Epoch: 14, Steps: 13 | Train Loss: 0.184 Vali Loss: 0.748 Vali Acc: 0.766 Test Loss: 0.748 Test Acc: 0.766
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.20353364944458
Epoch: 15, Steps: 13 | Train Loss: 0.160 Vali Loss: 0.636 Vali Acc: 0.722 Test Loss: 0.636 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.143032550811768
Epoch: 16, Steps: 13 | Train Loss: 0.143 Vali Loss: 0.608 Vali Acc: 0.732 Test Loss: 0.608 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.003769636154175
Epoch: 17, Steps: 13 | Train Loss: 0.114 Vali Loss: 0.657 Vali Acc: 0.678 Test Loss: 0.657 Test Acc: 0.678
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.0892791748046875
Epoch: 18, Steps: 13 | Train Loss: 0.174 Vali Loss: 0.659 Vali Acc: 0.678 Test Loss: 0.659 Test Acc: 0.678
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7804878048780488
model parameter : 1774610
model size : 7.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.7355313301086426
Epoch: 1, Steps: 13 | Train Loss: 0.608 Vali Loss: 0.594 Vali Acc: 0.712 Test Loss: 0.594 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 2.3594837188720703
Epoch: 2, Steps: 13 | Train Loss: 0.576 Vali Loss: 0.571 Vali Acc: 0.717 Test Loss: 0.571 Test Acc: 0.717
Validation loss decreased (-0.712189 --> -0.717067).  Saving model ...
Epoch: 3 cost time: 2.4082164764404297
Epoch: 3, Steps: 13 | Train Loss: 0.530 Vali Loss: 0.551 Vali Acc: 0.727 Test Loss: 0.551 Test Acc: 0.727
Validation loss decreased (-0.717067 --> -0.726824).  Saving model ...
Epoch: 4 cost time: 2.551663398742676
Epoch: 4, Steps: 13 | Train Loss: 0.555 Vali Loss: 0.539 Vali Acc: 0.732 Test Loss: 0.539 Test Acc: 0.732
Validation loss decreased (-0.726824 --> -0.731702).  Saving model ...
Epoch: 5 cost time: 2.428227663040161
Epoch: 5, Steps: 13 | Train Loss: 0.472 Vali Loss: 0.566 Vali Acc: 0.737 Test Loss: 0.566 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736580).  Saving model ...
Epoch: 6 cost time: 2.4861741065979004
Epoch: 6, Steps: 13 | Train Loss: 0.416 Vali Loss: 0.535 Vali Acc: 0.727 Test Loss: 0.535 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.4580185413360596
Epoch: 7, Steps: 13 | Train Loss: 0.413 Vali Loss: 0.530 Vali Acc: 0.727 Test Loss: 0.530 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.6486763954162598
Epoch: 8, Steps: 13 | Train Loss: 0.365 Vali Loss: 0.541 Vali Acc: 0.732 Test Loss: 0.541 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.6687467098236084
Epoch: 9, Steps: 13 | Train Loss: 0.308 Vali Loss: 0.635 Vali Acc: 0.741 Test Loss: 0.635 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741457).  Saving model ...
Epoch: 10 cost time: 2.7207748889923096
Epoch: 10, Steps: 13 | Train Loss: 0.336 Vali Loss: 0.543 Vali Acc: 0.756 Test Loss: 0.543 Test Acc: 0.756
Validation loss decreased (-0.741457 --> -0.756092).  Saving model ...
Epoch: 11 cost time: 2.574453830718994
Epoch: 11, Steps: 13 | Train Loss: 0.289 Vali Loss: 0.601 Vali Acc: 0.698 Test Loss: 0.601 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.6426522731781006
Epoch: 12, Steps: 13 | Train Loss: 0.297 Vali Loss: 0.539 Vali Acc: 0.727 Test Loss: 0.539 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.6229782104492188
Epoch: 13, Steps: 13 | Train Loss: 0.273 Vali Loss: 0.589 Vali Acc: 0.737 Test Loss: 0.589 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.595165967941284
Epoch: 14, Steps: 13 | Train Loss: 0.203 Vali Loss: 0.648 Vali Acc: 0.741 Test Loss: 0.648 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.717341423034668
Epoch: 15, Steps: 13 | Train Loss: 0.192 Vali Loss: 0.594 Vali Acc: 0.751 Test Loss: 0.594 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.574455976486206
Epoch: 16, Steps: 13 | Train Loss: 0.149 Vali Loss: 0.620 Vali Acc: 0.732 Test Loss: 0.620 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.513561725616455
Epoch: 17, Steps: 13 | Train Loss: 0.135 Vali Loss: 0.813 Vali Acc: 0.576 Test Loss: 0.813 Test Acc: 0.576
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.2588565349578857
Epoch: 18, Steps: 13 | Train Loss: 0.148 Vali Loss: 0.685 Vali Acc: 0.732 Test Loss: 0.685 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.5729949474334717
Epoch: 19, Steps: 13 | Train Loss: 0.194 Vali Loss: 0.715 Vali Acc: 0.741 Test Loss: 0.715 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.602238893508911
Epoch: 20, Steps: 13 | Train Loss: 0.120 Vali Loss: 0.662 Vali Acc: 0.712 Test Loss: 0.662 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 533042
model size : 2.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.281517744064331
Epoch: 1, Steps: 13 | Train Loss: 0.633 Vali Loss: 0.564 Vali Acc: 0.717 Test Loss: 0.564 Test Acc: 0.717
Validation loss decreased (inf --> -0.717068).  Saving model ...
Epoch: 2 cost time: 6.117138624191284
Epoch: 2, Steps: 13 | Train Loss: 0.570 Vali Loss: 0.542 Vali Acc: 0.732 Test Loss: 0.542 Test Acc: 0.732
Validation loss decreased (-0.717068 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 6.1212158203125
Epoch: 3, Steps: 13 | Train Loss: 0.536 Vali Loss: 0.526 Vali Acc: 0.746 Test Loss: 0.526 Test Acc: 0.746
Validation loss decreased (-0.731702 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 6.814899444580078
Epoch: 4, Steps: 13 | Train Loss: 0.503 Vali Loss: 0.547 Vali Acc: 0.732 Test Loss: 0.547 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.533670663833618
Epoch: 5, Steps: 13 | Train Loss: 0.446 Vali Loss: 0.543 Vali Acc: 0.717 Test Loss: 0.543 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.119786739349365
Epoch: 6, Steps: 13 | Train Loss: 0.437 Vali Loss: 0.513 Vali Acc: 0.766 Test Loss: 0.513 Test Acc: 0.766
Validation loss decreased (-0.746336 --> -0.765849).  Saving model ...
Epoch: 7 cost time: 4.904943943023682
Epoch: 7, Steps: 13 | Train Loss: 0.415 Vali Loss: 0.644 Vali Acc: 0.737 Test Loss: 0.644 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.34670877456665
Epoch: 8, Steps: 13 | Train Loss: 0.418 Vali Loss: 0.515 Vali Acc: 0.746 Test Loss: 0.515 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.514322757720947
Epoch: 9, Steps: 13 | Train Loss: 0.341 Vali Loss: 0.525 Vali Acc: 0.727 Test Loss: 0.525 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.005376815795898
Epoch: 10, Steps: 13 | Train Loss: 0.280 Vali Loss: 0.526 Vali Acc: 0.761 Test Loss: 0.526 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.1653618812561035
Epoch: 11, Steps: 13 | Train Loss: 0.276 Vali Loss: 0.554 Vali Acc: 0.756 Test Loss: 0.554 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.916776418685913
Epoch: 12, Steps: 13 | Train Loss: 0.281 Vali Loss: 0.702 Vali Acc: 0.751 Test Loss: 0.702 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 6.214154005050659
Epoch: 13, Steps: 13 | Train Loss: 0.237 Vali Loss: 0.651 Vali Acc: 0.766 Test Loss: 0.651 Test Acc: 0.766
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 6.262107849121094
Epoch: 14, Steps: 13 | Train Loss: 0.183 Vali Loss: 0.583 Vali Acc: 0.737 Test Loss: 0.583 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.84871768951416
Epoch: 15, Steps: 13 | Train Loss: 0.200 Vali Loss: 0.585 Vali Acc: 0.688 Test Loss: 0.585 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 6.2598042488098145
Epoch: 16, Steps: 13 | Train Loss: 0.139 Vali Loss: 0.586 Vali Acc: 0.707 Test Loss: 0.586 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 895442
model size : 3.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.283100843429565
Epoch: 1, Steps: 13 | Train Loss: 0.608 Vali Loss: 0.595 Vali Acc: 0.722 Test Loss: 0.595 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 3.336169958114624
Epoch: 2, Steps: 13 | Train Loss: 0.579 Vali Loss: 0.567 Vali Acc: 0.722 Test Loss: 0.567 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721946).  Saving model ...
Epoch: 3 cost time: 3.506134271621704
Epoch: 3, Steps: 13 | Train Loss: 0.520 Vali Loss: 0.544 Vali Acc: 0.737 Test Loss: 0.544 Test Acc: 0.737
Validation loss decreased (-0.721946 --> -0.736580).  Saving model ...
Epoch: 4 cost time: 3.5006871223449707
Epoch: 4, Steps: 13 | Train Loss: 0.516 Vali Loss: 0.543 Vali Acc: 0.737 Test Loss: 0.543 Test Acc: 0.737
Validation loss decreased (-0.736580 --> -0.736580).  Saving model ...
Epoch: 5 cost time: 3.465184211730957
Epoch: 5, Steps: 13 | Train Loss: 0.445 Vali Loss: 0.519 Vali Acc: 0.751 Test Loss: 0.519 Test Acc: 0.751
Validation loss decreased (-0.736580 --> -0.751214).  Saving model ...
Epoch: 6 cost time: 3.4848732948303223
Epoch: 6, Steps: 13 | Train Loss: 0.413 Vali Loss: 0.518 Vali Acc: 0.732 Test Loss: 0.518 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.4225430488586426
Epoch: 7, Steps: 13 | Train Loss: 0.395 Vali Loss: 0.570 Vali Acc: 0.663 Test Loss: 0.570 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.69606614112854
Epoch: 8, Steps: 13 | Train Loss: 0.383 Vali Loss: 0.512 Vali Acc: 0.771 Test Loss: 0.512 Test Acc: 0.771
Validation loss decreased (-0.751214 --> -0.770727).  Saving model ...
Epoch: 9 cost time: 3.506160259246826
Epoch: 9, Steps: 13 | Train Loss: 0.339 Vali Loss: 0.524 Vali Acc: 0.751 Test Loss: 0.524 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.693392753601074
Epoch: 10, Steps: 13 | Train Loss: 0.283 Vali Loss: 0.568 Vali Acc: 0.702 Test Loss: 0.568 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.397353172302246
Epoch: 11, Steps: 13 | Train Loss: 0.244 Vali Loss: 0.594 Vali Acc: 0.766 Test Loss: 0.594 Test Acc: 0.766
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.726665496826172
Epoch: 12, Steps: 13 | Train Loss: 0.233 Vali Loss: 0.569 Vali Acc: 0.746 Test Loss: 0.569 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.570141553878784
Epoch: 13, Steps: 13 | Train Loss: 0.216 Vali Loss: 0.582 Vali Acc: 0.741 Test Loss: 0.582 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.512904167175293
Epoch: 14, Steps: 13 | Train Loss: 0.176 Vali Loss: 0.751 Vali Acc: 0.610 Test Loss: 0.751 Test Acc: 0.610
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.2649405002593994
Epoch: 15, Steps: 13 | Train Loss: 0.200 Vali Loss: 0.627 Vali Acc: 0.756 Test Loss: 0.627 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.226783037185669
Epoch: 16, Steps: 13 | Train Loss: 0.178 Vali Loss: 0.618 Vali Acc: 0.741 Test Loss: 0.618 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.2332603931427
Epoch: 17, Steps: 13 | Train Loss: 0.163 Vali Loss: 0.651 Vali Acc: 0.741 Test Loss: 0.651 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.16935658454895
Epoch: 18, Steps: 13 | Train Loss: 0.123 Vali Loss: 0.632 Vali Acc: 0.746 Test Loss: 0.632 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 274610
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.784792900085449
Epoch: 1, Steps: 13 | Train Loss: 0.633 Vali Loss: 0.564 Vali Acc: 0.717 Test Loss: 0.564 Test Acc: 0.717
Validation loss decreased (inf --> -0.717068).  Saving model ...
Epoch: 2 cost time: 5.008579969406128
Epoch: 2, Steps: 13 | Train Loss: 0.569 Vali Loss: 0.542 Vali Acc: 0.737 Test Loss: 0.542 Test Acc: 0.737
Validation loss decreased (-0.717068 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 4.559558868408203
Epoch: 3, Steps: 13 | Train Loss: 0.537 Vali Loss: 0.525 Vali Acc: 0.746 Test Loss: 0.525 Test Acc: 0.746
Validation loss decreased (-0.736580 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 4.997008800506592
Epoch: 4, Steps: 13 | Train Loss: 0.509 Vali Loss: 0.547 Vali Acc: 0.737 Test Loss: 0.547 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.466397762298584
Epoch: 5, Steps: 13 | Train Loss: 0.460 Vali Loss: 0.535 Vali Acc: 0.727 Test Loss: 0.535 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.612272262573242
Epoch: 6, Steps: 13 | Train Loss: 0.453 Vali Loss: 0.505 Vali Acc: 0.761 Test Loss: 0.505 Test Acc: 0.761
Validation loss decreased (-0.746336 --> -0.760971).  Saving model ...
Epoch: 7 cost time: 4.467893362045288
Epoch: 7, Steps: 13 | Train Loss: 0.430 Vali Loss: 0.629 Vali Acc: 0.741 Test Loss: 0.629 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.488383054733276
Epoch: 8, Steps: 13 | Train Loss: 0.432 Vali Loss: 0.495 Vali Acc: 0.776 Test Loss: 0.495 Test Acc: 0.776
Validation loss decreased (-0.760971 --> -0.775605).  Saving model ...
Epoch: 9 cost time: 4.2830352783203125
Epoch: 9, Steps: 13 | Train Loss: 0.352 Vali Loss: 0.503 Vali Acc: 0.771 Test Loss: 0.503 Test Acc: 0.771
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.3979268074035645
Epoch: 10, Steps: 13 | Train Loss: 0.295 Vali Loss: 0.538 Vali Acc: 0.751 Test Loss: 0.538 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.272758722305298
Epoch: 11, Steps: 13 | Train Loss: 0.301 Vali Loss: 0.539 Vali Acc: 0.746 Test Loss: 0.539 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.524040937423706
Epoch: 12, Steps: 13 | Train Loss: 0.301 Vali Loss: 0.824 Vali Acc: 0.732 Test Loss: 0.824 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.598390340805054
Epoch: 13, Steps: 13 | Train Loss: 0.261 Vali Loss: 0.674 Vali Acc: 0.741 Test Loss: 0.674 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.994692087173462
Epoch: 14, Steps: 13 | Train Loss: 0.217 Vali Loss: 0.567 Vali Acc: 0.746 Test Loss: 0.567 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.567357301712036
Epoch: 15, Steps: 13 | Train Loss: 0.203 Vali Loss: 0.609 Vali Acc: 0.659 Test Loss: 0.609 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.922844648361206
Epoch: 16, Steps: 13 | Train Loss: 0.243 Vali Loss: 0.589 Vali Acc: 0.698 Test Loss: 0.589 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.580156087875366
Epoch: 17, Steps: 13 | Train Loss: 0.145 Vali Loss: 0.618 Vali Acc: 0.727 Test Loss: 0.618 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.874307870864868
Epoch: 18, Steps: 13 | Train Loss: 0.116 Vali Loss: 0.621 Vali Acc: 0.698 Test Loss: 0.621 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 895442
model size : 3.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.515422344207764
Epoch: 1, Steps: 13 | Train Loss: 0.606 Vali Loss: 0.600 Vali Acc: 0.722 Test Loss: 0.600 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.5855295658111572
Epoch: 2, Steps: 13 | Train Loss: 0.579 Vali Loss: 0.572 Vali Acc: 0.727 Test Loss: 0.572 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 2.9750916957855225
Epoch: 3, Steps: 13 | Train Loss: 0.517 Vali Loss: 0.549 Vali Acc: 0.732 Test Loss: 0.549 Test Acc: 0.732
Validation loss decreased (-0.726824 --> -0.731702).  Saving model ...
Epoch: 4 cost time: 3.1213152408599854
Epoch: 4, Steps: 13 | Train Loss: 0.515 Vali Loss: 0.546 Vali Acc: 0.737 Test Loss: 0.546 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736580).  Saving model ...
Epoch: 5 cost time: 2.609325885772705
Epoch: 5, Steps: 13 | Train Loss: 0.446 Vali Loss: 0.520 Vali Acc: 0.761 Test Loss: 0.520 Test Acc: 0.761
Validation loss decreased (-0.736580 --> -0.760970).  Saving model ...
Epoch: 6 cost time: 3.026033878326416
Epoch: 6, Steps: 13 | Train Loss: 0.407 Vali Loss: 0.514 Vali Acc: 0.756 Test Loss: 0.514 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.9628734588623047
Epoch: 7, Steps: 13 | Train Loss: 0.392 Vali Loss: 0.580 Vali Acc: 0.678 Test Loss: 0.580 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.704730987548828
Epoch: 8, Steps: 13 | Train Loss: 0.388 Vali Loss: 0.522 Vali Acc: 0.761 Test Loss: 0.522 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.809439182281494
Epoch: 9, Steps: 13 | Train Loss: 0.345 Vali Loss: 0.527 Vali Acc: 0.761 Test Loss: 0.527 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.000495195388794
Epoch: 10, Steps: 13 | Train Loss: 0.285 Vali Loss: 0.553 Vali Acc: 0.727 Test Loss: 0.553 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.9040334224700928
Epoch: 11, Steps: 13 | Train Loss: 0.250 Vali Loss: 0.612 Vali Acc: 0.771 Test Loss: 0.612 Test Acc: 0.771
Validation loss decreased (-0.760970 --> -0.770726).  Saving model ...
Epoch: 12 cost time: 2.746037244796753
Epoch: 12, Steps: 13 | Train Loss: 0.234 Vali Loss: 0.581 Vali Acc: 0.722 Test Loss: 0.581 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.9112424850463867
Epoch: 13, Steps: 13 | Train Loss: 0.227 Vali Loss: 0.579 Vali Acc: 0.741 Test Loss: 0.579 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.772491931915283
Epoch: 14, Steps: 13 | Train Loss: 0.183 Vali Loss: 0.758 Vali Acc: 0.590 Test Loss: 0.758 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.6531498432159424
Epoch: 15, Steps: 13 | Train Loss: 0.174 Vali Loss: 0.589 Vali Acc: 0.737 Test Loss: 0.589 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.8367490768432617
Epoch: 16, Steps: 13 | Train Loss: 0.171 Vali Loss: 0.661 Vali Acc: 0.688 Test Loss: 0.661 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.7699058055877686
Epoch: 17, Steps: 13 | Train Loss: 0.166 Vali Loss: 0.650 Vali Acc: 0.722 Test Loss: 0.650 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.9402010440826416
Epoch: 18, Steps: 13 | Train Loss: 0.121 Vali Loss: 0.667 Vali Acc: 0.688 Test Loss: 0.667 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.9231789112091064
Epoch: 19, Steps: 13 | Train Loss: 0.103 Vali Loss: 0.659 Vali Acc: 0.741 Test Loss: 0.659 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.723198890686035
Epoch: 20, Steps: 13 | Train Loss: 0.102 Vali Loss: 0.744 Vali Acc: 0.717 Test Loss: 0.744 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.763786792755127
Epoch: 21, Steps: 13 | Train Loss: 0.102 Vali Loss: 0.710 Vali Acc: 0.698 Test Loss: 0.710 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 274610
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.229185104370117
Epoch: 1, Steps: 13 | Train Loss: 0.633 Vali Loss: 0.566 Vali Acc: 0.717 Test Loss: 0.566 Test Acc: 0.717
Validation loss decreased (inf --> -0.717068).  Saving model ...
Epoch: 2 cost time: 2.8095340728759766
Epoch: 2, Steps: 13 | Train Loss: 0.572 Vali Loss: 0.543 Vali Acc: 0.732 Test Loss: 0.543 Test Acc: 0.732
Validation loss decreased (-0.717068 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 2.8121066093444824
Epoch: 3, Steps: 13 | Train Loss: 0.538 Vali Loss: 0.526 Vali Acc: 0.746 Test Loss: 0.526 Test Acc: 0.746
Validation loss decreased (-0.731702 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 2.5368881225585938
Epoch: 4, Steps: 13 | Train Loss: 0.512 Vali Loss: 0.543 Vali Acc: 0.737 Test Loss: 0.543 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5090067386627197
Epoch: 5, Steps: 13 | Train Loss: 0.460 Vali Loss: 0.536 Vali Acc: 0.741 Test Loss: 0.536 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.7565269470214844
Epoch: 6, Steps: 13 | Train Loss: 0.453 Vali Loss: 0.516 Vali Acc: 0.761 Test Loss: 0.516 Test Acc: 0.761
Validation loss decreased (-0.746336 --> -0.760970).  Saving model ...
Epoch: 7 cost time: 2.6486356258392334
Epoch: 7, Steps: 13 | Train Loss: 0.430 Vali Loss: 0.615 Vali Acc: 0.732 Test Loss: 0.615 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.6731131076812744
Epoch: 8, Steps: 13 | Train Loss: 0.418 Vali Loss: 0.514 Vali Acc: 0.751 Test Loss: 0.514 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.76725697517395
Epoch: 9, Steps: 13 | Train Loss: 0.368 Vali Loss: 0.525 Vali Acc: 0.737 Test Loss: 0.525 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.6197381019592285
Epoch: 10, Steps: 13 | Train Loss: 0.301 Vali Loss: 0.537 Vali Acc: 0.756 Test Loss: 0.537 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.5054590702056885
Epoch: 11, Steps: 13 | Train Loss: 0.310 Vali Loss: 0.494 Vali Acc: 0.771 Test Loss: 0.494 Test Acc: 0.771
Validation loss decreased (-0.760970 --> -0.770727).  Saving model ...
Epoch: 12 cost time: 2.6932528018951416
Epoch: 12, Steps: 13 | Train Loss: 0.285 Vali Loss: 0.666 Vali Acc: 0.727 Test Loss: 0.666 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.030219078063965
Epoch: 13, Steps: 13 | Train Loss: 0.244 Vali Loss: 0.625 Vali Acc: 0.756 Test Loss: 0.625 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.0611765384674072
Epoch: 14, Steps: 13 | Train Loss: 0.202 Vali Loss: 0.582 Vali Acc: 0.785 Test Loss: 0.582 Test Acc: 0.785
Validation loss decreased (-0.770727 --> -0.785360).  Saving model ...
Epoch: 15 cost time: 2.109550714492798
Epoch: 15, Steps: 13 | Train Loss: 0.185 Vali Loss: 0.562 Vali Acc: 0.712 Test Loss: 0.562 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.6054561138153076
Epoch: 16, Steps: 13 | Train Loss: 0.170 Vali Loss: 0.567 Vali Acc: 0.761 Test Loss: 0.567 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.4846808910369873
Epoch: 17, Steps: 13 | Train Loss: 0.148 Vali Loss: 0.666 Vali Acc: 0.717 Test Loss: 0.666 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.5361831188201904
Epoch: 18, Steps: 13 | Train Loss: 0.118 Vali Loss: 0.534 Vali Acc: 0.756 Test Loss: 0.534 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.4739983081817627
Epoch: 19, Steps: 13 | Train Loss: 0.106 Vali Loss: 0.533 Vali Acc: 0.810 Test Loss: 0.533 Test Acc: 0.810
Validation loss decreased (-0.785360 --> -0.809751).  Saving model ...
Epoch: 20 cost time: 2.538041591644287
Epoch: 20, Steps: 13 | Train Loss: 0.079 Vali Loss: 0.720 Vali Acc: 0.639 Test Loss: 0.720 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.384465217590332
Epoch: 21, Steps: 13 | Train Loss: 0.087 Vali Loss: 0.543 Vali Acc: 0.766 Test Loss: 0.543 Test Acc: 0.766
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.3860671520233154
Epoch: 22, Steps: 13 | Train Loss: 0.157 Vali Loss: 0.851 Vali Acc: 0.659 Test Loss: 0.851 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.5657436847686768
Epoch: 23, Steps: 13 | Train Loss: 0.060 Vali Loss: 0.709 Vali Acc: 0.717 Test Loss: 0.709 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.3550169467926025
Epoch: 24, Steps: 13 | Train Loss: 0.044 Vali Loss: 0.673 Vali Acc: 0.712 Test Loss: 0.673 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.361116409301758
Epoch: 25, Steps: 13 | Train Loss: 0.072 Vali Loss: 0.670 Vali Acc: 0.746 Test Loss: 0.670 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.5212197303771973
Epoch: 26, Steps: 13 | Train Loss: 0.031 Vali Loss: 0.700 Vali Acc: 0.717 Test Loss: 0.700 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.660583019256592
Epoch: 27, Steps: 13 | Train Loss: 0.024 Vali Loss: 0.777 Vali Acc: 0.698 Test Loss: 0.777 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.5992579460144043
Epoch: 28, Steps: 13 | Train Loss: 0.048 Vali Loss: 0.675 Vali Acc: 0.766 Test Loss: 0.675 Test Acc: 0.766
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.7657251358032227
Epoch: 29, Steps: 13 | Train Loss: 0.046 Vali Loss: 0.790 Vali Acc: 0.732 Test Loss: 0.790 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.8097560975609757
model parameter : 895442
model size : 3.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.4864344596862793
Epoch: 1, Steps: 13 | Train Loss: 0.604 Vali Loss: 0.594 Vali Acc: 0.722 Test Loss: 0.594 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.882392406463623
Epoch: 2, Steps: 13 | Train Loss: 0.577 Vali Loss: 0.567 Vali Acc: 0.727 Test Loss: 0.567 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 1.7656142711639404
Epoch: 3, Steps: 13 | Train Loss: 0.517 Vali Loss: 0.543 Vali Acc: 0.737 Test Loss: 0.543 Test Acc: 0.737
Validation loss decreased (-0.726824 --> -0.736580).  Saving model ...
Epoch: 4 cost time: 1.9032669067382812
Epoch: 4, Steps: 13 | Train Loss: 0.523 Vali Loss: 0.543 Vali Acc: 0.737 Test Loss: 0.543 Test Acc: 0.737
Validation loss decreased (-0.736580 --> -0.736580).  Saving model ...
Epoch: 5 cost time: 1.8807520866394043
Epoch: 5, Steps: 13 | Train Loss: 0.452 Vali Loss: 0.518 Vali Acc: 0.751 Test Loss: 0.518 Test Acc: 0.751
Validation loss decreased (-0.736580 --> -0.751214).  Saving model ...
Epoch: 6 cost time: 1.8647575378417969
Epoch: 6, Steps: 13 | Train Loss: 0.417 Vali Loss: 0.504 Vali Acc: 0.780 Test Loss: 0.504 Test Acc: 0.780
Validation loss decreased (-0.751214 --> -0.780483).  Saving model ...
Epoch: 7 cost time: 1.687821626663208
Epoch: 7, Steps: 13 | Train Loss: 0.410 Vali Loss: 0.558 Vali Acc: 0.693 Test Loss: 0.558 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.879697561264038
Epoch: 8, Steps: 13 | Train Loss: 0.398 Vali Loss: 0.509 Vali Acc: 0.766 Test Loss: 0.509 Test Acc: 0.766
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.7406725883483887
Epoch: 9, Steps: 13 | Train Loss: 0.344 Vali Loss: 0.518 Vali Acc: 0.761 Test Loss: 0.518 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.6121835708618164
Epoch: 10, Steps: 13 | Train Loss: 0.298 Vali Loss: 0.519 Vali Acc: 0.751 Test Loss: 0.519 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.8729219436645508
Epoch: 11, Steps: 13 | Train Loss: 0.263 Vali Loss: 0.611 Vali Acc: 0.771 Test Loss: 0.611 Test Acc: 0.771
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.8123972415924072
Epoch: 12, Steps: 13 | Train Loss: 0.247 Vali Loss: 0.541 Vali Acc: 0.741 Test Loss: 0.541 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.956017017364502
Epoch: 13, Steps: 13 | Train Loss: 0.227 Vali Loss: 0.583 Vali Acc: 0.776 Test Loss: 0.583 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.7433488368988037
Epoch: 14, Steps: 13 | Train Loss: 0.207 Vali Loss: 0.681 Vali Acc: 0.605 Test Loss: 0.681 Test Acc: 0.605
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.9853506088256836
Epoch: 15, Steps: 13 | Train Loss: 0.217 Vali Loss: 0.641 Vali Acc: 0.761 Test Loss: 0.641 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.7250101566314697
Epoch: 16, Steps: 13 | Train Loss: 0.186 Vali Loss: 0.658 Vali Acc: 0.746 Test Loss: 0.658 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7804878048780488
model parameter : 274610
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.936119556427002
Epoch: 1, Steps: 13 | Train Loss: 0.619 Vali Loss: 0.606 Vali Acc: 0.712 Test Loss: 0.606 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 4.687456369400024
Epoch: 2, Steps: 13 | Train Loss: 0.621 Vali Loss: 0.569 Vali Acc: 0.712 Test Loss: 0.569 Test Acc: 0.712
Validation loss decreased (-0.712189 --> -0.712189).  Saving model ...
Epoch: 3 cost time: 4.704308748245239
Epoch: 3, Steps: 13 | Train Loss: 0.553 Vali Loss: 0.554 Vali Acc: 0.727 Test Loss: 0.554 Test Acc: 0.727
Validation loss decreased (-0.712189 --> -0.726824).  Saving model ...
Epoch: 4 cost time: 4.388208627700806
Epoch: 4, Steps: 13 | Train Loss: 0.498 Vali Loss: 0.547 Vali Acc: 0.737 Test Loss: 0.547 Test Acc: 0.737
Validation loss decreased (-0.726824 --> -0.736580).  Saving model ...
Epoch: 5 cost time: 4.318670988082886
Epoch: 5, Steps: 13 | Train Loss: 0.464 Vali Loss: 0.534 Vali Acc: 0.761 Test Loss: 0.534 Test Acc: 0.761
Validation loss decreased (-0.736580 --> -0.760970).  Saving model ...
Epoch: 6 cost time: 3.431586503982544
Epoch: 6, Steps: 13 | Train Loss: 0.431 Vali Loss: 0.527 Vali Acc: 0.746 Test Loss: 0.527 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.6598660945892334
Epoch: 7, Steps: 13 | Train Loss: 0.431 Vali Loss: 0.520 Vali Acc: 0.751 Test Loss: 0.520 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.303670883178711
Epoch: 8, Steps: 13 | Train Loss: 0.382 Vali Loss: 0.587 Vali Acc: 0.732 Test Loss: 0.587 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.217885732650757
Epoch: 9, Steps: 13 | Train Loss: 0.357 Vali Loss: 0.531 Vali Acc: 0.756 Test Loss: 0.531 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.233030080795288
Epoch: 10, Steps: 13 | Train Loss: 0.320 Vali Loss: 0.527 Vali Acc: 0.751 Test Loss: 0.527 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.126798868179321
Epoch: 11, Steps: 13 | Train Loss: 0.262 Vali Loss: 0.531 Vali Acc: 0.732 Test Loss: 0.531 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.032977819442749
Epoch: 12, Steps: 13 | Train Loss: 0.253 Vali Loss: 0.549 Vali Acc: 0.717 Test Loss: 0.549 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 5.132548809051514
Epoch: 13, Steps: 13 | Train Loss: 0.211 Vali Loss: 0.576 Vali Acc: 0.751 Test Loss: 0.576 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 5.152311563491821
Epoch: 14, Steps: 13 | Train Loss: 0.194 Vali Loss: 0.579 Vali Acc: 0.717 Test Loss: 0.579 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 5.04565167427063
Epoch: 15, Steps: 13 | Train Loss: 0.175 Vali Loss: 0.631 Vali Acc: 0.707 Test Loss: 0.631 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 455858
model size : 2.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.9062933921813965
Epoch: 1, Steps: 13 | Train Loss: 0.593 Vali Loss: 0.575 Vali Acc: 0.712 Test Loss: 0.575 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 3.2322657108306885
Epoch: 2, Steps: 13 | Train Loss: 0.570 Vali Loss: 0.565 Vali Acc: 0.712 Test Loss: 0.565 Test Acc: 0.712
Validation loss decreased (-0.712189 --> -0.712189).  Saving model ...
Epoch: 3 cost time: 3.218135118484497
Epoch: 3, Steps: 13 | Train Loss: 0.546 Vali Loss: 0.559 Vali Acc: 0.712 Test Loss: 0.559 Test Acc: 0.712
Validation loss decreased (-0.712189 --> -0.712190).  Saving model ...
Epoch: 4 cost time: 3.281360149383545
Epoch: 4, Steps: 13 | Train Loss: 0.533 Vali Loss: 0.544 Vali Acc: 0.727 Test Loss: 0.544 Test Acc: 0.727
Validation loss decreased (-0.712190 --> -0.726824).  Saving model ...
Epoch: 5 cost time: 3.2682676315307617
Epoch: 5, Steps: 13 | Train Loss: 0.496 Vali Loss: 0.535 Vali Acc: 0.746 Test Loss: 0.535 Test Acc: 0.746
Validation loss decreased (-0.726824 --> -0.746336).  Saving model ...
Epoch: 6 cost time: 3.228550434112549
Epoch: 6, Steps: 13 | Train Loss: 0.449 Vali Loss: 0.532 Vali Acc: 0.737 Test Loss: 0.532 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.187347888946533
Epoch: 7, Steps: 13 | Train Loss: 0.410 Vali Loss: 0.521 Vali Acc: 0.761 Test Loss: 0.521 Test Acc: 0.761
Validation loss decreased (-0.746336 --> -0.760970).  Saving model ...
Epoch: 8 cost time: 3.028571605682373
Epoch: 8, Steps: 13 | Train Loss: 0.377 Vali Loss: 0.582 Vali Acc: 0.722 Test Loss: 0.582 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.1733648777008057
Epoch: 9, Steps: 13 | Train Loss: 0.383 Vali Loss: 0.555 Vali Acc: 0.712 Test Loss: 0.555 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.1800389289855957
Epoch: 10, Steps: 13 | Train Loss: 0.341 Vali Loss: 0.532 Vali Acc: 0.746 Test Loss: 0.532 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.239450454711914
Epoch: 11, Steps: 13 | Train Loss: 0.286 Vali Loss: 0.531 Vali Acc: 0.722 Test Loss: 0.531 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.203716993331909
Epoch: 12, Steps: 13 | Train Loss: 0.270 Vali Loss: 0.582 Vali Acc: 0.756 Test Loss: 0.582 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.1548609733581543
Epoch: 13, Steps: 13 | Train Loss: 0.238 Vali Loss: 0.563 Vali Acc: 0.693 Test Loss: 0.563 Test Acc: 0.693
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.210479259490967
Epoch: 14, Steps: 13 | Train Loss: 0.204 Vali Loss: 0.565 Vali Acc: 0.741 Test Loss: 0.565 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.245300054550171
Epoch: 15, Steps: 13 | Train Loss: 0.219 Vali Loss: 0.575 Vali Acc: 0.698 Test Loss: 0.575 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.244551658630371
Epoch: 16, Steps: 13 | Train Loss: 0.216 Vali Loss: 0.622 Vali Acc: 0.654 Test Loss: 0.622 Test Acc: 0.654
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.018211841583252
Epoch: 17, Steps: 13 | Train Loss: 0.157 Vali Loss: 0.588 Vali Acc: 0.688 Test Loss: 0.588 Test Acc: 0.688
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 145394
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.022637367248535
Epoch: 1, Steps: 13 | Train Loss: 0.618 Vali Loss: 0.608 Vali Acc: 0.712 Test Loss: 0.608 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 4.195045232772827
Epoch: 2, Steps: 13 | Train Loss: 0.622 Vali Loss: 0.571 Vali Acc: 0.712 Test Loss: 0.571 Test Acc: 0.712
Validation loss decreased (-0.712189 --> -0.712189).  Saving model ...
Epoch: 3 cost time: 4.213601350784302
Epoch: 3, Steps: 13 | Train Loss: 0.554 Vali Loss: 0.554 Vali Acc: 0.722 Test Loss: 0.554 Test Acc: 0.722
Validation loss decreased (-0.712189 --> -0.721946).  Saving model ...
Epoch: 4 cost time: 4.069264888763428
Epoch: 4, Steps: 13 | Train Loss: 0.501 Vali Loss: 0.544 Vali Acc: 0.741 Test Loss: 0.544 Test Acc: 0.741
Validation loss decreased (-0.721946 --> -0.741458).  Saving model ...
Epoch: 5 cost time: 4.171976804733276
Epoch: 5, Steps: 13 | Train Loss: 0.470 Vali Loss: 0.530 Vali Acc: 0.751 Test Loss: 0.530 Test Acc: 0.751
Validation loss decreased (-0.741458 --> -0.751214).  Saving model ...
Epoch: 6 cost time: 4.270517349243164
Epoch: 6, Steps: 13 | Train Loss: 0.435 Vali Loss: 0.519 Vali Acc: 0.761 Test Loss: 0.519 Test Acc: 0.761
Validation loss decreased (-0.751214 --> -0.760970).  Saving model ...
Epoch: 7 cost time: 4.508756637573242
Epoch: 7, Steps: 13 | Train Loss: 0.436 Vali Loss: 0.525 Vali Acc: 0.741 Test Loss: 0.525 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.613798379898071
Epoch: 8, Steps: 13 | Train Loss: 0.392 Vali Loss: 0.589 Vali Acc: 0.737 Test Loss: 0.589 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.323890686035156
Epoch: 9, Steps: 13 | Train Loss: 0.364 Vali Loss: 0.533 Vali Acc: 0.756 Test Loss: 0.533 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.396226644515991
Epoch: 10, Steps: 13 | Train Loss: 0.332 Vali Loss: 0.522 Vali Acc: 0.737 Test Loss: 0.522 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.135018348693848
Epoch: 11, Steps: 13 | Train Loss: 0.267 Vali Loss: 0.524 Vali Acc: 0.741 Test Loss: 0.524 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.459519147872925
Epoch: 12, Steps: 13 | Train Loss: 0.273 Vali Loss: 0.552 Vali Acc: 0.741 Test Loss: 0.552 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.40321946144104
Epoch: 13, Steps: 13 | Train Loss: 0.224 Vali Loss: 0.556 Vali Acc: 0.746 Test Loss: 0.556 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.387535572052002
Epoch: 14, Steps: 13 | Train Loss: 0.207 Vali Loss: 0.574 Vali Acc: 0.707 Test Loss: 0.574 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.145954608917236
Epoch: 15, Steps: 13 | Train Loss: 0.177 Vali Loss: 0.571 Vali Acc: 0.732 Test Loss: 0.571 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.9202659130096436
Epoch: 16, Steps: 13 | Train Loss: 0.151 Vali Loss: 0.614 Vali Acc: 0.732 Test Loss: 0.614 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 455858
model size : 2.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.6973512172698975
Epoch: 1, Steps: 13 | Train Loss: 0.590 Vali Loss: 0.573 Vali Acc: 0.712 Test Loss: 0.573 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 2.892683506011963
Epoch: 2, Steps: 13 | Train Loss: 0.567 Vali Loss: 0.562 Vali Acc: 0.712 Test Loss: 0.562 Test Acc: 0.712
Validation loss decreased (-0.712189 --> -0.712190).  Saving model ...
Epoch: 3 cost time: 2.8448684215545654
Epoch: 3, Steps: 13 | Train Loss: 0.540 Vali Loss: 0.556 Vali Acc: 0.712 Test Loss: 0.556 Test Acc: 0.712
Validation loss decreased (-0.712190 --> -0.712190).  Saving model ...
Epoch: 4 cost time: 2.720520496368408
Epoch: 4, Steps: 13 | Train Loss: 0.533 Vali Loss: 0.540 Vali Acc: 0.727 Test Loss: 0.540 Test Acc: 0.727
Validation loss decreased (-0.712190 --> -0.726824).  Saving model ...
Epoch: 5 cost time: 2.6896705627441406
Epoch: 5, Steps: 13 | Train Loss: 0.496 Vali Loss: 0.531 Vali Acc: 0.746 Test Loss: 0.531 Test Acc: 0.746
Validation loss decreased (-0.726824 --> -0.746336).  Saving model ...
Epoch: 6 cost time: 2.732081174850464
Epoch: 6, Steps: 13 | Train Loss: 0.448 Vali Loss: 0.532 Vali Acc: 0.756 Test Loss: 0.532 Test Acc: 0.756
Validation loss decreased (-0.746336 --> -0.756092).  Saving model ...
Epoch: 7 cost time: 2.8273987770080566
Epoch: 7, Steps: 13 | Train Loss: 0.407 Vali Loss: 0.518 Vali Acc: 0.756 Test Loss: 0.518 Test Acc: 0.756
Validation loss decreased (-0.756092 --> -0.756092).  Saving model ...
Epoch: 8 cost time: 2.82920241355896
Epoch: 8, Steps: 13 | Train Loss: 0.377 Vali Loss: 0.586 Vali Acc: 0.722 Test Loss: 0.586 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.8724751472473145
Epoch: 9, Steps: 13 | Train Loss: 0.386 Vali Loss: 0.549 Vali Acc: 0.707 Test Loss: 0.549 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.8088066577911377
Epoch: 10, Steps: 13 | Train Loss: 0.342 Vali Loss: 0.528 Vali Acc: 0.761 Test Loss: 0.528 Test Acc: 0.761
Validation loss decreased (-0.756092 --> -0.760970).  Saving model ...
Epoch: 11 cost time: 2.7899839878082275
Epoch: 11, Steps: 13 | Train Loss: 0.292 Vali Loss: 0.532 Vali Acc: 0.737 Test Loss: 0.532 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.691816568374634
Epoch: 12, Steps: 13 | Train Loss: 0.280 Vali Loss: 0.587 Vali Acc: 0.756 Test Loss: 0.587 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.578209638595581
Epoch: 13, Steps: 13 | Train Loss: 0.243 Vali Loss: 0.570 Vali Acc: 0.688 Test Loss: 0.570 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.653548240661621
Epoch: 14, Steps: 13 | Train Loss: 0.208 Vali Loss: 0.563 Vali Acc: 0.741 Test Loss: 0.563 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.6331729888916016
Epoch: 15, Steps: 13 | Train Loss: 0.214 Vali Loss: 0.570 Vali Acc: 0.707 Test Loss: 0.570 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.6164183616638184
Epoch: 16, Steps: 13 | Train Loss: 0.209 Vali Loss: 0.595 Vali Acc: 0.683 Test Loss: 0.595 Test Acc: 0.683
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.6438913345336914
Epoch: 17, Steps: 13 | Train Loss: 0.166 Vali Loss: 0.576 Vali Acc: 0.688 Test Loss: 0.576 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.8288397789001465
Epoch: 18, Steps: 13 | Train Loss: 0.134 Vali Loss: 0.644 Vali Acc: 0.654 Test Loss: 0.644 Test Acc: 0.654
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.8006200790405273
Epoch: 19, Steps: 13 | Train Loss: 0.142 Vali Loss: 0.606 Vali Acc: 0.698 Test Loss: 0.606 Test Acc: 0.698
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.8111965656280518
Epoch: 20, Steps: 13 | Train Loss: 0.118 Vali Loss: 0.645 Vali Acc: 0.673 Test Loss: 0.645 Test Acc: 0.673
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 145394
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.113083600997925
Epoch: 1, Steps: 13 | Train Loss: 0.618 Vali Loss: 0.605 Vali Acc: 0.717 Test Loss: 0.605 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 2.5222654342651367
Epoch: 2, Steps: 13 | Train Loss: 0.622 Vali Loss: 0.568 Vali Acc: 0.712 Test Loss: 0.568 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.8260250091552734
Epoch: 3, Steps: 13 | Train Loss: 0.558 Vali Loss: 0.552 Vali Acc: 0.727 Test Loss: 0.552 Test Acc: 0.727
Validation loss decreased (-0.717067 --> -0.726824).  Saving model ...
Epoch: 4 cost time: 2.799619674682617
Epoch: 4, Steps: 13 | Train Loss: 0.505 Vali Loss: 0.540 Vali Acc: 0.741 Test Loss: 0.540 Test Acc: 0.741
Validation loss decreased (-0.726824 --> -0.741458).  Saving model ...
Epoch: 5 cost time: 2.757098913192749
Epoch: 5, Steps: 13 | Train Loss: 0.474 Vali Loss: 0.526 Vali Acc: 0.761 Test Loss: 0.526 Test Acc: 0.761
Validation loss decreased (-0.741458 --> -0.760970).  Saving model ...
Epoch: 6 cost time: 2.6483078002929688
Epoch: 6, Steps: 13 | Train Loss: 0.439 Vali Loss: 0.520 Vali Acc: 0.741 Test Loss: 0.520 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.625831365585327
Epoch: 7, Steps: 13 | Train Loss: 0.436 Vali Loss: 0.522 Vali Acc: 0.732 Test Loss: 0.522 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.57283353805542
Epoch: 8, Steps: 13 | Train Loss: 0.383 Vali Loss: 0.578 Vali Acc: 0.732 Test Loss: 0.578 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.40803599357605
Epoch: 9, Steps: 13 | Train Loss: 0.373 Vali Loss: 0.520 Vali Acc: 0.780 Test Loss: 0.520 Test Acc: 0.780
Validation loss decreased (-0.760970 --> -0.780483).  Saving model ...
Epoch: 10 cost time: 2.598242998123169
Epoch: 10, Steps: 13 | Train Loss: 0.330 Vali Loss: 0.516 Vali Acc: 0.751 Test Loss: 0.516 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.4221792221069336
Epoch: 11, Steps: 13 | Train Loss: 0.269 Vali Loss: 0.522 Vali Acc: 0.746 Test Loss: 0.522 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.725888967514038
Epoch: 12, Steps: 13 | Train Loss: 0.270 Vali Loss: 0.543 Vali Acc: 0.737 Test Loss: 0.543 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.7611775398254395
Epoch: 13, Steps: 13 | Train Loss: 0.234 Vali Loss: 0.551 Vali Acc: 0.751 Test Loss: 0.551 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.714735984802246
Epoch: 14, Steps: 13 | Train Loss: 0.234 Vali Loss: 0.593 Vali Acc: 0.673 Test Loss: 0.593 Test Acc: 0.673
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.72532320022583
Epoch: 15, Steps: 13 | Train Loss: 0.193 Vali Loss: 0.701 Vali Acc: 0.595 Test Loss: 0.701 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.7901511192321777
Epoch: 16, Steps: 13 | Train Loss: 0.164 Vali Loss: 0.593 Vali Acc: 0.737 Test Loss: 0.593 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.654486894607544
Epoch: 17, Steps: 13 | Train Loss: 0.158 Vali Loss: 0.598 Vali Acc: 0.741 Test Loss: 0.598 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.4494800567626953
Epoch: 18, Steps: 13 | Train Loss: 0.125 Vali Loss: 0.764 Vali Acc: 0.751 Test Loss: 0.764 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.6198227405548096
Epoch: 19, Steps: 13 | Train Loss: 0.145 Vali Loss: 0.726 Vali Acc: 0.756 Test Loss: 0.726 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7804878048780488
model parameter : 455858
model size : 2.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.30544376373291
Epoch: 1, Steps: 13 | Train Loss: 0.589 Vali Loss: 0.572 Vali Acc: 0.712 Test Loss: 0.572 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 1.8752765655517578
Epoch: 2, Steps: 13 | Train Loss: 0.565 Vali Loss: 0.559 Vali Acc: 0.717 Test Loss: 0.559 Test Acc: 0.717
Validation loss decreased (-0.712189 --> -0.717068).  Saving model ...
Epoch: 3 cost time: 1.8576610088348389
Epoch: 3, Steps: 13 | Train Loss: 0.542 Vali Loss: 0.555 Vali Acc: 0.717 Test Loss: 0.555 Test Acc: 0.717
Validation loss decreased (-0.717068 --> -0.717068).  Saving model ...
Epoch: 4 cost time: 1.7667443752288818
Epoch: 4, Steps: 13 | Train Loss: 0.533 Vali Loss: 0.537 Vali Acc: 0.732 Test Loss: 0.537 Test Acc: 0.732
Validation loss decreased (-0.717068 --> -0.731702).  Saving model ...
Epoch: 5 cost time: 1.838425874710083
Epoch: 5, Steps: 13 | Train Loss: 0.497 Vali Loss: 0.528 Vali Acc: 0.751 Test Loss: 0.528 Test Acc: 0.751
Validation loss decreased (-0.731702 --> -0.751214).  Saving model ...
Epoch: 6 cost time: 1.8116788864135742
Epoch: 6, Steps: 13 | Train Loss: 0.450 Vali Loss: 0.530 Vali Acc: 0.756 Test Loss: 0.530 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756092).  Saving model ...
Epoch: 7 cost time: 1.9053399562835693
Epoch: 7, Steps: 13 | Train Loss: 0.411 Vali Loss: 0.521 Vali Acc: 0.761 Test Loss: 0.521 Test Acc: 0.761
Validation loss decreased (-0.756092 --> -0.760970).  Saving model ...
Epoch: 8 cost time: 1.9080991744995117
Epoch: 8, Steps: 13 | Train Loss: 0.375 Vali Loss: 0.606 Vali Acc: 0.727 Test Loss: 0.606 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.948112964630127
Epoch: 9, Steps: 13 | Train Loss: 0.391 Vali Loss: 0.567 Vali Acc: 0.702 Test Loss: 0.567 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.931750774383545
Epoch: 10, Steps: 13 | Train Loss: 0.342 Vali Loss: 0.540 Vali Acc: 0.761 Test Loss: 0.540 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.9383656978607178
Epoch: 11, Steps: 13 | Train Loss: 0.302 Vali Loss: 0.540 Vali Acc: 0.751 Test Loss: 0.540 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.9513773918151855
Epoch: 12, Steps: 13 | Train Loss: 0.282 Vali Loss: 0.581 Vali Acc: 0.761 Test Loss: 0.581 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.9268581867218018
Epoch: 13, Steps: 13 | Train Loss: 0.243 Vali Loss: 0.541 Vali Acc: 0.751 Test Loss: 0.541 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.040627956390381
Epoch: 14, Steps: 13 | Train Loss: 0.208 Vali Loss: 0.599 Vali Acc: 0.761 Test Loss: 0.599 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.8902900218963623
Epoch: 15, Steps: 13 | Train Loss: 0.214 Vali Loss: 0.554 Vali Acc: 0.741 Test Loss: 0.554 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.8615477085113525
Epoch: 16, Steps: 13 | Train Loss: 0.177 Vali Loss: 0.573 Vali Acc: 0.746 Test Loss: 0.573 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.7629923820495605
Epoch: 17, Steps: 13 | Train Loss: 0.165 Vali Loss: 0.565 Vali Acc: 0.737 Test Loss: 0.565 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 145394
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 9.512548208236694
Epoch: 1, Steps: 13 | Train Loss: 0.612 Vali Loss: 0.588 Vali Acc: 0.722 Test Loss: 0.588 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 7.718769311904907
Epoch: 2, Steps: 13 | Train Loss: 0.602 Vali Loss: 0.579 Vali Acc: 0.722 Test Loss: 0.579 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 7.437823295593262
Epoch: 3, Steps: 13 | Train Loss: 0.565 Vali Loss: 0.579 Vali Acc: 0.722 Test Loss: 0.579 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 4 cost time: 7.745419502258301
Epoch: 4, Steps: 13 | Train Loss: 0.561 Vali Loss: 0.570 Vali Acc: 0.717 Test Loss: 0.570 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.071277141571045
Epoch: 5, Steps: 13 | Train Loss: 0.534 Vali Loss: 0.564 Vali Acc: 0.717 Test Loss: 0.564 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.965405702590942
Epoch: 6, Steps: 13 | Train Loss: 0.495 Vali Loss: 0.560 Vali Acc: 0.717 Test Loss: 0.560 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 7.52582311630249
Epoch: 7, Steps: 13 | Train Loss: 0.459 Vali Loss: 0.555 Vali Acc: 0.732 Test Loss: 0.555 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 8 cost time: 7.955803155899048
Epoch: 8, Steps: 13 | Train Loss: 0.446 Vali Loss: 0.543 Vali Acc: 0.727 Test Loss: 0.543 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.764447450637817
Epoch: 9, Steps: 13 | Train Loss: 0.420 Vali Loss: 0.558 Vali Acc: 0.737 Test Loss: 0.558 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736580).  Saving model ...
Epoch: 10 cost time: 7.84004282951355
Epoch: 10, Steps: 13 | Train Loss: 0.418 Vali Loss: 0.555 Vali Acc: 0.741 Test Loss: 0.555 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741458).  Saving model ...
Epoch: 11 cost time: 7.827926874160767
Epoch: 11, Steps: 13 | Train Loss: 0.363 Vali Loss: 0.558 Vali Acc: 0.751 Test Loss: 0.558 Test Acc: 0.751
Validation loss decreased (-0.741458 --> -0.751214).  Saving model ...
Epoch: 12 cost time: 7.888428211212158
Epoch: 12, Steps: 13 | Train Loss: 0.387 Vali Loss: 0.580 Vali Acc: 0.717 Test Loss: 0.580 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 8.218428611755371
Epoch: 13, Steps: 13 | Train Loss: 0.323 Vali Loss: 0.564 Vali Acc: 0.761 Test Loss: 0.564 Test Acc: 0.761
Validation loss decreased (-0.751214 --> -0.760970).  Saving model ...
Epoch: 14 cost time: 8.1840500831604
Epoch: 14, Steps: 13 | Train Loss: 0.394 Vali Loss: 0.733 Vali Acc: 0.698 Test Loss: 0.733 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 8.008600950241089
Epoch: 15, Steps: 13 | Train Loss: 0.345 Vali Loss: 0.527 Vali Acc: 0.761 Test Loss: 0.527 Test Acc: 0.761
Validation loss decreased (-0.760970 --> -0.760970).  Saving model ...
Epoch: 16 cost time: 7.6203248500823975
Epoch: 16, Steps: 13 | Train Loss: 0.289 Vali Loss: 0.594 Vali Acc: 0.693 Test Loss: 0.594 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 7.826585292816162
Epoch: 17, Steps: 13 | Train Loss: 0.292 Vali Loss: 0.555 Vali Acc: 0.732 Test Loss: 0.555 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 7.82433819770813
Epoch: 18, Steps: 13 | Train Loss: 0.280 Vali Loss: 0.535 Vali Acc: 0.751 Test Loss: 0.535 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 7.7535240650177
Epoch: 19, Steps: 13 | Train Loss: 0.245 Vali Loss: 0.668 Vali Acc: 0.756 Test Loss: 0.668 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 7.068937301635742
Epoch: 20, Steps: 13 | Train Loss: 0.257 Vali Loss: 0.706 Vali Acc: 0.702 Test Loss: 0.706 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 8.089664220809937
Epoch: 21, Steps: 13 | Train Loss: 0.226 Vali Loss: 0.571 Vali Acc: 0.737 Test Loss: 0.571 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 8.33366584777832
Epoch: 22, Steps: 13 | Train Loss: 0.193 Vali Loss: 0.664 Vali Acc: 0.746 Test Loss: 0.664 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 8.209874629974365
Epoch: 23, Steps: 13 | Train Loss: 0.215 Vali Loss: 0.624 Vali Acc: 0.707 Test Loss: 0.624 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 7.968270301818848
Epoch: 24, Steps: 13 | Train Loss: 0.195 Vali Loss: 0.637 Vali Acc: 0.732 Test Loss: 0.637 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 7.846342325210571
Epoch: 25, Steps: 13 | Train Loss: 0.181 Vali Loss: 0.712 Vali Acc: 0.654 Test Loss: 0.712 Test Acc: 0.654
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 887882
model size : 3.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.085353136062622
Epoch: 1, Steps: 13 | Train Loss: 0.618 Vali Loss: 0.570 Vali Acc: 0.717 Test Loss: 0.570 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 4.475157260894775
Epoch: 2, Steps: 13 | Train Loss: 0.581 Vali Loss: 0.563 Vali Acc: 0.727 Test Loss: 0.563 Test Acc: 0.727
Validation loss decreased (-0.717067 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 4.246070861816406
Epoch: 3, Steps: 13 | Train Loss: 0.566 Vali Loss: 0.549 Vali Acc: 0.746 Test Loss: 0.549 Test Acc: 0.746
Validation loss decreased (-0.726824 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 4.359076023101807
Epoch: 4, Steps: 13 | Train Loss: 0.545 Vali Loss: 0.542 Vali Acc: 0.737 Test Loss: 0.542 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.562626123428345
Epoch: 5, Steps: 13 | Train Loss: 0.509 Vali Loss: 0.533 Vali Acc: 0.751 Test Loss: 0.533 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751214).  Saving model ...
Epoch: 6 cost time: 4.526062726974487
Epoch: 6, Steps: 13 | Train Loss: 0.506 Vali Loss: 0.518 Vali Acc: 0.746 Test Loss: 0.518 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.590364694595337
Epoch: 7, Steps: 13 | Train Loss: 0.441 Vali Loss: 0.515 Vali Acc: 0.756 Test Loss: 0.515 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756092).  Saving model ...
Epoch: 8 cost time: 4.587283372879028
Epoch: 8, Steps: 13 | Train Loss: 0.448 Vali Loss: 0.532 Vali Acc: 0.737 Test Loss: 0.532 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.182156324386597
Epoch: 9, Steps: 13 | Train Loss: 0.436 Vali Loss: 0.531 Vali Acc: 0.756 Test Loss: 0.531 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.137577772140503
Epoch: 10, Steps: 13 | Train Loss: 0.413 Vali Loss: 0.570 Vali Acc: 0.737 Test Loss: 0.570 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.7940564155578613
Epoch: 11, Steps: 13 | Train Loss: 0.374 Vali Loss: 0.574 Vali Acc: 0.746 Test Loss: 0.574 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.416166305541992
Epoch: 12, Steps: 13 | Train Loss: 0.360 Vali Loss: 0.543 Vali Acc: 0.737 Test Loss: 0.543 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.2065083980560303
Epoch: 13, Steps: 13 | Train Loss: 0.361 Vali Loss: 0.530 Vali Acc: 0.717 Test Loss: 0.530 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.1785788536071777
Epoch: 14, Steps: 13 | Train Loss: 0.319 Vali Loss: 0.528 Vali Acc: 0.727 Test Loss: 0.528 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.479949712753296
Epoch: 15, Steps: 13 | Train Loss: 0.284 Vali Loss: 0.556 Vali Acc: 0.717 Test Loss: 0.556 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.250048875808716
Epoch: 16, Steps: 13 | Train Loss: 0.253 Vali Loss: 0.618 Vali Acc: 0.741 Test Loss: 0.618 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.1818766593933105
Epoch: 17, Steps: 13 | Train Loss: 0.272 Vali Loss: 0.629 Vali Acc: 0.756 Test Loss: 0.629 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 266906
model size : 1.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.016057968139648
Epoch: 1, Steps: 13 | Train Loss: 0.612 Vali Loss: 0.588 Vali Acc: 0.722 Test Loss: 0.588 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 5.705966472625732
Epoch: 2, Steps: 13 | Train Loss: 0.604 Vali Loss: 0.579 Vali Acc: 0.722 Test Loss: 0.579 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 6.121035099029541
Epoch: 3, Steps: 13 | Train Loss: 0.566 Vali Loss: 0.576 Vali Acc: 0.722 Test Loss: 0.576 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 4 cost time: 5.6968278884887695
Epoch: 4, Steps: 13 | Train Loss: 0.557 Vali Loss: 0.567 Vali Acc: 0.717 Test Loss: 0.567 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.133908748626709
Epoch: 5, Steps: 13 | Train Loss: 0.530 Vali Loss: 0.561 Vali Acc: 0.722 Test Loss: 0.561 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721946).  Saving model ...
Epoch: 6 cost time: 5.958786249160767
Epoch: 6, Steps: 13 | Train Loss: 0.494 Vali Loss: 0.552 Vali Acc: 0.727 Test Loss: 0.552 Test Acc: 0.727
Validation loss decreased (-0.721946 --> -0.726824).  Saving model ...
Epoch: 7 cost time: 5.830003261566162
Epoch: 7, Steps: 13 | Train Loss: 0.472 Vali Loss: 0.540 Vali Acc: 0.746 Test Loss: 0.540 Test Acc: 0.746
Validation loss decreased (-0.726824 --> -0.746336).  Saving model ...
Epoch: 8 cost time: 6.119210243225098
Epoch: 8, Steps: 13 | Train Loss: 0.433 Vali Loss: 0.534 Vali Acc: 0.751 Test Loss: 0.534 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751214).  Saving model ...
Epoch: 9 cost time: 5.610739707946777
Epoch: 9, Steps: 13 | Train Loss: 0.419 Vali Loss: 0.552 Vali Acc: 0.722 Test Loss: 0.552 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.279922723770142
Epoch: 10, Steps: 13 | Train Loss: 0.422 Vali Loss: 0.570 Vali Acc: 0.737 Test Loss: 0.570 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.743172883987427
Epoch: 11, Steps: 13 | Train Loss: 0.377 Vali Loss: 0.558 Vali Acc: 0.746 Test Loss: 0.558 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.737375259399414
Epoch: 12, Steps: 13 | Train Loss: 0.402 Vali Loss: 0.608 Vali Acc: 0.683 Test Loss: 0.608 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.793452978134155
Epoch: 13, Steps: 13 | Train Loss: 0.336 Vali Loss: 0.608 Vali Acc: 0.737 Test Loss: 0.608 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.104893684387207
Epoch: 14, Steps: 13 | Train Loss: 0.336 Vali Loss: 0.584 Vali Acc: 0.722 Test Loss: 0.584 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.74299168586731
Epoch: 15, Steps: 13 | Train Loss: 0.379 Vali Loss: 0.568 Vali Acc: 0.751 Test Loss: 0.568 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.890089511871338
Epoch: 16, Steps: 13 | Train Loss: 0.306 Vali Loss: 0.572 Vali Acc: 0.707 Test Loss: 0.572 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 6.107070207595825
Epoch: 17, Steps: 13 | Train Loss: 0.307 Vali Loss: 0.561 Vali Acc: 0.737 Test Loss: 0.561 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 5.497907876968384
Epoch: 18, Steps: 13 | Train Loss: 0.288 Vali Loss: 0.546 Vali Acc: 0.737 Test Loss: 0.546 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 887882
model size : 3.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.2204909324646
Epoch: 1, Steps: 13 | Train Loss: 0.621 Vali Loss: 0.571 Vali Acc: 0.712 Test Loss: 0.571 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 3.5507233142852783
Epoch: 2, Steps: 13 | Train Loss: 0.582 Vali Loss: 0.563 Vali Acc: 0.727 Test Loss: 0.563 Test Acc: 0.727
Validation loss decreased (-0.712189 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 3.7607181072235107
Epoch: 3, Steps: 13 | Train Loss: 0.568 Vali Loss: 0.549 Vali Acc: 0.737 Test Loss: 0.549 Test Acc: 0.737
Validation loss decreased (-0.726824 --> -0.736580).  Saving model ...
Epoch: 4 cost time: 3.5516583919525146
Epoch: 4, Steps: 13 | Train Loss: 0.548 Vali Loss: 0.540 Vali Acc: 0.737 Test Loss: 0.540 Test Acc: 0.737
Validation loss decreased (-0.736580 --> -0.736580).  Saving model ...
Epoch: 5 cost time: 3.5019614696502686
Epoch: 5, Steps: 13 | Train Loss: 0.506 Vali Loss: 0.527 Vali Acc: 0.751 Test Loss: 0.527 Test Acc: 0.751
Validation loss decreased (-0.736580 --> -0.751214).  Saving model ...
Epoch: 6 cost time: 3.7707903385162354
Epoch: 6, Steps: 13 | Train Loss: 0.506 Vali Loss: 0.518 Vali Acc: 0.761 Test Loss: 0.518 Test Acc: 0.761
Validation loss decreased (-0.751214 --> -0.760970).  Saving model ...
Epoch: 7 cost time: 3.7583072185516357
Epoch: 7, Steps: 13 | Train Loss: 0.443 Vali Loss: 0.515 Vali Acc: 0.746 Test Loss: 0.515 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.5731260776519775
Epoch: 8, Steps: 13 | Train Loss: 0.474 Vali Loss: 0.539 Vali Acc: 0.727 Test Loss: 0.539 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.635958433151245
Epoch: 9, Steps: 13 | Train Loss: 0.436 Vali Loss: 0.523 Vali Acc: 0.751 Test Loss: 0.523 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.5860331058502197
Epoch: 10, Steps: 13 | Train Loss: 0.419 Vali Loss: 0.600 Vali Acc: 0.751 Test Loss: 0.600 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.618412733078003
Epoch: 11, Steps: 13 | Train Loss: 0.392 Vali Loss: 0.539 Vali Acc: 0.741 Test Loss: 0.539 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.4480812549591064
Epoch: 12, Steps: 13 | Train Loss: 0.354 Vali Loss: 0.524 Vali Acc: 0.756 Test Loss: 0.524 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.5798609256744385
Epoch: 13, Steps: 13 | Train Loss: 0.358 Vali Loss: 0.534 Vali Acc: 0.707 Test Loss: 0.534 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.7899386882781982
Epoch: 14, Steps: 13 | Train Loss: 0.329 Vali Loss: 0.530 Vali Acc: 0.702 Test Loss: 0.530 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.859908103942871
Epoch: 15, Steps: 13 | Train Loss: 0.300 Vali Loss: 0.546 Vali Acc: 0.727 Test Loss: 0.546 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.497488498687744
Epoch: 16, Steps: 13 | Train Loss: 0.260 Vali Loss: 0.603 Vali Acc: 0.727 Test Loss: 0.603 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 266906
model size : 1.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.322063684463501
Epoch: 1, Steps: 13 | Train Loss: 0.613 Vali Loss: 0.589 Vali Acc: 0.722 Test Loss: 0.589 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 3.6717450618743896
Epoch: 2, Steps: 13 | Train Loss: 0.606 Vali Loss: 0.580 Vali Acc: 0.722 Test Loss: 0.580 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 3.766038656234741
Epoch: 3, Steps: 13 | Train Loss: 0.572 Vali Loss: 0.576 Vali Acc: 0.722 Test Loss: 0.576 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 4 cost time: 3.6663870811462402
Epoch: 4, Steps: 13 | Train Loss: 0.565 Vali Loss: 0.567 Vali Acc: 0.717 Test Loss: 0.567 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.5828630924224854
Epoch: 5, Steps: 13 | Train Loss: 0.546 Vali Loss: 0.558 Vali Acc: 0.717 Test Loss: 0.558 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.3080179691314697
Epoch: 6, Steps: 13 | Train Loss: 0.506 Vali Loss: 0.545 Vali Acc: 0.732 Test Loss: 0.545 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 7 cost time: 3.781949520111084
Epoch: 7, Steps: 13 | Train Loss: 0.490 Vali Loss: 0.534 Vali Acc: 0.741 Test Loss: 0.534 Test Acc: 0.741
Validation loss decreased (-0.731702 --> -0.741458).  Saving model ...
Epoch: 8 cost time: 3.7765045166015625
Epoch: 8, Steps: 13 | Train Loss: 0.457 Vali Loss: 0.608 Vali Acc: 0.727 Test Loss: 0.608 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.472172975540161
Epoch: 9, Steps: 13 | Train Loss: 0.449 Vali Loss: 0.588 Vali Acc: 0.698 Test Loss: 0.588 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.5193135738372803
Epoch: 10, Steps: 13 | Train Loss: 0.456 Vali Loss: 0.530 Vali Acc: 0.741 Test Loss: 0.530 Test Acc: 0.741
Validation loss decreased (-0.741458 --> -0.741458).  Saving model ...
Epoch: 11 cost time: 4.027086496353149
Epoch: 11, Steps: 13 | Train Loss: 0.391 Vali Loss: 0.572 Vali Acc: 0.741 Test Loss: 0.572 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.8134942054748535
Epoch: 12, Steps: 13 | Train Loss: 0.440 Vali Loss: 0.572 Vali Acc: 0.712 Test Loss: 0.572 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.5928497314453125
Epoch: 13, Steps: 13 | Train Loss: 0.352 Vali Loss: 0.592 Vali Acc: 0.741 Test Loss: 0.592 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.9793176651000977
Epoch: 14, Steps: 13 | Train Loss: 0.391 Vali Loss: 0.507 Vali Acc: 0.766 Test Loss: 0.507 Test Acc: 0.766
Validation loss decreased (-0.741458 --> -0.765849).  Saving model ...
Epoch: 15 cost time: 3.8058583736419678
Epoch: 15, Steps: 13 | Train Loss: 0.371 Vali Loss: 0.469 Vali Acc: 0.800 Test Loss: 0.469 Test Acc: 0.800
Validation loss decreased (-0.765849 --> -0.799995).  Saving model ...
Epoch: 16 cost time: 3.6206562519073486
Epoch: 16, Steps: 13 | Train Loss: 0.318 Vali Loss: 0.575 Vali Acc: 0.707 Test Loss: 0.575 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.5582761764526367
Epoch: 17, Steps: 13 | Train Loss: 0.310 Vali Loss: 0.496 Vali Acc: 0.771 Test Loss: 0.496 Test Acc: 0.771
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.7691566944122314
Epoch: 18, Steps: 13 | Train Loss: 0.281 Vali Loss: 0.496 Vali Acc: 0.771 Test Loss: 0.496 Test Acc: 0.771
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.976226568222046
Epoch: 19, Steps: 13 | Train Loss: 0.257 Vali Loss: 0.595 Vali Acc: 0.741 Test Loss: 0.595 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.798346996307373
Epoch: 20, Steps: 13 | Train Loss: 0.245 Vali Loss: 0.504 Vali Acc: 0.776 Test Loss: 0.504 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.4748287200927734
Epoch: 21, Steps: 13 | Train Loss: 0.284 Vali Loss: 0.701 Vali Acc: 0.732 Test Loss: 0.701 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.979790687561035
Epoch: 22, Steps: 13 | Train Loss: 0.260 Vali Loss: 0.634 Vali Acc: 0.761 Test Loss: 0.634 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.9218509197235107
Epoch: 23, Steps: 13 | Train Loss: 0.224 Vali Loss: 0.567 Vali Acc: 0.737 Test Loss: 0.567 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.397482395172119
Epoch: 24, Steps: 13 | Train Loss: 0.189 Vali Loss: 0.615 Vali Acc: 0.751 Test Loss: 0.615 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.9952890872955322
Epoch: 25, Steps: 13 | Train Loss: 0.199 Vali Loss: 0.656 Vali Acc: 0.668 Test Loss: 0.656 Test Acc: 0.668
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.8
model parameter : 887882
model size : 3.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.104374885559082
Epoch: 1, Steps: 13 | Train Loss: 0.619 Vali Loss: 0.572 Vali Acc: 0.712 Test Loss: 0.572 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 2.441174030303955
Epoch: 2, Steps: 13 | Train Loss: 0.581 Vali Loss: 0.548 Vali Acc: 0.727 Test Loss: 0.548 Test Acc: 0.727
Validation loss decreased (-0.712189 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 2.457087278366089
Epoch: 3, Steps: 13 | Train Loss: 0.568 Vali Loss: 0.527 Vali Acc: 0.741 Test Loss: 0.527 Test Acc: 0.741
Validation loss decreased (-0.726824 --> -0.741458).  Saving model ...
Epoch: 4 cost time: 2.5901944637298584
Epoch: 4, Steps: 13 | Train Loss: 0.548 Vali Loss: 0.526 Vali Acc: 0.741 Test Loss: 0.526 Test Acc: 0.741
Validation loss decreased (-0.741458 --> -0.741458).  Saving model ...
Epoch: 5 cost time: 2.6060190200805664
Epoch: 5, Steps: 13 | Train Loss: 0.513 Vali Loss: 0.530 Vali Acc: 0.741 Test Loss: 0.530 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.6532373428344727
Epoch: 6, Steps: 13 | Train Loss: 0.514 Vali Loss: 0.545 Vali Acc: 0.737 Test Loss: 0.545 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.584188938140869
Epoch: 7, Steps: 13 | Train Loss: 0.456 Vali Loss: 0.520 Vali Acc: 0.746 Test Loss: 0.520 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746336).  Saving model ...
Epoch: 8 cost time: 2.5053858757019043
Epoch: 8, Steps: 13 | Train Loss: 0.474 Vali Loss: 0.517 Vali Acc: 0.746 Test Loss: 0.517 Test Acc: 0.746
Validation loss decreased (-0.746336 --> -0.746336).  Saving model ...
Epoch: 9 cost time: 2.600390672683716
Epoch: 9, Steps: 13 | Train Loss: 0.448 Vali Loss: 0.518 Vali Acc: 0.756 Test Loss: 0.518 Test Acc: 0.756
Validation loss decreased (-0.746336 --> -0.756092).  Saving model ...
Epoch: 10 cost time: 2.3585710525512695
Epoch: 10, Steps: 13 | Train Loss: 0.434 Vali Loss: 0.485 Vali Acc: 0.751 Test Loss: 0.485 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.636712074279785
Epoch: 11, Steps: 13 | Train Loss: 0.390 Vali Loss: 0.517 Vali Acc: 0.756 Test Loss: 0.517 Test Acc: 0.756
Validation loss decreased (-0.756092 --> -0.756092).  Saving model ...
Epoch: 12 cost time: 2.6357712745666504
Epoch: 12, Steps: 13 | Train Loss: 0.398 Vali Loss: 0.488 Vali Acc: 0.756 Test Loss: 0.488 Test Acc: 0.756
Validation loss decreased (-0.756092 --> -0.756093).  Saving model ...
Epoch: 13 cost time: 2.629211664199829
Epoch: 13, Steps: 13 | Train Loss: 0.387 Vali Loss: 0.527 Vali Acc: 0.737 Test Loss: 0.527 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.5261478424072266
Epoch: 14, Steps: 13 | Train Loss: 0.428 Vali Loss: 0.499 Vali Acc: 0.756 Test Loss: 0.499 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.381834030151367
Epoch: 15, Steps: 13 | Train Loss: 0.330 Vali Loss: 0.541 Vali Acc: 0.746 Test Loss: 0.541 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.398662805557251
Epoch: 16, Steps: 13 | Train Loss: 0.299 Vali Loss: 0.547 Vali Acc: 0.746 Test Loss: 0.547 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.2801878452301025
Epoch: 17, Steps: 13 | Train Loss: 0.311 Vali Loss: 0.552 Vali Acc: 0.732 Test Loss: 0.552 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.5378623008728027
Epoch: 18, Steps: 13 | Train Loss: 0.272 Vali Loss: 0.482 Vali Acc: 0.771 Test Loss: 0.482 Test Acc: 0.771
Validation loss decreased (-0.756093 --> -0.770727).  Saving model ...
Epoch: 19 cost time: 2.6330623626708984
Epoch: 19, Steps: 13 | Train Loss: 0.301 Vali Loss: 0.565 Vali Acc: 0.741 Test Loss: 0.565 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.599604606628418
Epoch: 20, Steps: 13 | Train Loss: 0.242 Vali Loss: 0.600 Vali Acc: 0.746 Test Loss: 0.600 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.35501766204834
Epoch: 21, Steps: 13 | Train Loss: 0.230 Vali Loss: 0.593 Vali Acc: 0.727 Test Loss: 0.593 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.560030698776245
Epoch: 22, Steps: 13 | Train Loss: 0.218 Vali Loss: 0.577 Vali Acc: 0.698 Test Loss: 0.577 Test Acc: 0.698
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.4041616916656494
Epoch: 23, Steps: 13 | Train Loss: 0.184 Vali Loss: 0.539 Vali Acc: 0.746 Test Loss: 0.539 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.527642011642456
Epoch: 24, Steps: 13 | Train Loss: 0.193 Vali Loss: 0.623 Vali Acc: 0.746 Test Loss: 0.623 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.63409686088562
Epoch: 25, Steps: 13 | Train Loss: 0.164 Vali Loss: 0.656 Vali Acc: 0.707 Test Loss: 0.656 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.6766889095306396
Epoch: 26, Steps: 13 | Train Loss: 0.164 Vali Loss: 0.841 Vali Acc: 0.751 Test Loss: 0.841 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.7101080417633057
Epoch: 27, Steps: 13 | Train Loss: 0.251 Vali Loss: 0.648 Vali Acc: 0.737 Test Loss: 0.648 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.6155898571014404
Epoch: 28, Steps: 13 | Train Loss: 0.289 Vali Loss: 0.629 Vali Acc: 0.693 Test Loss: 0.629 Test Acc: 0.693
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 266906
model size : 1.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.636393070220947
Epoch: 1, Steps: 13 | Train Loss: 0.580 Vali Loss: 0.582 Vali Acc: 0.712 Test Loss: 0.582 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 5.02218770980835
Epoch: 2, Steps: 13 | Train Loss: 0.586 Vali Loss: 0.574 Vali Acc: 0.712 Test Loss: 0.574 Test Acc: 0.712
Validation loss decreased (-0.712189 --> -0.712189).  Saving model ...
Epoch: 3 cost time: 5.258262395858765
Epoch: 3, Steps: 13 | Train Loss: 0.552 Vali Loss: 0.564 Vali Acc: 0.712 Test Loss: 0.564 Test Acc: 0.712
Validation loss decreased (-0.712189 --> -0.712189).  Saving model ...
Epoch: 4 cost time: 4.889403581619263
Epoch: 4, Steps: 13 | Train Loss: 0.520 Vali Loss: 0.557 Vali Acc: 0.722 Test Loss: 0.557 Test Acc: 0.722
Validation loss decreased (-0.712189 --> -0.721946).  Saving model ...
Epoch: 5 cost time: 4.801864862442017
Epoch: 5, Steps: 13 | Train Loss: 0.523 Vali Loss: 0.566 Vali Acc: 0.717 Test Loss: 0.566 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.135322570800781
Epoch: 6, Steps: 13 | Train Loss: 0.478 Vali Loss: 0.542 Vali Acc: 0.717 Test Loss: 0.542 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.121970891952515
Epoch: 7, Steps: 13 | Train Loss: 0.440 Vali Loss: 0.554 Vali Acc: 0.717 Test Loss: 0.554 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.988501787185669
Epoch: 8, Steps: 13 | Train Loss: 0.445 Vali Loss: 0.542 Vali Acc: 0.722 Test Loss: 0.542 Test Acc: 0.722
Validation loss decreased (-0.721946 --> -0.721946).  Saving model ...
Epoch: 9 cost time: 4.5185301303863525
Epoch: 9, Steps: 13 | Train Loss: 0.425 Vali Loss: 0.540 Vali Acc: 0.741 Test Loss: 0.540 Test Acc: 0.741
Validation loss decreased (-0.721946 --> -0.741458).  Saving model ...
Epoch: 10 cost time: 4.692497968673706
Epoch: 10, Steps: 13 | Train Loss: 0.400 Vali Loss: 0.526 Vali Acc: 0.741 Test Loss: 0.526 Test Acc: 0.741
Validation loss decreased (-0.741458 --> -0.741458).  Saving model ...
Epoch: 11 cost time: 4.7263805866241455
Epoch: 11, Steps: 13 | Train Loss: 0.407 Vali Loss: 0.543 Vali Acc: 0.737 Test Loss: 0.543 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.842264890670776
Epoch: 12, Steps: 13 | Train Loss: 0.370 Vali Loss: 0.564 Vali Acc: 0.741 Test Loss: 0.564 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.831943511962891
Epoch: 13, Steps: 13 | Train Loss: 0.366 Vali Loss: 0.525 Vali Acc: 0.746 Test Loss: 0.525 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746336).  Saving model ...
Epoch: 14 cost time: 4.859860181808472
Epoch: 14, Steps: 13 | Train Loss: 0.311 Vali Loss: 0.521 Vali Acc: 0.766 Test Loss: 0.521 Test Acc: 0.766
Validation loss decreased (-0.746336 --> -0.765848).  Saving model ...
Epoch: 15 cost time: 5.035277605056763
Epoch: 15, Steps: 13 | Train Loss: 0.299 Vali Loss: 0.545 Vali Acc: 0.702 Test Loss: 0.545 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.090129137039185
Epoch: 16, Steps: 13 | Train Loss: 0.293 Vali Loss: 0.517 Vali Acc: 0.761 Test Loss: 0.517 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.844630002975464
Epoch: 17, Steps: 13 | Train Loss: 0.268 Vali Loss: 0.524 Vali Acc: 0.761 Test Loss: 0.524 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.65506911277771
Epoch: 18, Steps: 13 | Train Loss: 0.257 Vali Loss: 0.539 Vali Acc: 0.756 Test Loss: 0.539 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.387902498245239
Epoch: 19, Steps: 13 | Train Loss: 0.226 Vali Loss: 0.582 Vali Acc: 0.663 Test Loss: 0.582 Test Acc: 0.663
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.696856260299683
Epoch: 20, Steps: 13 | Train Loss: 0.225 Vali Loss: 0.573 Vali Acc: 0.766 Test Loss: 0.573 Test Acc: 0.766
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.647897720336914
Epoch: 21, Steps: 13 | Train Loss: 0.196 Vali Loss: 0.586 Vali Acc: 0.668 Test Loss: 0.586 Test Acc: 0.668
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.6484010219573975
Epoch: 22, Steps: 13 | Train Loss: 0.187 Vali Loss: 0.567 Vali Acc: 0.751 Test Loss: 0.567 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.734029054641724
Epoch: 23, Steps: 13 | Train Loss: 0.184 Vali Loss: 0.570 Vali Acc: 0.741 Test Loss: 0.570 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 4.817535161972046
Epoch: 24, Steps: 13 | Train Loss: 0.161 Vali Loss: 0.593 Vali Acc: 0.698 Test Loss: 0.593 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 448010
model size : 1.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.745756149291992
Epoch: 1, Steps: 13 | Train Loss: 0.613 Vali Loss: 0.588 Vali Acc: 0.717 Test Loss: 0.588 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 2.949618339538574
Epoch: 2, Steps: 13 | Train Loss: 0.582 Vali Loss: 0.578 Vali Acc: 0.717 Test Loss: 0.578 Test Acc: 0.717
Validation loss decreased (-0.717067 --> -0.717067).  Saving model ...
Epoch: 3 cost time: 2.910672426223755
Epoch: 3, Steps: 13 | Train Loss: 0.574 Vali Loss: 0.565 Vali Acc: 0.732 Test Loss: 0.565 Test Acc: 0.732
Validation loss decreased (-0.717067 --> -0.731702).  Saving model ...
Epoch: 4 cost time: 2.9610469341278076
Epoch: 4, Steps: 13 | Train Loss: 0.553 Vali Loss: 0.557 Vali Acc: 0.741 Test Loss: 0.557 Test Acc: 0.741
Validation loss decreased (-0.731702 --> -0.741458).  Saving model ...
Epoch: 5 cost time: 3.0432920455932617
Epoch: 5, Steps: 13 | Train Loss: 0.511 Vali Loss: 0.550 Vali Acc: 0.746 Test Loss: 0.550 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746336).  Saving model ...
Epoch: 6 cost time: 3.0076215267181396
Epoch: 6, Steps: 13 | Train Loss: 0.532 Vali Loss: 0.544 Vali Acc: 0.741 Test Loss: 0.544 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.008755922317505
Epoch: 7, Steps: 13 | Train Loss: 0.496 Vali Loss: 0.537 Vali Acc: 0.746 Test Loss: 0.537 Test Acc: 0.746
Validation loss decreased (-0.746336 --> -0.746336).  Saving model ...
Epoch: 8 cost time: 2.9009556770324707
Epoch: 8, Steps: 13 | Train Loss: 0.459 Vali Loss: 0.539 Vali Acc: 0.737 Test Loss: 0.539 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.2061023712158203
Epoch: 9, Steps: 13 | Train Loss: 0.435 Vali Loss: 0.530 Vali Acc: 0.756 Test Loss: 0.530 Test Acc: 0.756
Validation loss decreased (-0.746336 --> -0.756092).  Saving model ...
Epoch: 10 cost time: 3.2387895584106445
Epoch: 10, Steps: 13 | Train Loss: 0.417 Vali Loss: 0.545 Vali Acc: 0.727 Test Loss: 0.545 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.310025453567505
Epoch: 11, Steps: 13 | Train Loss: 0.401 Vali Loss: 0.546 Vali Acc: 0.746 Test Loss: 0.546 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.1566860675811768
Epoch: 12, Steps: 13 | Train Loss: 0.368 Vali Loss: 0.538 Vali Acc: 0.751 Test Loss: 0.538 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.117872953414917
Epoch: 13, Steps: 13 | Train Loss: 0.399 Vali Loss: 0.555 Vali Acc: 0.688 Test Loss: 0.555 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.1173512935638428
Epoch: 14, Steps: 13 | Train Loss: 0.367 Vali Loss: 0.568 Vali Acc: 0.761 Test Loss: 0.568 Test Acc: 0.761
Validation loss decreased (-0.756092 --> -0.760970).  Saving model ...
Epoch: 15 cost time: 3.09407377243042
Epoch: 15, Steps: 13 | Train Loss: 0.337 Vali Loss: 0.541 Vali Acc: 0.766 Test Loss: 0.541 Test Acc: 0.766
Validation loss decreased (-0.760970 --> -0.765848).  Saving model ...
Epoch: 16 cost time: 3.21858286857605
Epoch: 16, Steps: 13 | Train Loss: 0.312 Vali Loss: 0.553 Vali Acc: 0.766 Test Loss: 0.553 Test Acc: 0.766
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.0376808643341064
Epoch: 17, Steps: 13 | Train Loss: 0.309 Vali Loss: 0.578 Vali Acc: 0.732 Test Loss: 0.578 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.032900810241699
Epoch: 18, Steps: 13 | Train Loss: 0.276 Vali Loss: 0.579 Vali Acc: 0.727 Test Loss: 0.579 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.9982831478118896
Epoch: 19, Steps: 13 | Train Loss: 0.263 Vali Loss: 0.582 Vali Acc: 0.746 Test Loss: 0.582 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.948620080947876
Epoch: 20, Steps: 13 | Train Loss: 0.264 Vali Loss: 0.622 Vali Acc: 0.673 Test Loss: 0.622 Test Acc: 0.673
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.1982624530792236
Epoch: 21, Steps: 13 | Train Loss: 0.239 Vali Loss: 0.581 Vali Acc: 0.732 Test Loss: 0.581 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.2724945545196533
Epoch: 22, Steps: 13 | Train Loss: 0.209 Vali Loss: 0.621 Vali Acc: 0.659 Test Loss: 0.621 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.2222373485565186
Epoch: 23, Steps: 13 | Train Loss: 0.211 Vali Loss: 0.617 Vali Acc: 0.693 Test Loss: 0.617 Test Acc: 0.693
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.2580573558807373
Epoch: 24, Steps: 13 | Train Loss: 0.179 Vali Loss: 0.627 Vali Acc: 0.712 Test Loss: 0.627 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.1907763481140137
Epoch: 25, Steps: 13 | Train Loss: 0.156 Vali Loss: 0.641 Vali Acc: 0.698 Test Loss: 0.641 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 137498
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.629081964492798
Epoch: 1, Steps: 13 | Train Loss: 0.581 Vali Loss: 0.582 Vali Acc: 0.712 Test Loss: 0.582 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 3.7822422981262207
Epoch: 2, Steps: 13 | Train Loss: 0.587 Vali Loss: 0.574 Vali Acc: 0.712 Test Loss: 0.574 Test Acc: 0.712
Validation loss decreased (-0.712189 --> -0.712189).  Saving model ...
Epoch: 3 cost time: 3.7678420543670654
Epoch: 3, Steps: 13 | Train Loss: 0.551 Vali Loss: 0.562 Vali Acc: 0.717 Test Loss: 0.562 Test Acc: 0.717
Validation loss decreased (-0.712189 --> -0.717068).  Saving model ...
Epoch: 4 cost time: 3.599815607070923
Epoch: 4, Steps: 13 | Train Loss: 0.521 Vali Loss: 0.555 Vali Acc: 0.727 Test Loss: 0.555 Test Acc: 0.727
Validation loss decreased (-0.717068 --> -0.726824).  Saving model ...
Epoch: 5 cost time: 3.4607715606689453
Epoch: 5, Steps: 13 | Train Loss: 0.523 Vali Loss: 0.564 Vali Acc: 0.717 Test Loss: 0.564 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.649366617202759
Epoch: 6, Steps: 13 | Train Loss: 0.482 Vali Loss: 0.540 Vali Acc: 0.722 Test Loss: 0.540 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.8994693756103516
Epoch: 7, Steps: 13 | Train Loss: 0.440 Vali Loss: 0.551 Vali Acc: 0.707 Test Loss: 0.551 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.894388198852539
Epoch: 8, Steps: 13 | Train Loss: 0.445 Vali Loss: 0.542 Vali Acc: 0.727 Test Loss: 0.542 Test Acc: 0.727
Validation loss decreased (-0.726824 --> -0.726824).  Saving model ...
Epoch: 9 cost time: 3.915602445602417
Epoch: 9, Steps: 13 | Train Loss: 0.448 Vali Loss: 0.542 Vali Acc: 0.732 Test Loss: 0.542 Test Acc: 0.732
Validation loss decreased (-0.726824 --> -0.731702).  Saving model ...
Epoch: 10 cost time: 3.903825521469116
Epoch: 10, Steps: 13 | Train Loss: 0.410 Vali Loss: 0.517 Vali Acc: 0.737 Test Loss: 0.517 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736580).  Saving model ...
Epoch: 11 cost time: 3.8206491470336914
Epoch: 11, Steps: 13 | Train Loss: 0.385 Vali Loss: 0.514 Vali Acc: 0.741 Test Loss: 0.514 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741458).  Saving model ...
Epoch: 12 cost time: 3.9768800735473633
Epoch: 12, Steps: 13 | Train Loss: 0.360 Vali Loss: 0.530 Vali Acc: 0.741 Test Loss: 0.530 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.957939863204956
Epoch: 13, Steps: 13 | Train Loss: 0.351 Vali Loss: 0.515 Vali Acc: 0.756 Test Loss: 0.515 Test Acc: 0.756
Validation loss decreased (-0.741458 --> -0.756092).  Saving model ...
Epoch: 14 cost time: 3.8533737659454346
Epoch: 14, Steps: 13 | Train Loss: 0.310 Vali Loss: 0.515 Vali Acc: 0.737 Test Loss: 0.515 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.6466269493103027
Epoch: 15, Steps: 13 | Train Loss: 0.301 Vali Loss: 0.552 Vali Acc: 0.673 Test Loss: 0.552 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.6322834491729736
Epoch: 16, Steps: 13 | Train Loss: 0.298 Vali Loss: 0.520 Vali Acc: 0.756 Test Loss: 0.520 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.598912239074707
Epoch: 17, Steps: 13 | Train Loss: 0.276 Vali Loss: 0.522 Vali Acc: 0.761 Test Loss: 0.522 Test Acc: 0.761
Validation loss decreased (-0.756092 --> -0.760970).  Saving model ...
Epoch: 18 cost time: 3.9345579147338867
Epoch: 18, Steps: 13 | Train Loss: 0.251 Vali Loss: 0.535 Vali Acc: 0.756 Test Loss: 0.535 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.9549341201782227
Epoch: 19, Steps: 13 | Train Loss: 0.228 Vali Loss: 0.591 Vali Acc: 0.663 Test Loss: 0.591 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.9246203899383545
Epoch: 20, Steps: 13 | Train Loss: 0.229 Vali Loss: 0.626 Vali Acc: 0.751 Test Loss: 0.626 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.755758285522461
Epoch: 21, Steps: 13 | Train Loss: 0.205 Vali Loss: 0.598 Vali Acc: 0.659 Test Loss: 0.598 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.6286721229553223
Epoch: 22, Steps: 13 | Train Loss: 0.192 Vali Loss: 0.580 Vali Acc: 0.737 Test Loss: 0.580 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.8271636962890625
Epoch: 23, Steps: 13 | Train Loss: 0.187 Vali Loss: 0.587 Vali Acc: 0.732 Test Loss: 0.587 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.9193596839904785
Epoch: 24, Steps: 13 | Train Loss: 0.170 Vali Loss: 0.627 Vali Acc: 0.693 Test Loss: 0.627 Test Acc: 0.693
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.9938719272613525
Epoch: 25, Steps: 13 | Train Loss: 0.156 Vali Loss: 0.615 Vali Acc: 0.727 Test Loss: 0.615 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.8641443252563477
Epoch: 26, Steps: 13 | Train Loss: 0.138 Vali Loss: 0.668 Vali Acc: 0.663 Test Loss: 0.668 Test Acc: 0.663
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.5766866207122803
Epoch: 27, Steps: 13 | Train Loss: 0.140 Vali Loss: 0.773 Vali Acc: 0.639 Test Loss: 0.773 Test Acc: 0.639
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 448010
model size : 1.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.4598283767700195
Epoch: 1, Steps: 13 | Train Loss: 0.613 Vali Loss: 0.587 Vali Acc: 0.717 Test Loss: 0.587 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 2.715304374694824
Epoch: 2, Steps: 13 | Train Loss: 0.583 Vali Loss: 0.577 Vali Acc: 0.717 Test Loss: 0.577 Test Acc: 0.717
Validation loss decreased (-0.717067 --> -0.717067).  Saving model ...
Epoch: 3 cost time: 2.709757089614868
Epoch: 3, Steps: 13 | Train Loss: 0.574 Vali Loss: 0.566 Vali Acc: 0.732 Test Loss: 0.566 Test Acc: 0.732
Validation loss decreased (-0.717067 --> -0.731702).  Saving model ...
Epoch: 4 cost time: 2.5932397842407227
Epoch: 4, Steps: 13 | Train Loss: 0.553 Vali Loss: 0.558 Vali Acc: 0.737 Test Loss: 0.558 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736580).  Saving model ...
Epoch: 5 cost time: 2.476806879043579
Epoch: 5, Steps: 13 | Train Loss: 0.512 Vali Loss: 0.551 Vali Acc: 0.746 Test Loss: 0.551 Test Acc: 0.746
Validation loss decreased (-0.736580 --> -0.746336).  Saving model ...
Epoch: 6 cost time: 2.6230452060699463
Epoch: 6, Steps: 13 | Train Loss: 0.533 Vali Loss: 0.548 Vali Acc: 0.727 Test Loss: 0.548 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.611712694168091
Epoch: 7, Steps: 13 | Train Loss: 0.497 Vali Loss: 0.545 Vali Acc: 0.751 Test Loss: 0.545 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751214).  Saving model ...
Epoch: 8 cost time: 2.782191753387451
Epoch: 8, Steps: 13 | Train Loss: 0.461 Vali Loss: 0.542 Vali Acc: 0.732 Test Loss: 0.542 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.7014055252075195
Epoch: 9, Steps: 13 | Train Loss: 0.435 Vali Loss: 0.544 Vali Acc: 0.751 Test Loss: 0.544 Test Acc: 0.751
Validation loss decreased (-0.751214 --> -0.751214).  Saving model ...
Epoch: 10 cost time: 2.7287509441375732
Epoch: 10, Steps: 13 | Train Loss: 0.419 Vali Loss: 0.544 Vali Acc: 0.737 Test Loss: 0.544 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.459183692932129
Epoch: 11, Steps: 13 | Train Loss: 0.403 Vali Loss: 0.551 Vali Acc: 0.746 Test Loss: 0.551 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.288902759552002
Epoch: 12, Steps: 13 | Train Loss: 0.386 Vali Loss: 0.542 Vali Acc: 0.722 Test Loss: 0.542 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.465986728668213
Epoch: 13, Steps: 13 | Train Loss: 0.404 Vali Loss: 0.552 Vali Acc: 0.717 Test Loss: 0.552 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.479621410369873
Epoch: 14, Steps: 13 | Train Loss: 0.363 Vali Loss: 0.569 Vali Acc: 0.746 Test Loss: 0.569 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.8734540939331055
Epoch: 15, Steps: 13 | Train Loss: 0.337 Vali Loss: 0.538 Vali Acc: 0.741 Test Loss: 0.538 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.0134267807006836
Epoch: 16, Steps: 13 | Train Loss: 0.313 Vali Loss: 0.558 Vali Acc: 0.756 Test Loss: 0.558 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756092).  Saving model ...
Epoch: 17 cost time: 1.9245221614837646
Epoch: 17, Steps: 13 | Train Loss: 0.302 Vali Loss: 0.545 Vali Acc: 0.756 Test Loss: 0.545 Test Acc: 0.756
Validation loss decreased (-0.756092 --> -0.756092).  Saving model ...
Epoch: 18 cost time: 2.6373462677001953
Epoch: 18, Steps: 13 | Train Loss: 0.289 Vali Loss: 0.574 Vali Acc: 0.698 Test Loss: 0.574 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.676567316055298
Epoch: 19, Steps: 13 | Train Loss: 0.277 Vali Loss: 0.555 Vali Acc: 0.741 Test Loss: 0.555 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.5689055919647217
Epoch: 20, Steps: 13 | Train Loss: 0.237 Vali Loss: 0.594 Vali Acc: 0.702 Test Loss: 0.594 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.5037059783935547
Epoch: 21, Steps: 13 | Train Loss: 0.223 Vali Loss: 0.605 Vali Acc: 0.751 Test Loss: 0.605 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.753009080886841
Epoch: 22, Steps: 13 | Train Loss: 0.200 Vali Loss: 0.634 Vali Acc: 0.663 Test Loss: 0.634 Test Acc: 0.663
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.529731035232544
Epoch: 23, Steps: 13 | Train Loss: 0.204 Vali Loss: 0.622 Vali Acc: 0.698 Test Loss: 0.622 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.5385680198669434
Epoch: 24, Steps: 13 | Train Loss: 0.171 Vali Loss: 0.586 Vali Acc: 0.741 Test Loss: 0.586 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.5751452445983887
Epoch: 25, Steps: 13 | Train Loss: 0.160 Vali Loss: 0.590 Vali Acc: 0.751 Test Loss: 0.590 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.5483057498931885
Epoch: 26, Steps: 13 | Train Loss: 0.168 Vali Loss: 0.670 Vali Acc: 0.741 Test Loss: 0.670 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.2951319217681885
Epoch: 27, Steps: 13 | Train Loss: 0.148 Vali Loss: 0.666 Vali Acc: 0.732 Test Loss: 0.666 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 137498
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.48902702331543
Epoch: 1, Steps: 13 | Train Loss: 0.582 Vali Loss: 0.587 Vali Acc: 0.712 Test Loss: 0.587 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 2.981971025466919
Epoch: 2, Steps: 13 | Train Loss: 0.588 Vali Loss: 0.576 Vali Acc: 0.712 Test Loss: 0.576 Test Acc: 0.712
Validation loss decreased (-0.712189 --> -0.712189).  Saving model ...
Epoch: 3 cost time: 2.7309985160827637
Epoch: 3, Steps: 13 | Train Loss: 0.555 Vali Loss: 0.562 Vali Acc: 0.717 Test Loss: 0.562 Test Acc: 0.717
Validation loss decreased (-0.712189 --> -0.717068).  Saving model ...
Epoch: 4 cost time: 2.805236339569092
Epoch: 4, Steps: 13 | Train Loss: 0.529 Vali Loss: 0.555 Vali Acc: 0.722 Test Loss: 0.555 Test Acc: 0.722
Validation loss decreased (-0.717068 --> -0.721946).  Saving model ...
Epoch: 5 cost time: 2.9372382164001465
Epoch: 5, Steps: 13 | Train Loss: 0.528 Vali Loss: 0.582 Vali Acc: 0.712 Test Loss: 0.582 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.94541335105896
Epoch: 6, Steps: 13 | Train Loss: 0.496 Vali Loss: 0.562 Vali Acc: 0.712 Test Loss: 0.562 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.659139633178711
Epoch: 7, Steps: 13 | Train Loss: 0.454 Vali Loss: 0.543 Vali Acc: 0.727 Test Loss: 0.543 Test Acc: 0.727
Validation loss decreased (-0.721946 --> -0.726824).  Saving model ...
Epoch: 8 cost time: 2.742771863937378
Epoch: 8, Steps: 13 | Train Loss: 0.470 Vali Loss: 0.523 Vali Acc: 0.737 Test Loss: 0.523 Test Acc: 0.737
Validation loss decreased (-0.726824 --> -0.736580).  Saving model ...
Epoch: 9 cost time: 2.9490363597869873
Epoch: 9, Steps: 13 | Train Loss: 0.457 Vali Loss: 0.515 Vali Acc: 0.727 Test Loss: 0.515 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.6439502239227295
Epoch: 10, Steps: 13 | Train Loss: 0.417 Vali Loss: 0.525 Vali Acc: 0.727 Test Loss: 0.525 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.6447386741638184
Epoch: 11, Steps: 13 | Train Loss: 0.402 Vali Loss: 0.535 Vali Acc: 0.746 Test Loss: 0.535 Test Acc: 0.746
Validation loss decreased (-0.736580 --> -0.746336).  Saving model ...
Epoch: 12 cost time: 2.807758092880249
Epoch: 12, Steps: 13 | Train Loss: 0.365 Vali Loss: 0.726 Vali Acc: 0.722 Test Loss: 0.726 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.6787450313568115
Epoch: 13, Steps: 13 | Train Loss: 0.423 Vali Loss: 0.612 Vali Acc: 0.688 Test Loss: 0.612 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.658841371536255
Epoch: 14, Steps: 13 | Train Loss: 0.331 Vali Loss: 0.498 Vali Acc: 0.756 Test Loss: 0.498 Test Acc: 0.756
Validation loss decreased (-0.746336 --> -0.756093).  Saving model ...
Epoch: 15 cost time: 2.9593911170959473
Epoch: 15, Steps: 13 | Train Loss: 0.325 Vali Loss: 0.515 Vali Acc: 0.732 Test Loss: 0.515 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.9390530586242676
Epoch: 16, Steps: 13 | Train Loss: 0.322 Vali Loss: 0.492 Vali Acc: 0.756 Test Loss: 0.492 Test Acc: 0.756
Validation loss decreased (-0.756093 --> -0.756093).  Saving model ...
Epoch: 17 cost time: 2.782965660095215
Epoch: 17, Steps: 13 | Train Loss: 0.286 Vali Loss: 0.608 Vali Acc: 0.712 Test Loss: 0.608 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.670530319213867
Epoch: 18, Steps: 13 | Train Loss: 0.273 Vali Loss: 0.612 Vali Acc: 0.717 Test Loss: 0.612 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.925117015838623
Epoch: 19, Steps: 13 | Train Loss: 0.258 Vali Loss: 0.589 Vali Acc: 0.668 Test Loss: 0.589 Test Acc: 0.668
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.691765069961548
Epoch: 20, Steps: 13 | Train Loss: 0.246 Vali Loss: 0.561 Vali Acc: 0.751 Test Loss: 0.561 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.7934277057647705
Epoch: 21, Steps: 13 | Train Loss: 0.219 Vali Loss: 0.611 Vali Acc: 0.673 Test Loss: 0.611 Test Acc: 0.673
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.961156129837036
Epoch: 22, Steps: 13 | Train Loss: 0.196 Vali Loss: 0.582 Vali Acc: 0.746 Test Loss: 0.582 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.892472743988037
Epoch: 23, Steps: 13 | Train Loss: 0.201 Vali Loss: 0.564 Vali Acc: 0.766 Test Loss: 0.564 Test Acc: 0.766
Validation loss decreased (-0.756093 --> -0.765848).  Saving model ...
Epoch: 24 cost time: 2.590484142303467
Epoch: 24, Steps: 13 | Train Loss: 0.213 Vali Loss: 0.676 Vali Acc: 0.668 Test Loss: 0.676 Test Acc: 0.668
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.556077241897583
Epoch: 25, Steps: 13 | Train Loss: 0.147 Vali Loss: 0.663 Vali Acc: 0.668 Test Loss: 0.663 Test Acc: 0.668
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.755671501159668
Epoch: 26, Steps: 13 | Train Loss: 0.148 Vali Loss: 0.725 Vali Acc: 0.644 Test Loss: 0.725 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.5925686359405518
Epoch: 27, Steps: 13 | Train Loss: 0.155 Vali Loss: 0.801 Vali Acc: 0.624 Test Loss: 0.801 Test Acc: 0.624
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.609586238861084
Epoch: 28, Steps: 13 | Train Loss: 0.159 Vali Loss: 0.639 Vali Acc: 0.717 Test Loss: 0.639 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.9343101978302
Epoch: 29, Steps: 13 | Train Loss: 0.116 Vali Loss: 0.697 Vali Acc: 0.683 Test Loss: 0.697 Test Acc: 0.683
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.9184021949768066
Epoch: 30, Steps: 13 | Train Loss: 0.132 Vali Loss: 0.657 Vali Acc: 0.737 Test Loss: 0.657 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 448010
model size : 1.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.276167869567871
Epoch: 1, Steps: 13 | Train Loss: 0.612 Vali Loss: 0.587 Vali Acc: 0.712 Test Loss: 0.587 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 1.8926501274108887
Epoch: 2, Steps: 13 | Train Loss: 0.582 Vali Loss: 0.578 Vali Acc: 0.712 Test Loss: 0.578 Test Acc: 0.712
Validation loss decreased (-0.712189 --> -0.712189).  Saving model ...
Epoch: 3 cost time: 2.0154590606689453
Epoch: 3, Steps: 13 | Train Loss: 0.575 Vali Loss: 0.565 Vali Acc: 0.727 Test Loss: 0.565 Test Acc: 0.727
Validation loss decreased (-0.712189 --> -0.726824).  Saving model ...
Epoch: 4 cost time: 2.0540072917938232
Epoch: 4, Steps: 13 | Train Loss: 0.554 Vali Loss: 0.564 Vali Acc: 0.737 Test Loss: 0.564 Test Acc: 0.737
Validation loss decreased (-0.726824 --> -0.736580).  Saving model ...
Epoch: 5 cost time: 1.7903625965118408
Epoch: 5, Steps: 13 | Train Loss: 0.514 Vali Loss: 0.564 Vali Acc: 0.737 Test Loss: 0.564 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7580184936523438
Epoch: 6, Steps: 13 | Train Loss: 0.541 Vali Loss: 0.560 Vali Acc: 0.761 Test Loss: 0.560 Test Acc: 0.761
Validation loss decreased (-0.736580 --> -0.760970).  Saving model ...
Epoch: 7 cost time: 1.6433000564575195
Epoch: 7, Steps: 13 | Train Loss: 0.502 Vali Loss: 0.544 Vali Acc: 0.746 Test Loss: 0.544 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.864048957824707
Epoch: 8, Steps: 13 | Train Loss: 0.465 Vali Loss: 0.535 Vali Acc: 0.737 Test Loss: 0.535 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8792791366577148
Epoch: 9, Steps: 13 | Train Loss: 0.442 Vali Loss: 0.524 Vali Acc: 0.746 Test Loss: 0.524 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.6098930835723877
Epoch: 10, Steps: 13 | Train Loss: 0.431 Vali Loss: 0.529 Vali Acc: 0.751 Test Loss: 0.529 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.658592939376831
Epoch: 11, Steps: 13 | Train Loss: 0.416 Vali Loss: 0.533 Vali Acc: 0.751 Test Loss: 0.533 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.9337029457092285
Epoch: 12, Steps: 13 | Train Loss: 0.391 Vali Loss: 0.537 Vali Acc: 0.751 Test Loss: 0.537 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.0439605712890625
Epoch: 13, Steps: 13 | Train Loss: 0.393 Vali Loss: 0.564 Vali Acc: 0.702 Test Loss: 0.564 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.8797452449798584
Epoch: 14, Steps: 13 | Train Loss: 0.382 Vali Loss: 0.586 Vali Acc: 0.751 Test Loss: 0.586 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.958296537399292
Epoch: 15, Steps: 13 | Train Loss: 0.361 Vali Loss: 0.541 Vali Acc: 0.732 Test Loss: 0.541 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.066730260848999
Epoch: 16, Steps: 13 | Train Loss: 0.321 Vali Loss: 0.605 Vali Acc: 0.737 Test Loss: 0.605 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 137498
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.412923097610474
Epoch: 1, Steps: 13 | Train Loss: 0.631 Vali Loss: 0.582 Vali Acc: 0.717 Test Loss: 0.582 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 4.016848087310791
Epoch: 2, Steps: 13 | Train Loss: 0.564 Vali Loss: 0.575 Vali Acc: 0.712 Test Loss: 0.575 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.0847697257995605
Epoch: 3, Steps: 13 | Train Loss: 0.564 Vali Loss: 0.570 Vali Acc: 0.717 Test Loss: 0.570 Test Acc: 0.717
Validation loss decreased (-0.717067 --> -0.717067).  Saving model ...
Epoch: 4 cost time: 3.0264389514923096
Epoch: 4, Steps: 13 | Train Loss: 0.547 Vali Loss: 0.561 Vali Acc: 0.717 Test Loss: 0.561 Test Acc: 0.717
Validation loss decreased (-0.717067 --> -0.717068).  Saving model ...
Epoch: 5 cost time: 3.0126795768737793
Epoch: 5, Steps: 13 | Train Loss: 0.526 Vali Loss: 0.565 Vali Acc: 0.712 Test Loss: 0.565 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.172482252120972
Epoch: 6, Steps: 13 | Train Loss: 0.513 Vali Loss: 0.548 Vali Acc: 0.737 Test Loss: 0.548 Test Acc: 0.737
Validation loss decreased (-0.717068 --> -0.736580).  Saving model ...
Epoch: 7 cost time: 3.9877779483795166
Epoch: 7, Steps: 13 | Train Loss: 0.463 Vali Loss: 0.569 Vali Acc: 0.727 Test Loss: 0.569 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.936718463897705
Epoch: 8, Steps: 13 | Train Loss: 0.467 Vali Loss: 0.538 Vali Acc: 0.732 Test Loss: 0.538 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.294269323348999
Epoch: 9, Steps: 13 | Train Loss: 0.435 Vali Loss: 0.551 Vali Acc: 0.717 Test Loss: 0.551 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.270293712615967
Epoch: 10, Steps: 13 | Train Loss: 0.397 Vali Loss: 0.540 Vali Acc: 0.737 Test Loss: 0.540 Test Acc: 0.737
Validation loss decreased (-0.736580 --> -0.736580).  Saving model ...
Epoch: 11 cost time: 4.287007093429565
Epoch: 11, Steps: 13 | Train Loss: 0.372 Vali Loss: 0.559 Vali Acc: 0.683 Test Loss: 0.559 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.3083178997039795
Epoch: 12, Steps: 13 | Train Loss: 0.356 Vali Loss: 0.602 Vali Acc: 0.732 Test Loss: 0.602 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.326352834701538
Epoch: 13, Steps: 13 | Train Loss: 0.322 Vali Loss: 0.584 Vali Acc: 0.698 Test Loss: 0.584 Test Acc: 0.698
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.962585687637329
Epoch: 14, Steps: 13 | Train Loss: 0.304 Vali Loss: 0.582 Vali Acc: 0.717 Test Loss: 0.582 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.373631954193115
Epoch: 15, Steps: 13 | Train Loss: 0.281 Vali Loss: 0.600 Vali Acc: 0.737 Test Loss: 0.600 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.1978466510772705
Epoch: 16, Steps: 13 | Train Loss: 0.269 Vali Loss: 0.573 Vali Acc: 0.698 Test Loss: 0.573 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.7590980529785156
Epoch: 17, Steps: 13 | Train Loss: 0.260 Vali Loss: 0.583 Vali Acc: 0.712 Test Loss: 0.583 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.265146017074585
Epoch: 18, Steps: 13 | Train Loss: 0.222 Vali Loss: 0.585 Vali Acc: 0.707 Test Loss: 0.585 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.337060451507568
Epoch: 19, Steps: 13 | Train Loss: 0.220 Vali Loss: 0.596 Vali Acc: 0.741 Test Loss: 0.596 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741457).  Saving model ...
Epoch: 20 cost time: 4.095771789550781
Epoch: 20, Steps: 13 | Train Loss: 0.222 Vali Loss: 0.550 Vali Acc: 0.727 Test Loss: 0.550 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.102077007293701
Epoch: 21, Steps: 13 | Train Loss: 0.188 Vali Loss: 0.578 Vali Acc: 0.722 Test Loss: 0.578 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.355254650115967
Epoch: 22, Steps: 13 | Train Loss: 0.155 Vali Loss: 0.632 Vali Acc: 0.702 Test Loss: 0.632 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.168973445892334
Epoch: 23, Steps: 13 | Train Loss: 0.159 Vali Loss: 0.644 Vali Acc: 0.688 Test Loss: 0.644 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 4.0520148277282715
Epoch: 24, Steps: 13 | Train Loss: 0.160 Vali Loss: 0.604 Vali Acc: 0.707 Test Loss: 0.604 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 4.155858993530273
Epoch: 25, Steps: 13 | Train Loss: 0.138 Vali Loss: 0.698 Vali Acc: 0.741 Test Loss: 0.698 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.9098331928253174
Epoch: 26, Steps: 13 | Train Loss: 0.150 Vali Loss: 0.709 Vali Acc: 0.737 Test Loss: 0.709 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.845980644226074
Epoch: 27, Steps: 13 | Train Loss: 0.123 Vali Loss: 0.658 Vali Acc: 0.722 Test Loss: 0.658 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 4.308428525924683
Epoch: 28, Steps: 13 | Train Loss: 0.133 Vali Loss: 0.646 Vali Acc: 0.702 Test Loss: 0.646 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 4.010616302490234
Epoch: 29, Steps: 13 | Train Loss: 0.102 Vali Loss: 0.661 Vali Acc: 0.693 Test Loss: 0.661 Test Acc: 0.693
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 228074
model size : 1.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.399433851242065
Epoch: 1, Steps: 13 | Train Loss: 0.600 Vali Loss: 0.581 Vali Acc: 0.722 Test Loss: 0.581 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.497636318206787
Epoch: 2, Steps: 13 | Train Loss: 0.581 Vali Loss: 0.576 Vali Acc: 0.722 Test Loss: 0.576 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 2.6180074214935303
Epoch: 3, Steps: 13 | Train Loss: 0.566 Vali Loss: 0.569 Vali Acc: 0.722 Test Loss: 0.569 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721946).  Saving model ...
Epoch: 4 cost time: 2.7580175399780273
Epoch: 4, Steps: 13 | Train Loss: 0.537 Vali Loss: 0.564 Vali Acc: 0.722 Test Loss: 0.564 Test Acc: 0.722
Validation loss decreased (-0.721946 --> -0.721946).  Saving model ...
Epoch: 5 cost time: 2.812925100326538
Epoch: 5, Steps: 13 | Train Loss: 0.522 Vali Loss: 0.554 Vali Acc: 0.727 Test Loss: 0.554 Test Acc: 0.727
Validation loss decreased (-0.721946 --> -0.726824).  Saving model ...
Epoch: 6 cost time: 2.5480079650878906
Epoch: 6, Steps: 13 | Train Loss: 0.486 Vali Loss: 0.555 Vali Acc: 0.712 Test Loss: 0.555 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.686676263809204
Epoch: 7, Steps: 13 | Train Loss: 0.484 Vali Loss: 0.549 Vali Acc: 0.732 Test Loss: 0.549 Test Acc: 0.732
Validation loss decreased (-0.726824 --> -0.731702).  Saving model ...
Epoch: 8 cost time: 2.8626391887664795
Epoch: 8, Steps: 13 | Train Loss: 0.456 Vali Loss: 0.542 Vali Acc: 0.737 Test Loss: 0.542 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736580).  Saving model ...
Epoch: 9 cost time: 2.9041941165924072
Epoch: 9, Steps: 13 | Train Loss: 0.419 Vali Loss: 0.532 Vali Acc: 0.746 Test Loss: 0.532 Test Acc: 0.746
Validation loss decreased (-0.736580 --> -0.746336).  Saving model ...
Epoch: 10 cost time: 2.4841065406799316
Epoch: 10, Steps: 13 | Train Loss: 0.398 Vali Loss: 0.554 Vali Acc: 0.732 Test Loss: 0.554 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.540876865386963
Epoch: 11, Steps: 13 | Train Loss: 0.383 Vali Loss: 0.521 Vali Acc: 0.741 Test Loss: 0.521 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.934180498123169
Epoch: 12, Steps: 13 | Train Loss: 0.377 Vali Loss: 0.534 Vali Acc: 0.737 Test Loss: 0.534 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.8567800521850586
Epoch: 13, Steps: 13 | Train Loss: 0.348 Vali Loss: 0.536 Vali Acc: 0.756 Test Loss: 0.536 Test Acc: 0.756
Validation loss decreased (-0.746336 --> -0.756092).  Saving model ...
Epoch: 14 cost time: 2.7474982738494873
Epoch: 14, Steps: 13 | Train Loss: 0.345 Vali Loss: 0.528 Vali Acc: 0.746 Test Loss: 0.528 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.5811495780944824
Epoch: 15, Steps: 13 | Train Loss: 0.317 Vali Loss: 0.521 Vali Acc: 0.737 Test Loss: 0.521 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.659123659133911
Epoch: 16, Steps: 13 | Train Loss: 0.317 Vali Loss: 0.598 Vali Acc: 0.761 Test Loss: 0.598 Test Acc: 0.761
Validation loss decreased (-0.756092 --> -0.760970).  Saving model ...
Epoch: 17 cost time: 2.646569013595581
Epoch: 17, Steps: 13 | Train Loss: 0.316 Vali Loss: 0.515 Vali Acc: 0.741 Test Loss: 0.515 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.472957134246826
Epoch: 18, Steps: 13 | Train Loss: 0.293 Vali Loss: 0.546 Vali Acc: 0.707 Test Loss: 0.546 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.5239720344543457
Epoch: 19, Steps: 13 | Train Loss: 0.274 Vali Loss: 0.555 Vali Acc: 0.751 Test Loss: 0.555 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.740018129348755
Epoch: 20, Steps: 13 | Train Loss: 0.252 Vali Loss: 0.535 Vali Acc: 0.732 Test Loss: 0.535 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.756647825241089
Epoch: 21, Steps: 13 | Train Loss: 0.248 Vali Loss: 0.552 Vali Acc: 0.722 Test Loss: 0.552 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.6174190044403076
Epoch: 22, Steps: 13 | Train Loss: 0.245 Vali Loss: 0.591 Vali Acc: 0.746 Test Loss: 0.591 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.6571602821350098
Epoch: 23, Steps: 13 | Train Loss: 0.234 Vali Loss: 0.561 Vali Acc: 0.737 Test Loss: 0.561 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.793966054916382
Epoch: 24, Steps: 13 | Train Loss: 0.220 Vali Loss: 0.562 Vali Acc: 0.717 Test Loss: 0.562 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.7132744789123535
Epoch: 25, Steps: 13 | Train Loss: 0.199 Vali Loss: 0.551 Vali Acc: 0.756 Test Loss: 0.551 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.581195116043091
Epoch: 26, Steps: 13 | Train Loss: 0.200 Vali Loss: 0.591 Vali Acc: 0.751 Test Loss: 0.591 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 72794
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.622018814086914
Epoch: 1, Steps: 13 | Train Loss: 0.631 Vali Loss: 0.582 Vali Acc: 0.712 Test Loss: 0.582 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 2.9298019409179688
Epoch: 2, Steps: 13 | Train Loss: 0.564 Vali Loss: 0.575 Vali Acc: 0.712 Test Loss: 0.575 Test Acc: 0.712
Validation loss decreased (-0.712189 --> -0.712189).  Saving model ...
Epoch: 3 cost time: 3.2995665073394775
Epoch: 3, Steps: 13 | Train Loss: 0.564 Vali Loss: 0.570 Vali Acc: 0.717 Test Loss: 0.570 Test Acc: 0.717
Validation loss decreased (-0.712189 --> -0.717067).  Saving model ...
Epoch: 4 cost time: 3.3449161052703857
Epoch: 4, Steps: 13 | Train Loss: 0.549 Vali Loss: 0.560 Vali Acc: 0.717 Test Loss: 0.560 Test Acc: 0.717
Validation loss decreased (-0.717067 --> -0.717068).  Saving model ...
Epoch: 5 cost time: 3.1045570373535156
Epoch: 5, Steps: 13 | Train Loss: 0.529 Vali Loss: 0.567 Vali Acc: 0.712 Test Loss: 0.567 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.071763277053833
Epoch: 6, Steps: 13 | Train Loss: 0.518 Vali Loss: 0.555 Vali Acc: 0.737 Test Loss: 0.555 Test Acc: 0.737
Validation loss decreased (-0.717068 --> -0.736580).  Saving model ...
Epoch: 7 cost time: 3.27323579788208
Epoch: 7, Steps: 13 | Train Loss: 0.471 Vali Loss: 0.552 Vali Acc: 0.737 Test Loss: 0.552 Test Acc: 0.737
Validation loss decreased (-0.736580 --> -0.736580).  Saving model ...
Epoch: 8 cost time: 3.3056633472442627
Epoch: 8, Steps: 13 | Train Loss: 0.468 Vali Loss: 0.540 Vali Acc: 0.751 Test Loss: 0.540 Test Acc: 0.751
Validation loss decreased (-0.736580 --> -0.751214).  Saving model ...
Epoch: 9 cost time: 3.0751140117645264
Epoch: 9, Steps: 13 | Train Loss: 0.444 Vali Loss: 0.541 Vali Acc: 0.737 Test Loss: 0.541 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.087639808654785
Epoch: 10, Steps: 13 | Train Loss: 0.415 Vali Loss: 0.537 Vali Acc: 0.722 Test Loss: 0.537 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.198296070098877
Epoch: 11, Steps: 13 | Train Loss: 0.376 Vali Loss: 0.559 Vali Acc: 0.693 Test Loss: 0.559 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.1886134147644043
Epoch: 12, Steps: 13 | Train Loss: 0.387 Vali Loss: 0.565 Vali Acc: 0.732 Test Loss: 0.565 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.939457654953003
Epoch: 13, Steps: 13 | Train Loss: 0.329 Vali Loss: 0.567 Vali Acc: 0.702 Test Loss: 0.567 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.012733221054077
Epoch: 14, Steps: 13 | Train Loss: 0.317 Vali Loss: 0.590 Vali Acc: 0.702 Test Loss: 0.590 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.3800766468048096
Epoch: 15, Steps: 13 | Train Loss: 0.311 Vali Loss: 0.562 Vali Acc: 0.732 Test Loss: 0.562 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.335721969604492
Epoch: 16, Steps: 13 | Train Loss: 0.259 Vali Loss: 0.577 Vali Acc: 0.717 Test Loss: 0.577 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.175227403640747
Epoch: 17, Steps: 13 | Train Loss: 0.273 Vali Loss: 0.591 Vali Acc: 0.717 Test Loss: 0.591 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.1982946395874023
Epoch: 18, Steps: 13 | Train Loss: 0.244 Vali Loss: 0.608 Vali Acc: 0.732 Test Loss: 0.608 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 228074
model size : 1.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.809668779373169
Epoch: 1, Steps: 13 | Train Loss: 0.600 Vali Loss: 0.581 Vali Acc: 0.722 Test Loss: 0.581 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.243479013442993
Epoch: 2, Steps: 13 | Train Loss: 0.582 Vali Loss: 0.576 Vali Acc: 0.722 Test Loss: 0.576 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 2.2892730236053467
Epoch: 3, Steps: 13 | Train Loss: 0.565 Vali Loss: 0.568 Vali Acc: 0.722 Test Loss: 0.568 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721946).  Saving model ...
Epoch: 4 cost time: 2.265615701675415
Epoch: 4, Steps: 13 | Train Loss: 0.542 Vali Loss: 0.563 Vali Acc: 0.722 Test Loss: 0.563 Test Acc: 0.722
Validation loss decreased (-0.721946 --> -0.721946).  Saving model ...
Epoch: 5 cost time: 2.186980724334717
Epoch: 5, Steps: 13 | Train Loss: 0.526 Vali Loss: 0.551 Vali Acc: 0.737 Test Loss: 0.551 Test Acc: 0.737
Validation loss decreased (-0.721946 --> -0.736580).  Saving model ...
Epoch: 6 cost time: 2.14418363571167
Epoch: 6, Steps: 13 | Train Loss: 0.493 Vali Loss: 0.550 Vali Acc: 0.737 Test Loss: 0.550 Test Acc: 0.737
Validation loss decreased (-0.736580 --> -0.736580).  Saving model ...
Epoch: 7 cost time: 2.2936947345733643
Epoch: 7, Steps: 13 | Train Loss: 0.489 Vali Loss: 0.541 Vali Acc: 0.737 Test Loss: 0.541 Test Acc: 0.737
Validation loss decreased (-0.736580 --> -0.736580).  Saving model ...
Epoch: 8 cost time: 2.284947156906128
Epoch: 8, Steps: 13 | Train Loss: 0.452 Vali Loss: 0.546 Vali Acc: 0.727 Test Loss: 0.546 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7149152755737305
Epoch: 9, Steps: 13 | Train Loss: 0.430 Vali Loss: 0.530 Vali Acc: 0.712 Test Loss: 0.530 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6867623329162598
Epoch: 10, Steps: 13 | Train Loss: 0.407 Vali Loss: 0.538 Vali Acc: 0.737 Test Loss: 0.538 Test Acc: 0.737
Validation loss decreased (-0.736580 --> -0.736580).  Saving model ...
Epoch: 11 cost time: 1.7071170806884766
Epoch: 11, Steps: 13 | Train Loss: 0.387 Vali Loss: 0.528 Vali Acc: 0.727 Test Loss: 0.528 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.3367743492126465
Epoch: 12, Steps: 13 | Train Loss: 0.386 Vali Loss: 0.532 Vali Acc: 0.732 Test Loss: 0.532 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.1694605350494385
Epoch: 13, Steps: 13 | Train Loss: 0.359 Vali Loss: 0.533 Vali Acc: 0.746 Test Loss: 0.533 Test Acc: 0.746
Validation loss decreased (-0.736580 --> -0.746336).  Saving model ...
Epoch: 14 cost time: 2.109970808029175
Epoch: 14, Steps: 13 | Train Loss: 0.336 Vali Loss: 0.525 Vali Acc: 0.732 Test Loss: 0.525 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.3695385456085205
Epoch: 15, Steps: 13 | Train Loss: 0.309 Vali Loss: 0.525 Vali Acc: 0.727 Test Loss: 0.525 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.0818440914154053
Epoch: 16, Steps: 13 | Train Loss: 0.316 Vali Loss: 0.574 Vali Acc: 0.746 Test Loss: 0.574 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.3117058277130127
Epoch: 17, Steps: 13 | Train Loss: 0.299 Vali Loss: 0.535 Vali Acc: 0.727 Test Loss: 0.535 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.072911024093628
Epoch: 18, Steps: 13 | Train Loss: 0.279 Vali Loss: 0.596 Vali Acc: 0.683 Test Loss: 0.596 Test Acc: 0.683
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.976505994796753
Epoch: 19, Steps: 13 | Train Loss: 0.283 Vali Loss: 0.583 Vali Acc: 0.737 Test Loss: 0.583 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.238175868988037
Epoch: 20, Steps: 13 | Train Loss: 0.268 Vali Loss: 0.551 Vali Acc: 0.727 Test Loss: 0.551 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.0120112895965576
Epoch: 21, Steps: 13 | Train Loss: 0.247 Vali Loss: 0.563 Vali Acc: 0.732 Test Loss: 0.563 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.3028156757354736
Epoch: 22, Steps: 13 | Train Loss: 0.230 Vali Loss: 0.607 Vali Acc: 0.746 Test Loss: 0.607 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.118671178817749
Epoch: 23, Steps: 13 | Train Loss: 0.218 Vali Loss: 0.594 Vali Acc: 0.732 Test Loss: 0.594 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 72794
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.08891749382019
Epoch: 1, Steps: 13 | Train Loss: 0.631 Vali Loss: 0.579 Vali Acc: 0.712 Test Loss: 0.579 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 2.3262500762939453
Epoch: 2, Steps: 13 | Train Loss: 0.567 Vali Loss: 0.572 Vali Acc: 0.712 Test Loss: 0.572 Test Acc: 0.712
Validation loss decreased (-0.712189 --> -0.712189).  Saving model ...
Epoch: 3 cost time: 2.2467668056488037
Epoch: 3, Steps: 13 | Train Loss: 0.566 Vali Loss: 0.566 Vali Acc: 0.712 Test Loss: 0.566 Test Acc: 0.712
Validation loss decreased (-0.712189 --> -0.712189).  Saving model ...
Epoch: 4 cost time: 2.42069411277771
Epoch: 4, Steps: 13 | Train Loss: 0.554 Vali Loss: 0.564 Vali Acc: 0.707 Test Loss: 0.564 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.149444103240967
Epoch: 5, Steps: 13 | Train Loss: 0.538 Vali Loss: 0.572 Vali Acc: 0.712 Test Loss: 0.572 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.429047107696533
Epoch: 6, Steps: 13 | Train Loss: 0.532 Vali Loss: 0.555 Vali Acc: 0.722 Test Loss: 0.555 Test Acc: 0.722
Validation loss decreased (-0.712189 --> -0.721946).  Saving model ...
Epoch: 7 cost time: 2.3030505180358887
Epoch: 7, Steps: 13 | Train Loss: 0.477 Vali Loss: 0.559 Vali Acc: 0.722 Test Loss: 0.559 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.432281970977783
Epoch: 8, Steps: 13 | Train Loss: 0.483 Vali Loss: 0.562 Vali Acc: 0.727 Test Loss: 0.562 Test Acc: 0.727
Validation loss decreased (-0.721946 --> -0.726824).  Saving model ...
Epoch: 9 cost time: 2.5705995559692383
Epoch: 9, Steps: 13 | Train Loss: 0.456 Vali Loss: 0.538 Vali Acc: 0.737 Test Loss: 0.538 Test Acc: 0.737
Validation loss decreased (-0.726824 --> -0.736580).  Saving model ...
Epoch: 10 cost time: 2.3934223651885986
Epoch: 10, Steps: 13 | Train Loss: 0.431 Vali Loss: 0.533 Vali Acc: 0.761 Test Loss: 0.533 Test Acc: 0.761
Validation loss decreased (-0.736580 --> -0.760970).  Saving model ...
Epoch: 11 cost time: 2.5272772312164307
Epoch: 11, Steps: 13 | Train Loss: 0.411 Vali Loss: 0.503 Vali Acc: 0.761 Test Loss: 0.503 Test Acc: 0.761
Validation loss decreased (-0.760970 --> -0.760971).  Saving model ...
Epoch: 12 cost time: 2.4347662925720215
Epoch: 12, Steps: 13 | Train Loss: 0.407 Vali Loss: 0.505 Vali Acc: 0.761 Test Loss: 0.505 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.3824081420898438
Epoch: 13, Steps: 13 | Train Loss: 0.357 Vali Loss: 0.496 Vali Acc: 0.761 Test Loss: 0.496 Test Acc: 0.761
Validation loss decreased (-0.760971 --> -0.760971).  Saving model ...
Epoch: 14 cost time: 2.5513734817504883
Epoch: 14, Steps: 13 | Train Loss: 0.357 Vali Loss: 0.516 Vali Acc: 0.746 Test Loss: 0.516 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.359051465988159
Epoch: 15, Steps: 13 | Train Loss: 0.332 Vali Loss: 0.602 Vali Acc: 0.737 Test Loss: 0.602 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.374269485473633
Epoch: 16, Steps: 13 | Train Loss: 0.325 Vali Loss: 0.572 Vali Acc: 0.707 Test Loss: 0.572 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.4231441020965576
Epoch: 17, Steps: 13 | Train Loss: 0.303 Vali Loss: 0.530 Vali Acc: 0.751 Test Loss: 0.530 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.187711477279663
Epoch: 18, Steps: 13 | Train Loss: 0.278 Vali Loss: 0.551 Vali Acc: 0.727 Test Loss: 0.551 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.535081624984741
Epoch: 19, Steps: 13 | Train Loss: 0.246 Vali Loss: 0.561 Vali Acc: 0.741 Test Loss: 0.561 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.351816415786743
Epoch: 20, Steps: 13 | Train Loss: 0.249 Vali Loss: 0.540 Vali Acc: 0.722 Test Loss: 0.540 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.2518815994262695
Epoch: 21, Steps: 13 | Train Loss: 0.223 Vali Loss: 0.540 Vali Acc: 0.732 Test Loss: 0.540 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.689011573791504
Epoch: 22, Steps: 13 | Train Loss: 0.207 Vali Loss: 0.611 Vali Acc: 0.678 Test Loss: 0.611 Test Acc: 0.678
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.421773672103882
Epoch: 23, Steps: 13 | Train Loss: 0.236 Vali Loss: 0.526 Vali Acc: 0.746 Test Loss: 0.526 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 228074
model size : 1.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.528614044189453
Epoch: 1, Steps: 13 | Train Loss: 0.596 Vali Loss: 0.581 Vali Acc: 0.722 Test Loss: 0.581 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.641568660736084
Epoch: 2, Steps: 13 | Train Loss: 0.585 Vali Loss: 0.575 Vali Acc: 0.722 Test Loss: 0.575 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 1.6781303882598877
Epoch: 3, Steps: 13 | Train Loss: 0.568 Vali Loss: 0.567 Vali Acc: 0.732 Test Loss: 0.567 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 4 cost time: 1.8823022842407227
Epoch: 4, Steps: 13 | Train Loss: 0.545 Vali Loss: 0.560 Vali Acc: 0.732 Test Loss: 0.560 Test Acc: 0.732
Validation loss decreased (-0.731702 --> -0.731702).  Saving model ...
Epoch: 5 cost time: 1.661034345626831
Epoch: 5, Steps: 13 | Train Loss: 0.536 Vali Loss: 0.548 Vali Acc: 0.727 Test Loss: 0.548 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5796947479248047
Epoch: 6, Steps: 13 | Train Loss: 0.499 Vali Loss: 0.541 Vali Acc: 0.737 Test Loss: 0.541 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736580).  Saving model ...
Epoch: 7 cost time: 1.793567180633545
Epoch: 7, Steps: 13 | Train Loss: 0.500 Vali Loss: 0.529 Vali Acc: 0.727 Test Loss: 0.529 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7687592506408691
Epoch: 8, Steps: 13 | Train Loss: 0.475 Vali Loss: 0.527 Vali Acc: 0.741 Test Loss: 0.527 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741458).  Saving model ...
Epoch: 9 cost time: 1.575551986694336
Epoch: 9, Steps: 13 | Train Loss: 0.457 Vali Loss: 0.533 Vali Acc: 0.717 Test Loss: 0.533 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3099653720855713
Epoch: 10, Steps: 13 | Train Loss: 0.437 Vali Loss: 0.550 Vali Acc: 0.737 Test Loss: 0.550 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3448150157928467
Epoch: 11, Steps: 13 | Train Loss: 0.418 Vali Loss: 0.524 Vali Acc: 0.712 Test Loss: 0.524 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3814213275909424
Epoch: 12, Steps: 13 | Train Loss: 0.415 Vali Loss: 0.521 Vali Acc: 0.737 Test Loss: 0.521 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.512251853942871
Epoch: 13, Steps: 13 | Train Loss: 0.378 Vali Loss: 0.522 Vali Acc: 0.737 Test Loss: 0.522 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.9027063846588135
Epoch: 14, Steps: 13 | Train Loss: 0.348 Vali Loss: 0.532 Vali Acc: 0.737 Test Loss: 0.532 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.9037773609161377
Epoch: 15, Steps: 13 | Train Loss: 0.334 Vali Loss: 0.542 Vali Acc: 0.727 Test Loss: 0.542 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.0296144485473633
Epoch: 16, Steps: 13 | Train Loss: 0.337 Vali Loss: 0.566 Vali Acc: 0.746 Test Loss: 0.566 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746336).  Saving model ...
Epoch: 17 cost time: 1.9302387237548828
Epoch: 17, Steps: 13 | Train Loss: 0.316 Vali Loss: 0.546 Vali Acc: 0.707 Test Loss: 0.546 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.9273955821990967
Epoch: 18, Steps: 13 | Train Loss: 0.304 Vali Loss: 0.627 Vali Acc: 0.629 Test Loss: 0.627 Test Acc: 0.629
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.713984727859497
Epoch: 19, Steps: 13 | Train Loss: 0.296 Vali Loss: 0.569 Vali Acc: 0.751 Test Loss: 0.569 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751214).  Saving model ...
Epoch: 20 cost time: 1.8418543338775635
Epoch: 20, Steps: 13 | Train Loss: 0.257 Vali Loss: 0.564 Vali Acc: 0.712 Test Loss: 0.564 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.854353904724121
Epoch: 21, Steps: 13 | Train Loss: 0.275 Vali Loss: 0.587 Vali Acc: 0.756 Test Loss: 0.587 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756092).  Saving model ...
Epoch: 22 cost time: 1.8071393966674805
Epoch: 22, Steps: 13 | Train Loss: 0.251 Vali Loss: 0.572 Vali Acc: 0.751 Test Loss: 0.572 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.8399693965911865
Epoch: 23, Steps: 13 | Train Loss: 0.239 Vali Loss: 0.591 Vali Acc: 0.751 Test Loss: 0.591 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.8362362384796143
Epoch: 24, Steps: 13 | Train Loss: 0.237 Vali Loss: 0.642 Vali Acc: 0.659 Test Loss: 0.642 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.7272703647613525
Epoch: 25, Steps: 13 | Train Loss: 0.300 Vali Loss: 0.622 Vali Acc: 0.741 Test Loss: 0.622 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.7962632179260254
Epoch: 26, Steps: 13 | Train Loss: 0.215 Vali Loss: 0.605 Vali Acc: 0.712 Test Loss: 0.605 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.8661768436431885
Epoch: 27, Steps: 13 | Train Loss: 0.185 Vali Loss: 0.605 Vali Acc: 0.678 Test Loss: 0.605 Test Acc: 0.678
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.8504114151000977
Epoch: 28, Steps: 13 | Train Loss: 0.163 Vali Loss: 0.596 Vali Acc: 0.707 Test Loss: 0.596 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.9315848350524902
Epoch: 29, Steps: 13 | Train Loss: 0.157 Vali Loss: 0.592 Vali Acc: 0.746 Test Loss: 0.592 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.9129574298858643
Epoch: 30, Steps: 13 | Train Loss: 0.155 Vali Loss: 0.580 Vali Acc: 0.717 Test Loss: 0.580 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el3_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 72794
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 43.648491621017456
Epoch: 1, Steps: 13 | Train Loss: 0.620 Vali Loss: 0.682 Vali Acc: 0.605 Test Loss: 0.682 Test Acc: 0.605
Validation loss decreased (inf --> -0.604871).  Saving model ...
Epoch: 2 cost time: 41.79347348213196
Epoch: 2, Steps: 13 | Train Loss: 0.606 Vali Loss: 0.553 Vali Acc: 0.678 Test Loss: 0.553 Test Acc: 0.678
Validation loss decreased (-0.604871 --> -0.678043).  Saving model ...
Epoch: 3 cost time: 41.70773410797119
Epoch: 3, Steps: 13 | Train Loss: 0.387 Vali Loss: 0.526 Vali Acc: 0.746 Test Loss: 0.526 Test Acc: 0.746
Validation loss decreased (-0.678043 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 40.74666237831116
Epoch: 4, Steps: 13 | Train Loss: 0.315 Vali Loss: 0.706 Vali Acc: 0.737 Test Loss: 0.706 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 40.28515338897705
Epoch: 5, Steps: 13 | Train Loss: 0.236 Vali Loss: 0.586 Vali Acc: 0.756 Test Loss: 0.586 Test Acc: 0.756
Validation loss decreased (-0.746336 --> -0.756092).  Saving model ...
Epoch: 6 cost time: 53.484376668930054
Epoch: 6, Steps: 13 | Train Loss: 0.188 Vali Loss: 0.621 Vali Acc: 0.741 Test Loss: 0.621 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 53.87214136123657
Epoch: 7, Steps: 13 | Train Loss: 0.119 Vali Loss: 0.876 Vali Acc: 0.576 Test Loss: 0.876 Test Acc: 0.576
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 53.486387491226196
Epoch: 8, Steps: 13 | Train Loss: 0.115 Vali Loss: 0.805 Vali Acc: 0.629 Test Loss: 0.805 Test Acc: 0.629
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 53.96225881576538
Epoch: 9, Steps: 13 | Train Loss: 0.067 Vali Loss: 1.500 Vali Acc: 0.478 Test Loss: 1.500 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 53.83751702308655
Epoch: 10, Steps: 13 | Train Loss: 0.111 Vali Loss: 0.858 Vali Acc: 0.702 Test Loss: 0.858 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 53.79169201850891
Epoch: 11, Steps: 13 | Train Loss: 0.057 Vali Loss: 0.875 Vali Acc: 0.620 Test Loss: 0.875 Test Acc: 0.620
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 52.02761960029602
Epoch: 12, Steps: 13 | Train Loss: 0.091 Vali Loss: 0.925 Vali Acc: 0.693 Test Loss: 0.925 Test Acc: 0.693
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 52.64117097854614
Epoch: 13, Steps: 13 | Train Loss: 0.025 Vali Loss: 1.093 Vali Acc: 0.683 Test Loss: 1.093 Test Acc: 0.683
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 48.29587125778198
Epoch: 14, Steps: 13 | Train Loss: 0.077 Vali Loss: 1.407 Vali Acc: 0.717 Test Loss: 1.407 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 50.52972364425659
Epoch: 15, Steps: 13 | Train Loss: 0.125 Vali Loss: 1.685 Vali Acc: 0.737 Test Loss: 1.685 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 37619074
model size : 145.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 19.946088075637817
Epoch: 1, Steps: 13 | Train Loss: 0.656 Vali Loss: 0.549 Vali Acc: 0.737 Test Loss: 0.549 Test Acc: 0.737
Validation loss decreased (inf --> -0.736580).  Saving model ...
Epoch: 2 cost time: 18.4977126121521
Epoch: 2, Steps: 13 | Train Loss: 0.506 Vali Loss: 0.581 Vali Acc: 0.751 Test Loss: 0.581 Test Acc: 0.751
Validation loss decreased (-0.736580 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 18.49159002304077
Epoch: 3, Steps: 13 | Train Loss: 0.398 Vali Loss: 0.514 Vali Acc: 0.732 Test Loss: 0.514 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 18.02375555038452
Epoch: 4, Steps: 13 | Train Loss: 0.316 Vali Loss: 0.574 Vali Acc: 0.771 Test Loss: 0.574 Test Acc: 0.771
Validation loss decreased (-0.751214 --> -0.770726).  Saving model ...
Epoch: 5 cost time: 17.732867002487183
Epoch: 5, Steps: 13 | Train Loss: 0.267 Vali Loss: 0.567 Vali Acc: 0.717 Test Loss: 0.567 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 18.543123245239258
Epoch: 6, Steps: 13 | Train Loss: 0.276 Vali Loss: 1.217 Vali Acc: 0.737 Test Loss: 1.217 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 18.91278100013733
Epoch: 7, Steps: 13 | Train Loss: 0.261 Vali Loss: 0.785 Vali Acc: 0.576 Test Loss: 0.785 Test Acc: 0.576
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 18.87172770500183
Epoch: 8, Steps: 13 | Train Loss: 0.138 Vali Loss: 0.659 Vali Acc: 0.707 Test Loss: 0.659 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 18.61156940460205
Epoch: 9, Steps: 13 | Train Loss: 0.074 Vali Loss: 1.148 Vali Acc: 0.732 Test Loss: 1.148 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 18.25498127937317
Epoch: 10, Steps: 13 | Train Loss: 0.153 Vali Loss: 0.827 Vali Acc: 0.746 Test Loss: 0.827 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 18.482832193374634
Epoch: 11, Steps: 13 | Train Loss: 0.079 Vali Loss: 0.737 Vali Acc: 0.707 Test Loss: 0.737 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 18.60965061187744
Epoch: 12, Steps: 13 | Train Loss: 0.023 Vali Loss: 1.012 Vali Acc: 0.741 Test Loss: 1.012 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 18.97689390182495
Epoch: 13, Steps: 13 | Train Loss: 0.025 Vali Loss: 1.295 Vali Acc: 0.537 Test Loss: 1.295 Test Acc: 0.537
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 16.019044637680054
Epoch: 14, Steps: 13 | Train Loss: 0.045 Vali Loss: 0.956 Vali Acc: 0.732 Test Loss: 0.956 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 11140994
model size : 44.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 42.004058837890625
Epoch: 1, Steps: 13 | Train Loss: 0.621 Vali Loss: 0.690 Vali Acc: 0.595 Test Loss: 0.690 Test Acc: 0.595
Validation loss decreased (inf --> -0.595115).  Saving model ...
Epoch: 2 cost time: 40.00287985801697
Epoch: 2, Steps: 13 | Train Loss: 0.595 Vali Loss: 0.549 Vali Acc: 0.678 Test Loss: 0.549 Test Acc: 0.678
Validation loss decreased (-0.595115 --> -0.678043).  Saving model ...
Epoch: 3 cost time: 39.901493549346924
Epoch: 3, Steps: 13 | Train Loss: 0.389 Vali Loss: 0.512 Vali Acc: 0.766 Test Loss: 0.512 Test Acc: 0.766
Validation loss decreased (-0.678043 --> -0.765849).  Saving model ...
Epoch: 4 cost time: 40.2011878490448
Epoch: 4, Steps: 13 | Train Loss: 0.334 Vali Loss: 0.888 Vali Acc: 0.732 Test Loss: 0.888 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 39.94870734214783
Epoch: 5, Steps: 13 | Train Loss: 0.242 Vali Loss: 0.554 Vali Acc: 0.702 Test Loss: 0.554 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 39.740926027297974
Epoch: 6, Steps: 13 | Train Loss: 0.240 Vali Loss: 0.589 Vali Acc: 0.683 Test Loss: 0.589 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 39.821876764297485
Epoch: 7, Steps: 13 | Train Loss: 0.325 Vali Loss: 0.890 Vali Acc: 0.727 Test Loss: 0.890 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 39.74004101753235
Epoch: 8, Steps: 13 | Train Loss: 0.272 Vali Loss: 0.721 Vali Acc: 0.649 Test Loss: 0.721 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 39.526984214782715
Epoch: 9, Steps: 13 | Train Loss: 0.111 Vali Loss: 2.438 Vali Acc: 0.424 Test Loss: 2.438 Test Acc: 0.424
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 39.76453447341919
Epoch: 10, Steps: 13 | Train Loss: 0.348 Vali Loss: 1.084 Vali Acc: 0.537 Test Loss: 1.084 Test Acc: 0.537
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 39.26762580871582
Epoch: 11, Steps: 13 | Train Loss: 0.213 Vali Loss: 0.984 Vali Acc: 0.561 Test Loss: 0.984 Test Acc: 0.561
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 41.24637579917908
Epoch: 12, Steps: 13 | Train Loss: 0.058 Vali Loss: 0.921 Vali Acc: 0.732 Test Loss: 0.921 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 41.24271583557129
Epoch: 13, Steps: 13 | Train Loss: 0.020 Vali Loss: 1.185 Vali Acc: 0.590 Test Loss: 1.185 Test Acc: 0.590
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 37619074
model size : 145.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 17.482102394104004
Epoch: 1, Steps: 13 | Train Loss: 0.657 Vali Loss: 0.552 Vali Acc: 0.737 Test Loss: 0.552 Test Acc: 0.737
Validation loss decreased (inf --> -0.736580).  Saving model ...
Epoch: 2 cost time: 15.287316083908081
Epoch: 2, Steps: 13 | Train Loss: 0.510 Vali Loss: 0.592 Vali Acc: 0.756 Test Loss: 0.592 Test Acc: 0.756
Validation loss decreased (-0.736580 --> -0.756092).  Saving model ...
Epoch: 3 cost time: 12.703755617141724
Epoch: 3, Steps: 13 | Train Loss: 0.408 Vali Loss: 0.520 Vali Acc: 0.741 Test Loss: 0.520 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 14.94045639038086
Epoch: 4, Steps: 13 | Train Loss: 0.317 Vali Loss: 0.517 Vali Acc: 0.761 Test Loss: 0.517 Test Acc: 0.761
Validation loss decreased (-0.756092 --> -0.760970).  Saving model ...
Epoch: 5 cost time: 15.217174768447876
Epoch: 5, Steps: 13 | Train Loss: 0.226 Vali Loss: 0.597 Vali Acc: 0.668 Test Loss: 0.597 Test Acc: 0.668
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 14.956100940704346
Epoch: 6, Steps: 13 | Train Loss: 0.225 Vali Loss: 0.760 Vali Acc: 0.766 Test Loss: 0.760 Test Acc: 0.766
Validation loss decreased (-0.760970 --> -0.765846).  Saving model ...
Epoch: 7 cost time: 14.403658628463745
Epoch: 7, Steps: 13 | Train Loss: 0.129 Vali Loss: 0.661 Vali Acc: 0.756 Test Loss: 0.661 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 14.73296308517456
Epoch: 8, Steps: 13 | Train Loss: 0.099 Vali Loss: 0.938 Vali Acc: 0.571 Test Loss: 0.938 Test Acc: 0.571
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 14.761136293411255
Epoch: 9, Steps: 13 | Train Loss: 0.271 Vali Loss: 1.062 Vali Acc: 0.532 Test Loss: 1.062 Test Acc: 0.532
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 14.569292068481445
Epoch: 10, Steps: 13 | Train Loss: 0.204 Vali Loss: 1.033 Vali Acc: 0.751 Test Loss: 1.033 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 14.395920753479004
Epoch: 11, Steps: 13 | Train Loss: 0.095 Vali Loss: 1.226 Vali Acc: 0.741 Test Loss: 1.226 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 14.968067407608032
Epoch: 12, Steps: 13 | Train Loss: 0.046 Vali Loss: 0.860 Vali Acc: 0.668 Test Loss: 0.860 Test Acc: 0.668
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 14.999377965927124
Epoch: 13, Steps: 13 | Train Loss: 0.016 Vali Loss: 0.881 Vali Acc: 0.717 Test Loss: 0.881 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 14.548402309417725
Epoch: 14, Steps: 13 | Train Loss: 0.019 Vali Loss: 0.903 Vali Acc: 0.732 Test Loss: 0.903 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 14.437519788742065
Epoch: 15, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.943 Vali Acc: 0.737 Test Loss: 0.943 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 14.876028060913086
Epoch: 16, Steps: 13 | Train Loss: 0.028 Vali Loss: 0.992 Vali Acc: 0.751 Test Loss: 0.992 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 11140994
model size : 44.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 24.453038215637207
Epoch: 1, Steps: 13 | Train Loss: 0.621 Vali Loss: 0.689 Vali Acc: 0.600 Test Loss: 0.689 Test Acc: 0.600
Validation loss decreased (inf --> -0.599993).  Saving model ...
Epoch: 2 cost time: 22.782548904418945
Epoch: 2, Steps: 13 | Train Loss: 0.597 Vali Loss: 0.555 Vali Acc: 0.678 Test Loss: 0.555 Test Acc: 0.678
Validation loss decreased (-0.599993 --> -0.678043).  Saving model ...
Epoch: 3 cost time: 19.496334552764893
Epoch: 3, Steps: 13 | Train Loss: 0.391 Vali Loss: 0.527 Vali Acc: 0.751 Test Loss: 0.527 Test Acc: 0.751
Validation loss decreased (-0.678043 --> -0.751214).  Saving model ...
Epoch: 4 cost time: 23.667261123657227
Epoch: 4, Steps: 13 | Train Loss: 0.335 Vali Loss: 0.937 Vali Acc: 0.727 Test Loss: 0.937 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 23.203670978546143
Epoch: 5, Steps: 13 | Train Loss: 0.240 Vali Loss: 0.585 Vali Acc: 0.663 Test Loss: 0.585 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 22.518535614013672
Epoch: 6, Steps: 13 | Train Loss: 0.273 Vali Loss: 0.593 Vali Acc: 0.741 Test Loss: 0.593 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 22.522758960723877
Epoch: 7, Steps: 13 | Train Loss: 0.154 Vali Loss: 0.669 Vali Acc: 0.751 Test Loss: 0.669 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 22.72505497932434
Epoch: 8, Steps: 13 | Train Loss: 0.134 Vali Loss: 1.332 Vali Acc: 0.493 Test Loss: 1.332 Test Acc: 0.493
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 22.582614421844482
Epoch: 9, Steps: 13 | Train Loss: 0.095 Vali Loss: 0.930 Vali Acc: 0.585 Test Loss: 0.930 Test Acc: 0.585
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 22.923393487930298
Epoch: 10, Steps: 13 | Train Loss: 0.042 Vali Loss: 0.936 Vali Acc: 0.751 Test Loss: 0.936 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 22.59647512435913
Epoch: 11, Steps: 13 | Train Loss: 0.279 Vali Loss: 0.923 Vali Acc: 0.654 Test Loss: 0.923 Test Acc: 0.654
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 23.352768421173096
Epoch: 12, Steps: 13 | Train Loss: 0.294 Vali Loss: 0.936 Vali Acc: 0.585 Test Loss: 0.936 Test Acc: 0.585
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 23.121917009353638
Epoch: 13, Steps: 13 | Train Loss: 0.044 Vali Loss: 0.973 Vali Acc: 0.722 Test Loss: 0.973 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 37619074
model size : 145.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 10.82631516456604
Epoch: 1, Steps: 13 | Train Loss: 0.657 Vali Loss: 0.554 Vali Acc: 0.732 Test Loss: 0.554 Test Acc: 0.732
Validation loss decreased (inf --> -0.731702).  Saving model ...
Epoch: 2 cost time: 9.545173645019531
Epoch: 2, Steps: 13 | Train Loss: 0.515 Vali Loss: 0.594 Vali Acc: 0.741 Test Loss: 0.594 Test Acc: 0.741
Validation loss decreased (-0.731702 --> -0.741457).  Saving model ...
Epoch: 3 cost time: 9.664173364639282
Epoch: 3, Steps: 13 | Train Loss: 0.411 Vali Loss: 0.528 Vali Acc: 0.727 Test Loss: 0.528 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.2943754196167
Epoch: 4, Steps: 13 | Train Loss: 0.321 Vali Loss: 0.526 Vali Acc: 0.766 Test Loss: 0.526 Test Acc: 0.766
Validation loss decreased (-0.741457 --> -0.765848).  Saving model ...
Epoch: 5 cost time: 9.235145568847656
Epoch: 5, Steps: 13 | Train Loss: 0.459 Vali Loss: 0.580 Vali Acc: 0.698 Test Loss: 0.580 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.77806282043457
Epoch: 6, Steps: 13 | Train Loss: 0.351 Vali Loss: 0.773 Vali Acc: 0.766 Test Loss: 0.773 Test Acc: 0.766
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 9.412334203720093
Epoch: 7, Steps: 13 | Train Loss: 0.240 Vali Loss: 0.642 Vali Acc: 0.737 Test Loss: 0.642 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 9.472710847854614
Epoch: 8, Steps: 13 | Train Loss: 0.086 Vali Loss: 0.687 Vali Acc: 0.732 Test Loss: 0.687 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 9.604124069213867
Epoch: 9, Steps: 13 | Train Loss: 0.133 Vali Loss: 0.702 Vali Acc: 0.712 Test Loss: 0.702 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 9.314737796783447
Epoch: 10, Steps: 13 | Train Loss: 0.139 Vali Loss: 0.996 Vali Acc: 0.751 Test Loss: 0.996 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 9.503829717636108
Epoch: 11, Steps: 13 | Train Loss: 0.050 Vali Loss: 0.810 Vali Acc: 0.663 Test Loss: 0.810 Test Acc: 0.663
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 8.146976709365845
Epoch: 12, Steps: 13 | Train Loss: 0.066 Vali Loss: 0.962 Vali Acc: 0.746 Test Loss: 0.962 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 9.060689687728882
Epoch: 13, Steps: 13 | Train Loss: 0.059 Vali Loss: 1.187 Vali Acc: 0.732 Test Loss: 1.187 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 8.817006587982178
Epoch: 14, Steps: 13 | Train Loss: 0.276 Vali Loss: 1.292 Vali Acc: 0.756 Test Loss: 1.292 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 11140994
model size : 44.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 29.426823616027832
Epoch: 1, Steps: 13 | Train Loss: 0.657 Vali Loss: 0.690 Vali Acc: 0.522 Test Loss: 0.690 Test Acc: 0.522
Validation loss decreased (inf --> -0.521944).  Saving model ...
Epoch: 2 cost time: 27.470909595489502
Epoch: 2, Steps: 13 | Train Loss: 0.658 Vali Loss: 0.716 Vali Acc: 0.561 Test Loss: 0.716 Test Acc: 0.561
Validation loss decreased (-0.521944 --> -0.560968).  Saving model ...
Epoch: 3 cost time: 27.601560354232788
Epoch: 3, Steps: 13 | Train Loss: 0.466 Vali Loss: 0.510 Vali Acc: 0.761 Test Loss: 0.510 Test Acc: 0.761
Validation loss decreased (-0.560968 --> -0.760971).  Saving model ...
Epoch: 4 cost time: 27.38851499557495
Epoch: 4, Steps: 13 | Train Loss: 0.340 Vali Loss: 0.518 Vali Acc: 0.751 Test Loss: 0.518 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 27.171817541122437
Epoch: 5, Steps: 13 | Train Loss: 0.304 Vali Loss: 0.631 Vali Acc: 0.654 Test Loss: 0.631 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 27.12002682685852
Epoch: 6, Steps: 13 | Train Loss: 0.258 Vali Loss: 0.718 Vali Acc: 0.761 Test Loss: 0.718 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 27.899303197860718
Epoch: 7, Steps: 13 | Train Loss: 0.278 Vali Loss: 0.682 Vali Acc: 0.668 Test Loss: 0.682 Test Acc: 0.668
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 30.21984362602234
Epoch: 8, Steps: 13 | Train Loss: 0.126 Vali Loss: 1.272 Vali Acc: 0.732 Test Loss: 1.272 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 30.44900918006897
Epoch: 9, Steps: 13 | Train Loss: 0.237 Vali Loss: 0.695 Vali Acc: 0.698 Test Loss: 0.695 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 29.779154777526855
Epoch: 10, Steps: 13 | Train Loss: 0.074 Vali Loss: 1.034 Vali Acc: 0.751 Test Loss: 1.034 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 28.836087942123413
Epoch: 11, Steps: 13 | Train Loss: 0.066 Vali Loss: 0.933 Vali Acc: 0.654 Test Loss: 0.933 Test Acc: 0.654
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 28.8726007938385
Epoch: 12, Steps: 13 | Train Loss: 0.079 Vali Loss: 1.117 Vali Acc: 0.732 Test Loss: 1.117 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 29.298141479492188
Epoch: 13, Steps: 13 | Train Loss: 0.077 Vali Loss: 0.915 Vali Acc: 0.746 Test Loss: 0.915 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 18874242
model size : 74.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 14.068489074707031
Epoch: 1, Steps: 13 | Train Loss: 0.576 Vali Loss: 0.557 Vali Acc: 0.741 Test Loss: 0.557 Test Acc: 0.741
Validation loss decreased (inf --> -0.741458).  Saving model ...
Epoch: 2 cost time: 12.054972887039185
Epoch: 2, Steps: 13 | Train Loss: 0.524 Vali Loss: 0.540 Vali Acc: 0.702 Test Loss: 0.540 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 12.121348857879639
Epoch: 3, Steps: 13 | Train Loss: 0.407 Vali Loss: 0.616 Vali Acc: 0.663 Test Loss: 0.616 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 12.123431921005249
Epoch: 4, Steps: 13 | Train Loss: 0.365 Vali Loss: 0.635 Vali Acc: 0.644 Test Loss: 0.635 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 12.169036149978638
Epoch: 5, Steps: 13 | Train Loss: 0.233 Vali Loss: 0.629 Vali Acc: 0.761 Test Loss: 0.629 Test Acc: 0.761
Validation loss decreased (-0.741458 --> -0.760969).  Saving model ...
Epoch: 6 cost time: 12.329872846603394
Epoch: 6, Steps: 13 | Train Loss: 0.187 Vali Loss: 1.020 Vali Acc: 0.493 Test Loss: 1.020 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 12.168107509613037
Epoch: 7, Steps: 13 | Train Loss: 0.270 Vali Loss: 0.647 Vali Acc: 0.688 Test Loss: 0.647 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 12.273823022842407
Epoch: 8, Steps: 13 | Train Loss: 0.129 Vali Loss: 0.777 Vali Acc: 0.732 Test Loss: 0.777 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 12.182900428771973
Epoch: 9, Steps: 13 | Train Loss: 0.397 Vali Loss: 0.897 Vali Acc: 0.761 Test Loss: 0.897 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 11.954018115997314
Epoch: 10, Steps: 13 | Train Loss: 0.466 Vali Loss: 0.739 Vali Acc: 0.717 Test Loss: 0.739 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 10.81279969215393
Epoch: 11, Steps: 13 | Train Loss: 0.327 Vali Loss: 1.054 Vali Acc: 0.771 Test Loss: 1.054 Test Acc: 0.771
Validation loss decreased (-0.760969 --> -0.770721).  Saving model ...
Epoch: 12 cost time: 11.421563625335693
Epoch: 12, Steps: 13 | Train Loss: 0.071 Vali Loss: 0.806 Vali Acc: 0.688 Test Loss: 0.806 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 11.485522747039795
Epoch: 13, Steps: 13 | Train Loss: 0.039 Vali Loss: 0.877 Vali Acc: 0.668 Test Loss: 0.877 Test Acc: 0.668
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 11.303628206253052
Epoch: 14, Steps: 13 | Train Loss: 0.015 Vali Loss: 0.884 Vali Acc: 0.727 Test Loss: 0.884 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 11.30333137512207
Epoch: 15, Steps: 13 | Train Loss: 0.067 Vali Loss: 1.395 Vali Acc: 0.756 Test Loss: 1.395 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 11.384550094604492
Epoch: 16, Steps: 13 | Train Loss: 0.012 Vali Loss: 0.864 Vali Acc: 0.688 Test Loss: 0.864 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 11.510658979415894
Epoch: 17, Steps: 13 | Train Loss: 0.011 Vali Loss: 0.996 Vali Acc: 0.624 Test Loss: 0.996 Test Acc: 0.624
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 11.52199387550354
Epoch: 18, Steps: 13 | Train Loss: 0.018 Vali Loss: 0.936 Vali Acc: 0.702 Test Loss: 0.936 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 11.360261678695679
Epoch: 19, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.032 Vali Acc: 0.717 Test Loss: 1.032 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 11.02458119392395
Epoch: 20, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.115 Vali Acc: 0.727 Test Loss: 1.115 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 11.43774962425232
Epoch: 21, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.084 Vali Acc: 0.722 Test Loss: 1.084 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 5634946
model size : 23.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 23.45990228652954
Epoch: 1, Steps: 13 | Train Loss: 0.657 Vali Loss: 0.692 Vali Acc: 0.517 Test Loss: 0.692 Test Acc: 0.517
Validation loss decreased (inf --> -0.517066).  Saving model ...
Epoch: 2 cost time: 21.875335454940796
Epoch: 2, Steps: 13 | Train Loss: 0.658 Vali Loss: 0.717 Vali Acc: 0.561 Test Loss: 0.717 Test Acc: 0.561
Validation loss decreased (-0.517066 --> -0.560968).  Saving model ...
Epoch: 3 cost time: 21.434662103652954
Epoch: 3, Steps: 13 | Train Loss: 0.461 Vali Loss: 0.497 Vali Acc: 0.776 Test Loss: 0.497 Test Acc: 0.776
Validation loss decreased (-0.560968 --> -0.775605).  Saving model ...
Epoch: 4 cost time: 21.5417377948761
Epoch: 4, Steps: 13 | Train Loss: 0.313 Vali Loss: 0.566 Vali Acc: 0.756 Test Loss: 0.566 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 21.949735641479492
Epoch: 5, Steps: 13 | Train Loss: 0.340 Vali Loss: 0.640 Vali Acc: 0.756 Test Loss: 0.640 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 21.389108419418335
Epoch: 6, Steps: 13 | Train Loss: 0.206 Vali Loss: 0.777 Vali Acc: 0.600 Test Loss: 0.777 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 20.663633823394775
Epoch: 7, Steps: 13 | Train Loss: 0.178 Vali Loss: 0.603 Vali Acc: 0.712 Test Loss: 0.603 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 22.30780816078186
Epoch: 8, Steps: 13 | Train Loss: 0.130 Vali Loss: 1.053 Vali Acc: 0.732 Test Loss: 1.053 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 21.247169971466064
Epoch: 9, Steps: 13 | Train Loss: 0.148 Vali Loss: 0.658 Vali Acc: 0.722 Test Loss: 0.658 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 21.669860363006592
Epoch: 10, Steps: 13 | Train Loss: 0.156 Vali Loss: 0.682 Vali Acc: 0.707 Test Loss: 0.682 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 22.18540906906128
Epoch: 11, Steps: 13 | Train Loss: 0.112 Vali Loss: 0.851 Vali Acc: 0.756 Test Loss: 0.851 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 21.885467767715454
Epoch: 12, Steps: 13 | Train Loss: 0.024 Vali Loss: 0.833 Vali Acc: 0.732 Test Loss: 0.833 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 21.54297161102295
Epoch: 13, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.138 Vali Acc: 0.756 Test Loss: 1.138 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 18874242
model size : 74.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 11.131486415863037
Epoch: 1, Steps: 13 | Train Loss: 0.575 Vali Loss: 0.560 Vali Acc: 0.737 Test Loss: 0.560 Test Acc: 0.737
Validation loss decreased (inf --> -0.736580).  Saving model ...
Epoch: 2 cost time: 9.8687584400177
Epoch: 2, Steps: 13 | Train Loss: 0.525 Vali Loss: 0.548 Vali Acc: 0.707 Test Loss: 0.548 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.313619613647461
Epoch: 3, Steps: 13 | Train Loss: 0.408 Vali Loss: 0.593 Vali Acc: 0.644 Test Loss: 0.593 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.908774614334106
Epoch: 4, Steps: 13 | Train Loss: 0.361 Vali Loss: 0.602 Vali Acc: 0.639 Test Loss: 0.602 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 9.303217649459839
Epoch: 5, Steps: 13 | Train Loss: 0.240 Vali Loss: 0.559 Vali Acc: 0.756 Test Loss: 0.559 Test Acc: 0.756
Validation loss decreased (-0.736580 --> -0.756092).  Saving model ...
Epoch: 6 cost time: 9.596993684768677
Epoch: 6, Steps: 13 | Train Loss: 0.188 Vali Loss: 0.822 Vali Acc: 0.561 Test Loss: 0.822 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.59030270576477
Epoch: 7, Steps: 13 | Train Loss: 0.205 Vali Loss: 0.729 Vali Acc: 0.751 Test Loss: 0.729 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 9.296196937561035
Epoch: 8, Steps: 13 | Train Loss: 0.110 Vali Loss: 0.672 Vali Acc: 0.727 Test Loss: 0.672 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 8.592715740203857
Epoch: 9, Steps: 13 | Train Loss: 0.166 Vali Loss: 1.155 Vali Acc: 0.737 Test Loss: 1.155 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 9.317310571670532
Epoch: 10, Steps: 13 | Train Loss: 0.085 Vali Loss: 1.203 Vali Acc: 0.732 Test Loss: 1.203 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 9.198237895965576
Epoch: 11, Steps: 13 | Train Loss: 0.113 Vali Loss: 0.803 Vali Acc: 0.737 Test Loss: 0.803 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 9.279308557510376
Epoch: 12, Steps: 13 | Train Loss: 0.107 Vali Loss: 2.532 Vali Acc: 0.444 Test Loss: 2.532 Test Acc: 0.444
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 9.298888921737671
Epoch: 13, Steps: 13 | Train Loss: 0.128 Vali Loss: 1.248 Vali Acc: 0.556 Test Loss: 1.248 Test Acc: 0.556
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 9.293507814407349
Epoch: 14, Steps: 13 | Train Loss: 0.026 Vali Loss: 1.006 Vali Acc: 0.722 Test Loss: 1.006 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 9.132872104644775
Epoch: 15, Steps: 13 | Train Loss: 0.042 Vali Loss: 1.080 Vali Acc: 0.712 Test Loss: 1.080 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 5634946
model size : 23.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 14.244295358657837
Epoch: 1, Steps: 13 | Train Loss: 0.656 Vali Loss: 0.689 Vali Acc: 0.517 Test Loss: 0.689 Test Acc: 0.517
Validation loss decreased (inf --> -0.517066).  Saving model ...
Epoch: 2 cost time: 13.0698881149292
Epoch: 2, Steps: 13 | Train Loss: 0.666 Vali Loss: 0.728 Vali Acc: 0.541 Test Loss: 0.728 Test Acc: 0.541
Validation loss decreased (-0.517066 --> -0.541456).  Saving model ...
Epoch: 3 cost time: 12.818194389343262
Epoch: 3, Steps: 13 | Train Loss: 0.467 Vali Loss: 0.501 Vali Acc: 0.771 Test Loss: 0.501 Test Acc: 0.771
Validation loss decreased (-0.541456 --> -0.770727).  Saving model ...
Epoch: 4 cost time: 12.887821197509766
Epoch: 4, Steps: 13 | Train Loss: 0.317 Vali Loss: 0.589 Vali Acc: 0.741 Test Loss: 0.589 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 13.006573915481567
Epoch: 5, Steps: 13 | Train Loss: 0.332 Vali Loss: 0.631 Vali Acc: 0.751 Test Loss: 0.631 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 12.637691259384155
Epoch: 6, Steps: 13 | Train Loss: 0.189 Vali Loss: 0.589 Vali Acc: 0.678 Test Loss: 0.589 Test Acc: 0.678
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 13.11682677268982
Epoch: 7, Steps: 13 | Train Loss: 0.164 Vali Loss: 0.615 Vali Acc: 0.737 Test Loss: 0.615 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 12.342871904373169
Epoch: 8, Steps: 13 | Train Loss: 0.093 Vali Loss: 0.800 Vali Acc: 0.751 Test Loss: 0.800 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 12.800548315048218
Epoch: 9, Steps: 13 | Train Loss: 0.848 Vali Loss: 1.197 Vali Acc: 0.493 Test Loss: 1.197 Test Acc: 0.493
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 12.792818546295166
Epoch: 10, Steps: 13 | Train Loss: 0.307 Vali Loss: 0.695 Vali Acc: 0.717 Test Loss: 0.695 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 11.91064715385437
Epoch: 11, Steps: 13 | Train Loss: 0.090 Vali Loss: 1.078 Vali Acc: 0.761 Test Loss: 1.078 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 12.855741500854492
Epoch: 12, Steps: 13 | Train Loss: 0.029 Vali Loss: 1.051 Vali Acc: 0.741 Test Loss: 1.051 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 13.676276683807373
Epoch: 13, Steps: 13 | Train Loss: 0.021 Vali Loss: 0.855 Vali Acc: 0.727 Test Loss: 0.855 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 18874242
model size : 74.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.540270805358887
Epoch: 1, Steps: 13 | Train Loss: 0.577 Vali Loss: 0.559 Vali Acc: 0.737 Test Loss: 0.559 Test Acc: 0.737
Validation loss decreased (inf --> -0.736580).  Saving model ...
Epoch: 2 cost time: 5.787029266357422
Epoch: 2, Steps: 13 | Train Loss: 0.526 Vali Loss: 0.551 Vali Acc: 0.712 Test Loss: 0.551 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.2501866817474365
Epoch: 3, Steps: 13 | Train Loss: 0.414 Vali Loss: 0.604 Vali Acc: 0.654 Test Loss: 0.604 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.890071868896484
Epoch: 4, Steps: 13 | Train Loss: 0.374 Vali Loss: 0.711 Vali Acc: 0.576 Test Loss: 0.711 Test Acc: 0.576
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.210870265960693
Epoch: 5, Steps: 13 | Train Loss: 0.251 Vali Loss: 0.715 Vali Acc: 0.741 Test Loss: 0.715 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741456).  Saving model ...
Epoch: 6 cost time: 5.763684272766113
Epoch: 6, Steps: 13 | Train Loss: 0.319 Vali Loss: 0.640 Vali Acc: 0.683 Test Loss: 0.640 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.225761651992798
Epoch: 7, Steps: 13 | Train Loss: 0.287 Vali Loss: 0.680 Vali Acc: 0.624 Test Loss: 0.680 Test Acc: 0.624
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.7210373878479
Epoch: 8, Steps: 13 | Train Loss: 0.352 Vali Loss: 2.272 Vali Acc: 0.341 Test Loss: 2.272 Test Acc: 0.341
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.1216230392456055
Epoch: 9, Steps: 13 | Train Loss: 0.514 Vali Loss: 0.677 Vali Acc: 0.702 Test Loss: 0.677 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.798303604125977
Epoch: 10, Steps: 13 | Train Loss: 0.260 Vali Loss: 1.131 Vali Acc: 0.737 Test Loss: 1.131 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 6.02651309967041
Epoch: 11, Steps: 13 | Train Loss: 0.128 Vali Loss: 1.748 Vali Acc: 0.722 Test Loss: 1.748 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 6.053699970245361
Epoch: 12, Steps: 13 | Train Loss: 0.093 Vali Loss: 0.844 Vali Acc: 0.634 Test Loss: 0.844 Test Acc: 0.634
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 5.862939119338989
Epoch: 13, Steps: 13 | Train Loss: 0.030 Vali Loss: 1.062 Vali Acc: 0.576 Test Loss: 1.062 Test Acc: 0.576
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 6.241179466247559
Epoch: 14, Steps: 13 | Train Loss: 0.028 Vali Loss: 1.313 Vali Acc: 0.746 Test Loss: 1.313 Test Acc: 0.746
Validation loss decreased (-0.741456 --> -0.746328).  Saving model ...
Epoch: 15 cost time: 5.689598798751831
Epoch: 15, Steps: 13 | Train Loss: 0.086 Vali Loss: 1.234 Vali Acc: 0.761 Test Loss: 1.234 Test Acc: 0.761
Validation loss decreased (-0.746328 --> -0.760963).  Saving model ...
Epoch: 16 cost time: 6.020506143569946
Epoch: 16, Steps: 13 | Train Loss: 0.011 Vali Loss: 0.924 Vali Acc: 0.722 Test Loss: 0.924 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.5418009757995605
Epoch: 17, Steps: 13 | Train Loss: 0.004 Vali Loss: 0.915 Vali Acc: 0.702 Test Loss: 0.915 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.9634950160980225
Epoch: 18, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.928 Vali Acc: 0.698 Test Loss: 0.928 Test Acc: 0.698
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.466607093811035
Epoch: 19, Steps: 13 | Train Loss: 0.002 Vali Loss: 0.955 Vali Acc: 0.712 Test Loss: 0.955 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.612057209014893
Epoch: 20, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.007 Vali Acc: 0.702 Test Loss: 1.007 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 5.522571325302124
Epoch: 21, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.237 Vali Acc: 0.751 Test Loss: 1.237 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 5.505590200424194
Epoch: 22, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.071 Vali Acc: 0.698 Test Loss: 1.071 Test Acc: 0.698
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 5.347233533859253
Epoch: 23, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.074 Vali Acc: 0.707 Test Loss: 1.074 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 5.237097263336182
Epoch: 24, Steps: 13 | Train Loss: 0.065 Vali Loss: 1.349 Vali Acc: 0.737 Test Loss: 1.349 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 5.3752052783966064
Epoch: 25, Steps: 13 | Train Loss: 0.010 Vali Loss: 2.001 Vali Acc: 0.737 Test Loss: 2.001 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 5634946
model size : 23.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 32.90052628517151
Epoch: 1, Steps: 13 | Train Loss: 0.616 Vali Loss: 0.568 Vali Acc: 0.732 Test Loss: 0.568 Test Acc: 0.732
Validation loss decreased (inf --> -0.731702).  Saving model ...
Epoch: 2 cost time: 31.59849238395691
Epoch: 2, Steps: 13 | Train Loss: 0.514 Vali Loss: 0.573 Vali Acc: 0.756 Test Loss: 0.573 Test Acc: 0.756
Validation loss decreased (-0.731702 --> -0.756092).  Saving model ...
Epoch: 3 cost time: 31.289781093597412
Epoch: 3, Steps: 13 | Train Loss: 0.442 Vali Loss: 0.515 Vali Acc: 0.785 Test Loss: 0.515 Test Acc: 0.785
Validation loss decreased (-0.756092 --> -0.785361).  Saving model ...
Epoch: 4 cost time: 31.266350984573364
Epoch: 4, Steps: 13 | Train Loss: 0.383 Vali Loss: 0.509 Vali Acc: 0.771 Test Loss: 0.509 Test Acc: 0.771
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 29.337175130844116
Epoch: 5, Steps: 13 | Train Loss: 0.345 Vali Loss: 0.713 Vali Acc: 0.566 Test Loss: 0.713 Test Acc: 0.566
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 32.38939833641052
Epoch: 6, Steps: 13 | Train Loss: 0.363 Vali Loss: 0.538 Vali Acc: 0.722 Test Loss: 0.538 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 35.90051531791687
Epoch: 7, Steps: 13 | Train Loss: 0.263 Vali Loss: 0.674 Vali Acc: 0.605 Test Loss: 0.674 Test Acc: 0.605
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 35.851062297821045
Epoch: 8, Steps: 13 | Train Loss: 0.218 Vali Loss: 0.813 Vali Acc: 0.751 Test Loss: 0.813 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 35.7803795337677
Epoch: 9, Steps: 13 | Train Loss: 0.167 Vali Loss: 0.563 Vali Acc: 0.741 Test Loss: 0.563 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 35.56056499481201
Epoch: 10, Steps: 13 | Train Loss: 0.110 Vali Loss: 0.638 Vali Acc: 0.698 Test Loss: 0.638 Test Acc: 0.698
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 32.43518662452698
Epoch: 11, Steps: 13 | Train Loss: 0.078 Vali Loss: 0.698 Vali Acc: 0.746 Test Loss: 0.698 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 33.63560891151428
Epoch: 12, Steps: 13 | Train Loss: 0.068 Vali Loss: 0.789 Vali Acc: 0.771 Test Loss: 0.789 Test Acc: 0.771
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 35.848453998565674
Epoch: 13, Steps: 13 | Train Loss: 0.053 Vali Loss: 0.814 Vali Acc: 0.707 Test Loss: 0.814 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7853658536585366
model parameter : 18811074
model size : 73.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 16.277690649032593
Epoch: 1, Steps: 13 | Train Loss: 0.593 Vali Loss: 0.605 Vali Acc: 0.712 Test Loss: 0.605 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 14.17436695098877
Epoch: 2, Steps: 13 | Train Loss: 0.524 Vali Loss: 0.559 Vali Acc: 0.727 Test Loss: 0.559 Test Acc: 0.727
Validation loss decreased (-0.712189 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 14.308887004852295
Epoch: 3, Steps: 13 | Train Loss: 0.496 Vali Loss: 0.503 Vali Acc: 0.766 Test Loss: 0.503 Test Acc: 0.766
Validation loss decreased (-0.726824 --> -0.765849).  Saving model ...
Epoch: 4 cost time: 14.343220233917236
Epoch: 4, Steps: 13 | Train Loss: 0.438 Vali Loss: 0.685 Vali Acc: 0.732 Test Loss: 0.685 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 14.360377073287964
Epoch: 5, Steps: 13 | Train Loss: 0.369 Vali Loss: 0.549 Vali Acc: 0.766 Test Loss: 0.549 Test Acc: 0.766
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 14.330449104309082
Epoch: 6, Steps: 13 | Train Loss: 0.319 Vali Loss: 0.572 Vali Acc: 0.756 Test Loss: 0.572 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 13.773910760879517
Epoch: 7, Steps: 13 | Train Loss: 0.240 Vali Loss: 0.548 Vali Acc: 0.766 Test Loss: 0.548 Test Acc: 0.766
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 13.896867513656616
Epoch: 8, Steps: 13 | Train Loss: 0.236 Vali Loss: 0.644 Vali Acc: 0.683 Test Loss: 0.644 Test Acc: 0.683
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 13.923597812652588
Epoch: 9, Steps: 13 | Train Loss: 0.253 Vali Loss: 0.600 Vali Acc: 0.737 Test Loss: 0.600 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 13.845415830612183
Epoch: 10, Steps: 13 | Train Loss: 0.107 Vali Loss: 0.645 Vali Acc: 0.746 Test Loss: 0.645 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 13.803580522537231
Epoch: 11, Steps: 13 | Train Loss: 0.085 Vali Loss: 0.650 Vali Acc: 0.741 Test Loss: 0.650 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 13.895906209945679
Epoch: 12, Steps: 13 | Train Loss: 0.058 Vali Loss: 0.820 Vali Acc: 0.771 Test Loss: 0.820 Test Acc: 0.771
Validation loss decreased (-0.765849 --> -0.770724).  Saving model ...
Epoch: 13 cost time: 13.900577068328857
Epoch: 13, Steps: 13 | Train Loss: 0.062 Vali Loss: 0.945 Vali Acc: 0.605 Test Loss: 0.945 Test Acc: 0.605
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 13.85984492301941
Epoch: 14, Steps: 13 | Train Loss: 0.072 Vali Loss: 0.755 Vali Acc: 0.688 Test Loss: 0.755 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 13.448348760604858
Epoch: 15, Steps: 13 | Train Loss: 0.045 Vali Loss: 0.942 Vali Acc: 0.737 Test Loss: 0.942 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 14.128386497497559
Epoch: 16, Steps: 13 | Train Loss: 0.029 Vali Loss: 0.868 Vali Acc: 0.712 Test Loss: 0.868 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 14.024106740951538
Epoch: 17, Steps: 13 | Train Loss: 0.035 Vali Loss: 0.872 Vali Acc: 0.659 Test Loss: 0.872 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 14.260535717010498
Epoch: 18, Steps: 13 | Train Loss: 0.013 Vali Loss: 0.946 Vali Acc: 0.707 Test Loss: 0.946 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 13.96214246749878
Epoch: 19, Steps: 13 | Train Loss: 0.020 Vali Loss: 0.859 Vali Acc: 0.717 Test Loss: 0.859 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 13.87315058708191
Epoch: 20, Steps: 13 | Train Loss: 0.007 Vali Loss: 0.893 Vali Acc: 0.693 Test Loss: 0.893 Test Acc: 0.693
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 13.979051113128662
Epoch: 21, Steps: 13 | Train Loss: 0.018 Vali Loss: 0.880 Vali Acc: 0.732 Test Loss: 0.880 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 14.032317638397217
Epoch: 22, Steps: 13 | Train Loss: 0.005 Vali Loss: 0.934 Vali Acc: 0.746 Test Loss: 0.934 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 5571522
model size : 22.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 29.86943554878235
Epoch: 1, Steps: 13 | Train Loss: 0.615 Vali Loss: 0.570 Vali Acc: 0.727 Test Loss: 0.570 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 27.714843273162842
Epoch: 2, Steps: 13 | Train Loss: 0.525 Vali Loss: 0.590 Vali Acc: 0.741 Test Loss: 0.590 Test Acc: 0.741
Validation loss decreased (-0.726824 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 27.541157007217407
Epoch: 3, Steps: 13 | Train Loss: 0.456 Vali Loss: 0.518 Vali Acc: 0.776 Test Loss: 0.518 Test Acc: 0.776
Validation loss decreased (-0.741458 --> -0.775605).  Saving model ...
Epoch: 4 cost time: 28.297882080078125
Epoch: 4, Steps: 13 | Train Loss: 0.395 Vali Loss: 0.511 Vali Acc: 0.761 Test Loss: 0.511 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 28.049360752105713
Epoch: 5, Steps: 13 | Train Loss: 0.351 Vali Loss: 0.733 Vali Acc: 0.566 Test Loss: 0.733 Test Acc: 0.566
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 27.74940514564514
Epoch: 6, Steps: 13 | Train Loss: 0.393 Vali Loss: 0.549 Vali Acc: 0.707 Test Loss: 0.549 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 28.026757955551147
Epoch: 7, Steps: 13 | Train Loss: 0.276 Vali Loss: 0.799 Vali Acc: 0.507 Test Loss: 0.799 Test Acc: 0.507
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 28.236591577529907
Epoch: 8, Steps: 13 | Train Loss: 0.245 Vali Loss: 0.572 Vali Acc: 0.722 Test Loss: 0.572 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 27.884559392929077
Epoch: 9, Steps: 13 | Train Loss: 0.138 Vali Loss: 0.601 Vali Acc: 0.712 Test Loss: 0.601 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 27.897903442382812
Epoch: 10, Steps: 13 | Train Loss: 0.119 Vali Loss: 0.616 Vali Acc: 0.717 Test Loss: 0.616 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 27.97497868537903
Epoch: 11, Steps: 13 | Train Loss: 0.084 Vali Loss: 0.649 Vali Acc: 0.732 Test Loss: 0.649 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 27.887421131134033
Epoch: 12, Steps: 13 | Train Loss: 0.064 Vali Loss: 0.716 Vali Acc: 0.712 Test Loss: 0.716 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 27.534308195114136
Epoch: 13, Steps: 13 | Train Loss: 0.067 Vali Loss: 0.716 Vali Acc: 0.741 Test Loss: 0.716 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 18811074
model size : 73.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 13.520686626434326
Epoch: 1, Steps: 13 | Train Loss: 0.592 Vali Loss: 0.607 Vali Acc: 0.712 Test Loss: 0.607 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 11.169044494628906
Epoch: 2, Steps: 13 | Train Loss: 0.528 Vali Loss: 0.567 Vali Acc: 0.727 Test Loss: 0.567 Test Acc: 0.727
Validation loss decreased (-0.712189 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 11.142765522003174
Epoch: 3, Steps: 13 | Train Loss: 0.501 Vali Loss: 0.514 Vali Acc: 0.751 Test Loss: 0.514 Test Acc: 0.751
Validation loss decreased (-0.726824 --> -0.751214).  Saving model ...
Epoch: 4 cost time: 10.921287059783936
Epoch: 4, Steps: 13 | Train Loss: 0.434 Vali Loss: 0.719 Vali Acc: 0.722 Test Loss: 0.719 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 11.02505373954773
Epoch: 5, Steps: 13 | Train Loss: 0.431 Vali Loss: 0.727 Vali Acc: 0.732 Test Loss: 0.727 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 10.697967052459717
Epoch: 6, Steps: 13 | Train Loss: 0.394 Vali Loss: 0.810 Vali Acc: 0.732 Test Loss: 0.810 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 10.891963720321655
Epoch: 7, Steps: 13 | Train Loss: 0.323 Vali Loss: 0.639 Vali Acc: 0.737 Test Loss: 0.639 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 10.797836780548096
Epoch: 8, Steps: 13 | Train Loss: 0.240 Vali Loss: 0.544 Vali Acc: 0.727 Test Loss: 0.544 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 11.03565001487732
Epoch: 9, Steps: 13 | Train Loss: 0.183 Vali Loss: 0.911 Vali Acc: 0.722 Test Loss: 0.911 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 11.054396152496338
Epoch: 10, Steps: 13 | Train Loss: 0.137 Vali Loss: 0.701 Vali Acc: 0.761 Test Loss: 0.701 Test Acc: 0.761
Validation loss decreased (-0.751214 --> -0.760969).  Saving model ...
Epoch: 11 cost time: 10.919884443283081
Epoch: 11, Steps: 13 | Train Loss: 0.094 Vali Loss: 0.651 Vali Acc: 0.698 Test Loss: 0.651 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 10.91230320930481
Epoch: 12, Steps: 13 | Train Loss: 0.060 Vali Loss: 0.815 Vali Acc: 0.751 Test Loss: 0.815 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 10.964135885238647
Epoch: 13, Steps: 13 | Train Loss: 0.049 Vali Loss: 0.747 Vali Acc: 0.688 Test Loss: 0.747 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 11.141634225845337
Epoch: 14, Steps: 13 | Train Loss: 0.039 Vali Loss: 0.782 Vali Acc: 0.707 Test Loss: 0.782 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 11.26748275756836
Epoch: 15, Steps: 13 | Train Loss: 0.030 Vali Loss: 0.826 Vali Acc: 0.698 Test Loss: 0.826 Test Acc: 0.698
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 11.430291891098022
Epoch: 16, Steps: 13 | Train Loss: 0.020 Vali Loss: 0.912 Vali Acc: 0.698 Test Loss: 0.912 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 11.220974922180176
Epoch: 17, Steps: 13 | Train Loss: 0.020 Vali Loss: 0.835 Vali Acc: 0.712 Test Loss: 0.835 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 11.271421670913696
Epoch: 18, Steps: 13 | Train Loss: 0.010 Vali Loss: 0.959 Vali Acc: 0.746 Test Loss: 0.959 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 11.221323251724243
Epoch: 19, Steps: 13 | Train Loss: 0.014 Vali Loss: 0.899 Vali Acc: 0.722 Test Loss: 0.899 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 11.031128168106079
Epoch: 20, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.062 Vali Acc: 0.737 Test Loss: 1.062 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 5571522
model size : 22.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 18.0242862701416
Epoch: 1, Steps: 13 | Train Loss: 0.615 Vali Loss: 0.571 Vali Acc: 0.727 Test Loss: 0.571 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 16.222559213638306
Epoch: 2, Steps: 13 | Train Loss: 0.529 Vali Loss: 0.586 Vali Acc: 0.746 Test Loss: 0.586 Test Acc: 0.746
Validation loss decreased (-0.726824 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 16.442760705947876
Epoch: 3, Steps: 13 | Train Loss: 0.461 Vali Loss: 0.519 Vali Acc: 0.756 Test Loss: 0.519 Test Acc: 0.756
Validation loss decreased (-0.746336 --> -0.756092).  Saving model ...
Epoch: 4 cost time: 16.122799396514893
Epoch: 4, Steps: 13 | Train Loss: 0.398 Vali Loss: 0.510 Vali Acc: 0.741 Test Loss: 0.510 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 16.414787530899048
Epoch: 5, Steps: 13 | Train Loss: 0.340 Vali Loss: 0.778 Vali Acc: 0.556 Test Loss: 0.778 Test Acc: 0.556
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 16.375052213668823
Epoch: 6, Steps: 13 | Train Loss: 0.386 Vali Loss: 0.562 Vali Acc: 0.702 Test Loss: 0.562 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 16.354671716690063
Epoch: 7, Steps: 13 | Train Loss: 0.306 Vali Loss: 0.654 Vali Acc: 0.649 Test Loss: 0.654 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 16.3175208568573
Epoch: 8, Steps: 13 | Train Loss: 0.206 Vali Loss: 0.701 Vali Acc: 0.751 Test Loss: 0.701 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 16.454719305038452
Epoch: 9, Steps: 13 | Train Loss: 0.147 Vali Loss: 0.581 Vali Acc: 0.737 Test Loss: 0.581 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 16.542274951934814
Epoch: 10, Steps: 13 | Train Loss: 0.093 Vali Loss: 0.798 Vali Acc: 0.610 Test Loss: 0.798 Test Acc: 0.610
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 16.065997838974
Epoch: 11, Steps: 13 | Train Loss: 0.446 Vali Loss: 1.193 Vali Acc: 0.463 Test Loss: 1.193 Test Acc: 0.463
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 16.228684186935425
Epoch: 12, Steps: 13 | Train Loss: 0.148 Vali Loss: 0.672 Vali Acc: 0.707 Test Loss: 0.672 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 16.363007307052612
Epoch: 13, Steps: 13 | Train Loss: 0.065 Vali Loss: 0.734 Vali Acc: 0.727 Test Loss: 0.734 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 18811074
model size : 73.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 9.029115438461304
Epoch: 1, Steps: 13 | Train Loss: 0.591 Vali Loss: 0.608 Vali Acc: 0.717 Test Loss: 0.608 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 7.407841920852661
Epoch: 2, Steps: 13 | Train Loss: 0.530 Vali Loss: 0.563 Vali Acc: 0.722 Test Loss: 0.563 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721946).  Saving model ...
Epoch: 3 cost time: 7.409560203552246
Epoch: 3, Steps: 13 | Train Loss: 0.501 Vali Loss: 0.514 Vali Acc: 0.751 Test Loss: 0.514 Test Acc: 0.751
Validation loss decreased (-0.721946 --> -0.751214).  Saving model ...
Epoch: 4 cost time: 7.264899730682373
Epoch: 4, Steps: 13 | Train Loss: 0.430 Vali Loss: 0.698 Vali Acc: 0.722 Test Loss: 0.698 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.403822898864746
Epoch: 5, Steps: 13 | Train Loss: 0.428 Vali Loss: 0.722 Vali Acc: 0.727 Test Loss: 0.722 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.400274753570557
Epoch: 6, Steps: 13 | Train Loss: 0.391 Vali Loss: 0.837 Vali Acc: 0.727 Test Loss: 0.837 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 7.355340480804443
Epoch: 7, Steps: 13 | Train Loss: 0.334 Vali Loss: 0.627 Vali Acc: 0.741 Test Loss: 0.627 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 7.245797634124756
Epoch: 8, Steps: 13 | Train Loss: 0.428 Vali Loss: 0.566 Vali Acc: 0.707 Test Loss: 0.566 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 7.240771055221558
Epoch: 9, Steps: 13 | Train Loss: 0.270 Vali Loss: 0.908 Vali Acc: 0.722 Test Loss: 0.908 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 7.219953298568726
Epoch: 10, Steps: 13 | Train Loss: 0.173 Vali Loss: 0.681 Vali Acc: 0.654 Test Loss: 0.681 Test Acc: 0.654
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 7.118894100189209
Epoch: 11, Steps: 13 | Train Loss: 0.177 Vali Loss: 0.706 Vali Acc: 0.741 Test Loss: 0.706 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 7.19753623008728
Epoch: 12, Steps: 13 | Train Loss: 0.073 Vali Loss: 0.745 Vali Acc: 0.751 Test Loss: 0.745 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 6.646788120269775
Epoch: 13, Steps: 13 | Train Loss: 0.080 Vali Loss: 0.962 Vali Acc: 0.561 Test Loss: 0.962 Test Acc: 0.561
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 5571522
model size : 22.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 22.716655492782593
Epoch: 1, Steps: 13 | Train Loss: 0.602 Vali Loss: 0.602 Vali Acc: 0.722 Test Loss: 0.602 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 20.8288733959198
Epoch: 2, Steps: 13 | Train Loss: 0.512 Vali Loss: 0.524 Vali Acc: 0.746 Test Loss: 0.524 Test Acc: 0.746
Validation loss decreased (-0.721945 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 20.445796012878418
Epoch: 3, Steps: 13 | Train Loss: 0.453 Vali Loss: 0.547 Vali Acc: 0.732 Test Loss: 0.547 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 20.062163829803467
Epoch: 4, Steps: 13 | Train Loss: 0.367 Vali Loss: 0.548 Vali Acc: 0.746 Test Loss: 0.548 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 19.608232736587524
Epoch: 5, Steps: 13 | Train Loss: 0.327 Vali Loss: 0.798 Vali Acc: 0.561 Test Loss: 0.798 Test Acc: 0.561
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 19.746249198913574
Epoch: 6, Steps: 13 | Train Loss: 0.385 Vali Loss: 0.574 Vali Acc: 0.737 Test Loss: 0.574 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 19.502551317214966
Epoch: 7, Steps: 13 | Train Loss: 0.229 Vali Loss: 0.671 Vali Acc: 0.741 Test Loss: 0.671 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 19.812878131866455
Epoch: 8, Steps: 13 | Train Loss: 0.199 Vali Loss: 0.806 Vali Acc: 0.571 Test Loss: 0.806 Test Acc: 0.571
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 19.516044855117798
Epoch: 9, Steps: 13 | Train Loss: 0.201 Vali Loss: 0.647 Vali Acc: 0.673 Test Loss: 0.647 Test Acc: 0.673
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 19.800508737564087
Epoch: 10, Steps: 13 | Train Loss: 0.111 Vali Loss: 0.638 Vali Acc: 0.741 Test Loss: 0.638 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 20.266690969467163
Epoch: 11, Steps: 13 | Train Loss: 0.103 Vali Loss: 0.795 Vali Acc: 0.751 Test Loss: 0.795 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751212).  Saving model ...
Epoch: 12 cost time: 20.419734239578247
Epoch: 12, Steps: 13 | Train Loss: 0.106 Vali Loss: 0.670 Vali Acc: 0.673 Test Loss: 0.670 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 20.30244755744934
Epoch: 13, Steps: 13 | Train Loss: 0.067 Vali Loss: 0.748 Vali Acc: 0.668 Test Loss: 0.748 Test Acc: 0.668
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 20.38141107559204
Epoch: 14, Steps: 13 | Train Loss: 0.028 Vali Loss: 0.810 Vali Acc: 0.751 Test Loss: 0.810 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 20.277846813201904
Epoch: 15, Steps: 13 | Train Loss: 0.021 Vali Loss: 0.902 Vali Acc: 0.610 Test Loss: 0.902 Test Acc: 0.610
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 20.42963933944702
Epoch: 16, Steps: 13 | Train Loss: 0.024 Vali Loss: 1.121 Vali Acc: 0.732 Test Loss: 1.121 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 20.247681617736816
Epoch: 17, Steps: 13 | Train Loss: 0.047 Vali Loss: 1.009 Vali Acc: 0.737 Test Loss: 1.009 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 20.157973289489746
Epoch: 18, Steps: 13 | Train Loss: 0.034 Vali Loss: 0.927 Vali Acc: 0.605 Test Loss: 0.927 Test Acc: 0.605
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 20.286091804504395
Epoch: 19, Steps: 13 | Train Loss: 0.023 Vali Loss: 0.975 Vali Acc: 0.732 Test Loss: 0.975 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 20.131821155548096
Epoch: 20, Steps: 13 | Train Loss: 0.049 Vali Loss: 1.030 Vali Acc: 0.644 Test Loss: 1.030 Test Acc: 0.644
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 20.357276439666748
Epoch: 21, Steps: 13 | Train Loss: 0.008 Vali Loss: 0.994 Vali Acc: 0.707 Test Loss: 0.994 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 9437890
model size : 37.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 9.962533473968506
Epoch: 1, Steps: 13 | Train Loss: 0.650 Vali Loss: 0.571 Vali Acc: 0.727 Test Loss: 0.571 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 8.622365713119507
Epoch: 2, Steps: 13 | Train Loss: 0.548 Vali Loss: 0.532 Vali Acc: 0.737 Test Loss: 0.532 Test Acc: 0.737
Validation loss decreased (-0.726824 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 8.70585823059082
Epoch: 3, Steps: 13 | Train Loss: 0.444 Vali Loss: 0.528 Vali Acc: 0.756 Test Loss: 0.528 Test Acc: 0.756
Validation loss decreased (-0.736580 --> -0.756092).  Saving model ...
Epoch: 4 cost time: 8.65855622291565
Epoch: 4, Steps: 13 | Train Loss: 0.396 Vali Loss: 0.519 Vali Acc: 0.780 Test Loss: 0.519 Test Acc: 0.780
Validation loss decreased (-0.756092 --> -0.780483).  Saving model ...
Epoch: 5 cost time: 8.675196647644043
Epoch: 5, Steps: 13 | Train Loss: 0.309 Vali Loss: 0.580 Vali Acc: 0.673 Test Loss: 0.580 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.63060998916626
Epoch: 6, Steps: 13 | Train Loss: 0.235 Vali Loss: 0.520 Vali Acc: 0.737 Test Loss: 0.520 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 8.613974571228027
Epoch: 7, Steps: 13 | Train Loss: 0.237 Vali Loss: 0.615 Vali Acc: 0.771 Test Loss: 0.615 Test Acc: 0.771
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 8.626914024353027
Epoch: 8, Steps: 13 | Train Loss: 0.207 Vali Loss: 0.637 Vali Acc: 0.707 Test Loss: 0.637 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 8.666644811630249
Epoch: 9, Steps: 13 | Train Loss: 0.227 Vali Loss: 0.665 Vali Acc: 0.668 Test Loss: 0.665 Test Acc: 0.668
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 8.4606773853302
Epoch: 10, Steps: 13 | Train Loss: 0.144 Vali Loss: 0.646 Vali Acc: 0.707 Test Loss: 0.646 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 8.720899105072021
Epoch: 11, Steps: 13 | Train Loss: 0.075 Vali Loss: 0.661 Vali Acc: 0.737 Test Loss: 0.661 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 8.670827865600586
Epoch: 12, Steps: 13 | Train Loss: 0.050 Vali Loss: 0.840 Vali Acc: 0.620 Test Loss: 0.840 Test Acc: 0.620
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 8.683578491210938
Epoch: 13, Steps: 13 | Train Loss: 0.047 Vali Loss: 0.801 Vali Acc: 0.649 Test Loss: 0.801 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 8.623352766036987
Epoch: 14, Steps: 13 | Train Loss: 0.040 Vali Loss: 0.917 Vali Acc: 0.756 Test Loss: 0.917 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7804878048780488
model parameter : 2817986
model size : 11.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 17.95285415649414
Epoch: 1, Steps: 13 | Train Loss: 0.603 Vali Loss: 0.613 Vali Acc: 0.722 Test Loss: 0.613 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 15.69631814956665
Epoch: 2, Steps: 13 | Train Loss: 0.520 Vali Loss: 0.532 Vali Acc: 0.741 Test Loss: 0.532 Test Acc: 0.741
Validation loss decreased (-0.721945 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 15.559584617614746
Epoch: 3, Steps: 13 | Train Loss: 0.471 Vali Loss: 0.524 Vali Acc: 0.746 Test Loss: 0.524 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 15.58386516571045
Epoch: 4, Steps: 13 | Train Loss: 0.373 Vali Loss: 0.536 Vali Acc: 0.737 Test Loss: 0.536 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 15.757212400436401
Epoch: 5, Steps: 13 | Train Loss: 0.336 Vali Loss: 0.730 Vali Acc: 0.576 Test Loss: 0.730 Test Acc: 0.576
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 15.636082410812378
Epoch: 6, Steps: 13 | Train Loss: 0.313 Vali Loss: 0.555 Vali Acc: 0.717 Test Loss: 0.555 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 15.49958848953247
Epoch: 7, Steps: 13 | Train Loss: 0.255 Vali Loss: 0.752 Vali Acc: 0.737 Test Loss: 0.752 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 15.78191614151001
Epoch: 8, Steps: 13 | Train Loss: 0.201 Vali Loss: 0.876 Vali Acc: 0.517 Test Loss: 0.876 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 15.290288925170898
Epoch: 9, Steps: 13 | Train Loss: 0.236 Vali Loss: 0.653 Vali Acc: 0.654 Test Loss: 0.653 Test Acc: 0.654
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 15.240068435668945
Epoch: 10, Steps: 13 | Train Loss: 0.163 Vali Loss: 0.696 Vali Acc: 0.615 Test Loss: 0.696 Test Acc: 0.615
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 15.272540807723999
Epoch: 11, Steps: 13 | Train Loss: 0.106 Vali Loss: 0.795 Vali Acc: 0.776 Test Loss: 0.795 Test Acc: 0.776
Validation loss decreased (-0.746336 --> -0.775602).  Saving model ...
Epoch: 12 cost time: 15.19430685043335
Epoch: 12, Steps: 13 | Train Loss: 0.115 Vali Loss: 0.654 Vali Acc: 0.707 Test Loss: 0.654 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 15.367418766021729
Epoch: 13, Steps: 13 | Train Loss: 0.065 Vali Loss: 0.677 Vali Acc: 0.707 Test Loss: 0.677 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 15.287146806716919
Epoch: 14, Steps: 13 | Train Loss: 0.028 Vali Loss: 0.777 Vali Acc: 0.737 Test Loss: 0.777 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 15.831079244613647
Epoch: 15, Steps: 13 | Train Loss: 0.021 Vali Loss: 0.904 Vali Acc: 0.624 Test Loss: 0.904 Test Acc: 0.624
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 15.192476511001587
Epoch: 16, Steps: 13 | Train Loss: 0.020 Vali Loss: 1.066 Vali Acc: 0.756 Test Loss: 1.066 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 15.48194670677185
Epoch: 17, Steps: 13 | Train Loss: 0.018 Vali Loss: 0.956 Vali Acc: 0.751 Test Loss: 0.956 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 15.679137229919434
Epoch: 18, Steps: 13 | Train Loss: 0.022 Vali Loss: 0.930 Vali Acc: 0.727 Test Loss: 0.930 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 15.722988605499268
Epoch: 19, Steps: 13 | Train Loss: 0.012 Vali Loss: 0.915 Vali Acc: 0.707 Test Loss: 0.915 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 15.384214401245117
Epoch: 20, Steps: 13 | Train Loss: 0.095 Vali Loss: 1.113 Vali Acc: 0.576 Test Loss: 1.113 Test Acc: 0.576
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 15.737685441970825
Epoch: 21, Steps: 13 | Train Loss: 0.025 Vali Loss: 0.897 Vali Acc: 0.722 Test Loss: 0.897 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 9437890
model size : 37.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.814164400100708
Epoch: 1, Steps: 13 | Train Loss: 0.652 Vali Loss: 0.572 Vali Acc: 0.727 Test Loss: 0.572 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 7.0275163650512695
Epoch: 2, Steps: 13 | Train Loss: 0.550 Vali Loss: 0.535 Vali Acc: 0.737 Test Loss: 0.535 Test Acc: 0.737
Validation loss decreased (-0.726824 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 7.0773539543151855
Epoch: 3, Steps: 13 | Train Loss: 0.455 Vali Loss: 0.537 Vali Acc: 0.746 Test Loss: 0.537 Test Acc: 0.746
Validation loss decreased (-0.736580 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 7.063359498977661
Epoch: 4, Steps: 13 | Train Loss: 0.409 Vali Loss: 0.516 Vali Acc: 0.766 Test Loss: 0.516 Test Acc: 0.766
Validation loss decreased (-0.746336 --> -0.765848).  Saving model ...
Epoch: 5 cost time: 6.9814558029174805
Epoch: 5, Steps: 13 | Train Loss: 0.314 Vali Loss: 0.538 Vali Acc: 0.717 Test Loss: 0.538 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.164427280426025
Epoch: 6, Steps: 13 | Train Loss: 0.249 Vali Loss: 0.526 Vali Acc: 0.741 Test Loss: 0.526 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.998425483703613
Epoch: 7, Steps: 13 | Train Loss: 0.253 Vali Loss: 0.562 Vali Acc: 0.771 Test Loss: 0.562 Test Acc: 0.771
Validation loss decreased (-0.765848 --> -0.770726).  Saving model ...
Epoch: 8 cost time: 7.029993057250977
Epoch: 8, Steps: 13 | Train Loss: 0.227 Vali Loss: 0.660 Vali Acc: 0.624 Test Loss: 0.660 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.035161018371582
Epoch: 9, Steps: 13 | Train Loss: 0.271 Vali Loss: 0.573 Vali Acc: 0.722 Test Loss: 0.573 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.974127531051636
Epoch: 10, Steps: 13 | Train Loss: 0.272 Vali Loss: 0.732 Vali Acc: 0.776 Test Loss: 0.732 Test Acc: 0.776
Validation loss decreased (-0.770726 --> -0.775602).  Saving model ...
Epoch: 11 cost time: 6.987497568130493
Epoch: 11, Steps: 13 | Train Loss: 0.146 Vali Loss: 0.599 Vali Acc: 0.717 Test Loss: 0.599 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.2171242237091064
Epoch: 12, Steps: 13 | Train Loss: 0.078 Vali Loss: 0.722 Vali Acc: 0.634 Test Loss: 0.722 Test Acc: 0.634
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 7.107187747955322
Epoch: 13, Steps: 13 | Train Loss: 0.058 Vali Loss: 0.654 Vali Acc: 0.732 Test Loss: 0.654 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 7.0633463859558105
Epoch: 14, Steps: 13 | Train Loss: 0.035 Vali Loss: 0.691 Vali Acc: 0.717 Test Loss: 0.691 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.951690673828125
Epoch: 15, Steps: 13 | Train Loss: 0.026 Vali Loss: 0.839 Vali Acc: 0.756 Test Loss: 0.839 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 7.1004860401153564
Epoch: 16, Steps: 13 | Train Loss: 0.038 Vali Loss: 1.043 Vali Acc: 0.746 Test Loss: 1.043 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 7.124920129776001
Epoch: 17, Steps: 13 | Train Loss: 0.025 Vali Loss: 0.898 Vali Acc: 0.659 Test Loss: 0.898 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 7.200953006744385
Epoch: 18, Steps: 13 | Train Loss: 0.031 Vali Loss: 0.833 Vali Acc: 0.668 Test Loss: 0.833 Test Acc: 0.668
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 7.045224189758301
Epoch: 19, Steps: 13 | Train Loss: 0.012 Vali Loss: 0.828 Vali Acc: 0.727 Test Loss: 0.828 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 7.064173460006714
Epoch: 20, Steps: 13 | Train Loss: 0.007 Vali Loss: 0.857 Vali Acc: 0.727 Test Loss: 0.857 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 2817986
model size : 11.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 11.404717445373535
Epoch: 1, Steps: 13 | Train Loss: 0.602 Vali Loss: 0.612 Vali Acc: 0.722 Test Loss: 0.612 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 9.748265981674194
Epoch: 2, Steps: 13 | Train Loss: 0.526 Vali Loss: 0.533 Vali Acc: 0.737 Test Loss: 0.533 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 9.944896936416626
Epoch: 3, Steps: 13 | Train Loss: 0.476 Vali Loss: 0.517 Vali Acc: 0.746 Test Loss: 0.517 Test Acc: 0.746
Validation loss decreased (-0.736580 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 10.00131368637085
Epoch: 4, Steps: 13 | Train Loss: 0.382 Vali Loss: 0.522 Vali Acc: 0.732 Test Loss: 0.522 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.571272373199463
Epoch: 5, Steps: 13 | Train Loss: 0.366 Vali Loss: 0.696 Vali Acc: 0.605 Test Loss: 0.696 Test Acc: 0.605
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 9.498400688171387
Epoch: 6, Steps: 13 | Train Loss: 0.379 Vali Loss: 0.678 Vali Acc: 0.605 Test Loss: 0.678 Test Acc: 0.605
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 9.782688617706299
Epoch: 7, Steps: 13 | Train Loss: 0.243 Vali Loss: 0.679 Vali Acc: 0.688 Test Loss: 0.679 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 9.76930832862854
Epoch: 8, Steps: 13 | Train Loss: 0.282 Vali Loss: 1.104 Vali Acc: 0.468 Test Loss: 1.104 Test Acc: 0.468
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 9.752337217330933
Epoch: 9, Steps: 13 | Train Loss: 0.223 Vali Loss: 0.615 Vali Acc: 0.663 Test Loss: 0.615 Test Acc: 0.663
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 9.575445652008057
Epoch: 10, Steps: 13 | Train Loss: 0.187 Vali Loss: 0.640 Vali Acc: 0.712 Test Loss: 0.640 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 9.501867294311523
Epoch: 11, Steps: 13 | Train Loss: 0.116 Vali Loss: 0.766 Vali Acc: 0.688 Test Loss: 0.766 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 9.805042743682861
Epoch: 12, Steps: 13 | Train Loss: 0.068 Vali Loss: 1.175 Vali Acc: 0.624 Test Loss: 1.175 Test Acc: 0.624
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 9.43130350112915
Epoch: 13, Steps: 13 | Train Loss: 0.353 Vali Loss: 0.676 Vali Acc: 0.702 Test Loss: 0.676 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 9437890
model size : 37.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.237260580062866
Epoch: 1, Steps: 13 | Train Loss: 0.651 Vali Loss: 0.573 Vali Acc: 0.722 Test Loss: 0.573 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.523460865020752
Epoch: 2, Steps: 13 | Train Loss: 0.552 Vali Loss: 0.550 Vali Acc: 0.732 Test Loss: 0.550 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 4.588104724884033
Epoch: 3, Steps: 13 | Train Loss: 0.464 Vali Loss: 0.552 Vali Acc: 0.737 Test Loss: 0.552 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736580).  Saving model ...
Epoch: 4 cost time: 4.519335746765137
Epoch: 4, Steps: 13 | Train Loss: 0.419 Vali Loss: 0.525 Vali Acc: 0.761 Test Loss: 0.525 Test Acc: 0.761
Validation loss decreased (-0.736580 --> -0.760970).  Saving model ...
Epoch: 5 cost time: 4.514364957809448
Epoch: 5, Steps: 13 | Train Loss: 0.376 Vali Loss: 0.518 Vali Acc: 0.771 Test Loss: 0.518 Test Acc: 0.771
Validation loss decreased (-0.760970 --> -0.770727).  Saving model ...
Epoch: 6 cost time: 4.586060047149658
Epoch: 6, Steps: 13 | Train Loss: 0.275 Vali Loss: 0.555 Vali Acc: 0.717 Test Loss: 0.555 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.5856475830078125
Epoch: 7, Steps: 13 | Train Loss: 0.239 Vali Loss: 0.537 Vali Acc: 0.732 Test Loss: 0.537 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.599669694900513
Epoch: 8, Steps: 13 | Train Loss: 0.185 Vali Loss: 0.611 Vali Acc: 0.702 Test Loss: 0.611 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.616753578186035
Epoch: 9, Steps: 13 | Train Loss: 0.156 Vali Loss: 0.612 Vali Acc: 0.693 Test Loss: 0.612 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.528165578842163
Epoch: 10, Steps: 13 | Train Loss: 0.213 Vali Loss: 0.640 Vali Acc: 0.732 Test Loss: 0.640 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.441193342208862
Epoch: 11, Steps: 13 | Train Loss: 0.125 Vali Loss: 0.665 Vali Acc: 0.741 Test Loss: 0.665 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.525858163833618
Epoch: 12, Steps: 13 | Train Loss: 0.056 Vali Loss: 0.795 Vali Acc: 0.600 Test Loss: 0.795 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.444742918014526
Epoch: 13, Steps: 13 | Train Loss: 0.163 Vali Loss: 0.809 Vali Acc: 0.610 Test Loss: 0.809 Test Acc: 0.610
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.463016986846924
Epoch: 14, Steps: 13 | Train Loss: 0.114 Vali Loss: 0.724 Vali Acc: 0.722 Test Loss: 0.724 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.566845893859863
Epoch: 15, Steps: 13 | Train Loss: 0.041 Vali Loss: 0.836 Vali Acc: 0.732 Test Loss: 0.836 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 2817986
model size : 11.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 15.644755601882935
Epoch: 1, Steps: 13 | Train Loss: 0.619 Vali Loss: 0.561 Vali Acc: 0.732 Test Loss: 0.561 Test Acc: 0.732
Validation loss decreased (inf --> -0.731702).  Saving model ...
Epoch: 2 cost time: 13.20359492301941
Epoch: 2, Steps: 13 | Train Loss: 0.517 Vali Loss: 0.528 Vali Acc: 0.776 Test Loss: 0.528 Test Acc: 0.776
Validation loss decreased (-0.731702 --> -0.775604).  Saving model ...
Epoch: 3 cost time: 13.277520895004272
Epoch: 3, Steps: 13 | Train Loss: 0.443 Vali Loss: 0.509 Vali Acc: 0.771 Test Loss: 0.509 Test Acc: 0.771
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 13.125226259231567
Epoch: 4, Steps: 13 | Train Loss: 0.373 Vali Loss: 0.529 Vali Acc: 0.756 Test Loss: 0.529 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 13.228162050247192
Epoch: 5, Steps: 13 | Train Loss: 0.347 Vali Loss: 0.531 Vali Acc: 0.746 Test Loss: 0.531 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 12.939382314682007
Epoch: 6, Steps: 13 | Train Loss: 0.259 Vali Loss: 0.599 Vali Acc: 0.751 Test Loss: 0.599 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 13.230484962463379
Epoch: 7, Steps: 13 | Train Loss: 0.234 Vali Loss: 0.567 Vali Acc: 0.756 Test Loss: 0.567 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 13.131253719329834
Epoch: 8, Steps: 13 | Train Loss: 0.241 Vali Loss: 0.631 Vali Acc: 0.771 Test Loss: 0.631 Test Acc: 0.771
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 13.242241859436035
Epoch: 9, Steps: 13 | Train Loss: 0.169 Vali Loss: 0.631 Vali Acc: 0.732 Test Loss: 0.631 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 13.116249561309814
Epoch: 10, Steps: 13 | Train Loss: 0.157 Vali Loss: 0.722 Vali Acc: 0.620 Test Loss: 0.722 Test Acc: 0.620
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 13.419626474380493
Epoch: 11, Steps: 13 | Train Loss: 0.080 Vali Loss: 0.796 Vali Acc: 0.771 Test Loss: 0.796 Test Acc: 0.771
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 13.541768312454224
Epoch: 12, Steps: 13 | Train Loss: 0.116 Vali Loss: 0.692 Vali Acc: 0.702 Test Loss: 0.692 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 4751298
model size : 19.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.961985349655151
Epoch: 1, Steps: 13 | Train Loss: 0.651 Vali Loss: 0.561 Vali Acc: 0.727 Test Loss: 0.561 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 6.1765055656433105
Epoch: 2, Steps: 13 | Train Loss: 0.557 Vali Loss: 0.575 Vali Acc: 0.722 Test Loss: 0.575 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.263017892837524
Epoch: 3, Steps: 13 | Train Loss: 0.478 Vali Loss: 0.518 Vali Acc: 0.751 Test Loss: 0.518 Test Acc: 0.751
Validation loss decreased (-0.726824 --> -0.751214).  Saving model ...
Epoch: 4 cost time: 6.184837341308594
Epoch: 4, Steps: 13 | Train Loss: 0.390 Vali Loss: 0.538 Vali Acc: 0.717 Test Loss: 0.538 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.327174425125122
Epoch: 5, Steps: 13 | Train Loss: 0.319 Vali Loss: 0.602 Vali Acc: 0.741 Test Loss: 0.602 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.69865870475769
Epoch: 6, Steps: 13 | Train Loss: 0.333 Vali Loss: 0.739 Vali Acc: 0.741 Test Loss: 0.739 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.266027450561523
Epoch: 7, Steps: 13 | Train Loss: 0.306 Vali Loss: 0.853 Vali Acc: 0.741 Test Loss: 0.853 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 6.1970930099487305
Epoch: 8, Steps: 13 | Train Loss: 0.246 Vali Loss: 0.596 Vali Acc: 0.741 Test Loss: 0.596 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 6.189810514450073
Epoch: 9, Steps: 13 | Train Loss: 0.177 Vali Loss: 0.650 Vali Acc: 0.688 Test Loss: 0.650 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 6.133677005767822
Epoch: 10, Steps: 13 | Train Loss: 0.161 Vali Loss: 0.701 Vali Acc: 0.659 Test Loss: 0.701 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 6.162440299987793
Epoch: 11, Steps: 13 | Train Loss: 0.103 Vali Loss: 0.686 Vali Acc: 0.673 Test Loss: 0.686 Test Acc: 0.673
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 6.1623146533966064
Epoch: 12, Steps: 13 | Train Loss: 0.091 Vali Loss: 0.681 Vali Acc: 0.732 Test Loss: 0.681 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 6.165752649307251
Epoch: 13, Steps: 13 | Train Loss: 0.121 Vali Loss: 1.060 Vali Acc: 0.746 Test Loss: 1.060 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 1441218
model size : 6.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 12.6044762134552
Epoch: 1, Steps: 13 | Train Loss: 0.618 Vali Loss: 0.564 Vali Acc: 0.727 Test Loss: 0.564 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 10.625073432922363
Epoch: 2, Steps: 13 | Train Loss: 0.523 Vali Loss: 0.533 Vali Acc: 0.766 Test Loss: 0.533 Test Acc: 0.766
Validation loss decreased (-0.726824 --> -0.765848).  Saving model ...
Epoch: 3 cost time: 10.600735664367676
Epoch: 3, Steps: 13 | Train Loss: 0.450 Vali Loss: 0.514 Vali Acc: 0.756 Test Loss: 0.514 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 10.658581733703613
Epoch: 4, Steps: 13 | Train Loss: 0.374 Vali Loss: 0.597 Vali Acc: 0.737 Test Loss: 0.597 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 10.496740341186523
Epoch: 5, Steps: 13 | Train Loss: 0.344 Vali Loss: 0.522 Vali Acc: 0.766 Test Loss: 0.522 Test Acc: 0.766
Validation loss decreased (-0.765848 --> -0.765848).  Saving model ...
Epoch: 6 cost time: 10.49438762664795
Epoch: 6, Steps: 13 | Train Loss: 0.261 Vali Loss: 0.541 Vali Acc: 0.761 Test Loss: 0.541 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.64076042175293
Epoch: 7, Steps: 13 | Train Loss: 0.223 Vali Loss: 0.552 Vali Acc: 0.693 Test Loss: 0.552 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 10.693154335021973
Epoch: 8, Steps: 13 | Train Loss: 0.207 Vali Loss: 0.592 Vali Acc: 0.702 Test Loss: 0.592 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 10.696315288543701
Epoch: 9, Steps: 13 | Train Loss: 0.187 Vali Loss: 0.612 Vali Acc: 0.707 Test Loss: 0.612 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 10.556961297988892
Epoch: 10, Steps: 13 | Train Loss: 0.129 Vali Loss: 0.682 Vali Acc: 0.644 Test Loss: 0.682 Test Acc: 0.644
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 10.487759351730347
Epoch: 11, Steps: 13 | Train Loss: 0.077 Vali Loss: 0.769 Vali Acc: 0.751 Test Loss: 0.769 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 10.548974752426147
Epoch: 12, Steps: 13 | Train Loss: 0.134 Vali Loss: 0.660 Vali Acc: 0.717 Test Loss: 0.660 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 10.641035556793213
Epoch: 13, Steps: 13 | Train Loss: 0.107 Vali Loss: 0.798 Vali Acc: 0.634 Test Loss: 0.798 Test Acc: 0.634
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 10.49511456489563
Epoch: 14, Steps: 13 | Train Loss: 0.045 Vali Loss: 0.918 Vali Acc: 0.595 Test Loss: 0.918 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 10.578857660293579
Epoch: 15, Steps: 13 | Train Loss: 0.026 Vali Loss: 0.801 Vali Acc: 0.717 Test Loss: 0.801 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 4751298
model size : 19.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.776775360107422
Epoch: 1, Steps: 13 | Train Loss: 0.652 Vali Loss: 0.563 Vali Acc: 0.727 Test Loss: 0.563 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 5.135757923126221
Epoch: 2, Steps: 13 | Train Loss: 0.563 Vali Loss: 0.574 Vali Acc: 0.717 Test Loss: 0.574 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.175592660903931
Epoch: 3, Steps: 13 | Train Loss: 0.483 Vali Loss: 0.521 Vali Acc: 0.746 Test Loss: 0.521 Test Acc: 0.746
Validation loss decreased (-0.726824 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 5.163315057754517
Epoch: 4, Steps: 13 | Train Loss: 0.390 Vali Loss: 0.545 Vali Acc: 0.688 Test Loss: 0.545 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.152356386184692
Epoch: 5, Steps: 13 | Train Loss: 0.332 Vali Loss: 0.567 Vali Acc: 0.741 Test Loss: 0.567 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.192137718200684
Epoch: 6, Steps: 13 | Train Loss: 0.311 Vali Loss: 0.615 Vali Acc: 0.756 Test Loss: 0.615 Test Acc: 0.756
Validation loss decreased (-0.746336 --> -0.756091).  Saving model ...
Epoch: 7 cost time: 5.187923431396484
Epoch: 7, Steps: 13 | Train Loss: 0.246 Vali Loss: 0.562 Vali Acc: 0.776 Test Loss: 0.562 Test Acc: 0.776
Validation loss decreased (-0.756091 --> -0.775604).  Saving model ...
Epoch: 8 cost time: 5.151365756988525
Epoch: 8, Steps: 13 | Train Loss: 0.233 Vali Loss: 0.568 Vali Acc: 0.698 Test Loss: 0.568 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.1965110301971436
Epoch: 9, Steps: 13 | Train Loss: 0.137 Vali Loss: 0.575 Vali Acc: 0.702 Test Loss: 0.575 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.096086263656616
Epoch: 10, Steps: 13 | Train Loss: 0.122 Vali Loss: 0.603 Vali Acc: 0.693 Test Loss: 0.603 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.085824012756348
Epoch: 11, Steps: 13 | Train Loss: 0.080 Vali Loss: 0.635 Vali Acc: 0.717 Test Loss: 0.635 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.192000389099121
Epoch: 12, Steps: 13 | Train Loss: 0.057 Vali Loss: 0.689 Vali Acc: 0.722 Test Loss: 0.689 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.162667512893677
Epoch: 13, Steps: 13 | Train Loss: 0.169 Vali Loss: 1.050 Vali Acc: 0.746 Test Loss: 1.050 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.060903310775757
Epoch: 14, Steps: 13 | Train Loss: 0.063 Vali Loss: 0.798 Vali Acc: 0.668 Test Loss: 0.798 Test Acc: 0.668
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.044445276260376
Epoch: 15, Steps: 13 | Train Loss: 0.037 Vali Loss: 0.778 Vali Acc: 0.727 Test Loss: 0.778 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.049971342086792
Epoch: 16, Steps: 13 | Train Loss: 0.064 Vali Loss: 0.898 Vali Acc: 0.761 Test Loss: 0.898 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.1381611824035645
Epoch: 17, Steps: 13 | Train Loss: 0.054 Vali Loss: 0.788 Vali Acc: 0.698 Test Loss: 0.788 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 1441218
model size : 6.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.343340635299683
Epoch: 1, Steps: 13 | Train Loss: 0.619 Vali Loss: 0.562 Vali Acc: 0.727 Test Loss: 0.562 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 6.658467531204224
Epoch: 2, Steps: 13 | Train Loss: 0.524 Vali Loss: 0.534 Vali Acc: 0.766 Test Loss: 0.534 Test Acc: 0.766
Validation loss decreased (-0.726824 --> -0.765848).  Saving model ...
Epoch: 3 cost time: 6.666001558303833
Epoch: 3, Steps: 13 | Train Loss: 0.448 Vali Loss: 0.518 Vali Acc: 0.751 Test Loss: 0.518 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.5460169315338135
Epoch: 4, Steps: 13 | Train Loss: 0.378 Vali Loss: 0.618 Vali Acc: 0.732 Test Loss: 0.618 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.655925273895264
Epoch: 5, Steps: 13 | Train Loss: 0.354 Vali Loss: 0.523 Vali Acc: 0.771 Test Loss: 0.523 Test Acc: 0.771
Validation loss decreased (-0.765848 --> -0.770726).  Saving model ...
Epoch: 6 cost time: 6.541108846664429
Epoch: 6, Steps: 13 | Train Loss: 0.279 Vali Loss: 0.598 Vali Acc: 0.756 Test Loss: 0.598 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.532276391983032
Epoch: 7, Steps: 13 | Train Loss: 0.245 Vali Loss: 0.557 Vali Acc: 0.737 Test Loss: 0.557 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.534035921096802
Epoch: 8, Steps: 13 | Train Loss: 0.259 Vali Loss: 0.569 Vali Acc: 0.712 Test Loss: 0.569 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.5117998123168945
Epoch: 9, Steps: 13 | Train Loss: 0.177 Vali Loss: 0.597 Vali Acc: 0.712 Test Loss: 0.597 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.551199913024902
Epoch: 10, Steps: 13 | Train Loss: 0.124 Vali Loss: 0.616 Vali Acc: 0.698 Test Loss: 0.616 Test Acc: 0.698
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 6.397616863250732
Epoch: 11, Steps: 13 | Train Loss: 0.125 Vali Loss: 0.726 Vali Acc: 0.663 Test Loss: 0.726 Test Acc: 0.663
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 6.391959190368652
Epoch: 12, Steps: 13 | Train Loss: 0.111 Vali Loss: 0.756 Vali Acc: 0.756 Test Loss: 0.756 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 6.458772659301758
Epoch: 13, Steps: 13 | Train Loss: 0.084 Vali Loss: 0.804 Vali Acc: 0.756 Test Loss: 0.804 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 6.637309312820435
Epoch: 14, Steps: 13 | Train Loss: 0.067 Vali Loss: 0.738 Vali Acc: 0.732 Test Loss: 0.738 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 6.311499118804932
Epoch: 15, Steps: 13 | Train Loss: 0.050 Vali Loss: 0.792 Vali Acc: 0.722 Test Loss: 0.792 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 4751298
model size : 19.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.944526672363281
Epoch: 1, Steps: 13 | Train Loss: 0.654 Vali Loss: 0.566 Vali Acc: 0.722 Test Loss: 0.566 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 3.3446850776672363
Epoch: 2, Steps: 13 | Train Loss: 0.566 Vali Loss: 0.576 Vali Acc: 0.717 Test Loss: 0.576 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.3420238494873047
Epoch: 3, Steps: 13 | Train Loss: 0.487 Vali Loss: 0.523 Vali Acc: 0.751 Test Loss: 0.523 Test Acc: 0.751
Validation loss decreased (-0.721946 --> -0.751214).  Saving model ...
Epoch: 4 cost time: 3.328984022140503
Epoch: 4, Steps: 13 | Train Loss: 0.390 Vali Loss: 0.559 Vali Acc: 0.683 Test Loss: 0.559 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.345795154571533
Epoch: 5, Steps: 13 | Train Loss: 0.329 Vali Loss: 0.595 Vali Acc: 0.746 Test Loss: 0.595 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.4277000427246094
Epoch: 6, Steps: 13 | Train Loss: 0.327 Vali Loss: 0.676 Vali Acc: 0.746 Test Loss: 0.676 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.3535358905792236
Epoch: 7, Steps: 13 | Train Loss: 0.290 Vali Loss: 0.706 Vali Acc: 0.746 Test Loss: 0.706 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.388493299484253
Epoch: 8, Steps: 13 | Train Loss: 0.263 Vali Loss: 0.579 Vali Acc: 0.756 Test Loss: 0.579 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756092).  Saving model ...
Epoch: 9 cost time: 3.3716235160827637
Epoch: 9, Steps: 13 | Train Loss: 0.297 Vali Loss: 0.795 Vali Acc: 0.751 Test Loss: 0.795 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.433154821395874
Epoch: 10, Steps: 13 | Train Loss: 0.262 Vali Loss: 0.657 Vali Acc: 0.761 Test Loss: 0.657 Test Acc: 0.761
Validation loss decreased (-0.756092 --> -0.760969).  Saving model ...
Epoch: 11 cost time: 3.343086004257202
Epoch: 11, Steps: 13 | Train Loss: 0.259 Vali Loss: 0.675 Vali Acc: 0.629 Test Loss: 0.675 Test Acc: 0.629
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.370079755783081
Epoch: 12, Steps: 13 | Train Loss: 0.154 Vali Loss: 1.024 Vali Acc: 0.527 Test Loss: 1.024 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.3803210258483887
Epoch: 13, Steps: 13 | Train Loss: 0.109 Vali Loss: 0.667 Vali Acc: 0.722 Test Loss: 0.667 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.351506233215332
Epoch: 14, Steps: 13 | Train Loss: 0.051 Vali Loss: 0.770 Vali Acc: 0.634 Test Loss: 0.770 Test Acc: 0.634
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.396193742752075
Epoch: 15, Steps: 13 | Train Loss: 0.037 Vali Loss: 0.821 Vali Acc: 0.751 Test Loss: 0.821 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.400967836380005
Epoch: 16, Steps: 13 | Train Loss: 0.053 Vali Loss: 0.787 Vali Acc: 0.712 Test Loss: 0.787 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.4647514820098877
Epoch: 17, Steps: 13 | Train Loss: 0.033 Vali Loss: 0.943 Vali Acc: 0.605 Test Loss: 0.943 Test Acc: 0.605
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.4758269786834717
Epoch: 18, Steps: 13 | Train Loss: 0.024 Vali Loss: 0.800 Vali Acc: 0.707 Test Loss: 0.800 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.4565486907958984
Epoch: 19, Steps: 13 | Train Loss: 0.028 Vali Loss: 0.828 Vali Acc: 0.698 Test Loss: 0.828 Test Acc: 0.698
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.4381768703460693
Epoch: 20, Steps: 13 | Train Loss: 0.032 Vali Loss: 0.926 Vali Acc: 0.732 Test Loss: 0.926 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 1441218
model size : 6.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 19.77796697616577
Epoch: 1, Steps: 13 | Train Loss: 0.663 Vali Loss: 0.601 Vali Acc: 0.722 Test Loss: 0.601 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 17.42893648147583
Epoch: 2, Steps: 13 | Train Loss: 0.550 Vali Loss: 0.544 Vali Acc: 0.732 Test Loss: 0.544 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 17.656944036483765
Epoch: 3, Steps: 13 | Train Loss: 0.517 Vali Loss: 0.584 Vali Acc: 0.702 Test Loss: 0.584 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 17.705936431884766
Epoch: 4, Steps: 13 | Train Loss: 0.485 Vali Loss: 0.514 Vali Acc: 0.732 Test Loss: 0.514 Test Acc: 0.732
Validation loss decreased (-0.731702 --> -0.731702).  Saving model ...
Epoch: 5 cost time: 17.783262014389038
Epoch: 5, Steps: 13 | Train Loss: 0.445 Vali Loss: 0.536 Vali Acc: 0.737 Test Loss: 0.536 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736580).  Saving model ...
Epoch: 6 cost time: 17.548542022705078
Epoch: 6, Steps: 13 | Train Loss: 0.388 Vali Loss: 0.539 Vali Acc: 0.751 Test Loss: 0.539 Test Acc: 0.751
Validation loss decreased (-0.736580 --> -0.751214).  Saving model ...
Epoch: 7 cost time: 17.290229082107544
Epoch: 7, Steps: 13 | Train Loss: 0.358 Vali Loss: 0.544 Vali Acc: 0.776 Test Loss: 0.544 Test Acc: 0.776
Validation loss decreased (-0.751214 --> -0.775604).  Saving model ...
Epoch: 8 cost time: 17.80137014389038
Epoch: 8, Steps: 13 | Train Loss: 0.278 Vali Loss: 0.613 Vali Acc: 0.737 Test Loss: 0.613 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 17.688990831375122
Epoch: 9, Steps: 13 | Train Loss: 0.250 Vali Loss: 0.536 Vali Acc: 0.751 Test Loss: 0.536 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 17.972289323806763
Epoch: 10, Steps: 13 | Train Loss: 0.232 Vali Loss: 0.603 Vali Acc: 0.654 Test Loss: 0.603 Test Acc: 0.654
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 17.61337113380432
Epoch: 11, Steps: 13 | Train Loss: 0.192 Vali Loss: 0.978 Vali Acc: 0.463 Test Loss: 0.978 Test Acc: 0.463
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 17.66677689552307
Epoch: 12, Steps: 13 | Train Loss: 0.219 Vali Loss: 0.603 Vali Acc: 0.712 Test Loss: 0.603 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 17.755935192108154
Epoch: 13, Steps: 13 | Train Loss: 0.155 Vali Loss: 0.615 Vali Acc: 0.683 Test Loss: 0.615 Test Acc: 0.683
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 17.511682510375977
Epoch: 14, Steps: 13 | Train Loss: 0.131 Vali Loss: 0.641 Vali Acc: 0.761 Test Loss: 0.641 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 17.413713693618774
Epoch: 15, Steps: 13 | Train Loss: 0.088 Vali Loss: 0.627 Vali Acc: 0.746 Test Loss: 0.627 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 17.19519829750061
Epoch: 16, Steps: 13 | Train Loss: 0.077 Vali Loss: 0.668 Vali Acc: 0.717 Test Loss: 0.668 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 16.80237078666687
Epoch: 17, Steps: 13 | Train Loss: 0.067 Vali Loss: 0.668 Vali Acc: 0.688 Test Loss: 0.668 Test Acc: 0.688
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 4719714
model size : 18.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 11.708492994308472
Epoch: 1, Steps: 13 | Train Loss: 0.700 Vali Loss: 0.599 Vali Acc: 0.712 Test Loss: 0.599 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 9.439991474151611
Epoch: 2, Steps: 13 | Train Loss: 0.555 Vali Loss: 0.573 Vali Acc: 0.737 Test Loss: 0.573 Test Acc: 0.737
Validation loss decreased (-0.712189 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 9.344970703125
Epoch: 3, Steps: 13 | Train Loss: 0.521 Vali Loss: 0.528 Vali Acc: 0.761 Test Loss: 0.528 Test Acc: 0.761
Validation loss decreased (-0.736580 --> -0.760970).  Saving model ...
Epoch: 4 cost time: 9.26716136932373
Epoch: 4, Steps: 13 | Train Loss: 0.435 Vali Loss: 0.507 Vali Acc: 0.751 Test Loss: 0.507 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.139479637145996
Epoch: 5, Steps: 13 | Train Loss: 0.397 Vali Loss: 0.561 Vali Acc: 0.712 Test Loss: 0.561 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 9.43579649925232
Epoch: 6, Steps: 13 | Train Loss: 0.384 Vali Loss: 0.516 Vali Acc: 0.737 Test Loss: 0.516 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 9.233765125274658
Epoch: 7, Steps: 13 | Train Loss: 0.309 Vali Loss: 0.628 Vali Acc: 0.751 Test Loss: 0.628 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 9.424093008041382
Epoch: 8, Steps: 13 | Train Loss: 0.276 Vali Loss: 0.572 Vali Acc: 0.741 Test Loss: 0.572 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 9.489293336868286
Epoch: 9, Steps: 13 | Train Loss: 0.291 Vali Loss: 0.544 Vali Acc: 0.780 Test Loss: 0.544 Test Acc: 0.780
Validation loss decreased (-0.760970 --> -0.780482).  Saving model ...
Epoch: 10 cost time: 9.343019962310791
Epoch: 10, Steps: 13 | Train Loss: 0.235 Vali Loss: 0.566 Vali Acc: 0.776 Test Loss: 0.566 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 9.218396663665771
Epoch: 11, Steps: 13 | Train Loss: 0.192 Vali Loss: 0.568 Vali Acc: 0.761 Test Loss: 0.568 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 9.20449948310852
Epoch: 12, Steps: 13 | Train Loss: 0.167 Vali Loss: 0.571 Vali Acc: 0.741 Test Loss: 0.571 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 9.305630445480347
Epoch: 13, Steps: 13 | Train Loss: 0.138 Vali Loss: 0.632 Vali Acc: 0.761 Test Loss: 0.632 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 9.258986473083496
Epoch: 14, Steps: 13 | Train Loss: 0.104 Vali Loss: 0.621 Vali Acc: 0.756 Test Loss: 0.621 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 9.372479915618896
Epoch: 15, Steps: 13 | Train Loss: 0.088 Vali Loss: 0.663 Vali Acc: 0.702 Test Loss: 0.663 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 9.105504751205444
Epoch: 16, Steps: 13 | Train Loss: 0.083 Vali Loss: 0.636 Vali Acc: 0.717 Test Loss: 0.636 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 9.18709659576416
Epoch: 17, Steps: 13 | Train Loss: 0.069 Vali Loss: 0.780 Vali Acc: 0.766 Test Loss: 0.780 Test Acc: 0.766
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 9.46404480934143
Epoch: 18, Steps: 13 | Train Loss: 0.091 Vali Loss: 0.690 Vali Acc: 0.751 Test Loss: 0.690 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 9.56460452079773
Epoch: 19, Steps: 13 | Train Loss: 0.042 Vali Loss: 0.672 Vali Acc: 0.727 Test Loss: 0.672 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7804878048780488
model parameter : 1409506
model size : 6.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 12.860225915908813
Epoch: 1, Steps: 13 | Train Loss: 0.663 Vali Loss: 0.600 Vali Acc: 0.722 Test Loss: 0.600 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 10.699419260025024
Epoch: 2, Steps: 13 | Train Loss: 0.553 Vali Loss: 0.542 Vali Acc: 0.746 Test Loss: 0.542 Test Acc: 0.746
Validation loss decreased (-0.721945 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 10.756870985031128
Epoch: 3, Steps: 13 | Train Loss: 0.532 Vali Loss: 0.615 Vali Acc: 0.634 Test Loss: 0.615 Test Acc: 0.634
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 10.09424638748169
Epoch: 4, Steps: 13 | Train Loss: 0.512 Vali Loss: 0.515 Vali Acc: 0.737 Test Loss: 0.515 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 10.693228483200073
Epoch: 5, Steps: 13 | Train Loss: 0.462 Vali Loss: 0.550 Vali Acc: 0.737 Test Loss: 0.550 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 10.737316608428955
Epoch: 6, Steps: 13 | Train Loss: 0.410 Vali Loss: 0.546 Vali Acc: 0.766 Test Loss: 0.546 Test Acc: 0.766
Validation loss decreased (-0.746336 --> -0.765848).  Saving model ...
Epoch: 7 cost time: 10.771761417388916
Epoch: 7, Steps: 13 | Train Loss: 0.349 Vali Loss: 0.527 Vali Acc: 0.780 Test Loss: 0.527 Test Acc: 0.780
Validation loss decreased (-0.765848 --> -0.780483).  Saving model ...
Epoch: 8 cost time: 10.715512990951538
Epoch: 8, Steps: 13 | Train Loss: 0.286 Vali Loss: 0.553 Vali Acc: 0.766 Test Loss: 0.553 Test Acc: 0.766
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 10.720844030380249
Epoch: 9, Steps: 13 | Train Loss: 0.243 Vali Loss: 0.528 Vali Acc: 0.766 Test Loss: 0.528 Test Acc: 0.766
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 10.761250972747803
Epoch: 10, Steps: 13 | Train Loss: 0.247 Vali Loss: 0.570 Vali Acc: 0.678 Test Loss: 0.570 Test Acc: 0.678
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 10.965696096420288
Epoch: 11, Steps: 13 | Train Loss: 0.186 Vali Loss: 0.933 Vali Acc: 0.502 Test Loss: 0.933 Test Acc: 0.502
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 10.982773303985596
Epoch: 12, Steps: 13 | Train Loss: 0.213 Vali Loss: 0.558 Vali Acc: 0.717 Test Loss: 0.558 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 11.04211139678955
Epoch: 13, Steps: 13 | Train Loss: 0.137 Vali Loss: 0.565 Vali Acc: 0.702 Test Loss: 0.565 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 11.16201376914978
Epoch: 14, Steps: 13 | Train Loss: 0.123 Vali Loss: 0.606 Vali Acc: 0.732 Test Loss: 0.606 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 10.905199766159058
Epoch: 15, Steps: 13 | Train Loss: 0.088 Vali Loss: 0.739 Vali Acc: 0.751 Test Loss: 0.739 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 10.934429168701172
Epoch: 16, Steps: 13 | Train Loss: 0.067 Vali Loss: 0.736 Vali Acc: 0.698 Test Loss: 0.736 Test Acc: 0.698
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 11.17274808883667
Epoch: 17, Steps: 13 | Train Loss: 0.090 Vali Loss: 0.676 Vali Acc: 0.702 Test Loss: 0.676 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7804878048780488
model parameter : 4719714
model size : 18.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.4968671798706055
Epoch: 1, Steps: 13 | Train Loss: 0.701 Vali Loss: 0.598 Vali Acc: 0.712 Test Loss: 0.598 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 5.547574281692505
Epoch: 2, Steps: 13 | Train Loss: 0.552 Vali Loss: 0.578 Vali Acc: 0.727 Test Loss: 0.578 Test Acc: 0.727
Validation loss decreased (-0.712189 --> -0.726823).  Saving model ...
Epoch: 3 cost time: 5.61368203163147
Epoch: 3, Steps: 13 | Train Loss: 0.519 Vali Loss: 0.535 Vali Acc: 0.741 Test Loss: 0.535 Test Acc: 0.741
Validation loss decreased (-0.726823 --> -0.741458).  Saving model ...
Epoch: 4 cost time: 5.410180330276489
Epoch: 4, Steps: 13 | Train Loss: 0.442 Vali Loss: 0.513 Vali Acc: 0.751 Test Loss: 0.513 Test Acc: 0.751
Validation loss decreased (-0.741458 --> -0.751214).  Saving model ...
Epoch: 5 cost time: 5.615323781967163
Epoch: 5, Steps: 13 | Train Loss: 0.416 Vali Loss: 0.527 Vali Acc: 0.732 Test Loss: 0.527 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.694770812988281
Epoch: 6, Steps: 13 | Train Loss: 0.396 Vali Loss: 0.509 Vali Acc: 0.751 Test Loss: 0.509 Test Acc: 0.751
Validation loss decreased (-0.751214 --> -0.751214).  Saving model ...
Epoch: 7 cost time: 5.571612119674683
Epoch: 7, Steps: 13 | Train Loss: 0.320 Vali Loss: 0.525 Vali Acc: 0.761 Test Loss: 0.525 Test Acc: 0.761
Validation loss decreased (-0.751214 --> -0.760970).  Saving model ...
Epoch: 8 cost time: 5.713859558105469
Epoch: 8, Steps: 13 | Train Loss: 0.268 Vali Loss: 0.532 Vali Acc: 0.732 Test Loss: 0.532 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.732420206069946
Epoch: 9, Steps: 13 | Train Loss: 0.273 Vali Loss: 0.554 Vali Acc: 0.766 Test Loss: 0.554 Test Acc: 0.766
Validation loss decreased (-0.760970 --> -0.765848).  Saving model ...
Epoch: 10 cost time: 5.675503730773926
Epoch: 10, Steps: 13 | Train Loss: 0.246 Vali Loss: 0.553 Vali Acc: 0.776 Test Loss: 0.553 Test Acc: 0.776
Validation loss decreased (-0.765848 --> -0.775604).  Saving model ...
Epoch: 11 cost time: 5.662172555923462
Epoch: 11, Steps: 13 | Train Loss: 0.199 Vali Loss: 0.553 Vali Acc: 0.766 Test Loss: 0.553 Test Acc: 0.766
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.883577585220337
Epoch: 12, Steps: 13 | Train Loss: 0.157 Vali Loss: 0.557 Vali Acc: 0.751 Test Loss: 0.557 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.646099090576172
Epoch: 13, Steps: 13 | Train Loss: 0.143 Vali Loss: 0.682 Vali Acc: 0.771 Test Loss: 0.682 Test Acc: 0.771
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.740107774734497
Epoch: 14, Steps: 13 | Train Loss: 0.114 Vali Loss: 0.653 Vali Acc: 0.751 Test Loss: 0.653 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.549142599105835
Epoch: 15, Steps: 13 | Train Loss: 0.167 Vali Loss: 0.657 Vali Acc: 0.673 Test Loss: 0.657 Test Acc: 0.673
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.674867153167725
Epoch: 16, Steps: 13 | Train Loss: 0.092 Vali Loss: 0.623 Vali Acc: 0.732 Test Loss: 0.623 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 5.753960847854614
Epoch: 17, Steps: 13 | Train Loss: 0.066 Vali Loss: 0.769 Vali Acc: 0.776 Test Loss: 0.769 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 5.882824182510376
Epoch: 18, Steps: 13 | Train Loss: 0.077 Vali Loss: 0.721 Vali Acc: 0.741 Test Loss: 0.721 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 5.801376104354858
Epoch: 19, Steps: 13 | Train Loss: 0.043 Vali Loss: 0.701 Vali Acc: 0.698 Test Loss: 0.701 Test Acc: 0.698
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 5.987355709075928
Epoch: 20, Steps: 13 | Train Loss: 0.038 Vali Loss: 0.770 Vali Acc: 0.663 Test Loss: 0.770 Test Acc: 0.663
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 1409506
model size : 6.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.664107322692871
Epoch: 1, Steps: 13 | Train Loss: 0.664 Vali Loss: 0.602 Vali Acc: 0.722 Test Loss: 0.602 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 6.955926418304443
Epoch: 2, Steps: 13 | Train Loss: 0.556 Vali Loss: 0.544 Vali Acc: 0.746 Test Loss: 0.544 Test Acc: 0.746
Validation loss decreased (-0.721945 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 7.118271112442017
Epoch: 3, Steps: 13 | Train Loss: 0.538 Vali Loss: 0.615 Vali Acc: 0.649 Test Loss: 0.615 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.877991199493408
Epoch: 4, Steps: 13 | Train Loss: 0.511 Vali Loss: 0.520 Vali Acc: 0.727 Test Loss: 0.520 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.854131460189819
Epoch: 5, Steps: 13 | Train Loss: 0.466 Vali Loss: 0.551 Vali Acc: 0.732 Test Loss: 0.551 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.846093654632568
Epoch: 6, Steps: 13 | Train Loss: 0.417 Vali Loss: 0.558 Vali Acc: 0.751 Test Loss: 0.558 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751214).  Saving model ...
Epoch: 7 cost time: 6.8346757888793945
Epoch: 7, Steps: 13 | Train Loss: 0.352 Vali Loss: 0.540 Vali Acc: 0.766 Test Loss: 0.540 Test Acc: 0.766
Validation loss decreased (-0.751214 --> -0.765848).  Saving model ...
Epoch: 8 cost time: 6.890496730804443
Epoch: 8, Steps: 13 | Train Loss: 0.285 Vali Loss: 0.595 Vali Acc: 0.741 Test Loss: 0.595 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.905938625335693
Epoch: 9, Steps: 13 | Train Loss: 0.255 Vali Loss: 0.534 Vali Acc: 0.771 Test Loss: 0.534 Test Acc: 0.771
Validation loss decreased (-0.765848 --> -0.770726).  Saving model ...
Epoch: 10 cost time: 6.981947183609009
Epoch: 10, Steps: 13 | Train Loss: 0.266 Vali Loss: 0.903 Vali Acc: 0.512 Test Loss: 0.903 Test Acc: 0.512
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.898017168045044
Epoch: 11, Steps: 13 | Train Loss: 0.233 Vali Loss: 0.721 Vali Acc: 0.576 Test Loss: 0.721 Test Acc: 0.576
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.772001028060913
Epoch: 12, Steps: 13 | Train Loss: 0.575 Vali Loss: 0.593 Vali Acc: 0.702 Test Loss: 0.593 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.870743274688721
Epoch: 13, Steps: 13 | Train Loss: 0.200 Vali Loss: 0.581 Vali Acc: 0.707 Test Loss: 0.581 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.754902362823486
Epoch: 14, Steps: 13 | Train Loss: 0.205 Vali Loss: 0.616 Vali Acc: 0.683 Test Loss: 0.616 Test Acc: 0.683
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.758307695388794
Epoch: 15, Steps: 13 | Train Loss: 0.143 Vali Loss: 0.621 Vali Acc: 0.712 Test Loss: 0.621 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.10704493522644
Epoch: 16, Steps: 13 | Train Loss: 0.242 Vali Loss: 1.149 Vali Acc: 0.488 Test Loss: 1.149 Test Acc: 0.488
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 6.862494230270386
Epoch: 17, Steps: 13 | Train Loss: 0.159 Vali Loss: 0.954 Vali Acc: 0.546 Test Loss: 0.954 Test Acc: 0.546
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 6.771480321884155
Epoch: 18, Steps: 13 | Train Loss: 0.105 Vali Loss: 0.789 Vali Acc: 0.615 Test Loss: 0.789 Test Acc: 0.615
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 6.9094038009643555
Epoch: 19, Steps: 13 | Train Loss: 0.130 Vali Loss: 0.738 Vali Acc: 0.668 Test Loss: 0.738 Test Acc: 0.668
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 4719714
model size : 18.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.504764080047607
Epoch: 1, Steps: 13 | Train Loss: 0.701 Vali Loss: 0.599 Vali Acc: 0.707 Test Loss: 0.599 Test Acc: 0.707
Validation loss decreased (inf --> -0.707311).  Saving model ...
Epoch: 2 cost time: 3.803687572479248
Epoch: 2, Steps: 13 | Train Loss: 0.558 Vali Loss: 0.583 Vali Acc: 0.727 Test Loss: 0.583 Test Acc: 0.727
Validation loss decreased (-0.707311 --> -0.726823).  Saving model ...
Epoch: 3 cost time: 3.807861328125
Epoch: 3, Steps: 13 | Train Loss: 0.519 Vali Loss: 0.534 Vali Acc: 0.751 Test Loss: 0.534 Test Acc: 0.751
Validation loss decreased (-0.726823 --> -0.751214).  Saving model ...
Epoch: 4 cost time: 3.812990188598633
Epoch: 4, Steps: 13 | Train Loss: 0.437 Vali Loss: 0.513 Vali Acc: 0.761 Test Loss: 0.513 Test Acc: 0.761
Validation loss decreased (-0.751214 --> -0.760970).  Saving model ...
Epoch: 5 cost time: 3.8297197818756104
Epoch: 5, Steps: 13 | Train Loss: 0.418 Vali Loss: 0.526 Vali Acc: 0.732 Test Loss: 0.526 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.828015089035034
Epoch: 6, Steps: 13 | Train Loss: 0.393 Vali Loss: 0.507 Vali Acc: 0.766 Test Loss: 0.507 Test Acc: 0.766
Validation loss decreased (-0.760970 --> -0.765849).  Saving model ...
Epoch: 7 cost time: 3.883727788925171
Epoch: 7, Steps: 13 | Train Loss: 0.348 Vali Loss: 0.512 Vali Acc: 0.766 Test Loss: 0.512 Test Acc: 0.766
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.8373405933380127
Epoch: 8, Steps: 13 | Train Loss: 0.290 Vali Loss: 0.545 Vali Acc: 0.751 Test Loss: 0.545 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.8189280033111572
Epoch: 9, Steps: 13 | Train Loss: 0.306 Vali Loss: 0.531 Vali Acc: 0.756 Test Loss: 0.531 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.9261457920074463
Epoch: 10, Steps: 13 | Train Loss: 0.249 Vali Loss: 0.565 Vali Acc: 0.771 Test Loss: 0.565 Test Acc: 0.771
Validation loss decreased (-0.765849 --> -0.770726).  Saving model ...
Epoch: 11 cost time: 3.8000869750976562
Epoch: 11, Steps: 13 | Train Loss: 0.251 Vali Loss: 0.617 Vali Acc: 0.751 Test Loss: 0.617 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.808039426803589
Epoch: 12, Steps: 13 | Train Loss: 0.202 Vali Loss: 0.569 Vali Acc: 0.746 Test Loss: 0.569 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.853942394256592
Epoch: 13, Steps: 13 | Train Loss: 0.173 Vali Loss: 1.007 Vali Acc: 0.727 Test Loss: 1.007 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.8349623680114746
Epoch: 14, Steps: 13 | Train Loss: 0.220 Vali Loss: 0.602 Vali Acc: 0.737 Test Loss: 0.602 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.801640033721924
Epoch: 15, Steps: 13 | Train Loss: 0.186 Vali Loss: 0.622 Vali Acc: 0.727 Test Loss: 0.622 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.8706202507019043
Epoch: 16, Steps: 13 | Train Loss: 0.101 Vali Loss: 0.636 Vali Acc: 0.741 Test Loss: 0.636 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.9015231132507324
Epoch: 17, Steps: 13 | Train Loss: 0.072 Vali Loss: 0.725 Vali Acc: 0.756 Test Loss: 0.725 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.7934672832489014
Epoch: 18, Steps: 13 | Train Loss: 0.110 Vali Loss: 0.831 Vali Acc: 0.756 Test Loss: 0.831 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.863703727722168
Epoch: 19, Steps: 13 | Train Loss: 0.061 Vali Loss: 0.707 Vali Acc: 0.717 Test Loss: 0.707 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.8199005126953125
Epoch: 20, Steps: 13 | Train Loss: 0.059 Vali Loss: 0.762 Vali Acc: 0.654 Test Loss: 0.762 Test Acc: 0.654
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 1409506
model size : 6.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 12.00424861907959
Epoch: 1, Steps: 13 | Train Loss: 0.572 Vali Loss: 0.594 Vali Acc: 0.722 Test Loss: 0.594 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 10.070800542831421
Epoch: 2, Steps: 13 | Train Loss: 0.561 Vali Loss: 0.547 Vali Acc: 0.746 Test Loss: 0.547 Test Acc: 0.746
Validation loss decreased (-0.721945 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 10.117194652557373
Epoch: 3, Steps: 13 | Train Loss: 0.503 Vali Loss: 0.570 Vali Acc: 0.727 Test Loss: 0.570 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 10.15844178199768
Epoch: 4, Steps: 13 | Train Loss: 0.462 Vali Loss: 0.535 Vali Acc: 0.741 Test Loss: 0.535 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 10.057061910629272
Epoch: 5, Steps: 13 | Train Loss: 0.418 Vali Loss: 0.557 Vali Acc: 0.732 Test Loss: 0.557 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 10.203181505203247
Epoch: 6, Steps: 13 | Train Loss: 0.363 Vali Loss: 0.551 Vali Acc: 0.727 Test Loss: 0.551 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 10.128081560134888
Epoch: 7, Steps: 13 | Train Loss: 0.344 Vali Loss: 0.599 Vali Acc: 0.741 Test Loss: 0.599 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 10.37801218032837
Epoch: 8, Steps: 13 | Train Loss: 0.290 Vali Loss: 0.537 Vali Acc: 0.746 Test Loss: 0.537 Test Acc: 0.746
Validation loss decreased (-0.746336 --> -0.746336).  Saving model ...
Epoch: 9 cost time: 10.117927551269531
Epoch: 9, Steps: 13 | Train Loss: 0.260 Vali Loss: 0.552 Vali Acc: 0.741 Test Loss: 0.552 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 10.149081707000732
Epoch: 10, Steps: 13 | Train Loss: 0.300 Vali Loss: 0.688 Vali Acc: 0.610 Test Loss: 0.688 Test Acc: 0.610
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 10.15306806564331
Epoch: 11, Steps: 13 | Train Loss: 0.263 Vali Loss: 0.672 Vali Acc: 0.639 Test Loss: 0.672 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 10.07527756690979
Epoch: 12, Steps: 13 | Train Loss: 0.201 Vali Loss: 0.576 Vali Acc: 0.717 Test Loss: 0.576 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 10.38065505027771
Epoch: 13, Steps: 13 | Train Loss: 0.156 Vali Loss: 0.604 Vali Acc: 0.737 Test Loss: 0.604 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 10.47584319114685
Epoch: 14, Steps: 13 | Train Loss: 0.121 Vali Loss: 0.603 Vali Acc: 0.746 Test Loss: 0.603 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 10.419708013534546
Epoch: 15, Steps: 13 | Train Loss: 0.138 Vali Loss: 0.668 Vali Acc: 0.678 Test Loss: 0.668 Test Acc: 0.678
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 10.379230260848999
Epoch: 16, Steps: 13 | Train Loss: 0.081 Vali Loss: 0.663 Vali Acc: 0.717 Test Loss: 0.663 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 10.430894613265991
Epoch: 17, Steps: 13 | Train Loss: 0.060 Vali Loss: 0.732 Vali Acc: 0.668 Test Loss: 0.732 Test Acc: 0.668
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 10.321576356887817
Epoch: 18, Steps: 13 | Train Loss: 0.070 Vali Loss: 0.717 Vali Acc: 0.673 Test Loss: 0.717 Test Acc: 0.673
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 2376034
model size : 9.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.366542339324951
Epoch: 1, Steps: 13 | Train Loss: 0.663 Vali Loss: 0.591 Vali Acc: 0.712 Test Loss: 0.591 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 5.624725103378296
Epoch: 2, Steps: 13 | Train Loss: 0.551 Vali Loss: 0.559 Vali Acc: 0.727 Test Loss: 0.559 Test Acc: 0.727
Validation loss decreased (-0.712189 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 5.565950393676758
Epoch: 3, Steps: 13 | Train Loss: 0.516 Vali Loss: 0.539 Vali Acc: 0.746 Test Loss: 0.539 Test Acc: 0.746
Validation loss decreased (-0.726824 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 5.557208061218262
Epoch: 4, Steps: 13 | Train Loss: 0.454 Vali Loss: 0.543 Vali Acc: 0.741 Test Loss: 0.543 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.533366680145264
Epoch: 5, Steps: 13 | Train Loss: 0.431 Vali Loss: 0.600 Vali Acc: 0.741 Test Loss: 0.600 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.628615140914917
Epoch: 6, Steps: 13 | Train Loss: 0.383 Vali Loss: 0.526 Vali Acc: 0.771 Test Loss: 0.526 Test Acc: 0.771
Validation loss decreased (-0.746336 --> -0.770726).  Saving model ...
Epoch: 7 cost time: 5.547647953033447
Epoch: 7, Steps: 13 | Train Loss: 0.334 Vali Loss: 0.517 Vali Acc: 0.780 Test Loss: 0.517 Test Acc: 0.780
Validation loss decreased (-0.770726 --> -0.780483).  Saving model ...
Epoch: 8 cost time: 5.586518287658691
Epoch: 8, Steps: 13 | Train Loss: 0.290 Vali Loss: 0.554 Vali Acc: 0.771 Test Loss: 0.554 Test Acc: 0.771
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.593524217605591
Epoch: 9, Steps: 13 | Train Loss: 0.276 Vali Loss: 0.586 Vali Acc: 0.766 Test Loss: 0.586 Test Acc: 0.766
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.634539604187012
Epoch: 10, Steps: 13 | Train Loss: 0.218 Vali Loss: 0.598 Vali Acc: 0.649 Test Loss: 0.598 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.673717260360718
Epoch: 11, Steps: 13 | Train Loss: 0.212 Vali Loss: 0.587 Vali Acc: 0.668 Test Loss: 0.587 Test Acc: 0.668
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.6345789432525635
Epoch: 12, Steps: 13 | Train Loss: 0.152 Vali Loss: 0.634 Vali Acc: 0.766 Test Loss: 0.634 Test Acc: 0.766
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.573032379150391
Epoch: 13, Steps: 13 | Train Loss: 0.148 Vali Loss: 0.611 Vali Acc: 0.746 Test Loss: 0.611 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.665923357009888
Epoch: 14, Steps: 13 | Train Loss: 0.115 Vali Loss: 0.640 Vali Acc: 0.663 Test Loss: 0.640 Test Acc: 0.663
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.475476264953613
Epoch: 15, Steps: 13 | Train Loss: 0.106 Vali Loss: 0.619 Vali Acc: 0.712 Test Loss: 0.619 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.728388071060181
Epoch: 16, Steps: 13 | Train Loss: 0.086 Vali Loss: 0.650 Vali Acc: 0.688 Test Loss: 0.650 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.751460075378418
Epoch: 17, Steps: 13 | Train Loss: 0.065 Vali Loss: 0.763 Vali Acc: 0.766 Test Loss: 0.763 Test Acc: 0.766
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7804878048780488
model parameter : 720866
model size : 3.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 9.123252630233765
Epoch: 1, Steps: 13 | Train Loss: 0.572 Vali Loss: 0.595 Vali Acc: 0.722 Test Loss: 0.595 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 7.27151346206665
Epoch: 2, Steps: 13 | Train Loss: 0.566 Vali Loss: 0.544 Vali Acc: 0.737 Test Loss: 0.544 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 7.118454694747925
Epoch: 3, Steps: 13 | Train Loss: 0.510 Vali Loss: 0.564 Vali Acc: 0.732 Test Loss: 0.564 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.193246126174927
Epoch: 4, Steps: 13 | Train Loss: 0.466 Vali Loss: 0.527 Vali Acc: 0.741 Test Loss: 0.527 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741458).  Saving model ...
Epoch: 5 cost time: 7.0945117473602295
Epoch: 5, Steps: 13 | Train Loss: 0.427 Vali Loss: 0.519 Vali Acc: 0.732 Test Loss: 0.519 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.1554131507873535
Epoch: 6, Steps: 13 | Train Loss: 0.365 Vali Loss: 0.523 Vali Acc: 0.737 Test Loss: 0.523 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.12123703956604
Epoch: 7, Steps: 13 | Train Loss: 0.341 Vali Loss: 0.584 Vali Acc: 0.737 Test Loss: 0.584 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 7.177771329879761
Epoch: 8, Steps: 13 | Train Loss: 0.299 Vali Loss: 0.548 Vali Acc: 0.741 Test Loss: 0.548 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 7.228111267089844
Epoch: 9, Steps: 13 | Train Loss: 0.247 Vali Loss: 0.560 Vali Acc: 0.741 Test Loss: 0.560 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 7.215850830078125
Epoch: 10, Steps: 13 | Train Loss: 0.266 Vali Loss: 0.674 Vali Acc: 0.620 Test Loss: 0.674 Test Acc: 0.620
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 7.117854356765747
Epoch: 11, Steps: 13 | Train Loss: 0.316 Vali Loss: 0.664 Vali Acc: 0.620 Test Loss: 0.664 Test Acc: 0.620
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 7.065224647521973
Epoch: 12, Steps: 13 | Train Loss: 0.221 Vali Loss: 0.565 Vali Acc: 0.732 Test Loss: 0.565 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 7.042855262756348
Epoch: 13, Steps: 13 | Train Loss: 0.144 Vali Loss: 0.583 Vali Acc: 0.732 Test Loss: 0.583 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 7.1380133628845215
Epoch: 14, Steps: 13 | Train Loss: 0.118 Vali Loss: 0.596 Vali Acc: 0.727 Test Loss: 0.596 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 2376034
model size : 9.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.6444525718688965
Epoch: 1, Steps: 13 | Train Loss: 0.663 Vali Loss: 0.593 Vali Acc: 0.707 Test Loss: 0.593 Test Acc: 0.707
Validation loss decreased (inf --> -0.707311).  Saving model ...
Epoch: 2 cost time: 3.774247169494629
Epoch: 2, Steps: 13 | Train Loss: 0.549 Vali Loss: 0.560 Vali Acc: 0.727 Test Loss: 0.560 Test Acc: 0.727
Validation loss decreased (-0.707311 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 3.7749183177948
Epoch: 3, Steps: 13 | Train Loss: 0.518 Vali Loss: 0.540 Vali Acc: 0.741 Test Loss: 0.540 Test Acc: 0.741
Validation loss decreased (-0.726824 --> -0.741458).  Saving model ...
Epoch: 4 cost time: 3.696204423904419
Epoch: 4, Steps: 13 | Train Loss: 0.458 Vali Loss: 0.545 Vali Acc: 0.741 Test Loss: 0.545 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.601353883743286
Epoch: 5, Steps: 13 | Train Loss: 0.437 Vali Loss: 0.607 Vali Acc: 0.732 Test Loss: 0.607 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.6943533420562744
Epoch: 6, Steps: 13 | Train Loss: 0.395 Vali Loss: 0.527 Vali Acc: 0.766 Test Loss: 0.527 Test Acc: 0.766
Validation loss decreased (-0.741458 --> -0.765848).  Saving model ...
Epoch: 7 cost time: 3.7318131923675537
Epoch: 7, Steps: 13 | Train Loss: 0.343 Vali Loss: 0.520 Vali Acc: 0.780 Test Loss: 0.520 Test Acc: 0.780
Validation loss decreased (-0.765848 --> -0.780483).  Saving model ...
Epoch: 8 cost time: 3.737473726272583
Epoch: 8, Steps: 13 | Train Loss: 0.308 Vali Loss: 0.540 Vali Acc: 0.776 Test Loss: 0.540 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.7572784423828125
Epoch: 9, Steps: 13 | Train Loss: 0.298 Vali Loss: 0.533 Vali Acc: 0.776 Test Loss: 0.533 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.7346880435943604
Epoch: 10, Steps: 13 | Train Loss: 0.227 Vali Loss: 0.541 Vali Acc: 0.727 Test Loss: 0.541 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.724888324737549
Epoch: 11, Steps: 13 | Train Loss: 0.186 Vali Loss: 0.560 Vali Acc: 0.771 Test Loss: 0.560 Test Acc: 0.771
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.790956497192383
Epoch: 12, Steps: 13 | Train Loss: 0.154 Vali Loss: 0.564 Vali Acc: 0.707 Test Loss: 0.564 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.7617108821868896
Epoch: 13, Steps: 13 | Train Loss: 0.134 Vali Loss: 0.584 Vali Acc: 0.722 Test Loss: 0.584 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.6557626724243164
Epoch: 14, Steps: 13 | Train Loss: 0.107 Vali Loss: 0.674 Vali Acc: 0.634 Test Loss: 0.674 Test Acc: 0.634
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.7902896404266357
Epoch: 15, Steps: 13 | Train Loss: 0.100 Vali Loss: 0.626 Vali Acc: 0.702 Test Loss: 0.626 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.7674989700317383
Epoch: 16, Steps: 13 | Train Loss: 0.082 Vali Loss: 0.653 Vali Acc: 0.698 Test Loss: 0.653 Test Acc: 0.698
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.780282497406006
Epoch: 17, Steps: 13 | Train Loss: 0.097 Vali Loss: 0.670 Vali Acc: 0.717 Test Loss: 0.670 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7804878048780488
model parameter : 720866
model size : 3.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.921267986297607
Epoch: 1, Steps: 13 | Train Loss: 0.572 Vali Loss: 0.597 Vali Acc: 0.722 Test Loss: 0.597 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.360665798187256
Epoch: 2, Steps: 13 | Train Loss: 0.566 Vali Loss: 0.547 Vali Acc: 0.737 Test Loss: 0.547 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 4.4021315574646
Epoch: 3, Steps: 13 | Train Loss: 0.513 Vali Loss: 0.569 Vali Acc: 0.732 Test Loss: 0.569 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.374467849731445
Epoch: 4, Steps: 13 | Train Loss: 0.469 Vali Loss: 0.530 Vali Acc: 0.746 Test Loss: 0.530 Test Acc: 0.746
Validation loss decreased (-0.736580 --> -0.746336).  Saving model ...
Epoch: 5 cost time: 4.395020961761475
Epoch: 5, Steps: 13 | Train Loss: 0.431 Vali Loss: 0.524 Vali Acc: 0.737 Test Loss: 0.524 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.330832481384277
Epoch: 6, Steps: 13 | Train Loss: 0.378 Vali Loss: 0.523 Vali Acc: 0.741 Test Loss: 0.523 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.378377437591553
Epoch: 7, Steps: 13 | Train Loss: 0.344 Vali Loss: 0.548 Vali Acc: 0.737 Test Loss: 0.548 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.355520725250244
Epoch: 8, Steps: 13 | Train Loss: 0.343 Vali Loss: 0.532 Vali Acc: 0.741 Test Loss: 0.532 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.363964080810547
Epoch: 9, Steps: 13 | Train Loss: 0.259 Vali Loss: 0.539 Vali Acc: 0.751 Test Loss: 0.539 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751214).  Saving model ...
Epoch: 10 cost time: 4.353471279144287
Epoch: 10, Steps: 13 | Train Loss: 0.261 Vali Loss: 0.574 Vali Acc: 0.693 Test Loss: 0.574 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.406750202178955
Epoch: 11, Steps: 13 | Train Loss: 0.242 Vali Loss: 0.686 Vali Acc: 0.620 Test Loss: 0.686 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.342211723327637
Epoch: 12, Steps: 13 | Train Loss: 0.183 Vali Loss: 0.597 Vali Acc: 0.698 Test Loss: 0.597 Test Acc: 0.698
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.360471963882446
Epoch: 13, Steps: 13 | Train Loss: 0.154 Vali Loss: 0.610 Vali Acc: 0.737 Test Loss: 0.610 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.329875707626343
Epoch: 14, Steps: 13 | Train Loss: 0.254 Vali Loss: 0.603 Vali Acc: 0.746 Test Loss: 0.603 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.403567790985107
Epoch: 15, Steps: 13 | Train Loss: 0.200 Vali Loss: 0.627 Vali Acc: 0.712 Test Loss: 0.627 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.311914920806885
Epoch: 16, Steps: 13 | Train Loss: 0.088 Vali Loss: 0.668 Vali Acc: 0.737 Test Loss: 0.668 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.368575096130371
Epoch: 17, Steps: 13 | Train Loss: 0.069 Vali Loss: 0.680 Vali Acc: 0.732 Test Loss: 0.680 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.277300119400024
Epoch: 18, Steps: 13 | Train Loss: 0.117 Vali Loss: 0.795 Vali Acc: 0.727 Test Loss: 0.795 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.275258779525757
Epoch: 19, Steps: 13 | Train Loss: 0.048 Vali Loss: 0.757 Vali Acc: 0.737 Test Loss: 0.757 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 2376034
model size : 9.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.426748991012573
Epoch: 1, Steps: 13 | Train Loss: 0.668 Vali Loss: 0.593 Vali Acc: 0.712 Test Loss: 0.593 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 2.5549182891845703
Epoch: 2, Steps: 13 | Train Loss: 0.549 Vali Loss: 0.560 Vali Acc: 0.722 Test Loss: 0.560 Test Acc: 0.722
Validation loss decreased (-0.712189 --> -0.721946).  Saving model ...
Epoch: 3 cost time: 2.5743260383605957
Epoch: 3, Steps: 13 | Train Loss: 0.524 Vali Loss: 0.543 Vali Acc: 0.737 Test Loss: 0.543 Test Acc: 0.737
Validation loss decreased (-0.721946 --> -0.736580).  Saving model ...
Epoch: 4 cost time: 2.5479063987731934
Epoch: 4, Steps: 13 | Train Loss: 0.462 Vali Loss: 0.552 Vali Acc: 0.737 Test Loss: 0.552 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.573781967163086
Epoch: 5, Steps: 13 | Train Loss: 0.437 Vali Loss: 0.590 Vali Acc: 0.737 Test Loss: 0.590 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.6066930294036865
Epoch: 6, Steps: 13 | Train Loss: 0.389 Vali Loss: 0.533 Vali Acc: 0.756 Test Loss: 0.533 Test Acc: 0.756
Validation loss decreased (-0.736580 --> -0.756092).  Saving model ...
Epoch: 7 cost time: 2.5791640281677246
Epoch: 7, Steps: 13 | Train Loss: 0.341 Vali Loss: 0.532 Vali Acc: 0.771 Test Loss: 0.532 Test Acc: 0.771
Validation loss decreased (-0.756092 --> -0.770726).  Saving model ...
Epoch: 8 cost time: 2.574019193649292
Epoch: 8, Steps: 13 | Train Loss: 0.315 Vali Loss: 0.556 Vali Acc: 0.776 Test Loss: 0.556 Test Acc: 0.776
Validation loss decreased (-0.770726 --> -0.775604).  Saving model ...
Epoch: 9 cost time: 2.5905864238739014
Epoch: 9, Steps: 13 | Train Loss: 0.313 Vali Loss: 0.562 Vali Acc: 0.702 Test Loss: 0.562 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.4521849155426025
Epoch: 10, Steps: 13 | Train Loss: 0.234 Vali Loss: 0.560 Vali Acc: 0.712 Test Loss: 0.560 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.567196846008301
Epoch: 11, Steps: 13 | Train Loss: 0.200 Vali Loss: 0.560 Vali Acc: 0.756 Test Loss: 0.560 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.5820484161376953
Epoch: 12, Steps: 13 | Train Loss: 0.158 Vali Loss: 0.585 Vali Acc: 0.771 Test Loss: 0.585 Test Acc: 0.771
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.559149980545044
Epoch: 13, Steps: 13 | Train Loss: 0.154 Vali Loss: 0.596 Vali Acc: 0.722 Test Loss: 0.596 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.052025079727173
Epoch: 14, Steps: 13 | Train Loss: 0.121 Vali Loss: 0.621 Vali Acc: 0.683 Test Loss: 0.621 Test Acc: 0.683
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.5797271728515625
Epoch: 15, Steps: 13 | Train Loss: 0.105 Vali Loss: 0.705 Vali Acc: 0.629 Test Loss: 0.705 Test Acc: 0.629
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.608586072921753
Epoch: 16, Steps: 13 | Train Loss: 0.089 Vali Loss: 0.702 Vali Acc: 0.654 Test Loss: 0.702 Test Acc: 0.654
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.5786402225494385
Epoch: 17, Steps: 13 | Train Loss: 0.089 Vali Loss: 0.687 Vali Acc: 0.678 Test Loss: 0.687 Test Acc: 0.678
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.583756446838379
Epoch: 18, Steps: 13 | Train Loss: 0.075 Vali Loss: 0.735 Vali Acc: 0.659 Test Loss: 0.735 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 720866
model size : 3.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.188172101974487
Epoch: 1, Steps: 13 | Train Loss: 0.731 Vali Loss: 0.608 Vali Acc: 0.722 Test Loss: 0.608 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 6.179475784301758
Epoch: 2, Steps: 13 | Train Loss: 0.586 Vali Loss: 0.553 Vali Acc: 0.727 Test Loss: 0.553 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 6.389014005661011
Epoch: 3, Steps: 13 | Train Loss: 0.536 Vali Loss: 0.592 Vali Acc: 0.727 Test Loss: 0.592 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.383825778961182
Epoch: 4, Steps: 13 | Train Loss: 0.480 Vali Loss: 0.525 Vali Acc: 0.741 Test Loss: 0.525 Test Acc: 0.741
Validation loss decreased (-0.726824 --> -0.741458).  Saving model ...
Epoch: 5 cost time: 6.406942367553711
Epoch: 5, Steps: 13 | Train Loss: 0.421 Vali Loss: 0.543 Vali Acc: 0.732 Test Loss: 0.543 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.405588626861572
Epoch: 6, Steps: 13 | Train Loss: 0.448 Vali Loss: 0.536 Vali Acc: 0.741 Test Loss: 0.536 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.416797876358032
Epoch: 7, Steps: 13 | Train Loss: 0.356 Vali Loss: 0.627 Vali Acc: 0.746 Test Loss: 0.627 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746335).  Saving model ...
Epoch: 8 cost time: 6.419129848480225
Epoch: 8, Steps: 13 | Train Loss: 0.331 Vali Loss: 0.626 Vali Acc: 0.727 Test Loss: 0.626 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.362475633621216
Epoch: 9, Steps: 13 | Train Loss: 0.298 Vali Loss: 0.582 Vali Acc: 0.756 Test Loss: 0.582 Test Acc: 0.756
Validation loss decreased (-0.746335 --> -0.756092).  Saving model ...
Epoch: 10 cost time: 6.439605951309204
Epoch: 10, Steps: 13 | Train Loss: 0.283 Vali Loss: 0.542 Vali Acc: 0.756 Test Loss: 0.542 Test Acc: 0.756
Validation loss decreased (-0.756092 --> -0.756092).  Saving model ...
Epoch: 11 cost time: 6.418053865432739
Epoch: 11, Steps: 13 | Train Loss: 0.254 Vali Loss: 0.549 Vali Acc: 0.722 Test Loss: 0.549 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.399247646331787
Epoch: 12, Steps: 13 | Train Loss: 0.259 Vali Loss: 0.721 Vali Acc: 0.746 Test Loss: 0.721 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.313919305801392
Epoch: 13, Steps: 13 | Train Loss: 0.191 Vali Loss: 0.699 Vali Acc: 0.741 Test Loss: 0.699 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.393057107925415
Epoch: 14, Steps: 13 | Train Loss: 0.179 Vali Loss: 0.750 Vali Acc: 0.746 Test Loss: 0.750 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.4140918254852295
Epoch: 15, Steps: 13 | Train Loss: 0.160 Vali Loss: 0.666 Vali Acc: 0.751 Test Loss: 0.666 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 6.331191301345825
Epoch: 16, Steps: 13 | Train Loss: 0.100 Vali Loss: 0.622 Vali Acc: 0.727 Test Loss: 0.622 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 6.265153646469116
Epoch: 17, Steps: 13 | Train Loss: 0.090 Vali Loss: 0.854 Vali Acc: 0.751 Test Loss: 0.854 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 6.357842206954956
Epoch: 18, Steps: 13 | Train Loss: 0.078 Vali Loss: 0.720 Vali Acc: 0.746 Test Loss: 0.720 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 6.355430603027344
Epoch: 19, Steps: 13 | Train Loss: 0.059 Vali Loss: 0.666 Vali Acc: 0.698 Test Loss: 0.666 Test Acc: 0.698
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 6.379076719284058
Epoch: 20, Steps: 13 | Train Loss: 0.050 Vali Loss: 0.724 Vali Acc: 0.698 Test Loss: 0.724 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 1204194
model size : 5.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.417424440383911
Epoch: 1, Steps: 13 | Train Loss: 0.621 Vali Loss: 0.599 Vali Acc: 0.712 Test Loss: 0.599 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 3.6880862712860107
Epoch: 2, Steps: 13 | Train Loss: 0.578 Vali Loss: 0.564 Vali Acc: 0.722 Test Loss: 0.564 Test Acc: 0.722
Validation loss decreased (-0.712189 --> -0.721946).  Saving model ...
Epoch: 3 cost time: 3.6790106296539307
Epoch: 3, Steps: 13 | Train Loss: 0.495 Vali Loss: 0.549 Vali Acc: 0.766 Test Loss: 0.549 Test Acc: 0.766
Validation loss decreased (-0.721946 --> -0.765848).  Saving model ...
Epoch: 4 cost time: 3.6752583980560303
Epoch: 4, Steps: 13 | Train Loss: 0.442 Vali Loss: 0.528 Vali Acc: 0.737 Test Loss: 0.528 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.6993799209594727
Epoch: 5, Steps: 13 | Train Loss: 0.411 Vali Loss: 0.519 Vali Acc: 0.746 Test Loss: 0.519 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.6538400650024414
Epoch: 6, Steps: 13 | Train Loss: 0.365 Vali Loss: 0.513 Vali Acc: 0.756 Test Loss: 0.513 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.6685171127319336
Epoch: 7, Steps: 13 | Train Loss: 0.325 Vali Loss: 0.500 Vali Acc: 0.766 Test Loss: 0.500 Test Acc: 0.766
Validation loss decreased (-0.765848 --> -0.765849).  Saving model ...
Epoch: 8 cost time: 3.2854971885681152
Epoch: 8, Steps: 13 | Train Loss: 0.280 Vali Loss: 0.517 Vali Acc: 0.732 Test Loss: 0.517 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.854635715484619
Epoch: 9, Steps: 13 | Train Loss: 0.236 Vali Loss: 0.565 Vali Acc: 0.663 Test Loss: 0.565 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.88226580619812
Epoch: 10, Steps: 13 | Train Loss: 0.244 Vali Loss: 0.520 Vali Acc: 0.737 Test Loss: 0.520 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.817091464996338
Epoch: 11, Steps: 13 | Train Loss: 0.253 Vali Loss: 0.636 Vali Acc: 0.751 Test Loss: 0.636 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.645805597305298
Epoch: 12, Steps: 13 | Train Loss: 0.214 Vali Loss: 0.901 Vali Acc: 0.732 Test Loss: 0.901 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.6259958744049072
Epoch: 13, Steps: 13 | Train Loss: 0.281 Vali Loss: 0.550 Vali Acc: 0.732 Test Loss: 0.550 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.671973943710327
Epoch: 14, Steps: 13 | Train Loss: 0.196 Vali Loss: 0.709 Vali Acc: 0.629 Test Loss: 0.709 Test Acc: 0.629
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.652932643890381
Epoch: 15, Steps: 13 | Train Loss: 0.114 Vali Loss: 0.577 Vali Acc: 0.688 Test Loss: 0.577 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.688776731491089
Epoch: 16, Steps: 13 | Train Loss: 0.104 Vali Loss: 0.852 Vali Acc: 0.585 Test Loss: 0.852 Test Acc: 0.585
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.67128324508667
Epoch: 17, Steps: 13 | Train Loss: 0.154 Vali Loss: 0.846 Vali Acc: 0.595 Test Loss: 0.846 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 376546
model size : 2.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.031739711761475
Epoch: 1, Steps: 13 | Train Loss: 0.731 Vali Loss: 0.611 Vali Acc: 0.717 Test Loss: 0.611 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 5.194305419921875
Epoch: 2, Steps: 13 | Train Loss: 0.588 Vali Loss: 0.555 Vali Acc: 0.722 Test Loss: 0.555 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721946).  Saving model ...
Epoch: 3 cost time: 5.187563180923462
Epoch: 3, Steps: 13 | Train Loss: 0.540 Vali Loss: 0.598 Vali Acc: 0.727 Test Loss: 0.598 Test Acc: 0.727
Validation loss decreased (-0.721946 --> -0.726823).  Saving model ...
Epoch: 4 cost time: 5.215131521224976
Epoch: 4, Steps: 13 | Train Loss: 0.489 Vali Loss: 0.528 Vali Acc: 0.751 Test Loss: 0.528 Test Acc: 0.751
Validation loss decreased (-0.726823 --> -0.751214).  Saving model ...
Epoch: 5 cost time: 5.230108976364136
Epoch: 5, Steps: 13 | Train Loss: 0.426 Vali Loss: 0.535 Vali Acc: 0.741 Test Loss: 0.535 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.3016886711120605
Epoch: 6, Steps: 13 | Train Loss: 0.470 Vali Loss: 0.524 Vali Acc: 0.756 Test Loss: 0.524 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756092).  Saving model ...
Epoch: 7 cost time: 5.334969520568848
Epoch: 7, Steps: 13 | Train Loss: 0.365 Vali Loss: 0.514 Vali Acc: 0.761 Test Loss: 0.514 Test Acc: 0.761
Validation loss decreased (-0.756092 --> -0.760970).  Saving model ...
Epoch: 8 cost time: 5.242023468017578
Epoch: 8, Steps: 13 | Train Loss: 0.296 Vali Loss: 0.580 Vali Acc: 0.746 Test Loss: 0.580 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.316035032272339
Epoch: 9, Steps: 13 | Train Loss: 0.289 Vali Loss: 0.562 Vali Acc: 0.761 Test Loss: 0.562 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.25253701210022
Epoch: 10, Steps: 13 | Train Loss: 0.302 Vali Loss: 0.585 Vali Acc: 0.746 Test Loss: 0.585 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.192843437194824
Epoch: 11, Steps: 13 | Train Loss: 0.279 Vali Loss: 0.531 Vali Acc: 0.766 Test Loss: 0.531 Test Acc: 0.766
Validation loss decreased (-0.760970 --> -0.765848).  Saving model ...
Epoch: 12 cost time: 5.182338237762451
Epoch: 12, Steps: 13 | Train Loss: 0.228 Vali Loss: 0.663 Vali Acc: 0.746 Test Loss: 0.663 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.167649745941162
Epoch: 13, Steps: 13 | Train Loss: 0.188 Vali Loss: 0.715 Vali Acc: 0.761 Test Loss: 0.715 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.150719404220581
Epoch: 14, Steps: 13 | Train Loss: 0.188 Vali Loss: 0.731 Vali Acc: 0.776 Test Loss: 0.731 Test Acc: 0.776
Validation loss decreased (-0.765848 --> -0.775602).  Saving model ...
Epoch: 15 cost time: 5.218262434005737
Epoch: 15, Steps: 13 | Train Loss: 0.160 Vali Loss: 0.666 Vali Acc: 0.756 Test Loss: 0.666 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.171266078948975
Epoch: 16, Steps: 13 | Train Loss: 0.157 Vali Loss: 0.608 Vali Acc: 0.712 Test Loss: 0.608 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.188760042190552
Epoch: 17, Steps: 13 | Train Loss: 0.083 Vali Loss: 0.768 Vali Acc: 0.761 Test Loss: 0.768 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.26175332069397
Epoch: 18, Steps: 13 | Train Loss: 0.068 Vali Loss: 0.658 Vali Acc: 0.727 Test Loss: 0.658 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 5.160077095031738
Epoch: 19, Steps: 13 | Train Loss: 0.050 Vali Loss: 0.672 Vali Acc: 0.693 Test Loss: 0.672 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 5.2203192710876465
Epoch: 20, Steps: 13 | Train Loss: 0.048 Vali Loss: 0.726 Vali Acc: 0.668 Test Loss: 0.726 Test Acc: 0.668
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 5.176652908325195
Epoch: 21, Steps: 13 | Train Loss: 0.048 Vali Loss: 0.761 Vali Acc: 0.659 Test Loss: 0.761 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 5.105249643325806
Epoch: 22, Steps: 13 | Train Loss: 0.027 Vali Loss: 0.725 Vali Acc: 0.698 Test Loss: 0.725 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 5.145265817642212
Epoch: 23, Steps: 13 | Train Loss: 0.020 Vali Loss: 0.770 Vali Acc: 0.663 Test Loss: 0.770 Test Acc: 0.663
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 5.148988723754883
Epoch: 24, Steps: 13 | Train Loss: 0.023 Vali Loss: 0.836 Vali Acc: 0.634 Test Loss: 0.836 Test Acc: 0.634
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 1204194
model size : 5.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.8318469524383545
Epoch: 1, Steps: 13 | Train Loss: 0.619 Vali Loss: 0.595 Vali Acc: 0.712 Test Loss: 0.595 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 2.986379623413086
Epoch: 2, Steps: 13 | Train Loss: 0.580 Vali Loss: 0.564 Vali Acc: 0.727 Test Loss: 0.564 Test Acc: 0.727
Validation loss decreased (-0.712189 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 2.986279010772705
Epoch: 3, Steps: 13 | Train Loss: 0.499 Vali Loss: 0.549 Vali Acc: 0.766 Test Loss: 0.549 Test Acc: 0.766
Validation loss decreased (-0.726824 --> -0.765848).  Saving model ...
Epoch: 4 cost time: 2.998228073120117
Epoch: 4, Steps: 13 | Train Loss: 0.447 Vali Loss: 0.526 Vali Acc: 0.741 Test Loss: 0.526 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.9697885513305664
Epoch: 5, Steps: 13 | Train Loss: 0.410 Vali Loss: 0.515 Vali Acc: 0.766 Test Loss: 0.515 Test Acc: 0.766
Validation loss decreased (-0.765848 --> -0.765849).  Saving model ...
Epoch: 6 cost time: 2.968771457672119
Epoch: 6, Steps: 13 | Train Loss: 0.371 Vali Loss: 0.511 Vali Acc: 0.761 Test Loss: 0.511 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.034147262573242
Epoch: 7, Steps: 13 | Train Loss: 0.331 Vali Loss: 0.500 Vali Acc: 0.776 Test Loss: 0.500 Test Acc: 0.776
Validation loss decreased (-0.765849 --> -0.775605).  Saving model ...
Epoch: 8 cost time: 2.9709558486938477
Epoch: 8, Steps: 13 | Train Loss: 0.288 Vali Loss: 0.506 Vali Acc: 0.741 Test Loss: 0.506 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.9651012420654297
Epoch: 9, Steps: 13 | Train Loss: 0.253 Vali Loss: 0.519 Vali Acc: 0.722 Test Loss: 0.519 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.9737560749053955
Epoch: 10, Steps: 13 | Train Loss: 0.253 Vali Loss: 0.512 Vali Acc: 0.761 Test Loss: 0.512 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.004225254058838
Epoch: 11, Steps: 13 | Train Loss: 0.291 Vali Loss: 0.648 Vali Acc: 0.746 Test Loss: 0.648 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.9923365116119385
Epoch: 12, Steps: 13 | Train Loss: 0.198 Vali Loss: 0.778 Vali Acc: 0.737 Test Loss: 0.778 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.9674770832061768
Epoch: 13, Steps: 13 | Train Loss: 0.202 Vali Loss: 0.599 Vali Acc: 0.780 Test Loss: 0.599 Test Acc: 0.780
Validation loss decreased (-0.775605 --> -0.780482).  Saving model ...
Epoch: 14 cost time: 2.938516139984131
Epoch: 14, Steps: 13 | Train Loss: 0.194 Vali Loss: 0.634 Vali Acc: 0.624 Test Loss: 0.634 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.954885721206665
Epoch: 15, Steps: 13 | Train Loss: 0.108 Vali Loss: 0.568 Vali Acc: 0.698 Test Loss: 0.568 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.949424982070923
Epoch: 16, Steps: 13 | Train Loss: 0.103 Vali Loss: 0.723 Vali Acc: 0.620 Test Loss: 0.723 Test Acc: 0.620
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.96669340133667
Epoch: 17, Steps: 13 | Train Loss: 0.113 Vali Loss: 0.712 Vali Acc: 0.610 Test Loss: 0.712 Test Acc: 0.610
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.0080671310424805
Epoch: 18, Steps: 13 | Train Loss: 0.074 Vali Loss: 0.604 Vali Acc: 0.707 Test Loss: 0.604 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.9823875427246094
Epoch: 19, Steps: 13 | Train Loss: 0.055 Vali Loss: 0.638 Vali Acc: 0.683 Test Loss: 0.638 Test Acc: 0.683
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.9594602584838867
Epoch: 20, Steps: 13 | Train Loss: 0.045 Vali Loss: 0.630 Vali Acc: 0.712 Test Loss: 0.630 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.014895439147949
Epoch: 21, Steps: 13 | Train Loss: 0.036 Vali Loss: 0.641 Vali Acc: 0.717 Test Loss: 0.641 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.967442274093628
Epoch: 22, Steps: 13 | Train Loss: 0.030 Vali Loss: 0.667 Vali Acc: 0.712 Test Loss: 0.667 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.110502243041992
Epoch: 23, Steps: 13 | Train Loss: 0.031 Vali Loss: 0.754 Vali Acc: 0.737 Test Loss: 0.754 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7804878048780488
model parameter : 376546
model size : 2.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.980677604675293
Epoch: 1, Steps: 13 | Train Loss: 0.731 Vali Loss: 0.611 Vali Acc: 0.722 Test Loss: 0.611 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 3.453627347946167
Epoch: 2, Steps: 13 | Train Loss: 0.588 Vali Loss: 0.555 Vali Acc: 0.722 Test Loss: 0.555 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721946).  Saving model ...
Epoch: 3 cost time: 3.411176919937134
Epoch: 3, Steps: 13 | Train Loss: 0.543 Vali Loss: 0.597 Vali Acc: 0.727 Test Loss: 0.597 Test Acc: 0.727
Validation loss decreased (-0.721946 --> -0.726823).  Saving model ...
Epoch: 4 cost time: 3.5242865085601807
Epoch: 4, Steps: 13 | Train Loss: 0.492 Vali Loss: 0.529 Vali Acc: 0.741 Test Loss: 0.529 Test Acc: 0.741
Validation loss decreased (-0.726823 --> -0.741458).  Saving model ...
Epoch: 5 cost time: 3.4213333129882812
Epoch: 5, Steps: 13 | Train Loss: 0.432 Vali Loss: 0.544 Vali Acc: 0.737 Test Loss: 0.544 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.3764283657073975
Epoch: 6, Steps: 13 | Train Loss: 0.476 Vali Loss: 0.542 Vali Acc: 0.751 Test Loss: 0.542 Test Acc: 0.751
Validation loss decreased (-0.741458 --> -0.751214).  Saving model ...
Epoch: 7 cost time: 3.4087839126586914
Epoch: 7, Steps: 13 | Train Loss: 0.368 Vali Loss: 0.513 Vali Acc: 0.737 Test Loss: 0.513 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.4174702167510986
Epoch: 8, Steps: 13 | Train Loss: 0.300 Vali Loss: 0.553 Vali Acc: 0.761 Test Loss: 0.553 Test Acc: 0.761
Validation loss decreased (-0.751214 --> -0.760970).  Saving model ...
Epoch: 9 cost time: 3.4238367080688477
Epoch: 9, Steps: 13 | Train Loss: 0.281 Vali Loss: 0.550 Vali Acc: 0.751 Test Loss: 0.550 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.418627977371216
Epoch: 10, Steps: 13 | Train Loss: 0.310 Vali Loss: 0.649 Vali Acc: 0.737 Test Loss: 0.649 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.391322374343872
Epoch: 11, Steps: 13 | Train Loss: 0.265 Vali Loss: 0.534 Vali Acc: 0.741 Test Loss: 0.534 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.4133970737457275
Epoch: 12, Steps: 13 | Train Loss: 0.209 Vali Loss: 0.579 Vali Acc: 0.761 Test Loss: 0.579 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.203033208847046
Epoch: 13, Steps: 13 | Train Loss: 0.325 Vali Loss: 0.758 Vali Acc: 0.751 Test Loss: 0.758 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.3073198795318604
Epoch: 14, Steps: 13 | Train Loss: 0.202 Vali Loss: 0.809 Vali Acc: 0.746 Test Loss: 0.809 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.318432092666626
Epoch: 15, Steps: 13 | Train Loss: 0.194 Vali Loss: 0.688 Vali Acc: 0.737 Test Loss: 0.688 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.3333840370178223
Epoch: 16, Steps: 13 | Train Loss: 0.123 Vali Loss: 0.646 Vali Acc: 0.751 Test Loss: 0.646 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.3382129669189453
Epoch: 17, Steps: 13 | Train Loss: 0.092 Vali Loss: 0.838 Vali Acc: 0.751 Test Loss: 0.838 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.3277499675750732
Epoch: 18, Steps: 13 | Train Loss: 0.085 Vali Loss: 0.660 Vali Acc: 0.712 Test Loss: 0.660 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 1204194
model size : 5.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.9491348266601562
Epoch: 1, Steps: 13 | Train Loss: 0.621 Vali Loss: 0.595 Vali Acc: 0.712 Test Loss: 0.595 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 2.1894562244415283
Epoch: 2, Steps: 13 | Train Loss: 0.582 Vali Loss: 0.565 Vali Acc: 0.727 Test Loss: 0.565 Test Acc: 0.727
Validation loss decreased (-0.712189 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 2.0816445350646973
Epoch: 3, Steps: 13 | Train Loss: 0.502 Vali Loss: 0.549 Vali Acc: 0.761 Test Loss: 0.549 Test Acc: 0.761
Validation loss decreased (-0.726824 --> -0.760970).  Saving model ...
Epoch: 4 cost time: 2.1116836071014404
Epoch: 4, Steps: 13 | Train Loss: 0.450 Vali Loss: 0.532 Vali Acc: 0.737 Test Loss: 0.532 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9530165195465088
Epoch: 5, Steps: 13 | Train Loss: 0.414 Vali Loss: 0.521 Vali Acc: 0.756 Test Loss: 0.521 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.1603989601135254
Epoch: 6, Steps: 13 | Train Loss: 0.380 Vali Loss: 0.511 Vali Acc: 0.761 Test Loss: 0.511 Test Acc: 0.761
Validation loss decreased (-0.760970 --> -0.760970).  Saving model ...
Epoch: 7 cost time: 2.1887176036834717
Epoch: 7, Steps: 13 | Train Loss: 0.336 Vali Loss: 0.509 Vali Acc: 0.771 Test Loss: 0.509 Test Acc: 0.771
Validation loss decreased (-0.760970 --> -0.770727).  Saving model ...
Epoch: 8 cost time: 2.237431049346924
Epoch: 8, Steps: 13 | Train Loss: 0.293 Vali Loss: 0.503 Vali Acc: 0.771 Test Loss: 0.503 Test Acc: 0.771
Validation loss decreased (-0.770727 --> -0.770727).  Saving model ...
Epoch: 9 cost time: 2.1807024478912354
Epoch: 9, Steps: 13 | Train Loss: 0.263 Vali Loss: 0.514 Vali Acc: 0.722 Test Loss: 0.514 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1618874073028564
Epoch: 10, Steps: 13 | Train Loss: 0.255 Vali Loss: 0.524 Vali Acc: 0.776 Test Loss: 0.524 Test Acc: 0.776
Validation loss decreased (-0.770727 --> -0.775605).  Saving model ...
Epoch: 11 cost time: 2.1714706420898438
Epoch: 11, Steps: 13 | Train Loss: 0.289 Vali Loss: 0.642 Vali Acc: 0.746 Test Loss: 0.642 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.1476058959960938
Epoch: 12, Steps: 13 | Train Loss: 0.205 Vali Loss: 0.700 Vali Acc: 0.746 Test Loss: 0.700 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.143421173095703
Epoch: 13, Steps: 13 | Train Loss: 0.175 Vali Loss: 0.636 Vali Acc: 0.761 Test Loss: 0.636 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.150310754776001
Epoch: 14, Steps: 13 | Train Loss: 0.152 Vali Loss: 0.575 Vali Acc: 0.766 Test Loss: 0.575 Test Acc: 0.766
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.1641430854797363
Epoch: 15, Steps: 13 | Train Loss: 0.135 Vali Loss: 0.566 Vali Acc: 0.746 Test Loss: 0.566 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.208556652069092
Epoch: 16, Steps: 13 | Train Loss: 0.106 Vali Loss: 0.698 Vali Acc: 0.615 Test Loss: 0.698 Test Acc: 0.615
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.168043613433838
Epoch: 17, Steps: 13 | Train Loss: 0.131 Vali Loss: 0.832 Vali Acc: 0.580 Test Loss: 0.832 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.189241647720337
Epoch: 18, Steps: 13 | Train Loss: 0.174 Vali Loss: 0.622 Vali Acc: 0.751 Test Loss: 0.622 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.156208038330078
Epoch: 19, Steps: 13 | Train Loss: 0.064 Vali Loss: 0.617 Vali Acc: 0.707 Test Loss: 0.617 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.174715042114258
Epoch: 20, Steps: 13 | Train Loss: 0.049 Vali Loss: 0.630 Vali Acc: 0.722 Test Loss: 0.630 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 376546
model size : 2.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 9.67765474319458
Epoch: 1, Steps: 13 | Train Loss: 0.595 Vali Loss: 0.598 Vali Acc: 0.722 Test Loss: 0.598 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 7.822964668273926
Epoch: 2, Steps: 13 | Train Loss: 0.560 Vali Loss: 0.560 Vali Acc: 0.727 Test Loss: 0.560 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 7.8698859214782715
Epoch: 3, Steps: 13 | Train Loss: 0.538 Vali Loss: 0.543 Vali Acc: 0.722 Test Loss: 0.543 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.83163595199585
Epoch: 4, Steps: 13 | Train Loss: 0.492 Vali Loss: 0.519 Vali Acc: 0.732 Test Loss: 0.519 Test Acc: 0.732
Validation loss decreased (-0.726824 --> -0.731702).  Saving model ...
Epoch: 5 cost time: 7.754900693893433
Epoch: 5, Steps: 13 | Train Loss: 0.440 Vali Loss: 0.542 Vali Acc: 0.732 Test Loss: 0.542 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.655142545700073
Epoch: 6, Steps: 13 | Train Loss: 0.408 Vali Loss: 0.530 Vali Acc: 0.727 Test Loss: 0.530 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.685747861862183
Epoch: 7, Steps: 13 | Train Loss: 0.379 Vali Loss: 0.517 Vali Acc: 0.746 Test Loss: 0.517 Test Acc: 0.746
Validation loss decreased (-0.731702 --> -0.746336).  Saving model ...
Epoch: 8 cost time: 7.685758352279663
Epoch: 8, Steps: 13 | Train Loss: 0.407 Vali Loss: 0.506 Vali Acc: 0.751 Test Loss: 0.506 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751214).  Saving model ...
Epoch: 9 cost time: 7.5909950733184814
Epoch: 9, Steps: 13 | Train Loss: 0.308 Vali Loss: 0.508 Vali Acc: 0.766 Test Loss: 0.508 Test Acc: 0.766
Validation loss decreased (-0.751214 --> -0.765849).  Saving model ...
Epoch: 10 cost time: 7.55219030380249
Epoch: 10, Steps: 13 | Train Loss: 0.312 Vali Loss: 0.532 Vali Acc: 0.771 Test Loss: 0.532 Test Acc: 0.771
Validation loss decreased (-0.765849 --> -0.770726).  Saving model ...
Epoch: 11 cost time: 7.50414514541626
Epoch: 11, Steps: 13 | Train Loss: 0.246 Vali Loss: 0.555 Vali Acc: 0.756 Test Loss: 0.555 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.574598789215088
Epoch: 12, Steps: 13 | Train Loss: 0.244 Vali Loss: 0.533 Vali Acc: 0.712 Test Loss: 0.533 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 7.474954605102539
Epoch: 13, Steps: 13 | Train Loss: 0.243 Vali Loss: 0.617 Vali Acc: 0.746 Test Loss: 0.617 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 7.431092977523804
Epoch: 14, Steps: 13 | Train Loss: 0.186 Vali Loss: 0.577 Vali Acc: 0.756 Test Loss: 0.577 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 7.661106109619141
Epoch: 15, Steps: 13 | Train Loss: 0.141 Vali Loss: 0.579 Vali Acc: 0.746 Test Loss: 0.579 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 7.789206266403198
Epoch: 16, Steps: 13 | Train Loss: 0.120 Vali Loss: 0.608 Vali Acc: 0.673 Test Loss: 0.608 Test Acc: 0.673
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 7.728471994400024
Epoch: 17, Steps: 13 | Train Loss: 0.104 Vali Loss: 0.610 Vali Acc: 0.732 Test Loss: 0.610 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 7.686412572860718
Epoch: 18, Steps: 13 | Train Loss: 0.100 Vali Loss: 0.648 Vali Acc: 0.727 Test Loss: 0.648 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 7.815380334854126
Epoch: 19, Steps: 13 | Train Loss: 0.075 Vali Loss: 0.649 Vali Acc: 0.717 Test Loss: 0.649 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 7.746864080429077
Epoch: 20, Steps: 13 | Train Loss: 0.061 Vali Loss: 0.671 Vali Acc: 0.712 Test Loss: 0.671 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 1188402
model size : 4.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.66590428352356
Epoch: 1, Steps: 13 | Train Loss: 0.576 Vali Loss: 0.564 Vali Acc: 0.722 Test Loss: 0.564 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 4.672528028488159
Epoch: 2, Steps: 13 | Train Loss: 0.560 Vali Loss: 0.539 Vali Acc: 0.732 Test Loss: 0.539 Test Acc: 0.732
Validation loss decreased (-0.721946 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 4.796483039855957
Epoch: 3, Steps: 13 | Train Loss: 0.512 Vali Loss: 0.537 Vali Acc: 0.732 Test Loss: 0.537 Test Acc: 0.732
Validation loss decreased (-0.731702 --> -0.731702).  Saving model ...
Epoch: 4 cost time: 4.6851255893707275
Epoch: 4, Steps: 13 | Train Loss: 0.471 Vali Loss: 0.519 Vali Acc: 0.751 Test Loss: 0.519 Test Acc: 0.751
Validation loss decreased (-0.731702 --> -0.751214).  Saving model ...
Epoch: 5 cost time: 4.7702412605285645
Epoch: 5, Steps: 13 | Train Loss: 0.436 Vali Loss: 0.520 Vali Acc: 0.746 Test Loss: 0.520 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.737724304199219
Epoch: 6, Steps: 13 | Train Loss: 0.420 Vali Loss: 0.542 Vali Acc: 0.683 Test Loss: 0.542 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.747207880020142
Epoch: 7, Steps: 13 | Train Loss: 0.380 Vali Loss: 0.504 Vali Acc: 0.766 Test Loss: 0.504 Test Acc: 0.766
Validation loss decreased (-0.751214 --> -0.765849).  Saving model ...
Epoch: 8 cost time: 4.738556146621704
Epoch: 8, Steps: 13 | Train Loss: 0.359 Vali Loss: 0.515 Vali Acc: 0.756 Test Loss: 0.515 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.697907209396362
Epoch: 9, Steps: 13 | Train Loss: 0.339 Vali Loss: 0.536 Vali Acc: 0.761 Test Loss: 0.536 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.845715761184692
Epoch: 10, Steps: 13 | Train Loss: 0.278 Vali Loss: 0.539 Vali Acc: 0.751 Test Loss: 0.539 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.877441883087158
Epoch: 11, Steps: 13 | Train Loss: 0.276 Vali Loss: 0.562 Vali Acc: 0.688 Test Loss: 0.562 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.77013635635376
Epoch: 12, Steps: 13 | Train Loss: 0.273 Vali Loss: 0.619 Vali Acc: 0.673 Test Loss: 0.619 Test Acc: 0.673
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.886480808258057
Epoch: 13, Steps: 13 | Train Loss: 0.219 Vali Loss: 0.548 Vali Acc: 0.688 Test Loss: 0.548 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.86806321144104
Epoch: 14, Steps: 13 | Train Loss: 0.165 Vali Loss: 0.572 Vali Acc: 0.702 Test Loss: 0.572 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.764621019363403
Epoch: 15, Steps: 13 | Train Loss: 0.138 Vali Loss: 0.578 Vali Acc: 0.717 Test Loss: 0.578 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.803440570831299
Epoch: 16, Steps: 13 | Train Loss: 0.114 Vali Loss: 0.594 Vali Acc: 0.698 Test Loss: 0.594 Test Acc: 0.698
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.813814640045166
Epoch: 17, Steps: 13 | Train Loss: 0.100 Vali Loss: 0.624 Vali Acc: 0.702 Test Loss: 0.624 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 360690
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.819916248321533
Epoch: 1, Steps: 13 | Train Loss: 0.594 Vali Loss: 0.600 Vali Acc: 0.722 Test Loss: 0.600 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 6.223104953765869
Epoch: 2, Steps: 13 | Train Loss: 0.562 Vali Loss: 0.565 Vali Acc: 0.732 Test Loss: 0.565 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 6.257946729660034
Epoch: 3, Steps: 13 | Train Loss: 0.540 Vali Loss: 0.547 Vali Acc: 0.727 Test Loss: 0.547 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.203179121017456
Epoch: 4, Steps: 13 | Train Loss: 0.497 Vali Loss: 0.525 Vali Acc: 0.737 Test Loss: 0.525 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736580).  Saving model ...
Epoch: 5 cost time: 6.323699951171875
Epoch: 5, Steps: 13 | Train Loss: 0.455 Vali Loss: 0.528 Vali Acc: 0.741 Test Loss: 0.528 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741458).  Saving model ...
Epoch: 6 cost time: 6.213631868362427
Epoch: 6, Steps: 13 | Train Loss: 0.418 Vali Loss: 0.501 Vali Acc: 0.751 Test Loss: 0.501 Test Acc: 0.751
Validation loss decreased (-0.741458 --> -0.751215).  Saving model ...
Epoch: 7 cost time: 6.239048480987549
Epoch: 7, Steps: 13 | Train Loss: 0.382 Vali Loss: 0.500 Vali Acc: 0.746 Test Loss: 0.500 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.050543546676636
Epoch: 8, Steps: 13 | Train Loss: 0.430 Vali Loss: 0.504 Vali Acc: 0.766 Test Loss: 0.504 Test Acc: 0.766
Validation loss decreased (-0.751215 --> -0.765849).  Saving model ...
Epoch: 9 cost time: 6.147432088851929
Epoch: 9, Steps: 13 | Train Loss: 0.317 Vali Loss: 0.506 Vali Acc: 0.771 Test Loss: 0.506 Test Acc: 0.771
Validation loss decreased (-0.765849 --> -0.770727).  Saving model ...
Epoch: 10 cost time: 6.102087020874023
Epoch: 10, Steps: 13 | Train Loss: 0.305 Vali Loss: 0.498 Vali Acc: 0.766 Test Loss: 0.498 Test Acc: 0.766
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.1953935623168945
Epoch: 11, Steps: 13 | Train Loss: 0.251 Vali Loss: 0.512 Vali Acc: 0.780 Test Loss: 0.512 Test Acc: 0.780
Validation loss decreased (-0.770727 --> -0.780483).  Saving model ...
Epoch: 12 cost time: 6.112281084060669
Epoch: 12, Steps: 13 | Train Loss: 0.236 Vali Loss: 0.551 Vali Acc: 0.673 Test Loss: 0.551 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.112438917160034
Epoch: 13, Steps: 13 | Train Loss: 0.260 Vali Loss: 0.636 Vali Acc: 0.761 Test Loss: 0.636 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.1475889682769775
Epoch: 14, Steps: 13 | Train Loss: 0.228 Vali Loss: 0.566 Vali Acc: 0.785 Test Loss: 0.566 Test Acc: 0.785
Validation loss decreased (-0.780483 --> -0.785360).  Saving model ...
Epoch: 15 cost time: 6.1834940910339355
Epoch: 15, Steps: 13 | Train Loss: 0.146 Vali Loss: 0.556 Vali Acc: 0.732 Test Loss: 0.556 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.119175910949707
Epoch: 16, Steps: 13 | Train Loss: 0.123 Vali Loss: 0.628 Vali Acc: 0.649 Test Loss: 0.628 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.182742357254028
Epoch: 17, Steps: 13 | Train Loss: 0.113 Vali Loss: 0.574 Vali Acc: 0.693 Test Loss: 0.574 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 6.203506231307983
Epoch: 18, Steps: 13 | Train Loss: 0.107 Vali Loss: 0.641 Vali Acc: 0.727 Test Loss: 0.641 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 6.132092237472534
Epoch: 19, Steps: 13 | Train Loss: 0.073 Vali Loss: 0.648 Vali Acc: 0.668 Test Loss: 0.648 Test Acc: 0.668
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 6.091619491577148
Epoch: 20, Steps: 13 | Train Loss: 0.064 Vali Loss: 0.667 Vali Acc: 0.683 Test Loss: 0.667 Test Acc: 0.683
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 6.006057262420654
Epoch: 21, Steps: 13 | Train Loss: 0.089 Vali Loss: 0.704 Vali Acc: 0.678 Test Loss: 0.704 Test Acc: 0.678
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 5.975615501403809
Epoch: 22, Steps: 13 | Train Loss: 0.067 Vali Loss: 0.658 Vali Acc: 0.712 Test Loss: 0.658 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 6.022051572799683
Epoch: 23, Steps: 13 | Train Loss: 0.057 Vali Loss: 0.697 Vali Acc: 0.712 Test Loss: 0.697 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 5.9244065284729
Epoch: 24, Steps: 13 | Train Loss: 0.044 Vali Loss: 0.836 Vali Acc: 0.712 Test Loss: 0.836 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7853658536585366
model parameter : 1188402
model size : 4.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.067934513092041
Epoch: 1, Steps: 13 | Train Loss: 0.575 Vali Loss: 0.564 Vali Acc: 0.727 Test Loss: 0.564 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 3.4479851722717285
Epoch: 2, Steps: 13 | Train Loss: 0.557 Vali Loss: 0.540 Vali Acc: 0.732 Test Loss: 0.540 Test Acc: 0.732
Validation loss decreased (-0.726824 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 3.3753247261047363
Epoch: 3, Steps: 13 | Train Loss: 0.508 Vali Loss: 0.536 Vali Acc: 0.737 Test Loss: 0.536 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736580).  Saving model ...
Epoch: 4 cost time: 3.303065299987793
Epoch: 4, Steps: 13 | Train Loss: 0.474 Vali Loss: 0.524 Vali Acc: 0.741 Test Loss: 0.524 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741458).  Saving model ...
Epoch: 5 cost time: 3.286726951599121
Epoch: 5, Steps: 13 | Train Loss: 0.438 Vali Loss: 0.522 Vali Acc: 0.746 Test Loss: 0.522 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746336).  Saving model ...
Epoch: 6 cost time: 3.300694465637207
Epoch: 6, Steps: 13 | Train Loss: 0.423 Vali Loss: 0.535 Vali Acc: 0.693 Test Loss: 0.535 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.3354854583740234
Epoch: 7, Steps: 13 | Train Loss: 0.382 Vali Loss: 0.506 Vali Acc: 0.746 Test Loss: 0.506 Test Acc: 0.746
Validation loss decreased (-0.746336 --> -0.746336).  Saving model ...
Epoch: 8 cost time: 3.312269687652588
Epoch: 8, Steps: 13 | Train Loss: 0.360 Vali Loss: 0.529 Vali Acc: 0.766 Test Loss: 0.529 Test Acc: 0.766
Validation loss decreased (-0.746336 --> -0.765848).  Saving model ...
Epoch: 9 cost time: 3.2650399208068848
Epoch: 9, Steps: 13 | Train Loss: 0.343 Vali Loss: 0.546 Vali Acc: 0.751 Test Loss: 0.546 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.3904805183410645
Epoch: 10, Steps: 13 | Train Loss: 0.286 Vali Loss: 0.556 Vali Acc: 0.756 Test Loss: 0.556 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.382239818572998
Epoch: 11, Steps: 13 | Train Loss: 0.281 Vali Loss: 0.584 Vali Acc: 0.673 Test Loss: 0.584 Test Acc: 0.673
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.3490123748779297
Epoch: 12, Steps: 13 | Train Loss: 0.286 Vali Loss: 0.637 Vali Acc: 0.639 Test Loss: 0.637 Test Acc: 0.639
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.335111618041992
Epoch: 13, Steps: 13 | Train Loss: 0.242 Vali Loss: 0.554 Vali Acc: 0.727 Test Loss: 0.554 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.316412925720215
Epoch: 14, Steps: 13 | Train Loss: 0.186 Vali Loss: 0.574 Vali Acc: 0.712 Test Loss: 0.574 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.107956886291504
Epoch: 15, Steps: 13 | Train Loss: 0.150 Vali Loss: 0.569 Vali Acc: 0.737 Test Loss: 0.569 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.343329429626465
Epoch: 16, Steps: 13 | Train Loss: 0.126 Vali Loss: 0.599 Vali Acc: 0.702 Test Loss: 0.599 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.302778482437134
Epoch: 17, Steps: 13 | Train Loss: 0.100 Vali Loss: 0.625 Vali Acc: 0.693 Test Loss: 0.625 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.450249433517456
Epoch: 18, Steps: 13 | Train Loss: 0.092 Vali Loss: 0.694 Vali Acc: 0.741 Test Loss: 0.694 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 360690
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.1603734493255615
Epoch: 1, Steps: 13 | Train Loss: 0.595 Vali Loss: 0.601 Vali Acc: 0.722 Test Loss: 0.601 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 3.364379405975342
Epoch: 2, Steps: 13 | Train Loss: 0.560 Vali Loss: 0.564 Vali Acc: 0.732 Test Loss: 0.564 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 3.3955726623535156
Epoch: 3, Steps: 13 | Train Loss: 0.543 Vali Loss: 0.552 Vali Acc: 0.717 Test Loss: 0.552 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.111003875732422
Epoch: 4, Steps: 13 | Train Loss: 0.505 Vali Loss: 0.530 Vali Acc: 0.741 Test Loss: 0.530 Test Acc: 0.741
Validation loss decreased (-0.731702 --> -0.741458).  Saving model ...
Epoch: 5 cost time: 3.449455738067627
Epoch: 5, Steps: 13 | Train Loss: 0.450 Vali Loss: 0.555 Vali Acc: 0.741 Test Loss: 0.555 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.41383695602417
Epoch: 6, Steps: 13 | Train Loss: 0.420 Vali Loss: 0.504 Vali Acc: 0.766 Test Loss: 0.504 Test Acc: 0.766
Validation loss decreased (-0.741458 --> -0.765849).  Saving model ...
Epoch: 7 cost time: 3.441201686859131
Epoch: 7, Steps: 13 | Train Loss: 0.396 Vali Loss: 0.504 Vali Acc: 0.771 Test Loss: 0.504 Test Acc: 0.771
Validation loss decreased (-0.765849 --> -0.770727).  Saving model ...
Epoch: 8 cost time: 3.5613534450531006
Epoch: 8, Steps: 13 | Train Loss: 0.404 Vali Loss: 0.505 Vali Acc: 0.751 Test Loss: 0.505 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.383175849914551
Epoch: 9, Steps: 13 | Train Loss: 0.326 Vali Loss: 0.517 Vali Acc: 0.756 Test Loss: 0.517 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.430393934249878
Epoch: 10, Steps: 13 | Train Loss: 0.304 Vali Loss: 0.542 Vali Acc: 0.761 Test Loss: 0.542 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.404710292816162
Epoch: 11, Steps: 13 | Train Loss: 0.258 Vali Loss: 0.631 Vali Acc: 0.746 Test Loss: 0.631 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.423290729522705
Epoch: 12, Steps: 13 | Train Loss: 0.257 Vali Loss: 0.609 Vali Acc: 0.722 Test Loss: 0.609 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.193373918533325
Epoch: 13, Steps: 13 | Train Loss: 0.254 Vali Loss: 0.670 Vali Acc: 0.737 Test Loss: 0.670 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.6431806087493896
Epoch: 14, Steps: 13 | Train Loss: 0.203 Vali Loss: 0.603 Vali Acc: 0.771 Test Loss: 0.603 Test Acc: 0.771
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.743004322052002
Epoch: 15, Steps: 13 | Train Loss: 0.146 Vali Loss: 0.556 Vali Acc: 0.712 Test Loss: 0.556 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.4306108951568604
Epoch: 16, Steps: 13 | Train Loss: 0.120 Vali Loss: 0.571 Vali Acc: 0.693 Test Loss: 0.571 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.275250196456909
Epoch: 17, Steps: 13 | Train Loss: 0.102 Vali Loss: 0.619 Vali Acc: 0.722 Test Loss: 0.619 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 1188402
model size : 4.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.749234676361084
Epoch: 1, Steps: 13 | Train Loss: 0.574 Vali Loss: 0.565 Vali Acc: 0.727 Test Loss: 0.565 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 2.2127978801727295
Epoch: 2, Steps: 13 | Train Loss: 0.557 Vali Loss: 0.539 Vali Acc: 0.732 Test Loss: 0.539 Test Acc: 0.732
Validation loss decreased (-0.726824 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 2.2210001945495605
Epoch: 3, Steps: 13 | Train Loss: 0.509 Vali Loss: 0.541 Vali Acc: 0.732 Test Loss: 0.541 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.2059381008148193
Epoch: 4, Steps: 13 | Train Loss: 0.476 Vali Loss: 0.522 Vali Acc: 0.746 Test Loss: 0.522 Test Acc: 0.746
Validation loss decreased (-0.731702 --> -0.746336).  Saving model ...
Epoch: 5 cost time: 2.188096523284912
Epoch: 5, Steps: 13 | Train Loss: 0.439 Vali Loss: 0.529 Vali Acc: 0.741 Test Loss: 0.529 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1795308589935303
Epoch: 6, Steps: 13 | Train Loss: 0.429 Vali Loss: 0.549 Vali Acc: 0.707 Test Loss: 0.549 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.2199203968048096
Epoch: 7, Steps: 13 | Train Loss: 0.390 Vali Loss: 0.511 Vali Acc: 0.761 Test Loss: 0.511 Test Acc: 0.761
Validation loss decreased (-0.746336 --> -0.760970).  Saving model ...
Epoch: 8 cost time: 2.1571593284606934
Epoch: 8, Steps: 13 | Train Loss: 0.362 Vali Loss: 0.544 Vali Acc: 0.751 Test Loss: 0.544 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1452672481536865
Epoch: 9, Steps: 13 | Train Loss: 0.347 Vali Loss: 0.532 Vali Acc: 0.756 Test Loss: 0.532 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.1953091621398926
Epoch: 10, Steps: 13 | Train Loss: 0.301 Vali Loss: 0.546 Vali Acc: 0.756 Test Loss: 0.546 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.2256083488464355
Epoch: 11, Steps: 13 | Train Loss: 0.309 Vali Loss: 0.667 Vali Acc: 0.595 Test Loss: 0.667 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.170654535293579
Epoch: 12, Steps: 13 | Train Loss: 0.304 Vali Loss: 0.554 Vali Acc: 0.727 Test Loss: 0.554 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.9893066883087158
Epoch: 13, Steps: 13 | Train Loss: 0.248 Vali Loss: 0.539 Vali Acc: 0.717 Test Loss: 0.539 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.186368465423584
Epoch: 14, Steps: 13 | Train Loss: 0.202 Vali Loss: 0.559 Vali Acc: 0.737 Test Loss: 0.559 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.2114295959472656
Epoch: 15, Steps: 13 | Train Loss: 0.167 Vali Loss: 0.564 Vali Acc: 0.702 Test Loss: 0.564 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.2749860286712646
Epoch: 16, Steps: 13 | Train Loss: 0.132 Vali Loss: 0.603 Vali Acc: 0.737 Test Loss: 0.603 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.240488290786743
Epoch: 17, Steps: 13 | Train Loss: 0.122 Vali Loss: 0.611 Vali Acc: 0.698 Test Loss: 0.611 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 360690
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.9306206703186035
Epoch: 1, Steps: 13 | Train Loss: 0.624 Vali Loss: 0.606 Vali Acc: 0.717 Test Loss: 0.606 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 5.219586133956909
Epoch: 2, Steps: 13 | Train Loss: 0.570 Vali Loss: 0.565 Vali Acc: 0.717 Test Loss: 0.565 Test Acc: 0.717
Validation loss decreased (-0.717067 --> -0.717068).  Saving model ...
Epoch: 3 cost time: 5.221386909484863
Epoch: 3, Steps: 13 | Train Loss: 0.525 Vali Loss: 0.565 Vali Acc: 0.717 Test Loss: 0.565 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.270657777786255
Epoch: 4, Steps: 13 | Train Loss: 0.508 Vali Loss: 0.541 Vali Acc: 0.727 Test Loss: 0.541 Test Acc: 0.727
Validation loss decreased (-0.717068 --> -0.726824).  Saving model ...
Epoch: 5 cost time: 5.261179208755493
Epoch: 5, Steps: 13 | Train Loss: 0.439 Vali Loss: 0.523 Vali Acc: 0.751 Test Loss: 0.523 Test Acc: 0.751
Validation loss decreased (-0.726824 --> -0.751214).  Saving model ...
Epoch: 6 cost time: 5.2197089195251465
Epoch: 6, Steps: 13 | Train Loss: 0.421 Vali Loss: 0.551 Vali Acc: 0.756 Test Loss: 0.551 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756092).  Saving model ...
Epoch: 7 cost time: 5.168894052505493
Epoch: 7, Steps: 13 | Train Loss: 0.390 Vali Loss: 0.517 Vali Acc: 0.727 Test Loss: 0.517 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.197821378707886
Epoch: 8, Steps: 13 | Train Loss: 0.387 Vali Loss: 0.524 Vali Acc: 0.741 Test Loss: 0.524 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.27042555809021
Epoch: 9, Steps: 13 | Train Loss: 0.337 Vali Loss: 0.551 Vali Acc: 0.746 Test Loss: 0.551 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.062761306762695
Epoch: 10, Steps: 13 | Train Loss: 0.333 Vali Loss: 0.547 Vali Acc: 0.756 Test Loss: 0.547 Test Acc: 0.756
Validation loss decreased (-0.756092 --> -0.756092).  Saving model ...
Epoch: 11 cost time: 5.251769542694092
Epoch: 11, Steps: 13 | Train Loss: 0.292 Vali Loss: 0.500 Vali Acc: 0.751 Test Loss: 0.500 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.265221357345581
Epoch: 12, Steps: 13 | Train Loss: 0.278 Vali Loss: 0.513 Vali Acc: 0.756 Test Loss: 0.513 Test Acc: 0.756
Validation loss decreased (-0.756092 --> -0.756092).  Saving model ...
Epoch: 13 cost time: 5.115512132644653
Epoch: 13, Steps: 13 | Train Loss: 0.224 Vali Loss: 0.574 Vali Acc: 0.668 Test Loss: 0.574 Test Acc: 0.668
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.180867910385132
Epoch: 14, Steps: 13 | Train Loss: 0.233 Vali Loss: 0.534 Vali Acc: 0.780 Test Loss: 0.534 Test Acc: 0.780
Validation loss decreased (-0.756092 --> -0.780482).  Saving model ...
Epoch: 15 cost time: 5.22905421257019
Epoch: 15, Steps: 13 | Train Loss: 0.187 Vali Loss: 0.552 Vali Acc: 0.712 Test Loss: 0.552 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.303700923919678
Epoch: 16, Steps: 13 | Train Loss: 0.153 Vali Loss: 0.560 Vali Acc: 0.741 Test Loss: 0.560 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.194895267486572
Epoch: 17, Steps: 13 | Train Loss: 0.161 Vali Loss: 0.588 Vali Acc: 0.727 Test Loss: 0.588 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.2110302448272705
Epoch: 18, Steps: 13 | Train Loss: 0.132 Vali Loss: 0.602 Vali Acc: 0.707 Test Loss: 0.602 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 5.280100345611572
Epoch: 19, Steps: 13 | Train Loss: 0.120 Vali Loss: 0.600 Vali Acc: 0.717 Test Loss: 0.600 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 5.280623197555542
Epoch: 20, Steps: 13 | Train Loss: 0.087 Vali Loss: 0.633 Vali Acc: 0.741 Test Loss: 0.633 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 5.191298723220825
Epoch: 21, Steps: 13 | Train Loss: 0.073 Vali Loss: 0.689 Vali Acc: 0.766 Test Loss: 0.689 Test Acc: 0.766
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 5.191408634185791
Epoch: 22, Steps: 13 | Train Loss: 0.067 Vali Loss: 0.749 Vali Acc: 0.776 Test Loss: 0.749 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 5.193134546279907
Epoch: 23, Steps: 13 | Train Loss: 0.056 Vali Loss: 0.700 Vali Acc: 0.766 Test Loss: 0.700 Test Acc: 0.766
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 5.230931282043457
Epoch: 24, Steps: 13 | Train Loss: 0.054 Vali Loss: 0.768 Vali Acc: 0.776 Test Loss: 0.768 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7804878048780488
model parameter : 602290
model size : 2.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.953007698059082
Epoch: 1, Steps: 13 | Train Loss: 0.685 Vali Loss: 0.594 Vali Acc: 0.722 Test Loss: 0.594 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 3.258014440536499
Epoch: 2, Steps: 13 | Train Loss: 0.582 Vali Loss: 0.574 Vali Acc: 0.727 Test Loss: 0.574 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 3.2717978954315186
Epoch: 3, Steps: 13 | Train Loss: 0.559 Vali Loss: 0.555 Vali Acc: 0.722 Test Loss: 0.555 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.3239405155181885
Epoch: 4, Steps: 13 | Train Loss: 0.500 Vali Loss: 0.532 Vali Acc: 0.741 Test Loss: 0.532 Test Acc: 0.741
Validation loss decreased (-0.726824 --> -0.741458).  Saving model ...
Epoch: 5 cost time: 3.2448995113372803
Epoch: 5, Steps: 13 | Train Loss: 0.480 Vali Loss: 0.521 Vali Acc: 0.746 Test Loss: 0.521 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746336).  Saving model ...
Epoch: 6 cost time: 3.2241132259368896
Epoch: 6, Steps: 13 | Train Loss: 0.428 Vali Loss: 0.515 Vali Acc: 0.756 Test Loss: 0.515 Test Acc: 0.756
Validation loss decreased (-0.746336 --> -0.756092).  Saving model ...
Epoch: 7 cost time: 3.3052656650543213
Epoch: 7, Steps: 13 | Train Loss: 0.408 Vali Loss: 0.521 Vali Acc: 0.737 Test Loss: 0.521 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.2626519203186035
Epoch: 8, Steps: 13 | Train Loss: 0.358 Vali Loss: 0.516 Vali Acc: 0.766 Test Loss: 0.516 Test Acc: 0.766
Validation loss decreased (-0.756092 --> -0.765848).  Saving model ...
Epoch: 9 cost time: 3.2763054370880127
Epoch: 9, Steps: 13 | Train Loss: 0.332 Vali Loss: 0.562 Vali Acc: 0.727 Test Loss: 0.562 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.305647373199463
Epoch: 10, Steps: 13 | Train Loss: 0.304 Vali Loss: 0.534 Vali Acc: 0.732 Test Loss: 0.534 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.2188332080841064
Epoch: 11, Steps: 13 | Train Loss: 0.264 Vali Loss: 0.543 Vali Acc: 0.766 Test Loss: 0.543 Test Acc: 0.766
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.252349853515625
Epoch: 12, Steps: 13 | Train Loss: 0.223 Vali Loss: 0.643 Vali Acc: 0.649 Test Loss: 0.643 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.2547171115875244
Epoch: 13, Steps: 13 | Train Loss: 0.243 Vali Loss: 0.641 Vali Acc: 0.693 Test Loss: 0.641 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.31925368309021
Epoch: 14, Steps: 13 | Train Loss: 0.192 Vali Loss: 0.640 Vali Acc: 0.688 Test Loss: 0.640 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.2403934001922607
Epoch: 15, Steps: 13 | Train Loss: 0.206 Vali Loss: 0.597 Vali Acc: 0.732 Test Loss: 0.597 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.2149243354797363
Epoch: 16, Steps: 13 | Train Loss: 0.160 Vali Loss: 0.654 Vali Acc: 0.698 Test Loss: 0.654 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.2567460536956787
Epoch: 17, Steps: 13 | Train Loss: 0.161 Vali Loss: 0.829 Vali Acc: 0.629 Test Loss: 0.829 Test Acc: 0.629
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.2726547718048096
Epoch: 18, Steps: 13 | Train Loss: 0.182 Vali Loss: 0.646 Vali Acc: 0.737 Test Loss: 0.646 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 188402
model size : 1.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.186839818954468
Epoch: 1, Steps: 13 | Train Loss: 0.622 Vali Loss: 0.606 Vali Acc: 0.717 Test Loss: 0.606 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 4.561843395233154
Epoch: 2, Steps: 13 | Train Loss: 0.571 Vali Loss: 0.564 Vali Acc: 0.717 Test Loss: 0.564 Test Acc: 0.717
Validation loss decreased (-0.717067 --> -0.717068).  Saving model ...
Epoch: 3 cost time: 4.469196081161499
Epoch: 3, Steps: 13 | Train Loss: 0.527 Vali Loss: 0.564 Vali Acc: 0.712 Test Loss: 0.564 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.483877897262573
Epoch: 4, Steps: 13 | Train Loss: 0.508 Vali Loss: 0.540 Vali Acc: 0.722 Test Loss: 0.540 Test Acc: 0.722
Validation loss decreased (-0.717068 --> -0.721946).  Saving model ...
Epoch: 5 cost time: 4.516684532165527
Epoch: 5, Steps: 13 | Train Loss: 0.453 Vali Loss: 0.518 Vali Acc: 0.756 Test Loss: 0.518 Test Acc: 0.756
Validation loss decreased (-0.721946 --> -0.756092).  Saving model ...
Epoch: 6 cost time: 4.442612648010254
Epoch: 6, Steps: 13 | Train Loss: 0.421 Vali Loss: 0.531 Vali Acc: 0.756 Test Loss: 0.531 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.540123462677002
Epoch: 7, Steps: 13 | Train Loss: 0.402 Vali Loss: 0.507 Vali Acc: 0.741 Test Loss: 0.507 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.472071170806885
Epoch: 8, Steps: 13 | Train Loss: 0.392 Vali Loss: 0.514 Vali Acc: 0.761 Test Loss: 0.514 Test Acc: 0.761
Validation loss decreased (-0.756092 --> -0.760970).  Saving model ...
Epoch: 9 cost time: 4.4281861782073975
Epoch: 9, Steps: 13 | Train Loss: 0.339 Vali Loss: 0.518 Vali Acc: 0.771 Test Loss: 0.518 Test Acc: 0.771
Validation loss decreased (-0.760970 --> -0.770727).  Saving model ...
Epoch: 10 cost time: 4.620586633682251
Epoch: 10, Steps: 13 | Train Loss: 0.324 Vali Loss: 0.551 Vali Acc: 0.771 Test Loss: 0.551 Test Acc: 0.771
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.208220720291138
Epoch: 11, Steps: 13 | Train Loss: 0.286 Vali Loss: 0.527 Vali Acc: 0.717 Test Loss: 0.527 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.38596248626709
Epoch: 12, Steps: 13 | Train Loss: 0.270 Vali Loss: 0.544 Vali Acc: 0.693 Test Loss: 0.544 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.362797498703003
Epoch: 13, Steps: 13 | Train Loss: 0.244 Vali Loss: 0.566 Vali Acc: 0.663 Test Loss: 0.566 Test Acc: 0.663
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.349011421203613
Epoch: 14, Steps: 13 | Train Loss: 0.256 Vali Loss: 0.529 Vali Acc: 0.751 Test Loss: 0.529 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.3109190464019775
Epoch: 15, Steps: 13 | Train Loss: 0.191 Vali Loss: 0.556 Vali Acc: 0.698 Test Loss: 0.556 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.3444905281066895
Epoch: 16, Steps: 13 | Train Loss: 0.167 Vali Loss: 0.562 Vali Acc: 0.712 Test Loss: 0.562 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.197925806045532
Epoch: 17, Steps: 13 | Train Loss: 0.155 Vali Loss: 0.573 Vali Acc: 0.727 Test Loss: 0.573 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.268347978591919
Epoch: 18, Steps: 13 | Train Loss: 0.135 Vali Loss: 0.714 Vali Acc: 0.639 Test Loss: 0.714 Test Acc: 0.639
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.3031275272369385
Epoch: 19, Steps: 13 | Train Loss: 0.147 Vali Loss: 0.620 Vali Acc: 0.663 Test Loss: 0.620 Test Acc: 0.663
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 602290
model size : 2.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.332223176956177
Epoch: 1, Steps: 13 | Train Loss: 0.684 Vali Loss: 0.598 Vali Acc: 0.722 Test Loss: 0.598 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.6452295780181885
Epoch: 2, Steps: 13 | Train Loss: 0.586 Vali Loss: 0.576 Vali Acc: 0.722 Test Loss: 0.576 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 2.719680070877075
Epoch: 3, Steps: 13 | Train Loss: 0.559 Vali Loss: 0.558 Vali Acc: 0.717 Test Loss: 0.558 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.6516835689544678
Epoch: 4, Steps: 13 | Train Loss: 0.499 Vali Loss: 0.534 Vali Acc: 0.751 Test Loss: 0.534 Test Acc: 0.751
Validation loss decreased (-0.721945 --> -0.751214).  Saving model ...
Epoch: 5 cost time: 2.667541980743408
Epoch: 5, Steps: 13 | Train Loss: 0.478 Vali Loss: 0.523 Vali Acc: 0.756 Test Loss: 0.523 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756092).  Saving model ...
Epoch: 6 cost time: 2.6885838508605957
Epoch: 6, Steps: 13 | Train Loss: 0.429 Vali Loss: 0.514 Vali Acc: 0.761 Test Loss: 0.514 Test Acc: 0.761
Validation loss decreased (-0.756092 --> -0.760970).  Saving model ...
Epoch: 7 cost time: 2.7058892250061035
Epoch: 7, Steps: 13 | Train Loss: 0.416 Vali Loss: 0.532 Vali Acc: 0.737 Test Loss: 0.532 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.718498706817627
Epoch: 8, Steps: 13 | Train Loss: 0.366 Vali Loss: 0.510 Vali Acc: 0.766 Test Loss: 0.510 Test Acc: 0.766
Validation loss decreased (-0.760970 --> -0.765849).  Saving model ...
Epoch: 9 cost time: 2.6901650428771973
Epoch: 9, Steps: 13 | Train Loss: 0.333 Vali Loss: 0.541 Vali Acc: 0.741 Test Loss: 0.541 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.645408868789673
Epoch: 10, Steps: 13 | Train Loss: 0.306 Vali Loss: 0.517 Vali Acc: 0.741 Test Loss: 0.517 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.6764769554138184
Epoch: 11, Steps: 13 | Train Loss: 0.265 Vali Loss: 0.537 Vali Acc: 0.751 Test Loss: 0.537 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.7509992122650146
Epoch: 12, Steps: 13 | Train Loss: 0.227 Vali Loss: 0.586 Vali Acc: 0.698 Test Loss: 0.586 Test Acc: 0.698
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.719759941101074
Epoch: 13, Steps: 13 | Train Loss: 0.228 Vali Loss: 0.756 Vali Acc: 0.600 Test Loss: 0.756 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.712506055831909
Epoch: 14, Steps: 13 | Train Loss: 0.214 Vali Loss: 0.649 Vali Acc: 0.678 Test Loss: 0.649 Test Acc: 0.678
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.742553234100342
Epoch: 15, Steps: 13 | Train Loss: 0.224 Vali Loss: 0.604 Vali Acc: 0.751 Test Loss: 0.604 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.822547197341919
Epoch: 16, Steps: 13 | Train Loss: 0.175 Vali Loss: 0.611 Vali Acc: 0.732 Test Loss: 0.611 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.753657579421997
Epoch: 17, Steps: 13 | Train Loss: 0.156 Vali Loss: 0.761 Vali Acc: 0.615 Test Loss: 0.761 Test Acc: 0.615
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.715399980545044
Epoch: 18, Steps: 13 | Train Loss: 0.169 Vali Loss: 0.632 Vali Acc: 0.732 Test Loss: 0.632 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 188402
model size : 1.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.366694450378418
Epoch: 1, Steps: 13 | Train Loss: 0.625 Vali Loss: 0.607 Vali Acc: 0.717 Test Loss: 0.607 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 2.7055091857910156
Epoch: 2, Steps: 13 | Train Loss: 0.569 Vali Loss: 0.565 Vali Acc: 0.717 Test Loss: 0.565 Test Acc: 0.717
Validation loss decreased (-0.717067 --> -0.717068).  Saving model ...
Epoch: 3 cost time: 2.6760826110839844
Epoch: 3, Steps: 13 | Train Loss: 0.528 Vali Loss: 0.567 Vali Acc: 0.717 Test Loss: 0.567 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.7175612449645996
Epoch: 4, Steps: 13 | Train Loss: 0.510 Vali Loss: 0.538 Vali Acc: 0.722 Test Loss: 0.538 Test Acc: 0.722
Validation loss decreased (-0.717068 --> -0.721946).  Saving model ...
Epoch: 5 cost time: 2.711017608642578
Epoch: 5, Steps: 13 | Train Loss: 0.460 Vali Loss: 0.512 Vali Acc: 0.756 Test Loss: 0.512 Test Acc: 0.756
Validation loss decreased (-0.721946 --> -0.756092).  Saving model ...
Epoch: 6 cost time: 2.647411823272705
Epoch: 6, Steps: 13 | Train Loss: 0.429 Vali Loss: 0.530 Vali Acc: 0.756 Test Loss: 0.530 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.5175015926361084
Epoch: 7, Steps: 13 | Train Loss: 0.404 Vali Loss: 0.509 Vali Acc: 0.751 Test Loss: 0.509 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.702802896499634
Epoch: 8, Steps: 13 | Train Loss: 0.383 Vali Loss: 0.509 Vali Acc: 0.756 Test Loss: 0.509 Test Acc: 0.756
Validation loss decreased (-0.756092 --> -0.756092).  Saving model ...
Epoch: 9 cost time: 2.65130615234375
Epoch: 9, Steps: 13 | Train Loss: 0.348 Vali Loss: 0.508 Vali Acc: 0.766 Test Loss: 0.508 Test Acc: 0.766
Validation loss decreased (-0.756092 --> -0.765849).  Saving model ...
Epoch: 10 cost time: 2.725128650665283
Epoch: 10, Steps: 13 | Train Loss: 0.326 Vali Loss: 0.504 Vali Acc: 0.766 Test Loss: 0.504 Test Acc: 0.766
Validation loss decreased (-0.765849 --> -0.765849).  Saving model ...
Epoch: 11 cost time: 2.7131686210632324
Epoch: 11, Steps: 13 | Train Loss: 0.309 Vali Loss: 0.513 Vali Acc: 0.722 Test Loss: 0.513 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.697809934616089
Epoch: 12, Steps: 13 | Train Loss: 0.269 Vali Loss: 0.519 Vali Acc: 0.732 Test Loss: 0.519 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.739224910736084
Epoch: 13, Steps: 13 | Train Loss: 0.223 Vali Loss: 0.576 Vali Acc: 0.673 Test Loss: 0.576 Test Acc: 0.673
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.7064905166625977
Epoch: 14, Steps: 13 | Train Loss: 0.217 Vali Loss: 0.583 Vali Acc: 0.693 Test Loss: 0.583 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.768369197845459
Epoch: 15, Steps: 13 | Train Loss: 0.205 Vali Loss: 0.573 Vali Acc: 0.683 Test Loss: 0.573 Test Acc: 0.683
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.724222421646118
Epoch: 16, Steps: 13 | Train Loss: 0.172 Vali Loss: 0.586 Vali Acc: 0.678 Test Loss: 0.586 Test Acc: 0.678
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.652059316635132
Epoch: 17, Steps: 13 | Train Loss: 0.163 Vali Loss: 0.658 Vali Acc: 0.654 Test Loss: 0.658 Test Acc: 0.654
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.725013017654419
Epoch: 18, Steps: 13 | Train Loss: 0.140 Vali Loss: 0.786 Vali Acc: 0.595 Test Loss: 0.786 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.8321220874786377
Epoch: 19, Steps: 13 | Train Loss: 0.149 Vali Loss: 0.614 Vali Acc: 0.717 Test Loss: 0.614 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.72566819190979
Epoch: 20, Steps: 13 | Train Loss: 0.105 Vali Loss: 0.635 Vali Acc: 0.732 Test Loss: 0.635 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 602290
model size : 2.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.6289427280426025
Epoch: 1, Steps: 13 | Train Loss: 0.684 Vali Loss: 0.598 Vali Acc: 0.722 Test Loss: 0.598 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.8878729343414307
Epoch: 2, Steps: 13 | Train Loss: 0.585 Vali Loss: 0.576 Vali Acc: 0.717 Test Loss: 0.576 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.902371883392334
Epoch: 3, Steps: 13 | Train Loss: 0.558 Vali Loss: 0.558 Vali Acc: 0.717 Test Loss: 0.558 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.89691162109375
Epoch: 4, Steps: 13 | Train Loss: 0.499 Vali Loss: 0.534 Vali Acc: 0.746 Test Loss: 0.534 Test Acc: 0.746
Validation loss decreased (-0.721945 --> -0.746336).  Saving model ...
Epoch: 5 cost time: 1.91050124168396
Epoch: 5, Steps: 13 | Train Loss: 0.479 Vali Loss: 0.525 Vali Acc: 0.756 Test Loss: 0.525 Test Acc: 0.756
Validation loss decreased (-0.746336 --> -0.756092).  Saving model ...
Epoch: 6 cost time: 1.8450117111206055
Epoch: 6, Steps: 13 | Train Loss: 0.431 Vali Loss: 0.516 Vali Acc: 0.766 Test Loss: 0.516 Test Acc: 0.766
Validation loss decreased (-0.756092 --> -0.765849).  Saving model ...
Epoch: 7 cost time: 1.9871444702148438
Epoch: 7, Steps: 13 | Train Loss: 0.410 Vali Loss: 0.513 Vali Acc: 0.761 Test Loss: 0.513 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.880133867263794
Epoch: 8, Steps: 13 | Train Loss: 0.361 Vali Loss: 0.520 Vali Acc: 0.756 Test Loss: 0.520 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.93570876121521
Epoch: 9, Steps: 13 | Train Loss: 0.337 Vali Loss: 0.551 Vali Acc: 0.737 Test Loss: 0.551 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.895460844039917
Epoch: 10, Steps: 13 | Train Loss: 0.313 Vali Loss: 0.526 Vali Acc: 0.746 Test Loss: 0.526 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.902467966079712
Epoch: 11, Steps: 13 | Train Loss: 0.274 Vali Loss: 0.545 Vali Acc: 0.766 Test Loss: 0.545 Test Acc: 0.766
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.7658884525299072
Epoch: 12, Steps: 13 | Train Loss: 0.232 Vali Loss: 0.593 Vali Acc: 0.659 Test Loss: 0.593 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.96486234664917
Epoch: 13, Steps: 13 | Train Loss: 0.237 Vali Loss: 0.678 Vali Acc: 0.615 Test Loss: 0.678 Test Acc: 0.615
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.9199817180633545
Epoch: 14, Steps: 13 | Train Loss: 0.235 Vali Loss: 0.604 Vali Acc: 0.693 Test Loss: 0.604 Test Acc: 0.693
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.9628965854644775
Epoch: 15, Steps: 13 | Train Loss: 0.218 Vali Loss: 0.616 Vali Acc: 0.737 Test Loss: 0.616 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.947901964187622
Epoch: 16, Steps: 13 | Train Loss: 0.180 Vali Loss: 0.658 Vali Acc: 0.659 Test Loss: 0.658 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 188402
model size : 1.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.533003091812134
Epoch: 1, Steps: 13 | Train Loss: 0.624 Vali Loss: 0.589 Vali Acc: 0.722 Test Loss: 0.589 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.62964129447937
Epoch: 2, Steps: 13 | Train Loss: 0.572 Vali Loss: 0.564 Vali Acc: 0.722 Test Loss: 0.564 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721946).  Saving model ...
Epoch: 3 cost time: 4.60668158531189
Epoch: 3, Steps: 13 | Train Loss: 0.528 Vali Loss: 0.553 Vali Acc: 0.717 Test Loss: 0.553 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.6971940994262695
Epoch: 4, Steps: 13 | Train Loss: 0.499 Vali Loss: 0.539 Vali Acc: 0.741 Test Loss: 0.539 Test Acc: 0.741
Validation loss decreased (-0.721946 --> -0.741458).  Saving model ...
Epoch: 5 cost time: 4.647236585617065
Epoch: 5, Steps: 13 | Train Loss: 0.473 Vali Loss: 0.523 Vali Acc: 0.741 Test Loss: 0.523 Test Acc: 0.741
Validation loss decreased (-0.741458 --> -0.741458).  Saving model ...
Epoch: 6 cost time: 4.6594014167785645
Epoch: 6, Steps: 13 | Train Loss: 0.433 Vali Loss: 0.534 Vali Acc: 0.766 Test Loss: 0.534 Test Acc: 0.766
Validation loss decreased (-0.741458 --> -0.765848).  Saving model ...
Epoch: 7 cost time: 4.664376974105835
Epoch: 7, Steps: 13 | Train Loss: 0.424 Vali Loss: 0.566 Vali Acc: 0.741 Test Loss: 0.566 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.491284608840942
Epoch: 8, Steps: 13 | Train Loss: 0.362 Vali Loss: 0.533 Vali Acc: 0.741 Test Loss: 0.533 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.649034261703491
Epoch: 9, Steps: 13 | Train Loss: 0.351 Vali Loss: 0.592 Vali Acc: 0.737 Test Loss: 0.592 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.694113731384277
Epoch: 10, Steps: 13 | Train Loss: 0.352 Vali Loss: 0.516 Vali Acc: 0.741 Test Loss: 0.516 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.548997402191162
Epoch: 11, Steps: 13 | Train Loss: 0.291 Vali Loss: 0.518 Vali Acc: 0.746 Test Loss: 0.518 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.704580783843994
Epoch: 12, Steps: 13 | Train Loss: 0.268 Vali Loss: 0.526 Vali Acc: 0.737 Test Loss: 0.526 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.726013422012329
Epoch: 13, Steps: 13 | Train Loss: 0.267 Vali Loss: 0.531 Vali Acc: 0.727 Test Loss: 0.531 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.712334394454956
Epoch: 14, Steps: 13 | Train Loss: 0.226 Vali Loss: 0.536 Vali Acc: 0.776 Test Loss: 0.536 Test Acc: 0.776
Validation loss decreased (-0.765848 --> -0.775604).  Saving model ...
Epoch: 15 cost time: 4.738161563873291
Epoch: 15, Steps: 13 | Train Loss: 0.207 Vali Loss: 0.789 Vali Acc: 0.537 Test Loss: 0.789 Test Acc: 0.537
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.740393400192261
Epoch: 16, Steps: 13 | Train Loss: 0.214 Vali Loss: 0.552 Vali Acc: 0.698 Test Loss: 0.552 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.61444091796875
Epoch: 17, Steps: 13 | Train Loss: 0.210 Vali Loss: 0.679 Vali Acc: 0.746 Test Loss: 0.679 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.7470128536224365
Epoch: 18, Steps: 13 | Train Loss: 0.149 Vali Loss: 0.576 Vali Acc: 0.712 Test Loss: 0.576 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.639230489730835
Epoch: 19, Steps: 13 | Train Loss: 0.137 Vali Loss: 0.666 Vali Acc: 0.624 Test Loss: 0.666 Test Acc: 0.624
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.666515350341797
Epoch: 20, Steps: 13 | Train Loss: 0.126 Vali Loss: 0.603 Vali Acc: 0.688 Test Loss: 0.603 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.642459392547607
Epoch: 21, Steps: 13 | Train Loss: 0.134 Vali Loss: 0.649 Vali Acc: 0.654 Test Loss: 0.649 Test Acc: 0.654
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.742694616317749
Epoch: 22, Steps: 13 | Train Loss: 0.078 Vali Loss: 0.627 Vali Acc: 0.707 Test Loss: 0.627 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.679842233657837
Epoch: 23, Steps: 13 | Train Loss: 0.076 Vali Loss: 0.711 Vali Acc: 0.673 Test Loss: 0.711 Test Acc: 0.673
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 4.686497211456299
Epoch: 24, Steps: 13 | Train Loss: 0.071 Vali Loss: 0.655 Vali Acc: 0.693 Test Loss: 0.655 Test Acc: 0.693
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 309234
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.626514196395874
Epoch: 1, Steps: 13 | Train Loss: 0.610 Vali Loss: 0.603 Vali Acc: 0.717 Test Loss: 0.603 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 3.0380961894989014
Epoch: 2, Steps: 13 | Train Loss: 0.591 Vali Loss: 0.578 Vali Acc: 0.712 Test Loss: 0.578 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.022566556930542
Epoch: 3, Steps: 13 | Train Loss: 0.548 Vali Loss: 0.565 Vali Acc: 0.722 Test Loss: 0.565 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721946).  Saving model ...
Epoch: 4 cost time: 2.965208053588867
Epoch: 4, Steps: 13 | Train Loss: 0.517 Vali Loss: 0.553 Vali Acc: 0.732 Test Loss: 0.553 Test Acc: 0.732
Validation loss decreased (-0.721946 --> -0.731702).  Saving model ...
Epoch: 5 cost time: 2.9874424934387207
Epoch: 5, Steps: 13 | Train Loss: 0.478 Vali Loss: 0.544 Vali Acc: 0.732 Test Loss: 0.544 Test Acc: 0.732
Validation loss decreased (-0.731702 --> -0.731702).  Saving model ...
Epoch: 6 cost time: 2.983241081237793
Epoch: 6, Steps: 13 | Train Loss: 0.457 Vali Loss: 0.548 Vali Acc: 0.717 Test Loss: 0.548 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.9913291931152344
Epoch: 7, Steps: 13 | Train Loss: 0.420 Vali Loss: 0.539 Vali Acc: 0.722 Test Loss: 0.539 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.9915411472320557
Epoch: 8, Steps: 13 | Train Loss: 0.385 Vali Loss: 0.605 Vali Acc: 0.741 Test Loss: 0.605 Test Acc: 0.741
Validation loss decreased (-0.731702 --> -0.741457).  Saving model ...
Epoch: 9 cost time: 2.9765512943267822
Epoch: 9, Steps: 13 | Train Loss: 0.380 Vali Loss: 0.633 Vali Acc: 0.629 Test Loss: 0.633 Test Acc: 0.629
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.955566883087158
Epoch: 10, Steps: 13 | Train Loss: 0.360 Vali Loss: 0.550 Vali Acc: 0.722 Test Loss: 0.550 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.9629104137420654
Epoch: 11, Steps: 13 | Train Loss: 0.302 Vali Loss: 0.570 Vali Acc: 0.732 Test Loss: 0.570 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.988684892654419
Epoch: 12, Steps: 13 | Train Loss: 0.278 Vali Loss: 0.568 Vali Acc: 0.722 Test Loss: 0.568 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.965928554534912
Epoch: 13, Steps: 13 | Train Loss: 0.260 Vali Loss: 0.629 Vali Acc: 0.639 Test Loss: 0.629 Test Acc: 0.639
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.9884421825408936
Epoch: 14, Steps: 13 | Train Loss: 0.272 Vali Loss: 0.599 Vali Acc: 0.673 Test Loss: 0.599 Test Acc: 0.673
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.974529266357422
Epoch: 15, Steps: 13 | Train Loss: 0.278 Vali Loss: 0.698 Vali Acc: 0.746 Test Loss: 0.698 Test Acc: 0.746
Validation loss decreased (-0.741457 --> -0.746334).  Saving model ...
Epoch: 16 cost time: 2.973172903060913
Epoch: 16, Steps: 13 | Train Loss: 0.216 Vali Loss: 0.633 Vali Acc: 0.732 Test Loss: 0.633 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.0154731273651123
Epoch: 17, Steps: 13 | Train Loss: 0.199 Vali Loss: 0.616 Vali Acc: 0.722 Test Loss: 0.616 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.976778745651245
Epoch: 18, Steps: 13 | Train Loss: 0.175 Vali Loss: 0.728 Vali Acc: 0.590 Test Loss: 0.728 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.0361032485961914
Epoch: 19, Steps: 13 | Train Loss: 0.189 Vali Loss: 0.642 Vali Acc: 0.673 Test Loss: 0.642 Test Acc: 0.673
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.986356496810913
Epoch: 20, Steps: 13 | Train Loss: 0.188 Vali Loss: 0.814 Vali Acc: 0.732 Test Loss: 0.814 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.9589498043060303
Epoch: 21, Steps: 13 | Train Loss: 0.155 Vali Loss: 0.656 Vali Acc: 0.688 Test Loss: 0.656 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.9821619987487793
Epoch: 22, Steps: 13 | Train Loss: 0.108 Vali Loss: 0.637 Vali Acc: 0.707 Test Loss: 0.637 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.959524154663086
Epoch: 23, Steps: 13 | Train Loss: 0.083 Vali Loss: 0.646 Vali Acc: 0.707 Test Loss: 0.646 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.0087907314300537
Epoch: 24, Steps: 13 | Train Loss: 0.089 Vali Loss: 0.657 Vali Acc: 0.717 Test Loss: 0.657 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.0470964908599854
Epoch: 25, Steps: 13 | Train Loss: 0.075 Vali Loss: 0.744 Vali Acc: 0.624 Test Loss: 0.744 Test Acc: 0.624
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 102258
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.687224626541138
Epoch: 1, Steps: 13 | Train Loss: 0.624 Vali Loss: 0.590 Vali Acc: 0.722 Test Loss: 0.590 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 3.9687952995300293
Epoch: 2, Steps: 13 | Train Loss: 0.574 Vali Loss: 0.565 Vali Acc: 0.722 Test Loss: 0.565 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721946).  Saving model ...
Epoch: 3 cost time: 3.988551378250122
Epoch: 3, Steps: 13 | Train Loss: 0.530 Vali Loss: 0.554 Vali Acc: 0.717 Test Loss: 0.554 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.9476702213287354
Epoch: 4, Steps: 13 | Train Loss: 0.503 Vali Loss: 0.539 Vali Acc: 0.737 Test Loss: 0.539 Test Acc: 0.737
Validation loss decreased (-0.721946 --> -0.736580).  Saving model ...
Epoch: 5 cost time: 3.9244906902313232
Epoch: 5, Steps: 13 | Train Loss: 0.479 Vali Loss: 0.523 Vali Acc: 0.746 Test Loss: 0.523 Test Acc: 0.746
Validation loss decreased (-0.736580 --> -0.746336).  Saving model ...
Epoch: 6 cost time: 3.8219826221466064
Epoch: 6, Steps: 13 | Train Loss: 0.432 Vali Loss: 0.538 Vali Acc: 0.746 Test Loss: 0.538 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.917418956756592
Epoch: 7, Steps: 13 | Train Loss: 0.430 Vali Loss: 0.565 Vali Acc: 0.737 Test Loss: 0.565 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.8385725021362305
Epoch: 8, Steps: 13 | Train Loss: 0.375 Vali Loss: 0.527 Vali Acc: 0.741 Test Loss: 0.527 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.7749359607696533
Epoch: 9, Steps: 13 | Train Loss: 0.364 Vali Loss: 0.558 Vali Acc: 0.741 Test Loss: 0.558 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.74692702293396
Epoch: 10, Steps: 13 | Train Loss: 0.363 Vali Loss: 0.532 Vali Acc: 0.698 Test Loss: 0.532 Test Acc: 0.698
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.7397124767303467
Epoch: 11, Steps: 13 | Train Loss: 0.315 Vali Loss: 0.538 Vali Acc: 0.776 Test Loss: 0.538 Test Acc: 0.776
Validation loss decreased (-0.746336 --> -0.775604).  Saving model ...
Epoch: 12 cost time: 3.7166411876678467
Epoch: 12, Steps: 13 | Train Loss: 0.292 Vali Loss: 0.527 Vali Acc: 0.776 Test Loss: 0.527 Test Acc: 0.776
Validation loss decreased (-0.775604 --> -0.775604).  Saving model ...
Epoch: 13 cost time: 3.78369140625
Epoch: 13, Steps: 13 | Train Loss: 0.275 Vali Loss: 0.529 Vali Acc: 0.688 Test Loss: 0.529 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.7847068309783936
Epoch: 14, Steps: 13 | Train Loss: 0.243 Vali Loss: 0.545 Vali Acc: 0.785 Test Loss: 0.545 Test Acc: 0.785
Validation loss decreased (-0.775604 --> -0.785360).  Saving model ...
Epoch: 15 cost time: 3.76293683052063
Epoch: 15, Steps: 13 | Train Loss: 0.207 Vali Loss: 0.736 Vali Acc: 0.580 Test Loss: 0.736 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.7309935092926025
Epoch: 16, Steps: 13 | Train Loss: 0.214 Vali Loss: 0.558 Vali Acc: 0.693 Test Loss: 0.558 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.670729160308838
Epoch: 17, Steps: 13 | Train Loss: 0.219 Vali Loss: 0.817 Vali Acc: 0.746 Test Loss: 0.817 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.777193069458008
Epoch: 18, Steps: 13 | Train Loss: 0.159 Vali Loss: 0.610 Vali Acc: 0.688 Test Loss: 0.610 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.643718957901001
Epoch: 19, Steps: 13 | Train Loss: 0.171 Vali Loss: 0.653 Vali Acc: 0.634 Test Loss: 0.653 Test Acc: 0.634
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.7315564155578613
Epoch: 20, Steps: 13 | Train Loss: 0.127 Vali Loss: 0.596 Vali Acc: 0.707 Test Loss: 0.596 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.6572532653808594
Epoch: 21, Steps: 13 | Train Loss: 0.154 Vali Loss: 0.697 Vali Acc: 0.620 Test Loss: 0.697 Test Acc: 0.620
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.588423013687134
Epoch: 22, Steps: 13 | Train Loss: 0.089 Vali Loss: 0.665 Vali Acc: 0.649 Test Loss: 0.665 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.6965084075927734
Epoch: 23, Steps: 13 | Train Loss: 0.086 Vali Loss: 0.753 Vali Acc: 0.585 Test Loss: 0.753 Test Acc: 0.585
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.6061596870422363
Epoch: 24, Steps: 13 | Train Loss: 0.077 Vali Loss: 0.672 Vali Acc: 0.668 Test Loss: 0.672 Test Acc: 0.668
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7853658536585366
model parameter : 309234
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.186697244644165
Epoch: 1, Steps: 13 | Train Loss: 0.609 Vali Loss: 0.604 Vali Acc: 0.717 Test Loss: 0.604 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 2.3477180004119873
Epoch: 2, Steps: 13 | Train Loss: 0.589 Vali Loss: 0.577 Vali Acc: 0.717 Test Loss: 0.577 Test Acc: 0.717
Validation loss decreased (-0.717067 --> -0.717067).  Saving model ...
Epoch: 3 cost time: 2.281282663345337
Epoch: 3, Steps: 13 | Train Loss: 0.549 Vali Loss: 0.563 Vali Acc: 0.717 Test Loss: 0.563 Test Acc: 0.717
Validation loss decreased (-0.717067 --> -0.717068).  Saving model ...
Epoch: 4 cost time: 2.5337162017822266
Epoch: 4, Steps: 13 | Train Loss: 0.516 Vali Loss: 0.550 Vali Acc: 0.732 Test Loss: 0.550 Test Acc: 0.732
Validation loss decreased (-0.717068 --> -0.731702).  Saving model ...
Epoch: 5 cost time: 2.4559102058410645
Epoch: 5, Steps: 13 | Train Loss: 0.480 Vali Loss: 0.540 Vali Acc: 0.737 Test Loss: 0.540 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736580).  Saving model ...
Epoch: 6 cost time: 2.2271032333374023
Epoch: 6, Steps: 13 | Train Loss: 0.457 Vali Loss: 0.538 Vali Acc: 0.732 Test Loss: 0.538 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.433304786682129
Epoch: 7, Steps: 13 | Train Loss: 0.419 Vali Loss: 0.528 Vali Acc: 0.756 Test Loss: 0.528 Test Acc: 0.756
Validation loss decreased (-0.736580 --> -0.756092).  Saving model ...
Epoch: 8 cost time: 2.449753761291504
Epoch: 8, Steps: 13 | Train Loss: 0.391 Vali Loss: 0.612 Vali Acc: 0.741 Test Loss: 0.612 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.428995370864868
Epoch: 9, Steps: 13 | Train Loss: 0.392 Vali Loss: 0.626 Vali Acc: 0.624 Test Loss: 0.626 Test Acc: 0.624
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.4400951862335205
Epoch: 10, Steps: 13 | Train Loss: 0.366 Vali Loss: 0.535 Vali Acc: 0.751 Test Loss: 0.535 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.341297149658203
Epoch: 11, Steps: 13 | Train Loss: 0.308 Vali Loss: 0.552 Vali Acc: 0.741 Test Loss: 0.552 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.43939208984375
Epoch: 12, Steps: 13 | Train Loss: 0.289 Vali Loss: 0.547 Vali Acc: 0.756 Test Loss: 0.547 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.460423469543457
Epoch: 13, Steps: 13 | Train Loss: 0.273 Vali Loss: 0.624 Vali Acc: 0.620 Test Loss: 0.624 Test Acc: 0.620
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.4675238132476807
Epoch: 14, Steps: 13 | Train Loss: 0.301 Vali Loss: 0.541 Vali Acc: 0.727 Test Loss: 0.541 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.3980517387390137
Epoch: 15, Steps: 13 | Train Loss: 0.269 Vali Loss: 0.641 Vali Acc: 0.746 Test Loss: 0.641 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.445435047149658
Epoch: 16, Steps: 13 | Train Loss: 0.219 Vali Loss: 0.635 Vali Acc: 0.737 Test Loss: 0.635 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.509194850921631
Epoch: 17, Steps: 13 | Train Loss: 0.204 Vali Loss: 0.613 Vali Acc: 0.737 Test Loss: 0.613 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 102258
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.8456053733825684
Epoch: 1, Steps: 13 | Train Loss: 0.625 Vali Loss: 0.590 Vali Acc: 0.722 Test Loss: 0.590 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.2905702590942383
Epoch: 2, Steps: 13 | Train Loss: 0.573 Vali Loss: 0.564 Vali Acc: 0.722 Test Loss: 0.564 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721946).  Saving model ...
Epoch: 3 cost time: 2.3669991493225098
Epoch: 3, Steps: 13 | Train Loss: 0.532 Vali Loss: 0.553 Vali Acc: 0.727 Test Loss: 0.553 Test Acc: 0.727
Validation loss decreased (-0.721946 --> -0.726824).  Saving model ...
Epoch: 4 cost time: 2.3038363456726074
Epoch: 4, Steps: 13 | Train Loss: 0.504 Vali Loss: 0.538 Vali Acc: 0.737 Test Loss: 0.538 Test Acc: 0.737
Validation loss decreased (-0.726824 --> -0.736580).  Saving model ...
Epoch: 5 cost time: 2.3829429149627686
Epoch: 5, Steps: 13 | Train Loss: 0.479 Vali Loss: 0.520 Vali Acc: 0.746 Test Loss: 0.520 Test Acc: 0.746
Validation loss decreased (-0.736580 --> -0.746336).  Saving model ...
Epoch: 6 cost time: 2.206204414367676
Epoch: 6, Steps: 13 | Train Loss: 0.433 Vali Loss: 0.538 Vali Acc: 0.756 Test Loss: 0.538 Test Acc: 0.756
Validation loss decreased (-0.746336 --> -0.756092).  Saving model ...
Epoch: 7 cost time: 2.3432114124298096
Epoch: 7, Steps: 13 | Train Loss: 0.437 Vali Loss: 0.562 Vali Acc: 0.732 Test Loss: 0.562 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.422193765640259
Epoch: 8, Steps: 13 | Train Loss: 0.377 Vali Loss: 0.511 Vali Acc: 0.751 Test Loss: 0.511 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.257295846939087
Epoch: 9, Steps: 13 | Train Loss: 0.364 Vali Loss: 0.533 Vali Acc: 0.741 Test Loss: 0.533 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.3578948974609375
Epoch: 10, Steps: 13 | Train Loss: 0.337 Vali Loss: 0.532 Vali Acc: 0.707 Test Loss: 0.532 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.3414411544799805
Epoch: 11, Steps: 13 | Train Loss: 0.314 Vali Loss: 0.520 Vali Acc: 0.785 Test Loss: 0.520 Test Acc: 0.785
Validation loss decreased (-0.756092 --> -0.785361).  Saving model ...
Epoch: 12 cost time: 2.386674404144287
Epoch: 12, Steps: 13 | Train Loss: 0.271 Vali Loss: 0.549 Vali Acc: 0.683 Test Loss: 0.549 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.3001480102539062
Epoch: 13, Steps: 13 | Train Loss: 0.301 Vali Loss: 0.526 Vali Acc: 0.732 Test Loss: 0.526 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.3441503047943115
Epoch: 14, Steps: 13 | Train Loss: 0.244 Vali Loss: 0.559 Vali Acc: 0.756 Test Loss: 0.559 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.1414363384246826
Epoch: 15, Steps: 13 | Train Loss: 0.211 Vali Loss: 0.725 Vali Acc: 0.605 Test Loss: 0.725 Test Acc: 0.605
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.409994125366211
Epoch: 16, Steps: 13 | Train Loss: 0.212 Vali Loss: 0.613 Vali Acc: 0.644 Test Loss: 0.613 Test Acc: 0.644
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.49554181098938
Epoch: 17, Steps: 13 | Train Loss: 0.209 Vali Loss: 0.603 Vali Acc: 0.766 Test Loss: 0.603 Test Acc: 0.766
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.429067373275757
Epoch: 18, Steps: 13 | Train Loss: 0.149 Vali Loss: 0.584 Vali Acc: 0.727 Test Loss: 0.584 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.3933186531066895
Epoch: 19, Steps: 13 | Train Loss: 0.140 Vali Loss: 0.683 Vali Acc: 0.595 Test Loss: 0.683 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.4140212535858154
Epoch: 20, Steps: 13 | Train Loss: 0.149 Vali Loss: 0.603 Vali Acc: 0.712 Test Loss: 0.603 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.368544578552246
Epoch: 21, Steps: 13 | Train Loss: 0.105 Vali Loss: 0.620 Vali Acc: 0.698 Test Loss: 0.620 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7853658536585366
model parameter : 309234
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.7959725856781006
Epoch: 1, Steps: 13 | Train Loss: 0.607 Vali Loss: 0.611 Vali Acc: 0.717 Test Loss: 0.611 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.8757548332214355
Epoch: 2, Steps: 13 | Train Loss: 0.589 Vali Loss: 0.583 Vali Acc: 0.717 Test Loss: 0.583 Test Acc: 0.717
Validation loss decreased (-0.717067 --> -0.717067).  Saving model ...
Epoch: 3 cost time: 1.8898861408233643
Epoch: 3, Steps: 13 | Train Loss: 0.548 Vali Loss: 0.570 Vali Acc: 0.712 Test Loss: 0.570 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9290354251861572
Epoch: 4, Steps: 13 | Train Loss: 0.517 Vali Loss: 0.555 Vali Acc: 0.727 Test Loss: 0.555 Test Acc: 0.727
Validation loss decreased (-0.717067 --> -0.726824).  Saving model ...
Epoch: 5 cost time: 1.9413552284240723
Epoch: 5, Steps: 13 | Train Loss: 0.477 Vali Loss: 0.545 Vali Acc: 0.741 Test Loss: 0.545 Test Acc: 0.741
Validation loss decreased (-0.726824 --> -0.741458).  Saving model ...
Epoch: 6 cost time: 1.8904690742492676
Epoch: 6, Steps: 13 | Train Loss: 0.456 Vali Loss: 0.545 Vali Acc: 0.741 Test Loss: 0.545 Test Acc: 0.741
Validation loss decreased (-0.741458 --> -0.741458).  Saving model ...
Epoch: 7 cost time: 1.8766653537750244
Epoch: 7, Steps: 13 | Train Loss: 0.419 Vali Loss: 0.537 Vali Acc: 0.751 Test Loss: 0.537 Test Acc: 0.751
Validation loss decreased (-0.741458 --> -0.751214).  Saving model ...
Epoch: 8 cost time: 1.8752288818359375
Epoch: 8, Steps: 13 | Train Loss: 0.395 Vali Loss: 0.638 Vali Acc: 0.741 Test Loss: 0.638 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.86973237991333
Epoch: 9, Steps: 13 | Train Loss: 0.399 Vali Loss: 0.672 Vali Acc: 0.600 Test Loss: 0.672 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8862643241882324
Epoch: 10, Steps: 13 | Train Loss: 0.368 Vali Loss: 0.548 Vali Acc: 0.751 Test Loss: 0.548 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.8745522499084473
Epoch: 11, Steps: 13 | Train Loss: 0.310 Vali Loss: 0.569 Vali Acc: 0.746 Test Loss: 0.569 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.8838255405426025
Epoch: 12, Steps: 13 | Train Loss: 0.292 Vali Loss: 0.550 Vali Acc: 0.751 Test Loss: 0.550 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.8943595886230469
Epoch: 13, Steps: 13 | Train Loss: 0.274 Vali Loss: 0.583 Vali Acc: 0.702 Test Loss: 0.583 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.8902010917663574
Epoch: 14, Steps: 13 | Train Loss: 0.283 Vali Loss: 0.554 Vali Acc: 0.722 Test Loss: 0.554 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.8501689434051514
Epoch: 15, Steps: 13 | Train Loss: 0.283 Vali Loss: 0.644 Vali Acc: 0.751 Test Loss: 0.644 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.9148190021514893
Epoch: 16, Steps: 13 | Train Loss: 0.231 Vali Loss: 0.677 Vali Acc: 0.741 Test Loss: 0.677 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.9167351722717285
Epoch: 17, Steps: 13 | Train Loss: 0.205 Vali Loss: 0.628 Vali Acc: 0.746 Test Loss: 0.628 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 102258
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.674643516540527
Epoch: 1, Steps: 13 | Train Loss: 0.627 Vali Loss: 0.588 Vali Acc: 0.712 Test Loss: 0.588 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 6.656672477722168
Epoch: 2, Steps: 13 | Train Loss: 0.581 Vali Loss: 0.580 Vali Acc: 0.712 Test Loss: 0.580 Test Acc: 0.712
Validation loss decreased (-0.712189 --> -0.712189).  Saving model ...
Epoch: 3 cost time: 6.490856170654297
Epoch: 3, Steps: 13 | Train Loss: 0.571 Vali Loss: 0.570 Vali Acc: 0.717 Test Loss: 0.570 Test Acc: 0.717
Validation loss decreased (-0.712189 --> -0.717067).  Saving model ...
Epoch: 4 cost time: 6.709540367126465
Epoch: 4, Steps: 13 | Train Loss: 0.537 Vali Loss: 0.565 Vali Acc: 0.707 Test Loss: 0.565 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.716846466064453
Epoch: 5, Steps: 13 | Train Loss: 0.501 Vali Loss: 0.565 Vali Acc: 0.717 Test Loss: 0.565 Test Acc: 0.717
Validation loss decreased (-0.717067 --> -0.717068).  Saving model ...
Epoch: 6 cost time: 6.726728916168213
Epoch: 6, Steps: 13 | Train Loss: 0.498 Vali Loss: 0.554 Vali Acc: 0.727 Test Loss: 0.554 Test Acc: 0.727
Validation loss decreased (-0.717068 --> -0.726824).  Saving model ...
Epoch: 7 cost time: 6.733492851257324
Epoch: 7, Steps: 13 | Train Loss: 0.491 Vali Loss: 0.550 Vali Acc: 0.722 Test Loss: 0.550 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.717588901519775
Epoch: 8, Steps: 13 | Train Loss: 0.434 Vali Loss: 0.552 Vali Acc: 0.722 Test Loss: 0.552 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.735275983810425
Epoch: 9, Steps: 13 | Train Loss: 0.422 Vali Loss: 0.536 Vali Acc: 0.741 Test Loss: 0.536 Test Acc: 0.741
Validation loss decreased (-0.726824 --> -0.741458).  Saving model ...
Epoch: 10 cost time: 6.597103118896484
Epoch: 10, Steps: 13 | Train Loss: 0.395 Vali Loss: 0.541 Vali Acc: 0.717 Test Loss: 0.541 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.6793787479400635
Epoch: 11, Steps: 13 | Train Loss: 0.382 Vali Loss: 0.531 Vali Acc: 0.732 Test Loss: 0.531 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.669867992401123
Epoch: 12, Steps: 13 | Train Loss: 0.331 Vali Loss: 0.556 Vali Acc: 0.751 Test Loss: 0.556 Test Acc: 0.751
Validation loss decreased (-0.741458 --> -0.751214).  Saving model ...
Epoch: 13 cost time: 6.682775497436523
Epoch: 13, Steps: 13 | Train Loss: 0.333 Vali Loss: 0.554 Vali Acc: 0.693 Test Loss: 0.554 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.683135986328125
Epoch: 14, Steps: 13 | Train Loss: 0.321 Vali Loss: 0.565 Vali Acc: 0.751 Test Loss: 0.565 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.544165849685669
Epoch: 15, Steps: 13 | Train Loss: 0.289 Vali Loss: 0.541 Vali Acc: 0.722 Test Loss: 0.541 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.769798040390015
Epoch: 16, Steps: 13 | Train Loss: 0.268 Vali Loss: 0.563 Vali Acc: 0.712 Test Loss: 0.563 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 6.759218692779541
Epoch: 17, Steps: 13 | Train Loss: 0.264 Vali Loss: 0.547 Vali Acc: 0.732 Test Loss: 0.547 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 6.821619987487793
Epoch: 18, Steps: 13 | Train Loss: 0.246 Vali Loss: 0.569 Vali Acc: 0.693 Test Loss: 0.569 Test Acc: 0.693
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 6.77934718132019
Epoch: 19, Steps: 13 | Train Loss: 0.222 Vali Loss: 0.573 Vali Acc: 0.756 Test Loss: 0.573 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756092).  Saving model ...
Epoch: 20 cost time: 6.759702444076538
Epoch: 20, Steps: 13 | Train Loss: 0.191 Vali Loss: 0.591 Vali Acc: 0.668 Test Loss: 0.591 Test Acc: 0.668
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 6.769141435623169
Epoch: 21, Steps: 13 | Train Loss: 0.211 Vali Loss: 0.593 Vali Acc: 0.693 Test Loss: 0.593 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 6.64084267616272
Epoch: 22, Steps: 13 | Train Loss: 0.187 Vali Loss: 0.603 Vali Acc: 0.659 Test Loss: 0.603 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 6.701300621032715
Epoch: 23, Steps: 13 | Train Loss: 0.165 Vali Loss: 0.619 Vali Acc: 0.702 Test Loss: 0.619 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 6.694465637207031
Epoch: 24, Steps: 13 | Train Loss: 0.165 Vali Loss: 0.633 Vali Acc: 0.659 Test Loss: 0.633 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 6.745062828063965
Epoch: 25, Steps: 13 | Train Loss: 0.166 Vali Loss: 0.641 Vali Acc: 0.678 Test Loss: 0.641 Test Acc: 0.678
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 6.652857303619385
Epoch: 26, Steps: 13 | Train Loss: 0.147 Vali Loss: 0.620 Vali Acc: 0.732 Test Loss: 0.620 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 6.506839990615845
Epoch: 27, Steps: 13 | Train Loss: 0.121 Vali Loss: 0.644 Vali Acc: 0.629 Test Loss: 0.644 Test Acc: 0.629
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 6.827233552932739
Epoch: 28, Steps: 13 | Train Loss: 0.123 Vali Loss: 0.669 Vali Acc: 0.629 Test Loss: 0.669 Test Acc: 0.629
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 6.722954273223877
Epoch: 29, Steps: 13 | Train Loss: 0.110 Vali Loss: 0.659 Vali Acc: 0.707 Test Loss: 0.659 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 594586
model size : 2.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.759131193161011
Epoch: 1, Steps: 13 | Train Loss: 0.721 Vali Loss: 0.597 Vali Acc: 0.722 Test Loss: 0.597 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 3.9602456092834473
Epoch: 2, Steps: 13 | Train Loss: 0.604 Vali Loss: 0.582 Vali Acc: 0.722 Test Loss: 0.582 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 3.9846031665802
Epoch: 3, Steps: 13 | Train Loss: 0.556 Vali Loss: 0.569 Vali Acc: 0.737 Test Loss: 0.569 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736580).  Saving model ...
Epoch: 4 cost time: 3.9703171253204346
Epoch: 4, Steps: 13 | Train Loss: 0.524 Vali Loss: 0.553 Vali Acc: 0.732 Test Loss: 0.553 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.936737060546875
Epoch: 5, Steps: 13 | Train Loss: 0.487 Vali Loss: 0.555 Vali Acc: 0.732 Test Loss: 0.555 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.9008212089538574
Epoch: 6, Steps: 13 | Train Loss: 0.463 Vali Loss: 0.538 Vali Acc: 0.756 Test Loss: 0.538 Test Acc: 0.756
Validation loss decreased (-0.736580 --> -0.756092).  Saving model ...
Epoch: 7 cost time: 3.91860032081604
Epoch: 7, Steps: 13 | Train Loss: 0.434 Vali Loss: 0.527 Vali Acc: 0.766 Test Loss: 0.527 Test Acc: 0.766
Validation loss decreased (-0.756092 --> -0.765848).  Saving model ...
Epoch: 8 cost time: 3.938847780227661
Epoch: 8, Steps: 13 | Train Loss: 0.420 Vali Loss: 0.519 Vali Acc: 0.746 Test Loss: 0.519 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.8502938747406006
Epoch: 9, Steps: 13 | Train Loss: 0.391 Vali Loss: 0.520 Vali Acc: 0.751 Test Loss: 0.520 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.6771249771118164
Epoch: 10, Steps: 13 | Train Loss: 0.376 Vali Loss: 0.571 Vali Acc: 0.707 Test Loss: 0.571 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.7929251194000244
Epoch: 11, Steps: 13 | Train Loss: 0.362 Vali Loss: 0.532 Vali Acc: 0.771 Test Loss: 0.532 Test Acc: 0.771
Validation loss decreased (-0.765848 --> -0.770726).  Saving model ...
Epoch: 12 cost time: 3.708173990249634
Epoch: 12, Steps: 13 | Train Loss: 0.400 Vali Loss: 0.634 Vali Acc: 0.673 Test Loss: 0.634 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.7923147678375244
Epoch: 13, Steps: 13 | Train Loss: 0.319 Vali Loss: 0.530 Vali Acc: 0.746 Test Loss: 0.530 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.7084813117980957
Epoch: 14, Steps: 13 | Train Loss: 0.265 Vali Loss: 0.574 Vali Acc: 0.683 Test Loss: 0.574 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.694047212600708
Epoch: 15, Steps: 13 | Train Loss: 0.273 Vali Loss: 0.573 Vali Acc: 0.771 Test Loss: 0.573 Test Acc: 0.771
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.733849287033081
Epoch: 16, Steps: 13 | Train Loss: 0.293 Vali Loss: 0.620 Vali Acc: 0.678 Test Loss: 0.620 Test Acc: 0.678
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.7379164695739746
Epoch: 17, Steps: 13 | Train Loss: 0.265 Vali Loss: 0.654 Vali Acc: 0.663 Test Loss: 0.654 Test Acc: 0.663
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.7052628993988037
Epoch: 18, Steps: 13 | Train Loss: 0.220 Vali Loss: 0.577 Vali Acc: 0.712 Test Loss: 0.577 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.7145841121673584
Epoch: 19, Steps: 13 | Train Loss: 0.221 Vali Loss: 0.587 Vali Acc: 0.717 Test Loss: 0.587 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.7283308506011963
Epoch: 20, Steps: 13 | Train Loss: 0.215 Vali Loss: 0.598 Vali Acc: 0.737 Test Loss: 0.598 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.7480454444885254
Epoch: 21, Steps: 13 | Train Loss: 0.166 Vali Loss: 0.619 Vali Acc: 0.693 Test Loss: 0.619 Test Acc: 0.693
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 180602
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.906689882278442
Epoch: 1, Steps: 13 | Train Loss: 0.627 Vali Loss: 0.589 Vali Acc: 0.712 Test Loss: 0.589 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 5.128370523452759
Epoch: 2, Steps: 13 | Train Loss: 0.582 Vali Loss: 0.580 Vali Acc: 0.712 Test Loss: 0.580 Test Acc: 0.712
Validation loss decreased (-0.712189 --> -0.712189).  Saving model ...
Epoch: 3 cost time: 5.095906019210815
Epoch: 3, Steps: 13 | Train Loss: 0.571 Vali Loss: 0.570 Vali Acc: 0.717 Test Loss: 0.570 Test Acc: 0.717
Validation loss decreased (-0.712189 --> -0.717067).  Saving model ...
Epoch: 4 cost time: 5.0719828605651855
Epoch: 4, Steps: 13 | Train Loss: 0.539 Vali Loss: 0.564 Vali Acc: 0.712 Test Loss: 0.564 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.050264120101929
Epoch: 5, Steps: 13 | Train Loss: 0.503 Vali Loss: 0.562 Vali Acc: 0.722 Test Loss: 0.562 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721946).  Saving model ...
Epoch: 6 cost time: 4.87077522277832
Epoch: 6, Steps: 13 | Train Loss: 0.496 Vali Loss: 0.553 Vali Acc: 0.737 Test Loss: 0.553 Test Acc: 0.737
Validation loss decreased (-0.721946 --> -0.736580).  Saving model ...
Epoch: 7 cost time: 5.137987852096558
Epoch: 7, Steps: 13 | Train Loss: 0.488 Vali Loss: 0.551 Vali Acc: 0.727 Test Loss: 0.551 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.130409002304077
Epoch: 8, Steps: 13 | Train Loss: 0.433 Vali Loss: 0.555 Vali Acc: 0.722 Test Loss: 0.555 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.897275447845459
Epoch: 9, Steps: 13 | Train Loss: 0.421 Vali Loss: 0.539 Vali Acc: 0.732 Test Loss: 0.539 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.903848171234131
Epoch: 10, Steps: 13 | Train Loss: 0.399 Vali Loss: 0.542 Vali Acc: 0.722 Test Loss: 0.542 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.1620423793792725
Epoch: 11, Steps: 13 | Train Loss: 0.379 Vali Loss: 0.582 Vali Acc: 0.698 Test Loss: 0.582 Test Acc: 0.698
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.148750066757202
Epoch: 12, Steps: 13 | Train Loss: 0.354 Vali Loss: 0.535 Vali Acc: 0.737 Test Loss: 0.535 Test Acc: 0.737
Validation loss decreased (-0.736580 --> -0.736580).  Saving model ...
Epoch: 13 cost time: 5.142914295196533
Epoch: 13, Steps: 13 | Train Loss: 0.317 Vali Loss: 0.525 Vali Acc: 0.746 Test Loss: 0.525 Test Acc: 0.746
Validation loss decreased (-0.736580 --> -0.746336).  Saving model ...
Epoch: 14 cost time: 5.057224273681641
Epoch: 14, Steps: 13 | Train Loss: 0.304 Vali Loss: 0.552 Vali Acc: 0.732 Test Loss: 0.552 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.973892450332642
Epoch: 15, Steps: 13 | Train Loss: 0.278 Vali Loss: 0.535 Vali Acc: 0.722 Test Loss: 0.535 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.122003555297852
Epoch: 16, Steps: 13 | Train Loss: 0.256 Vali Loss: 0.545 Vali Acc: 0.707 Test Loss: 0.545 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.040036916732788
Epoch: 17, Steps: 13 | Train Loss: 0.253 Vali Loss: 0.553 Vali Acc: 0.717 Test Loss: 0.553 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 5.148817300796509
Epoch: 18, Steps: 13 | Train Loss: 0.239 Vali Loss: 0.557 Vali Acc: 0.717 Test Loss: 0.557 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 5.111902475357056
Epoch: 19, Steps: 13 | Train Loss: 0.213 Vali Loss: 0.575 Vali Acc: 0.741 Test Loss: 0.575 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.049437999725342
Epoch: 20, Steps: 13 | Train Loss: 0.192 Vali Loss: 0.579 Vali Acc: 0.707 Test Loss: 0.579 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.955622434616089
Epoch: 21, Steps: 13 | Train Loss: 0.198 Vali Loss: 0.638 Vali Acc: 0.624 Test Loss: 0.638 Test Acc: 0.624
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 5.144355058670044
Epoch: 22, Steps: 13 | Train Loss: 0.196 Vali Loss: 0.624 Vali Acc: 0.673 Test Loss: 0.624 Test Acc: 0.673
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 5.159565448760986
Epoch: 23, Steps: 13 | Train Loss: 0.163 Vali Loss: 0.620 Vali Acc: 0.756 Test Loss: 0.620 Test Acc: 0.756
Validation loss decreased (-0.746336 --> -0.756091).  Saving model ...
Epoch: 24 cost time: 5.2175657749176025
Epoch: 24, Steps: 13 | Train Loss: 0.169 Vali Loss: 0.646 Vali Acc: 0.634 Test Loss: 0.646 Test Acc: 0.634
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 5.138463973999023
Epoch: 25, Steps: 13 | Train Loss: 0.164 Vali Loss: 0.667 Vali Acc: 0.659 Test Loss: 0.667 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 5.136249780654907
Epoch: 26, Steps: 13 | Train Loss: 0.136 Vali Loss: 0.673 Vali Acc: 0.727 Test Loss: 0.673 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 5.120410680770874
Epoch: 27, Steps: 13 | Train Loss: 0.109 Vali Loss: 0.671 Vali Acc: 0.732 Test Loss: 0.671 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 5.189095497131348
Epoch: 28, Steps: 13 | Train Loss: 0.114 Vali Loss: 0.818 Vali Acc: 0.610 Test Loss: 0.818 Test Acc: 0.610
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 5.29828143119812
Epoch: 29, Steps: 13 | Train Loss: 0.115 Vali Loss: 0.722 Vali Acc: 0.688 Test Loss: 0.722 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 5.228049039840698
Epoch: 30, Steps: 13 | Train Loss: 0.094 Vali Loss: 0.720 Vali Acc: 0.663 Test Loss: 0.720 Test Acc: 0.663
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 594586
model size : 2.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.0249176025390625
Epoch: 1, Steps: 13 | Train Loss: 0.724 Vali Loss: 0.598 Vali Acc: 0.722 Test Loss: 0.598 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 3.2596256732940674
Epoch: 2, Steps: 13 | Train Loss: 0.605 Vali Loss: 0.583 Vali Acc: 0.722 Test Loss: 0.583 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 3.244608163833618
Epoch: 3, Steps: 13 | Train Loss: 0.557 Vali Loss: 0.568 Vali Acc: 0.727 Test Loss: 0.568 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726824).  Saving model ...
Epoch: 4 cost time: 3.1998696327209473
Epoch: 4, Steps: 13 | Train Loss: 0.529 Vali Loss: 0.549 Vali Acc: 0.741 Test Loss: 0.549 Test Acc: 0.741
Validation loss decreased (-0.726824 --> -0.741458).  Saving model ...
Epoch: 5 cost time: 3.3201911449432373
Epoch: 5, Steps: 13 | Train Loss: 0.492 Vali Loss: 0.549 Vali Acc: 0.737 Test Loss: 0.549 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.296621084213257
Epoch: 6, Steps: 13 | Train Loss: 0.468 Vali Loss: 0.535 Vali Acc: 0.761 Test Loss: 0.535 Test Acc: 0.761
Validation loss decreased (-0.741458 --> -0.760970).  Saving model ...
Epoch: 7 cost time: 3.321986675262451
Epoch: 7, Steps: 13 | Train Loss: 0.444 Vali Loss: 0.531 Vali Acc: 0.756 Test Loss: 0.531 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.3121352195739746
Epoch: 8, Steps: 13 | Train Loss: 0.431 Vali Loss: 0.532 Vali Acc: 0.756 Test Loss: 0.532 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.30259370803833
Epoch: 9, Steps: 13 | Train Loss: 0.401 Vali Loss: 0.524 Vali Acc: 0.746 Test Loss: 0.524 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.2865874767303467
Epoch: 10, Steps: 13 | Train Loss: 0.394 Vali Loss: 0.559 Vali Acc: 0.698 Test Loss: 0.559 Test Acc: 0.698
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.300891160964966
Epoch: 11, Steps: 13 | Train Loss: 0.376 Vali Loss: 0.532 Vali Acc: 0.737 Test Loss: 0.532 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.2540123462677
Epoch: 12, Steps: 13 | Train Loss: 0.409 Vali Loss: 0.591 Vali Acc: 0.698 Test Loss: 0.591 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.2497103214263916
Epoch: 13, Steps: 13 | Train Loss: 0.318 Vali Loss: 0.545 Vali Acc: 0.732 Test Loss: 0.545 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.244173288345337
Epoch: 14, Steps: 13 | Train Loss: 0.280 Vali Loss: 0.609 Vali Acc: 0.683 Test Loss: 0.609 Test Acc: 0.683
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.275670051574707
Epoch: 15, Steps: 13 | Train Loss: 0.276 Vali Loss: 0.583 Vali Acc: 0.766 Test Loss: 0.583 Test Acc: 0.766
Validation loss decreased (-0.760970 --> -0.765848).  Saving model ...
Epoch: 16 cost time: 3.268494129180908
Epoch: 16, Steps: 13 | Train Loss: 0.291 Vali Loss: 0.576 Vali Acc: 0.722 Test Loss: 0.576 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.4455244541168213
Epoch: 17, Steps: 13 | Train Loss: 0.263 Vali Loss: 0.636 Vali Acc: 0.668 Test Loss: 0.636 Test Acc: 0.668
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.246450901031494
Epoch: 18, Steps: 13 | Train Loss: 0.223 Vali Loss: 0.572 Vali Acc: 0.712 Test Loss: 0.572 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.283402442932129
Epoch: 19, Steps: 13 | Train Loss: 0.219 Vali Loss: 0.603 Vali Acc: 0.698 Test Loss: 0.603 Test Acc: 0.698
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.2215869426727295
Epoch: 20, Steps: 13 | Train Loss: 0.215 Vali Loss: 0.598 Vali Acc: 0.722 Test Loss: 0.598 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.2941644191741943
Epoch: 21, Steps: 13 | Train Loss: 0.180 Vali Loss: 0.591 Vali Acc: 0.746 Test Loss: 0.591 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.3224706649780273
Epoch: 22, Steps: 13 | Train Loss: 0.189 Vali Loss: 0.742 Vali Acc: 0.654 Test Loss: 0.742 Test Acc: 0.654
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.324262857437134
Epoch: 23, Steps: 13 | Train Loss: 0.176 Vali Loss: 0.662 Vali Acc: 0.698 Test Loss: 0.662 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.2971279621124268
Epoch: 24, Steps: 13 | Train Loss: 0.172 Vali Loss: 0.623 Vali Acc: 0.746 Test Loss: 0.623 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.3091084957122803
Epoch: 25, Steps: 13 | Train Loss: 0.145 Vali Loss: 0.614 Vali Acc: 0.683 Test Loss: 0.614 Test Acc: 0.683
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 180602
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.8135669231414795
Epoch: 1, Steps: 13 | Train Loss: 0.626 Vali Loss: 0.594 Vali Acc: 0.712 Test Loss: 0.594 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 2.426170825958252
Epoch: 2, Steps: 13 | Train Loss: 0.587 Vali Loss: 0.588 Vali Acc: 0.717 Test Loss: 0.588 Test Acc: 0.717
Validation loss decreased (-0.712189 --> -0.717067).  Saving model ...
Epoch: 3 cost time: 2.2974953651428223
Epoch: 3, Steps: 13 | Train Loss: 0.574 Vali Loss: 0.578 Vali Acc: 0.717 Test Loss: 0.578 Test Acc: 0.717
Validation loss decreased (-0.717067 --> -0.717067).  Saving model ...
Epoch: 4 cost time: 2.3407785892486572
Epoch: 4, Steps: 13 | Train Loss: 0.552 Vali Loss: 0.568 Vali Acc: 0.717 Test Loss: 0.568 Test Acc: 0.717
Validation loss decreased (-0.717067 --> -0.717067).  Saving model ...
Epoch: 5 cost time: 3.0798301696777344
Epoch: 5, Steps: 13 | Train Loss: 0.518 Vali Loss: 0.572 Vali Acc: 0.727 Test Loss: 0.572 Test Acc: 0.727
Validation loss decreased (-0.717067 --> -0.726824).  Saving model ...
Epoch: 6 cost time: 3.098869562149048
Epoch: 6, Steps: 13 | Train Loss: 0.514 Vali Loss: 0.557 Vali Acc: 0.732 Test Loss: 0.557 Test Acc: 0.732
Validation loss decreased (-0.726824 --> -0.731702).  Saving model ...
Epoch: 7 cost time: 3.141064405441284
Epoch: 7, Steps: 13 | Train Loss: 0.503 Vali Loss: 0.518 Vali Acc: 0.751 Test Loss: 0.518 Test Acc: 0.751
Validation loss decreased (-0.731702 --> -0.751214).  Saving model ...
Epoch: 8 cost time: 3.080052614212036
Epoch: 8, Steps: 13 | Train Loss: 0.451 Vali Loss: 0.538 Vali Acc: 0.756 Test Loss: 0.538 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756092).  Saving model ...
Epoch: 9 cost time: 3.187225580215454
Epoch: 9, Steps: 13 | Train Loss: 0.441 Vali Loss: 0.524 Vali Acc: 0.766 Test Loss: 0.524 Test Acc: 0.766
Validation loss decreased (-0.756092 --> -0.765848).  Saving model ...
Epoch: 10 cost time: 3.1453025341033936
Epoch: 10, Steps: 13 | Train Loss: 0.425 Vali Loss: 0.516 Vali Acc: 0.766 Test Loss: 0.516 Test Acc: 0.766
Validation loss decreased (-0.765848 --> -0.765849).  Saving model ...
Epoch: 11 cost time: 3.10675311088562
Epoch: 11, Steps: 13 | Train Loss: 0.400 Vali Loss: 0.519 Vali Acc: 0.746 Test Loss: 0.519 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.1126065254211426
Epoch: 12, Steps: 13 | Train Loss: 0.361 Vali Loss: 0.523 Vali Acc: 0.766 Test Loss: 0.523 Test Acc: 0.766
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.162552833557129
Epoch: 13, Steps: 13 | Train Loss: 0.409 Vali Loss: 0.559 Vali Acc: 0.688 Test Loss: 0.559 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.032803773880005
Epoch: 14, Steps: 13 | Train Loss: 0.341 Vali Loss: 0.535 Vali Acc: 0.766 Test Loss: 0.535 Test Acc: 0.766
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.249523878097534
Epoch: 15, Steps: 13 | Train Loss: 0.312 Vali Loss: 0.517 Vali Acc: 0.741 Test Loss: 0.517 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.3186590671539307
Epoch: 16, Steps: 13 | Train Loss: 0.298 Vali Loss: 0.522 Vali Acc: 0.737 Test Loss: 0.522 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.30119252204895
Epoch: 17, Steps: 13 | Train Loss: 0.293 Vali Loss: 0.527 Vali Acc: 0.746 Test Loss: 0.527 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.2553067207336426
Epoch: 18, Steps: 13 | Train Loss: 0.274 Vali Loss: 0.531 Vali Acc: 0.746 Test Loss: 0.531 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.2981226444244385
Epoch: 19, Steps: 13 | Train Loss: 0.254 Vali Loss: 0.543 Vali Acc: 0.727 Test Loss: 0.543 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.3133063316345215
Epoch: 20, Steps: 13 | Train Loss: 0.221 Vali Loss: 0.573 Vali Acc: 0.693 Test Loss: 0.573 Test Acc: 0.693
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 594586
model size : 2.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.912109613418579
Epoch: 1, Steps: 13 | Train Loss: 0.724 Vali Loss: 0.594 Vali Acc: 0.722 Test Loss: 0.594 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.244779348373413
Epoch: 2, Steps: 13 | Train Loss: 0.605 Vali Loss: 0.585 Vali Acc: 0.722 Test Loss: 0.585 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 2.319955587387085
Epoch: 3, Steps: 13 | Train Loss: 0.559 Vali Loss: 0.570 Vali Acc: 0.732 Test Loss: 0.570 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 4 cost time: 2.2399327754974365
Epoch: 4, Steps: 13 | Train Loss: 0.527 Vali Loss: 0.571 Vali Acc: 0.722 Test Loss: 0.571 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.4433298110961914
Epoch: 5, Steps: 13 | Train Loss: 0.507 Vali Loss: 0.577 Vali Acc: 0.722 Test Loss: 0.577 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.344409465789795
Epoch: 6, Steps: 13 | Train Loss: 0.495 Vali Loss: 0.549 Vali Acc: 0.756 Test Loss: 0.549 Test Acc: 0.756
Validation loss decreased (-0.731702 --> -0.756092).  Saving model ...
Epoch: 7 cost time: 2.3508338928222656
Epoch: 7, Steps: 13 | Train Loss: 0.454 Vali Loss: 0.563 Vali Acc: 0.746 Test Loss: 0.563 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.368859052658081
Epoch: 8, Steps: 13 | Train Loss: 0.447 Vali Loss: 0.571 Vali Acc: 0.761 Test Loss: 0.571 Test Acc: 0.761
Validation loss decreased (-0.756092 --> -0.760970).  Saving model ...
Epoch: 9 cost time: 2.349236249923706
Epoch: 9, Steps: 13 | Train Loss: 0.422 Vali Loss: 0.571 Vali Acc: 0.732 Test Loss: 0.571 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.3794145584106445
Epoch: 10, Steps: 13 | Train Loss: 0.405 Vali Loss: 0.538 Vali Acc: 0.732 Test Loss: 0.538 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.3519489765167236
Epoch: 11, Steps: 13 | Train Loss: 0.396 Vali Loss: 0.544 Vali Acc: 0.751 Test Loss: 0.544 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.417858839035034
Epoch: 12, Steps: 13 | Train Loss: 0.435 Vali Loss: 0.650 Vali Acc: 0.624 Test Loss: 0.650 Test Acc: 0.624
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.3873965740203857
Epoch: 13, Steps: 13 | Train Loss: 0.359 Vali Loss: 0.529 Vali Acc: 0.795 Test Loss: 0.529 Test Acc: 0.795
Validation loss decreased (-0.760970 --> -0.795117).  Saving model ...
Epoch: 14 cost time: 2.524338960647583
Epoch: 14, Steps: 13 | Train Loss: 0.318 Vali Loss: 0.643 Vali Acc: 0.629 Test Loss: 0.643 Test Acc: 0.629
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.446427583694458
Epoch: 15, Steps: 13 | Train Loss: 0.317 Vali Loss: 0.571 Vali Acc: 0.776 Test Loss: 0.571 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.4920036792755127
Epoch: 16, Steps: 13 | Train Loss: 0.320 Vali Loss: 0.561 Vali Acc: 0.683 Test Loss: 0.561 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.533756971359253
Epoch: 17, Steps: 13 | Train Loss: 0.314 Vali Loss: 0.616 Vali Acc: 0.654 Test Loss: 0.616 Test Acc: 0.654
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.4683997631073
Epoch: 18, Steps: 13 | Train Loss: 0.275 Vali Loss: 0.557 Vali Acc: 0.722 Test Loss: 0.557 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.4770278930664062
Epoch: 19, Steps: 13 | Train Loss: 0.256 Vali Loss: 0.563 Vali Acc: 0.698 Test Loss: 0.563 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.489766836166382
Epoch: 20, Steps: 13 | Train Loss: 0.248 Vali Loss: 0.573 Vali Acc: 0.732 Test Loss: 0.573 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.474050521850586
Epoch: 21, Steps: 13 | Train Loss: 0.226 Vali Loss: 0.563 Vali Acc: 0.693 Test Loss: 0.563 Test Acc: 0.693
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.483384370803833
Epoch: 22, Steps: 13 | Train Loss: 0.218 Vali Loss: 0.655 Vali Acc: 0.659 Test Loss: 0.655 Test Acc: 0.659
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.5127360820770264
Epoch: 23, Steps: 13 | Train Loss: 0.205 Vali Loss: 0.618 Vali Acc: 0.737 Test Loss: 0.618 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7951219512195122
model parameter : 180602
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.275692939758301
Epoch: 1, Steps: 13 | Train Loss: 0.665 Vali Loss: 0.580 Vali Acc: 0.712 Test Loss: 0.580 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 4.3744871616363525
Epoch: 2, Steps: 13 | Train Loss: 0.593 Vali Loss: 0.572 Vali Acc: 0.717 Test Loss: 0.572 Test Acc: 0.717
Validation loss decreased (-0.712189 --> -0.717067).  Saving model ...
Epoch: 3 cost time: 4.45134711265564
Epoch: 3, Steps: 13 | Train Loss: 0.582 Vali Loss: 0.546 Vali Acc: 0.737 Test Loss: 0.546 Test Acc: 0.737
Validation loss decreased (-0.717067 --> -0.736580).  Saving model ...
Epoch: 4 cost time: 4.386814832687378
Epoch: 4, Steps: 13 | Train Loss: 0.540 Vali Loss: 0.536 Vali Acc: 0.746 Test Loss: 0.536 Test Acc: 0.746
Validation loss decreased (-0.736580 --> -0.746336).  Saving model ...
Epoch: 5 cost time: 4.40530252456665
Epoch: 5, Steps: 13 | Train Loss: 0.491 Vali Loss: 0.535 Vali Acc: 0.746 Test Loss: 0.535 Test Acc: 0.746
Validation loss decreased (-0.746336 --> -0.746336).  Saving model ...
Epoch: 6 cost time: 4.419614553451538
Epoch: 6, Steps: 13 | Train Loss: 0.491 Vali Loss: 0.528 Vali Acc: 0.751 Test Loss: 0.528 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751214).  Saving model ...
Epoch: 7 cost time: 4.440587520599365
Epoch: 7, Steps: 13 | Train Loss: 0.466 Vali Loss: 0.521 Vali Acc: 0.737 Test Loss: 0.521 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.225024938583374
Epoch: 8, Steps: 13 | Train Loss: 0.477 Vali Loss: 0.524 Vali Acc: 0.732 Test Loss: 0.524 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.309106349945068
Epoch: 9, Steps: 13 | Train Loss: 0.418 Vali Loss: 0.530 Vali Acc: 0.746 Test Loss: 0.530 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.296222448348999
Epoch: 10, Steps: 13 | Train Loss: 0.409 Vali Loss: 0.530 Vali Acc: 0.732 Test Loss: 0.530 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.261308908462524
Epoch: 11, Steps: 13 | Train Loss: 0.397 Vali Loss: 0.550 Vali Acc: 0.727 Test Loss: 0.550 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.081345796585083
Epoch: 12, Steps: 13 | Train Loss: 0.385 Vali Loss: 0.582 Vali Acc: 0.751 Test Loss: 0.582 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.155588626861572
Epoch: 13, Steps: 13 | Train Loss: 0.355 Vali Loss: 0.561 Vali Acc: 0.702 Test Loss: 0.561 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.14882755279541
Epoch: 14, Steps: 13 | Train Loss: 0.355 Vali Loss: 0.568 Vali Acc: 0.707 Test Loss: 0.568 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.057389497756958
Epoch: 15, Steps: 13 | Train Loss: 0.336 Vali Loss: 0.558 Vali Acc: 0.717 Test Loss: 0.558 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.8492586612701416
Epoch: 16, Steps: 13 | Train Loss: 0.288 Vali Loss: 0.567 Vali Acc: 0.717 Test Loss: 0.567 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 301338
model size : 1.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.564509391784668
Epoch: 1, Steps: 13 | Train Loss: 0.607 Vali Loss: 0.595 Vali Acc: 0.712 Test Loss: 0.595 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 2.621084451675415
Epoch: 2, Steps: 13 | Train Loss: 0.588 Vali Loss: 0.582 Vali Acc: 0.717 Test Loss: 0.582 Test Acc: 0.717
Validation loss decreased (-0.712189 --> -0.717067).  Saving model ...
Epoch: 3 cost time: 2.513594388961792
Epoch: 3, Steps: 13 | Train Loss: 0.576 Vali Loss: 0.574 Vali Acc: 0.722 Test Loss: 0.574 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721945).  Saving model ...
Epoch: 4 cost time: 2.7566897869110107
Epoch: 4, Steps: 13 | Train Loss: 0.522 Vali Loss: 0.551 Vali Acc: 0.727 Test Loss: 0.551 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726824).  Saving model ...
Epoch: 5 cost time: 2.742586612701416
Epoch: 5, Steps: 13 | Train Loss: 0.514 Vali Loss: 0.543 Vali Acc: 0.722 Test Loss: 0.543 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.7255377769470215
Epoch: 6, Steps: 13 | Train Loss: 0.490 Vali Loss: 0.535 Vali Acc: 0.737 Test Loss: 0.535 Test Acc: 0.737
Validation loss decreased (-0.726824 --> -0.736580).  Saving model ...
Epoch: 7 cost time: 2.717325210571289
Epoch: 7, Steps: 13 | Train Loss: 0.482 Vali Loss: 0.535 Vali Acc: 0.737 Test Loss: 0.535 Test Acc: 0.737
Validation loss decreased (-0.736580 --> -0.736580).  Saving model ...
Epoch: 8 cost time: 2.7731876373291016
Epoch: 8, Steps: 13 | Train Loss: 0.479 Vali Loss: 0.533 Vali Acc: 0.737 Test Loss: 0.533 Test Acc: 0.737
Validation loss decreased (-0.736580 --> -0.736580).  Saving model ...
Epoch: 9 cost time: 2.7133545875549316
Epoch: 9, Steps: 13 | Train Loss: 0.431 Vali Loss: 0.549 Vali Acc: 0.732 Test Loss: 0.549 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.7237026691436768
Epoch: 10, Steps: 13 | Train Loss: 0.416 Vali Loss: 0.530 Vali Acc: 0.741 Test Loss: 0.530 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741458).  Saving model ...
Epoch: 11 cost time: 2.698730945587158
Epoch: 11, Steps: 13 | Train Loss: 0.397 Vali Loss: 0.544 Vali Acc: 0.732 Test Loss: 0.544 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.524622678756714
Epoch: 12, Steps: 13 | Train Loss: 0.379 Vali Loss: 0.577 Vali Acc: 0.741 Test Loss: 0.577 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.7720534801483154
Epoch: 13, Steps: 13 | Train Loss: 0.385 Vali Loss: 0.553 Vali Acc: 0.712 Test Loss: 0.553 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.594552755355835
Epoch: 14, Steps: 13 | Train Loss: 0.340 Vali Loss: 0.545 Vali Acc: 0.741 Test Loss: 0.545 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.7292957305908203
Epoch: 15, Steps: 13 | Train Loss: 0.314 Vali Loss: 0.570 Vali Acc: 0.746 Test Loss: 0.570 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746336).  Saving model ...
Epoch: 16 cost time: 2.6899027824401855
Epoch: 16, Steps: 13 | Train Loss: 0.315 Vali Loss: 0.590 Vali Acc: 0.688 Test Loss: 0.590 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.7269346714019775
Epoch: 17, Steps: 13 | Train Loss: 0.304 Vali Loss: 0.627 Vali Acc: 0.737 Test Loss: 0.627 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.7661986351013184
Epoch: 18, Steps: 13 | Train Loss: 0.267 Vali Loss: 0.619 Vali Acc: 0.707 Test Loss: 0.619 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.740780830383301
Epoch: 19, Steps: 13 | Train Loss: 0.240 Vali Loss: 0.623 Vali Acc: 0.707 Test Loss: 0.623 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.8281900882720947
Epoch: 20, Steps: 13 | Train Loss: 0.228 Vali Loss: 0.657 Vali Acc: 0.663 Test Loss: 0.657 Test Acc: 0.663
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.7283434867858887
Epoch: 21, Steps: 13 | Train Loss: 0.227 Vali Loss: 0.703 Vali Acc: 0.751 Test Loss: 0.703 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751212).  Saving model ...
Epoch: 22 cost time: 2.7405126094818115
Epoch: 22, Steps: 13 | Train Loss: 0.230 Vali Loss: 0.677 Vali Acc: 0.668 Test Loss: 0.677 Test Acc: 0.668
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.733185052871704
Epoch: 23, Steps: 13 | Train Loss: 0.189 Vali Loss: 0.641 Vali Acc: 0.698 Test Loss: 0.641 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.796088218688965
Epoch: 24, Steps: 13 | Train Loss: 0.190 Vali Loss: 0.730 Vali Acc: 0.737 Test Loss: 0.730 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.7627439498901367
Epoch: 25, Steps: 13 | Train Loss: 0.179 Vali Loss: 0.695 Vali Acc: 0.663 Test Loss: 0.695 Test Acc: 0.663
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.776541233062744
Epoch: 26, Steps: 13 | Train Loss: 0.178 Vali Loss: 0.771 Vali Acc: 0.756 Test Loss: 0.771 Test Acc: 0.756
Validation loss decreased (-0.751212 --> -0.756090).  Saving model ...
Epoch: 27 cost time: 2.8312020301818848
Epoch: 27, Steps: 13 | Train Loss: 0.190 Vali Loss: 0.671 Vali Acc: 0.688 Test Loss: 0.671 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.8523108959198
Epoch: 28, Steps: 13 | Train Loss: 0.142 Vali Loss: 0.703 Vali Acc: 0.654 Test Loss: 0.703 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.7857813835144043
Epoch: 29, Steps: 13 | Train Loss: 0.145 Vali Loss: 0.744 Vali Acc: 0.659 Test Loss: 0.744 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.8218564987182617
Epoch: 30, Steps: 13 | Train Loss: 0.174 Vali Loss: 0.745 Vali Acc: 0.761 Test Loss: 0.745 Test Acc: 0.761
Validation loss decreased (-0.756090 --> -0.760968).  Saving model ...
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 94330
model size : 0.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.251872777938843
Epoch: 1, Steps: 13 | Train Loss: 0.665 Vali Loss: 0.582 Vali Acc: 0.712 Test Loss: 0.582 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 3.419980049133301
Epoch: 2, Steps: 13 | Train Loss: 0.593 Vali Loss: 0.573 Vali Acc: 0.717 Test Loss: 0.573 Test Acc: 0.717
Validation loss decreased (-0.712189 --> -0.717067).  Saving model ...
Epoch: 3 cost time: 3.3655219078063965
Epoch: 3, Steps: 13 | Train Loss: 0.586 Vali Loss: 0.547 Vali Acc: 0.732 Test Loss: 0.547 Test Acc: 0.732
Validation loss decreased (-0.717067 --> -0.731702).  Saving model ...
Epoch: 4 cost time: 3.318161964416504
Epoch: 4, Steps: 13 | Train Loss: 0.548 Vali Loss: 0.535 Vali Acc: 0.751 Test Loss: 0.535 Test Acc: 0.751
Validation loss decreased (-0.731702 --> -0.751214).  Saving model ...
Epoch: 5 cost time: 3.306572198867798
Epoch: 5, Steps: 13 | Train Loss: 0.494 Vali Loss: 0.533 Vali Acc: 0.741 Test Loss: 0.533 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.342960834503174
Epoch: 6, Steps: 13 | Train Loss: 0.489 Vali Loss: 0.523 Vali Acc: 0.746 Test Loss: 0.523 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.343062162399292
Epoch: 7, Steps: 13 | Train Loss: 0.466 Vali Loss: 0.521 Vali Acc: 0.751 Test Loss: 0.521 Test Acc: 0.751
Validation loss decreased (-0.751214 --> -0.751214).  Saving model ...
Epoch: 8 cost time: 3.338707208633423
Epoch: 8, Steps: 13 | Train Loss: 0.478 Vali Loss: 0.530 Vali Acc: 0.732 Test Loss: 0.530 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.9096357822418213
Epoch: 9, Steps: 13 | Train Loss: 0.435 Vali Loss: 0.526 Vali Acc: 0.761 Test Loss: 0.526 Test Acc: 0.761
Validation loss decreased (-0.751214 --> -0.760970).  Saving model ...
Epoch: 10 cost time: 3.423795700073242
Epoch: 10, Steps: 13 | Train Loss: 0.419 Vali Loss: 0.530 Vali Acc: 0.732 Test Loss: 0.530 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.4560019969940186
Epoch: 11, Steps: 13 | Train Loss: 0.414 Vali Loss: 0.537 Vali Acc: 0.727 Test Loss: 0.537 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.4360220432281494
Epoch: 12, Steps: 13 | Train Loss: 0.390 Vali Loss: 0.567 Vali Acc: 0.756 Test Loss: 0.567 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.4040839672088623
Epoch: 13, Steps: 13 | Train Loss: 0.351 Vali Loss: 0.531 Vali Acc: 0.737 Test Loss: 0.531 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.462062120437622
Epoch: 14, Steps: 13 | Train Loss: 0.358 Vali Loss: 0.547 Vali Acc: 0.712 Test Loss: 0.547 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.436008930206299
Epoch: 15, Steps: 13 | Train Loss: 0.340 Vali Loss: 0.546 Vali Acc: 0.737 Test Loss: 0.546 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.279594659805298
Epoch: 16, Steps: 13 | Train Loss: 0.311 Vali Loss: 0.582 Vali Acc: 0.663 Test Loss: 0.582 Test Acc: 0.663
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.2759737968444824
Epoch: 17, Steps: 13 | Train Loss: 0.311 Vali Loss: 0.580 Vali Acc: 0.746 Test Loss: 0.580 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.279420852661133
Epoch: 18, Steps: 13 | Train Loss: 0.286 Vali Loss: 0.585 Vali Acc: 0.678 Test Loss: 0.585 Test Acc: 0.678
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.431056261062622
Epoch: 19, Steps: 13 | Train Loss: 0.257 Vali Loss: 0.560 Vali Acc: 0.717 Test Loss: 0.560 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 301338
model size : 1.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.9185421466827393
Epoch: 1, Steps: 13 | Train Loss: 0.606 Vali Loss: 0.596 Vali Acc: 0.712 Test Loss: 0.596 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 2.307433843612671
Epoch: 2, Steps: 13 | Train Loss: 0.587 Vali Loss: 0.582 Vali Acc: 0.717 Test Loss: 0.582 Test Acc: 0.717
Validation loss decreased (-0.712189 --> -0.717067).  Saving model ...
Epoch: 3 cost time: 2.319448471069336
Epoch: 3, Steps: 13 | Train Loss: 0.577 Vali Loss: 0.575 Vali Acc: 0.722 Test Loss: 0.575 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721945).  Saving model ...
Epoch: 4 cost time: 2.306047201156616
Epoch: 4, Steps: 13 | Train Loss: 0.525 Vali Loss: 0.551 Vali Acc: 0.727 Test Loss: 0.551 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726824).  Saving model ...
Epoch: 5 cost time: 2.302915573120117
Epoch: 5, Steps: 13 | Train Loss: 0.516 Vali Loss: 0.543 Vali Acc: 0.732 Test Loss: 0.543 Test Acc: 0.732
Validation loss decreased (-0.726824 --> -0.731702).  Saving model ...
Epoch: 6 cost time: 2.2908785343170166
Epoch: 6, Steps: 13 | Train Loss: 0.490 Vali Loss: 0.536 Vali Acc: 0.741 Test Loss: 0.536 Test Acc: 0.741
Validation loss decreased (-0.731702 --> -0.741458).  Saving model ...
Epoch: 7 cost time: 2.373762607574463
Epoch: 7, Steps: 13 | Train Loss: 0.483 Vali Loss: 0.537 Vali Acc: 0.732 Test Loss: 0.537 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.412327289581299
Epoch: 8, Steps: 13 | Train Loss: 0.479 Vali Loss: 0.533 Vali Acc: 0.741 Test Loss: 0.533 Test Acc: 0.741
Validation loss decreased (-0.741458 --> -0.741458).  Saving model ...
Epoch: 9 cost time: 2.3691835403442383
Epoch: 9, Steps: 13 | Train Loss: 0.433 Vali Loss: 0.568 Vali Acc: 0.727 Test Loss: 0.568 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.36920166015625
Epoch: 10, Steps: 13 | Train Loss: 0.413 Vali Loss: 0.562 Vali Acc: 0.737 Test Loss: 0.562 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.40803861618042
Epoch: 11, Steps: 13 | Train Loss: 0.405 Vali Loss: 0.560 Vali Acc: 0.722 Test Loss: 0.560 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.405001640319824
Epoch: 12, Steps: 13 | Train Loss: 0.388 Vali Loss: 0.563 Vali Acc: 0.727 Test Loss: 0.563 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.4078218936920166
Epoch: 13, Steps: 13 | Train Loss: 0.367 Vali Loss: 0.569 Vali Acc: 0.727 Test Loss: 0.569 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.3996567726135254
Epoch: 14, Steps: 13 | Train Loss: 0.352 Vali Loss: 0.567 Vali Acc: 0.717 Test Loss: 0.567 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.4336156845092773
Epoch: 15, Steps: 13 | Train Loss: 0.330 Vali Loss: 0.575 Vali Acc: 0.727 Test Loss: 0.575 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.3599441051483154
Epoch: 16, Steps: 13 | Train Loss: 0.315 Vali Loss: 0.585 Vali Acc: 0.678 Test Loss: 0.585 Test Acc: 0.678
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.3699607849121094
Epoch: 17, Steps: 13 | Train Loss: 0.298 Vali Loss: 0.596 Vali Acc: 0.707 Test Loss: 0.596 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.391416311264038
Epoch: 18, Steps: 13 | Train Loss: 0.266 Vali Loss: 0.605 Vali Acc: 0.702 Test Loss: 0.605 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 94330
model size : 0.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.221286773681641
Epoch: 1, Steps: 13 | Train Loss: 0.667 Vali Loss: 0.589 Vali Acc: 0.712 Test Loss: 0.589 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 2.629504680633545
Epoch: 2, Steps: 13 | Train Loss: 0.595 Vali Loss: 0.585 Vali Acc: 0.717 Test Loss: 0.585 Test Acc: 0.717
Validation loss decreased (-0.712189 --> -0.717067).  Saving model ...
Epoch: 3 cost time: 2.655803918838501
Epoch: 3, Steps: 13 | Train Loss: 0.584 Vali Loss: 0.561 Vali Acc: 0.717 Test Loss: 0.561 Test Acc: 0.717
Validation loss decreased (-0.717067 --> -0.717068).  Saving model ...
Epoch: 4 cost time: 2.653447389602661
Epoch: 4, Steps: 13 | Train Loss: 0.547 Vali Loss: 0.566 Vali Acc: 0.741 Test Loss: 0.566 Test Acc: 0.741
Validation loss decreased (-0.717068 --> -0.741458).  Saving model ...
Epoch: 5 cost time: 2.670607566833496
Epoch: 5, Steps: 13 | Train Loss: 0.514 Vali Loss: 0.559 Vali Acc: 0.737 Test Loss: 0.559 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.639507293701172
Epoch: 6, Steps: 13 | Train Loss: 0.507 Vali Loss: 0.548 Vali Acc: 0.746 Test Loss: 0.548 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746336).  Saving model ...
Epoch: 7 cost time: 2.643571138381958
Epoch: 7, Steps: 13 | Train Loss: 0.482 Vali Loss: 0.530 Vali Acc: 0.756 Test Loss: 0.530 Test Acc: 0.756
Validation loss decreased (-0.746336 --> -0.756092).  Saving model ...
Epoch: 8 cost time: 2.445298433303833
Epoch: 8, Steps: 13 | Train Loss: 0.491 Vali Loss: 0.518 Vali Acc: 0.741 Test Loss: 0.518 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.630107879638672
Epoch: 9, Steps: 13 | Train Loss: 0.446 Vali Loss: 0.543 Vali Acc: 0.756 Test Loss: 0.543 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.7006096839904785
Epoch: 10, Steps: 13 | Train Loss: 0.436 Vali Loss: 0.536 Vali Acc: 0.737 Test Loss: 0.536 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.6024117469787598
Epoch: 11, Steps: 13 | Train Loss: 0.432 Vali Loss: 0.524 Vali Acc: 0.741 Test Loss: 0.524 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.6393840312957764
Epoch: 12, Steps: 13 | Train Loss: 0.412 Vali Loss: 0.540 Vali Acc: 0.741 Test Loss: 0.540 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.6450228691101074
Epoch: 13, Steps: 13 | Train Loss: 0.376 Vali Loss: 0.549 Vali Acc: 0.756 Test Loss: 0.549 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.6691060066223145
Epoch: 14, Steps: 13 | Train Loss: 0.358 Vali Loss: 0.552 Vali Acc: 0.717 Test Loss: 0.552 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.6123340129852295
Epoch: 15, Steps: 13 | Train Loss: 0.370 Vali Loss: 0.505 Vali Acc: 0.780 Test Loss: 0.505 Test Acc: 0.780
Validation loss decreased (-0.756092 --> -0.780483).  Saving model ...
Epoch: 16 cost time: 2.6423768997192383
Epoch: 16, Steps: 13 | Train Loss: 0.331 Vali Loss: 0.533 Vali Acc: 0.732 Test Loss: 0.533 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.4887611865997314
Epoch: 17, Steps: 13 | Train Loss: 0.323 Vali Loss: 0.580 Vali Acc: 0.766 Test Loss: 0.580 Test Acc: 0.766
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.718806743621826
Epoch: 18, Steps: 13 | Train Loss: 0.298 Vali Loss: 0.619 Vali Acc: 0.717 Test Loss: 0.619 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.603546380996704
Epoch: 19, Steps: 13 | Train Loss: 0.295 Vali Loss: 0.576 Vali Acc: 0.698 Test Loss: 0.576 Test Acc: 0.698
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.631293773651123
Epoch: 20, Steps: 13 | Train Loss: 0.255 Vali Loss: 0.544 Vali Acc: 0.771 Test Loss: 0.544 Test Acc: 0.771
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.6482481956481934
Epoch: 21, Steps: 13 | Train Loss: 0.261 Vali Loss: 0.587 Vali Acc: 0.761 Test Loss: 0.587 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.6200473308563232
Epoch: 22, Steps: 13 | Train Loss: 0.235 Vali Loss: 0.589 Vali Acc: 0.698 Test Loss: 0.589 Test Acc: 0.698
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.642113447189331
Epoch: 23, Steps: 13 | Train Loss: 0.214 Vali Loss: 0.561 Vali Acc: 0.746 Test Loss: 0.561 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.612804412841797
Epoch: 24, Steps: 13 | Train Loss: 0.192 Vali Loss: 0.576 Vali Acc: 0.741 Test Loss: 0.576 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.626070737838745
Epoch: 25, Steps: 13 | Train Loss: 0.192 Vali Loss: 0.620 Vali Acc: 0.746 Test Loss: 0.620 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7804878048780488
model parameter : 301338
model size : 1.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.9682557582855225
Epoch: 1, Steps: 13 | Train Loss: 0.604 Vali Loss: 0.595 Vali Acc: 0.712 Test Loss: 0.595 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 2.0019569396972656
Epoch: 2, Steps: 13 | Train Loss: 0.588 Vali Loss: 0.584 Vali Acc: 0.717 Test Loss: 0.584 Test Acc: 0.717
Validation loss decreased (-0.712189 --> -0.717067).  Saving model ...
Epoch: 3 cost time: 2.0791916847229004
Epoch: 3, Steps: 13 | Train Loss: 0.580 Vali Loss: 0.578 Vali Acc: 0.717 Test Loss: 0.578 Test Acc: 0.717
Validation loss decreased (-0.717067 --> -0.717067).  Saving model ...
Epoch: 4 cost time: 2.038280963897705
Epoch: 4, Steps: 13 | Train Loss: 0.528 Vali Loss: 0.551 Vali Acc: 0.722 Test Loss: 0.551 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721946).  Saving model ...
Epoch: 5 cost time: 2.1163721084594727
Epoch: 5, Steps: 13 | Train Loss: 0.517 Vali Loss: 0.546 Vali Acc: 0.732 Test Loss: 0.546 Test Acc: 0.732
Validation loss decreased (-0.721946 --> -0.731702).  Saving model ...
Epoch: 6 cost time: 2.0991251468658447
Epoch: 6, Steps: 13 | Train Loss: 0.498 Vali Loss: 0.541 Vali Acc: 0.727 Test Loss: 0.541 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.1111955642700195
Epoch: 7, Steps: 13 | Train Loss: 0.493 Vali Loss: 0.542 Vali Acc: 0.741 Test Loss: 0.542 Test Acc: 0.741
Validation loss decreased (-0.731702 --> -0.741458).  Saving model ...
Epoch: 8 cost time: 2.1348001956939697
Epoch: 8, Steps: 13 | Train Loss: 0.491 Vali Loss: 0.552 Vali Acc: 0.737 Test Loss: 0.552 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9971082210540771
Epoch: 9, Steps: 13 | Train Loss: 0.463 Vali Loss: 0.537 Vali Acc: 0.737 Test Loss: 0.537 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.1416001319885254
Epoch: 10, Steps: 13 | Train Loss: 0.426 Vali Loss: 0.533 Vali Acc: 0.741 Test Loss: 0.533 Test Acc: 0.741
Validation loss decreased (-0.741458 --> -0.741458).  Saving model ...
Epoch: 11 cost time: 2.1422383785247803
Epoch: 11, Steps: 13 | Train Loss: 0.420 Vali Loss: 0.526 Vali Acc: 0.751 Test Loss: 0.526 Test Acc: 0.751
Validation loss decreased (-0.741458 --> -0.751214).  Saving model ...
Epoch: 12 cost time: 2.0327811241149902
Epoch: 12, Steps: 13 | Train Loss: 0.393 Vali Loss: 0.547 Vali Acc: 0.737 Test Loss: 0.547 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.0524566173553467
Epoch: 13, Steps: 13 | Train Loss: 0.387 Vali Loss: 0.533 Vali Acc: 0.732 Test Loss: 0.533 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.0407063961029053
Epoch: 14, Steps: 13 | Train Loss: 0.362 Vali Loss: 0.526 Vali Acc: 0.761 Test Loss: 0.526 Test Acc: 0.761
Validation loss decreased (-0.751214 --> -0.760970).  Saving model ...
Epoch: 15 cost time: 1.971336841583252
Epoch: 15, Steps: 13 | Train Loss: 0.342 Vali Loss: 0.564 Vali Acc: 0.746 Test Loss: 0.564 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9833927154541016
Epoch: 16, Steps: 13 | Train Loss: 0.339 Vali Loss: 0.603 Vali Acc: 0.659 Test Loss: 0.603 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.0408904552459717
Epoch: 17, Steps: 13 | Train Loss: 0.324 Vali Loss: 0.605 Vali Acc: 0.702 Test Loss: 0.605 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.9667317867279053
Epoch: 18, Steps: 13 | Train Loss: 0.291 Vali Loss: 0.584 Vali Acc: 0.678 Test Loss: 0.584 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.8992831707000732
Epoch: 19, Steps: 13 | Train Loss: 0.307 Vali Loss: 0.560 Vali Acc: 0.707 Test Loss: 0.560 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.0234498977661133
Epoch: 20, Steps: 13 | Train Loss: 0.253 Vali Loss: 0.601 Vali Acc: 0.659 Test Loss: 0.601 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.048368215560913
Epoch: 21, Steps: 13 | Train Loss: 0.244 Vali Loss: 0.610 Vali Acc: 0.756 Test Loss: 0.610 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.0037307739257812
Epoch: 22, Steps: 13 | Train Loss: 0.232 Vali Loss: 0.609 Vali Acc: 0.688 Test Loss: 0.609 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.0236947536468506
Epoch: 23, Steps: 13 | Train Loss: 0.224 Vali Loss: 0.608 Vali Acc: 0.702 Test Loss: 0.608 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.028073310852051
Epoch: 24, Steps: 13 | Train Loss: 0.203 Vali Loss: 0.638 Vali Acc: 0.722 Test Loss: 0.638 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 94330
model size : 0.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.609699487686157
Epoch: 1, Steps: 13 | Train Loss: 0.773 Vali Loss: 0.606 Vali Acc: 0.727 Test Loss: 0.606 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 3.790588855743408
Epoch: 2, Steps: 13 | Train Loss: 0.601 Vali Loss: 0.577 Vali Acc: 0.722 Test Loss: 0.577 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.7477192878723145
Epoch: 3, Steps: 13 | Train Loss: 0.554 Vali Loss: 0.553 Vali Acc: 0.727 Test Loss: 0.553 Test Acc: 0.727
Validation loss decreased (-0.726823 --> -0.726824).  Saving model ...
Epoch: 4 cost time: 3.8700084686279297
Epoch: 4, Steps: 13 | Train Loss: 0.520 Vali Loss: 0.546 Vali Acc: 0.741 Test Loss: 0.546 Test Acc: 0.741
Validation loss decreased (-0.726824 --> -0.741458).  Saving model ...
Epoch: 5 cost time: 3.773453950881958
Epoch: 5, Steps: 13 | Train Loss: 0.511 Vali Loss: 0.536 Vali Acc: 0.741 Test Loss: 0.536 Test Acc: 0.741
Validation loss decreased (-0.741458 --> -0.741458).  Saving model ...
Epoch: 6 cost time: 3.5503296852111816
Epoch: 6, Steps: 13 | Train Loss: 0.483 Vali Loss: 0.533 Vali Acc: 0.746 Test Loss: 0.533 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746336).  Saving model ...
Epoch: 7 cost time: 3.804403781890869
Epoch: 7, Steps: 13 | Train Loss: 0.482 Vali Loss: 0.532 Vali Acc: 0.741 Test Loss: 0.532 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.7358157634735107
Epoch: 8, Steps: 13 | Train Loss: 0.451 Vali Loss: 0.521 Vali Acc: 0.741 Test Loss: 0.521 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.756094455718994
Epoch: 9, Steps: 13 | Train Loss: 0.421 Vali Loss: 0.511 Vali Acc: 0.761 Test Loss: 0.511 Test Acc: 0.761
Validation loss decreased (-0.746336 --> -0.760971).  Saving model ...
Epoch: 10 cost time: 3.5399701595306396
Epoch: 10, Steps: 13 | Train Loss: 0.404 Vali Loss: 0.521 Vali Acc: 0.766 Test Loss: 0.521 Test Acc: 0.766
Validation loss decreased (-0.760971 --> -0.765848).  Saving model ...
Epoch: 11 cost time: 3.7138137817382812
Epoch: 11, Steps: 13 | Train Loss: 0.374 Vali Loss: 0.519 Vali Acc: 0.766 Test Loss: 0.519 Test Acc: 0.766
Validation loss decreased (-0.765848 --> -0.765848).  Saving model ...
Epoch: 12 cost time: 3.669081211090088
Epoch: 12, Steps: 13 | Train Loss: 0.376 Vali Loss: 0.515 Vali Acc: 0.776 Test Loss: 0.515 Test Acc: 0.776
Validation loss decreased (-0.765848 --> -0.775605).  Saving model ...
Epoch: 13 cost time: 3.675819158554077
Epoch: 13, Steps: 13 | Train Loss: 0.338 Vali Loss: 0.522 Vali Acc: 0.771 Test Loss: 0.522 Test Acc: 0.771
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.718745231628418
Epoch: 14, Steps: 13 | Train Loss: 0.330 Vali Loss: 0.514 Vali Acc: 0.776 Test Loss: 0.514 Test Acc: 0.776
Validation loss decreased (-0.775605 --> -0.775605).  Saving model ...
Epoch: 15 cost time: 3.6955976486206055
Epoch: 15, Steps: 13 | Train Loss: 0.297 Vali Loss: 0.581 Vali Acc: 0.761 Test Loss: 0.581 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.6841976642608643
Epoch: 16, Steps: 13 | Train Loss: 0.301 Vali Loss: 0.541 Vali Acc: 0.727 Test Loss: 0.541 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.7224209308624268
Epoch: 17, Steps: 13 | Train Loss: 0.274 Vali Loss: 0.563 Vali Acc: 0.766 Test Loss: 0.563 Test Acc: 0.766
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.6613810062408447
Epoch: 18, Steps: 13 | Train Loss: 0.268 Vali Loss: 0.542 Vali Acc: 0.766 Test Loss: 0.542 Test Acc: 0.766
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.7291061878204346
Epoch: 19, Steps: 13 | Train Loss: 0.232 Vali Loss: 0.550 Vali Acc: 0.756 Test Loss: 0.550 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.6610629558563232
Epoch: 20, Steps: 13 | Train Loss: 0.228 Vali Loss: 0.566 Vali Acc: 0.761 Test Loss: 0.566 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.6766321659088135
Epoch: 21, Steps: 13 | Train Loss: 0.238 Vali Loss: 0.578 Vali Acc: 0.707 Test Loss: 0.578 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.700406312942505
Epoch: 22, Steps: 13 | Train Loss: 0.207 Vali Loss: 0.580 Vali Acc: 0.756 Test Loss: 0.580 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.720137119293213
Epoch: 23, Steps: 13 | Train Loss: 0.191 Vali Loss: 0.615 Vali Acc: 0.756 Test Loss: 0.615 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.6490042209625244
Epoch: 24, Steps: 13 | Train Loss: 0.187 Vali Loss: 0.584 Vali Acc: 0.717 Test Loss: 0.584 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.775609756097561
model parameter : 154714
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.564521074295044
Epoch: 1, Steps: 13 | Train Loss: 0.669 Vali Loss: 0.583 Vali Acc: 0.717 Test Loss: 0.583 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 2.620166778564453
Epoch: 2, Steps: 13 | Train Loss: 0.586 Vali Loss: 0.588 Vali Acc: 0.717 Test Loss: 0.588 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.634054183959961
Epoch: 3, Steps: 13 | Train Loss: 0.559 Vali Loss: 0.569 Vali Acc: 0.722 Test Loss: 0.569 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721946).  Saving model ...
Epoch: 4 cost time: 2.604592800140381
Epoch: 4, Steps: 13 | Train Loss: 0.554 Vali Loss: 0.561 Vali Acc: 0.722 Test Loss: 0.561 Test Acc: 0.722
Validation loss decreased (-0.721946 --> -0.721946).  Saving model ...
Epoch: 5 cost time: 2.590132236480713
Epoch: 5, Steps: 13 | Train Loss: 0.524 Vali Loss: 0.554 Vali Acc: 0.732 Test Loss: 0.554 Test Acc: 0.732
Validation loss decreased (-0.721946 --> -0.731702).  Saving model ...
Epoch: 6 cost time: 2.613151788711548
Epoch: 6, Steps: 13 | Train Loss: 0.498 Vali Loss: 0.547 Vali Acc: 0.732 Test Loss: 0.547 Test Acc: 0.732
Validation loss decreased (-0.731702 --> -0.731702).  Saving model ...
Epoch: 7 cost time: 2.577486991882324
Epoch: 7, Steps: 13 | Train Loss: 0.470 Vali Loss: 0.566 Vali Acc: 0.737 Test Loss: 0.566 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736580).  Saving model ...
Epoch: 8 cost time: 2.6514205932617188
Epoch: 8, Steps: 13 | Train Loss: 0.471 Vali Loss: 0.540 Vali Acc: 0.732 Test Loss: 0.540 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.6618173122406006
Epoch: 9, Steps: 13 | Train Loss: 0.451 Vali Loss: 0.540 Vali Acc: 0.737 Test Loss: 0.540 Test Acc: 0.737
Validation loss decreased (-0.736580 --> -0.736580).  Saving model ...
Epoch: 10 cost time: 2.6488873958587646
Epoch: 10, Steps: 13 | Train Loss: 0.429 Vali Loss: 0.539 Vali Acc: 0.732 Test Loss: 0.539 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.604696750640869
Epoch: 11, Steps: 13 | Train Loss: 0.387 Vali Loss: 0.533 Vali Acc: 0.761 Test Loss: 0.533 Test Acc: 0.761
Validation loss decreased (-0.736580 --> -0.760970).  Saving model ...
Epoch: 12 cost time: 2.612530469894409
Epoch: 12, Steps: 13 | Train Loss: 0.382 Vali Loss: 0.532 Vali Acc: 0.756 Test Loss: 0.532 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.6247801780700684
Epoch: 13, Steps: 13 | Train Loss: 0.396 Vali Loss: 0.545 Vali Acc: 0.698 Test Loss: 0.545 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.285761594772339
Epoch: 14, Steps: 13 | Train Loss: 0.376 Vali Loss: 0.540 Vali Acc: 0.751 Test Loss: 0.540 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.569563150405884
Epoch: 15, Steps: 13 | Train Loss: 0.338 Vali Loss: 0.519 Vali Acc: 0.737 Test Loss: 0.519 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.527979612350464
Epoch: 16, Steps: 13 | Train Loss: 0.327 Vali Loss: 0.536 Vali Acc: 0.707 Test Loss: 0.536 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.4913270473480225
Epoch: 17, Steps: 13 | Train Loss: 0.325 Vali Loss: 0.558 Vali Acc: 0.756 Test Loss: 0.558 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.453378438949585
Epoch: 18, Steps: 13 | Train Loss: 0.292 Vali Loss: 0.524 Vali Acc: 0.732 Test Loss: 0.524 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.4590861797332764
Epoch: 19, Steps: 13 | Train Loss: 0.293 Vali Loss: 0.545 Vali Acc: 0.702 Test Loss: 0.545 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.3188414573669434
Epoch: 20, Steps: 13 | Train Loss: 0.261 Vali Loss: 0.546 Vali Acc: 0.741 Test Loss: 0.546 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.482128858566284
Epoch: 21, Steps: 13 | Train Loss: 0.260 Vali Loss: 0.577 Vali Acc: 0.663 Test Loss: 0.577 Test Acc: 0.663
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 51194
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.773963689804077
Epoch: 1, Steps: 13 | Train Loss: 0.771 Vali Loss: 0.607 Vali Acc: 0.727 Test Loss: 0.607 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 2.660494565963745
Epoch: 2, Steps: 13 | Train Loss: 0.603 Vali Loss: 0.578 Vali Acc: 0.722 Test Loss: 0.578 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.123961925506592
Epoch: 3, Steps: 13 | Train Loss: 0.555 Vali Loss: 0.554 Vali Acc: 0.727 Test Loss: 0.554 Test Acc: 0.727
Validation loss decreased (-0.726823 --> -0.726824).  Saving model ...
Epoch: 4 cost time: 3.0953140258789062
Epoch: 4, Steps: 13 | Train Loss: 0.521 Vali Loss: 0.547 Vali Acc: 0.741 Test Loss: 0.547 Test Acc: 0.741
Validation loss decreased (-0.726824 --> -0.741458).  Saving model ...
Epoch: 5 cost time: 3.134768486022949
Epoch: 5, Steps: 13 | Train Loss: 0.512 Vali Loss: 0.536 Vali Acc: 0.741 Test Loss: 0.536 Test Acc: 0.741
Validation loss decreased (-0.741458 --> -0.741458).  Saving model ...
Epoch: 6 cost time: 3.1502015590667725
Epoch: 6, Steps: 13 | Train Loss: 0.483 Vali Loss: 0.533 Vali Acc: 0.746 Test Loss: 0.533 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746336).  Saving model ...
Epoch: 7 cost time: 3.0622267723083496
Epoch: 7, Steps: 13 | Train Loss: 0.483 Vali Loss: 0.532 Vali Acc: 0.741 Test Loss: 0.532 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.2439212799072266
Epoch: 8, Steps: 13 | Train Loss: 0.454 Vali Loss: 0.525 Vali Acc: 0.737 Test Loss: 0.525 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.1753835678100586
Epoch: 9, Steps: 13 | Train Loss: 0.424 Vali Loss: 0.517 Vali Acc: 0.766 Test Loss: 0.517 Test Acc: 0.766
Validation loss decreased (-0.746336 --> -0.765848).  Saving model ...
Epoch: 10 cost time: 3.199735641479492
Epoch: 10, Steps: 13 | Train Loss: 0.409 Vali Loss: 0.516 Vali Acc: 0.761 Test Loss: 0.516 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.279794216156006
Epoch: 11, Steps: 13 | Train Loss: 0.371 Vali Loss: 0.513 Vali Acc: 0.766 Test Loss: 0.513 Test Acc: 0.766
Validation loss decreased (-0.765848 --> -0.765849).  Saving model ...
Epoch: 12 cost time: 3.011364459991455
Epoch: 12, Steps: 13 | Train Loss: 0.377 Vali Loss: 0.521 Vali Acc: 0.780 Test Loss: 0.521 Test Acc: 0.780
Validation loss decreased (-0.765849 --> -0.780483).  Saving model ...
Epoch: 13 cost time: 3.150899887084961
Epoch: 13, Steps: 13 | Train Loss: 0.337 Vali Loss: 0.515 Vali Acc: 0.776 Test Loss: 0.515 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.1527092456817627
Epoch: 14, Steps: 13 | Train Loss: 0.338 Vali Loss: 0.513 Vali Acc: 0.771 Test Loss: 0.513 Test Acc: 0.771
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.2448697090148926
Epoch: 15, Steps: 13 | Train Loss: 0.295 Vali Loss: 0.568 Vali Acc: 0.771 Test Loss: 0.568 Test Acc: 0.771
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.210453748703003
Epoch: 16, Steps: 13 | Train Loss: 0.306 Vali Loss: 0.536 Vali Acc: 0.737 Test Loss: 0.536 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.2014036178588867
Epoch: 17, Steps: 13 | Train Loss: 0.276 Vali Loss: 0.601 Vali Acc: 0.756 Test Loss: 0.601 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.2323882579803467
Epoch: 18, Steps: 13 | Train Loss: 0.269 Vali Loss: 0.534 Vali Acc: 0.751 Test Loss: 0.534 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.0082590579986572
Epoch: 19, Steps: 13 | Train Loss: 0.243 Vali Loss: 0.567 Vali Acc: 0.722 Test Loss: 0.567 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.209087371826172
Epoch: 20, Steps: 13 | Train Loss: 0.221 Vali Loss: 0.565 Vali Acc: 0.751 Test Loss: 0.565 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.1290767192840576
Epoch: 21, Steps: 13 | Train Loss: 0.230 Vali Loss: 0.570 Vali Acc: 0.727 Test Loss: 0.570 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.1945180892944336
Epoch: 22, Steps: 13 | Train Loss: 0.219 Vali Loss: 0.572 Vali Acc: 0.756 Test Loss: 0.572 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7804878048780488
model parameter : 154714
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.8720853328704834
Epoch: 1, Steps: 13 | Train Loss: 0.670 Vali Loss: 0.584 Vali Acc: 0.717 Test Loss: 0.584 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 2.274009943008423
Epoch: 2, Steps: 13 | Train Loss: 0.586 Vali Loss: 0.589 Vali Acc: 0.712 Test Loss: 0.589 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8073680400848389
Epoch: 3, Steps: 13 | Train Loss: 0.558 Vali Loss: 0.568 Vali Acc: 0.727 Test Loss: 0.568 Test Acc: 0.727
Validation loss decreased (-0.717067 --> -0.726824).  Saving model ...
Epoch: 4 cost time: 2.2942020893096924
Epoch: 4, Steps: 13 | Train Loss: 0.551 Vali Loss: 0.559 Vali Acc: 0.722 Test Loss: 0.559 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2175111770629883
Epoch: 5, Steps: 13 | Train Loss: 0.526 Vali Loss: 0.553 Vali Acc: 0.727 Test Loss: 0.553 Test Acc: 0.727
Validation loss decreased (-0.726824 --> -0.726824).  Saving model ...
Epoch: 6 cost time: 2.223569631576538
Epoch: 6, Steps: 13 | Train Loss: 0.498 Vali Loss: 0.546 Vali Acc: 0.727 Test Loss: 0.546 Test Acc: 0.727
Validation loss decreased (-0.726824 --> -0.726824).  Saving model ...
Epoch: 7 cost time: 2.215776205062866
Epoch: 7, Steps: 13 | Train Loss: 0.471 Vali Loss: 0.561 Vali Acc: 0.732 Test Loss: 0.561 Test Acc: 0.732
Validation loss decreased (-0.726824 --> -0.731702).  Saving model ...
Epoch: 8 cost time: 2.2246313095092773
Epoch: 8, Steps: 13 | Train Loss: 0.475 Vali Loss: 0.536 Vali Acc: 0.732 Test Loss: 0.536 Test Acc: 0.732
Validation loss decreased (-0.731702 --> -0.731702).  Saving model ...
Epoch: 9 cost time: 2.292785882949829
Epoch: 9, Steps: 13 | Train Loss: 0.452 Vali Loss: 0.533 Vali Acc: 0.727 Test Loss: 0.533 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.251552104949951
Epoch: 10, Steps: 13 | Train Loss: 0.428 Vali Loss: 0.534 Vali Acc: 0.737 Test Loss: 0.534 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736580).  Saving model ...
Epoch: 11 cost time: 2.2736012935638428
Epoch: 11, Steps: 13 | Train Loss: 0.388 Vali Loss: 0.527 Vali Acc: 0.761 Test Loss: 0.527 Test Acc: 0.761
Validation loss decreased (-0.736580 --> -0.760970).  Saving model ...
Epoch: 12 cost time: 2.2164711952209473
Epoch: 12, Steps: 13 | Train Loss: 0.389 Vali Loss: 0.524 Vali Acc: 0.766 Test Loss: 0.524 Test Acc: 0.766
Validation loss decreased (-0.760970 --> -0.765848).  Saving model ...
Epoch: 13 cost time: 2.2544355392456055
Epoch: 13, Steps: 13 | Train Loss: 0.398 Vali Loss: 0.534 Vali Acc: 0.722 Test Loss: 0.534 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.2436606884002686
Epoch: 14, Steps: 13 | Train Loss: 0.377 Vali Loss: 0.531 Vali Acc: 0.756 Test Loss: 0.531 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.1984684467315674
Epoch: 15, Steps: 13 | Train Loss: 0.333 Vali Loss: 0.515 Vali Acc: 0.746 Test Loss: 0.515 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.2570178508758545
Epoch: 16, Steps: 13 | Train Loss: 0.331 Vali Loss: 0.539 Vali Acc: 0.702 Test Loss: 0.539 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.226027011871338
Epoch: 17, Steps: 13 | Train Loss: 0.333 Vali Loss: 0.546 Vali Acc: 0.761 Test Loss: 0.546 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.255884885787964
Epoch: 18, Steps: 13 | Train Loss: 0.286 Vali Loss: 0.533 Vali Acc: 0.746 Test Loss: 0.533 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.2225780487060547
Epoch: 19, Steps: 13 | Train Loss: 0.292 Vali Loss: 0.568 Vali Acc: 0.663 Test Loss: 0.568 Test Acc: 0.663
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.197319746017456
Epoch: 20, Steps: 13 | Train Loss: 0.265 Vali Loss: 0.558 Vali Acc: 0.751 Test Loss: 0.558 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.2492308616638184
Epoch: 21, Steps: 13 | Train Loss: 0.250 Vali Loss: 0.573 Vali Acc: 0.659 Test Loss: 0.573 Test Acc: 0.659
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.2103796005249023
Epoch: 22, Steps: 13 | Train Loss: 0.231 Vali Loss: 0.570 Vali Acc: 0.751 Test Loss: 0.570 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 51194
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.444960117340088
Epoch: 1, Steps: 13 | Train Loss: 0.773 Vali Loss: 0.612 Vali Acc: 0.727 Test Loss: 0.612 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 2.4098012447357178
Epoch: 2, Steps: 13 | Train Loss: 0.603 Vali Loss: 0.584 Vali Acc: 0.722 Test Loss: 0.584 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.371885061264038
Epoch: 3, Steps: 13 | Train Loss: 0.558 Vali Loss: 0.562 Vali Acc: 0.722 Test Loss: 0.562 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.469569444656372
Epoch: 4, Steps: 13 | Train Loss: 0.521 Vali Loss: 0.561 Vali Acc: 0.737 Test Loss: 0.561 Test Acc: 0.737
Validation loss decreased (-0.726823 --> -0.736580).  Saving model ...
Epoch: 5 cost time: 2.3502824306488037
Epoch: 5, Steps: 13 | Train Loss: 0.518 Vali Loss: 0.550 Vali Acc: 0.727 Test Loss: 0.550 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.4191997051239014
Epoch: 6, Steps: 13 | Train Loss: 0.491 Vali Loss: 0.537 Vali Acc: 0.741 Test Loss: 0.537 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741458).  Saving model ...
Epoch: 7 cost time: 2.3859691619873047
Epoch: 7, Steps: 13 | Train Loss: 0.493 Vali Loss: 0.511 Vali Acc: 0.741 Test Loss: 0.511 Test Acc: 0.741
Validation loss decreased (-0.741458 --> -0.741458).  Saving model ...
Epoch: 8 cost time: 2.3280396461486816
Epoch: 8, Steps: 13 | Train Loss: 0.458 Vali Loss: 0.492 Vali Acc: 0.746 Test Loss: 0.492 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746337).  Saving model ...
Epoch: 9 cost time: 2.3675172328948975
Epoch: 9, Steps: 13 | Train Loss: 0.438 Vali Loss: 0.489 Vali Acc: 0.776 Test Loss: 0.489 Test Acc: 0.776
Validation loss decreased (-0.746337 --> -0.775605).  Saving model ...
Epoch: 10 cost time: 2.3441970348358154
Epoch: 10, Steps: 13 | Train Loss: 0.428 Vali Loss: 0.508 Vali Acc: 0.761 Test Loss: 0.508 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.388793706893921
Epoch: 11, Steps: 13 | Train Loss: 0.394 Vali Loss: 0.497 Vali Acc: 0.766 Test Loss: 0.497 Test Acc: 0.766
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.3192830085754395
Epoch: 12, Steps: 13 | Train Loss: 0.400 Vali Loss: 0.491 Vali Acc: 0.761 Test Loss: 0.491 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.3198859691619873
Epoch: 13, Steps: 13 | Train Loss: 0.360 Vali Loss: 0.501 Vali Acc: 0.766 Test Loss: 0.501 Test Acc: 0.766
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.186216354370117
Epoch: 14, Steps: 13 | Train Loss: 0.351 Vali Loss: 0.515 Vali Acc: 0.776 Test Loss: 0.515 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.404442071914673
Epoch: 15, Steps: 13 | Train Loss: 0.316 Vali Loss: 0.544 Vali Acc: 0.766 Test Loss: 0.544 Test Acc: 0.766
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.4691553115844727
Epoch: 16, Steps: 13 | Train Loss: 0.343 Vali Loss: 0.521 Vali Acc: 0.746 Test Loss: 0.521 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.4548730850219727
Epoch: 17, Steps: 13 | Train Loss: 0.287 Vali Loss: 0.520 Vali Acc: 0.785 Test Loss: 0.520 Test Acc: 0.785
Validation loss decreased (-0.775605 --> -0.785361).  Saving model ...
Epoch: 18 cost time: 2.4587738513946533
Epoch: 18, Steps: 13 | Train Loss: 0.276 Vali Loss: 0.502 Vali Acc: 0.780 Test Loss: 0.502 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.4513306617736816
Epoch: 19, Steps: 13 | Train Loss: 0.269 Vali Loss: 0.532 Vali Acc: 0.751 Test Loss: 0.532 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.487412452697754
Epoch: 20, Steps: 13 | Train Loss: 0.262 Vali Loss: 0.521 Vali Acc: 0.785 Test Loss: 0.521 Test Acc: 0.785
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.4444022178649902
Epoch: 21, Steps: 13 | Train Loss: 0.248 Vali Loss: 0.456 Vali Acc: 0.780 Test Loss: 0.456 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.429429292678833
Epoch: 22, Steps: 13 | Train Loss: 0.313 Vali Loss: 0.522 Vali Acc: 0.805 Test Loss: 0.522 Test Acc: 0.805
Validation loss decreased (-0.785361 --> -0.804873).  Saving model ...
Epoch: 23 cost time: 2.525667667388916
Epoch: 23, Steps: 13 | Train Loss: 0.221 Vali Loss: 0.536 Vali Acc: 0.732 Test Loss: 0.536 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.5112082958221436
Epoch: 24, Steps: 13 | Train Loss: 0.221 Vali Loss: 0.567 Vali Acc: 0.756 Test Loss: 0.567 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.352181911468506
Epoch: 25, Steps: 13 | Train Loss: 0.191 Vali Loss: 0.584 Vali Acc: 0.737 Test Loss: 0.584 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.5221543312072754
Epoch: 26, Steps: 13 | Train Loss: 0.177 Vali Loss: 0.578 Vali Acc: 0.727 Test Loss: 0.578 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.472093105316162
Epoch: 27, Steps: 13 | Train Loss: 0.159 Vali Loss: 0.599 Vali Acc: 0.732 Test Loss: 0.599 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.4122958183288574
Epoch: 28, Steps: 13 | Train Loss: 0.158 Vali Loss: 0.607 Vali Acc: 0.698 Test Loss: 0.607 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.4951441287994385
Epoch: 29, Steps: 13 | Train Loss: 0.159 Vali Loss: 0.508 Vali Acc: 0.766 Test Loss: 0.508 Test Acc: 0.766
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.4924492835998535
Epoch: 30, Steps: 13 | Train Loss: 0.154 Vali Loss: 0.524 Vali Acc: 0.780 Test Loss: 0.524 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.8048780487804879
model parameter : 154714
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.5977630615234375
Epoch: 1, Steps: 13 | Train Loss: 0.674 Vali Loss: 0.583 Vali Acc: 0.717 Test Loss: 0.583 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.9119954109191895
Epoch: 2, Steps: 13 | Train Loss: 0.592 Vali Loss: 0.592 Vali Acc: 0.712 Test Loss: 0.592 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9189226627349854
Epoch: 3, Steps: 13 | Train Loss: 0.561 Vali Loss: 0.570 Vali Acc: 0.722 Test Loss: 0.570 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721946).  Saving model ...
Epoch: 4 cost time: 1.8715717792510986
Epoch: 4, Steps: 13 | Train Loss: 0.557 Vali Loss: 0.560 Vali Acc: 0.717 Test Loss: 0.560 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9596443176269531
Epoch: 5, Steps: 13 | Train Loss: 0.531 Vali Loss: 0.557 Vali Acc: 0.722 Test Loss: 0.557 Test Acc: 0.722
Validation loss decreased (-0.721946 --> -0.721946).  Saving model ...
Epoch: 6 cost time: 1.960890293121338
Epoch: 6, Steps: 13 | Train Loss: 0.506 Vali Loss: 0.546 Vali Acc: 0.722 Test Loss: 0.546 Test Acc: 0.722
Validation loss decreased (-0.721946 --> -0.721946).  Saving model ...
Epoch: 7 cost time: 1.9042959213256836
Epoch: 7, Steps: 13 | Train Loss: 0.480 Vali Loss: 0.565 Vali Acc: 0.727 Test Loss: 0.565 Test Acc: 0.727
Validation loss decreased (-0.721946 --> -0.726824).  Saving model ...
Epoch: 8 cost time: 1.9121308326721191
Epoch: 8, Steps: 13 | Train Loss: 0.486 Vali Loss: 0.543 Vali Acc: 0.741 Test Loss: 0.543 Test Acc: 0.741
Validation loss decreased (-0.726824 --> -0.741458).  Saving model ...
Epoch: 9 cost time: 1.8666326999664307
Epoch: 9, Steps: 13 | Train Loss: 0.462 Vali Loss: 0.554 Vali Acc: 0.727 Test Loss: 0.554 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.939934492111206
Epoch: 10, Steps: 13 | Train Loss: 0.437 Vali Loss: 0.538 Vali Acc: 0.741 Test Loss: 0.538 Test Acc: 0.741
Validation loss decreased (-0.741458 --> -0.741458).  Saving model ...
Epoch: 11 cost time: 1.9141085147857666
Epoch: 11, Steps: 13 | Train Loss: 0.400 Vali Loss: 0.505 Vali Acc: 0.761 Test Loss: 0.505 Test Acc: 0.761
Validation loss decreased (-0.741458 --> -0.760971).  Saving model ...
Epoch: 12 cost time: 1.9565086364746094
Epoch: 12, Steps: 13 | Train Loss: 0.402 Vali Loss: 0.513 Vali Acc: 0.761 Test Loss: 0.513 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.03895902633667
Epoch: 13, Steps: 13 | Train Loss: 0.409 Vali Loss: 0.548 Vali Acc: 0.722 Test Loss: 0.548 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.9337353706359863
Epoch: 14, Steps: 13 | Train Loss: 0.392 Vali Loss: 0.542 Vali Acc: 0.741 Test Loss: 0.542 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.931983470916748
Epoch: 15, Steps: 13 | Train Loss: 0.347 Vali Loss: 0.509 Vali Acc: 0.751 Test Loss: 0.509 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.9138989448547363
Epoch: 16, Steps: 13 | Train Loss: 0.353 Vali Loss: 0.562 Vali Acc: 0.698 Test Loss: 0.562 Test Acc: 0.698
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.8861634731292725
Epoch: 17, Steps: 13 | Train Loss: 0.352 Vali Loss: 0.574 Vali Acc: 0.741 Test Loss: 0.574 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.9439918994903564
Epoch: 18, Steps: 13 | Train Loss: 0.314 Vali Loss: 0.513 Vali Acc: 0.741 Test Loss: 0.513 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.0825886726379395
Epoch: 19, Steps: 13 | Train Loss: 0.338 Vali Loss: 0.548 Vali Acc: 0.702 Test Loss: 0.548 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.1003987789154053
Epoch: 20, Steps: 13 | Train Loss: 0.279 Vali Loss: 0.562 Vali Acc: 0.737 Test Loss: 0.562 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.0344483852386475
Epoch: 21, Steps: 13 | Train Loss: 0.272 Vali Loss: 0.621 Vali Acc: 0.634 Test Loss: 0.621 Test Acc: 0.634
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_TimesNet_UEA_ftM_sl405_ll0_pl0_el2_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 51194
model size : 0.36MB
