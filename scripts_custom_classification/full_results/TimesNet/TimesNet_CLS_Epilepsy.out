Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 32.81667613983154
Epoch: 1, Steps: 9 | Train Loss: 1.301 Vali Loss: 0.952 Vali Acc: 0.754 Test Loss: 0.952 Test Acc: 0.754
Validation loss decreased (inf --> -0.753614).  Saving model ...
Epoch: 2 cost time: 36.513487100601196
Epoch: 2, Steps: 9 | Train Loss: 0.702 Vali Loss: 0.471 Vali Acc: 0.826 Test Loss: 0.471 Test Acc: 0.826
Validation loss decreased (-0.753614 --> -0.826082).  Saving model ...
Epoch: 3 cost time: 29.859039068222046
Epoch: 3, Steps: 9 | Train Loss: 0.377 Vali Loss: 0.336 Vali Acc: 0.862 Test Loss: 0.336 Test Acc: 0.862
Validation loss decreased (-0.826082 --> -0.862315).  Saving model ...
Epoch: 4 cost time: 36.640958309173584
Epoch: 4, Steps: 9 | Train Loss: 0.369 Vali Loss: 0.466 Vali Acc: 0.848 Test Loss: 0.466 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 37.2721905708313
Epoch: 5, Steps: 9 | Train Loss: 0.080 Vali Loss: 0.392 Vali Acc: 0.877 Test Loss: 0.392 Test Acc: 0.877
Validation loss decreased (-0.862315 --> -0.876808).  Saving model ...
Epoch: 6 cost time: 38.639196157455444
Epoch: 6, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.422 Vali Acc: 0.877 Test Loss: 0.422 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 37.308767795562744
Epoch: 7, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.359 Vali Acc: 0.884 Test Loss: 0.359 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884054).  Saving model ...
Epoch: 8 cost time: 38.54627561569214
Epoch: 8, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.544 Vali Acc: 0.848 Test Loss: 0.544 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 39.897480726242065
Epoch: 9, Steps: 9 | Train Loss: 0.302 Vali Loss: 0.721 Vali Acc: 0.783 Test Loss: 0.721 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 37.08671283721924
Epoch: 10, Steps: 9 | Train Loss: 0.220 Vali Loss: 0.968 Vali Acc: 0.725 Test Loss: 0.968 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 38.14768981933594
Epoch: 11, Steps: 9 | Train Loss: 0.087 Vali Loss: 0.564 Vali Acc: 0.848 Test Loss: 0.564 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 34.97273802757263
Epoch: 12, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.714 Vali Acc: 0.833 Test Loss: 0.714 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 36.22393846511841
Epoch: 13, Steps: 9 | Train Loss: 0.222 Vali Loss: 0.475 Vali Acc: 0.826 Test Loss: 0.475 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 38.3170964717865
Epoch: 14, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.576 Vali Acc: 0.855 Test Loss: 0.576 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 37.11326718330383
Epoch: 15, Steps: 9 | Train Loss: 0.168 Vali Loss: 0.655 Vali Acc: 0.783 Test Loss: 0.655 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 37.76098275184631
Epoch: 16, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.588 Vali Acc: 0.870 Test Loss: 0.588 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 34.76482677459717
Epoch: 17, Steps: 9 | Train Loss: 0.147 Vali Loss: 0.615 Vali Acc: 0.848 Test Loss: 0.615 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 75089796
model size : 288.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 14.814284563064575
Epoch: 1, Steps: 9 | Train Loss: 1.447 Vali Loss: 1.053 Vali Acc: 0.609 Test Loss: 1.053 Test Acc: 0.609
Validation loss decreased (inf --> -0.608685).  Saving model ...
Epoch: 2 cost time: 12.910183668136597
Epoch: 2, Steps: 9 | Train Loss: 0.806 Vali Loss: 0.586 Vali Acc: 0.768 Test Loss: 0.586 Test Acc: 0.768
Validation loss decreased (-0.608685 --> -0.768110).  Saving model ...
Epoch: 3 cost time: 13.194966077804565
Epoch: 3, Steps: 9 | Train Loss: 0.448 Vali Loss: 0.444 Vali Acc: 0.833 Test Loss: 0.444 Test Acc: 0.833
Validation loss decreased (-0.768110 --> -0.833329).  Saving model ...
Epoch: 4 cost time: 13.61106538772583
Epoch: 4, Steps: 9 | Train Loss: 0.206 Vali Loss: 0.384 Vali Acc: 0.855 Test Loss: 0.384 Test Acc: 0.855
Validation loss decreased (-0.833329 --> -0.855069).  Saving model ...
Epoch: 5 cost time: 13.430886507034302
Epoch: 5, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.475 Vali Acc: 0.826 Test Loss: 0.475 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 13.37653923034668
Epoch: 6, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.380 Vali Acc: 0.862 Test Loss: 0.380 Test Acc: 0.862
Validation loss decreased (-0.855069 --> -0.862315).  Saving model ...
Epoch: 7 cost time: 12.28208041191101
Epoch: 7, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.666 Vali Acc: 0.819 Test Loss: 0.666 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 10.069184064865112
Epoch: 8, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.400 Vali Acc: 0.877 Test Loss: 0.400 Test Acc: 0.877
Validation loss decreased (-0.862315 --> -0.876808).  Saving model ...
Epoch: 9 cost time: 9.960839748382568
Epoch: 9, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.360 Vali Acc: 0.913 Test Loss: 0.360 Test Acc: 0.913
Validation loss decreased (-0.876808 --> -0.913040).  Saving model ...
Epoch: 10 cost time: 12.811877727508545
Epoch: 10, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.376 Vali Acc: 0.884 Test Loss: 0.376 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 12.951483488082886
Epoch: 11, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.509 Vali Acc: 0.891 Test Loss: 0.509 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 13.192109107971191
Epoch: 12, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.559 Vali Acc: 0.884 Test Loss: 0.559 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 12.419370651245117
Epoch: 13, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.648 Vali Acc: 0.862 Test Loss: 0.648 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 12.718520879745483
Epoch: 14, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.711 Vali Acc: 0.870 Test Loss: 0.711 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 11.794193267822266
Epoch: 15, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.527 Vali Acc: 0.899 Test Loss: 0.527 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 12.22180438041687
Epoch: 16, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.531 Vali Acc: 0.862 Test Loss: 0.531 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 12.8788583278656
Epoch: 17, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.509 Vali Acc: 0.862 Test Loss: 0.509 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 13.57282280921936
Epoch: 18, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.318 Vali Acc: 0.928 Test Loss: 0.318 Test Acc: 0.928
Validation loss decreased (-0.913040 --> -0.927533).  Saving model ...
Epoch: 19 cost time: 12.082027435302734
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.353 Vali Acc: 0.928 Test Loss: 0.353 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 13.895342826843262
Epoch: 20, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.452 Vali Acc: 0.906 Test Loss: 0.452 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 13.702114582061768
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.538 Vali Acc: 0.891 Test Loss: 0.538 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 12.089653253555298
Epoch: 22, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.552 Vali Acc: 0.913 Test Loss: 0.552 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 13.220262050628662
Epoch: 23, Steps: 9 | Train Loss: 0.283 Vali Loss: 0.720 Vali Acc: 0.841 Test Loss: 0.720 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 13.671319484710693
Epoch: 24, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.757 Vali Acc: 0.826 Test Loss: 0.757 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 13.79763150215149
Epoch: 25, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.673 Vali Acc: 0.754 Test Loss: 0.673 Test Acc: 0.754
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 13.741159915924072
Epoch: 26, Steps: 9 | Train Loss: 0.014 Vali Loss: 1.545 Vali Acc: 0.645 Test Loss: 1.545 Test Acc: 0.645
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 13.793099641799927
Epoch: 27, Steps: 9 | Train Loss: 0.378 Vali Loss: 0.581 Vali Acc: 0.833 Test Loss: 0.581 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 12.82236123085022
Epoch: 28, Steps: 9 | Train Loss: 0.149 Vali Loss: 3.758 Vali Acc: 0.732 Test Loss: 3.758 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.927536231884058
model parameter : 22133636
model size : 86.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 26.68712067604065
Epoch: 1, Steps: 9 | Train Loss: 1.309 Vali Loss: 1.010 Vali Acc: 0.703 Test Loss: 1.010 Test Acc: 0.703
Validation loss decreased (inf --> -0.702888).  Saving model ...
Epoch: 2 cost time: 18.06481146812439
Epoch: 2, Steps: 9 | Train Loss: 0.812 Vali Loss: 0.521 Vali Acc: 0.812 Test Loss: 0.521 Test Acc: 0.812
Validation loss decreased (-0.702888 --> -0.811589).  Saving model ...
Epoch: 3 cost time: 23.641486883163452
Epoch: 3, Steps: 9 | Train Loss: 0.372 Vali Loss: 0.295 Vali Acc: 0.884 Test Loss: 0.295 Test Acc: 0.884
Validation loss decreased (-0.811589 --> -0.884055).  Saving model ...
Epoch: 4 cost time: 23.57140350341797
Epoch: 4, Steps: 9 | Train Loss: 0.226 Vali Loss: 0.457 Vali Acc: 0.833 Test Loss: 0.457 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 26.383710622787476
Epoch: 5, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.309 Vali Acc: 0.891 Test Loss: 0.309 Test Acc: 0.891
Validation loss decreased (-0.884055 --> -0.891301).  Saving model ...
Epoch: 6 cost time: 25.725558519363403
Epoch: 6, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.392 Vali Acc: 0.877 Test Loss: 0.392 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 27.018689155578613
Epoch: 7, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.338 Vali Acc: 0.877 Test Loss: 0.338 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 26.22152280807495
Epoch: 8, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.476 Vali Acc: 0.891 Test Loss: 0.476 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 26.636175870895386
Epoch: 9, Steps: 9 | Train Loss: 0.330 Vali Loss: 0.766 Vali Acc: 0.804 Test Loss: 0.766 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 26.93863272666931
Epoch: 10, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.543 Vali Acc: 0.870 Test Loss: 0.543 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 26.415387392044067
Epoch: 11, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.617 Vali Acc: 0.862 Test Loss: 0.617 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 25.825072288513184
Epoch: 12, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.566 Vali Acc: 0.862 Test Loss: 0.566 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 25.03389620780945
Epoch: 13, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.597 Vali Acc: 0.855 Test Loss: 0.597 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 23.977227926254272
Epoch: 14, Steps: 9 | Train Loss: 0.262 Vali Loss: 0.585 Vali Acc: 0.848 Test Loss: 0.585 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 18.250359058380127
Epoch: 15, Steps: 9 | Train Loss: 0.204 Vali Loss: 0.385 Vali Acc: 0.884 Test Loss: 0.385 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 75089796
model size : 288.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 10.905962944030762
Epoch: 1, Steps: 9 | Train Loss: 1.454 Vali Loss: 1.089 Vali Acc: 0.594 Test Loss: 1.089 Test Acc: 0.594
Validation loss decreased (inf --> -0.594192).  Saving model ...
Epoch: 2 cost time: 9.632646799087524
Epoch: 2, Steps: 9 | Train Loss: 0.881 Vali Loss: 0.668 Vali Acc: 0.717 Test Loss: 0.668 Test Acc: 0.717
Validation loss decreased (-0.594192 --> -0.717385).  Saving model ...
Epoch: 3 cost time: 9.612710952758789
Epoch: 3, Steps: 9 | Train Loss: 0.476 Vali Loss: 0.419 Vali Acc: 0.833 Test Loss: 0.419 Test Acc: 0.833
Validation loss decreased (-0.717385 --> -0.833329).  Saving model ...
Epoch: 4 cost time: 9.824443578720093
Epoch: 4, Steps: 9 | Train Loss: 0.218 Vali Loss: 0.403 Vali Acc: 0.848 Test Loss: 0.403 Test Acc: 0.848
Validation loss decreased (-0.833329 --> -0.847822).  Saving model ...
Epoch: 5 cost time: 9.613528728485107
Epoch: 5, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.460 Vali Acc: 0.855 Test Loss: 0.460 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855068).  Saving model ...
Epoch: 6 cost time: 9.681415319442749
Epoch: 6, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.347 Vali Acc: 0.877 Test Loss: 0.347 Test Acc: 0.877
Validation loss decreased (-0.855068 --> -0.876808).  Saving model ...
Epoch: 7 cost time: 9.466700315475464
Epoch: 7, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.584 Vali Acc: 0.833 Test Loss: 0.584 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.677363872528076
Epoch: 8, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.464 Vali Acc: 0.891 Test Loss: 0.464 Test Acc: 0.891
Validation loss decreased (-0.876808 --> -0.891300).  Saving model ...
Epoch: 9 cost time: 7.613336801528931
Epoch: 9, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.414 Vali Acc: 0.862 Test Loss: 0.414 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.651509761810303
Epoch: 10, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.402 Vali Acc: 0.891 Test Loss: 0.402 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891300).  Saving model ...
Epoch: 11 cost time: 9.721784830093384
Epoch: 11, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.439 Vali Acc: 0.891 Test Loss: 0.439 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 10.30878758430481
Epoch: 12, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.464 Vali Acc: 0.899 Test Loss: 0.464 Test Acc: 0.899
Validation loss decreased (-0.891300 --> -0.898546).  Saving model ...
Epoch: 13 cost time: 8.137585639953613
Epoch: 13, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.455 Vali Acc: 0.906 Test Loss: 0.455 Test Acc: 0.906
Validation loss decreased (-0.898546 --> -0.905793).  Saving model ...
Epoch: 14 cost time: 9.862414360046387
Epoch: 14, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.487 Vali Acc: 0.899 Test Loss: 0.487 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 9.694136619567871
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.475 Vali Acc: 0.899 Test Loss: 0.475 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 9.654710054397583
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.439 Vali Acc: 0.906 Test Loss: 0.439 Test Acc: 0.906
Validation loss decreased (-0.905793 --> -0.905793).  Saving model ...
Epoch: 17 cost time: 9.536247491836548
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.417 Vali Acc: 0.906 Test Loss: 0.417 Test Acc: 0.906
Validation loss decreased (-0.905793 --> -0.905793).  Saving model ...
Epoch: 18 cost time: 9.92424201965332
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.419 Vali Acc: 0.906 Test Loss: 0.419 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 9.769384860992432
Epoch: 19, Steps: 9 | Train Loss: 0.139 Vali Loss: 0.593 Vali Acc: 0.833 Test Loss: 0.593 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 9.748157262802124
Epoch: 20, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.556 Vali Acc: 0.891 Test Loss: 0.556 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 8.937970638275146
Epoch: 21, Steps: 9 | Train Loss: 0.020 Vali Loss: 1.884 Vali Acc: 0.797 Test Loss: 1.884 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 9.62893033027649
Epoch: 22, Steps: 9 | Train Loss: 0.195 Vali Loss: 0.694 Vali Acc: 0.855 Test Loss: 0.694 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 9.856674671173096
Epoch: 23, Steps: 9 | Train Loss: 0.136 Vali Loss: 1.096 Vali Acc: 0.717 Test Loss: 1.096 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 9.843584299087524
Epoch: 24, Steps: 9 | Train Loss: 0.109 Vali Loss: 0.674 Vali Acc: 0.833 Test Loss: 0.674 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 9.857338666915894
Epoch: 25, Steps: 9 | Train Loss: 0.169 Vali Loss: 0.779 Vali Acc: 0.804 Test Loss: 0.779 Test Acc: 0.804
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 9.981413841247559
Epoch: 26, Steps: 9 | Train Loss: 0.125 Vali Loss: 0.658 Vali Acc: 0.833 Test Loss: 0.658 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 9.84725046157837
Epoch: 27, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.446 Vali Acc: 0.877 Test Loss: 0.446 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 22133636
model size : 86.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 14.063239097595215
Epoch: 1, Steps: 9 | Train Loss: 1.314 Vali Loss: 1.106 Vali Acc: 0.572 Test Loss: 1.106 Test Acc: 0.572
Validation loss decreased (inf --> -0.572453).  Saving model ...
Epoch: 2 cost time: 12.535423755645752
Epoch: 2, Steps: 9 | Train Loss: 0.855 Vali Loss: 0.758 Vali Acc: 0.696 Test Loss: 0.758 Test Acc: 0.696
Validation loss decreased (-0.572453 --> -0.695645).  Saving model ...
Epoch: 3 cost time: 14.824243307113647
Epoch: 3, Steps: 9 | Train Loss: 0.450 Vali Loss: 0.436 Vali Acc: 0.833 Test Loss: 0.436 Test Acc: 0.833
Validation loss decreased (-0.695645 --> -0.833329).  Saving model ...
Epoch: 4 cost time: 14.027005195617676
Epoch: 4, Steps: 9 | Train Loss: 0.200 Vali Loss: 0.459 Vali Acc: 0.826 Test Loss: 0.459 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 14.3406240940094
Epoch: 5, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.401 Vali Acc: 0.848 Test Loss: 0.401 Test Acc: 0.848
Validation loss decreased (-0.833329 --> -0.847822).  Saving model ...
Epoch: 6 cost time: 14.077298879623413
Epoch: 6, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.433 Vali Acc: 0.870 Test Loss: 0.433 Test Acc: 0.870
Validation loss decreased (-0.847822 --> -0.869561).  Saving model ...
Epoch: 7 cost time: 16.33173966407776
Epoch: 7, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.368 Vali Acc: 0.899 Test Loss: 0.368 Test Acc: 0.899
Validation loss decreased (-0.869561 --> -0.898547).  Saving model ...
Epoch: 8 cost time: 13.286330223083496
Epoch: 8, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.475 Vali Acc: 0.884 Test Loss: 0.475 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 14.25800895690918
Epoch: 9, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.837 Vali Acc: 0.841 Test Loss: 0.837 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 16.66587209701538
Epoch: 10, Steps: 9 | Train Loss: 0.495 Vali Loss: 1.404 Vali Acc: 0.717 Test Loss: 1.404 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 17.080936670303345
Epoch: 11, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.527 Vali Acc: 0.746 Test Loss: 1.527 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 16.776399850845337
Epoch: 12, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.481 Vali Acc: 0.746 Test Loss: 1.481 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 16.927836656570435
Epoch: 13, Steps: 9 | Train Loss: 0.015 Vali Loss: 1.192 Vali Acc: 0.739 Test Loss: 1.192 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 16.953245401382446
Epoch: 14, Steps: 9 | Train Loss: 0.252 Vali Loss: 0.608 Vali Acc: 0.797 Test Loss: 0.608 Test Acc: 0.797
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 16.702306270599365
Epoch: 15, Steps: 9 | Train Loss: 0.106 Vali Loss: 1.063 Vali Acc: 0.804 Test Loss: 1.063 Test Acc: 0.804
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 16.690908432006836
Epoch: 16, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.790 Vali Acc: 0.783 Test Loss: 0.790 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 16.52916407585144
Epoch: 17, Steps: 9 | Train Loss: 0.397 Vali Loss: 0.683 Vali Acc: 0.819 Test Loss: 0.683 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 75089796
model size : 288.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.284778356552124
Epoch: 1, Steps: 9 | Train Loss: 1.458 Vali Loss: 1.196 Vali Acc: 0.435 Test Loss: 1.196 Test Acc: 0.435
Validation loss decreased (inf --> -0.434771).  Saving model ...
Epoch: 2 cost time: 5.351475238800049
Epoch: 2, Steps: 9 | Train Loss: 0.956 Vali Loss: 0.876 Vali Acc: 0.623 Test Loss: 0.876 Test Acc: 0.623
Validation loss decreased (-0.434771 --> -0.623180).  Saving model ...
Epoch: 3 cost time: 5.563989639282227
Epoch: 3, Steps: 9 | Train Loss: 0.492 Vali Loss: 0.603 Vali Acc: 0.746 Test Loss: 0.603 Test Acc: 0.746
Validation loss decreased (-0.623180 --> -0.746371).  Saving model ...
Epoch: 4 cost time: 6.3835132122039795
Epoch: 4, Steps: 9 | Train Loss: 0.230 Vali Loss: 0.521 Vali Acc: 0.804 Test Loss: 0.521 Test Acc: 0.804
Validation loss decreased (-0.746371 --> -0.804343).  Saving model ...
Epoch: 5 cost time: 6.531432390213013
Epoch: 5, Steps: 9 | Train Loss: 0.106 Vali Loss: 0.505 Vali Acc: 0.833 Test Loss: 0.505 Test Acc: 0.833
Validation loss decreased (-0.804343 --> -0.833328).  Saving model ...
Epoch: 6 cost time: 6.541219234466553
Epoch: 6, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.339 Vali Acc: 0.899 Test Loss: 0.339 Test Acc: 0.899
Validation loss decreased (-0.833328 --> -0.898547).  Saving model ...
Epoch: 7 cost time: 6.642847299575806
Epoch: 7, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.511 Vali Acc: 0.855 Test Loss: 0.511 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.290862560272217
Epoch: 8, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.530 Vali Acc: 0.870 Test Loss: 0.530 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.1693336963653564
Epoch: 9, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.486 Vali Acc: 0.884 Test Loss: 0.486 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.513668775558472
Epoch: 10, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.481 Vali Acc: 0.877 Test Loss: 0.481 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.597518682479858
Epoch: 11, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.501 Vali Acc: 0.877 Test Loss: 0.501 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 6.706153631210327
Epoch: 12, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.479 Vali Acc: 0.877 Test Loss: 0.479 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 6.180685520172119
Epoch: 13, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.375 Vali Acc: 0.906 Test Loss: 0.375 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905793).  Saving model ...
Epoch: 14 cost time: 6.412444829940796
Epoch: 14, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.436 Vali Acc: 0.891 Test Loss: 0.436 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.6092541217803955
Epoch: 15, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.448 Vali Acc: 0.906 Test Loss: 0.448 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.078970909118652
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.517 Vali Acc: 0.870 Test Loss: 0.517 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.148647308349609
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.419 Vali Acc: 0.906 Test Loss: 0.419 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 5.9180779457092285
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.367 Vali Acc: 0.913 Test Loss: 0.367 Test Acc: 0.913
Validation loss decreased (-0.905793 --> -0.913040).  Saving model ...
Epoch: 19 cost time: 6.548717260360718
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.567 Vali Acc: 0.877 Test Loss: 0.567 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.890058994293213
Epoch: 20, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.422 Vali Acc: 0.884 Test Loss: 0.422 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 6.655822515487671
Epoch: 21, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.516 Vali Acc: 0.891 Test Loss: 0.516 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 6.93560528755188
Epoch: 22, Steps: 9 | Train Loss: 0.191 Vali Loss: 0.344 Vali Acc: 0.928 Test Loss: 0.344 Test Acc: 0.928
Validation loss decreased (-0.913040 --> -0.927533).  Saving model ...
Epoch: 23 cost time: 6.583523511886597
Epoch: 23, Steps: 9 | Train Loss: 0.333 Vali Loss: 4.182 Vali Acc: 0.522 Test Loss: 4.182 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.559225797653198
Epoch: 24, Steps: 9 | Train Loss: 0.173 Vali Loss: 0.706 Vali Acc: 0.841 Test Loss: 0.706 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 6.467399835586548
Epoch: 25, Steps: 9 | Train Loss: 0.663 Vali Loss: 4.916 Vali Acc: 0.536 Test Loss: 4.916 Test Acc: 0.536
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 5.980156421661377
Epoch: 26, Steps: 9 | Train Loss: 0.060 Vali Loss: 6.383 Vali Acc: 0.529 Test Loss: 6.383 Test Acc: 0.529
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 6.794909715652466
Epoch: 27, Steps: 9 | Train Loss: 0.645 Vali Loss: 0.619 Vali Acc: 0.804 Test Loss: 0.619 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 6.3827550411224365
Epoch: 28, Steps: 9 | Train Loss: 0.361 Vali Loss: 2.004 Vali Acc: 0.688 Test Loss: 2.004 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 6.6727354526519775
Epoch: 29, Steps: 9 | Train Loss: 0.887 Vali Loss: 4.096 Vali Acc: 0.710 Test Loss: 4.096 Test Acc: 0.710
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 6.0258824825286865
Epoch: 30, Steps: 9 | Train Loss: 0.875 Vali Loss: 3.444 Vali Acc: 0.732 Test Loss: 3.444 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.927536231884058
model parameter : 22133636
model size : 86.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 21.394150972366333
Epoch: 1, Steps: 9 | Train Loss: 1.345 Vali Loss: 1.032 Vali Acc: 0.667 Test Loss: 1.032 Test Acc: 0.667
Validation loss decreased (inf --> -0.666656).  Saving model ...
Epoch: 2 cost time: 15.536842823028564
Epoch: 2, Steps: 9 | Train Loss: 0.847 Vali Loss: 0.527 Vali Acc: 0.797 Test Loss: 0.527 Test Acc: 0.797
Validation loss decreased (-0.666656 --> -0.797096).  Saving model ...
Epoch: 3 cost time: 14.055916547775269
Epoch: 3, Steps: 9 | Train Loss: 0.406 Vali Loss: 0.374 Vali Acc: 0.877 Test Loss: 0.374 Test Acc: 0.877
Validation loss decreased (-0.797096 --> -0.876808).  Saving model ...
Epoch: 4 cost time: 16.924086093902588
Epoch: 4, Steps: 9 | Train Loss: 0.219 Vali Loss: 0.428 Vali Acc: 0.855 Test Loss: 0.428 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 17.10979461669922
Epoch: 5, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.514 Vali Acc: 0.855 Test Loss: 0.514 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 14.498034000396729
Epoch: 6, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.457 Vali Acc: 0.891 Test Loss: 0.457 Test Acc: 0.891
Validation loss decreased (-0.876808 --> -0.891300).  Saving model ...
Epoch: 7 cost time: 15.157280921936035
Epoch: 7, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.445 Vali Acc: 0.870 Test Loss: 0.445 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 18.865041255950928
Epoch: 8, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.577 Vali Acc: 0.877 Test Loss: 0.577 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 16.304190158843994
Epoch: 9, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.500 Vali Acc: 0.891 Test Loss: 0.500 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 20.260190725326538
Epoch: 10, Steps: 9 | Train Loss: 0.313 Vali Loss: 0.335 Vali Acc: 0.906 Test Loss: 0.335 Test Acc: 0.906
Validation loss decreased (-0.891300 --> -0.905794).  Saving model ...
Epoch: 11 cost time: 20.468189001083374
Epoch: 11, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.486 Vali Acc: 0.855 Test Loss: 0.486 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 18.077858448028564
Epoch: 12, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.581 Vali Acc: 0.833 Test Loss: 0.581 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 19.482435941696167
Epoch: 13, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.679 Vali Acc: 0.833 Test Loss: 0.679 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 20.035674571990967
Epoch: 14, Steps: 9 | Train Loss: 0.021 Vali Loss: 1.504 Vali Acc: 0.783 Test Loss: 1.504 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 17.45441198348999
Epoch: 15, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.912 Vali Acc: 0.754 Test Loss: 0.912 Test Acc: 0.754
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 18.890891790390015
Epoch: 16, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.896 Vali Acc: 0.790 Test Loss: 0.896 Test Acc: 0.790
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 19.118700742721558
Epoch: 17, Steps: 9 | Train Loss: 0.074 Vali Loss: 1.174 Vali Acc: 0.783 Test Loss: 1.174 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 18.803094387054443
Epoch: 18, Steps: 9 | Train Loss: 0.123 Vali Loss: 0.852 Vali Acc: 0.804 Test Loss: 0.852 Test Acc: 0.804
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 17.511168479919434
Epoch: 19, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.480 Vali Acc: 0.870 Test Loss: 0.480 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 16.524677515029907
Epoch: 20, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.510 Vali Acc: 0.870 Test Loss: 0.510 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 37600132
model size : 145.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 8.948662996292114
Epoch: 1, Steps: 9 | Train Loss: 1.450 Vali Loss: 1.055 Vali Acc: 0.688 Test Loss: 1.055 Test Acc: 0.688
Validation loss decreased (inf --> -0.688395).  Saving model ...
Epoch: 2 cost time: 7.430150032043457
Epoch: 2, Steps: 9 | Train Loss: 0.873 Vali Loss: 0.606 Vali Acc: 0.761 Test Loss: 0.606 Test Acc: 0.761
Validation loss decreased (-0.688395 --> -0.760864).  Saving model ...
Epoch: 3 cost time: 7.532880544662476
Epoch: 3, Steps: 9 | Train Loss: 0.475 Vali Loss: 0.497 Vali Acc: 0.790 Test Loss: 0.497 Test Acc: 0.790
Validation loss decreased (-0.760864 --> -0.789850).  Saving model ...
Epoch: 4 cost time: 7.106485366821289
Epoch: 4, Steps: 9 | Train Loss: 0.348 Vali Loss: 0.315 Vali Acc: 0.891 Test Loss: 0.315 Test Acc: 0.891
Validation loss decreased (-0.789850 --> -0.891301).  Saving model ...
Epoch: 5 cost time: 7.214616775512695
Epoch: 5, Steps: 9 | Train Loss: 0.163 Vali Loss: 0.482 Vali Acc: 0.812 Test Loss: 0.482 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.569154977798462
Epoch: 6, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.372 Vali Acc: 0.877 Test Loss: 0.372 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.49907922744751
Epoch: 7, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.555 Vali Acc: 0.833 Test Loss: 0.555 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 7.103446960449219
Epoch: 8, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.399 Vali Acc: 0.906 Test Loss: 0.399 Test Acc: 0.906
Validation loss decreased (-0.891301 --> -0.905793).  Saving model ...
Epoch: 9 cost time: 7.890547037124634
Epoch: 9, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.499 Vali Acc: 0.855 Test Loss: 0.499 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.907328367233276
Epoch: 10, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.483 Vali Acc: 0.848 Test Loss: 0.483 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.936588764190674
Epoch: 11, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.370 Vali Acc: 0.899 Test Loss: 0.370 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 7.121010780334473
Epoch: 12, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.692 Vali Acc: 0.819 Test Loss: 1.692 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 7.112655162811279
Epoch: 13, Steps: 9 | Train Loss: 0.158 Vali Loss: 0.519 Vali Acc: 0.862 Test Loss: 0.519 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.925508260726929
Epoch: 14, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.552 Vali Acc: 0.855 Test Loss: 0.552 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 6.3064985275268555
Epoch: 15, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.680 Vali Acc: 0.826 Test Loss: 0.680 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 6.95375657081604
Epoch: 16, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.591 Vali Acc: 0.833 Test Loss: 0.591 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 7.4644455909729
Epoch: 17, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.552 Vali Acc: 0.848 Test Loss: 0.552 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 7.854723930358887
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.600 Vali Acc: 0.855 Test Loss: 0.600 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 11121540
model size : 44.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 14.523571491241455
Epoch: 1, Steps: 9 | Train Loss: 1.356 Vali Loss: 1.065 Vali Acc: 0.645 Test Loss: 1.065 Test Acc: 0.645
Validation loss decreased (inf --> -0.644917).  Saving model ...
Epoch: 2 cost time: 13.799741506576538
Epoch: 2, Steps: 9 | Train Loss: 0.911 Vali Loss: 0.589 Vali Acc: 0.775 Test Loss: 0.589 Test Acc: 0.775
Validation loss decreased (-0.644917 --> -0.775356).  Saving model ...
Epoch: 3 cost time: 14.079881429672241
Epoch: 3, Steps: 9 | Train Loss: 0.463 Vali Loss: 0.435 Vali Acc: 0.855 Test Loss: 0.435 Test Acc: 0.855
Validation loss decreased (-0.775356 --> -0.855068).  Saving model ...
Epoch: 4 cost time: 13.62444519996643
Epoch: 4, Steps: 9 | Train Loss: 0.261 Vali Loss: 0.475 Vali Acc: 0.819 Test Loss: 0.475 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.972545862197876
Epoch: 5, Steps: 9 | Train Loss: 0.116 Vali Loss: 0.491 Vali Acc: 0.819 Test Loss: 0.491 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 13.364455223083496
Epoch: 6, Steps: 9 | Train Loss: 0.654 Vali Loss: 0.407 Vali Acc: 0.891 Test Loss: 0.407 Test Acc: 0.891
Validation loss decreased (-0.855068 --> -0.891300).  Saving model ...
Epoch: 7 cost time: 13.963255405426025
Epoch: 7, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.424 Vali Acc: 0.841 Test Loss: 0.424 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 14.187879800796509
Epoch: 8, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.393 Vali Acc: 0.870 Test Loss: 0.393 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 14.008589506149292
Epoch: 9, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.338 Vali Acc: 0.913 Test Loss: 0.338 Test Acc: 0.913
Validation loss decreased (-0.891300 --> -0.913040).  Saving model ...
Epoch: 10 cost time: 14.088008642196655
Epoch: 10, Steps: 9 | Train Loss: 0.137 Vali Loss: 0.269 Vali Acc: 0.913 Test Loss: 0.269 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913041).  Saving model ...
Epoch: 11 cost time: 14.326538562774658
Epoch: 11, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.349 Vali Acc: 0.884 Test Loss: 0.349 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 13.974398612976074
Epoch: 12, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.410 Vali Acc: 0.855 Test Loss: 0.410 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 10.565362691879272
Epoch: 13, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.859 Vali Acc: 0.833 Test Loss: 0.859 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 12.397096633911133
Epoch: 14, Steps: 9 | Train Loss: 0.003 Vali Loss: 2.219 Vali Acc: 0.768 Test Loss: 2.219 Test Acc: 0.768
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 11.825268507003784
Epoch: 15, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.796 Vali Acc: 0.855 Test Loss: 0.796 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 11.032984733581543
Epoch: 16, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.489 Vali Acc: 0.870 Test Loss: 0.489 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 12.051303386688232
Epoch: 17, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.993 Vali Acc: 0.783 Test Loss: 0.993 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 13.88025426864624
Epoch: 18, Steps: 9 | Train Loss: 0.205 Vali Loss: 0.504 Vali Acc: 0.862 Test Loss: 0.504 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 13.710680961608887
Epoch: 19, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.789 Vali Acc: 0.826 Test Loss: 0.789 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 13.51577091217041
Epoch: 20, Steps: 9 | Train Loss: 0.017 Vali Loss: 1.076 Vali Acc: 0.790 Test Loss: 1.076 Test Acc: 0.790
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 37600132
model size : 145.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 6.531714677810669
Epoch: 1, Steps: 9 | Train Loss: 1.448 Vali Loss: 1.091 Vali Acc: 0.616 Test Loss: 1.091 Test Acc: 0.616
Validation loss decreased (inf --> -0.615931).  Saving model ...
Epoch: 2 cost time: 4.36519455909729
Epoch: 2, Steps: 9 | Train Loss: 0.946 Vali Loss: 0.651 Vali Acc: 0.761 Test Loss: 0.651 Test Acc: 0.761
Validation loss decreased (-0.615931 --> -0.760863).  Saving model ...
Epoch: 3 cost time: 5.98914909362793
Epoch: 3, Steps: 9 | Train Loss: 0.551 Vali Loss: 0.524 Vali Acc: 0.804 Test Loss: 0.524 Test Acc: 0.804
Validation loss decreased (-0.760863 --> -0.804343).  Saving model ...
Epoch: 4 cost time: 5.834136247634888
Epoch: 4, Steps: 9 | Train Loss: 0.305 Vali Loss: 0.308 Vali Acc: 0.899 Test Loss: 0.308 Test Acc: 0.899
Validation loss decreased (-0.804343 --> -0.898548).  Saving model ...
Epoch: 5 cost time: 5.274649143218994
Epoch: 5, Steps: 9 | Train Loss: 0.143 Vali Loss: 0.421 Vali Acc: 0.848 Test Loss: 0.421 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.690910339355469
Epoch: 6, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.361 Vali Acc: 0.891 Test Loss: 0.361 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.87173867225647
Epoch: 7, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.451 Vali Acc: 0.855 Test Loss: 0.451 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.261317253112793
Epoch: 8, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.493 Vali Acc: 0.877 Test Loss: 0.493 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.277130603790283
Epoch: 9, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.459 Vali Acc: 0.884 Test Loss: 0.459 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.780862808227539
Epoch: 10, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.478 Vali Acc: 0.884 Test Loss: 0.478 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 6.156104564666748
Epoch: 11, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.509 Vali Acc: 0.884 Test Loss: 0.509 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.947704076766968
Epoch: 12, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.609 Vali Acc: 0.877 Test Loss: 0.609 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.9522545337677
Epoch: 13, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.450 Vali Acc: 0.899 Test Loss: 0.450 Test Acc: 0.899
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 5.643503904342651
Epoch: 14, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.388 Vali Acc: 0.906 Test Loss: 0.388 Test Acc: 0.906
Validation loss decreased (-0.898548 --> -0.905793).  Saving model ...
Epoch: 15 cost time: 4.825631856918335
Epoch: 15, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.679 Vali Acc: 0.841 Test Loss: 0.679 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.757343053817749
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.943 Vali Acc: 0.833 Test Loss: 0.943 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.66421365737915
Epoch: 17, Steps: 9 | Train Loss: 0.083 Vali Loss: 2.211 Vali Acc: 0.746 Test Loss: 2.211 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.980698585510254
Epoch: 18, Steps: 9 | Train Loss: 0.095 Vali Loss: 0.500 Vali Acc: 0.870 Test Loss: 0.500 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 6.002002000808716
Epoch: 19, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.842 Vali Acc: 0.833 Test Loss: 0.842 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 5.872969627380371
Epoch: 20, Steps: 9 | Train Loss: 0.113 Vali Loss: 0.499 Vali Acc: 0.891 Test Loss: 0.499 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 5.608389616012573
Epoch: 21, Steps: 9 | Train Loss: 0.038 Vali Loss: 1.188 Vali Acc: 0.768 Test Loss: 1.188 Test Acc: 0.768
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 5.67730188369751
Epoch: 22, Steps: 9 | Train Loss: 0.191 Vali Loss: 0.620 Vali Acc: 0.848 Test Loss: 0.620 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 5.507088899612427
Epoch: 23, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.815 Vali Acc: 0.761 Test Loss: 0.815 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 5.535144090652466
Epoch: 24, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.885 Vali Acc: 0.819 Test Loss: 0.885 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 11121540
model size : 44.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 8.031328439712524
Epoch: 1, Steps: 9 | Train Loss: 1.380 Vali Loss: 1.193 Vali Acc: 0.471 Test Loss: 1.193 Test Acc: 0.471
Validation loss decreased (inf --> -0.471003).  Saving model ...
Epoch: 2 cost time: 5.238213777542114
Epoch: 2, Steps: 9 | Train Loss: 0.977 Vali Loss: 0.850 Vali Acc: 0.659 Test Loss: 0.850 Test Acc: 0.659
Validation loss decreased (-0.471003 --> -0.659412).  Saving model ...
Epoch: 3 cost time: 5.9069037437438965
Epoch: 3, Steps: 9 | Train Loss: 0.573 Vali Loss: 0.638 Vali Acc: 0.717 Test Loss: 0.638 Test Acc: 0.717
Validation loss decreased (-0.659412 --> -0.717385).  Saving model ...
Epoch: 4 cost time: 8.204328536987305
Epoch: 4, Steps: 9 | Train Loss: 0.301 Vali Loss: 0.619 Vali Acc: 0.761 Test Loss: 0.619 Test Acc: 0.761
Validation loss decreased (-0.717385 --> -0.760863).  Saving model ...
Epoch: 5 cost time: 7.925924777984619
Epoch: 5, Steps: 9 | Train Loss: 0.174 Vali Loss: 0.567 Vali Acc: 0.775 Test Loss: 0.567 Test Acc: 0.775
Validation loss decreased (-0.760863 --> -0.775357).  Saving model ...
Epoch: 6 cost time: 8.240018844604492
Epoch: 6, Steps: 9 | Train Loss: 0.111 Vali Loss: 0.664 Vali Acc: 0.797 Test Loss: 0.664 Test Acc: 0.797
Validation loss decreased (-0.775357 --> -0.797095).  Saving model ...
Epoch: 7 cost time: 7.969845771789551
Epoch: 7, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.717 Vali Acc: 0.739 Test Loss: 0.717 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.46623682975769
Epoch: 8, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.738 Vali Acc: 0.754 Test Loss: 0.738 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 8.579432725906372
Epoch: 9, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.791 Vali Acc: 0.790 Test Loss: 0.791 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 8.04163408279419
Epoch: 10, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.287 Vali Acc: 0.891 Test Loss: 0.287 Test Acc: 0.891
Validation loss decreased (-0.797095 --> -0.891301).  Saving model ...
Epoch: 11 cost time: 8.401190042495728
Epoch: 11, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.347 Vali Acc: 0.877 Test Loss: 0.347 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.627910137176514
Epoch: 12, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.376 Vali Acc: 0.906 Test Loss: 0.376 Test Acc: 0.906
Validation loss decreased (-0.891301 --> -0.905793).  Saving model ...
Epoch: 13 cost time: 7.678375959396362
Epoch: 13, Steps: 9 | Train Loss: 0.113 Vali Loss: 0.347 Vali Acc: 0.920 Test Loss: 0.347 Test Acc: 0.920
Validation loss decreased (-0.905793 --> -0.920286).  Saving model ...
Epoch: 14 cost time: 7.516834497451782
Epoch: 14, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.408 Vali Acc: 0.928 Test Loss: 0.408 Test Acc: 0.928
Validation loss decreased (-0.920286 --> -0.927532).  Saving model ...
Epoch: 15 cost time: 5.434057950973511
Epoch: 15, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.365 Vali Acc: 0.920 Test Loss: 0.365 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.61430287361145
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.370 Vali Acc: 0.906 Test Loss: 0.370 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.584762811660767
Epoch: 17, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.584 Vali Acc: 0.855 Test Loss: 0.584 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 8.476248264312744
Epoch: 18, Steps: 9 | Train Loss: 1.007 Vali Loss: 0.472 Vali Acc: 0.891 Test Loss: 0.472 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 8.470468997955322
Epoch: 19, Steps: 9 | Train Loss: 0.176 Vali Loss: 1.073 Vali Acc: 0.783 Test Loss: 1.073 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 8.365689754486084
Epoch: 20, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.749 Vali Acc: 0.797 Test Loss: 0.749 Test Acc: 0.797
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 8.213367700576782
Epoch: 21, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.635 Vali Acc: 0.703 Test Loss: 1.635 Test Acc: 0.703
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 8.108433961868286
Epoch: 22, Steps: 9 | Train Loss: 0.650 Vali Loss: 1.164 Vali Acc: 0.616 Test Loss: 1.164 Test Acc: 0.616
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 8.453882694244385
Epoch: 23, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.063 Vali Acc: 0.674 Test Loss: 1.063 Test Acc: 0.674
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 8.154167175292969
Epoch: 24, Steps: 9 | Train Loss: 0.603 Vali Loss: 1.131 Vali Acc: 0.681 Test Loss: 1.131 Test Acc: 0.681
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.927536231884058
model parameter : 37600132
model size : 145.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.271714448928833
Epoch: 1, Steps: 9 | Train Loss: 1.450 Vali Loss: 1.138 Vali Acc: 0.565 Test Loss: 1.138 Test Acc: 0.565
Validation loss decreased (inf --> -0.565206).  Saving model ...
Epoch: 2 cost time: 4.094747543334961
Epoch: 2, Steps: 9 | Train Loss: 0.993 Vali Loss: 0.868 Vali Acc: 0.630 Test Loss: 0.868 Test Acc: 0.630
Validation loss decreased (-0.565206 --> -0.630426).  Saving model ...
Epoch: 3 cost time: 4.468946218490601
Epoch: 3, Steps: 9 | Train Loss: 0.606 Vali Loss: 0.681 Vali Acc: 0.739 Test Loss: 0.681 Test Acc: 0.739
Validation loss decreased (-0.630426 --> -0.739124).  Saving model ...
Epoch: 4 cost time: 4.397683143615723
Epoch: 4, Steps: 9 | Train Loss: 0.314 Vali Loss: 0.437 Vali Acc: 0.855 Test Loss: 0.437 Test Acc: 0.855
Validation loss decreased (-0.739124 --> -0.855068).  Saving model ...
Epoch: 5 cost time: 4.055459022521973
Epoch: 5, Steps: 9 | Train Loss: 0.145 Vali Loss: 0.466 Vali Acc: 0.841 Test Loss: 0.466 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.597612619400024
Epoch: 6, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.445 Vali Acc: 0.848 Test Loss: 0.445 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.106673955917358
Epoch: 7, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.483 Vali Acc: 0.848 Test Loss: 0.483 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.2829909324646
Epoch: 8, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.621 Vali Acc: 0.812 Test Loss: 0.621 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.310507297515869
Epoch: 9, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.705 Vali Acc: 0.841 Test Loss: 0.705 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.64077615737915
Epoch: 10, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.513 Vali Acc: 0.862 Test Loss: 0.513 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862314).  Saving model ...
Epoch: 11 cost time: 3.9110445976257324
Epoch: 11, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.346 Vali Acc: 0.906 Test Loss: 0.346 Test Acc: 0.906
Validation loss decreased (-0.862314 --> -0.905794).  Saving model ...
Epoch: 12 cost time: 4.1306517124176025
Epoch: 12, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.560 Vali Acc: 0.841 Test Loss: 0.560 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.576987266540527
Epoch: 13, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.656 Vali Acc: 0.862 Test Loss: 0.656 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.186382532119751
Epoch: 14, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.655 Vali Acc: 0.870 Test Loss: 0.655 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.262204647064209
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.560 Vali Acc: 0.884 Test Loss: 0.560 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.251388311386108
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.545 Vali Acc: 0.877 Test Loss: 0.545 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.450382947921753
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.743 Vali Acc: 0.819 Test Loss: 1.743 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.0110557079315186
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.709 Vali Acc: 0.819 Test Loss: 1.709 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.491100072860718
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.650 Vali Acc: 0.797 Test Loss: 1.650 Test Acc: 0.797
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.3162453174591064
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.532 Vali Acc: 0.804 Test Loss: 1.532 Test Acc: 0.804
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.374466896057129
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.482 Vali Acc: 0.804 Test Loss: 1.482 Test Acc: 0.804
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 11121540
model size : 44.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 21.584428071975708
Epoch: 1, Steps: 9 | Train Loss: 1.369 Vali Loss: 1.136 Vali Acc: 0.551 Test Loss: 1.136 Test Acc: 0.551
Validation loss decreased (inf --> -0.550713).  Saving model ...
Epoch: 2 cost time: 14.749505281448364
Epoch: 2, Steps: 9 | Train Loss: 0.981 Vali Loss: 0.717 Vali Acc: 0.703 Test Loss: 0.717 Test Acc: 0.703
Validation loss decreased (-0.550713 --> -0.702891).  Saving model ...
Epoch: 3 cost time: 19.916171312332153
Epoch: 3, Steps: 9 | Train Loss: 0.538 Vali Loss: 0.458 Vali Acc: 0.812 Test Loss: 0.458 Test Acc: 0.812
Validation loss decreased (-0.702891 --> -0.811590).  Saving model ...
Epoch: 4 cost time: 20.18803071975708
Epoch: 4, Steps: 9 | Train Loss: 0.351 Vali Loss: 0.390 Vali Acc: 0.848 Test Loss: 0.390 Test Acc: 0.848
Validation loss decreased (-0.811590 --> -0.847822).  Saving model ...
Epoch: 5 cost time: 20.05783176422119
Epoch: 5, Steps: 9 | Train Loss: 0.207 Vali Loss: 0.383 Vali Acc: 0.862 Test Loss: 0.383 Test Acc: 0.862
Validation loss decreased (-0.847822 --> -0.862315).  Saving model ...
Epoch: 6 cost time: 19.94671940803528
Epoch: 6, Steps: 9 | Train Loss: 0.116 Vali Loss: 0.479 Vali Acc: 0.804 Test Loss: 0.479 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 18.06365180015564
Epoch: 7, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.547 Vali Acc: 0.848 Test Loss: 0.547 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 16.90157127380371
Epoch: 8, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.438 Vali Acc: 0.891 Test Loss: 0.438 Test Acc: 0.891
Validation loss decreased (-0.862315 --> -0.891300).  Saving model ...
Epoch: 9 cost time: 21.43852162361145
Epoch: 9, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.582 Vali Acc: 0.833 Test Loss: 0.582 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 18.217315435409546
Epoch: 10, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.382 Vali Acc: 0.884 Test Loss: 0.382 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 21.96945595741272
Epoch: 11, Steps: 9 | Train Loss: 0.096 Vali Loss: 0.587 Vali Acc: 0.848 Test Loss: 0.587 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 21.848797082901
Epoch: 12, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.499 Vali Acc: 0.870 Test Loss: 0.499 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 20.49739694595337
Epoch: 13, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.547 Vali Acc: 0.826 Test Loss: 0.547 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 22.00302290916443
Epoch: 14, Steps: 9 | Train Loss: 0.175 Vali Loss: 1.020 Vali Acc: 0.826 Test Loss: 1.020 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 21.59121584892273
Epoch: 15, Steps: 9 | Train Loss: 0.103 Vali Loss: 1.123 Vali Acc: 0.826 Test Loss: 1.123 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 18.115591287612915
Epoch: 16, Steps: 9 | Train Loss: 0.341 Vali Loss: 1.037 Vali Acc: 0.746 Test Loss: 1.037 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 18.001606225967407
Epoch: 17, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.858 Vali Acc: 0.826 Test Loss: 0.858 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 19.11844825744629
Epoch: 18, Steps: 9 | Train Loss: 0.089 Vali Loss: 0.445 Vali Acc: 0.884 Test Loss: 0.445 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 37547972
model size : 144.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 8.566731452941895
Epoch: 1, Steps: 9 | Train Loss: 1.406 Vali Loss: 1.170 Vali Acc: 0.587 Test Loss: 1.170 Test Acc: 0.587
Validation loss decreased (inf --> -0.586945).  Saving model ...
Epoch: 2 cost time: 7.870389461517334
Epoch: 2, Steps: 9 | Train Loss: 0.967 Vali Loss: 0.735 Vali Acc: 0.739 Test Loss: 0.735 Test Acc: 0.739
Validation loss decreased (-0.586945 --> -0.739123).  Saving model ...
Epoch: 3 cost time: 6.4516074657440186
Epoch: 3, Steps: 9 | Train Loss: 0.594 Vali Loss: 0.514 Vali Acc: 0.790 Test Loss: 0.514 Test Acc: 0.790
Validation loss decreased (-0.739123 --> -0.789850).  Saving model ...
Epoch: 4 cost time: 7.030986785888672
Epoch: 4, Steps: 9 | Train Loss: 0.352 Vali Loss: 0.416 Vali Acc: 0.862 Test Loss: 0.416 Test Acc: 0.862
Validation loss decreased (-0.789850 --> -0.862315).  Saving model ...
Epoch: 5 cost time: 8.008270502090454
Epoch: 5, Steps: 9 | Train Loss: 0.286 Vali Loss: 0.464 Vali Acc: 0.790 Test Loss: 0.464 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.897221565246582
Epoch: 6, Steps: 9 | Train Loss: 0.169 Vali Loss: 0.390 Vali Acc: 0.862 Test Loss: 0.390 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 7 cost time: 7.954403638839722
Epoch: 7, Steps: 9 | Train Loss: 0.080 Vali Loss: 0.366 Vali Acc: 0.862 Test Loss: 0.366 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 8 cost time: 7.784118890762329
Epoch: 8, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.425 Vali Acc: 0.848 Test Loss: 0.425 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.558687448501587
Epoch: 9, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.485 Vali Acc: 0.848 Test Loss: 0.485 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 7.2519636154174805
Epoch: 10, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.465 Vali Acc: 0.862 Test Loss: 0.465 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 7.120246887207031
Epoch: 11, Steps: 9 | Train Loss: 0.214 Vali Loss: 0.326 Vali Acc: 0.891 Test Loss: 0.326 Test Acc: 0.891
Validation loss decreased (-0.862315 --> -0.891301).  Saving model ...
Epoch: 12 cost time: 6.481830358505249
Epoch: 12, Steps: 9 | Train Loss: 0.162 Vali Loss: 0.524 Vali Acc: 0.833 Test Loss: 0.524 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.559507608413696
Epoch: 13, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.551 Vali Acc: 0.833 Test Loss: 0.551 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.43173885345459
Epoch: 14, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.303 Vali Acc: 0.899 Test Loss: 0.303 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898548).  Saving model ...
Epoch: 15 cost time: 5.473865270614624
Epoch: 15, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.468 Vali Acc: 0.891 Test Loss: 0.468 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 8.13656735420227
Epoch: 16, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.411 Vali Acc: 0.884 Test Loss: 0.411 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.746845960617065
Epoch: 17, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.334 Vali Acc: 0.870 Test Loss: 0.334 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.5268261432647705
Epoch: 18, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.320 Vali Acc: 0.899 Test Loss: 0.320 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 7.704594373703003
Epoch: 19, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.349 Vali Acc: 0.884 Test Loss: 0.349 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 8.368603944778442
Epoch: 20, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.339 Vali Acc: 0.899 Test Loss: 0.339 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 8.200542211532593
Epoch: 21, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.300 Vali Acc: 0.899 Test Loss: 0.300 Test Acc: 0.899
Validation loss decreased (-0.898548 --> -0.898548).  Saving model ...
Epoch: 22 cost time: 7.962290287017822
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.287 Vali Acc: 0.899 Test Loss: 0.287 Test Acc: 0.899
Validation loss decreased (-0.898548 --> -0.898548).  Saving model ...
Epoch: 23 cost time: 7.700575828552246
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.275 Vali Acc: 0.906 Test Loss: 0.275 Test Acc: 0.906
Validation loss decreased (-0.898548 --> -0.905794).  Saving model ...
Epoch: 24 cost time: 8.227829933166504
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.906 Test Loss: 0.274 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 25 cost time: 7.5082783699035645
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.906 Test Loss: 0.273 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 26 cost time: 8.606844902038574
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.276 Vali Acc: 0.906 Test Loss: 0.276 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 8.659416913986206
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.906 Test Loss: 0.280 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 8.34746766090393
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.283 Vali Acc: 0.906 Test Loss: 0.283 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 8.97304105758667
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.282 Vali Acc: 0.906 Test Loss: 0.282 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 9.601479291915894
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.282 Vali Acc: 0.906 Test Loss: 0.282 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 11068868
model size : 43.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 16.75321912765503
Epoch: 1, Steps: 9 | Train Loss: 1.372 Vali Loss: 1.181 Vali Acc: 0.486 Test Loss: 1.181 Test Acc: 0.486
Validation loss decreased (inf --> -0.485495).  Saving model ...
Epoch: 2 cost time: 15.06427812576294
Epoch: 2, Steps: 9 | Train Loss: 1.061 Vali Loss: 0.797 Vali Acc: 0.623 Test Loss: 0.797 Test Acc: 0.623
Validation loss decreased (-0.485495 --> -0.623180).  Saving model ...
Epoch: 3 cost time: 15.16652774810791
Epoch: 3, Steps: 9 | Train Loss: 0.624 Vali Loss: 0.491 Vali Acc: 0.797 Test Loss: 0.491 Test Acc: 0.797
Validation loss decreased (-0.623180 --> -0.797097).  Saving model ...
Epoch: 4 cost time: 16.1281795501709
Epoch: 4, Steps: 9 | Train Loss: 0.394 Vali Loss: 0.393 Vali Acc: 0.819 Test Loss: 0.393 Test Acc: 0.819
Validation loss decreased (-0.797097 --> -0.818837).  Saving model ...
Epoch: 5 cost time: 16.09202265739441
Epoch: 5, Steps: 9 | Train Loss: 0.210 Vali Loss: 0.342 Vali Acc: 0.870 Test Loss: 0.342 Test Acc: 0.870
Validation loss decreased (-0.818837 --> -0.869562).  Saving model ...
Epoch: 6 cost time: 16.19970178604126
Epoch: 6, Steps: 9 | Train Loss: 0.122 Vali Loss: 0.399 Vali Acc: 0.848 Test Loss: 0.399 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 12.524588346481323
Epoch: 7, Steps: 9 | Train Loss: 0.125 Vali Loss: 0.399 Vali Acc: 0.826 Test Loss: 0.399 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 14.320424556732178
Epoch: 8, Steps: 9 | Train Loss: 0.252 Vali Loss: 0.507 Vali Acc: 0.833 Test Loss: 0.507 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 14.211120367050171
Epoch: 9, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.583 Vali Acc: 0.797 Test Loss: 0.583 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 14.657864570617676
Epoch: 10, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.359 Vali Acc: 0.870 Test Loss: 0.359 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 14.789650917053223
Epoch: 11, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.335 Vali Acc: 0.913 Test Loss: 0.335 Test Acc: 0.913
Validation loss decreased (-0.869562 --> -0.913040).  Saving model ...
Epoch: 12 cost time: 10.98039722442627
Epoch: 12, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.364 Vali Acc: 0.877 Test Loss: 0.364 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 12.726218700408936
Epoch: 13, Steps: 9 | Train Loss: 0.142 Vali Loss: 0.354 Vali Acc: 0.891 Test Loss: 0.354 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 14.629549980163574
Epoch: 14, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.343 Vali Acc: 0.906 Test Loss: 0.343 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 15.830961465835571
Epoch: 15, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.349 Vali Acc: 0.906 Test Loss: 0.349 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 15.52962040901184
Epoch: 16, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.339 Vali Acc: 0.899 Test Loss: 0.339 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 15.783747434616089
Epoch: 17, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.804 Vali Acc: 0.826 Test Loss: 0.804 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 16.226582288742065
Epoch: 18, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.513 Vali Acc: 0.826 Test Loss: 0.513 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 15.148010492324829
Epoch: 19, Steps: 9 | Train Loss: 0.078 Vali Loss: 2.087 Vali Acc: 0.746 Test Loss: 2.087 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 14.21900200843811
Epoch: 20, Steps: 9 | Train Loss: 0.011 Vali Loss: 2.437 Vali Acc: 0.717 Test Loss: 2.437 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 14.393726587295532
Epoch: 21, Steps: 9 | Train Loss: 0.413 Vali Loss: 2.169 Vali Acc: 0.754 Test Loss: 2.169 Test Acc: 0.754
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 37547972
model size : 144.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 7.108039379119873
Epoch: 1, Steps: 9 | Train Loss: 1.409 Vali Loss: 1.211 Vali Acc: 0.543 Test Loss: 1.211 Test Acc: 0.543
Validation loss decreased (inf --> -0.543466).  Saving model ...
Epoch: 2 cost time: 5.298250913619995
Epoch: 2, Steps: 9 | Train Loss: 1.040 Vali Loss: 0.800 Vali Acc: 0.696 Test Loss: 0.800 Test Acc: 0.696
Validation loss decreased (-0.543466 --> -0.695644).  Saving model ...
Epoch: 3 cost time: 4.666811227798462
Epoch: 3, Steps: 9 | Train Loss: 0.666 Vali Loss: 0.550 Vali Acc: 0.812 Test Loss: 0.550 Test Acc: 0.812
Validation loss decreased (-0.695644 --> -0.811589).  Saving model ...
Epoch: 4 cost time: 4.215304374694824
Epoch: 4, Steps: 9 | Train Loss: 0.425 Vali Loss: 0.421 Vali Acc: 0.819 Test Loss: 0.421 Test Acc: 0.819
Validation loss decreased (-0.811589 --> -0.818836).  Saving model ...
Epoch: 5 cost time: 5.4189910888671875
Epoch: 5, Steps: 9 | Train Loss: 0.326 Vali Loss: 0.412 Vali Acc: 0.848 Test Loss: 0.412 Test Acc: 0.848
Validation loss decreased (-0.818836 --> -0.847822).  Saving model ...
Epoch: 6 cost time: 5.540797233581543
Epoch: 6, Steps: 9 | Train Loss: 0.168 Vali Loss: 0.402 Vali Acc: 0.833 Test Loss: 0.402 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.036679029464722
Epoch: 7, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.349 Vali Acc: 0.862 Test Loss: 0.349 Test Acc: 0.862
Validation loss decreased (-0.847822 --> -0.862315).  Saving model ...
Epoch: 8 cost time: 5.983965158462524
Epoch: 8, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.372 Vali Acc: 0.870 Test Loss: 0.372 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869561).  Saving model ...
Epoch: 9 cost time: 5.373968601226807
Epoch: 9, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.397 Vali Acc: 0.891 Test Loss: 0.397 Test Acc: 0.891
Validation loss decreased (-0.869561 --> -0.891300).  Saving model ...
Epoch: 10 cost time: 5.205558776855469
Epoch: 10, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.373 Vali Acc: 0.862 Test Loss: 0.373 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.739992618560791
Epoch: 11, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.335 Vali Acc: 0.870 Test Loss: 0.335 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.818347692489624
Epoch: 12, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.324 Vali Acc: 0.906 Test Loss: 0.324 Test Acc: 0.906
Validation loss decreased (-0.891300 --> -0.905794).  Saving model ...
Epoch: 13 cost time: 5.597975730895996
Epoch: 13, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.392 Vali Acc: 0.877 Test Loss: 0.392 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.82774019241333
Epoch: 14, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.490 Vali Acc: 0.855 Test Loss: 0.490 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.645854949951172
Epoch: 15, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.350 Vali Acc: 0.906 Test Loss: 0.350 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.7685792446136475
Epoch: 16, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.261 Vali Acc: 0.920 Test Loss: 0.261 Test Acc: 0.920
Validation loss decreased (-0.905794 --> -0.920287).  Saving model ...
Epoch: 17 cost time: 5.482492446899414
Epoch: 17, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.433 Vali Acc: 0.862 Test Loss: 0.433 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.6691672801971436
Epoch: 18, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.482 Vali Acc: 0.877 Test Loss: 0.482 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.639261960983276
Epoch: 19, Steps: 9 | Train Loss: 0.241 Vali Loss: 0.900 Vali Acc: 0.797 Test Loss: 0.900 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.513893365859985
Epoch: 20, Steps: 9 | Train Loss: 0.319 Vali Loss: 0.402 Vali Acc: 0.899 Test Loss: 0.402 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 5.680309295654297
Epoch: 21, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.614 Vali Acc: 0.841 Test Loss: 0.614 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 5.689274072647095
Epoch: 22, Steps: 9 | Train Loss: 0.080 Vali Loss: 0.697 Vali Acc: 0.790 Test Loss: 0.697 Test Acc: 0.790
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 5.262300968170166
Epoch: 23, Steps: 9 | Train Loss: 0.502 Vali Loss: 1.493 Vali Acc: 0.783 Test Loss: 1.493 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 4.271249532699585
Epoch: 24, Steps: 9 | Train Loss: 0.346 Vali Loss: 0.446 Vali Acc: 0.870 Test Loss: 0.446 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 4.340511083602905
Epoch: 25, Steps: 9 | Train Loss: 0.255 Vali Loss: 0.433 Vali Acc: 0.877 Test Loss: 0.433 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 4.486582517623901
Epoch: 26, Steps: 9 | Train Loss: 0.080 Vali Loss: 1.286 Vali Acc: 0.761 Test Loss: 1.286 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 11068868
model size : 43.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 10.413301467895508
Epoch: 1, Steps: 9 | Train Loss: 1.372 Vali Loss: 1.253 Vali Acc: 0.391 Test Loss: 1.253 Test Acc: 0.391
Validation loss decreased (inf --> -0.391292).  Saving model ...
Epoch: 2 cost time: 8.846092700958252
Epoch: 2, Steps: 9 | Train Loss: 1.106 Vali Loss: 0.986 Vali Acc: 0.507 Test Loss: 0.986 Test Acc: 0.507
Validation loss decreased (-0.391292 --> -0.507237).  Saving model ...
Epoch: 3 cost time: 9.248257160186768
Epoch: 3, Steps: 9 | Train Loss: 0.722 Vali Loss: 0.781 Vali Acc: 0.717 Test Loss: 0.781 Test Acc: 0.717
Validation loss decreased (-0.507237 --> -0.717383).  Saving model ...
Epoch: 4 cost time: 8.909457445144653
Epoch: 4, Steps: 9 | Train Loss: 0.453 Vali Loss: 0.606 Vali Acc: 0.739 Test Loss: 0.606 Test Acc: 0.739
Validation loss decreased (-0.717383 --> -0.739124).  Saving model ...
Epoch: 5 cost time: 7.809098958969116
Epoch: 5, Steps: 9 | Train Loss: 0.270 Vali Loss: 0.477 Vali Acc: 0.862 Test Loss: 0.477 Test Acc: 0.862
Validation loss decreased (-0.739124 --> -0.862314).  Saving model ...
Epoch: 6 cost time: 10.361742734909058
Epoch: 6, Steps: 9 | Train Loss: 0.145 Vali Loss: 0.476 Vali Acc: 0.812 Test Loss: 0.476 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.643245935440063
Epoch: 7, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.407 Vali Acc: 0.848 Test Loss: 0.407 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 10.460450172424316
Epoch: 8, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.423 Vali Acc: 0.862 Test Loss: 0.423 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862315).  Saving model ...
Epoch: 9 cost time: 10.201251983642578
Epoch: 9, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.475 Vali Acc: 0.826 Test Loss: 0.475 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 9.664660930633545
Epoch: 10, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.736 Vali Acc: 0.826 Test Loss: 0.736 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 10.134898900985718
Epoch: 11, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.358 Vali Acc: 0.891 Test Loss: 0.358 Test Acc: 0.891
Validation loss decreased (-0.862315 --> -0.891301).  Saving model ...
Epoch: 12 cost time: 10.371252536773682
Epoch: 12, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.430 Vali Acc: 0.884 Test Loss: 0.430 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 10.697052478790283
Epoch: 13, Steps: 9 | Train Loss: 0.128 Vali Loss: 0.421 Vali Acc: 0.862 Test Loss: 0.421 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 9.532607316970825
Epoch: 14, Steps: 9 | Train Loss: 0.058 Vali Loss: 1.316 Vali Acc: 0.652 Test Loss: 1.316 Test Acc: 0.652
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 9.329917907714844
Epoch: 15, Steps: 9 | Train Loss: 0.367 Vali Loss: 0.945 Vali Acc: 0.739 Test Loss: 0.945 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 8.945012331008911
Epoch: 16, Steps: 9 | Train Loss: 0.522 Vali Loss: 1.379 Vali Acc: 0.688 Test Loss: 1.379 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 8.812469244003296
Epoch: 17, Steps: 9 | Train Loss: 0.154 Vali Loss: 1.296 Vali Acc: 0.717 Test Loss: 1.296 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 7.7217841148376465
Epoch: 18, Steps: 9 | Train Loss: 0.297 Vali Loss: 1.014 Vali Acc: 0.761 Test Loss: 1.014 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 9.389994859695435
Epoch: 19, Steps: 9 | Train Loss: 0.285 Vali Loss: 1.758 Vali Acc: 0.717 Test Loss: 1.758 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 9.433911085128784
Epoch: 20, Steps: 9 | Train Loss: 0.227 Vali Loss: 2.236 Vali Acc: 0.616 Test Loss: 2.236 Test Acc: 0.616
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 8.317072629928589
Epoch: 21, Steps: 9 | Train Loss: 1.232 Vali Loss: 2.090 Vali Acc: 0.638 Test Loss: 2.090 Test Acc: 0.638
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 37547972
model size : 144.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.607040882110596
Epoch: 1, Steps: 9 | Train Loss: 1.414 Vali Loss: 1.265 Vali Acc: 0.449 Test Loss: 1.265 Test Acc: 0.449
Validation loss decreased (inf --> -0.449263).  Saving model ...
Epoch: 2 cost time: 4.063796043395996
Epoch: 2, Steps: 9 | Train Loss: 1.095 Vali Loss: 1.006 Vali Acc: 0.536 Test Loss: 1.006 Test Acc: 0.536
Validation loss decreased (-0.449263 --> -0.536222).  Saving model ...
Epoch: 3 cost time: 4.4326698780059814
Epoch: 3, Steps: 9 | Train Loss: 0.745 Vali Loss: 0.771 Vali Acc: 0.681 Test Loss: 0.771 Test Acc: 0.681
Validation loss decreased (-0.536222 --> -0.681152).  Saving model ...
Epoch: 4 cost time: 4.039510011672974
Epoch: 4, Steps: 9 | Train Loss: 0.496 Vali Loss: 0.579 Vali Acc: 0.754 Test Loss: 0.579 Test Acc: 0.754
Validation loss decreased (-0.681152 --> -0.753617).  Saving model ...
Epoch: 5 cost time: 3.6435625553131104
Epoch: 5, Steps: 9 | Train Loss: 0.291 Vali Loss: 0.590 Vali Acc: 0.732 Test Loss: 0.590 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.1028921604156494
Epoch: 6, Steps: 9 | Train Loss: 0.167 Vali Loss: 0.652 Vali Acc: 0.761 Test Loss: 0.652 Test Acc: 0.761
Validation loss decreased (-0.753617 --> -0.760863).  Saving model ...
Epoch: 7 cost time: 4.631802797317505
Epoch: 7, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.529 Vali Acc: 0.790 Test Loss: 0.529 Test Acc: 0.790
Validation loss decreased (-0.760863 --> -0.789850).  Saving model ...
Epoch: 8 cost time: 4.119170904159546
Epoch: 8, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.476 Vali Acc: 0.819 Test Loss: 0.476 Test Acc: 0.819
Validation loss decreased (-0.789850 --> -0.818836).  Saving model ...
Epoch: 9 cost time: 3.862454891204834
Epoch: 9, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.492 Vali Acc: 0.841 Test Loss: 0.492 Test Acc: 0.841
Validation loss decreased (-0.818836 --> -0.840575).  Saving model ...
Epoch: 10 cost time: 3.8127763271331787
Epoch: 10, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.424 Vali Acc: 0.877 Test Loss: 0.424 Test Acc: 0.877
Validation loss decreased (-0.840575 --> -0.876807).  Saving model ...
Epoch: 11 cost time: 4.221540927886963
Epoch: 11, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.858 Vali Acc: 0.797 Test Loss: 0.858 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.2396080493927
Epoch: 12, Steps: 9 | Train Loss: 0.260 Vali Loss: 0.429 Vali Acc: 0.891 Test Loss: 0.429 Test Acc: 0.891
Validation loss decreased (-0.876807 --> -0.891300).  Saving model ...
Epoch: 13 cost time: 4.263460159301758
Epoch: 13, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.384 Vali Acc: 0.710 Test Loss: 1.384 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.7970612049102783
Epoch: 14, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.665 Vali Acc: 0.732 Test Loss: 1.665 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.339453935623169
Epoch: 15, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.531 Vali Acc: 0.739 Test Loss: 1.531 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.007719039916992
Epoch: 16, Steps: 9 | Train Loss: 0.133 Vali Loss: 0.349 Vali Acc: 0.884 Test Loss: 0.349 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.8446645736694336
Epoch: 17, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.408 Vali Acc: 0.891 Test Loss: 0.408 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891300).  Saving model ...
Epoch: 18 cost time: 3.9986088275909424
Epoch: 18, Steps: 9 | Train Loss: 0.118 Vali Loss: 0.319 Vali Acc: 0.906 Test Loss: 0.319 Test Acc: 0.906
Validation loss decreased (-0.891300 --> -0.905794).  Saving model ...
Epoch: 19 cost time: 3.4501237869262695
Epoch: 19, Steps: 9 | Train Loss: 0.134 Vali Loss: 0.520 Vali Acc: 0.848 Test Loss: 0.520 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.991806745529175
Epoch: 20, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.369 Vali Acc: 0.906 Test Loss: 0.369 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.6400020122528076
Epoch: 21, Steps: 9 | Train Loss: 0.082 Vali Loss: 1.072 Vali Acc: 0.783 Test Loss: 1.072 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.6408162117004395
Epoch: 22, Steps: 9 | Train Loss: 0.192 Vali Loss: 0.871 Vali Acc: 0.848 Test Loss: 0.871 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.6757776737213135
Epoch: 23, Steps: 9 | Train Loss: 0.199 Vali Loss: 0.644 Vali Acc: 0.797 Test Loss: 0.644 Test Acc: 0.797
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.990823745727539
Epoch: 24, Steps: 9 | Train Loss: 0.278 Vali Loss: 0.719 Vali Acc: 0.775 Test Loss: 0.719 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.615496873855591
Epoch: 25, Steps: 9 | Train Loss: 0.325 Vali Loss: 0.600 Vali Acc: 0.826 Test Loss: 0.600 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.6937203407287598
Epoch: 26, Steps: 9 | Train Loss: 0.122 Vali Loss: 0.324 Vali Acc: 0.899 Test Loss: 0.324 Test Acc: 0.899
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.992964744567871
Epoch: 27, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.428 Vali Acc: 0.884 Test Loss: 0.428 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 3.994969129562378
Epoch: 28, Steps: 9 | Train Loss: 0.105 Vali Loss: 0.501 Vali Acc: 0.826 Test Loss: 0.501 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 11068868
model size : 43.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 12.84432864189148
Epoch: 1, Steps: 9 | Train Loss: 1.400 Vali Loss: 1.137 Vali Acc: 0.500 Test Loss: 1.137 Test Acc: 0.500
Validation loss decreased (inf --> -0.499989).  Saving model ...
Epoch: 2 cost time: 11.917633533477783
Epoch: 2, Steps: 9 | Train Loss: 0.978 Vali Loss: 0.731 Vali Acc: 0.732 Test Loss: 0.731 Test Acc: 0.732
Validation loss decreased (-0.499989 --> -0.731877).  Saving model ...
Epoch: 3 cost time: 11.97139835357666
Epoch: 3, Steps: 9 | Train Loss: 0.595 Vali Loss: 0.481 Vali Acc: 0.812 Test Loss: 0.481 Test Acc: 0.812
Validation loss decreased (-0.731877 --> -0.811589).  Saving model ...
Epoch: 4 cost time: 11.643407583236694
Epoch: 4, Steps: 9 | Train Loss: 0.385 Vali Loss: 0.389 Vali Acc: 0.841 Test Loss: 0.389 Test Acc: 0.841
Validation loss decreased (-0.811589 --> -0.840576).  Saving model ...
Epoch: 5 cost time: 11.499694108963013
Epoch: 5, Steps: 9 | Train Loss: 0.280 Vali Loss: 0.359 Vali Acc: 0.855 Test Loss: 0.359 Test Acc: 0.855
Validation loss decreased (-0.840576 --> -0.855069).  Saving model ...
Epoch: 6 cost time: 9.654421091079712
Epoch: 6, Steps: 9 | Train Loss: 0.160 Vali Loss: 0.426 Vali Acc: 0.812 Test Loss: 0.426 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.599204301834106
Epoch: 7, Steps: 9 | Train Loss: 0.165 Vali Loss: 0.423 Vali Acc: 0.826 Test Loss: 0.423 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 8.494108438491821
Epoch: 8, Steps: 9 | Train Loss: 0.131 Vali Loss: 0.430 Vali Acc: 0.870 Test Loss: 0.430 Test Acc: 0.870
Validation loss decreased (-0.855069 --> -0.869561).  Saving model ...
Epoch: 9 cost time: 10.348801136016846
Epoch: 9, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.495 Vali Acc: 0.833 Test Loss: 0.495 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 10.976614475250244
Epoch: 10, Steps: 9 | Train Loss: 0.206 Vali Loss: 0.604 Vali Acc: 0.833 Test Loss: 0.604 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 10.825164794921875
Epoch: 11, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.354 Vali Acc: 0.877 Test Loss: 0.354 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876808).  Saving model ...
Epoch: 12 cost time: 11.424930810928345
Epoch: 12, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.461 Vali Acc: 0.862 Test Loss: 0.461 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 10.787538051605225
Epoch: 13, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.393 Vali Acc: 0.877 Test Loss: 0.393 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 10.968281507492065
Epoch: 14, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.602 Vali Acc: 0.855 Test Loss: 0.602 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 11.111946821212769
Epoch: 15, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.554 Vali Acc: 0.841 Test Loss: 0.554 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 7.637409448623657
Epoch: 16, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.417 Vali Acc: 0.906 Test Loss: 0.417 Test Acc: 0.906
Validation loss decreased (-0.876808 --> -0.905793).  Saving model ...
Epoch: 17 cost time: 10.636439800262451
Epoch: 17, Steps: 9 | Train Loss: 0.051 Vali Loss: 1.548 Vali Acc: 0.790 Test Loss: 1.548 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 10.679717063903809
Epoch: 18, Steps: 9 | Train Loss: 0.099 Vali Loss: 0.630 Vali Acc: 0.812 Test Loss: 0.630 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 10.34929871559143
Epoch: 19, Steps: 9 | Train Loss: 0.032 Vali Loss: 1.412 Vali Acc: 0.761 Test Loss: 1.412 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 9.56385850906372
Epoch: 20, Steps: 9 | Train Loss: 0.234 Vali Loss: 0.411 Vali Acc: 0.848 Test Loss: 0.411 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 9.830663681030273
Epoch: 21, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.503 Vali Acc: 0.877 Test Loss: 0.503 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 9.712501049041748
Epoch: 22, Steps: 9 | Train Loss: 0.149 Vali Loss: 0.582 Vali Acc: 0.833 Test Loss: 0.582 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 8.928981065750122
Epoch: 23, Steps: 9 | Train Loss: 0.043 Vali Loss: 1.669 Vali Acc: 0.746 Test Loss: 1.669 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 12.18784475326538
Epoch: 24, Steps: 9 | Train Loss: 0.257 Vali Loss: 0.354 Vali Acc: 0.906 Test Loss: 0.354 Test Acc: 0.906
Validation loss decreased (-0.905793 --> -0.905794).  Saving model ...
Epoch: 25 cost time: 12.252931356430054
Epoch: 25, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.401 Vali Acc: 0.906 Test Loss: 0.401 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 10.541151762008667
Epoch: 26, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.438 Vali Acc: 0.877 Test Loss: 0.438 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 10.752124071121216
Epoch: 27, Steps: 9 | Train Loss: 0.089 Vali Loss: 0.402 Vali Acc: 0.899 Test Loss: 0.402 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 11.491236925125122
Epoch: 28, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.389 Vali Acc: 0.920 Test Loss: 0.389 Test Acc: 0.920
Validation loss decreased (-0.905794 --> -0.920286).  Saving model ...
Epoch: 29 cost time: 11.550634622573853
Epoch: 29, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.364 Vali Acc: 0.913 Test Loss: 0.364 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 9.848096370697021
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.355 Vali Acc: 0.906 Test Loss: 0.355 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 18801604
model size : 72.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 6.2972612380981445
Epoch: 1, Steps: 9 | Train Loss: 1.393 Vali Loss: 1.202 Vali Acc: 0.514 Test Loss: 1.202 Test Acc: 0.514
Validation loss decreased (inf --> -0.514481).  Saving model ...
Epoch: 2 cost time: 4.079142808914185
Epoch: 2, Steps: 9 | Train Loss: 1.048 Vali Loss: 0.793 Vali Acc: 0.754 Test Loss: 0.793 Test Acc: 0.754
Validation loss decreased (-0.514481 --> -0.753615).  Saving model ...
Epoch: 3 cost time: 4.434430837631226
Epoch: 3, Steps: 9 | Train Loss: 0.626 Vali Loss: 0.508 Vali Acc: 0.797 Test Loss: 0.508 Test Acc: 0.797
Validation loss decreased (-0.753615 --> -0.797096).  Saving model ...
Epoch: 4 cost time: 3.554366111755371
Epoch: 4, Steps: 9 | Train Loss: 0.405 Vali Loss: 0.406 Vali Acc: 0.819 Test Loss: 0.406 Test Acc: 0.819
Validation loss decreased (-0.797096 --> -0.818837).  Saving model ...
Epoch: 5 cost time: 3.275175094604492
Epoch: 5, Steps: 9 | Train Loss: 0.209 Vali Loss: 0.387 Vali Acc: 0.862 Test Loss: 0.387 Test Acc: 0.862
Validation loss decreased (-0.818837 --> -0.862315).  Saving model ...
Epoch: 6 cost time: 3.0878846645355225
Epoch: 6, Steps: 9 | Train Loss: 0.133 Vali Loss: 0.430 Vali Acc: 0.841 Test Loss: 0.430 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.713902711868286
Epoch: 7, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.526 Vali Acc: 0.819 Test Loss: 0.526 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.3580055236816406
Epoch: 8, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.511 Vali Acc: 0.841 Test Loss: 0.511 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.758117198944092
Epoch: 9, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.354 Vali Acc: 0.891 Test Loss: 0.354 Test Acc: 0.891
Validation loss decreased (-0.862315 --> -0.891301).  Saving model ...
Epoch: 10 cost time: 4.747966289520264
Epoch: 10, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.389 Vali Acc: 0.877 Test Loss: 0.389 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.884462118148804
Epoch: 11, Steps: 9 | Train Loss: 0.151 Vali Loss: 0.500 Vali Acc: 0.841 Test Loss: 0.500 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.122503042221069
Epoch: 12, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.336 Vali Acc: 0.906 Test Loss: 0.336 Test Acc: 0.906
Validation loss decreased (-0.891301 --> -0.905794).  Saving model ...
Epoch: 13 cost time: 4.694300889968872
Epoch: 13, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.344 Vali Acc: 0.906 Test Loss: 0.344 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.082003116607666
Epoch: 14, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.493 Vali Acc: 0.841 Test Loss: 0.493 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.88314151763916
Epoch: 15, Steps: 9 | Train Loss: 0.106 Vali Loss: 0.473 Vali Acc: 0.819 Test Loss: 0.473 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.800699949264526
Epoch: 16, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.338 Vali Acc: 0.899 Test Loss: 0.338 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.073349237442017
Epoch: 17, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.467 Vali Acc: 0.870 Test Loss: 0.467 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.539167881011963
Epoch: 18, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.491 Vali Acc: 0.862 Test Loss: 0.491 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.926294565200806
Epoch: 19, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.437 Vali Acc: 0.891 Test Loss: 0.437 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.825976371765137
Epoch: 20, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.495 Vali Acc: 0.870 Test Loss: 0.495 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.7751359939575195
Epoch: 21, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.464 Vali Acc: 0.862 Test Loss: 0.464 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.199052572250366
Epoch: 22, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.473 Vali Acc: 0.848 Test Loss: 0.473 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 5561796
model size : 22.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 9.795409202575684
Epoch: 1, Steps: 9 | Train Loss: 1.401 Vali Loss: 1.154 Vali Acc: 0.486 Test Loss: 1.154 Test Acc: 0.486
Validation loss decreased (inf --> -0.485496).  Saving model ...
Epoch: 2 cost time: 7.990984916687012
Epoch: 2, Steps: 9 | Train Loss: 1.045 Vali Loss: 0.808 Vali Acc: 0.667 Test Loss: 0.808 Test Acc: 0.667
Validation loss decreased (-0.485496 --> -0.666659).  Saving model ...
Epoch: 3 cost time: 8.220844268798828
Epoch: 3, Steps: 9 | Train Loss: 0.655 Vali Loss: 0.532 Vali Acc: 0.797 Test Loss: 0.532 Test Acc: 0.797
Validation loss decreased (-0.666659 --> -0.797096).  Saving model ...
Epoch: 4 cost time: 6.756481409072876
Epoch: 4, Steps: 9 | Train Loss: 0.460 Vali Loss: 0.407 Vali Acc: 0.833 Test Loss: 0.407 Test Acc: 0.833
Validation loss decreased (-0.797096 --> -0.833329).  Saving model ...
Epoch: 5 cost time: 6.0838072299957275
Epoch: 5, Steps: 9 | Train Loss: 0.311 Vali Loss: 0.326 Vali Acc: 0.862 Test Loss: 0.326 Test Acc: 0.862
Validation loss decreased (-0.833329 --> -0.862316).  Saving model ...
Epoch: 6 cost time: 5.838455438613892
Epoch: 6, Steps: 9 | Train Loss: 0.184 Vali Loss: 0.411 Vali Acc: 0.848 Test Loss: 0.411 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.733402729034424
Epoch: 7, Steps: 9 | Train Loss: 0.140 Vali Loss: 0.363 Vali Acc: 0.870 Test Loss: 0.363 Test Acc: 0.870
Validation loss decreased (-0.862316 --> -0.869562).  Saving model ...
Epoch: 8 cost time: 8.081978797912598
Epoch: 8, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.487 Vali Acc: 0.826 Test Loss: 0.487 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 8.310846328735352
Epoch: 9, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.406 Vali Acc: 0.855 Test Loss: 0.406 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 8.116633176803589
Epoch: 10, Steps: 9 | Train Loss: 0.152 Vali Loss: 0.323 Vali Acc: 0.899 Test Loss: 0.323 Test Acc: 0.899
Validation loss decreased (-0.869562 --> -0.898547).  Saving model ...
Epoch: 11 cost time: 7.8991851806640625
Epoch: 11, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.557 Vali Acc: 0.812 Test Loss: 0.557 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 8.312922954559326
Epoch: 12, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.478 Vali Acc: 0.877 Test Loss: 0.478 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 7.025171995162964
Epoch: 13, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.373 Vali Acc: 0.906 Test Loss: 0.373 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905793).  Saving model ...
Epoch: 14 cost time: 7.972475290298462
Epoch: 14, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.515 Vali Acc: 0.884 Test Loss: 0.515 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 7.371461868286133
Epoch: 15, Steps: 9 | Train Loss: 0.144 Vali Loss: 0.615 Vali Acc: 0.841 Test Loss: 0.615 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.4617578983306885
Epoch: 16, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.396 Vali Acc: 0.899 Test Loss: 0.396 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 7.864541530609131
Epoch: 17, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.235 Vali Acc: 0.913 Test Loss: 0.235 Test Acc: 0.913
Validation loss decreased (-0.905793 --> -0.913041).  Saving model ...
Epoch: 18 cost time: 7.861642837524414
Epoch: 18, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.579 Vali Acc: 0.891 Test Loss: 0.579 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 7.660311698913574
Epoch: 19, Steps: 9 | Train Loss: 0.232 Vali Loss: 0.364 Vali Acc: 0.920 Test Loss: 0.364 Test Acc: 0.920
Validation loss decreased (-0.913041 --> -0.920286).  Saving model ...
Epoch: 20 cost time: 7.705749988555908
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.932 Vali Acc: 0.826 Test Loss: 0.932 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 7.0695960521698
Epoch: 21, Steps: 9 | Train Loss: 0.218 Vali Loss: 0.670 Vali Acc: 0.812 Test Loss: 0.670 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 6.595036268234253
Epoch: 22, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.399 Vali Acc: 0.906 Test Loss: 0.399 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 6.21648645401001
Epoch: 23, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.454 Vali Acc: 0.848 Test Loss: 0.454 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 5.980780363082886
Epoch: 24, Steps: 9 | Train Loss: 0.171 Vali Loss: 0.655 Vali Acc: 0.855 Test Loss: 0.655 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 6.84516167640686
Epoch: 25, Steps: 9 | Train Loss: 0.122 Vali Loss: 0.228 Vali Acc: 0.920 Test Loss: 0.228 Test Acc: 0.920
Validation loss decreased (-0.920286 --> -0.920288).  Saving model ...
Epoch: 26 cost time: 7.0262227058410645
Epoch: 26, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.408 Vali Acc: 0.899 Test Loss: 0.408 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 6.6980462074279785
Epoch: 27, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.751 Vali Acc: 0.870 Test Loss: 0.751 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 6.641279220581055
Epoch: 28, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.795 Vali Acc: 0.884 Test Loss: 0.795 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 5.798016548156738
Epoch: 29, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.846 Vali Acc: 0.877 Test Loss: 0.846 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 5.646641492843628
Epoch: 30, Steps: 9 | Train Loss: 0.626 Vali Loss: 0.709 Vali Acc: 0.877 Test Loss: 0.709 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 18801604
model size : 72.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.2403552532196045
Epoch: 1, Steps: 9 | Train Loss: 1.398 Vali Loss: 1.215 Vali Acc: 0.486 Test Loss: 1.215 Test Acc: 0.486
Validation loss decreased (inf --> -0.485495).  Saving model ...
Epoch: 2 cost time: 2.9122049808502197
Epoch: 2, Steps: 9 | Train Loss: 1.060 Vali Loss: 0.834 Vali Acc: 0.717 Test Loss: 0.834 Test Acc: 0.717
Validation loss decreased (-0.485495 --> -0.717383).  Saving model ...
Epoch: 3 cost time: 2.997202157974243
Epoch: 3, Steps: 9 | Train Loss: 0.672 Vali Loss: 0.555 Vali Acc: 0.804 Test Loss: 0.555 Test Acc: 0.804
Validation loss decreased (-0.717383 --> -0.804342).  Saving model ...
Epoch: 4 cost time: 3.088361978530884
Epoch: 4, Steps: 9 | Train Loss: 0.457 Vali Loss: 0.432 Vali Acc: 0.826 Test Loss: 0.432 Test Acc: 0.826
Validation loss decreased (-0.804342 --> -0.826083).  Saving model ...
Epoch: 5 cost time: 3.050724744796753
Epoch: 5, Steps: 9 | Train Loss: 0.283 Vali Loss: 0.385 Vali Acc: 0.819 Test Loss: 0.385 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.0564072132110596
Epoch: 6, Steps: 9 | Train Loss: 0.161 Vali Loss: 0.398 Vali Acc: 0.819 Test Loss: 0.398 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.0028953552246094
Epoch: 7, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.428 Vali Acc: 0.833 Test Loss: 0.428 Test Acc: 0.833
Validation loss decreased (-0.826083 --> -0.833329).  Saving model ...
Epoch: 8 cost time: 2.562286138534546
Epoch: 8, Steps: 9 | Train Loss: 0.096 Vali Loss: 0.374 Vali Acc: 0.848 Test Loss: 0.374 Test Acc: 0.848
Validation loss decreased (-0.833329 --> -0.847822).  Saving model ...
Epoch: 9 cost time: 2.850238800048828
Epoch: 9, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.369 Vali Acc: 0.862 Test Loss: 0.369 Test Acc: 0.862
Validation loss decreased (-0.847822 --> -0.862315).  Saving model ...
Epoch: 10 cost time: 2.852957248687744
Epoch: 10, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.388 Vali Acc: 0.862 Test Loss: 0.388 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.5343680381774902
Epoch: 11, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.422 Vali Acc: 0.862 Test Loss: 0.422 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.7925479412078857
Epoch: 12, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.387 Vali Acc: 0.899 Test Loss: 0.387 Test Acc: 0.899
Validation loss decreased (-0.862315 --> -0.898547).  Saving model ...
Epoch: 13 cost time: 2.4391720294952393
Epoch: 13, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.457 Vali Acc: 0.877 Test Loss: 0.457 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.4919564723968506
Epoch: 14, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.440 Vali Acc: 0.870 Test Loss: 0.440 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.7572431564331055
Epoch: 15, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.350 Vali Acc: 0.884 Test Loss: 0.350 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.9990007877349854
Epoch: 16, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.335 Vali Acc: 0.906 Test Loss: 0.335 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905794).  Saving model ...
Epoch: 17 cost time: 3.246786594390869
Epoch: 17, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.452 Vali Acc: 0.884 Test Loss: 0.452 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.0800602436065674
Epoch: 18, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.470 Vali Acc: 0.884 Test Loss: 0.470 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.0607073307037354
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.444 Vali Acc: 0.891 Test Loss: 0.444 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.9872334003448486
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.410 Vali Acc: 0.899 Test Loss: 0.410 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.0827770233154297
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.404 Vali Acc: 0.899 Test Loss: 0.404 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.1296186447143555
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.408 Vali Acc: 0.899 Test Loss: 0.408 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.0814642906188965
Epoch: 23, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.408 Vali Acc: 0.891 Test Loss: 0.408 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.994215726852417
Epoch: 24, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.451 Vali Acc: 0.884 Test Loss: 0.451 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.1743431091308594
Epoch: 25, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.460 Vali Acc: 0.906 Test Loss: 0.460 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.10229754447937
Epoch: 26, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.444 Vali Acc: 0.913 Test Loss: 0.444 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913039).  Saving model ...
Epoch: 27 cost time: 3.0004451274871826
Epoch: 27, Steps: 9 | Train Loss: 0.115 Vali Loss: 0.377 Vali Acc: 0.906 Test Loss: 0.377 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.8900294303894043
Epoch: 28, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.428 Vali Acc: 0.855 Test Loss: 0.428 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.046722650527954
Epoch: 29, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.480 Vali Acc: 0.862 Test Loss: 0.480 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.023922920227051
Epoch: 30, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.439 Vali Acc: 0.877 Test Loss: 0.439 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 5561796
model size : 22.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.098758935928345
Epoch: 1, Steps: 9 | Train Loss: 1.411 Vali Loss: 1.210 Vali Acc: 0.420 Test Loss: 1.210 Test Acc: 0.420
Validation loss decreased (inf --> -0.420278).  Saving model ...
Epoch: 2 cost time: 3.703761577606201
Epoch: 2, Steps: 9 | Train Loss: 1.077 Vali Loss: 0.964 Vali Acc: 0.594 Test Loss: 0.964 Test Acc: 0.594
Validation loss decreased (-0.420278 --> -0.594193).  Saving model ...
Epoch: 3 cost time: 3.5282516479492188
Epoch: 3, Steps: 9 | Train Loss: 0.749 Vali Loss: 0.765 Vali Acc: 0.659 Test Loss: 0.765 Test Acc: 0.659
Validation loss decreased (-0.594193 --> -0.659413).  Saving model ...
Epoch: 4 cost time: 3.5277223587036133
Epoch: 4, Steps: 9 | Train Loss: 0.553 Vali Loss: 0.765 Vali Acc: 0.667 Test Loss: 0.765 Test Acc: 0.667
Validation loss decreased (-0.659413 --> -0.666659).  Saving model ...
Epoch: 5 cost time: 3.646406650543213
Epoch: 5, Steps: 9 | Train Loss: 0.351 Vali Loss: 0.700 Vali Acc: 0.681 Test Loss: 0.700 Test Acc: 0.681
Validation loss decreased (-0.666659 --> -0.681152).  Saving model ...
Epoch: 6 cost time: 3.6829419136047363
Epoch: 6, Steps: 9 | Train Loss: 0.198 Vali Loss: 0.771 Vali Acc: 0.688 Test Loss: 0.771 Test Acc: 0.688
Validation loss decreased (-0.681152 --> -0.688398).  Saving model ...
Epoch: 7 cost time: 3.21911883354187
Epoch: 7, Steps: 9 | Train Loss: 0.115 Vali Loss: 0.791 Vali Acc: 0.659 Test Loss: 0.791 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.024116516113281
Epoch: 8, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.479 Vali Acc: 0.841 Test Loss: 0.479 Test Acc: 0.841
Validation loss decreased (-0.688398 --> -0.840575).  Saving model ...
Epoch: 9 cost time: 3.9321036338806152
Epoch: 9, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.380 Vali Acc: 0.877 Test Loss: 0.380 Test Acc: 0.877
Validation loss decreased (-0.840575 --> -0.876808).  Saving model ...
Epoch: 10 cost time: 3.882216691970825
Epoch: 10, Steps: 9 | Train Loss: 0.056 Vali Loss: 1.324 Vali Acc: 0.732 Test Loss: 1.324 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.001469373703003
Epoch: 11, Steps: 9 | Train Loss: 0.014 Vali Loss: 2.090 Vali Acc: 0.638 Test Loss: 2.090 Test Acc: 0.638
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.9326889514923096
Epoch: 12, Steps: 9 | Train Loss: 0.349 Vali Loss: 1.063 Vali Acc: 0.739 Test Loss: 1.063 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.027902841567993
Epoch: 13, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.909 Vali Acc: 0.804 Test Loss: 0.909 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.9401233196258545
Epoch: 14, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.927 Vali Acc: 0.841 Test Loss: 0.927 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.6817574501037598
Epoch: 15, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.008 Vali Acc: 0.841 Test Loss: 1.008 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.7366931438446045
Epoch: 16, Steps: 9 | Train Loss: 0.104 Vali Loss: 0.891 Vali Acc: 0.833 Test Loss: 0.891 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.457156181335449
Epoch: 17, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.969 Vali Acc: 0.717 Test Loss: 0.969 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.421887397766113
Epoch: 18, Steps: 9 | Train Loss: 0.025 Vali Loss: 1.037 Vali Acc: 0.732 Test Loss: 1.037 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.534878730773926
Epoch: 19, Steps: 9 | Train Loss: 0.007 Vali Loss: 1.117 Vali Acc: 0.688 Test Loss: 1.117 Test Acc: 0.688
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 18801604
model size : 72.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.746486186981201
Epoch: 1, Steps: 9 | Train Loss: 1.396 Vali Loss: 1.249 Vali Acc: 0.442 Test Loss: 1.249 Test Acc: 0.442
Validation loss decreased (inf --> -0.442016).  Saving model ...
Epoch: 2 cost time: 2.179509401321411
Epoch: 2, Steps: 9 | Train Loss: 1.086 Vali Loss: 0.964 Vali Acc: 0.630 Test Loss: 0.964 Test Acc: 0.630
Validation loss decreased (-0.442016 --> -0.630425).  Saving model ...
Epoch: 3 cost time: 2.3570544719696045
Epoch: 3, Steps: 9 | Train Loss: 0.738 Vali Loss: 0.740 Vali Acc: 0.739 Test Loss: 0.740 Test Acc: 0.739
Validation loss decreased (-0.630425 --> -0.739123).  Saving model ...
Epoch: 4 cost time: 2.3588593006134033
Epoch: 4, Steps: 9 | Train Loss: 0.504 Vali Loss: 0.590 Vali Acc: 0.790 Test Loss: 0.590 Test Acc: 0.790
Validation loss decreased (-0.739123 --> -0.789849).  Saving model ...
Epoch: 5 cost time: 2.306082248687744
Epoch: 5, Steps: 9 | Train Loss: 0.303 Vali Loss: 0.542 Vali Acc: 0.790 Test Loss: 0.542 Test Acc: 0.790
Validation loss decreased (-0.789849 --> -0.789850).  Saving model ...
Epoch: 6 cost time: 2.343146324157715
Epoch: 6, Steps: 9 | Train Loss: 0.185 Vali Loss: 0.460 Vali Acc: 0.819 Test Loss: 0.460 Test Acc: 0.819
Validation loss decreased (-0.789850 --> -0.818836).  Saving model ...
Epoch: 7 cost time: 2.156464099884033
Epoch: 7, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.479 Vali Acc: 0.833 Test Loss: 0.479 Test Acc: 0.833
Validation loss decreased (-0.818836 --> -0.833329).  Saving model ...
Epoch: 8 cost time: 2.2068591117858887
Epoch: 8, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.358 Vali Acc: 0.877 Test Loss: 0.358 Test Acc: 0.877
Validation loss decreased (-0.833329 --> -0.876808).  Saving model ...
Epoch: 9 cost time: 2.0392167568206787
Epoch: 9, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.394 Vali Acc: 0.855 Test Loss: 0.394 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1641833782196045
Epoch: 10, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.510 Vali Acc: 0.819 Test Loss: 0.510 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.252434492111206
Epoch: 11, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.630 Vali Acc: 0.797 Test Loss: 0.630 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.2598676681518555
Epoch: 12, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.802 Vali Acc: 0.768 Test Loss: 0.802 Test Acc: 0.768
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.3540892601013184
Epoch: 13, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.456 Vali Acc: 0.862 Test Loss: 0.456 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.416416645050049
Epoch: 14, Steps: 9 | Train Loss: 0.130 Vali Loss: 0.712 Vali Acc: 0.797 Test Loss: 0.712 Test Acc: 0.797
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.4433608055114746
Epoch: 15, Steps: 9 | Train Loss: 0.126 Vali Loss: 0.639 Vali Acc: 0.804 Test Loss: 0.639 Test Acc: 0.804
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.5176281929016113
Epoch: 16, Steps: 9 | Train Loss: 0.015 Vali Loss: 1.054 Vali Acc: 0.710 Test Loss: 1.054 Test Acc: 0.710
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.3946783542633057
Epoch: 17, Steps: 9 | Train Loss: 0.294 Vali Loss: 0.275 Vali Acc: 0.913 Test Loss: 0.275 Test Acc: 0.913
Validation loss decreased (-0.876808 --> -0.913041).  Saving model ...
Epoch: 18 cost time: 2.390993356704712
Epoch: 18, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.381 Vali Acc: 0.884 Test Loss: 0.381 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.377537965774536
Epoch: 19, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.386 Vali Acc: 0.906 Test Loss: 0.386 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.3199658393859863
Epoch: 20, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.344 Vali Acc: 0.913 Test Loss: 0.344 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.1305091381073
Epoch: 21, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.420 Vali Acc: 0.899 Test Loss: 0.420 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.9251255989074707
Epoch: 22, Steps: 9 | Train Loss: 0.219 Vali Loss: 0.441 Vali Acc: 0.877 Test Loss: 0.441 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.9307949542999268
Epoch: 23, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.450 Vali Acc: 0.884 Test Loss: 0.450 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.9599318504333496
Epoch: 24, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.469 Vali Acc: 0.848 Test Loss: 0.469 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.1038012504577637
Epoch: 25, Steps: 9 | Train Loss: 0.020 Vali Loss: 1.437 Vali Acc: 0.804 Test Loss: 1.437 Test Acc: 0.804
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.250056743621826
Epoch: 26, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.662 Vali Acc: 0.783 Test Loss: 1.662 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.0753889083862305
Epoch: 27, Steps: 9 | Train Loss: 0.041 Vali Loss: 1.246 Vali Acc: 0.804 Test Loss: 1.246 Test Acc: 0.804
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 5561796
model size : 22.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 7.148818731307983
Epoch: 1, Steps: 9 | Train Loss: 1.369 Vali Loss: 1.237 Vali Acc: 0.478 Test Loss: 1.237 Test Acc: 0.478
Validation loss decreased (inf --> -0.478249).  Saving model ...
Epoch: 2 cost time: 5.737321376800537
Epoch: 2, Steps: 9 | Train Loss: 1.044 Vali Loss: 0.819 Vali Acc: 0.732 Test Loss: 0.819 Test Acc: 0.732
Validation loss decreased (-0.478249 --> -0.731876).  Saving model ...
Epoch: 3 cost time: 5.677628993988037
Epoch: 3, Steps: 9 | Train Loss: 0.699 Vali Loss: 0.558 Vali Acc: 0.775 Test Loss: 0.558 Test Acc: 0.775
Validation loss decreased (-0.731876 --> -0.775357).  Saving model ...
Epoch: 4 cost time: 5.898784875869751
Epoch: 4, Steps: 9 | Train Loss: 0.391 Vali Loss: 0.420 Vali Acc: 0.819 Test Loss: 0.420 Test Acc: 0.819
Validation loss decreased (-0.775357 --> -0.818836).  Saving model ...
Epoch: 5 cost time: 5.196422100067139
Epoch: 5, Steps: 9 | Train Loss: 0.263 Vali Loss: 0.505 Vali Acc: 0.826 Test Loss: 0.505 Test Acc: 0.826
Validation loss decreased (-0.818836 --> -0.826082).  Saving model ...
Epoch: 6 cost time: 5.0407490730285645
Epoch: 6, Steps: 9 | Train Loss: 0.142 Vali Loss: 0.431 Vali Acc: 0.870 Test Loss: 0.431 Test Acc: 0.870
Validation loss decreased (-0.826082 --> -0.869561).  Saving model ...
Epoch: 7 cost time: 4.744609355926514
Epoch: 7, Steps: 9 | Train Loss: 0.106 Vali Loss: 0.469 Vali Acc: 0.826 Test Loss: 0.469 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.5197436809539795
Epoch: 8, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.530 Vali Acc: 0.833 Test Loss: 0.530 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.7253851890563965
Epoch: 9, Steps: 9 | Train Loss: 0.183 Vali Loss: 0.480 Vali Acc: 0.848 Test Loss: 0.480 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.202518701553345
Epoch: 10, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.411 Vali Acc: 0.877 Test Loss: 0.411 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876807).  Saving model ...
Epoch: 11 cost time: 6.095189332962036
Epoch: 11, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.448 Vali Acc: 0.891 Test Loss: 0.448 Test Acc: 0.891
Validation loss decreased (-0.876807 --> -0.891300).  Saving model ...
Epoch: 12 cost time: 6.259569883346558
Epoch: 12, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.543 Vali Acc: 0.841 Test Loss: 0.543 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.263571739196777
Epoch: 13, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.619 Vali Acc: 0.819 Test Loss: 0.619 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.2633421421051025
Epoch: 14, Steps: 9 | Train Loss: 0.529 Vali Loss: 0.675 Vali Acc: 0.812 Test Loss: 0.675 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.12104868888855
Epoch: 15, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.319 Vali Acc: 0.884 Test Loss: 0.319 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 6.147002935409546
Epoch: 16, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.391 Vali Acc: 0.862 Test Loss: 0.391 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 6.109598159790039
Epoch: 17, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.400 Vali Acc: 0.877 Test Loss: 0.400 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 6.315719842910767
Epoch: 18, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.440 Vali Acc: 0.862 Test Loss: 0.440 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 6.234171152114868
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.415 Vali Acc: 0.891 Test Loss: 0.415 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891300).  Saving model ...
Epoch: 20 cost time: 5.345191478729248
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.389 Vali Acc: 0.899 Test Loss: 0.389 Test Acc: 0.899
Validation loss decreased (-0.891300 --> -0.898547).  Saving model ...
Epoch: 21 cost time: 5.719266653060913
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.409 Vali Acc: 0.899 Test Loss: 0.409 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.1376953125
Epoch: 22, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.405 Vali Acc: 0.891 Test Loss: 0.405 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.4210569858551025
Epoch: 23, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.439 Vali Acc: 0.891 Test Loss: 0.439 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 5.313849687576294
Epoch: 24, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.417 Vali Acc: 0.884 Test Loss: 0.417 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 5.361676931381226
Epoch: 25, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.390 Vali Acc: 0.877 Test Loss: 0.390 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 5.489926099777222
Epoch: 26, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.431 Vali Acc: 0.913 Test Loss: 0.431 Test Acc: 0.913
Validation loss decreased (-0.898547 --> -0.913039).  Saving model ...
Epoch: 27 cost time: 5.9312498569488525
Epoch: 27, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.467 Vali Acc: 0.913 Test Loss: 0.467 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 5.954244136810303
Epoch: 28, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.400 Vali Acc: 0.906 Test Loss: 0.400 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 5.913807392120361
Epoch: 29, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.367 Vali Acc: 0.884 Test Loss: 0.367 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 5.466369152069092
Epoch: 30, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.354 Vali Acc: 0.899 Test Loss: 0.354 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 9428420
model size : 37.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.195819616317749
Epoch: 1, Steps: 9 | Train Loss: 1.271 Vali Loss: 1.146 Vali Acc: 0.529 Test Loss: 1.146 Test Acc: 0.529
Validation loss decreased (inf --> -0.528974).  Saving model ...
Epoch: 2 cost time: 2.5771358013153076
Epoch: 2, Steps: 9 | Train Loss: 0.980 Vali Loss: 0.841 Vali Acc: 0.710 Test Loss: 0.841 Test Acc: 0.710
Validation loss decreased (-0.528974 --> -0.710137).  Saving model ...
Epoch: 3 cost time: 2.726921796798706
Epoch: 3, Steps: 9 | Train Loss: 0.660 Vali Loss: 0.570 Vali Acc: 0.804 Test Loss: 0.570 Test Acc: 0.804
Validation loss decreased (-0.710137 --> -0.804342).  Saving model ...
Epoch: 4 cost time: 2.7071077823638916
Epoch: 4, Steps: 9 | Train Loss: 0.415 Vali Loss: 0.441 Vali Acc: 0.826 Test Loss: 0.441 Test Acc: 0.826
Validation loss decreased (-0.804342 --> -0.826083).  Saving model ...
Epoch: 5 cost time: 2.6766014099121094
Epoch: 5, Steps: 9 | Train Loss: 0.260 Vali Loss: 0.460 Vali Acc: 0.870 Test Loss: 0.460 Test Acc: 0.870
Validation loss decreased (-0.826083 --> -0.869561).  Saving model ...
Epoch: 6 cost time: 2.761460781097412
Epoch: 6, Steps: 9 | Train Loss: 0.329 Vali Loss: 0.397 Vali Acc: 0.870 Test Loss: 0.397 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 7 cost time: 2.7961177825927734
Epoch: 7, Steps: 9 | Train Loss: 0.131 Vali Loss: 0.328 Vali Acc: 0.870 Test Loss: 0.328 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869562).  Saving model ...
Epoch: 8 cost time: 2.817032814025879
Epoch: 8, Steps: 9 | Train Loss: 0.098 Vali Loss: 0.338 Vali Acc: 0.884 Test Loss: 0.338 Test Acc: 0.884
Validation loss decreased (-0.869562 --> -0.884055).  Saving model ...
Epoch: 9 cost time: 2.6552531719207764
Epoch: 9, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.317 Vali Acc: 0.855 Test Loss: 0.317 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.8229241371154785
Epoch: 10, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.375 Vali Acc: 0.862 Test Loss: 0.375 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.7848854064941406
Epoch: 11, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.279 Vali Acc: 0.920 Test Loss: 0.279 Test Acc: 0.920
Validation loss decreased (-0.884055 --> -0.920287).  Saving model ...
Epoch: 12 cost time: 2.3679537773132324
Epoch: 12, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.407 Vali Acc: 0.899 Test Loss: 0.407 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.5635926723480225
Epoch: 13, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.445 Vali Acc: 0.891 Test Loss: 0.445 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.4974801540374756
Epoch: 14, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.383 Vali Acc: 0.891 Test Loss: 0.383 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.0665605068206787
Epoch: 15, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.397 Vali Acc: 0.877 Test Loss: 0.397 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.470287561416626
Epoch: 16, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.407 Vali Acc: 0.913 Test Loss: 0.407 Test Acc: 0.913
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.3216395378112793
Epoch: 17, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.402 Vali Acc: 0.920 Test Loss: 0.402 Test Acc: 0.920
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.183645725250244
Epoch: 18, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.364 Vali Acc: 0.913 Test Loss: 0.364 Test Acc: 0.913
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.297203540802002
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.362 Vali Acc: 0.899 Test Loss: 0.362 Test Acc: 0.899
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.2387847900390625
Epoch: 20, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.358 Vali Acc: 0.920 Test Loss: 0.358 Test Acc: 0.920
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.2488656044006348
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.375 Vali Acc: 0.928 Test Loss: 0.375 Test Acc: 0.928
Validation loss decreased (-0.920287 --> -0.927532).  Saving model ...
Epoch: 22 cost time: 1.515838384628296
Epoch: 22, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.374 Vali Acc: 0.928 Test Loss: 0.374 Test Acc: 0.928
Validation loss decreased (-0.927532 --> -0.927532).  Saving model ...
Epoch: 23 cost time: 1.4998779296875
Epoch: 23, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.378 Vali Acc: 0.906 Test Loss: 0.378 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.434002161026001
Epoch: 24, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.372 Vali Acc: 0.899 Test Loss: 0.372 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.438645601272583
Epoch: 25, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.358 Vali Acc: 0.899 Test Loss: 0.358 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.3129026889801025
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.346 Vali Acc: 0.913 Test Loss: 0.346 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.351463556289673
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.345 Vali Acc: 0.913 Test Loss: 0.345 Test Acc: 0.913
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.373347043991089
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.354 Vali Acc: 0.928 Test Loss: 0.354 Test Acc: 0.928
Validation loss decreased (-0.927532 --> -0.927533).  Saving model ...
Epoch: 29 cost time: 2.3392012119293213
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.366 Vali Acc: 0.920 Test Loss: 0.366 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.3469226360321045
Epoch: 30, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.408 Vali Acc: 0.906 Test Loss: 0.408 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.927536231884058
model parameter : 2808260
model size : 11.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.280531883239746
Epoch: 1, Steps: 9 | Train Loss: 1.372 Vali Loss: 1.248 Vali Acc: 0.478 Test Loss: 1.248 Test Acc: 0.478
Validation loss decreased (inf --> -0.478248).  Saving model ...
Epoch: 2 cost time: 3.2064576148986816
Epoch: 2, Steps: 9 | Train Loss: 1.080 Vali Loss: 0.873 Vali Acc: 0.717 Test Loss: 0.873 Test Acc: 0.717
Validation loss decreased (-0.478248 --> -0.717383).  Saving model ...
Epoch: 3 cost time: 3.4613335132598877
Epoch: 3, Steps: 9 | Train Loss: 0.796 Vali Loss: 0.628 Vali Acc: 0.761 Test Loss: 0.628 Test Acc: 0.761
Validation loss decreased (-0.717383 --> -0.760863).  Saving model ...
Epoch: 4 cost time: 3.344820022583008
Epoch: 4, Steps: 9 | Train Loss: 0.471 Vali Loss: 0.434 Vali Acc: 0.833 Test Loss: 0.434 Test Acc: 0.833
Validation loss decreased (-0.760863 --> -0.833329).  Saving model ...
Epoch: 5 cost time: 3.697435140609741
Epoch: 5, Steps: 9 | Train Loss: 0.303 Vali Loss: 0.424 Vali Acc: 0.819 Test Loss: 0.424 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.669111490249634
Epoch: 6, Steps: 9 | Train Loss: 0.169 Vali Loss: 0.370 Vali Acc: 0.877 Test Loss: 0.370 Test Acc: 0.877
Validation loss decreased (-0.833329 --> -0.876808).  Saving model ...
Epoch: 7 cost time: 4.557262897491455
Epoch: 7, Steps: 9 | Train Loss: 0.443 Vali Loss: 0.410 Vali Acc: 0.833 Test Loss: 0.410 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.67471718788147
Epoch: 8, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.401 Vali Acc: 0.855 Test Loss: 0.401 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.388323783874512
Epoch: 9, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.470 Vali Acc: 0.855 Test Loss: 0.470 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.659262180328369
Epoch: 10, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.511 Vali Acc: 0.862 Test Loss: 0.511 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.591782331466675
Epoch: 11, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.461 Vali Acc: 0.848 Test Loss: 0.461 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.6245808601379395
Epoch: 12, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.356 Vali Acc: 0.884 Test Loss: 0.356 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884054).  Saving model ...
Epoch: 13 cost time: 3.7600948810577393
Epoch: 13, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.424 Vali Acc: 0.906 Test Loss: 0.424 Test Acc: 0.906
Validation loss decreased (-0.884054 --> -0.905793).  Saving model ...
Epoch: 14 cost time: 3.961087942123413
Epoch: 14, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.466 Vali Acc: 0.906 Test Loss: 0.466 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.102272987365723
Epoch: 15, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.433 Vali Acc: 0.891 Test Loss: 0.433 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.282745122909546
Epoch: 16, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.454 Vali Acc: 0.870 Test Loss: 0.454 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.422763109207153
Epoch: 17, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.467 Vali Acc: 0.855 Test Loss: 0.467 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.236895561218262
Epoch: 18, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.667 Vali Acc: 0.826 Test Loss: 0.667 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.474137544631958
Epoch: 19, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.698 Vali Acc: 0.819 Test Loss: 0.698 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.482927322387695
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.697 Vali Acc: 0.826 Test Loss: 0.697 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.360534429550171
Epoch: 21, Steps: 9 | Train Loss: 0.349 Vali Loss: 0.692 Vali Acc: 0.841 Test Loss: 0.692 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.49643611907959
Epoch: 22, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.434 Vali Acc: 0.906 Test Loss: 0.434 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.070993900299072
Epoch: 23, Steps: 9 | Train Loss: 0.098 Vali Loss: 0.671 Vali Acc: 0.826 Test Loss: 0.671 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 9428420
model size : 37.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.152099370956421
Epoch: 1, Steps: 9 | Train Loss: 1.282 Vali Loss: 1.169 Vali Acc: 0.514 Test Loss: 1.169 Test Acc: 0.514
Validation loss decreased (inf --> -0.514481).  Saving model ...
Epoch: 2 cost time: 1.822098731994629
Epoch: 2, Steps: 9 | Train Loss: 1.021 Vali Loss: 0.901 Vali Acc: 0.688 Test Loss: 0.901 Test Acc: 0.688
Validation loss decreased (-0.514481 --> -0.688397).  Saving model ...
Epoch: 3 cost time: 1.8735592365264893
Epoch: 3, Steps: 9 | Train Loss: 0.721 Vali Loss: 0.634 Vali Acc: 0.790 Test Loss: 0.634 Test Acc: 0.790
Validation loss decreased (-0.688397 --> -0.789849).  Saving model ...
Epoch: 4 cost time: 1.8252215385437012
Epoch: 4, Steps: 9 | Train Loss: 0.502 Vali Loss: 0.491 Vali Acc: 0.797 Test Loss: 0.491 Test Acc: 0.797
Validation loss decreased (-0.789849 --> -0.797097).  Saving model ...
Epoch: 5 cost time: 1.9198479652404785
Epoch: 5, Steps: 9 | Train Loss: 0.303 Vali Loss: 0.368 Vali Acc: 0.884 Test Loss: 0.368 Test Acc: 0.884
Validation loss decreased (-0.797097 --> -0.884054).  Saving model ...
Epoch: 6 cost time: 2.1524908542633057
Epoch: 6, Steps: 9 | Train Loss: 0.265 Vali Loss: 0.325 Vali Acc: 0.877 Test Loss: 0.325 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9877886772155762
Epoch: 7, Steps: 9 | Train Loss: 0.156 Vali Loss: 0.348 Vali Acc: 0.877 Test Loss: 0.348 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.186488628387451
Epoch: 8, Steps: 9 | Train Loss: 0.141 Vali Loss: 0.364 Vali Acc: 0.848 Test Loss: 0.364 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.0649194717407227
Epoch: 9, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.271 Vali Acc: 0.899 Test Loss: 0.271 Test Acc: 0.899
Validation loss decreased (-0.884054 --> -0.898548).  Saving model ...
Epoch: 10 cost time: 1.9646430015563965
Epoch: 10, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.376 Vali Acc: 0.870 Test Loss: 0.376 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.168834686279297
Epoch: 11, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.377 Vali Acc: 0.870 Test Loss: 0.377 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8395180702209473
Epoch: 12, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.311 Vali Acc: 0.913 Test Loss: 0.311 Test Acc: 0.913
Validation loss decreased (-0.898548 --> -0.913040).  Saving model ...
Epoch: 13 cost time: 1.671464443206787
Epoch: 13, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.352 Vali Acc: 0.906 Test Loss: 0.352 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7270188331604004
Epoch: 14, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.379 Vali Acc: 0.884 Test Loss: 0.379 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.9715468883514404
Epoch: 15, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.364 Vali Acc: 0.891 Test Loss: 0.364 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.9499211311340332
Epoch: 16, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.337 Vali Acc: 0.899 Test Loss: 0.337 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.986144781112671
Epoch: 17, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.319 Vali Acc: 0.913 Test Loss: 0.319 Test Acc: 0.913
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.130828857421875
Epoch: 18, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.318 Vali Acc: 0.920 Test Loss: 0.318 Test Acc: 0.920
Validation loss decreased (-0.913040 --> -0.920287).  Saving model ...
Epoch: 19 cost time: 2.207338333129883
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.293 Vali Acc: 0.920 Test Loss: 0.293 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 20 cost time: 1.9774088859558105
Epoch: 20, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.305 Vali Acc: 0.920 Test Loss: 0.305 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.1235854625701904
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.336 Vali Acc: 0.920 Test Loss: 0.336 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.043031930923462
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.353 Vali Acc: 0.920 Test Loss: 0.353 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.1676087379455566
Epoch: 23, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.344 Vali Acc: 0.920 Test Loss: 0.344 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.243346929550171
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.341 Vali Acc: 0.920 Test Loss: 0.341 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.0529701709747314
Epoch: 25, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.338 Vali Acc: 0.920 Test Loss: 0.338 Test Acc: 0.920
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.125314474105835
Epoch: 26, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.340 Vali Acc: 0.920 Test Loss: 0.340 Test Acc: 0.920
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.02966570854187
Epoch: 27, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.366 Vali Acc: 0.891 Test Loss: 0.366 Test Acc: 0.891
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.6443407535552979
Epoch: 28, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.370 Vali Acc: 0.899 Test Loss: 0.370 Test Acc: 0.899
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.6815643310546875
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.368 Vali Acc: 0.884 Test Loss: 0.368 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 2808260
model size : 11.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.050375461578369
Epoch: 1, Steps: 9 | Train Loss: 1.372 Vali Loss: 1.285 Vali Acc: 0.377 Test Loss: 1.285 Test Acc: 0.377
Validation loss decreased (inf --> -0.376799).  Saving model ...
Epoch: 2 cost time: 2.901134967803955
Epoch: 2, Steps: 9 | Train Loss: 1.109 Vali Loss: 1.011 Vali Acc: 0.594 Test Loss: 1.011 Test Acc: 0.594
Validation loss decreased (-0.376799 --> -0.594193).  Saving model ...
Epoch: 3 cost time: 2.766617774963379
Epoch: 3, Steps: 9 | Train Loss: 0.839 Vali Loss: 0.844 Vali Acc: 0.638 Test Loss: 0.844 Test Acc: 0.638
Validation loss decreased (-0.594193 --> -0.637673).  Saving model ...
Epoch: 4 cost time: 2.9955549240112305
Epoch: 4, Steps: 9 | Train Loss: 0.562 Vali Loss: 0.670 Vali Acc: 0.703 Test Loss: 0.670 Test Acc: 0.703
Validation loss decreased (-0.637673 --> -0.702892).  Saving model ...
Epoch: 5 cost time: 3.038723945617676
Epoch: 5, Steps: 9 | Train Loss: 0.362 Vali Loss: 0.560 Vali Acc: 0.783 Test Loss: 0.560 Test Acc: 0.783
Validation loss decreased (-0.702892 --> -0.782603).  Saving model ...
Epoch: 6 cost time: 2.8831284046173096
Epoch: 6, Steps: 9 | Train Loss: 0.225 Vali Loss: 0.483 Vali Acc: 0.819 Test Loss: 0.483 Test Acc: 0.819
Validation loss decreased (-0.782603 --> -0.818836).  Saving model ...
Epoch: 7 cost time: 3.125304698944092
Epoch: 7, Steps: 9 | Train Loss: 0.138 Vali Loss: 0.456 Vali Acc: 0.819 Test Loss: 0.456 Test Acc: 0.819
Validation loss decreased (-0.818836 --> -0.818836).  Saving model ...
Epoch: 8 cost time: 2.7590818405151367
Epoch: 8, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.492 Vali Acc: 0.833 Test Loss: 0.492 Test Acc: 0.833
Validation loss decreased (-0.818836 --> -0.833328).  Saving model ...
Epoch: 9 cost time: 2.6625356674194336
Epoch: 9, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.526 Vali Acc: 0.862 Test Loss: 0.526 Test Acc: 0.862
Validation loss decreased (-0.833328 --> -0.862314).  Saving model ...
Epoch: 10 cost time: 2.785865306854248
Epoch: 10, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.474 Vali Acc: 0.870 Test Loss: 0.474 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869560).  Saving model ...
Epoch: 11 cost time: 2.5240252017974854
Epoch: 11, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.430 Vali Acc: 0.884 Test Loss: 0.430 Test Acc: 0.884
Validation loss decreased (-0.869560 --> -0.884054).  Saving model ...
Epoch: 12 cost time: 2.7283623218536377
Epoch: 12, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.401 Vali Acc: 0.906 Test Loss: 0.401 Test Acc: 0.906
Validation loss decreased (-0.884054 --> -0.905793).  Saving model ...
Epoch: 13 cost time: 2.844074010848999
Epoch: 13, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.432 Vali Acc: 0.913 Test Loss: 0.432 Test Acc: 0.913
Validation loss decreased (-0.905793 --> -0.913039).  Saving model ...
Epoch: 14 cost time: 2.840214252471924
Epoch: 14, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.840 Vali Acc: 0.819 Test Loss: 0.840 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.8718903064727783
Epoch: 15, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.265 Vali Acc: 0.775 Test Loss: 1.265 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.8334057331085205
Epoch: 16, Steps: 9 | Train Loss: 0.282 Vali Loss: 0.659 Vali Acc: 0.826 Test Loss: 0.659 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.6920251846313477
Epoch: 17, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.475 Vali Acc: 0.913 Test Loss: 0.475 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.4834961891174316
Epoch: 18, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.375 Vali Acc: 0.906 Test Loss: 0.375 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.8154475688934326
Epoch: 19, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.399 Vali Acc: 0.884 Test Loss: 0.399 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.8974876403808594
Epoch: 20, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.722 Vali Acc: 0.862 Test Loss: 0.722 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.9315333366394043
Epoch: 21, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.680 Vali Acc: 0.870 Test Loss: 0.680 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.249654769897461
Epoch: 22, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.591 Vali Acc: 0.884 Test Loss: 0.591 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.064023017883301
Epoch: 23, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.523 Vali Acc: 0.877 Test Loss: 0.523 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 9428420
model size : 37.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.9111101627349854
Epoch: 1, Steps: 9 | Train Loss: 1.284 Vali Loss: 1.199 Vali Acc: 0.486 Test Loss: 1.199 Test Acc: 0.486
Validation loss decreased (inf --> -0.485495).  Saving model ...
Epoch: 2 cost time: 1.3427021503448486
Epoch: 2, Steps: 9 | Train Loss: 1.040 Vali Loss: 1.009 Vali Acc: 0.594 Test Loss: 1.009 Test Acc: 0.594
Validation loss decreased (-0.485495 --> -0.594193).  Saving model ...
Epoch: 3 cost time: 1.387134075164795
Epoch: 3, Steps: 9 | Train Loss: 0.779 Vali Loss: 0.807 Vali Acc: 0.703 Test Loss: 0.807 Test Acc: 0.703
Validation loss decreased (-0.594193 --> -0.702890).  Saving model ...
Epoch: 4 cost time: 1.3326520919799805
Epoch: 4, Steps: 9 | Train Loss: 0.547 Vali Loss: 0.646 Vali Acc: 0.732 Test Loss: 0.646 Test Acc: 0.732
Validation loss decreased (-0.702890 --> -0.731878).  Saving model ...
Epoch: 5 cost time: 1.3497686386108398
Epoch: 5, Steps: 9 | Train Loss: 0.364 Vali Loss: 0.519 Vali Acc: 0.804 Test Loss: 0.519 Test Acc: 0.804
Validation loss decreased (-0.731878 --> -0.804343).  Saving model ...
Epoch: 6 cost time: 1.4231557846069336
Epoch: 6, Steps: 9 | Train Loss: 0.234 Vali Loss: 0.449 Vali Acc: 0.833 Test Loss: 0.449 Test Acc: 0.833
Validation loss decreased (-0.804343 --> -0.833329).  Saving model ...
Epoch: 7 cost time: 1.5029070377349854
Epoch: 7, Steps: 9 | Train Loss: 0.149 Vali Loss: 0.429 Vali Acc: 0.812 Test Loss: 0.429 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4770479202270508
Epoch: 8, Steps: 9 | Train Loss: 0.139 Vali Loss: 0.485 Vali Acc: 0.775 Test Loss: 0.485 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.54194974899292
Epoch: 9, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.485 Vali Acc: 0.841 Test Loss: 0.485 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840575).  Saving model ...
Epoch: 10 cost time: 1.3656690120697021
Epoch: 10, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.581 Vali Acc: 0.790 Test Loss: 0.581 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.350689172744751
Epoch: 11, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.524 Vali Acc: 0.790 Test Loss: 0.524 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1630244255065918
Epoch: 12, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.547 Vali Acc: 0.826 Test Loss: 0.547 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1475820541381836
Epoch: 13, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.575 Vali Acc: 0.797 Test Loss: 0.575 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.129589557647705
Epoch: 14, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.560 Vali Acc: 0.804 Test Loss: 0.560 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.209883451461792
Epoch: 15, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.563 Vali Acc: 0.819 Test Loss: 0.563 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.1773741245269775
Epoch: 16, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.572 Vali Acc: 0.819 Test Loss: 0.572 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.1807985305786133
Epoch: 17, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.571 Vali Acc: 0.841 Test Loss: 0.571 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.3793940544128418
Epoch: 18, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.554 Vali Acc: 0.862 Test Loss: 0.554 Test Acc: 0.862
Validation loss decreased (-0.840575 --> -0.862313).  Saving model ...
Epoch: 19 cost time: 1.320267677307129
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.538 Vali Acc: 0.862 Test Loss: 0.538 Test Acc: 0.862
Validation loss decreased (-0.862313 --> -0.862313).  Saving model ...
Epoch: 20 cost time: 1.3357622623443604
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.532 Vali Acc: 0.862 Test Loss: 0.532 Test Acc: 0.862
Validation loss decreased (-0.862313 --> -0.862314).  Saving model ...
Epoch: 21 cost time: 1.4116151332855225
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.543 Vali Acc: 0.862 Test Loss: 0.543 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4772939682006836
Epoch: 22, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.468 Vali Acc: 0.877 Test Loss: 0.468 Test Acc: 0.877
Validation loss decreased (-0.862314 --> -0.876807).  Saving model ...
Epoch: 23 cost time: 1.5343244075775146
Epoch: 23, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.409 Vali Acc: 0.884 Test Loss: 0.409 Test Acc: 0.884
Validation loss decreased (-0.876807 --> -0.884054).  Saving model ...
Epoch: 24 cost time: 1.4784154891967773
Epoch: 24, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.381 Vali Acc: 0.884 Test Loss: 0.381 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 25 cost time: 1.4423274993896484
Epoch: 25, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.399 Vali Acc: 0.899 Test Loss: 0.399 Test Acc: 0.899
Validation loss decreased (-0.884054 --> -0.898547).  Saving model ...
Epoch: 26 cost time: 1.34775710105896
Epoch: 26, Steps: 9 | Train Loss: 0.037 Vali Loss: 1.023 Vali Acc: 0.833 Test Loss: 1.023 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.4114248752593994
Epoch: 27, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.850 Vali Acc: 0.819 Test Loss: 0.850 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.5075368881225586
Epoch: 28, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.546 Vali Acc: 0.819 Test Loss: 0.546 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.348050832748413
Epoch: 29, Steps: 9 | Train Loss: 0.031 Vali Loss: 1.121 Vali Acc: 0.739 Test Loss: 1.121 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.3249397277832031
Epoch: 30, Steps: 9 | Train Loss: 0.007 Vali Loss: 1.305 Vali Acc: 0.746 Test Loss: 1.305 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 2808260
model size : 11.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 7.075055837631226
Epoch: 1, Steps: 9 | Train Loss: 1.435 Vali Loss: 1.342 Vali Acc: 0.391 Test Loss: 1.342 Test Acc: 0.391
Validation loss decreased (inf --> -0.391291).  Saving model ...
Epoch: 2 cost time: 5.891151189804077
Epoch: 2, Steps: 9 | Train Loss: 1.263 Vali Loss: 1.096 Vali Acc: 0.616 Test Loss: 1.096 Test Acc: 0.616
Validation loss decreased (-0.391291 --> -0.615931).  Saving model ...
Epoch: 3 cost time: 5.747399806976318
Epoch: 3, Steps: 9 | Train Loss: 0.974 Vali Loss: 0.869 Vali Acc: 0.725 Test Loss: 0.869 Test Acc: 0.725
Validation loss decreased (-0.615931 --> -0.724629).  Saving model ...
Epoch: 4 cost time: 5.762500047683716
Epoch: 4, Steps: 9 | Train Loss: 0.711 Vali Loss: 0.626 Vali Acc: 0.819 Test Loss: 0.626 Test Acc: 0.819
Validation loss decreased (-0.724629 --> -0.818834).  Saving model ...
Epoch: 5 cost time: 5.59485936164856
Epoch: 5, Steps: 9 | Train Loss: 0.454 Vali Loss: 0.481 Vali Acc: 0.826 Test Loss: 0.481 Test Acc: 0.826
Validation loss decreased (-0.818834 --> -0.826082).  Saving model ...
Epoch: 6 cost time: 5.847143888473511
Epoch: 6, Steps: 9 | Train Loss: 0.293 Vali Loss: 0.425 Vali Acc: 0.841 Test Loss: 0.425 Test Acc: 0.841
Validation loss decreased (-0.826082 --> -0.840575).  Saving model ...
Epoch: 7 cost time: 5.241989374160767
Epoch: 7, Steps: 9 | Train Loss: 0.331 Vali Loss: 0.363 Vali Acc: 0.891 Test Loss: 0.363 Test Acc: 0.891
Validation loss decreased (-0.840575 --> -0.891301).  Saving model ...
Epoch: 8 cost time: 5.105790138244629
Epoch: 8, Steps: 9 | Train Loss: 0.233 Vali Loss: 0.363 Vali Acc: 0.877 Test Loss: 0.363 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.367662191390991
Epoch: 9, Steps: 9 | Train Loss: 0.130 Vali Loss: 0.458 Vali Acc: 0.833 Test Loss: 0.458 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.588632822036743
Epoch: 10, Steps: 9 | Train Loss: 0.099 Vali Loss: 0.342 Vali Acc: 0.884 Test Loss: 0.342 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.988018274307251
Epoch: 11, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.407 Vali Acc: 0.877 Test Loss: 0.407 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.101477384567261
Epoch: 12, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.386 Vali Acc: 0.906 Test Loss: 0.386 Test Acc: 0.906
Validation loss decreased (-0.891301 --> -0.905793).  Saving model ...
Epoch: 13 cost time: 5.194218873977661
Epoch: 13, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.264 Vali Acc: 0.928 Test Loss: 0.264 Test Acc: 0.928
Validation loss decreased (-0.905793 --> -0.927534).  Saving model ...
Epoch: 14 cost time: 5.1928322315216064
Epoch: 14, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.278 Vali Acc: 0.920 Test Loss: 0.278 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.700439453125
Epoch: 15, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.289 Vali Acc: 0.928 Test Loss: 0.289 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.5024309158325195
Epoch: 16, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.302 Vali Acc: 0.920 Test Loss: 0.302 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.542351007461548
Epoch: 17, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.270 Vali Acc: 0.913 Test Loss: 0.270 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.722434043884277
Epoch: 18, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.306 Vali Acc: 0.899 Test Loss: 0.306 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.4578447341918945
Epoch: 19, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.311 Vali Acc: 0.899 Test Loss: 0.311 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.2933108806610107
Epoch: 20, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.321 Vali Acc: 0.913 Test Loss: 0.321 Test Acc: 0.913
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 5.813685655593872
Epoch: 21, Steps: 9 | Train Loss: 0.270 Vali Loss: 0.283 Vali Acc: 0.928 Test Loss: 0.283 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 5.58787989616394
Epoch: 22, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.258 Vali Acc: 0.920 Test Loss: 0.258 Test Acc: 0.920
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 5.574405193328857
Epoch: 23, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.276 Vali Acc: 0.928 Test Loss: 0.276 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.927536231884058
model parameter : 9402340
model size : 36.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.731464385986328
Epoch: 1, Steps: 9 | Train Loss: 1.364 Vali Loss: 1.330 Vali Acc: 0.341 Test Loss: 1.330 Test Acc: 0.341
Validation loss decreased (inf --> -0.340566).  Saving model ...
Epoch: 2 cost time: 3.093818426132202
Epoch: 2, Steps: 9 | Train Loss: 1.126 Vali Loss: 1.070 Vali Acc: 0.609 Test Loss: 1.070 Test Acc: 0.609
Validation loss decreased (-0.340566 --> -0.608685).  Saving model ...
Epoch: 3 cost time: 3.261932373046875
Epoch: 3, Steps: 9 | Train Loss: 0.876 Vali Loss: 0.767 Vali Acc: 0.775 Test Loss: 0.767 Test Acc: 0.775
Validation loss decreased (-0.608685 --> -0.775355).  Saving model ...
Epoch: 4 cost time: 3.001657009124756
Epoch: 4, Steps: 9 | Train Loss: 0.600 Vali Loss: 0.516 Vali Acc: 0.826 Test Loss: 0.516 Test Acc: 0.826
Validation loss decreased (-0.775355 --> -0.826082).  Saving model ...
Epoch: 5 cost time: 3.3020153045654297
Epoch: 5, Steps: 9 | Train Loss: 0.450 Vali Loss: 0.417 Vali Acc: 0.819 Test Loss: 0.417 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.2643721103668213
Epoch: 6, Steps: 9 | Train Loss: 0.315 Vali Loss: 0.382 Vali Acc: 0.848 Test Loss: 0.382 Test Acc: 0.848
Validation loss decreased (-0.826082 --> -0.847822).  Saving model ...
Epoch: 7 cost time: 3.188843011856079
Epoch: 7, Steps: 9 | Train Loss: 0.178 Vali Loss: 0.375 Vali Acc: 0.862 Test Loss: 0.375 Test Acc: 0.862
Validation loss decreased (-0.847822 --> -0.862315).  Saving model ...
Epoch: 8 cost time: 3.4606833457946777
Epoch: 8, Steps: 9 | Train Loss: 0.171 Vali Loss: 0.387 Vali Acc: 0.870 Test Loss: 0.387 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869561).  Saving model ...
Epoch: 9 cost time: 3.6550562381744385
Epoch: 9, Steps: 9 | Train Loss: 0.105 Vali Loss: 0.430 Vali Acc: 0.848 Test Loss: 0.430 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.523423194885254
Epoch: 10, Steps: 9 | Train Loss: 0.150 Vali Loss: 0.408 Vali Acc: 0.877 Test Loss: 0.408 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876808).  Saving model ...
Epoch: 11 cost time: 3.4368674755096436
Epoch: 11, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.402 Vali Acc: 0.870 Test Loss: 0.402 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.5211079120635986
Epoch: 12, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.370 Vali Acc: 0.891 Test Loss: 0.370 Test Acc: 0.891
Validation loss decreased (-0.876808 --> -0.891301).  Saving model ...
Epoch: 13 cost time: 3.4725234508514404
Epoch: 13, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.394 Vali Acc: 0.870 Test Loss: 0.394 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.531863212585449
Epoch: 14, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.364 Vali Acc: 0.884 Test Loss: 0.364 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.55073618888855
Epoch: 15, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.447 Vali Acc: 0.855 Test Loss: 0.447 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.2395706176757812
Epoch: 16, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.459 Vali Acc: 0.862 Test Loss: 0.459 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.99210262298584
Epoch: 17, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.449 Vali Acc: 0.891 Test Loss: 0.449 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.9538440704345703
Epoch: 18, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.437 Vali Acc: 0.899 Test Loss: 0.437 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898546).  Saving model ...
Epoch: 19 cost time: 3.117764472961426
Epoch: 19, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.477 Vali Acc: 0.877 Test Loss: 0.477 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.3638734817504883
Epoch: 20, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.489 Vali Acc: 0.870 Test Loss: 0.489 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.2433550357818604
Epoch: 21, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.489 Vali Acc: 0.884 Test Loss: 0.489 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.355121612548828
Epoch: 22, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.460 Vali Acc: 0.870 Test Loss: 0.460 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.3638503551483154
Epoch: 23, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.483 Vali Acc: 0.891 Test Loss: 0.483 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.35756516456604
Epoch: 24, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.513 Vali Acc: 0.855 Test Loss: 0.513 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.3088624477386475
Epoch: 25, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.536 Vali Acc: 0.870 Test Loss: 0.536 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.191457509994507
Epoch: 26, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.539 Vali Acc: 0.841 Test Loss: 0.539 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.217663526535034
Epoch: 27, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.375 Vali Acc: 0.891 Test Loss: 0.375 Test Acc: 0.891
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 3.218822717666626
Epoch: 28, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.378 Vali Acc: 0.884 Test Loss: 0.378 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 2781924
model size : 11.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.76938271522522
Epoch: 1, Steps: 9 | Train Loss: 1.437 Vali Loss: 1.352 Vali Acc: 0.391 Test Loss: 1.352 Test Acc: 0.391
Validation loss decreased (inf --> -0.391291).  Saving model ...
Epoch: 2 cost time: 4.524378299713135
Epoch: 2, Steps: 9 | Train Loss: 1.302 Vali Loss: 1.146 Vali Acc: 0.551 Test Loss: 1.146 Test Acc: 0.551
Validation loss decreased (-0.391291 --> -0.550713).  Saving model ...
Epoch: 3 cost time: 3.9470138549804688
Epoch: 3, Steps: 9 | Train Loss: 1.042 Vali Loss: 0.909 Vali Acc: 0.710 Test Loss: 0.909 Test Acc: 0.710
Validation loss decreased (-0.550713 --> -0.710136).  Saving model ...
Epoch: 4 cost time: 4.107386350631714
Epoch: 4, Steps: 9 | Train Loss: 0.806 Vali Loss: 0.698 Vali Acc: 0.790 Test Loss: 0.698 Test Acc: 0.790
Validation loss decreased (-0.710136 --> -0.789848).  Saving model ...
Epoch: 5 cost time: 3.995208978652954
Epoch: 5, Steps: 9 | Train Loss: 0.565 Vali Loss: 0.522 Vali Acc: 0.841 Test Loss: 0.522 Test Acc: 0.841
Validation loss decreased (-0.789848 --> -0.840574).  Saving model ...
Epoch: 6 cost time: 3.9894094467163086
Epoch: 6, Steps: 9 | Train Loss: 0.376 Vali Loss: 0.481 Vali Acc: 0.826 Test Loss: 0.481 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.6128387451171875
Epoch: 7, Steps: 9 | Train Loss: 0.366 Vali Loss: 0.377 Vali Acc: 0.884 Test Loss: 0.377 Test Acc: 0.884
Validation loss decreased (-0.840574 --> -0.884054).  Saving model ...
Epoch: 8 cost time: 4.499445676803589
Epoch: 8, Steps: 9 | Train Loss: 0.320 Vali Loss: 0.328 Vali Acc: 0.891 Test Loss: 0.328 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891301).  Saving model ...
Epoch: 9 cost time: 4.615133047103882
Epoch: 9, Steps: 9 | Train Loss: 0.143 Vali Loss: 0.394 Vali Acc: 0.862 Test Loss: 0.394 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.623360633850098
Epoch: 10, Steps: 9 | Train Loss: 0.089 Vali Loss: 0.311 Vali Acc: 0.884 Test Loss: 0.311 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.7322704792022705
Epoch: 11, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.276 Vali Acc: 0.913 Test Loss: 0.276 Test Acc: 0.913
Validation loss decreased (-0.891301 --> -0.913041).  Saving model ...
Epoch: 12 cost time: 4.55226993560791
Epoch: 12, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.346 Vali Acc: 0.891 Test Loss: 0.346 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.622317790985107
Epoch: 13, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.314 Vali Acc: 0.906 Test Loss: 0.314 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.250390529632568
Epoch: 14, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.324 Vali Acc: 0.913 Test Loss: 0.324 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.408339023590088
Epoch: 15, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.326 Vali Acc: 0.906 Test Loss: 0.326 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.381886720657349
Epoch: 16, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.381 Vali Acc: 0.877 Test Loss: 0.381 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.324172019958496
Epoch: 17, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.256 Vali Acc: 0.935 Test Loss: 0.256 Test Acc: 0.935
Validation loss decreased (-0.913041 --> -0.934780).  Saving model ...
Epoch: 18 cost time: 4.467205286026001
Epoch: 18, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.232 Vali Acc: 0.942 Test Loss: 0.232 Test Acc: 0.942
Validation loss decreased (-0.934780 --> -0.942027).  Saving model ...
Epoch: 19 cost time: 3.4969799518585205
Epoch: 19, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.245 Vali Acc: 0.935 Test Loss: 0.245 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.8776752948760986
Epoch: 20, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.253 Vali Acc: 0.935 Test Loss: 0.253 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.9243264198303223
Epoch: 21, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.350 Vali Acc: 0.899 Test Loss: 0.350 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.275349378585815
Epoch: 22, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.500 Vali Acc: 0.877 Test Loss: 0.500 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.2234413623809814
Epoch: 23, Steps: 9 | Train Loss: 0.186 Vali Loss: 0.494 Vali Acc: 0.884 Test Loss: 0.494 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 4.11893630027771
Epoch: 24, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.612 Vali Acc: 0.870 Test Loss: 0.612 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 4.548563241958618
Epoch: 25, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.389 Vali Acc: 0.920 Test Loss: 0.389 Test Acc: 0.920
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 4.563340902328491
Epoch: 26, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.583 Vali Acc: 0.899 Test Loss: 0.583 Test Acc: 0.899
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 4.480387210845947
Epoch: 27, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.178 Vali Acc: 0.848 Test Loss: 1.178 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 4.5741517543792725
Epoch: 28, Steps: 9 | Train Loss: 0.180 Vali Loss: 1.245 Vali Acc: 0.848 Test Loss: 1.245 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9420289855072463
model parameter : 9402340
model size : 36.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.139866352081299
Epoch: 1, Steps: 9 | Train Loss: 1.365 Vali Loss: 1.338 Vali Acc: 0.333 Test Loss: 1.338 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 2.363374948501587
Epoch: 2, Steps: 9 | Train Loss: 1.138 Vali Loss: 1.093 Vali Acc: 0.551 Test Loss: 1.093 Test Acc: 0.551
Validation loss decreased (-0.333320 --> -0.550714).  Saving model ...
Epoch: 3 cost time: 2.2610487937927246
Epoch: 3, Steps: 9 | Train Loss: 0.915 Vali Loss: 0.821 Vali Acc: 0.732 Test Loss: 0.821 Test Acc: 0.732
Validation loss decreased (-0.550714 --> -0.731876).  Saving model ...
Epoch: 4 cost time: 2.236920118331909
Epoch: 4, Steps: 9 | Train Loss: 0.669 Vali Loss: 0.590 Vali Acc: 0.797 Test Loss: 0.590 Test Acc: 0.797
Validation loss decreased (-0.731876 --> -0.797096).  Saving model ...
Epoch: 5 cost time: 2.252570152282715
Epoch: 5, Steps: 9 | Train Loss: 0.515 Vali Loss: 0.462 Vali Acc: 0.819 Test Loss: 0.462 Test Acc: 0.819
Validation loss decreased (-0.797096 --> -0.818836).  Saving model ...
Epoch: 6 cost time: 2.409269094467163
Epoch: 6, Steps: 9 | Train Loss: 0.360 Vali Loss: 0.398 Vali Acc: 0.833 Test Loss: 0.398 Test Acc: 0.833
Validation loss decreased (-0.818836 --> -0.833329).  Saving model ...
Epoch: 7 cost time: 2.482205629348755
Epoch: 7, Steps: 9 | Train Loss: 0.234 Vali Loss: 0.376 Vali Acc: 0.862 Test Loss: 0.376 Test Acc: 0.862
Validation loss decreased (-0.833329 --> -0.862315).  Saving model ...
Epoch: 8 cost time: 2.513709783554077
Epoch: 8, Steps: 9 | Train Loss: 0.207 Vali Loss: 0.372 Vali Acc: 0.841 Test Loss: 0.372 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.441951036453247
Epoch: 9, Steps: 9 | Train Loss: 0.119 Vali Loss: 0.385 Vali Acc: 0.848 Test Loss: 0.385 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.4652438163757324
Epoch: 10, Steps: 9 | Train Loss: 0.110 Vali Loss: 0.385 Vali Acc: 0.855 Test Loss: 0.385 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.4860012531280518
Epoch: 11, Steps: 9 | Train Loss: 0.089 Vali Loss: 0.363 Vali Acc: 0.848 Test Loss: 0.363 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.5193042755126953
Epoch: 12, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.343 Vali Acc: 0.855 Test Loss: 0.343 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.4236600399017334
Epoch: 13, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.366 Vali Acc: 0.870 Test Loss: 0.366 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869562).  Saving model ...
Epoch: 14 cost time: 2.4626007080078125
Epoch: 14, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.310 Vali Acc: 0.877 Test Loss: 0.310 Test Acc: 0.877
Validation loss decreased (-0.869562 --> -0.876808).  Saving model ...
Epoch: 15 cost time: 2.481079578399658
Epoch: 15, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.386 Vali Acc: 0.884 Test Loss: 0.386 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884054).  Saving model ...
Epoch: 16 cost time: 2.456001043319702
Epoch: 16, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.465 Vali Acc: 0.870 Test Loss: 0.465 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.3766133785247803
Epoch: 17, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.469 Vali Acc: 0.884 Test Loss: 0.469 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.518521785736084
Epoch: 18, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.657 Vali Acc: 0.812 Test Loss: 0.657 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.4292924404144287
Epoch: 19, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.374 Vali Acc: 0.899 Test Loss: 0.374 Test Acc: 0.899
Validation loss decreased (-0.884054 --> -0.898547).  Saving model ...
Epoch: 20 cost time: 2.3414406776428223
Epoch: 20, Steps: 9 | Train Loss: 0.017 Vali Loss: 1.173 Vali Acc: 0.790 Test Loss: 1.173 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.2809648513793945
Epoch: 21, Steps: 9 | Train Loss: 0.174 Vali Loss: 0.333 Vali Acc: 0.877 Test Loss: 0.333 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.470515489578247
Epoch: 22, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.325 Vali Acc: 0.891 Test Loss: 0.325 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.327223777770996
Epoch: 23, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.463 Vali Acc: 0.855 Test Loss: 0.463 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.2523915767669678
Epoch: 24, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.382 Vali Acc: 0.906 Test Loss: 0.382 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905793).  Saving model ...
Epoch: 25 cost time: 2.21999454498291
Epoch: 25, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.357 Vali Acc: 0.891 Test Loss: 0.357 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.1677582263946533
Epoch: 26, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.372 Vali Acc: 0.891 Test Loss: 0.372 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.2894186973571777
Epoch: 27, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.370 Vali Acc: 0.891 Test Loss: 0.370 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.2900352478027344
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.365 Vali Acc: 0.891 Test Loss: 0.365 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.32637095451355
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.363 Vali Acc: 0.899 Test Loss: 0.363 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.224597215652466
Epoch: 30, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.350 Vali Acc: 0.913 Test Loss: 0.350 Test Acc: 0.913
Validation loss decreased (-0.905793 --> -0.913040).  Saving model ...
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 2781924
model size : 11.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.256598472595215
Epoch: 1, Steps: 9 | Train Loss: 1.445 Vali Loss: 1.381 Vali Acc: 0.326 Test Loss: 1.381 Test Acc: 0.326
Validation loss decreased (inf --> -0.326073).  Saving model ...
Epoch: 2 cost time: 2.8734819889068604
Epoch: 2, Steps: 9 | Train Loss: 1.322 Vali Loss: 1.216 Vali Acc: 0.478 Test Loss: 1.216 Test Acc: 0.478
Validation loss decreased (-0.326073 --> -0.478249).  Saving model ...
Epoch: 3 cost time: 2.6899940967559814
Epoch: 3, Steps: 9 | Train Loss: 1.086 Vali Loss: 1.027 Vali Acc: 0.616 Test Loss: 1.027 Test Acc: 0.616
Validation loss decreased (-0.478249 --> -0.615932).  Saving model ...
Epoch: 4 cost time: 2.9419806003570557
Epoch: 4, Steps: 9 | Train Loss: 0.884 Vali Loss: 0.840 Vali Acc: 0.696 Test Loss: 0.840 Test Acc: 0.696
Validation loss decreased (-0.615932 --> -0.695644).  Saving model ...
Epoch: 5 cost time: 2.940028667449951
Epoch: 5, Steps: 9 | Train Loss: 0.665 Vali Loss: 0.673 Vali Acc: 0.761 Test Loss: 0.673 Test Acc: 0.761
Validation loss decreased (-0.695644 --> -0.760863).  Saving model ...
Epoch: 6 cost time: 2.9283273220062256
Epoch: 6, Steps: 9 | Train Loss: 0.473 Vali Loss: 0.544 Vali Acc: 0.790 Test Loss: 0.544 Test Acc: 0.790
Validation loss decreased (-0.760863 --> -0.789850).  Saving model ...
Epoch: 7 cost time: 2.899731159210205
Epoch: 7, Steps: 9 | Train Loss: 0.361 Vali Loss: 0.436 Vali Acc: 0.870 Test Loss: 0.436 Test Acc: 0.870
Validation loss decreased (-0.789850 --> -0.869561).  Saving model ...
Epoch: 8 cost time: 3.065490961074829
Epoch: 8, Steps: 9 | Train Loss: 0.236 Vali Loss: 0.417 Vali Acc: 0.841 Test Loss: 0.417 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.8566341400146484
Epoch: 9, Steps: 9 | Train Loss: 0.143 Vali Loss: 0.432 Vali Acc: 0.862 Test Loss: 0.432 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.8142991065979004
Epoch: 10, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.393 Vali Acc: 0.877 Test Loss: 0.393 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876808).  Saving model ...
Epoch: 11 cost time: 2.751039981842041
Epoch: 11, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.354 Vali Acc: 0.891 Test Loss: 0.354 Test Acc: 0.891
Validation loss decreased (-0.876808 --> -0.891301).  Saving model ...
Epoch: 12 cost time: 2.7493550777435303
Epoch: 12, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.321 Vali Acc: 0.906 Test Loss: 0.321 Test Acc: 0.906
Validation loss decreased (-0.891301 --> -0.905794).  Saving model ...
Epoch: 13 cost time: 2.782273530960083
Epoch: 13, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.260 Vali Acc: 0.920 Test Loss: 0.260 Test Acc: 0.920
Validation loss decreased (-0.905794 --> -0.920287).  Saving model ...
Epoch: 14 cost time: 2.7726659774780273
Epoch: 14, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.347 Vali Acc: 0.906 Test Loss: 0.347 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.7873425483703613
Epoch: 15, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.375 Vali Acc: 0.884 Test Loss: 0.375 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.0630857944488525
Epoch: 16, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.358 Vali Acc: 0.891 Test Loss: 0.358 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.1411893367767334
Epoch: 17, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.312 Vali Acc: 0.906 Test Loss: 0.312 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.233332633972168
Epoch: 18, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.339 Vali Acc: 0.906 Test Loss: 0.339 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.0202720165252686
Epoch: 19, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.426 Vali Acc: 0.899 Test Loss: 0.426 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.0420451164245605
Epoch: 20, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.341 Vali Acc: 0.920 Test Loss: 0.341 Test Acc: 0.920
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.954843044281006
Epoch: 21, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.988 Vali Acc: 0.710 Test Loss: 0.988 Test Acc: 0.710
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.9706215858459473
Epoch: 22, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.975 Vali Acc: 0.703 Test Loss: 0.975 Test Acc: 0.703
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.0068087577819824
Epoch: 23, Steps: 9 | Train Loss: 0.335 Vali Loss: 0.521 Vali Acc: 0.848 Test Loss: 0.521 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 9402340
model size : 36.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.078319549560547
Epoch: 1, Steps: 9 | Train Loss: 1.364 Vali Loss: 1.371 Vali Acc: 0.297 Test Loss: 1.371 Test Acc: 0.297
Validation loss decreased (inf --> -0.297088).  Saving model ...
Epoch: 2 cost time: 1.6450159549713135
Epoch: 2, Steps: 9 | Train Loss: 1.160 Vali Loss: 1.185 Vali Acc: 0.464 Test Loss: 1.185 Test Acc: 0.464
Validation loss decreased (-0.297088 --> -0.463756).  Saving model ...
Epoch: 3 cost time: 1.6305582523345947
Epoch: 3, Steps: 9 | Train Loss: 0.969 Vali Loss: 0.966 Vali Acc: 0.645 Test Loss: 0.966 Test Acc: 0.645
Validation loss decreased (-0.463756 --> -0.644918).  Saving model ...
Epoch: 4 cost time: 1.6582822799682617
Epoch: 4, Steps: 9 | Train Loss: 0.753 Vali Loss: 0.756 Vali Acc: 0.710 Test Loss: 0.756 Test Acc: 0.710
Validation loss decreased (-0.644918 --> -0.710137).  Saving model ...
Epoch: 5 cost time: 1.81685471534729
Epoch: 5, Steps: 9 | Train Loss: 0.592 Vali Loss: 0.616 Vali Acc: 0.768 Test Loss: 0.616 Test Acc: 0.768
Validation loss decreased (-0.710137 --> -0.768110).  Saving model ...
Epoch: 6 cost time: 1.7637760639190674
Epoch: 6, Steps: 9 | Train Loss: 0.435 Vali Loss: 0.518 Vali Acc: 0.790 Test Loss: 0.518 Test Acc: 0.790
Validation loss decreased (-0.768110 --> -0.789850).  Saving model ...
Epoch: 7 cost time: 1.7755770683288574
Epoch: 7, Steps: 9 | Train Loss: 0.291 Vali Loss: 0.445 Vali Acc: 0.826 Test Loss: 0.445 Test Acc: 0.826
Validation loss decreased (-0.789850 --> -0.826083).  Saving model ...
Epoch: 8 cost time: 1.8692853450775146
Epoch: 8, Steps: 9 | Train Loss: 0.223 Vali Loss: 0.428 Vali Acc: 0.841 Test Loss: 0.428 Test Acc: 0.841
Validation loss decreased (-0.826083 --> -0.840575).  Saving model ...
Epoch: 9 cost time: 1.765040397644043
Epoch: 9, Steps: 9 | Train Loss: 0.155 Vali Loss: 0.463 Vali Acc: 0.826 Test Loss: 0.463 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.710629940032959
Epoch: 10, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.417 Vali Acc: 0.826 Test Loss: 0.417 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8697710037231445
Epoch: 11, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.390 Vali Acc: 0.841 Test Loss: 0.390 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840576).  Saving model ...
Epoch: 12 cost time: 1.7777397632598877
Epoch: 12, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.448 Vali Acc: 0.841 Test Loss: 0.448 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8093369007110596
Epoch: 13, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.346 Vali Acc: 0.884 Test Loss: 0.346 Test Acc: 0.884
Validation loss decreased (-0.840576 --> -0.884055).  Saving model ...
Epoch: 14 cost time: 1.6087720394134521
Epoch: 14, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.309 Vali Acc: 0.884 Test Loss: 0.309 Test Acc: 0.884
Validation loss decreased (-0.884055 --> -0.884055).  Saving model ...
Epoch: 15 cost time: 1.6784043312072754
Epoch: 15, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.372 Vali Acc: 0.891 Test Loss: 0.372 Test Acc: 0.891
Validation loss decreased (-0.884055 --> -0.891301).  Saving model ...
Epoch: 16 cost time: 1.5937530994415283
Epoch: 16, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.390 Vali Acc: 0.884 Test Loss: 0.390 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6763625144958496
Epoch: 17, Steps: 9 | Train Loss: 0.011 Vali Loss: 1.282 Vali Acc: 0.703 Test Loss: 1.282 Test Acc: 0.703
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.6672029495239258
Epoch: 18, Steps: 9 | Train Loss: 0.029 Vali Loss: 1.072 Vali Acc: 0.754 Test Loss: 1.072 Test Acc: 0.754
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.6140787601470947
Epoch: 19, Steps: 9 | Train Loss: 0.436 Vali Loss: 0.995 Vali Acc: 0.783 Test Loss: 0.995 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.6426572799682617
Epoch: 20, Steps: 9 | Train Loss: 0.015 Vali Loss: 1.583 Vali Acc: 0.783 Test Loss: 1.583 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.6963284015655518
Epoch: 21, Steps: 9 | Train Loss: 0.496 Vali Loss: 0.493 Vali Acc: 0.870 Test Loss: 0.493 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.739563226699829
Epoch: 22, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.530 Vali Acc: 0.826 Test Loss: 0.530 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.7931280136108398
Epoch: 23, Steps: 9 | Train Loss: 0.120 Vali Loss: 0.495 Vali Acc: 0.877 Test Loss: 0.495 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.5492255687713623
Epoch: 24, Steps: 9 | Train Loss: 0.119 Vali Loss: 0.737 Vali Acc: 0.761 Test Loss: 0.737 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.661454677581787
Epoch: 25, Steps: 9 | Train Loss: 0.117 Vali Loss: 0.473 Vali Acc: 0.862 Test Loss: 0.473 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 2781924
model size : 11.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.801367998123169
Epoch: 1, Steps: 9 | Train Loss: 1.382 Vali Loss: 1.206 Vali Acc: 0.529 Test Loss: 1.206 Test Acc: 0.529
Validation loss decreased (inf --> -0.528973).  Saving model ...
Epoch: 2 cost time: 4.069220304489136
Epoch: 2, Steps: 9 | Train Loss: 1.140 Vali Loss: 0.968 Vali Acc: 0.710 Test Loss: 0.968 Test Acc: 0.710
Validation loss decreased (-0.528973 --> -0.710135).  Saving model ...
Epoch: 3 cost time: 4.098728179931641
Epoch: 3, Steps: 9 | Train Loss: 0.848 Vali Loss: 0.738 Vali Acc: 0.754 Test Loss: 0.738 Test Acc: 0.754
Validation loss decreased (-0.710135 --> -0.753616).  Saving model ...
Epoch: 4 cost time: 4.035874843597412
Epoch: 4, Steps: 9 | Train Loss: 0.616 Vali Loss: 0.552 Vali Acc: 0.797 Test Loss: 0.552 Test Acc: 0.797
Validation loss decreased (-0.753616 --> -0.797096).  Saving model ...
Epoch: 5 cost time: 4.035535097122192
Epoch: 5, Steps: 9 | Train Loss: 0.443 Vali Loss: 0.491 Vali Acc: 0.797 Test Loss: 0.491 Test Acc: 0.797
Validation loss decreased (-0.797096 --> -0.797097).  Saving model ...
Epoch: 6 cost time: 4.181203126907349
Epoch: 6, Steps: 9 | Train Loss: 0.392 Vali Loss: 0.427 Vali Acc: 0.855 Test Loss: 0.427 Test Acc: 0.855
Validation loss decreased (-0.797097 --> -0.855068).  Saving model ...
Epoch: 7 cost time: 4.1594860553741455
Epoch: 7, Steps: 9 | Train Loss: 0.245 Vali Loss: 0.388 Vali Acc: 0.848 Test Loss: 0.388 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.08132791519165
Epoch: 8, Steps: 9 | Train Loss: 0.184 Vali Loss: 0.408 Vali Acc: 0.848 Test Loss: 0.408 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.881519079208374
Epoch: 9, Steps: 9 | Train Loss: 0.121 Vali Loss: 0.378 Vali Acc: 0.855 Test Loss: 0.378 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855069).  Saving model ...
Epoch: 10 cost time: 3.8555350303649902
Epoch: 10, Steps: 9 | Train Loss: 0.096 Vali Loss: 0.403 Vali Acc: 0.841 Test Loss: 0.403 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.8224809169769287
Epoch: 11, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.449 Vali Acc: 0.841 Test Loss: 0.449 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.9212636947631836
Epoch: 12, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.349 Vali Acc: 0.891 Test Loss: 0.349 Test Acc: 0.891
Validation loss decreased (-0.855069 --> -0.891301).  Saving model ...
Epoch: 13 cost time: 4.164788722991943
Epoch: 13, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.344 Vali Acc: 0.884 Test Loss: 0.344 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.249290704727173
Epoch: 14, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.345 Vali Acc: 0.913 Test Loss: 0.345 Test Acc: 0.913
Validation loss decreased (-0.891301 --> -0.913040).  Saving model ...
Epoch: 15 cost time: 4.293568849563599
Epoch: 15, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.374 Vali Acc: 0.913 Test Loss: 0.374 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.339655876159668
Epoch: 16, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.469 Vali Acc: 0.870 Test Loss: 0.469 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.172283172607422
Epoch: 17, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.466 Vali Acc: 0.877 Test Loss: 0.466 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.425341606140137
Epoch: 18, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.385 Vali Acc: 0.913 Test Loss: 0.385 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.396543025970459
Epoch: 19, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.371 Vali Acc: 0.913 Test Loss: 0.371 Test Acc: 0.913
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.340950965881348
Epoch: 20, Steps: 9 | Train Loss: 0.129 Vali Loss: 0.488 Vali Acc: 0.891 Test Loss: 0.488 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.247194051742554
Epoch: 21, Steps: 9 | Train Loss: 0.147 Vali Loss: 0.459 Vali Acc: 0.891 Test Loss: 0.459 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.209978342056274
Epoch: 22, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.352 Vali Acc: 0.913 Test Loss: 0.352 Test Acc: 0.913
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.2516796588897705
Epoch: 23, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.350 Vali Acc: 0.906 Test Loss: 0.350 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 4.434477806091309
Epoch: 24, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.361 Vali Acc: 0.913 Test Loss: 0.361 Test Acc: 0.913
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 4714980
model size : 18.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.014028787612915
Epoch: 1, Steps: 9 | Train Loss: 1.396 Vali Loss: 1.338 Vali Acc: 0.406 Test Loss: 1.338 Test Acc: 0.406
Validation loss decreased (inf --> -0.405784).  Saving model ...
Epoch: 2 cost time: 2.4309189319610596
Epoch: 2, Steps: 9 | Train Loss: 1.207 Vali Loss: 1.100 Vali Acc: 0.601 Test Loss: 1.100 Test Acc: 0.601
Validation loss decreased (-0.405784 --> -0.601438).  Saving model ...
Epoch: 3 cost time: 2.4751384258270264
Epoch: 3, Steps: 9 | Train Loss: 0.957 Vali Loss: 0.841 Vali Acc: 0.710 Test Loss: 0.841 Test Acc: 0.710
Validation loss decreased (-0.601438 --> -0.710137).  Saving model ...
Epoch: 4 cost time: 2.3910892009735107
Epoch: 4, Steps: 9 | Train Loss: 0.675 Vali Loss: 0.621 Vali Acc: 0.783 Test Loss: 0.621 Test Acc: 0.783
Validation loss decreased (-0.710137 --> -0.782602).  Saving model ...
Epoch: 5 cost time: 2.3825409412384033
Epoch: 5, Steps: 9 | Train Loss: 0.510 Vali Loss: 0.498 Vali Acc: 0.804 Test Loss: 0.498 Test Acc: 0.804
Validation loss decreased (-0.782602 --> -0.804343).  Saving model ...
Epoch: 6 cost time: 3.3902759552001953
Epoch: 6, Steps: 9 | Train Loss: 0.399 Vali Loss: 0.438 Vali Acc: 0.804 Test Loss: 0.438 Test Acc: 0.804
Validation loss decreased (-0.804343 --> -0.804343).  Saving model ...
Epoch: 7 cost time: 3.5624847412109375
Epoch: 7, Steps: 9 | Train Loss: 0.253 Vali Loss: 0.410 Vali Acc: 0.819 Test Loss: 0.410 Test Acc: 0.819
Validation loss decreased (-0.804343 --> -0.818836).  Saving model ...
Epoch: 8 cost time: 3.669591188430786
Epoch: 8, Steps: 9 | Train Loss: 0.183 Vali Loss: 0.426 Vali Acc: 0.848 Test Loss: 0.426 Test Acc: 0.848
Validation loss decreased (-0.818836 --> -0.847822).  Saving model ...
Epoch: 9 cost time: 3.6161746978759766
Epoch: 9, Steps: 9 | Train Loss: 0.141 Vali Loss: 0.379 Vali Acc: 0.862 Test Loss: 0.379 Test Acc: 0.862
Validation loss decreased (-0.847822 --> -0.862315).  Saving model ...
Epoch: 10 cost time: 3.6539523601531982
Epoch: 10, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.383 Vali Acc: 0.855 Test Loss: 0.383 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.9520180225372314
Epoch: 11, Steps: 9 | Train Loss: 0.118 Vali Loss: 0.326 Vali Acc: 0.884 Test Loss: 0.326 Test Acc: 0.884
Validation loss decreased (-0.862315 --> -0.884055).  Saving model ...
Epoch: 12 cost time: 3.787440061569214
Epoch: 12, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.325 Vali Acc: 0.899 Test Loss: 0.325 Test Acc: 0.899
Validation loss decreased (-0.884055 --> -0.898547).  Saving model ...
Epoch: 13 cost time: 3.771275758743286
Epoch: 13, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.368 Vali Acc: 0.884 Test Loss: 0.368 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.8390228748321533
Epoch: 14, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.341 Vali Acc: 0.899 Test Loss: 0.341 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.6975064277648926
Epoch: 15, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.359 Vali Acc: 0.891 Test Loss: 0.359 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.5908467769622803
Epoch: 16, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.387 Vali Acc: 0.891 Test Loss: 0.387 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.600355863571167
Epoch: 17, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.330 Vali Acc: 0.899 Test Loss: 0.330 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.8354272842407227
Epoch: 18, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.360 Vali Acc: 0.906 Test Loss: 0.360 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905793).  Saving model ...
Epoch: 19 cost time: 3.635620594024658
Epoch: 19, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.351 Vali Acc: 0.899 Test Loss: 0.351 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.6449453830718994
Epoch: 20, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.371 Vali Acc: 0.855 Test Loss: 0.371 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.996959924697876
Epoch: 21, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.492 Vali Acc: 0.797 Test Loss: 0.492 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.7036664485931396
Epoch: 22, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.362 Vali Acc: 0.862 Test Loss: 0.362 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.6441688537597656
Epoch: 23, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.302 Vali Acc: 0.920 Test Loss: 0.302 Test Acc: 0.920
Validation loss decreased (-0.905793 --> -0.920287).  Saving model ...
Epoch: 24 cost time: 3.6464903354644775
Epoch: 24, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.288 Vali Acc: 0.928 Test Loss: 0.288 Test Acc: 0.928
Validation loss decreased (-0.920287 --> -0.927533).  Saving model ...
Epoch: 25 cost time: 3.643538475036621
Epoch: 25, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.292 Vali Acc: 0.928 Test Loss: 0.292 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.4485602378845215
Epoch: 26, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.320 Vali Acc: 0.920 Test Loss: 0.320 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.5482308864593506
Epoch: 27, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.771 Vali Acc: 0.819 Test Loss: 0.771 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.5827715396881104
Epoch: 28, Steps: 9 | Train Loss: 0.089 Vali Loss: 0.988 Vali Acc: 0.717 Test Loss: 0.988 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.498241662979126
Epoch: 29, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.600 Vali Acc: 0.775 Test Loss: 0.600 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.7247767448425293
Epoch: 30, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.387 Vali Acc: 0.870 Test Loss: 0.387 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.927536231884058
model parameter : 1404644
model size : 5.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 6.601043939590454
Epoch: 1, Steps: 9 | Train Loss: 1.383 Vali Loss: 1.210 Vali Acc: 0.522 Test Loss: 1.210 Test Acc: 0.522
Validation loss decreased (inf --> -0.521727).  Saving model ...
Epoch: 2 cost time: 5.0721025466918945
Epoch: 2, Steps: 9 | Train Loss: 1.172 Vali Loss: 1.010 Vali Acc: 0.674 Test Loss: 1.010 Test Acc: 0.674
Validation loss decreased (-0.521727 --> -0.673903).  Saving model ...
Epoch: 3 cost time: 5.075551271438599
Epoch: 3, Steps: 9 | Train Loss: 0.919 Vali Loss: 0.817 Vali Acc: 0.717 Test Loss: 0.817 Test Acc: 0.717
Validation loss decreased (-0.673903 --> -0.717383).  Saving model ...
Epoch: 4 cost time: 4.991831541061401
Epoch: 4, Steps: 9 | Train Loss: 0.714 Vali Loss: 0.631 Vali Acc: 0.783 Test Loss: 0.631 Test Acc: 0.783
Validation loss decreased (-0.717383 --> -0.782602).  Saving model ...
Epoch: 5 cost time: 5.074981927871704
Epoch: 5, Steps: 9 | Train Loss: 0.502 Vali Loss: 0.508 Vali Acc: 0.812 Test Loss: 0.508 Test Acc: 0.812
Validation loss decreased (-0.782602 --> -0.811589).  Saving model ...
Epoch: 6 cost time: 5.0527262687683105
Epoch: 6, Steps: 9 | Train Loss: 0.424 Vali Loss: 0.417 Vali Acc: 0.862 Test Loss: 0.417 Test Acc: 0.862
Validation loss decreased (-0.811589 --> -0.862315).  Saving model ...
Epoch: 7 cost time: 4.960135459899902
Epoch: 7, Steps: 9 | Train Loss: 0.276 Vali Loss: 0.353 Vali Acc: 0.884 Test Loss: 0.353 Test Acc: 0.884
Validation loss decreased (-0.862315 --> -0.884054).  Saving model ...
Epoch: 8 cost time: 4.969011068344116
Epoch: 8, Steps: 9 | Train Loss: 0.209 Vali Loss: 0.386 Vali Acc: 0.862 Test Loss: 0.386 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.0586020946502686
Epoch: 9, Steps: 9 | Train Loss: 0.149 Vali Loss: 0.333 Vali Acc: 0.877 Test Loss: 0.333 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.013281345367432
Epoch: 10, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.351 Vali Acc: 0.862 Test Loss: 0.351 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.991879940032959
Epoch: 11, Steps: 9 | Train Loss: 0.223 Vali Loss: 0.303 Vali Acc: 0.906 Test Loss: 0.303 Test Acc: 0.906
Validation loss decreased (-0.884054 --> -0.905794).  Saving model ...
Epoch: 12 cost time: 5.050182342529297
Epoch: 12, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.255 Vali Acc: 0.920 Test Loss: 0.255 Test Acc: 0.920
Validation loss decreased (-0.905794 --> -0.920287).  Saving model ...
Epoch: 13 cost time: 5.05707859992981
Epoch: 13, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.290 Vali Acc: 0.906 Test Loss: 0.290 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.8263537883758545
Epoch: 14, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.370 Vali Acc: 0.891 Test Loss: 0.370 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.79782509803772
Epoch: 15, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.326 Vali Acc: 0.920 Test Loss: 0.326 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.942351579666138
Epoch: 16, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.296 Vali Acc: 0.877 Test Loss: 0.296 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.973559141159058
Epoch: 17, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.332 Vali Acc: 0.906 Test Loss: 0.332 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.963658332824707
Epoch: 18, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.326 Vali Acc: 0.920 Test Loss: 0.326 Test Acc: 0.920
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.99171257019043
Epoch: 19, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.319 Vali Acc: 0.913 Test Loss: 0.319 Test Acc: 0.913
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.942056655883789
Epoch: 20, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.313 Vali Acc: 0.920 Test Loss: 0.313 Test Acc: 0.920
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.966575384140015
Epoch: 21, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.775 Vali Acc: 0.877 Test Loss: 0.775 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.960109710693359
Epoch: 22, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.690 Vali Acc: 0.877 Test Loss: 0.690 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 4714980
model size : 18.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.895281076431274
Epoch: 1, Steps: 9 | Train Loss: 1.414 Vali Loss: 1.341 Vali Acc: 0.420 Test Loss: 1.341 Test Acc: 0.420
Validation loss decreased (inf --> -0.420276).  Saving model ...
Epoch: 2 cost time: 2.9046337604522705
Epoch: 2, Steps: 9 | Train Loss: 1.229 Vali Loss: 1.131 Vali Acc: 0.572 Test Loss: 1.131 Test Acc: 0.572
Validation loss decreased (-0.420276 --> -0.572452).  Saving model ...
Epoch: 3 cost time: 2.915217399597168
Epoch: 3, Steps: 9 | Train Loss: 1.008 Vali Loss: 0.907 Vali Acc: 0.659 Test Loss: 0.907 Test Acc: 0.659
Validation loss decreased (-0.572452 --> -0.659411).  Saving model ...
Epoch: 4 cost time: 2.9639556407928467
Epoch: 4, Steps: 9 | Train Loss: 0.762 Vali Loss: 0.697 Vali Acc: 0.768 Test Loss: 0.697 Test Acc: 0.768
Validation loss decreased (-0.659411 --> -0.768109).  Saving model ...
Epoch: 5 cost time: 2.9615628719329834
Epoch: 5, Steps: 9 | Train Loss: 0.570 Vali Loss: 0.559 Vali Acc: 0.775 Test Loss: 0.559 Test Acc: 0.775
Validation loss decreased (-0.768109 --> -0.775357).  Saving model ...
Epoch: 6 cost time: 2.983572244644165
Epoch: 6, Steps: 9 | Train Loss: 0.447 Vali Loss: 0.467 Vali Acc: 0.812 Test Loss: 0.467 Test Acc: 0.812
Validation loss decreased (-0.775357 --> -0.811590).  Saving model ...
Epoch: 7 cost time: 2.945647954940796
Epoch: 7, Steps: 9 | Train Loss: 0.274 Vali Loss: 0.434 Vali Acc: 0.812 Test Loss: 0.434 Test Acc: 0.812
Validation loss decreased (-0.811590 --> -0.811590).  Saving model ...
Epoch: 8 cost time: 2.8719398975372314
Epoch: 8, Steps: 9 | Train Loss: 0.208 Vali Loss: 0.481 Vali Acc: 0.812 Test Loss: 0.481 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.9515559673309326
Epoch: 9, Steps: 9 | Train Loss: 0.134 Vali Loss: 0.487 Vali Acc: 0.812 Test Loss: 0.487 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.9606785774230957
Epoch: 10, Steps: 9 | Train Loss: 0.157 Vali Loss: 0.323 Vali Acc: 0.899 Test Loss: 0.323 Test Acc: 0.899
Validation loss decreased (-0.811590 --> -0.898547).  Saving model ...
Epoch: 11 cost time: 2.8792052268981934
Epoch: 11, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.295 Vali Acc: 0.913 Test Loss: 0.295 Test Acc: 0.913
Validation loss decreased (-0.898547 --> -0.913041).  Saving model ...
Epoch: 12 cost time: 2.951050281524658
Epoch: 12, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.346 Vali Acc: 0.891 Test Loss: 0.346 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.940863609313965
Epoch: 13, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.330 Vali Acc: 0.877 Test Loss: 0.330 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.939326524734497
Epoch: 14, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.283 Vali Acc: 0.913 Test Loss: 0.283 Test Acc: 0.913
Validation loss decreased (-0.913041 --> -0.913041).  Saving model ...
Epoch: 15 cost time: 2.809793472290039
Epoch: 15, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.325 Vali Acc: 0.899 Test Loss: 0.325 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.8465490341186523
Epoch: 16, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.357 Vali Acc: 0.891 Test Loss: 0.357 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.8878586292266846
Epoch: 17, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.318 Vali Acc: 0.906 Test Loss: 0.318 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.8542234897613525
Epoch: 18, Steps: 9 | Train Loss: 0.131 Vali Loss: 0.311 Vali Acc: 0.913 Test Loss: 0.311 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.80511736869812
Epoch: 19, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.328 Vali Acc: 0.906 Test Loss: 0.328 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.084768295288086
Epoch: 20, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.494 Vali Acc: 0.833 Test Loss: 0.494 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.14180064201355
Epoch: 21, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.320 Vali Acc: 0.899 Test Loss: 0.320 Test Acc: 0.899
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.0684235095977783
Epoch: 22, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.311 Vali Acc: 0.913 Test Loss: 0.311 Test Acc: 0.913
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.115710735321045
Epoch: 23, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.310 Vali Acc: 0.913 Test Loss: 0.310 Test Acc: 0.913
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.1955182552337646
Epoch: 24, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.316 Vali Acc: 0.913 Test Loss: 0.316 Test Acc: 0.913
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 1404644
model size : 5.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.731604337692261
Epoch: 1, Steps: 9 | Train Loss: 1.387 Vali Loss: 1.216 Vali Acc: 0.522 Test Loss: 1.216 Test Acc: 0.522
Validation loss decreased (inf --> -0.521727).  Saving model ...
Epoch: 2 cost time: 3.7050890922546387
Epoch: 2, Steps: 9 | Train Loss: 1.181 Vali Loss: 1.044 Vali Acc: 0.630 Test Loss: 1.044 Test Acc: 0.630
Validation loss decreased (-0.521727 --> -0.630424).  Saving model ...
Epoch: 3 cost time: 3.8344638347625732
Epoch: 3, Steps: 9 | Train Loss: 0.962 Vali Loss: 0.914 Vali Acc: 0.652 Test Loss: 0.914 Test Acc: 0.652
Validation loss decreased (-0.630424 --> -0.652165).  Saving model ...
Epoch: 4 cost time: 3.9541878700256348
Epoch: 4, Steps: 9 | Train Loss: 0.778 Vali Loss: 0.792 Vali Acc: 0.659 Test Loss: 0.792 Test Acc: 0.659
Validation loss decreased (-0.652165 --> -0.659412).  Saving model ...
Epoch: 5 cost time: 3.9298040866851807
Epoch: 5, Steps: 9 | Train Loss: 0.582 Vali Loss: 0.684 Vali Acc: 0.725 Test Loss: 0.684 Test Acc: 0.725
Validation loss decreased (-0.659412 --> -0.724631).  Saving model ...
Epoch: 6 cost time: 3.7636311054229736
Epoch: 6, Steps: 9 | Train Loss: 0.467 Vali Loss: 0.558 Vali Acc: 0.804 Test Loss: 0.558 Test Acc: 0.804
Validation loss decreased (-0.724631 --> -0.804342).  Saving model ...
Epoch: 7 cost time: 3.8000290393829346
Epoch: 7, Steps: 9 | Train Loss: 0.323 Vali Loss: 0.465 Vali Acc: 0.862 Test Loss: 0.465 Test Acc: 0.862
Validation loss decreased (-0.804342 --> -0.862314).  Saving model ...
Epoch: 8 cost time: 4.025510311126709
Epoch: 8, Steps: 9 | Train Loss: 0.237 Vali Loss: 0.460 Vali Acc: 0.848 Test Loss: 0.460 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.912043333053589
Epoch: 9, Steps: 9 | Train Loss: 0.153 Vali Loss: 0.391 Vali Acc: 0.884 Test Loss: 0.391 Test Acc: 0.884
Validation loss decreased (-0.862314 --> -0.884054).  Saving model ...
Epoch: 10 cost time: 3.6455392837524414
Epoch: 10, Steps: 9 | Train Loss: 0.095 Vali Loss: 0.367 Vali Acc: 0.877 Test Loss: 0.367 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.584885597229004
Epoch: 11, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.340 Vali Acc: 0.899 Test Loss: 0.340 Test Acc: 0.899
Validation loss decreased (-0.884054 --> -0.898547).  Saving model ...
Epoch: 12 cost time: 3.856948137283325
Epoch: 12, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.277 Vali Acc: 0.928 Test Loss: 0.277 Test Acc: 0.928
Validation loss decreased (-0.898547 --> -0.927533).  Saving model ...
Epoch: 13 cost time: 4.001608610153198
Epoch: 13, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.312 Vali Acc: 0.906 Test Loss: 0.312 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.7410004138946533
Epoch: 14, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.335 Vali Acc: 0.906 Test Loss: 0.335 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.66367769241333
Epoch: 15, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.302 Vali Acc: 0.920 Test Loss: 0.302 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.7024898529052734
Epoch: 16, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.277 Vali Acc: 0.913 Test Loss: 0.277 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.8938755989074707
Epoch: 17, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.291 Vali Acc: 0.920 Test Loss: 0.291 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.9993064403533936
Epoch: 18, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.284 Vali Acc: 0.928 Test Loss: 0.284 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.353398323059082
Epoch: 19, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.273 Vali Acc: 0.920 Test Loss: 0.273 Test Acc: 0.920
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.373835563659668
Epoch: 20, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.384 Vali Acc: 0.877 Test Loss: 0.384 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.2960333824157715
Epoch: 21, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.589 Vali Acc: 0.855 Test Loss: 0.589 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.337717056274414
Epoch: 22, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.662 Vali Acc: 0.862 Test Loss: 0.662 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.927536231884058
model parameter : 4714980
model size : 18.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.142954111099243
Epoch: 1, Steps: 9 | Train Loss: 1.417 Vali Loss: 1.351 Vali Acc: 0.420 Test Loss: 1.351 Test Acc: 0.420
Validation loss decreased (inf --> -0.420276).  Saving model ...
Epoch: 2 cost time: 2.2186174392700195
Epoch: 2, Steps: 9 | Train Loss: 1.249 Vali Loss: 1.173 Vali Acc: 0.551 Test Loss: 1.173 Test Acc: 0.551
Validation loss decreased (-0.420276 --> -0.550713).  Saving model ...
Epoch: 3 cost time: 2.2045278549194336
Epoch: 3, Steps: 9 | Train Loss: 1.054 Vali Loss: 0.992 Vali Acc: 0.616 Test Loss: 0.992 Test Acc: 0.616
Validation loss decreased (-0.550713 --> -0.615932).  Saving model ...
Epoch: 4 cost time: 2.2177159786224365
Epoch: 4, Steps: 9 | Train Loss: 0.858 Vali Loss: 0.836 Vali Acc: 0.667 Test Loss: 0.836 Test Acc: 0.667
Validation loss decreased (-0.615932 --> -0.666658).  Saving model ...
Epoch: 5 cost time: 2.304744005203247
Epoch: 5, Steps: 9 | Train Loss: 0.657 Vali Loss: 0.679 Vali Acc: 0.746 Test Loss: 0.679 Test Acc: 0.746
Validation loss decreased (-0.666658 --> -0.746370).  Saving model ...
Epoch: 6 cost time: 2.353041887283325
Epoch: 6, Steps: 9 | Train Loss: 0.508 Vali Loss: 0.562 Vali Acc: 0.790 Test Loss: 0.562 Test Acc: 0.790
Validation loss decreased (-0.746370 --> -0.789849).  Saving model ...
Epoch: 7 cost time: 2.4104044437408447
Epoch: 7, Steps: 9 | Train Loss: 0.372 Vali Loss: 0.459 Vali Acc: 0.812 Test Loss: 0.459 Test Acc: 0.812
Validation loss decreased (-0.789849 --> -0.811590).  Saving model ...
Epoch: 8 cost time: 2.4160730838775635
Epoch: 8, Steps: 9 | Train Loss: 0.283 Vali Loss: 0.426 Vali Acc: 0.841 Test Loss: 0.426 Test Acc: 0.841
Validation loss decreased (-0.811590 --> -0.840575).  Saving model ...
Epoch: 9 cost time: 2.4813292026519775
Epoch: 9, Steps: 9 | Train Loss: 0.177 Vali Loss: 0.390 Vali Acc: 0.884 Test Loss: 0.390 Test Acc: 0.884
Validation loss decreased (-0.840575 --> -0.884054).  Saving model ...
Epoch: 10 cost time: 2.3292770385742188
Epoch: 10, Steps: 9 | Train Loss: 0.111 Vali Loss: 0.373 Vali Acc: 0.855 Test Loss: 0.373 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.2267022132873535
Epoch: 11, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.355 Vali Acc: 0.877 Test Loss: 0.355 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.3024306297302246
Epoch: 12, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.550 Vali Acc: 0.790 Test Loss: 0.550 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.3053388595581055
Epoch: 13, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.798 Vali Acc: 0.783 Test Loss: 0.798 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.316760301589966
Epoch: 14, Steps: 9 | Train Loss: 0.108 Vali Loss: 0.485 Vali Acc: 0.841 Test Loss: 0.485 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.365424156188965
Epoch: 15, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.375 Vali Acc: 0.877 Test Loss: 0.375 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.3786115646362305
Epoch: 16, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.354 Vali Acc: 0.899 Test Loss: 0.354 Test Acc: 0.899
Validation loss decreased (-0.884054 --> -0.898547).  Saving model ...
Epoch: 17 cost time: 2.304830551147461
Epoch: 17, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.359 Vali Acc: 0.899 Test Loss: 0.359 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.2288124561309814
Epoch: 18, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.463 Vali Acc: 0.848 Test Loss: 0.463 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.2251038551330566
Epoch: 19, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.459 Vali Acc: 0.833 Test Loss: 0.459 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.184689998626709
Epoch: 20, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.389 Vali Acc: 0.848 Test Loss: 0.389 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.1573753356933594
Epoch: 21, Steps: 9 | Train Loss: 0.040 Vali Loss: 1.224 Vali Acc: 0.725 Test Loss: 1.224 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.248166561126709
Epoch: 22, Steps: 9 | Train Loss: 0.261 Vali Loss: 0.907 Vali Acc: 0.812 Test Loss: 0.907 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.407487154006958
Epoch: 23, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.648 Vali Acc: 0.797 Test Loss: 0.648 Test Acc: 0.797
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.3586459159851074
Epoch: 24, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.411 Vali Acc: 0.906 Test Loss: 0.411 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905793).  Saving model ...
Epoch: 25 cost time: 2.200382709503174
Epoch: 25, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.423 Vali Acc: 0.891 Test Loss: 0.423 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.161155939102173
Epoch: 26, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.371 Vali Acc: 0.891 Test Loss: 0.371 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.181628465652466
Epoch: 27, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.435 Vali Acc: 0.899 Test Loss: 0.435 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.067098379135132
Epoch: 28, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.492 Vali Acc: 0.870 Test Loss: 0.492 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.136298418045044
Epoch: 29, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.482 Vali Acc: 0.884 Test Loss: 0.482 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.096313714981079
Epoch: 30, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.417 Vali Acc: 0.920 Test Loss: 0.417 Test Acc: 0.920
Validation loss decreased (-0.905793 --> -0.920286).  Saving model ...
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 1404644
model size : 5.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 6.978363513946533
Epoch: 1, Steps: 9 | Train Loss: 1.387 Vali Loss: 1.227 Vali Acc: 0.522 Test Loss: 1.227 Test Acc: 0.522
Validation loss decreased (inf --> -0.521727).  Saving model ...
Epoch: 2 cost time: 4.987995386123657
Epoch: 2, Steps: 9 | Train Loss: 1.158 Vali Loss: 1.023 Vali Acc: 0.761 Test Loss: 1.023 Test Acc: 0.761
Validation loss decreased (-0.521727 --> -0.760859).  Saving model ...
Epoch: 3 cost time: 4.952549934387207
Epoch: 3, Steps: 9 | Train Loss: 0.937 Vali Loss: 0.791 Vali Acc: 0.804 Test Loss: 0.791 Test Acc: 0.804
Validation loss decreased (-0.760859 --> -0.804340).  Saving model ...
Epoch: 4 cost time: 5.183651924133301
Epoch: 4, Steps: 9 | Train Loss: 0.650 Vali Loss: 0.585 Vali Acc: 0.812 Test Loss: 0.585 Test Acc: 0.812
Validation loss decreased (-0.804340 --> -0.811588).  Saving model ...
Epoch: 5 cost time: 4.8244218826293945
Epoch: 5, Steps: 9 | Train Loss: 0.474 Vali Loss: 0.455 Vali Acc: 0.833 Test Loss: 0.455 Test Acc: 0.833
Validation loss decreased (-0.811588 --> -0.833329).  Saving model ...
Epoch: 6 cost time: 5.015090227127075
Epoch: 6, Steps: 9 | Train Loss: 0.331 Vali Loss: 0.397 Vali Acc: 0.855 Test Loss: 0.397 Test Acc: 0.855
Validation loss decreased (-0.833329 --> -0.855068).  Saving model ...
Epoch: 7 cost time: 5.071819067001343
Epoch: 7, Steps: 9 | Train Loss: 0.406 Vali Loss: 0.365 Vali Acc: 0.848 Test Loss: 0.365 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.174214124679565
Epoch: 8, Steps: 9 | Train Loss: 0.225 Vali Loss: 0.410 Vali Acc: 0.870 Test Loss: 0.410 Test Acc: 0.870
Validation loss decreased (-0.855068 --> -0.869561).  Saving model ...
Epoch: 9 cost time: 4.802065372467041
Epoch: 9, Steps: 9 | Train Loss: 0.193 Vali Loss: 0.392 Vali Acc: 0.862 Test Loss: 0.392 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.0690953731536865
Epoch: 10, Steps: 9 | Train Loss: 0.122 Vali Loss: 0.437 Vali Acc: 0.841 Test Loss: 0.437 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.069338798522949
Epoch: 11, Steps: 9 | Train Loss: 0.095 Vali Loss: 0.409 Vali Acc: 0.855 Test Loss: 0.409 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.079720973968506
Epoch: 12, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.417 Vali Acc: 0.862 Test Loss: 0.417 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.036365985870361
Epoch: 13, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.485 Vali Acc: 0.862 Test Loss: 0.485 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.136611223220825
Epoch: 14, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.491 Vali Acc: 0.841 Test Loss: 0.491 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.0262978076934814
Epoch: 15, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.479 Vali Acc: 0.841 Test Loss: 0.479 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.157502889633179
Epoch: 16, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.394 Vali Acc: 0.891 Test Loss: 0.394 Test Acc: 0.891
Validation loss decreased (-0.869561 --> -0.891300).  Saving model ...
Epoch: 17 cost time: 4.711580514907837
Epoch: 17, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.418 Vali Acc: 0.884 Test Loss: 0.418 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.698938846588135
Epoch: 18, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.566 Vali Acc: 0.848 Test Loss: 0.566 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.701298236846924
Epoch: 19, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.541 Vali Acc: 0.841 Test Loss: 0.541 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.79962158203125
Epoch: 20, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.478 Vali Acc: 0.870 Test Loss: 0.478 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 5.04669451713562
Epoch: 21, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.504 Vali Acc: 0.826 Test Loss: 0.504 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 5.13502049446106
Epoch: 22, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.436 Vali Acc: 0.862 Test Loss: 0.436 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 5.072187185287476
Epoch: 23, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.415 Vali Acc: 0.877 Test Loss: 0.415 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 5.0110344886779785
Epoch: 24, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.455 Vali Acc: 0.877 Test Loss: 0.455 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 5.0904905796051025
Epoch: 25, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.408 Vali Acc: 0.891 Test Loss: 0.408 Test Acc: 0.891
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 5.06805157661438
Epoch: 26, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.441 Vali Acc: 0.891 Test Loss: 0.441 Test Acc: 0.891
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 2371300
model size : 9.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.782615661621094
Epoch: 1, Steps: 9 | Train Loss: 1.374 Vali Loss: 1.280 Vali Acc: 0.500 Test Loss: 1.280 Test Acc: 0.500
Validation loss decreased (inf --> -0.499987).  Saving model ...
Epoch: 2 cost time: 3.063493251800537
Epoch: 2, Steps: 9 | Train Loss: 1.220 Vali Loss: 1.107 Vali Acc: 0.616 Test Loss: 1.107 Test Acc: 0.616
Validation loss decreased (-0.499987 --> -0.615931).  Saving model ...
Epoch: 3 cost time: 2.983821392059326
Epoch: 3, Steps: 9 | Train Loss: 0.981 Vali Loss: 0.875 Vali Acc: 0.761 Test Loss: 0.875 Test Acc: 0.761
Validation loss decreased (-0.615931 --> -0.760861).  Saving model ...
Epoch: 4 cost time: 3.01850962638855
Epoch: 4, Steps: 9 | Train Loss: 0.734 Vali Loss: 0.638 Vali Acc: 0.797 Test Loss: 0.638 Test Acc: 0.797
Validation loss decreased (-0.760861 --> -0.797095).  Saving model ...
Epoch: 5 cost time: 3.0357484817504883
Epoch: 5, Steps: 9 | Train Loss: 0.498 Vali Loss: 0.478 Vali Acc: 0.833 Test Loss: 0.478 Test Acc: 0.833
Validation loss decreased (-0.797095 --> -0.833329).  Saving model ...
Epoch: 6 cost time: 3.072815418243408
Epoch: 6, Steps: 9 | Train Loss: 0.331 Vali Loss: 0.392 Vali Acc: 0.848 Test Loss: 0.392 Test Acc: 0.848
Validation loss decreased (-0.833329 --> -0.847822).  Saving model ...
Epoch: 7 cost time: 2.981572389602661
Epoch: 7, Steps: 9 | Train Loss: 0.275 Vali Loss: 0.359 Vali Acc: 0.862 Test Loss: 0.359 Test Acc: 0.862
Validation loss decreased (-0.847822 --> -0.862315).  Saving model ...
Epoch: 8 cost time: 3.0758540630340576
Epoch: 8, Steps: 9 | Train Loss: 0.228 Vali Loss: 0.366 Vali Acc: 0.855 Test Loss: 0.366 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.0077152252197266
Epoch: 9, Steps: 9 | Train Loss: 0.157 Vali Loss: 0.398 Vali Acc: 0.833 Test Loss: 0.398 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.96700119972229
Epoch: 10, Steps: 9 | Train Loss: 0.159 Vali Loss: 0.374 Vali Acc: 0.862 Test Loss: 0.374 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.9151737689971924
Epoch: 11, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.339 Vali Acc: 0.877 Test Loss: 0.339 Test Acc: 0.877
Validation loss decreased (-0.862315 --> -0.876808).  Saving model ...
Epoch: 12 cost time: 2.9010238647460938
Epoch: 12, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.402 Vali Acc: 0.848 Test Loss: 0.402 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.9751734733581543
Epoch: 13, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.384 Vali Acc: 0.855 Test Loss: 0.384 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.0885868072509766
Epoch: 14, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.313 Vali Acc: 0.862 Test Loss: 0.313 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.0168302059173584
Epoch: 15, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.297 Vali Acc: 0.884 Test Loss: 0.297 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884055).  Saving model ...
Epoch: 16 cost time: 3.085850954055786
Epoch: 16, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.356 Vali Acc: 0.884 Test Loss: 0.356 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.024954080581665
Epoch: 17, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.321 Vali Acc: 0.891 Test Loss: 0.321 Test Acc: 0.891
Validation loss decreased (-0.884055 --> -0.891301).  Saving model ...
Epoch: 18 cost time: 3.12809681892395
Epoch: 18, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.295 Vali Acc: 0.877 Test Loss: 0.295 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.978534460067749
Epoch: 19, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.314 Vali Acc: 0.891 Test Loss: 0.314 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 20 cost time: 2.8964388370513916
Epoch: 20, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.326 Vali Acc: 0.877 Test Loss: 0.326 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.98591947555542
Epoch: 21, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.291 Vali Acc: 0.906 Test Loss: 0.291 Test Acc: 0.906
Validation loss decreased (-0.891301 --> -0.905794).  Saving model ...
Epoch: 22 cost time: 2.9667608737945557
Epoch: 22, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.309 Vali Acc: 0.906 Test Loss: 0.309 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.915339469909668
Epoch: 23, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.338 Vali Acc: 0.891 Test Loss: 0.338 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.972172498703003
Epoch: 24, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.333 Vali Acc: 0.899 Test Loss: 0.333 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.0808913707733154
Epoch: 25, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.300 Vali Acc: 0.899 Test Loss: 0.300 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.814711093902588
Epoch: 26, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.292 Vali Acc: 0.899 Test Loss: 0.292 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.0123050212860107
Epoch: 27, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.314 Vali Acc: 0.899 Test Loss: 0.314 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.998037815093994
Epoch: 28, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.333 Vali Acc: 0.891 Test Loss: 0.333 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.084872245788574
Epoch: 29, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.325 Vali Acc: 0.891 Test Loss: 0.325 Test Acc: 0.891
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.945070266723633
Epoch: 30, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.305 Vali Acc: 0.891 Test Loss: 0.305 Test Acc: 0.891
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 716004
model size : 3.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.49085259437561
Epoch: 1, Steps: 9 | Train Loss: 1.394 Vali Loss: 1.230 Vali Acc: 0.543 Test Loss: 1.230 Test Acc: 0.543
Validation loss decreased (inf --> -0.543466).  Saving model ...
Epoch: 2 cost time: 3.6734695434570312
Epoch: 2, Steps: 9 | Train Loss: 1.182 Vali Loss: 1.041 Vali Acc: 0.717 Test Loss: 1.041 Test Acc: 0.717
Validation loss decreased (-0.543466 --> -0.717381).  Saving model ...
Epoch: 3 cost time: 3.63389253616333
Epoch: 3, Steps: 9 | Train Loss: 0.995 Vali Loss: 0.854 Vali Acc: 0.746 Test Loss: 0.854 Test Acc: 0.746
Validation loss decreased (-0.717381 --> -0.746368).  Saving model ...
Epoch: 4 cost time: 3.660228729248047
Epoch: 4, Steps: 9 | Train Loss: 0.731 Vali Loss: 0.677 Vali Acc: 0.768 Test Loss: 0.677 Test Acc: 0.768
Validation loss decreased (-0.746368 --> -0.768109).  Saving model ...
Epoch: 5 cost time: 3.664966583251953
Epoch: 5, Steps: 9 | Train Loss: 0.574 Vali Loss: 0.549 Vali Acc: 0.783 Test Loss: 0.549 Test Acc: 0.783
Validation loss decreased (-0.768109 --> -0.782603).  Saving model ...
Epoch: 6 cost time: 3.602367877960205
Epoch: 6, Steps: 9 | Train Loss: 0.430 Vali Loss: 0.454 Vali Acc: 0.833 Test Loss: 0.454 Test Acc: 0.833
Validation loss decreased (-0.782603 --> -0.833329).  Saving model ...
Epoch: 7 cost time: 3.7712676525115967
Epoch: 7, Steps: 9 | Train Loss: 0.319 Vali Loss: 0.461 Vali Acc: 0.826 Test Loss: 0.461 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.739271879196167
Epoch: 8, Steps: 9 | Train Loss: 0.240 Vali Loss: 0.548 Vali Acc: 0.833 Test Loss: 0.548 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.642808675765991
Epoch: 9, Steps: 9 | Train Loss: 0.196 Vali Loss: 0.580 Vali Acc: 0.804 Test Loss: 0.580 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.6451127529144287
Epoch: 10, Steps: 9 | Train Loss: 0.139 Vali Loss: 0.640 Vali Acc: 0.797 Test Loss: 0.640 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.5863046646118164
Epoch: 11, Steps: 9 | Train Loss: 0.175 Vali Loss: 0.659 Vali Acc: 0.826 Test Loss: 0.659 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.6179862022399902
Epoch: 12, Steps: 9 | Train Loss: 0.168 Vali Loss: 0.417 Vali Acc: 0.870 Test Loss: 0.417 Test Acc: 0.870
Validation loss decreased (-0.833329 --> -0.869561).  Saving model ...
Epoch: 13 cost time: 3.8681044578552246
Epoch: 13, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.448 Vali Acc: 0.848 Test Loss: 0.448 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.820415735244751
Epoch: 14, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.424 Vali Acc: 0.862 Test Loss: 0.424 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.7426304817199707
Epoch: 15, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.428 Vali Acc: 0.870 Test Loss: 0.428 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.6719179153442383
Epoch: 16, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.383 Vali Acc: 0.884 Test Loss: 0.383 Test Acc: 0.884
Validation loss decreased (-0.869561 --> -0.884054).  Saving model ...
Epoch: 17 cost time: 3.68306040763855
Epoch: 17, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.396 Vali Acc: 0.877 Test Loss: 0.396 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.582293748855591
Epoch: 18, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.459 Vali Acc: 0.862 Test Loss: 0.459 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.439828634262085
Epoch: 19, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.460 Vali Acc: 0.862 Test Loss: 0.460 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.035650968551636
Epoch: 20, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.465 Vali Acc: 0.862 Test Loss: 0.465 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.7108449935913086
Epoch: 21, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.460 Vali Acc: 0.862 Test Loss: 0.460 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.8683502674102783
Epoch: 22, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.446 Vali Acc: 0.870 Test Loss: 0.446 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.769329309463501
Epoch: 23, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.479 Vali Acc: 0.877 Test Loss: 0.479 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.9414730072021484
Epoch: 24, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.450 Vali Acc: 0.877 Test Loss: 0.450 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.7062318325042725
Epoch: 25, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.455 Vali Acc: 0.884 Test Loss: 0.455 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.7534618377685547
Epoch: 26, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.475 Vali Acc: 0.899 Test Loss: 0.475 Test Acc: 0.899
Validation loss decreased (-0.884054 --> -0.898546).  Saving model ...
Epoch: 27 cost time: 3.5578129291534424
Epoch: 27, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.461 Vali Acc: 0.884 Test Loss: 0.461 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.7514805793762207
Epoch: 28, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.503 Vali Acc: 0.870 Test Loss: 0.503 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.6341350078582764
Epoch: 29, Steps: 9 | Train Loss: 0.297 Vali Loss: 0.529 Vali Acc: 0.862 Test Loss: 0.529 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.7770907878875732
Epoch: 30, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.495 Vali Acc: 0.884 Test Loss: 0.495 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 2371300
model size : 9.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.197938919067383
Epoch: 1, Steps: 9 | Train Loss: 1.369 Vali Loss: 1.275 Vali Acc: 0.500 Test Loss: 1.275 Test Acc: 0.500
Validation loss decreased (inf --> -0.499987).  Saving model ...
Epoch: 2 cost time: 2.360846996307373
Epoch: 2, Steps: 9 | Train Loss: 1.223 Vali Loss: 1.114 Vali Acc: 0.623 Test Loss: 1.114 Test Acc: 0.623
Validation loss decreased (-0.499987 --> -0.623177).  Saving model ...
Epoch: 3 cost time: 2.3237314224243164
Epoch: 3, Steps: 9 | Train Loss: 1.001 Vali Loss: 0.910 Vali Acc: 0.725 Test Loss: 0.910 Test Acc: 0.725
Validation loss decreased (-0.623177 --> -0.724629).  Saving model ...
Epoch: 4 cost time: 2.447178840637207
Epoch: 4, Steps: 9 | Train Loss: 0.801 Vali Loss: 0.715 Vali Acc: 0.783 Test Loss: 0.715 Test Acc: 0.783
Validation loss decreased (-0.724629 --> -0.782602).  Saving model ...
Epoch: 5 cost time: 2.4747471809387207
Epoch: 5, Steps: 9 | Train Loss: 0.577 Vali Loss: 0.547 Vali Acc: 0.826 Test Loss: 0.547 Test Acc: 0.826
Validation loss decreased (-0.782602 --> -0.826081).  Saving model ...
Epoch: 6 cost time: 2.5527307987213135
Epoch: 6, Steps: 9 | Train Loss: 0.428 Vali Loss: 0.423 Vali Acc: 0.855 Test Loss: 0.423 Test Acc: 0.855
Validation loss decreased (-0.826081 --> -0.855068).  Saving model ...
Epoch: 7 cost time: 2.5398707389831543
Epoch: 7, Steps: 9 | Train Loss: 0.304 Vali Loss: 0.417 Vali Acc: 0.826 Test Loss: 0.417 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.498684883117676
Epoch: 8, Steps: 9 | Train Loss: 0.279 Vali Loss: 0.391 Vali Acc: 0.819 Test Loss: 0.391 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.4846856594085693
Epoch: 9, Steps: 9 | Train Loss: 0.156 Vali Loss: 0.397 Vali Acc: 0.819 Test Loss: 0.397 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.4098050594329834
Epoch: 10, Steps: 9 | Train Loss: 0.162 Vali Loss: 0.358 Vali Acc: 0.841 Test Loss: 0.358 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.349670648574829
Epoch: 11, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.317 Vali Acc: 0.884 Test Loss: 0.317 Test Acc: 0.884
Validation loss decreased (-0.855068 --> -0.884055).  Saving model ...
Epoch: 12 cost time: 2.4048383235931396
Epoch: 12, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.355 Vali Acc: 0.848 Test Loss: 0.355 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.304734706878662
Epoch: 13, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.341 Vali Acc: 0.855 Test Loss: 0.341 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.4243791103363037
Epoch: 14, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.300 Vali Acc: 0.884 Test Loss: 0.300 Test Acc: 0.884
Validation loss decreased (-0.884055 --> -0.884055).  Saving model ...
Epoch: 15 cost time: 2.602890968322754
Epoch: 15, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.303 Vali Acc: 0.877 Test Loss: 0.303 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.3804898262023926
Epoch: 16, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.330 Vali Acc: 0.877 Test Loss: 0.330 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.0284924507141113
Epoch: 17, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.320 Vali Acc: 0.870 Test Loss: 0.320 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.547159194946289
Epoch: 18, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.299 Vali Acc: 0.891 Test Loss: 0.299 Test Acc: 0.891
Validation loss decreased (-0.884055 --> -0.891301).  Saving model ...
Epoch: 19 cost time: 2.4350669384002686
Epoch: 19, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.306 Vali Acc: 0.877 Test Loss: 0.306 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.5463593006134033
Epoch: 20, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.296 Vali Acc: 0.891 Test Loss: 0.296 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 21 cost time: 2.6169509887695312
Epoch: 21, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.289 Vali Acc: 0.906 Test Loss: 0.289 Test Acc: 0.906
Validation loss decreased (-0.891301 --> -0.905794).  Saving model ...
Epoch: 22 cost time: 2.5485827922821045
Epoch: 22, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.320 Vali Acc: 0.891 Test Loss: 0.320 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.495666265487671
Epoch: 23, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.345 Vali Acc: 0.899 Test Loss: 0.345 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.471696138381958
Epoch: 24, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.333 Vali Acc: 0.891 Test Loss: 0.333 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.4846928119659424
Epoch: 25, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.313 Vali Acc: 0.891 Test Loss: 0.313 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.556556224822998
Epoch: 26, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.339 Vali Acc: 0.877 Test Loss: 0.339 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.3844830989837646
Epoch: 27, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.379 Vali Acc: 0.862 Test Loss: 0.379 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.435678720474243
Epoch: 28, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.304 Vali Acc: 0.899 Test Loss: 0.304 Test Acc: 0.899
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.5333800315856934
Epoch: 29, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.282 Vali Acc: 0.913 Test Loss: 0.282 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913041).  Saving model ...
Epoch: 30 cost time: 2.4632163047790527
Epoch: 30, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.314 Vali Acc: 0.906 Test Loss: 0.314 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 716004
model size : 3.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.633455038070679
Epoch: 1, Steps: 9 | Train Loss: 1.398 Vali Loss: 1.242 Vali Acc: 0.514 Test Loss: 1.242 Test Acc: 0.514
Validation loss decreased (inf --> -0.514480).  Saving model ...
Epoch: 2 cost time: 2.738032817840576
Epoch: 2, Steps: 9 | Train Loss: 1.192 Vali Loss: 1.096 Vali Acc: 0.645 Test Loss: 1.096 Test Acc: 0.645
Validation loss decreased (-0.514480 --> -0.644917).  Saving model ...
Epoch: 3 cost time: 2.6857032775878906
Epoch: 3, Steps: 9 | Train Loss: 1.024 Vali Loss: 0.961 Vali Acc: 0.667 Test Loss: 0.961 Test Acc: 0.667
Validation loss decreased (-0.644917 --> -0.666657).  Saving model ...
Epoch: 4 cost time: 2.705739736557007
Epoch: 4, Steps: 9 | Train Loss: 0.797 Vali Loss: 0.854 Vali Acc: 0.681 Test Loss: 0.854 Test Acc: 0.681
Validation loss decreased (-0.666657 --> -0.681151).  Saving model ...
Epoch: 5 cost time: 2.6108646392822266
Epoch: 5, Steps: 9 | Train Loss: 0.676 Vali Loss: 0.708 Vali Acc: 0.761 Test Loss: 0.708 Test Acc: 0.761
Validation loss decreased (-0.681151 --> -0.760862).  Saving model ...
Epoch: 6 cost time: 2.675126314163208
Epoch: 6, Steps: 9 | Train Loss: 0.499 Vali Loss: 0.567 Vali Acc: 0.848 Test Loss: 0.567 Test Acc: 0.848
Validation loss decreased (-0.760862 --> -0.847820).  Saving model ...
Epoch: 7 cost time: 2.6984691619873047
Epoch: 7, Steps: 9 | Train Loss: 0.422 Vali Loss: 0.487 Vali Acc: 0.848 Test Loss: 0.487 Test Acc: 0.848
Validation loss decreased (-0.847820 --> -0.847821).  Saving model ...
Epoch: 8 cost time: 2.7341134548187256
Epoch: 8, Steps: 9 | Train Loss: 0.328 Vali Loss: 0.538 Vali Acc: 0.812 Test Loss: 0.538 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.861293315887451
Epoch: 9, Steps: 9 | Train Loss: 0.247 Vali Loss: 0.481 Vali Acc: 0.812 Test Loss: 0.481 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.952849864959717
Epoch: 10, Steps: 9 | Train Loss: 0.154 Vali Loss: 0.508 Vali Acc: 0.819 Test Loss: 0.508 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.837378740310669
Epoch: 11, Steps: 9 | Train Loss: 0.118 Vali Loss: 0.464 Vali Acc: 0.812 Test Loss: 0.464 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.7554590702056885
Epoch: 12, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.469 Vali Acc: 0.812 Test Loss: 0.469 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.8653082847595215
Epoch: 13, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.538 Vali Acc: 0.826 Test Loss: 0.538 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.871086359024048
Epoch: 14, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.452 Vali Acc: 0.819 Test Loss: 0.452 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.7856836318969727
Epoch: 15, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.640 Vali Acc: 0.746 Test Loss: 0.640 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.887641429901123
Epoch: 16, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.845 Vali Acc: 0.717 Test Loss: 0.845 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.8146286010742188
Epoch: 17, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.895 Vali Acc: 0.703 Test Loss: 0.895 Test Acc: 0.703
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 2371300
model size : 9.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.870547294616699
Epoch: 1, Steps: 9 | Train Loss: 1.370 Vali Loss: 1.276 Vali Acc: 0.500 Test Loss: 1.276 Test Acc: 0.500
Validation loss decreased (inf --> -0.499987).  Saving model ...
Epoch: 2 cost time: 2.0827817916870117
Epoch: 2, Steps: 9 | Train Loss: 1.239 Vali Loss: 1.146 Vali Acc: 0.580 Test Loss: 1.146 Test Acc: 0.580
Validation loss decreased (-0.499987 --> -0.579699).  Saving model ...
Epoch: 3 cost time: 1.946439504623413
Epoch: 3, Steps: 9 | Train Loss: 1.036 Vali Loss: 1.004 Vali Acc: 0.630 Test Loss: 1.004 Test Acc: 0.630
Validation loss decreased (-0.579699 --> -0.630425).  Saving model ...
Epoch: 4 cost time: 1.9471650123596191
Epoch: 4, Steps: 9 | Train Loss: 0.855 Vali Loss: 0.860 Vali Acc: 0.681 Test Loss: 0.860 Test Acc: 0.681
Validation loss decreased (-0.630425 --> -0.681151).  Saving model ...
Epoch: 5 cost time: 2.037590742111206
Epoch: 5, Steps: 9 | Train Loss: 0.634 Vali Loss: 0.726 Vali Acc: 0.725 Test Loss: 0.726 Test Acc: 0.725
Validation loss decreased (-0.681151 --> -0.724630).  Saving model ...
Epoch: 6 cost time: 1.8709709644317627
Epoch: 6, Steps: 9 | Train Loss: 0.511 Vali Loss: 0.584 Vali Acc: 0.761 Test Loss: 0.584 Test Acc: 0.761
Validation loss decreased (-0.724630 --> -0.760864).  Saving model ...
Epoch: 7 cost time: 1.9394252300262451
Epoch: 7, Steps: 9 | Train Loss: 0.387 Vali Loss: 0.473 Vali Acc: 0.804 Test Loss: 0.473 Test Acc: 0.804
Validation loss decreased (-0.760864 --> -0.804343).  Saving model ...
Epoch: 8 cost time: 1.8689062595367432
Epoch: 8, Steps: 9 | Train Loss: 0.291 Vali Loss: 0.436 Vali Acc: 0.826 Test Loss: 0.436 Test Acc: 0.826
Validation loss decreased (-0.804343 --> -0.826083).  Saving model ...
Epoch: 9 cost time: 1.921154260635376
Epoch: 9, Steps: 9 | Train Loss: 0.193 Vali Loss: 0.405 Vali Acc: 0.833 Test Loss: 0.405 Test Acc: 0.833
Validation loss decreased (-0.826083 --> -0.833329).  Saving model ...
Epoch: 10 cost time: 1.8281958103179932
Epoch: 10, Steps: 9 | Train Loss: 0.133 Vali Loss: 0.364 Vali Acc: 0.848 Test Loss: 0.364 Test Acc: 0.848
Validation loss decreased (-0.833329 --> -0.847822).  Saving model ...
Epoch: 11 cost time: 1.791025161743164
Epoch: 11, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.400 Vali Acc: 0.855 Test Loss: 0.400 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855068).  Saving model ...
Epoch: 12 cost time: 1.835892915725708
Epoch: 12, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.413 Vali Acc: 0.833 Test Loss: 0.413 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.874675989151001
Epoch: 13, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.355 Vali Acc: 0.862 Test Loss: 0.355 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862315).  Saving model ...
Epoch: 14 cost time: 1.9684429168701172
Epoch: 14, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.322 Vali Acc: 0.870 Test Loss: 0.322 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869562).  Saving model ...
Epoch: 15 cost time: 1.8516860008239746
Epoch: 15, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.336 Vali Acc: 0.870 Test Loss: 0.336 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.030910015106201
Epoch: 16, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.324 Vali Acc: 0.877 Test Loss: 0.324 Test Acc: 0.877
Validation loss decreased (-0.869562 --> -0.876808).  Saving model ...
Epoch: 17 cost time: 1.896639108657837
Epoch: 17, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.330 Vali Acc: 0.877 Test Loss: 0.330 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8966443538665771
Epoch: 18, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.329 Vali Acc: 0.877 Test Loss: 0.329 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.9029467105865479
Epoch: 19, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.336 Vali Acc: 0.877 Test Loss: 0.336 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.8774986267089844
Epoch: 20, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.321 Vali Acc: 0.884 Test Loss: 0.321 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884055).  Saving model ...
Epoch: 21 cost time: 1.8155755996704102
Epoch: 21, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.317 Vali Acc: 0.891 Test Loss: 0.317 Test Acc: 0.891
Validation loss decreased (-0.884055 --> -0.891301).  Saving model ...
Epoch: 22 cost time: 1.9185068607330322
Epoch: 22, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.324 Vali Acc: 0.891 Test Loss: 0.324 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.868298053741455
Epoch: 23, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.410 Vali Acc: 0.855 Test Loss: 0.410 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.942920446395874
Epoch: 24, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.499 Vali Acc: 0.848 Test Loss: 0.499 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.9747803211212158
Epoch: 25, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.353 Vali Acc: 0.891 Test Loss: 0.353 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.967817783355713
Epoch: 26, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.300 Vali Acc: 0.899 Test Loss: 0.300 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898548).  Saving model ...
Epoch: 27 cost time: 1.9101321697235107
Epoch: 27, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.304 Vali Acc: 0.906 Test Loss: 0.304 Test Acc: 0.906
Validation loss decreased (-0.898548 --> -0.905794).  Saving model ...
Epoch: 28 cost time: 1.871652364730835
Epoch: 28, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.313 Vali Acc: 0.884 Test Loss: 0.313 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.9366590976715088
Epoch: 29, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.369 Vali Acc: 0.877 Test Loss: 0.369 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.783351182937622
Epoch: 30, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.373 Vali Acc: 0.870 Test Loss: 0.373 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 716004
model size : 3.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 7.694788694381714
Epoch: 1, Steps: 9 | Train Loss: 1.465 Vali Loss: 1.434 Vali Acc: 0.210 Test Loss: 1.434 Test Acc: 0.210
Validation loss decreased (inf --> -0.210131).  Saving model ...
Epoch: 2 cost time: 5.867562770843506
Epoch: 2, Steps: 9 | Train Loss: 1.362 Vali Loss: 1.293 Vali Acc: 0.348 Test Loss: 1.293 Test Acc: 0.348
Validation loss decreased (-0.210131 --> -0.347813).  Saving model ...
Epoch: 3 cost time: 5.965752840042114
Epoch: 3, Steps: 9 | Train Loss: 1.148 Vali Loss: 1.116 Vali Acc: 0.536 Test Loss: 1.116 Test Acc: 0.536
Validation loss decreased (-0.347813 --> -0.536221).  Saving model ...
Epoch: 4 cost time: 6.004539251327515
Epoch: 4, Steps: 9 | Train Loss: 0.981 Vali Loss: 0.953 Vali Acc: 0.572 Test Loss: 0.953 Test Acc: 0.572
Validation loss decreased (-0.536221 --> -0.572454).  Saving model ...
Epoch: 5 cost time: 6.067509174346924
Epoch: 5, Steps: 9 | Train Loss: 0.819 Vali Loss: 0.768 Vali Acc: 0.717 Test Loss: 0.768 Test Acc: 0.717
Validation loss decreased (-0.572454 --> -0.717384).  Saving model ...
Epoch: 6 cost time: 5.968477487564087
Epoch: 6, Steps: 9 | Train Loss: 0.627 Vali Loss: 0.632 Vali Acc: 0.783 Test Loss: 0.632 Test Acc: 0.783
Validation loss decreased (-0.717384 --> -0.782602).  Saving model ...
Epoch: 7 cost time: 5.91304087638855
Epoch: 7, Steps: 9 | Train Loss: 0.513 Vali Loss: 0.577 Vali Acc: 0.783 Test Loss: 0.577 Test Acc: 0.783
Validation loss decreased (-0.782602 --> -0.782603).  Saving model ...
Epoch: 8 cost time: 5.968149900436401
Epoch: 8, Steps: 9 | Train Loss: 0.605 Vali Loss: 0.484 Vali Acc: 0.812 Test Loss: 0.484 Test Acc: 0.812
Validation loss decreased (-0.782603 --> -0.811589).  Saving model ...
Epoch: 9 cost time: 5.939688444137573
Epoch: 9, Steps: 9 | Train Loss: 0.285 Vali Loss: 0.455 Vali Acc: 0.833 Test Loss: 0.455 Test Acc: 0.833
Validation loss decreased (-0.811589 --> -0.833329).  Saving model ...
Epoch: 10 cost time: 5.949930429458618
Epoch: 10, Steps: 9 | Train Loss: 0.270 Vali Loss: 0.464 Vali Acc: 0.790 Test Loss: 0.464 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.735737323760986
Epoch: 11, Steps: 9 | Train Loss: 0.230 Vali Loss: 0.497 Vali Acc: 0.812 Test Loss: 0.497 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.848110198974609
Epoch: 12, Steps: 9 | Train Loss: 0.192 Vali Loss: 0.461 Vali Acc: 0.819 Test Loss: 0.461 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.943603754043579
Epoch: 13, Steps: 9 | Train Loss: 0.122 Vali Loss: 0.323 Vali Acc: 0.877 Test Loss: 0.323 Test Acc: 0.877
Validation loss decreased (-0.833329 --> -0.876808).  Saving model ...
Epoch: 14 cost time: 5.9137139320373535
Epoch: 14, Steps: 9 | Train Loss: 0.095 Vali Loss: 0.329 Vali Acc: 0.906 Test Loss: 0.329 Test Acc: 0.906
Validation loss decreased (-0.876808 --> -0.905794).  Saving model ...
Epoch: 15 cost time: 6.018397569656372
Epoch: 15, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.340 Vali Acc: 0.899 Test Loss: 0.340 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.131998538970947
Epoch: 16, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.371 Vali Acc: 0.899 Test Loss: 0.371 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.054530620574951
Epoch: 17, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.337 Vali Acc: 0.906 Test Loss: 0.337 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 6.015971899032593
Epoch: 18, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.275 Vali Acc: 0.913 Test Loss: 0.275 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913041).  Saving model ...
Epoch: 19 cost time: 5.9155426025390625
Epoch: 19, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.330 Vali Acc: 0.906 Test Loss: 0.330 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.931328535079956
Epoch: 20, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.388 Vali Acc: 0.891 Test Loss: 0.388 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.995392799377441
Epoch: 21, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.312 Vali Acc: 0.906 Test Loss: 0.312 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 5.93153715133667
Epoch: 22, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.379 Vali Acc: 0.891 Test Loss: 0.379 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 5.693259954452515
Epoch: 23, Steps: 9 | Train Loss: 0.113 Vali Loss: 0.280 Vali Acc: 0.913 Test Loss: 0.280 Test Acc: 0.913
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 5.691772699356079
Epoch: 24, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.404 Vali Acc: 0.870 Test Loss: 0.404 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 6.0336503982543945
Epoch: 25, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.404 Vali Acc: 0.884 Test Loss: 0.404 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 6.0958287715911865
Epoch: 26, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.356 Vali Acc: 0.899 Test Loss: 0.356 Test Acc: 0.899
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 6.142604351043701
Epoch: 27, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.416 Vali Acc: 0.884 Test Loss: 0.416 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 6.137917995452881
Epoch: 28, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.489 Vali Acc: 0.884 Test Loss: 0.489 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 2358260
model size : 9.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.921034097671509
Epoch: 1, Steps: 9 | Train Loss: 1.388 Vali Loss: 1.264 Vali Acc: 0.435 Test Loss: 1.264 Test Acc: 0.435
Validation loss decreased (inf --> -0.434770).  Saving model ...
Epoch: 2 cost time: 3.7075886726379395
Epoch: 2, Steps: 9 | Train Loss: 1.263 Vali Loss: 1.121 Vali Acc: 0.587 Test Loss: 1.121 Test Acc: 0.587
Validation loss decreased (-0.434770 --> -0.586945).  Saving model ...
Epoch: 3 cost time: 3.6367602348327637
Epoch: 3, Steps: 9 | Train Loss: 1.098 Vali Loss: 0.958 Vali Acc: 0.688 Test Loss: 0.958 Test Acc: 0.688
Validation loss decreased (-0.586945 --> -0.688396).  Saving model ...
Epoch: 4 cost time: 3.6278035640716553
Epoch: 4, Steps: 9 | Train Loss: 0.883 Vali Loss: 0.823 Vali Acc: 0.703 Test Loss: 0.823 Test Acc: 0.703
Validation loss decreased (-0.688396 --> -0.702890).  Saving model ...
Epoch: 5 cost time: 3.634873390197754
Epoch: 5, Steps: 9 | Train Loss: 0.740 Vali Loss: 0.665 Vali Acc: 0.761 Test Loss: 0.665 Test Acc: 0.761
Validation loss decreased (-0.702890 --> -0.760863).  Saving model ...
Epoch: 6 cost time: 3.521970748901367
Epoch: 6, Steps: 9 | Train Loss: 0.567 Vali Loss: 0.549 Vali Acc: 0.804 Test Loss: 0.549 Test Acc: 0.804
Validation loss decreased (-0.760863 --> -0.804342).  Saving model ...
Epoch: 7 cost time: 3.6491270065307617
Epoch: 7, Steps: 9 | Train Loss: 0.475 Vali Loss: 0.470 Vali Acc: 0.790 Test Loss: 0.470 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.5883307456970215
Epoch: 8, Steps: 9 | Train Loss: 0.325 Vali Loss: 0.443 Vali Acc: 0.819 Test Loss: 0.443 Test Acc: 0.819
Validation loss decreased (-0.804342 --> -0.818836).  Saving model ...
Epoch: 9 cost time: 3.5161170959472656
Epoch: 9, Steps: 9 | Train Loss: 0.315 Vali Loss: 0.412 Vali Acc: 0.877 Test Loss: 0.412 Test Acc: 0.877
Validation loss decreased (-0.818836 --> -0.876807).  Saving model ...
Epoch: 10 cost time: 3.5775039196014404
Epoch: 10, Steps: 9 | Train Loss: 0.223 Vali Loss: 0.355 Vali Acc: 0.884 Test Loss: 0.355 Test Acc: 0.884
Validation loss decreased (-0.876807 --> -0.884054).  Saving model ...
Epoch: 11 cost time: 3.1933631896972656
Epoch: 11, Steps: 9 | Train Loss: 0.206 Vali Loss: 0.357 Vali Acc: 0.877 Test Loss: 0.357 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.3654026985168457
Epoch: 12, Steps: 9 | Train Loss: 0.136 Vali Loss: 0.363 Vali Acc: 0.884 Test Loss: 0.363 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.4656264781951904
Epoch: 13, Steps: 9 | Train Loss: 0.108 Vali Loss: 0.326 Vali Acc: 0.891 Test Loss: 0.326 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891301).  Saving model ...
Epoch: 14 cost time: 3.5276925563812256
Epoch: 14, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.301 Vali Acc: 0.891 Test Loss: 0.301 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 15 cost time: 3.645092248916626
Epoch: 15, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.312 Vali Acc: 0.891 Test Loss: 0.312 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.580368995666504
Epoch: 16, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.353 Vali Acc: 0.906 Test Loss: 0.353 Test Acc: 0.906
Validation loss decreased (-0.891301 --> -0.905794).  Saving model ...
Epoch: 17 cost time: 3.642828941345215
Epoch: 17, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.343 Vali Acc: 0.913 Test Loss: 0.343 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913040).  Saving model ...
Epoch: 18 cost time: 3.5596725940704346
Epoch: 18, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.327 Vali Acc: 0.913 Test Loss: 0.327 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913040).  Saving model ...
Epoch: 19 cost time: 3.4998247623443604
Epoch: 19, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.335 Vali Acc: 0.913 Test Loss: 0.335 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.5334720611572266
Epoch: 20, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.321 Vali Acc: 0.899 Test Loss: 0.321 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.650775194168091
Epoch: 21, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.288 Vali Acc: 0.913 Test Loss: 0.288 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913041).  Saving model ...
Epoch: 22 cost time: 3.601937770843506
Epoch: 22, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.292 Vali Acc: 0.920 Test Loss: 0.292 Test Acc: 0.920
Validation loss decreased (-0.913041 --> -0.920287).  Saving model ...
Epoch: 23 cost time: 3.650026798248291
Epoch: 23, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.314 Vali Acc: 0.913 Test Loss: 0.314 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.5472493171691895
Epoch: 24, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.315 Vali Acc: 0.906 Test Loss: 0.315 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.5550575256347656
Epoch: 25, Steps: 9 | Train Loss: 0.108 Vali Loss: 0.266 Vali Acc: 0.935 Test Loss: 0.266 Test Acc: 0.935
Validation loss decreased (-0.920287 --> -0.934780).  Saving model ...
Epoch: 26 cost time: 3.6309006214141846
Epoch: 26, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.226 Vali Acc: 0.935 Test Loss: 0.226 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 27 cost time: 3.778107166290283
Epoch: 27, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.256 Vali Acc: 0.928 Test Loss: 0.256 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.6198906898498535
Epoch: 28, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.299 Vali Acc: 0.913 Test Loss: 0.299 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.6527185440063477
Epoch: 29, Steps: 9 | Train Loss: 0.187 Vali Loss: 0.309 Vali Acc: 0.935 Test Loss: 0.309 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.43748140335083
Epoch: 30, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.356 Vali Acc: 0.906 Test Loss: 0.356 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9347826086956522
model parameter : 702836
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 6.610016345977783
Epoch: 1, Steps: 9 | Train Loss: 1.465 Vali Loss: 1.440 Vali Acc: 0.181 Test Loss: 1.440 Test Acc: 0.181
Validation loss decreased (inf --> -0.181145).  Saving model ...
Epoch: 2 cost time: 4.717983722686768
Epoch: 2, Steps: 9 | Train Loss: 1.376 Vali Loss: 1.310 Vali Acc: 0.341 Test Loss: 1.310 Test Acc: 0.341
Validation loss decreased (-0.181145 --> -0.340567).  Saving model ...
Epoch: 3 cost time: 4.746342420578003
Epoch: 3, Steps: 9 | Train Loss: 1.189 Vali Loss: 1.157 Vali Acc: 0.507 Test Loss: 1.157 Test Acc: 0.507
Validation loss decreased (-0.340567 --> -0.507235).  Saving model ...
Epoch: 4 cost time: 4.615018844604492
Epoch: 4, Steps: 9 | Train Loss: 1.049 Vali Loss: 1.014 Vali Acc: 0.543 Test Loss: 1.014 Test Acc: 0.543
Validation loss decreased (-0.507235 --> -0.543468).  Saving model ...
Epoch: 5 cost time: 4.776094198226929
Epoch: 5, Steps: 9 | Train Loss: 0.889 Vali Loss: 0.840 Vali Acc: 0.681 Test Loss: 0.840 Test Acc: 0.681
Validation loss decreased (-0.543468 --> -0.681151).  Saving model ...
Epoch: 6 cost time: 4.6671037673950195
Epoch: 6, Steps: 9 | Train Loss: 0.715 Vali Loss: 0.719 Vali Acc: 0.739 Test Loss: 0.719 Test Acc: 0.739
Validation loss decreased (-0.681151 --> -0.739123).  Saving model ...
Epoch: 7 cost time: 4.537516117095947
Epoch: 7, Steps: 9 | Train Loss: 0.612 Vali Loss: 0.658 Vali Acc: 0.717 Test Loss: 0.658 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.778190612792969
Epoch: 8, Steps: 9 | Train Loss: 0.630 Vali Loss: 0.549 Vali Acc: 0.797 Test Loss: 0.549 Test Acc: 0.797
Validation loss decreased (-0.739123 --> -0.797096).  Saving model ...
Epoch: 9 cost time: 4.748234033584595
Epoch: 9, Steps: 9 | Train Loss: 0.371 Vali Loss: 0.514 Vali Acc: 0.812 Test Loss: 0.514 Test Acc: 0.812
Validation loss decreased (-0.797096 --> -0.811589).  Saving model ...
Epoch: 10 cost time: 4.825964689254761
Epoch: 10, Steps: 9 | Train Loss: 0.334 Vali Loss: 0.473 Vali Acc: 0.819 Test Loss: 0.473 Test Acc: 0.819
Validation loss decreased (-0.811589 --> -0.818836).  Saving model ...
Epoch: 11 cost time: 4.807451248168945
Epoch: 11, Steps: 9 | Train Loss: 0.313 Vali Loss: 0.500 Vali Acc: 0.790 Test Loss: 0.500 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.757627248764038
Epoch: 12, Steps: 9 | Train Loss: 0.221 Vali Loss: 0.418 Vali Acc: 0.855 Test Loss: 0.418 Test Acc: 0.855
Validation loss decreased (-0.818836 --> -0.855068).  Saving model ...
Epoch: 13 cost time: 4.6131720542907715
Epoch: 13, Steps: 9 | Train Loss: 0.218 Vali Loss: 0.357 Vali Acc: 0.884 Test Loss: 0.357 Test Acc: 0.884
Validation loss decreased (-0.855068 --> -0.884054).  Saving model ...
Epoch: 14 cost time: 4.549896478652954
Epoch: 14, Steps: 9 | Train Loss: 0.390 Vali Loss: 0.360 Vali Acc: 0.891 Test Loss: 0.360 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891301).  Saving model ...
Epoch: 15 cost time: 4.5268683433532715
Epoch: 15, Steps: 9 | Train Loss: 0.116 Vali Loss: 0.405 Vali Acc: 0.862 Test Loss: 0.405 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.801126956939697
Epoch: 16, Steps: 9 | Train Loss: 0.176 Vali Loss: 0.378 Vali Acc: 0.862 Test Loss: 0.378 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.71791934967041
Epoch: 17, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.351 Vali Acc: 0.891 Test Loss: 0.351 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 18 cost time: 4.722876071929932
Epoch: 18, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.331 Vali Acc: 0.891 Test Loss: 0.331 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 19 cost time: 4.73258113861084
Epoch: 19, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.268 Vali Acc: 0.906 Test Loss: 0.268 Test Acc: 0.906
Validation loss decreased (-0.891301 --> -0.905794).  Saving model ...
Epoch: 20 cost time: 4.6870787143707275
Epoch: 20, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.257 Vali Acc: 0.906 Test Loss: 0.257 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905795).  Saving model ...
Epoch: 21 cost time: 4.700012922286987
Epoch: 21, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.248 Vali Acc: 0.920 Test Loss: 0.248 Test Acc: 0.920
Validation loss decreased (-0.905795 --> -0.920287).  Saving model ...
Epoch: 22 cost time: 4.689527750015259
Epoch: 22, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.301 Vali Acc: 0.884 Test Loss: 0.301 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.617288112640381
Epoch: 23, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.278 Vali Acc: 0.906 Test Loss: 0.278 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.7575318813323975
Epoch: 24, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.248 Vali Acc: 0.920 Test Loss: 0.248 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 4.7256574630737305
Epoch: 25, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.261 Vali Acc: 0.928 Test Loss: 0.261 Test Acc: 0.928
Validation loss decreased (-0.920287 --> -0.927534).  Saving model ...
Epoch: 26 cost time: 4.844135046005249
Epoch: 26, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.266 Vali Acc: 0.942 Test Loss: 0.266 Test Acc: 0.942
Validation loss decreased (-0.927534 --> -0.942026).  Saving model ...
Epoch: 27 cost time: 4.632988214492798
Epoch: 27, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.237 Vali Acc: 0.942 Test Loss: 0.237 Test Acc: 0.942
Validation loss decreased (-0.942026 --> -0.942027).  Saving model ...
Epoch: 28 cost time: 4.556567668914795
Epoch: 28, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.212 Vali Acc: 0.949 Test Loss: 0.212 Test Acc: 0.949
Validation loss decreased (-0.942027 --> -0.949273).  Saving model ...
Epoch: 29 cost time: 4.636037826538086
Epoch: 29, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.364 Vali Acc: 0.870 Test Loss: 0.364 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 4.650359869003296
Epoch: 30, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.285 Vali Acc: 0.906 Test Loss: 0.285 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9492753623188406
model parameter : 2358260
model size : 9.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.802037715911865
Epoch: 1, Steps: 9 | Train Loss: 1.391 Vali Loss: 1.266 Vali Acc: 0.435 Test Loss: 1.266 Test Acc: 0.435
Validation loss decreased (inf --> -0.434770).  Saving model ...
Epoch: 2 cost time: 2.8519997596740723
Epoch: 2, Steps: 9 | Train Loss: 1.271 Vali Loss: 1.138 Vali Acc: 0.551 Test Loss: 1.138 Test Acc: 0.551
Validation loss decreased (-0.434770 --> -0.550713).  Saving model ...
Epoch: 3 cost time: 2.8638432025909424
Epoch: 3, Steps: 9 | Train Loss: 1.123 Vali Loss: 0.989 Vali Acc: 0.667 Test Loss: 0.989 Test Acc: 0.667
Validation loss decreased (-0.550713 --> -0.666657).  Saving model ...
Epoch: 4 cost time: 2.8606479167938232
Epoch: 4, Steps: 9 | Train Loss: 0.925 Vali Loss: 0.860 Vali Acc: 0.688 Test Loss: 0.860 Test Acc: 0.688
Validation loss decreased (-0.666657 --> -0.688397).  Saving model ...
Epoch: 5 cost time: 2.757521867752075
Epoch: 5, Steps: 9 | Train Loss: 0.769 Vali Loss: 0.710 Vali Acc: 0.754 Test Loss: 0.710 Test Acc: 0.754
Validation loss decreased (-0.688397 --> -0.753616).  Saving model ...
Epoch: 6 cost time: 2.9075679779052734
Epoch: 6, Steps: 9 | Train Loss: 0.630 Vali Loss: 0.595 Vali Acc: 0.804 Test Loss: 0.595 Test Acc: 0.804
Validation loss decreased (-0.753616 --> -0.804342).  Saving model ...
Epoch: 7 cost time: 2.9111037254333496
Epoch: 7, Steps: 9 | Train Loss: 0.489 Vali Loss: 0.501 Vali Acc: 0.819 Test Loss: 0.501 Test Acc: 0.819
Validation loss decreased (-0.804342 --> -0.818836).  Saving model ...
Epoch: 8 cost time: 2.825507164001465
Epoch: 8, Steps: 9 | Train Loss: 0.378 Vali Loss: 0.459 Vali Acc: 0.826 Test Loss: 0.459 Test Acc: 0.826
Validation loss decreased (-0.818836 --> -0.826082).  Saving model ...
Epoch: 9 cost time: 2.9669229984283447
Epoch: 9, Steps: 9 | Train Loss: 0.487 Vali Loss: 0.393 Vali Acc: 0.862 Test Loss: 0.393 Test Acc: 0.862
Validation loss decreased (-0.826082 --> -0.862315).  Saving model ...
Epoch: 10 cost time: 2.9400863647460938
Epoch: 10, Steps: 9 | Train Loss: 0.326 Vali Loss: 0.371 Vali Acc: 0.877 Test Loss: 0.371 Test Acc: 0.877
Validation loss decreased (-0.862315 --> -0.876808).  Saving model ...
Epoch: 11 cost time: 3.1417858600616455
Epoch: 11, Steps: 9 | Train Loss: 0.317 Vali Loss: 0.359 Vali Acc: 0.870 Test Loss: 0.359 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.7967710494995117
Epoch: 12, Steps: 9 | Train Loss: 0.175 Vali Loss: 0.350 Vali Acc: 0.877 Test Loss: 0.350 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 13 cost time: 2.7600953578948975
Epoch: 13, Steps: 9 | Train Loss: 0.168 Vali Loss: 0.326 Vali Acc: 0.884 Test Loss: 0.326 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884055).  Saving model ...
Epoch: 14 cost time: 2.811171531677246
Epoch: 14, Steps: 9 | Train Loss: 0.114 Vali Loss: 0.309 Vali Acc: 0.891 Test Loss: 0.309 Test Acc: 0.891
Validation loss decreased (-0.884055 --> -0.891301).  Saving model ...
Epoch: 15 cost time: 2.814115524291992
Epoch: 15, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.314 Vali Acc: 0.877 Test Loss: 0.314 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.818507432937622
Epoch: 16, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.292 Vali Acc: 0.906 Test Loss: 0.292 Test Acc: 0.906
Validation loss decreased (-0.891301 --> -0.905794).  Saving model ...
Epoch: 17 cost time: 2.963026285171509
Epoch: 17, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.331 Vali Acc: 0.884 Test Loss: 0.331 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.8952229022979736
Epoch: 18, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.338 Vali Acc: 0.870 Test Loss: 0.338 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.997607946395874
Epoch: 19, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.279 Vali Acc: 0.899 Test Loss: 0.279 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.8871512413024902
Epoch: 20, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.294 Vali Acc: 0.891 Test Loss: 0.294 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.852530002593994
Epoch: 21, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.320 Vali Acc: 0.891 Test Loss: 0.320 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.901557683944702
Epoch: 22, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.305 Vali Acc: 0.899 Test Loss: 0.305 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.916454792022705
Epoch: 23, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.264 Vali Acc: 0.928 Test Loss: 0.264 Test Acc: 0.928
Validation loss decreased (-0.905794 --> -0.927534).  Saving model ...
Epoch: 24 cost time: 2.8777143955230713
Epoch: 24, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.302 Vali Acc: 0.906 Test Loss: 0.302 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.993929147720337
Epoch: 25, Steps: 9 | Train Loss: 0.202 Vali Loss: 0.316 Vali Acc: 0.891 Test Loss: 0.316 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.8983335494995117
Epoch: 26, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.403 Vali Acc: 0.877 Test Loss: 0.403 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.738835573196411
Epoch: 27, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.363 Vali Acc: 0.891 Test Loss: 0.363 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.7822022438049316
Epoch: 28, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.361 Vali Acc: 0.899 Test Loss: 0.361 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.8192198276519775
Epoch: 29, Steps: 9 | Train Loss: 0.108 Vali Loss: 0.639 Vali Acc: 0.812 Test Loss: 0.639 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.639772891998291
Epoch: 30, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.485 Vali Acc: 0.848 Test Loss: 0.485 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.927536231884058
model parameter : 702836
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.569089889526367
Epoch: 1, Steps: 9 | Train Loss: 1.469 Vali Loss: 1.445 Vali Acc: 0.174 Test Loss: 1.445 Test Acc: 0.174
Validation loss decreased (inf --> -0.173899).  Saving model ...
Epoch: 2 cost time: 2.8304741382598877
Epoch: 2, Steps: 9 | Train Loss: 1.386 Vali Loss: 1.343 Vali Acc: 0.283 Test Loss: 1.343 Test Acc: 0.283
Validation loss decreased (-0.173899 --> -0.282595).  Saving model ...
Epoch: 3 cost time: 2.8104166984558105
Epoch: 3, Steps: 9 | Train Loss: 1.229 Vali Loss: 1.220 Vali Acc: 0.435 Test Loss: 1.220 Test Acc: 0.435
Validation loss decreased (-0.282595 --> -0.434770).  Saving model ...
Epoch: 4 cost time: 2.9394991397857666
Epoch: 4, Steps: 9 | Train Loss: 1.133 Vali Loss: 1.106 Vali Acc: 0.486 Test Loss: 1.106 Test Acc: 0.486
Validation loss decreased (-0.434770 --> -0.485496).  Saving model ...
Epoch: 5 cost time: 3.6342408657073975
Epoch: 5, Steps: 9 | Train Loss: 0.986 Vali Loss: 0.987 Vali Acc: 0.572 Test Loss: 0.987 Test Acc: 0.572
Validation loss decreased (-0.485496 --> -0.572454).  Saving model ...
Epoch: 6 cost time: 3.503570079803467
Epoch: 6, Steps: 9 | Train Loss: 0.820 Vali Loss: 0.899 Vali Acc: 0.609 Test Loss: 0.899 Test Acc: 0.609
Validation loss decreased (-0.572454 --> -0.608687).  Saving model ...
Epoch: 7 cost time: 3.5522303581237793
Epoch: 7, Steps: 9 | Train Loss: 0.719 Vali Loss: 0.835 Vali Acc: 0.616 Test Loss: 0.835 Test Acc: 0.616
Validation loss decreased (-0.608687 --> -0.615934).  Saving model ...
Epoch: 8 cost time: 3.671511173248291
Epoch: 8, Steps: 9 | Train Loss: 0.606 Vali Loss: 0.717 Vali Acc: 0.688 Test Loss: 0.717 Test Acc: 0.688
Validation loss decreased (-0.615934 --> -0.688399).  Saving model ...
Epoch: 9 cost time: 3.612097978591919
Epoch: 9, Steps: 9 | Train Loss: 0.468 Vali Loss: 0.627 Vali Acc: 0.703 Test Loss: 0.627 Test Acc: 0.703
Validation loss decreased (-0.688399 --> -0.702892).  Saving model ...
Epoch: 10 cost time: 3.4283969402313232
Epoch: 10, Steps: 9 | Train Loss: 0.407 Vali Loss: 0.557 Vali Acc: 0.732 Test Loss: 0.557 Test Acc: 0.732
Validation loss decreased (-0.702892 --> -0.731878).  Saving model ...
Epoch: 11 cost time: 3.6703078746795654
Epoch: 11, Steps: 9 | Train Loss: 0.294 Vali Loss: 0.500 Vali Acc: 0.819 Test Loss: 0.500 Test Acc: 0.819
Validation loss decreased (-0.731878 --> -0.818836).  Saving model ...
Epoch: 12 cost time: 3.727961778640747
Epoch: 12, Steps: 9 | Train Loss: 0.281 Vali Loss: 0.466 Vali Acc: 0.848 Test Loss: 0.466 Test Acc: 0.848
Validation loss decreased (-0.818836 --> -0.847821).  Saving model ...
Epoch: 13 cost time: 3.4506609439849854
Epoch: 13, Steps: 9 | Train Loss: 0.180 Vali Loss: 0.592 Vali Acc: 0.746 Test Loss: 0.592 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.988039493560791
Epoch: 14, Steps: 9 | Train Loss: 0.120 Vali Loss: 0.667 Vali Acc: 0.746 Test Loss: 0.667 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.6939752101898193
Epoch: 15, Steps: 9 | Train Loss: 0.107 Vali Loss: 1.052 Vali Acc: 0.754 Test Loss: 1.052 Test Acc: 0.754
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.6860923767089844
Epoch: 16, Steps: 9 | Train Loss: 0.322 Vali Loss: 0.959 Vali Acc: 0.710 Test Loss: 0.959 Test Acc: 0.710
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.580944299697876
Epoch: 17, Steps: 9 | Train Loss: 0.070 Vali Loss: 1.008 Vali Acc: 0.732 Test Loss: 1.008 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.80232572555542
Epoch: 18, Steps: 9 | Train Loss: 0.117 Vali Loss: 0.850 Vali Acc: 0.725 Test Loss: 0.850 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.8597540855407715
Epoch: 19, Steps: 9 | Train Loss: 0.135 Vali Loss: 0.394 Vali Acc: 0.855 Test Loss: 0.394 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855069).  Saving model ...
Epoch: 20 cost time: 3.50404953956604
Epoch: 20, Steps: 9 | Train Loss: 0.193 Vali Loss: 0.359 Vali Acc: 0.855 Test Loss: 0.359 Test Acc: 0.855
Validation loss decreased (-0.855069 --> -0.855069).  Saving model ...
Epoch: 21 cost time: 3.37947940826416
Epoch: 21, Steps: 9 | Train Loss: 0.144 Vali Loss: 0.498 Vali Acc: 0.812 Test Loss: 0.498 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.7756924629211426
Epoch: 22, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.271 Vali Acc: 0.891 Test Loss: 0.271 Test Acc: 0.891
Validation loss decreased (-0.855069 --> -0.891302).  Saving model ...
Epoch: 23 cost time: 3.774921417236328
Epoch: 23, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.286 Vali Acc: 0.891 Test Loss: 0.286 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.4932875633239746
Epoch: 24, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.268 Vali Acc: 0.920 Test Loss: 0.268 Test Acc: 0.920
Validation loss decreased (-0.891302 --> -0.920287).  Saving model ...
Epoch: 25 cost time: 3.8597350120544434
Epoch: 25, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.265 Vali Acc: 0.913 Test Loss: 0.265 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.6600990295410156
Epoch: 26, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.258 Vali Acc: 0.906 Test Loss: 0.258 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.784127712249756
Epoch: 27, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.266 Vali Acc: 0.906 Test Loss: 0.266 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.8075315952301025
Epoch: 28, Steps: 9 | Train Loss: 0.150 Vali Loss: 0.287 Vali Acc: 0.906 Test Loss: 0.287 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.759329319000244
Epoch: 29, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.316 Vali Acc: 0.899 Test Loss: 0.316 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.5281946659088135
Epoch: 30, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.306 Vali Acc: 0.899 Test Loss: 0.306 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 2358260
model size : 9.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.524811029434204
Epoch: 1, Steps: 9 | Train Loss: 1.397 Vali Loss: 1.282 Vali Acc: 0.449 Test Loss: 1.282 Test Acc: 0.449
Validation loss decreased (inf --> -0.449263).  Saving model ...
Epoch: 2 cost time: 2.4023821353912354
Epoch: 2, Steps: 9 | Train Loss: 1.279 Vali Loss: 1.168 Vali Acc: 0.529 Test Loss: 1.168 Test Acc: 0.529
Validation loss decreased (-0.449263 --> -0.528974).  Saving model ...
Epoch: 3 cost time: 2.640162229537964
Epoch: 3, Steps: 9 | Train Loss: 1.143 Vali Loss: 1.051 Vali Acc: 0.587 Test Loss: 1.051 Test Acc: 0.587
Validation loss decreased (-0.528974 --> -0.586946).  Saving model ...
Epoch: 4 cost time: 2.637493371963501
Epoch: 4, Steps: 9 | Train Loss: 0.966 Vali Loss: 0.953 Vali Acc: 0.630 Test Loss: 0.953 Test Acc: 0.630
Validation loss decreased (-0.586946 --> -0.630425).  Saving model ...
Epoch: 5 cost time: 2.466120958328247
Epoch: 5, Steps: 9 | Train Loss: 0.846 Vali Loss: 0.847 Vali Acc: 0.674 Test Loss: 0.847 Test Acc: 0.674
Validation loss decreased (-0.630425 --> -0.673905).  Saving model ...
Epoch: 6 cost time: 2.3461086750030518
Epoch: 6, Steps: 9 | Train Loss: 0.722 Vali Loss: 0.762 Vali Acc: 0.732 Test Loss: 0.762 Test Acc: 0.732
Validation loss decreased (-0.673905 --> -0.731876).  Saving model ...
Epoch: 7 cost time: 2.6304163932800293
Epoch: 7, Steps: 9 | Train Loss: 0.612 Vali Loss: 0.686 Vali Acc: 0.746 Test Loss: 0.686 Test Acc: 0.746
Validation loss decreased (-0.731876 --> -0.746370).  Saving model ...
Epoch: 8 cost time: 2.5536460876464844
Epoch: 8, Steps: 9 | Train Loss: 0.496 Vali Loss: 0.622 Vali Acc: 0.761 Test Loss: 0.622 Test Acc: 0.761
Validation loss decreased (-0.746370 --> -0.760863).  Saving model ...
Epoch: 9 cost time: 2.371262311935425
Epoch: 9, Steps: 9 | Train Loss: 0.413 Vali Loss: 0.548 Vali Acc: 0.826 Test Loss: 0.548 Test Acc: 0.826
Validation loss decreased (-0.760863 --> -0.826081).  Saving model ...
Epoch: 10 cost time: 2.420860528945923
Epoch: 10, Steps: 9 | Train Loss: 0.334 Vali Loss: 0.496 Vali Acc: 0.855 Test Loss: 0.496 Test Acc: 0.855
Validation loss decreased (-0.826081 --> -0.855068).  Saving model ...
Epoch: 11 cost time: 2.690912961959839
Epoch: 11, Steps: 9 | Train Loss: 0.269 Vali Loss: 0.445 Vali Acc: 0.848 Test Loss: 0.445 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.467456579208374
Epoch: 12, Steps: 9 | Train Loss: 0.206 Vali Loss: 0.432 Vali Acc: 0.841 Test Loss: 0.432 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.4162893295288086
Epoch: 13, Steps: 9 | Train Loss: 0.163 Vali Loss: 0.386 Vali Acc: 0.862 Test Loss: 0.386 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862315).  Saving model ...
Epoch: 14 cost time: 2.0778772830963135
Epoch: 14, Steps: 9 | Train Loss: 0.128 Vali Loss: 0.372 Vali Acc: 0.855 Test Loss: 0.372 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.552788734436035
Epoch: 15, Steps: 9 | Train Loss: 0.108 Vali Loss: 0.384 Vali Acc: 0.870 Test Loss: 0.384 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869561).  Saving model ...
Epoch: 16 cost time: 2.5943846702575684
Epoch: 16, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.373 Vali Acc: 0.884 Test Loss: 0.373 Test Acc: 0.884
Validation loss decreased (-0.869561 --> -0.884054).  Saving model ...
Epoch: 17 cost time: 2.3897228240966797
Epoch: 17, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.401 Vali Acc: 0.841 Test Loss: 0.401 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.3078887462615967
Epoch: 18, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.378 Vali Acc: 0.855 Test Loss: 0.378 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.650585174560547
Epoch: 19, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.327 Vali Acc: 0.862 Test Loss: 0.327 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.690333366394043
Epoch: 20, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.340 Vali Acc: 0.862 Test Loss: 0.340 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.6610195636749268
Epoch: 21, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.336 Vali Acc: 0.870 Test Loss: 0.336 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.682805299758911
Epoch: 22, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.328 Vali Acc: 0.891 Test Loss: 0.328 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891301).  Saving model ...
Epoch: 23 cost time: 2.803231954574585
Epoch: 23, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.319 Vali Acc: 0.891 Test Loss: 0.319 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 24 cost time: 2.675605535507202
Epoch: 24, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.361 Vali Acc: 0.877 Test Loss: 0.361 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.4407410621643066
Epoch: 25, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.375 Vali Acc: 0.870 Test Loss: 0.375 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.481548547744751
Epoch: 26, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.380 Vali Acc: 0.870 Test Loss: 0.380 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.7359652519226074
Epoch: 27, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.354 Vali Acc: 0.870 Test Loss: 0.354 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.6669819355010986
Epoch: 28, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.345 Vali Acc: 0.862 Test Loss: 0.345 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.7735543251037598
Epoch: 29, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.375 Vali Acc: 0.891 Test Loss: 0.375 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.7216978073120117
Epoch: 30, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.333 Vali Acc: 0.899 Test Loss: 0.333 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898547).  Saving model ...
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 702836
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 6.851930618286133
Epoch: 1, Steps: 9 | Train Loss: 1.424 Vali Loss: 1.394 Vali Acc: 0.319 Test Loss: 1.394 Test Acc: 0.319
Validation loss decreased (inf --> -0.318827).  Saving model ...
Epoch: 2 cost time: 5.0349812507629395
Epoch: 2, Steps: 9 | Train Loss: 1.344 Vali Loss: 1.289 Vali Acc: 0.420 Test Loss: 1.289 Test Acc: 0.420
Validation loss decreased (-0.318827 --> -0.420277).  Saving model ...
Epoch: 3 cost time: 4.897146940231323
Epoch: 3, Steps: 9 | Train Loss: 1.180 Vali Loss: 1.167 Vali Acc: 0.486 Test Loss: 1.167 Test Acc: 0.486
Validation loss decreased (-0.420277 --> -0.485496).  Saving model ...
Epoch: 4 cost time: 4.940301179885864
Epoch: 4, Steps: 9 | Train Loss: 1.051 Vali Loss: 1.022 Vali Acc: 0.587 Test Loss: 1.022 Test Acc: 0.587
Validation loss decreased (-0.485496 --> -0.586946).  Saving model ...
Epoch: 5 cost time: 4.987569570541382
Epoch: 5, Steps: 9 | Train Loss: 0.904 Vali Loss: 0.863 Vali Acc: 0.703 Test Loss: 0.863 Test Acc: 0.703
Validation loss decreased (-0.586946 --> -0.702890).  Saving model ...
Epoch: 6 cost time: 4.701446056365967
Epoch: 6, Steps: 9 | Train Loss: 0.730 Vali Loss: 0.704 Vali Acc: 0.746 Test Loss: 0.704 Test Acc: 0.746
Validation loss decreased (-0.702890 --> -0.746370).  Saving model ...
Epoch: 7 cost time: 4.853163957595825
Epoch: 7, Steps: 9 | Train Loss: 0.581 Vali Loss: 0.599 Vali Acc: 0.790 Test Loss: 0.599 Test Acc: 0.790
Validation loss decreased (-0.746370 --> -0.789849).  Saving model ...
Epoch: 8 cost time: 4.880530118942261
Epoch: 8, Steps: 9 | Train Loss: 0.476 Vali Loss: 0.498 Vali Acc: 0.819 Test Loss: 0.498 Test Acc: 0.819
Validation loss decreased (-0.789849 --> -0.818836).  Saving model ...
Epoch: 9 cost time: 5.12542200088501
Epoch: 9, Steps: 9 | Train Loss: 0.352 Vali Loss: 0.460 Vali Acc: 0.819 Test Loss: 0.460 Test Acc: 0.819
Validation loss decreased (-0.818836 --> -0.818836).  Saving model ...
Epoch: 10 cost time: 5.016674518585205
Epoch: 10, Steps: 9 | Train Loss: 0.280 Vali Loss: 0.416 Vali Acc: 0.841 Test Loss: 0.416 Test Acc: 0.841
Validation loss decreased (-0.818836 --> -0.840576).  Saving model ...
Epoch: 11 cost time: 4.87946629524231
Epoch: 11, Steps: 9 | Train Loss: 0.423 Vali Loss: 0.336 Vali Acc: 0.870 Test Loss: 0.336 Test Acc: 0.870
Validation loss decreased (-0.840576 --> -0.869562).  Saving model ...
Epoch: 12 cost time: 4.855169057846069
Epoch: 12, Steps: 9 | Train Loss: 0.200 Vali Loss: 0.340 Vali Acc: 0.870 Test Loss: 0.340 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.56484317779541
Epoch: 13, Steps: 9 | Train Loss: 0.164 Vali Loss: 0.309 Vali Acc: 0.884 Test Loss: 0.309 Test Acc: 0.884
Validation loss decreased (-0.869562 --> -0.884055).  Saving model ...
Epoch: 14 cost time: 4.76837420463562
Epoch: 14, Steps: 9 | Train Loss: 0.131 Vali Loss: 0.326 Vali Acc: 0.862 Test Loss: 0.326 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.67236328125
Epoch: 15, Steps: 9 | Train Loss: 0.113 Vali Loss: 0.339 Vali Acc: 0.855 Test Loss: 0.339 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.169975280761719
Epoch: 16, Steps: 9 | Train Loss: 0.128 Vali Loss: 0.296 Vali Acc: 0.884 Test Loss: 0.296 Test Acc: 0.884
Validation loss decreased (-0.884055 --> -0.884055).  Saving model ...
Epoch: 17 cost time: 5.089673042297363
Epoch: 17, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.280 Vali Acc: 0.891 Test Loss: 0.280 Test Acc: 0.891
Validation loss decreased (-0.884055 --> -0.891302).  Saving model ...
Epoch: 18 cost time: 3.860840320587158
Epoch: 18, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.348 Vali Acc: 0.862 Test Loss: 0.348 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.898388147354126
Epoch: 19, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.367 Vali Acc: 0.855 Test Loss: 0.367 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.708611965179443
Epoch: 20, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.275 Vali Acc: 0.891 Test Loss: 0.275 Test Acc: 0.891
Validation loss decreased (-0.891302 --> -0.891302).  Saving model ...
Epoch: 21 cost time: 4.622705459594727
Epoch: 21, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.282 Vali Acc: 0.891 Test Loss: 0.282 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.8976287841796875
Epoch: 22, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.307 Vali Acc: 0.899 Test Loss: 0.307 Test Acc: 0.899
Validation loss decreased (-0.891302 --> -0.898548).  Saving model ...
Epoch: 23 cost time: 5.1106791496276855
Epoch: 23, Steps: 9 | Train Loss: 0.224 Vali Loss: 0.292 Vali Acc: 0.906 Test Loss: 0.292 Test Acc: 0.906
Validation loss decreased (-0.898548 --> -0.905794).  Saving model ...
Epoch: 24 cost time: 4.66164755821228
Epoch: 24, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.267 Vali Acc: 0.913 Test Loss: 0.267 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913041).  Saving model ...
Epoch: 25 cost time: 4.739494800567627
Epoch: 25, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.264 Vali Acc: 0.913 Test Loss: 0.264 Test Acc: 0.913
Validation loss decreased (-0.913041 --> -0.913041).  Saving model ...
Epoch: 26 cost time: 4.452488660812378
Epoch: 26, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.274 Vali Acc: 0.906 Test Loss: 0.274 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.716492414474487
Epoch: 27, Steps: 9 | Train Loss: 0.154 Vali Loss: 0.267 Vali Acc: 0.913 Test Loss: 0.267 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 4.7561023235321045
Epoch: 28, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.269 Vali Acc: 0.906 Test Loss: 0.269 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 4.875946760177612
Epoch: 29, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.350 Vali Acc: 0.884 Test Loss: 0.350 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 4.826646089553833
Epoch: 30, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.355 Vali Acc: 0.877 Test Loss: 0.355 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 1186036
model size : 4.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.16975998878479
Epoch: 1, Steps: 9 | Train Loss: 1.431 Vali Loss: 1.364 Vali Acc: 0.341 Test Loss: 1.364 Test Acc: 0.341
Validation loss decreased (inf --> -0.340566).  Saving model ...
Epoch: 2 cost time: 3.2484140396118164
Epoch: 2, Steps: 9 | Train Loss: 1.288 Vali Loss: 1.216 Vali Acc: 0.464 Test Loss: 1.216 Test Acc: 0.464
Validation loss decreased (-0.340566 --> -0.463756).  Saving model ...
Epoch: 3 cost time: 3.309009552001953
Epoch: 3, Steps: 9 | Train Loss: 1.118 Vali Loss: 1.055 Vali Acc: 0.587 Test Loss: 1.055 Test Acc: 0.587
Validation loss decreased (-0.463756 --> -0.586946).  Saving model ...
Epoch: 4 cost time: 3.1915693283081055
Epoch: 4, Steps: 9 | Train Loss: 0.957 Vali Loss: 0.915 Vali Acc: 0.623 Test Loss: 0.915 Test Acc: 0.623
Validation loss decreased (-0.586946 --> -0.623179).  Saving model ...
Epoch: 5 cost time: 3.169222831726074
Epoch: 5, Steps: 9 | Train Loss: 0.824 Vali Loss: 0.765 Vali Acc: 0.681 Test Loss: 0.765 Test Acc: 0.681
Validation loss decreased (-0.623179 --> -0.681152).  Saving model ...
Epoch: 6 cost time: 3.3889122009277344
Epoch: 6, Steps: 9 | Train Loss: 0.683 Vali Loss: 0.666 Vali Acc: 0.761 Test Loss: 0.666 Test Acc: 0.761
Validation loss decreased (-0.681152 --> -0.760863).  Saving model ...
Epoch: 7 cost time: 3.2236275672912598
Epoch: 7, Steps: 9 | Train Loss: 0.574 Vali Loss: 0.584 Vali Acc: 0.790 Test Loss: 0.584 Test Acc: 0.790
Validation loss decreased (-0.760863 --> -0.789849).  Saving model ...
Epoch: 8 cost time: 3.1195037364959717
Epoch: 8, Steps: 9 | Train Loss: 0.458 Vali Loss: 0.506 Vali Acc: 0.797 Test Loss: 0.506 Test Acc: 0.797
Validation loss decreased (-0.789849 --> -0.797096).  Saving model ...
Epoch: 9 cost time: 3.3445472717285156
Epoch: 9, Steps: 9 | Train Loss: 0.398 Vali Loss: 0.450 Vali Acc: 0.862 Test Loss: 0.450 Test Acc: 0.862
Validation loss decreased (-0.797096 --> -0.862314).  Saving model ...
Epoch: 10 cost time: 3.2851555347442627
Epoch: 10, Steps: 9 | Train Loss: 0.319 Vali Loss: 0.426 Vali Acc: 0.848 Test Loss: 0.426 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.1475839614868164
Epoch: 11, Steps: 9 | Train Loss: 0.264 Vali Loss: 0.427 Vali Acc: 0.841 Test Loss: 0.427 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.7105154991149902
Epoch: 12, Steps: 9 | Train Loss: 0.204 Vali Loss: 0.405 Vali Acc: 0.862 Test Loss: 0.405 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862315).  Saving model ...
Epoch: 13 cost time: 2.7759249210357666
Epoch: 13, Steps: 9 | Train Loss: 0.172 Vali Loss: 0.364 Vali Acc: 0.862 Test Loss: 0.364 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 14 cost time: 2.7206838130950928
Epoch: 14, Steps: 9 | Train Loss: 0.116 Vali Loss: 0.342 Vali Acc: 0.877 Test Loss: 0.342 Test Acc: 0.877
Validation loss decreased (-0.862315 --> -0.876808).  Saving model ...
Epoch: 15 cost time: 2.770112991333008
Epoch: 15, Steps: 9 | Train Loss: 0.111 Vali Loss: 0.352 Vali Acc: 0.877 Test Loss: 0.352 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.7220685482025146
Epoch: 16, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.385 Vali Acc: 0.862 Test Loss: 0.385 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.7697994709014893
Epoch: 17, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.368 Vali Acc: 0.870 Test Loss: 0.368 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.2616946697235107
Epoch: 18, Steps: 9 | Train Loss: 0.116 Vali Loss: 0.337 Vali Acc: 0.884 Test Loss: 0.337 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884055).  Saving model ...
Epoch: 19 cost time: 3.4115402698516846
Epoch: 19, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.328 Vali Acc: 0.884 Test Loss: 0.328 Test Acc: 0.884
Validation loss decreased (-0.884055 --> -0.884055).  Saving model ...
Epoch: 20 cost time: 3.2138307094573975
Epoch: 20, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.317 Vali Acc: 0.884 Test Loss: 0.317 Test Acc: 0.884
Validation loss decreased (-0.884055 --> -0.884055).  Saving model ...
Epoch: 21 cost time: 3.289921522140503
Epoch: 21, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.339 Vali Acc: 0.891 Test Loss: 0.339 Test Acc: 0.891
Validation loss decreased (-0.884055 --> -0.891301).  Saving model ...
Epoch: 22 cost time: 3.193216323852539
Epoch: 22, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.384 Vali Acc: 0.891 Test Loss: 0.384 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.94702410697937
Epoch: 23, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.398 Vali Acc: 0.870 Test Loss: 0.398 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.4241490364074707
Epoch: 24, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.363 Vali Acc: 0.899 Test Loss: 0.363 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898547).  Saving model ...
Epoch: 25 cost time: 3.0638208389282227
Epoch: 25, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.329 Vali Acc: 0.899 Test Loss: 0.329 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 26 cost time: 3.032499074935913
Epoch: 26, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.338 Vali Acc: 0.891 Test Loss: 0.338 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.220146894454956
Epoch: 27, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.361 Vali Acc: 0.906 Test Loss: 0.361 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905793).  Saving model ...
Epoch: 28 cost time: 3.097217082977295
Epoch: 28, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.354 Vali Acc: 0.899 Test Loss: 0.354 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.3443517684936523
Epoch: 29, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.346 Vali Acc: 0.891 Test Loss: 0.346 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.1623106002807617
Epoch: 30, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.339 Vali Acc: 0.906 Test Loss: 0.339 Test Acc: 0.906
Validation loss decreased (-0.905793 --> -0.905794).  Saving model ...
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 358260
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.718102693557739
Epoch: 1, Steps: 9 | Train Loss: 1.423 Vali Loss: 1.398 Vali Acc: 0.297 Test Loss: 1.398 Test Acc: 0.297
Validation loss decreased (inf --> -0.297087).  Saving model ...
Epoch: 2 cost time: 3.725924253463745
Epoch: 2, Steps: 9 | Train Loss: 1.347 Vali Loss: 1.299 Vali Acc: 0.406 Test Loss: 1.299 Test Acc: 0.406
Validation loss decreased (-0.297087 --> -0.405784).  Saving model ...
Epoch: 3 cost time: 3.7847397327423096
Epoch: 3, Steps: 9 | Train Loss: 1.194 Vali Loss: 1.185 Vali Acc: 0.478 Test Loss: 1.185 Test Acc: 0.478
Validation loss decreased (-0.405784 --> -0.478249).  Saving model ...
Epoch: 4 cost time: 3.7229347229003906
Epoch: 4, Steps: 9 | Train Loss: 1.080 Vali Loss: 1.060 Vali Acc: 0.572 Test Loss: 1.060 Test Acc: 0.572
Validation loss decreased (-0.478249 --> -0.572453).  Saving model ...
Epoch: 5 cost time: 3.782104253768921
Epoch: 5, Steps: 9 | Train Loss: 0.942 Vali Loss: 0.922 Vali Acc: 0.681 Test Loss: 0.922 Test Acc: 0.681
Validation loss decreased (-0.572453 --> -0.681150).  Saving model ...
Epoch: 6 cost time: 3.8033764362335205
Epoch: 6, Steps: 9 | Train Loss: 0.765 Vali Loss: 0.761 Vali Acc: 0.746 Test Loss: 0.761 Test Acc: 0.746
Validation loss decreased (-0.681150 --> -0.746369).  Saving model ...
Epoch: 7 cost time: 3.1654748916625977
Epoch: 7, Steps: 9 | Train Loss: 0.653 Vali Loss: 0.666 Vali Acc: 0.790 Test Loss: 0.666 Test Acc: 0.790
Validation loss decreased (-0.746369 --> -0.789848).  Saving model ...
Epoch: 8 cost time: 3.9468040466308594
Epoch: 8, Steps: 9 | Train Loss: 0.558 Vali Loss: 0.555 Vali Acc: 0.819 Test Loss: 0.555 Test Acc: 0.819
Validation loss decreased (-0.789848 --> -0.818835).  Saving model ...
Epoch: 9 cost time: 3.642345905303955
Epoch: 9, Steps: 9 | Train Loss: 0.394 Vali Loss: 0.481 Vali Acc: 0.826 Test Loss: 0.481 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826082).  Saving model ...
Epoch: 10 cost time: 3.8807640075683594
Epoch: 10, Steps: 9 | Train Loss: 0.342 Vali Loss: 0.463 Vali Acc: 0.826 Test Loss: 0.463 Test Acc: 0.826
Validation loss decreased (-0.826082 --> -0.826082).  Saving model ...
Epoch: 11 cost time: 3.8526811599731445
Epoch: 11, Steps: 9 | Train Loss: 0.334 Vali Loss: 0.404 Vali Acc: 0.826 Test Loss: 0.404 Test Acc: 0.826
Validation loss decreased (-0.826082 --> -0.826083).  Saving model ...
Epoch: 12 cost time: 3.8126935958862305
Epoch: 12, Steps: 9 | Train Loss: 0.217 Vali Loss: 0.391 Vali Acc: 0.855 Test Loss: 0.391 Test Acc: 0.855
Validation loss decreased (-0.826083 --> -0.855069).  Saving model ...
Epoch: 13 cost time: 3.9744606018066406
Epoch: 13, Steps: 9 | Train Loss: 0.295 Vali Loss: 0.320 Vali Acc: 0.891 Test Loss: 0.320 Test Acc: 0.891
Validation loss decreased (-0.855069 --> -0.891301).  Saving model ...
Epoch: 14 cost time: 3.9519429206848145
Epoch: 14, Steps: 9 | Train Loss: 0.157 Vali Loss: 0.344 Vali Acc: 0.848 Test Loss: 0.344 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.951134443283081
Epoch: 15, Steps: 9 | Train Loss: 0.156 Vali Loss: 0.345 Vali Acc: 0.848 Test Loss: 0.345 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.7126681804656982
Epoch: 16, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.301 Vali Acc: 0.884 Test Loss: 0.301 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.5486483573913574
Epoch: 17, Steps: 9 | Train Loss: 0.109 Vali Loss: 0.255 Vali Acc: 0.920 Test Loss: 0.255 Test Acc: 0.920
Validation loss decreased (-0.891301 --> -0.920287).  Saving model ...
Epoch: 18 cost time: 4.032179832458496
Epoch: 18, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.319 Vali Acc: 0.877 Test Loss: 0.319 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.044825553894043
Epoch: 19, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.346 Vali Acc: 0.862 Test Loss: 0.346 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.04404091835022
Epoch: 20, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.250 Vali Acc: 0.920 Test Loss: 0.250 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 21 cost time: 3.68306565284729
Epoch: 21, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.284 Vali Acc: 0.899 Test Loss: 0.284 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.9311091899871826
Epoch: 22, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.319 Vali Acc: 0.870 Test Loss: 0.319 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.780197858810425
Epoch: 23, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.305 Vali Acc: 0.884 Test Loss: 0.305 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.7468738555908203
Epoch: 24, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.276 Vali Acc: 0.913 Test Loss: 0.276 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.877861499786377
Epoch: 25, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.292 Vali Acc: 0.899 Test Loss: 0.292 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.8538079261779785
Epoch: 26, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.314 Vali Acc: 0.884 Test Loss: 0.314 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.988138198852539
Epoch: 27, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.290 Vali Acc: 0.906 Test Loss: 0.290 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 4.014860391616821
Epoch: 28, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.271 Vali Acc: 0.906 Test Loss: 0.271 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.7550113201141357
Epoch: 29, Steps: 9 | Train Loss: 0.127 Vali Loss: 0.332 Vali Acc: 0.884 Test Loss: 0.332 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.9151742458343506
Epoch: 30, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.591 Vali Acc: 0.877 Test Loss: 0.591 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 1186036
model size : 4.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.649970769882202
Epoch: 1, Steps: 9 | Train Loss: 1.435 Vali Loss: 1.376 Vali Acc: 0.312 Test Loss: 1.376 Test Acc: 0.312
Validation loss decreased (inf --> -0.311580).  Saving model ...
Epoch: 2 cost time: 2.6340577602386475
Epoch: 2, Steps: 9 | Train Loss: 1.297 Vali Loss: 1.236 Vali Acc: 0.464 Test Loss: 1.236 Test Acc: 0.464
Validation loss decreased (-0.311580 --> -0.463756).  Saving model ...
Epoch: 3 cost time: 2.823836088180542
Epoch: 3, Steps: 9 | Train Loss: 1.127 Vali Loss: 1.080 Vali Acc: 0.572 Test Loss: 1.080 Test Acc: 0.572
Validation loss decreased (-0.463756 --> -0.572453).  Saving model ...
Epoch: 4 cost time: 2.8355588912963867
Epoch: 4, Steps: 9 | Train Loss: 0.994 Vali Loss: 0.956 Vali Acc: 0.587 Test Loss: 0.956 Test Acc: 0.587
Validation loss decreased (-0.572453 --> -0.586947).  Saving model ...
Epoch: 5 cost time: 2.6218132972717285
Epoch: 5, Steps: 9 | Train Loss: 0.852 Vali Loss: 0.823 Vali Acc: 0.652 Test Loss: 0.823 Test Acc: 0.652
Validation loss decreased (-0.586947 --> -0.652166).  Saving model ...
Epoch: 6 cost time: 2.8981847763061523
Epoch: 6, Steps: 9 | Train Loss: 0.714 Vali Loss: 0.735 Vali Acc: 0.688 Test Loss: 0.735 Test Acc: 0.688
Validation loss decreased (-0.652166 --> -0.688398).  Saving model ...
Epoch: 7 cost time: 2.80190372467041
Epoch: 7, Steps: 9 | Train Loss: 0.614 Vali Loss: 0.658 Vali Acc: 0.746 Test Loss: 0.658 Test Acc: 0.746
Validation loss decreased (-0.688398 --> -0.746370).  Saving model ...
Epoch: 8 cost time: 2.6147522926330566
Epoch: 8, Steps: 9 | Train Loss: 0.518 Vali Loss: 0.590 Vali Acc: 0.754 Test Loss: 0.590 Test Acc: 0.754
Validation loss decreased (-0.746370 --> -0.753617).  Saving model ...
Epoch: 9 cost time: 2.868712902069092
Epoch: 9, Steps: 9 | Train Loss: 0.422 Vali Loss: 0.514 Vali Acc: 0.797 Test Loss: 0.514 Test Acc: 0.797
Validation loss decreased (-0.753617 --> -0.797096).  Saving model ...
Epoch: 10 cost time: 2.833432912826538
Epoch: 10, Steps: 9 | Train Loss: 0.363 Vali Loss: 0.484 Vali Acc: 0.812 Test Loss: 0.484 Test Acc: 0.812
Validation loss decreased (-0.797096 --> -0.811589).  Saving model ...
Epoch: 11 cost time: 2.652644395828247
Epoch: 11, Steps: 9 | Train Loss: 0.299 Vali Loss: 0.472 Vali Acc: 0.812 Test Loss: 0.472 Test Acc: 0.812
Validation loss decreased (-0.811589 --> -0.811589).  Saving model ...
Epoch: 12 cost time: 2.4314663410186768
Epoch: 12, Steps: 9 | Train Loss: 0.234 Vali Loss: 0.449 Vali Acc: 0.819 Test Loss: 0.449 Test Acc: 0.819
Validation loss decreased (-0.811589 --> -0.818836).  Saving model ...
Epoch: 13 cost time: 2.2811200618743896
Epoch: 13, Steps: 9 | Train Loss: 0.207 Vali Loss: 0.417 Vali Acc: 0.833 Test Loss: 0.417 Test Acc: 0.833
Validation loss decreased (-0.818836 --> -0.833329).  Saving model ...
Epoch: 14 cost time: 2.3672618865966797
Epoch: 14, Steps: 9 | Train Loss: 0.141 Vali Loss: 0.419 Vali Acc: 0.848 Test Loss: 0.419 Test Acc: 0.848
Validation loss decreased (-0.833329 --> -0.847822).  Saving model ...
Epoch: 15 cost time: 2.2608227729797363
Epoch: 15, Steps: 9 | Train Loss: 0.141 Vali Loss: 0.432 Vali Acc: 0.833 Test Loss: 0.432 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.2747602462768555
Epoch: 16, Steps: 9 | Train Loss: 0.105 Vali Loss: 0.440 Vali Acc: 0.833 Test Loss: 0.440 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.37339186668396
Epoch: 17, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.414 Vali Acc: 0.848 Test Loss: 0.414 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 18 cost time: 2.722139358520508
Epoch: 18, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.426 Vali Acc: 0.848 Test Loss: 0.426 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.8980610370635986
Epoch: 19, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.443 Vali Acc: 0.833 Test Loss: 0.443 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.4700803756713867
Epoch: 20, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.435 Vali Acc: 0.855 Test Loss: 0.435 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855068).  Saving model ...
Epoch: 21 cost time: 2.6265220642089844
Epoch: 21, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.411 Vali Acc: 0.870 Test Loss: 0.411 Test Acc: 0.870
Validation loss decreased (-0.855068 --> -0.869561).  Saving model ...
Epoch: 22 cost time: 2.90653657913208
Epoch: 22, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.467 Vali Acc: 0.841 Test Loss: 0.467 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.4754974842071533
Epoch: 23, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.473 Vali Acc: 0.826 Test Loss: 0.473 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.6573824882507324
Epoch: 24, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.433 Vali Acc: 0.855 Test Loss: 0.433 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.7753050327301025
Epoch: 25, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.409 Vali Acc: 0.870 Test Loss: 0.409 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 26 cost time: 2.581538200378418
Epoch: 26, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.451 Vali Acc: 0.862 Test Loss: 0.451 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.5936052799224854
Epoch: 27, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.452 Vali Acc: 0.855 Test Loss: 0.452 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.778156042098999
Epoch: 28, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.449 Vali Acc: 0.848 Test Loss: 0.449 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.69858455657959
Epoch: 29, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.450 Vali Acc: 0.855 Test Loss: 0.450 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.570061206817627
Epoch: 30, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.450 Vali Acc: 0.855 Test Loss: 0.450 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 358260
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.83759880065918
Epoch: 1, Steps: 9 | Train Loss: 1.418 Vali Loss: 1.404 Vali Acc: 0.297 Test Loss: 1.404 Test Acc: 0.297
Validation loss decreased (inf --> -0.297087).  Saving model ...
Epoch: 2 cost time: 2.7816524505615234
Epoch: 2, Steps: 9 | Train Loss: 1.356 Vali Loss: 1.322 Vali Acc: 0.355 Test Loss: 1.322 Test Acc: 0.355
Validation loss decreased (-0.297087 --> -0.355059).  Saving model ...
Epoch: 3 cost time: 2.796497106552124
Epoch: 3, Steps: 9 | Train Loss: 1.207 Vali Loss: 1.233 Vali Acc: 0.413 Test Loss: 1.233 Test Acc: 0.413
Validation loss decreased (-0.355059 --> -0.413031).  Saving model ...
Epoch: 4 cost time: 3.0743391513824463
Epoch: 4, Steps: 9 | Train Loss: 1.120 Vali Loss: 1.138 Vali Acc: 0.507 Test Loss: 1.138 Test Acc: 0.507
Validation loss decreased (-0.413031 --> -0.507235).  Saving model ...
Epoch: 5 cost time: 2.7467219829559326
Epoch: 5, Steps: 9 | Train Loss: 1.005 Vali Loss: 1.023 Vali Acc: 0.587 Test Loss: 1.023 Test Acc: 0.587
Validation loss decreased (-0.507235 --> -0.586946).  Saving model ...
Epoch: 6 cost time: 2.843245029449463
Epoch: 6, Steps: 9 | Train Loss: 0.869 Vali Loss: 0.908 Vali Acc: 0.645 Test Loss: 0.908 Test Acc: 0.645
Validation loss decreased (-0.586946 --> -0.644918).  Saving model ...
Epoch: 7 cost time: 2.9875736236572266
Epoch: 7, Steps: 9 | Train Loss: 0.743 Vali Loss: 0.851 Vali Acc: 0.667 Test Loss: 0.851 Test Acc: 0.667
Validation loss decreased (-0.644918 --> -0.666658).  Saving model ...
Epoch: 8 cost time: 2.837510824203491
Epoch: 8, Steps: 9 | Train Loss: 0.631 Vali Loss: 0.747 Vali Acc: 0.717 Test Loss: 0.747 Test Acc: 0.717
Validation loss decreased (-0.666658 --> -0.717384).  Saving model ...
Epoch: 9 cost time: 2.7443196773529053
Epoch: 9, Steps: 9 | Train Loss: 0.515 Vali Loss: 0.699 Vali Acc: 0.732 Test Loss: 0.699 Test Acc: 0.732
Validation loss decreased (-0.717384 --> -0.731877).  Saving model ...
Epoch: 10 cost time: 2.8587958812713623
Epoch: 10, Steps: 9 | Train Loss: 0.420 Vali Loss: 0.640 Vali Acc: 0.739 Test Loss: 0.640 Test Acc: 0.739
Validation loss decreased (-0.731877 --> -0.739124).  Saving model ...
Epoch: 11 cost time: 3.0636138916015625
Epoch: 11, Steps: 9 | Train Loss: 0.329 Vali Loss: 0.557 Vali Acc: 0.746 Test Loss: 0.557 Test Acc: 0.746
Validation loss decreased (-0.739124 --> -0.746371).  Saving model ...
Epoch: 12 cost time: 2.7758142948150635
Epoch: 12, Steps: 9 | Train Loss: 0.267 Vali Loss: 0.527 Vali Acc: 0.761 Test Loss: 0.527 Test Acc: 0.761
Validation loss decreased (-0.746371 --> -0.760864).  Saving model ...
Epoch: 13 cost time: 2.4249048233032227
Epoch: 13, Steps: 9 | Train Loss: 0.223 Vali Loss: 0.508 Vali Acc: 0.790 Test Loss: 0.508 Test Acc: 0.790
Validation loss decreased (-0.760864 --> -0.789850).  Saving model ...
Epoch: 14 cost time: 2.458198070526123
Epoch: 14, Steps: 9 | Train Loss: 0.161 Vali Loss: 0.493 Vali Acc: 0.790 Test Loss: 0.493 Test Acc: 0.790
Validation loss decreased (-0.789850 --> -0.789850).  Saving model ...
Epoch: 15 cost time: 2.420456647872925
Epoch: 15, Steps: 9 | Train Loss: 0.141 Vali Loss: 0.499 Vali Acc: 0.783 Test Loss: 0.499 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.43681263923645
Epoch: 16, Steps: 9 | Train Loss: 0.112 Vali Loss: 0.463 Vali Acc: 0.804 Test Loss: 0.463 Test Acc: 0.804
Validation loss decreased (-0.789850 --> -0.804343).  Saving model ...
Epoch: 17 cost time: 2.3831591606140137
Epoch: 17, Steps: 9 | Train Loss: 0.086 Vali Loss: 0.391 Vali Acc: 0.833 Test Loss: 0.391 Test Acc: 0.833
Validation loss decreased (-0.804343 --> -0.833329).  Saving model ...
Epoch: 18 cost time: 2.420499563217163
Epoch: 18, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.414 Vali Acc: 0.819 Test Loss: 0.414 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.079136371612549
Epoch: 19, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.397 Vali Acc: 0.826 Test Loss: 0.397 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.945622205734253
Epoch: 20, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.338 Vali Acc: 0.862 Test Loss: 0.338 Test Acc: 0.862
Validation loss decreased (-0.833329 --> -0.862315).  Saving model ...
Epoch: 21 cost time: 3.060417652130127
Epoch: 21, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.323 Vali Acc: 0.870 Test Loss: 0.323 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869562).  Saving model ...
Epoch: 22 cost time: 2.9330761432647705
Epoch: 22, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.313 Vali Acc: 0.870 Test Loss: 0.313 Test Acc: 0.870
Validation loss decreased (-0.869562 --> -0.869562).  Saving model ...
Epoch: 23 cost time: 3.1486380100250244
Epoch: 23, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.325 Vali Acc: 0.870 Test Loss: 0.325 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.1025161743164062
Epoch: 24, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.338 Vali Acc: 0.862 Test Loss: 0.338 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.066697120666504
Epoch: 25, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.345 Vali Acc: 0.862 Test Loss: 0.345 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.1079885959625244
Epoch: 26, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.337 Vali Acc: 0.862 Test Loss: 0.337 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.5380606651306152
Epoch: 27, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.288 Vali Acc: 0.906 Test Loss: 0.288 Test Acc: 0.906
Validation loss decreased (-0.869562 --> -0.905794).  Saving model ...
Epoch: 28 cost time: 3.0594217777252197
Epoch: 28, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.335 Vali Acc: 0.899 Test Loss: 0.335 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.9611592292785645
Epoch: 29, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.306 Vali Acc: 0.913 Test Loss: 0.306 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913040).  Saving model ...
Epoch: 30 cost time: 2.732306480407715
Epoch: 30, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.896 Vali Acc: 0.804 Test Loss: 0.896 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 1186036
model size : 4.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.002961874008179
Epoch: 1, Steps: 9 | Train Loss: 1.442 Vali Loss: 1.380 Vali Acc: 0.326 Test Loss: 1.380 Test Acc: 0.326
Validation loss decreased (inf --> -0.326073).  Saving model ...
Epoch: 2 cost time: 1.7308650016784668
Epoch: 2, Steps: 9 | Train Loss: 1.312 Vali Loss: 1.249 Vali Acc: 0.464 Test Loss: 1.249 Test Acc: 0.464
Validation loss decreased (-0.326073 --> -0.463756).  Saving model ...
Epoch: 3 cost time: 2.148017406463623
Epoch: 3, Steps: 9 | Train Loss: 1.137 Vali Loss: 1.111 Vali Acc: 0.536 Test Loss: 1.111 Test Acc: 0.536
Validation loss decreased (-0.463756 --> -0.536221).  Saving model ...
Epoch: 4 cost time: 2.1126794815063477
Epoch: 4, Steps: 9 | Train Loss: 1.013 Vali Loss: 1.004 Vali Acc: 0.565 Test Loss: 1.004 Test Acc: 0.565
Validation loss decreased (-0.536221 --> -0.565207).  Saving model ...
Epoch: 5 cost time: 1.7348549365997314
Epoch: 5, Steps: 9 | Train Loss: 0.867 Vali Loss: 0.906 Vali Acc: 0.609 Test Loss: 0.906 Test Acc: 0.609
Validation loss decreased (-0.565207 --> -0.608687).  Saving model ...
Epoch: 6 cost time: 2.139737367630005
Epoch: 6, Steps: 9 | Train Loss: 0.731 Vali Loss: 0.841 Vali Acc: 0.638 Test Loss: 0.841 Test Acc: 0.638
Validation loss decreased (-0.608687 --> -0.637673).  Saving model ...
Epoch: 7 cost time: 2.0830230712890625
Epoch: 7, Steps: 9 | Train Loss: 0.633 Vali Loss: 0.782 Vali Acc: 0.652 Test Loss: 0.782 Test Acc: 0.652
Validation loss decreased (-0.637673 --> -0.652166).  Saving model ...
Epoch: 8 cost time: 1.960777997970581
Epoch: 8, Steps: 9 | Train Loss: 0.549 Vali Loss: 0.728 Vali Acc: 0.652 Test Loss: 0.728 Test Acc: 0.652
Validation loss decreased (-0.652166 --> -0.652167).  Saving model ...
Epoch: 9 cost time: 2.141576051712036
Epoch: 9, Steps: 9 | Train Loss: 0.460 Vali Loss: 0.661 Vali Acc: 0.681 Test Loss: 0.661 Test Acc: 0.681
Validation loss decreased (-0.652167 --> -0.681153).  Saving model ...
Epoch: 10 cost time: 2.067049741744995
Epoch: 10, Steps: 9 | Train Loss: 0.385 Vali Loss: 0.601 Vali Acc: 0.746 Test Loss: 0.601 Test Acc: 0.746
Validation loss decreased (-0.681153 --> -0.746371).  Saving model ...
Epoch: 11 cost time: 2.1824803352355957
Epoch: 11, Steps: 9 | Train Loss: 0.326 Vali Loss: 0.556 Vali Acc: 0.775 Test Loss: 0.556 Test Acc: 0.775
Validation loss decreased (-0.746371 --> -0.775357).  Saving model ...
Epoch: 12 cost time: 2.210747003555298
Epoch: 12, Steps: 9 | Train Loss: 0.255 Vali Loss: 0.518 Vali Acc: 0.790 Test Loss: 0.518 Test Acc: 0.790
Validation loss decreased (-0.775357 --> -0.789850).  Saving model ...
Epoch: 13 cost time: 1.9282281398773193
Epoch: 13, Steps: 9 | Train Loss: 0.229 Vali Loss: 0.468 Vali Acc: 0.812 Test Loss: 0.468 Test Acc: 0.812
Validation loss decreased (-0.789850 --> -0.811590).  Saving model ...
Epoch: 14 cost time: 2.115710973739624
Epoch: 14, Steps: 9 | Train Loss: 0.164 Vali Loss: 0.473 Vali Acc: 0.812 Test Loss: 0.473 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9783387184143066
Epoch: 15, Steps: 9 | Train Loss: 0.153 Vali Loss: 0.461 Vali Acc: 0.819 Test Loss: 0.461 Test Acc: 0.819
Validation loss decreased (-0.811590 --> -0.818836).  Saving model ...
Epoch: 16 cost time: 1.6931414604187012
Epoch: 16, Steps: 9 | Train Loss: 0.118 Vali Loss: 0.462 Vali Acc: 0.819 Test Loss: 0.462 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.2331557273864746
Epoch: 17, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.453 Vali Acc: 0.812 Test Loss: 0.453 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.9183440208435059
Epoch: 18, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.438 Vali Acc: 0.826 Test Loss: 0.438 Test Acc: 0.826
Validation loss decreased (-0.818836 --> -0.826083).  Saving model ...
Epoch: 19 cost time: 2.220986843109131
Epoch: 19, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.446 Vali Acc: 0.826 Test Loss: 0.446 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.0227203369140625
Epoch: 20, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.452 Vali Acc: 0.848 Test Loss: 0.452 Test Acc: 0.848
Validation loss decreased (-0.826083 --> -0.847822).  Saving model ...
Epoch: 21 cost time: 1.9357285499572754
Epoch: 21, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.432 Vali Acc: 0.870 Test Loss: 0.432 Test Acc: 0.870
Validation loss decreased (-0.847822 --> -0.869561).  Saving model ...
Epoch: 22 cost time: 2.174633502960205
Epoch: 22, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.453 Vali Acc: 0.848 Test Loss: 0.453 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.9555740356445312
Epoch: 23, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.455 Vali Acc: 0.848 Test Loss: 0.455 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.2291722297668457
Epoch: 24, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.431 Vali Acc: 0.862 Test Loss: 0.431 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.8971691131591797
Epoch: 25, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.435 Vali Acc: 0.862 Test Loss: 0.435 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.929227352142334
Epoch: 26, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.452 Vali Acc: 0.855 Test Loss: 0.452 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.0825583934783936
Epoch: 27, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.424 Vali Acc: 0.877 Test Loss: 0.424 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876807).  Saving model ...
Epoch: 28 cost time: 1.9077425003051758
Epoch: 28, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.425 Vali Acc: 0.870 Test Loss: 0.425 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.0722126960754395
Epoch: 29, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.446 Vali Acc: 0.870 Test Loss: 0.446 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.9559714794158936
Epoch: 30, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.440 Vali Acc: 0.870 Test Loss: 0.440 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 358260
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 6.489502668380737
Epoch: 1, Steps: 9 | Train Loss: 1.355 Vali Loss: 1.333 Vali Acc: 0.362 Test Loss: 1.333 Test Acc: 0.362
Validation loss decreased (inf --> -0.362306).  Saving model ...
Epoch: 2 cost time: 4.159809112548828
Epoch: 2, Steps: 9 | Train Loss: 1.288 Vali Loss: 1.220 Vali Acc: 0.558 Test Loss: 1.220 Test Acc: 0.558
Validation loss decreased (-0.362306 --> -0.557959).  Saving model ...
Epoch: 3 cost time: 4.158892393112183
Epoch: 3, Steps: 9 | Train Loss: 1.133 Vali Loss: 1.087 Vali Acc: 0.623 Test Loss: 1.087 Test Acc: 0.623
Validation loss decreased (-0.557959 --> -0.623178).  Saving model ...
Epoch: 4 cost time: 4.402149677276611
Epoch: 4, Steps: 9 | Train Loss: 0.962 Vali Loss: 0.915 Vali Acc: 0.703 Test Loss: 0.915 Test Acc: 0.703
Validation loss decreased (-0.623178 --> -0.702889).  Saving model ...
Epoch: 5 cost time: 3.8718459606170654
Epoch: 5, Steps: 9 | Train Loss: 0.819 Vali Loss: 0.749 Vali Acc: 0.746 Test Loss: 0.749 Test Acc: 0.746
Validation loss decreased (-0.702889 --> -0.746369).  Saving model ...
Epoch: 6 cost time: 3.311384677886963
Epoch: 6, Steps: 9 | Train Loss: 0.661 Vali Loss: 0.623 Vali Acc: 0.754 Test Loss: 0.623 Test Acc: 0.754
Validation loss decreased (-0.746369 --> -0.753617).  Saving model ...
Epoch: 7 cost time: 3.352583885192871
Epoch: 7, Steps: 9 | Train Loss: 0.523 Vali Loss: 0.527 Vali Acc: 0.812 Test Loss: 0.527 Test Acc: 0.812
Validation loss decreased (-0.753617 --> -0.811589).  Saving model ...
Epoch: 8 cost time: 3.399186372756958
Epoch: 8, Steps: 9 | Train Loss: 0.411 Vali Loss: 0.452 Vali Acc: 0.833 Test Loss: 0.452 Test Acc: 0.833
Validation loss decreased (-0.811589 --> -0.833329).  Saving model ...
Epoch: 9 cost time: 3.810602903366089
Epoch: 9, Steps: 9 | Train Loss: 0.433 Vali Loss: 0.378 Vali Acc: 0.862 Test Loss: 0.378 Test Acc: 0.862
Validation loss decreased (-0.833329 --> -0.862315).  Saving model ...
Epoch: 10 cost time: 4.1114983558654785
Epoch: 10, Steps: 9 | Train Loss: 0.238 Vali Loss: 0.371 Vali Acc: 0.848 Test Loss: 0.371 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.9556686878204346
Epoch: 11, Steps: 9 | Train Loss: 0.212 Vali Loss: 0.378 Vali Acc: 0.862 Test Loss: 0.378 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.868889808654785
Epoch: 12, Steps: 9 | Train Loss: 0.199 Vali Loss: 0.382 Vali Acc: 0.855 Test Loss: 0.382 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.8895251750946045
Epoch: 13, Steps: 9 | Train Loss: 0.149 Vali Loss: 0.381 Vali Acc: 0.848 Test Loss: 0.381 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.805830240249634
Epoch: 14, Steps: 9 | Train Loss: 0.116 Vali Loss: 0.357 Vali Acc: 0.855 Test Loss: 0.357 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.8018991947174072
Epoch: 15, Steps: 9 | Train Loss: 0.387 Vali Loss: 0.388 Vali Acc: 0.855 Test Loss: 0.388 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.111221075057983
Epoch: 16, Steps: 9 | Train Loss: 0.099 Vali Loss: 0.382 Vali Acc: 0.870 Test Loss: 0.382 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869561).  Saving model ...
Epoch: 17 cost time: 4.032442808151245
Epoch: 17, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.346 Vali Acc: 0.884 Test Loss: 0.346 Test Acc: 0.884
Validation loss decreased (-0.869561 --> -0.884055).  Saving model ...
Epoch: 18 cost time: 4.014976263046265
Epoch: 18, Steps: 9 | Train Loss: 0.159 Vali Loss: 0.332 Vali Acc: 0.891 Test Loss: 0.332 Test Acc: 0.891
Validation loss decreased (-0.884055 --> -0.891301).  Saving model ...
Epoch: 19 cost time: 3.912813186645508
Epoch: 19, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.327 Vali Acc: 0.891 Test Loss: 0.327 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 20 cost time: 4.303057909011841
Epoch: 20, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.347 Vali Acc: 0.891 Test Loss: 0.347 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.261257886886597
Epoch: 21, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.389 Vali Acc: 0.884 Test Loss: 0.389 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.015893220901489
Epoch: 22, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.452 Vali Acc: 0.877 Test Loss: 0.452 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.043701887130737
Epoch: 23, Steps: 9 | Train Loss: 0.089 Vali Loss: 0.397 Vali Acc: 0.884 Test Loss: 0.397 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 4.020606994628906
Epoch: 24, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.398 Vali Acc: 0.899 Test Loss: 0.398 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898547).  Saving model ...
Epoch: 25 cost time: 4.274181365966797
Epoch: 25, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.402 Vali Acc: 0.899 Test Loss: 0.402 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.323476076126099
Epoch: 26, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.392 Vali Acc: 0.899 Test Loss: 0.392 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 27 cost time: 4.111247539520264
Epoch: 27, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.375 Vali Acc: 0.899 Test Loss: 0.375 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 28 cost time: 4.104011058807373
Epoch: 28, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.395 Vali Acc: 0.891 Test Loss: 0.395 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 4.122101545333862
Epoch: 29, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.445 Vali Acc: 0.870 Test Loss: 0.445 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 4.219998359680176
Epoch: 30, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.454 Vali Acc: 0.891 Test Loss: 0.454 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 599924
model size : 2.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.354194402694702
Epoch: 1, Steps: 9 | Train Loss: 1.371 Vali Loss: 1.368 Vali Acc: 0.304 Test Loss: 1.368 Test Acc: 0.304
Validation loss decreased (inf --> -0.304334).  Saving model ...
Epoch: 2 cost time: 3.103944778442383
Epoch: 2, Steps: 9 | Train Loss: 1.274 Vali Loss: 1.267 Vali Acc: 0.449 Test Loss: 1.267 Test Acc: 0.449
Validation loss decreased (-0.304334 --> -0.449263).  Saving model ...
Epoch: 3 cost time: 3.1254804134368896
Epoch: 3, Steps: 9 | Train Loss: 1.155 Vali Loss: 1.161 Vali Acc: 0.543 Test Loss: 1.161 Test Acc: 0.543
Validation loss decreased (-0.449263 --> -0.543467).  Saving model ...
Epoch: 4 cost time: 3.192115306854248
Epoch: 4, Steps: 9 | Train Loss: 1.005 Vali Loss: 1.033 Vali Acc: 0.652 Test Loss: 1.033 Test Acc: 0.652
Validation loss decreased (-0.543467 --> -0.652164).  Saving model ...
Epoch: 5 cost time: 3.1485812664031982
Epoch: 5, Steps: 9 | Train Loss: 0.860 Vali Loss: 0.906 Vali Acc: 0.710 Test Loss: 0.906 Test Acc: 0.710
Validation loss decreased (-0.652164 --> -0.710136).  Saving model ...
Epoch: 6 cost time: 2.7687466144561768
Epoch: 6, Steps: 9 | Train Loss: 0.718 Vali Loss: 0.776 Vali Acc: 0.754 Test Loss: 0.776 Test Acc: 0.754
Validation loss decreased (-0.710136 --> -0.753615).  Saving model ...
Epoch: 7 cost time: 3.035654306411743
Epoch: 7, Steps: 9 | Train Loss: 0.624 Vali Loss: 0.689 Vali Acc: 0.783 Test Loss: 0.689 Test Acc: 0.783
Validation loss decreased (-0.753615 --> -0.782602).  Saving model ...
Epoch: 8 cost time: 2.6182713508605957
Epoch: 8, Steps: 9 | Train Loss: 0.515 Vali Loss: 0.627 Vali Acc: 0.761 Test Loss: 0.627 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.1674466133117676
Epoch: 9, Steps: 9 | Train Loss: 0.401 Vali Loss: 0.555 Vali Acc: 0.819 Test Loss: 0.555 Test Acc: 0.819
Validation loss decreased (-0.782602 --> -0.818835).  Saving model ...
Epoch: 10 cost time: 2.976513624191284
Epoch: 10, Steps: 9 | Train Loss: 0.315 Vali Loss: 0.509 Vali Acc: 0.826 Test Loss: 0.509 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826082).  Saving model ...
Epoch: 11 cost time: 3.1736061573028564
Epoch: 11, Steps: 9 | Train Loss: 0.270 Vali Loss: 0.485 Vali Acc: 0.826 Test Loss: 0.485 Test Acc: 0.826
Validation loss decreased (-0.826082 --> -0.826082).  Saving model ...
Epoch: 12 cost time: 2.9503471851348877
Epoch: 12, Steps: 9 | Train Loss: 0.209 Vali Loss: 0.481 Vali Acc: 0.819 Test Loss: 0.481 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.185256242752075
Epoch: 13, Steps: 9 | Train Loss: 0.213 Vali Loss: 0.452 Vali Acc: 0.841 Test Loss: 0.452 Test Acc: 0.841
Validation loss decreased (-0.826082 --> -0.840575).  Saving model ...
Epoch: 14 cost time: 2.9226596355438232
Epoch: 14, Steps: 9 | Train Loss: 0.146 Vali Loss: 0.413 Vali Acc: 0.848 Test Loss: 0.413 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847822).  Saving model ...
Epoch: 15 cost time: 3.122544050216675
Epoch: 15, Steps: 9 | Train Loss: 0.118 Vali Loss: 0.393 Vali Acc: 0.848 Test Loss: 0.393 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 16 cost time: 3.070366621017456
Epoch: 16, Steps: 9 | Train Loss: 0.141 Vali Loss: 0.392 Vali Acc: 0.848 Test Loss: 0.392 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 17 cost time: 3.201831817626953
Epoch: 17, Steps: 9 | Train Loss: 0.099 Vali Loss: 0.422 Vali Acc: 0.855 Test Loss: 0.422 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855068).  Saving model ...
Epoch: 18 cost time: 3.108968734741211
Epoch: 18, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.403 Vali Acc: 0.862 Test Loss: 0.403 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862315).  Saving model ...
Epoch: 19 cost time: 2.7934513092041016
Epoch: 19, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.393 Vali Acc: 0.855 Test Loss: 0.393 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.069080352783203
Epoch: 20, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.411 Vali Acc: 0.833 Test Loss: 0.411 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.5286684036254883
Epoch: 21, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.442 Vali Acc: 0.833 Test Loss: 0.442 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.207425832748413
Epoch: 22, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.413 Vali Acc: 0.841 Test Loss: 0.413 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.939891815185547
Epoch: 23, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.402 Vali Acc: 0.870 Test Loss: 0.402 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869561).  Saving model ...
Epoch: 24 cost time: 3.186164140701294
Epoch: 24, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.419 Vali Acc: 0.855 Test Loss: 0.419 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.054659605026245
Epoch: 25, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.404 Vali Acc: 0.855 Test Loss: 0.404 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.192448377609253
Epoch: 26, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.393 Vali Acc: 0.884 Test Loss: 0.393 Test Acc: 0.884
Validation loss decreased (-0.869561 --> -0.884054).  Saving model ...
Epoch: 27 cost time: 3.1588408946990967
Epoch: 27, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.393 Vali Acc: 0.870 Test Loss: 0.393 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.0937438011169434
Epoch: 28, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.416 Vali Acc: 0.848 Test Loss: 0.416 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.1517207622528076
Epoch: 29, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.414 Vali Acc: 0.848 Test Loss: 0.414 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.1820452213287354
Epoch: 30, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.387 Vali Acc: 0.855 Test Loss: 0.387 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 185972
model size : 1.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.848923444747925
Epoch: 1, Steps: 9 | Train Loss: 1.355 Vali Loss: 1.332 Vali Acc: 0.370 Test Loss: 1.332 Test Acc: 0.370
Validation loss decreased (inf --> -0.369552).  Saving model ...
Epoch: 2 cost time: 3.4832510948181152
Epoch: 2, Steps: 9 | Train Loss: 1.290 Vali Loss: 1.228 Vali Acc: 0.551 Test Loss: 1.228 Test Acc: 0.551
Validation loss decreased (-0.369552 --> -0.550712).  Saving model ...
Epoch: 3 cost time: 3.521885871887207
Epoch: 3, Steps: 9 | Train Loss: 1.144 Vali Loss: 1.105 Vali Acc: 0.616 Test Loss: 1.105 Test Acc: 0.616
Validation loss decreased (-0.550712 --> -0.615931).  Saving model ...
Epoch: 4 cost time: 3.447798490524292
Epoch: 4, Steps: 9 | Train Loss: 0.983 Vali Loss: 0.948 Vali Acc: 0.674 Test Loss: 0.948 Test Acc: 0.674
Validation loss decreased (-0.615931 --> -0.673904).  Saving model ...
Epoch: 5 cost time: 3.530329704284668
Epoch: 5, Steps: 9 | Train Loss: 0.855 Vali Loss: 0.799 Vali Acc: 0.710 Test Loss: 0.799 Test Acc: 0.710
Validation loss decreased (-0.673904 --> -0.710137).  Saving model ...
Epoch: 6 cost time: 3.404292106628418
Epoch: 6, Steps: 9 | Train Loss: 0.712 Vali Loss: 0.677 Vali Acc: 0.739 Test Loss: 0.677 Test Acc: 0.739
Validation loss decreased (-0.710137 --> -0.739124).  Saving model ...
Epoch: 7 cost time: 3.5163657665252686
Epoch: 7, Steps: 9 | Train Loss: 0.589 Vali Loss: 0.574 Vali Acc: 0.790 Test Loss: 0.574 Test Acc: 0.790
Validation loss decreased (-0.739124 --> -0.789849).  Saving model ...
Epoch: 8 cost time: 3.2871005535125732
Epoch: 8, Steps: 9 | Train Loss: 0.448 Vali Loss: 0.481 Vali Acc: 0.833 Test Loss: 0.481 Test Acc: 0.833
Validation loss decreased (-0.789849 --> -0.833329).  Saving model ...
Epoch: 9 cost time: 2.7666373252868652
Epoch: 9, Steps: 9 | Train Loss: 0.478 Vali Loss: 0.406 Vali Acc: 0.870 Test Loss: 0.406 Test Acc: 0.870
Validation loss decreased (-0.833329 --> -0.869561).  Saving model ...
Epoch: 10 cost time: 2.8978614807128906
Epoch: 10, Steps: 9 | Train Loss: 0.339 Vali Loss: 0.396 Vali Acc: 0.848 Test Loss: 0.396 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.9297101497650146
Epoch: 11, Steps: 9 | Train Loss: 0.263 Vali Loss: 0.411 Vali Acc: 0.848 Test Loss: 0.411 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.261265277862549
Epoch: 12, Steps: 9 | Train Loss: 0.245 Vali Loss: 0.426 Vali Acc: 0.841 Test Loss: 0.426 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.4105100631713867
Epoch: 13, Steps: 9 | Train Loss: 0.203 Vali Loss: 0.400 Vali Acc: 0.862 Test Loss: 0.400 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.3820552825927734
Epoch: 14, Steps: 9 | Train Loss: 0.151 Vali Loss: 0.369 Vali Acc: 0.862 Test Loss: 0.369 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.2441208362579346
Epoch: 15, Steps: 9 | Train Loss: 0.329 Vali Loss: 0.404 Vali Acc: 0.870 Test Loss: 0.404 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 16 cost time: 3.2642242908477783
Epoch: 16, Steps: 9 | Train Loss: 0.104 Vali Loss: 0.391 Vali Acc: 0.870 Test Loss: 0.391 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 17 cost time: 3.215263605117798
Epoch: 17, Steps: 9 | Train Loss: 0.152 Vali Loss: 0.372 Vali Acc: 0.884 Test Loss: 0.372 Test Acc: 0.884
Validation loss decreased (-0.869561 --> -0.884054).  Saving model ...
Epoch: 18 cost time: 3.293809175491333
Epoch: 18, Steps: 9 | Train Loss: 0.186 Vali Loss: 0.391 Vali Acc: 0.870 Test Loss: 0.391 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.209552049636841
Epoch: 19, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.365 Vali Acc: 0.899 Test Loss: 0.365 Test Acc: 0.899
Validation loss decreased (-0.884054 --> -0.898547).  Saving model ...
Epoch: 20 cost time: 3.2222769260406494
Epoch: 20, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.391 Vali Acc: 0.891 Test Loss: 0.391 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.286564588546753
Epoch: 21, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.421 Vali Acc: 0.884 Test Loss: 0.421 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.419981002807617
Epoch: 22, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.397 Vali Acc: 0.891 Test Loss: 0.397 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.3147599697113037
Epoch: 23, Steps: 9 | Train Loss: 0.189 Vali Loss: 0.378 Vali Acc: 0.906 Test Loss: 0.378 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905793).  Saving model ...
Epoch: 24 cost time: 3.358360767364502
Epoch: 24, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.382 Vali Acc: 0.891 Test Loss: 0.382 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.308136224746704
Epoch: 25, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.398 Vali Acc: 0.906 Test Loss: 0.398 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.534217119216919
Epoch: 26, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.405 Vali Acc: 0.906 Test Loss: 0.405 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.3520843982696533
Epoch: 27, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.383 Vali Acc: 0.906 Test Loss: 0.383 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.470642328262329
Epoch: 28, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.384 Vali Acc: 0.906 Test Loss: 0.384 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.426719903945923
Epoch: 29, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.413 Vali Acc: 0.899 Test Loss: 0.413 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.5320613384246826
Epoch: 30, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.389 Vali Acc: 0.906 Test Loss: 0.389 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 599924
model size : 2.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.461385488510132
Epoch: 1, Steps: 9 | Train Loss: 1.375 Vali Loss: 1.370 Vali Acc: 0.304 Test Loss: 1.370 Test Acc: 0.304
Validation loss decreased (inf --> -0.304334).  Saving model ...
Epoch: 2 cost time: 2.2514333724975586
Epoch: 2, Steps: 9 | Train Loss: 1.280 Vali Loss: 1.272 Vali Acc: 0.428 Test Loss: 1.272 Test Acc: 0.428
Validation loss decreased (-0.304334 --> -0.427524).  Saving model ...
Epoch: 3 cost time: 2.1818535327911377
Epoch: 3, Steps: 9 | Train Loss: 1.159 Vali Loss: 1.170 Vali Acc: 0.536 Test Loss: 1.170 Test Acc: 0.536
Validation loss decreased (-0.427524 --> -0.536220).  Saving model ...
Epoch: 4 cost time: 2.1810333728790283
Epoch: 4, Steps: 9 | Train Loss: 1.022 Vali Loss: 1.051 Vali Acc: 0.630 Test Loss: 1.051 Test Acc: 0.630
Validation loss decreased (-0.536220 --> -0.630424).  Saving model ...
Epoch: 5 cost time: 2.128342390060425
Epoch: 5, Steps: 9 | Train Loss: 0.890 Vali Loss: 0.939 Vali Acc: 0.696 Test Loss: 0.939 Test Acc: 0.696
Validation loss decreased (-0.630424 --> -0.695643).  Saving model ...
Epoch: 6 cost time: 2.675180196762085
Epoch: 6, Steps: 9 | Train Loss: 0.760 Vali Loss: 0.818 Vali Acc: 0.761 Test Loss: 0.818 Test Acc: 0.761
Validation loss decreased (-0.695643 --> -0.760861).  Saving model ...
Epoch: 7 cost time: 2.419233560562134
Epoch: 7, Steps: 9 | Train Loss: 0.665 Vali Loss: 0.730 Vali Acc: 0.783 Test Loss: 0.730 Test Acc: 0.783
Validation loss decreased (-0.760861 --> -0.782601).  Saving model ...
Epoch: 8 cost time: 2.7437334060668945
Epoch: 8, Steps: 9 | Train Loss: 0.540 Vali Loss: 0.658 Vali Acc: 0.783 Test Loss: 0.658 Test Acc: 0.783
Validation loss decreased (-0.782601 --> -0.782602).  Saving model ...
Epoch: 9 cost time: 2.5953965187072754
Epoch: 9, Steps: 9 | Train Loss: 0.442 Vali Loss: 0.587 Vali Acc: 0.819 Test Loss: 0.587 Test Acc: 0.819
Validation loss decreased (-0.782602 --> -0.818835).  Saving model ...
Epoch: 10 cost time: 2.768812656402588
Epoch: 10, Steps: 9 | Train Loss: 0.352 Vali Loss: 0.540 Vali Acc: 0.826 Test Loss: 0.540 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826082).  Saving model ...
Epoch: 11 cost time: 2.505053997039795
Epoch: 11, Steps: 9 | Train Loss: 0.276 Vali Loss: 0.495 Vali Acc: 0.833 Test Loss: 0.495 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833328).  Saving model ...
Epoch: 12 cost time: 2.682985782623291
Epoch: 12, Steps: 9 | Train Loss: 0.216 Vali Loss: 0.485 Vali Acc: 0.819 Test Loss: 0.485 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.4718260765075684
Epoch: 13, Steps: 9 | Train Loss: 0.205 Vali Loss: 0.476 Vali Acc: 0.826 Test Loss: 0.476 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.706223964691162
Epoch: 14, Steps: 9 | Train Loss: 0.155 Vali Loss: 0.439 Vali Acc: 0.833 Test Loss: 0.439 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833329).  Saving model ...
Epoch: 15 cost time: 2.6265547275543213
Epoch: 15, Steps: 9 | Train Loss: 0.135 Vali Loss: 0.430 Vali Acc: 0.819 Test Loss: 0.430 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.661867380142212
Epoch: 16, Steps: 9 | Train Loss: 0.177 Vali Loss: 0.417 Vali Acc: 0.826 Test Loss: 0.417 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.3368852138519287
Epoch: 17, Steps: 9 | Train Loss: 0.098 Vali Loss: 0.422 Vali Acc: 0.833 Test Loss: 0.422 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 18 cost time: 2.5803446769714355
Epoch: 18, Steps: 9 | Train Loss: 0.086 Vali Loss: 0.427 Vali Acc: 0.819 Test Loss: 0.427 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.3066625595092773
Epoch: 19, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.437 Vali Acc: 0.826 Test Loss: 0.437 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.654299020767212
Epoch: 20, Steps: 9 | Train Loss: 0.120 Vali Loss: 0.402 Vali Acc: 0.826 Test Loss: 0.402 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.344480514526367
Epoch: 21, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.404 Vali Acc: 0.826 Test Loss: 0.404 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.695451021194458
Epoch: 22, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.401 Vali Acc: 0.826 Test Loss: 0.401 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.5142130851745605
Epoch: 23, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.401 Vali Acc: 0.870 Test Loss: 0.401 Test Acc: 0.870
Validation loss decreased (-0.833329 --> -0.869561).  Saving model ...
Epoch: 24 cost time: 2.6544861793518066
Epoch: 24, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.429 Vali Acc: 0.826 Test Loss: 0.429 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.457923650741577
Epoch: 25, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.410 Vali Acc: 0.841 Test Loss: 0.410 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.47546124458313
Epoch: 26, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.396 Vali Acc: 0.862 Test Loss: 0.396 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.4772777557373047
Epoch: 27, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.393 Vali Acc: 0.862 Test Loss: 0.393 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.4333295822143555
Epoch: 28, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.421 Vali Acc: 0.826 Test Loss: 0.421 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.544598340988159
Epoch: 29, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.417 Vali Acc: 0.826 Test Loss: 0.417 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.354599952697754
Epoch: 30, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.396 Vali Acc: 0.848 Test Loss: 0.396 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 185972
model size : 1.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.203653812408447
Epoch: 1, Steps: 9 | Train Loss: 1.361 Vali Loss: 1.330 Vali Acc: 0.362 Test Loss: 1.330 Test Acc: 0.362
Validation loss decreased (inf --> -0.362306).  Saving model ...
Epoch: 2 cost time: 2.6624577045440674
Epoch: 2, Steps: 9 | Train Loss: 1.298 Vali Loss: 1.238 Vali Acc: 0.536 Test Loss: 1.238 Test Acc: 0.536
Validation loss decreased (-0.362306 --> -0.536220).  Saving model ...
Epoch: 3 cost time: 2.4589805603027344
Epoch: 3, Steps: 9 | Train Loss: 1.165 Vali Loss: 1.144 Vali Acc: 0.587 Test Loss: 1.144 Test Acc: 0.587
Validation loss decreased (-0.536220 --> -0.586945).  Saving model ...
Epoch: 4 cost time: 2.669147253036499
Epoch: 4, Steps: 9 | Train Loss: 1.022 Vali Loss: 1.038 Vali Acc: 0.594 Test Loss: 1.038 Test Acc: 0.594
Validation loss decreased (-0.586945 --> -0.594193).  Saving model ...
Epoch: 5 cost time: 2.588275194168091
Epoch: 5, Steps: 9 | Train Loss: 0.908 Vali Loss: 0.942 Vali Acc: 0.616 Test Loss: 0.942 Test Acc: 0.616
Validation loss decreased (-0.594193 --> -0.615933).  Saving model ...
Epoch: 6 cost time: 2.6517460346221924
Epoch: 6, Steps: 9 | Train Loss: 0.789 Vali Loss: 0.866 Vali Acc: 0.652 Test Loss: 0.866 Test Acc: 0.652
Validation loss decreased (-0.615933 --> -0.652165).  Saving model ...
Epoch: 7 cost time: 2.5697882175445557
Epoch: 7, Steps: 9 | Train Loss: 0.691 Vali Loss: 0.799 Vali Acc: 0.703 Test Loss: 0.799 Test Acc: 0.703
Validation loss decreased (-0.652165 --> -0.702891).  Saving model ...
Epoch: 8 cost time: 2.561110734939575
Epoch: 8, Steps: 9 | Train Loss: 0.590 Vali Loss: 0.721 Vali Acc: 0.732 Test Loss: 0.721 Test Acc: 0.732
Validation loss decreased (-0.702891 --> -0.731877).  Saving model ...
Epoch: 9 cost time: 2.176522731781006
Epoch: 9, Steps: 9 | Train Loss: 0.504 Vali Loss: 0.654 Vali Acc: 0.754 Test Loss: 0.654 Test Acc: 0.754
Validation loss decreased (-0.731877 --> -0.753617).  Saving model ...
Epoch: 10 cost time: 2.1403090953826904
Epoch: 10, Steps: 9 | Train Loss: 0.403 Vali Loss: 0.622 Vali Acc: 0.746 Test Loss: 0.622 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.1553421020507812
Epoch: 11, Steps: 9 | Train Loss: 0.334 Vali Loss: 0.586 Vali Acc: 0.768 Test Loss: 0.586 Test Acc: 0.768
Validation loss decreased (-0.753617 --> -0.768110).  Saving model ...
Epoch: 12 cost time: 2.1334214210510254
Epoch: 12, Steps: 9 | Train Loss: 0.278 Vali Loss: 0.552 Vali Acc: 0.797 Test Loss: 0.552 Test Acc: 0.797
Validation loss decreased (-0.768110 --> -0.797096).  Saving model ...
Epoch: 13 cost time: 2.1376051902770996
Epoch: 13, Steps: 9 | Train Loss: 0.236 Vali Loss: 0.539 Vali Acc: 0.790 Test Loss: 0.539 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.3879454135894775
Epoch: 14, Steps: 9 | Train Loss: 0.187 Vali Loss: 0.524 Vali Acc: 0.804 Test Loss: 0.524 Test Acc: 0.804
Validation loss decreased (-0.797096 --> -0.804343).  Saving model ...
Epoch: 15 cost time: 2.315016269683838
Epoch: 15, Steps: 9 | Train Loss: 0.141 Vali Loss: 0.538 Vali Acc: 0.812 Test Loss: 0.538 Test Acc: 0.812
Validation loss decreased (-0.804343 --> -0.811589).  Saving model ...
Epoch: 16 cost time: 2.3942408561706543
Epoch: 16, Steps: 9 | Train Loss: 0.111 Vali Loss: 0.509 Vali Acc: 0.819 Test Loss: 0.509 Test Acc: 0.819
Validation loss decreased (-0.811589 --> -0.818835).  Saving model ...
Epoch: 17 cost time: 2.439588785171509
Epoch: 17, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.486 Vali Acc: 0.833 Test Loss: 0.486 Test Acc: 0.833
Validation loss decreased (-0.818835 --> -0.833328).  Saving model ...
Epoch: 18 cost time: 2.642921209335327
Epoch: 18, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.474 Vali Acc: 0.848 Test Loss: 0.474 Test Acc: 0.848
Validation loss decreased (-0.833328 --> -0.847821).  Saving model ...
Epoch: 19 cost time: 2.619983196258545
Epoch: 19, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.549 Vali Acc: 0.790 Test Loss: 0.549 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.473463296890259
Epoch: 20, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.593 Vali Acc: 0.812 Test Loss: 0.593 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.4114553928375244
Epoch: 21, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.616 Vali Acc: 0.812 Test Loss: 0.616 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.5078675746917725
Epoch: 22, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.591 Vali Acc: 0.833 Test Loss: 0.591 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.3358986377716064
Epoch: 23, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.427 Vali Acc: 0.877 Test Loss: 0.427 Test Acc: 0.877
Validation loss decreased (-0.847821 --> -0.876807).  Saving model ...
Epoch: 24 cost time: 2.4111521244049072
Epoch: 24, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.635 Vali Acc: 0.790 Test Loss: 0.635 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.504666328430176
Epoch: 25, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.772 Vali Acc: 0.768 Test Loss: 0.772 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.441981792449951
Epoch: 26, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.822 Vali Acc: 0.783 Test Loss: 0.822 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.5883913040161133
Epoch: 27, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.823 Vali Acc: 0.783 Test Loss: 0.823 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.5067379474639893
Epoch: 28, Steps: 9 | Train Loss: 0.116 Vali Loss: 0.411 Vali Acc: 0.899 Test Loss: 0.411 Test Acc: 0.899
Validation loss decreased (-0.876807 --> -0.898547).  Saving model ...
Epoch: 29 cost time: 2.531989812850952
Epoch: 29, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.424 Vali Acc: 0.891 Test Loss: 0.424 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.5800273418426514
Epoch: 30, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.444 Vali Acc: 0.877 Test Loss: 0.444 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 599924
model size : 2.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.886862277984619
Epoch: 1, Steps: 9 | Train Loss: 1.380 Vali Loss: 1.376 Vali Acc: 0.319 Test Loss: 1.376 Test Acc: 0.319
Validation loss decreased (inf --> -0.318827).  Saving model ...
Epoch: 2 cost time: 1.894840955734253
Epoch: 2, Steps: 9 | Train Loss: 1.283 Vali Loss: 1.285 Vali Acc: 0.420 Test Loss: 1.285 Test Acc: 0.420
Validation loss decreased (-0.318827 --> -0.420277).  Saving model ...
Epoch: 3 cost time: 1.9006965160369873
Epoch: 3, Steps: 9 | Train Loss: 1.167 Vali Loss: 1.193 Vali Acc: 0.529 Test Loss: 1.193 Test Acc: 0.529
Validation loss decreased (-0.420277 --> -0.528974).  Saving model ...
Epoch: 4 cost time: 2.0475761890411377
Epoch: 4, Steps: 9 | Train Loss: 1.030 Vali Loss: 1.084 Vali Acc: 0.594 Test Loss: 1.084 Test Acc: 0.594
Validation loss decreased (-0.528974 --> -0.594192).  Saving model ...
Epoch: 5 cost time: 1.766108751296997
Epoch: 5, Steps: 9 | Train Loss: 0.902 Vali Loss: 0.982 Vali Acc: 0.638 Test Loss: 0.982 Test Acc: 0.638
Validation loss decreased (-0.594192 --> -0.637671).  Saving model ...
Epoch: 6 cost time: 1.6552574634552002
Epoch: 6, Steps: 9 | Train Loss: 0.786 Vali Loss: 0.885 Vali Acc: 0.681 Test Loss: 0.885 Test Acc: 0.681
Validation loss decreased (-0.637671 --> -0.681151).  Saving model ...
Epoch: 7 cost time: 1.7053093910217285
Epoch: 7, Steps: 9 | Train Loss: 0.703 Vali Loss: 0.811 Vali Acc: 0.754 Test Loss: 0.811 Test Acc: 0.754
Validation loss decreased (-0.681151 --> -0.753615).  Saving model ...
Epoch: 8 cost time: 1.6420860290527344
Epoch: 8, Steps: 9 | Train Loss: 0.591 Vali Loss: 0.744 Vali Acc: 0.739 Test Loss: 0.744 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6616895198822021
Epoch: 9, Steps: 9 | Train Loss: 0.491 Vali Loss: 0.677 Vali Acc: 0.768 Test Loss: 0.677 Test Acc: 0.768
Validation loss decreased (-0.753615 --> -0.768109).  Saving model ...
Epoch: 10 cost time: 1.7031104564666748
Epoch: 10, Steps: 9 | Train Loss: 0.406 Vali Loss: 0.623 Vali Acc: 0.783 Test Loss: 0.623 Test Acc: 0.783
Validation loss decreased (-0.768109 --> -0.782602).  Saving model ...
Epoch: 11 cost time: 1.8208212852478027
Epoch: 11, Steps: 9 | Train Loss: 0.327 Vali Loss: 0.586 Vali Acc: 0.790 Test Loss: 0.586 Test Acc: 0.790
Validation loss decreased (-0.782602 --> -0.789849).  Saving model ...
Epoch: 12 cost time: 1.896315574645996
Epoch: 12, Steps: 9 | Train Loss: 0.255 Vali Loss: 0.560 Vali Acc: 0.797 Test Loss: 0.560 Test Acc: 0.797
Validation loss decreased (-0.789849 --> -0.797096).  Saving model ...
Epoch: 13 cost time: 2.0053365230560303
Epoch: 13, Steps: 9 | Train Loss: 0.202 Vali Loss: 0.539 Vali Acc: 0.804 Test Loss: 0.539 Test Acc: 0.804
Validation loss decreased (-0.797096 --> -0.804342).  Saving model ...
Epoch: 14 cost time: 1.8790595531463623
Epoch: 14, Steps: 9 | Train Loss: 0.183 Vali Loss: 0.500 Vali Acc: 0.819 Test Loss: 0.500 Test Acc: 0.819
Validation loss decreased (-0.804342 --> -0.818836).  Saving model ...
Epoch: 15 cost time: 1.975398302078247
Epoch: 15, Steps: 9 | Train Loss: 0.144 Vali Loss: 0.490 Vali Acc: 0.833 Test Loss: 0.490 Test Acc: 0.833
Validation loss decreased (-0.818836 --> -0.833328).  Saving model ...
Epoch: 16 cost time: 1.8428988456726074
Epoch: 16, Steps: 9 | Train Loss: 0.122 Vali Loss: 0.464 Vali Acc: 0.833 Test Loss: 0.464 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833329).  Saving model ...
Epoch: 17 cost time: 2.0845859050750732
Epoch: 17, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.490 Vali Acc: 0.790 Test Loss: 0.490 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8834192752838135
Epoch: 18, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.471 Vali Acc: 0.812 Test Loss: 0.471 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.075110673904419
Epoch: 19, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.456 Vali Acc: 0.804 Test Loss: 0.456 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.951955795288086
Epoch: 20, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.449 Vali Acc: 0.812 Test Loss: 0.449 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.9212498664855957
Epoch: 21, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.467 Vali Acc: 0.812 Test Loss: 0.467 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.6780576705932617
Epoch: 22, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.467 Vali Acc: 0.812 Test Loss: 0.467 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.921285629272461
Epoch: 23, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.432 Vali Acc: 0.819 Test Loss: 0.432 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.9462916851043701
Epoch: 24, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.554 Vali Acc: 0.783 Test Loss: 0.554 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.9142508506774902
Epoch: 25, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.616 Vali Acc: 0.783 Test Loss: 0.616 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.1771345138549805
Epoch: 26, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.623 Vali Acc: 0.790 Test Loss: 0.623 Test Acc: 0.790
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8333333333333334
model parameter : 185972
model size : 1.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 7.889163494110107
Epoch: 1, Steps: 9 | Train Loss: 1.358 Vali Loss: 1.327 Vali Acc: 0.355 Test Loss: 1.327 Test Acc: 0.355
Validation loss decreased (inf --> -0.355059).  Saving model ...
Epoch: 2 cost time: 5.855941295623779
Epoch: 2, Steps: 9 | Train Loss: 1.278 Vali Loss: 1.269 Vali Acc: 0.457 Test Loss: 1.269 Test Acc: 0.457
Validation loss decreased (-0.355059 --> -0.456509).  Saving model ...
Epoch: 3 cost time: 6.236000299453735
Epoch: 3, Steps: 9 | Train Loss: 1.227 Vali Loss: 1.192 Vali Acc: 0.558 Test Loss: 1.192 Test Acc: 0.558
Validation loss decreased (-0.456509 --> -0.557959).  Saving model ...
Epoch: 4 cost time: 6.155733108520508
Epoch: 4, Steps: 9 | Train Loss: 1.098 Vali Loss: 1.094 Vali Acc: 0.558 Test Loss: 1.094 Test Acc: 0.558
Validation loss decreased (-0.557959 --> -0.557960).  Saving model ...
Epoch: 5 cost time: 6.251351594924927
Epoch: 5, Steps: 9 | Train Loss: 0.956 Vali Loss: 0.970 Vali Acc: 0.609 Test Loss: 0.970 Test Acc: 0.609
Validation loss decreased (-0.557960 --> -0.608686).  Saving model ...
Epoch: 6 cost time: 6.122553825378418
Epoch: 6, Steps: 9 | Train Loss: 0.803 Vali Loss: 0.808 Vali Acc: 0.688 Test Loss: 0.808 Test Acc: 0.688
Validation loss decreased (-0.608686 --> -0.688398).  Saving model ...
Epoch: 7 cost time: 6.039262771606445
Epoch: 7, Steps: 9 | Train Loss: 0.679 Vali Loss: 0.686 Vali Acc: 0.746 Test Loss: 0.686 Test Acc: 0.746
Validation loss decreased (-0.688398 --> -0.746370).  Saving model ...
Epoch: 8 cost time: 6.228075265884399
Epoch: 8, Steps: 9 | Train Loss: 0.578 Vali Loss: 0.593 Vali Acc: 0.790 Test Loss: 0.593 Test Acc: 0.790
Validation loss decreased (-0.746370 --> -0.789849).  Saving model ...
Epoch: 9 cost time: 6.075411081314087
Epoch: 9, Steps: 9 | Train Loss: 0.497 Vali Loss: 0.528 Vali Acc: 0.812 Test Loss: 0.528 Test Acc: 0.812
Validation loss decreased (-0.789849 --> -0.811589).  Saving model ...
Epoch: 10 cost time: 6.042417764663696
Epoch: 10, Steps: 9 | Train Loss: 0.407 Vali Loss: 0.562 Vali Acc: 0.790 Test Loss: 0.562 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.896749019622803
Epoch: 11, Steps: 9 | Train Loss: 0.390 Vali Loss: 0.467 Vali Acc: 0.804 Test Loss: 0.467 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.79368782043457
Epoch: 12, Steps: 9 | Train Loss: 0.310 Vali Loss: 0.445 Vali Acc: 0.826 Test Loss: 0.445 Test Acc: 0.826
Validation loss decreased (-0.811589 --> -0.826083).  Saving model ...
Epoch: 13 cost time: 6.043489456176758
Epoch: 13, Steps: 9 | Train Loss: 0.285 Vali Loss: 0.388 Vali Acc: 0.855 Test Loss: 0.388 Test Acc: 0.855
Validation loss decreased (-0.826083 --> -0.855069).  Saving model ...
Epoch: 14 cost time: 6.072868824005127
Epoch: 14, Steps: 9 | Train Loss: 0.238 Vali Loss: 0.364 Vali Acc: 0.855 Test Loss: 0.364 Test Acc: 0.855
Validation loss decreased (-0.855069 --> -0.855069).  Saving model ...
Epoch: 15 cost time: 6.083892822265625
Epoch: 15, Steps: 9 | Train Loss: 0.200 Vali Loss: 0.356 Vali Acc: 0.862 Test Loss: 0.356 Test Acc: 0.862
Validation loss decreased (-0.855069 --> -0.862315).  Saving model ...
Epoch: 16 cost time: 5.821115493774414
Epoch: 16, Steps: 9 | Train Loss: 0.190 Vali Loss: 0.434 Vali Acc: 0.819 Test Loss: 0.434 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.781548261642456
Epoch: 17, Steps: 9 | Train Loss: 0.143 Vali Loss: 0.358 Vali Acc: 0.862 Test Loss: 0.358 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.119302272796631
Epoch: 18, Steps: 9 | Train Loss: 0.131 Vali Loss: 0.309 Vali Acc: 0.899 Test Loss: 0.309 Test Acc: 0.899
Validation loss decreased (-0.862315 --> -0.898548).  Saving model ...
Epoch: 19 cost time: 5.094690799713135
Epoch: 19, Steps: 9 | Train Loss: 0.118 Vali Loss: 0.379 Vali Acc: 0.848 Test Loss: 0.379 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.870528221130371
Epoch: 20, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.369 Vali Acc: 0.848 Test Loss: 0.369 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.606333255767822
Epoch: 21, Steps: 9 | Train Loss: 0.131 Vali Loss: 0.376 Vali Acc: 0.848 Test Loss: 0.376 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 5.585130929946899
Epoch: 22, Steps: 9 | Train Loss: 0.111 Vali Loss: 0.343 Vali Acc: 0.833 Test Loss: 0.343 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 5.68009614944458
Epoch: 23, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.482 Vali Acc: 0.804 Test Loss: 0.482 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 5.486095190048218
Epoch: 24, Steps: 9 | Train Loss: 0.094 Vali Loss: 0.343 Vali Acc: 0.855 Test Loss: 0.343 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 5.681148529052734
Epoch: 25, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.385 Vali Acc: 0.819 Test Loss: 0.385 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 5.622851371765137
Epoch: 26, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.357 Vali Acc: 0.884 Test Loss: 0.357 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 5.629734754562378
Epoch: 27, Steps: 9 | Train Loss: 0.086 Vali Loss: 0.447 Vali Acc: 0.848 Test Loss: 0.447 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 5.696798801422119
Epoch: 28, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.384 Vali Acc: 0.862 Test Loss: 0.384 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 1179900
model size : 4.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 6.211210250854492
Epoch: 1, Steps: 9 | Train Loss: 1.433 Vali Loss: 1.397 Vali Acc: 0.304 Test Loss: 1.397 Test Acc: 0.304
Validation loss decreased (inf --> -0.304334).  Saving model ...
Epoch: 2 cost time: 3.9088847637176514
Epoch: 2, Steps: 9 | Train Loss: 1.361 Vali Loss: 1.346 Vali Acc: 0.420 Test Loss: 1.346 Test Acc: 0.420
Validation loss decreased (-0.304334 --> -0.420276).  Saving model ...
Epoch: 3 cost time: 3.664097547531128
Epoch: 3, Steps: 9 | Train Loss: 1.253 Vali Loss: 1.293 Vali Acc: 0.543 Test Loss: 1.293 Test Acc: 0.543
Validation loss decreased (-0.420276 --> -0.543465).  Saving model ...
Epoch: 4 cost time: 3.602421283721924
Epoch: 4, Steps: 9 | Train Loss: 1.170 Vali Loss: 1.240 Vali Acc: 0.551 Test Loss: 1.240 Test Acc: 0.551
Validation loss decreased (-0.543465 --> -0.550712).  Saving model ...
Epoch: 5 cost time: 3.6508822441101074
Epoch: 5, Steps: 9 | Train Loss: 1.056 Vali Loss: 1.163 Vali Acc: 0.580 Test Loss: 1.163 Test Acc: 0.580
Validation loss decreased (-0.550712 --> -0.579699).  Saving model ...
Epoch: 6 cost time: 4.622293472290039
Epoch: 6, Steps: 9 | Train Loss: 0.929 Vali Loss: 1.037 Vali Acc: 0.645 Test Loss: 1.037 Test Acc: 0.645
Validation loss decreased (-0.579699 --> -0.644917).  Saving model ...
Epoch: 7 cost time: 4.342434644699097
Epoch: 7, Steps: 9 | Train Loss: 0.782 Vali Loss: 0.904 Vali Acc: 0.645 Test Loss: 0.904 Test Acc: 0.645
Validation loss decreased (-0.644917 --> -0.644918).  Saving model ...
Epoch: 8 cost time: 4.628098726272583
Epoch: 8, Steps: 9 | Train Loss: 0.654 Vali Loss: 0.814 Vali Acc: 0.616 Test Loss: 0.814 Test Acc: 0.616
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.248752117156982
Epoch: 9, Steps: 9 | Train Loss: 0.561 Vali Loss: 0.689 Vali Acc: 0.768 Test Loss: 0.689 Test Acc: 0.768
Validation loss decreased (-0.644918 --> -0.768109).  Saving model ...
Epoch: 10 cost time: 4.516600847244263
Epoch: 10, Steps: 9 | Train Loss: 0.462 Vali Loss: 0.627 Vali Acc: 0.761 Test Loss: 0.627 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.341858863830566
Epoch: 11, Steps: 9 | Train Loss: 0.367 Vali Loss: 0.550 Vali Acc: 0.804 Test Loss: 0.550 Test Acc: 0.804
Validation loss decreased (-0.768109 --> -0.804342).  Saving model ...
Epoch: 12 cost time: 4.566685199737549
Epoch: 12, Steps: 9 | Train Loss: 0.296 Vali Loss: 0.471 Vali Acc: 0.804 Test Loss: 0.471 Test Acc: 0.804
Validation loss decreased (-0.804342 --> -0.804343).  Saving model ...
Epoch: 13 cost time: 4.205145597457886
Epoch: 13, Steps: 9 | Train Loss: 0.254 Vali Loss: 0.421 Vali Acc: 0.826 Test Loss: 0.421 Test Acc: 0.826
Validation loss decreased (-0.804343 --> -0.826083).  Saving model ...
Epoch: 14 cost time: 4.5890936851501465
Epoch: 14, Steps: 9 | Train Loss: 0.192 Vali Loss: 0.400 Vali Acc: 0.833 Test Loss: 0.400 Test Acc: 0.833
Validation loss decreased (-0.826083 --> -0.833329).  Saving model ...
Epoch: 15 cost time: 4.14977502822876
Epoch: 15, Steps: 9 | Train Loss: 0.146 Vali Loss: 0.392 Vali Acc: 0.833 Test Loss: 0.392 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 16 cost time: 4.4229137897491455
Epoch: 16, Steps: 9 | Train Loss: 0.132 Vali Loss: 0.352 Vali Acc: 0.862 Test Loss: 0.352 Test Acc: 0.862
Validation loss decreased (-0.833329 --> -0.862315).  Saving model ...
Epoch: 17 cost time: 4.035552263259888
Epoch: 17, Steps: 9 | Train Loss: 0.123 Vali Loss: 0.338 Vali Acc: 0.870 Test Loss: 0.338 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869562).  Saving model ...
Epoch: 18 cost time: 4.35810923576355
Epoch: 18, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.347 Vali Acc: 0.848 Test Loss: 0.347 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.9331741333007812
Epoch: 19, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.344 Vali Acc: 0.855 Test Loss: 0.344 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.364223003387451
Epoch: 20, Steps: 9 | Train Loss: 0.096 Vali Loss: 0.342 Vali Acc: 0.862 Test Loss: 0.342 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.234158277511597
Epoch: 21, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.379 Vali Acc: 0.841 Test Loss: 0.379 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.15254545211792
Epoch: 22, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.348 Vali Acc: 0.862 Test Loss: 0.348 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.026885509490967
Epoch: 23, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.307 Vali Acc: 0.891 Test Loss: 0.307 Test Acc: 0.891
Validation loss decreased (-0.869562 --> -0.891301).  Saving model ...
Epoch: 24 cost time: 4.116268873214722
Epoch: 24, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.278 Vali Acc: 0.884 Test Loss: 0.278 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.075278997421265
Epoch: 25, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.365 Vali Acc: 0.891 Test Loss: 0.365 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 4.081393480300903
Epoch: 26, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.384 Vali Acc: 0.862 Test Loss: 0.384 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 4.120939016342163
Epoch: 27, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.351 Vali Acc: 0.862 Test Loss: 0.351 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.8574116230010986
Epoch: 28, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.327 Vali Acc: 0.870 Test Loss: 0.327 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 4.308964729309082
Epoch: 29, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.294 Vali Acc: 0.891 Test Loss: 0.294 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 30 cost time: 3.9380404949188232
Epoch: 30, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.304 Vali Acc: 0.906 Test Loss: 0.304 Test Acc: 0.906
Validation loss decreased (-0.891301 --> -0.905794).  Saving model ...
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 351932
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 6.386742353439331
Epoch: 1, Steps: 9 | Train Loss: 1.363 Vali Loss: 1.327 Vali Acc: 0.348 Test Loss: 1.327 Test Acc: 0.348
Validation loss decreased (inf --> -0.347813).  Saving model ...
Epoch: 2 cost time: 4.354655027389526
Epoch: 2, Steps: 9 | Train Loss: 1.284 Vali Loss: 1.270 Vali Acc: 0.435 Test Loss: 1.270 Test Acc: 0.435
Validation loss decreased (-0.347813 --> -0.434770).  Saving model ...
Epoch: 3 cost time: 4.474099159240723
Epoch: 3, Steps: 9 | Train Loss: 1.233 Vali Loss: 1.192 Vali Acc: 0.551 Test Loss: 1.192 Test Acc: 0.551
Validation loss decreased (-0.434770 --> -0.550713).  Saving model ...
Epoch: 4 cost time: 4.258373498916626
Epoch: 4, Steps: 9 | Train Loss: 1.108 Vali Loss: 1.099 Vali Acc: 0.551 Test Loss: 1.099 Test Acc: 0.551
Validation loss decreased (-0.550713 --> -0.550714).  Saving model ...
Epoch: 5 cost time: 4.299199819564819
Epoch: 5, Steps: 9 | Train Loss: 0.972 Vali Loss: 0.968 Vali Acc: 0.623 Test Loss: 0.968 Test Acc: 0.623
Validation loss decreased (-0.550714 --> -0.623179).  Saving model ...
Epoch: 6 cost time: 4.2776265144348145
Epoch: 6, Steps: 9 | Train Loss: 0.815 Vali Loss: 0.812 Vali Acc: 0.688 Test Loss: 0.812 Test Acc: 0.688
Validation loss decreased (-0.623179 --> -0.688398).  Saving model ...
Epoch: 7 cost time: 4.387250900268555
Epoch: 7, Steps: 9 | Train Loss: 0.734 Vali Loss: 0.663 Vali Acc: 0.790 Test Loss: 0.663 Test Acc: 0.790
Validation loss decreased (-0.688398 --> -0.789848).  Saving model ...
Epoch: 8 cost time: 3.8326668739318848
Epoch: 8, Steps: 9 | Train Loss: 0.652 Vali Loss: 0.612 Vali Acc: 0.790 Test Loss: 0.612 Test Acc: 0.790
Validation loss decreased (-0.789848 --> -0.789849).  Saving model ...
Epoch: 9 cost time: 4.388735294342041
Epoch: 9, Steps: 9 | Train Loss: 0.549 Vali Loss: 0.568 Vali Acc: 0.833 Test Loss: 0.568 Test Acc: 0.833
Validation loss decreased (-0.789849 --> -0.833328).  Saving model ...
Epoch: 10 cost time: 3.972303867340088
Epoch: 10, Steps: 9 | Train Loss: 0.501 Vali Loss: 0.570 Vali Acc: 0.768 Test Loss: 0.570 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.4638352394104
Epoch: 11, Steps: 9 | Train Loss: 0.449 Vali Loss: 0.492 Vali Acc: 0.812 Test Loss: 0.492 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.15458869934082
Epoch: 12, Steps: 9 | Train Loss: 0.357 Vali Loss: 0.475 Vali Acc: 0.790 Test Loss: 0.475 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.4355785846710205
Epoch: 13, Steps: 9 | Train Loss: 0.296 Vali Loss: 0.381 Vali Acc: 0.870 Test Loss: 0.381 Test Acc: 0.870
Validation loss decreased (-0.833328 --> -0.869561).  Saving model ...
Epoch: 14 cost time: 4.419734716415405
Epoch: 14, Steps: 9 | Train Loss: 0.287 Vali Loss: 0.404 Vali Acc: 0.833 Test Loss: 0.404 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.233513832092285
Epoch: 15, Steps: 9 | Train Loss: 0.251 Vali Loss: 0.636 Vali Acc: 0.732 Test Loss: 0.636 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.328412294387817
Epoch: 16, Steps: 9 | Train Loss: 0.263 Vali Loss: 0.431 Vali Acc: 0.833 Test Loss: 0.431 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.437684774398804
Epoch: 17, Steps: 9 | Train Loss: 0.165 Vali Loss: 0.342 Vali Acc: 0.884 Test Loss: 0.342 Test Acc: 0.884
Validation loss decreased (-0.869561 --> -0.884055).  Saving model ...
Epoch: 18 cost time: 4.459608793258667
Epoch: 18, Steps: 9 | Train Loss: 0.148 Vali Loss: 0.353 Vali Acc: 0.870 Test Loss: 0.353 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.27016019821167
Epoch: 19, Steps: 9 | Train Loss: 0.149 Vali Loss: 0.350 Vali Acc: 0.906 Test Loss: 0.350 Test Acc: 0.906
Validation loss decreased (-0.884055 --> -0.905794).  Saving model ...
Epoch: 20 cost time: 4.456551551818848
Epoch: 20, Steps: 9 | Train Loss: 0.122 Vali Loss: 0.372 Vali Acc: 0.870 Test Loss: 0.372 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.350774049758911
Epoch: 21, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.345 Vali Acc: 0.877 Test Loss: 0.345 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.633545875549316
Epoch: 22, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.353 Vali Acc: 0.877 Test Loss: 0.353 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.224005460739136
Epoch: 23, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.403 Vali Acc: 0.848 Test Loss: 0.403 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 4.370159864425659
Epoch: 24, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.457 Vali Acc: 0.848 Test Loss: 0.457 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 4.250315189361572
Epoch: 25, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.370 Vali Acc: 0.877 Test Loss: 0.370 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 4.436731338500977
Epoch: 26, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.372 Vali Acc: 0.877 Test Loss: 0.372 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 4.165406227111816
Epoch: 27, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.419 Vali Acc: 0.877 Test Loss: 0.419 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 4.504641771316528
Epoch: 28, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.347 Vali Acc: 0.862 Test Loss: 0.347 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 4.209696292877197
Epoch: 29, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.274 Vali Acc: 0.906 Test Loss: 0.274 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 30 cost time: 4.378763198852539
Epoch: 30, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.300 Vali Acc: 0.891 Test Loss: 0.300 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 1179900
model size : 4.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.345865726470947
Epoch: 1, Steps: 9 | Train Loss: 1.433 Vali Loss: 1.390 Vali Acc: 0.304 Test Loss: 1.390 Test Acc: 0.304
Validation loss decreased (inf --> -0.304334).  Saving model ...
Epoch: 2 cost time: 2.756645917892456
Epoch: 2, Steps: 9 | Train Loss: 1.364 Vali Loss: 1.339 Vali Acc: 0.435 Test Loss: 1.339 Test Acc: 0.435
Validation loss decreased (-0.304334 --> -0.434769).  Saving model ...
Epoch: 3 cost time: 3.19095778465271
Epoch: 3, Steps: 9 | Train Loss: 1.244 Vali Loss: 1.286 Vali Acc: 0.522 Test Loss: 1.286 Test Acc: 0.522
Validation loss decreased (-0.434769 --> -0.521726).  Saving model ...
Epoch: 4 cost time: 3.0894806385040283
Epoch: 4, Steps: 9 | Train Loss: 1.165 Vali Loss: 1.231 Vali Acc: 0.580 Test Loss: 1.231 Test Acc: 0.580
Validation loss decreased (-0.521726 --> -0.579698).  Saving model ...
Epoch: 5 cost time: 3.2019965648651123
Epoch: 5, Steps: 9 | Train Loss: 1.054 Vali Loss: 1.152 Vali Acc: 0.587 Test Loss: 1.152 Test Acc: 0.587
Validation loss decreased (-0.579698 --> -0.586945).  Saving model ...
Epoch: 6 cost time: 3.201406478881836
Epoch: 6, Steps: 9 | Train Loss: 0.919 Vali Loss: 1.025 Vali Acc: 0.652 Test Loss: 1.025 Test Acc: 0.652
Validation loss decreased (-0.586945 --> -0.652164).  Saving model ...
Epoch: 7 cost time: 3.1858906745910645
Epoch: 7, Steps: 9 | Train Loss: 0.792 Vali Loss: 0.908 Vali Acc: 0.609 Test Loss: 0.908 Test Acc: 0.609
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.5113296508789062
Epoch: 8, Steps: 9 | Train Loss: 0.653 Vali Loss: 0.817 Vali Acc: 0.667 Test Loss: 0.817 Test Acc: 0.667
Validation loss decreased (-0.652164 --> -0.666658).  Saving model ...
Epoch: 9 cost time: 3.101465940475464
Epoch: 9, Steps: 9 | Train Loss: 0.566 Vali Loss: 0.706 Vali Acc: 0.703 Test Loss: 0.706 Test Acc: 0.703
Validation loss decreased (-0.666658 --> -0.702891).  Saving model ...
Epoch: 10 cost time: 3.1894402503967285
Epoch: 10, Steps: 9 | Train Loss: 0.462 Vali Loss: 0.623 Vali Acc: 0.725 Test Loss: 0.623 Test Acc: 0.725
Validation loss decreased (-0.702891 --> -0.724631).  Saving model ...
Epoch: 11 cost time: 3.0138185024261475
Epoch: 11, Steps: 9 | Train Loss: 0.405 Vali Loss: 0.544 Vali Acc: 0.826 Test Loss: 0.544 Test Acc: 0.826
Validation loss decreased (-0.724631 --> -0.826082).  Saving model ...
Epoch: 12 cost time: 3.1781084537506104
Epoch: 12, Steps: 9 | Train Loss: 0.307 Vali Loss: 0.457 Vali Acc: 0.826 Test Loss: 0.457 Test Acc: 0.826
Validation loss decreased (-0.826082 --> -0.826082).  Saving model ...
Epoch: 13 cost time: 3.255542278289795
Epoch: 13, Steps: 9 | Train Loss: 0.293 Vali Loss: 0.428 Vali Acc: 0.870 Test Loss: 0.428 Test Acc: 0.870
Validation loss decreased (-0.826082 --> -0.869561).  Saving model ...
Epoch: 14 cost time: 3.2687766551971436
Epoch: 14, Steps: 9 | Train Loss: 0.248 Vali Loss: 0.412 Vali Acc: 0.855 Test Loss: 0.412 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.402869701385498
Epoch: 15, Steps: 9 | Train Loss: 0.197 Vali Loss: 0.403 Vali Acc: 0.841 Test Loss: 0.403 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.1967594623565674
Epoch: 16, Steps: 9 | Train Loss: 0.160 Vali Loss: 0.375 Vali Acc: 0.870 Test Loss: 0.375 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 17 cost time: 3.3242745399475098
Epoch: 17, Steps: 9 | Train Loss: 0.193 Vali Loss: 0.305 Vali Acc: 0.906 Test Loss: 0.305 Test Acc: 0.906
Validation loss decreased (-0.869561 --> -0.905794).  Saving model ...
Epoch: 18 cost time: 3.222696304321289
Epoch: 18, Steps: 9 | Train Loss: 0.128 Vali Loss: 0.351 Vali Acc: 0.884 Test Loss: 0.351 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.1092052459716797
Epoch: 19, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.310 Vali Acc: 0.891 Test Loss: 0.310 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.348410129547119
Epoch: 20, Steps: 9 | Train Loss: 0.109 Vali Loss: 0.320 Vali Acc: 0.891 Test Loss: 0.320 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.2863972187042236
Epoch: 21, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.277 Vali Acc: 0.899 Test Loss: 0.277 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.404404401779175
Epoch: 22, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.270 Vali Acc: 0.891 Test Loss: 0.270 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.3260445594787598
Epoch: 23, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.273 Vali Acc: 0.920 Test Loss: 0.273 Test Acc: 0.920
Validation loss decreased (-0.905794 --> -0.920287).  Saving model ...
Epoch: 24 cost time: 3.2695069313049316
Epoch: 24, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.285 Vali Acc: 0.906 Test Loss: 0.285 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.135761260986328
Epoch: 25, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.313 Vali Acc: 0.906 Test Loss: 0.313 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.2101399898529053
Epoch: 26, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.293 Vali Acc: 0.913 Test Loss: 0.293 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.334127902984619
Epoch: 27, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.285 Vali Acc: 0.920 Test Loss: 0.285 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.146357536315918
Epoch: 28, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.270 Vali Acc: 0.928 Test Loss: 0.270 Test Acc: 0.928
Validation loss decreased (-0.920287 --> -0.927534).  Saving model ...
Epoch: 29 cost time: 3.321094274520874
Epoch: 29, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.284 Vali Acc: 0.928 Test Loss: 0.284 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.476447343826294
Epoch: 30, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.283 Vali Acc: 0.920 Test Loss: 0.283 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.927536231884058
model parameter : 351932
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.967884063720703
Epoch: 1, Steps: 9 | Train Loss: 1.372 Vali Loss: 1.318 Vali Acc: 0.355 Test Loss: 1.318 Test Acc: 0.355
Validation loss decreased (inf --> -0.355059).  Saving model ...
Epoch: 2 cost time: 2.9868597984313965
Epoch: 2, Steps: 9 | Train Loss: 1.299 Vali Loss: 1.270 Vali Acc: 0.428 Test Loss: 1.270 Test Acc: 0.428
Validation loss decreased (-0.355059 --> -0.427524).  Saving model ...
Epoch: 3 cost time: 2.899688959121704
Epoch: 3, Steps: 9 | Train Loss: 1.261 Vali Loss: 1.201 Vali Acc: 0.514 Test Loss: 1.201 Test Acc: 0.514
Validation loss decreased (-0.427524 --> -0.514481).  Saving model ...
Epoch: 4 cost time: 2.974907159805298
Epoch: 4, Steps: 9 | Train Loss: 1.147 Vali Loss: 1.136 Vali Acc: 0.507 Test Loss: 1.136 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.2404611110687256
Epoch: 5, Steps: 9 | Train Loss: 1.051 Vali Loss: 1.032 Vali Acc: 0.543 Test Loss: 1.032 Test Acc: 0.543
Validation loss decreased (-0.514481 --> -0.543468).  Saving model ...
Epoch: 6 cost time: 2.5512099266052246
Epoch: 6, Steps: 9 | Train Loss: 0.903 Vali Loss: 0.905 Vali Acc: 0.594 Test Loss: 0.905 Test Acc: 0.594
Validation loss decreased (-0.543468 --> -0.594194).  Saving model ...
Epoch: 7 cost time: 2.5937459468841553
Epoch: 7, Steps: 9 | Train Loss: 0.842 Vali Loss: 0.810 Vali Acc: 0.696 Test Loss: 0.810 Test Acc: 0.696
Validation loss decreased (-0.594194 --> -0.695644).  Saving model ...
Epoch: 8 cost time: 2.5352017879486084
Epoch: 8, Steps: 9 | Train Loss: 0.735 Vali Loss: 0.741 Vali Acc: 0.739 Test Loss: 0.741 Test Acc: 0.739
Validation loss decreased (-0.695644 --> -0.739123).  Saving model ...
Epoch: 9 cost time: 2.7410006523132324
Epoch: 9, Steps: 9 | Train Loss: 0.640 Vali Loss: 0.703 Vali Acc: 0.746 Test Loss: 0.703 Test Acc: 0.746
Validation loss decreased (-0.739123 --> -0.746370).  Saving model ...
Epoch: 10 cost time: 2.9985945224761963
Epoch: 10, Steps: 9 | Train Loss: 0.633 Vali Loss: 0.698 Vali Acc: 0.674 Test Loss: 0.698 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.0219807624816895
Epoch: 11, Steps: 9 | Train Loss: 0.517 Vali Loss: 0.665 Vali Acc: 0.768 Test Loss: 0.665 Test Acc: 0.768
Validation loss decreased (-0.746370 --> -0.768109).  Saving model ...
Epoch: 12 cost time: 2.8719258308410645
Epoch: 12, Steps: 9 | Train Loss: 0.470 Vali Loss: 0.613 Vali Acc: 0.754 Test Loss: 0.613 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.058481454849243
Epoch: 13, Steps: 9 | Train Loss: 0.434 Vali Loss: 0.606 Vali Acc: 0.761 Test Loss: 0.606 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.688450336456299
Epoch: 14, Steps: 9 | Train Loss: 0.360 Vali Loss: 0.568 Vali Acc: 0.783 Test Loss: 0.568 Test Acc: 0.783
Validation loss decreased (-0.768109 --> -0.782603).  Saving model ...
Epoch: 15 cost time: 3.074678659439087
Epoch: 15, Steps: 9 | Train Loss: 0.330 Vali Loss: 0.484 Vali Acc: 0.783 Test Loss: 0.484 Test Acc: 0.783
Validation loss decreased (-0.782603 --> -0.782604).  Saving model ...
Epoch: 16 cost time: 2.8108084201812744
Epoch: 16, Steps: 9 | Train Loss: 0.244 Vali Loss: 0.370 Vali Acc: 0.870 Test Loss: 0.370 Test Acc: 0.870
Validation loss decreased (-0.782604 --> -0.869562).  Saving model ...
Epoch: 17 cost time: 3.1655659675598145
Epoch: 17, Steps: 9 | Train Loss: 0.226 Vali Loss: 0.451 Vali Acc: 0.833 Test Loss: 0.451 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.086993932723999
Epoch: 18, Steps: 9 | Train Loss: 0.268 Vali Loss: 0.452 Vali Acc: 0.833 Test Loss: 0.452 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.324162006378174
Epoch: 19, Steps: 9 | Train Loss: 0.193 Vali Loss: 0.330 Vali Acc: 0.877 Test Loss: 0.330 Test Acc: 0.877
Validation loss decreased (-0.869562 --> -0.876808).  Saving model ...
Epoch: 20 cost time: 3.090975522994995
Epoch: 20, Steps: 9 | Train Loss: 0.231 Vali Loss: 0.356 Vali Acc: 0.855 Test Loss: 0.356 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.425525665283203
Epoch: 21, Steps: 9 | Train Loss: 0.197 Vali Loss: 0.424 Vali Acc: 0.826 Test Loss: 0.424 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.0268540382385254
Epoch: 22, Steps: 9 | Train Loss: 0.160 Vali Loss: 0.403 Vali Acc: 0.833 Test Loss: 0.403 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.2896335124969482
Epoch: 23, Steps: 9 | Train Loss: 0.151 Vali Loss: 0.399 Vali Acc: 0.855 Test Loss: 0.399 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.0762574672698975
Epoch: 24, Steps: 9 | Train Loss: 0.169 Vali Loss: 0.486 Vali Acc: 0.783 Test Loss: 0.486 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.4739787578582764
Epoch: 25, Steps: 9 | Train Loss: 0.136 Vali Loss: 0.467 Vali Acc: 0.804 Test Loss: 0.467 Test Acc: 0.804
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.0639405250549316
Epoch: 26, Steps: 9 | Train Loss: 0.116 Vali Loss: 0.350 Vali Acc: 0.877 Test Loss: 0.350 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.1952223777770996
Epoch: 27, Steps: 9 | Train Loss: 0.150 Vali Loss: 0.326 Vali Acc: 0.870 Test Loss: 0.326 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.151893138885498
Epoch: 28, Steps: 9 | Train Loss: 0.121 Vali Loss: 0.386 Vali Acc: 0.848 Test Loss: 0.386 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.3815999031066895
Epoch: 29, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.358 Vali Acc: 0.862 Test Loss: 0.358 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 1179900
model size : 4.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.869435787200928
Epoch: 1, Steps: 9 | Train Loss: 1.445 Vali Loss: 1.394 Vali Acc: 0.304 Test Loss: 1.394 Test Acc: 0.304
Validation loss decreased (inf --> -0.304334).  Saving model ...
Epoch: 2 cost time: 2.713609457015991
Epoch: 2, Steps: 9 | Train Loss: 1.377 Vali Loss: 1.359 Vali Acc: 0.370 Test Loss: 1.359 Test Acc: 0.370
Validation loss decreased (-0.304334 --> -0.369552).  Saving model ...
Epoch: 3 cost time: 2.9227800369262695
Epoch: 3, Steps: 9 | Train Loss: 1.269 Vali Loss: 1.322 Vali Acc: 0.486 Test Loss: 1.322 Test Acc: 0.486
Validation loss decreased (-0.369552 --> -0.485494).  Saving model ...
Epoch: 4 cost time: 2.7078559398651123
Epoch: 4, Steps: 9 | Train Loss: 1.205 Vali Loss: 1.298 Vali Acc: 0.406 Test Loss: 1.298 Test Acc: 0.406
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.742170810699463
Epoch: 5, Steps: 9 | Train Loss: 1.095 Vali Loss: 1.252 Vali Acc: 0.428 Test Loss: 1.252 Test Acc: 0.428
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.8782222270965576
Epoch: 6, Steps: 9 | Train Loss: 0.984 Vali Loss: 1.151 Vali Acc: 0.522 Test Loss: 1.151 Test Acc: 0.522
Validation loss decreased (-0.485494 --> -0.521728).  Saving model ...
Epoch: 7 cost time: 2.6412572860717773
Epoch: 7, Steps: 9 | Train Loss: 0.846 Vali Loss: 1.025 Vali Acc: 0.601 Test Loss: 1.025 Test Acc: 0.601
Validation loss decreased (-0.521728 --> -0.601439).  Saving model ...
Epoch: 8 cost time: 2.7643210887908936
Epoch: 8, Steps: 9 | Train Loss: 0.721 Vali Loss: 0.932 Vali Acc: 0.558 Test Loss: 0.932 Test Acc: 0.558
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.638051986694336
Epoch: 9, Steps: 9 | Train Loss: 0.680 Vali Loss: 0.784 Vali Acc: 0.710 Test Loss: 0.784 Test Acc: 0.710
Validation loss decreased (-0.601439 --> -0.710137).  Saving model ...
Epoch: 10 cost time: 2.8504157066345215
Epoch: 10, Steps: 9 | Train Loss: 0.557 Vali Loss: 0.733 Vali Acc: 0.717 Test Loss: 0.733 Test Acc: 0.717
Validation loss decreased (-0.710137 --> -0.717384).  Saving model ...
Epoch: 11 cost time: 2.7535409927368164
Epoch: 11, Steps: 9 | Train Loss: 0.470 Vali Loss: 0.695 Vali Acc: 0.725 Test Loss: 0.695 Test Acc: 0.725
Validation loss decreased (-0.717384 --> -0.724631).  Saving model ...
Epoch: 12 cost time: 2.857693910598755
Epoch: 12, Steps: 9 | Train Loss: 0.431 Vali Loss: 0.601 Vali Acc: 0.790 Test Loss: 0.601 Test Acc: 0.790
Validation loss decreased (-0.724631 --> -0.789849).  Saving model ...
Epoch: 13 cost time: 2.3715479373931885
Epoch: 13, Steps: 9 | Train Loss: 0.380 Vali Loss: 0.611 Vali Acc: 0.768 Test Loss: 0.611 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.955408811569214
Epoch: 14, Steps: 9 | Train Loss: 0.345 Vali Loss: 0.534 Vali Acc: 0.841 Test Loss: 0.534 Test Acc: 0.841
Validation loss decreased (-0.789849 --> -0.840574).  Saving model ...
Epoch: 15 cost time: 2.71468186378479
Epoch: 15, Steps: 9 | Train Loss: 0.270 Vali Loss: 0.497 Vali Acc: 0.812 Test Loss: 0.497 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.834263324737549
Epoch: 16, Steps: 9 | Train Loss: 0.247 Vali Loss: 0.462 Vali Acc: 0.833 Test Loss: 0.462 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.580336332321167
Epoch: 17, Steps: 9 | Train Loss: 0.209 Vali Loss: 0.443 Vali Acc: 0.833 Test Loss: 0.443 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.8207788467407227
Epoch: 18, Steps: 9 | Train Loss: 0.231 Vali Loss: 0.439 Vali Acc: 0.841 Test Loss: 0.439 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840575).  Saving model ...
Epoch: 19 cost time: 2.5376391410827637
Epoch: 19, Steps: 9 | Train Loss: 0.163 Vali Loss: 0.423 Vali Acc: 0.848 Test Loss: 0.423 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847822).  Saving model ...
Epoch: 20 cost time: 2.7067131996154785
Epoch: 20, Steps: 9 | Train Loss: 0.169 Vali Loss: 0.425 Vali Acc: 0.870 Test Loss: 0.425 Test Acc: 0.870
Validation loss decreased (-0.847822 --> -0.869561).  Saving model ...
Epoch: 21 cost time: 2.6472835540771484
Epoch: 21, Steps: 9 | Train Loss: 0.183 Vali Loss: 0.362 Vali Acc: 0.877 Test Loss: 0.362 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876808).  Saving model ...
Epoch: 22 cost time: 2.5137524604797363
Epoch: 22, Steps: 9 | Train Loss: 0.119 Vali Loss: 0.377 Vali Acc: 0.870 Test Loss: 0.377 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.656792402267456
Epoch: 23, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.391 Vali Acc: 0.855 Test Loss: 0.391 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.4960992336273193
Epoch: 24, Steps: 9 | Train Loss: 0.080 Vali Loss: 0.346 Vali Acc: 0.862 Test Loss: 0.346 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.6074767112731934
Epoch: 25, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.347 Vali Acc: 0.870 Test Loss: 0.347 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.4329299926757812
Epoch: 26, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.320 Vali Acc: 0.877 Test Loss: 0.320 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 27 cost time: 2.7355730533599854
Epoch: 27, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.305 Vali Acc: 0.877 Test Loss: 0.305 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876809).  Saving model ...
Epoch: 28 cost time: 2.6004514694213867
Epoch: 28, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.310 Vali Acc: 0.877 Test Loss: 0.310 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.6934680938720703
Epoch: 29, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.324 Vali Acc: 0.870 Test Loss: 0.324 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.4785397052764893
Epoch: 30, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.316 Vali Acc: 0.877 Test Loss: 0.316 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 351932
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 6.44670033454895
Epoch: 1, Steps: 9 | Train Loss: 1.432 Vali Loss: 1.421 Vali Acc: 0.203 Test Loss: 1.421 Test Acc: 0.203
Validation loss decreased (inf --> -0.202884).  Saving model ...
Epoch: 2 cost time: 4.761845350265503
Epoch: 2, Steps: 9 | Train Loss: 1.345 Vali Loss: 1.360 Vali Acc: 0.268 Test Loss: 1.360 Test Acc: 0.268
Validation loss decreased (-0.202884 --> -0.268102).  Saving model ...
Epoch: 3 cost time: 4.049168348312378
Epoch: 3, Steps: 9 | Train Loss: 1.246 Vali Loss: 1.282 Vali Acc: 0.399 Test Loss: 1.282 Test Acc: 0.399
Validation loss decreased (-0.268102 --> -0.398538).  Saving model ...
Epoch: 4 cost time: 3.7718024253845215
Epoch: 4, Steps: 9 | Train Loss: 1.141 Vali Loss: 1.187 Vali Acc: 0.442 Test Loss: 1.187 Test Acc: 0.442
Validation loss decreased (-0.398538 --> -0.442017).  Saving model ...
Epoch: 5 cost time: 3.5583393573760986
Epoch: 5, Steps: 9 | Train Loss: 1.029 Vali Loss: 1.067 Vali Acc: 0.514 Test Loss: 1.067 Test Acc: 0.514
Validation loss decreased (-0.442017 --> -0.514482).  Saving model ...
Epoch: 6 cost time: 4.207059621810913
Epoch: 6, Steps: 9 | Train Loss: 0.887 Vali Loss: 0.950 Vali Acc: 0.580 Test Loss: 0.950 Test Acc: 0.580
Validation loss decreased (-0.514482 --> -0.579701).  Saving model ...
Epoch: 7 cost time: 4.12882924079895
Epoch: 7, Steps: 9 | Train Loss: 0.731 Vali Loss: 0.852 Vali Acc: 0.659 Test Loss: 0.852 Test Acc: 0.659
Validation loss decreased (-0.579701 --> -0.659412).  Saving model ...
Epoch: 8 cost time: 4.442110776901245
Epoch: 8, Steps: 9 | Train Loss: 0.628 Vali Loss: 0.769 Vali Acc: 0.717 Test Loss: 0.769 Test Acc: 0.717
Validation loss decreased (-0.659412 --> -0.717384).  Saving model ...
Epoch: 9 cost time: 4.461190223693848
Epoch: 9, Steps: 9 | Train Loss: 0.556 Vali Loss: 0.688 Vali Acc: 0.790 Test Loss: 0.688 Test Acc: 0.790
Validation loss decreased (-0.717384 --> -0.789848).  Saving model ...
Epoch: 10 cost time: 4.556573152542114
Epoch: 10, Steps: 9 | Train Loss: 0.486 Vali Loss: 0.646 Vali Acc: 0.797 Test Loss: 0.646 Test Acc: 0.797
Validation loss decreased (-0.789848 --> -0.797095).  Saving model ...
Epoch: 11 cost time: 4.628429174423218
Epoch: 11, Steps: 9 | Train Loss: 0.428 Vali Loss: 0.584 Vali Acc: 0.841 Test Loss: 0.584 Test Acc: 0.841
Validation loss decreased (-0.797095 --> -0.840574).  Saving model ...
Epoch: 12 cost time: 4.592320680618286
Epoch: 12, Steps: 9 | Train Loss: 0.351 Vali Loss: 0.545 Vali Acc: 0.819 Test Loss: 0.545 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.44960880279541
Epoch: 13, Steps: 9 | Train Loss: 0.277 Vali Loss: 0.493 Vali Acc: 0.848 Test Loss: 0.493 Test Acc: 0.848
Validation loss decreased (-0.840574 --> -0.847821).  Saving model ...
Epoch: 14 cost time: 4.516360759735107
Epoch: 14, Steps: 9 | Train Loss: 0.242 Vali Loss: 0.483 Vali Acc: 0.855 Test Loss: 0.483 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855068).  Saving model ...
Epoch: 15 cost time: 4.592885494232178
Epoch: 15, Steps: 9 | Train Loss: 0.217 Vali Loss: 0.434 Vali Acc: 0.877 Test Loss: 0.434 Test Acc: 0.877
Validation loss decreased (-0.855068 --> -0.876807).  Saving model ...
Epoch: 16 cost time: 4.432518005371094
Epoch: 16, Steps: 9 | Train Loss: 0.182 Vali Loss: 0.435 Vali Acc: 0.877 Test Loss: 0.435 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.409271001815796
Epoch: 17, Steps: 9 | Train Loss: 0.149 Vali Loss: 0.472 Vali Acc: 0.862 Test Loss: 0.472 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.713515520095825
Epoch: 18, Steps: 9 | Train Loss: 0.159 Vali Loss: 0.382 Vali Acc: 0.891 Test Loss: 0.382 Test Acc: 0.891
Validation loss decreased (-0.876807 --> -0.891301).  Saving model ...
Epoch: 19 cost time: 4.834962368011475
Epoch: 19, Steps: 9 | Train Loss: 0.166 Vali Loss: 0.375 Vali Acc: 0.913 Test Loss: 0.375 Test Acc: 0.913
Validation loss decreased (-0.891301 --> -0.913040).  Saving model ...
Epoch: 20 cost time: 4.333942890167236
Epoch: 20, Steps: 9 | Train Loss: 0.109 Vali Loss: 0.319 Vali Acc: 0.935 Test Loss: 0.319 Test Acc: 0.935
Validation loss decreased (-0.913040 --> -0.934779).  Saving model ...
Epoch: 21 cost time: 4.4432432651519775
Epoch: 21, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.360 Vali Acc: 0.913 Test Loss: 0.360 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.05433988571167
Epoch: 22, Steps: 9 | Train Loss: 0.080 Vali Loss: 0.352 Vali Acc: 0.928 Test Loss: 0.352 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.442190408706665
Epoch: 23, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.308 Vali Acc: 0.920 Test Loss: 0.308 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.461012125015259
Epoch: 24, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.292 Vali Acc: 0.928 Test Loss: 0.292 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.819913864135742
Epoch: 25, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.299 Vali Acc: 0.920 Test Loss: 0.299 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.8678205013275146
Epoch: 26, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.322 Vali Acc: 0.920 Test Loss: 0.322 Test Acc: 0.920
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 4.762253522872925
Epoch: 27, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.340 Vali Acc: 0.913 Test Loss: 0.340 Test Acc: 0.913
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 4.9378502368927
Epoch: 28, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.338 Vali Acc: 0.913 Test Loss: 0.338 Test Acc: 0.913
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 4.628610610961914
Epoch: 29, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.252 Vali Acc: 0.928 Test Loss: 0.252 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 4.44447135925293
Epoch: 30, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.304 Vali Acc: 0.891 Test Loss: 0.304 Test Acc: 0.891
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9347826086956522
model parameter : 593404
model size : 2.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.813204526901245
Epoch: 1, Steps: 9 | Train Loss: 1.458 Vali Loss: 1.421 Vali Acc: 0.275 Test Loss: 1.421 Test Acc: 0.275
Validation loss decreased (inf --> -0.275348).  Saving model ...
Epoch: 2 cost time: 3.4856393337249756
Epoch: 2, Steps: 9 | Train Loss: 1.427 Vali Loss: 1.383 Vali Acc: 0.290 Test Loss: 1.383 Test Acc: 0.290
Validation loss decreased (-0.275348 --> -0.289841).  Saving model ...
Epoch: 3 cost time: 3.066037178039551
Epoch: 3, Steps: 9 | Train Loss: 1.359 Vali Loss: 1.332 Vali Acc: 0.370 Test Loss: 1.332 Test Acc: 0.370
Validation loss decreased (-0.289841 --> -0.369552).  Saving model ...
Epoch: 4 cost time: 3.3998379707336426
Epoch: 4, Steps: 9 | Train Loss: 1.252 Vali Loss: 1.283 Vali Acc: 0.420 Test Loss: 1.283 Test Acc: 0.420
Validation loss decreased (-0.369552 --> -0.420277).  Saving model ...
Epoch: 5 cost time: 3.7176549434661865
Epoch: 5, Steps: 9 | Train Loss: 1.176 Vali Loss: 1.224 Vali Acc: 0.457 Test Loss: 1.224 Test Acc: 0.457
Validation loss decreased (-0.420277 --> -0.456509).  Saving model ...
Epoch: 6 cost time: 3.6177101135253906
Epoch: 6, Steps: 9 | Train Loss: 1.092 Vali Loss: 1.154 Vali Acc: 0.522 Test Loss: 1.154 Test Acc: 0.522
Validation loss decreased (-0.456509 --> -0.521728).  Saving model ...
Epoch: 7 cost time: 3.964465618133545
Epoch: 7, Steps: 9 | Train Loss: 0.992 Vali Loss: 1.053 Vali Acc: 0.601 Test Loss: 1.053 Test Acc: 0.601
Validation loss decreased (-0.521728 --> -0.601439).  Saving model ...
Epoch: 8 cost time: 3.723914861679077
Epoch: 8, Steps: 9 | Train Loss: 0.848 Vali Loss: 0.936 Vali Acc: 0.688 Test Loss: 0.936 Test Acc: 0.688
Validation loss decreased (-0.601439 --> -0.688396).  Saving model ...
Epoch: 9 cost time: 3.7647955417633057
Epoch: 9, Steps: 9 | Train Loss: 0.730 Vali Loss: 0.806 Vali Acc: 0.746 Test Loss: 0.806 Test Acc: 0.746
Validation loss decreased (-0.688396 --> -0.746369).  Saving model ...
Epoch: 10 cost time: 3.9940662384033203
Epoch: 10, Steps: 9 | Train Loss: 0.599 Vali Loss: 0.656 Vali Acc: 0.783 Test Loss: 0.656 Test Acc: 0.783
Validation loss decreased (-0.746369 --> -0.782602).  Saving model ...
Epoch: 11 cost time: 3.5949208736419678
Epoch: 11, Steps: 9 | Train Loss: 0.455 Vali Loss: 0.522 Vali Acc: 0.862 Test Loss: 0.522 Test Acc: 0.862
Validation loss decreased (-0.782602 --> -0.862314).  Saving model ...
Epoch: 12 cost time: 3.60386323928833
Epoch: 12, Steps: 9 | Train Loss: 0.339 Vali Loss: 0.424 Vali Acc: 0.891 Test Loss: 0.424 Test Acc: 0.891
Validation loss decreased (-0.862314 --> -0.891300).  Saving model ...
Epoch: 13 cost time: 3.9966278076171875
Epoch: 13, Steps: 9 | Train Loss: 0.272 Vali Loss: 0.348 Vali Acc: 0.899 Test Loss: 0.348 Test Acc: 0.899
Validation loss decreased (-0.891300 --> -0.898547).  Saving model ...
Epoch: 14 cost time: 3.9368114471435547
Epoch: 14, Steps: 9 | Train Loss: 0.207 Vali Loss: 0.306 Vali Acc: 0.906 Test Loss: 0.306 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905794).  Saving model ...
Epoch: 15 cost time: 4.247089862823486
Epoch: 15, Steps: 9 | Train Loss: 0.182 Vali Loss: 0.262 Vali Acc: 0.899 Test Loss: 0.262 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.744807004928589
Epoch: 16, Steps: 9 | Train Loss: 0.145 Vali Loss: 0.267 Vali Acc: 0.899 Test Loss: 0.267 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.7949843406677246
Epoch: 17, Steps: 9 | Train Loss: 0.123 Vali Loss: 0.270 Vali Acc: 0.891 Test Loss: 0.270 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.5263376235961914
Epoch: 18, Steps: 9 | Train Loss: 0.111 Vali Loss: 0.249 Vali Acc: 0.899 Test Loss: 0.249 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.069127082824707
Epoch: 19, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.252 Vali Acc: 0.906 Test Loss: 0.252 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905795).  Saving model ...
Epoch: 20 cost time: 3.0696237087249756
Epoch: 20, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.278 Vali Acc: 0.891 Test Loss: 0.278 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.807487964630127
Epoch: 21, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.252 Vali Acc: 0.906 Test Loss: 0.252 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.0047547817230225
Epoch: 22, Steps: 9 | Train Loss: 0.080 Vali Loss: 0.272 Vali Acc: 0.913 Test Loss: 0.272 Test Acc: 0.913
Validation loss decreased (-0.905795 --> -0.913041).  Saving model ...
Epoch: 23 cost time: 2.9232852458953857
Epoch: 23, Steps: 9 | Train Loss: 0.087 Vali Loss: 0.226 Vali Acc: 0.913 Test Loss: 0.226 Test Acc: 0.913
Validation loss decreased (-0.913041 --> -0.913041).  Saving model ...
Epoch: 24 cost time: 2.8083789348602295
Epoch: 24, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.205 Vali Acc: 0.942 Test Loss: 0.205 Test Acc: 0.942
Validation loss decreased (-0.913041 --> -0.942027).  Saving model ...
Epoch: 25 cost time: 2.872716188430786
Epoch: 25, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.186 Vali Acc: 0.957 Test Loss: 0.186 Test Acc: 0.957
Validation loss decreased (-0.942027 --> -0.956520).  Saving model ...
Epoch: 26 cost time: 3.1928884983062744
Epoch: 26, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.194 Vali Acc: 0.942 Test Loss: 0.194 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.4749257564544678
Epoch: 27, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.205 Vali Acc: 0.928 Test Loss: 0.205 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.3596582412719727
Epoch: 28, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.223 Vali Acc: 0.928 Test Loss: 0.223 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.6203949451446533
Epoch: 29, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.274 Vali Acc: 0.913 Test Loss: 0.274 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.804199695587158
Epoch: 30, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.220 Vali Acc: 0.928 Test Loss: 0.220 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9565217391304348
model parameter : 179388
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.247560977935791
Epoch: 1, Steps: 9 | Train Loss: 1.428 Vali Loss: 1.418 Vali Acc: 0.196 Test Loss: 1.418 Test Acc: 0.196
Validation loss decreased (inf --> -0.195638).  Saving model ...
Epoch: 2 cost time: 3.4793965816497803
Epoch: 2, Steps: 9 | Train Loss: 1.343 Vali Loss: 1.361 Vali Acc: 0.290 Test Loss: 1.361 Test Acc: 0.290
Validation loss decreased (-0.195638 --> -0.289841).  Saving model ...
Epoch: 3 cost time: 3.807821750640869
Epoch: 3, Steps: 9 | Train Loss: 1.250 Vali Loss: 1.283 Vali Acc: 0.370 Test Loss: 1.283 Test Acc: 0.370
Validation loss decreased (-0.289841 --> -0.369552).  Saving model ...
Epoch: 4 cost time: 3.6140036582946777
Epoch: 4, Steps: 9 | Train Loss: 1.140 Vali Loss: 1.190 Vali Acc: 0.457 Test Loss: 1.190 Test Acc: 0.457
Validation loss decreased (-0.369552 --> -0.456510).  Saving model ...
Epoch: 5 cost time: 3.415212392807007
Epoch: 5, Steps: 9 | Train Loss: 1.015 Vali Loss: 1.071 Vali Acc: 0.522 Test Loss: 1.071 Test Acc: 0.522
Validation loss decreased (-0.456510 --> -0.521728).  Saving model ...
Epoch: 6 cost time: 3.5269267559051514
Epoch: 6, Steps: 9 | Train Loss: 0.885 Vali Loss: 0.955 Vali Acc: 0.558 Test Loss: 0.955 Test Acc: 0.558
Validation loss decreased (-0.521728 --> -0.557961).  Saving model ...
Epoch: 7 cost time: 3.4112658500671387
Epoch: 7, Steps: 9 | Train Loss: 0.744 Vali Loss: 0.865 Vali Acc: 0.652 Test Loss: 0.865 Test Acc: 0.652
Validation loss decreased (-0.557961 --> -0.652165).  Saving model ...
Epoch: 8 cost time: 3.6328353881835938
Epoch: 8, Steps: 9 | Train Loss: 0.651 Vali Loss: 0.792 Vali Acc: 0.681 Test Loss: 0.792 Test Acc: 0.681
Validation loss decreased (-0.652165 --> -0.681151).  Saving model ...
Epoch: 9 cost time: 3.64461350440979
Epoch: 9, Steps: 9 | Train Loss: 0.572 Vali Loss: 0.705 Vali Acc: 0.775 Test Loss: 0.705 Test Acc: 0.775
Validation loss decreased (-0.681151 --> -0.775355).  Saving model ...
Epoch: 10 cost time: 3.4067904949188232
Epoch: 10, Steps: 9 | Train Loss: 0.517 Vali Loss: 0.681 Vali Acc: 0.761 Test Loss: 0.681 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.060107946395874
Epoch: 11, Steps: 9 | Train Loss: 0.451 Vali Loss: 0.603 Vali Acc: 0.848 Test Loss: 0.603 Test Acc: 0.848
Validation loss decreased (-0.775355 --> -0.847820).  Saving model ...
Epoch: 12 cost time: 3.3113489151000977
Epoch: 12, Steps: 9 | Train Loss: 0.388 Vali Loss: 0.585 Vali Acc: 0.812 Test Loss: 0.585 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.2629013061523438
Epoch: 13, Steps: 9 | Train Loss: 0.322 Vali Loss: 0.518 Vali Acc: 0.862 Test Loss: 0.518 Test Acc: 0.862
Validation loss decreased (-0.847820 --> -0.862314).  Saving model ...
Epoch: 14 cost time: 3.291990041732788
Epoch: 14, Steps: 9 | Train Loss: 0.271 Vali Loss: 0.458 Vali Acc: 0.862 Test Loss: 0.458 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 15 cost time: 3.8548130989074707
Epoch: 15, Steps: 9 | Train Loss: 0.219 Vali Loss: 0.423 Vali Acc: 0.877 Test Loss: 0.423 Test Acc: 0.877
Validation loss decreased (-0.862314 --> -0.876807).  Saving model ...
Epoch: 16 cost time: 3.804152488708496
Epoch: 16, Steps: 9 | Train Loss: 0.174 Vali Loss: 0.440 Vali Acc: 0.891 Test Loss: 0.440 Test Acc: 0.891
Validation loss decreased (-0.876807 --> -0.891300).  Saving model ...
Epoch: 17 cost time: 3.979457139968872
Epoch: 17, Steps: 9 | Train Loss: 0.150 Vali Loss: 0.389 Vali Acc: 0.906 Test Loss: 0.389 Test Acc: 0.906
Validation loss decreased (-0.891300 --> -0.905793).  Saving model ...
Epoch: 18 cost time: 4.116766929626465
Epoch: 18, Steps: 9 | Train Loss: 0.130 Vali Loss: 0.355 Vali Acc: 0.913 Test Loss: 0.355 Test Acc: 0.913
Validation loss decreased (-0.905793 --> -0.913040).  Saving model ...
Epoch: 19 cost time: 4.1441874504089355
Epoch: 19, Steps: 9 | Train Loss: 0.107 Vali Loss: 0.351 Vali Acc: 0.928 Test Loss: 0.351 Test Acc: 0.928
Validation loss decreased (-0.913040 --> -0.927533).  Saving model ...
Epoch: 20 cost time: 3.4815871715545654
Epoch: 20, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.337 Vali Acc: 0.913 Test Loss: 0.337 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.750081777572632
Epoch: 21, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.328 Vali Acc: 0.920 Test Loss: 0.328 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.305140972137451
Epoch: 22, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.327 Vali Acc: 0.920 Test Loss: 0.327 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.196059226989746
Epoch: 23, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.252 Vali Acc: 0.928 Test Loss: 0.252 Test Acc: 0.928
Validation loss decreased (-0.927533 --> -0.927534).  Saving model ...
Epoch: 24 cost time: 3.6962907314300537
Epoch: 24, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.393 Vali Acc: 0.906 Test Loss: 0.393 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.726186752319336
Epoch: 25, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.280 Vali Acc: 0.935 Test Loss: 0.280 Test Acc: 0.935
Validation loss decreased (-0.927534 --> -0.934780).  Saving model ...
Epoch: 26 cost time: 3.767974376678467
Epoch: 26, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.332 Vali Acc: 0.920 Test Loss: 0.332 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.078871011734009
Epoch: 27, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.310 Vali Acc: 0.920 Test Loss: 0.310 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.4499356746673584
Epoch: 28, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.338 Vali Acc: 0.935 Test Loss: 0.338 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.585479259490967
Epoch: 29, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.340 Vali Acc: 0.928 Test Loss: 0.340 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.5711605548858643
Epoch: 30, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.272 Vali Acc: 0.935 Test Loss: 0.272 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9347826086956522
model parameter : 593404
model size : 2.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.119441270828247
Epoch: 1, Steps: 9 | Train Loss: 1.457 Vali Loss: 1.421 Vali Acc: 0.275 Test Loss: 1.421 Test Acc: 0.275
Validation loss decreased (inf --> -0.275348).  Saving model ...
Epoch: 2 cost time: 3.3055057525634766
Epoch: 2, Steps: 9 | Train Loss: 1.434 Vali Loss: 1.386 Vali Acc: 0.290 Test Loss: 1.386 Test Acc: 0.290
Validation loss decreased (-0.275348 --> -0.289841).  Saving model ...
Epoch: 3 cost time: 3.185009241104126
Epoch: 3, Steps: 9 | Train Loss: 1.355 Vali Loss: 1.334 Vali Acc: 0.348 Test Loss: 1.334 Test Acc: 0.348
Validation loss decreased (-0.289841 --> -0.347813).  Saving model ...
Epoch: 4 cost time: 2.957697868347168
Epoch: 4, Steps: 9 | Train Loss: 1.259 Vali Loss: 1.283 Vali Acc: 0.428 Test Loss: 1.283 Test Acc: 0.428
Validation loss decreased (-0.347813 --> -0.427523).  Saving model ...
Epoch: 5 cost time: 3.2390010356903076
Epoch: 5, Steps: 9 | Train Loss: 1.181 Vali Loss: 1.231 Vali Acc: 0.478 Test Loss: 1.231 Test Acc: 0.478
Validation loss decreased (-0.427523 --> -0.478249).  Saving model ...
Epoch: 6 cost time: 2.9191055297851562
Epoch: 6, Steps: 9 | Train Loss: 1.101 Vali Loss: 1.162 Vali Acc: 0.522 Test Loss: 1.162 Test Acc: 0.522
Validation loss decreased (-0.478249 --> -0.521728).  Saving model ...
Epoch: 7 cost time: 2.770904302597046
Epoch: 7, Steps: 9 | Train Loss: 0.985 Vali Loss: 1.069 Vali Acc: 0.580 Test Loss: 1.069 Test Acc: 0.580
Validation loss decreased (-0.521728 --> -0.579699).  Saving model ...
Epoch: 8 cost time: 2.4607596397399902
Epoch: 8, Steps: 9 | Train Loss: 0.859 Vali Loss: 0.947 Vali Acc: 0.645 Test Loss: 0.947 Test Acc: 0.645
Validation loss decreased (-0.579699 --> -0.644918).  Saving model ...
Epoch: 9 cost time: 2.7055280208587646
Epoch: 9, Steps: 9 | Train Loss: 0.731 Vali Loss: 0.832 Vali Acc: 0.710 Test Loss: 0.832 Test Acc: 0.710
Validation loss decreased (-0.644918 --> -0.710137).  Saving model ...
Epoch: 10 cost time: 2.8900647163391113
Epoch: 10, Steps: 9 | Train Loss: 0.606 Vali Loss: 0.681 Vali Acc: 0.783 Test Loss: 0.681 Test Acc: 0.783
Validation loss decreased (-0.710137 --> -0.782602).  Saving model ...
Epoch: 11 cost time: 2.803967237472534
Epoch: 11, Steps: 9 | Train Loss: 0.466 Vali Loss: 0.558 Vali Acc: 0.848 Test Loss: 0.558 Test Acc: 0.848
Validation loss decreased (-0.782602 --> -0.847821).  Saving model ...
Epoch: 12 cost time: 3.183164596557617
Epoch: 12, Steps: 9 | Train Loss: 0.345 Vali Loss: 0.445 Vali Acc: 0.891 Test Loss: 0.445 Test Acc: 0.891
Validation loss decreased (-0.847821 --> -0.891300).  Saving model ...
Epoch: 13 cost time: 3.00818133354187
Epoch: 13, Steps: 9 | Train Loss: 0.285 Vali Loss: 0.383 Vali Acc: 0.891 Test Loss: 0.383 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891301).  Saving model ...
Epoch: 14 cost time: 3.3270294666290283
Epoch: 14, Steps: 9 | Train Loss: 0.234 Vali Loss: 0.324 Vali Acc: 0.920 Test Loss: 0.324 Test Acc: 0.920
Validation loss decreased (-0.891301 --> -0.920287).  Saving model ...
Epoch: 15 cost time: 2.7570676803588867
Epoch: 15, Steps: 9 | Train Loss: 0.191 Vali Loss: 0.286 Vali Acc: 0.928 Test Loss: 0.286 Test Acc: 0.928
Validation loss decreased (-0.920287 --> -0.927533).  Saving model ...
Epoch: 16 cost time: 2.7437493801116943
Epoch: 16, Steps: 9 | Train Loss: 0.147 Vali Loss: 0.283 Vali Acc: 0.928 Test Loss: 0.283 Test Acc: 0.928
Validation loss decreased (-0.927533 --> -0.927533).  Saving model ...
Epoch: 17 cost time: 2.836968421936035
Epoch: 17, Steps: 9 | Train Loss: 0.120 Vali Loss: 0.233 Vali Acc: 0.942 Test Loss: 0.233 Test Acc: 0.942
Validation loss decreased (-0.927533 --> -0.942027).  Saving model ...
Epoch: 18 cost time: 2.974599599838257
Epoch: 18, Steps: 9 | Train Loss: 0.128 Vali Loss: 0.208 Vali Acc: 0.935 Test Loss: 0.208 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.0129644870758057
Epoch: 19, Steps: 9 | Train Loss: 0.107 Vali Loss: 0.235 Vali Acc: 0.920 Test Loss: 0.235 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.312690496444702
Epoch: 20, Steps: 9 | Train Loss: 0.108 Vali Loss: 0.181 Vali Acc: 0.935 Test Loss: 0.181 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.1681771278381348
Epoch: 21, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.177 Vali Acc: 0.942 Test Loss: 0.177 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 22 cost time: 3.063218832015991
Epoch: 22, Steps: 9 | Train Loss: 0.080 Vali Loss: 0.176 Vali Acc: 0.942 Test Loss: 0.176 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 23 cost time: 3.3452200889587402
Epoch: 23, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.157 Vali Acc: 0.957 Test Loss: 0.157 Test Acc: 0.957
Validation loss decreased (-0.942027 --> -0.956520).  Saving model ...
Epoch: 24 cost time: 2.8834283351898193
Epoch: 24, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.156 Vali Acc: 0.964 Test Loss: 0.156 Test Acc: 0.964
Validation loss decreased (-0.956520 --> -0.963767).  Saving model ...
Epoch: 25 cost time: 3.374828815460205
Epoch: 25, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.174 Vali Acc: 0.942 Test Loss: 0.174 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.0743892192840576
Epoch: 26, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.171 Vali Acc: 0.942 Test Loss: 0.171 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.031778573989868
Epoch: 27, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.150 Vali Acc: 0.942 Test Loss: 0.150 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.9187443256378174
Epoch: 28, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.167 Vali Acc: 0.949 Test Loss: 0.167 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.8122286796569824
Epoch: 29, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.173 Vali Acc: 0.949 Test Loss: 0.173 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.19779372215271
Epoch: 30, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.165 Vali Acc: 0.935 Test Loss: 0.165 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9637681159420289
model parameter : 179388
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.621841192245483
Epoch: 1, Steps: 9 | Train Loss: 1.436 Vali Loss: 1.415 Vali Acc: 0.196 Test Loss: 1.415 Test Acc: 0.196
Validation loss decreased (inf --> -0.195638).  Saving model ...
Epoch: 2 cost time: 2.8775713443756104
Epoch: 2, Steps: 9 | Train Loss: 1.345 Vali Loss: 1.360 Vali Acc: 0.290 Test Loss: 1.360 Test Acc: 0.290
Validation loss decreased (-0.195638 --> -0.289841).  Saving model ...
Epoch: 3 cost time: 2.6915829181671143
Epoch: 3, Steps: 9 | Train Loss: 1.252 Vali Loss: 1.287 Vali Acc: 0.391 Test Loss: 1.287 Test Acc: 0.391
Validation loss decreased (-0.289841 --> -0.391291).  Saving model ...
Epoch: 4 cost time: 2.631920337677002
Epoch: 4, Steps: 9 | Train Loss: 1.145 Vali Loss: 1.206 Vali Acc: 0.471 Test Loss: 1.206 Test Acc: 0.471
Validation loss decreased (-0.391291 --> -0.471002).  Saving model ...
Epoch: 5 cost time: 2.300415515899658
Epoch: 5, Steps: 9 | Train Loss: 1.017 Vali Loss: 1.096 Vali Acc: 0.529 Test Loss: 1.096 Test Acc: 0.529
Validation loss decreased (-0.471002 --> -0.528975).  Saving model ...
Epoch: 6 cost time: 2.4338929653167725
Epoch: 6, Steps: 9 | Train Loss: 0.900 Vali Loss: 0.998 Vali Acc: 0.543 Test Loss: 0.998 Test Acc: 0.543
Validation loss decreased (-0.528975 --> -0.543468).  Saving model ...
Epoch: 7 cost time: 2.4764599800109863
Epoch: 7, Steps: 9 | Train Loss: 0.767 Vali Loss: 0.913 Vali Acc: 0.580 Test Loss: 0.913 Test Acc: 0.580
Validation loss decreased (-0.543468 --> -0.579701).  Saving model ...
Epoch: 8 cost time: 2.671341896057129
Epoch: 8, Steps: 9 | Train Loss: 0.674 Vali Loss: 0.820 Vali Acc: 0.645 Test Loss: 0.820 Test Acc: 0.645
Validation loss decreased (-0.579701 --> -0.644919).  Saving model ...
Epoch: 9 cost time: 3.0436158180236816
Epoch: 9, Steps: 9 | Train Loss: 0.592 Vali Loss: 0.741 Vali Acc: 0.725 Test Loss: 0.741 Test Acc: 0.725
Validation loss decreased (-0.644919 --> -0.724630).  Saving model ...
Epoch: 10 cost time: 3.008709192276001
Epoch: 10, Steps: 9 | Train Loss: 0.530 Vali Loss: 0.731 Vali Acc: 0.681 Test Loss: 0.731 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.236759901046753
Epoch: 11, Steps: 9 | Train Loss: 0.465 Vali Loss: 0.681 Vali Acc: 0.754 Test Loss: 0.681 Test Acc: 0.754
Validation loss decreased (-0.724630 --> -0.753616).  Saving model ...
Epoch: 12 cost time: 3.0842208862304688
Epoch: 12, Steps: 9 | Train Loss: 0.378 Vali Loss: 0.661 Vali Acc: 0.732 Test Loss: 0.661 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.9549720287323
Epoch: 13, Steps: 9 | Train Loss: 0.322 Vali Loss: 0.644 Vali Acc: 0.754 Test Loss: 0.644 Test Acc: 0.754
Validation loss decreased (-0.753616 --> -0.753617).  Saving model ...
Epoch: 14 cost time: 2.977515935897827
Epoch: 14, Steps: 9 | Train Loss: 0.290 Vali Loss: 0.582 Vali Acc: 0.812 Test Loss: 0.582 Test Acc: 0.812
Validation loss decreased (-0.753617 --> -0.811588).  Saving model ...
Epoch: 15 cost time: 3.053304672241211
Epoch: 15, Steps: 9 | Train Loss: 0.292 Vali Loss: 0.515 Vali Acc: 0.812 Test Loss: 0.515 Test Acc: 0.812
Validation loss decreased (-0.811588 --> -0.811589).  Saving model ...
Epoch: 16 cost time: 2.4747843742370605
Epoch: 16, Steps: 9 | Train Loss: 0.225 Vali Loss: 0.470 Vali Acc: 0.870 Test Loss: 0.470 Test Acc: 0.870
Validation loss decreased (-0.811589 --> -0.869561).  Saving model ...
Epoch: 17 cost time: 2.815551280975342
Epoch: 17, Steps: 9 | Train Loss: 0.185 Vali Loss: 0.453 Vali Acc: 0.870 Test Loss: 0.453 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 18 cost time: 3.0599896907806396
Epoch: 18, Steps: 9 | Train Loss: 0.192 Vali Loss: 0.451 Vali Acc: 0.855 Test Loss: 0.451 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.18373966217041
Epoch: 19, Steps: 9 | Train Loss: 0.146 Vali Loss: 0.488 Vali Acc: 0.848 Test Loss: 0.488 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.9461660385131836
Epoch: 20, Steps: 9 | Train Loss: 0.134 Vali Loss: 0.439 Vali Acc: 0.884 Test Loss: 0.439 Test Acc: 0.884
Validation loss decreased (-0.869561 --> -0.884054).  Saving model ...
Epoch: 21 cost time: 2.647432327270508
Epoch: 21, Steps: 9 | Train Loss: 0.106 Vali Loss: 0.419 Vali Acc: 0.899 Test Loss: 0.419 Test Acc: 0.899
Validation loss decreased (-0.884054 --> -0.898547).  Saving model ...
Epoch: 22 cost time: 2.8801987171173096
Epoch: 22, Steps: 9 | Train Loss: 0.135 Vali Loss: 0.349 Vali Acc: 0.906 Test Loss: 0.349 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905794).  Saving model ...
Epoch: 23 cost time: 2.9562807083129883
Epoch: 23, Steps: 9 | Train Loss: 0.086 Vali Loss: 0.279 Vali Acc: 0.913 Test Loss: 0.279 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913041).  Saving model ...
Epoch: 24 cost time: 3.1158337593078613
Epoch: 24, Steps: 9 | Train Loss: 0.086 Vali Loss: 0.306 Vali Acc: 0.920 Test Loss: 0.306 Test Acc: 0.920
Validation loss decreased (-0.913041 --> -0.920287).  Saving model ...
Epoch: 25 cost time: 2.766329765319824
Epoch: 25, Steps: 9 | Train Loss: 0.104 Vali Loss: 0.363 Vali Acc: 0.920 Test Loss: 0.363 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.7983858585357666
Epoch: 26, Steps: 9 | Train Loss: 0.086 Vali Loss: 0.355 Vali Acc: 0.920 Test Loss: 0.355 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.72098445892334
Epoch: 27, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.299 Vali Acc: 0.935 Test Loss: 0.299 Test Acc: 0.935
Validation loss decreased (-0.920287 --> -0.934780).  Saving model ...
Epoch: 28 cost time: 3.0473709106445312
Epoch: 28, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.321 Vali Acc: 0.920 Test Loss: 0.321 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.079421281814575
Epoch: 29, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.352 Vali Acc: 0.913 Test Loss: 0.352 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.787170886993408
Epoch: 30, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.242 Vali Acc: 0.942 Test Loss: 0.242 Test Acc: 0.942
Validation loss decreased (-0.934780 --> -0.942027).  Saving model ...
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9420289855072463
model parameter : 593404
model size : 2.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.46788763999939
Epoch: 1, Steps: 9 | Train Loss: 1.459 Vali Loss: 1.429 Vali Acc: 0.312 Test Loss: 1.429 Test Acc: 0.312
Validation loss decreased (inf --> -0.311580).  Saving model ...
Epoch: 2 cost time: 2.664605140686035
Epoch: 2, Steps: 9 | Train Loss: 1.426 Vali Loss: 1.397 Vali Acc: 0.275 Test Loss: 1.397 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.499207019805908
Epoch: 3, Steps: 9 | Train Loss: 1.358 Vali Loss: 1.354 Vali Acc: 0.333 Test Loss: 1.354 Test Acc: 0.333
Validation loss decreased (-0.311580 --> -0.333320).  Saving model ...
Epoch: 4 cost time: 2.5500967502593994
Epoch: 4, Steps: 9 | Train Loss: 1.282 Vali Loss: 1.315 Vali Acc: 0.406 Test Loss: 1.315 Test Acc: 0.406
Validation loss decreased (-0.333320 --> -0.405784).  Saving model ...
Epoch: 5 cost time: 2.65045166015625
Epoch: 5, Steps: 9 | Train Loss: 1.195 Vali Loss: 1.276 Vali Acc: 0.428 Test Loss: 1.276 Test Acc: 0.428
Validation loss decreased (-0.405784 --> -0.427523).  Saving model ...
Epoch: 6 cost time: 2.7011804580688477
Epoch: 6, Steps: 9 | Train Loss: 1.121 Vali Loss: 1.222 Vali Acc: 0.478 Test Loss: 1.222 Test Acc: 0.478
Validation loss decreased (-0.427523 --> -0.478249).  Saving model ...
Epoch: 7 cost time: 2.572361946105957
Epoch: 7, Steps: 9 | Train Loss: 1.030 Vali Loss: 1.137 Vali Acc: 0.558 Test Loss: 1.137 Test Acc: 0.558
Validation loss decreased (-0.478249 --> -0.557960).  Saving model ...
Epoch: 8 cost time: 2.5820822715759277
Epoch: 8, Steps: 9 | Train Loss: 0.894 Vali Loss: 1.035 Vali Acc: 0.587 Test Loss: 1.035 Test Acc: 0.587
Validation loss decreased (-0.557960 --> -0.586946).  Saving model ...
Epoch: 9 cost time: 2.802018404006958
Epoch: 9, Steps: 9 | Train Loss: 0.744 Vali Loss: 0.928 Vali Acc: 0.652 Test Loss: 0.928 Test Acc: 0.652
Validation loss decreased (-0.586946 --> -0.652165).  Saving model ...
Epoch: 10 cost time: 2.265695333480835
Epoch: 10, Steps: 9 | Train Loss: 0.679 Vali Loss: 0.805 Vali Acc: 0.710 Test Loss: 0.805 Test Acc: 0.710
Validation loss decreased (-0.652165 --> -0.710137).  Saving model ...
Epoch: 11 cost time: 2.6908881664276123
Epoch: 11, Steps: 9 | Train Loss: 0.523 Vali Loss: 0.686 Vali Acc: 0.739 Test Loss: 0.686 Test Acc: 0.739
Validation loss decreased (-0.710137 --> -0.739124).  Saving model ...
Epoch: 12 cost time: 2.8461053371429443
Epoch: 12, Steps: 9 | Train Loss: 0.421 Vali Loss: 0.601 Vali Acc: 0.761 Test Loss: 0.601 Test Acc: 0.761
Validation loss decreased (-0.739124 --> -0.760864).  Saving model ...
Epoch: 13 cost time: 3.093947172164917
Epoch: 13, Steps: 9 | Train Loss: 0.276 Vali Loss: 0.514 Vali Acc: 0.783 Test Loss: 0.514 Test Acc: 0.783
Validation loss decreased (-0.760864 --> -0.782604).  Saving model ...
Epoch: 14 cost time: 2.633646011352539
Epoch: 14, Steps: 9 | Train Loss: 0.294 Vali Loss: 0.444 Vali Acc: 0.819 Test Loss: 0.444 Test Acc: 0.819
Validation loss decreased (-0.782604 --> -0.818836).  Saving model ...
Epoch: 15 cost time: 2.5698370933532715
Epoch: 15, Steps: 9 | Train Loss: 0.256 Vali Loss: 0.417 Vali Acc: 0.848 Test Loss: 0.417 Test Acc: 0.848
Validation loss decreased (-0.818836 --> -0.847822).  Saving model ...
Epoch: 16 cost time: 2.638655424118042
Epoch: 16, Steps: 9 | Train Loss: 0.219 Vali Loss: 0.382 Vali Acc: 0.855 Test Loss: 0.382 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855069).  Saving model ...
Epoch: 17 cost time: 2.3330304622650146
Epoch: 17, Steps: 9 | Train Loss: 0.187 Vali Loss: 0.360 Vali Acc: 0.870 Test Loss: 0.360 Test Acc: 0.870
Validation loss decreased (-0.855069 --> -0.869562).  Saving model ...
Epoch: 18 cost time: 2.2219178676605225
Epoch: 18, Steps: 9 | Train Loss: 0.182 Vali Loss: 0.344 Vali Acc: 0.855 Test Loss: 0.344 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.978459358215332
Epoch: 19, Steps: 9 | Train Loss: 0.182 Vali Loss: 0.413 Vali Acc: 0.855 Test Loss: 0.413 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.111107349395752
Epoch: 20, Steps: 9 | Train Loss: 0.208 Vali Loss: 0.301 Vali Acc: 0.877 Test Loss: 0.301 Test Acc: 0.877
Validation loss decreased (-0.869562 --> -0.876809).  Saving model ...
Epoch: 21 cost time: 2.259848117828369
Epoch: 21, Steps: 9 | Train Loss: 0.134 Vali Loss: 0.296 Vali Acc: 0.870 Test Loss: 0.296 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.137373447418213
Epoch: 22, Steps: 9 | Train Loss: 0.118 Vali Loss: 0.286 Vali Acc: 0.884 Test Loss: 0.286 Test Acc: 0.884
Validation loss decreased (-0.876809 --> -0.884055).  Saving model ...
Epoch: 23 cost time: 2.4588217735290527
Epoch: 23, Steps: 9 | Train Loss: 0.115 Vali Loss: 0.273 Vali Acc: 0.899 Test Loss: 0.273 Test Acc: 0.899
Validation loss decreased (-0.884055 --> -0.898548).  Saving model ...
Epoch: 24 cost time: 2.6650490760803223
Epoch: 24, Steps: 9 | Train Loss: 0.086 Vali Loss: 0.290 Vali Acc: 0.862 Test Loss: 0.290 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.634462594985962
Epoch: 25, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.266 Vali Acc: 0.906 Test Loss: 0.266 Test Acc: 0.906
Validation loss decreased (-0.898548 --> -0.905794).  Saving model ...
Epoch: 26 cost time: 2.5152480602264404
Epoch: 26, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.266 Vali Acc: 0.913 Test Loss: 0.266 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913041).  Saving model ...
Epoch: 27 cost time: 2.6436257362365723
Epoch: 27, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.244 Vali Acc: 0.920 Test Loss: 0.244 Test Acc: 0.920
Validation loss decreased (-0.913041 --> -0.920287).  Saving model ...
Epoch: 28 cost time: 2.6136720180511475
Epoch: 28, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.234 Vali Acc: 0.920 Test Loss: 0.234 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920288).  Saving model ...
Epoch: 29 cost time: 2.344484329223633
Epoch: 29, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.234 Vali Acc: 0.920 Test Loss: 0.234 Test Acc: 0.920
Validation loss decreased (-0.920288 --> -0.920288).  Saving model ...
Epoch: 30 cost time: 2.428870439529419
Epoch: 30, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.232 Vali Acc: 0.906 Test Loss: 0.232 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 179388
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 6.057132244110107
Epoch: 1, Steps: 9 | Train Loss: 1.473 Vali Loss: 1.474 Vali Acc: 0.261 Test Loss: 1.474 Test Acc: 0.261
Validation loss decreased (inf --> -0.260855).  Saving model ...
Epoch: 2 cost time: 4.277198314666748
Epoch: 2, Steps: 9 | Train Loss: 1.404 Vali Loss: 1.412 Vali Acc: 0.254 Test Loss: 1.412 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.0099451541900635
Epoch: 3, Steps: 9 | Train Loss: 1.341 Vali Loss: 1.340 Vali Acc: 0.297 Test Loss: 1.340 Test Acc: 0.297
Validation loss decreased (-0.260855 --> -0.297088).  Saving model ...
Epoch: 4 cost time: 4.014991283416748
Epoch: 4, Steps: 9 | Train Loss: 1.255 Vali Loss: 1.269 Vali Acc: 0.420 Test Loss: 1.269 Test Acc: 0.420
Validation loss decreased (-0.297088 --> -0.420277).  Saving model ...
Epoch: 5 cost time: 4.1766979694366455
Epoch: 5, Steps: 9 | Train Loss: 1.159 Vali Loss: 1.192 Vali Acc: 0.500 Test Loss: 1.192 Test Acc: 0.500
Validation loss decreased (-0.420277 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 4.46280574798584
Epoch: 6, Steps: 9 | Train Loss: 1.066 Vali Loss: 1.100 Vali Acc: 0.565 Test Loss: 1.100 Test Acc: 0.565
Validation loss decreased (-0.499988 --> -0.565206).  Saving model ...
Epoch: 7 cost time: 4.166892766952515
Epoch: 7, Steps: 9 | Train Loss: 0.928 Vali Loss: 0.992 Vali Acc: 0.572 Test Loss: 0.992 Test Acc: 0.572
Validation loss decreased (-0.565206 --> -0.572454).  Saving model ...
Epoch: 8 cost time: 4.528504371643066
Epoch: 8, Steps: 9 | Train Loss: 0.794 Vali Loss: 0.858 Vali Acc: 0.652 Test Loss: 0.858 Test Acc: 0.652
Validation loss decreased (-0.572454 --> -0.652165).  Saving model ...
Epoch: 9 cost time: 4.225342512130737
Epoch: 9, Steps: 9 | Train Loss: 0.685 Vali Loss: 0.744 Vali Acc: 0.674 Test Loss: 0.744 Test Acc: 0.674
Validation loss decreased (-0.652165 --> -0.673906).  Saving model ...
Epoch: 10 cost time: 4.1854088306427
Epoch: 10, Steps: 9 | Train Loss: 0.584 Vali Loss: 0.658 Vali Acc: 0.725 Test Loss: 0.658 Test Acc: 0.725
Validation loss decreased (-0.673906 --> -0.724631).  Saving model ...
Epoch: 11 cost time: 3.8550522327423096
Epoch: 11, Steps: 9 | Train Loss: 0.490 Vali Loss: 0.572 Vali Acc: 0.761 Test Loss: 0.572 Test Acc: 0.761
Validation loss decreased (-0.724631 --> -0.760864).  Saving model ...
Epoch: 12 cost time: 4.022340297698975
Epoch: 12, Steps: 9 | Train Loss: 0.458 Vali Loss: 0.540 Vali Acc: 0.812 Test Loss: 0.540 Test Acc: 0.812
Validation loss decreased (-0.760864 --> -0.811589).  Saving model ...
Epoch: 13 cost time: 3.9129011631011963
Epoch: 13, Steps: 9 | Train Loss: 0.362 Vali Loss: 0.510 Vali Acc: 0.797 Test Loss: 0.510 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.8109147548675537
Epoch: 14, Steps: 9 | Train Loss: 0.310 Vali Loss: 0.451 Vali Acc: 0.833 Test Loss: 0.451 Test Acc: 0.833
Validation loss decreased (-0.811589 --> -0.833329).  Saving model ...
Epoch: 15 cost time: 4.265981912612915
Epoch: 15, Steps: 9 | Train Loss: 0.276 Vali Loss: 0.457 Vali Acc: 0.812 Test Loss: 0.457 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.167131662368774
Epoch: 16, Steps: 9 | Train Loss: 0.251 Vali Loss: 0.473 Vali Acc: 0.826 Test Loss: 0.473 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.304349184036255
Epoch: 17, Steps: 9 | Train Loss: 0.233 Vali Loss: 0.415 Vali Acc: 0.848 Test Loss: 0.415 Test Acc: 0.848
Validation loss decreased (-0.833329 --> -0.847822).  Saving model ...
Epoch: 18 cost time: 4.2648491859436035
Epoch: 18, Steps: 9 | Train Loss: 0.186 Vali Loss: 0.426 Vali Acc: 0.848 Test Loss: 0.426 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.426685333251953
Epoch: 19, Steps: 9 | Train Loss: 0.153 Vali Loss: 0.464 Vali Acc: 0.841 Test Loss: 0.464 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.10421347618103
Epoch: 20, Steps: 9 | Train Loss: 0.140 Vali Loss: 0.434 Vali Acc: 0.855 Test Loss: 0.434 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855068).  Saving model ...
Epoch: 21 cost time: 4.221454858779907
Epoch: 21, Steps: 9 | Train Loss: 0.113 Vali Loss: 0.400 Vali Acc: 0.855 Test Loss: 0.400 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 22 cost time: 4.220275640487671
Epoch: 22, Steps: 9 | Train Loss: 0.080 Vali Loss: 0.402 Vali Acc: 0.855 Test Loss: 0.402 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.320000648498535
Epoch: 23, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.405 Vali Acc: 0.862 Test Loss: 0.405 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862315).  Saving model ...
Epoch: 24 cost time: 4.028588533401489
Epoch: 24, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.388 Vali Acc: 0.891 Test Loss: 0.388 Test Acc: 0.891
Validation loss decreased (-0.862315 --> -0.891300).  Saving model ...
Epoch: 25 cost time: 4.173353433609009
Epoch: 25, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.446 Vali Acc: 0.819 Test Loss: 0.446 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.266449689865112
Epoch: 26, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.428 Vali Acc: 0.841 Test Loss: 0.428 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.8949224948883057
Epoch: 27, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.399 Vali Acc: 0.870 Test Loss: 0.399 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 4.393046855926514
Epoch: 28, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.429 Vali Acc: 0.862 Test Loss: 0.429 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 4.210256814956665
Epoch: 29, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.396 Vali Acc: 0.870 Test Loss: 0.396 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.9692630767822266
Epoch: 30, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.332 Vali Acc: 0.877 Test Loss: 0.332 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 300156
model size : 1.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.140731573104858
Epoch: 1, Steps: 9 | Train Loss: 1.347 Vali Loss: 1.395 Vali Acc: 0.261 Test Loss: 1.395 Test Acc: 0.261
Validation loss decreased (inf --> -0.260856).  Saving model ...
Epoch: 2 cost time: 2.9869449138641357
Epoch: 2, Steps: 9 | Train Loss: 1.335 Vali Loss: 1.335 Vali Acc: 0.319 Test Loss: 1.335 Test Acc: 0.319
Validation loss decreased (-0.260856 --> -0.318827).  Saving model ...
Epoch: 3 cost time: 2.755946397781372
Epoch: 3, Steps: 9 | Train Loss: 1.225 Vali Loss: 1.261 Vali Acc: 0.428 Test Loss: 1.261 Test Acc: 0.428
Validation loss decreased (-0.318827 --> -0.427524).  Saving model ...
Epoch: 4 cost time: 2.925889253616333
Epoch: 4, Steps: 9 | Train Loss: 1.142 Vali Loss: 1.178 Vali Acc: 0.522 Test Loss: 1.178 Test Acc: 0.522
Validation loss decreased (-0.427524 --> -0.521727).  Saving model ...
Epoch: 5 cost time: 2.8690390586853027
Epoch: 5, Steps: 9 | Train Loss: 1.063 Vali Loss: 1.088 Vali Acc: 0.522 Test Loss: 1.088 Test Acc: 0.522
Validation loss decreased (-0.521727 --> -0.521728).  Saving model ...
Epoch: 6 cost time: 2.9463002681732178
Epoch: 6, Steps: 9 | Train Loss: 0.961 Vali Loss: 1.000 Vali Acc: 0.572 Test Loss: 1.000 Test Acc: 0.572
Validation loss decreased (-0.521728 --> -0.572454).  Saving model ...
Epoch: 7 cost time: 2.797977924346924
Epoch: 7, Steps: 9 | Train Loss: 0.858 Vali Loss: 0.918 Vali Acc: 0.623 Test Loss: 0.918 Test Acc: 0.623
Validation loss decreased (-0.572454 --> -0.623179).  Saving model ...
Epoch: 8 cost time: 2.792210340499878
Epoch: 8, Steps: 9 | Train Loss: 0.768 Vali Loss: 0.831 Vali Acc: 0.645 Test Loss: 0.831 Test Acc: 0.645
Validation loss decreased (-0.623179 --> -0.644919).  Saving model ...
Epoch: 9 cost time: 2.772418737411499
Epoch: 9, Steps: 9 | Train Loss: 0.681 Vali Loss: 0.749 Vali Acc: 0.696 Test Loss: 0.749 Test Acc: 0.696
Validation loss decreased (-0.644919 --> -0.695645).  Saving model ...
Epoch: 10 cost time: 2.6067352294921875
Epoch: 10, Steps: 9 | Train Loss: 0.579 Vali Loss: 0.661 Vali Acc: 0.746 Test Loss: 0.661 Test Acc: 0.746
Validation loss decreased (-0.695645 --> -0.746370).  Saving model ...
Epoch: 11 cost time: 3.181584358215332
Epoch: 11, Steps: 9 | Train Loss: 0.498 Vali Loss: 0.599 Vali Acc: 0.768 Test Loss: 0.599 Test Acc: 0.768
Validation loss decreased (-0.746370 --> -0.768110).  Saving model ...
Epoch: 12 cost time: 3.0009806156158447
Epoch: 12, Steps: 9 | Train Loss: 0.415 Vali Loss: 0.533 Vali Acc: 0.783 Test Loss: 0.533 Test Acc: 0.783
Validation loss decreased (-0.768110 --> -0.782603).  Saving model ...
Epoch: 13 cost time: 2.979606866836548
Epoch: 13, Steps: 9 | Train Loss: 0.370 Vali Loss: 0.490 Vali Acc: 0.790 Test Loss: 0.490 Test Acc: 0.790
Validation loss decreased (-0.782603 --> -0.789850).  Saving model ...
Epoch: 14 cost time: 3.1971356868743896
Epoch: 14, Steps: 9 | Train Loss: 0.329 Vali Loss: 0.443 Vali Acc: 0.833 Test Loss: 0.443 Test Acc: 0.833
Validation loss decreased (-0.789850 --> -0.833329).  Saving model ...
Epoch: 15 cost time: 3.0777029991149902
Epoch: 15, Steps: 9 | Train Loss: 0.302 Vali Loss: 0.410 Vali Acc: 0.841 Test Loss: 0.410 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840576).  Saving model ...
Epoch: 16 cost time: 2.9555304050445557
Epoch: 16, Steps: 9 | Train Loss: 0.250 Vali Loss: 0.443 Vali Acc: 0.819 Test Loss: 0.443 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.202470541000366
Epoch: 17, Steps: 9 | Train Loss: 0.212 Vali Loss: 0.387 Vali Acc: 0.841 Test Loss: 0.387 Test Acc: 0.841
Validation loss decreased (-0.840576 --> -0.840576).  Saving model ...
Epoch: 18 cost time: 2.9029831886291504
Epoch: 18, Steps: 9 | Train Loss: 0.177 Vali Loss: 0.368 Vali Acc: 0.841 Test Loss: 0.368 Test Acc: 0.841
Validation loss decreased (-0.840576 --> -0.840576).  Saving model ...
Epoch: 19 cost time: 3.1207003593444824
Epoch: 19, Steps: 9 | Train Loss: 0.141 Vali Loss: 0.399 Vali Acc: 0.833 Test Loss: 0.399 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.930124521255493
Epoch: 20, Steps: 9 | Train Loss: 0.134 Vali Loss: 0.396 Vali Acc: 0.833 Test Loss: 0.396 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.33695125579834
Epoch: 21, Steps: 9 | Train Loss: 0.132 Vali Loss: 0.349 Vali Acc: 0.841 Test Loss: 0.349 Test Acc: 0.841
Validation loss decreased (-0.840576 --> -0.840576).  Saving model ...
Epoch: 22 cost time: 3.1151676177978516
Epoch: 22, Steps: 9 | Train Loss: 0.114 Vali Loss: 0.340 Vali Acc: 0.870 Test Loss: 0.340 Test Acc: 0.870
Validation loss decreased (-0.840576 --> -0.869562).  Saving model ...
Epoch: 23 cost time: 3.1796140670776367
Epoch: 23, Steps: 9 | Train Loss: 0.109 Vali Loss: 0.365 Vali Acc: 0.870 Test Loss: 0.365 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.0248634815216064
Epoch: 24, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.362 Vali Acc: 0.891 Test Loss: 0.362 Test Acc: 0.891
Validation loss decreased (-0.869562 --> -0.891301).  Saving model ...
Epoch: 25 cost time: 2.9122164249420166
Epoch: 25, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.332 Vali Acc: 0.884 Test Loss: 0.332 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.199355363845825
Epoch: 26, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.307 Vali Acc: 0.906 Test Loss: 0.307 Test Acc: 0.906
Validation loss decreased (-0.891301 --> -0.905794).  Saving model ...
Epoch: 27 cost time: 3.095365285873413
Epoch: 27, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.350 Vali Acc: 0.891 Test Loss: 0.350 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.7349259853363037
Epoch: 28, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.366 Vali Acc: 0.891 Test Loss: 0.366 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.7140414714813232
Epoch: 29, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.327 Vali Acc: 0.899 Test Loss: 0.327 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.9729583263397217
Epoch: 30, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.391 Vali Acc: 0.870 Test Loss: 0.391 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 93116
model size : 0.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.836952447891235
Epoch: 1, Steps: 9 | Train Loss: 1.473 Vali Loss: 1.473 Vali Acc: 0.254 Test Loss: 1.473 Test Acc: 0.254
Validation loss decreased (inf --> -0.253608).  Saving model ...
Epoch: 2 cost time: 2.853949546813965
Epoch: 2, Steps: 9 | Train Loss: 1.408 Vali Loss: 1.410 Vali Acc: 0.246 Test Loss: 1.410 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.6842851638793945
Epoch: 3, Steps: 9 | Train Loss: 1.343 Vali Loss: 1.335 Vali Acc: 0.290 Test Loss: 1.335 Test Acc: 0.290
Validation loss decreased (-0.253608 --> -0.289842).  Saving model ...
Epoch: 4 cost time: 2.8968260288238525
Epoch: 4, Steps: 9 | Train Loss: 1.259 Vali Loss: 1.263 Vali Acc: 0.384 Test Loss: 1.263 Test Acc: 0.384
Validation loss decreased (-0.289842 --> -0.384045).  Saving model ...
Epoch: 5 cost time: 3.2366440296173096
Epoch: 5, Steps: 9 | Train Loss: 1.162 Vali Loss: 1.186 Vali Acc: 0.478 Test Loss: 1.186 Test Acc: 0.478
Validation loss decreased (-0.384045 --> -0.478249).  Saving model ...
Epoch: 6 cost time: 3.3914036750793457
Epoch: 6, Steps: 9 | Train Loss: 1.073 Vali Loss: 1.095 Vali Acc: 0.565 Test Loss: 1.095 Test Acc: 0.565
Validation loss decreased (-0.478249 --> -0.565206).  Saving model ...
Epoch: 7 cost time: 3.1403489112854004
Epoch: 7, Steps: 9 | Train Loss: 0.938 Vali Loss: 0.986 Vali Acc: 0.587 Test Loss: 0.986 Test Acc: 0.587
Validation loss decreased (-0.565206 --> -0.586947).  Saving model ...
Epoch: 8 cost time: 3.2967920303344727
Epoch: 8, Steps: 9 | Train Loss: 0.815 Vali Loss: 0.853 Vali Acc: 0.659 Test Loss: 0.853 Test Acc: 0.659
Validation loss decreased (-0.586947 --> -0.659412).  Saving model ...
Epoch: 9 cost time: 3.2250099182128906
Epoch: 9, Steps: 9 | Train Loss: 0.697 Vali Loss: 0.725 Vali Acc: 0.725 Test Loss: 0.725 Test Acc: 0.725
Validation loss decreased (-0.659412 --> -0.724630).  Saving model ...
Epoch: 10 cost time: 3.4883615970611572
Epoch: 10, Steps: 9 | Train Loss: 0.608 Vali Loss: 0.638 Vali Acc: 0.754 Test Loss: 0.638 Test Acc: 0.754
Validation loss decreased (-0.724630 --> -0.753617).  Saving model ...
Epoch: 11 cost time: 3.4549720287323
Epoch: 11, Steps: 9 | Train Loss: 0.509 Vali Loss: 0.571 Vali Acc: 0.783 Test Loss: 0.571 Test Acc: 0.783
Validation loss decreased (-0.753617 --> -0.782603).  Saving model ...
Epoch: 12 cost time: 3.656536817550659
Epoch: 12, Steps: 9 | Train Loss: 0.471 Vali Loss: 0.553 Vali Acc: 0.775 Test Loss: 0.553 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.579122304916382
Epoch: 13, Steps: 9 | Train Loss: 0.424 Vali Loss: 0.566 Vali Acc: 0.754 Test Loss: 0.566 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.0770750045776367
Epoch: 14, Steps: 9 | Train Loss: 0.319 Vali Loss: 0.475 Vali Acc: 0.812 Test Loss: 0.475 Test Acc: 0.812
Validation loss decreased (-0.782603 --> -0.811589).  Saving model ...
Epoch: 15 cost time: 3.115586042404175
Epoch: 15, Steps: 9 | Train Loss: 0.327 Vali Loss: 0.466 Vali Acc: 0.812 Test Loss: 0.466 Test Acc: 0.812
Validation loss decreased (-0.811589 --> -0.811590).  Saving model ...
Epoch: 16 cost time: 3.1222386360168457
Epoch: 16, Steps: 9 | Train Loss: 0.290 Vali Loss: 0.496 Vali Acc: 0.783 Test Loss: 0.496 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.3831627368927
Epoch: 17, Steps: 9 | Train Loss: 0.256 Vali Loss: 0.482 Vali Acc: 0.812 Test Loss: 0.482 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.4370620250701904
Epoch: 18, Steps: 9 | Train Loss: 0.236 Vali Loss: 0.508 Vali Acc: 0.819 Test Loss: 0.508 Test Acc: 0.819
Validation loss decreased (-0.811590 --> -0.818835).  Saving model ...
Epoch: 19 cost time: 3.2519803047180176
Epoch: 19, Steps: 9 | Train Loss: 0.184 Vali Loss: 0.528 Vali Acc: 0.797 Test Loss: 0.528 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.023435115814209
Epoch: 20, Steps: 9 | Train Loss: 0.161 Vali Loss: 0.462 Vali Acc: 0.833 Test Loss: 0.462 Test Acc: 0.833
Validation loss decreased (-0.818835 --> -0.833329).  Saving model ...
Epoch: 21 cost time: 3.579660654067993
Epoch: 21, Steps: 9 | Train Loss: 0.146 Vali Loss: 0.425 Vali Acc: 0.833 Test Loss: 0.425 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 22 cost time: 3.264535903930664
Epoch: 22, Steps: 9 | Train Loss: 0.117 Vali Loss: 0.430 Vali Acc: 0.826 Test Loss: 0.430 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.588759422302246
Epoch: 23, Steps: 9 | Train Loss: 0.119 Vali Loss: 0.441 Vali Acc: 0.841 Test Loss: 0.441 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840575).  Saving model ...
Epoch: 24 cost time: 3.810826063156128
Epoch: 24, Steps: 9 | Train Loss: 0.134 Vali Loss: 0.430 Vali Acc: 0.833 Test Loss: 0.430 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.60292911529541
Epoch: 25, Steps: 9 | Train Loss: 0.099 Vali Loss: 0.365 Vali Acc: 0.870 Test Loss: 0.365 Test Acc: 0.870
Validation loss decreased (-0.840575 --> -0.869562).  Saving model ...
Epoch: 26 cost time: 3.5746281147003174
Epoch: 26, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.438 Vali Acc: 0.870 Test Loss: 0.438 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.120316982269287
Epoch: 27, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.432 Vali Acc: 0.855 Test Loss: 0.432 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.243293046951294
Epoch: 28, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.369 Vali Acc: 0.862 Test Loss: 0.369 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.1818010807037354
Epoch: 29, Steps: 9 | Train Loss: 0.080 Vali Loss: 0.444 Vali Acc: 0.848 Test Loss: 0.444 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.254547119140625
Epoch: 30, Steps: 9 | Train Loss: 0.087 Vali Loss: 0.368 Vali Acc: 0.862 Test Loss: 0.368 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 300156
model size : 1.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.9033002853393555
Epoch: 1, Steps: 9 | Train Loss: 1.348 Vali Loss: 1.401 Vali Acc: 0.254 Test Loss: 1.401 Test Acc: 0.254
Validation loss decreased (inf --> -0.253609).  Saving model ...
Epoch: 2 cost time: 3.0549895763397217
Epoch: 2, Steps: 9 | Train Loss: 1.348 Vali Loss: 1.342 Vali Acc: 0.304 Test Loss: 1.342 Test Acc: 0.304
Validation loss decreased (-0.253609 --> -0.304334).  Saving model ...
Epoch: 3 cost time: 2.981637954711914
Epoch: 3, Steps: 9 | Train Loss: 1.235 Vali Loss: 1.270 Vali Acc: 0.391 Test Loss: 1.270 Test Acc: 0.391
Validation loss decreased (-0.304334 --> -0.391292).  Saving model ...
Epoch: 4 cost time: 3.158705949783325
Epoch: 4, Steps: 9 | Train Loss: 1.150 Vali Loss: 1.190 Vali Acc: 0.522 Test Loss: 1.190 Test Acc: 0.522
Validation loss decreased (-0.391292 --> -0.521727).  Saving model ...
Epoch: 5 cost time: 2.583237409591675
Epoch: 5, Steps: 9 | Train Loss: 1.090 Vali Loss: 1.105 Vali Acc: 0.558 Test Loss: 1.105 Test Acc: 0.558
Validation loss decreased (-0.521727 --> -0.557960).  Saving model ...
Epoch: 6 cost time: 3.0001564025878906
Epoch: 6, Steps: 9 | Train Loss: 0.989 Vali Loss: 1.019 Vali Acc: 0.594 Test Loss: 1.019 Test Acc: 0.594
Validation loss decreased (-0.557960 --> -0.594193).  Saving model ...
Epoch: 7 cost time: 2.573200225830078
Epoch: 7, Steps: 9 | Train Loss: 0.893 Vali Loss: 0.943 Vali Acc: 0.616 Test Loss: 0.943 Test Acc: 0.616
Validation loss decreased (-0.594193 --> -0.615933).  Saving model ...
Epoch: 8 cost time: 2.5146586894989014
Epoch: 8, Steps: 9 | Train Loss: 0.814 Vali Loss: 0.864 Vali Acc: 0.652 Test Loss: 0.864 Test Acc: 0.652
Validation loss decreased (-0.615933 --> -0.652165).  Saving model ...
Epoch: 9 cost time: 2.8500983715057373
Epoch: 9, Steps: 9 | Train Loss: 0.729 Vali Loss: 0.789 Vali Acc: 0.645 Test Loss: 0.789 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.9848921298980713
Epoch: 10, Steps: 9 | Train Loss: 0.630 Vali Loss: 0.715 Vali Acc: 0.703 Test Loss: 0.715 Test Acc: 0.703
Validation loss decreased (-0.652165 --> -0.702891).  Saving model ...
Epoch: 11 cost time: 2.9929258823394775
Epoch: 11, Steps: 9 | Train Loss: 0.561 Vali Loss: 0.656 Vali Acc: 0.775 Test Loss: 0.656 Test Acc: 0.775
Validation loss decreased (-0.702891 --> -0.775356).  Saving model ...
Epoch: 12 cost time: 2.6844098567962646
Epoch: 12, Steps: 9 | Train Loss: 0.475 Vali Loss: 0.590 Vali Acc: 0.804 Test Loss: 0.590 Test Acc: 0.804
Validation loss decreased (-0.775356 --> -0.804342).  Saving model ...
Epoch: 13 cost time: 2.592437982559204
Epoch: 13, Steps: 9 | Train Loss: 0.429 Vali Loss: 0.530 Vali Acc: 0.826 Test Loss: 0.530 Test Acc: 0.826
Validation loss decreased (-0.804342 --> -0.826082).  Saving model ...
Epoch: 14 cost time: 2.8908164501190186
Epoch: 14, Steps: 9 | Train Loss: 0.365 Vali Loss: 0.482 Vali Acc: 0.826 Test Loss: 0.482 Test Acc: 0.826
Validation loss decreased (-0.826082 --> -0.826082).  Saving model ...
Epoch: 15 cost time: 2.8061347007751465
Epoch: 15, Steps: 9 | Train Loss: 0.350 Vali Loss: 0.456 Vali Acc: 0.855 Test Loss: 0.456 Test Acc: 0.855
Validation loss decreased (-0.826082 --> -0.855068).  Saving model ...
Epoch: 16 cost time: 2.7261383533477783
Epoch: 16, Steps: 9 | Train Loss: 0.277 Vali Loss: 0.432 Vali Acc: 0.862 Test Loss: 0.432 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862315).  Saving model ...
Epoch: 17 cost time: 2.880739212036133
Epoch: 17, Steps: 9 | Train Loss: 0.263 Vali Loss: 0.405 Vali Acc: 0.870 Test Loss: 0.405 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869561).  Saving model ...
Epoch: 18 cost time: 2.7567574977874756
Epoch: 18, Steps: 9 | Train Loss: 0.188 Vali Loss: 0.423 Vali Acc: 0.862 Test Loss: 0.423 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.923088550567627
Epoch: 19, Steps: 9 | Train Loss: 0.191 Vali Loss: 0.394 Vali Acc: 0.899 Test Loss: 0.394 Test Acc: 0.899
Validation loss decreased (-0.869561 --> -0.898547).  Saving model ...
Epoch: 20 cost time: 2.776001214981079
Epoch: 20, Steps: 9 | Train Loss: 0.163 Vali Loss: 0.355 Vali Acc: 0.899 Test Loss: 0.355 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 21 cost time: 2.7736213207244873
Epoch: 21, Steps: 9 | Train Loss: 0.123 Vali Loss: 0.356 Vali Acc: 0.884 Test Loss: 0.356 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.7781262397766113
Epoch: 22, Steps: 9 | Train Loss: 0.103 Vali Loss: 0.355 Vali Acc: 0.884 Test Loss: 0.355 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.005915641784668
Epoch: 23, Steps: 9 | Train Loss: 0.108 Vali Loss: 0.320 Vali Acc: 0.877 Test Loss: 0.320 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.690899610519409
Epoch: 24, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.323 Vali Acc: 0.913 Test Loss: 0.323 Test Acc: 0.913
Validation loss decreased (-0.898547 --> -0.913040).  Saving model ...
Epoch: 25 cost time: 2.8367347717285156
Epoch: 25, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.333 Vali Acc: 0.906 Test Loss: 0.333 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.76399564743042
Epoch: 26, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.330 Vali Acc: 0.899 Test Loss: 0.330 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.755915641784668
Epoch: 27, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.332 Vali Acc: 0.891 Test Loss: 0.332 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.4240574836730957
Epoch: 28, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.344 Vali Acc: 0.899 Test Loss: 0.344 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.55202579498291
Epoch: 29, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.324 Vali Acc: 0.920 Test Loss: 0.324 Test Acc: 0.920
Validation loss decreased (-0.913040 --> -0.920287).  Saving model ...
Epoch: 30 cost time: 2.954782247543335
Epoch: 30, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.322 Vali Acc: 0.920 Test Loss: 0.322 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 93116
model size : 0.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.766231060028076
Epoch: 1, Steps: 9 | Train Loss: 1.475 Vali Loss: 1.474 Vali Acc: 0.246 Test Loss: 1.474 Test Acc: 0.246
Validation loss decreased (inf --> -0.246362).  Saving model ...
Epoch: 2 cost time: 2.745698928833008
Epoch: 2, Steps: 9 | Train Loss: 1.411 Vali Loss: 1.418 Vali Acc: 0.239 Test Loss: 1.418 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.6508257389068604
Epoch: 3, Steps: 9 | Train Loss: 1.347 Vali Loss: 1.351 Vali Acc: 0.261 Test Loss: 1.351 Test Acc: 0.261
Validation loss decreased (-0.246362 --> -0.260856).  Saving model ...
Epoch: 4 cost time: 2.6799018383026123
Epoch: 4, Steps: 9 | Train Loss: 1.264 Vali Loss: 1.286 Vali Acc: 0.377 Test Loss: 1.286 Test Acc: 0.377
Validation loss decreased (-0.260856 --> -0.376799).  Saving model ...
Epoch: 5 cost time: 2.721956253051758
Epoch: 5, Steps: 9 | Train Loss: 1.176 Vali Loss: 1.216 Vali Acc: 0.471 Test Loss: 1.216 Test Acc: 0.471
Validation loss decreased (-0.376799 --> -0.471002).  Saving model ...
Epoch: 6 cost time: 2.710418224334717
Epoch: 6, Steps: 9 | Train Loss: 1.097 Vali Loss: 1.135 Vali Acc: 0.551 Test Loss: 1.135 Test Acc: 0.551
Validation loss decreased (-0.471002 --> -0.550713).  Saving model ...
Epoch: 7 cost time: 2.8812155723571777
Epoch: 7, Steps: 9 | Train Loss: 0.967 Vali Loss: 1.043 Vali Acc: 0.551 Test Loss: 1.043 Test Acc: 0.551
Validation loss decreased (-0.550713 --> -0.550714).  Saving model ...
Epoch: 8 cost time: 3.086076259613037
Epoch: 8, Steps: 9 | Train Loss: 0.861 Vali Loss: 0.942 Vali Acc: 0.616 Test Loss: 0.942 Test Acc: 0.616
Validation loss decreased (-0.550714 --> -0.615933).  Saving model ...
Epoch: 9 cost time: 2.5964746475219727
Epoch: 9, Steps: 9 | Train Loss: 0.770 Vali Loss: 0.849 Vali Acc: 0.645 Test Loss: 0.849 Test Acc: 0.645
Validation loss decreased (-0.615933 --> -0.644919).  Saving model ...
Epoch: 10 cost time: 2.549861431121826
Epoch: 10, Steps: 9 | Train Loss: 0.662 Vali Loss: 0.773 Vali Acc: 0.667 Test Loss: 0.773 Test Acc: 0.667
Validation loss decreased (-0.644919 --> -0.666659).  Saving model ...
Epoch: 11 cost time: 2.7343850135803223
Epoch: 11, Steps: 9 | Train Loss: 0.609 Vali Loss: 0.726 Vali Acc: 0.703 Test Loss: 0.726 Test Acc: 0.703
Validation loss decreased (-0.666659 --> -0.702891).  Saving model ...
Epoch: 12 cost time: 2.722217559814453
Epoch: 12, Steps: 9 | Train Loss: 0.515 Vali Loss: 0.658 Vali Acc: 0.710 Test Loss: 0.658 Test Acc: 0.710
Validation loss decreased (-0.702891 --> -0.710138).  Saving model ...
Epoch: 13 cost time: 2.4962780475616455
Epoch: 13, Steps: 9 | Train Loss: 0.434 Vali Loss: 0.631 Vali Acc: 0.739 Test Loss: 0.631 Test Acc: 0.739
Validation loss decreased (-0.710138 --> -0.739124).  Saving model ...
Epoch: 14 cost time: 2.4817094802856445
Epoch: 14, Steps: 9 | Train Loss: 0.398 Vali Loss: 0.588 Vali Acc: 0.746 Test Loss: 0.588 Test Acc: 0.746
Validation loss decreased (-0.739124 --> -0.746371).  Saving model ...
Epoch: 15 cost time: 2.847532272338867
Epoch: 15, Steps: 9 | Train Loss: 0.358 Vali Loss: 0.550 Vali Acc: 0.783 Test Loss: 0.550 Test Acc: 0.783
Validation loss decreased (-0.746371 --> -0.782603).  Saving model ...
Epoch: 16 cost time: 2.6377222537994385
Epoch: 16, Steps: 9 | Train Loss: 0.344 Vali Loss: 0.612 Vali Acc: 0.754 Test Loss: 0.612 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.8190910816192627
Epoch: 17, Steps: 9 | Train Loss: 0.289 Vali Loss: 0.589 Vali Acc: 0.761 Test Loss: 0.589 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.537057876586914
Epoch: 18, Steps: 9 | Train Loss: 0.235 Vali Loss: 0.628 Vali Acc: 0.768 Test Loss: 0.628 Test Acc: 0.768
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.713740587234497
Epoch: 19, Steps: 9 | Train Loss: 0.224 Vali Loss: 0.618 Vali Acc: 0.754 Test Loss: 0.618 Test Acc: 0.754
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.419898509979248
Epoch: 20, Steps: 9 | Train Loss: 0.179 Vali Loss: 0.576 Vali Acc: 0.783 Test Loss: 0.576 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.673184633255005
Epoch: 21, Steps: 9 | Train Loss: 0.186 Vali Loss: 0.604 Vali Acc: 0.804 Test Loss: 0.604 Test Acc: 0.804
Validation loss decreased (-0.782603 --> -0.804342).  Saving model ...
Epoch: 22 cost time: 2.5878705978393555
Epoch: 22, Steps: 9 | Train Loss: 0.148 Vali Loss: 0.583 Vali Acc: 0.797 Test Loss: 0.583 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.910057306289673
Epoch: 23, Steps: 9 | Train Loss: 0.143 Vali Loss: 0.558 Vali Acc: 0.775 Test Loss: 0.558 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.843845844268799
Epoch: 24, Steps: 9 | Train Loss: 0.139 Vali Loss: 0.572 Vali Acc: 0.804 Test Loss: 0.572 Test Acc: 0.804
Validation loss decreased (-0.804342 --> -0.804342).  Saving model ...
Epoch: 25 cost time: 2.611830711364746
Epoch: 25, Steps: 9 | Train Loss: 0.129 Vali Loss: 0.561 Vali Acc: 0.797 Test Loss: 0.561 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.5671138763427734
Epoch: 26, Steps: 9 | Train Loss: 0.141 Vali Loss: 0.578 Vali Acc: 0.812 Test Loss: 0.578 Test Acc: 0.812
Validation loss decreased (-0.804342 --> -0.811588).  Saving model ...
Epoch: 27 cost time: 2.466374397277832
Epoch: 27, Steps: 9 | Train Loss: 0.111 Vali Loss: 0.643 Vali Acc: 0.783 Test Loss: 0.643 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.3284876346588135
Epoch: 28, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.610 Vali Acc: 0.812 Test Loss: 0.610 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.652954578399658
Epoch: 29, Steps: 9 | Train Loss: 0.094 Vali Loss: 0.554 Vali Acc: 0.797 Test Loss: 0.554 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.7583906650543213
Epoch: 30, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.604 Vali Acc: 0.790 Test Loss: 0.604 Test Acc: 0.790
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8115942028985508
model parameter : 300156
model size : 1.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.135238885879517
Epoch: 1, Steps: 9 | Train Loss: 1.345 Vali Loss: 1.387 Vali Acc: 0.246 Test Loss: 1.387 Test Acc: 0.246
Validation loss decreased (inf --> -0.246363).  Saving model ...
Epoch: 2 cost time: 2.4103782176971436
Epoch: 2, Steps: 9 | Train Loss: 1.342 Vali Loss: 1.336 Vali Acc: 0.290 Test Loss: 1.336 Test Acc: 0.290
Validation loss decreased (-0.246363 --> -0.289842).  Saving model ...
Epoch: 3 cost time: 2.5785839557647705
Epoch: 3, Steps: 9 | Train Loss: 1.238 Vali Loss: 1.271 Vali Acc: 0.399 Test Loss: 1.271 Test Acc: 0.399
Validation loss decreased (-0.289842 --> -0.398538).  Saving model ...
Epoch: 4 cost time: 2.379387855529785
Epoch: 4, Steps: 9 | Train Loss: 1.159 Vali Loss: 1.197 Vali Acc: 0.507 Test Loss: 1.197 Test Acc: 0.507
Validation loss decreased (-0.398538 --> -0.507234).  Saving model ...
Epoch: 5 cost time: 2.36857533454895
Epoch: 5, Steps: 9 | Train Loss: 1.118 Vali Loss: 1.117 Vali Acc: 0.587 Test Loss: 1.117 Test Acc: 0.587
Validation loss decreased (-0.507234 --> -0.586945).  Saving model ...
Epoch: 6 cost time: 2.5633864402770996
Epoch: 6, Steps: 9 | Train Loss: 1.026 Vali Loss: 1.034 Vali Acc: 0.594 Test Loss: 1.034 Test Acc: 0.594
Validation loss decreased (-0.586945 --> -0.594193).  Saving model ...
Epoch: 7 cost time: 2.455990791320801
Epoch: 7, Steps: 9 | Train Loss: 0.942 Vali Loss: 0.963 Vali Acc: 0.616 Test Loss: 0.963 Test Acc: 0.616
Validation loss decreased (-0.594193 --> -0.615932).  Saving model ...
Epoch: 8 cost time: 2.5254199504852295
Epoch: 8, Steps: 9 | Train Loss: 0.843 Vali Loss: 0.892 Vali Acc: 0.638 Test Loss: 0.892 Test Acc: 0.638
Validation loss decreased (-0.615932 --> -0.637672).  Saving model ...
Epoch: 9 cost time: 2.382016897201538
Epoch: 9, Steps: 9 | Train Loss: 0.783 Vali Loss: 0.833 Vali Acc: 0.659 Test Loss: 0.833 Test Acc: 0.659
Validation loss decreased (-0.637672 --> -0.659412).  Saving model ...
Epoch: 10 cost time: 2.456173896789551
Epoch: 10, Steps: 9 | Train Loss: 0.689 Vali Loss: 0.771 Vali Acc: 0.696 Test Loss: 0.771 Test Acc: 0.696
Validation loss decreased (-0.659412 --> -0.695644).  Saving model ...
Epoch: 11 cost time: 2.5441207885742188
Epoch: 11, Steps: 9 | Train Loss: 0.619 Vali Loss: 0.718 Vali Acc: 0.703 Test Loss: 0.718 Test Acc: 0.703
Validation loss decreased (-0.695644 --> -0.702891).  Saving model ...
Epoch: 12 cost time: 2.4179954528808594
Epoch: 12, Steps: 9 | Train Loss: 0.548 Vali Loss: 0.668 Vali Acc: 0.754 Test Loss: 0.668 Test Acc: 0.754
Validation loss decreased (-0.702891 --> -0.753617).  Saving model ...
Epoch: 13 cost time: 2.3986568450927734
Epoch: 13, Steps: 9 | Train Loss: 0.496 Vali Loss: 0.619 Vali Acc: 0.746 Test Loss: 0.619 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.4540698528289795
Epoch: 14, Steps: 9 | Train Loss: 0.426 Vali Loss: 0.575 Vali Acc: 0.768 Test Loss: 0.575 Test Acc: 0.768
Validation loss decreased (-0.753617 --> -0.768110).  Saving model ...
Epoch: 15 cost time: 2.4260356426239014
Epoch: 15, Steps: 9 | Train Loss: 0.393 Vali Loss: 0.528 Vali Acc: 0.797 Test Loss: 0.528 Test Acc: 0.797
Validation loss decreased (-0.768110 --> -0.797096).  Saving model ...
Epoch: 16 cost time: 2.468480110168457
Epoch: 16, Steps: 9 | Train Loss: 0.342 Vali Loss: 0.511 Vali Acc: 0.804 Test Loss: 0.511 Test Acc: 0.804
Validation loss decreased (-0.797096 --> -0.804343).  Saving model ...
Epoch: 17 cost time: 2.585439920425415
Epoch: 17, Steps: 9 | Train Loss: 0.336 Vali Loss: 0.495 Vali Acc: 0.804 Test Loss: 0.495 Test Acc: 0.804
Validation loss decreased (-0.804343 --> -0.804343).  Saving model ...
Epoch: 18 cost time: 2.165994882583618
Epoch: 18, Steps: 9 | Train Loss: 0.235 Vali Loss: 0.463 Vali Acc: 0.812 Test Loss: 0.463 Test Acc: 0.812
Validation loss decreased (-0.804343 --> -0.811590).  Saving model ...
Epoch: 19 cost time: 2.2557194232940674
Epoch: 19, Steps: 9 | Train Loss: 0.226 Vali Loss: 0.435 Vali Acc: 0.819 Test Loss: 0.435 Test Acc: 0.819
Validation loss decreased (-0.811590 --> -0.818836).  Saving model ...
Epoch: 20 cost time: 2.150447368621826
Epoch: 20, Steps: 9 | Train Loss: 0.190 Vali Loss: 0.424 Vali Acc: 0.826 Test Loss: 0.424 Test Acc: 0.826
Validation loss decreased (-0.818836 --> -0.826083).  Saving model ...
Epoch: 21 cost time: 2.1604838371276855
Epoch: 21, Steps: 9 | Train Loss: 0.190 Vali Loss: 0.423 Vali Acc: 0.833 Test Loss: 0.423 Test Acc: 0.833
Validation loss decreased (-0.826083 --> -0.833329).  Saving model ...
Epoch: 22 cost time: 2.180302619934082
Epoch: 22, Steps: 9 | Train Loss: 0.165 Vali Loss: 0.404 Vali Acc: 0.812 Test Loss: 0.404 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.159064531326294
Epoch: 23, Steps: 9 | Train Loss: 0.176 Vali Loss: 0.376 Vali Acc: 0.848 Test Loss: 0.376 Test Acc: 0.848
Validation loss decreased (-0.833329 --> -0.847822).  Saving model ...
Epoch: 24 cost time: 1.992572546005249
Epoch: 24, Steps: 9 | Train Loss: 0.132 Vali Loss: 0.358 Vali Acc: 0.841 Test Loss: 0.358 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.097642660140991
Epoch: 25, Steps: 9 | Train Loss: 0.146 Vali Loss: 0.372 Vali Acc: 0.833 Test Loss: 0.372 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.239448308944702
Epoch: 26, Steps: 9 | Train Loss: 0.140 Vali Loss: 0.353 Vali Acc: 0.841 Test Loss: 0.353 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.1973609924316406
Epoch: 27, Steps: 9 | Train Loss: 0.107 Vali Loss: 0.352 Vali Acc: 0.877 Test Loss: 0.352 Test Acc: 0.877
Validation loss decreased (-0.847822 --> -0.876808).  Saving model ...
Epoch: 28 cost time: 2.155496597290039
Epoch: 28, Steps: 9 | Train Loss: 0.087 Vali Loss: 0.362 Vali Acc: 0.862 Test Loss: 0.362 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.104233980178833
Epoch: 29, Steps: 9 | Train Loss: 0.107 Vali Loss: 0.357 Vali Acc: 0.884 Test Loss: 0.357 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884054).  Saving model ...
Epoch: 30 cost time: 2.4562456607818604
Epoch: 30, Steps: 9 | Train Loss: 0.080 Vali Loss: 0.348 Vali Acc: 0.870 Test Loss: 0.348 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el4_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 93116
model size : 0.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 30.105411529541016
Epoch: 1, Steps: 9 | Train Loss: 1.333 Vali Loss: 1.031 Vali Acc: 0.674 Test Loss: 1.031 Test Acc: 0.674
Validation loss decreased (inf --> -0.673903).  Saving model ...
Epoch: 2 cost time: 28.4856858253479
Epoch: 2, Steps: 9 | Train Loss: 0.771 Vali Loss: 0.535 Vali Acc: 0.783 Test Loss: 0.535 Test Acc: 0.783
Validation loss decreased (-0.673903 --> -0.782603).  Saving model ...
Epoch: 3 cost time: 29.242902517318726
Epoch: 3, Steps: 9 | Train Loss: 0.454 Vali Loss: 0.386 Vali Acc: 0.841 Test Loss: 0.386 Test Acc: 0.841
Validation loss decreased (-0.782603 --> -0.840576).  Saving model ...
Epoch: 4 cost time: 25.971569776535034
Epoch: 4, Steps: 9 | Train Loss: 0.182 Vali Loss: 0.387 Vali Acc: 0.884 Test Loss: 0.387 Test Acc: 0.884
Validation loss decreased (-0.840576 --> -0.884054).  Saving model ...
Epoch: 5 cost time: 27.71053957939148
Epoch: 5, Steps: 9 | Train Loss: 0.144 Vali Loss: 0.468 Vali Acc: 0.833 Test Loss: 0.468 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 29.002331018447876
Epoch: 6, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.316 Vali Acc: 0.891 Test Loss: 0.316 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891301).  Saving model ...
Epoch: 7 cost time: 26.54606580734253
Epoch: 7, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.319 Vali Acc: 0.899 Test Loss: 0.319 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898548).  Saving model ...
Epoch: 8 cost time: 31.517675638198853
Epoch: 8, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.496 Vali Acc: 0.862 Test Loss: 0.496 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 31.427516222000122
Epoch: 9, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.490 Vali Acc: 0.848 Test Loss: 0.490 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 31.18785071372986
Epoch: 10, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.328 Vali Acc: 0.928 Test Loss: 0.328 Test Acc: 0.928
Validation loss decreased (-0.898548 --> -0.927533).  Saving model ...
Epoch: 11 cost time: 30.977349758148193
Epoch: 11, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.772 Vali Acc: 0.790 Test Loss: 0.772 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 28.394858360290527
Epoch: 12, Steps: 9 | Train Loss: 0.125 Vali Loss: 0.420 Vali Acc: 0.884 Test Loss: 0.420 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 26.908036470413208
Epoch: 13, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.576 Vali Acc: 0.862 Test Loss: 0.576 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 28.251684188842773
Epoch: 14, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.308 Vali Acc: 0.906 Test Loss: 0.308 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 28.974522352218628
Epoch: 15, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.636 Vali Acc: 0.855 Test Loss: 0.636 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 29.783560276031494
Epoch: 16, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.625 Vali Acc: 0.855 Test Loss: 0.625 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 28.948107481002808
Epoch: 17, Steps: 9 | Train Loss: 0.206 Vali Loss: 0.430 Vali Acc: 0.877 Test Loss: 0.430 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 27.157798767089844
Epoch: 18, Steps: 9 | Train Loss: 0.194 Vali Loss: 0.877 Vali Acc: 0.754 Test Loss: 0.877 Test Acc: 0.754
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 31.10597252845764
Epoch: 19, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.511 Vali Acc: 0.877 Test Loss: 0.511 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 30.15000605583191
Epoch: 20, Steps: 9 | Train Loss: 0.186 Vali Loss: 0.496 Vali Acc: 0.862 Test Loss: 0.496 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.927536231884058
model parameter : 56344196
model size : 217.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 13.125235557556152
Epoch: 1, Steps: 9 | Train Loss: 1.298 Vali Loss: 1.002 Vali Acc: 0.594 Test Loss: 1.002 Test Acc: 0.594
Validation loss decreased (inf --> -0.594193).  Saving model ...
Epoch: 2 cost time: 10.862295389175415
Epoch: 2, Steps: 9 | Train Loss: 0.812 Vali Loss: 0.549 Vali Acc: 0.783 Test Loss: 0.549 Test Acc: 0.783
Validation loss decreased (-0.594193 --> -0.782603).  Saving model ...
Epoch: 3 cost time: 10.864229679107666
Epoch: 3, Steps: 9 | Train Loss: 0.381 Vali Loss: 0.376 Vali Acc: 0.862 Test Loss: 0.376 Test Acc: 0.862
Validation loss decreased (-0.782603 --> -0.862315).  Saving model ...
Epoch: 4 cost time: 10.050591230392456
Epoch: 4, Steps: 9 | Train Loss: 0.267 Vali Loss: 0.611 Vali Acc: 0.790 Test Loss: 0.611 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.578321933746338
Epoch: 5, Steps: 9 | Train Loss: 0.124 Vali Loss: 0.326 Vali Acc: 0.884 Test Loss: 0.326 Test Acc: 0.884
Validation loss decreased (-0.862315 --> -0.884055).  Saving model ...
Epoch: 6 cost time: 9.700515985488892
Epoch: 6, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.431 Vali Acc: 0.833 Test Loss: 0.431 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.644605875015259
Epoch: 7, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.463 Vali Acc: 0.862 Test Loss: 0.463 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 10.47301721572876
Epoch: 8, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.535 Vali Acc: 0.826 Test Loss: 0.535 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 10.69283127784729
Epoch: 9, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.435 Vali Acc: 0.877 Test Loss: 0.435 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 10.764475345611572
Epoch: 10, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.569 Vali Acc: 0.833 Test Loss: 0.569 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 10.769890785217285
Epoch: 11, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.501 Vali Acc: 0.891 Test Loss: 0.501 Test Acc: 0.891
Validation loss decreased (-0.884055 --> -0.891299).  Saving model ...
Epoch: 12 cost time: 10.746520757675171
Epoch: 12, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.481 Vali Acc: 0.891 Test Loss: 0.481 Test Acc: 0.891
Validation loss decreased (-0.891299 --> -0.891300).  Saving model ...
Epoch: 13 cost time: 10.768792629241943
Epoch: 13, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.484 Vali Acc: 0.891 Test Loss: 0.484 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 10.843419551849365
Epoch: 14, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.371 Vali Acc: 0.899 Test Loss: 0.371 Test Acc: 0.899
Validation loss decreased (-0.891300 --> -0.898547).  Saving model ...
Epoch: 15 cost time: 10.19992184638977
Epoch: 15, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.313 Vali Acc: 0.891 Test Loss: 0.313 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 10.383588552474976
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.360 Vali Acc: 0.884 Test Loss: 0.360 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 11.28606367111206
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.407 Vali Acc: 0.891 Test Loss: 0.407 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 11.195659875869751
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.415 Vali Acc: 0.899 Test Loss: 0.415 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 11.025944948196411
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.461 Vali Acc: 0.884 Test Loss: 0.461 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 11.194100379943848
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.386 Vali Acc: 0.891 Test Loss: 0.386 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 11.380205392837524
Epoch: 21, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.536 Vali Acc: 0.877 Test Loss: 0.536 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 11.247779130935669
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.663 Vali Acc: 0.855 Test Loss: 0.663 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 11.08475947380066
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.622 Vali Acc: 0.877 Test Loss: 0.622 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 11.276249885559082
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.560 Vali Acc: 0.877 Test Loss: 0.560 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 16627076
model size : 65.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 21.353408098220825
Epoch: 1, Steps: 9 | Train Loss: 1.336 Vali Loss: 1.055 Vali Acc: 0.659 Test Loss: 1.055 Test Acc: 0.659
Validation loss decreased (inf --> -0.659410).  Saving model ...
Epoch: 2 cost time: 20.925496101379395
Epoch: 2, Steps: 9 | Train Loss: 0.849 Vali Loss: 0.647 Vali Acc: 0.739 Test Loss: 0.647 Test Acc: 0.739
Validation loss decreased (-0.659410 --> -0.739124).  Saving model ...
Epoch: 3 cost time: 21.133262157440186
Epoch: 3, Steps: 9 | Train Loss: 0.515 Vali Loss: 0.385 Vali Acc: 0.841 Test Loss: 0.385 Test Acc: 0.841
Validation loss decreased (-0.739124 --> -0.840576).  Saving model ...
Epoch: 4 cost time: 21.54010844230652
Epoch: 4, Steps: 9 | Train Loss: 0.252 Vali Loss: 0.534 Vali Acc: 0.826 Test Loss: 0.534 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 20.184242963790894
Epoch: 5, Steps: 9 | Train Loss: 0.140 Vali Loss: 0.460 Vali Acc: 0.855 Test Loss: 0.460 Test Acc: 0.855
Validation loss decreased (-0.840576 --> -0.855068).  Saving model ...
Epoch: 6 cost time: 23.107130765914917
Epoch: 6, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.374 Vali Acc: 0.884 Test Loss: 0.374 Test Acc: 0.884
Validation loss decreased (-0.855068 --> -0.884054).  Saving model ...
Epoch: 7 cost time: 23.395177841186523
Epoch: 7, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.294 Vali Acc: 0.899 Test Loss: 0.294 Test Acc: 0.899
Validation loss decreased (-0.884054 --> -0.898548).  Saving model ...
Epoch: 8 cost time: 23.491016387939453
Epoch: 8, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.370 Vali Acc: 0.899 Test Loss: 0.370 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 22.77674627304077
Epoch: 9, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.347 Vali Acc: 0.906 Test Loss: 0.347 Test Acc: 0.906
Validation loss decreased (-0.898548 --> -0.905794).  Saving model ...
Epoch: 10 cost time: 21.932788848876953
Epoch: 10, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.397 Vali Acc: 0.899 Test Loss: 0.397 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 19.51902675628662
Epoch: 11, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.407 Vali Acc: 0.891 Test Loss: 0.407 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 21.28252911567688
Epoch: 12, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.377 Vali Acc: 0.870 Test Loss: 0.377 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 21.171602487564087
Epoch: 13, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.430 Vali Acc: 0.906 Test Loss: 0.430 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 21.04537558555603
Epoch: 14, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.403 Vali Acc: 0.913 Test Loss: 0.403 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913039).  Saving model ...
Epoch: 15 cost time: 20.452340602874756
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.394 Vali Acc: 0.913 Test Loss: 0.394 Test Acc: 0.913
Validation loss decreased (-0.913039 --> -0.913040).  Saving model ...
Epoch: 16 cost time: 21.481691598892212
Epoch: 16, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.353 Vali Acc: 0.920 Test Loss: 0.353 Test Acc: 0.920
Validation loss decreased (-0.913040 --> -0.920286).  Saving model ...
Epoch: 17 cost time: 22.0580050945282
Epoch: 17, Steps: 9 | Train Loss: 0.464 Vali Loss: 1.580 Vali Acc: 0.775 Test Loss: 1.580 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 21.686084747314453
Epoch: 18, Steps: 9 | Train Loss: 0.196 Vali Loss: 0.727 Vali Acc: 0.783 Test Loss: 0.727 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 22.058513402938843
Epoch: 19, Steps: 9 | Train Loss: 0.006 Vali Loss: 2.020 Vali Acc: 0.732 Test Loss: 2.020 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 20.46688437461853
Epoch: 20, Steps: 9 | Train Loss: 0.531 Vali Loss: 1.166 Vali Acc: 0.819 Test Loss: 1.166 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 18.572198390960693
Epoch: 21, Steps: 9 | Train Loss: 0.042 Vali Loss: 1.680 Vali Acc: 0.819 Test Loss: 1.680 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 19.423641443252563
Epoch: 22, Steps: 9 | Train Loss: 0.107 Vali Loss: 1.871 Vali Acc: 0.688 Test Loss: 1.871 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 19.447291135787964
Epoch: 23, Steps: 9 | Train Loss: 0.475 Vali Loss: 2.547 Vali Acc: 0.638 Test Loss: 2.547 Test Acc: 0.638
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 20.267289876937866
Epoch: 24, Steps: 9 | Train Loss: 0.131 Vali Loss: 1.039 Vali Acc: 0.841 Test Loss: 1.039 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 20.170302629470825
Epoch: 25, Steps: 9 | Train Loss: 0.154 Vali Loss: 0.913 Vali Acc: 0.826 Test Loss: 0.913 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 19.336334943771362
Epoch: 26, Steps: 9 | Train Loss: 0.753 Vali Loss: 1.505 Vali Acc: 0.645 Test Loss: 1.505 Test Acc: 0.645
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 56344196
model size : 217.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 9.619420051574707
Epoch: 1, Steps: 9 | Train Loss: 1.294 Vali Loss: 1.020 Vali Acc: 0.623 Test Loss: 1.020 Test Acc: 0.623
Validation loss decreased (inf --> -0.623178).  Saving model ...
Epoch: 2 cost time: 7.854419231414795
Epoch: 2, Steps: 9 | Train Loss: 0.853 Vali Loss: 0.603 Vali Acc: 0.768 Test Loss: 0.603 Test Acc: 0.768
Validation loss decreased (-0.623178 --> -0.768110).  Saving model ...
Epoch: 3 cost time: 7.761421203613281
Epoch: 3, Steps: 9 | Train Loss: 0.417 Vali Loss: 0.370 Vali Acc: 0.862 Test Loss: 0.370 Test Acc: 0.862
Validation loss decreased (-0.768110 --> -0.862315).  Saving model ...
Epoch: 4 cost time: 8.045763731002808
Epoch: 4, Steps: 9 | Train Loss: 0.280 Vali Loss: 0.522 Vali Acc: 0.812 Test Loss: 0.522 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.429283857345581
Epoch: 5, Steps: 9 | Train Loss: 0.118 Vali Loss: 0.376 Vali Acc: 0.862 Test Loss: 0.376 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.265163898468018
Epoch: 6, Steps: 9 | Train Loss: 0.114 Vali Loss: 0.388 Vali Acc: 0.870 Test Loss: 0.388 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869561).  Saving model ...
Epoch: 7 cost time: 7.585709571838379
Epoch: 7, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.589 Vali Acc: 0.826 Test Loss: 0.589 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.147928953170776
Epoch: 8, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.406 Vali Acc: 0.862 Test Loss: 0.406 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.7647316455841064
Epoch: 9, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.473 Vali Acc: 0.891 Test Loss: 0.473 Test Acc: 0.891
Validation loss decreased (-0.869561 --> -0.891300).  Saving model ...
Epoch: 10 cost time: 7.817397594451904
Epoch: 10, Steps: 9 | Train Loss: 0.180 Vali Loss: 0.437 Vali Acc: 0.884 Test Loss: 0.437 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.864259719848633
Epoch: 11, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.419 Vali Acc: 0.877 Test Loss: 0.419 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 8.120065212249756
Epoch: 12, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.555 Vali Acc: 0.855 Test Loss: 0.555 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 8.071473598480225
Epoch: 13, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.190 Vali Acc: 0.804 Test Loss: 1.190 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 8.017231464385986
Epoch: 14, Steps: 9 | Train Loss: 0.143 Vali Loss: 0.975 Vali Acc: 0.855 Test Loss: 0.975 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 7.441419363021851
Epoch: 15, Steps: 9 | Train Loss: 0.122 Vali Loss: 0.860 Vali Acc: 0.775 Test Loss: 0.860 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 7.6753411293029785
Epoch: 16, Steps: 9 | Train Loss: 0.079 Vali Loss: 1.460 Vali Acc: 0.725 Test Loss: 1.460 Test Acc: 0.725
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 8.282729387283325
Epoch: 17, Steps: 9 | Train Loss: 0.008 Vali Loss: 1.576 Vali Acc: 0.732 Test Loss: 1.576 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 8.27532410621643
Epoch: 18, Steps: 9 | Train Loss: 0.176 Vali Loss: 1.125 Vali Acc: 0.739 Test Loss: 1.125 Test Acc: 0.739
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 8.304531574249268
Epoch: 19, Steps: 9 | Train Loss: 0.123 Vali Loss: 0.606 Vali Acc: 0.826 Test Loss: 0.606 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 16627076
model size : 65.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 14.754517078399658
Epoch: 1, Steps: 9 | Train Loss: 1.340 Vali Loss: 1.147 Vali Acc: 0.551 Test Loss: 1.147 Test Acc: 0.551
Validation loss decreased (inf --> -0.550713).  Saving model ...
Epoch: 2 cost time: 13.367139339447021
Epoch: 2, Steps: 9 | Train Loss: 0.881 Vali Loss: 0.813 Vali Acc: 0.659 Test Loss: 0.813 Test Acc: 0.659
Validation loss decreased (-0.550713 --> -0.659412).  Saving model ...
Epoch: 3 cost time: 12.09403920173645
Epoch: 3, Steps: 9 | Train Loss: 0.508 Vali Loss: 0.517 Vali Acc: 0.783 Test Loss: 0.517 Test Acc: 0.783
Validation loss decreased (-0.659412 --> -0.782604).  Saving model ...
Epoch: 4 cost time: 12.445635557174683
Epoch: 4, Steps: 9 | Train Loss: 0.251 Vali Loss: 0.527 Vali Acc: 0.790 Test Loss: 0.527 Test Acc: 0.790
Validation loss decreased (-0.782604 --> -0.789850).  Saving model ...
Epoch: 5 cost time: 12.817358016967773
Epoch: 5, Steps: 9 | Train Loss: 0.125 Vali Loss: 0.503 Vali Acc: 0.797 Test Loss: 0.503 Test Acc: 0.797
Validation loss decreased (-0.789850 --> -0.797096).  Saving model ...
Epoch: 6 cost time: 13.240721464157104
Epoch: 6, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.506 Vali Acc: 0.870 Test Loss: 0.506 Test Acc: 0.870
Validation loss decreased (-0.797096 --> -0.869560).  Saving model ...
Epoch: 7 cost time: 12.940354585647583
Epoch: 7, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.328 Vali Acc: 0.906 Test Loss: 0.328 Test Acc: 0.906
Validation loss decreased (-0.869560 --> -0.905794).  Saving model ...
Epoch: 8 cost time: 11.53466010093689
Epoch: 8, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.437 Vali Acc: 0.862 Test Loss: 0.437 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 12.795723915100098
Epoch: 9, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.522 Vali Acc: 0.870 Test Loss: 0.522 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 12.615882873535156
Epoch: 10, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.434 Vali Acc: 0.884 Test Loss: 0.434 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 13.631629228591919
Epoch: 11, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.592 Vali Acc: 0.804 Test Loss: 0.592 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 13.744266986846924
Epoch: 12, Steps: 9 | Train Loss: 0.149 Vali Loss: 0.689 Vali Acc: 0.833 Test Loss: 0.689 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 14.027123212814331
Epoch: 13, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.506 Vali Acc: 0.884 Test Loss: 0.506 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 13.967631816864014
Epoch: 14, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.418 Vali Acc: 0.906 Test Loss: 0.418 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 12.562966346740723
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.373 Vali Acc: 0.899 Test Loss: 0.373 Test Acc: 0.899
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 12.544363260269165
Epoch: 16, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.437 Vali Acc: 0.884 Test Loss: 0.437 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 13.003945589065552
Epoch: 17, Steps: 9 | Train Loss: 0.107 Vali Loss: 1.503 Vali Acc: 0.812 Test Loss: 1.503 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 56344196
model size : 217.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 7.23694634437561
Epoch: 1, Steps: 9 | Train Loss: 1.287 Vali Loss: 1.099 Vali Acc: 0.551 Test Loss: 1.099 Test Acc: 0.551
Validation loss decreased (inf --> -0.550714).  Saving model ...
Epoch: 2 cost time: 5.764128923416138
Epoch: 2, Steps: 9 | Train Loss: 0.879 Vali Loss: 0.827 Vali Acc: 0.674 Test Loss: 0.827 Test Acc: 0.674
Validation loss decreased (-0.550714 --> -0.673905).  Saving model ...
Epoch: 3 cost time: 5.507507562637329
Epoch: 3, Steps: 9 | Train Loss: 0.497 Vali Loss: 0.590 Vali Acc: 0.717 Test Loss: 0.590 Test Acc: 0.717
Validation loss decreased (-0.673905 --> -0.717385).  Saving model ...
Epoch: 4 cost time: 5.734368801116943
Epoch: 4, Steps: 9 | Train Loss: 0.294 Vali Loss: 0.615 Vali Acc: 0.783 Test Loss: 0.615 Test Acc: 0.783
Validation loss decreased (-0.717385 --> -0.782603).  Saving model ...
Epoch: 5 cost time: 5.681467294692993
Epoch: 5, Steps: 9 | Train Loss: 0.136 Vali Loss: 0.477 Vali Acc: 0.841 Test Loss: 0.477 Test Acc: 0.841
Validation loss decreased (-0.782603 --> -0.840575).  Saving model ...
Epoch: 6 cost time: 5.7158873081207275
Epoch: 6, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.408 Vali Acc: 0.877 Test Loss: 0.408 Test Acc: 0.877
Validation loss decreased (-0.840575 --> -0.876808).  Saving model ...
Epoch: 7 cost time: 5.5823774337768555
Epoch: 7, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.345 Vali Acc: 0.884 Test Loss: 0.345 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884055).  Saving model ...
Epoch: 8 cost time: 5.50537633895874
Epoch: 8, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.347 Vali Acc: 0.899 Test Loss: 0.347 Test Acc: 0.899
Validation loss decreased (-0.884055 --> -0.898547).  Saving model ...
Epoch: 9 cost time: 5.422134160995483
Epoch: 9, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.392 Vali Acc: 0.913 Test Loss: 0.392 Test Acc: 0.913
Validation loss decreased (-0.898547 --> -0.913040).  Saving model ...
Epoch: 10 cost time: 5.721943140029907
Epoch: 10, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.436 Vali Acc: 0.906 Test Loss: 0.436 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.767103910446167
Epoch: 11, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.454 Vali Acc: 0.891 Test Loss: 0.454 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.872513771057129
Epoch: 12, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.445 Vali Acc: 0.891 Test Loss: 0.445 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.737434387207031
Epoch: 13, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.425 Vali Acc: 0.899 Test Loss: 0.425 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.651810646057129
Epoch: 14, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.174 Vali Acc: 0.783 Test Loss: 1.174 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.525003910064697
Epoch: 15, Steps: 9 | Train Loss: 0.012 Vali Loss: 1.474 Vali Acc: 0.797 Test Loss: 1.474 Test Acc: 0.797
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.771815299987793
Epoch: 16, Steps: 9 | Train Loss: 0.209 Vali Loss: 1.379 Vali Acc: 0.768 Test Loss: 1.379 Test Acc: 0.768
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.52553129196167
Epoch: 17, Steps: 9 | Train Loss: 0.012 Vali Loss: 1.733 Vali Acc: 0.710 Test Loss: 1.733 Test Acc: 0.710
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.387351989746094
Epoch: 18, Steps: 9 | Train Loss: 0.423 Vali Loss: 0.850 Vali Acc: 0.768 Test Loss: 0.850 Test Acc: 0.768
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.3341064453125
Epoch: 19, Steps: 9 | Train Loss: 0.535 Vali Loss: 0.453 Vali Acc: 0.877 Test Loss: 0.453 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 16627076
model size : 65.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 17.772552967071533
Epoch: 1, Steps: 9 | Train Loss: 1.315 Vali Loss: 1.044 Vali Acc: 0.681 Test Loss: 1.044 Test Acc: 0.681
Validation loss decreased (inf --> -0.681149).  Saving model ...
Epoch: 2 cost time: 16.29279136657715
Epoch: 2, Steps: 9 | Train Loss: 0.812 Vali Loss: 0.562 Vali Acc: 0.790 Test Loss: 0.562 Test Acc: 0.790
Validation loss decreased (-0.681149 --> -0.789849).  Saving model ...
Epoch: 3 cost time: 16.6087703704834
Epoch: 3, Steps: 9 | Train Loss: 0.410 Vali Loss: 0.412 Vali Acc: 0.848 Test Loss: 0.412 Test Acc: 0.848
Validation loss decreased (-0.789849 --> -0.847822).  Saving model ...
Epoch: 4 cost time: 16.410900592803955
Epoch: 4, Steps: 9 | Train Loss: 0.212 Vali Loss: 0.522 Vali Acc: 0.833 Test Loss: 0.522 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 16.153168439865112
Epoch: 5, Steps: 9 | Train Loss: 0.193 Vali Loss: 0.449 Vali Acc: 0.884 Test Loss: 0.449 Test Acc: 0.884
Validation loss decreased (-0.847822 --> -0.884053).  Saving model ...
Epoch: 6 cost time: 18.521769285202026
Epoch: 6, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.609 Vali Acc: 0.804 Test Loss: 0.609 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 18.15195322036743
Epoch: 7, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.424 Vali Acc: 0.884 Test Loss: 0.424 Test Acc: 0.884
Validation loss decreased (-0.884053 --> -0.884054).  Saving model ...
Epoch: 8 cost time: 17.84165930747986
Epoch: 8, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.656 Vali Acc: 0.819 Test Loss: 0.656 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 18.021682500839233
Epoch: 9, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.625 Vali Acc: 0.855 Test Loss: 0.625 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 17.961788654327393
Epoch: 10, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.411 Vali Acc: 0.899 Test Loss: 0.411 Test Acc: 0.899
Validation loss decreased (-0.884054 --> -0.898547).  Saving model ...
Epoch: 11 cost time: 17.01536774635315
Epoch: 11, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.651 Vali Acc: 0.826 Test Loss: 0.651 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 15.104587078094482
Epoch: 12, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.599 Vali Acc: 0.841 Test Loss: 0.599 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 16.345110177993774
Epoch: 13, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.451 Vali Acc: 0.899 Test Loss: 0.451 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 16.683187007904053
Epoch: 14, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.607 Vali Acc: 0.862 Test Loss: 0.607 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 16.51214575767517
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.679 Vali Acc: 0.848 Test Loss: 0.679 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 16.750403881072998
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.654 Vali Acc: 0.848 Test Loss: 0.654 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 16.47649049758911
Epoch: 17, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.395 Vali Acc: 0.877 Test Loss: 0.395 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 15.700429201126099
Epoch: 18, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.729 Vali Acc: 0.848 Test Loss: 0.729 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 17.554258346557617
Epoch: 19, Steps: 9 | Train Loss: 0.107 Vali Loss: 0.792 Vali Acc: 0.833 Test Loss: 0.792 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 17.474011659622192
Epoch: 20, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.482 Vali Acc: 0.884 Test Loss: 0.482 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 28226948
model size : 110.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 8.623067140579224
Epoch: 1, Steps: 9 | Train Loss: 1.365 Vali Loss: 1.092 Vali Acc: 0.645 Test Loss: 1.092 Test Acc: 0.645
Validation loss decreased (inf --> -0.644917).  Saving model ...
Epoch: 2 cost time: 6.79757285118103
Epoch: 2, Steps: 9 | Train Loss: 0.838 Vali Loss: 0.637 Vali Acc: 0.797 Test Loss: 0.637 Test Acc: 0.797
Validation loss decreased (-0.644917 --> -0.797095).  Saving model ...
Epoch: 3 cost time: 6.886461019515991
Epoch: 3, Steps: 9 | Train Loss: 0.459 Vali Loss: 0.483 Vali Acc: 0.819 Test Loss: 0.483 Test Acc: 0.819
Validation loss decreased (-0.797095 --> -0.818836).  Saving model ...
Epoch: 4 cost time: 6.65530800819397
Epoch: 4, Steps: 9 | Train Loss: 0.329 Vali Loss: 0.378 Vali Acc: 0.862 Test Loss: 0.378 Test Acc: 0.862
Validation loss decreased (-0.818836 --> -0.862315).  Saving model ...
Epoch: 5 cost time: 6.630897283554077
Epoch: 5, Steps: 9 | Train Loss: 0.151 Vali Loss: 0.525 Vali Acc: 0.804 Test Loss: 0.525 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.933987379074097
Epoch: 6, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.446 Vali Acc: 0.848 Test Loss: 0.446 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.4594621658325195
Epoch: 7, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.446 Vali Acc: 0.833 Test Loss: 0.446 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.424332857131958
Epoch: 8, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.406 Vali Acc: 0.862 Test Loss: 0.406 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.402746915817261
Epoch: 9, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.545 Vali Acc: 0.826 Test Loss: 0.545 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 6.388051509857178
Epoch: 10, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.509 Vali Acc: 0.833 Test Loss: 0.509 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 6.2868571281433105
Epoch: 11, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.362 Vali Acc: 0.891 Test Loss: 0.362 Test Acc: 0.891
Validation loss decreased (-0.862315 --> -0.891301).  Saving model ...
Epoch: 12 cost time: 6.333216667175293
Epoch: 12, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.356 Vali Acc: 0.891 Test Loss: 0.356 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 13 cost time: 6.2734668254852295
Epoch: 13, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.458 Vali Acc: 0.870 Test Loss: 0.458 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.301460266113281
Epoch: 14, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.554 Vali Acc: 0.855 Test Loss: 0.554 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.464335203170776
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.456 Vali Acc: 0.884 Test Loss: 0.456 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.413981914520264
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.403 Vali Acc: 0.884 Test Loss: 0.403 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.895916700363159
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.403 Vali Acc: 0.877 Test Loss: 0.403 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.8666675090789795
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.438 Vali Acc: 0.877 Test Loss: 0.438 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 6.3128502368927
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.448 Vali Acc: 0.877 Test Loss: 0.448 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 6.388131141662598
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.446 Vali Acc: 0.877 Test Loss: 0.446 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 6.125114440917969
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.444 Vali Acc: 0.884 Test Loss: 0.444 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 6.244288206100464
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.434 Vali Acc: 0.884 Test Loss: 0.434 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 8368004
model size : 34.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 13.832837581634521
Epoch: 1, Steps: 9 | Train Loss: 1.319 Vali Loss: 1.058 Vali Acc: 0.645 Test Loss: 1.058 Test Acc: 0.645
Validation loss decreased (inf --> -0.644917).  Saving model ...
Epoch: 2 cost time: 12.121747493743896
Epoch: 2, Steps: 9 | Train Loss: 0.880 Vali Loss: 0.641 Vali Acc: 0.768 Test Loss: 0.641 Test Acc: 0.768
Validation loss decreased (-0.644917 --> -0.768110).  Saving model ...
Epoch: 3 cost time: 11.69539213180542
Epoch: 3, Steps: 9 | Train Loss: 0.602 Vali Loss: 0.425 Vali Acc: 0.862 Test Loss: 0.425 Test Acc: 0.862
Validation loss decreased (-0.768110 --> -0.862315).  Saving model ...
Epoch: 4 cost time: 11.108196020126343
Epoch: 4, Steps: 9 | Train Loss: 0.251 Vali Loss: 0.410 Vali Acc: 0.833 Test Loss: 0.410 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 11.540678024291992
Epoch: 5, Steps: 9 | Train Loss: 0.182 Vali Loss: 0.373 Vali Acc: 0.855 Test Loss: 0.373 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 11.542758464813232
Epoch: 6, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.402 Vali Acc: 0.855 Test Loss: 0.402 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 11.322225093841553
Epoch: 7, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.484 Vali Acc: 0.841 Test Loss: 0.484 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 11.870079040527344
Epoch: 8, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.600 Vali Acc: 0.819 Test Loss: 0.600 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 11.678016185760498
Epoch: 9, Steps: 9 | Train Loss: 0.243 Vali Loss: 0.743 Vali Acc: 0.862 Test Loss: 0.743 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 12.34871792793274
Epoch: 10, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.889 Vali Acc: 0.804 Test Loss: 0.889 Test Acc: 0.804
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 12.013550519943237
Epoch: 11, Steps: 9 | Train Loss: 0.156 Vali Loss: 0.414 Vali Acc: 0.891 Test Loss: 0.414 Test Acc: 0.891
Validation loss decreased (-0.862315 --> -0.891300).  Saving model ...
Epoch: 12 cost time: 12.187434196472168
Epoch: 12, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.512 Vali Acc: 0.855 Test Loss: 0.512 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 12.166284799575806
Epoch: 13, Steps: 9 | Train Loss: 0.087 Vali Loss: 0.492 Vali Acc: 0.870 Test Loss: 0.492 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 11.945414781570435
Epoch: 14, Steps: 9 | Train Loss: 0.179 Vali Loss: 0.612 Vali Acc: 0.870 Test Loss: 0.612 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 12.144984483718872
Epoch: 15, Steps: 9 | Train Loss: 0.030 Vali Loss: 2.900 Vali Acc: 0.732 Test Loss: 2.900 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 12.393260478973389
Epoch: 16, Steps: 9 | Train Loss: 0.027 Vali Loss: 3.044 Vali Acc: 0.739 Test Loss: 3.044 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 11.141641616821289
Epoch: 17, Steps: 9 | Train Loss: 0.020 Vali Loss: 2.632 Vali Acc: 0.696 Test Loss: 2.632 Test Acc: 0.696
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 11.195723295211792
Epoch: 18, Steps: 9 | Train Loss: 0.194 Vali Loss: 1.196 Vali Acc: 0.841 Test Loss: 1.196 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 11.718531370162964
Epoch: 19, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.651 Vali Acc: 0.855 Test Loss: 0.651 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 11.636224508285522
Epoch: 20, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.335 Vali Acc: 0.899 Test Loss: 0.335 Test Acc: 0.899
Validation loss decreased (-0.891300 --> -0.898547).  Saving model ...
Epoch: 21 cost time: 11.822086095809937
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.401 Vali Acc: 0.862 Test Loss: 0.401 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 11.863110780715942
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.484 Vali Acc: 0.877 Test Loss: 0.484 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 11.944165468215942
Epoch: 23, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.531 Vali Acc: 0.891 Test Loss: 0.531 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 11.233711242675781
Epoch: 24, Steps: 9 | Train Loss: 0.164 Vali Loss: 0.701 Vali Acc: 0.855 Test Loss: 0.701 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 12.156817197799683
Epoch: 25, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.286 Vali Acc: 0.920 Test Loss: 0.286 Test Acc: 0.920
Validation loss decreased (-0.898547 --> -0.920287).  Saving model ...
Epoch: 26 cost time: 12.145005226135254
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.858 Vali Acc: 0.812 Test Loss: 0.858 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 11.166544437408447
Epoch: 27, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.531 Vali Acc: 0.891 Test Loss: 0.531 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 11.174400806427002
Epoch: 28, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.453 Vali Acc: 0.899 Test Loss: 0.453 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 11.150817155838013
Epoch: 29, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.849 Vali Acc: 0.812 Test Loss: 0.849 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 12.311222791671753
Epoch: 30, Steps: 9 | Train Loss: 0.023 Vali Loss: 1.501 Vali Acc: 0.848 Test Loss: 1.501 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 28226948
model size : 110.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 6.662104606628418
Epoch: 1, Steps: 9 | Train Loss: 1.368 Vali Loss: 1.119 Vali Acc: 0.580 Test Loss: 1.119 Test Acc: 0.580
Validation loss decreased (inf --> -0.579699).  Saving model ...
Epoch: 2 cost time: 4.715851545333862
Epoch: 2, Steps: 9 | Train Loss: 0.871 Vali Loss: 0.677 Vali Acc: 0.754 Test Loss: 0.677 Test Acc: 0.754
Validation loss decreased (-0.579699 --> -0.753616).  Saving model ...
Epoch: 3 cost time: 4.903605937957764
Epoch: 3, Steps: 9 | Train Loss: 0.535 Vali Loss: 0.525 Vali Acc: 0.804 Test Loss: 0.525 Test Acc: 0.804
Validation loss decreased (-0.753616 --> -0.804343).  Saving model ...
Epoch: 4 cost time: 5.084632396697998
Epoch: 4, Steps: 9 | Train Loss: 0.280 Vali Loss: 0.308 Vali Acc: 0.877 Test Loss: 0.308 Test Acc: 0.877
Validation loss decreased (-0.804343 --> -0.876809).  Saving model ...
Epoch: 5 cost time: 5.116860628128052
Epoch: 5, Steps: 9 | Train Loss: 0.294 Vali Loss: 0.459 Vali Acc: 0.833 Test Loss: 0.459 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.0655317306518555
Epoch: 6, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.411 Vali Acc: 0.833 Test Loss: 0.411 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.1023149490356445
Epoch: 7, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.473 Vali Acc: 0.848 Test Loss: 0.473 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.1786394119262695
Epoch: 8, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.403 Vali Acc: 0.877 Test Loss: 0.403 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.943046808242798
Epoch: 9, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.458 Vali Acc: 0.870 Test Loss: 0.458 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.099912405014038
Epoch: 10, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.425 Vali Acc: 0.884 Test Loss: 0.425 Test Acc: 0.884
Validation loss decreased (-0.876809 --> -0.884054).  Saving model ...
Epoch: 11 cost time: 5.007428169250488
Epoch: 11, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.392 Vali Acc: 0.891 Test Loss: 0.392 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891300).  Saving model ...
Epoch: 12 cost time: 5.115085601806641
Epoch: 12, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.388 Vali Acc: 0.884 Test Loss: 0.388 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.095028400421143
Epoch: 13, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.462 Vali Acc: 0.877 Test Loss: 0.462 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.899431228637695
Epoch: 14, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.517 Vali Acc: 0.877 Test Loss: 0.517 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.949141502380371
Epoch: 15, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.463 Vali Acc: 0.891 Test Loss: 0.463 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.0848705768585205
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.438 Vali Acc: 0.891 Test Loss: 0.438 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.193209648132324
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.432 Vali Acc: 0.891 Test Loss: 0.432 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.259692430496216
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.445 Vali Acc: 0.891 Test Loss: 0.445 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.281290054321289
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.441 Vali Acc: 0.877 Test Loss: 0.441 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.340210914611816
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.468 Vali Acc: 0.891 Test Loss: 0.468 Test Acc: 0.891
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.242330312728882
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.411 Vali Acc: 0.884 Test Loss: 0.411 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 8368004
model size : 34.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 9.700042963027954
Epoch: 1, Steps: 9 | Train Loss: 1.324 Vali Loss: 1.135 Vali Acc: 0.572 Test Loss: 1.135 Test Acc: 0.572
Validation loss decreased (inf --> -0.572452).  Saving model ...
Epoch: 2 cost time: 8.06321668624878
Epoch: 2, Steps: 9 | Train Loss: 0.933 Vali Loss: 0.841 Vali Acc: 0.630 Test Loss: 0.841 Test Acc: 0.630
Validation loss decreased (-0.572452 --> -0.630426).  Saving model ...
Epoch: 3 cost time: 7.937185525894165
Epoch: 3, Steps: 9 | Train Loss: 0.564 Vali Loss: 0.650 Vali Acc: 0.746 Test Loss: 0.650 Test Acc: 0.746
Validation loss decreased (-0.630426 --> -0.746370).  Saving model ...
Epoch: 4 cost time: 8.035447835922241
Epoch: 4, Steps: 9 | Train Loss: 0.305 Vali Loss: 0.613 Vali Acc: 0.775 Test Loss: 0.613 Test Acc: 0.775
Validation loss decreased (-0.746370 --> -0.775356).  Saving model ...
Epoch: 5 cost time: 7.492470979690552
Epoch: 5, Steps: 9 | Train Loss: 0.158 Vali Loss: 0.400 Vali Acc: 0.848 Test Loss: 0.400 Test Acc: 0.848
Validation loss decreased (-0.775356 --> -0.847822).  Saving model ...
Epoch: 6 cost time: 8.006303787231445
Epoch: 6, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.387 Vali Acc: 0.862 Test Loss: 0.387 Test Acc: 0.862
Validation loss decreased (-0.847822 --> -0.862315).  Saving model ...
Epoch: 7 cost time: 7.868594408035278
Epoch: 7, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.460 Vali Acc: 0.877 Test Loss: 0.460 Test Acc: 0.877
Validation loss decreased (-0.862315 --> -0.876807).  Saving model ...
Epoch: 8 cost time: 7.952969551086426
Epoch: 8, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.388 Vali Acc: 0.891 Test Loss: 0.388 Test Acc: 0.891
Validation loss decreased (-0.876807 --> -0.891300).  Saving model ...
Epoch: 9 cost time: 7.778203248977661
Epoch: 9, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.364 Vali Acc: 0.891 Test Loss: 0.364 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891301).  Saving model ...
Epoch: 10 cost time: 8.007385969161987
Epoch: 10, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.500 Vali Acc: 0.870 Test Loss: 0.500 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.6995689868927
Epoch: 11, Steps: 9 | Train Loss: 0.208 Vali Loss: 0.548 Vali Acc: 0.855 Test Loss: 0.548 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 8.254135608673096
Epoch: 12, Steps: 9 | Train Loss: 0.034 Vali Loss: 1.310 Vali Acc: 0.739 Test Loss: 1.310 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 7.7332422733306885
Epoch: 13, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.904 Vali Acc: 0.761 Test Loss: 0.904 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 8.45112943649292
Epoch: 14, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.938 Vali Acc: 0.790 Test Loss: 0.938 Test Acc: 0.790
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 8.636351108551025
Epoch: 15, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.887 Vali Acc: 0.775 Test Loss: 0.887 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 8.591449499130249
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.927 Vali Acc: 0.775 Test Loss: 0.927 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 8.527178764343262
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.870 Vali Acc: 0.768 Test Loss: 0.870 Test Acc: 0.768
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 8.212834119796753
Epoch: 18, Steps: 9 | Train Loss: 0.024 Vali Loss: 1.256 Vali Acc: 0.717 Test Loss: 1.256 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 8.578930377960205
Epoch: 19, Steps: 9 | Train Loss: 0.354 Vali Loss: 0.756 Vali Acc: 0.812 Test Loss: 0.756 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 28226948
model size : 110.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.72364616394043
Epoch: 1, Steps: 9 | Train Loss: 1.377 Vali Loss: 1.171 Vali Acc: 0.529 Test Loss: 1.171 Test Acc: 0.529
Validation loss decreased (inf --> -0.528974).  Saving model ...
Epoch: 2 cost time: 4.084367990493774
Epoch: 2, Steps: 9 | Train Loss: 0.917 Vali Loss: 0.877 Vali Acc: 0.659 Test Loss: 0.877 Test Acc: 0.659
Validation loss decreased (-0.528974 --> -0.659412).  Saving model ...
Epoch: 3 cost time: 4.041881561279297
Epoch: 3, Steps: 9 | Train Loss: 0.573 Vali Loss: 0.691 Vali Acc: 0.717 Test Loss: 0.691 Test Acc: 0.717
Validation loss decreased (-0.659412 --> -0.717384).  Saving model ...
Epoch: 4 cost time: 3.9687070846557617
Epoch: 4, Steps: 9 | Train Loss: 0.303 Vali Loss: 0.423 Vali Acc: 0.804 Test Loss: 0.423 Test Acc: 0.804
Validation loss decreased (-0.717384 --> -0.804344).  Saving model ...
Epoch: 5 cost time: 3.8860995769500732
Epoch: 5, Steps: 9 | Train Loss: 0.261 Vali Loss: 0.500 Vali Acc: 0.826 Test Loss: 0.500 Test Acc: 0.826
Validation loss decreased (-0.804344 --> -0.826082).  Saving model ...
Epoch: 6 cost time: 3.7514731884002686
Epoch: 6, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.479 Vali Acc: 0.833 Test Loss: 0.479 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833329).  Saving model ...
Epoch: 7 cost time: 3.902855396270752
Epoch: 7, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.542 Vali Acc: 0.826 Test Loss: 0.542 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.8306572437286377
Epoch: 8, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.821 Vali Acc: 0.681 Test Loss: 0.821 Test Acc: 0.681
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.7756707668304443
Epoch: 9, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.655 Vali Acc: 0.819 Test Loss: 0.655 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.8116021156311035
Epoch: 10, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.616 Vali Acc: 0.841 Test Loss: 0.616 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840574).  Saving model ...
Epoch: 11 cost time: 3.743279218673706
Epoch: 11, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.639 Vali Acc: 0.819 Test Loss: 0.639 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.829237222671509
Epoch: 12, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.376 Vali Acc: 0.870 Test Loss: 0.376 Test Acc: 0.870
Validation loss decreased (-0.840574 --> -0.869561).  Saving model ...
Epoch: 13 cost time: 3.8077619075775146
Epoch: 13, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.433 Vali Acc: 0.877 Test Loss: 0.433 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876807).  Saving model ...
Epoch: 14 cost time: 3.8979666233062744
Epoch: 14, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.469 Vali Acc: 0.870 Test Loss: 0.469 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.7812142372131348
Epoch: 15, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.444 Vali Acc: 0.884 Test Loss: 0.444 Test Acc: 0.884
Validation loss decreased (-0.876807 --> -0.884054).  Saving model ...
Epoch: 16 cost time: 3.7207634449005127
Epoch: 16, Steps: 9 | Train Loss: 0.087 Vali Loss: 0.575 Vali Acc: 0.826 Test Loss: 0.575 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.9524660110473633
Epoch: 17, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.867 Vali Acc: 0.732 Test Loss: 0.867 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.906564950942993
Epoch: 18, Steps: 9 | Train Loss: 0.007 Vali Loss: 1.087 Vali Acc: 0.717 Test Loss: 1.087 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.8006505966186523
Epoch: 19, Steps: 9 | Train Loss: 0.138 Vali Loss: 1.503 Vali Acc: 0.775 Test Loss: 1.503 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.7833385467529297
Epoch: 20, Steps: 9 | Train Loss: 0.025 Vali Loss: 1.883 Vali Acc: 0.775 Test Loss: 1.883 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.4796597957611084
Epoch: 21, Steps: 9 | Train Loss: 0.117 Vali Loss: 2.219 Vali Acc: 0.645 Test Loss: 2.219 Test Acc: 0.645
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.5637624263763428
Epoch: 22, Steps: 9 | Train Loss: 0.013 Vali Loss: 1.323 Vali Acc: 0.761 Test Loss: 1.323 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.578788995742798
Epoch: 23, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.165 Vali Acc: 0.804 Test Loss: 1.165 Test Acc: 0.804
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.5351169109344482
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.138 Vali Acc: 0.775 Test Loss: 1.138 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.8415210247039795
Epoch: 25, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.586 Vali Acc: 0.732 Test Loss: 1.586 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 8368004
model size : 34.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 21.90537977218628
Epoch: 1, Steps: 9 | Train Loss: 1.433 Vali Loss: 1.194 Vali Acc: 0.493 Test Loss: 1.194 Test Acc: 0.493
Validation loss decreased (inf --> -0.492742).  Saving model ...
Epoch: 2 cost time: 19.782764434814453
Epoch: 2, Steps: 9 | Train Loss: 1.024 Vali Loss: 0.747 Vali Acc: 0.710 Test Loss: 0.747 Test Acc: 0.710
Validation loss decreased (-0.492742 --> -0.710137).  Saving model ...
Epoch: 3 cost time: 19.638081312179565
Epoch: 3, Steps: 9 | Train Loss: 0.634 Vali Loss: 0.480 Vali Acc: 0.775 Test Loss: 0.480 Test Acc: 0.775
Validation loss decreased (-0.710137 --> -0.775358).  Saving model ...
Epoch: 4 cost time: 18.589280605316162
Epoch: 4, Steps: 9 | Train Loss: 0.395 Vali Loss: 0.446 Vali Acc: 0.797 Test Loss: 0.446 Test Acc: 0.797
Validation loss decreased (-0.775358 --> -0.797097).  Saving model ...
Epoch: 5 cost time: 19.4730224609375
Epoch: 5, Steps: 9 | Train Loss: 0.231 Vali Loss: 0.519 Vali Acc: 0.848 Test Loss: 0.519 Test Acc: 0.848
Validation loss decreased (-0.797097 --> -0.847821).  Saving model ...
Epoch: 6 cost time: 19.617011785507202
Epoch: 6, Steps: 9 | Train Loss: 0.146 Vali Loss: 0.651 Vali Acc: 0.826 Test Loss: 0.651 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 19.610593795776367
Epoch: 7, Steps: 9 | Train Loss: 0.154 Vali Loss: 0.451 Vali Acc: 0.862 Test Loss: 0.451 Test Acc: 0.862
Validation loss decreased (-0.847821 --> -0.862314).  Saving model ...
Epoch: 8 cost time: 19.255632877349854
Epoch: 8, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.446 Vali Acc: 0.862 Test Loss: 0.446 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 9 cost time: 19.253190755844116
Epoch: 9, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.556 Vali Acc: 0.797 Test Loss: 0.556 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 19.64639949798584
Epoch: 10, Steps: 9 | Train Loss: 0.287 Vali Loss: 0.767 Vali Acc: 0.797 Test Loss: 0.767 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 20.093852758407593
Epoch: 11, Steps: 9 | Train Loss: 0.123 Vali Loss: 0.498 Vali Acc: 0.790 Test Loss: 0.498 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 19.066264390945435
Epoch: 12, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.405 Vali Acc: 0.884 Test Loss: 0.405 Test Acc: 0.884
Validation loss decreased (-0.862314 --> -0.884054).  Saving model ...
Epoch: 13 cost time: 18.214135885238647
Epoch: 13, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.583 Vali Acc: 0.855 Test Loss: 0.583 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 18.073009967803955
Epoch: 14, Steps: 9 | Train Loss: 0.087 Vali Loss: 0.498 Vali Acc: 0.812 Test Loss: 0.498 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 18.421245336532593
Epoch: 15, Steps: 9 | Train Loss: 0.139 Vali Loss: 0.529 Vali Acc: 0.826 Test Loss: 0.529 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 18.31777787208557
Epoch: 16, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.671 Vali Acc: 0.826 Test Loss: 0.671 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 18.55149555206299
Epoch: 17, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.492 Vali Acc: 0.870 Test Loss: 0.492 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 18.719884634017944
Epoch: 18, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.554 Vali Acc: 0.848 Test Loss: 0.554 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 19.94004249572754
Epoch: 19, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.439 Vali Acc: 0.870 Test Loss: 0.439 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 20.161850214004517
Epoch: 20, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.445 Vali Acc: 0.884 Test Loss: 0.445 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 20.152942419052124
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.471 Vali Acc: 0.884 Test Loss: 0.471 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 20.607115983963013
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.477 Vali Acc: 0.884 Test Loss: 0.477 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 28174404
model size : 108.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 9.97800588607788
Epoch: 1, Steps: 9 | Train Loss: 1.384 Vali Loss: 1.255 Vali Acc: 0.464 Test Loss: 1.255 Test Acc: 0.464
Validation loss decreased (inf --> -0.463756).  Saving model ...
Epoch: 2 cost time: 7.809880018234253
Epoch: 2, Steps: 9 | Train Loss: 1.031 Vali Loss: 0.822 Vali Acc: 0.746 Test Loss: 0.822 Test Acc: 0.746
Validation loss decreased (-0.463756 --> -0.746369).  Saving model ...
Epoch: 3 cost time: 7.207154273986816
Epoch: 3, Steps: 9 | Train Loss: 0.651 Vali Loss: 0.523 Vali Acc: 0.790 Test Loss: 0.523 Test Acc: 0.790
Validation loss decreased (-0.746369 --> -0.789850).  Saving model ...
Epoch: 4 cost time: 7.269883871078491
Epoch: 4, Steps: 9 | Train Loss: 0.360 Vali Loss: 0.406 Vali Acc: 0.833 Test Loss: 0.406 Test Acc: 0.833
Validation loss decreased (-0.789850 --> -0.833329).  Saving model ...
Epoch: 5 cost time: 7.626585245132446
Epoch: 5, Steps: 9 | Train Loss: 0.241 Vali Loss: 0.351 Vali Acc: 0.862 Test Loss: 0.351 Test Acc: 0.862
Validation loss decreased (-0.833329 --> -0.862315).  Saving model ...
Epoch: 6 cost time: 7.566827774047852
Epoch: 6, Steps: 9 | Train Loss: 0.171 Vali Loss: 0.320 Vali Acc: 0.899 Test Loss: 0.320 Test Acc: 0.899
Validation loss decreased (-0.862315 --> -0.898548).  Saving model ...
Epoch: 7 cost time: 7.970912456512451
Epoch: 7, Steps: 9 | Train Loss: 0.124 Vali Loss: 0.332 Vali Acc: 0.870 Test Loss: 0.332 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.80266809463501
Epoch: 8, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.350 Vali Acc: 0.877 Test Loss: 0.350 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.753949403762817
Epoch: 9, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.360 Vali Acc: 0.884 Test Loss: 0.360 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 7.609630107879639
Epoch: 10, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.333 Vali Acc: 0.891 Test Loss: 0.333 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 7.166550636291504
Epoch: 11, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.383 Vali Acc: 0.884 Test Loss: 0.383 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 7.74129843711853
Epoch: 12, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.389 Vali Acc: 0.891 Test Loss: 0.389 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 7.693243503570557
Epoch: 13, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.393 Vali Acc: 0.891 Test Loss: 0.393 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 7.671666145324707
Epoch: 14, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.328 Vali Acc: 0.913 Test Loss: 0.328 Test Acc: 0.913
Validation loss decreased (-0.898548 --> -0.913040).  Saving model ...
Epoch: 15 cost time: 7.15734601020813
Epoch: 15, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.295 Vali Acc: 0.906 Test Loss: 0.295 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 7.055370569229126
Epoch: 16, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.303 Vali Acc: 0.899 Test Loss: 0.303 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 7.1596925258636475
Epoch: 17, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.286 Vali Acc: 0.906 Test Loss: 0.286 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 7.2042272090911865
Epoch: 18, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.277 Vali Acc: 0.913 Test Loss: 0.277 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913041).  Saving model ...
Epoch: 19 cost time: 7.203221797943115
Epoch: 19, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.239 Vali Acc: 0.920 Test Loss: 0.239 Test Acc: 0.920
Validation loss decreased (-0.913041 --> -0.920287).  Saving model ...
Epoch: 20 cost time: 7.647109746932983
Epoch: 20, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.269 Vali Acc: 0.928 Test Loss: 0.269 Test Acc: 0.928
Validation loss decreased (-0.920287 --> -0.927534).  Saving model ...
Epoch: 21 cost time: 7.732104063034058
Epoch: 21, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.339 Vali Acc: 0.906 Test Loss: 0.339 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 7.574869155883789
Epoch: 22, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.446 Vali Acc: 0.906 Test Loss: 0.446 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 7.592334508895874
Epoch: 23, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.283 Vali Acc: 0.942 Test Loss: 0.283 Test Acc: 0.942
Validation loss decreased (-0.927534 --> -0.942026).  Saving model ...
Epoch: 24 cost time: 7.602897644042969
Epoch: 24, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.203 Vali Acc: 0.957 Test Loss: 0.203 Test Acc: 0.957
Validation loss decreased (-0.942026 --> -0.956520).  Saving model ...
Epoch: 25 cost time: 7.612029790878296
Epoch: 25, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.261 Vali Acc: 0.920 Test Loss: 0.261 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 7.736682891845703
Epoch: 26, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.320 Vali Acc: 0.920 Test Loss: 0.320 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 7.72499680519104
Epoch: 27, Steps: 9 | Train Loss: 0.098 Vali Loss: 0.285 Vali Acc: 0.928 Test Loss: 0.285 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 7.642590761184692
Epoch: 28, Steps: 9 | Train Loss: 0.250 Vali Loss: 0.810 Vali Acc: 0.928 Test Loss: 0.810 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 7.663197994232178
Epoch: 29, Steps: 9 | Train Loss: 0.200 Vali Loss: 0.345 Vali Acc: 0.884 Test Loss: 0.345 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 7.668190240859985
Epoch: 30, Steps: 9 | Train Loss: 0.102 Vali Loss: 0.327 Vali Acc: 0.884 Test Loss: 0.327 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9565217391304348
model parameter : 8315076
model size : 32.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 15.22991394996643
Epoch: 1, Steps: 9 | Train Loss: 1.436 Vali Loss: 1.224 Vali Acc: 0.471 Test Loss: 1.224 Test Acc: 0.471
Validation loss decreased (inf --> -0.471002).  Saving model ...
Epoch: 2 cost time: 13.860804319381714
Epoch: 2, Steps: 9 | Train Loss: 1.072 Vali Loss: 0.819 Vali Acc: 0.674 Test Loss: 0.819 Test Acc: 0.674
Validation loss decreased (-0.471002 --> -0.673905).  Saving model ...
Epoch: 3 cost time: 13.769790887832642
Epoch: 3, Steps: 9 | Train Loss: 0.710 Vali Loss: 0.534 Vali Acc: 0.804 Test Loss: 0.534 Test Acc: 0.804
Validation loss decreased (-0.673905 --> -0.804342).  Saving model ...
Epoch: 4 cost time: 13.657310485839844
Epoch: 4, Steps: 9 | Train Loss: 0.438 Vali Loss: 0.404 Vali Acc: 0.833 Test Loss: 0.404 Test Acc: 0.833
Validation loss decreased (-0.804342 --> -0.833329).  Saving model ...
Epoch: 5 cost time: 14.127549886703491
Epoch: 5, Steps: 9 | Train Loss: 0.286 Vali Loss: 0.396 Vali Acc: 0.841 Test Loss: 0.396 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840576).  Saving model ...
Epoch: 6 cost time: 13.767202854156494
Epoch: 6, Steps: 9 | Train Loss: 0.157 Vali Loss: 0.437 Vali Acc: 0.841 Test Loss: 0.437 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 14.299866914749146
Epoch: 7, Steps: 9 | Train Loss: 0.106 Vali Loss: 0.437 Vali Acc: 0.833 Test Loss: 0.437 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 14.387952327728271
Epoch: 8, Steps: 9 | Train Loss: 0.452 Vali Loss: 0.334 Vali Acc: 0.870 Test Loss: 0.334 Test Acc: 0.870
Validation loss decreased (-0.840576 --> -0.869562).  Saving model ...
Epoch: 9 cost time: 14.474279880523682
Epoch: 9, Steps: 9 | Train Loss: 0.177 Vali Loss: 0.508 Vali Acc: 0.812 Test Loss: 0.508 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 14.532135725021362
Epoch: 10, Steps: 9 | Train Loss: 0.114 Vali Loss: 0.487 Vali Acc: 0.862 Test Loss: 0.487 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 13.517242670059204
Epoch: 11, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.366 Vali Acc: 0.870 Test Loss: 0.366 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 14.673553943634033
Epoch: 12, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.363 Vali Acc: 0.862 Test Loss: 0.363 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 14.808091640472412
Epoch: 13, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.556 Vali Acc: 0.862 Test Loss: 0.556 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 14.211430072784424
Epoch: 14, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.464 Vali Acc: 0.891 Test Loss: 0.464 Test Acc: 0.891
Validation loss decreased (-0.869562 --> -0.891300).  Saving model ...
Epoch: 15 cost time: 14.480924606323242
Epoch: 15, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.291 Vali Acc: 0.899 Test Loss: 0.291 Test Acc: 0.899
Validation loss decreased (-0.891300 --> -0.898548).  Saving model ...
Epoch: 16 cost time: 13.790879726409912
Epoch: 16, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.369 Vali Acc: 0.891 Test Loss: 0.369 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 14.956620216369629
Epoch: 17, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.409 Vali Acc: 0.899 Test Loss: 0.409 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 15.904526948928833
Epoch: 18, Steps: 9 | Train Loss: 0.105 Vali Loss: 0.592 Vali Acc: 0.833 Test Loss: 0.592 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 18.37757182121277
Epoch: 19, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.438 Vali Acc: 0.906 Test Loss: 0.438 Test Acc: 0.906
Validation loss decreased (-0.898548 --> -0.905793).  Saving model ...
Epoch: 20 cost time: 18.36708927154541
Epoch: 20, Steps: 9 | Train Loss: 0.013 Vali Loss: 1.050 Vali Acc: 0.855 Test Loss: 1.050 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 17.606388807296753
Epoch: 21, Steps: 9 | Train Loss: 0.122 Vali Loss: 1.174 Vali Acc: 0.826 Test Loss: 1.174 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 16.97290825843811
Epoch: 22, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.383 Vali Acc: 0.877 Test Loss: 0.383 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 17.714390754699707
Epoch: 23, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.365 Vali Acc: 0.870 Test Loss: 0.365 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 17.207310676574707
Epoch: 24, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.363 Vali Acc: 0.891 Test Loss: 0.363 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 17.72474455833435
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.386 Vali Acc: 0.906 Test Loss: 0.386 Test Acc: 0.906
Validation loss decreased (-0.905793 --> -0.905793).  Saving model ...
Epoch: 26 cost time: 17.987086296081543
Epoch: 26, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.294 Vali Acc: 0.899 Test Loss: 0.294 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 17.214999198913574
Epoch: 27, Steps: 9 | Train Loss: 0.434 Vali Loss: 0.602 Vali Acc: 0.826 Test Loss: 0.602 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 17.078277111053467
Epoch: 28, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.682 Vali Acc: 0.790 Test Loss: 0.682 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 17.590497970581055
Epoch: 29, Steps: 9 | Train Loss: 0.303 Vali Loss: 0.871 Vali Acc: 0.870 Test Loss: 0.871 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 17.59802484512329
Epoch: 30, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.666 Vali Acc: 0.870 Test Loss: 0.666 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 28174404
model size : 108.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 9.424955368041992
Epoch: 1, Steps: 9 | Train Loss: 1.383 Vali Loss: 1.256 Vali Acc: 0.464 Test Loss: 1.256 Test Acc: 0.464
Validation loss decreased (inf --> -0.463756).  Saving model ...
Epoch: 2 cost time: 7.262638330459595
Epoch: 2, Steps: 9 | Train Loss: 1.061 Vali Loss: 0.850 Vali Acc: 0.775 Test Loss: 0.850 Test Acc: 0.775
Validation loss decreased (-0.463756 --> -0.775354).  Saving model ...
Epoch: 3 cost time: 7.072529315948486
Epoch: 3, Steps: 9 | Train Loss: 0.701 Vali Loss: 0.530 Vali Acc: 0.812 Test Loss: 0.530 Test Acc: 0.812
Validation loss decreased (-0.775354 --> -0.811589).  Saving model ...
Epoch: 4 cost time: 7.059401750564575
Epoch: 4, Steps: 9 | Train Loss: 0.447 Vali Loss: 0.387 Vali Acc: 0.848 Test Loss: 0.387 Test Acc: 0.848
Validation loss decreased (-0.811589 --> -0.847822).  Saving model ...
Epoch: 5 cost time: 7.040089845657349
Epoch: 5, Steps: 9 | Train Loss: 0.269 Vali Loss: 0.343 Vali Acc: 0.870 Test Loss: 0.343 Test Acc: 0.870
Validation loss decreased (-0.847822 --> -0.869562).  Saving model ...
Epoch: 6 cost time: 7.213407754898071
Epoch: 6, Steps: 9 | Train Loss: 0.244 Vali Loss: 0.350 Vali Acc: 0.862 Test Loss: 0.350 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.1644251346588135
Epoch: 7, Steps: 9 | Train Loss: 0.102 Vali Loss: 0.320 Vali Acc: 0.862 Test Loss: 0.320 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 7.181153774261475
Epoch: 8, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.296 Vali Acc: 0.899 Test Loss: 0.296 Test Acc: 0.899
Validation loss decreased (-0.869562 --> -0.898548).  Saving model ...
Epoch: 9 cost time: 7.149183988571167
Epoch: 9, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.270 Vali Acc: 0.906 Test Loss: 0.270 Test Acc: 0.906
Validation loss decreased (-0.898548 --> -0.905794).  Saving model ...
Epoch: 10 cost time: 7.064753532409668
Epoch: 10, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.256 Vali Acc: 0.920 Test Loss: 0.256 Test Acc: 0.920
Validation loss decreased (-0.905794 --> -0.920287).  Saving model ...
Epoch: 11 cost time: 7.203015327453613
Epoch: 11, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.280 Vali Acc: 0.913 Test Loss: 0.280 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.166970729827881
Epoch: 12, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.300 Vali Acc: 0.913 Test Loss: 0.300 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 7.1010541915893555
Epoch: 13, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.253 Vali Acc: 0.913 Test Loss: 0.253 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.932181358337402
Epoch: 14, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.246 Vali Acc: 0.920 Test Loss: 0.246 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 15 cost time: 6.946964740753174
Epoch: 15, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.301 Vali Acc: 0.913 Test Loss: 0.301 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.822615146636963
Epoch: 16, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.301 Vali Acc: 0.913 Test Loss: 0.301 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 7.061883926391602
Epoch: 17, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.274 Vali Acc: 0.913 Test Loss: 0.274 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 7.12734842300415
Epoch: 18, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.249 Vali Acc: 0.935 Test Loss: 0.249 Test Acc: 0.935
Validation loss decreased (-0.920287 --> -0.934780).  Saving model ...
Epoch: 19 cost time: 7.049405336380005
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.935 Test Loss: 0.226 Test Acc: 0.935
Validation loss decreased (-0.934780 --> -0.934780).  Saving model ...
Epoch: 20 cost time: 7.043911933898926
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.935 Test Loss: 0.231 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 7.0981361865997314
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.246 Vali Acc: 0.935 Test Loss: 0.246 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 6.7474141120910645
Epoch: 22, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.648 Vali Acc: 0.812 Test Loss: 0.648 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 6.927461624145508
Epoch: 23, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.482 Vali Acc: 0.862 Test Loss: 0.482 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 7.05845832824707
Epoch: 24, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.239 Vali Acc: 0.906 Test Loss: 0.239 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 6.706308841705322
Epoch: 25, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.500 Vali Acc: 0.884 Test Loss: 0.500 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 6.785966157913208
Epoch: 26, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.463 Vali Acc: 0.906 Test Loss: 0.463 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 7.036698818206787
Epoch: 27, Steps: 9 | Train Loss: 0.089 Vali Loss: 0.481 Vali Acc: 0.870 Test Loss: 0.481 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 6.913012742996216
Epoch: 28, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.132 Vali Acc: 0.957 Test Loss: 0.132 Test Acc: 0.957
Validation loss decreased (-0.934780 --> -0.956520).  Saving model ...
Epoch: 29 cost time: 6.964964866638184
Epoch: 29, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.239 Vali Acc: 0.920 Test Loss: 0.239 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 7.064549922943115
Epoch: 30, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.550 Vali Acc: 0.877 Test Loss: 0.550 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9565217391304348
model parameter : 8315076
model size : 32.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 12.180841207504272
Epoch: 1, Steps: 9 | Train Loss: 1.435 Vali Loss: 1.290 Vali Acc: 0.406 Test Loss: 1.290 Test Acc: 0.406
Validation loss decreased (inf --> -0.405784).  Saving model ...
Epoch: 2 cost time: 10.106495141983032
Epoch: 2, Steps: 9 | Train Loss: 1.137 Vali Loss: 0.981 Vali Acc: 0.558 Test Loss: 0.981 Test Acc: 0.558
Validation loss decreased (-0.405784 --> -0.557961).  Saving model ...
Epoch: 3 cost time: 10.236314535140991
Epoch: 3, Steps: 9 | Train Loss: 0.777 Vali Loss: 0.711 Vali Acc: 0.732 Test Loss: 0.711 Test Acc: 0.732
Validation loss decreased (-0.557961 --> -0.731877).  Saving model ...
Epoch: 4 cost time: 10.350654363632202
Epoch: 4, Steps: 9 | Train Loss: 0.538 Vali Loss: 0.594 Vali Acc: 0.754 Test Loss: 0.594 Test Acc: 0.754
Validation loss decreased (-0.731877 --> -0.753617).  Saving model ...
Epoch: 5 cost time: 11.32362699508667
Epoch: 5, Steps: 9 | Train Loss: 0.353 Vali Loss: 0.500 Vali Acc: 0.833 Test Loss: 0.500 Test Acc: 0.833
Validation loss decreased (-0.753617 --> -0.833328).  Saving model ...
Epoch: 6 cost time: 11.168645858764648
Epoch: 6, Steps: 9 | Train Loss: 0.191 Vali Loss: 0.442 Vali Acc: 0.841 Test Loss: 0.442 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840575).  Saving model ...
Epoch: 7 cost time: 11.30574107170105
Epoch: 7, Steps: 9 | Train Loss: 0.133 Vali Loss: 0.449 Vali Acc: 0.855 Test Loss: 0.449 Test Acc: 0.855
Validation loss decreased (-0.840575 --> -0.855068).  Saving model ...
Epoch: 8 cost time: 10.782261610031128
Epoch: 8, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.460 Vali Acc: 0.855 Test Loss: 0.460 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 10.920514345169067
Epoch: 9, Steps: 9 | Train Loss: 0.137 Vali Loss: 0.484 Vali Acc: 0.833 Test Loss: 0.484 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 10.976308584213257
Epoch: 10, Steps: 9 | Train Loss: 0.125 Vali Loss: 0.418 Vali Acc: 0.884 Test Loss: 0.418 Test Acc: 0.884
Validation loss decreased (-0.855068 --> -0.884054).  Saving model ...
Epoch: 11 cost time: 11.399324417114258
Epoch: 11, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.338 Vali Acc: 0.891 Test Loss: 0.338 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891301).  Saving model ...
Epoch: 12 cost time: 10.568453073501587
Epoch: 12, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.415 Vali Acc: 0.899 Test Loss: 0.415 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898547).  Saving model ...
Epoch: 13 cost time: 10.347293615341187
Epoch: 13, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.451 Vali Acc: 0.884 Test Loss: 0.451 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 10.917821407318115
Epoch: 14, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.418 Vali Acc: 0.906 Test Loss: 0.418 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905793).  Saving model ...
Epoch: 15 cost time: 10.501253843307495
Epoch: 15, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.439 Vali Acc: 0.891 Test Loss: 0.439 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 9.63979983329773
Epoch: 16, Steps: 9 | Train Loss: 0.344 Vali Loss: 0.849 Vali Acc: 0.848 Test Loss: 0.849 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 10.39471173286438
Epoch: 17, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.709 Vali Acc: 0.841 Test Loss: 0.709 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 10.48363208770752
Epoch: 18, Steps: 9 | Train Loss: 0.134 Vali Loss: 0.497 Vali Acc: 0.870 Test Loss: 0.497 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 10.26911735534668
Epoch: 19, Steps: 9 | Train Loss: 0.102 Vali Loss: 0.391 Vali Acc: 0.877 Test Loss: 0.391 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 10.197078227996826
Epoch: 20, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.624 Vali Acc: 0.848 Test Loss: 0.624 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 9.811336755752563
Epoch: 21, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.608 Vali Acc: 0.848 Test Loss: 0.608 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 9.845613479614258
Epoch: 22, Steps: 9 | Train Loss: 0.681 Vali Loss: 1.311 Vali Acc: 0.812 Test Loss: 1.311 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 10.035447835922241
Epoch: 23, Steps: 9 | Train Loss: 0.241 Vali Loss: 0.657 Vali Acc: 0.848 Test Loss: 0.657 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 10.234985828399658
Epoch: 24, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.367 Vali Acc: 0.884 Test Loss: 0.367 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 28174404
model size : 108.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 6.781096696853638
Epoch: 1, Steps: 9 | Train Loss: 1.383 Vali Loss: 1.308 Vali Acc: 0.377 Test Loss: 1.308 Test Acc: 0.377
Validation loss decreased (inf --> -0.376799).  Saving model ...
Epoch: 2 cost time: 4.587115287780762
Epoch: 2, Steps: 9 | Train Loss: 1.111 Vali Loss: 1.045 Vali Acc: 0.645 Test Loss: 1.045 Test Acc: 0.645
Validation loss decreased (-0.376799 --> -0.644917).  Saving model ...
Epoch: 3 cost time: 4.56761622428894
Epoch: 3, Steps: 9 | Train Loss: 0.798 Vali Loss: 0.757 Vali Acc: 0.732 Test Loss: 0.757 Test Acc: 0.732
Validation loss decreased (-0.644917 --> -0.731876).  Saving model ...
Epoch: 4 cost time: 4.93006443977356
Epoch: 4, Steps: 9 | Train Loss: 0.518 Vali Loss: 0.568 Vali Acc: 0.790 Test Loss: 0.568 Test Acc: 0.790
Validation loss decreased (-0.731876 --> -0.789849).  Saving model ...
Epoch: 5 cost time: 4.740201234817505
Epoch: 5, Steps: 9 | Train Loss: 0.327 Vali Loss: 0.504 Vali Acc: 0.804 Test Loss: 0.504 Test Acc: 0.804
Validation loss decreased (-0.789849 --> -0.804343).  Saving model ...
Epoch: 6 cost time: 4.8936707973480225
Epoch: 6, Steps: 9 | Train Loss: 0.206 Vali Loss: 0.433 Vali Acc: 0.812 Test Loss: 0.433 Test Acc: 0.812
Validation loss decreased (-0.804343 --> -0.811590).  Saving model ...
Epoch: 7 cost time: 4.817286491394043
Epoch: 7, Steps: 9 | Train Loss: 0.109 Vali Loss: 0.397 Vali Acc: 0.826 Test Loss: 0.397 Test Acc: 0.826
Validation loss decreased (-0.811590 --> -0.826083).  Saving model ...
Epoch: 8 cost time: 4.837563753128052
Epoch: 8, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.390 Vali Acc: 0.848 Test Loss: 0.390 Test Acc: 0.848
Validation loss decreased (-0.826083 --> -0.847822).  Saving model ...
Epoch: 9 cost time: 4.6660239696502686
Epoch: 9, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.293 Vali Acc: 0.920 Test Loss: 0.293 Test Acc: 0.920
Validation loss decreased (-0.847822 --> -0.920287).  Saving model ...
Epoch: 10 cost time: 4.674654006958008
Epoch: 10, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.326 Vali Acc: 0.913 Test Loss: 0.326 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.385393142700195
Epoch: 11, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.311 Vali Acc: 0.891 Test Loss: 0.311 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.347898721694946
Epoch: 12, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.839 Vali Acc: 0.797 Test Loss: 0.839 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.4581217765808105
Epoch: 13, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.734 Vali Acc: 0.804 Test Loss: 0.734 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.553803443908691
Epoch: 14, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.635 Vali Acc: 0.797 Test Loss: 0.635 Test Acc: 0.797
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.559496641159058
Epoch: 15, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.735 Vali Acc: 0.804 Test Loss: 0.735 Test Acc: 0.804
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.5922253131866455
Epoch: 16, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.595 Vali Acc: 0.855 Test Loss: 0.595 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.596578598022461
Epoch: 17, Steps: 9 | Train Loss: 0.099 Vali Loss: 0.613 Vali Acc: 0.790 Test Loss: 0.613 Test Acc: 0.790
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.567434787750244
Epoch: 18, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.638 Vali Acc: 0.790 Test Loss: 0.638 Test Acc: 0.790
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.439411878585815
Epoch: 19, Steps: 9 | Train Loss: 0.167 Vali Loss: 0.671 Vali Acc: 0.833 Test Loss: 0.671 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 8315076
model size : 32.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 14.242542505264282
Epoch: 1, Steps: 9 | Train Loss: 1.409 Vali Loss: 1.288 Vali Acc: 0.435 Test Loss: 1.288 Test Acc: 0.435
Validation loss decreased (inf --> -0.434770).  Saving model ...
Epoch: 2 cost time: 12.333959817886353
Epoch: 2, Steps: 9 | Train Loss: 1.080 Vali Loss: 0.830 Vali Acc: 0.688 Test Loss: 0.830 Test Acc: 0.688
Validation loss decreased (-0.434770 --> -0.688397).  Saving model ...
Epoch: 3 cost time: 12.115166425704956
Epoch: 3, Steps: 9 | Train Loss: 0.647 Vali Loss: 0.543 Vali Acc: 0.783 Test Loss: 0.543 Test Acc: 0.783
Validation loss decreased (-0.688397 --> -0.782603).  Saving model ...
Epoch: 4 cost time: 12.520050287246704
Epoch: 4, Steps: 9 | Train Loss: 0.389 Vali Loss: 0.404 Vali Acc: 0.848 Test Loss: 0.404 Test Acc: 0.848
Validation loss decreased (-0.782603 --> -0.847822).  Saving model ...
Epoch: 5 cost time: 12.51924753189087
Epoch: 5, Steps: 9 | Train Loss: 0.248 Vali Loss: 0.440 Vali Acc: 0.841 Test Loss: 0.440 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 12.700602531433105
Epoch: 6, Steps: 9 | Train Loss: 0.131 Vali Loss: 0.380 Vali Acc: 0.891 Test Loss: 0.380 Test Acc: 0.891
Validation loss decreased (-0.847822 --> -0.891301).  Saving model ...
Epoch: 7 cost time: 12.75916600227356
Epoch: 7, Steps: 9 | Train Loss: 0.106 Vali Loss: 0.410 Vali Acc: 0.899 Test Loss: 0.410 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898547).  Saving model ...
Epoch: 8 cost time: 13.088219404220581
Epoch: 8, Steps: 9 | Train Loss: 0.120 Vali Loss: 0.359 Vali Acc: 0.884 Test Loss: 0.359 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 12.692172288894653
Epoch: 9, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.384 Vali Acc: 0.870 Test Loss: 0.384 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 12.63499903678894
Epoch: 10, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.572 Vali Acc: 0.812 Test Loss: 0.572 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 10.658174991607666
Epoch: 11, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.512 Vali Acc: 0.833 Test Loss: 0.512 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 12.788051128387451
Epoch: 12, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.429 Vali Acc: 0.877 Test Loss: 0.429 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 13.053816795349121
Epoch: 13, Steps: 9 | Train Loss: 0.238 Vali Loss: 0.338 Vali Acc: 0.913 Test Loss: 0.338 Test Acc: 0.913
Validation loss decreased (-0.898547 --> -0.913040).  Saving model ...
Epoch: 14 cost time: 12.473471641540527
Epoch: 14, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.605 Vali Acc: 0.790 Test Loss: 0.605 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 12.585099220275879
Epoch: 15, Steps: 9 | Train Loss: 0.087 Vali Loss: 0.394 Vali Acc: 0.870 Test Loss: 0.394 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 12.720342636108398
Epoch: 16, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.472 Vali Acc: 0.855 Test Loss: 0.472 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 13.226507186889648
Epoch: 17, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.699 Vali Acc: 0.833 Test Loss: 0.699 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 12.308602333068848
Epoch: 18, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.363 Vali Acc: 0.891 Test Loss: 0.363 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 12.85964059829712
Epoch: 19, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.350 Vali Acc: 0.906 Test Loss: 0.350 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 13.16969347000122
Epoch: 20, Steps: 9 | Train Loss: 0.117 Vali Loss: 0.433 Vali Acc: 0.884 Test Loss: 0.433 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 15.733644247055054
Epoch: 21, Steps: 9 | Train Loss: 0.044 Vali Loss: 1.016 Vali Acc: 0.797 Test Loss: 1.016 Test Acc: 0.797
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 15.170627117156982
Epoch: 22, Steps: 9 | Train Loss: 0.205 Vali Loss: 0.771 Vali Acc: 0.819 Test Loss: 0.771 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 15.914537191390991
Epoch: 23, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.306 Vali Acc: 0.899 Test Loss: 0.306 Test Acc: 0.899
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 14114628
model size : 55.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 8.787792205810547
Epoch: 1, Steps: 9 | Train Loss: 1.365 Vali Loss: 1.197 Vali Acc: 0.558 Test Loss: 1.197 Test Acc: 0.558
Validation loss decreased (inf --> -0.557959).  Saving model ...
Epoch: 2 cost time: 7.0992653369903564
Epoch: 2, Steps: 9 | Train Loss: 1.034 Vali Loss: 0.840 Vali Acc: 0.710 Test Loss: 0.840 Test Acc: 0.710
Validation loss decreased (-0.557959 --> -0.710137).  Saving model ...
Epoch: 3 cost time: 6.818734169006348
Epoch: 3, Steps: 9 | Train Loss: 0.627 Vali Loss: 0.571 Vali Acc: 0.783 Test Loss: 0.571 Test Acc: 0.783
Validation loss decreased (-0.710137 --> -0.782603).  Saving model ...
Epoch: 4 cost time: 6.436018466949463
Epoch: 4, Steps: 9 | Train Loss: 0.415 Vali Loss: 0.486 Vali Acc: 0.797 Test Loss: 0.486 Test Acc: 0.797
Validation loss decreased (-0.782603 --> -0.797097).  Saving model ...
Epoch: 5 cost time: 7.091826438903809
Epoch: 5, Steps: 9 | Train Loss: 0.325 Vali Loss: 0.407 Vali Acc: 0.862 Test Loss: 0.407 Test Acc: 0.862
Validation loss decreased (-0.797097 --> -0.862315).  Saving model ...
Epoch: 6 cost time: 6.9332969188690186
Epoch: 6, Steps: 9 | Train Loss: 0.206 Vali Loss: 0.380 Vali Acc: 0.870 Test Loss: 0.380 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869561).  Saving model ...
Epoch: 7 cost time: 7.050614833831787
Epoch: 7, Steps: 9 | Train Loss: 0.115 Vali Loss: 0.483 Vali Acc: 0.841 Test Loss: 0.483 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.014657497406006
Epoch: 8, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.338 Vali Acc: 0.877 Test Loss: 0.338 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876808).  Saving model ...
Epoch: 9 cost time: 6.904439449310303
Epoch: 9, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.419 Vali Acc: 0.877 Test Loss: 0.419 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.967096567153931
Epoch: 10, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.379 Vali Acc: 0.862 Test Loss: 0.379 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.672274351119995
Epoch: 11, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.350 Vali Acc: 0.877 Test Loss: 0.350 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 7.006754398345947
Epoch: 12, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.369 Vali Acc: 0.884 Test Loss: 0.369 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884054).  Saving model ...
Epoch: 13 cost time: 7.051066875457764
Epoch: 13, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.422 Vali Acc: 0.870 Test Loss: 0.422 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 7.159352779388428
Epoch: 14, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.463 Vali Acc: 0.855 Test Loss: 0.463 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.883515357971191
Epoch: 15, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.371 Vali Acc: 0.899 Test Loss: 0.371 Test Acc: 0.899
Validation loss decreased (-0.884054 --> -0.898547).  Saving model ...
Epoch: 16 cost time: 6.928119897842407
Epoch: 16, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.363 Vali Acc: 0.891 Test Loss: 0.363 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.854401111602783
Epoch: 17, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.558 Vali Acc: 0.826 Test Loss: 0.558 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.865078687667847
Epoch: 18, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.527 Vali Acc: 0.848 Test Loss: 0.527 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 6.413493394851685
Epoch: 19, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.541 Vali Acc: 0.870 Test Loss: 0.541 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 7.033955812454224
Epoch: 20, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.568 Vali Acc: 0.848 Test Loss: 0.568 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 6.944112062454224
Epoch: 21, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.485 Vali Acc: 0.870 Test Loss: 0.485 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 7.221477270126343
Epoch: 22, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.408 Vali Acc: 0.899 Test Loss: 0.408 Test Acc: 0.899
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 6.911179542541504
Epoch: 23, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.397 Vali Acc: 0.906 Test Loss: 0.397 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905793).  Saving model ...
Epoch: 24 cost time: 6.952314853668213
Epoch: 24, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.404 Vali Acc: 0.891 Test Loss: 0.404 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 7.201298236846924
Epoch: 25, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.404 Vali Acc: 0.891 Test Loss: 0.404 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 6.914846897125244
Epoch: 26, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.456 Vali Acc: 0.906 Test Loss: 0.456 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 6.046938419342041
Epoch: 27, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.379 Vali Acc: 0.928 Test Loss: 0.379 Test Acc: 0.928
Validation loss decreased (-0.905793 --> -0.927532).  Saving model ...
Epoch: 28 cost time: 5.94853138923645
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.403 Vali Acc: 0.899 Test Loss: 0.403 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 6.1256468296051025
Epoch: 29, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.338 Vali Acc: 0.913 Test Loss: 0.338 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 5.931927442550659
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.382 Vali Acc: 0.884 Test Loss: 0.382 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.927536231884058
model parameter : 4184772
model size : 17.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 13.42344856262207
Epoch: 1, Steps: 9 | Train Loss: 1.408 Vali Loss: 1.308 Vali Acc: 0.399 Test Loss: 1.308 Test Acc: 0.399
Validation loss decreased (inf --> -0.398538).  Saving model ...
Epoch: 2 cost time: 11.364369630813599
Epoch: 2, Steps: 9 | Train Loss: 1.118 Vali Loss: 0.871 Vali Acc: 0.645 Test Loss: 0.871 Test Acc: 0.645
Validation loss decreased (-0.398538 --> -0.644919).  Saving model ...
Epoch: 3 cost time: 11.478788375854492
Epoch: 3, Steps: 9 | Train Loss: 0.720 Vali Loss: 0.590 Vali Acc: 0.797 Test Loss: 0.590 Test Acc: 0.797
Validation loss decreased (-0.644919 --> -0.797096).  Saving model ...
Epoch: 4 cost time: 11.347203493118286
Epoch: 4, Steps: 9 | Train Loss: 0.484 Vali Loss: 0.420 Vali Acc: 0.848 Test Loss: 0.420 Test Acc: 0.848
Validation loss decreased (-0.797096 --> -0.847822).  Saving model ...
Epoch: 5 cost time: 11.625132322311401
Epoch: 5, Steps: 9 | Train Loss: 0.318 Vali Loss: 0.422 Vali Acc: 0.819 Test Loss: 0.422 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 11.440921306610107
Epoch: 6, Steps: 9 | Train Loss: 0.164 Vali Loss: 0.337 Vali Acc: 0.870 Test Loss: 0.337 Test Acc: 0.870
Validation loss decreased (-0.847822 --> -0.869562).  Saving model ...
Epoch: 7 cost time: 11.463709831237793
Epoch: 7, Steps: 9 | Train Loss: 0.134 Vali Loss: 0.362 Vali Acc: 0.870 Test Loss: 0.362 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 11.439218997955322
Epoch: 8, Steps: 9 | Train Loss: 0.379 Vali Loss: 0.352 Vali Acc: 0.870 Test Loss: 0.352 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 9.711697578430176
Epoch: 9, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.363 Vali Acc: 0.884 Test Loss: 0.363 Test Acc: 0.884
Validation loss decreased (-0.869562 --> -0.884054).  Saving model ...
Epoch: 10 cost time: 9.343114614486694
Epoch: 10, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.391 Vali Acc: 0.870 Test Loss: 0.391 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 9.040524005889893
Epoch: 11, Steps: 9 | Train Loss: 0.215 Vali Loss: 0.416 Vali Acc: 0.855 Test Loss: 0.416 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 10.87533187866211
Epoch: 12, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.393 Vali Acc: 0.870 Test Loss: 0.393 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 10.84197449684143
Epoch: 13, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.380 Vali Acc: 0.855 Test Loss: 0.380 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 10.600965023040771
Epoch: 14, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.334 Vali Acc: 0.891 Test Loss: 0.334 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891301).  Saving model ...
Epoch: 15 cost time: 10.632574796676636
Epoch: 15, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.448 Vali Acc: 0.862 Test Loss: 0.448 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 10.277252674102783
Epoch: 16, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.369 Vali Acc: 0.891 Test Loss: 0.369 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 10.829772710800171
Epoch: 17, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.258 Vali Acc: 0.906 Test Loss: 0.258 Test Acc: 0.906
Validation loss decreased (-0.891301 --> -0.905795).  Saving model ...
Epoch: 18 cost time: 10.702780961990356
Epoch: 18, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.344 Vali Acc: 0.884 Test Loss: 0.344 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 10.92671251296997
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.442 Vali Acc: 0.877 Test Loss: 0.442 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 11.067774057388306
Epoch: 20, Steps: 9 | Train Loss: 0.201 Vali Loss: 0.446 Vali Acc: 0.891 Test Loss: 0.446 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 10.801674365997314
Epoch: 21, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.474 Vali Acc: 0.862 Test Loss: 0.474 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 10.811991214752197
Epoch: 22, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.625 Vali Acc: 0.841 Test Loss: 0.625 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 10.802222490310669
Epoch: 23, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.694 Vali Acc: 0.826 Test Loss: 0.694 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 10.912979364395142
Epoch: 24, Steps: 9 | Train Loss: 0.144 Vali Loss: 0.398 Vali Acc: 0.855 Test Loss: 0.398 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 10.585017442703247
Epoch: 25, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.726 Vali Acc: 0.862 Test Loss: 0.726 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 10.637875080108643
Epoch: 26, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.698 Vali Acc: 0.855 Test Loss: 0.698 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 10.806087732315063
Epoch: 27, Steps: 9 | Train Loss: 0.266 Vali Loss: 0.588 Vali Acc: 0.877 Test Loss: 0.588 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 14114628
model size : 55.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 6.89656138420105
Epoch: 1, Steps: 9 | Train Loss: 1.362 Vali Loss: 1.217 Vali Acc: 0.565 Test Loss: 1.217 Test Acc: 0.565
Validation loss decreased (inf --> -0.565205).  Saving model ...
Epoch: 2 cost time: 4.781082630157471
Epoch: 2, Steps: 9 | Train Loss: 1.079 Vali Loss: 0.891 Vali Acc: 0.681 Test Loss: 0.891 Test Acc: 0.681
Validation loss decreased (-0.565205 --> -0.681151).  Saving model ...
Epoch: 3 cost time: 5.119306325912476
Epoch: 3, Steps: 9 | Train Loss: 0.707 Vali Loss: 0.647 Vali Acc: 0.783 Test Loss: 0.647 Test Acc: 0.783
Validation loss decreased (-0.681151 --> -0.782602).  Saving model ...
Epoch: 4 cost time: 5.1806042194366455
Epoch: 4, Steps: 9 | Train Loss: 0.496 Vali Loss: 0.482 Vali Acc: 0.826 Test Loss: 0.482 Test Acc: 0.826
Validation loss decreased (-0.782602 --> -0.826082).  Saving model ...
Epoch: 5 cost time: 4.852080345153809
Epoch: 5, Steps: 9 | Train Loss: 0.308 Vali Loss: 0.376 Vali Acc: 0.870 Test Loss: 0.376 Test Acc: 0.870
Validation loss decreased (-0.826082 --> -0.869561).  Saving model ...
Epoch: 6 cost time: 4.195124626159668
Epoch: 6, Steps: 9 | Train Loss: 0.179 Vali Loss: 0.364 Vali Acc: 0.884 Test Loss: 0.364 Test Acc: 0.884
Validation loss decreased (-0.869561 --> -0.884054).  Saving model ...
Epoch: 7 cost time: 4.163954257965088
Epoch: 7, Steps: 9 | Train Loss: 0.118 Vali Loss: 0.432 Vali Acc: 0.833 Test Loss: 0.432 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.946789979934692
Epoch: 8, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.338 Vali Acc: 0.877 Test Loss: 0.338 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.740240812301636
Epoch: 9, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.411 Vali Acc: 0.870 Test Loss: 0.411 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.870074987411499
Epoch: 10, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.366 Vali Acc: 0.884 Test Loss: 0.366 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.914625883102417
Epoch: 11, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.359 Vali Acc: 0.891 Test Loss: 0.359 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891301).  Saving model ...
Epoch: 12 cost time: 4.890679597854614
Epoch: 12, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.347 Vali Acc: 0.891 Test Loss: 0.347 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 13 cost time: 4.543247938156128
Epoch: 13, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.377 Vali Acc: 0.884 Test Loss: 0.377 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.189633131027222
Epoch: 14, Steps: 9 | Train Loss: 0.468 Vali Loss: 0.354 Vali Acc: 0.899 Test Loss: 0.354 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898547).  Saving model ...
Epoch: 15 cost time: 5.233530044555664
Epoch: 15, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.373 Vali Acc: 0.906 Test Loss: 0.373 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905793).  Saving model ...
Epoch: 16 cost time: 4.760974884033203
Epoch: 16, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.370 Vali Acc: 0.891 Test Loss: 0.370 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.280838489532471
Epoch: 17, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.449 Vali Acc: 0.870 Test Loss: 0.449 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.33837103843689
Epoch: 18, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.388 Vali Acc: 0.884 Test Loss: 0.388 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.347294569015503
Epoch: 19, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.446 Vali Acc: 0.899 Test Loss: 0.446 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.226723670959473
Epoch: 20, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.431 Vali Acc: 0.891 Test Loss: 0.431 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 5.159950017929077
Epoch: 21, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.377 Vali Acc: 0.899 Test Loss: 0.377 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 5.1972362995147705
Epoch: 22, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.374 Vali Acc: 0.899 Test Loss: 0.374 Test Acc: 0.899
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.842554569244385
Epoch: 23, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.380 Vali Acc: 0.891 Test Loss: 0.380 Test Acc: 0.891
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.001643419265747
Epoch: 24, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.356 Vali Acc: 0.920 Test Loss: 0.356 Test Acc: 0.920
Validation loss decreased (-0.905793 --> -0.920286).  Saving model ...
Epoch: 25 cost time: 4.435231447219849
Epoch: 25, Steps: 9 | Train Loss: 0.067 Vali Loss: 1.654 Vali Acc: 0.696 Test Loss: 1.654 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.872568130493164
Epoch: 26, Steps: 9 | Train Loss: 0.101 Vali Loss: 1.020 Vali Acc: 0.732 Test Loss: 1.020 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 5.460489511489868
Epoch: 27, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.448 Vali Acc: 0.862 Test Loss: 0.448 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 5.232197046279907
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 3.880 Vali Acc: 0.761 Test Loss: 3.880 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 4.940129518508911
Epoch: 29, Steps: 9 | Train Loss: 0.497 Vali Loss: 0.840 Vali Acc: 0.710 Test Loss: 0.840 Test Acc: 0.710
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 5.175256013870239
Epoch: 30, Steps: 9 | Train Loss: 0.156 Vali Loss: 0.236 Vali Acc: 0.920 Test Loss: 0.236 Test Acc: 0.920
Validation loss decreased (-0.920286 --> -0.920287).  Saving model ...
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 4184772
model size : 17.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 8.810166358947754
Epoch: 1, Steps: 9 | Train Loss: 1.411 Vali Loss: 1.334 Vali Acc: 0.348 Test Loss: 1.334 Test Acc: 0.348
Validation loss decreased (inf --> -0.347813).  Saving model ...
Epoch: 2 cost time: 7.345757007598877
Epoch: 2, Steps: 9 | Train Loss: 1.146 Vali Loss: 1.039 Vali Acc: 0.565 Test Loss: 1.039 Test Acc: 0.565
Validation loss decreased (-0.347813 --> -0.565207).  Saving model ...
Epoch: 3 cost time: 7.31714653968811
Epoch: 3, Steps: 9 | Train Loss: 0.787 Vali Loss: 0.835 Vali Acc: 0.623 Test Loss: 0.835 Test Acc: 0.623
Validation loss decreased (-0.565207 --> -0.623180).  Saving model ...
Epoch: 4 cost time: 7.16060209274292
Epoch: 4, Steps: 9 | Train Loss: 0.544 Vali Loss: 0.673 Vali Acc: 0.717 Test Loss: 0.673 Test Acc: 0.717
Validation loss decreased (-0.623180 --> -0.717385).  Saving model ...
Epoch: 5 cost time: 7.232477188110352
Epoch: 5, Steps: 9 | Train Loss: 0.334 Vali Loss: 0.523 Vali Acc: 0.812 Test Loss: 0.523 Test Acc: 0.812
Validation loss decreased (-0.717385 --> -0.811589).  Saving model ...
Epoch: 6 cost time: 6.784010171890259
Epoch: 6, Steps: 9 | Train Loss: 0.222 Vali Loss: 0.417 Vali Acc: 0.877 Test Loss: 0.417 Test Acc: 0.877
Validation loss decreased (-0.811589 --> -0.876807).  Saving model ...
Epoch: 7 cost time: 7.482802867889404
Epoch: 7, Steps: 9 | Train Loss: 0.104 Vali Loss: 0.427 Vali Acc: 0.848 Test Loss: 0.427 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.180553436279297
Epoch: 8, Steps: 9 | Train Loss: 0.164 Vali Loss: 0.343 Vali Acc: 0.877 Test Loss: 0.343 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876808).  Saving model ...
Epoch: 9 cost time: 7.233988285064697
Epoch: 9, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.771 Vali Acc: 0.681 Test Loss: 0.771 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.0013439655303955
Epoch: 10, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.956 Vali Acc: 0.659 Test Loss: 0.956 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 7.1276819705963135
Epoch: 11, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.867 Vali Acc: 0.681 Test Loss: 0.867 Test Acc: 0.681
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 7.1485748291015625
Epoch: 12, Steps: 9 | Train Loss: 0.014 Vali Loss: 1.102 Vali Acc: 0.703 Test Loss: 1.102 Test Acc: 0.703
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 7.130741596221924
Epoch: 13, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.845 Vali Acc: 0.696 Test Loss: 0.845 Test Acc: 0.696
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 7.461356163024902
Epoch: 14, Steps: 9 | Train Loss: 0.010 Vali Loss: 1.074 Vali Acc: 0.659 Test Loss: 1.074 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 7.049511194229126
Epoch: 15, Steps: 9 | Train Loss: 0.155 Vali Loss: 0.450 Vali Acc: 0.841 Test Loss: 0.450 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 6.9920618534088135
Epoch: 16, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.792 Vali Acc: 0.797 Test Loss: 0.792 Test Acc: 0.797
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 7.061433553695679
Epoch: 17, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.822 Vali Acc: 0.790 Test Loss: 0.822 Test Acc: 0.790
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 6.21192741394043
Epoch: 18, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.820 Vali Acc: 0.790 Test Loss: 0.820 Test Acc: 0.790
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 14114628
model size : 55.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.591698169708252
Epoch: 1, Steps: 9 | Train Loss: 1.364 Vali Loss: 1.250 Vali Acc: 0.500 Test Loss: 1.250 Test Acc: 0.500
Validation loss decreased (inf --> -0.499987).  Saving model ...
Epoch: 2 cost time: 3.7285566329956055
Epoch: 2, Steps: 9 | Train Loss: 1.100 Vali Loss: 1.009 Vali Acc: 0.630 Test Loss: 1.009 Test Acc: 0.630
Validation loss decreased (-0.499987 --> -0.630425).  Saving model ...
Epoch: 3 cost time: 3.6692874431610107
Epoch: 3, Steps: 9 | Train Loss: 0.756 Vali Loss: 0.800 Vali Acc: 0.674 Test Loss: 0.800 Test Acc: 0.674
Validation loss decreased (-0.630425 --> -0.673905).  Saving model ...
Epoch: 4 cost time: 3.717991590499878
Epoch: 4, Steps: 9 | Train Loss: 0.563 Vali Loss: 0.643 Vali Acc: 0.768 Test Loss: 0.643 Test Acc: 0.768
Validation loss decreased (-0.673905 --> -0.768110).  Saving model ...
Epoch: 5 cost time: 3.768186569213867
Epoch: 5, Steps: 9 | Train Loss: 0.377 Vali Loss: 0.502 Vali Acc: 0.833 Test Loss: 0.502 Test Acc: 0.833
Validation loss decreased (-0.768110 --> -0.833328).  Saving model ...
Epoch: 6 cost time: 3.1355156898498535
Epoch: 6, Steps: 9 | Train Loss: 0.215 Vali Loss: 0.438 Vali Acc: 0.848 Test Loss: 0.438 Test Acc: 0.848
Validation loss decreased (-0.833328 --> -0.847822).  Saving model ...
Epoch: 7 cost time: 3.007432460784912
Epoch: 7, Steps: 9 | Train Loss: 0.114 Vali Loss: 0.438 Vali Acc: 0.848 Test Loss: 0.438 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 8 cost time: 3.637578010559082
Epoch: 8, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.466 Vali Acc: 0.833 Test Loss: 0.466 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.542893171310425
Epoch: 9, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.440 Vali Acc: 0.833 Test Loss: 0.440 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.427532196044922
Epoch: 10, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.387 Vali Acc: 0.877 Test Loss: 0.387 Test Acc: 0.877
Validation loss decreased (-0.847822 --> -0.876808).  Saving model ...
Epoch: 11 cost time: 3.352489948272705
Epoch: 11, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.373 Vali Acc: 0.884 Test Loss: 0.373 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884054).  Saving model ...
Epoch: 12 cost time: 3.1850757598876953
Epoch: 12, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.390 Vali Acc: 0.884 Test Loss: 0.390 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.0864005088806152
Epoch: 13, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.462 Vali Acc: 0.884 Test Loss: 0.462 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.1591672897338867
Epoch: 14, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.416 Vali Acc: 0.891 Test Loss: 0.416 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891300).  Saving model ...
Epoch: 15 cost time: 3.79984450340271
Epoch: 15, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.441 Vali Acc: 0.862 Test Loss: 0.441 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.4875853061676025
Epoch: 16, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.457 Vali Acc: 0.848 Test Loss: 0.457 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.59856915473938
Epoch: 17, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.616 Vali Acc: 0.841 Test Loss: 0.616 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.798839807510376
Epoch: 18, Steps: 9 | Train Loss: 0.182 Vali Loss: 0.407 Vali Acc: 0.906 Test Loss: 0.407 Test Acc: 0.906
Validation loss decreased (-0.891300 --> -0.905793).  Saving model ...
Epoch: 19 cost time: 3.6109883785247803
Epoch: 19, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.624 Vali Acc: 0.833 Test Loss: 0.624 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.703666925430298
Epoch: 20, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.453 Vali Acc: 0.862 Test Loss: 0.453 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.6026527881622314
Epoch: 21, Steps: 9 | Train Loss: 0.136 Vali Loss: 0.499 Vali Acc: 0.870 Test Loss: 0.499 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.676792621612549
Epoch: 22, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.504 Vali Acc: 0.884 Test Loss: 0.504 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.8406074047088623
Epoch: 23, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.489 Vali Acc: 0.870 Test Loss: 0.489 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.5883595943450928
Epoch: 24, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.475 Vali Acc: 0.862 Test Loss: 0.475 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.687967538833618
Epoch: 25, Steps: 9 | Train Loss: 0.121 Vali Loss: 1.375 Vali Acc: 0.739 Test Loss: 1.375 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.7001373767852783
Epoch: 26, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.827 Vali Acc: 0.732 Test Loss: 1.827 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.5894663333892822
Epoch: 27, Steps: 9 | Train Loss: 0.047 Vali Loss: 1.429 Vali Acc: 0.739 Test Loss: 1.429 Test Acc: 0.739
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 3.8272159099578857
Epoch: 28, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.496 Vali Acc: 0.754 Test Loss: 1.496 Test Acc: 0.754
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 4184772
model size : 17.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 11.2807137966156
Epoch: 1, Steps: 9 | Train Loss: 1.396 Vali Loss: 1.196 Vali Acc: 0.522 Test Loss: 1.196 Test Acc: 0.522
Validation loss decreased (inf --> -0.521727).  Saving model ...
Epoch: 2 cost time: 9.311250448226929
Epoch: 2, Steps: 9 | Train Loss: 1.046 Vali Loss: 0.868 Vali Acc: 0.667 Test Loss: 0.868 Test Acc: 0.667
Validation loss decreased (-0.521727 --> -0.666658).  Saving model ...
Epoch: 3 cost time: 9.573175430297852
Epoch: 3, Steps: 9 | Train Loss: 0.699 Vali Loss: 0.599 Vali Acc: 0.797 Test Loss: 0.599 Test Acc: 0.797
Validation loss decreased (-0.666658 --> -0.797095).  Saving model ...
Epoch: 4 cost time: 9.459675550460815
Epoch: 4, Steps: 9 | Train Loss: 0.454 Vali Loss: 0.479 Vali Acc: 0.833 Test Loss: 0.479 Test Acc: 0.833
Validation loss decreased (-0.797095 --> -0.833329).  Saving model ...
Epoch: 5 cost time: 9.723135948181152
Epoch: 5, Steps: 9 | Train Loss: 0.357 Vali Loss: 0.437 Vali Acc: 0.870 Test Loss: 0.437 Test Acc: 0.870
Validation loss decreased (-0.833329 --> -0.869561).  Saving model ...
Epoch: 6 cost time: 9.588588953018188
Epoch: 6, Steps: 9 | Train Loss: 0.209 Vali Loss: 0.407 Vali Acc: 0.870 Test Loss: 0.407 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 7 cost time: 9.45483136177063
Epoch: 7, Steps: 9 | Train Loss: 0.128 Vali Loss: 0.390 Vali Acc: 0.862 Test Loss: 0.390 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.87345838546753
Epoch: 8, Steps: 9 | Train Loss: 0.086 Vali Loss: 0.344 Vali Acc: 0.899 Test Loss: 0.344 Test Acc: 0.899
Validation loss decreased (-0.869561 --> -0.898547).  Saving model ...
Epoch: 9 cost time: 9.805978059768677
Epoch: 9, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.403 Vali Acc: 0.855 Test Loss: 0.403 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 9.7406165599823
Epoch: 10, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.514 Vali Acc: 0.826 Test Loss: 0.514 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 8.907039165496826
Epoch: 11, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.423 Vali Acc: 0.884 Test Loss: 0.423 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 10.116375207901001
Epoch: 12, Steps: 9 | Train Loss: 0.247 Vali Loss: 0.476 Vali Acc: 0.855 Test Loss: 0.476 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 10.095455646514893
Epoch: 13, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.375 Vali Acc: 0.891 Test Loss: 0.375 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 10.027137517929077
Epoch: 14, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.430 Vali Acc: 0.884 Test Loss: 0.430 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 9.538792371749878
Epoch: 15, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.489 Vali Acc: 0.848 Test Loss: 0.489 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 8.506481885910034
Epoch: 16, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.412 Vali Acc: 0.891 Test Loss: 0.412 Test Acc: 0.891
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 9.545902729034424
Epoch: 17, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.437 Vali Acc: 0.906 Test Loss: 0.437 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905793).  Saving model ...
Epoch: 18 cost time: 9.370221138000488
Epoch: 18, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.524 Vali Acc: 0.870 Test Loss: 0.524 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 9.783807277679443
Epoch: 19, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.583 Vali Acc: 0.841 Test Loss: 0.583 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 9.445121049880981
Epoch: 20, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.541 Vali Acc: 0.855 Test Loss: 0.541 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 8.905880689620972
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.436 Vali Acc: 0.891 Test Loss: 0.436 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 9.349610090255737
Epoch: 22, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.720 Vali Acc: 0.812 Test Loss: 0.720 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 9.668347120285034
Epoch: 23, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.765 Vali Acc: 0.797 Test Loss: 0.765 Test Acc: 0.797
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 8.315008163452148
Epoch: 24, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.667 Vali Acc: 0.819 Test Loss: 0.667 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 9.69843578338623
Epoch: 25, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.543 Vali Acc: 0.870 Test Loss: 0.543 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 9.658585548400879
Epoch: 26, Steps: 9 | Train Loss: 0.095 Vali Loss: 0.600 Vali Acc: 0.855 Test Loss: 0.600 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 9.901022911071777
Epoch: 27, Steps: 9 | Train Loss: 0.011 Vali Loss: 1.098 Vali Acc: 0.790 Test Loss: 1.098 Test Acc: 0.790
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 7084740
model size : 28.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 6.2757391929626465
Epoch: 1, Steps: 9 | Train Loss: 1.384 Vali Loss: 1.233 Vali Acc: 0.500 Test Loss: 1.233 Test Acc: 0.500
Validation loss decreased (inf --> -0.499988).  Saving model ...
Epoch: 2 cost time: 4.649066686630249
Epoch: 2, Steps: 9 | Train Loss: 1.120 Vali Loss: 0.944 Vali Acc: 0.652 Test Loss: 0.944 Test Acc: 0.652
Validation loss decreased (-0.499988 --> -0.652164).  Saving model ...
Epoch: 3 cost time: 4.640655994415283
Epoch: 3, Steps: 9 | Train Loss: 0.806 Vali Loss: 0.687 Vali Acc: 0.761 Test Loss: 0.687 Test Acc: 0.761
Validation loss decreased (-0.652164 --> -0.760863).  Saving model ...
Epoch: 4 cost time: 4.230794429779053
Epoch: 4, Steps: 9 | Train Loss: 0.487 Vali Loss: 0.500 Vali Acc: 0.855 Test Loss: 0.500 Test Acc: 0.855
Validation loss decreased (-0.760863 --> -0.855067).  Saving model ...
Epoch: 5 cost time: 4.702118873596191
Epoch: 5, Steps: 9 | Train Loss: 0.289 Vali Loss: 0.428 Vali Acc: 0.855 Test Loss: 0.428 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855068).  Saving model ...
Epoch: 6 cost time: 4.955806493759155
Epoch: 6, Steps: 9 | Train Loss: 0.331 Vali Loss: 0.337 Vali Acc: 0.855 Test Loss: 0.337 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855069).  Saving model ...
Epoch: 7 cost time: 4.503399133682251
Epoch: 7, Steps: 9 | Train Loss: 0.116 Vali Loss: 0.367 Vali Acc: 0.870 Test Loss: 0.367 Test Acc: 0.870
Validation loss decreased (-0.855069 --> -0.869562).  Saving model ...
Epoch: 8 cost time: 4.733164310455322
Epoch: 8, Steps: 9 | Train Loss: 0.086 Vali Loss: 0.418 Vali Acc: 0.833 Test Loss: 0.418 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.717933177947998
Epoch: 9, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.337 Vali Acc: 0.855 Test Loss: 0.337 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.851616859436035
Epoch: 10, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.364 Vali Acc: 0.855 Test Loss: 0.364 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.835638761520386
Epoch: 11, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.357 Vali Acc: 0.877 Test Loss: 0.357 Test Acc: 0.877
Validation loss decreased (-0.869562 --> -0.876808).  Saving model ...
Epoch: 12 cost time: 4.813336133956909
Epoch: 12, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.382 Vali Acc: 0.855 Test Loss: 0.382 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.027294874191284
Epoch: 13, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.417 Vali Acc: 0.862 Test Loss: 0.417 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.8942883014678955
Epoch: 14, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.360 Vali Acc: 0.884 Test Loss: 0.360 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884054).  Saving model ...
Epoch: 15 cost time: 4.802963018417358
Epoch: 15, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.372 Vali Acc: 0.877 Test Loss: 0.372 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.957515001296997
Epoch: 16, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.374 Vali Acc: 0.899 Test Loss: 0.374 Test Acc: 0.899
Validation loss decreased (-0.884054 --> -0.898547).  Saving model ...
Epoch: 17 cost time: 4.824512958526611
Epoch: 17, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.363 Vali Acc: 0.884 Test Loss: 0.363 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.91216516494751
Epoch: 18, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.346 Vali Acc: 0.877 Test Loss: 0.346 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.012909412384033
Epoch: 19, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.344 Vali Acc: 0.877 Test Loss: 0.344 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.8779616355896
Epoch: 20, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.370 Vali Acc: 0.891 Test Loss: 0.370 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 4.845334768295288
Epoch: 21, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.385 Vali Acc: 0.891 Test Loss: 0.385 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 4.880664110183716
Epoch: 22, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.384 Vali Acc: 0.877 Test Loss: 0.384 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 4.956511974334717
Epoch: 23, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.360 Vali Acc: 0.884 Test Loss: 0.360 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 5.171312570571899
Epoch: 24, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.369 Vali Acc: 0.877 Test Loss: 0.369 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 4.681008577346802
Epoch: 25, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.384 Vali Acc: 0.870 Test Loss: 0.384 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 4.190218448638916
Epoch: 26, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.375 Vali Acc: 0.870 Test Loss: 0.375 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 2119620
model size : 9.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 8.974873781204224
Epoch: 1, Steps: 9 | Train Loss: 1.392 Vali Loss: 1.206 Vali Acc: 0.522 Test Loss: 1.206 Test Acc: 0.522
Validation loss decreased (inf --> -0.521727).  Saving model ...
Epoch: 2 cost time: 7.36456298828125
Epoch: 2, Steps: 9 | Train Loss: 1.083 Vali Loss: 0.919 Vali Acc: 0.609 Test Loss: 0.919 Test Acc: 0.609
Validation loss decreased (-0.521727 --> -0.608686).  Saving model ...
Epoch: 3 cost time: 7.191721200942993
Epoch: 3, Steps: 9 | Train Loss: 0.755 Vali Loss: 0.686 Vali Acc: 0.768 Test Loss: 0.686 Test Acc: 0.768
Validation loss decreased (-0.608686 --> -0.768109).  Saving model ...
Epoch: 4 cost time: 7.215426206588745
Epoch: 4, Steps: 9 | Train Loss: 0.489 Vali Loss: 0.514 Vali Acc: 0.833 Test Loss: 0.514 Test Acc: 0.833
Validation loss decreased (-0.768109 --> -0.833328).  Saving model ...
Epoch: 5 cost time: 7.2128095626831055
Epoch: 5, Steps: 9 | Train Loss: 0.347 Vali Loss: 0.464 Vali Acc: 0.870 Test Loss: 0.464 Test Acc: 0.870
Validation loss decreased (-0.833328 --> -0.869561).  Saving model ...
Epoch: 6 cost time: 7.006494760513306
Epoch: 6, Steps: 9 | Train Loss: 0.440 Vali Loss: 0.400 Vali Acc: 0.891 Test Loss: 0.400 Test Acc: 0.891
Validation loss decreased (-0.869561 --> -0.891300).  Saving model ...
Epoch: 7 cost time: 6.478216171264648
Epoch: 7, Steps: 9 | Train Loss: 0.132 Vali Loss: 0.437 Vali Acc: 0.848 Test Loss: 0.437 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.636469841003418
Epoch: 8, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.363 Vali Acc: 0.877 Test Loss: 0.363 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.3734235763549805
Epoch: 9, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.458 Vali Acc: 0.848 Test Loss: 0.458 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 7.189626932144165
Epoch: 10, Steps: 9 | Train Loss: 0.177 Vali Loss: 0.498 Vali Acc: 0.833 Test Loss: 0.498 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 7.357952356338501
Epoch: 11, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.490 Vali Acc: 0.841 Test Loss: 0.490 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 6.989509105682373
Epoch: 12, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.457 Vali Acc: 0.862 Test Loss: 0.457 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 7.2793848514556885
Epoch: 13, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.433 Vali Acc: 0.877 Test Loss: 0.433 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 7.075428009033203
Epoch: 14, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.501 Vali Acc: 0.855 Test Loss: 0.501 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 7.224192142486572
Epoch: 15, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.424 Vali Acc: 0.870 Test Loss: 0.424 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 7.266479253768921
Epoch: 16, Steps: 9 | Train Loss: 0.401 Vali Loss: 0.866 Vali Acc: 0.783 Test Loss: 0.866 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 7084740
model size : 28.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.953472375869751
Epoch: 1, Steps: 9 | Train Loss: 1.382 Vali Loss: 1.244 Vali Acc: 0.478 Test Loss: 1.244 Test Acc: 0.478
Validation loss decreased (inf --> -0.478248).  Saving model ...
Epoch: 2 cost time: 3.785221576690674
Epoch: 2, Steps: 9 | Train Loss: 1.137 Vali Loss: 0.969 Vali Acc: 0.609 Test Loss: 0.969 Test Acc: 0.609
Validation loss decreased (-0.478248 --> -0.608686).  Saving model ...
Epoch: 3 cost time: 3.8799033164978027
Epoch: 3, Steps: 9 | Train Loss: 0.843 Vali Loss: 0.733 Vali Acc: 0.746 Test Loss: 0.733 Test Acc: 0.746
Validation loss decreased (-0.608686 --> -0.746369).  Saving model ...
Epoch: 4 cost time: 3.790644407272339
Epoch: 4, Steps: 9 | Train Loss: 0.558 Vali Loss: 0.539 Vali Acc: 0.848 Test Loss: 0.539 Test Acc: 0.848
Validation loss decreased (-0.746369 --> -0.847821).  Saving model ...
Epoch: 5 cost time: 3.8681819438934326
Epoch: 5, Steps: 9 | Train Loss: 0.328 Vali Loss: 0.407 Vali Acc: 0.870 Test Loss: 0.407 Test Acc: 0.870
Validation loss decreased (-0.847821 --> -0.869561).  Saving model ...
Epoch: 6 cost time: 3.8781843185424805
Epoch: 6, Steps: 9 | Train Loss: 0.309 Vali Loss: 0.368 Vali Acc: 0.855 Test Loss: 0.368 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.651904582977295
Epoch: 7, Steps: 9 | Train Loss: 0.137 Vali Loss: 0.341 Vali Acc: 0.899 Test Loss: 0.341 Test Acc: 0.899
Validation loss decreased (-0.869561 --> -0.898547).  Saving model ...
Epoch: 8 cost time: 3.7798967361450195
Epoch: 8, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.418 Vali Acc: 0.848 Test Loss: 0.418 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.7700929641723633
Epoch: 9, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.331 Vali Acc: 0.884 Test Loss: 0.331 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.7260031700134277
Epoch: 10, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.371 Vali Acc: 0.862 Test Loss: 0.371 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.9256234169006348
Epoch: 11, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.347 Vali Acc: 0.877 Test Loss: 0.347 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.226492404937744
Epoch: 12, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.368 Vali Acc: 0.877 Test Loss: 0.368 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.2636146545410156
Epoch: 13, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.348 Vali Acc: 0.877 Test Loss: 0.348 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.172081470489502
Epoch: 14, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.389 Vali Acc: 0.870 Test Loss: 0.389 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.148272752761841
Epoch: 15, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.425 Vali Acc: 0.884 Test Loss: 0.425 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.398400068283081
Epoch: 16, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.361 Vali Acc: 0.877 Test Loss: 0.361 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.343337297439575
Epoch: 17, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.354 Vali Acc: 0.884 Test Loss: 0.354 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 2119620
model size : 9.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 6.453720808029175
Epoch: 1, Steps: 9 | Train Loss: 1.395 Vali Loss: 1.227 Vali Acc: 0.478 Test Loss: 1.227 Test Acc: 0.478
Validation loss decreased (inf --> -0.478249).  Saving model ...
Epoch: 2 cost time: 4.617949724197388
Epoch: 2, Steps: 9 | Train Loss: 1.103 Vali Loss: 1.017 Vali Acc: 0.500 Test Loss: 1.017 Test Acc: 0.500
Validation loss decreased (-0.478249 --> -0.499990).  Saving model ...
Epoch: 3 cost time: 4.700683832168579
Epoch: 3, Steps: 9 | Train Loss: 0.809 Vali Loss: 0.871 Vali Acc: 0.630 Test Loss: 0.871 Test Acc: 0.630
Validation loss decreased (-0.499990 --> -0.630426).  Saving model ...
Epoch: 4 cost time: 4.5219526290893555
Epoch: 4, Steps: 9 | Train Loss: 0.579 Vali Loss: 0.714 Vali Acc: 0.732 Test Loss: 0.714 Test Acc: 0.732
Validation loss decreased (-0.630426 --> -0.731877).  Saving model ...
Epoch: 5 cost time: 4.6724488735198975
Epoch: 5, Steps: 9 | Train Loss: 0.412 Vali Loss: 0.629 Vali Acc: 0.746 Test Loss: 0.629 Test Acc: 0.746
Validation loss decreased (-0.731877 --> -0.746371).  Saving model ...
Epoch: 6 cost time: 4.455265760421753
Epoch: 6, Steps: 9 | Train Loss: 0.267 Vali Loss: 0.503 Vali Acc: 0.826 Test Loss: 0.503 Test Acc: 0.826
Validation loss decreased (-0.746371 --> -0.826082).  Saving model ...
Epoch: 7 cost time: 4.377746343612671
Epoch: 7, Steps: 9 | Train Loss: 0.154 Vali Loss: 0.470 Vali Acc: 0.826 Test Loss: 0.470 Test Acc: 0.826
Validation loss decreased (-0.826082 --> -0.826082).  Saving model ...
Epoch: 8 cost time: 4.542088270187378
Epoch: 8, Steps: 9 | Train Loss: 0.089 Vali Loss: 0.436 Vali Acc: 0.841 Test Loss: 0.436 Test Acc: 0.841
Validation loss decreased (-0.826082 --> -0.840575).  Saving model ...
Epoch: 9 cost time: 4.47487473487854
Epoch: 9, Steps: 9 | Train Loss: 0.126 Vali Loss: 0.555 Vali Acc: 0.812 Test Loss: 0.555 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.984829902648926
Epoch: 10, Steps: 9 | Train Loss: 0.206 Vali Loss: 0.807 Vali Acc: 0.761 Test Loss: 0.807 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.1305670738220215
Epoch: 11, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.905 Vali Acc: 0.797 Test Loss: 0.905 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.608344554901123
Epoch: 12, Steps: 9 | Train Loss: 0.164 Vali Loss: 0.705 Vali Acc: 0.819 Test Loss: 0.705 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.744385242462158
Epoch: 13, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.573 Vali Acc: 0.812 Test Loss: 0.573 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.958077669143677
Epoch: 14, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.662 Vali Acc: 0.761 Test Loss: 0.662 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.635885000228882
Epoch: 15, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.420 Vali Acc: 0.877 Test Loss: 0.420 Test Acc: 0.877
Validation loss decreased (-0.840575 --> -0.876807).  Saving model ...
Epoch: 16 cost time: 4.752153635025024
Epoch: 16, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.883 Vali Acc: 0.739 Test Loss: 0.883 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.527732849121094
Epoch: 17, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.766 Vali Acc: 0.783 Test Loss: 0.766 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.599520444869995
Epoch: 18, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.790 Vali Acc: 0.775 Test Loss: 0.790 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.822168827056885
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.730 Vali Acc: 0.790 Test Loss: 0.730 Test Acc: 0.790
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.165313959121704
Epoch: 20, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.719 Vali Acc: 0.783 Test Loss: 0.719 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.947418212890625
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.710 Vali Acc: 0.775 Test Loss: 0.710 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.506725788116455
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.711 Vali Acc: 0.783 Test Loss: 0.711 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 5.007948637008667
Epoch: 23, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.593 Vali Acc: 0.812 Test Loss: 0.593 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.436574935913086
Epoch: 24, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.783 Vali Acc: 0.746 Test Loss: 0.783 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 4.839606761932373
Epoch: 25, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.245 Vali Acc: 0.754 Test Loss: 1.245 Test Acc: 0.754
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 7084740
model size : 28.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.943195104598999
Epoch: 1, Steps: 9 | Train Loss: 1.386 Vali Loss: 1.273 Vali Acc: 0.406 Test Loss: 1.273 Test Acc: 0.406
Validation loss decreased (inf --> -0.405784).  Saving model ...
Epoch: 2 cost time: 2.705711603164673
Epoch: 2, Steps: 9 | Train Loss: 1.148 Vali Loss: 1.055 Vali Acc: 0.529 Test Loss: 1.055 Test Acc: 0.529
Validation loss decreased (-0.405784 --> -0.528975).  Saving model ...
Epoch: 3 cost time: 3.0063302516937256
Epoch: 3, Steps: 9 | Train Loss: 0.865 Vali Loss: 0.873 Vali Acc: 0.681 Test Loss: 0.873 Test Acc: 0.681
Validation loss decreased (-0.528975 --> -0.681151).  Saving model ...
Epoch: 4 cost time: 2.705247163772583
Epoch: 4, Steps: 9 | Train Loss: 0.593 Vali Loss: 0.691 Vali Acc: 0.775 Test Loss: 0.691 Test Acc: 0.775
Validation loss decreased (-0.681151 --> -0.775355).  Saving model ...
Epoch: 5 cost time: 2.8802030086517334
Epoch: 5, Steps: 9 | Train Loss: 0.372 Vali Loss: 0.585 Vali Acc: 0.797 Test Loss: 0.585 Test Acc: 0.797
Validation loss decreased (-0.775355 --> -0.797096).  Saving model ...
Epoch: 6 cost time: 2.780127763748169
Epoch: 6, Steps: 9 | Train Loss: 0.259 Vali Loss: 0.547 Vali Acc: 0.783 Test Loss: 0.547 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.8591291904449463
Epoch: 7, Steps: 9 | Train Loss: 0.144 Vali Loss: 0.542 Vali Acc: 0.790 Test Loss: 0.542 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.74871826171875
Epoch: 8, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.514 Vali Acc: 0.804 Test Loss: 0.514 Test Acc: 0.804
Validation loss decreased (-0.797096 --> -0.804343).  Saving model ...
Epoch: 9 cost time: 2.9066293239593506
Epoch: 9, Steps: 9 | Train Loss: 0.354 Vali Loss: 0.503 Vali Acc: 0.819 Test Loss: 0.503 Test Acc: 0.819
Validation loss decreased (-0.804343 --> -0.818836).  Saving model ...
Epoch: 10 cost time: 2.739964246749878
Epoch: 10, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.428 Vali Acc: 0.848 Test Loss: 0.428 Test Acc: 0.848
Validation loss decreased (-0.818836 --> -0.847822).  Saving model ...
Epoch: 11 cost time: 2.901932716369629
Epoch: 11, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.411 Vali Acc: 0.862 Test Loss: 0.411 Test Acc: 0.862
Validation loss decreased (-0.847822 --> -0.862315).  Saving model ...
Epoch: 12 cost time: 2.9329519271850586
Epoch: 12, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.418 Vali Acc: 0.870 Test Loss: 0.418 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869561).  Saving model ...
Epoch: 13 cost time: 2.8740696907043457
Epoch: 13, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.458 Vali Acc: 0.826 Test Loss: 0.458 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.919609785079956
Epoch: 14, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.547 Vali Acc: 0.804 Test Loss: 0.547 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.1099328994750977
Epoch: 15, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.574 Vali Acc: 0.797 Test Loss: 0.574 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.8824801445007324
Epoch: 16, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.565 Vali Acc: 0.790 Test Loss: 0.565 Test Acc: 0.790
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.9812631607055664
Epoch: 17, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.606 Vali Acc: 0.775 Test Loss: 0.606 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.0273656845092773
Epoch: 18, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.523 Vali Acc: 0.826 Test Loss: 0.523 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.806095600128174
Epoch: 19, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.733 Vali Acc: 0.833 Test Loss: 0.733 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.010251760482788
Epoch: 20, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.662 Vali Acc: 0.833 Test Loss: 0.662 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.9289638996124268
Epoch: 21, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.593 Vali Acc: 0.862 Test Loss: 0.593 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.999346971511841
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.581 Vali Acc: 0.848 Test Loss: 0.581 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 2119620
model size : 9.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 10.320489645004272
Epoch: 1, Steps: 9 | Train Loss: 1.418 Vali Loss: 1.269 Vali Acc: 0.391 Test Loss: 1.269 Test Acc: 0.391
Validation loss decreased (inf --> -0.391292).  Saving model ...
Epoch: 2 cost time: 9.816439151763916
Epoch: 2, Steps: 9 | Train Loss: 1.156 Vali Loss: 0.996 Vali Acc: 0.580 Test Loss: 0.996 Test Acc: 0.580
Validation loss decreased (-0.391292 --> -0.579700).  Saving model ...
Epoch: 3 cost time: 10.006459474563599
Epoch: 3, Steps: 9 | Train Loss: 0.839 Vali Loss: 0.730 Vali Acc: 0.732 Test Loss: 0.730 Test Acc: 0.732
Validation loss decreased (-0.579700 --> -0.731877).  Saving model ...
Epoch: 4 cost time: 10.001940727233887
Epoch: 4, Steps: 9 | Train Loss: 0.643 Vali Loss: 0.560 Vali Acc: 0.775 Test Loss: 0.560 Test Acc: 0.775
Validation loss decreased (-0.731877 --> -0.775357).  Saving model ...
Epoch: 5 cost time: 10.009599208831787
Epoch: 5, Steps: 9 | Train Loss: 0.447 Vali Loss: 0.453 Vali Acc: 0.812 Test Loss: 0.453 Test Acc: 0.812
Validation loss decreased (-0.775357 --> -0.811590).  Saving model ...
Epoch: 6 cost time: 10.44507098197937
Epoch: 6, Steps: 9 | Train Loss: 0.331 Vali Loss: 0.451 Vali Acc: 0.826 Test Loss: 0.451 Test Acc: 0.826
Validation loss decreased (-0.811590 --> -0.826082).  Saving model ...
Epoch: 7 cost time: 9.987523794174194
Epoch: 7, Steps: 9 | Train Loss: 0.259 Vali Loss: 0.409 Vali Acc: 0.862 Test Loss: 0.409 Test Acc: 0.862
Validation loss decreased (-0.826082 --> -0.862315).  Saving model ...
Epoch: 8 cost time: 10.062618255615234
Epoch: 8, Steps: 9 | Train Loss: 0.223 Vali Loss: 0.297 Vali Acc: 0.899 Test Loss: 0.297 Test Acc: 0.899
Validation loss decreased (-0.862315 --> -0.898548).  Saving model ...
Epoch: 9 cost time: 10.344060897827148
Epoch: 9, Steps: 9 | Train Loss: 0.176 Vali Loss: 0.499 Vali Acc: 0.848 Test Loss: 0.499 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 10.258294820785522
Epoch: 10, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.428 Vali Acc: 0.870 Test Loss: 0.428 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 10.260103702545166
Epoch: 11, Steps: 9 | Train Loss: 0.259 Vali Loss: 0.357 Vali Acc: 0.891 Test Loss: 0.357 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 10.344123840332031
Epoch: 12, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.430 Vali Acc: 0.841 Test Loss: 0.430 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 8.704756736755371
Epoch: 13, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.424 Vali Acc: 0.862 Test Loss: 0.424 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 8.48956847190857
Epoch: 14, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.396 Vali Acc: 0.891 Test Loss: 0.396 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 10.076804161071777
Epoch: 15, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.378 Vali Acc: 0.899 Test Loss: 0.378 Test Acc: 0.899
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 9.812437534332275
Epoch: 16, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.489 Vali Acc: 0.862 Test Loss: 0.489 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 9.93267035484314
Epoch: 17, Steps: 9 | Train Loss: 0.087 Vali Loss: 0.395 Vali Acc: 0.899 Test Loss: 0.395 Test Acc: 0.899
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 9.210092306137085
Epoch: 18, Steps: 9 | Train Loss: 0.147 Vali Loss: 0.414 Vali Acc: 0.891 Test Loss: 0.414 Test Acc: 0.891
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 7058468
model size : 27.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 7.18271803855896
Epoch: 1, Steps: 9 | Train Loss: 1.372 Vali Loss: 1.291 Vali Acc: 0.413 Test Loss: 1.291 Test Acc: 0.413
Validation loss decreased (inf --> -0.413031).  Saving model ...
Epoch: 2 cost time: 5.311826705932617
Epoch: 2, Steps: 9 | Train Loss: 1.173 Vali Loss: 1.041 Vali Acc: 0.638 Test Loss: 1.041 Test Acc: 0.638
Validation loss decreased (-0.413031 --> -0.637671).  Saving model ...
Epoch: 3 cost time: 5.2389233112335205
Epoch: 3, Steps: 9 | Train Loss: 0.900 Vali Loss: 0.815 Vali Acc: 0.725 Test Loss: 0.815 Test Acc: 0.725
Validation loss decreased (-0.637671 --> -0.724630).  Saving model ...
Epoch: 4 cost time: 5.469443321228027
Epoch: 4, Steps: 9 | Train Loss: 0.633 Vali Loss: 0.604 Vali Acc: 0.761 Test Loss: 0.604 Test Acc: 0.761
Validation loss decreased (-0.724630 --> -0.760864).  Saving model ...
Epoch: 5 cost time: 5.107574701309204
Epoch: 5, Steps: 9 | Train Loss: 0.465 Vali Loss: 0.474 Vali Acc: 0.841 Test Loss: 0.474 Test Acc: 0.841
Validation loss decreased (-0.760864 --> -0.840575).  Saving model ...
Epoch: 6 cost time: 5.136534214019775
Epoch: 6, Steps: 9 | Train Loss: 0.321 Vali Loss: 0.407 Vali Acc: 0.862 Test Loss: 0.407 Test Acc: 0.862
Validation loss decreased (-0.840575 --> -0.862315).  Saving model ...
Epoch: 7 cost time: 5.278148412704468
Epoch: 7, Steps: 9 | Train Loss: 0.251 Vali Loss: 0.390 Vali Acc: 0.855 Test Loss: 0.390 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.271070718765259
Epoch: 8, Steps: 9 | Train Loss: 0.153 Vali Loss: 0.445 Vali Acc: 0.833 Test Loss: 0.445 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.064276218414307
Epoch: 9, Steps: 9 | Train Loss: 0.110 Vali Loss: 0.429 Vali Acc: 0.855 Test Loss: 0.429 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.116453170776367
Epoch: 10, Steps: 9 | Train Loss: 0.116 Vali Loss: 0.421 Vali Acc: 0.855 Test Loss: 0.421 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.266615867614746
Epoch: 11, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.384 Vali Acc: 0.870 Test Loss: 0.384 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869561).  Saving model ...
Epoch: 12 cost time: 5.023928642272949
Epoch: 12, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.412 Vali Acc: 0.862 Test Loss: 0.412 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.215326547622681
Epoch: 13, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.425 Vali Acc: 0.884 Test Loss: 0.425 Test Acc: 0.884
Validation loss decreased (-0.869561 --> -0.884054).  Saving model ...
Epoch: 14 cost time: 5.347212314605713
Epoch: 14, Steps: 9 | Train Loss: 0.151 Vali Loss: 0.434 Vali Acc: 0.877 Test Loss: 0.434 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.251316785812378
Epoch: 15, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.383 Vali Acc: 0.884 Test Loss: 0.383 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 16 cost time: 4.591724634170532
Epoch: 16, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.353 Vali Acc: 0.884 Test Loss: 0.353 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 17 cost time: 4.45002293586731
Epoch: 17, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.359 Vali Acc: 0.891 Test Loss: 0.359 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891301).  Saving model ...
Epoch: 18 cost time: 4.898223876953125
Epoch: 18, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.375 Vali Acc: 0.891 Test Loss: 0.375 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.90795373916626
Epoch: 19, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.379 Vali Acc: 0.891 Test Loss: 0.379 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.84998631477356
Epoch: 20, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.414 Vali Acc: 0.884 Test Loss: 0.414 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.155085325241089
Epoch: 21, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.382 Vali Acc: 0.891 Test Loss: 0.382 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.846664190292358
Epoch: 22, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.345 Vali Acc: 0.899 Test Loss: 0.345 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898547).  Saving model ...
Epoch: 23 cost time: 5.010545492172241
Epoch: 23, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.339 Vali Acc: 0.913 Test Loss: 0.339 Test Acc: 0.913
Validation loss decreased (-0.898547 --> -0.913040).  Saving model ...
Epoch: 24 cost time: 4.721643447875977
Epoch: 24, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.377 Vali Acc: 0.906 Test Loss: 0.377 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.5584869384765625
Epoch: 25, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.413 Vali Acc: 0.891 Test Loss: 0.413 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 5.439326047897339
Epoch: 26, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.420 Vali Acc: 0.899 Test Loss: 0.420 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 5.365704298019409
Epoch: 27, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.395 Vali Acc: 0.899 Test Loss: 0.395 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 4.595806360244751
Epoch: 28, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.367 Vali Acc: 0.899 Test Loss: 0.367 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 5.622015714645386
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.361 Vali Acc: 0.899 Test Loss: 0.361 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 5.285783767700195
Epoch: 30, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.389 Vali Acc: 0.899 Test Loss: 0.389 Test Acc: 0.899
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 2093156
model size : 8.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 9.26893949508667
Epoch: 1, Steps: 9 | Train Loss: 1.418 Vali Loss: 1.276 Vali Acc: 0.399 Test Loss: 1.276 Test Acc: 0.399
Validation loss decreased (inf --> -0.398538).  Saving model ...
Epoch: 2 cost time: 6.867458343505859
Epoch: 2, Steps: 9 | Train Loss: 1.177 Vali Loss: 1.019 Vali Acc: 0.551 Test Loss: 1.019 Test Acc: 0.551
Validation loss decreased (-0.398538 --> -0.550714).  Saving model ...
Epoch: 3 cost time: 6.352319717407227
Epoch: 3, Steps: 9 | Train Loss: 0.917 Vali Loss: 0.788 Vali Acc: 0.681 Test Loss: 0.788 Test Acc: 0.681
Validation loss decreased (-0.550714 --> -0.681152).  Saving model ...
Epoch: 4 cost time: 7.192799806594849
Epoch: 4, Steps: 9 | Train Loss: 0.724 Vali Loss: 0.608 Vali Acc: 0.797 Test Loss: 0.608 Test Acc: 0.797
Validation loss decreased (-0.681152 --> -0.797095).  Saving model ...
Epoch: 5 cost time: 7.04278039932251
Epoch: 5, Steps: 9 | Train Loss: 0.526 Vali Loss: 0.550 Vali Acc: 0.790 Test Loss: 0.550 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.445874452590942
Epoch: 6, Steps: 9 | Train Loss: 0.383 Vali Loss: 0.476 Vali Acc: 0.812 Test Loss: 0.476 Test Acc: 0.812
Validation loss decreased (-0.797095 --> -0.811589).  Saving model ...
Epoch: 7 cost time: 7.34358549118042
Epoch: 7, Steps: 9 | Train Loss: 0.351 Vali Loss: 0.400 Vali Acc: 0.841 Test Loss: 0.400 Test Acc: 0.841
Validation loss decreased (-0.811589 --> -0.840576).  Saving model ...
Epoch: 8 cost time: 7.147687911987305
Epoch: 8, Steps: 9 | Train Loss: 0.229 Vali Loss: 0.292 Vali Acc: 0.906 Test Loss: 0.292 Test Acc: 0.906
Validation loss decreased (-0.840576 --> -0.905794).  Saving model ...
Epoch: 9 cost time: 7.048436403274536
Epoch: 9, Steps: 9 | Train Loss: 0.182 Vali Loss: 0.431 Vali Acc: 0.855 Test Loss: 0.431 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.4646522998809814
Epoch: 10, Steps: 9 | Train Loss: 0.107 Vali Loss: 0.436 Vali Acc: 0.855 Test Loss: 0.436 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 7.302434206008911
Epoch: 11, Steps: 9 | Train Loss: 0.271 Vali Loss: 0.309 Vali Acc: 0.906 Test Loss: 0.309 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 7.19039511680603
Epoch: 12, Steps: 9 | Train Loss: 0.132 Vali Loss: 0.381 Vali Acc: 0.877 Test Loss: 0.381 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 7.424849033355713
Epoch: 13, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.356 Vali Acc: 0.870 Test Loss: 0.356 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 7.239318370819092
Epoch: 14, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.319 Vali Acc: 0.906 Test Loss: 0.319 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 7.199893474578857
Epoch: 15, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.325 Vali Acc: 0.899 Test Loss: 0.325 Test Acc: 0.899
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 7.511373281478882
Epoch: 16, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.361 Vali Acc: 0.862 Test Loss: 0.361 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 6.985166311264038
Epoch: 17, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.338 Vali Acc: 0.877 Test Loss: 0.338 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 6.14991307258606
Epoch: 18, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.407 Vali Acc: 0.877 Test Loss: 0.407 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 7058468
model size : 27.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.459762334823608
Epoch: 1, Steps: 9 | Train Loss: 1.371 Vali Loss: 1.293 Vali Acc: 0.413 Test Loss: 1.293 Test Acc: 0.413
Validation loss decreased (inf --> -0.413031).  Saving model ...
Epoch: 2 cost time: 3.580686569213867
Epoch: 2, Steps: 9 | Train Loss: 1.191 Vali Loss: 1.061 Vali Acc: 0.594 Test Loss: 1.061 Test Acc: 0.594
Validation loss decreased (-0.413031 --> -0.594192).  Saving model ...
Epoch: 3 cost time: 3.610050916671753
Epoch: 3, Steps: 9 | Train Loss: 0.951 Vali Loss: 0.866 Vali Acc: 0.652 Test Loss: 0.866 Test Acc: 0.652
Validation loss decreased (-0.594192 --> -0.652165).  Saving model ...
Epoch: 4 cost time: 3.3747811317443848
Epoch: 4, Steps: 9 | Train Loss: 0.724 Vali Loss: 0.677 Vali Acc: 0.725 Test Loss: 0.677 Test Acc: 0.725
Validation loss decreased (-0.652165 --> -0.724631).  Saving model ...
Epoch: 5 cost time: 3.5838441848754883
Epoch: 5, Steps: 9 | Train Loss: 0.539 Vali Loss: 0.510 Vali Acc: 0.790 Test Loss: 0.510 Test Acc: 0.790
Validation loss decreased (-0.724631 --> -0.789850).  Saving model ...
Epoch: 6 cost time: 3.480515480041504
Epoch: 6, Steps: 9 | Train Loss: 0.427 Vali Loss: 0.436 Vali Acc: 0.797 Test Loss: 0.436 Test Acc: 0.797
Validation loss decreased (-0.789850 --> -0.797097).  Saving model ...
Epoch: 7 cost time: 3.473238229751587
Epoch: 7, Steps: 9 | Train Loss: 0.288 Vali Loss: 0.373 Vali Acc: 0.855 Test Loss: 0.373 Test Acc: 0.855
Validation loss decreased (-0.797097 --> -0.855069).  Saving model ...
Epoch: 8 cost time: 3.5724387168884277
Epoch: 8, Steps: 9 | Train Loss: 0.409 Vali Loss: 0.409 Vali Acc: 0.841 Test Loss: 0.409 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.265014171600342
Epoch: 9, Steps: 9 | Train Loss: 0.206 Vali Loss: 0.321 Vali Acc: 0.884 Test Loss: 0.321 Test Acc: 0.884
Validation loss decreased (-0.855069 --> -0.884055).  Saving model ...
Epoch: 10 cost time: 3.5485687255859375
Epoch: 10, Steps: 9 | Train Loss: 0.119 Vali Loss: 0.380 Vali Acc: 0.841 Test Loss: 0.380 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.515068531036377
Epoch: 11, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.323 Vali Acc: 0.870 Test Loss: 0.323 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.4304957389831543
Epoch: 12, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.327 Vali Acc: 0.884 Test Loss: 0.327 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.418600082397461
Epoch: 13, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.360 Vali Acc: 0.877 Test Loss: 0.360 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.5402557849884033
Epoch: 14, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.375 Vali Acc: 0.891 Test Loss: 0.375 Test Acc: 0.891
Validation loss decreased (-0.884055 --> -0.891301).  Saving model ...
Epoch: 15 cost time: 3.425550699234009
Epoch: 15, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.367 Vali Acc: 0.891 Test Loss: 0.367 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 16 cost time: 3.253572940826416
Epoch: 16, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.366 Vali Acc: 0.884 Test Loss: 0.366 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.162832260131836
Epoch: 17, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.341 Vali Acc: 0.891 Test Loss: 0.341 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 18 cost time: 3.2576966285705566
Epoch: 18, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.343 Vali Acc: 0.891 Test Loss: 0.343 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.69887638092041
Epoch: 19, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.352 Vali Acc: 0.891 Test Loss: 0.352 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.698962450027466
Epoch: 20, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.384 Vali Acc: 0.884 Test Loss: 0.384 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.4182889461517334
Epoch: 21, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.349 Vali Acc: 0.891 Test Loss: 0.349 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.722989559173584
Epoch: 22, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.434 Vali Acc: 0.862 Test Loss: 0.434 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.7646331787109375
Epoch: 23, Steps: 9 | Train Loss: 0.029 Vali Loss: 1.843 Vali Acc: 0.732 Test Loss: 1.843 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.769012928009033
Epoch: 24, Steps: 9 | Train Loss: 0.217 Vali Loss: 0.961 Vali Acc: 0.783 Test Loss: 0.961 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.772345542907715
Epoch: 25, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.348 Vali Acc: 0.928 Test Loss: 0.348 Test Acc: 0.928
Validation loss decreased (-0.891301 --> -0.927533).  Saving model ...
Epoch: 26 cost time: 3.894224166870117
Epoch: 26, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.368 Vali Acc: 0.899 Test Loss: 0.368 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.986440420150757
Epoch: 27, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.381 Vali Acc: 0.899 Test Loss: 0.381 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 4.058399438858032
Epoch: 28, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.357 Vali Acc: 0.891 Test Loss: 0.357 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.878246307373047
Epoch: 29, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.328 Vali Acc: 0.913 Test Loss: 0.328 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.595414876937866
Epoch: 30, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.284 Vali Acc: 0.913 Test Loss: 0.284 Test Acc: 0.913
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.927536231884058
model parameter : 2093156
model size : 8.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 6.3572893142700195
Epoch: 1, Steps: 9 | Train Loss: 1.421 Vali Loss: 1.305 Vali Acc: 0.377 Test Loss: 1.305 Test Acc: 0.377
Validation loss decreased (inf --> -0.376799).  Saving model ...
Epoch: 2 cost time: 4.775462865829468
Epoch: 2, Steps: 9 | Train Loss: 1.211 Vali Loss: 1.144 Vali Acc: 0.464 Test Loss: 1.144 Test Acc: 0.464
Validation loss decreased (-0.376799 --> -0.463757).  Saving model ...
Epoch: 3 cost time: 4.5305540561676025
Epoch: 3, Steps: 9 | Train Loss: 1.004 Vali Loss: 0.968 Vali Acc: 0.558 Test Loss: 0.968 Test Acc: 0.558
Validation loss decreased (-0.463757 --> -0.557961).  Saving model ...
Epoch: 4 cost time: 4.768150329589844
Epoch: 4, Steps: 9 | Train Loss: 0.801 Vali Loss: 0.826 Vali Acc: 0.667 Test Loss: 0.826 Test Acc: 0.667
Validation loss decreased (-0.557961 --> -0.666658).  Saving model ...
Epoch: 5 cost time: 5.405466556549072
Epoch: 5, Steps: 9 | Train Loss: 0.618 Vali Loss: 0.693 Vali Acc: 0.710 Test Loss: 0.693 Test Acc: 0.710
Validation loss decreased (-0.666658 --> -0.710138).  Saving model ...
Epoch: 6 cost time: 5.287875652313232
Epoch: 6, Steps: 9 | Train Loss: 0.449 Vali Loss: 0.581 Vali Acc: 0.761 Test Loss: 0.581 Test Acc: 0.761
Validation loss decreased (-0.710138 --> -0.760864).  Saving model ...
Epoch: 7 cost time: 5.120198965072632
Epoch: 7, Steps: 9 | Train Loss: 0.394 Vali Loss: 0.567 Vali Acc: 0.746 Test Loss: 0.567 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.205742597579956
Epoch: 8, Steps: 9 | Train Loss: 0.267 Vali Loss: 0.459 Vali Acc: 0.819 Test Loss: 0.459 Test Acc: 0.819
Validation loss decreased (-0.760864 --> -0.818836).  Saving model ...
Epoch: 9 cost time: 5.159133672714233
Epoch: 9, Steps: 9 | Train Loss: 0.199 Vali Loss: 0.565 Vali Acc: 0.768 Test Loss: 0.565 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.7377636432647705
Epoch: 10, Steps: 9 | Train Loss: 0.117 Vali Loss: 0.432 Vali Acc: 0.812 Test Loss: 0.432 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.453703880310059
Epoch: 11, Steps: 9 | Train Loss: 0.211 Vali Loss: 0.365 Vali Acc: 0.870 Test Loss: 0.365 Test Acc: 0.870
Validation loss decreased (-0.818836 --> -0.869562).  Saving model ...
Epoch: 12 cost time: 4.611940145492554
Epoch: 12, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.423 Vali Acc: 0.848 Test Loss: 0.423 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.692918539047241
Epoch: 13, Steps: 9 | Train Loss: 0.087 Vali Loss: 0.671 Vali Acc: 0.797 Test Loss: 0.671 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.260302305221558
Epoch: 14, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.470 Vali Acc: 0.848 Test Loss: 0.470 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.148071765899658
Epoch: 15, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.433 Vali Acc: 0.862 Test Loss: 0.433 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.27521276473999
Epoch: 16, Steps: 9 | Train Loss: 0.038 Vali Loss: 1.242 Vali Acc: 0.746 Test Loss: 1.242 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.307556867599487
Epoch: 17, Steps: 9 | Train Loss: 0.019 Vali Loss: 1.324 Vali Acc: 0.732 Test Loss: 1.324 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.062430381774902
Epoch: 18, Steps: 9 | Train Loss: 0.037 Vali Loss: 1.298 Vali Acc: 0.768 Test Loss: 1.298 Test Acc: 0.768
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.339756727218628
Epoch: 19, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.417 Vali Acc: 0.775 Test Loss: 1.417 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.381950378417969
Epoch: 20, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.325 Vali Acc: 0.790 Test Loss: 1.325 Test Acc: 0.790
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.241452932357788
Epoch: 21, Steps: 9 | Train Loss: 0.364 Vali Loss: 0.519 Vali Acc: 0.841 Test Loss: 0.519 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 7058468
model size : 27.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.104503393173218
Epoch: 1, Steps: 9 | Train Loss: 1.368 Vali Loss: 1.310 Vali Acc: 0.384 Test Loss: 1.310 Test Acc: 0.384
Validation loss decreased (inf --> -0.384045).  Saving model ...
Epoch: 2 cost time: 3.117469072341919
Epoch: 2, Steps: 9 | Train Loss: 1.202 Vali Loss: 1.099 Vali Acc: 0.587 Test Loss: 1.099 Test Acc: 0.587
Validation loss decreased (-0.384045 --> -0.586946).  Saving model ...
Epoch: 3 cost time: 3.194770574569702
Epoch: 3, Steps: 9 | Train Loss: 0.980 Vali Loss: 0.923 Vali Acc: 0.630 Test Loss: 0.923 Test Acc: 0.630
Validation loss decreased (-0.586946 --> -0.630426).  Saving model ...
Epoch: 4 cost time: 2.764735460281372
Epoch: 4, Steps: 9 | Train Loss: 0.779 Vali Loss: 0.776 Vali Acc: 0.674 Test Loss: 0.776 Test Acc: 0.674
Validation loss decreased (-0.630426 --> -0.673905).  Saving model ...
Epoch: 5 cost time: 3.256073474884033
Epoch: 5, Steps: 9 | Train Loss: 0.609 Vali Loss: 0.635 Vali Acc: 0.717 Test Loss: 0.635 Test Acc: 0.717
Validation loss decreased (-0.673905 --> -0.717385).  Saving model ...
Epoch: 6 cost time: 3.356654405593872
Epoch: 6, Steps: 9 | Train Loss: 0.482 Vali Loss: 0.517 Vali Acc: 0.783 Test Loss: 0.517 Test Acc: 0.783
Validation loss decreased (-0.717385 --> -0.782604).  Saving model ...
Epoch: 7 cost time: 3.12160062789917
Epoch: 7, Steps: 9 | Train Loss: 0.373 Vali Loss: 0.483 Vali Acc: 0.790 Test Loss: 0.483 Test Acc: 0.790
Validation loss decreased (-0.782604 --> -0.789850).  Saving model ...
Epoch: 8 cost time: 3.095792770385742
Epoch: 8, Steps: 9 | Train Loss: 0.263 Vali Loss: 0.484 Vali Acc: 0.790 Test Loss: 0.484 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.0741991996765137
Epoch: 9, Steps: 9 | Train Loss: 0.177 Vali Loss: 0.410 Vali Acc: 0.841 Test Loss: 0.410 Test Acc: 0.841
Validation loss decreased (-0.789850 --> -0.840576).  Saving model ...
Epoch: 10 cost time: 3.155032157897949
Epoch: 10, Steps: 9 | Train Loss: 0.120 Vali Loss: 0.399 Vali Acc: 0.833 Test Loss: 0.399 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.875227212905884
Epoch: 11, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.376 Vali Acc: 0.855 Test Loss: 0.376 Test Acc: 0.855
Validation loss decreased (-0.840576 --> -0.855069).  Saving model ...
Epoch: 12 cost time: 2.9068515300750732
Epoch: 12, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.385 Vali Acc: 0.848 Test Loss: 0.385 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.0279366970062256
Epoch: 13, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.402 Vali Acc: 0.855 Test Loss: 0.402 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.9629650115966797
Epoch: 14, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.586 Vali Acc: 0.775 Test Loss: 0.586 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.008099317550659
Epoch: 15, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.521 Vali Acc: 0.804 Test Loss: 0.521 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.2700815200805664
Epoch: 16, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.367 Vali Acc: 0.891 Test Loss: 0.367 Test Acc: 0.891
Validation loss decreased (-0.855069 --> -0.891301).  Saving model ...
Epoch: 17 cost time: 2.8880069255828857
Epoch: 17, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.286 Vali Acc: 0.884 Test Loss: 0.286 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.263653516769409
Epoch: 18, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.335 Vali Acc: 0.906 Test Loss: 0.335 Test Acc: 0.906
Validation loss decreased (-0.891301 --> -0.905794).  Saving model ...
Epoch: 19 cost time: 3.2074990272521973
Epoch: 19, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.358 Vali Acc: 0.913 Test Loss: 0.358 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913040).  Saving model ...
Epoch: 20 cost time: 3.2791993618011475
Epoch: 20, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.404 Vali Acc: 0.899 Test Loss: 0.404 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.305802822113037
Epoch: 21, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.407 Vali Acc: 0.891 Test Loss: 0.407 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.3750452995300293
Epoch: 22, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.430 Vali Acc: 0.870 Test Loss: 0.430 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.226452112197876
Epoch: 23, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.385 Vali Acc: 0.899 Test Loss: 0.385 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.3321690559387207
Epoch: 24, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.345 Vali Acc: 0.899 Test Loss: 0.345 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.2994577884674072
Epoch: 25, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.315 Vali Acc: 0.891 Test Loss: 0.315 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.1052775382995605
Epoch: 26, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.697 Vali Acc: 0.855 Test Loss: 0.697 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.3379366397857666
Epoch: 27, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.697 Vali Acc: 0.826 Test Loss: 0.697 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.2894012928009033
Epoch: 28, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.834 Vali Acc: 0.812 Test Loss: 0.834 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.334756374359131
Epoch: 29, Steps: 9 | Train Loss: 0.103 Vali Loss: 0.559 Vali Acc: 0.877 Test Loss: 0.559 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 2093156
model size : 8.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 9.472016334533691
Epoch: 1, Steps: 9 | Train Loss: 1.391 Vali Loss: 1.261 Vali Acc: 0.406 Test Loss: 1.261 Test Acc: 0.406
Validation loss decreased (inf --> -0.405784).  Saving model ...
Epoch: 2 cost time: 6.977479934692383
Epoch: 2, Steps: 9 | Train Loss: 1.211 Vali Loss: 1.036 Vali Acc: 0.681 Test Loss: 1.036 Test Acc: 0.681
Validation loss decreased (-0.405784 --> -0.681149).  Saving model ...
Epoch: 3 cost time: 7.260115385055542
Epoch: 3, Steps: 9 | Train Loss: 0.917 Vali Loss: 0.794 Vali Acc: 0.739 Test Loss: 0.794 Test Acc: 0.739
Validation loss decreased (-0.681149 --> -0.739122).  Saving model ...
Epoch: 4 cost time: 6.777193069458008
Epoch: 4, Steps: 9 | Train Loss: 0.654 Vali Loss: 0.574 Vali Acc: 0.804 Test Loss: 0.574 Test Acc: 0.804
Validation loss decreased (-0.739122 --> -0.804342).  Saving model ...
Epoch: 5 cost time: 6.172870397567749
Epoch: 5, Steps: 9 | Train Loss: 0.463 Vali Loss: 0.452 Vali Acc: 0.826 Test Loss: 0.452 Test Acc: 0.826
Validation loss decreased (-0.804342 --> -0.826082).  Saving model ...
Epoch: 6 cost time: 6.745146989822388
Epoch: 6, Steps: 9 | Train Loss: 0.315 Vali Loss: 0.427 Vali Acc: 0.848 Test Loss: 0.427 Test Acc: 0.848
Validation loss decreased (-0.826082 --> -0.847822).  Saving model ...
Epoch: 7 cost time: 7.0167906284332275
Epoch: 7, Steps: 9 | Train Loss: 0.191 Vali Loss: 0.359 Vali Acc: 0.841 Test Loss: 0.359 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.119278192520142
Epoch: 8, Steps: 9 | Train Loss: 0.203 Vali Loss: 0.370 Vali Acc: 0.855 Test Loss: 0.370 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855069).  Saving model ...
Epoch: 9 cost time: 7.127723693847656
Epoch: 9, Steps: 9 | Train Loss: 0.507 Vali Loss: 0.329 Vali Acc: 0.877 Test Loss: 0.329 Test Acc: 0.877
Validation loss decreased (-0.855069 --> -0.876808).  Saving model ...
Epoch: 10 cost time: 7.215052127838135
Epoch: 10, Steps: 9 | Train Loss: 0.157 Vali Loss: 0.380 Vali Acc: 0.891 Test Loss: 0.380 Test Acc: 0.891
Validation loss decreased (-0.876808 --> -0.891301).  Saving model ...
Epoch: 11 cost time: 7.082484006881714
Epoch: 11, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.379 Vali Acc: 0.870 Test Loss: 0.379 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.66681981086731
Epoch: 12, Steps: 9 | Train Loss: 0.102 Vali Loss: 0.386 Vali Acc: 0.877 Test Loss: 0.386 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.85538649559021
Epoch: 13, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.339 Vali Acc: 0.906 Test Loss: 0.339 Test Acc: 0.906
Validation loss decreased (-0.891301 --> -0.905794).  Saving model ...
Epoch: 14 cost time: 6.8049702644348145
Epoch: 14, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.378 Vali Acc: 0.891 Test Loss: 0.378 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 7.0480945110321045
Epoch: 15, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.409 Vali Acc: 0.884 Test Loss: 0.409 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.853755712509155
Epoch: 16, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.400 Vali Acc: 0.891 Test Loss: 0.400 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 6.140271186828613
Epoch: 17, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.412 Vali Acc: 0.877 Test Loss: 0.412 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.411139726638794
Epoch: 18, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.417 Vali Acc: 0.870 Test Loss: 0.417 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 7.038480997085571
Epoch: 19, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.394 Vali Acc: 0.877 Test Loss: 0.394 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 7.146478891372681
Epoch: 20, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.391 Vali Acc: 0.891 Test Loss: 0.391 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 7.302988767623901
Epoch: 21, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.419 Vali Acc: 0.884 Test Loss: 0.419 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 7.169250965118408
Epoch: 22, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.421 Vali Acc: 0.899 Test Loss: 0.421 Test Acc: 0.899
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 6.791858196258545
Epoch: 23, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.419 Vali Acc: 0.920 Test Loss: 0.419 Test Acc: 0.920
Validation loss decreased (-0.905794 --> -0.920286).  Saving model ...
Epoch: 24 cost time: 6.744828939437866
Epoch: 24, Steps: 9 | Train Loss: 0.130 Vali Loss: 0.399 Vali Acc: 0.913 Test Loss: 0.399 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 7.22076678276062
Epoch: 25, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.434 Vali Acc: 0.877 Test Loss: 0.434 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 7.472483158111572
Epoch: 26, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.667 Vali Acc: 0.848 Test Loss: 0.667 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 7.5680859088897705
Epoch: 27, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.795 Vali Acc: 0.804 Test Loss: 0.795 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 7.173268556594849
Epoch: 28, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.617 Vali Acc: 0.826 Test Loss: 0.617 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 6.8080339431762695
Epoch: 29, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.553 Vali Acc: 0.870 Test Loss: 0.553 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 6.618543386459351
Epoch: 30, Steps: 9 | Train Loss: 0.246 Vali Loss: 0.610 Vali Acc: 0.833 Test Loss: 0.610 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 3542948
model size : 14.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.426133394241333
Epoch: 1, Steps: 9 | Train Loss: 1.362 Vali Loss: 1.257 Vali Acc: 0.471 Test Loss: 1.257 Test Acc: 0.471
Validation loss decreased (inf --> -0.471002).  Saving model ...
Epoch: 2 cost time: 3.440676689147949
Epoch: 2, Steps: 9 | Train Loss: 1.166 Vali Loss: 1.052 Vali Acc: 0.688 Test Loss: 1.052 Test Acc: 0.688
Validation loss decreased (-0.471002 --> -0.688395).  Saving model ...
Epoch: 3 cost time: 3.6738216876983643
Epoch: 3, Steps: 9 | Train Loss: 0.936 Vali Loss: 0.845 Vali Acc: 0.746 Test Loss: 0.845 Test Acc: 0.746
Validation loss decreased (-0.688395 --> -0.746368).  Saving model ...
Epoch: 4 cost time: 3.553534507751465
Epoch: 4, Steps: 9 | Train Loss: 0.687 Vali Loss: 0.657 Vali Acc: 0.804 Test Loss: 0.657 Test Acc: 0.804
Validation loss decreased (-0.746368 --> -0.804341).  Saving model ...
Epoch: 5 cost time: 3.7602012157440186
Epoch: 5, Steps: 9 | Train Loss: 0.481 Vali Loss: 0.524 Vali Acc: 0.804 Test Loss: 0.524 Test Acc: 0.804
Validation loss decreased (-0.804341 --> -0.804343).  Saving model ...
Epoch: 6 cost time: 3.4713776111602783
Epoch: 6, Steps: 9 | Train Loss: 0.392 Vali Loss: 0.458 Vali Acc: 0.826 Test Loss: 0.458 Test Acc: 0.826
Validation loss decreased (-0.804343 --> -0.826082).  Saving model ...
Epoch: 7 cost time: 3.737128496170044
Epoch: 7, Steps: 9 | Train Loss: 0.297 Vali Loss: 0.420 Vali Acc: 0.841 Test Loss: 0.420 Test Acc: 0.841
Validation loss decreased (-0.826082 --> -0.840576).  Saving model ...
Epoch: 8 cost time: 3.676042079925537
Epoch: 8, Steps: 9 | Train Loss: 0.222 Vali Loss: 0.414 Vali Acc: 0.833 Test Loss: 0.414 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.7312214374542236
Epoch: 9, Steps: 9 | Train Loss: 0.144 Vali Loss: 0.397 Vali Acc: 0.855 Test Loss: 0.397 Test Acc: 0.855
Validation loss decreased (-0.840576 --> -0.855068).  Saving model ...
Epoch: 10 cost time: 3.857720136642456
Epoch: 10, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.368 Vali Acc: 0.862 Test Loss: 0.368 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862315).  Saving model ...
Epoch: 11 cost time: 3.7572712898254395
Epoch: 11, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.337 Vali Acc: 0.870 Test Loss: 0.337 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869562).  Saving model ...
Epoch: 12 cost time: 3.5886764526367188
Epoch: 12, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.440 Vali Acc: 0.841 Test Loss: 0.440 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.7785403728485107
Epoch: 13, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.432 Vali Acc: 0.833 Test Loss: 0.432 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.6625256538391113
Epoch: 14, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.376 Vali Acc: 0.862 Test Loss: 0.376 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.2491562366485596
Epoch: 15, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.325 Vali Acc: 0.913 Test Loss: 0.325 Test Acc: 0.913
Validation loss decreased (-0.869562 --> -0.913040).  Saving model ...
Epoch: 16 cost time: 3.1043481826782227
Epoch: 16, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.354 Vali Acc: 0.877 Test Loss: 0.354 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.4876952171325684
Epoch: 17, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.355 Vali Acc: 0.870 Test Loss: 0.355 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.543306827545166
Epoch: 18, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.359 Vali Acc: 0.877 Test Loss: 0.359 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.479339122772217
Epoch: 19, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.385 Vali Acc: 0.870 Test Loss: 0.385 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.4456746578216553
Epoch: 20, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.384 Vali Acc: 0.877 Test Loss: 0.384 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.471494436264038
Epoch: 21, Steps: 9 | Train Loss: 0.242 Vali Loss: 0.353 Vali Acc: 0.891 Test Loss: 0.353 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.2898731231689453
Epoch: 22, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.371 Vali Acc: 0.891 Test Loss: 0.371 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.3453590869903564
Epoch: 23, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.360 Vali Acc: 0.884 Test Loss: 0.360 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.624136209487915
Epoch: 24, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.344 Vali Acc: 0.913 Test Loss: 0.344 Test Acc: 0.913
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.9545726776123047
Epoch: 25, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.366 Vali Acc: 0.899 Test Loss: 0.366 Test Acc: 0.899
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 1060196
model size : 4.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 7.226961612701416
Epoch: 1, Steps: 9 | Train Loss: 1.391 Vali Loss: 1.278 Vali Acc: 0.399 Test Loss: 1.278 Test Acc: 0.399
Validation loss decreased (inf --> -0.398538).  Saving model ...
Epoch: 2 cost time: 4.9421045780181885
Epoch: 2, Steps: 9 | Train Loss: 1.231 Vali Loss: 1.075 Vali Acc: 0.638 Test Loss: 1.075 Test Acc: 0.638
Validation loss decreased (-0.398538 --> -0.637670).  Saving model ...
Epoch: 3 cost time: 5.166154861450195
Epoch: 3, Steps: 9 | Train Loss: 0.970 Vali Loss: 0.863 Vali Acc: 0.681 Test Loss: 0.863 Test Acc: 0.681
Validation loss decreased (-0.637670 --> -0.681151).  Saving model ...
Epoch: 4 cost time: 4.474241495132446
Epoch: 4, Steps: 9 | Train Loss: 0.747 Vali Loss: 0.670 Vali Acc: 0.746 Test Loss: 0.670 Test Acc: 0.746
Validation loss decreased (-0.681151 --> -0.746370).  Saving model ...
Epoch: 5 cost time: 4.296760559082031
Epoch: 5, Steps: 9 | Train Loss: 0.566 Vali Loss: 0.566 Vali Acc: 0.775 Test Loss: 0.566 Test Acc: 0.775
Validation loss decreased (-0.746370 --> -0.775357).  Saving model ...
Epoch: 6 cost time: 4.442335844039917
Epoch: 6, Steps: 9 | Train Loss: 0.413 Vali Loss: 0.425 Vali Acc: 0.833 Test Loss: 0.425 Test Acc: 0.833
Validation loss decreased (-0.775357 --> -0.833329).  Saving model ...
Epoch: 7 cost time: 5.333312511444092
Epoch: 7, Steps: 9 | Train Loss: 0.285 Vali Loss: 0.361 Vali Acc: 0.877 Test Loss: 0.361 Test Acc: 0.877
Validation loss decreased (-0.833329 --> -0.876808).  Saving model ...
Epoch: 8 cost time: 5.012174844741821
Epoch: 8, Steps: 9 | Train Loss: 0.237 Vali Loss: 0.413 Vali Acc: 0.841 Test Loss: 0.413 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.114572763442993
Epoch: 9, Steps: 9 | Train Loss: 0.212 Vali Loss: 0.368 Vali Acc: 0.848 Test Loss: 0.368 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.147949695587158
Epoch: 10, Steps: 9 | Train Loss: 0.122 Vali Loss: 0.321 Vali Acc: 0.884 Test Loss: 0.321 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884055).  Saving model ...
Epoch: 11 cost time: 5.0358405113220215
Epoch: 11, Steps: 9 | Train Loss: 0.105 Vali Loss: 0.349 Vali Acc: 0.848 Test Loss: 0.349 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.004148483276367
Epoch: 12, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.396 Vali Acc: 0.862 Test Loss: 0.396 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.034321546554565
Epoch: 13, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.352 Vali Acc: 0.899 Test Loss: 0.352 Test Acc: 0.899
Validation loss decreased (-0.884055 --> -0.898547).  Saving model ...
Epoch: 14 cost time: 5.038862466812134
Epoch: 14, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.340 Vali Acc: 0.899 Test Loss: 0.340 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 15 cost time: 4.852099895477295
Epoch: 15, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.380 Vali Acc: 0.877 Test Loss: 0.380 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.160125970840454
Epoch: 16, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.401 Vali Acc: 0.884 Test Loss: 0.401 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.936645269393921
Epoch: 17, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.397 Vali Acc: 0.884 Test Loss: 0.397 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.576956272125244
Epoch: 18, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.399 Vali Acc: 0.870 Test Loss: 0.399 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.503132104873657
Epoch: 19, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.399 Vali Acc: 0.891 Test Loss: 0.399 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.367563247680664
Epoch: 20, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.406 Vali Acc: 0.891 Test Loss: 0.406 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.44099760055542
Epoch: 21, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.407 Vali Acc: 0.899 Test Loss: 0.407 Test Acc: 0.899
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.505938291549683
Epoch: 22, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.401 Vali Acc: 0.891 Test Loss: 0.401 Test Acc: 0.891
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.48759651184082
Epoch: 23, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.507 Vali Acc: 0.891 Test Loss: 0.507 Test Acc: 0.891
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 4.835144996643066
Epoch: 24, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.515 Vali Acc: 0.855 Test Loss: 0.515 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 3542948
model size : 14.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.7758800983428955
Epoch: 1, Steps: 9 | Train Loss: 1.367 Vali Loss: 1.257 Vali Acc: 0.486 Test Loss: 1.257 Test Acc: 0.486
Validation loss decreased (inf --> -0.485495).  Saving model ...
Epoch: 2 cost time: 2.8260958194732666
Epoch: 2, Steps: 9 | Train Loss: 1.189 Vali Loss: 1.067 Vali Acc: 0.652 Test Loss: 1.067 Test Acc: 0.652
Validation loss decreased (-0.485495 --> -0.652163).  Saving model ...
Epoch: 3 cost time: 2.8932464122772217
Epoch: 3, Steps: 9 | Train Loss: 0.957 Vali Loss: 0.887 Vali Acc: 0.725 Test Loss: 0.887 Test Acc: 0.725
Validation loss decreased (-0.652163 --> -0.724629).  Saving model ...
Epoch: 4 cost time: 2.8157427310943604
Epoch: 4, Steps: 9 | Train Loss: 0.756 Vali Loss: 0.738 Vali Acc: 0.775 Test Loss: 0.738 Test Acc: 0.775
Validation loss decreased (-0.724629 --> -0.775355).  Saving model ...
Epoch: 5 cost time: 2.8316760063171387
Epoch: 5, Steps: 9 | Train Loss: 0.578 Vali Loss: 0.606 Vali Acc: 0.783 Test Loss: 0.606 Test Acc: 0.783
Validation loss decreased (-0.775355 --> -0.782603).  Saving model ...
Epoch: 6 cost time: 2.840813159942627
Epoch: 6, Steps: 9 | Train Loss: 0.440 Vali Loss: 0.528 Vali Acc: 0.804 Test Loss: 0.528 Test Acc: 0.804
Validation loss decreased (-0.782603 --> -0.804343).  Saving model ...
Epoch: 7 cost time: 2.8936750888824463
Epoch: 7, Steps: 9 | Train Loss: 0.324 Vali Loss: 0.425 Vali Acc: 0.841 Test Loss: 0.425 Test Acc: 0.841
Validation loss decreased (-0.804343 --> -0.840575).  Saving model ...
Epoch: 8 cost time: 2.812434434890747
Epoch: 8, Steps: 9 | Train Loss: 0.217 Vali Loss: 0.371 Vali Acc: 0.862 Test Loss: 0.371 Test Acc: 0.862
Validation loss decreased (-0.840575 --> -0.862315).  Saving model ...
Epoch: 9 cost time: 2.8854727745056152
Epoch: 9, Steps: 9 | Train Loss: 0.167 Vali Loss: 0.412 Vali Acc: 0.833 Test Loss: 0.412 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.719822406768799
Epoch: 10, Steps: 9 | Train Loss: 0.107 Vali Loss: 0.398 Vali Acc: 0.833 Test Loss: 0.398 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.8679935932159424
Epoch: 11, Steps: 9 | Train Loss: 0.094 Vali Loss: 0.346 Vali Acc: 0.848 Test Loss: 0.346 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.6746764183044434
Epoch: 12, Steps: 9 | Train Loss: 0.408 Vali Loss: 0.426 Vali Acc: 0.833 Test Loss: 0.426 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.7703938484191895
Epoch: 13, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.363 Vali Acc: 0.855 Test Loss: 0.363 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.877812623977661
Epoch: 14, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.372 Vali Acc: 0.848 Test Loss: 0.372 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.707308053970337
Epoch: 15, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.388 Vali Acc: 0.848 Test Loss: 0.388 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.988229513168335
Epoch: 16, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.330 Vali Acc: 0.855 Test Loss: 0.330 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.5136725902557373
Epoch: 17, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.402 Vali Acc: 0.833 Test Loss: 0.402 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.391836404800415
Epoch: 18, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.427 Vali Acc: 0.833 Test Loss: 0.427 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 1060196
model size : 4.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.117006540298462
Epoch: 1, Steps: 9 | Train Loss: 1.390 Vali Loss: 1.293 Vali Acc: 0.370 Test Loss: 1.293 Test Acc: 0.370
Validation loss decreased (inf --> -0.369552).  Saving model ...
Epoch: 2 cost time: 2.8416736125946045
Epoch: 2, Steps: 9 | Train Loss: 1.241 Vali Loss: 1.133 Vali Acc: 0.551 Test Loss: 1.133 Test Acc: 0.551
Validation loss decreased (-0.369552 --> -0.550713).  Saving model ...
Epoch: 3 cost time: 3.4634249210357666
Epoch: 3, Steps: 9 | Train Loss: 1.015 Vali Loss: 0.963 Vali Acc: 0.645 Test Loss: 0.963 Test Acc: 0.645
Validation loss decreased (-0.550713 --> -0.644918).  Saving model ...
Epoch: 4 cost time: 3.360894203186035
Epoch: 4, Steps: 9 | Train Loss: 0.829 Vali Loss: 0.815 Vali Acc: 0.659 Test Loss: 0.815 Test Acc: 0.659
Validation loss decreased (-0.644918 --> -0.659412).  Saving model ...
Epoch: 5 cost time: 3.116849422454834
Epoch: 5, Steps: 9 | Train Loss: 0.618 Vali Loss: 0.687 Vali Acc: 0.717 Test Loss: 0.687 Test Acc: 0.717
Validation loss decreased (-0.659412 --> -0.717384).  Saving model ...
Epoch: 6 cost time: 3.259214162826538
Epoch: 6, Steps: 9 | Train Loss: 0.465 Vali Loss: 0.579 Vali Acc: 0.775 Test Loss: 0.579 Test Acc: 0.775
Validation loss decreased (-0.717384 --> -0.775357).  Saving model ...
Epoch: 7 cost time: 3.4512836933135986
Epoch: 7, Steps: 9 | Train Loss: 0.314 Vali Loss: 0.488 Vali Acc: 0.804 Test Loss: 0.488 Test Acc: 0.804
Validation loss decreased (-0.775357 --> -0.804343).  Saving model ...
Epoch: 8 cost time: 3.408047914505005
Epoch: 8, Steps: 9 | Train Loss: 0.259 Vali Loss: 0.462 Vali Acc: 0.797 Test Loss: 0.462 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.3397445678710938
Epoch: 9, Steps: 9 | Train Loss: 0.160 Vali Loss: 0.429 Vali Acc: 0.812 Test Loss: 0.429 Test Acc: 0.812
Validation loss decreased (-0.804343 --> -0.811590).  Saving model ...
Epoch: 10 cost time: 3.5099925994873047
Epoch: 10, Steps: 9 | Train Loss: 0.118 Vali Loss: 0.370 Vali Acc: 0.855 Test Loss: 0.370 Test Acc: 0.855
Validation loss decreased (-0.811590 --> -0.855069).  Saving model ...
Epoch: 11 cost time: 3.3861074447631836
Epoch: 11, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.371 Vali Acc: 0.848 Test Loss: 0.371 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.6571145057678223
Epoch: 12, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.527 Vali Acc: 0.819 Test Loss: 0.527 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.6510138511657715
Epoch: 13, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.531 Vali Acc: 0.819 Test Loss: 0.531 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.6143810749053955
Epoch: 14, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.345 Vali Acc: 0.906 Test Loss: 0.345 Test Acc: 0.906
Validation loss decreased (-0.855069 --> -0.905794).  Saving model ...
Epoch: 15 cost time: 3.575679302215576
Epoch: 15, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.421 Vali Acc: 0.877 Test Loss: 0.421 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.5425734519958496
Epoch: 16, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.430 Vali Acc: 0.884 Test Loss: 0.430 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.615250825881958
Epoch: 17, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.384 Vali Acc: 0.899 Test Loss: 0.384 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.6457767486572266
Epoch: 18, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.383 Vali Acc: 0.899 Test Loss: 0.383 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.701056480407715
Epoch: 19, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.432 Vali Acc: 0.884 Test Loss: 0.432 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.063903570175171
Epoch: 20, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.430 Vali Acc: 0.877 Test Loss: 0.430 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.222933769226074
Epoch: 21, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.676 Vali Acc: 0.841 Test Loss: 0.676 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.229900360107422
Epoch: 22, Steps: 9 | Train Loss: 0.154 Vali Loss: 0.366 Vali Acc: 0.899 Test Loss: 0.366 Test Acc: 0.899
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.1236085891723633
Epoch: 23, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.636 Vali Acc: 0.826 Test Loss: 0.636 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.2423577308654785
Epoch: 24, Steps: 9 | Train Loss: 0.147 Vali Loss: 0.832 Vali Acc: 0.826 Test Loss: 0.832 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 3542948
model size : 14.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.240867853164673
Epoch: 1, Steps: 9 | Train Loss: 1.372 Vali Loss: 1.271 Vali Acc: 0.457 Test Loss: 1.271 Test Acc: 0.457
Validation loss decreased (inf --> -0.456509).  Saving model ...
Epoch: 2 cost time: 2.363889455795288
Epoch: 2, Steps: 9 | Train Loss: 1.196 Vali Loss: 1.104 Vali Acc: 0.616 Test Loss: 1.104 Test Acc: 0.616
Validation loss decreased (-0.456509 --> -0.615931).  Saving model ...
Epoch: 3 cost time: 2.224271297454834
Epoch: 3, Steps: 9 | Train Loss: 0.980 Vali Loss: 0.944 Vali Acc: 0.674 Test Loss: 0.944 Test Acc: 0.674
Validation loss decreased (-0.615931 --> -0.673904).  Saving model ...
Epoch: 4 cost time: 2.3353431224823
Epoch: 4, Steps: 9 | Train Loss: 0.790 Vali Loss: 0.823 Vali Acc: 0.710 Test Loss: 0.823 Test Acc: 0.710
Validation loss decreased (-0.673904 --> -0.710137).  Saving model ...
Epoch: 5 cost time: 2.2381017208099365
Epoch: 5, Steps: 9 | Train Loss: 0.650 Vali Loss: 0.737 Vali Acc: 0.703 Test Loss: 0.737 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.2166571617126465
Epoch: 6, Steps: 9 | Train Loss: 0.531 Vali Loss: 0.676 Vali Acc: 0.725 Test Loss: 0.676 Test Acc: 0.725
Validation loss decreased (-0.710137 --> -0.724631).  Saving model ...
Epoch: 7 cost time: 2.310845375061035
Epoch: 7, Steps: 9 | Train Loss: 0.396 Vali Loss: 0.553 Vali Acc: 0.775 Test Loss: 0.553 Test Acc: 0.775
Validation loss decreased (-0.724631 --> -0.775357).  Saving model ...
Epoch: 8 cost time: 2.2775204181671143
Epoch: 8, Steps: 9 | Train Loss: 0.308 Vali Loss: 0.514 Vali Acc: 0.775 Test Loss: 0.514 Test Acc: 0.775
Validation loss decreased (-0.775357 --> -0.775357).  Saving model ...
Epoch: 9 cost time: 2.304940938949585
Epoch: 9, Steps: 9 | Train Loss: 0.202 Vali Loss: 0.517 Vali Acc: 0.783 Test Loss: 0.517 Test Acc: 0.783
Validation loss decreased (-0.775357 --> -0.782604).  Saving model ...
Epoch: 10 cost time: 1.9516682624816895
Epoch: 10, Steps: 9 | Train Loss: 0.142 Vali Loss: 0.487 Vali Acc: 0.775 Test Loss: 0.487 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.355445146560669
Epoch: 11, Steps: 9 | Train Loss: 0.106 Vali Loss: 0.438 Vali Acc: 0.812 Test Loss: 0.438 Test Acc: 0.812
Validation loss decreased (-0.782604 --> -0.811590).  Saving model ...
Epoch: 12 cost time: 2.1150949001312256
Epoch: 12, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.485 Vali Acc: 0.804 Test Loss: 0.485 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.267165422439575
Epoch: 13, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.439 Vali Acc: 0.826 Test Loss: 0.439 Test Acc: 0.826
Validation loss decreased (-0.811590 --> -0.826083).  Saving model ...
Epoch: 14 cost time: 2.3676676750183105
Epoch: 14, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.423 Vali Acc: 0.841 Test Loss: 0.423 Test Acc: 0.841
Validation loss decreased (-0.826083 --> -0.840575).  Saving model ...
Epoch: 15 cost time: 2.2931346893310547
Epoch: 15, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.413 Vali Acc: 0.855 Test Loss: 0.413 Test Acc: 0.855
Validation loss decreased (-0.840575 --> -0.855068).  Saving model ...
Epoch: 16 cost time: 2.019761323928833
Epoch: 16, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.411 Vali Acc: 0.855 Test Loss: 0.411 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 17 cost time: 2.0284862518310547
Epoch: 17, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.414 Vali Acc: 0.848 Test Loss: 0.414 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.0745177268981934
Epoch: 18, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.385 Vali Acc: 0.870 Test Loss: 0.385 Test Acc: 0.870
Validation loss decreased (-0.855068 --> -0.869561).  Saving model ...
Epoch: 19 cost time: 2.2093451023101807
Epoch: 19, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.399 Vali Acc: 0.855 Test Loss: 0.399 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.1930391788482666
Epoch: 20, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.519 Vali Acc: 0.826 Test Loss: 0.519 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.1356513500213623
Epoch: 21, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.435 Vali Acc: 0.841 Test Loss: 0.435 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.1035664081573486
Epoch: 22, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.462 Vali Acc: 0.848 Test Loss: 0.462 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.1155102252960205
Epoch: 23, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.535 Vali Acc: 0.848 Test Loss: 0.535 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.329465627670288
Epoch: 24, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.749 Vali Acc: 0.797 Test Loss: 0.749 Test Acc: 0.797
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.348186731338501
Epoch: 25, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.571 Vali Acc: 0.826 Test Loss: 0.571 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.315537452697754
Epoch: 26, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.525 Vali Acc: 0.841 Test Loss: 0.525 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.3296399116516113
Epoch: 27, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.573 Vali Acc: 0.826 Test Loss: 0.573 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.4010732173919678
Epoch: 28, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.611 Vali Acc: 0.826 Test Loss: 0.611 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 1060196
model size : 4.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 6.4888014793396
Epoch: 1, Steps: 9 | Train Loss: 1.401 Vali Loss: 1.301 Vali Acc: 0.428 Test Loss: 1.301 Test Acc: 0.428
Validation loss decreased (inf --> -0.427523).  Saving model ...
Epoch: 2 cost time: 4.12239146232605
Epoch: 2, Steps: 9 | Train Loss: 1.179 Vali Loss: 1.039 Vali Acc: 0.667 Test Loss: 1.039 Test Acc: 0.667
Validation loss decreased (-0.427523 --> -0.666656).  Saving model ...
Epoch: 3 cost time: 4.309990644454956
Epoch: 3, Steps: 9 | Train Loss: 0.895 Vali Loss: 0.798 Vali Acc: 0.746 Test Loss: 0.798 Test Acc: 0.746
Validation loss decreased (-0.666656 --> -0.746369).  Saving model ...
Epoch: 4 cost time: 4.4036877155303955
Epoch: 4, Steps: 9 | Train Loss: 0.686 Vali Loss: 0.627 Vali Acc: 0.783 Test Loss: 0.627 Test Acc: 0.783
Validation loss decreased (-0.746369 --> -0.782602).  Saving model ...
Epoch: 5 cost time: 4.318410396575928
Epoch: 5, Steps: 9 | Train Loss: 0.485 Vali Loss: 0.500 Vali Acc: 0.819 Test Loss: 0.500 Test Acc: 0.819
Validation loss decreased (-0.782602 --> -0.818836).  Saving model ...
Epoch: 6 cost time: 3.8601317405700684
Epoch: 6, Steps: 9 | Train Loss: 0.333 Vali Loss: 0.456 Vali Acc: 0.826 Test Loss: 0.456 Test Acc: 0.826
Validation loss decreased (-0.818836 --> -0.826082).  Saving model ...
Epoch: 7 cost time: 3.910017251968384
Epoch: 7, Steps: 9 | Train Loss: 0.359 Vali Loss: 0.412 Vali Acc: 0.826 Test Loss: 0.412 Test Acc: 0.826
Validation loss decreased (-0.826082 --> -0.826083).  Saving model ...
Epoch: 8 cost time: 3.893126964569092
Epoch: 8, Steps: 9 | Train Loss: 0.234 Vali Loss: 0.357 Vali Acc: 0.870 Test Loss: 0.357 Test Acc: 0.870
Validation loss decreased (-0.826083 --> -0.869562).  Saving model ...
Epoch: 9 cost time: 3.927335500717163
Epoch: 9, Steps: 9 | Train Loss: 0.173 Vali Loss: 0.432 Vali Acc: 0.848 Test Loss: 0.432 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.199994802474976
Epoch: 10, Steps: 9 | Train Loss: 0.154 Vali Loss: 0.440 Vali Acc: 0.855 Test Loss: 0.440 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.052536964416504
Epoch: 11, Steps: 9 | Train Loss: 0.107 Vali Loss: 0.409 Vali Acc: 0.848 Test Loss: 0.409 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.524352550506592
Epoch: 12, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.412 Vali Acc: 0.862 Test Loss: 0.412 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.632263660430908
Epoch: 13, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.401 Vali Acc: 0.877 Test Loss: 0.401 Test Acc: 0.877
Validation loss decreased (-0.869562 --> -0.876808).  Saving model ...
Epoch: 14 cost time: 3.4180245399475098
Epoch: 14, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.412 Vali Acc: 0.877 Test Loss: 0.412 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.228055715560913
Epoch: 15, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.403 Vali Acc: 0.884 Test Loss: 0.403 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884054).  Saving model ...
Epoch: 16 cost time: 4.127902984619141
Epoch: 16, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.373 Vali Acc: 0.884 Test Loss: 0.373 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 17 cost time: 4.29140830039978
Epoch: 17, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.442 Vali Acc: 0.855 Test Loss: 0.442 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.385465860366821
Epoch: 18, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.476 Vali Acc: 0.841 Test Loss: 0.476 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.474748611450195
Epoch: 19, Steps: 9 | Train Loss: 0.151 Vali Loss: 0.368 Vali Acc: 0.884 Test Loss: 0.368 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 20 cost time: 4.400086164474487
Epoch: 20, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.313 Vali Acc: 0.906 Test Loss: 0.313 Test Acc: 0.906
Validation loss decreased (-0.884054 --> -0.905794).  Saving model ...
Epoch: 21 cost time: 4.559491157531738
Epoch: 21, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.437 Vali Acc: 0.870 Test Loss: 0.437 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.259030103683472
Epoch: 22, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.466 Vali Acc: 0.870 Test Loss: 0.466 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.211766481399536
Epoch: 23, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.408 Vali Acc: 0.877 Test Loss: 0.408 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.271172046661377
Epoch: 24, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.397 Vali Acc: 0.884 Test Loss: 0.397 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 4.0651445388793945
Epoch: 25, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.438 Vali Acc: 0.884 Test Loss: 0.438 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.004029035568237
Epoch: 26, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.478 Vali Acc: 0.877 Test Loss: 0.478 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.569404363632202
Epoch: 27, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.500 Vali Acc: 0.862 Test Loss: 0.500 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.9681742191314697
Epoch: 28, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.491 Vali Acc: 0.862 Test Loss: 0.491 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.9688713550567627
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.469 Vali Acc: 0.884 Test Loss: 0.469 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 4.021860599517822
Epoch: 30, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.465 Vali Acc: 0.884 Test Loss: 0.465 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 1785188
model size : 7.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.046133279800415
Epoch: 1, Steps: 9 | Train Loss: 1.374 Vali Loss: 1.374 Vali Acc: 0.290 Test Loss: 1.374 Test Acc: 0.290
Validation loss decreased (inf --> -0.289841).  Saving model ...
Epoch: 2 cost time: 2.99544358253479
Epoch: 2, Steps: 9 | Train Loss: 1.211 Vali Loss: 1.144 Vali Acc: 0.493 Test Loss: 1.144 Test Acc: 0.493
Validation loss decreased (-0.289841 --> -0.492742).  Saving model ...
Epoch: 3 cost time: 3.13014817237854
Epoch: 3, Steps: 9 | Train Loss: 0.925 Vali Loss: 0.901 Vali Acc: 0.710 Test Loss: 0.901 Test Acc: 0.710
Validation loss decreased (-0.492742 --> -0.710136).  Saving model ...
Epoch: 4 cost time: 2.81133770942688
Epoch: 4, Steps: 9 | Train Loss: 0.662 Vali Loss: 0.667 Vali Acc: 0.768 Test Loss: 0.667 Test Acc: 0.768
Validation loss decreased (-0.710136 --> -0.768109).  Saving model ...
Epoch: 5 cost time: 2.9233736991882324
Epoch: 5, Steps: 9 | Train Loss: 0.544 Vali Loss: 0.482 Vali Acc: 0.812 Test Loss: 0.482 Test Acc: 0.812
Validation loss decreased (-0.768109 --> -0.811589).  Saving model ...
Epoch: 6 cost time: 2.825068712234497
Epoch: 6, Steps: 9 | Train Loss: 0.356 Vali Loss: 0.412 Vali Acc: 0.833 Test Loss: 0.412 Test Acc: 0.833
Validation loss decreased (-0.811589 --> -0.833329).  Saving model ...
Epoch: 7 cost time: 2.8487696647644043
Epoch: 7, Steps: 9 | Train Loss: 0.322 Vali Loss: 0.419 Vali Acc: 0.826 Test Loss: 0.419 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.92590594291687
Epoch: 8, Steps: 9 | Train Loss: 0.259 Vali Loss: 0.413 Vali Acc: 0.862 Test Loss: 0.413 Test Acc: 0.862
Validation loss decreased (-0.833329 --> -0.862315).  Saving model ...
Epoch: 9 cost time: 2.914193868637085
Epoch: 9, Steps: 9 | Train Loss: 0.191 Vali Loss: 0.337 Vali Acc: 0.862 Test Loss: 0.337 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 10 cost time: 2.9022817611694336
Epoch: 10, Steps: 9 | Train Loss: 0.141 Vali Loss: 0.367 Vali Acc: 0.877 Test Loss: 0.367 Test Acc: 0.877
Validation loss decreased (-0.862315 --> -0.876808).  Saving model ...
Epoch: 11 cost time: 3.079652786254883
Epoch: 11, Steps: 9 | Train Loss: 0.112 Vali Loss: 0.385 Vali Acc: 0.870 Test Loss: 0.385 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.086517572402954
Epoch: 12, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.304 Vali Acc: 0.906 Test Loss: 0.304 Test Acc: 0.906
Validation loss decreased (-0.876808 --> -0.905794).  Saving model ...
Epoch: 13 cost time: 2.8135833740234375
Epoch: 13, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.328 Vali Acc: 0.877 Test Loss: 0.328 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.720745086669922
Epoch: 14, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.358 Vali Acc: 0.877 Test Loss: 0.358 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.787824869155884
Epoch: 15, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.360 Vali Acc: 0.877 Test Loss: 0.360 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.786180257797241
Epoch: 16, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.316 Vali Acc: 0.899 Test Loss: 0.316 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.821936845779419
Epoch: 17, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.291 Vali Acc: 0.913 Test Loss: 0.291 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913041).  Saving model ...
Epoch: 18 cost time: 3.0267298221588135
Epoch: 18, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.293 Vali Acc: 0.913 Test Loss: 0.293 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.0992677211761475
Epoch: 19, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.333 Vali Acc: 0.891 Test Loss: 0.333 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.885423421859741
Epoch: 20, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.319 Vali Acc: 0.906 Test Loss: 0.319 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.7660892009735107
Epoch: 21, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.309 Vali Acc: 0.906 Test Loss: 0.309 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.7056941986083984
Epoch: 22, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.347 Vali Acc: 0.899 Test Loss: 0.347 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.572175979614258
Epoch: 23, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.376 Vali Acc: 0.891 Test Loss: 0.376 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.636038303375244
Epoch: 24, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.379 Vali Acc: 0.899 Test Loss: 0.379 Test Acc: 0.899
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.291926145553589
Epoch: 25, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.348 Vali Acc: 0.899 Test Loss: 0.348 Test Acc: 0.899
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.8107423782348633
Epoch: 26, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.332 Vali Acc: 0.906 Test Loss: 0.332 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.850884437561035
Epoch: 27, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.302 Vali Acc: 0.913 Test Loss: 0.302 Test Acc: 0.913
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 543716
model size : 2.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.751702785491943
Epoch: 1, Steps: 9 | Train Loss: 1.400 Vali Loss: 1.299 Vali Acc: 0.428 Test Loss: 1.299 Test Acc: 0.428
Validation loss decreased (inf --> -0.427523).  Saving model ...
Epoch: 2 cost time: 3.6310367584228516
Epoch: 2, Steps: 9 | Train Loss: 1.192 Vali Loss: 1.052 Vali Acc: 0.645 Test Loss: 1.052 Test Acc: 0.645
Validation loss decreased (-0.427523 --> -0.644917).  Saving model ...
Epoch: 3 cost time: 3.390015125274658
Epoch: 3, Steps: 9 | Train Loss: 0.949 Vali Loss: 0.848 Vali Acc: 0.732 Test Loss: 0.848 Test Acc: 0.732
Validation loss decreased (-0.644917 --> -0.731876).  Saving model ...
Epoch: 4 cost time: 3.0466573238372803
Epoch: 4, Steps: 9 | Train Loss: 0.761 Vali Loss: 0.708 Vali Acc: 0.761 Test Loss: 0.708 Test Acc: 0.761
Validation loss decreased (-0.731876 --> -0.760862).  Saving model ...
Epoch: 5 cost time: 3.200282335281372
Epoch: 5, Steps: 9 | Train Loss: 0.571 Vali Loss: 0.563 Vali Acc: 0.797 Test Loss: 0.563 Test Acc: 0.797
Validation loss decreased (-0.760862 --> -0.797096).  Saving model ...
Epoch: 6 cost time: 3.2202341556549072
Epoch: 6, Steps: 9 | Train Loss: 0.417 Vali Loss: 0.468 Vali Acc: 0.826 Test Loss: 0.468 Test Acc: 0.826
Validation loss decreased (-0.797096 --> -0.826082).  Saving model ...
Epoch: 7 cost time: 3.3006832599639893
Epoch: 7, Steps: 9 | Train Loss: 0.455 Vali Loss: 0.410 Vali Acc: 0.833 Test Loss: 0.410 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833329).  Saving model ...
Epoch: 8 cost time: 3.3046305179595947
Epoch: 8, Steps: 9 | Train Loss: 0.275 Vali Loss: 0.378 Vali Acc: 0.862 Test Loss: 0.378 Test Acc: 0.862
Validation loss decreased (-0.833329 --> -0.862315).  Saving model ...
Epoch: 9 cost time: 3.299015522003174
Epoch: 9, Steps: 9 | Train Loss: 0.393 Vali Loss: 0.389 Vali Acc: 0.855 Test Loss: 0.389 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.79673433303833
Epoch: 10, Steps: 9 | Train Loss: 0.149 Vali Loss: 0.341 Vali Acc: 0.870 Test Loss: 0.341 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869562).  Saving model ...
Epoch: 11 cost time: 3.533632516860962
Epoch: 11, Steps: 9 | Train Loss: 0.106 Vali Loss: 0.370 Vali Acc: 0.862 Test Loss: 0.370 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.549081802368164
Epoch: 12, Steps: 9 | Train Loss: 0.179 Vali Loss: 0.412 Vali Acc: 0.841 Test Loss: 0.412 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.694735288619995
Epoch: 13, Steps: 9 | Train Loss: 0.104 Vali Loss: 0.360 Vali Acc: 0.855 Test Loss: 0.360 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.404371500015259
Epoch: 14, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.402 Vali Acc: 0.848 Test Loss: 0.402 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.331951141357422
Epoch: 15, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.404 Vali Acc: 0.870 Test Loss: 0.404 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.352893590927124
Epoch: 16, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.384 Vali Acc: 0.877 Test Loss: 0.384 Test Acc: 0.877
Validation loss decreased (-0.869562 --> -0.876808).  Saving model ...
Epoch: 17 cost time: 3.784302234649658
Epoch: 17, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.391 Vali Acc: 0.870 Test Loss: 0.391 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.968102216720581
Epoch: 18, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.339 Vali Acc: 0.877 Test Loss: 0.339 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 19 cost time: 3.682804822921753
Epoch: 19, Steps: 9 | Train Loss: 0.102 Vali Loss: 0.393 Vali Acc: 0.891 Test Loss: 0.393 Test Acc: 0.891
Validation loss decreased (-0.876808 --> -0.891300).  Saving model ...
Epoch: 20 cost time: 3.718820810317993
Epoch: 20, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.435 Vali Acc: 0.877 Test Loss: 0.435 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.691284418106079
Epoch: 21, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.430 Vali Acc: 0.870 Test Loss: 0.430 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.687324285507202
Epoch: 22, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.424 Vali Acc: 0.862 Test Loss: 0.424 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.6014959812164307
Epoch: 23, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.405 Vali Acc: 0.877 Test Loss: 0.405 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.819385528564453
Epoch: 24, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.390 Vali Acc: 0.891 Test Loss: 0.390 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891300).  Saving model ...
Epoch: 25 cost time: 3.70680832862854
Epoch: 25, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.400 Vali Acc: 0.877 Test Loss: 0.400 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.8235063552856445
Epoch: 26, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.503 Vali Acc: 0.855 Test Loss: 0.503 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.6522715091705322
Epoch: 27, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.490 Vali Acc: 0.862 Test Loss: 0.490 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.9010815620422363
Epoch: 28, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.507 Vali Acc: 0.870 Test Loss: 0.507 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.369508981704712
Epoch: 29, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.456 Vali Acc: 0.870 Test Loss: 0.456 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.350337505340576
Epoch: 30, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.436 Vali Acc: 0.877 Test Loss: 0.436 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 1785188
model size : 7.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.210651159286499
Epoch: 1, Steps: 9 | Train Loss: 1.387 Vali Loss: 1.371 Vali Acc: 0.290 Test Loss: 1.371 Test Acc: 0.290
Validation loss decreased (inf --> -0.289841).  Saving model ...
Epoch: 2 cost time: 2.281146287918091
Epoch: 2, Steps: 9 | Train Loss: 1.236 Vali Loss: 1.166 Vali Acc: 0.464 Test Loss: 1.166 Test Acc: 0.464
Validation loss decreased (-0.289841 --> -0.463756).  Saving model ...
Epoch: 3 cost time: 2.3081629276275635
Epoch: 3, Steps: 9 | Train Loss: 0.973 Vali Loss: 0.965 Vali Acc: 0.645 Test Loss: 0.965 Test Acc: 0.645
Validation loss decreased (-0.463756 --> -0.644918).  Saving model ...
Epoch: 4 cost time: 2.1555819511413574
Epoch: 4, Steps: 9 | Train Loss: 0.750 Vali Loss: 0.775 Vali Acc: 0.754 Test Loss: 0.775 Test Acc: 0.754
Validation loss decreased (-0.644918 --> -0.753615).  Saving model ...
Epoch: 5 cost time: 2.43446683883667
Epoch: 5, Steps: 9 | Train Loss: 0.613 Vali Loss: 0.583 Vali Acc: 0.790 Test Loss: 0.583 Test Acc: 0.790
Validation loss decreased (-0.753615 --> -0.789849).  Saving model ...
Epoch: 6 cost time: 2.710111618041992
Epoch: 6, Steps: 9 | Train Loss: 0.485 Vali Loss: 0.474 Vali Acc: 0.826 Test Loss: 0.474 Test Acc: 0.826
Validation loss decreased (-0.789849 --> -0.826082).  Saving model ...
Epoch: 7 cost time: 2.6419849395751953
Epoch: 7, Steps: 9 | Train Loss: 0.317 Vali Loss: 0.421 Vali Acc: 0.826 Test Loss: 0.421 Test Acc: 0.826
Validation loss decreased (-0.826082 --> -0.826083).  Saving model ...
Epoch: 8 cost time: 2.3182578086853027
Epoch: 8, Steps: 9 | Train Loss: 0.301 Vali Loss: 0.405 Vali Acc: 0.877 Test Loss: 0.405 Test Acc: 0.877
Validation loss decreased (-0.826083 --> -0.876808).  Saving model ...
Epoch: 9 cost time: 2.4585981369018555
Epoch: 9, Steps: 9 | Train Loss: 0.244 Vali Loss: 0.382 Vali Acc: 0.848 Test Loss: 0.382 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.4240849018096924
Epoch: 10, Steps: 9 | Train Loss: 0.140 Vali Loss: 0.380 Vali Acc: 0.870 Test Loss: 0.380 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.537799835205078
Epoch: 11, Steps: 9 | Train Loss: 0.110 Vali Loss: 0.348 Vali Acc: 0.884 Test Loss: 0.348 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884054).  Saving model ...
Epoch: 12 cost time: 2.4405112266540527
Epoch: 12, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.305 Vali Acc: 0.891 Test Loss: 0.305 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891301).  Saving model ...
Epoch: 13 cost time: 2.4895782470703125
Epoch: 13, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.321 Vali Acc: 0.877 Test Loss: 0.321 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.2927706241607666
Epoch: 14, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.329 Vali Acc: 0.884 Test Loss: 0.329 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.27921462059021
Epoch: 15, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.323 Vali Acc: 0.906 Test Loss: 0.323 Test Acc: 0.906
Validation loss decreased (-0.891301 --> -0.905794).  Saving model ...
Epoch: 16 cost time: 2.3621301651000977
Epoch: 16, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.303 Vali Acc: 0.906 Test Loss: 0.303 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 17 cost time: 2.3301076889038086
Epoch: 17, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.306 Vali Acc: 0.884 Test Loss: 0.306 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.350213050842285
Epoch: 18, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.307 Vali Acc: 0.899 Test Loss: 0.307 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.384174346923828
Epoch: 19, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.324 Vali Acc: 0.906 Test Loss: 0.324 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.25183367729187
Epoch: 20, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.306 Vali Acc: 0.913 Test Loss: 0.306 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913040).  Saving model ...
Epoch: 21 cost time: 2.4366185665130615
Epoch: 21, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.290 Vali Acc: 0.913 Test Loss: 0.290 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913041).  Saving model ...
Epoch: 22 cost time: 2.4457948207855225
Epoch: 22, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.289 Vali Acc: 0.913 Test Loss: 0.289 Test Acc: 0.913
Validation loss decreased (-0.913041 --> -0.913041).  Saving model ...
Epoch: 23 cost time: 2.509805202484131
Epoch: 23, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.301 Vali Acc: 0.920 Test Loss: 0.301 Test Acc: 0.920
Validation loss decreased (-0.913041 --> -0.920287).  Saving model ...
Epoch: 24 cost time: 2.3370800018310547
Epoch: 24, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.312 Vali Acc: 0.906 Test Loss: 0.312 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.3808481693267822
Epoch: 25, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.292 Vali Acc: 0.920 Test Loss: 0.292 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 26 cost time: 2.3117589950561523
Epoch: 26, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.285 Vali Acc: 0.920 Test Loss: 0.285 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 27 cost time: 1.8268322944641113
Epoch: 27, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.275 Vali Acc: 0.920 Test Loss: 0.275 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 28 cost time: 1.750291109085083
Epoch: 28, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.280 Vali Acc: 0.920 Test Loss: 0.280 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.2721710205078125
Epoch: 29, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.273 Vali Acc: 0.913 Test Loss: 0.273 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.185865879058838
Epoch: 30, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.275 Vali Acc: 0.920 Test Loss: 0.275 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 543716
model size : 2.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.792157173156738
Epoch: 1, Steps: 9 | Train Loss: 1.399 Vali Loss: 1.304 Vali Acc: 0.399 Test Loss: 1.304 Test Acc: 0.399
Validation loss decreased (inf --> -0.398538).  Saving model ...
Epoch: 2 cost time: 2.8946995735168457
Epoch: 2, Steps: 9 | Train Loss: 1.203 Vali Loss: 1.105 Vali Acc: 0.580 Test Loss: 1.105 Test Acc: 0.580
Validation loss decreased (-0.398538 --> -0.579699).  Saving model ...
Epoch: 3 cost time: 2.796511173248291
Epoch: 3, Steps: 9 | Train Loss: 0.983 Vali Loss: 0.951 Vali Acc: 0.659 Test Loss: 0.951 Test Acc: 0.659
Validation loss decreased (-0.579699 --> -0.659411).  Saving model ...
Epoch: 4 cost time: 2.5330634117126465
Epoch: 4, Steps: 9 | Train Loss: 0.800 Vali Loss: 0.842 Vali Acc: 0.681 Test Loss: 0.842 Test Acc: 0.681
Validation loss decreased (-0.659411 --> -0.681151).  Saving model ...
Epoch: 5 cost time: 2.1529908180236816
Epoch: 5, Steps: 9 | Train Loss: 0.657 Vali Loss: 0.720 Vali Acc: 0.754 Test Loss: 0.720 Test Acc: 0.754
Validation loss decreased (-0.681151 --> -0.753616).  Saving model ...
Epoch: 6 cost time: 2.5614988803863525
Epoch: 6, Steps: 9 | Train Loss: 0.521 Vali Loss: 0.638 Vali Acc: 0.754 Test Loss: 0.638 Test Acc: 0.754
Validation loss decreased (-0.753616 --> -0.753617).  Saving model ...
Epoch: 7 cost time: 2.3677968978881836
Epoch: 7, Steps: 9 | Train Loss: 0.403 Vali Loss: 0.556 Vali Acc: 0.783 Test Loss: 0.556 Test Acc: 0.783
Validation loss decreased (-0.753617 --> -0.782603).  Saving model ...
Epoch: 8 cost time: 2.5702173709869385
Epoch: 8, Steps: 9 | Train Loss: 0.315 Vali Loss: 0.488 Vali Acc: 0.790 Test Loss: 0.488 Test Acc: 0.790
Validation loss decreased (-0.782603 --> -0.789850).  Saving model ...
Epoch: 9 cost time: 2.537943124771118
Epoch: 9, Steps: 9 | Train Loss: 0.231 Vali Loss: 0.426 Vali Acc: 0.848 Test Loss: 0.426 Test Acc: 0.848
Validation loss decreased (-0.789850 --> -0.847822).  Saving model ...
Epoch: 10 cost time: 2.506270170211792
Epoch: 10, Steps: 9 | Train Loss: 0.164 Vali Loss: 0.400 Vali Acc: 0.855 Test Loss: 0.400 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855068).  Saving model ...
Epoch: 11 cost time: 2.5887606143951416
Epoch: 11, Steps: 9 | Train Loss: 0.113 Vali Loss: 0.575 Vali Acc: 0.797 Test Loss: 0.575 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.7967145442962646
Epoch: 12, Steps: 9 | Train Loss: 0.160 Vali Loss: 0.612 Vali Acc: 0.804 Test Loss: 0.612 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.497635841369629
Epoch: 13, Steps: 9 | Train Loss: 0.080 Vali Loss: 0.676 Vali Acc: 0.732 Test Loss: 0.676 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.305736541748047
Epoch: 14, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.710 Vali Acc: 0.732 Test Loss: 0.710 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.6609156131744385
Epoch: 15, Steps: 9 | Train Loss: 0.118 Vali Loss: 0.367 Vali Acc: 0.862 Test Loss: 0.367 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862315).  Saving model ...
Epoch: 16 cost time: 2.660498857498169
Epoch: 16, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.421 Vali Acc: 0.862 Test Loss: 0.421 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.681098222732544
Epoch: 17, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.475 Vali Acc: 0.848 Test Loss: 0.475 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.2401654720306396
Epoch: 18, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.424 Vali Acc: 0.855 Test Loss: 0.424 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.5448787212371826
Epoch: 19, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.416 Vali Acc: 0.855 Test Loss: 0.416 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.6455540657043457
Epoch: 20, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.409 Vali Acc: 0.855 Test Loss: 0.409 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.5644845962524414
Epoch: 21, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.417 Vali Acc: 0.855 Test Loss: 0.417 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.694568157196045
Epoch: 22, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.413 Vali Acc: 0.862 Test Loss: 0.413 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.62038254737854
Epoch: 23, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.395 Vali Acc: 0.862 Test Loss: 0.395 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.7179007530212402
Epoch: 24, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.384 Vali Acc: 0.870 Test Loss: 0.384 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869561).  Saving model ...
Epoch: 25 cost time: 2.5596745014190674
Epoch: 25, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.386 Vali Acc: 0.870 Test Loss: 0.386 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.6532886028289795
Epoch: 26, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.389 Vali Acc: 0.891 Test Loss: 0.389 Test Acc: 0.891
Validation loss decreased (-0.869561 --> -0.891300).  Saving model ...
Epoch: 27 cost time: 2.652428150177002
Epoch: 27, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.448 Vali Acc: 0.862 Test Loss: 0.448 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.525482177734375
Epoch: 28, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.429 Vali Acc: 0.877 Test Loss: 0.429 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.530517339706421
Epoch: 29, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.420 Vali Acc: 0.884 Test Loss: 0.420 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.552215099334717
Epoch: 30, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.395 Vali Acc: 0.884 Test Loss: 0.395 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 1785188
model size : 7.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.5119218826293945
Epoch: 1, Steps: 9 | Train Loss: 1.396 Vali Loss: 1.369 Vali Acc: 0.268 Test Loss: 1.369 Test Acc: 0.268
Validation loss decreased (inf --> -0.268102).  Saving model ...
Epoch: 2 cost time: 1.6627798080444336
Epoch: 2, Steps: 9 | Train Loss: 1.250 Vali Loss: 1.196 Vali Acc: 0.406 Test Loss: 1.196 Test Acc: 0.406
Validation loss decreased (-0.268102 --> -0.405785).  Saving model ...
Epoch: 3 cost time: 1.7248518466949463
Epoch: 3, Steps: 9 | Train Loss: 0.998 Vali Loss: 1.039 Vali Acc: 0.536 Test Loss: 1.039 Test Acc: 0.536
Validation loss decreased (-0.405785 --> -0.536221).  Saving model ...
Epoch: 4 cost time: 1.6002202033996582
Epoch: 4, Steps: 9 | Train Loss: 0.804 Vali Loss: 0.907 Vali Acc: 0.572 Test Loss: 0.907 Test Acc: 0.572
Validation loss decreased (-0.536221 --> -0.572455).  Saving model ...
Epoch: 5 cost time: 1.6727113723754883
Epoch: 5, Steps: 9 | Train Loss: 0.675 Vali Loss: 0.781 Vali Acc: 0.717 Test Loss: 0.781 Test Acc: 0.717
Validation loss decreased (-0.572455 --> -0.717383).  Saving model ...
Epoch: 6 cost time: 1.8827075958251953
Epoch: 6, Steps: 9 | Train Loss: 0.527 Vali Loss: 0.685 Vali Acc: 0.754 Test Loss: 0.685 Test Acc: 0.754
Validation loss decreased (-0.717383 --> -0.753616).  Saving model ...
Epoch: 7 cost time: 1.7339880466461182
Epoch: 7, Steps: 9 | Train Loss: 0.411 Vali Loss: 0.586 Vali Acc: 0.790 Test Loss: 0.586 Test Acc: 0.790
Validation loss decreased (-0.753616 --> -0.789849).  Saving model ...
Epoch: 8 cost time: 1.7602672576904297
Epoch: 8, Steps: 9 | Train Loss: 0.315 Vali Loss: 0.514 Vali Acc: 0.819 Test Loss: 0.514 Test Acc: 0.819
Validation loss decreased (-0.789849 --> -0.818835).  Saving model ...
Epoch: 9 cost time: 1.7876131534576416
Epoch: 9, Steps: 9 | Train Loss: 0.214 Vali Loss: 0.439 Vali Acc: 0.819 Test Loss: 0.439 Test Acc: 0.819
Validation loss decreased (-0.818835 --> -0.818836).  Saving model ...
Epoch: 10 cost time: 1.8183674812316895
Epoch: 10, Steps: 9 | Train Loss: 0.149 Vali Loss: 0.435 Vali Acc: 0.841 Test Loss: 0.435 Test Acc: 0.841
Validation loss decreased (-0.818836 --> -0.840575).  Saving model ...
Epoch: 11 cost time: 1.7742187976837158
Epoch: 11, Steps: 9 | Train Loss: 0.108 Vali Loss: 0.396 Vali Acc: 0.862 Test Loss: 0.396 Test Acc: 0.862
Validation loss decreased (-0.840575 --> -0.862315).  Saving model ...
Epoch: 12 cost time: 1.8922410011291504
Epoch: 12, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.349 Vali Acc: 0.870 Test Loss: 0.349 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869562).  Saving model ...
Epoch: 13 cost time: 1.8180615901947021
Epoch: 13, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.345 Vali Acc: 0.877 Test Loss: 0.345 Test Acc: 0.877
Validation loss decreased (-0.869562 --> -0.876808).  Saving model ...
Epoch: 14 cost time: 1.7724013328552246
Epoch: 14, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.341 Vali Acc: 0.884 Test Loss: 0.341 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884055).  Saving model ...
Epoch: 15 cost time: 1.7383394241333008
Epoch: 15, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.333 Vali Acc: 0.899 Test Loss: 0.333 Test Acc: 0.899
Validation loss decreased (-0.884055 --> -0.898547).  Saving model ...
Epoch: 16 cost time: 1.8013315200805664
Epoch: 16, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.381 Vali Acc: 0.877 Test Loss: 0.381 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.744690179824829
Epoch: 17, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.368 Vali Acc: 0.884 Test Loss: 0.368 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.672271728515625
Epoch: 18, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.302 Vali Acc: 0.906 Test Loss: 0.302 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905794).  Saving model ...
Epoch: 19 cost time: 1.7680542469024658
Epoch: 19, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.318 Vali Acc: 0.891 Test Loss: 0.318 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6695499420166016
Epoch: 20, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.367 Vali Acc: 0.877 Test Loss: 0.367 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.695476770401001
Epoch: 21, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.392 Vali Acc: 0.870 Test Loss: 0.392 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.7907593250274658
Epoch: 22, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.399 Vali Acc: 0.884 Test Loss: 0.399 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.7273635864257812
Epoch: 23, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.406 Vali Acc: 0.877 Test Loss: 0.406 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.639559268951416
Epoch: 24, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.356 Vali Acc: 0.877 Test Loss: 0.356 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.6665327548980713
Epoch: 25, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.329 Vali Acc: 0.884 Test Loss: 0.329 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.7544641494750977
Epoch: 26, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.329 Vali Acc: 0.877 Test Loss: 0.329 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.7159101963043213
Epoch: 27, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.333 Vali Acc: 0.877 Test Loss: 0.333 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.7153277397155762
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.340 Vali Acc: 0.877 Test Loss: 0.340 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 543716
model size : 2.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 6.860392808914185
Epoch: 1, Steps: 9 | Train Loss: 1.362 Vali Loss: 1.323 Vali Acc: 0.319 Test Loss: 1.323 Test Acc: 0.319
Validation loss decreased (inf --> -0.318827).  Saving model ...
Epoch: 2 cost time: 4.168370246887207
Epoch: 2, Steps: 9 | Train Loss: 1.268 Vali Loss: 1.177 Vali Acc: 0.457 Test Loss: 1.177 Test Acc: 0.457
Validation loss decreased (-0.318827 --> -0.456510).  Saving model ...
Epoch: 3 cost time: 4.13706636428833
Epoch: 3, Steps: 9 | Train Loss: 1.110 Vali Loss: 1.038 Vali Acc: 0.543 Test Loss: 1.038 Test Acc: 0.543
Validation loss decreased (-0.456510 --> -0.543468).  Saving model ...
Epoch: 4 cost time: 5.1211090087890625
Epoch: 4, Steps: 9 | Train Loss: 0.929 Vali Loss: 0.900 Vali Acc: 0.594 Test Loss: 0.900 Test Acc: 0.594
Validation loss decreased (-0.543468 --> -0.594194).  Saving model ...
Epoch: 5 cost time: 5.296525239944458
Epoch: 5, Steps: 9 | Train Loss: 0.797 Vali Loss: 0.770 Vali Acc: 0.667 Test Loss: 0.770 Test Acc: 0.667
Validation loss decreased (-0.594194 --> -0.666659).  Saving model ...
Epoch: 6 cost time: 5.4611358642578125
Epoch: 6, Steps: 9 | Train Loss: 0.728 Vali Loss: 0.660 Vali Acc: 0.703 Test Loss: 0.660 Test Acc: 0.703
Validation loss decreased (-0.666659 --> -0.702892).  Saving model ...
Epoch: 7 cost time: 5.324723720550537
Epoch: 7, Steps: 9 | Train Loss: 0.507 Vali Loss: 0.575 Vali Acc: 0.775 Test Loss: 0.575 Test Acc: 0.775
Validation loss decreased (-0.702892 --> -0.775357).  Saving model ...
Epoch: 8 cost time: 5.3099706172943115
Epoch: 8, Steps: 9 | Train Loss: 0.417 Vali Loss: 0.481 Vali Acc: 0.812 Test Loss: 0.481 Test Acc: 0.812
Validation loss decreased (-0.775357 --> -0.811589).  Saving model ...
Epoch: 9 cost time: 5.366434812545776
Epoch: 9, Steps: 9 | Train Loss: 0.385 Vali Loss: 0.450 Vali Acc: 0.841 Test Loss: 0.450 Test Acc: 0.841
Validation loss decreased (-0.811589 --> -0.840575).  Saving model ...
Epoch: 10 cost time: 5.0600268840789795
Epoch: 10, Steps: 9 | Train Loss: 0.291 Vali Loss: 0.417 Vali Acc: 0.841 Test Loss: 0.417 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840576).  Saving model ...
Epoch: 11 cost time: 5.23400616645813
Epoch: 11, Steps: 9 | Train Loss: 0.256 Vali Loss: 0.389 Vali Acc: 0.870 Test Loss: 0.389 Test Acc: 0.870
Validation loss decreased (-0.840576 --> -0.869561).  Saving model ...
Epoch: 12 cost time: 4.913665294647217
Epoch: 12, Steps: 9 | Train Loss: 0.213 Vali Loss: 0.419 Vali Acc: 0.862 Test Loss: 0.419 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.464327573776245
Epoch: 13, Steps: 9 | Train Loss: 0.272 Vali Loss: 0.392 Vali Acc: 0.855 Test Loss: 0.392 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.754037618637085
Epoch: 14, Steps: 9 | Train Loss: 0.149 Vali Loss: 0.449 Vali Acc: 0.855 Test Loss: 0.449 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.7385478019714355
Epoch: 15, Steps: 9 | Train Loss: 0.137 Vali Loss: 0.396 Vali Acc: 0.877 Test Loss: 0.396 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876808).  Saving model ...
Epoch: 16 cost time: 5.7203850746154785
Epoch: 16, Steps: 9 | Train Loss: 0.123 Vali Loss: 0.421 Vali Acc: 0.862 Test Loss: 0.421 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.663699150085449
Epoch: 17, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.378 Vali Acc: 0.884 Test Loss: 0.378 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884054).  Saving model ...
Epoch: 18 cost time: 5.680325746536255
Epoch: 18, Steps: 9 | Train Loss: 0.108 Vali Loss: 0.372 Vali Acc: 0.884 Test Loss: 0.372 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 19 cost time: 5.438694477081299
Epoch: 19, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.407 Vali Acc: 0.862 Test Loss: 0.407 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.418142318725586
Epoch: 20, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.395 Vali Acc: 0.877 Test Loss: 0.395 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.391751766204834
Epoch: 21, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.401 Vali Acc: 0.884 Test Loss: 0.401 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 5.5196473598480225
Epoch: 22, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.351 Vali Acc: 0.913 Test Loss: 0.351 Test Acc: 0.913
Validation loss decreased (-0.884054 --> -0.913040).  Saving model ...
Epoch: 23 cost time: 5.670991659164429
Epoch: 23, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.408 Vali Acc: 0.870 Test Loss: 0.408 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 5.580522060394287
Epoch: 24, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.375 Vali Acc: 0.913 Test Loss: 0.375 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 5.656683683395386
Epoch: 25, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.369 Vali Acc: 0.920 Test Loss: 0.369 Test Acc: 0.920
Validation loss decreased (-0.913040 --> -0.920286).  Saving model ...
Epoch: 26 cost time: 5.4718005657196045
Epoch: 26, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.362 Vali Acc: 0.906 Test Loss: 0.362 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 5.734269142150879
Epoch: 27, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.370 Vali Acc: 0.906 Test Loss: 0.370 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 5.764112234115601
Epoch: 28, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.364 Vali Acc: 0.899 Test Loss: 0.364 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 5.182087421417236
Epoch: 29, Steps: 9 | Train Loss: 0.155 Vali Loss: 0.460 Vali Acc: 0.870 Test Loss: 0.460 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 5.335936069488525
Epoch: 30, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.427 Vali Acc: 0.891 Test Loss: 0.427 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 1772052
model size : 7.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.509277582168579
Epoch: 1, Steps: 9 | Train Loss: 1.497 Vali Loss: 1.427 Vali Acc: 0.232 Test Loss: 1.427 Test Acc: 0.232
Validation loss decreased (inf --> -0.231870).  Saving model ...
Epoch: 2 cost time: 3.2166807651519775
Epoch: 2, Steps: 9 | Train Loss: 1.369 Vali Loss: 1.317 Vali Acc: 0.399 Test Loss: 1.317 Test Acc: 0.399
Validation loss decreased (-0.231870 --> -0.398538).  Saving model ...
Epoch: 3 cost time: 3.416207790374756
Epoch: 3, Steps: 9 | Train Loss: 1.209 Vali Loss: 1.178 Vali Acc: 0.543 Test Loss: 1.178 Test Acc: 0.543
Validation loss decreased (-0.398538 --> -0.543466).  Saving model ...
Epoch: 4 cost time: 3.4242324829101562
Epoch: 4, Steps: 9 | Train Loss: 1.051 Vali Loss: 1.028 Vali Acc: 0.609 Test Loss: 1.028 Test Acc: 0.609
Validation loss decreased (-0.543466 --> -0.608685).  Saving model ...
Epoch: 5 cost time: 3.3593738079071045
Epoch: 5, Steps: 9 | Train Loss: 0.841 Vali Loss: 0.858 Vali Acc: 0.674 Test Loss: 0.858 Test Acc: 0.674
Validation loss decreased (-0.608685 --> -0.673904).  Saving model ...
Epoch: 6 cost time: 3.327185869216919
Epoch: 6, Steps: 9 | Train Loss: 0.684 Vali Loss: 0.688 Vali Acc: 0.739 Test Loss: 0.688 Test Acc: 0.739
Validation loss decreased (-0.673904 --> -0.739124).  Saving model ...
Epoch: 7 cost time: 3.5286149978637695
Epoch: 7, Steps: 9 | Train Loss: 0.538 Vali Loss: 0.550 Vali Acc: 0.783 Test Loss: 0.550 Test Acc: 0.783
Validation loss decreased (-0.739124 --> -0.782603).  Saving model ...
Epoch: 8 cost time: 3.4241726398468018
Epoch: 8, Steps: 9 | Train Loss: 0.451 Vali Loss: 0.457 Vali Acc: 0.812 Test Loss: 0.457 Test Acc: 0.812
Validation loss decreased (-0.782603 --> -0.811590).  Saving model ...
Epoch: 9 cost time: 3.3835179805755615
Epoch: 9, Steps: 9 | Train Loss: 0.330 Vali Loss: 0.418 Vali Acc: 0.855 Test Loss: 0.418 Test Acc: 0.855
Validation loss decreased (-0.811590 --> -0.855068).  Saving model ...
Epoch: 10 cost time: 3.3611631393432617
Epoch: 10, Steps: 9 | Train Loss: 0.274 Vali Loss: 0.403 Vali Acc: 0.877 Test Loss: 0.403 Test Acc: 0.877
Validation loss decreased (-0.855068 --> -0.876808).  Saving model ...
Epoch: 11 cost time: 3.3776824474334717
Epoch: 11, Steps: 9 | Train Loss: 0.215 Vali Loss: 0.393 Vali Acc: 0.877 Test Loss: 0.393 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 12 cost time: 3.5680434703826904
Epoch: 12, Steps: 9 | Train Loss: 0.175 Vali Loss: 0.390 Vali Acc: 0.855 Test Loss: 0.390 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.4945876598358154
Epoch: 13, Steps: 9 | Train Loss: 0.154 Vali Loss: 0.360 Vali Acc: 0.870 Test Loss: 0.360 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.4135379791259766
Epoch: 14, Steps: 9 | Train Loss: 0.133 Vali Loss: 0.396 Vali Acc: 0.855 Test Loss: 0.396 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.2271840572357178
Epoch: 15, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.381 Vali Acc: 0.862 Test Loss: 0.381 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.2354001998901367
Epoch: 16, Steps: 9 | Train Loss: 0.275 Vali Loss: 0.337 Vali Acc: 0.884 Test Loss: 0.337 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884055).  Saving model ...
Epoch: 17 cost time: 3.415074348449707
Epoch: 17, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.315 Vali Acc: 0.891 Test Loss: 0.315 Test Acc: 0.891
Validation loss decreased (-0.884055 --> -0.891301).  Saving model ...
Epoch: 18 cost time: 3.289637804031372
Epoch: 18, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.320 Vali Acc: 0.891 Test Loss: 0.320 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.4157724380493164
Epoch: 19, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.339 Vali Acc: 0.877 Test Loss: 0.339 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.1670987606048584
Epoch: 20, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.341 Vali Acc: 0.891 Test Loss: 0.341 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.024815320968628
Epoch: 21, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.310 Vali Acc: 0.899 Test Loss: 0.310 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898548).  Saving model ...
Epoch: 22 cost time: 3.2030465602874756
Epoch: 22, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.310 Vali Acc: 0.913 Test Loss: 0.310 Test Acc: 0.913
Validation loss decreased (-0.898548 --> -0.913040).  Saving model ...
Epoch: 23 cost time: 3.2578277587890625
Epoch: 23, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.322 Vali Acc: 0.906 Test Loss: 0.322 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.21956467628479
Epoch: 24, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.282 Vali Acc: 0.913 Test Loss: 0.282 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913041).  Saving model ...
Epoch: 25 cost time: 3.453413724899292
Epoch: 25, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.279 Vali Acc: 0.913 Test Loss: 0.279 Test Acc: 0.913
Validation loss decreased (-0.913041 --> -0.913041).  Saving model ...
Epoch: 26 cost time: 3.597055435180664
Epoch: 26, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.291 Vali Acc: 0.913 Test Loss: 0.291 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.3860692977905273
Epoch: 27, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.305 Vali Acc: 0.913 Test Loss: 0.305 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.587742328643799
Epoch: 28, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.336 Vali Acc: 0.899 Test Loss: 0.336 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.2970008850097656
Epoch: 29, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.273 Vali Acc: 0.906 Test Loss: 0.273 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.5055534839630127
Epoch: 30, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.252 Vali Acc: 0.920 Test Loss: 0.252 Test Acc: 0.920
Validation loss decreased (-0.913041 --> -0.920287).  Saving model ...
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 530484
model size : 2.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 6.364231109619141
Epoch: 1, Steps: 9 | Train Loss: 1.360 Vali Loss: 1.325 Vali Acc: 0.326 Test Loss: 1.325 Test Acc: 0.326
Validation loss decreased (inf --> -0.326074).  Saving model ...
Epoch: 2 cost time: 3.6508705615997314
Epoch: 2, Steps: 9 | Train Loss: 1.271 Vali Loss: 1.187 Vali Acc: 0.449 Test Loss: 1.187 Test Acc: 0.449
Validation loss decreased (-0.326074 --> -0.449263).  Saving model ...
Epoch: 3 cost time: 3.9330525398254395
Epoch: 3, Steps: 9 | Train Loss: 1.122 Vali Loss: 1.057 Vali Acc: 0.529 Test Loss: 1.057 Test Acc: 0.529
Validation loss decreased (-0.449263 --> -0.528975).  Saving model ...
Epoch: 4 cost time: 4.2396628856658936
Epoch: 4, Steps: 9 | Train Loss: 0.958 Vali Loss: 0.932 Vali Acc: 0.601 Test Loss: 0.932 Test Acc: 0.601
Validation loss decreased (-0.528975 --> -0.601440).  Saving model ...
Epoch: 5 cost time: 4.279976844787598
Epoch: 5, Steps: 9 | Train Loss: 0.863 Vali Loss: 0.840 Vali Acc: 0.609 Test Loss: 0.840 Test Acc: 0.609
Validation loss decreased (-0.601440 --> -0.608687).  Saving model ...
Epoch: 6 cost time: 4.326937437057495
Epoch: 6, Steps: 9 | Train Loss: 0.773 Vali Loss: 0.745 Vali Acc: 0.681 Test Loss: 0.745 Test Acc: 0.681
Validation loss decreased (-0.608687 --> -0.681152).  Saving model ...
Epoch: 7 cost time: 4.144359827041626
Epoch: 7, Steps: 9 | Train Loss: 0.633 Vali Loss: 0.653 Vali Acc: 0.790 Test Loss: 0.653 Test Acc: 0.790
Validation loss decreased (-0.681152 --> -0.789849).  Saving model ...
Epoch: 8 cost time: 4.324753999710083
Epoch: 8, Steps: 9 | Train Loss: 0.504 Vali Loss: 0.546 Vali Acc: 0.804 Test Loss: 0.546 Test Acc: 0.804
Validation loss decreased (-0.789849 --> -0.804342).  Saving model ...
Epoch: 9 cost time: 4.240424871444702
Epoch: 9, Steps: 9 | Train Loss: 0.456 Vali Loss: 0.499 Vali Acc: 0.855 Test Loss: 0.499 Test Acc: 0.855
Validation loss decreased (-0.804342 --> -0.855067).  Saving model ...
Epoch: 10 cost time: 4.004575729370117
Epoch: 10, Steps: 9 | Train Loss: 0.353 Vali Loss: 0.496 Vali Acc: 0.812 Test Loss: 0.496 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.223680019378662
Epoch: 11, Steps: 9 | Train Loss: 0.327 Vali Loss: 0.422 Vali Acc: 0.862 Test Loss: 0.422 Test Acc: 0.862
Validation loss decreased (-0.855067 --> -0.862315).  Saving model ...
Epoch: 12 cost time: 4.131897687911987
Epoch: 12, Steps: 9 | Train Loss: 0.247 Vali Loss: 0.429 Vali Acc: 0.862 Test Loss: 0.429 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.076242685317993
Epoch: 13, Steps: 9 | Train Loss: 0.237 Vali Loss: 0.419 Vali Acc: 0.833 Test Loss: 0.419 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.9396965503692627
Epoch: 14, Steps: 9 | Train Loss: 0.164 Vali Loss: 0.401 Vali Acc: 0.877 Test Loss: 0.401 Test Acc: 0.877
Validation loss decreased (-0.862315 --> -0.876808).  Saving model ...
Epoch: 15 cost time: 3.9581406116485596
Epoch: 15, Steps: 9 | Train Loss: 0.394 Vali Loss: 0.403 Vali Acc: 0.891 Test Loss: 0.403 Test Acc: 0.891
Validation loss decreased (-0.876808 --> -0.891300).  Saving model ...
Epoch: 16 cost time: 3.889148235321045
Epoch: 16, Steps: 9 | Train Loss: 0.116 Vali Loss: 0.383 Vali Acc: 0.899 Test Loss: 0.383 Test Acc: 0.899
Validation loss decreased (-0.891300 --> -0.898547).  Saving model ...
Epoch: 17 cost time: 3.9012579917907715
Epoch: 17, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.401 Vali Acc: 0.862 Test Loss: 0.401 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.101109027862549
Epoch: 18, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.415 Vali Acc: 0.870 Test Loss: 0.415 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.970176935195923
Epoch: 19, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.425 Vali Acc: 0.884 Test Loss: 0.425 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.930861711502075
Epoch: 20, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.391 Vali Acc: 0.906 Test Loss: 0.391 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905793).  Saving model ...
Epoch: 21 cost time: 3.9000518321990967
Epoch: 21, Steps: 9 | Train Loss: 0.166 Vali Loss: 0.378 Vali Acc: 0.913 Test Loss: 0.378 Test Acc: 0.913
Validation loss decreased (-0.905793 --> -0.913040).  Saving model ...
Epoch: 22 cost time: 4.084705114364624
Epoch: 22, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.400 Vali Acc: 0.862 Test Loss: 0.400 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.010271072387695
Epoch: 23, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.380 Vali Acc: 0.891 Test Loss: 0.380 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.9951179027557373
Epoch: 24, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.401 Vali Acc: 0.899 Test Loss: 0.401 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.8872809410095215
Epoch: 25, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.400 Vali Acc: 0.899 Test Loss: 0.400 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.8615825176239014
Epoch: 26, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.388 Vali Acc: 0.899 Test Loss: 0.388 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 4.023512363433838
Epoch: 27, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.389 Vali Acc: 0.913 Test Loss: 0.389 Test Acc: 0.913
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.9113054275512695
Epoch: 28, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.395 Vali Acc: 0.906 Test Loss: 0.395 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.9156551361083984
Epoch: 29, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.365 Vali Acc: 0.906 Test Loss: 0.365 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 4.304686784744263
Epoch: 30, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.393 Vali Acc: 0.913 Test Loss: 0.393 Test Acc: 0.913
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 1772052
model size : 7.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.304692506790161
Epoch: 1, Steps: 9 | Train Loss: 1.495 Vali Loss: 1.428 Vali Acc: 0.225 Test Loss: 1.428 Test Acc: 0.225
Validation loss decreased (inf --> -0.224623).  Saving model ...
Epoch: 2 cost time: 2.513603687286377
Epoch: 2, Steps: 9 | Train Loss: 1.373 Vali Loss: 1.321 Vali Acc: 0.362 Test Loss: 1.321 Test Acc: 0.362
Validation loss decreased (-0.224623 --> -0.362306).  Saving model ...
Epoch: 3 cost time: 2.566925525665283
Epoch: 3, Steps: 9 | Train Loss: 1.229 Vali Loss: 1.191 Vali Acc: 0.493 Test Loss: 1.191 Test Acc: 0.493
Validation loss decreased (-0.362306 --> -0.492742).  Saving model ...
Epoch: 4 cost time: 2.5594418048858643
Epoch: 4, Steps: 9 | Train Loss: 1.084 Vali Loss: 1.056 Vali Acc: 0.580 Test Loss: 1.056 Test Acc: 0.580
Validation loss decreased (-0.492742 --> -0.579700).  Saving model ...
Epoch: 5 cost time: 2.5098867416381836
Epoch: 5, Steps: 9 | Train Loss: 0.882 Vali Loss: 0.906 Vali Acc: 0.645 Test Loss: 0.906 Test Acc: 0.645
Validation loss decreased (-0.579700 --> -0.644918).  Saving model ...
Epoch: 6 cost time: 2.4471216201782227
Epoch: 6, Steps: 9 | Train Loss: 0.747 Vali Loss: 0.752 Vali Acc: 0.710 Test Loss: 0.752 Test Acc: 0.710
Validation loss decreased (-0.644918 --> -0.710137).  Saving model ...
Epoch: 7 cost time: 2.312366008758545
Epoch: 7, Steps: 9 | Train Loss: 0.597 Vali Loss: 0.620 Vali Acc: 0.746 Test Loss: 0.620 Test Acc: 0.746
Validation loss decreased (-0.710137 --> -0.746371).  Saving model ...
Epoch: 8 cost time: 2.5744781494140625
Epoch: 8, Steps: 9 | Train Loss: 0.476 Vali Loss: 0.529 Vali Acc: 0.790 Test Loss: 0.529 Test Acc: 0.790
Validation loss decreased (-0.746371 --> -0.789850).  Saving model ...
Epoch: 9 cost time: 2.6145875453948975
Epoch: 9, Steps: 9 | Train Loss: 0.358 Vali Loss: 0.475 Vali Acc: 0.819 Test Loss: 0.475 Test Acc: 0.819
Validation loss decreased (-0.789850 --> -0.818836).  Saving model ...
Epoch: 10 cost time: 2.3826839923858643
Epoch: 10, Steps: 9 | Train Loss: 0.387 Vali Loss: 0.455 Vali Acc: 0.841 Test Loss: 0.455 Test Acc: 0.841
Validation loss decreased (-0.818836 --> -0.840575).  Saving model ...
Epoch: 11 cost time: 2.8074111938476562
Epoch: 11, Steps: 9 | Train Loss: 0.270 Vali Loss: 0.455 Vali Acc: 0.812 Test Loss: 0.455 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.672675132751465
Epoch: 12, Steps: 9 | Train Loss: 0.193 Vali Loss: 0.449 Vali Acc: 0.826 Test Loss: 0.449 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.9145936965942383
Epoch: 13, Steps: 9 | Train Loss: 0.175 Vali Loss: 0.416 Vali Acc: 0.855 Test Loss: 0.416 Test Acc: 0.855
Validation loss decreased (-0.840575 --> -0.855068).  Saving model ...
Epoch: 14 cost time: 2.7808732986450195
Epoch: 14, Steps: 9 | Train Loss: 0.121 Vali Loss: 0.413 Vali Acc: 0.841 Test Loss: 0.413 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.6529664993286133
Epoch: 15, Steps: 9 | Train Loss: 0.099 Vali Loss: 0.405 Vali Acc: 0.841 Test Loss: 0.405 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.7313218116760254
Epoch: 16, Steps: 9 | Train Loss: 0.113 Vali Loss: 0.387 Vali Acc: 0.855 Test Loss: 0.387 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855069).  Saving model ...
Epoch: 17 cost time: 2.721043586730957
Epoch: 17, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.368 Vali Acc: 0.855 Test Loss: 0.368 Test Acc: 0.855
Validation loss decreased (-0.855069 --> -0.855069).  Saving model ...
Epoch: 18 cost time: 2.7800281047821045
Epoch: 18, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.373 Vali Acc: 0.848 Test Loss: 0.373 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.690720319747925
Epoch: 19, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.398 Vali Acc: 0.848 Test Loss: 0.398 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.7819175720214844
Epoch: 20, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.407 Vali Acc: 0.841 Test Loss: 0.407 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.899873733520508
Epoch: 21, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.380 Vali Acc: 0.841 Test Loss: 0.380 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.791374683380127
Epoch: 22, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.370 Vali Acc: 0.855 Test Loss: 0.370 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.8318679332733154
Epoch: 23, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.355 Vali Acc: 0.862 Test Loss: 0.355 Test Acc: 0.862
Validation loss decreased (-0.855069 --> -0.862315).  Saving model ...
Epoch: 24 cost time: 2.660541296005249
Epoch: 24, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.338 Vali Acc: 0.862 Test Loss: 0.338 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 25 cost time: 2.6514101028442383
Epoch: 25, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.336 Vali Acc: 0.870 Test Loss: 0.336 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869562).  Saving model ...
Epoch: 26 cost time: 2.6301352977752686
Epoch: 26, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.332 Vali Acc: 0.884 Test Loss: 0.332 Test Acc: 0.884
Validation loss decreased (-0.869562 --> -0.884055).  Saving model ...
Epoch: 27 cost time: 2.7454004287719727
Epoch: 27, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.360 Vali Acc: 0.862 Test Loss: 0.360 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.7018303871154785
Epoch: 28, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.353 Vali Acc: 0.855 Test Loss: 0.353 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.892800807952881
Epoch: 29, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.341 Vali Acc: 0.855 Test Loss: 0.341 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.722625255584717
Epoch: 30, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.292 Vali Acc: 0.891 Test Loss: 0.292 Test Acc: 0.891
Validation loss decreased (-0.884055 --> -0.891301).  Saving model ...
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 530484
model size : 2.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.548507213592529
Epoch: 1, Steps: 9 | Train Loss: 1.355 Vali Loss: 1.335 Vali Acc: 0.326 Test Loss: 1.335 Test Acc: 0.326
Validation loss decreased (inf --> -0.326074).  Saving model ...
Epoch: 2 cost time: 2.5215542316436768
Epoch: 2, Steps: 9 | Train Loss: 1.274 Vali Loss: 1.217 Vali Acc: 0.420 Test Loss: 1.217 Test Acc: 0.420
Validation loss decreased (-0.326074 --> -0.420278).  Saving model ...
Epoch: 3 cost time: 2.719407558441162
Epoch: 3, Steps: 9 | Train Loss: 1.136 Vali Loss: 1.110 Vali Acc: 0.464 Test Loss: 1.110 Test Acc: 0.464
Validation loss decreased (-0.420278 --> -0.463757).  Saving model ...
Epoch: 4 cost time: 2.597559928894043
Epoch: 4, Steps: 9 | Train Loss: 0.975 Vali Loss: 1.014 Vali Acc: 0.514 Test Loss: 1.014 Test Acc: 0.514
Validation loss decreased (-0.463757 --> -0.514483).  Saving model ...
Epoch: 5 cost time: 2.772878646850586
Epoch: 5, Steps: 9 | Train Loss: 0.893 Vali Loss: 0.955 Vali Acc: 0.536 Test Loss: 0.955 Test Acc: 0.536
Validation loss decreased (-0.514483 --> -0.536222).  Saving model ...
Epoch: 6 cost time: 2.8122875690460205
Epoch: 6, Steps: 9 | Train Loss: 0.821 Vali Loss: 0.883 Vali Acc: 0.580 Test Loss: 0.883 Test Acc: 0.580
Validation loss decreased (-0.536222 --> -0.579701).  Saving model ...
Epoch: 7 cost time: 2.7065324783325195
Epoch: 7, Steps: 9 | Train Loss: 0.701 Vali Loss: 0.811 Vali Acc: 0.659 Test Loss: 0.811 Test Acc: 0.659
Validation loss decreased (-0.579701 --> -0.659412).  Saving model ...
Epoch: 8 cost time: 2.7376959323883057
Epoch: 8, Steps: 9 | Train Loss: 0.648 Vali Loss: 0.760 Vali Acc: 0.681 Test Loss: 0.760 Test Acc: 0.681
Validation loss decreased (-0.659412 --> -0.681152).  Saving model ...
Epoch: 9 cost time: 2.722238779067993
Epoch: 9, Steps: 9 | Train Loss: 0.533 Vali Loss: 0.749 Vali Acc: 0.688 Test Loss: 0.749 Test Acc: 0.688
Validation loss decreased (-0.681152 --> -0.688398).  Saving model ...
Epoch: 10 cost time: 2.678408145904541
Epoch: 10, Steps: 9 | Train Loss: 0.459 Vali Loss: 0.712 Vali Acc: 0.667 Test Loss: 0.712 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.5221104621887207
Epoch: 11, Steps: 9 | Train Loss: 0.375 Vali Loss: 0.675 Vali Acc: 0.696 Test Loss: 0.675 Test Acc: 0.696
Validation loss decreased (-0.688398 --> -0.695645).  Saving model ...
Epoch: 12 cost time: 2.511458396911621
Epoch: 12, Steps: 9 | Train Loss: 0.299 Vali Loss: 0.658 Vali Acc: 0.732 Test Loss: 0.658 Test Acc: 0.732
Validation loss decreased (-0.695645 --> -0.731877).  Saving model ...
Epoch: 13 cost time: 2.667780876159668
Epoch: 13, Steps: 9 | Train Loss: 0.290 Vali Loss: 0.583 Vali Acc: 0.732 Test Loss: 0.583 Test Acc: 0.732
Validation loss decreased (-0.731877 --> -0.731878).  Saving model ...
Epoch: 14 cost time: 2.4925076961517334
Epoch: 14, Steps: 9 | Train Loss: 0.174 Vali Loss: 0.474 Vali Acc: 0.848 Test Loss: 0.474 Test Acc: 0.848
Validation loss decreased (-0.731878 --> -0.847821).  Saving model ...
Epoch: 15 cost time: 2.653759717941284
Epoch: 15, Steps: 9 | Train Loss: 0.144 Vali Loss: 0.415 Vali Acc: 0.848 Test Loss: 0.415 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847822).  Saving model ...
Epoch: 16 cost time: 2.7243142127990723
Epoch: 16, Steps: 9 | Train Loss: 0.107 Vali Loss: 0.382 Vali Acc: 0.877 Test Loss: 0.382 Test Acc: 0.877
Validation loss decreased (-0.847822 --> -0.876808).  Saving model ...
Epoch: 17 cost time: 2.736855983734131
Epoch: 17, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.380 Vali Acc: 0.862 Test Loss: 0.380 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.7981624603271484
Epoch: 18, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.412 Vali Acc: 0.862 Test Loss: 0.412 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.6921489238739014
Epoch: 19, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.476 Vali Acc: 0.826 Test Loss: 0.476 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.729905605316162
Epoch: 20, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.465 Vali Acc: 0.841 Test Loss: 0.465 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.906193494796753
Epoch: 21, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.472 Vali Acc: 0.855 Test Loss: 0.472 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.773829221725464
Epoch: 22, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.386 Vali Acc: 0.877 Test Loss: 0.386 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.0252277851104736
Epoch: 23, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.478 Vali Acc: 0.899 Test Loss: 0.478 Test Acc: 0.899
Validation loss decreased (-0.876808 --> -0.898546).  Saving model ...
Epoch: 24 cost time: 2.9777674674987793
Epoch: 24, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.587 Vali Acc: 0.877 Test Loss: 0.587 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.1158180236816406
Epoch: 25, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.621 Vali Acc: 0.877 Test Loss: 0.621 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.806561231613159
Epoch: 26, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.561 Vali Acc: 0.899 Test Loss: 0.561 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.9900288581848145
Epoch: 27, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.554 Vali Acc: 0.899 Test Loss: 0.554 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.8828325271606445
Epoch: 28, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.539 Vali Acc: 0.899 Test Loss: 0.539 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.6969804763793945
Epoch: 29, Steps: 9 | Train Loss: 0.192 Vali Loss: 0.804 Vali Acc: 0.804 Test Loss: 0.804 Test Acc: 0.804
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.9905762672424316
Epoch: 30, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.377 Vali Acc: 0.906 Test Loss: 0.377 Test Acc: 0.906
Validation loss decreased (-0.898546 --> -0.905793).  Saving model ...
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 1772052
model size : 7.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.238893270492554
Epoch: 1, Steps: 9 | Train Loss: 1.486 Vali Loss: 1.428 Vali Acc: 0.246 Test Loss: 1.428 Test Acc: 0.246
Validation loss decreased (inf --> -0.246363).  Saving model ...
Epoch: 2 cost time: 2.0767853260040283
Epoch: 2, Steps: 9 | Train Loss: 1.369 Vali Loss: 1.334 Vali Acc: 0.370 Test Loss: 1.334 Test Acc: 0.370
Validation loss decreased (-0.246363 --> -0.369552).  Saving model ...
Epoch: 3 cost time: 2.1079418659210205
Epoch: 3, Steps: 9 | Train Loss: 1.230 Vali Loss: 1.221 Vali Acc: 0.413 Test Loss: 1.221 Test Acc: 0.413
Validation loss decreased (-0.369552 --> -0.413031).  Saving model ...
Epoch: 4 cost time: 1.8980293273925781
Epoch: 4, Steps: 9 | Train Loss: 1.094 Vali Loss: 1.103 Vali Acc: 0.551 Test Loss: 1.103 Test Acc: 0.551
Validation loss decreased (-0.413031 --> -0.550714).  Saving model ...
Epoch: 5 cost time: 2.0713272094726562
Epoch: 5, Steps: 9 | Train Loss: 0.913 Vali Loss: 0.994 Vali Acc: 0.601 Test Loss: 0.994 Test Acc: 0.601
Validation loss decreased (-0.550714 --> -0.601439).  Saving model ...
Epoch: 6 cost time: 2.1744072437286377
Epoch: 6, Steps: 9 | Train Loss: 0.802 Vali Loss: 0.886 Vali Acc: 0.638 Test Loss: 0.886 Test Acc: 0.638
Validation loss decreased (-0.601439 --> -0.637672).  Saving model ...
Epoch: 7 cost time: 1.6834509372711182
Epoch: 7, Steps: 9 | Train Loss: 0.656 Vali Loss: 0.765 Vali Acc: 0.688 Test Loss: 0.765 Test Acc: 0.688
Validation loss decreased (-0.637672 --> -0.688398).  Saving model ...
Epoch: 8 cost time: 2.1811695098876953
Epoch: 8, Steps: 9 | Train Loss: 0.555 Vali Loss: 0.663 Vali Acc: 0.754 Test Loss: 0.663 Test Acc: 0.754
Validation loss decreased (-0.688398 --> -0.753617).  Saving model ...
Epoch: 9 cost time: 1.7706854343414307
Epoch: 9, Steps: 9 | Train Loss: 0.444 Vali Loss: 0.605 Vali Acc: 0.775 Test Loss: 0.605 Test Acc: 0.775
Validation loss decreased (-0.753617 --> -0.775356).  Saving model ...
Epoch: 10 cost time: 1.9964590072631836
Epoch: 10, Steps: 9 | Train Loss: 0.360 Vali Loss: 0.565 Vali Acc: 0.775 Test Loss: 0.565 Test Acc: 0.775
Validation loss decreased (-0.775356 --> -0.775357).  Saving model ...
Epoch: 11 cost time: 1.844609022140503
Epoch: 11, Steps: 9 | Train Loss: 0.278 Vali Loss: 0.532 Vali Acc: 0.775 Test Loss: 0.532 Test Acc: 0.775
Validation loss decreased (-0.775357 --> -0.775357).  Saving model ...
Epoch: 12 cost time: 2.072280168533325
Epoch: 12, Steps: 9 | Train Loss: 0.225 Vali Loss: 0.517 Vali Acc: 0.783 Test Loss: 0.517 Test Acc: 0.783
Validation loss decreased (-0.775357 --> -0.782604).  Saving model ...
Epoch: 13 cost time: 2.0956056118011475
Epoch: 13, Steps: 9 | Train Loss: 0.194 Vali Loss: 0.475 Vali Acc: 0.790 Test Loss: 0.475 Test Acc: 0.790
Validation loss decreased (-0.782604 --> -0.789850).  Saving model ...
Epoch: 14 cost time: 2.0251216888427734
Epoch: 14, Steps: 9 | Train Loss: 0.138 Vali Loss: 0.443 Vali Acc: 0.804 Test Loss: 0.443 Test Acc: 0.804
Validation loss decreased (-0.789850 --> -0.804343).  Saving model ...
Epoch: 15 cost time: 2.070605516433716
Epoch: 15, Steps: 9 | Train Loss: 0.122 Vali Loss: 0.435 Vali Acc: 0.819 Test Loss: 0.435 Test Acc: 0.819
Validation loss decreased (-0.804343 --> -0.818836).  Saving model ...
Epoch: 16 cost time: 2.074413776397705
Epoch: 16, Steps: 9 | Train Loss: 0.121 Vali Loss: 0.426 Vali Acc: 0.819 Test Loss: 0.426 Test Acc: 0.819
Validation loss decreased (-0.818836 --> -0.818836).  Saving model ...
Epoch: 17 cost time: 1.9903039932250977
Epoch: 17, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.419 Vali Acc: 0.826 Test Loss: 0.419 Test Acc: 0.826
Validation loss decreased (-0.818836 --> -0.826083).  Saving model ...
Epoch: 18 cost time: 2.034008741378784
Epoch: 18, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.382 Vali Acc: 0.870 Test Loss: 0.382 Test Acc: 0.870
Validation loss decreased (-0.826083 --> -0.869561).  Saving model ...
Epoch: 19 cost time: 2.0159785747528076
Epoch: 19, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.404 Vali Acc: 0.848 Test Loss: 0.404 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.075336217880249
Epoch: 20, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.407 Vali Acc: 0.855 Test Loss: 0.407 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.0031535625457764
Epoch: 21, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.430 Vali Acc: 0.862 Test Loss: 0.430 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.0149848461151123
Epoch: 22, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.454 Vali Acc: 0.855 Test Loss: 0.454 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.981184482574463
Epoch: 23, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.412 Vali Acc: 0.855 Test Loss: 0.412 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.043452024459839
Epoch: 24, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.362 Vali Acc: 0.877 Test Loss: 0.362 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876808).  Saving model ...
Epoch: 25 cost time: 2.062873125076294
Epoch: 25, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.335 Vali Acc: 0.870 Test Loss: 0.335 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.8945155143737793
Epoch: 26, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.369 Vali Acc: 0.862 Test Loss: 0.369 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.8349997997283936
Epoch: 27, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.474 Vali Acc: 0.841 Test Loss: 0.474 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.9102635383605957
Epoch: 28, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.555 Vali Acc: 0.855 Test Loss: 0.555 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.8852224349975586
Epoch: 29, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.556 Vali Acc: 0.855 Test Loss: 0.556 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.8694117069244385
Epoch: 30, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.379 Vali Acc: 0.877 Test Loss: 0.379 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 530484
model size : 2.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.597834825515747
Epoch: 1, Steps: 9 | Train Loss: 1.372 Vali Loss: 1.325 Vali Acc: 0.391 Test Loss: 1.325 Test Acc: 0.391
Validation loss decreased (inf --> -0.391291).  Saving model ...
Epoch: 2 cost time: 3.6355574131011963
Epoch: 2, Steps: 9 | Train Loss: 1.297 Vali Loss: 1.246 Vali Acc: 0.442 Test Loss: 1.246 Test Acc: 0.442
Validation loss decreased (-0.391291 --> -0.442017).  Saving model ...
Epoch: 3 cost time: 3.551520586013794
Epoch: 3, Steps: 9 | Train Loss: 1.145 Vali Loss: 1.138 Vali Acc: 0.558 Test Loss: 1.138 Test Acc: 0.558
Validation loss decreased (-0.442017 --> -0.557960).  Saving model ...
Epoch: 4 cost time: 3.478745698928833
Epoch: 4, Steps: 9 | Train Loss: 1.007 Vali Loss: 1.016 Vali Acc: 0.616 Test Loss: 1.016 Test Acc: 0.616
Validation loss decreased (-0.557960 --> -0.615932).  Saving model ...
Epoch: 5 cost time: 3.4622244834899902
Epoch: 5, Steps: 9 | Train Loss: 0.870 Vali Loss: 0.859 Vali Acc: 0.703 Test Loss: 0.859 Test Acc: 0.703
Validation loss decreased (-0.615932 --> -0.702890).  Saving model ...
Epoch: 6 cost time: 3.400188684463501
Epoch: 6, Steps: 9 | Train Loss: 0.723 Vali Loss: 0.703 Vali Acc: 0.783 Test Loss: 0.703 Test Acc: 0.783
Validation loss decreased (-0.702890 --> -0.782602).  Saving model ...
Epoch: 7 cost time: 3.3077425956726074
Epoch: 7, Steps: 9 | Train Loss: 0.592 Vali Loss: 0.624 Vali Acc: 0.790 Test Loss: 0.624 Test Acc: 0.790
Validation loss decreased (-0.782602 --> -0.789849).  Saving model ...
Epoch: 8 cost time: 3.311884641647339
Epoch: 8, Steps: 9 | Train Loss: 0.451 Vali Loss: 0.520 Vali Acc: 0.819 Test Loss: 0.520 Test Acc: 0.819
Validation loss decreased (-0.789849 --> -0.818835).  Saving model ...
Epoch: 9 cost time: 3.4168035984039307
Epoch: 9, Steps: 9 | Train Loss: 0.320 Vali Loss: 0.481 Vali Acc: 0.826 Test Loss: 0.481 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826082).  Saving model ...
Epoch: 10 cost time: 3.421489715576172
Epoch: 10, Steps: 9 | Train Loss: 0.323 Vali Loss: 0.470 Vali Acc: 0.826 Test Loss: 0.470 Test Acc: 0.826
Validation loss decreased (-0.826082 --> -0.826082).  Saving model ...
Epoch: 11 cost time: 3.1730635166168213
Epoch: 11, Steps: 9 | Train Loss: 0.254 Vali Loss: 0.494 Vali Acc: 0.819 Test Loss: 0.494 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.2353408336639404
Epoch: 12, Steps: 9 | Train Loss: 0.239 Vali Loss: 0.470 Vali Acc: 0.819 Test Loss: 0.470 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.4403083324432373
Epoch: 13, Steps: 9 | Train Loss: 0.189 Vali Loss: 0.432 Vali Acc: 0.833 Test Loss: 0.432 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833329).  Saving model ...
Epoch: 14 cost time: 3.352750301361084
Epoch: 14, Steps: 9 | Train Loss: 0.229 Vali Loss: 0.451 Vali Acc: 0.833 Test Loss: 0.451 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.328669309616089
Epoch: 15, Steps: 9 | Train Loss: 0.151 Vali Loss: 0.409 Vali Acc: 0.826 Test Loss: 0.409 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.2989418506622314
Epoch: 16, Steps: 9 | Train Loss: 0.130 Vali Loss: 0.449 Vali Acc: 0.841 Test Loss: 0.449 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840575).  Saving model ...
Epoch: 17 cost time: 3.012136220932007
Epoch: 17, Steps: 9 | Train Loss: 0.128 Vali Loss: 0.437 Vali Acc: 0.855 Test Loss: 0.437 Test Acc: 0.855
Validation loss decreased (-0.840575 --> -0.855068).  Saving model ...
Epoch: 18 cost time: 3.3339762687683105
Epoch: 18, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.402 Vali Acc: 0.884 Test Loss: 0.402 Test Acc: 0.884
Validation loss decreased (-0.855068 --> -0.884054).  Saving model ...
Epoch: 19 cost time: 3.3583145141601562
Epoch: 19, Steps: 9 | Train Loss: 0.105 Vali Loss: 0.415 Vali Acc: 0.862 Test Loss: 0.415 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.447632312774658
Epoch: 20, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.409 Vali Acc: 0.848 Test Loss: 0.409 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.1300137042999268
Epoch: 21, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.378 Vali Acc: 0.855 Test Loss: 0.378 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.1076412200927734
Epoch: 22, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.395 Vali Acc: 0.870 Test Loss: 0.395 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.557912826538086
Epoch: 23, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.409 Vali Acc: 0.877 Test Loss: 0.409 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.5174009799957275
Epoch: 24, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.383 Vali Acc: 0.884 Test Loss: 0.383 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 25 cost time: 3.4902377128601074
Epoch: 25, Steps: 9 | Train Loss: 0.142 Vali Loss: 0.390 Vali Acc: 0.884 Test Loss: 0.390 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.656484365463257
Epoch: 26, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.396 Vali Acc: 0.884 Test Loss: 0.396 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.5334832668304443
Epoch: 27, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.404 Vali Acc: 0.870 Test Loss: 0.404 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.6880054473876953
Epoch: 28, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.433 Vali Acc: 0.870 Test Loss: 0.433 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.552676200866699
Epoch: 29, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.417 Vali Acc: 0.870 Test Loss: 0.417 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.7306582927703857
Epoch: 30, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.398 Vali Acc: 0.877 Test Loss: 0.398 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 892884
model size : 3.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.459346771240234
Epoch: 1, Steps: 9 | Train Loss: 1.414 Vali Loss: 1.408 Vali Acc: 0.333 Test Loss: 1.408 Test Acc: 0.333
Validation loss decreased (inf --> -0.333319).  Saving model ...
Epoch: 2 cost time: 2.467207908630371
Epoch: 2, Steps: 9 | Train Loss: 1.345 Vali Loss: 1.320 Vali Acc: 0.384 Test Loss: 1.320 Test Acc: 0.384
Validation loss decreased (-0.333319 --> -0.384045).  Saving model ...
Epoch: 3 cost time: 2.405308961868286
Epoch: 3, Steps: 9 | Train Loss: 1.248 Vali Loss: 1.217 Vali Acc: 0.507 Test Loss: 1.217 Test Acc: 0.507
Validation loss decreased (-0.384045 --> -0.507234).  Saving model ...
Epoch: 4 cost time: 2.237828493118286
Epoch: 4, Steps: 9 | Train Loss: 1.138 Vali Loss: 1.097 Vali Acc: 0.652 Test Loss: 1.097 Test Acc: 0.652
Validation loss decreased (-0.507234 --> -0.652163).  Saving model ...
Epoch: 5 cost time: 2.5800247192382812
Epoch: 5, Steps: 9 | Train Loss: 0.988 Vali Loss: 0.960 Vali Acc: 0.725 Test Loss: 0.960 Test Acc: 0.725
Validation loss decreased (-0.652163 --> -0.724628).  Saving model ...
Epoch: 6 cost time: 2.6641123294830322
Epoch: 6, Steps: 9 | Train Loss: 0.819 Vali Loss: 0.810 Vali Acc: 0.761 Test Loss: 0.810 Test Acc: 0.761
Validation loss decreased (-0.724628 --> -0.760861).  Saving model ...
Epoch: 7 cost time: 2.541435956954956
Epoch: 7, Steps: 9 | Train Loss: 0.678 Vali Loss: 0.677 Vali Acc: 0.746 Test Loss: 0.677 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.546048641204834
Epoch: 8, Steps: 9 | Train Loss: 0.553 Vali Loss: 0.588 Vali Acc: 0.812 Test Loss: 0.588 Test Acc: 0.812
Validation loss decreased (-0.760861 --> -0.811588).  Saving model ...
Epoch: 9 cost time: 2.6230628490448
Epoch: 9, Steps: 9 | Train Loss: 0.415 Vali Loss: 0.533 Vali Acc: 0.826 Test Loss: 0.533 Test Acc: 0.826
Validation loss decreased (-0.811588 --> -0.826082).  Saving model ...
Epoch: 10 cost time: 2.640812635421753
Epoch: 10, Steps: 9 | Train Loss: 0.398 Vali Loss: 0.482 Vali Acc: 0.819 Test Loss: 0.482 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.6052889823913574
Epoch: 11, Steps: 9 | Train Loss: 0.289 Vali Loss: 0.457 Vali Acc: 0.826 Test Loss: 0.457 Test Acc: 0.826
Validation loss decreased (-0.826082 --> -0.826082).  Saving model ...
Epoch: 12 cost time: 2.537288188934326
Epoch: 12, Steps: 9 | Train Loss: 0.231 Vali Loss: 0.436 Vali Acc: 0.826 Test Loss: 0.436 Test Acc: 0.826
Validation loss decreased (-0.826082 --> -0.826083).  Saving model ...
Epoch: 13 cost time: 2.5403168201446533
Epoch: 13, Steps: 9 | Train Loss: 0.200 Vali Loss: 0.419 Vali Acc: 0.848 Test Loss: 0.419 Test Acc: 0.848
Validation loss decreased (-0.826083 --> -0.847822).  Saving model ...
Epoch: 14 cost time: 2.546182632446289
Epoch: 14, Steps: 9 | Train Loss: 0.144 Vali Loss: 0.413 Vali Acc: 0.826 Test Loss: 0.413 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.575038194656372
Epoch: 15, Steps: 9 | Train Loss: 0.144 Vali Loss: 0.419 Vali Acc: 0.848 Test Loss: 0.419 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.5656800270080566
Epoch: 16, Steps: 9 | Train Loss: 0.233 Vali Loss: 0.369 Vali Acc: 0.848 Test Loss: 0.369 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 17 cost time: 2.4103689193725586
Epoch: 17, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.356 Vali Acc: 0.855 Test Loss: 0.356 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855069).  Saving model ...
Epoch: 18 cost time: 2.422534227371216
Epoch: 18, Steps: 9 | Train Loss: 0.229 Vali Loss: 0.317 Vali Acc: 0.862 Test Loss: 0.317 Test Acc: 0.862
Validation loss decreased (-0.855069 --> -0.862316).  Saving model ...
Epoch: 19 cost time: 2.476261615753174
Epoch: 19, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.296 Vali Acc: 0.877 Test Loss: 0.296 Test Acc: 0.877
Validation loss decreased (-0.862316 --> -0.876809).  Saving model ...
Epoch: 20 cost time: 2.5064597129821777
Epoch: 20, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.312 Vali Acc: 0.884 Test Loss: 0.312 Test Acc: 0.884
Validation loss decreased (-0.876809 --> -0.884055).  Saving model ...
Epoch: 21 cost time: 2.38387393951416
Epoch: 21, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.303 Vali Acc: 0.884 Test Loss: 0.303 Test Acc: 0.884
Validation loss decreased (-0.884055 --> -0.884055).  Saving model ...
Epoch: 22 cost time: 2.3994295597076416
Epoch: 22, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.295 Vali Acc: 0.884 Test Loss: 0.295 Test Acc: 0.884
Validation loss decreased (-0.884055 --> -0.884055).  Saving model ...
Epoch: 23 cost time: 2.3799352645874023
Epoch: 23, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.298 Vali Acc: 0.884 Test Loss: 0.298 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.262833833694458
Epoch: 24, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.309 Vali Acc: 0.891 Test Loss: 0.309 Test Acc: 0.891
Validation loss decreased (-0.884055 --> -0.891301).  Saving model ...
Epoch: 25 cost time: 2.3571066856384277
Epoch: 25, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.291 Vali Acc: 0.891 Test Loss: 0.291 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 26 cost time: 2.4238340854644775
Epoch: 26, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.278 Vali Acc: 0.899 Test Loss: 0.278 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898548).  Saving model ...
Epoch: 27 cost time: 2.4191017150878906
Epoch: 27, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.291 Vali Acc: 0.906 Test Loss: 0.291 Test Acc: 0.906
Validation loss decreased (-0.898548 --> -0.905794).  Saving model ...
Epoch: 28 cost time: 2.299621820449829
Epoch: 28, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.273 Vali Acc: 0.899 Test Loss: 0.273 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.3141043186187744
Epoch: 29, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.186 Vali Acc: 0.920 Test Loss: 0.186 Test Acc: 0.920
Validation loss decreased (-0.905794 --> -0.920288).  Saving model ...
Epoch: 30 cost time: 2.2837722301483154
Epoch: 30, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.220 Vali Acc: 0.920 Test Loss: 0.220 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 272052
model size : 1.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.731416463851929
Epoch: 1, Steps: 9 | Train Loss: 1.371 Vali Loss: 1.323 Vali Acc: 0.391 Test Loss: 1.323 Test Acc: 0.391
Validation loss decreased (inf --> -0.391291).  Saving model ...
Epoch: 2 cost time: 2.5271685123443604
Epoch: 2, Steps: 9 | Train Loss: 1.300 Vali Loss: 1.248 Vali Acc: 0.428 Test Loss: 1.248 Test Acc: 0.428
Validation loss decreased (-0.391291 --> -0.427524).  Saving model ...
Epoch: 3 cost time: 2.7665441036224365
Epoch: 3, Steps: 9 | Train Loss: 1.155 Vali Loss: 1.142 Vali Acc: 0.543 Test Loss: 1.142 Test Acc: 0.543
Validation loss decreased (-0.427524 --> -0.543467).  Saving model ...
Epoch: 4 cost time: 2.369497776031494
Epoch: 4, Steps: 9 | Train Loss: 1.037 Vali Loss: 1.032 Vali Acc: 0.609 Test Loss: 1.032 Test Acc: 0.609
Validation loss decreased (-0.543467 --> -0.608685).  Saving model ...
Epoch: 5 cost time: 2.385272264480591
Epoch: 5, Steps: 9 | Train Loss: 0.895 Vali Loss: 0.894 Vali Acc: 0.681 Test Loss: 0.894 Test Acc: 0.681
Validation loss decreased (-0.608685 --> -0.681150).  Saving model ...
Epoch: 6 cost time: 2.483419895172119
Epoch: 6, Steps: 9 | Train Loss: 0.776 Vali Loss: 0.743 Vali Acc: 0.761 Test Loss: 0.743 Test Acc: 0.761
Validation loss decreased (-0.681150 --> -0.760862).  Saving model ...
Epoch: 7 cost time: 2.6658732891082764
Epoch: 7, Steps: 9 | Train Loss: 0.647 Vali Loss: 0.630 Vali Acc: 0.797 Test Loss: 0.630 Test Acc: 0.797
Validation loss decreased (-0.760862 --> -0.797095).  Saving model ...
Epoch: 8 cost time: 2.489993095397949
Epoch: 8, Steps: 9 | Train Loss: 0.516 Vali Loss: 0.554 Vali Acc: 0.826 Test Loss: 0.554 Test Acc: 0.826
Validation loss decreased (-0.797095 --> -0.826081).  Saving model ...
Epoch: 9 cost time: 2.7275099754333496
Epoch: 9, Steps: 9 | Train Loss: 0.403 Vali Loss: 0.507 Vali Acc: 0.812 Test Loss: 0.507 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.7740139961242676
Epoch: 10, Steps: 9 | Train Loss: 0.388 Vali Loss: 0.448 Vali Acc: 0.812 Test Loss: 0.448 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.7864367961883545
Epoch: 11, Steps: 9 | Train Loss: 0.396 Vali Loss: 0.446 Vali Acc: 0.804 Test Loss: 0.446 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.843139171600342
Epoch: 12, Steps: 9 | Train Loss: 0.200 Vali Loss: 0.388 Vali Acc: 0.833 Test Loss: 0.388 Test Acc: 0.833
Validation loss decreased (-0.826081 --> -0.833329).  Saving model ...
Epoch: 13 cost time: 2.682093620300293
Epoch: 13, Steps: 9 | Train Loss: 0.199 Vali Loss: 0.403 Vali Acc: 0.833 Test Loss: 0.403 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.6897761821746826
Epoch: 14, Steps: 9 | Train Loss: 0.230 Vali Loss: 0.447 Vali Acc: 0.819 Test Loss: 0.447 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.8291945457458496
Epoch: 15, Steps: 9 | Train Loss: 0.149 Vali Loss: 0.411 Vali Acc: 0.841 Test Loss: 0.411 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840576).  Saving model ...
Epoch: 16 cost time: 3.1859920024871826
Epoch: 16, Steps: 9 | Train Loss: 0.135 Vali Loss: 0.418 Vali Acc: 0.797 Test Loss: 0.418 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.060551881790161
Epoch: 17, Steps: 9 | Train Loss: 0.094 Vali Loss: 0.439 Vali Acc: 0.833 Test Loss: 0.439 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.9474639892578125
Epoch: 18, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.439 Vali Acc: 0.848 Test Loss: 0.439 Test Acc: 0.848
Validation loss decreased (-0.840576 --> -0.847822).  Saving model ...
Epoch: 19 cost time: 2.8406262397766113
Epoch: 19, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.443 Vali Acc: 0.848 Test Loss: 0.443 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.016892433166504
Epoch: 20, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.456 Vali Acc: 0.826 Test Loss: 0.456 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.0709004402160645
Epoch: 21, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.454 Vali Acc: 0.848 Test Loss: 0.454 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.8461599349975586
Epoch: 22, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.456 Vali Acc: 0.855 Test Loss: 0.456 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855068).  Saving model ...
Epoch: 23 cost time: 2.8062732219696045
Epoch: 23, Steps: 9 | Train Loss: 0.122 Vali Loss: 0.443 Vali Acc: 0.862 Test Loss: 0.443 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862314).  Saving model ...
Epoch: 24 cost time: 2.99470591545105
Epoch: 24, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.419 Vali Acc: 0.877 Test Loss: 0.419 Test Acc: 0.877
Validation loss decreased (-0.862314 --> -0.876807).  Saving model ...
Epoch: 25 cost time: 3.12164306640625
Epoch: 25, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.413 Vali Acc: 0.877 Test Loss: 0.413 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876807).  Saving model ...
Epoch: 26 cost time: 2.796130418777466
Epoch: 26, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.449 Vali Acc: 0.870 Test Loss: 0.449 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.9682509899139404
Epoch: 27, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.469 Vali Acc: 0.870 Test Loss: 0.469 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.9477481842041016
Epoch: 28, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.518 Vali Acc: 0.848 Test Loss: 0.518 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.164536237716675
Epoch: 29, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.504 Vali Acc: 0.862 Test Loss: 0.504 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.1988680362701416
Epoch: 30, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.448 Vali Acc: 0.884 Test Loss: 0.448 Test Acc: 0.884
Validation loss decreased (-0.876807 --> -0.884053).  Saving model ...
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 892884
model size : 3.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.260919570922852
Epoch: 1, Steps: 9 | Train Loss: 1.410 Vali Loss: 1.411 Vali Acc: 0.326 Test Loss: 1.411 Test Acc: 0.326
Validation loss decreased (inf --> -0.326073).  Saving model ...
Epoch: 2 cost time: 1.9924213886260986
Epoch: 2, Steps: 9 | Train Loss: 1.342 Vali Loss: 1.326 Vali Acc: 0.384 Test Loss: 1.326 Test Acc: 0.384
Validation loss decreased (-0.326073 --> -0.384045).  Saving model ...
Epoch: 3 cost time: 2.0697107315063477
Epoch: 3, Steps: 9 | Train Loss: 1.250 Vali Loss: 1.223 Vali Acc: 0.507 Test Loss: 1.223 Test Acc: 0.507
Validation loss decreased (-0.384045 --> -0.507234).  Saving model ...
Epoch: 4 cost time: 2.066378355026245
Epoch: 4, Steps: 9 | Train Loss: 1.146 Vali Loss: 1.102 Vali Acc: 0.645 Test Loss: 1.102 Test Acc: 0.645
Validation loss decreased (-0.507234 --> -0.644917).  Saving model ...
Epoch: 5 cost time: 2.0535290241241455
Epoch: 5, Steps: 9 | Train Loss: 1.011 Vali Loss: 0.966 Vali Acc: 0.725 Test Loss: 0.966 Test Acc: 0.725
Validation loss decreased (-0.644917 --> -0.724628).  Saving model ...
Epoch: 6 cost time: 2.004944324493408
Epoch: 6, Steps: 9 | Train Loss: 0.851 Vali Loss: 0.827 Vali Acc: 0.746 Test Loss: 0.827 Test Acc: 0.746
Validation loss decreased (-0.724628 --> -0.746369).  Saving model ...
Epoch: 7 cost time: 1.991772174835205
Epoch: 7, Steps: 9 | Train Loss: 0.724 Vali Loss: 0.703 Vali Acc: 0.775 Test Loss: 0.703 Test Acc: 0.775
Validation loss decreased (-0.746369 --> -0.775355).  Saving model ...
Epoch: 8 cost time: 2.0044476985931396
Epoch: 8, Steps: 9 | Train Loss: 0.613 Vali Loss: 0.610 Vali Acc: 0.783 Test Loss: 0.610 Test Acc: 0.783
Validation loss decreased (-0.775355 --> -0.782603).  Saving model ...
Epoch: 9 cost time: 1.888375997543335
Epoch: 9, Steps: 9 | Train Loss: 0.471 Vali Loss: 0.531 Vali Acc: 0.804 Test Loss: 0.531 Test Acc: 0.804
Validation loss decreased (-0.782603 --> -0.804343).  Saving model ...
Epoch: 10 cost time: 2.0121231079101562
Epoch: 10, Steps: 9 | Train Loss: 0.410 Vali Loss: 0.473 Vali Acc: 0.812 Test Loss: 0.473 Test Acc: 0.812
Validation loss decreased (-0.804343 --> -0.811589).  Saving model ...
Epoch: 11 cost time: 2.0857865810394287
Epoch: 11, Steps: 9 | Train Loss: 0.324 Vali Loss: 0.451 Vali Acc: 0.819 Test Loss: 0.451 Test Acc: 0.819
Validation loss decreased (-0.811589 --> -0.818836).  Saving model ...
Epoch: 12 cost time: 2.05672025680542
Epoch: 12, Steps: 9 | Train Loss: 0.261 Vali Loss: 0.415 Vali Acc: 0.841 Test Loss: 0.415 Test Acc: 0.841
Validation loss decreased (-0.818836 --> -0.840576).  Saving model ...
Epoch: 13 cost time: 2.039904832839966
Epoch: 13, Steps: 9 | Train Loss: 0.196 Vali Loss: 0.392 Vali Acc: 0.848 Test Loss: 0.392 Test Acc: 0.848
Validation loss decreased (-0.840576 --> -0.847822).  Saving model ...
Epoch: 14 cost time: 2.1118898391723633
Epoch: 14, Steps: 9 | Train Loss: 0.186 Vali Loss: 0.387 Vali Acc: 0.819 Test Loss: 0.387 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.072521686553955
Epoch: 15, Steps: 9 | Train Loss: 0.149 Vali Loss: 0.366 Vali Acc: 0.833 Test Loss: 0.366 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.154036045074463
Epoch: 16, Steps: 9 | Train Loss: 0.279 Vali Loss: 0.326 Vali Acc: 0.877 Test Loss: 0.326 Test Acc: 0.877
Validation loss decreased (-0.847822 --> -0.876808).  Saving model ...
Epoch: 17 cost time: 2.163531541824341
Epoch: 17, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.294 Vali Acc: 0.884 Test Loss: 0.294 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884055).  Saving model ...
Epoch: 18 cost time: 2.212270975112915
Epoch: 18, Steps: 9 | Train Loss: 0.244 Vali Loss: 0.283 Vali Acc: 0.899 Test Loss: 0.283 Test Acc: 0.899
Validation loss decreased (-0.884055 --> -0.898548).  Saving model ...
Epoch: 19 cost time: 2.176337718963623
Epoch: 19, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.285 Vali Acc: 0.884 Test Loss: 0.285 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.261324644088745
Epoch: 20, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.293 Vali Acc: 0.870 Test Loss: 0.293 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.24072265625
Epoch: 21, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.288 Vali Acc: 0.870 Test Loss: 0.288 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.1912715435028076
Epoch: 22, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.277 Vali Acc: 0.884 Test Loss: 0.277 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.1466996669769287
Epoch: 23, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.277 Vali Acc: 0.884 Test Loss: 0.277 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.1782259941101074
Epoch: 24, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.308 Vali Acc: 0.884 Test Loss: 0.308 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.076685905456543
Epoch: 25, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.279 Vali Acc: 0.906 Test Loss: 0.279 Test Acc: 0.906
Validation loss decreased (-0.898548 --> -0.905794).  Saving model ...
Epoch: 26 cost time: 2.0918846130371094
Epoch: 26, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.267 Vali Acc: 0.906 Test Loss: 0.267 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 27 cost time: 2.151266574859619
Epoch: 27, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.266 Vali Acc: 0.913 Test Loss: 0.266 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913041).  Saving model ...
Epoch: 28 cost time: 2.0009591579437256
Epoch: 28, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.262 Vali Acc: 0.906 Test Loss: 0.262 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.145540475845337
Epoch: 29, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.269 Vali Acc: 0.913 Test Loss: 0.269 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.197376251220703
Epoch: 30, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.284 Vali Acc: 0.913 Test Loss: 0.284 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 272052
model size : 1.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.097870826721191
Epoch: 1, Steps: 9 | Train Loss: 1.372 Vali Loss: 1.320 Vali Acc: 0.399 Test Loss: 1.320 Test Acc: 0.399
Validation loss decreased (inf --> -0.398538).  Saving model ...
Epoch: 2 cost time: 2.131575345993042
Epoch: 2, Steps: 9 | Train Loss: 1.303 Vali Loss: 1.254 Vali Acc: 0.428 Test Loss: 1.254 Test Acc: 0.428
Validation loss decreased (-0.398538 --> -0.427524).  Saving model ...
Epoch: 3 cost time: 2.224677562713623
Epoch: 3, Steps: 9 | Train Loss: 1.172 Vali Loss: 1.168 Vali Acc: 0.500 Test Loss: 1.168 Test Acc: 0.500
Validation loss decreased (-0.427524 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 2.2177791595458984
Epoch: 4, Steps: 9 | Train Loss: 1.060 Vali Loss: 1.081 Vali Acc: 0.565 Test Loss: 1.081 Test Acc: 0.565
Validation loss decreased (-0.499988 --> -0.565207).  Saving model ...
Epoch: 5 cost time: 2.052145004272461
Epoch: 5, Steps: 9 | Train Loss: 0.933 Vali Loss: 0.989 Vali Acc: 0.638 Test Loss: 0.989 Test Acc: 0.638
Validation loss decreased (-0.565207 --> -0.637671).  Saving model ...
Epoch: 6 cost time: 2.1741349697113037
Epoch: 6, Steps: 9 | Train Loss: 0.829 Vali Loss: 0.912 Vali Acc: 0.609 Test Loss: 0.912 Test Acc: 0.609
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.200669050216675
Epoch: 7, Steps: 9 | Train Loss: 0.721 Vali Loss: 0.837 Vali Acc: 0.630 Test Loss: 0.837 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.142956256866455
Epoch: 8, Steps: 9 | Train Loss: 0.607 Vali Loss: 0.797 Vali Acc: 0.638 Test Loss: 0.797 Test Acc: 0.638
Validation loss decreased (-0.637671 --> -0.637673).  Saving model ...
Epoch: 9 cost time: 2.1254332065582275
Epoch: 9, Steps: 9 | Train Loss: 0.517 Vali Loss: 0.735 Vali Acc: 0.667 Test Loss: 0.735 Test Acc: 0.667
Validation loss decreased (-0.637673 --> -0.666659).  Saving model ...
Epoch: 10 cost time: 2.158216714859009
Epoch: 10, Steps: 9 | Train Loss: 0.441 Vali Loss: 0.683 Vali Acc: 0.703 Test Loss: 0.683 Test Acc: 0.703
Validation loss decreased (-0.666659 --> -0.702892).  Saving model ...
Epoch: 11 cost time: 2.161707878112793
Epoch: 11, Steps: 9 | Train Loss: 0.390 Vali Loss: 0.596 Vali Acc: 0.761 Test Loss: 0.596 Test Acc: 0.761
Validation loss decreased (-0.702892 --> -0.760864).  Saving model ...
Epoch: 12 cost time: 2.0736520290374756
Epoch: 12, Steps: 9 | Train Loss: 0.302 Vali Loss: 0.546 Vali Acc: 0.768 Test Loss: 0.546 Test Acc: 0.768
Validation loss decreased (-0.760864 --> -0.768110).  Saving model ...
Epoch: 13 cost time: 2.1724860668182373
Epoch: 13, Steps: 9 | Train Loss: 0.238 Vali Loss: 0.489 Vali Acc: 0.804 Test Loss: 0.489 Test Acc: 0.804
Validation loss decreased (-0.768110 --> -0.804343).  Saving model ...
Epoch: 14 cost time: 2.175849437713623
Epoch: 14, Steps: 9 | Train Loss: 0.245 Vali Loss: 0.452 Vali Acc: 0.826 Test Loss: 0.452 Test Acc: 0.826
Validation loss decreased (-0.804343 --> -0.826082).  Saving model ...
Epoch: 15 cost time: 2.2124102115631104
Epoch: 15, Steps: 9 | Train Loss: 0.148 Vali Loss: 0.445 Vali Acc: 0.826 Test Loss: 0.445 Test Acc: 0.826
Validation loss decreased (-0.826082 --> -0.826083).  Saving model ...
Epoch: 16 cost time: 2.1215405464172363
Epoch: 16, Steps: 9 | Train Loss: 0.130 Vali Loss: 0.473 Vali Acc: 0.812 Test Loss: 0.473 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.000518560409546
Epoch: 17, Steps: 9 | Train Loss: 0.109 Vali Loss: 0.504 Vali Acc: 0.797 Test Loss: 0.504 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.1139724254608154
Epoch: 18, Steps: 9 | Train Loss: 0.087 Vali Loss: 0.445 Vali Acc: 0.826 Test Loss: 0.445 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.1793882846832275
Epoch: 19, Steps: 9 | Train Loss: 0.116 Vali Loss: 0.428 Vali Acc: 0.855 Test Loss: 0.428 Test Acc: 0.855
Validation loss decreased (-0.826083 --> -0.855068).  Saving model ...
Epoch: 20 cost time: 2.346717596054077
Epoch: 20, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.452 Vali Acc: 0.819 Test Loss: 0.452 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.4016294479370117
Epoch: 21, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.453 Vali Acc: 0.819 Test Loss: 0.453 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.260232925415039
Epoch: 22, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.446 Vali Acc: 0.855 Test Loss: 0.446 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.369081735610962
Epoch: 23, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.448 Vali Acc: 0.855 Test Loss: 0.448 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.332873582839966
Epoch: 24, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.427 Vali Acc: 0.870 Test Loss: 0.427 Test Acc: 0.870
Validation loss decreased (-0.855068 --> -0.869561).  Saving model ...
Epoch: 25 cost time: 2.3958139419555664
Epoch: 25, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.387 Vali Acc: 0.891 Test Loss: 0.387 Test Acc: 0.891
Validation loss decreased (-0.869561 --> -0.891300).  Saving model ...
Epoch: 26 cost time: 2.191767930984497
Epoch: 26, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.385 Vali Acc: 0.891 Test Loss: 0.385 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891300).  Saving model ...
Epoch: 27 cost time: 2.1178784370422363
Epoch: 27, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.381 Vali Acc: 0.899 Test Loss: 0.381 Test Acc: 0.899
Validation loss decreased (-0.891300 --> -0.898547).  Saving model ...
Epoch: 28 cost time: 2.3145911693573
Epoch: 28, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.409 Vali Acc: 0.877 Test Loss: 0.409 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.2399187088012695
Epoch: 29, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.431 Vali Acc: 0.877 Test Loss: 0.431 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.2863800525665283
Epoch: 30, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.428 Vali Acc: 0.862 Test Loss: 0.428 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 892884
model size : 3.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.756720781326294
Epoch: 1, Steps: 9 | Train Loss: 1.403 Vali Loss: 1.412 Vali Acc: 0.326 Test Loss: 1.412 Test Acc: 0.326
Validation loss decreased (inf --> -0.326073).  Saving model ...
Epoch: 2 cost time: 1.6947166919708252
Epoch: 2, Steps: 9 | Train Loss: 1.337 Vali Loss: 1.339 Vali Acc: 0.370 Test Loss: 1.339 Test Acc: 0.370
Validation loss decreased (-0.326073 --> -0.369552).  Saving model ...
Epoch: 3 cost time: 1.689028263092041
Epoch: 3, Steps: 9 | Train Loss: 1.262 Vali Loss: 1.252 Vali Acc: 0.449 Test Loss: 1.252 Test Acc: 0.449
Validation loss decreased (-0.369552 --> -0.449263).  Saving model ...
Epoch: 4 cost time: 1.5680861473083496
Epoch: 4, Steps: 9 | Train Loss: 1.164 Vali Loss: 1.153 Vali Acc: 0.558 Test Loss: 1.153 Test Acc: 0.558
Validation loss decreased (-0.449263 --> -0.557959).  Saving model ...
Epoch: 5 cost time: 1.6341681480407715
Epoch: 5, Steps: 9 | Train Loss: 1.045 Vali Loss: 1.040 Vali Acc: 0.601 Test Loss: 1.040 Test Acc: 0.601
Validation loss decreased (-0.557959 --> -0.601439).  Saving model ...
Epoch: 6 cost time: 1.8349542617797852
Epoch: 6, Steps: 9 | Train Loss: 0.913 Vali Loss: 0.927 Vali Acc: 0.645 Test Loss: 0.927 Test Acc: 0.645
Validation loss decreased (-0.601439 --> -0.644918).  Saving model ...
Epoch: 7 cost time: 1.5928621292114258
Epoch: 7, Steps: 9 | Train Loss: 0.780 Vali Loss: 0.813 Vali Acc: 0.703 Test Loss: 0.813 Test Acc: 0.703
Validation loss decreased (-0.644918 --> -0.702890).  Saving model ...
Epoch: 8 cost time: 1.9082164764404297
Epoch: 8, Steps: 9 | Train Loss: 0.684 Vali Loss: 0.717 Vali Acc: 0.754 Test Loss: 0.717 Test Acc: 0.754
Validation loss decreased (-0.702890 --> -0.753616).  Saving model ...
Epoch: 9 cost time: 1.8509492874145508
Epoch: 9, Steps: 9 | Train Loss: 0.560 Vali Loss: 0.631 Vali Acc: 0.812 Test Loss: 0.631 Test Acc: 0.812
Validation loss decreased (-0.753616 --> -0.811588).  Saving model ...
Epoch: 10 cost time: 1.7874186038970947
Epoch: 10, Steps: 9 | Train Loss: 0.474 Vali Loss: 0.560 Vali Acc: 0.804 Test Loss: 0.560 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7748358249664307
Epoch: 11, Steps: 9 | Train Loss: 0.375 Vali Loss: 0.513 Vali Acc: 0.819 Test Loss: 0.513 Test Acc: 0.819
Validation loss decreased (-0.811588 --> -0.818835).  Saving model ...
Epoch: 12 cost time: 1.6865794658660889
Epoch: 12, Steps: 9 | Train Loss: 0.305 Vali Loss: 0.495 Vali Acc: 0.804 Test Loss: 0.495 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7379701137542725
Epoch: 13, Steps: 9 | Train Loss: 0.243 Vali Loss: 0.479 Vali Acc: 0.826 Test Loss: 0.479 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826082).  Saving model ...
Epoch: 14 cost time: 1.7559537887573242
Epoch: 14, Steps: 9 | Train Loss: 0.204 Vali Loss: 0.415 Vali Acc: 0.841 Test Loss: 0.415 Test Acc: 0.841
Validation loss decreased (-0.826082 --> -0.840576).  Saving model ...
Epoch: 15 cost time: 1.8383901119232178
Epoch: 15, Steps: 9 | Train Loss: 0.166 Vali Loss: 0.383 Vali Acc: 0.870 Test Loss: 0.383 Test Acc: 0.870
Validation loss decreased (-0.840576 --> -0.869561).  Saving model ...
Epoch: 16 cost time: 1.8101820945739746
Epoch: 16, Steps: 9 | Train Loss: 0.141 Vali Loss: 0.347 Vali Acc: 0.877 Test Loss: 0.347 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876808).  Saving model ...
Epoch: 17 cost time: 1.7402567863464355
Epoch: 17, Steps: 9 | Train Loss: 0.113 Vali Loss: 0.333 Vali Acc: 0.870 Test Loss: 0.333 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7205734252929688
Epoch: 18, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.295 Vali Acc: 0.891 Test Loss: 0.295 Test Acc: 0.891
Validation loss decreased (-0.876808 --> -0.891301).  Saving model ...
Epoch: 19 cost time: 1.6500067710876465
Epoch: 19, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.306 Vali Acc: 0.870 Test Loss: 0.306 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6441917419433594
Epoch: 20, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.365 Vali Acc: 0.855 Test Loss: 0.365 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.6502909660339355
Epoch: 21, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.334 Vali Acc: 0.862 Test Loss: 0.334 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.6430509090423584
Epoch: 22, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.312 Vali Acc: 0.870 Test Loss: 0.312 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.5094707012176514
Epoch: 23, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.314 Vali Acc: 0.862 Test Loss: 0.314 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.4886329174041748
Epoch: 24, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.316 Vali Acc: 0.870 Test Loss: 0.316 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.4531664848327637
Epoch: 25, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.306 Vali Acc: 0.884 Test Loss: 0.306 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.613215684890747
Epoch: 26, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.274 Vali Acc: 0.884 Test Loss: 0.274 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.62650728225708
Epoch: 27, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.250 Vali Acc: 0.928 Test Loss: 0.250 Test Acc: 0.928
Validation loss decreased (-0.891301 --> -0.927534).  Saving model ...
Epoch: 28 cost time: 1.777116298675537
Epoch: 28, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.254 Vali Acc: 0.899 Test Loss: 0.254 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.7184982299804688
Epoch: 29, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.259 Vali Acc: 0.906 Test Loss: 0.259 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.5537688732147217
Epoch: 30, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.265 Vali Acc: 0.913 Test Loss: 0.265 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.927536231884058
model parameter : 272052
model size : 1.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.988023519515991
Epoch: 1, Steps: 9 | Train Loss: 1.397 Vali Loss: 1.366 Vali Acc: 0.362 Test Loss: 1.366 Test Acc: 0.362
Validation loss decreased (inf --> -0.362305).  Saving model ...
Epoch: 2 cost time: 3.0726993083953857
Epoch: 2, Steps: 9 | Train Loss: 1.272 Vali Loss: 1.261 Vali Acc: 0.420 Test Loss: 1.261 Test Acc: 0.420
Validation loss decreased (-0.362305 --> -0.420277).  Saving model ...
Epoch: 3 cost time: 3.177867889404297
Epoch: 3, Steps: 9 | Train Loss: 1.131 Vali Loss: 1.131 Vali Acc: 0.551 Test Loss: 1.131 Test Acc: 0.551
Validation loss decreased (-0.420277 --> -0.550713).  Saving model ...
Epoch: 4 cost time: 3.1166226863861084
Epoch: 4, Steps: 9 | Train Loss: 1.000 Vali Loss: 1.003 Vali Acc: 0.609 Test Loss: 1.003 Test Acc: 0.609
Validation loss decreased (-0.550713 --> -0.608686).  Saving model ...
Epoch: 5 cost time: 2.983417272567749
Epoch: 5, Steps: 9 | Train Loss: 0.846 Vali Loss: 0.884 Vali Acc: 0.652 Test Loss: 0.884 Test Acc: 0.652
Validation loss decreased (-0.608686 --> -0.652165).  Saving model ...
Epoch: 6 cost time: 3.051118850708008
Epoch: 6, Steps: 9 | Train Loss: 0.712 Vali Loss: 0.760 Vali Acc: 0.739 Test Loss: 0.760 Test Acc: 0.739
Validation loss decreased (-0.652165 --> -0.739123).  Saving model ...
Epoch: 7 cost time: 3.116929054260254
Epoch: 7, Steps: 9 | Train Loss: 0.638 Vali Loss: 0.650 Vali Acc: 0.783 Test Loss: 0.650 Test Acc: 0.783
Validation loss decreased (-0.739123 --> -0.782602).  Saving model ...
Epoch: 8 cost time: 2.938131093978882
Epoch: 8, Steps: 9 | Train Loss: 0.480 Vali Loss: 0.566 Vali Acc: 0.783 Test Loss: 0.566 Test Acc: 0.783
Validation loss decreased (-0.782602 --> -0.782603).  Saving model ...
Epoch: 9 cost time: 3.0295073986053467
Epoch: 9, Steps: 9 | Train Loss: 0.392 Vali Loss: 0.502 Vali Acc: 0.790 Test Loss: 0.502 Test Acc: 0.790
Validation loss decreased (-0.782603 --> -0.789850).  Saving model ...
Epoch: 10 cost time: 3.245239496231079
Epoch: 10, Steps: 9 | Train Loss: 0.321 Vali Loss: 0.473 Vali Acc: 0.804 Test Loss: 0.473 Test Acc: 0.804
Validation loss decreased (-0.789850 --> -0.804343).  Saving model ...
Epoch: 11 cost time: 3.250154495239258
Epoch: 11, Steps: 9 | Train Loss: 0.294 Vali Loss: 0.463 Vali Acc: 0.812 Test Loss: 0.463 Test Acc: 0.812
Validation loss decreased (-0.804343 --> -0.811590).  Saving model ...
Epoch: 12 cost time: 3.2590081691741943
Epoch: 12, Steps: 9 | Train Loss: 0.255 Vali Loss: 0.451 Vali Acc: 0.819 Test Loss: 0.451 Test Acc: 0.819
Validation loss decreased (-0.811590 --> -0.818836).  Saving model ...
Epoch: 13 cost time: 3.1597580909729004
Epoch: 13, Steps: 9 | Train Loss: 0.210 Vali Loss: 0.418 Vali Acc: 0.833 Test Loss: 0.418 Test Acc: 0.833
Validation loss decreased (-0.818836 --> -0.833329).  Saving model ...
Epoch: 14 cost time: 3.0917513370513916
Epoch: 14, Steps: 9 | Train Loss: 0.180 Vali Loss: 0.417 Vali Acc: 0.841 Test Loss: 0.417 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840576).  Saving model ...
Epoch: 15 cost time: 2.955744981765747
Epoch: 15, Steps: 9 | Train Loss: 0.130 Vali Loss: 0.417 Vali Acc: 0.833 Test Loss: 0.417 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.967482328414917
Epoch: 16, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.429 Vali Acc: 0.833 Test Loss: 0.429 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.9246881008148193
Epoch: 17, Steps: 9 | Train Loss: 0.102 Vali Loss: 0.418 Vali Acc: 0.841 Test Loss: 0.418 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.9933063983917236
Epoch: 18, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.391 Vali Acc: 0.833 Test Loss: 0.391 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.0986831188201904
Epoch: 19, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.403 Vali Acc: 0.833 Test Loss: 0.403 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.0332653522491455
Epoch: 20, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.421 Vali Acc: 0.833 Test Loss: 0.421 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.1583430767059326
Epoch: 21, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.436 Vali Acc: 0.841 Test Loss: 0.436 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.138798713684082
Epoch: 22, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.439 Vali Acc: 0.826 Test Loss: 0.439 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.136367082595825
Epoch: 23, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.437 Vali Acc: 0.833 Test Loss: 0.437 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.290428876876831
Epoch: 24, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.481 Vali Acc: 0.826 Test Loss: 0.481 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8405797101449275
model parameter : 453300
model size : 2.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.072901248931885
Epoch: 1, Steps: 9 | Train Loss: 1.449 Vali Loss: 1.381 Vali Acc: 0.341 Test Loss: 1.381 Test Acc: 0.341
Validation loss decreased (inf --> -0.340566).  Saving model ...
Epoch: 2 cost time: 2.1324071884155273
Epoch: 2, Steps: 9 | Train Loss: 1.332 Vali Loss: 1.268 Vali Acc: 0.449 Test Loss: 1.268 Test Acc: 0.449
Validation loss decreased (-0.340566 --> -0.449263).  Saving model ...
Epoch: 3 cost time: 2.247941255569458
Epoch: 3, Steps: 9 | Train Loss: 1.198 Vali Loss: 1.148 Vali Acc: 0.522 Test Loss: 1.148 Test Acc: 0.522
Validation loss decreased (-0.449263 --> -0.521728).  Saving model ...
Epoch: 4 cost time: 2.279820442199707
Epoch: 4, Steps: 9 | Train Loss: 1.064 Vali Loss: 1.056 Vali Acc: 0.543 Test Loss: 1.056 Test Acc: 0.543
Validation loss decreased (-0.521728 --> -0.543468).  Saving model ...
Epoch: 5 cost time: 2.4337611198425293
Epoch: 5, Steps: 9 | Train Loss: 0.920 Vali Loss: 0.971 Vali Acc: 0.572 Test Loss: 0.971 Test Acc: 0.572
Validation loss decreased (-0.543468 --> -0.572454).  Saving model ...
Epoch: 6 cost time: 2.3094842433929443
Epoch: 6, Steps: 9 | Train Loss: 0.790 Vali Loss: 0.895 Vali Acc: 0.623 Test Loss: 0.895 Test Acc: 0.623
Validation loss decreased (-0.572454 --> -0.623179).  Saving model ...
Epoch: 7 cost time: 2.3999133110046387
Epoch: 7, Steps: 9 | Train Loss: 0.702 Vali Loss: 0.810 Vali Acc: 0.645 Test Loss: 0.810 Test Acc: 0.645
Validation loss decreased (-0.623179 --> -0.644919).  Saving model ...
Epoch: 8 cost time: 2.3733530044555664
Epoch: 8, Steps: 9 | Train Loss: 0.565 Vali Loss: 0.714 Vali Acc: 0.732 Test Loss: 0.714 Test Acc: 0.732
Validation loss decreased (-0.644919 --> -0.731877).  Saving model ...
Epoch: 9 cost time: 2.2813258171081543
Epoch: 9, Steps: 9 | Train Loss: 0.498 Vali Loss: 0.634 Vali Acc: 0.768 Test Loss: 0.634 Test Acc: 0.768
Validation loss decreased (-0.731877 --> -0.768110).  Saving model ...
Epoch: 10 cost time: 2.4150424003601074
Epoch: 10, Steps: 9 | Train Loss: 0.395 Vali Loss: 0.574 Vali Acc: 0.790 Test Loss: 0.574 Test Acc: 0.790
Validation loss decreased (-0.768110 --> -0.789849).  Saving model ...
Epoch: 11 cost time: 2.3402633666992188
Epoch: 11, Steps: 9 | Train Loss: 0.310 Vali Loss: 0.520 Vali Acc: 0.775 Test Loss: 0.520 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.455308198928833
Epoch: 12, Steps: 9 | Train Loss: 0.275 Vali Loss: 0.512 Vali Acc: 0.819 Test Loss: 0.512 Test Acc: 0.819
Validation loss decreased (-0.789849 --> -0.818835).  Saving model ...
Epoch: 13 cost time: 2.2858529090881348
Epoch: 13, Steps: 9 | Train Loss: 0.241 Vali Loss: 0.474 Vali Acc: 0.841 Test Loss: 0.474 Test Acc: 0.841
Validation loss decreased (-0.818835 --> -0.840575).  Saving model ...
Epoch: 14 cost time: 2.3295750617980957
Epoch: 14, Steps: 9 | Train Loss: 0.192 Vali Loss: 0.479 Vali Acc: 0.826 Test Loss: 0.479 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.1125876903533936
Epoch: 15, Steps: 9 | Train Loss: 0.144 Vali Loss: 0.468 Vali Acc: 0.848 Test Loss: 0.468 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847821).  Saving model ...
Epoch: 16 cost time: 2.235598087310791
Epoch: 16, Steps: 9 | Train Loss: 0.128 Vali Loss: 0.447 Vali Acc: 0.848 Test Loss: 0.447 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847822).  Saving model ...
Epoch: 17 cost time: 2.234757661819458
Epoch: 17, Steps: 9 | Train Loss: 0.134 Vali Loss: 0.448 Vali Acc: 0.848 Test Loss: 0.448 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.2456510066986084
Epoch: 18, Steps: 9 | Train Loss: 0.102 Vali Loss: 0.422 Vali Acc: 0.848 Test Loss: 0.422 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 19 cost time: 2.3078765869140625
Epoch: 19, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.436 Vali Acc: 0.855 Test Loss: 0.436 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855068).  Saving model ...
Epoch: 20 cost time: 2.2632997035980225
Epoch: 20, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.445 Vali Acc: 0.855 Test Loss: 0.445 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.228020668029785
Epoch: 21, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.410 Vali Acc: 0.848 Test Loss: 0.410 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.2943739891052246
Epoch: 22, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.431 Vali Acc: 0.833 Test Loss: 0.431 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.3377344608306885
Epoch: 23, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.434 Vali Acc: 0.819 Test Loss: 0.434 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.2980997562408447
Epoch: 24, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.397 Vali Acc: 0.855 Test Loss: 0.397 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 25 cost time: 2.3707687854766846
Epoch: 25, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.401 Vali Acc: 0.855 Test Loss: 0.401 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.456339120864868
Epoch: 26, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.409 Vali Acc: 0.862 Test Loss: 0.409 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862315).  Saving model ...
Epoch: 27 cost time: 2.3939523696899414
Epoch: 27, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.401 Vali Acc: 0.862 Test Loss: 0.401 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 28 cost time: 2.334087371826172
Epoch: 28, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.385 Vali Acc: 0.855 Test Loss: 0.385 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.309084892272949
Epoch: 29, Steps: 9 | Train Loss: 0.120 Vali Loss: 0.378 Vali Acc: 0.877 Test Loss: 0.378 Test Acc: 0.877
Validation loss decreased (-0.862315 --> -0.876808).  Saving model ...
Epoch: 30 cost time: 2.355123996734619
Epoch: 30, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.381 Vali Acc: 0.884 Test Loss: 0.381 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884054).  Saving model ...
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 142836
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.488043546676636
Epoch: 1, Steps: 9 | Train Loss: 1.394 Vali Loss: 1.369 Vali Acc: 0.341 Test Loss: 1.369 Test Acc: 0.341
Validation loss decreased (inf --> -0.340566).  Saving model ...
Epoch: 2 cost time: 2.5474820137023926
Epoch: 2, Steps: 9 | Train Loss: 1.275 Vali Loss: 1.266 Vali Acc: 0.413 Test Loss: 1.266 Test Acc: 0.413
Validation loss decreased (-0.340566 --> -0.413031).  Saving model ...
Epoch: 3 cost time: 2.444025754928589
Epoch: 3, Steps: 9 | Train Loss: 1.141 Vali Loss: 1.137 Vali Acc: 0.551 Test Loss: 1.137 Test Acc: 0.551
Validation loss decreased (-0.413031 --> -0.550713).  Saving model ...
Epoch: 4 cost time: 2.603168249130249
Epoch: 4, Steps: 9 | Train Loss: 1.011 Vali Loss: 1.017 Vali Acc: 0.594 Test Loss: 1.017 Test Acc: 0.594
Validation loss decreased (-0.550713 --> -0.594193).  Saving model ...
Epoch: 5 cost time: 2.658524513244629
Epoch: 5, Steps: 9 | Train Loss: 0.868 Vali Loss: 0.909 Vali Acc: 0.652 Test Loss: 0.909 Test Acc: 0.652
Validation loss decreased (-0.594193 --> -0.652165).  Saving model ...
Epoch: 6 cost time: 2.514305353164673
Epoch: 6, Steps: 9 | Train Loss: 0.748 Vali Loss: 0.802 Vali Acc: 0.703 Test Loss: 0.802 Test Acc: 0.703
Validation loss decreased (-0.652165 --> -0.702891).  Saving model ...
Epoch: 7 cost time: 2.6397366523742676
Epoch: 7, Steps: 9 | Train Loss: 0.682 Vali Loss: 0.710 Vali Acc: 0.754 Test Loss: 0.710 Test Acc: 0.754
Validation loss decreased (-0.702891 --> -0.753616).  Saving model ...
Epoch: 8 cost time: 2.6395680904388428
Epoch: 8, Steps: 9 | Train Loss: 0.514 Vali Loss: 0.622 Vali Acc: 0.775 Test Loss: 0.622 Test Acc: 0.775
Validation loss decreased (-0.753616 --> -0.775356).  Saving model ...
Epoch: 9 cost time: 2.632488489151001
Epoch: 9, Steps: 9 | Train Loss: 0.439 Vali Loss: 0.560 Vali Acc: 0.783 Test Loss: 0.560 Test Acc: 0.783
Validation loss decreased (-0.775356 --> -0.782603).  Saving model ...
Epoch: 10 cost time: 2.8552424907684326
Epoch: 10, Steps: 9 | Train Loss: 0.366 Vali Loss: 0.535 Vali Acc: 0.797 Test Loss: 0.535 Test Acc: 0.797
Validation loss decreased (-0.782603 --> -0.797096).  Saving model ...
Epoch: 11 cost time: 2.8758015632629395
Epoch: 11, Steps: 9 | Train Loss: 0.329 Vali Loss: 0.507 Vali Acc: 0.790 Test Loss: 0.507 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.9086790084838867
Epoch: 12, Steps: 9 | Train Loss: 0.269 Vali Loss: 0.482 Vali Acc: 0.812 Test Loss: 0.482 Test Acc: 0.812
Validation loss decreased (-0.797096 --> -0.811589).  Saving model ...
Epoch: 13 cost time: 2.7035019397735596
Epoch: 13, Steps: 9 | Train Loss: 0.220 Vali Loss: 0.451 Vali Acc: 0.826 Test Loss: 0.451 Test Acc: 0.826
Validation loss decreased (-0.811589 --> -0.826082).  Saving model ...
Epoch: 14 cost time: 2.6500353813171387
Epoch: 14, Steps: 9 | Train Loss: 0.279 Vali Loss: 0.449 Vali Acc: 0.826 Test Loss: 0.449 Test Acc: 0.826
Validation loss decreased (-0.826082 --> -0.826082).  Saving model ...
Epoch: 15 cost time: 2.7224767208099365
Epoch: 15, Steps: 9 | Train Loss: 0.141 Vali Loss: 0.421 Vali Acc: 0.826 Test Loss: 0.421 Test Acc: 0.826
Validation loss decreased (-0.826082 --> -0.826083).  Saving model ...
Epoch: 16 cost time: 2.65085768699646
Epoch: 16, Steps: 9 | Train Loss: 0.185 Vali Loss: 0.437 Vali Acc: 0.841 Test Loss: 0.437 Test Acc: 0.841
Validation loss decreased (-0.826083 --> -0.840575).  Saving model ...
Epoch: 17 cost time: 2.649247884750366
Epoch: 17, Steps: 9 | Train Loss: 0.098 Vali Loss: 0.440 Vali Acc: 0.848 Test Loss: 0.440 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847822).  Saving model ...
Epoch: 18 cost time: 2.810075283050537
Epoch: 18, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.411 Vali Acc: 0.826 Test Loss: 0.411 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.471712112426758
Epoch: 19, Steps: 9 | Train Loss: 0.089 Vali Loss: 0.436 Vali Acc: 0.833 Test Loss: 0.436 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.4757328033447266
Epoch: 20, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.458 Vali Acc: 0.833 Test Loss: 0.458 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.533336639404297
Epoch: 21, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.444 Vali Acc: 0.841 Test Loss: 0.444 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.6532504558563232
Epoch: 22, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.417 Vali Acc: 0.833 Test Loss: 0.417 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.688321352005005
Epoch: 23, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.427 Vali Acc: 0.848 Test Loss: 0.427 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 24 cost time: 2.7238247394561768
Epoch: 24, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.464 Vali Acc: 0.848 Test Loss: 0.464 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.76177978515625
Epoch: 25, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.457 Vali Acc: 0.848 Test Loss: 0.457 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.7052977085113525
Epoch: 26, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.428 Vali Acc: 0.841 Test Loss: 0.428 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.7727625370025635
Epoch: 27, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.460 Vali Acc: 0.855 Test Loss: 0.460 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855068).  Saving model ...
Epoch: 28 cost time: 2.8606221675872803
Epoch: 28, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.485 Vali Acc: 0.841 Test Loss: 0.485 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.688485860824585
Epoch: 29, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.475 Vali Acc: 0.855 Test Loss: 0.475 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.6555392742156982
Epoch: 30, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.462 Vali Acc: 0.862 Test Loss: 0.462 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862314).  Saving model ...
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 453300
model size : 2.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.7200586795806885
Epoch: 1, Steps: 9 | Train Loss: 1.438 Vali Loss: 1.371 Vali Acc: 0.341 Test Loss: 1.371 Test Acc: 0.341
Validation loss decreased (inf --> -0.340566).  Saving model ...
Epoch: 2 cost time: 1.769881010055542
Epoch: 2, Steps: 9 | Train Loss: 1.332 Vali Loss: 1.262 Vali Acc: 0.464 Test Loss: 1.262 Test Acc: 0.464
Validation loss decreased (-0.340566 --> -0.463755).  Saving model ...
Epoch: 3 cost time: 1.8219585418701172
Epoch: 3, Steps: 9 | Train Loss: 1.204 Vali Loss: 1.146 Vali Acc: 0.522 Test Loss: 1.146 Test Acc: 0.522
Validation loss decreased (-0.463755 --> -0.521728).  Saving model ...
Epoch: 4 cost time: 1.8504068851470947
Epoch: 4, Steps: 9 | Train Loss: 1.067 Vali Loss: 1.058 Vali Acc: 0.551 Test Loss: 1.058 Test Acc: 0.551
Validation loss decreased (-0.521728 --> -0.550714).  Saving model ...
Epoch: 5 cost time: 1.8710081577301025
Epoch: 5, Steps: 9 | Train Loss: 0.928 Vali Loss: 0.981 Vali Acc: 0.558 Test Loss: 0.981 Test Acc: 0.558
Validation loss decreased (-0.550714 --> -0.557961).  Saving model ...
Epoch: 6 cost time: 1.9853804111480713
Epoch: 6, Steps: 9 | Train Loss: 0.796 Vali Loss: 0.912 Vali Acc: 0.587 Test Loss: 0.912 Test Acc: 0.587
Validation loss decreased (-0.557961 --> -0.586947).  Saving model ...
Epoch: 7 cost time: 1.8616302013397217
Epoch: 7, Steps: 9 | Train Loss: 0.718 Vali Loss: 0.841 Vali Acc: 0.630 Test Loss: 0.841 Test Acc: 0.630
Validation loss decreased (-0.586947 --> -0.630426).  Saving model ...
Epoch: 8 cost time: 1.958155632019043
Epoch: 8, Steps: 9 | Train Loss: 0.594 Vali Loss: 0.762 Vali Acc: 0.696 Test Loss: 0.762 Test Acc: 0.696
Validation loss decreased (-0.630426 --> -0.695645).  Saving model ...
Epoch: 9 cost time: 1.8865694999694824
Epoch: 9, Steps: 9 | Train Loss: 0.531 Vali Loss: 0.685 Vali Acc: 0.746 Test Loss: 0.685 Test Acc: 0.746
Validation loss decreased (-0.695645 --> -0.746370).  Saving model ...
Epoch: 10 cost time: 1.9549157619476318
Epoch: 10, Steps: 9 | Train Loss: 0.437 Vali Loss: 0.632 Vali Acc: 0.754 Test Loss: 0.632 Test Acc: 0.754
Validation loss decreased (-0.746370 --> -0.753617).  Saving model ...
Epoch: 11 cost time: 1.9534728527069092
Epoch: 11, Steps: 9 | Train Loss: 0.361 Vali Loss: 0.581 Vali Acc: 0.768 Test Loss: 0.581 Test Acc: 0.768
Validation loss decreased (-0.753617 --> -0.768110).  Saving model ...
Epoch: 12 cost time: 1.9265599250793457
Epoch: 12, Steps: 9 | Train Loss: 0.309 Vali Loss: 0.567 Vali Acc: 0.768 Test Loss: 0.567 Test Acc: 0.768
Validation loss decreased (-0.768110 --> -0.768110).  Saving model ...
Epoch: 13 cost time: 1.995905876159668
Epoch: 13, Steps: 9 | Train Loss: 0.268 Vali Loss: 0.519 Vali Acc: 0.775 Test Loss: 0.519 Test Acc: 0.775
Validation loss decreased (-0.768110 --> -0.775357).  Saving model ...
Epoch: 14 cost time: 1.9992790222167969
Epoch: 14, Steps: 9 | Train Loss: 0.211 Vali Loss: 0.529 Vali Acc: 0.783 Test Loss: 0.529 Test Acc: 0.783
Validation loss decreased (-0.775357 --> -0.782603).  Saving model ...
Epoch: 15 cost time: 1.7879664897918701
Epoch: 15, Steps: 9 | Train Loss: 0.158 Vali Loss: 0.495 Vali Acc: 0.804 Test Loss: 0.495 Test Acc: 0.804
Validation loss decreased (-0.782603 --> -0.804343).  Saving model ...
Epoch: 16 cost time: 1.9612843990325928
Epoch: 16, Steps: 9 | Train Loss: 0.153 Vali Loss: 0.477 Vali Acc: 0.797 Test Loss: 0.477 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9236657619476318
Epoch: 17, Steps: 9 | Train Loss: 0.141 Vali Loss: 0.477 Vali Acc: 0.797 Test Loss: 0.477 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.0052549839019775
Epoch: 18, Steps: 9 | Train Loss: 0.122 Vali Loss: 0.487 Vali Acc: 0.790 Test Loss: 0.487 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.9138352870941162
Epoch: 19, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.501 Vali Acc: 0.790 Test Loss: 0.501 Test Acc: 0.790
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.0427284240722656
Epoch: 20, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.449 Vali Acc: 0.819 Test Loss: 0.449 Test Acc: 0.819
Validation loss decreased (-0.804343 --> -0.818836).  Saving model ...
Epoch: 21 cost time: 1.7214443683624268
Epoch: 21, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.452 Vali Acc: 0.826 Test Loss: 0.452 Test Acc: 0.826
Validation loss decreased (-0.818836 --> -0.826082).  Saving model ...
Epoch: 22 cost time: 1.8644373416900635
Epoch: 22, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.476 Vali Acc: 0.804 Test Loss: 0.476 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.7096545696258545
Epoch: 23, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.483 Vali Acc: 0.804 Test Loss: 0.483 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.6855146884918213
Epoch: 24, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.435 Vali Acc: 0.819 Test Loss: 0.435 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.6203162670135498
Epoch: 25, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.440 Vali Acc: 0.819 Test Loss: 0.440 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.665341854095459
Epoch: 26, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.440 Vali Acc: 0.812 Test Loss: 0.440 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.8355393409729004
Epoch: 27, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.441 Vali Acc: 0.819 Test Loss: 0.441 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.9062104225158691
Epoch: 28, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.440 Vali Acc: 0.819 Test Loss: 0.440 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.82326340675354
Epoch: 29, Steps: 9 | Train Loss: 0.112 Vali Loss: 0.413 Vali Acc: 0.841 Test Loss: 0.413 Test Acc: 0.841
Validation loss decreased (-0.826082 --> -0.840576).  Saving model ...
Epoch: 30 cost time: 1.8191757202148438
Epoch: 30, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.408 Vali Acc: 0.848 Test Loss: 0.408 Test Acc: 0.848
Validation loss decreased (-0.840576 --> -0.847822).  Saving model ...
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 142836
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.1579413414001465
Epoch: 1, Steps: 9 | Train Loss: 1.395 Vali Loss: 1.365 Vali Acc: 0.362 Test Loss: 1.365 Test Acc: 0.362
Validation loss decreased (inf --> -0.362305).  Saving model ...
Epoch: 2 cost time: 1.9847748279571533
Epoch: 2, Steps: 9 | Train Loss: 1.281 Vali Loss: 1.269 Vali Acc: 0.413 Test Loss: 1.269 Test Acc: 0.413
Validation loss decreased (-0.362305 --> -0.413031).  Saving model ...
Epoch: 3 cost time: 2.19167160987854
Epoch: 3, Steps: 9 | Train Loss: 1.149 Vali Loss: 1.151 Vali Acc: 0.529 Test Loss: 1.151 Test Acc: 0.529
Validation loss decreased (-0.413031 --> -0.528974).  Saving model ...
Epoch: 4 cost time: 2.2283027172088623
Epoch: 4, Steps: 9 | Train Loss: 1.030 Vali Loss: 1.049 Vali Acc: 0.580 Test Loss: 1.049 Test Acc: 0.580
Validation loss decreased (-0.528974 --> -0.579700).  Saving model ...
Epoch: 5 cost time: 2.1605162620544434
Epoch: 5, Steps: 9 | Train Loss: 0.891 Vali Loss: 0.960 Vali Acc: 0.623 Test Loss: 0.960 Test Acc: 0.623
Validation loss decreased (-0.579700 --> -0.623179).  Saving model ...
Epoch: 6 cost time: 2.2207632064819336
Epoch: 6, Steps: 9 | Train Loss: 0.795 Vali Loss: 0.883 Vali Acc: 0.681 Test Loss: 0.883 Test Acc: 0.681
Validation loss decreased (-0.623179 --> -0.681151).  Saving model ...
Epoch: 7 cost time: 2.184875965118408
Epoch: 7, Steps: 9 | Train Loss: 0.716 Vali Loss: 0.823 Vali Acc: 0.681 Test Loss: 0.823 Test Acc: 0.681
Validation loss decreased (-0.681151 --> -0.681151).  Saving model ...
Epoch: 8 cost time: 2.008307933807373
Epoch: 8, Steps: 9 | Train Loss: 0.601 Vali Loss: 0.762 Vali Acc: 0.710 Test Loss: 0.762 Test Acc: 0.710
Validation loss decreased (-0.681151 --> -0.710137).  Saving model ...
Epoch: 9 cost time: 2.215710401535034
Epoch: 9, Steps: 9 | Train Loss: 0.517 Vali Loss: 0.697 Vali Acc: 0.725 Test Loss: 0.697 Test Acc: 0.725
Validation loss decreased (-0.710137 --> -0.724631).  Saving model ...
Epoch: 10 cost time: 1.9368641376495361
Epoch: 10, Steps: 9 | Train Loss: 0.428 Vali Loss: 0.651 Vali Acc: 0.746 Test Loss: 0.651 Test Acc: 0.746
Validation loss decreased (-0.724631 --> -0.746370).  Saving model ...
Epoch: 11 cost time: 2.1386959552764893
Epoch: 11, Steps: 9 | Train Loss: 0.383 Vali Loss: 0.604 Vali Acc: 0.775 Test Loss: 0.604 Test Acc: 0.775
Validation loss decreased (-0.746370 --> -0.775356).  Saving model ...
Epoch: 12 cost time: 2.180063009262085
Epoch: 12, Steps: 9 | Train Loss: 0.308 Vali Loss: 0.566 Vali Acc: 0.790 Test Loss: 0.566 Test Acc: 0.790
Validation loss decreased (-0.775356 --> -0.789849).  Saving model ...
Epoch: 13 cost time: 2.0379087924957275
Epoch: 13, Steps: 9 | Train Loss: 0.242 Vali Loss: 0.536 Vali Acc: 0.783 Test Loss: 0.536 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.2916297912597656
Epoch: 14, Steps: 9 | Train Loss: 0.200 Vali Loss: 0.523 Vali Acc: 0.790 Test Loss: 0.523 Test Acc: 0.790
Validation loss decreased (-0.789849 --> -0.789850).  Saving model ...
Epoch: 15 cost time: 2.1951465606689453
Epoch: 15, Steps: 9 | Train Loss: 0.161 Vali Loss: 0.531 Vali Acc: 0.790 Test Loss: 0.531 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.2321596145629883
Epoch: 16, Steps: 9 | Train Loss: 0.138 Vali Loss: 0.516 Vali Acc: 0.783 Test Loss: 0.516 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.1545896530151367
Epoch: 17, Steps: 9 | Train Loss: 0.102 Vali Loss: 0.504 Vali Acc: 0.797 Test Loss: 0.504 Test Acc: 0.797
Validation loss decreased (-0.789850 --> -0.797096).  Saving model ...
Epoch: 18 cost time: 2.250211477279663
Epoch: 18, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.509 Vali Acc: 0.812 Test Loss: 0.509 Test Acc: 0.812
Validation loss decreased (-0.797096 --> -0.811589).  Saving model ...
Epoch: 19 cost time: 2.1608681678771973
Epoch: 19, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.510 Vali Acc: 0.804 Test Loss: 0.510 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.0115857124328613
Epoch: 20, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.522 Vali Acc: 0.804 Test Loss: 0.522 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.0771470069885254
Epoch: 21, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.519 Vali Acc: 0.826 Test Loss: 0.519 Test Acc: 0.826
Validation loss decreased (-0.811589 --> -0.826082).  Saving model ...
Epoch: 22 cost time: 2.0448248386383057
Epoch: 22, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.491 Vali Acc: 0.826 Test Loss: 0.491 Test Acc: 0.826
Validation loss decreased (-0.826082 --> -0.826082).  Saving model ...
Epoch: 23 cost time: 2.091998815536499
Epoch: 23, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.456 Vali Acc: 0.841 Test Loss: 0.456 Test Acc: 0.841
Validation loss decreased (-0.826082 --> -0.840575).  Saving model ...
Epoch: 24 cost time: 1.9884331226348877
Epoch: 24, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.478 Vali Acc: 0.848 Test Loss: 0.478 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847821).  Saving model ...
Epoch: 25 cost time: 2.1547765731811523
Epoch: 25, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.482 Vali Acc: 0.848 Test Loss: 0.482 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.1217758655548096
Epoch: 26, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.479 Vali Acc: 0.848 Test Loss: 0.479 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.1970739364624023
Epoch: 27, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.461 Vali Acc: 0.855 Test Loss: 0.461 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855068).  Saving model ...
Epoch: 28 cost time: 2.1405909061431885
Epoch: 28, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.465 Vali Acc: 0.855 Test Loss: 0.465 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.1500561237335205
Epoch: 29, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.456 Vali Acc: 0.855 Test Loss: 0.456 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 30 cost time: 2.132089376449585
Epoch: 30, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.493 Vali Acc: 0.855 Test Loss: 0.493 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 453300
model size : 2.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.564103841781616
Epoch: 1, Steps: 9 | Train Loss: 1.439 Vali Loss: 1.366 Vali Acc: 0.326 Test Loss: 1.366 Test Acc: 0.326
Validation loss decreased (inf --> -0.326073).  Saving model ...
Epoch: 2 cost time: 1.5339221954345703
Epoch: 2, Steps: 9 | Train Loss: 1.329 Vali Loss: 1.259 Vali Acc: 0.464 Test Loss: 1.259 Test Acc: 0.464
Validation loss decreased (-0.326073 --> -0.463756).  Saving model ...
Epoch: 3 cost time: 1.5869276523590088
Epoch: 3, Steps: 9 | Train Loss: 1.207 Vali Loss: 1.147 Vali Acc: 0.493 Test Loss: 1.147 Test Acc: 0.493
Validation loss decreased (-0.463756 --> -0.492742).  Saving model ...
Epoch: 4 cost time: 1.387873649597168
Epoch: 4, Steps: 9 | Train Loss: 1.069 Vali Loss: 1.063 Vali Acc: 0.529 Test Loss: 1.063 Test Acc: 0.529
Validation loss decreased (-0.492742 --> -0.528975).  Saving model ...
Epoch: 5 cost time: 1.441420078277588
Epoch: 5, Steps: 9 | Train Loss: 0.931 Vali Loss: 0.995 Vali Acc: 0.536 Test Loss: 0.995 Test Acc: 0.536
Validation loss decreased (-0.528975 --> -0.536222).  Saving model ...
Epoch: 6 cost time: 1.4779729843139648
Epoch: 6, Steps: 9 | Train Loss: 0.817 Vali Loss: 0.944 Vali Acc: 0.558 Test Loss: 0.944 Test Acc: 0.558
Validation loss decreased (-0.536222 --> -0.557962).  Saving model ...
Epoch: 7 cost time: 1.5658094882965088
Epoch: 7, Steps: 9 | Train Loss: 0.739 Vali Loss: 0.886 Vali Acc: 0.572 Test Loss: 0.886 Test Acc: 0.572
Validation loss decreased (-0.557962 --> -0.572455).  Saving model ...
Epoch: 8 cost time: 1.5221507549285889
Epoch: 8, Steps: 9 | Train Loss: 0.636 Vali Loss: 0.823 Vali Acc: 0.645 Test Loss: 0.823 Test Acc: 0.645
Validation loss decreased (-0.572455 --> -0.644919).  Saving model ...
Epoch: 9 cost time: 1.627027988433838
Epoch: 9, Steps: 9 | Train Loss: 0.570 Vali Loss: 0.773 Vali Acc: 0.667 Test Loss: 0.773 Test Acc: 0.667
Validation loss decreased (-0.644919 --> -0.666659).  Saving model ...
Epoch: 10 cost time: 1.59675931930542
Epoch: 10, Steps: 9 | Train Loss: 0.476 Vali Loss: 0.725 Vali Acc: 0.688 Test Loss: 0.725 Test Acc: 0.688
Validation loss decreased (-0.666659 --> -0.688399).  Saving model ...
Epoch: 11 cost time: 1.5650618076324463
Epoch: 11, Steps: 9 | Train Loss: 0.420 Vali Loss: 0.680 Vali Acc: 0.710 Test Loss: 0.680 Test Acc: 0.710
Validation loss decreased (-0.688399 --> -0.710138).  Saving model ...
Epoch: 12 cost time: 1.5936059951782227
Epoch: 12, Steps: 9 | Train Loss: 0.357 Vali Loss: 0.644 Vali Acc: 0.754 Test Loss: 0.644 Test Acc: 0.754
Validation loss decreased (-0.710138 --> -0.753617).  Saving model ...
Epoch: 13 cost time: 1.5996863842010498
Epoch: 13, Steps: 9 | Train Loss: 0.299 Vali Loss: 0.600 Vali Acc: 0.768 Test Loss: 0.600 Test Acc: 0.768
Validation loss decreased (-0.753617 --> -0.768110).  Saving model ...
Epoch: 14 cost time: 1.5665688514709473
Epoch: 14, Steps: 9 | Train Loss: 0.246 Vali Loss: 0.601 Vali Acc: 0.761 Test Loss: 0.601 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5144948959350586
Epoch: 15, Steps: 9 | Train Loss: 0.207 Vali Loss: 0.572 Vali Acc: 0.783 Test Loss: 0.572 Test Acc: 0.783
Validation loss decreased (-0.768110 --> -0.782603).  Saving model ...
Epoch: 16 cost time: 1.613368034362793
Epoch: 16, Steps: 9 | Train Loss: 0.168 Vali Loss: 0.545 Vali Acc: 0.783 Test Loss: 0.545 Test Acc: 0.783
Validation loss decreased (-0.782603 --> -0.782603).  Saving model ...
Epoch: 17 cost time: 1.54449462890625
Epoch: 17, Steps: 9 | Train Loss: 0.145 Vali Loss: 0.529 Vali Acc: 0.790 Test Loss: 0.529 Test Acc: 0.790
Validation loss decreased (-0.782603 --> -0.789850).  Saving model ...
Epoch: 18 cost time: 1.5544025897979736
Epoch: 18, Steps: 9 | Train Loss: 0.124 Vali Loss: 0.519 Vali Acc: 0.812 Test Loss: 0.519 Test Acc: 0.812
Validation loss decreased (-0.789850 --> -0.811589).  Saving model ...
Epoch: 19 cost time: 1.4945900440216064
Epoch: 19, Steps: 9 | Train Loss: 0.108 Vali Loss: 0.530 Vali Acc: 0.804 Test Loss: 0.530 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5191254615783691
Epoch: 20, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.496 Vali Acc: 0.797 Test Loss: 0.496 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5529906749725342
Epoch: 21, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.491 Vali Acc: 0.804 Test Loss: 0.491 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.6358966827392578
Epoch: 22, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.506 Vali Acc: 0.812 Test Loss: 0.506 Test Acc: 0.812
Validation loss decreased (-0.811589 --> -0.811589).  Saving model ...
Epoch: 23 cost time: 1.6133170127868652
Epoch: 23, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.506 Vali Acc: 0.812 Test Loss: 0.506 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.6259150505065918
Epoch: 24, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.509 Vali Acc: 0.812 Test Loss: 0.509 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.5140743255615234
Epoch: 25, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.535 Vali Acc: 0.804 Test Loss: 0.535 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.5453157424926758
Epoch: 26, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.534 Vali Acc: 0.797 Test Loss: 0.534 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.1699872016906738
Epoch: 27, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.540 Vali Acc: 0.790 Test Loss: 0.540 Test Acc: 0.790
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.4737591743469238
Epoch: 28, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.536 Vali Acc: 0.783 Test Loss: 0.536 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.583463191986084
Epoch: 29, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.493 Vali Acc: 0.833 Test Loss: 0.493 Test Acc: 0.833
Validation loss decreased (-0.811589 --> -0.833328).  Saving model ...
Epoch: 30 cost time: 1.4770350456237793
Epoch: 30, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.474 Vali Acc: 0.833 Test Loss: 0.474 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833329).  Saving model ...
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8333333333333334
model parameter : 142836
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.787128210067749
Epoch: 1, Steps: 9 | Train Loss: 1.418 Vali Loss: 1.377 Vali Acc: 0.304 Test Loss: 1.377 Test Acc: 0.304
Validation loss decreased (inf --> -0.304334).  Saving model ...
Epoch: 2 cost time: 3.6344645023345947
Epoch: 2, Steps: 9 | Train Loss: 1.322 Vali Loss: 1.289 Vali Acc: 0.442 Test Loss: 1.289 Test Acc: 0.442
Validation loss decreased (-0.304334 --> -0.442016).  Saving model ...
Epoch: 3 cost time: 3.747457504272461
Epoch: 3, Steps: 9 | Train Loss: 1.180 Vali Loss: 1.160 Vali Acc: 0.522 Test Loss: 1.160 Test Acc: 0.522
Validation loss decreased (-0.442016 --> -0.521728).  Saving model ...
Epoch: 4 cost time: 3.786381721496582
Epoch: 4, Steps: 9 | Train Loss: 1.049 Vali Loss: 1.008 Vali Acc: 0.572 Test Loss: 1.008 Test Acc: 0.572
Validation loss decreased (-0.521728 --> -0.572454).  Saving model ...
Epoch: 5 cost time: 3.6158432960510254
Epoch: 5, Steps: 9 | Train Loss: 0.885 Vali Loss: 0.891 Vali Acc: 0.645 Test Loss: 0.891 Test Acc: 0.645
Validation loss decreased (-0.572454 --> -0.644919).  Saving model ...
Epoch: 6 cost time: 3.952554941177368
Epoch: 6, Steps: 9 | Train Loss: 0.731 Vali Loss: 0.779 Vali Acc: 0.710 Test Loss: 0.779 Test Acc: 0.710
Validation loss decreased (-0.644919 --> -0.710137).  Saving model ...
Epoch: 7 cost time: 3.966261625289917
Epoch: 7, Steps: 9 | Train Loss: 0.621 Vali Loss: 0.682 Vali Acc: 0.725 Test Loss: 0.682 Test Acc: 0.725
Validation loss decreased (-0.710137 --> -0.724631).  Saving model ...
Epoch: 8 cost time: 3.8420052528381348
Epoch: 8, Steps: 9 | Train Loss: 0.502 Vali Loss: 0.601 Vali Acc: 0.768 Test Loss: 0.601 Test Acc: 0.768
Validation loss decreased (-0.724631 --> -0.768110).  Saving model ...
Epoch: 9 cost time: 4.211597681045532
Epoch: 9, Steps: 9 | Train Loss: 0.452 Vali Loss: 0.523 Vali Acc: 0.804 Test Loss: 0.523 Test Acc: 0.804
Validation loss decreased (-0.768110 --> -0.804343).  Saving model ...
Epoch: 10 cost time: 4.445235967636108
Epoch: 10, Steps: 9 | Train Loss: 0.350 Vali Loss: 0.457 Vali Acc: 0.826 Test Loss: 0.457 Test Acc: 0.826
Validation loss decreased (-0.804343 --> -0.826082).  Saving model ...
Epoch: 11 cost time: 4.377236366271973
Epoch: 11, Steps: 9 | Train Loss: 0.300 Vali Loss: 0.447 Vali Acc: 0.848 Test Loss: 0.447 Test Acc: 0.848
Validation loss decreased (-0.826082 --> -0.847822).  Saving model ...
Epoch: 12 cost time: 4.320307493209839
Epoch: 12, Steps: 9 | Train Loss: 0.237 Vali Loss: 0.386 Vali Acc: 0.855 Test Loss: 0.386 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855069).  Saving model ...
Epoch: 13 cost time: 4.523159980773926
Epoch: 13, Steps: 9 | Train Loss: 0.173 Vali Loss: 0.381 Vali Acc: 0.870 Test Loss: 0.381 Test Acc: 0.870
Validation loss decreased (-0.855069 --> -0.869561).  Saving model ...
Epoch: 14 cost time: 4.508606433868408
Epoch: 14, Steps: 9 | Train Loss: 0.197 Vali Loss: 0.467 Vali Acc: 0.841 Test Loss: 0.467 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.376987934112549
Epoch: 15, Steps: 9 | Train Loss: 0.177 Vali Loss: 0.425 Vali Acc: 0.841 Test Loss: 0.425 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.385621786117554
Epoch: 16, Steps: 9 | Train Loss: 0.153 Vali Loss: 0.426 Vali Acc: 0.848 Test Loss: 0.426 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.337976455688477
Epoch: 17, Steps: 9 | Train Loss: 0.158 Vali Loss: 0.353 Vali Acc: 0.884 Test Loss: 0.353 Test Acc: 0.884
Validation loss decreased (-0.869561 --> -0.884054).  Saving model ...
Epoch: 18 cost time: 4.354991912841797
Epoch: 18, Steps: 9 | Train Loss: 0.106 Vali Loss: 0.422 Vali Acc: 0.862 Test Loss: 0.422 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.16718602180481
Epoch: 19, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.370 Vali Acc: 0.870 Test Loss: 0.370 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.198134183883667
Epoch: 20, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.359 Vali Acc: 0.884 Test Loss: 0.359 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.184031009674072
Epoch: 21, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.337 Vali Acc: 0.884 Test Loss: 0.337 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884055).  Saving model ...
Epoch: 22 cost time: 4.226085424423218
Epoch: 22, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.333 Vali Acc: 0.877 Test Loss: 0.333 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.28203558921814
Epoch: 23, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.327 Vali Acc: 0.884 Test Loss: 0.327 Test Acc: 0.884
Validation loss decreased (-0.884055 --> -0.884055).  Saving model ...
Epoch: 24 cost time: 4.36724066734314
Epoch: 24, Steps: 9 | Train Loss: 0.113 Vali Loss: 0.327 Vali Acc: 0.877 Test Loss: 0.327 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.354567527770996
Epoch: 25, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.409 Vali Acc: 0.862 Test Loss: 0.409 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 4.466423511505127
Epoch: 26, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.345 Vali Acc: 0.884 Test Loss: 0.345 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 4.252330780029297
Epoch: 27, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.347 Vali Acc: 0.884 Test Loss: 0.347 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 4.373676061630249
Epoch: 28, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.396 Vali Acc: 0.870 Test Loss: 0.396 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 4.649312734603882
Epoch: 29, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.331 Vali Acc: 0.899 Test Loss: 0.331 Test Acc: 0.899
Validation loss decreased (-0.884055 --> -0.898547).  Saving model ...
Epoch: 30 cost time: 4.574029207229614
Epoch: 30, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.320 Vali Acc: 0.906 Test Loss: 0.320 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905794).  Saving model ...
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 886604
model size : 3.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.473681926727295
Epoch: 1, Steps: 9 | Train Loss: 1.428 Vali Loss: 1.339 Vali Acc: 0.275 Test Loss: 1.339 Test Acc: 0.275
Validation loss decreased (inf --> -0.275349).  Saving model ...
Epoch: 2 cost time: 3.3110830783843994
Epoch: 2, Steps: 9 | Train Loss: 1.355 Vali Loss: 1.267 Vali Acc: 0.486 Test Loss: 1.267 Test Acc: 0.486
Validation loss decreased (-0.275349 --> -0.485495).  Saving model ...
Epoch: 3 cost time: 3.291414976119995
Epoch: 3, Steps: 9 | Train Loss: 1.226 Vali Loss: 1.176 Vali Acc: 0.580 Test Loss: 1.176 Test Acc: 0.580
Validation loss decreased (-0.485495 --> -0.579698).  Saving model ...
Epoch: 4 cost time: 3.2681772708892822
Epoch: 4, Steps: 9 | Train Loss: 1.140 Vali Loss: 1.073 Vali Acc: 0.630 Test Loss: 1.073 Test Acc: 0.630
Validation loss decreased (-0.579698 --> -0.630424).  Saving model ...
Epoch: 5 cost time: 2.917741537094116
Epoch: 5, Steps: 9 | Train Loss: 0.984 Vali Loss: 0.964 Vali Acc: 0.645 Test Loss: 0.964 Test Acc: 0.645
Validation loss decreased (-0.630424 --> -0.644918).  Saving model ...
Epoch: 6 cost time: 3.1753687858581543
Epoch: 6, Steps: 9 | Train Loss: 0.862 Vali Loss: 0.858 Vali Acc: 0.630 Test Loss: 0.858 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.028529405593872
Epoch: 7, Steps: 9 | Train Loss: 0.739 Vali Loss: 0.775 Vali Acc: 0.674 Test Loss: 0.775 Test Acc: 0.674
Validation loss decreased (-0.644918 --> -0.673905).  Saving model ...
Epoch: 8 cost time: 3.0115325450897217
Epoch: 8, Steps: 9 | Train Loss: 0.649 Vali Loss: 0.693 Vali Acc: 0.696 Test Loss: 0.693 Test Acc: 0.696
Validation loss decreased (-0.673905 --> -0.695645).  Saving model ...
Epoch: 9 cost time: 2.685563325881958
Epoch: 9, Steps: 9 | Train Loss: 0.547 Vali Loss: 0.638 Vali Acc: 0.768 Test Loss: 0.638 Test Acc: 0.768
Validation loss decreased (-0.695645 --> -0.768110).  Saving model ...
Epoch: 10 cost time: 2.7974131107330322
Epoch: 10, Steps: 9 | Train Loss: 0.515 Vali Loss: 0.565 Vali Acc: 0.797 Test Loss: 0.565 Test Acc: 0.797
Validation loss decreased (-0.768110 --> -0.797096).  Saving model ...
Epoch: 11 cost time: 2.8859152793884277
Epoch: 11, Steps: 9 | Train Loss: 0.407 Vali Loss: 0.506 Vali Acc: 0.790 Test Loss: 0.506 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.9768142700195312
Epoch: 12, Steps: 9 | Train Loss: 0.345 Vali Loss: 0.482 Vali Acc: 0.783 Test Loss: 0.482 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.127779483795166
Epoch: 13, Steps: 9 | Train Loss: 0.318 Vali Loss: 0.419 Vali Acc: 0.812 Test Loss: 0.419 Test Acc: 0.812
Validation loss decreased (-0.797096 --> -0.811590).  Saving model ...
Epoch: 14 cost time: 3.1165637969970703
Epoch: 14, Steps: 9 | Train Loss: 0.235 Vali Loss: 0.430 Vali Acc: 0.833 Test Loss: 0.430 Test Acc: 0.833
Validation loss decreased (-0.811590 --> -0.833329).  Saving model ...
Epoch: 15 cost time: 2.909536838531494
Epoch: 15, Steps: 9 | Train Loss: 0.231 Vali Loss: 0.415 Vali Acc: 0.841 Test Loss: 0.415 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840576).  Saving model ...
Epoch: 16 cost time: 3.161193370819092
Epoch: 16, Steps: 9 | Train Loss: 0.168 Vali Loss: 0.428 Vali Acc: 0.819 Test Loss: 0.428 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.1405224800109863
Epoch: 17, Steps: 9 | Train Loss: 0.151 Vali Loss: 0.401 Vali Acc: 0.841 Test Loss: 0.401 Test Acc: 0.841
Validation loss decreased (-0.840576 --> -0.840576).  Saving model ...
Epoch: 18 cost time: 3.0314321517944336
Epoch: 18, Steps: 9 | Train Loss: 0.117 Vali Loss: 0.409 Vali Acc: 0.833 Test Loss: 0.409 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.0417213439941406
Epoch: 19, Steps: 9 | Train Loss: 0.129 Vali Loss: 0.375 Vali Acc: 0.855 Test Loss: 0.375 Test Acc: 0.855
Validation loss decreased (-0.840576 --> -0.855069).  Saving model ...
Epoch: 20 cost time: 3.0484414100646973
Epoch: 20, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.407 Vali Acc: 0.862 Test Loss: 0.407 Test Acc: 0.862
Validation loss decreased (-0.855069 --> -0.862315).  Saving model ...
Epoch: 21 cost time: 3.307063102722168
Epoch: 21, Steps: 9 | Train Loss: 0.116 Vali Loss: 0.384 Vali Acc: 0.848 Test Loss: 0.384 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.343365430831909
Epoch: 22, Steps: 9 | Train Loss: 0.122 Vali Loss: 0.373 Vali Acc: 0.848 Test Loss: 0.373 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.2582616806030273
Epoch: 23, Steps: 9 | Train Loss: 0.099 Vali Loss: 0.367 Vali Acc: 0.862 Test Loss: 0.367 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 24 cost time: 3.3119146823883057
Epoch: 24, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.388 Vali Acc: 0.870 Test Loss: 0.388 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869561).  Saving model ...
Epoch: 25 cost time: 3.3290858268737793
Epoch: 25, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.339 Vali Acc: 0.877 Test Loss: 0.339 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876808).  Saving model ...
Epoch: 26 cost time: 3.317218780517578
Epoch: 26, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.289 Vali Acc: 0.899 Test Loss: 0.289 Test Acc: 0.899
Validation loss decreased (-0.876808 --> -0.898548).  Saving model ...
Epoch: 27 cost time: 3.283759832382202
Epoch: 27, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.372 Vali Acc: 0.862 Test Loss: 0.372 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.9437363147735596
Epoch: 28, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.376 Vali Acc: 0.877 Test Loss: 0.376 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.7660202980041504
Epoch: 29, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.392 Vali Acc: 0.870 Test Loss: 0.392 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.857557773590088
Epoch: 30, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.343 Vali Acc: 0.877 Test Loss: 0.343 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 265628
model size : 1.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.123794078826904
Epoch: 1, Steps: 9 | Train Loss: 1.416 Vali Loss: 1.382 Vali Acc: 0.304 Test Loss: 1.382 Test Acc: 0.304
Validation loss decreased (inf --> -0.304334).  Saving model ...
Epoch: 2 cost time: 3.1447691917419434
Epoch: 2, Steps: 9 | Train Loss: 1.326 Vali Loss: 1.293 Vali Acc: 0.428 Test Loss: 1.293 Test Acc: 0.428
Validation loss decreased (-0.304334 --> -0.427523).  Saving model ...
Epoch: 3 cost time: 3.169910192489624
Epoch: 3, Steps: 9 | Train Loss: 1.197 Vali Loss: 1.166 Vali Acc: 0.522 Test Loss: 1.166 Test Acc: 0.522
Validation loss decreased (-0.427523 --> -0.521727).  Saving model ...
Epoch: 4 cost time: 3.1929235458374023
Epoch: 4, Steps: 9 | Train Loss: 1.070 Vali Loss: 1.011 Vali Acc: 0.572 Test Loss: 1.011 Test Acc: 0.572
Validation loss decreased (-0.521727 --> -0.572454).  Saving model ...
Epoch: 5 cost time: 3.3222293853759766
Epoch: 5, Steps: 9 | Train Loss: 0.929 Vali Loss: 0.889 Vali Acc: 0.659 Test Loss: 0.889 Test Acc: 0.659
Validation loss decreased (-0.572454 --> -0.659411).  Saving model ...
Epoch: 6 cost time: 3.2326931953430176
Epoch: 6, Steps: 9 | Train Loss: 0.787 Vali Loss: 0.787 Vali Acc: 0.667 Test Loss: 0.787 Test Acc: 0.667
Validation loss decreased (-0.659411 --> -0.666659).  Saving model ...
Epoch: 7 cost time: 3.383728504180908
Epoch: 7, Steps: 9 | Train Loss: 0.683 Vali Loss: 0.712 Vali Acc: 0.703 Test Loss: 0.712 Test Acc: 0.703
Validation loss decreased (-0.666659 --> -0.702891).  Saving model ...
Epoch: 8 cost time: 3.368852138519287
Epoch: 8, Steps: 9 | Train Loss: 0.594 Vali Loss: 0.662 Vali Acc: 0.725 Test Loss: 0.662 Test Acc: 0.725
Validation loss decreased (-0.702891 --> -0.724631).  Saving model ...
Epoch: 9 cost time: 3.5516347885131836
Epoch: 9, Steps: 9 | Train Loss: 0.551 Vali Loss: 0.627 Vali Acc: 0.732 Test Loss: 0.627 Test Acc: 0.732
Validation loss decreased (-0.724631 --> -0.731878).  Saving model ...
Epoch: 10 cost time: 3.408982276916504
Epoch: 10, Steps: 9 | Train Loss: 0.473 Vali Loss: 0.563 Vali Acc: 0.783 Test Loss: 0.563 Test Acc: 0.783
Validation loss decreased (-0.731878 --> -0.782603).  Saving model ...
Epoch: 11 cost time: 3.4397242069244385
Epoch: 11, Steps: 9 | Train Loss: 0.384 Vali Loss: 0.503 Vali Acc: 0.790 Test Loss: 0.503 Test Acc: 0.790
Validation loss decreased (-0.782603 --> -0.789850).  Saving model ...
Epoch: 12 cost time: 3.5787875652313232
Epoch: 12, Steps: 9 | Train Loss: 0.302 Vali Loss: 0.452 Vali Acc: 0.833 Test Loss: 0.452 Test Acc: 0.833
Validation loss decreased (-0.789850 --> -0.833329).  Saving model ...
Epoch: 13 cost time: 3.5131425857543945
Epoch: 13, Steps: 9 | Train Loss: 0.283 Vali Loss: 0.446 Vali Acc: 0.848 Test Loss: 0.446 Test Acc: 0.848
Validation loss decreased (-0.833329 --> -0.847822).  Saving model ...
Epoch: 14 cost time: 3.546128034591675
Epoch: 14, Steps: 9 | Train Loss: 0.269 Vali Loss: 0.428 Vali Acc: 0.833 Test Loss: 0.428 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.356968879699707
Epoch: 15, Steps: 9 | Train Loss: 0.214 Vali Loss: 0.384 Vali Acc: 0.862 Test Loss: 0.384 Test Acc: 0.862
Validation loss decreased (-0.847822 --> -0.862315).  Saving model ...
Epoch: 16 cost time: 3.4608583450317383
Epoch: 16, Steps: 9 | Train Loss: 0.141 Vali Loss: 0.364 Vali Acc: 0.877 Test Loss: 0.364 Test Acc: 0.877
Validation loss decreased (-0.862315 --> -0.876808).  Saving model ...
Epoch: 17 cost time: 3.4132373332977295
Epoch: 17, Steps: 9 | Train Loss: 0.136 Vali Loss: 0.309 Vali Acc: 0.877 Test Loss: 0.309 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876809).  Saving model ...
Epoch: 18 cost time: 3.2909672260284424
Epoch: 18, Steps: 9 | Train Loss: 0.159 Vali Loss: 0.307 Vali Acc: 0.884 Test Loss: 0.307 Test Acc: 0.884
Validation loss decreased (-0.876809 --> -0.884055).  Saving model ...
Epoch: 19 cost time: 3.3375144004821777
Epoch: 19, Steps: 9 | Train Loss: 0.099 Vali Loss: 0.347 Vali Acc: 0.884 Test Loss: 0.347 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.2191903591156006
Epoch: 20, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.324 Vali Acc: 0.899 Test Loss: 0.324 Test Acc: 0.899
Validation loss decreased (-0.884055 --> -0.898547).  Saving model ...
Epoch: 21 cost time: 3.552034854888916
Epoch: 21, Steps: 9 | Train Loss: 0.132 Vali Loss: 0.298 Vali Acc: 0.906 Test Loss: 0.298 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905794).  Saving model ...
Epoch: 22 cost time: 3.645071268081665
Epoch: 22, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.306 Vali Acc: 0.906 Test Loss: 0.306 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.5964577198028564
Epoch: 23, Steps: 9 | Train Loss: 0.130 Vali Loss: 0.283 Vali Acc: 0.920 Test Loss: 0.283 Test Acc: 0.920
Validation loss decreased (-0.905794 --> -0.920287).  Saving model ...
Epoch: 24 cost time: 3.6490578651428223
Epoch: 24, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.311 Vali Acc: 0.870 Test Loss: 0.311 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.595508337020874
Epoch: 25, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.387 Vali Acc: 0.870 Test Loss: 0.387 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.528928518295288
Epoch: 26, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.319 Vali Acc: 0.884 Test Loss: 0.319 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.5471651554107666
Epoch: 27, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.299 Vali Acc: 0.884 Test Loss: 0.299 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.4328668117523193
Epoch: 28, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.379 Vali Acc: 0.877 Test Loss: 0.379 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.3639047145843506
Epoch: 29, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.384 Vali Acc: 0.884 Test Loss: 0.384 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.424642562866211
Epoch: 30, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.346 Vali Acc: 0.891 Test Loss: 0.346 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 886604
model size : 3.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.263619899749756
Epoch: 1, Steps: 9 | Train Loss: 1.424 Vali Loss: 1.339 Vali Acc: 0.319 Test Loss: 1.339 Test Acc: 0.319
Validation loss decreased (inf --> -0.318827).  Saving model ...
Epoch: 2 cost time: 2.304901599884033
Epoch: 2, Steps: 9 | Train Loss: 1.355 Vali Loss: 1.269 Vali Acc: 0.471 Test Loss: 1.269 Test Acc: 0.471
Validation loss decreased (-0.318827 --> -0.471002).  Saving model ...
Epoch: 3 cost time: 2.511461019515991
Epoch: 3, Steps: 9 | Train Loss: 1.234 Vali Loss: 1.183 Vali Acc: 0.565 Test Loss: 1.183 Test Acc: 0.565
Validation loss decreased (-0.471002 --> -0.565206).  Saving model ...
Epoch: 4 cost time: 2.3257672786712646
Epoch: 4, Steps: 9 | Train Loss: 1.142 Vali Loss: 1.083 Vali Acc: 0.572 Test Loss: 1.083 Test Acc: 0.572
Validation loss decreased (-0.565206 --> -0.572453).  Saving model ...
Epoch: 5 cost time: 2.3031628131866455
Epoch: 5, Steps: 9 | Train Loss: 1.000 Vali Loss: 0.973 Vali Acc: 0.674 Test Loss: 0.973 Test Acc: 0.674
Validation loss decreased (-0.572453 --> -0.673903).  Saving model ...
Epoch: 6 cost time: 2.3527255058288574
Epoch: 6, Steps: 9 | Train Loss: 0.881 Vali Loss: 0.875 Vali Acc: 0.674 Test Loss: 0.875 Test Acc: 0.674
Validation loss decreased (-0.673903 --> -0.673904).  Saving model ...
Epoch: 7 cost time: 2.1627633571624756
Epoch: 7, Steps: 9 | Train Loss: 0.765 Vali Loss: 0.804 Vali Acc: 0.696 Test Loss: 0.804 Test Acc: 0.696
Validation loss decreased (-0.673904 --> -0.695644).  Saving model ...
Epoch: 8 cost time: 2.3623366355895996
Epoch: 8, Steps: 9 | Train Loss: 0.695 Vali Loss: 0.728 Vali Acc: 0.725 Test Loss: 0.728 Test Acc: 0.725
Validation loss decreased (-0.695644 --> -0.724630).  Saving model ...
Epoch: 9 cost time: 2.4953110218048096
Epoch: 9, Steps: 9 | Train Loss: 0.590 Vali Loss: 0.679 Vali Acc: 0.732 Test Loss: 0.679 Test Acc: 0.732
Validation loss decreased (-0.724630 --> -0.731877).  Saving model ...
Epoch: 10 cost time: 2.6200802326202393
Epoch: 10, Steps: 9 | Train Loss: 0.558 Vali Loss: 0.624 Vali Acc: 0.746 Test Loss: 0.624 Test Acc: 0.746
Validation loss decreased (-0.731877 --> -0.746371).  Saving model ...
Epoch: 11 cost time: 2.6151387691497803
Epoch: 11, Steps: 9 | Train Loss: 0.455 Vali Loss: 0.541 Vali Acc: 0.768 Test Loss: 0.541 Test Acc: 0.768
Validation loss decreased (-0.746371 --> -0.768111).  Saving model ...
Epoch: 12 cost time: 2.6120235919952393
Epoch: 12, Steps: 9 | Train Loss: 0.420 Vali Loss: 0.512 Vali Acc: 0.761 Test Loss: 0.512 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.58052134513855
Epoch: 13, Steps: 9 | Train Loss: 0.329 Vali Loss: 0.482 Vali Acc: 0.804 Test Loss: 0.482 Test Acc: 0.804
Validation loss decreased (-0.768111 --> -0.804343).  Saving model ...
Epoch: 14 cost time: 2.10764741897583
Epoch: 14, Steps: 9 | Train Loss: 0.273 Vali Loss: 0.464 Vali Acc: 0.804 Test Loss: 0.464 Test Acc: 0.804
Validation loss decreased (-0.804343 --> -0.804343).  Saving model ...
Epoch: 15 cost time: 2.197944164276123
Epoch: 15, Steps: 9 | Train Loss: 0.255 Vali Loss: 0.444 Vali Acc: 0.804 Test Loss: 0.444 Test Acc: 0.804
Validation loss decreased (-0.804343 --> -0.804343).  Saving model ...
Epoch: 16 cost time: 2.149707555770874
Epoch: 16, Steps: 9 | Train Loss: 0.217 Vali Loss: 0.452 Vali Acc: 0.812 Test Loss: 0.452 Test Acc: 0.812
Validation loss decreased (-0.804343 --> -0.811590).  Saving model ...
Epoch: 17 cost time: 2.0865209102630615
Epoch: 17, Steps: 9 | Train Loss: 0.194 Vali Loss: 0.375 Vali Acc: 0.862 Test Loss: 0.375 Test Acc: 0.862
Validation loss decreased (-0.811590 --> -0.862315).  Saving model ...
Epoch: 18 cost time: 2.1320855617523193
Epoch: 18, Steps: 9 | Train Loss: 0.161 Vali Loss: 0.399 Vali Acc: 0.826 Test Loss: 0.399 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.016145944595337
Epoch: 19, Steps: 9 | Train Loss: 0.142 Vali Loss: 0.386 Vali Acc: 0.848 Test Loss: 0.386 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.076615333557129
Epoch: 20, Steps: 9 | Train Loss: 0.138 Vali Loss: 0.369 Vali Acc: 0.848 Test Loss: 0.369 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.198603630065918
Epoch: 21, Steps: 9 | Train Loss: 0.127 Vali Loss: 0.319 Vali Acc: 0.870 Test Loss: 0.319 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869562).  Saving model ...
Epoch: 22 cost time: 2.1616742610931396
Epoch: 22, Steps: 9 | Train Loss: 0.108 Vali Loss: 0.336 Vali Acc: 0.884 Test Loss: 0.336 Test Acc: 0.884
Validation loss decreased (-0.869562 --> -0.884055).  Saving model ...
Epoch: 23 cost time: 2.2049756050109863
Epoch: 23, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.363 Vali Acc: 0.855 Test Loss: 0.363 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.0265917778015137
Epoch: 24, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.326 Vali Acc: 0.877 Test Loss: 0.326 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.1352477073669434
Epoch: 25, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.307 Vali Acc: 0.899 Test Loss: 0.307 Test Acc: 0.899
Validation loss decreased (-0.884055 --> -0.898548).  Saving model ...
Epoch: 26 cost time: 2.132307529449463
Epoch: 26, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.249 Vali Acc: 0.935 Test Loss: 0.249 Test Acc: 0.935
Validation loss decreased (-0.898548 --> -0.934780).  Saving model ...
Epoch: 27 cost time: 2.127579689025879
Epoch: 27, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.307 Vali Acc: 0.913 Test Loss: 0.307 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.473403215408325
Epoch: 28, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.332 Vali Acc: 0.870 Test Loss: 0.332 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.639718532562256
Epoch: 29, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.297 Vali Acc: 0.906 Test Loss: 0.297 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.686476230621338
Epoch: 30, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.295 Vali Acc: 0.906 Test Loss: 0.295 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9347826086956522
model parameter : 265628
model size : 1.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.5618391036987305
Epoch: 1, Steps: 9 | Train Loss: 1.419 Vali Loss: 1.381 Vali Acc: 0.319 Test Loss: 1.381 Test Acc: 0.319
Validation loss decreased (inf --> -0.318827).  Saving model ...
Epoch: 2 cost time: 2.5398809909820557
Epoch: 2, Steps: 9 | Train Loss: 1.328 Vali Loss: 1.301 Vali Acc: 0.384 Test Loss: 1.301 Test Acc: 0.384
Validation loss decreased (-0.318827 --> -0.384045).  Saving model ...
Epoch: 3 cost time: 2.3844223022460938
Epoch: 3, Steps: 9 | Train Loss: 1.215 Vali Loss: 1.189 Vali Acc: 0.507 Test Loss: 1.189 Test Acc: 0.507
Validation loss decreased (-0.384045 --> -0.507234).  Saving model ...
Epoch: 4 cost time: 2.5048916339874268
Epoch: 4, Steps: 9 | Train Loss: 1.108 Vali Loss: 1.058 Vali Acc: 0.572 Test Loss: 1.058 Test Acc: 0.572
Validation loss decreased (-0.507234 --> -0.572453).  Saving model ...
Epoch: 5 cost time: 2.5076420307159424
Epoch: 5, Steps: 9 | Train Loss: 0.983 Vali Loss: 0.953 Vali Acc: 0.609 Test Loss: 0.953 Test Acc: 0.609
Validation loss decreased (-0.572453 --> -0.608686).  Saving model ...
Epoch: 6 cost time: 2.61189866065979
Epoch: 6, Steps: 9 | Train Loss: 0.841 Vali Loss: 0.901 Vali Acc: 0.659 Test Loss: 0.901 Test Acc: 0.659
Validation loss decreased (-0.608686 --> -0.659411).  Saving model ...
Epoch: 7 cost time: 2.5982086658477783
Epoch: 7, Steps: 9 | Train Loss: 0.757 Vali Loss: 0.845 Vali Acc: 0.674 Test Loss: 0.845 Test Acc: 0.674
Validation loss decreased (-0.659411 --> -0.673905).  Saving model ...
Epoch: 8 cost time: 2.6118416786193848
Epoch: 8, Steps: 9 | Train Loss: 0.687 Vali Loss: 0.784 Vali Acc: 0.674 Test Loss: 0.784 Test Acc: 0.674
Validation loss decreased (-0.673905 --> -0.673905).  Saving model ...
Epoch: 9 cost time: 2.634115695953369
Epoch: 9, Steps: 9 | Train Loss: 0.636 Vali Loss: 0.774 Vali Acc: 0.667 Test Loss: 0.774 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.570073366165161
Epoch: 10, Steps: 9 | Train Loss: 0.533 Vali Loss: 0.698 Vali Acc: 0.732 Test Loss: 0.698 Test Acc: 0.732
Validation loss decreased (-0.673905 --> -0.731877).  Saving model ...
Epoch: 11 cost time: 2.628983736038208
Epoch: 11, Steps: 9 | Train Loss: 0.480 Vali Loss: 0.573 Vali Acc: 0.768 Test Loss: 0.573 Test Acc: 0.768
Validation loss decreased (-0.731877 --> -0.768110).  Saving model ...
Epoch: 12 cost time: 2.6046855449676514
Epoch: 12, Steps: 9 | Train Loss: 0.394 Vali Loss: 0.555 Vali Acc: 0.804 Test Loss: 0.555 Test Acc: 0.804
Validation loss decreased (-0.768110 --> -0.804342).  Saving model ...
Epoch: 13 cost time: 2.526014804840088
Epoch: 13, Steps: 9 | Train Loss: 0.324 Vali Loss: 0.549 Vali Acc: 0.797 Test Loss: 0.549 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.506499767303467
Epoch: 14, Steps: 9 | Train Loss: 0.306 Vali Loss: 0.459 Vali Acc: 0.833 Test Loss: 0.459 Test Acc: 0.833
Validation loss decreased (-0.804342 --> -0.833329).  Saving model ...
Epoch: 15 cost time: 2.450754165649414
Epoch: 15, Steps: 9 | Train Loss: 0.274 Vali Loss: 0.440 Vali Acc: 0.841 Test Loss: 0.440 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840575).  Saving model ...
Epoch: 16 cost time: 2.3933465480804443
Epoch: 16, Steps: 9 | Train Loss: 0.213 Vali Loss: 0.432 Vali Acc: 0.833 Test Loss: 0.432 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.4317967891693115
Epoch: 17, Steps: 9 | Train Loss: 0.203 Vali Loss: 0.394 Vali Acc: 0.870 Test Loss: 0.394 Test Acc: 0.870
Validation loss decreased (-0.840575 --> -0.869561).  Saving model ...
Epoch: 18 cost time: 2.4548754692077637
Epoch: 18, Steps: 9 | Train Loss: 0.150 Vali Loss: 0.425 Vali Acc: 0.848 Test Loss: 0.425 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.3454484939575195
Epoch: 19, Steps: 9 | Train Loss: 0.151 Vali Loss: 0.431 Vali Acc: 0.819 Test Loss: 0.431 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.4598984718322754
Epoch: 20, Steps: 9 | Train Loss: 0.125 Vali Loss: 0.448 Vali Acc: 0.819 Test Loss: 0.448 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.343017339706421
Epoch: 21, Steps: 9 | Train Loss: 0.145 Vali Loss: 0.700 Vali Acc: 0.746 Test Loss: 0.700 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.5090272426605225
Epoch: 22, Steps: 9 | Train Loss: 0.136 Vali Loss: 0.404 Vali Acc: 0.855 Test Loss: 0.404 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.6569840908050537
Epoch: 23, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.405 Vali Acc: 0.841 Test Loss: 0.405 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.584969997406006
Epoch: 24, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.371 Vali Acc: 0.848 Test Loss: 0.371 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.394638776779175
Epoch: 25, Steps: 9 | Train Loss: 0.080 Vali Loss: 0.356 Vali Acc: 0.870 Test Loss: 0.356 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869562).  Saving model ...
Epoch: 26 cost time: 2.2663698196411133
Epoch: 26, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.314 Vali Acc: 0.884 Test Loss: 0.314 Test Acc: 0.884
Validation loss decreased (-0.869562 --> -0.884055).  Saving model ...
Epoch: 27 cost time: 2.5258519649505615
Epoch: 27, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.340 Vali Acc: 0.877 Test Loss: 0.340 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.5710010528564453
Epoch: 28, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.333 Vali Acc: 0.877 Test Loss: 0.333 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.469917058944702
Epoch: 29, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.324 Vali Acc: 0.891 Test Loss: 0.324 Test Acc: 0.891
Validation loss decreased (-0.884055 --> -0.891301).  Saving model ...
Epoch: 30 cost time: 2.637174606323242
Epoch: 30, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.335 Vali Acc: 0.899 Test Loss: 0.335 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898547).  Saving model ...
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 886604
model size : 3.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.7525405883789062
Epoch: 1, Steps: 9 | Train Loss: 1.426 Vali Loss: 1.344 Vali Acc: 0.304 Test Loss: 1.344 Test Acc: 0.304
Validation loss decreased (inf --> -0.304334).  Saving model ...
Epoch: 2 cost time: 2.14509654045105
Epoch: 2, Steps: 9 | Train Loss: 1.361 Vali Loss: 1.278 Vali Acc: 0.464 Test Loss: 1.278 Test Acc: 0.464
Validation loss decreased (-0.304334 --> -0.463755).  Saving model ...
Epoch: 3 cost time: 2.158527135848999
Epoch: 3, Steps: 9 | Train Loss: 1.246 Vali Loss: 1.201 Vali Acc: 0.536 Test Loss: 1.201 Test Acc: 0.536
Validation loss decreased (-0.463755 --> -0.536220).  Saving model ...
Epoch: 4 cost time: 2.0998260974884033
Epoch: 4, Steps: 9 | Train Loss: 1.168 Vali Loss: 1.112 Vali Acc: 0.565 Test Loss: 1.112 Test Acc: 0.565
Validation loss decreased (-0.536220 --> -0.565206).  Saving model ...
Epoch: 5 cost time: 2.174905776977539
Epoch: 5, Steps: 9 | Train Loss: 1.044 Vali Loss: 1.010 Vali Acc: 0.638 Test Loss: 1.010 Test Acc: 0.638
Validation loss decreased (-0.565206 --> -0.637671).  Saving model ...
Epoch: 6 cost time: 2.1539289951324463
Epoch: 6, Steps: 9 | Train Loss: 0.909 Vali Loss: 0.922 Vali Acc: 0.659 Test Loss: 0.922 Test Acc: 0.659
Validation loss decreased (-0.637671 --> -0.659411).  Saving model ...
Epoch: 7 cost time: 2.2017149925231934
Epoch: 7, Steps: 9 | Train Loss: 0.814 Vali Loss: 0.857 Vali Acc: 0.659 Test Loss: 0.857 Test Acc: 0.659
Validation loss decreased (-0.659411 --> -0.659412).  Saving model ...
Epoch: 8 cost time: 2.0919711589813232
Epoch: 8, Steps: 9 | Train Loss: 0.746 Vali Loss: 0.797 Vali Acc: 0.659 Test Loss: 0.797 Test Acc: 0.659
Validation loss decreased (-0.659412 --> -0.659412).  Saving model ...
Epoch: 9 cost time: 2.0666310787200928
Epoch: 9, Steps: 9 | Train Loss: 0.652 Vali Loss: 0.762 Vali Acc: 0.681 Test Loss: 0.762 Test Acc: 0.681
Validation loss decreased (-0.659412 --> -0.681152).  Saving model ...
Epoch: 10 cost time: 2.002142906188965
Epoch: 10, Steps: 9 | Train Loss: 0.621 Vali Loss: 0.719 Vali Acc: 0.717 Test Loss: 0.719 Test Acc: 0.717
Validation loss decreased (-0.681152 --> -0.717384).  Saving model ...
Epoch: 11 cost time: 2.069477081298828
Epoch: 11, Steps: 9 | Train Loss: 0.531 Vali Loss: 0.669 Vali Acc: 0.746 Test Loss: 0.669 Test Acc: 0.746
Validation loss decreased (-0.717384 --> -0.746370).  Saving model ...
Epoch: 12 cost time: 1.9969477653503418
Epoch: 12, Steps: 9 | Train Loss: 0.470 Vali Loss: 0.616 Vali Acc: 0.754 Test Loss: 0.616 Test Acc: 0.754
Validation loss decreased (-0.746370 --> -0.753617).  Saving model ...
Epoch: 13 cost time: 2.121922731399536
Epoch: 13, Steps: 9 | Train Loss: 0.397 Vali Loss: 0.571 Vali Acc: 0.761 Test Loss: 0.571 Test Acc: 0.761
Validation loss decreased (-0.753617 --> -0.760864).  Saving model ...
Epoch: 14 cost time: 2.0407230854034424
Epoch: 14, Steps: 9 | Train Loss: 0.342 Vali Loss: 0.558 Vali Acc: 0.775 Test Loss: 0.558 Test Acc: 0.775
Validation loss decreased (-0.760864 --> -0.775357).  Saving model ...
Epoch: 15 cost time: 2.077237129211426
Epoch: 15, Steps: 9 | Train Loss: 0.339 Vali Loss: 0.508 Vali Acc: 0.797 Test Loss: 0.508 Test Acc: 0.797
Validation loss decreased (-0.775357 --> -0.797096).  Saving model ...
Epoch: 16 cost time: 2.0665555000305176
Epoch: 16, Steps: 9 | Train Loss: 0.265 Vali Loss: 0.543 Vali Acc: 0.761 Test Loss: 0.543 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.1709556579589844
Epoch: 17, Steps: 9 | Train Loss: 0.216 Vali Loss: 0.438 Vali Acc: 0.833 Test Loss: 0.438 Test Acc: 0.833
Validation loss decreased (-0.797096 --> -0.833329).  Saving model ...
Epoch: 18 cost time: 2.1492867469787598
Epoch: 18, Steps: 9 | Train Loss: 0.213 Vali Loss: 0.442 Vali Acc: 0.819 Test Loss: 0.442 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.0583298206329346
Epoch: 19, Steps: 9 | Train Loss: 0.154 Vali Loss: 0.446 Vali Acc: 0.833 Test Loss: 0.446 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.115565538406372
Epoch: 20, Steps: 9 | Train Loss: 0.193 Vali Loss: 0.459 Vali Acc: 0.819 Test Loss: 0.459 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.1881659030914307
Epoch: 21, Steps: 9 | Train Loss: 0.147 Vali Loss: 0.407 Vali Acc: 0.833 Test Loss: 0.407 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 22 cost time: 2.1981866359710693
Epoch: 22, Steps: 9 | Train Loss: 0.137 Vali Loss: 0.376 Vali Acc: 0.870 Test Loss: 0.376 Test Acc: 0.870
Validation loss decreased (-0.833329 --> -0.869561).  Saving model ...
Epoch: 23 cost time: 2.3479509353637695
Epoch: 23, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.431 Vali Acc: 0.826 Test Loss: 0.431 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.3359434604644775
Epoch: 24, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.374 Vali Acc: 0.877 Test Loss: 0.374 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876808).  Saving model ...
Epoch: 25 cost time: 2.2572267055511475
Epoch: 25, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.393 Vali Acc: 0.855 Test Loss: 0.393 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.1867640018463135
Epoch: 26, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.370 Vali Acc: 0.884 Test Loss: 0.370 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884054).  Saving model ...
Epoch: 27 cost time: 2.2586331367492676
Epoch: 27, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.423 Vali Acc: 0.862 Test Loss: 0.423 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.174435615539551
Epoch: 28, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.425 Vali Acc: 0.862 Test Loss: 0.425 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.114447832107544
Epoch: 29, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.424 Vali Acc: 0.862 Test Loss: 0.424 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.2268524169921875
Epoch: 30, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.401 Vali Acc: 0.877 Test Loss: 0.401 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 265628
model size : 1.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.722836017608643
Epoch: 1, Steps: 9 | Train Loss: 1.346 Vali Loss: 1.309 Vali Acc: 0.377 Test Loss: 1.309 Test Acc: 0.377
Validation loss decreased (inf --> -0.376799).  Saving model ...
Epoch: 2 cost time: 3.3594326972961426
Epoch: 2, Steps: 9 | Train Loss: 1.261 Vali Loss: 1.234 Vali Acc: 0.464 Test Loss: 1.234 Test Acc: 0.464
Validation loss decreased (-0.376799 --> -0.463756).  Saving model ...
Epoch: 3 cost time: 3.3247737884521484
Epoch: 3, Steps: 9 | Train Loss: 1.172 Vali Loss: 1.143 Vali Acc: 0.543 Test Loss: 1.143 Test Acc: 0.543
Validation loss decreased (-0.463756 --> -0.543467).  Saving model ...
Epoch: 4 cost time: 3.489981174468994
Epoch: 4, Steps: 9 | Train Loss: 1.054 Vali Loss: 1.056 Vali Acc: 0.580 Test Loss: 1.056 Test Acc: 0.580
Validation loss decreased (-0.543467 --> -0.579700).  Saving model ...
Epoch: 5 cost time: 3.442120313644409
Epoch: 5, Steps: 9 | Train Loss: 0.964 Vali Loss: 0.973 Vali Acc: 0.616 Test Loss: 0.973 Test Acc: 0.616
Validation loss decreased (-0.579700 --> -0.615932).  Saving model ...
Epoch: 6 cost time: 3.41624116897583
Epoch: 6, Steps: 9 | Train Loss: 0.855 Vali Loss: 0.890 Vali Acc: 0.681 Test Loss: 0.890 Test Acc: 0.681
Validation loss decreased (-0.615932 --> -0.681151).  Saving model ...
Epoch: 7 cost time: 3.31827712059021
Epoch: 7, Steps: 9 | Train Loss: 0.740 Vali Loss: 0.809 Vali Acc: 0.739 Test Loss: 0.809 Test Acc: 0.739
Validation loss decreased (-0.681151 --> -0.739122).  Saving model ...
Epoch: 8 cost time: 3.4195332527160645
Epoch: 8, Steps: 9 | Train Loss: 0.683 Vali Loss: 0.723 Vali Acc: 0.746 Test Loss: 0.723 Test Acc: 0.746
Validation loss decreased (-0.739122 --> -0.746370).  Saving model ...
Epoch: 9 cost time: 3.3161797523498535
Epoch: 9, Steps: 9 | Train Loss: 0.566 Vali Loss: 0.626 Vali Acc: 0.783 Test Loss: 0.626 Test Acc: 0.783
Validation loss decreased (-0.746370 --> -0.782602).  Saving model ...
Epoch: 10 cost time: 3.3223042488098145
Epoch: 10, Steps: 9 | Train Loss: 0.492 Vali Loss: 0.628 Vali Acc: 0.775 Test Loss: 0.628 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.401064872741699
Epoch: 11, Steps: 9 | Train Loss: 0.419 Vali Loss: 0.548 Vali Acc: 0.819 Test Loss: 0.548 Test Acc: 0.819
Validation loss decreased (-0.782602 --> -0.818835).  Saving model ...
Epoch: 12 cost time: 3.2918753623962402
Epoch: 12, Steps: 9 | Train Loss: 0.368 Vali Loss: 0.484 Vali Acc: 0.841 Test Loss: 0.484 Test Acc: 0.841
Validation loss decreased (-0.818835 --> -0.840575).  Saving model ...
Epoch: 13 cost time: 3.323629379272461
Epoch: 13, Steps: 9 | Train Loss: 0.305 Vali Loss: 0.462 Vali Acc: 0.812 Test Loss: 0.462 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.3772895336151123
Epoch: 14, Steps: 9 | Train Loss: 0.250 Vali Loss: 0.423 Vali Acc: 0.826 Test Loss: 0.423 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.3089301586151123
Epoch: 15, Steps: 9 | Train Loss: 0.231 Vali Loss: 0.349 Vali Acc: 0.870 Test Loss: 0.349 Test Acc: 0.870
Validation loss decreased (-0.840575 --> -0.869562).  Saving model ...
Epoch: 16 cost time: 3.1975293159484863
Epoch: 16, Steps: 9 | Train Loss: 0.170 Vali Loss: 0.461 Vali Acc: 0.848 Test Loss: 0.461 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.3276238441467285
Epoch: 17, Steps: 9 | Train Loss: 0.144 Vali Loss: 0.434 Vali Acc: 0.862 Test Loss: 0.434 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.4840891361236572
Epoch: 18, Steps: 9 | Train Loss: 0.140 Vali Loss: 0.432 Vali Acc: 0.862 Test Loss: 0.432 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.710418224334717
Epoch: 19, Steps: 9 | Train Loss: 0.139 Vali Loss: 0.443 Vali Acc: 0.855 Test Loss: 0.443 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.4940598011016846
Epoch: 20, Steps: 9 | Train Loss: 0.153 Vali Loss: 0.398 Vali Acc: 0.877 Test Loss: 0.398 Test Acc: 0.877
Validation loss decreased (-0.869562 --> -0.876808).  Saving model ...
Epoch: 21 cost time: 3.471604347229004
Epoch: 21, Steps: 9 | Train Loss: 0.086 Vali Loss: 0.295 Vali Acc: 0.884 Test Loss: 0.295 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884055).  Saving model ...
Epoch: 22 cost time: 3.538980484008789
Epoch: 22, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.308 Vali Acc: 0.891 Test Loss: 0.308 Test Acc: 0.891
Validation loss decreased (-0.884055 --> -0.891301).  Saving model ...
Epoch: 23 cost time: 3.641876459121704
Epoch: 23, Steps: 9 | Train Loss: 0.163 Vali Loss: 0.364 Vali Acc: 0.862 Test Loss: 0.364 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.5052592754364014
Epoch: 24, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.272 Vali Acc: 0.899 Test Loss: 0.272 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898548).  Saving model ...
Epoch: 25 cost time: 3.576037883758545
Epoch: 25, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.328 Vali Acc: 0.870 Test Loss: 0.328 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.4317102432250977
Epoch: 26, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.291 Vali Acc: 0.862 Test Loss: 0.291 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.361114501953125
Epoch: 27, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.370 Vali Acc: 0.877 Test Loss: 0.370 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.3904671669006348
Epoch: 28, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.254 Vali Acc: 0.899 Test Loss: 0.254 Test Acc: 0.899
Validation loss decreased (-0.898548 --> -0.898548).  Saving model ...
Epoch: 29 cost time: 3.71238374710083
Epoch: 29, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.229 Vali Acc: 0.913 Test Loss: 0.229 Test Acc: 0.913
Validation loss decreased (-0.898548 --> -0.913041).  Saving model ...
Epoch: 30 cost time: 3.6030800342559814
Epoch: 30, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.314 Vali Acc: 0.891 Test Loss: 0.314 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 446732
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.637462615966797
Epoch: 1, Steps: 9 | Train Loss: 1.424 Vali Loss: 1.405 Vali Acc: 0.420 Test Loss: 1.405 Test Acc: 0.420
Validation loss decreased (inf --> -0.420276).  Saving model ...
Epoch: 2 cost time: 2.3372130393981934
Epoch: 2, Steps: 9 | Train Loss: 1.390 Vali Loss: 1.364 Vali Acc: 0.435 Test Loss: 1.364 Test Acc: 0.435
Validation loss decreased (-0.420276 --> -0.434769).  Saving model ...
Epoch: 3 cost time: 2.536238431930542
Epoch: 3, Steps: 9 | Train Loss: 1.295 Vali Loss: 1.311 Vali Acc: 0.457 Test Loss: 1.311 Test Acc: 0.457
Validation loss decreased (-0.434769 --> -0.456509).  Saving model ...
Epoch: 4 cost time: 2.315614700317383
Epoch: 4, Steps: 9 | Train Loss: 1.260 Vali Loss: 1.257 Vali Acc: 0.457 Test Loss: 1.257 Test Acc: 0.457
Validation loss decreased (-0.456509 --> -0.456509).  Saving model ...
Epoch: 5 cost time: 2.4361753463745117
Epoch: 5, Steps: 9 | Train Loss: 1.174 Vali Loss: 1.193 Vali Acc: 0.514 Test Loss: 1.193 Test Acc: 0.514
Validation loss decreased (-0.456509 --> -0.514481).  Saving model ...
Epoch: 6 cost time: 2.296311616897583
Epoch: 6, Steps: 9 | Train Loss: 1.061 Vali Loss: 1.123 Vali Acc: 0.543 Test Loss: 1.123 Test Acc: 0.543
Validation loss decreased (-0.514481 --> -0.543467).  Saving model ...
Epoch: 7 cost time: 2.43620228767395
Epoch: 7, Steps: 9 | Train Loss: 0.984 Vali Loss: 1.022 Vali Acc: 0.558 Test Loss: 1.022 Test Acc: 0.558
Validation loss decreased (-0.543467 --> -0.557961).  Saving model ...
Epoch: 8 cost time: 2.29679012298584
Epoch: 8, Steps: 9 | Train Loss: 0.861 Vali Loss: 0.936 Vali Acc: 0.638 Test Loss: 0.936 Test Acc: 0.638
Validation loss decreased (-0.557961 --> -0.637672).  Saving model ...
Epoch: 9 cost time: 2.505908966064453
Epoch: 9, Steps: 9 | Train Loss: 0.738 Vali Loss: 0.864 Vali Acc: 0.645 Test Loss: 0.864 Test Acc: 0.645
Validation loss decreased (-0.637672 --> -0.644919).  Saving model ...
Epoch: 10 cost time: 2.3854546546936035
Epoch: 10, Steps: 9 | Train Loss: 0.639 Vali Loss: 0.777 Vali Acc: 0.688 Test Loss: 0.777 Test Acc: 0.688
Validation loss decreased (-0.644919 --> -0.688398).  Saving model ...
Epoch: 11 cost time: 2.468043565750122
Epoch: 11, Steps: 9 | Train Loss: 0.560 Vali Loss: 0.709 Vali Acc: 0.717 Test Loss: 0.709 Test Acc: 0.717
Validation loss decreased (-0.688398 --> -0.717384).  Saving model ...
Epoch: 12 cost time: 2.5074374675750732
Epoch: 12, Steps: 9 | Train Loss: 0.482 Vali Loss: 0.651 Vali Acc: 0.725 Test Loss: 0.651 Test Acc: 0.725
Validation loss decreased (-0.717384 --> -0.724631).  Saving model ...
Epoch: 13 cost time: 2.4052443504333496
Epoch: 13, Steps: 9 | Train Loss: 0.452 Vali Loss: 0.580 Vali Acc: 0.775 Test Loss: 0.580 Test Acc: 0.775
Validation loss decreased (-0.724631 --> -0.775357).  Saving model ...
Epoch: 14 cost time: 2.7534117698669434
Epoch: 14, Steps: 9 | Train Loss: 0.358 Vali Loss: 0.527 Vali Acc: 0.790 Test Loss: 0.527 Test Acc: 0.790
Validation loss decreased (-0.775357 --> -0.789850).  Saving model ...
Epoch: 15 cost time: 2.658905506134033
Epoch: 15, Steps: 9 | Train Loss: 0.297 Vali Loss: 0.512 Vali Acc: 0.790 Test Loss: 0.512 Test Acc: 0.790
Validation loss decreased (-0.789850 --> -0.789850).  Saving model ...
Epoch: 16 cost time: 2.8938887119293213
Epoch: 16, Steps: 9 | Train Loss: 0.285 Vali Loss: 0.494 Vali Acc: 0.783 Test Loss: 0.494 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.7366464138031006
Epoch: 17, Steps: 9 | Train Loss: 0.224 Vali Loss: 0.464 Vali Acc: 0.819 Test Loss: 0.464 Test Acc: 0.819
Validation loss decreased (-0.789850 --> -0.818836).  Saving model ...
Epoch: 18 cost time: 2.7967283725738525
Epoch: 18, Steps: 9 | Train Loss: 0.196 Vali Loss: 0.399 Vali Acc: 0.877 Test Loss: 0.399 Test Acc: 0.877
Validation loss decreased (-0.818836 --> -0.876808).  Saving model ...
Epoch: 19 cost time: 2.560590982437134
Epoch: 19, Steps: 9 | Train Loss: 0.175 Vali Loss: 0.394 Vali Acc: 0.870 Test Loss: 0.394 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.872082233428955
Epoch: 20, Steps: 9 | Train Loss: 0.141 Vali Loss: 0.448 Vali Acc: 0.833 Test Loss: 0.448 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.7566773891448975
Epoch: 21, Steps: 9 | Train Loss: 0.139 Vali Loss: 0.395 Vali Acc: 0.884 Test Loss: 0.395 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884054).  Saving model ...
Epoch: 22 cost time: 2.838986873626709
Epoch: 22, Steps: 9 | Train Loss: 0.116 Vali Loss: 0.406 Vali Acc: 0.855 Test Loss: 0.406 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.764972448348999
Epoch: 23, Steps: 9 | Train Loss: 0.123 Vali Loss: 0.410 Vali Acc: 0.855 Test Loss: 0.410 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.660902500152588
Epoch: 24, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.385 Vali Acc: 0.884 Test Loss: 0.385 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 25 cost time: 2.7824411392211914
Epoch: 25, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.370 Vali Acc: 0.870 Test Loss: 0.370 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.5465917587280273
Epoch: 26, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.361 Vali Acc: 0.862 Test Loss: 0.361 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.7361302375793457
Epoch: 27, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.339 Vali Acc: 0.884 Test Loss: 0.339 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884055).  Saving model ...
Epoch: 28 cost time: 2.6757583618164062
Epoch: 28, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.352 Vali Acc: 0.855 Test Loss: 0.352 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.7236921787261963
Epoch: 29, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.357 Vali Acc: 0.884 Test Loss: 0.357 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.7775135040283203
Epoch: 30, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.327 Vali Acc: 0.891 Test Loss: 0.327 Test Acc: 0.891
Validation loss decreased (-0.884055 --> -0.891301).  Saving model ...
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 136220
model size : 0.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.096174001693726
Epoch: 1, Steps: 9 | Train Loss: 1.344 Vali Loss: 1.311 Vali Acc: 0.377 Test Loss: 1.311 Test Acc: 0.377
Validation loss decreased (inf --> -0.376798).  Saving model ...
Epoch: 2 cost time: 2.853060007095337
Epoch: 2, Steps: 9 | Train Loss: 1.263 Vali Loss: 1.236 Vali Acc: 0.449 Test Loss: 1.236 Test Acc: 0.449
Validation loss decreased (-0.376798 --> -0.449263).  Saving model ...
Epoch: 3 cost time: 2.8874094486236572
Epoch: 3, Steps: 9 | Train Loss: 1.173 Vali Loss: 1.145 Vali Acc: 0.522 Test Loss: 1.145 Test Acc: 0.522
Validation loss decreased (-0.449263 --> -0.521728).  Saving model ...
Epoch: 4 cost time: 2.8625950813293457
Epoch: 4, Steps: 9 | Train Loss: 1.063 Vali Loss: 1.058 Vali Acc: 0.558 Test Loss: 1.058 Test Acc: 0.558
Validation loss decreased (-0.521728 --> -0.557960).  Saving model ...
Epoch: 5 cost time: 2.603870153427124
Epoch: 5, Steps: 9 | Train Loss: 0.974 Vali Loss: 0.976 Vali Acc: 0.616 Test Loss: 0.976 Test Acc: 0.616
Validation loss decreased (-0.557960 --> -0.615932).  Saving model ...
Epoch: 6 cost time: 2.5887129306793213
Epoch: 6, Steps: 9 | Train Loss: 0.869 Vali Loss: 0.893 Vali Acc: 0.638 Test Loss: 0.893 Test Acc: 0.638
Validation loss decreased (-0.615932 --> -0.637672).  Saving model ...
Epoch: 7 cost time: 2.7754576206207275
Epoch: 7, Steps: 9 | Train Loss: 0.756 Vali Loss: 0.815 Vali Acc: 0.667 Test Loss: 0.815 Test Acc: 0.667
Validation loss decreased (-0.637672 --> -0.666659).  Saving model ...
Epoch: 8 cost time: 3.0217370986938477
Epoch: 8, Steps: 9 | Train Loss: 0.707 Vali Loss: 0.720 Vali Acc: 0.710 Test Loss: 0.720 Test Acc: 0.710
Validation loss decreased (-0.666659 --> -0.710138).  Saving model ...
Epoch: 9 cost time: 3.0531198978424072
Epoch: 9, Steps: 9 | Train Loss: 0.597 Vali Loss: 0.631 Vali Acc: 0.790 Test Loss: 0.631 Test Acc: 0.790
Validation loss decreased (-0.710138 --> -0.789849).  Saving model ...
Epoch: 10 cost time: 2.8618476390838623
Epoch: 10, Steps: 9 | Train Loss: 0.536 Vali Loss: 0.567 Vali Acc: 0.826 Test Loss: 0.567 Test Acc: 0.826
Validation loss decreased (-0.789849 --> -0.826081).  Saving model ...
Epoch: 11 cost time: 2.9447405338287354
Epoch: 11, Steps: 9 | Train Loss: 0.439 Vali Loss: 0.504 Vali Acc: 0.855 Test Loss: 0.504 Test Acc: 0.855
Validation loss decreased (-0.826081 --> -0.855067).  Saving model ...
Epoch: 12 cost time: 2.864561080932617
Epoch: 12, Steps: 9 | Train Loss: 0.432 Vali Loss: 0.464 Vali Acc: 0.833 Test Loss: 0.464 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.9207026958465576
Epoch: 13, Steps: 9 | Train Loss: 0.365 Vali Loss: 0.428 Vali Acc: 0.855 Test Loss: 0.428 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855068).  Saving model ...
Epoch: 14 cost time: 3.0350654125213623
Epoch: 14, Steps: 9 | Train Loss: 0.316 Vali Loss: 0.410 Vali Acc: 0.826 Test Loss: 0.410 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.052504301071167
Epoch: 15, Steps: 9 | Train Loss: 0.264 Vali Loss: 0.343 Vali Acc: 0.884 Test Loss: 0.343 Test Acc: 0.884
Validation loss decreased (-0.855068 --> -0.884055).  Saving model ...
Epoch: 16 cost time: 2.9180550575256348
Epoch: 16, Steps: 9 | Train Loss: 0.216 Vali Loss: 0.451 Vali Acc: 0.819 Test Loss: 0.451 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.8470168113708496
Epoch: 17, Steps: 9 | Train Loss: 0.199 Vali Loss: 0.334 Vali Acc: 0.826 Test Loss: 0.334 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.121703624725342
Epoch: 18, Steps: 9 | Train Loss: 0.207 Vali Loss: 0.305 Vali Acc: 0.862 Test Loss: 0.305 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.9571533203125
Epoch: 19, Steps: 9 | Train Loss: 0.159 Vali Loss: 0.325 Vali Acc: 0.848 Test Loss: 0.325 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.9178903102874756
Epoch: 20, Steps: 9 | Train Loss: 0.118 Vali Loss: 0.257 Vali Acc: 0.891 Test Loss: 0.257 Test Acc: 0.891
Validation loss decreased (-0.884055 --> -0.891302).  Saving model ...
Epoch: 21 cost time: 2.826096296310425
Epoch: 21, Steps: 9 | Train Loss: 0.102 Vali Loss: 0.246 Vali Acc: 0.906 Test Loss: 0.246 Test Acc: 0.906
Validation loss decreased (-0.891302 --> -0.905795).  Saving model ...
Epoch: 22 cost time: 2.9549529552459717
Epoch: 22, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.380 Vali Acc: 0.862 Test Loss: 0.380 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.954139471054077
Epoch: 23, Steps: 9 | Train Loss: 0.115 Vali Loss: 0.422 Vali Acc: 0.833 Test Loss: 0.422 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.050158739089966
Epoch: 24, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.342 Vali Acc: 0.870 Test Loss: 0.342 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.0211963653564453
Epoch: 25, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.359 Vali Acc: 0.841 Test Loss: 0.359 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.7628979682922363
Epoch: 26, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.312 Vali Acc: 0.870 Test Loss: 0.312 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.016650915145874
Epoch: 27, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.356 Vali Acc: 0.841 Test Loss: 0.356 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.347473621368408
Epoch: 28, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.153 Vali Acc: 0.957 Test Loss: 0.153 Test Acc: 0.957
Validation loss decreased (-0.905795 --> -0.956520).  Saving model ...
Epoch: 29 cost time: 3.283639907836914
Epoch: 29, Steps: 9 | Train Loss: 0.103 Vali Loss: 0.185 Vali Acc: 0.935 Test Loss: 0.185 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.0727033615112305
Epoch: 30, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.257 Vali Acc: 0.884 Test Loss: 0.257 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9565217391304348
model parameter : 446732
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.798806667327881
Epoch: 1, Steps: 9 | Train Loss: 1.419 Vali Loss: 1.398 Vali Acc: 0.449 Test Loss: 1.398 Test Acc: 0.449
Validation loss decreased (inf --> -0.449261).  Saving model ...
Epoch: 2 cost time: 2.23883056640625
Epoch: 2, Steps: 9 | Train Loss: 1.389 Vali Loss: 1.359 Vali Acc: 0.464 Test Loss: 1.359 Test Acc: 0.464
Validation loss decreased (-0.449261 --> -0.463755).  Saving model ...
Epoch: 3 cost time: 2.392049551010132
Epoch: 3, Steps: 9 | Train Loss: 1.298 Vali Loss: 1.312 Vali Acc: 0.457 Test Loss: 1.312 Test Acc: 0.457
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.2585439682006836
Epoch: 4, Steps: 9 | Train Loss: 1.258 Vali Loss: 1.259 Vali Acc: 0.464 Test Loss: 1.259 Test Acc: 0.464
Validation loss decreased (-0.463755 --> -0.463756).  Saving model ...
Epoch: 5 cost time: 2.2407209873199463
Epoch: 5, Steps: 9 | Train Loss: 1.176 Vali Loss: 1.197 Vali Acc: 0.500 Test Loss: 1.197 Test Acc: 0.500
Validation loss decreased (-0.463756 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 2.2305080890655518
Epoch: 6, Steps: 9 | Train Loss: 1.071 Vali Loss: 1.133 Vali Acc: 0.536 Test Loss: 1.133 Test Acc: 0.536
Validation loss decreased (-0.499988 --> -0.536221).  Saving model ...
Epoch: 7 cost time: 2.2743170261383057
Epoch: 7, Steps: 9 | Train Loss: 0.998 Vali Loss: 1.037 Vali Acc: 0.543 Test Loss: 1.037 Test Acc: 0.543
Validation loss decreased (-0.536221 --> -0.543468).  Saving model ...
Epoch: 8 cost time: 2.397522211074829
Epoch: 8, Steps: 9 | Train Loss: 0.882 Vali Loss: 0.953 Vali Acc: 0.609 Test Loss: 0.953 Test Acc: 0.609
Validation loss decreased (-0.543468 --> -0.608686).  Saving model ...
Epoch: 9 cost time: 2.4099042415618896
Epoch: 9, Steps: 9 | Train Loss: 0.765 Vali Loss: 0.876 Vali Acc: 0.645 Test Loss: 0.876 Test Acc: 0.645
Validation loss decreased (-0.608686 --> -0.644919).  Saving model ...
Epoch: 10 cost time: 2.4090256690979004
Epoch: 10, Steps: 9 | Train Loss: 0.669 Vali Loss: 0.795 Vali Acc: 0.688 Test Loss: 0.795 Test Acc: 0.688
Validation loss decreased (-0.644919 --> -0.688398).  Saving model ...
Epoch: 11 cost time: 2.4105000495910645
Epoch: 11, Steps: 9 | Train Loss: 0.594 Vali Loss: 0.716 Vali Acc: 0.703 Test Loss: 0.716 Test Acc: 0.703
Validation loss decreased (-0.688398 --> -0.702891).  Saving model ...
Epoch: 12 cost time: 2.3885257244110107
Epoch: 12, Steps: 9 | Train Loss: 0.511 Vali Loss: 0.676 Vali Acc: 0.725 Test Loss: 0.676 Test Acc: 0.725
Validation loss decreased (-0.702891 --> -0.724631).  Saving model ...
Epoch: 13 cost time: 2.4938018321990967
Epoch: 13, Steps: 9 | Train Loss: 0.488 Vali Loss: 0.609 Vali Acc: 0.717 Test Loss: 0.609 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.3167781829833984
Epoch: 14, Steps: 9 | Train Loss: 0.386 Vali Loss: 0.584 Vali Acc: 0.746 Test Loss: 0.584 Test Acc: 0.746
Validation loss decreased (-0.724631 --> -0.746371).  Saving model ...
Epoch: 15 cost time: 2.1477909088134766
Epoch: 15, Steps: 9 | Train Loss: 0.327 Vali Loss: 0.546 Vali Acc: 0.746 Test Loss: 0.546 Test Acc: 0.746
Validation loss decreased (-0.746371 --> -0.746371).  Saving model ...
Epoch: 16 cost time: 2.384406328201294
Epoch: 16, Steps: 9 | Train Loss: 0.311 Vali Loss: 0.539 Vali Acc: 0.754 Test Loss: 0.539 Test Acc: 0.754
Validation loss decreased (-0.746371 --> -0.753618).  Saving model ...
Epoch: 17 cost time: 2.33774995803833
Epoch: 17, Steps: 9 | Train Loss: 0.269 Vali Loss: 0.528 Vali Acc: 0.775 Test Loss: 0.528 Test Acc: 0.775
Validation loss decreased (-0.753618 --> -0.775357).  Saving model ...
Epoch: 18 cost time: 2.165715217590332
Epoch: 18, Steps: 9 | Train Loss: 0.252 Vali Loss: 0.497 Vali Acc: 0.812 Test Loss: 0.497 Test Acc: 0.812
Validation loss decreased (-0.775357 --> -0.811589).  Saving model ...
Epoch: 19 cost time: 2.2977380752563477
Epoch: 19, Steps: 9 | Train Loss: 0.246 Vali Loss: 0.459 Vali Acc: 0.833 Test Loss: 0.459 Test Acc: 0.833
Validation loss decreased (-0.811589 --> -0.833329).  Saving model ...
Epoch: 20 cost time: 2.3171465396881104
Epoch: 20, Steps: 9 | Train Loss: 0.209 Vali Loss: 0.459 Vali Acc: 0.826 Test Loss: 0.459 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.363290309906006
Epoch: 21, Steps: 9 | Train Loss: 0.180 Vali Loss: 0.452 Vali Acc: 0.833 Test Loss: 0.452 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 22 cost time: 2.2657766342163086
Epoch: 22, Steps: 9 | Train Loss: 0.136 Vali Loss: 0.456 Vali Acc: 0.841 Test Loss: 0.456 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840575).  Saving model ...
Epoch: 23 cost time: 2.3505663871765137
Epoch: 23, Steps: 9 | Train Loss: 0.147 Vali Loss: 0.382 Vali Acc: 0.870 Test Loss: 0.382 Test Acc: 0.870
Validation loss decreased (-0.840575 --> -0.869561).  Saving model ...
Epoch: 24 cost time: 2.1640918254852295
Epoch: 24, Steps: 9 | Train Loss: 0.166 Vali Loss: 0.413 Vali Acc: 0.848 Test Loss: 0.413 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.150089979171753
Epoch: 25, Steps: 9 | Train Loss: 0.134 Vali Loss: 0.474 Vali Acc: 0.833 Test Loss: 0.474 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.7546076774597168
Epoch: 26, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.408 Vali Acc: 0.862 Test Loss: 0.408 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.1573848724365234
Epoch: 27, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.392 Vali Acc: 0.862 Test Loss: 0.392 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.164177656173706
Epoch: 28, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.371 Vali Acc: 0.884 Test Loss: 0.371 Test Acc: 0.884
Validation loss decreased (-0.869561 --> -0.884054).  Saving model ...
Epoch: 29 cost time: 2.267627000808716
Epoch: 29, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.382 Vali Acc: 0.855 Test Loss: 0.382 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.4385454654693604
Epoch: 30, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.385 Vali Acc: 0.862 Test Loss: 0.385 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 136220
model size : 0.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.359735012054443
Epoch: 1, Steps: 9 | Train Loss: 1.345 Vali Loss: 1.311 Vali Acc: 0.377 Test Loss: 1.311 Test Acc: 0.377
Validation loss decreased (inf --> -0.376798).  Saving model ...
Epoch: 2 cost time: 2.251779079437256
Epoch: 2, Steps: 9 | Train Loss: 1.267 Vali Loss: 1.241 Vali Acc: 0.449 Test Loss: 1.241 Test Acc: 0.449
Validation loss decreased (-0.376798 --> -0.449263).  Saving model ...
Epoch: 3 cost time: 2.2006819248199463
Epoch: 3, Steps: 9 | Train Loss: 1.189 Vali Loss: 1.161 Vali Acc: 0.514 Test Loss: 1.161 Test Acc: 0.514
Validation loss decreased (-0.449263 --> -0.514481).  Saving model ...
Epoch: 4 cost time: 2.22798752784729
Epoch: 4, Steps: 9 | Train Loss: 1.085 Vali Loss: 1.084 Vali Acc: 0.551 Test Loss: 1.084 Test Acc: 0.551
Validation loss decreased (-0.514481 --> -0.550714).  Saving model ...
Epoch: 5 cost time: 2.2166597843170166
Epoch: 5, Steps: 9 | Train Loss: 1.006 Vali Loss: 1.011 Vali Acc: 0.572 Test Loss: 1.011 Test Acc: 0.572
Validation loss decreased (-0.550714 --> -0.572454).  Saving model ...
Epoch: 6 cost time: 2.24845027923584
Epoch: 6, Steps: 9 | Train Loss: 0.909 Vali Loss: 0.938 Vali Acc: 0.630 Test Loss: 0.938 Test Acc: 0.630
Validation loss decreased (-0.572454 --> -0.630425).  Saving model ...
Epoch: 7 cost time: 2.2266781330108643
Epoch: 7, Steps: 9 | Train Loss: 0.804 Vali Loss: 0.870 Vali Acc: 0.674 Test Loss: 0.870 Test Acc: 0.674
Validation loss decreased (-0.630425 --> -0.673904).  Saving model ...
Epoch: 8 cost time: 2.230163335800171
Epoch: 8, Steps: 9 | Train Loss: 0.769 Vali Loss: 0.815 Vali Acc: 0.696 Test Loss: 0.815 Test Acc: 0.696
Validation loss decreased (-0.673904 --> -0.695644).  Saving model ...
Epoch: 9 cost time: 2.3469996452331543
Epoch: 9, Steps: 9 | Train Loss: 0.670 Vali Loss: 0.753 Vali Acc: 0.710 Test Loss: 0.753 Test Acc: 0.710
Validation loss decreased (-0.695644 --> -0.710137).  Saving model ...
Epoch: 10 cost time: 2.310297966003418
Epoch: 10, Steps: 9 | Train Loss: 0.612 Vali Loss: 0.698 Vali Acc: 0.739 Test Loss: 0.698 Test Acc: 0.739
Validation loss decreased (-0.710137 --> -0.739123).  Saving model ...
Epoch: 11 cost time: 2.190890312194824
Epoch: 11, Steps: 9 | Train Loss: 0.507 Vali Loss: 0.639 Vali Acc: 0.732 Test Loss: 0.639 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.1642518043518066
Epoch: 12, Steps: 9 | Train Loss: 0.485 Vali Loss: 0.580 Vali Acc: 0.746 Test Loss: 0.580 Test Acc: 0.746
Validation loss decreased (-0.739123 --> -0.746371).  Saving model ...
Epoch: 13 cost time: 2.3466367721557617
Epoch: 13, Steps: 9 | Train Loss: 0.436 Vali Loss: 0.573 Vali Acc: 0.739 Test Loss: 0.573 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.349663496017456
Epoch: 14, Steps: 9 | Train Loss: 0.381 Vali Loss: 0.534 Vali Acc: 0.775 Test Loss: 0.534 Test Acc: 0.775
Validation loss decreased (-0.746371 --> -0.775357).  Saving model ...
Epoch: 15 cost time: 2.373080015182495
Epoch: 15, Steps: 9 | Train Loss: 0.358 Vali Loss: 0.514 Vali Acc: 0.797 Test Loss: 0.514 Test Acc: 0.797
Validation loss decreased (-0.775357 --> -0.797096).  Saving model ...
Epoch: 16 cost time: 2.4396615028381348
Epoch: 16, Steps: 9 | Train Loss: 0.319 Vali Loss: 0.536 Vali Acc: 0.768 Test Loss: 0.536 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.3297834396362305
Epoch: 17, Steps: 9 | Train Loss: 0.280 Vali Loss: 0.495 Vali Acc: 0.783 Test Loss: 0.495 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.2142281532287598
Epoch: 18, Steps: 9 | Train Loss: 0.252 Vali Loss: 0.449 Vali Acc: 0.790 Test Loss: 0.449 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.2771408557891846
Epoch: 19, Steps: 9 | Train Loss: 0.214 Vali Loss: 0.454 Vali Acc: 0.804 Test Loss: 0.454 Test Acc: 0.804
Validation loss decreased (-0.797096 --> -0.804343).  Saving model ...
Epoch: 20 cost time: 2.1169583797454834
Epoch: 20, Steps: 9 | Train Loss: 0.174 Vali Loss: 0.434 Vali Acc: 0.841 Test Loss: 0.434 Test Acc: 0.841
Validation loss decreased (-0.804343 --> -0.840575).  Saving model ...
Epoch: 21 cost time: 2.2314231395721436
Epoch: 21, Steps: 9 | Train Loss: 0.168 Vali Loss: 0.425 Vali Acc: 0.812 Test Loss: 0.425 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.121386766433716
Epoch: 22, Steps: 9 | Train Loss: 0.134 Vali Loss: 0.398 Vali Acc: 0.812 Test Loss: 0.398 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.1456236839294434
Epoch: 23, Steps: 9 | Train Loss: 0.164 Vali Loss: 0.401 Vali Acc: 0.812 Test Loss: 0.401 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.2936666011810303
Epoch: 24, Steps: 9 | Train Loss: 0.116 Vali Loss: 0.387 Vali Acc: 0.848 Test Loss: 0.387 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847822).  Saving model ...
Epoch: 25 cost time: 2.3327159881591797
Epoch: 25, Steps: 9 | Train Loss: 0.116 Vali Loss: 0.392 Vali Acc: 0.812 Test Loss: 0.392 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.2612452507019043
Epoch: 26, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.422 Vali Acc: 0.826 Test Loss: 0.422 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.3874874114990234
Epoch: 27, Steps: 9 | Train Loss: 0.115 Vali Loss: 0.383 Vali Acc: 0.841 Test Loss: 0.383 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.383249044418335
Epoch: 28, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.345 Vali Acc: 0.833 Test Loss: 0.345 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.3283889293670654
Epoch: 29, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.358 Vali Acc: 0.833 Test Loss: 0.358 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.319096803665161
Epoch: 30, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.359 Vali Acc: 0.841 Test Loss: 0.359 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 446732
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.9487390518188477
Epoch: 1, Steps: 9 | Train Loss: 1.408 Vali Loss: 1.399 Vali Acc: 0.406 Test Loss: 1.399 Test Acc: 0.406
Validation loss decreased (inf --> -0.405783).  Saving model ...
Epoch: 2 cost time: 2.031843900680542
Epoch: 2, Steps: 9 | Train Loss: 1.385 Vali Loss: 1.360 Vali Acc: 0.420 Test Loss: 1.360 Test Acc: 0.420
Validation loss decreased (-0.405783 --> -0.420276).  Saving model ...
Epoch: 3 cost time: 2.011059045791626
Epoch: 3, Steps: 9 | Train Loss: 1.323 Vali Loss: 1.315 Vali Acc: 0.449 Test Loss: 1.315 Test Acc: 0.449
Validation loss decreased (-0.420276 --> -0.449262).  Saving model ...
Epoch: 4 cost time: 2.0930888652801514
Epoch: 4, Steps: 9 | Train Loss: 1.266 Vali Loss: 1.269 Vali Acc: 0.435 Test Loss: 1.269 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0421836376190186
Epoch: 5, Steps: 9 | Train Loss: 1.187 Vali Loss: 1.219 Vali Acc: 0.464 Test Loss: 1.219 Test Acc: 0.464
Validation loss decreased (-0.449262 --> -0.463756).  Saving model ...
Epoch: 6 cost time: 2.1118319034576416
Epoch: 6, Steps: 9 | Train Loss: 1.093 Vali Loss: 1.164 Vali Acc: 0.486 Test Loss: 1.164 Test Acc: 0.486
Validation loss decreased (-0.463756 --> -0.485496).  Saving model ...
Epoch: 7 cost time: 1.8485145568847656
Epoch: 7, Steps: 9 | Train Loss: 1.025 Vali Loss: 1.084 Vali Acc: 0.543 Test Loss: 1.084 Test Acc: 0.543
Validation loss decreased (-0.485496 --> -0.543467).  Saving model ...
Epoch: 8 cost time: 1.9499609470367432
Epoch: 8, Steps: 9 | Train Loss: 0.934 Vali Loss: 1.019 Vali Acc: 0.572 Test Loss: 1.019 Test Acc: 0.572
Validation loss decreased (-0.543467 --> -0.572454).  Saving model ...
Epoch: 9 cost time: 1.8861150741577148
Epoch: 9, Steps: 9 | Train Loss: 0.845 Vali Loss: 0.952 Vali Acc: 0.609 Test Loss: 0.952 Test Acc: 0.609
Validation loss decreased (-0.572454 --> -0.608686).  Saving model ...
Epoch: 10 cost time: 1.9521214962005615
Epoch: 10, Steps: 9 | Train Loss: 0.739 Vali Loss: 0.892 Vali Acc: 0.638 Test Loss: 0.892 Test Acc: 0.638
Validation loss decreased (-0.608686 --> -0.637672).  Saving model ...
Epoch: 11 cost time: 1.9274570941925049
Epoch: 11, Steps: 9 | Train Loss: 0.658 Vali Loss: 0.829 Vali Acc: 0.652 Test Loss: 0.829 Test Acc: 0.652
Validation loss decreased (-0.637672 --> -0.652166).  Saving model ...
Epoch: 12 cost time: 1.9435856342315674
Epoch: 12, Steps: 9 | Train Loss: 0.599 Vali Loss: 0.789 Vali Acc: 0.674 Test Loss: 0.789 Test Acc: 0.674
Validation loss decreased (-0.652166 --> -0.673905).  Saving model ...
Epoch: 13 cost time: 2.0297160148620605
Epoch: 13, Steps: 9 | Train Loss: 0.586 Vali Loss: 0.733 Vali Acc: 0.703 Test Loss: 0.733 Test Acc: 0.703
Validation loss decreased (-0.673905 --> -0.702891).  Saving model ...
Epoch: 14 cost time: 1.9039332866668701
Epoch: 14, Steps: 9 | Train Loss: 0.489 Vali Loss: 0.716 Vali Acc: 0.739 Test Loss: 0.716 Test Acc: 0.739
Validation loss decreased (-0.702891 --> -0.739123).  Saving model ...
Epoch: 15 cost time: 1.9078776836395264
Epoch: 15, Steps: 9 | Train Loss: 0.479 Vali Loss: 0.754 Vali Acc: 0.696 Test Loss: 0.754 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9132740497589111
Epoch: 16, Steps: 9 | Train Loss: 0.430 Vali Loss: 0.679 Vali Acc: 0.732 Test Loss: 0.679 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.012312173843384
Epoch: 17, Steps: 9 | Train Loss: 0.359 Vali Loss: 0.645 Vali Acc: 0.739 Test Loss: 0.645 Test Acc: 0.739
Validation loss decreased (-0.739123 --> -0.739124).  Saving model ...
Epoch: 18 cost time: 1.8744287490844727
Epoch: 18, Steps: 9 | Train Loss: 0.364 Vali Loss: 0.679 Vali Acc: 0.717 Test Loss: 0.679 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.923224687576294
Epoch: 19, Steps: 9 | Train Loss: 0.293 Vali Loss: 0.636 Vali Acc: 0.717 Test Loss: 0.636 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.0254552364349365
Epoch: 20, Steps: 9 | Train Loss: 0.290 Vali Loss: 0.594 Vali Acc: 0.739 Test Loss: 0.594 Test Acc: 0.739
Validation loss decreased (-0.739124 --> -0.739124).  Saving model ...
Epoch: 21 cost time: 1.8888301849365234
Epoch: 21, Steps: 9 | Train Loss: 0.261 Vali Loss: 0.602 Vali Acc: 0.761 Test Loss: 0.602 Test Acc: 0.761
Validation loss decreased (-0.739124 --> -0.760864).  Saving model ...
Epoch: 22 cost time: 2.080122470855713
Epoch: 22, Steps: 9 | Train Loss: 0.230 Vali Loss: 0.587 Vali Acc: 0.761 Test Loss: 0.587 Test Acc: 0.761
Validation loss decreased (-0.760864 --> -0.760864).  Saving model ...
Epoch: 23 cost time: 1.959380865097046
Epoch: 23, Steps: 9 | Train Loss: 0.194 Vali Loss: 0.538 Vali Acc: 0.783 Test Loss: 0.538 Test Acc: 0.783
Validation loss decreased (-0.760864 --> -0.782603).  Saving model ...
Epoch: 24 cost time: 2.060544729232788
Epoch: 24, Steps: 9 | Train Loss: 0.188 Vali Loss: 0.589 Vali Acc: 0.761 Test Loss: 0.589 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.0372354984283447
Epoch: 25, Steps: 9 | Train Loss: 0.164 Vali Loss: 0.531 Vali Acc: 0.812 Test Loss: 0.531 Test Acc: 0.812
Validation loss decreased (-0.782603 --> -0.811589).  Saving model ...
Epoch: 26 cost time: 2.0252363681793213
Epoch: 26, Steps: 9 | Train Loss: 0.149 Vali Loss: 0.479 Vali Acc: 0.819 Test Loss: 0.479 Test Acc: 0.819
Validation loss decreased (-0.811589 --> -0.818836).  Saving model ...
Epoch: 27 cost time: 2.0753819942474365
Epoch: 27, Steps: 9 | Train Loss: 0.125 Vali Loss: 0.524 Vali Acc: 0.826 Test Loss: 0.524 Test Acc: 0.826
Validation loss decreased (-0.818836 --> -0.826082).  Saving model ...
Epoch: 28 cost time: 1.9619107246398926
Epoch: 28, Steps: 9 | Train Loss: 0.149 Vali Loss: 0.609 Vali Acc: 0.775 Test Loss: 0.609 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.9438388347625732
Epoch: 29, Steps: 9 | Train Loss: 0.122 Vali Loss: 0.513 Vali Acc: 0.812 Test Loss: 0.513 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.0246052742004395
Epoch: 30, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.516 Vali Acc: 0.812 Test Loss: 0.516 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8260869565217391
model parameter : 136220
model size : 0.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.60164737701416
Epoch: 1, Steps: 9 | Train Loss: 1.488 Vali Loss: 1.408 Vali Acc: 0.232 Test Loss: 1.408 Test Acc: 0.232
Validation loss decreased (inf --> -0.231870).  Saving model ...
Epoch: 2 cost time: 3.2070114612579346
Epoch: 2, Steps: 9 | Train Loss: 1.392 Vali Loss: 1.352 Vali Acc: 0.312 Test Loss: 1.352 Test Acc: 0.312
Validation loss decreased (-0.231870 --> -0.311581).  Saving model ...
Epoch: 3 cost time: 3.240429639816284
Epoch: 3, Steps: 9 | Train Loss: 1.327 Vali Loss: 1.281 Vali Acc: 0.406 Test Loss: 1.281 Test Acc: 0.406
Validation loss decreased (-0.311581 --> -0.405784).  Saving model ...
Epoch: 4 cost time: 3.11618709564209
Epoch: 4, Steps: 9 | Train Loss: 1.237 Vali Loss: 1.200 Vali Acc: 0.529 Test Loss: 1.200 Test Acc: 0.529
Validation loss decreased (-0.405784 --> -0.528974).  Saving model ...
Epoch: 5 cost time: 3.400264263153076
Epoch: 5, Steps: 9 | Train Loss: 1.131 Vali Loss: 1.112 Vali Acc: 0.536 Test Loss: 1.112 Test Acc: 0.536
Validation loss decreased (-0.528974 --> -0.536221).  Saving model ...
Epoch: 6 cost time: 3.2557411193847656
Epoch: 6, Steps: 9 | Train Loss: 1.038 Vali Loss: 1.011 Vali Acc: 0.565 Test Loss: 1.011 Test Acc: 0.565
Validation loss decreased (-0.536221 --> -0.565207).  Saving model ...
Epoch: 7 cost time: 3.080681324005127
Epoch: 7, Steps: 9 | Train Loss: 0.924 Vali Loss: 0.918 Vali Acc: 0.587 Test Loss: 0.918 Test Acc: 0.587
Validation loss decreased (-0.565207 --> -0.586947).  Saving model ...
Epoch: 8 cost time: 3.377310276031494
Epoch: 8, Steps: 9 | Train Loss: 0.808 Vali Loss: 0.834 Vali Acc: 0.638 Test Loss: 0.834 Test Acc: 0.638
Validation loss decreased (-0.586947 --> -0.637673).  Saving model ...
Epoch: 9 cost time: 3.445840835571289
Epoch: 9, Steps: 9 | Train Loss: 0.710 Vali Loss: 0.756 Vali Acc: 0.696 Test Loss: 0.756 Test Acc: 0.696
Validation loss decreased (-0.637673 --> -0.695645).  Saving model ...
Epoch: 10 cost time: 3.4448776245117188
Epoch: 10, Steps: 9 | Train Loss: 0.593 Vali Loss: 0.644 Vali Acc: 0.790 Test Loss: 0.644 Test Acc: 0.790
Validation loss decreased (-0.695645 --> -0.789849).  Saving model ...
Epoch: 11 cost time: 3.3168222904205322
Epoch: 11, Steps: 9 | Train Loss: 0.526 Vali Loss: 0.588 Vali Acc: 0.797 Test Loss: 0.588 Test Acc: 0.797
Validation loss decreased (-0.789849 --> -0.797096).  Saving model ...
Epoch: 12 cost time: 3.4151647090911865
Epoch: 12, Steps: 9 | Train Loss: 0.439 Vali Loss: 0.523 Vali Acc: 0.797 Test Loss: 0.523 Test Acc: 0.797
Validation loss decreased (-0.797096 --> -0.797096).  Saving model ...
Epoch: 13 cost time: 3.297417163848877
Epoch: 13, Steps: 9 | Train Loss: 0.378 Vali Loss: 0.482 Vali Acc: 0.804 Test Loss: 0.482 Test Acc: 0.804
Validation loss decreased (-0.797096 --> -0.804343).  Saving model ...
Epoch: 14 cost time: 3.258727788925171
Epoch: 14, Steps: 9 | Train Loss: 0.296 Vali Loss: 0.450 Vali Acc: 0.819 Test Loss: 0.450 Test Acc: 0.819
Validation loss decreased (-0.804343 --> -0.818836).  Saving model ...
Epoch: 15 cost time: 3.2245795726776123
Epoch: 15, Steps: 9 | Train Loss: 0.270 Vali Loss: 0.383 Vali Acc: 0.855 Test Loss: 0.383 Test Acc: 0.855
Validation loss decreased (-0.818836 --> -0.855069).  Saving model ...
Epoch: 16 cost time: 3.2689473628997803
Epoch: 16, Steps: 9 | Train Loss: 0.274 Vali Loss: 0.394 Vali Acc: 0.841 Test Loss: 0.394 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.3725240230560303
Epoch: 17, Steps: 9 | Train Loss: 0.220 Vali Loss: 0.342 Vali Acc: 0.870 Test Loss: 0.342 Test Acc: 0.870
Validation loss decreased (-0.855069 --> -0.869562).  Saving model ...
Epoch: 18 cost time: 3.1960396766662598
Epoch: 18, Steps: 9 | Train Loss: 0.194 Vali Loss: 0.358 Vali Acc: 0.855 Test Loss: 0.358 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.107229709625244
Epoch: 19, Steps: 9 | Train Loss: 0.160 Vali Loss: 0.356 Vali Acc: 0.884 Test Loss: 0.356 Test Acc: 0.884
Validation loss decreased (-0.869562 --> -0.884054).  Saving model ...
Epoch: 20 cost time: 3.1352715492248535
Epoch: 20, Steps: 9 | Train Loss: 0.122 Vali Loss: 0.316 Vali Acc: 0.906 Test Loss: 0.316 Test Acc: 0.906
Validation loss decreased (-0.884054 --> -0.905794).  Saving model ...
Epoch: 21 cost time: 3.090120792388916
Epoch: 21, Steps: 9 | Train Loss: 0.113 Vali Loss: 0.328 Vali Acc: 0.884 Test Loss: 0.328 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.0445456504821777
Epoch: 22, Steps: 9 | Train Loss: 0.104 Vali Loss: 0.303 Vali Acc: 0.891 Test Loss: 0.303 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.21673583984375
Epoch: 23, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.292 Vali Acc: 0.899 Test Loss: 0.292 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.1646077632904053
Epoch: 24, Steps: 9 | Train Loss: 0.108 Vali Loss: 0.335 Vali Acc: 0.884 Test Loss: 0.335 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.950871467590332
Epoch: 25, Steps: 9 | Train Loss: 0.120 Vali Loss: 0.354 Vali Acc: 0.884 Test Loss: 0.354 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.9076337814331055
Epoch: 26, Steps: 9 | Train Loss: 0.080 Vali Loss: 0.340 Vali Acc: 0.884 Test Loss: 0.340 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.159247398376465
Epoch: 27, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.370 Vali Acc: 0.884 Test Loss: 0.370 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.9960715770721436
Epoch: 28, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.346 Vali Acc: 0.899 Test Loss: 0.346 Test Acc: 0.899
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.147221326828003
Epoch: 29, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.313 Vali Acc: 0.906 Test Loss: 0.313 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 30 cost time: 3.012312412261963
Epoch: 30, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.319 Vali Acc: 0.884 Test Loss: 0.319 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 226796
model size : 1.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.426799058914185
Epoch: 1, Steps: 9 | Train Loss: 1.452 Vali Loss: 1.411 Vali Acc: 0.246 Test Loss: 1.411 Test Acc: 0.246
Validation loss decreased (inf --> -0.246363).  Saving model ...
Epoch: 2 cost time: 2.3111467361450195
Epoch: 2, Steps: 9 | Train Loss: 1.380 Vali Loss: 1.329 Vali Acc: 0.377 Test Loss: 1.329 Test Acc: 0.377
Validation loss decreased (-0.246363 --> -0.376798).  Saving model ...
Epoch: 3 cost time: 2.441636800765991
Epoch: 3, Steps: 9 | Train Loss: 1.277 Vali Loss: 1.238 Vali Acc: 0.471 Test Loss: 1.238 Test Acc: 0.471
Validation loss decreased (-0.376798 --> -0.471002).  Saving model ...
Epoch: 4 cost time: 2.430086851119995
Epoch: 4, Steps: 9 | Train Loss: 1.163 Vali Loss: 1.148 Vali Acc: 0.536 Test Loss: 1.148 Test Acc: 0.536
Validation loss decreased (-0.471002 --> -0.536220).  Saving model ...
Epoch: 5 cost time: 2.2859225273132324
Epoch: 5, Steps: 9 | Train Loss: 1.083 Vali Loss: 1.067 Vali Acc: 0.587 Test Loss: 1.067 Test Acc: 0.587
Validation loss decreased (-0.536220 --> -0.586946).  Saving model ...
Epoch: 6 cost time: 2.2800769805908203
Epoch: 6, Steps: 9 | Train Loss: 0.978 Vali Loss: 1.003 Vali Acc: 0.594 Test Loss: 1.003 Test Acc: 0.594
Validation loss decreased (-0.586946 --> -0.594193).  Saving model ...
Epoch: 7 cost time: 2.257110357284546
Epoch: 7, Steps: 9 | Train Loss: 0.898 Vali Loss: 0.946 Vali Acc: 0.601 Test Loss: 0.946 Test Acc: 0.601
Validation loss decreased (-0.594193 --> -0.601440).  Saving model ...
Epoch: 8 cost time: 2.290924072265625
Epoch: 8, Steps: 9 | Train Loss: 0.793 Vali Loss: 0.883 Vali Acc: 0.587 Test Loss: 0.883 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.2952816486358643
Epoch: 9, Steps: 9 | Train Loss: 0.708 Vali Loss: 0.808 Vali Acc: 0.630 Test Loss: 0.808 Test Acc: 0.630
Validation loss decreased (-0.601440 --> -0.630427).  Saving model ...
Epoch: 10 cost time: 2.3116226196289062
Epoch: 10, Steps: 9 | Train Loss: 0.618 Vali Loss: 0.738 Vali Acc: 0.630 Test Loss: 0.738 Test Acc: 0.630
Validation loss decreased (-0.630427 --> -0.630427).  Saving model ...
Epoch: 11 cost time: 2.2814111709594727
Epoch: 11, Steps: 9 | Train Loss: 0.550 Vali Loss: 0.678 Vali Acc: 0.681 Test Loss: 0.678 Test Acc: 0.681
Validation loss decreased (-0.630427 --> -0.681153).  Saving model ...
Epoch: 12 cost time: 2.3605196475982666
Epoch: 12, Steps: 9 | Train Loss: 0.481 Vali Loss: 0.621 Vali Acc: 0.732 Test Loss: 0.621 Test Acc: 0.732
Validation loss decreased (-0.681153 --> -0.731878).  Saving model ...
Epoch: 13 cost time: 2.363718032836914
Epoch: 13, Steps: 9 | Train Loss: 0.409 Vali Loss: 0.588 Vali Acc: 0.739 Test Loss: 0.588 Test Acc: 0.739
Validation loss decreased (-0.731878 --> -0.739125).  Saving model ...
Epoch: 14 cost time: 2.440723419189453
Epoch: 14, Steps: 9 | Train Loss: 0.396 Vali Loss: 0.549 Vali Acc: 0.775 Test Loss: 0.549 Test Acc: 0.775
Validation loss decreased (-0.739125 --> -0.775357).  Saving model ...
Epoch: 15 cost time: 2.3100075721740723
Epoch: 15, Steps: 9 | Train Loss: 0.360 Vali Loss: 0.531 Vali Acc: 0.761 Test Loss: 0.531 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.4773199558258057
Epoch: 16, Steps: 9 | Train Loss: 0.276 Vali Loss: 0.504 Vali Acc: 0.790 Test Loss: 0.504 Test Acc: 0.790
Validation loss decreased (-0.775357 --> -0.789850).  Saving model ...
Epoch: 17 cost time: 2.402552604675293
Epoch: 17, Steps: 9 | Train Loss: 0.263 Vali Loss: 0.505 Vali Acc: 0.775 Test Loss: 0.505 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.3665130138397217
Epoch: 18, Steps: 9 | Train Loss: 0.231 Vali Loss: 0.501 Vali Acc: 0.804 Test Loss: 0.501 Test Acc: 0.804
Validation loss decreased (-0.789850 --> -0.804343).  Saving model ...
Epoch: 19 cost time: 2.3458495140075684
Epoch: 19, Steps: 9 | Train Loss: 0.196 Vali Loss: 0.462 Vali Acc: 0.812 Test Loss: 0.462 Test Acc: 0.812
Validation loss decreased (-0.804343 --> -0.811590).  Saving model ...
Epoch: 20 cost time: 2.349330186843872
Epoch: 20, Steps: 9 | Train Loss: 0.184 Vali Loss: 0.479 Vali Acc: 0.819 Test Loss: 0.479 Test Acc: 0.819
Validation loss decreased (-0.811590 --> -0.818836).  Saving model ...
Epoch: 21 cost time: 2.4083261489868164
Epoch: 21, Steps: 9 | Train Loss: 0.150 Vali Loss: 0.469 Vali Acc: 0.826 Test Loss: 0.469 Test Acc: 0.826
Validation loss decreased (-0.818836 --> -0.826082).  Saving model ...
Epoch: 22 cost time: 2.500072717666626
Epoch: 22, Steps: 9 | Train Loss: 0.132 Vali Loss: 0.489 Vali Acc: 0.812 Test Loss: 0.489 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.4470579624176025
Epoch: 23, Steps: 9 | Train Loss: 0.114 Vali Loss: 0.484 Vali Acc: 0.826 Test Loss: 0.484 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.525869607925415
Epoch: 24, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.457 Vali Acc: 0.826 Test Loss: 0.457 Test Acc: 0.826
Validation loss decreased (-0.826082 --> -0.826082).  Saving model ...
Epoch: 25 cost time: 2.4518883228302
Epoch: 25, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.452 Vali Acc: 0.833 Test Loss: 0.452 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833329).  Saving model ...
Epoch: 26 cost time: 2.592562437057495
Epoch: 26, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.459 Vali Acc: 0.826 Test Loss: 0.459 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.390676259994507
Epoch: 27, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.446 Vali Acc: 0.833 Test Loss: 0.446 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 28 cost time: 2.3964884281158447
Epoch: 28, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.405 Vali Acc: 0.833 Test Loss: 0.405 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 29 cost time: 2.4417471885681152
Epoch: 29, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.437 Vali Acc: 0.841 Test Loss: 0.437 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840575).  Saving model ...
Epoch: 30 cost time: 2.465085506439209
Epoch: 30, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.503 Vali Acc: 0.826 Test Loss: 0.503 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8405797101449275
model parameter : 71516
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.900346994400024
Epoch: 1, Steps: 9 | Train Loss: 1.492 Vali Loss: 1.413 Vali Acc: 0.217 Test Loss: 1.413 Test Acc: 0.217
Validation loss decreased (inf --> -0.217377).  Saving model ...
Epoch: 2 cost time: 2.5368411540985107
Epoch: 2, Steps: 9 | Train Loss: 1.395 Vali Loss: 1.356 Vali Acc: 0.290 Test Loss: 1.356 Test Acc: 0.290
Validation loss decreased (-0.217377 --> -0.289842).  Saving model ...
Epoch: 3 cost time: 2.591843366622925
Epoch: 3, Steps: 9 | Train Loss: 1.328 Vali Loss: 1.283 Vali Acc: 0.442 Test Loss: 1.283 Test Acc: 0.442
Validation loss decreased (-0.289842 --> -0.442016).  Saving model ...
Epoch: 4 cost time: 2.565901517868042
Epoch: 4, Steps: 9 | Train Loss: 1.239 Vali Loss: 1.199 Vali Acc: 0.514 Test Loss: 1.199 Test Acc: 0.514
Validation loss decreased (-0.442016 --> -0.514481).  Saving model ...
Epoch: 5 cost time: 2.740262031555176
Epoch: 5, Steps: 9 | Train Loss: 1.134 Vali Loss: 1.113 Vali Acc: 0.529 Test Loss: 1.113 Test Acc: 0.529
Validation loss decreased (-0.514481 --> -0.528974).  Saving model ...
Epoch: 6 cost time: 2.5003864765167236
Epoch: 6, Steps: 9 | Train Loss: 1.050 Vali Loss: 1.013 Vali Acc: 0.565 Test Loss: 1.013 Test Acc: 0.565
Validation loss decreased (-0.528974 --> -0.565207).  Saving model ...
Epoch: 7 cost time: 2.5453145503997803
Epoch: 7, Steps: 9 | Train Loss: 0.940 Vali Loss: 0.922 Vali Acc: 0.572 Test Loss: 0.922 Test Acc: 0.572
Validation loss decreased (-0.565207 --> -0.572455).  Saving model ...
Epoch: 8 cost time: 2.587615728378296
Epoch: 8, Steps: 9 | Train Loss: 0.829 Vali Loss: 0.837 Vali Acc: 0.616 Test Loss: 0.837 Test Acc: 0.616
Validation loss decreased (-0.572455 --> -0.615934).  Saving model ...
Epoch: 9 cost time: 2.602802276611328
Epoch: 9, Steps: 9 | Train Loss: 0.739 Vali Loss: 0.755 Vali Acc: 0.688 Test Loss: 0.755 Test Acc: 0.688
Validation loss decreased (-0.615934 --> -0.688398).  Saving model ...
Epoch: 10 cost time: 2.805742025375366
Epoch: 10, Steps: 9 | Train Loss: 0.623 Vali Loss: 0.669 Vali Acc: 0.775 Test Loss: 0.669 Test Acc: 0.775
Validation loss decreased (-0.688398 --> -0.775356).  Saving model ...
Epoch: 11 cost time: 2.4079880714416504
Epoch: 11, Steps: 9 | Train Loss: 0.552 Vali Loss: 0.623 Vali Acc: 0.783 Test Loss: 0.623 Test Acc: 0.783
Validation loss decreased (-0.775356 --> -0.782602).  Saving model ...
Epoch: 12 cost time: 2.3186137676239014
Epoch: 12, Steps: 9 | Train Loss: 0.451 Vali Loss: 0.555 Vali Acc: 0.790 Test Loss: 0.555 Test Acc: 0.790
Validation loss decreased (-0.782602 --> -0.789850).  Saving model ...
Epoch: 13 cost time: 2.5199599266052246
Epoch: 13, Steps: 9 | Train Loss: 0.403 Vali Loss: 0.472 Vali Acc: 0.812 Test Loss: 0.472 Test Acc: 0.812
Validation loss decreased (-0.789850 --> -0.811589).  Saving model ...
Epoch: 14 cost time: 2.4560720920562744
Epoch: 14, Steps: 9 | Train Loss: 0.333 Vali Loss: 0.481 Vali Acc: 0.826 Test Loss: 0.481 Test Acc: 0.826
Validation loss decreased (-0.811589 --> -0.826082).  Saving model ...
Epoch: 15 cost time: 2.32711124420166
Epoch: 15, Steps: 9 | Train Loss: 0.303 Vali Loss: 0.442 Vali Acc: 0.862 Test Loss: 0.442 Test Acc: 0.862
Validation loss decreased (-0.826082 --> -0.862314).  Saving model ...
Epoch: 16 cost time: 2.4795098304748535
Epoch: 16, Steps: 9 | Train Loss: 0.307 Vali Loss: 0.465 Vali Acc: 0.812 Test Loss: 0.465 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.603945255279541
Epoch: 17, Steps: 9 | Train Loss: 0.247 Vali Loss: 0.402 Vali Acc: 0.848 Test Loss: 0.402 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.4503488540649414
Epoch: 18, Steps: 9 | Train Loss: 0.209 Vali Loss: 0.436 Vali Acc: 0.841 Test Loss: 0.436 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.6817309856414795
Epoch: 19, Steps: 9 | Train Loss: 0.176 Vali Loss: 0.424 Vali Acc: 0.833 Test Loss: 0.424 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.433009147644043
Epoch: 20, Steps: 9 | Train Loss: 0.141 Vali Loss: 0.360 Vali Acc: 0.870 Test Loss: 0.360 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869562).  Saving model ...
Epoch: 21 cost time: 2.367737054824829
Epoch: 21, Steps: 9 | Train Loss: 0.118 Vali Loss: 0.325 Vali Acc: 0.884 Test Loss: 0.325 Test Acc: 0.884
Validation loss decreased (-0.869562 --> -0.884055).  Saving model ...
Epoch: 22 cost time: 2.561434030532837
Epoch: 22, Steps: 9 | Train Loss: 0.123 Vali Loss: 0.380 Vali Acc: 0.884 Test Loss: 0.380 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.5105597972869873
Epoch: 23, Steps: 9 | Train Loss: 0.094 Vali Loss: 0.311 Vali Acc: 0.877 Test Loss: 0.311 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.5287864208221436
Epoch: 24, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.303 Vali Acc: 0.906 Test Loss: 0.303 Test Acc: 0.906
Validation loss decreased (-0.884055 --> -0.905794).  Saving model ...
Epoch: 25 cost time: 2.582150459289551
Epoch: 25, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.345 Vali Acc: 0.877 Test Loss: 0.345 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.4243812561035156
Epoch: 26, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.324 Vali Acc: 0.884 Test Loss: 0.324 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.512986660003662
Epoch: 27, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.359 Vali Acc: 0.877 Test Loss: 0.359 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.589566946029663
Epoch: 28, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.312 Vali Acc: 0.870 Test Loss: 0.312 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.5650339126586914
Epoch: 29, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.289 Vali Acc: 0.899 Test Loss: 0.289 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.3817598819732666
Epoch: 30, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.308 Vali Acc: 0.884 Test Loss: 0.308 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 226796
model size : 1.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.8685550689697266
Epoch: 1, Steps: 9 | Train Loss: 1.450 Vali Loss: 1.413 Vali Acc: 0.246 Test Loss: 1.413 Test Acc: 0.246
Validation loss decreased (inf --> -0.246363).  Saving model ...
Epoch: 2 cost time: 1.8550817966461182
Epoch: 2, Steps: 9 | Train Loss: 1.384 Vali Loss: 1.331 Vali Acc: 0.391 Test Loss: 1.331 Test Acc: 0.391
Validation loss decreased (-0.246363 --> -0.391291).  Saving model ...
Epoch: 3 cost time: 2.067309617996216
Epoch: 3, Steps: 9 | Train Loss: 1.279 Vali Loss: 1.239 Vali Acc: 0.500 Test Loss: 1.239 Test Acc: 0.500
Validation loss decreased (-0.391291 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 2.023857593536377
Epoch: 4, Steps: 9 | Train Loss: 1.178 Vali Loss: 1.146 Vali Acc: 0.551 Test Loss: 1.146 Test Acc: 0.551
Validation loss decreased (-0.499988 --> -0.550713).  Saving model ...
Epoch: 5 cost time: 2.0796139240264893
Epoch: 5, Steps: 9 | Train Loss: 1.090 Vali Loss: 1.062 Vali Acc: 0.609 Test Loss: 1.062 Test Acc: 0.609
Validation loss decreased (-0.550713 --> -0.608685).  Saving model ...
Epoch: 6 cost time: 2.093618869781494
Epoch: 6, Steps: 9 | Train Loss: 0.995 Vali Loss: 0.990 Vali Acc: 0.601 Test Loss: 0.990 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.013439893722534
Epoch: 7, Steps: 9 | Train Loss: 0.925 Vali Loss: 0.937 Vali Acc: 0.638 Test Loss: 0.937 Test Acc: 0.638
Validation loss decreased (-0.608685 --> -0.637672).  Saving model ...
Epoch: 8 cost time: 2.11712384223938
Epoch: 8, Steps: 9 | Train Loss: 0.817 Vali Loss: 0.870 Vali Acc: 0.659 Test Loss: 0.870 Test Acc: 0.659
Validation loss decreased (-0.637672 --> -0.659412).  Saving model ...
Epoch: 9 cost time: 2.034902811050415
Epoch: 9, Steps: 9 | Train Loss: 0.738 Vali Loss: 0.798 Vali Acc: 0.667 Test Loss: 0.798 Test Acc: 0.667
Validation loss decreased (-0.659412 --> -0.666659).  Saving model ...
Epoch: 10 cost time: 2.1220083236694336
Epoch: 10, Steps: 9 | Train Loss: 0.650 Vali Loss: 0.721 Vali Acc: 0.703 Test Loss: 0.721 Test Acc: 0.703
Validation loss decreased (-0.666659 --> -0.702891).  Saving model ...
Epoch: 11 cost time: 2.114389657974243
Epoch: 11, Steps: 9 | Train Loss: 0.563 Vali Loss: 0.657 Vali Acc: 0.732 Test Loss: 0.657 Test Acc: 0.732
Validation loss decreased (-0.702891 --> -0.731877).  Saving model ...
Epoch: 12 cost time: 2.0621490478515625
Epoch: 12, Steps: 9 | Train Loss: 0.536 Vali Loss: 0.601 Vali Acc: 0.754 Test Loss: 0.601 Test Acc: 0.754
Validation loss decreased (-0.731877 --> -0.753617).  Saving model ...
Epoch: 13 cost time: 2.0133957862854004
Epoch: 13, Steps: 9 | Train Loss: 0.443 Vali Loss: 0.567 Vali Acc: 0.783 Test Loss: 0.567 Test Acc: 0.783
Validation loss decreased (-0.753617 --> -0.782603).  Saving model ...
Epoch: 14 cost time: 2.118260145187378
Epoch: 14, Steps: 9 | Train Loss: 0.431 Vali Loss: 0.522 Vali Acc: 0.804 Test Loss: 0.522 Test Acc: 0.804
Validation loss decreased (-0.782603 --> -0.804343).  Saving model ...
Epoch: 15 cost time: 2.018159866333008
Epoch: 15, Steps: 9 | Train Loss: 0.399 Vali Loss: 0.502 Vali Acc: 0.819 Test Loss: 0.502 Test Acc: 0.819
Validation loss decreased (-0.804343 --> -0.818836).  Saving model ...
Epoch: 16 cost time: 2.0769639015197754
Epoch: 16, Steps: 9 | Train Loss: 0.320 Vali Loss: 0.458 Vali Acc: 0.826 Test Loss: 0.458 Test Acc: 0.826
Validation loss decreased (-0.818836 --> -0.826082).  Saving model ...
Epoch: 17 cost time: 1.9934141635894775
Epoch: 17, Steps: 9 | Train Loss: 0.300 Vali Loss: 0.442 Vali Acc: 0.841 Test Loss: 0.442 Test Acc: 0.841
Validation loss decreased (-0.826082 --> -0.840575).  Saving model ...
Epoch: 18 cost time: 2.1713051795959473
Epoch: 18, Steps: 9 | Train Loss: 0.328 Vali Loss: 0.438 Vali Acc: 0.841 Test Loss: 0.438 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 19 cost time: 1.9379639625549316
Epoch: 19, Steps: 9 | Train Loss: 0.266 Vali Loss: 0.424 Vali Acc: 0.826 Test Loss: 0.424 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.0584912300109863
Epoch: 20, Steps: 9 | Train Loss: 0.252 Vali Loss: 0.428 Vali Acc: 0.877 Test Loss: 0.428 Test Acc: 0.877
Validation loss decreased (-0.840575 --> -0.876807).  Saving model ...
Epoch: 21 cost time: 2.0009827613830566
Epoch: 21, Steps: 9 | Train Loss: 0.181 Vali Loss: 0.442 Vali Acc: 0.862 Test Loss: 0.442 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.092644214630127
Epoch: 22, Steps: 9 | Train Loss: 0.166 Vali Loss: 0.406 Vali Acc: 0.870 Test Loss: 0.406 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.9870269298553467
Epoch: 23, Steps: 9 | Train Loss: 0.157 Vali Loss: 0.388 Vali Acc: 0.884 Test Loss: 0.388 Test Acc: 0.884
Validation loss decreased (-0.876807 --> -0.884054).  Saving model ...
Epoch: 24 cost time: 1.9838006496429443
Epoch: 24, Steps: 9 | Train Loss: 0.139 Vali Loss: 0.395 Vali Acc: 0.884 Test Loss: 0.395 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.0307092666625977
Epoch: 25, Steps: 9 | Train Loss: 0.145 Vali Loss: 0.403 Vali Acc: 0.870 Test Loss: 0.403 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.873708724975586
Epoch: 26, Steps: 9 | Train Loss: 0.153 Vali Loss: 0.360 Vali Acc: 0.884 Test Loss: 0.360 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 27 cost time: 1.900766134262085
Epoch: 27, Steps: 9 | Train Loss: 0.115 Vali Loss: 0.355 Vali Acc: 0.884 Test Loss: 0.355 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 28 cost time: 1.9659092426300049
Epoch: 28, Steps: 9 | Train Loss: 0.098 Vali Loss: 0.380 Vali Acc: 0.899 Test Loss: 0.380 Test Acc: 0.899
Validation loss decreased (-0.884054 --> -0.898547).  Saving model ...
Epoch: 29 cost time: 1.953866720199585
Epoch: 29, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.404 Vali Acc: 0.891 Test Loss: 0.404 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.9269053936004639
Epoch: 30, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.394 Vali Acc: 0.891 Test Loss: 0.394 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 71516
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.103640794754028
Epoch: 1, Steps: 9 | Train Loss: 1.491 Vali Loss: 1.411 Vali Acc: 0.217 Test Loss: 1.411 Test Acc: 0.217
Validation loss decreased (inf --> -0.217377).  Saving model ...
Epoch: 2 cost time: 2.0048177242279053
Epoch: 2, Steps: 9 | Train Loss: 1.395 Vali Loss: 1.357 Vali Acc: 0.304 Test Loss: 1.357 Test Acc: 0.304
Validation loss decreased (-0.217377 --> -0.304334).  Saving model ...
Epoch: 3 cost time: 2.080679178237915
Epoch: 3, Steps: 9 | Train Loss: 1.337 Vali Loss: 1.288 Vali Acc: 0.420 Test Loss: 1.288 Test Acc: 0.420
Validation loss decreased (-0.304334 --> -0.420277).  Saving model ...
Epoch: 4 cost time: 1.9499399662017822
Epoch: 4, Steps: 9 | Train Loss: 1.249 Vali Loss: 1.215 Vali Acc: 0.507 Test Loss: 1.215 Test Acc: 0.507
Validation loss decreased (-0.420277 --> -0.507234).  Saving model ...
Epoch: 5 cost time: 2.2547543048858643
Epoch: 5, Steps: 9 | Train Loss: 1.152 Vali Loss: 1.139 Vali Acc: 0.514 Test Loss: 1.139 Test Acc: 0.514
Validation loss decreased (-0.507234 --> -0.514481).  Saving model ...
Epoch: 6 cost time: 2.112199306488037
Epoch: 6, Steps: 9 | Train Loss: 1.085 Vali Loss: 1.054 Vali Acc: 0.551 Test Loss: 1.054 Test Acc: 0.551
Validation loss decreased (-0.514481 --> -0.550714).  Saving model ...
Epoch: 7 cost time: 1.9611866474151611
Epoch: 7, Steps: 9 | Train Loss: 1.004 Vali Loss: 0.980 Vali Acc: 0.565 Test Loss: 0.980 Test Acc: 0.565
Validation loss decreased (-0.550714 --> -0.565208).  Saving model ...
Epoch: 8 cost time: 2.413792371749878
Epoch: 8, Steps: 9 | Train Loss: 0.889 Vali Loss: 0.910 Vali Acc: 0.587 Test Loss: 0.910 Test Acc: 0.587
Validation loss decreased (-0.565208 --> -0.586947).  Saving model ...
Epoch: 9 cost time: 2.452004909515381
Epoch: 9, Steps: 9 | Train Loss: 0.805 Vali Loss: 0.835 Vali Acc: 0.601 Test Loss: 0.835 Test Acc: 0.601
Validation loss decreased (-0.586947 --> -0.601441).  Saving model ...
Epoch: 10 cost time: 2.5428595542907715
Epoch: 10, Steps: 9 | Train Loss: 0.729 Vali Loss: 0.764 Vali Acc: 0.674 Test Loss: 0.764 Test Acc: 0.674
Validation loss decreased (-0.601441 --> -0.673905).  Saving model ...
Epoch: 11 cost time: 1.9579262733459473
Epoch: 11, Steps: 9 | Train Loss: 0.642 Vali Loss: 0.704 Vali Acc: 0.732 Test Loss: 0.704 Test Acc: 0.732
Validation loss decreased (-0.673905 --> -0.731877).  Saving model ...
Epoch: 12 cost time: 1.9819133281707764
Epoch: 12, Steps: 9 | Train Loss: 0.570 Vali Loss: 0.659 Vali Acc: 0.768 Test Loss: 0.659 Test Acc: 0.768
Validation loss decreased (-0.731877 --> -0.768109).  Saving model ...
Epoch: 13 cost time: 2.2097840309143066
Epoch: 13, Steps: 9 | Train Loss: 0.530 Vali Loss: 0.599 Vali Acc: 0.826 Test Loss: 0.599 Test Acc: 0.826
Validation loss decreased (-0.768109 --> -0.826081).  Saving model ...
Epoch: 14 cost time: 2.15211820602417
Epoch: 14, Steps: 9 | Train Loss: 0.450 Vali Loss: 0.559 Vali Acc: 0.833 Test Loss: 0.559 Test Acc: 0.833
Validation loss decreased (-0.826081 --> -0.833328).  Saving model ...
Epoch: 15 cost time: 2.113593339920044
Epoch: 15, Steps: 9 | Train Loss: 0.397 Vali Loss: 0.523 Vali Acc: 0.826 Test Loss: 0.523 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.1919853687286377
Epoch: 16, Steps: 9 | Train Loss: 0.403 Vali Loss: 0.491 Vali Acc: 0.833 Test Loss: 0.491 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 17 cost time: 1.9904026985168457
Epoch: 17, Steps: 9 | Train Loss: 0.349 Vali Loss: 0.451 Vali Acc: 0.855 Test Loss: 0.451 Test Acc: 0.855
Validation loss decreased (-0.833328 --> -0.855068).  Saving model ...
Epoch: 18 cost time: 2.128654718399048
Epoch: 18, Steps: 9 | Train Loss: 0.301 Vali Loss: 0.461 Vali Acc: 0.841 Test Loss: 0.461 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.0958733558654785
Epoch: 19, Steps: 9 | Train Loss: 0.252 Vali Loss: 0.455 Vali Acc: 0.841 Test Loss: 0.455 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.010707139968872
Epoch: 20, Steps: 9 | Train Loss: 0.231 Vali Loss: 0.436 Vali Acc: 0.841 Test Loss: 0.436 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.939415693283081
Epoch: 21, Steps: 9 | Train Loss: 0.188 Vali Loss: 0.408 Vali Acc: 0.848 Test Loss: 0.408 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.2280187606811523
Epoch: 22, Steps: 9 | Train Loss: 0.179 Vali Loss: 0.401 Vali Acc: 0.870 Test Loss: 0.401 Test Acc: 0.870
Validation loss decreased (-0.855068 --> -0.869561).  Saving model ...
Epoch: 23 cost time: 2.2672922611236572
Epoch: 23, Steps: 9 | Train Loss: 0.208 Vali Loss: 0.414 Vali Acc: 0.848 Test Loss: 0.414 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.3431689739227295
Epoch: 24, Steps: 9 | Train Loss: 0.193 Vali Loss: 0.394 Vali Acc: 0.841 Test Loss: 0.394 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.2575387954711914
Epoch: 25, Steps: 9 | Train Loss: 0.124 Vali Loss: 0.365 Vali Acc: 0.870 Test Loss: 0.365 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869562).  Saving model ...
Epoch: 26 cost time: 2.0575478076934814
Epoch: 26, Steps: 9 | Train Loss: 0.103 Vali Loss: 0.350 Vali Acc: 0.870 Test Loss: 0.350 Test Acc: 0.870
Validation loss decreased (-0.869562 --> -0.869562).  Saving model ...
Epoch: 27 cost time: 2.3486807346343994
Epoch: 27, Steps: 9 | Train Loss: 0.095 Vali Loss: 0.381 Vali Acc: 0.870 Test Loss: 0.381 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.1979153156280518
Epoch: 28, Steps: 9 | Train Loss: 0.086 Vali Loss: 0.337 Vali Acc: 0.870 Test Loss: 0.337 Test Acc: 0.870
Validation loss decreased (-0.869562 --> -0.869562).  Saving model ...
Epoch: 29 cost time: 2.5565783977508545
Epoch: 29, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.310 Vali Acc: 0.884 Test Loss: 0.310 Test Acc: 0.884
Validation loss decreased (-0.869562 --> -0.884055).  Saving model ...
Epoch: 30 cost time: 2.1357839107513428
Epoch: 30, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.285 Vali Acc: 0.891 Test Loss: 0.285 Test Acc: 0.891
Validation loss decreased (-0.884055 --> -0.891301).  Saving model ...
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 226796
model size : 1.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.5376460552215576
Epoch: 1, Steps: 9 | Train Loss: 1.448 Vali Loss: 1.410 Vali Acc: 0.268 Test Loss: 1.410 Test Acc: 0.268
Validation loss decreased (inf --> -0.268102).  Saving model ...
Epoch: 2 cost time: 1.9474129676818848
Epoch: 2, Steps: 9 | Train Loss: 1.386 Vali Loss: 1.335 Vali Acc: 0.341 Test Loss: 1.335 Test Acc: 0.341
Validation loss decreased (-0.268102 --> -0.340566).  Saving model ...
Epoch: 3 cost time: 1.9760308265686035
Epoch: 3, Steps: 9 | Train Loss: 1.276 Vali Loss: 1.248 Vali Acc: 0.486 Test Loss: 1.248 Test Acc: 0.486
Validation loss decreased (-0.340566 --> -0.485495).  Saving model ...
Epoch: 4 cost time: 1.8538661003112793
Epoch: 4, Steps: 9 | Train Loss: 1.195 Vali Loss: 1.161 Vali Acc: 0.565 Test Loss: 1.161 Test Acc: 0.565
Validation loss decreased (-0.485495 --> -0.565206).  Saving model ...
Epoch: 5 cost time: 1.8343462944030762
Epoch: 5, Steps: 9 | Train Loss: 1.114 Vali Loss: 1.093 Vali Acc: 0.594 Test Loss: 1.093 Test Acc: 0.594
Validation loss decreased (-0.565206 --> -0.594192).  Saving model ...
Epoch: 6 cost time: 1.9910624027252197
Epoch: 6, Steps: 9 | Train Loss: 1.017 Vali Loss: 1.037 Vali Acc: 0.594 Test Loss: 1.037 Test Acc: 0.594
Validation loss decreased (-0.594192 --> -0.594193).  Saving model ...
Epoch: 7 cost time: 1.863663673400879
Epoch: 7, Steps: 9 | Train Loss: 0.970 Vali Loss: 0.993 Vali Acc: 0.594 Test Loss: 0.993 Test Acc: 0.594
Validation loss decreased (-0.594193 --> -0.594193).  Saving model ...
Epoch: 8 cost time: 1.8696918487548828
Epoch: 8, Steps: 9 | Train Loss: 0.875 Vali Loss: 0.951 Vali Acc: 0.594 Test Loss: 0.951 Test Acc: 0.594
Validation loss decreased (-0.594193 --> -0.594193).  Saving model ...
Epoch: 9 cost time: 1.9249992370605469
Epoch: 9, Steps: 9 | Train Loss: 0.816 Vali Loss: 0.893 Vali Acc: 0.652 Test Loss: 0.893 Test Acc: 0.652
Validation loss decreased (-0.594193 --> -0.652165).  Saving model ...
Epoch: 10 cost time: 1.9706854820251465
Epoch: 10, Steps: 9 | Train Loss: 0.733 Vali Loss: 0.831 Vali Acc: 0.688 Test Loss: 0.831 Test Acc: 0.688
Validation loss decreased (-0.652165 --> -0.688397).  Saving model ...
Epoch: 11 cost time: 1.866199016571045
Epoch: 11, Steps: 9 | Train Loss: 0.662 Vali Loss: 0.780 Vali Acc: 0.703 Test Loss: 0.780 Test Acc: 0.703
Validation loss decreased (-0.688397 --> -0.702891).  Saving model ...
Epoch: 12 cost time: 2.1026294231414795
Epoch: 12, Steps: 9 | Train Loss: 0.612 Vali Loss: 0.728 Vali Acc: 0.725 Test Loss: 0.728 Test Acc: 0.725
Validation loss decreased (-0.702891 --> -0.724630).  Saving model ...
Epoch: 13 cost time: 1.9648268222808838
Epoch: 13, Steps: 9 | Train Loss: 0.525 Vali Loss: 0.672 Vali Acc: 0.739 Test Loss: 0.672 Test Acc: 0.739
Validation loss decreased (-0.724630 --> -0.739124).  Saving model ...
Epoch: 14 cost time: 1.9839234352111816
Epoch: 14, Steps: 9 | Train Loss: 0.486 Vali Loss: 0.648 Vali Acc: 0.768 Test Loss: 0.648 Test Acc: 0.768
Validation loss decreased (-0.739124 --> -0.768109).  Saving model ...
Epoch: 15 cost time: 1.9095962047576904
Epoch: 15, Steps: 9 | Train Loss: 0.456 Vali Loss: 0.667 Vali Acc: 0.739 Test Loss: 0.667 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.037414312362671
Epoch: 16, Steps: 9 | Train Loss: 0.390 Vali Loss: 0.605 Vali Acc: 0.783 Test Loss: 0.605 Test Acc: 0.783
Validation loss decreased (-0.768109 --> -0.782603).  Saving model ...
Epoch: 17 cost time: 1.882570505142212
Epoch: 17, Steps: 9 | Train Loss: 0.373 Vali Loss: 0.573 Vali Acc: 0.812 Test Loss: 0.573 Test Acc: 0.812
Validation loss decreased (-0.782603 --> -0.811588).  Saving model ...
Epoch: 18 cost time: 2.0768256187438965
Epoch: 18, Steps: 9 | Train Loss: 0.368 Vali Loss: 0.554 Vali Acc: 0.804 Test Loss: 0.554 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.001248598098755
Epoch: 19, Steps: 9 | Train Loss: 0.331 Vali Loss: 0.535 Vali Acc: 0.826 Test Loss: 0.535 Test Acc: 0.826
Validation loss decreased (-0.811588 --> -0.826082).  Saving model ...
Epoch: 20 cost time: 1.9893455505371094
Epoch: 20, Steps: 9 | Train Loss: 0.282 Vali Loss: 0.520 Vali Acc: 0.812 Test Loss: 0.520 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8227918148040771
Epoch: 21, Steps: 9 | Train Loss: 0.229 Vali Loss: 0.513 Vali Acc: 0.819 Test Loss: 0.513 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.8162200450897217
Epoch: 22, Steps: 9 | Train Loss: 0.220 Vali Loss: 0.499 Vali Acc: 0.812 Test Loss: 0.499 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.8321735858917236
Epoch: 23, Steps: 9 | Train Loss: 0.212 Vali Loss: 0.483 Vali Acc: 0.812 Test Loss: 0.483 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.8171660900115967
Epoch: 24, Steps: 9 | Train Loss: 0.214 Vali Loss: 0.480 Vali Acc: 0.819 Test Loss: 0.480 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.639838695526123
Epoch: 25, Steps: 9 | Train Loss: 0.191 Vali Loss: 0.487 Vali Acc: 0.819 Test Loss: 0.487 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.7636692523956299
Epoch: 26, Steps: 9 | Train Loss: 0.190 Vali Loss: 0.475 Vali Acc: 0.819 Test Loss: 0.475 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.619814157485962
Epoch: 27, Steps: 9 | Train Loss: 0.130 Vali Loss: 0.478 Vali Acc: 0.819 Test Loss: 0.478 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.6548271179199219
Epoch: 28, Steps: 9 | Train Loss: 0.170 Vali Loss: 0.470 Vali Acc: 0.819 Test Loss: 0.470 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.6325671672821045
Epoch: 29, Steps: 9 | Train Loss: 0.132 Vali Loss: 0.457 Vali Acc: 0.826 Test Loss: 0.457 Test Acc: 0.826
Validation loss decreased (-0.826082 --> -0.826082).  Saving model ...
Epoch: 30 cost time: 1.6734185218811035
Epoch: 30, Steps: 9 | Train Loss: 0.134 Vali Loss: 0.470 Vali Acc: 0.804 Test Loss: 0.470 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el3_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8260869565217391
model parameter : 71516
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 21.47308659553528
Epoch: 1, Steps: 9 | Train Loss: 1.420 Vali Loss: 1.089 Vali Acc: 0.580 Test Loss: 1.089 Test Acc: 0.580
Validation loss decreased (inf --> -0.579699).  Saving model ...
Epoch: 2 cost time: 19.316504955291748
Epoch: 2, Steps: 9 | Train Loss: 0.837 Vali Loss: 0.573 Vali Acc: 0.812 Test Loss: 0.573 Test Acc: 0.812
Validation loss decreased (-0.579699 --> -0.811588).  Saving model ...
Epoch: 3 cost time: 19.499982357025146
Epoch: 3, Steps: 9 | Train Loss: 0.387 Vali Loss: 0.492 Vali Acc: 0.833 Test Loss: 0.492 Test Acc: 0.833
Validation loss decreased (-0.811588 --> -0.833328).  Saving model ...
Epoch: 4 cost time: 19.38486671447754
Epoch: 4, Steps: 9 | Train Loss: 0.183 Vali Loss: 0.545 Vali Acc: 0.833 Test Loss: 0.545 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 18.848275423049927
Epoch: 5, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.450 Vali Acc: 0.855 Test Loss: 0.450 Test Acc: 0.855
Validation loss decreased (-0.833328 --> -0.855068).  Saving model ...
Epoch: 6 cost time: 17.999157190322876
Epoch: 6, Steps: 9 | Train Loss: 0.050 Vali Loss: 1.069 Vali Acc: 0.819 Test Loss: 1.069 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 16.947134256362915
Epoch: 7, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.533 Vali Acc: 0.870 Test Loss: 0.533 Test Acc: 0.870
Validation loss decreased (-0.855068 --> -0.869560).  Saving model ...
Epoch: 8 cost time: 18.247873544692993
Epoch: 8, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.399 Vali Acc: 0.884 Test Loss: 0.399 Test Acc: 0.884
Validation loss decreased (-0.869560 --> -0.884054).  Saving model ...
Epoch: 9 cost time: 18.727480173110962
Epoch: 9, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.545 Vali Acc: 0.862 Test Loss: 0.545 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 19.305122137069702
Epoch: 10, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.937 Vali Acc: 0.783 Test Loss: 0.937 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 19.452510833740234
Epoch: 11, Steps: 9 | Train Loss: 0.127 Vali Loss: 0.543 Vali Acc: 0.848 Test Loss: 0.543 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 19.37929606437683
Epoch: 12, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.653 Vali Acc: 0.870 Test Loss: 0.653 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 19.092071294784546
Epoch: 13, Steps: 9 | Train Loss: 0.507 Vali Loss: 0.440 Vali Acc: 0.913 Test Loss: 0.440 Test Acc: 0.913
Validation loss decreased (-0.884054 --> -0.913039).  Saving model ...
Epoch: 14 cost time: 18.435409545898438
Epoch: 14, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.712 Vali Acc: 0.833 Test Loss: 0.712 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 19.096006393432617
Epoch: 15, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.461 Vali Acc: 0.920 Test Loss: 0.461 Test Acc: 0.920
Validation loss decreased (-0.913039 --> -0.920285).  Saving model ...
Epoch: 16 cost time: 18.856834650039673
Epoch: 16, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.610 Vali Acc: 0.870 Test Loss: 0.610 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 18.716125965118408
Epoch: 17, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.478 Vali Acc: 0.928 Test Loss: 0.478 Test Acc: 0.928
Validation loss decreased (-0.920285 --> -0.927531).  Saving model ...
Epoch: 18 cost time: 18.357404708862305
Epoch: 18, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.508 Vali Acc: 0.920 Test Loss: 0.508 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 18.551328897476196
Epoch: 19, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.528 Vali Acc: 0.891 Test Loss: 0.528 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 13.289084672927856
Epoch: 20, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.874 Vali Acc: 0.870 Test Loss: 0.874 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 16.059139013290405
Epoch: 21, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.702 Vali Acc: 0.862 Test Loss: 0.702 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 19.016956329345703
Epoch: 22, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.480 Vali Acc: 0.906 Test Loss: 0.480 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 19.130910873413086
Epoch: 23, Steps: 9 | Train Loss: 0.688 Vali Loss: 1.050 Vali Acc: 0.768 Test Loss: 1.050 Test Acc: 0.768
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 19.233538150787354
Epoch: 24, Steps: 9 | Train Loss: 0.116 Vali Loss: 1.799 Vali Acc: 0.833 Test Loss: 1.799 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 17.976293563842773
Epoch: 25, Steps: 9 | Train Loss: 0.184 Vali Loss: 1.055 Vali Acc: 0.819 Test Loss: 1.055 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 17.994930267333984
Epoch: 26, Steps: 9 | Train Loss: 0.107 Vali Loss: 0.886 Vali Acc: 0.906 Test Loss: 0.886 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 17.199371337890625
Epoch: 27, Steps: 9 | Train Loss: 0.138 Vali Loss: 1.710 Vali Acc: 0.826 Test Loss: 1.710 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.927536231884058
model parameter : 37598596
model size : 145.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 8.16927194595337
Epoch: 1, Steps: 9 | Train Loss: 1.314 Vali Loss: 1.099 Vali Acc: 0.616 Test Loss: 1.099 Test Acc: 0.616
Validation loss decreased (inf --> -0.615931).  Saving model ...
Epoch: 2 cost time: 6.695511817932129
Epoch: 2, Steps: 9 | Train Loss: 0.817 Vali Loss: 0.595 Vali Acc: 0.768 Test Loss: 0.595 Test Acc: 0.768
Validation loss decreased (-0.615931 --> -0.768110).  Saving model ...
Epoch: 3 cost time: 6.757906675338745
Epoch: 3, Steps: 9 | Train Loss: 0.345 Vali Loss: 0.448 Vali Acc: 0.819 Test Loss: 0.448 Test Acc: 0.819
Validation loss decreased (-0.768110 --> -0.818836).  Saving model ...
Epoch: 4 cost time: 6.978993892669678
Epoch: 4, Steps: 9 | Train Loss: 0.214 Vali Loss: 0.442 Vali Acc: 0.862 Test Loss: 0.442 Test Acc: 0.862
Validation loss decreased (-0.818836 --> -0.862314).  Saving model ...
Epoch: 5 cost time: 6.899737358093262
Epoch: 5, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.513 Vali Acc: 0.841 Test Loss: 0.513 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.93640398979187
Epoch: 6, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.456 Vali Acc: 0.855 Test Loss: 0.456 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.924475908279419
Epoch: 7, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.571 Vali Acc: 0.826 Test Loss: 0.571 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.956562757492065
Epoch: 8, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.708 Vali Acc: 0.797 Test Loss: 0.708 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 7.014276027679443
Epoch: 9, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.646 Vali Acc: 0.833 Test Loss: 0.646 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 6.991865634918213
Epoch: 10, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.492 Vali Acc: 0.870 Test Loss: 0.492 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869560).  Saving model ...
Epoch: 11 cost time: 6.82735538482666
Epoch: 11, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.505 Vali Acc: 0.862 Test Loss: 0.505 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.310261964797974
Epoch: 12, Steps: 9 | Train Loss: 0.279 Vali Loss: 0.395 Vali Acc: 0.899 Test Loss: 0.395 Test Acc: 0.899
Validation loss decreased (-0.869560 --> -0.898547).  Saving model ...
Epoch: 13 cost time: 7.300167083740234
Epoch: 13, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.417 Vali Acc: 0.891 Test Loss: 0.417 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 7.348253965377808
Epoch: 14, Steps: 9 | Train Loss: 0.112 Vali Loss: 0.418 Vali Acc: 0.891 Test Loss: 0.418 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 7.3041136264801025
Epoch: 15, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.519 Vali Acc: 0.870 Test Loss: 0.519 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 7.051263093948364
Epoch: 16, Steps: 9 | Train Loss: 0.183 Vali Loss: 0.459 Vali Acc: 0.891 Test Loss: 0.459 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 7.256308078765869
Epoch: 17, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.466 Vali Acc: 0.891 Test Loss: 0.466 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 7.201514482498169
Epoch: 18, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.346 Vali Acc: 0.920 Test Loss: 0.346 Test Acc: 0.920
Validation loss decreased (-0.898547 --> -0.920286).  Saving model ...
Epoch: 19 cost time: 7.185325860977173
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.400 Vali Acc: 0.877 Test Loss: 0.400 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 7.149568796157837
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.471 Vali Acc: 0.870 Test Loss: 0.471 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 7.3237693309783936
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.462 Vali Acc: 0.870 Test Loss: 0.462 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 7.290701150894165
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.498 Vali Acc: 0.877 Test Loss: 0.498 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 7.11988091468811
Epoch: 23, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.621 Vali Acc: 0.841 Test Loss: 0.621 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 7.312476634979248
Epoch: 24, Steps: 9 | Train Loss: 0.237 Vali Loss: 0.988 Vali Acc: 0.775 Test Loss: 0.988 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 7.246662139892578
Epoch: 25, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.602 Vali Acc: 0.848 Test Loss: 0.602 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 7.294822692871094
Epoch: 26, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.613 Vali Acc: 0.855 Test Loss: 0.613 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 7.410726070404053
Epoch: 27, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.682 Vali Acc: 0.848 Test Loss: 0.682 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 7.4215264320373535
Epoch: 28, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.667 Vali Acc: 0.848 Test Loss: 0.667 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 11120516
model size : 44.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 16.393917322158813
Epoch: 1, Steps: 9 | Train Loss: 1.419 Vali Loss: 1.107 Vali Acc: 0.580 Test Loss: 1.107 Test Acc: 0.580
Validation loss decreased (inf --> -0.579699).  Saving model ...
Epoch: 2 cost time: 14.261185646057129
Epoch: 2, Steps: 9 | Train Loss: 0.918 Vali Loss: 0.631 Vali Acc: 0.783 Test Loss: 0.631 Test Acc: 0.783
Validation loss decreased (-0.579699 --> -0.782602).  Saving model ...
Epoch: 3 cost time: 13.980577230453491
Epoch: 3, Steps: 9 | Train Loss: 0.496 Vali Loss: 0.474 Vali Acc: 0.812 Test Loss: 0.474 Test Acc: 0.812
Validation loss decreased (-0.782602 --> -0.811589).  Saving model ...
Epoch: 4 cost time: 13.278774738311768
Epoch: 4, Steps: 9 | Train Loss: 0.409 Vali Loss: 0.292 Vali Acc: 0.891 Test Loss: 0.292 Test Acc: 0.891
Validation loss decreased (-0.811589 --> -0.891301).  Saving model ...
Epoch: 5 cost time: 12.987708806991577
Epoch: 5, Steps: 9 | Train Loss: 0.122 Vali Loss: 0.346 Vali Acc: 0.891 Test Loss: 0.346 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 12.946756839752197
Epoch: 6, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.402 Vali Acc: 0.899 Test Loss: 0.402 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898547).  Saving model ...
Epoch: 7 cost time: 12.788502216339111
Epoch: 7, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.357 Vali Acc: 0.891 Test Loss: 0.357 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 12.601974725723267
Epoch: 8, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.405 Vali Acc: 0.877 Test Loss: 0.405 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 12.869134187698364
Epoch: 9, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.393 Vali Acc: 0.899 Test Loss: 0.393 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 10 cost time: 13.162022113800049
Epoch: 10, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.503 Vali Acc: 0.913 Test Loss: 0.503 Test Acc: 0.913
Validation loss decreased (-0.898547 --> -0.913038).  Saving model ...
Epoch: 11 cost time: 14.191840887069702
Epoch: 11, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.590 Vali Acc: 0.848 Test Loss: 0.590 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 13.99079179763794
Epoch: 12, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.707 Vali Acc: 0.833 Test Loss: 0.707 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 13.07475471496582
Epoch: 13, Steps: 9 | Train Loss: 0.310 Vali Loss: 0.983 Vali Acc: 0.826 Test Loss: 0.983 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 14.545748949050903
Epoch: 14, Steps: 9 | Train Loss: 0.157 Vali Loss: 0.706 Vali Acc: 0.833 Test Loss: 0.706 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 14.463468551635742
Epoch: 15, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.931 Vali Acc: 0.790 Test Loss: 0.931 Test Acc: 0.790
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 14.611192226409912
Epoch: 16, Steps: 9 | Train Loss: 0.005 Vali Loss: 2.000 Vali Acc: 0.674 Test Loss: 2.000 Test Acc: 0.674
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 14.04721474647522
Epoch: 17, Steps: 9 | Train Loss: 0.003 Vali Loss: 2.268 Vali Acc: 0.638 Test Loss: 2.268 Test Acc: 0.638
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 14.03379487991333
Epoch: 18, Steps: 9 | Train Loss: 0.236 Vali Loss: 0.605 Vali Acc: 0.812 Test Loss: 0.605 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 14.0848970413208
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.637 Vali Acc: 0.812 Test Loss: 0.637 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 14.026524782180786
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.569 Vali Acc: 0.841 Test Loss: 0.569 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 37598596
model size : 145.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 7.241403818130493
Epoch: 1, Steps: 9 | Train Loss: 1.321 Vali Loss: 1.115 Vali Acc: 0.594 Test Loss: 1.115 Test Acc: 0.594
Validation loss decreased (inf --> -0.594192).  Saving model ...
Epoch: 2 cost time: 5.43452262878418
Epoch: 2, Steps: 9 | Train Loss: 0.875 Vali Loss: 0.653 Vali Acc: 0.746 Test Loss: 0.653 Test Acc: 0.746
Validation loss decreased (-0.594192 --> -0.746370).  Saving model ...
Epoch: 3 cost time: 5.158013105392456
Epoch: 3, Steps: 9 | Train Loss: 0.403 Vali Loss: 0.429 Vali Acc: 0.848 Test Loss: 0.429 Test Acc: 0.848
Validation loss decreased (-0.746370 --> -0.847822).  Saving model ...
Epoch: 4 cost time: 5.626935720443726
Epoch: 4, Steps: 9 | Train Loss: 0.240 Vali Loss: 0.420 Vali Acc: 0.826 Test Loss: 0.420 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.593500852584839
Epoch: 5, Steps: 9 | Train Loss: 0.098 Vali Loss: 0.359 Vali Acc: 0.877 Test Loss: 0.359 Test Acc: 0.877
Validation loss decreased (-0.847822 --> -0.876808).  Saving model ...
Epoch: 6 cost time: 5.373735666275024
Epoch: 6, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.481 Vali Acc: 0.833 Test Loss: 0.481 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.565063953399658
Epoch: 7, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.390 Vali Acc: 0.877 Test Loss: 0.390 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.443321228027344
Epoch: 8, Steps: 9 | Train Loss: 0.132 Vali Loss: 0.458 Vali Acc: 0.891 Test Loss: 0.458 Test Acc: 0.891
Validation loss decreased (-0.876808 --> -0.891300).  Saving model ...
Epoch: 9 cost time: 5.352856159210205
Epoch: 9, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.502 Vali Acc: 0.841 Test Loss: 0.502 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.490711450576782
Epoch: 10, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.573 Vali Acc: 0.826 Test Loss: 0.573 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.45432448387146
Epoch: 11, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.554 Vali Acc: 0.841 Test Loss: 0.554 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.475718975067139
Epoch: 12, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.451 Vali Acc: 0.899 Test Loss: 0.451 Test Acc: 0.899
Validation loss decreased (-0.891300 --> -0.898546).  Saving model ...
Epoch: 13 cost time: 5.447447299957275
Epoch: 13, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.549 Vali Acc: 0.891 Test Loss: 0.549 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.644906759262085
Epoch: 14, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.442 Vali Acc: 0.906 Test Loss: 0.442 Test Acc: 0.906
Validation loss decreased (-0.898546 --> -0.905793).  Saving model ...
Epoch: 15 cost time: 5.5796473026275635
Epoch: 15, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.415 Vali Acc: 0.906 Test Loss: 0.415 Test Acc: 0.906
Validation loss decreased (-0.905793 --> -0.905793).  Saving model ...
Epoch: 16 cost time: 5.387519121170044
Epoch: 16, Steps: 9 | Train Loss: 0.144 Vali Loss: 0.391 Vali Acc: 0.906 Test Loss: 0.391 Test Acc: 0.906
Validation loss decreased (-0.905793 --> -0.905793).  Saving model ...
Epoch: 17 cost time: 5.486835241317749
Epoch: 17, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.455 Vali Acc: 0.906 Test Loss: 0.455 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.486773252487183
Epoch: 18, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.450 Vali Acc: 0.906 Test Loss: 0.450 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.386391878128052
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.416 Vali Acc: 0.906 Test Loss: 0.416 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.430103540420532
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.405 Vali Acc: 0.899 Test Loss: 0.405 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 5.427692174911499
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.392 Vali Acc: 0.906 Test Loss: 0.392 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 5.503136873245239
Epoch: 22, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.744 Vali Acc: 0.833 Test Loss: 0.744 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 5.200770616531372
Epoch: 23, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.504 Vali Acc: 0.870 Test Loss: 0.504 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 5.277207612991333
Epoch: 24, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.378 Vali Acc: 0.906 Test Loss: 0.378 Test Acc: 0.906
Validation loss decreased (-0.905793 --> -0.905793).  Saving model ...
Epoch: 25 cost time: 5.272355794906616
Epoch: 25, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.430 Vali Acc: 0.913 Test Loss: 0.430 Test Acc: 0.913
Validation loss decreased (-0.905793 --> -0.913039).  Saving model ...
Epoch: 26 cost time: 4.887848854064941
Epoch: 26, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.658 Vali Acc: 0.884 Test Loss: 0.658 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.987596273422241
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.784 Vali Acc: 0.870 Test Loss: 0.784 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 5.339360475540161
Epoch: 28, Steps: 9 | Train Loss: 0.450 Vali Loss: 0.612 Vali Acc: 0.877 Test Loss: 0.612 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 5.316969394683838
Epoch: 29, Steps: 9 | Train Loss: 0.033 Vali Loss: 1.118 Vali Acc: 0.819 Test Loss: 1.118 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 5.305598258972168
Epoch: 30, Steps: 9 | Train Loss: 0.736 Vali Loss: 1.890 Vali Acc: 0.804 Test Loss: 1.890 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 11120516
model size : 44.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 10.455555200576782
Epoch: 1, Steps: 9 | Train Loss: 1.423 Vali Loss: 1.191 Vali Acc: 0.457 Test Loss: 1.191 Test Acc: 0.457
Validation loss decreased (inf --> -0.456510).  Saving model ...
Epoch: 2 cost time: 8.501116514205933
Epoch: 2, Steps: 9 | Train Loss: 0.987 Vali Loss: 0.824 Vali Acc: 0.688 Test Loss: 0.824 Test Acc: 0.688
Validation loss decreased (-0.456510 --> -0.688398).  Saving model ...
Epoch: 3 cost time: 9.197274208068848
Epoch: 3, Steps: 9 | Train Loss: 0.564 Vali Loss: 0.577 Vali Acc: 0.768 Test Loss: 0.577 Test Acc: 0.768
Validation loss decreased (-0.688398 --> -0.768110).  Saving model ...
Epoch: 4 cost time: 9.13413143157959
Epoch: 4, Steps: 9 | Train Loss: 0.275 Vali Loss: 0.471 Vali Acc: 0.841 Test Loss: 0.471 Test Acc: 0.841
Validation loss decreased (-0.768110 --> -0.840575).  Saving model ...
Epoch: 5 cost time: 9.108547687530518
Epoch: 5, Steps: 9 | Train Loss: 0.127 Vali Loss: 0.476 Vali Acc: 0.848 Test Loss: 0.476 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847821).  Saving model ...
Epoch: 6 cost time: 9.313967227935791
Epoch: 6, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.555 Vali Acc: 0.790 Test Loss: 0.555 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.072440147399902
Epoch: 7, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.474 Vali Acc: 0.841 Test Loss: 0.474 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 9.122252941131592
Epoch: 8, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.268 Vali Acc: 0.928 Test Loss: 0.268 Test Acc: 0.928
Validation loss decreased (-0.847821 --> -0.927534).  Saving model ...
Epoch: 9 cost time: 9.471619606018066
Epoch: 9, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.600 Vali Acc: 0.841 Test Loss: 0.600 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 9.029877185821533
Epoch: 10, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.526 Vali Acc: 0.877 Test Loss: 0.526 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 8.572455883026123
Epoch: 11, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.414 Vali Acc: 0.913 Test Loss: 0.414 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 8.925105094909668
Epoch: 12, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.889 Vali Acc: 0.870 Test Loss: 0.889 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 8.103343963623047
Epoch: 13, Steps: 9 | Train Loss: 0.259 Vali Loss: 0.870 Vali Acc: 0.855 Test Loss: 0.870 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 8.22903847694397
Epoch: 14, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.642 Vali Acc: 0.790 Test Loss: 1.642 Test Acc: 0.790
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 8.132884502410889
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.656 Vali Acc: 0.768 Test Loss: 1.656 Test Acc: 0.768
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 8.217661142349243
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.655 Vali Acc: 0.812 Test Loss: 1.655 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 8.444915056228638
Epoch: 17, Steps: 9 | Train Loss: 0.254 Vali Loss: 1.162 Vali Acc: 0.819 Test Loss: 1.162 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 8.39536714553833
Epoch: 18, Steps: 9 | Train Loss: 0.234 Vali Loss: 1.272 Vali Acc: 0.804 Test Loss: 1.272 Test Acc: 0.804
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.927536231884058
model parameter : 37598596
model size : 145.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.357099771499634
Epoch: 1, Steps: 9 | Train Loss: 1.338 Vali Loss: 1.172 Vali Acc: 0.507 Test Loss: 1.172 Test Acc: 0.507
Validation loss decreased (inf --> -0.507235).  Saving model ...
Epoch: 2 cost time: 3.64579701423645
Epoch: 2, Steps: 9 | Train Loss: 0.921 Vali Loss: 0.811 Vali Acc: 0.652 Test Loss: 0.811 Test Acc: 0.652
Validation loss decreased (-0.507235 --> -0.652166).  Saving model ...
Epoch: 3 cost time: 3.698106050491333
Epoch: 3, Steps: 9 | Train Loss: 0.491 Vali Loss: 0.603 Vali Acc: 0.754 Test Loss: 0.603 Test Acc: 0.754
Validation loss decreased (-0.652166 --> -0.753617).  Saving model ...
Epoch: 4 cost time: 3.6571285724639893
Epoch: 4, Steps: 9 | Train Loss: 0.248 Vali Loss: 0.507 Vali Acc: 0.819 Test Loss: 0.507 Test Acc: 0.819
Validation loss decreased (-0.753617 --> -0.818836).  Saving model ...
Epoch: 5 cost time: 3.6803929805755615
Epoch: 5, Steps: 9 | Train Loss: 0.122 Vali Loss: 0.462 Vali Acc: 0.862 Test Loss: 0.462 Test Acc: 0.862
Validation loss decreased (-0.818836 --> -0.862314).  Saving model ...
Epoch: 6 cost time: 3.5497875213623047
Epoch: 6, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.438 Vali Acc: 0.855 Test Loss: 0.438 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.747413396835327
Epoch: 7, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.624 Vali Acc: 0.819 Test Loss: 0.624 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.8037161827087402
Epoch: 8, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.786 Vali Acc: 0.768 Test Loss: 0.786 Test Acc: 0.768
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.6878855228424072
Epoch: 9, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.491 Vali Acc: 0.884 Test Loss: 0.491 Test Acc: 0.884
Validation loss decreased (-0.862314 --> -0.884053).  Saving model ...
Epoch: 10 cost time: 3.8480846881866455
Epoch: 10, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.499 Vali Acc: 0.877 Test Loss: 0.499 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.927237033843994
Epoch: 11, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.428 Vali Acc: 0.884 Test Loss: 0.428 Test Acc: 0.884
Validation loss decreased (-0.884053 --> -0.884054).  Saving model ...
Epoch: 12 cost time: 3.7030723094940186
Epoch: 12, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.435 Vali Acc: 0.884 Test Loss: 0.435 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.694016456604004
Epoch: 13, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.517 Vali Acc: 0.855 Test Loss: 0.517 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.7535483837127686
Epoch: 14, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.743 Vali Acc: 0.833 Test Loss: 0.743 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.750354051589966
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.837 Vali Acc: 0.812 Test Loss: 0.837 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.553899049758911
Epoch: 16, Steps: 9 | Train Loss: 0.423 Vali Loss: 2.874 Vali Acc: 0.623 Test Loss: 2.874 Test Acc: 0.623
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.831605911254883
Epoch: 17, Steps: 9 | Train Loss: 0.457 Vali Loss: 1.391 Vali Acc: 0.638 Test Loss: 1.391 Test Acc: 0.638
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.5511209964752197
Epoch: 18, Steps: 9 | Train Loss: 0.309 Vali Loss: 1.306 Vali Acc: 0.674 Test Loss: 1.306 Test Acc: 0.674
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.6262006759643555
Epoch: 19, Steps: 9 | Train Loss: 0.348 Vali Loss: 1.385 Vali Acc: 0.761 Test Loss: 1.385 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.716017484664917
Epoch: 20, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.696 Vali Acc: 0.790 Test Loss: 0.696 Test Acc: 0.790
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.6890292167663574
Epoch: 21, Steps: 9 | Train Loss: 0.294 Vali Loss: 0.420 Vali Acc: 0.862 Test Loss: 0.420 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 11120516
model size : 44.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 12.33967399597168
Epoch: 1, Steps: 9 | Train Loss: 1.414 Vali Loss: 1.135 Vali Acc: 0.514 Test Loss: 1.135 Test Acc: 0.514
Validation loss decreased (inf --> -0.514481).  Saving model ...
Epoch: 2 cost time: 10.631103992462158
Epoch: 2, Steps: 9 | Train Loss: 0.835 Vali Loss: 0.617 Vali Acc: 0.783 Test Loss: 0.617 Test Acc: 0.783
Validation loss decreased (-0.514481 --> -0.782603).  Saving model ...
Epoch: 3 cost time: 10.111685276031494
Epoch: 3, Steps: 9 | Train Loss: 0.421 Vali Loss: 0.364 Vali Acc: 0.855 Test Loss: 0.364 Test Acc: 0.855
Validation loss decreased (-0.782603 --> -0.855069).  Saving model ...
Epoch: 4 cost time: 10.016908407211304
Epoch: 4, Steps: 9 | Train Loss: 0.240 Vali Loss: 0.463 Vali Acc: 0.819 Test Loss: 0.463 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.212532043457031
Epoch: 5, Steps: 9 | Train Loss: 0.159 Vali Loss: 0.335 Vali Acc: 0.862 Test Loss: 0.335 Test Acc: 0.862
Validation loss decreased (-0.855069 --> -0.862315).  Saving model ...
Epoch: 6 cost time: 10.226950645446777
Epoch: 6, Steps: 9 | Train Loss: 0.119 Vali Loss: 0.490 Vali Acc: 0.812 Test Loss: 0.490 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.290020227432251
Epoch: 7, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.554 Vali Acc: 0.826 Test Loss: 0.554 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 10.109079122543335
Epoch: 8, Steps: 9 | Train Loss: 0.304 Vali Loss: 0.322 Vali Acc: 0.877 Test Loss: 0.322 Test Acc: 0.877
Validation loss decreased (-0.862315 --> -0.876808).  Saving model ...
Epoch: 9 cost time: 10.08690619468689
Epoch: 9, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.468 Vali Acc: 0.855 Test Loss: 0.468 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 10.50626802444458
Epoch: 10, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.606 Vali Acc: 0.812 Test Loss: 0.606 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 10.469688892364502
Epoch: 11, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.550 Vali Acc: 0.841 Test Loss: 0.550 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 10.498218774795532
Epoch: 12, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.423 Vali Acc: 0.877 Test Loss: 0.423 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 10.504128694534302
Epoch: 13, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.399 Vali Acc: 0.891 Test Loss: 0.399 Test Acc: 0.891
Validation loss decreased (-0.876808 --> -0.891300).  Saving model ...
Epoch: 14 cost time: 10.095760583877563
Epoch: 14, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.436 Vali Acc: 0.877 Test Loss: 0.436 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 10.263573408126831
Epoch: 15, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.462 Vali Acc: 0.862 Test Loss: 0.462 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 10.187660694122314
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.480 Vali Acc: 0.848 Test Loss: 0.480 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 10.417466402053833
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.412 Vali Acc: 0.862 Test Loss: 0.412 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 10.179717540740967
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.351 Vali Acc: 0.884 Test Loss: 0.351 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 10.22316837310791
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.362 Vali Acc: 0.884 Test Loss: 0.362 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 10.725900650024414
Epoch: 20, Steps: 9 | Train Loss: 0.243 Vali Loss: 0.323 Vali Acc: 0.891 Test Loss: 0.323 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891301).  Saving model ...
Epoch: 21 cost time: 10.306297540664673
Epoch: 21, Steps: 9 | Train Loss: 0.149 Vali Loss: 0.319 Vali Acc: 0.906 Test Loss: 0.319 Test Acc: 0.906
Validation loss decreased (-0.891301 --> -0.905794).  Saving model ...
Epoch: 22 cost time: 9.977190256118774
Epoch: 22, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.398 Vali Acc: 0.870 Test Loss: 0.398 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 11.11556887626648
Epoch: 23, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.545 Vali Acc: 0.841 Test Loss: 0.545 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 11.256774425506592
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.486 Vali Acc: 0.848 Test Loss: 0.486 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 11.00123119354248
Epoch: 25, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.607 Vali Acc: 0.862 Test Loss: 0.607 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 9.905525207519531
Epoch: 26, Steps: 9 | Train Loss: 0.010 Vali Loss: 1.192 Vali Acc: 0.833 Test Loss: 1.192 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 9.923985004425049
Epoch: 27, Steps: 9 | Train Loss: 0.172 Vali Loss: 0.531 Vali Acc: 0.877 Test Loss: 0.531 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 9.784209728240967
Epoch: 28, Steps: 9 | Train Loss: 0.066 Vali Loss: 1.361 Vali Acc: 0.710 Test Loss: 1.361 Test Acc: 0.710
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 11.083739519119263
Epoch: 29, Steps: 9 | Train Loss: 0.352 Vali Loss: 0.852 Vali Acc: 0.819 Test Loss: 0.852 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 10.778981447219849
Epoch: 30, Steps: 9 | Train Loss: 0.177 Vali Loss: 0.910 Vali Acc: 0.790 Test Loss: 0.910 Test Acc: 0.790
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 18853764
model size : 74.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 6.039300441741943
Epoch: 1, Steps: 9 | Train Loss: 1.433 Vali Loss: 1.114 Vali Acc: 0.616 Test Loss: 1.114 Test Acc: 0.616
Validation loss decreased (inf --> -0.615931).  Saving model ...
Epoch: 2 cost time: 4.318597316741943
Epoch: 2, Steps: 9 | Train Loss: 0.928 Vali Loss: 0.669 Vali Acc: 0.775 Test Loss: 0.669 Test Acc: 0.775
Validation loss decreased (-0.615931 --> -0.775356).  Saving model ...
Epoch: 3 cost time: 4.145110368728638
Epoch: 3, Steps: 9 | Train Loss: 0.413 Vali Loss: 0.406 Vali Acc: 0.877 Test Loss: 0.406 Test Acc: 0.877
Validation loss decreased (-0.775356 --> -0.876808).  Saving model ...
Epoch: 4 cost time: 4.232828378677368
Epoch: 4, Steps: 9 | Train Loss: 0.214 Vali Loss: 0.517 Vali Acc: 0.833 Test Loss: 0.517 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.376378059387207
Epoch: 5, Steps: 9 | Train Loss: 0.157 Vali Loss: 0.465 Vali Acc: 0.862 Test Loss: 0.465 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.208312273025513
Epoch: 6, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.504 Vali Acc: 0.833 Test Loss: 0.504 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.115074396133423
Epoch: 7, Steps: 9 | Train Loss: 0.309 Vali Loss: 0.402 Vali Acc: 0.877 Test Loss: 0.402 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 8 cost time: 4.1329967975616455
Epoch: 8, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.376 Vali Acc: 0.884 Test Loss: 0.376 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884054).  Saving model ...
Epoch: 9 cost time: 4.114944696426392
Epoch: 9, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.441 Vali Acc: 0.870 Test Loss: 0.441 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.071861028671265
Epoch: 10, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.358 Vali Acc: 0.891 Test Loss: 0.358 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891301).  Saving model ...
Epoch: 11 cost time: 4.0651469230651855
Epoch: 11, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.389 Vali Acc: 0.899 Test Loss: 0.389 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898547).  Saving model ...
Epoch: 12 cost time: 4.102966785430908
Epoch: 12, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.488 Vali Acc: 0.855 Test Loss: 0.488 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.125108003616333
Epoch: 13, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.393 Vali Acc: 0.870 Test Loss: 0.393 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.9153754711151123
Epoch: 14, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.349 Vali Acc: 0.891 Test Loss: 0.349 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.082450866699219
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.413 Vali Acc: 0.884 Test Loss: 0.413 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.068471431732178
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.416 Vali Acc: 0.891 Test Loss: 0.416 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.9580671787261963
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.387 Vali Acc: 0.891 Test Loss: 0.387 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.079679727554321
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.373 Vali Acc: 0.891 Test Loss: 0.373 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.050272226333618
Epoch: 19, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.430 Vali Acc: 0.884 Test Loss: 0.430 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.110144138336182
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.552 Vali Acc: 0.855 Test Loss: 0.552 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.078962564468384
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.575 Vali Acc: 0.870 Test Loss: 0.575 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 5614468
model size : 23.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 9.526975631713867
Epoch: 1, Steps: 9 | Train Loss: 1.416 Vali Loss: 1.152 Vali Acc: 0.500 Test Loss: 1.152 Test Acc: 0.500
Validation loss decreased (inf --> -0.499988).  Saving model ...
Epoch: 2 cost time: 7.9376044273376465
Epoch: 2, Steps: 9 | Train Loss: 0.887 Vali Loss: 0.681 Vali Acc: 0.739 Test Loss: 0.681 Test Acc: 0.739
Validation loss decreased (-0.499988 --> -0.739124).  Saving model ...
Epoch: 3 cost time: 7.833508491516113
Epoch: 3, Steps: 9 | Train Loss: 0.480 Vali Loss: 0.406 Vali Acc: 0.841 Test Loss: 0.406 Test Acc: 0.841
Validation loss decreased (-0.739124 --> -0.840576).  Saving model ...
Epoch: 4 cost time: 7.601066589355469
Epoch: 4, Steps: 9 | Train Loss: 0.288 Vali Loss: 0.456 Vali Acc: 0.826 Test Loss: 0.456 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.068851470947266
Epoch: 5, Steps: 9 | Train Loss: 0.160 Vali Loss: 0.309 Vali Acc: 0.855 Test Loss: 0.309 Test Acc: 0.855
Validation loss decreased (-0.840576 --> -0.855069).  Saving model ...
Epoch: 6 cost time: 8.196542024612427
Epoch: 6, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.498 Vali Acc: 0.797 Test Loss: 0.498 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.031462907791138
Epoch: 7, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.451 Vali Acc: 0.848 Test Loss: 0.451 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 8.09017014503479
Epoch: 8, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.309 Vali Acc: 0.906 Test Loss: 0.309 Test Acc: 0.906
Validation loss decreased (-0.855069 --> -0.905794).  Saving model ...
Epoch: 9 cost time: 8.072621583938599
Epoch: 9, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.477 Vali Acc: 0.862 Test Loss: 0.477 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 8.13578462600708
Epoch: 10, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.423 Vali Acc: 0.870 Test Loss: 0.423 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 8.034655570983887
Epoch: 11, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.365 Vali Acc: 0.884 Test Loss: 0.365 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 8.046448707580566
Epoch: 12, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.479 Vali Acc: 0.884 Test Loss: 0.479 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 7.945715665817261
Epoch: 13, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.581 Vali Acc: 0.841 Test Loss: 0.581 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 8.054114580154419
Epoch: 14, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.579 Vali Acc: 0.855 Test Loss: 0.579 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 7.988033771514893
Epoch: 15, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.461 Vali Acc: 0.891 Test Loss: 0.461 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 8.000587224960327
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.455 Vali Acc: 0.877 Test Loss: 0.455 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 7.553987503051758
Epoch: 17, Steps: 9 | Train Loss: 0.111 Vali Loss: 0.375 Vali Acc: 0.891 Test Loss: 0.375 Test Acc: 0.891
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 7.3852925300598145
Epoch: 18, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.505 Vali Acc: 0.877 Test Loss: 0.505 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 18853764
model size : 74.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.94812273979187
Epoch: 1, Steps: 9 | Train Loss: 1.433 Vali Loss: 1.131 Vali Acc: 0.594 Test Loss: 1.131 Test Acc: 0.594
Validation loss decreased (inf --> -0.594192).  Saving model ...
Epoch: 2 cost time: 3.15779447555542
Epoch: 2, Steps: 9 | Train Loss: 0.959 Vali Loss: 0.721 Vali Acc: 0.725 Test Loss: 0.721 Test Acc: 0.725
Validation loss decreased (-0.594192 --> -0.724630).  Saving model ...
Epoch: 3 cost time: 3.2343053817749023
Epoch: 3, Steps: 9 | Train Loss: 0.459 Vali Loss: 0.477 Vali Acc: 0.833 Test Loss: 0.477 Test Acc: 0.833
Validation loss decreased (-0.724630 --> -0.833329).  Saving model ...
Epoch: 4 cost time: 3.163248062133789
Epoch: 4, Steps: 9 | Train Loss: 0.408 Vali Loss: 0.586 Vali Acc: 0.768 Test Loss: 0.586 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.1629068851470947
Epoch: 5, Steps: 9 | Train Loss: 0.146 Vali Loss: 0.410 Vali Acc: 0.833 Test Loss: 0.410 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 6 cost time: 3.238685131072998
Epoch: 6, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.553 Vali Acc: 0.797 Test Loss: 0.553 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.1909539699554443
Epoch: 7, Steps: 9 | Train Loss: 0.126 Vali Loss: 0.347 Vali Acc: 0.877 Test Loss: 0.347 Test Acc: 0.877
Validation loss decreased (-0.833329 --> -0.876808).  Saving model ...
Epoch: 8 cost time: 3.162642478942871
Epoch: 8, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.373 Vali Acc: 0.862 Test Loss: 0.373 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.206533432006836
Epoch: 9, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.530 Vali Acc: 0.826 Test Loss: 0.530 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.1264002323150635
Epoch: 10, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.375 Vali Acc: 0.884 Test Loss: 0.375 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884054).  Saving model ...
Epoch: 11 cost time: 3.18709135055542
Epoch: 11, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.361 Vali Acc: 0.906 Test Loss: 0.361 Test Acc: 0.906
Validation loss decreased (-0.884054 --> -0.905793).  Saving model ...
Epoch: 12 cost time: 3.231245279312134
Epoch: 12, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.446 Vali Acc: 0.884 Test Loss: 0.446 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.1009771823883057
Epoch: 13, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.491 Vali Acc: 0.855 Test Loss: 0.491 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.1933460235595703
Epoch: 14, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.451 Vali Acc: 0.877 Test Loss: 0.451 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.1760292053222656
Epoch: 15, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.380 Vali Acc: 0.884 Test Loss: 0.380 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.1044116020202637
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.387 Vali Acc: 0.891 Test Loss: 0.387 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.1465494632720947
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.424 Vali Acc: 0.891 Test Loss: 0.424 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.0891432762145996
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.476 Vali Acc: 0.891 Test Loss: 0.476 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.1109824180603027
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.488 Vali Acc: 0.899 Test Loss: 0.488 Test Acc: 0.899
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.214198589324951
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.441 Vali Acc: 0.899 Test Loss: 0.441 Test Acc: 0.899
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.1615772247314453
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.442 Vali Acc: 0.899 Test Loss: 0.442 Test Acc: 0.899
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 5614468
model size : 23.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 6.625035524368286
Epoch: 1, Steps: 9 | Train Loss: 1.417 Vali Loss: 1.191 Vali Acc: 0.464 Test Loss: 1.191 Test Acc: 0.464
Validation loss decreased (inf --> -0.463756).  Saving model ...
Epoch: 2 cost time: 4.7990686893463135
Epoch: 2, Steps: 9 | Train Loss: 0.946 Vali Loss: 0.861 Vali Acc: 0.652 Test Loss: 0.861 Test Acc: 0.652
Validation loss decreased (-0.463756 --> -0.652165).  Saving model ...
Epoch: 3 cost time: 4.906320810317993
Epoch: 3, Steps: 9 | Train Loss: 0.554 Vali Loss: 0.624 Vali Acc: 0.710 Test Loss: 0.624 Test Acc: 0.710
Validation loss decreased (-0.652165 --> -0.710139).  Saving model ...
Epoch: 4 cost time: 5.021147012710571
Epoch: 4, Steps: 9 | Train Loss: 0.315 Vali Loss: 0.536 Vali Acc: 0.804 Test Loss: 0.536 Test Acc: 0.804
Validation loss decreased (-0.710139 --> -0.804342).  Saving model ...
Epoch: 5 cost time: 4.814202070236206
Epoch: 5, Steps: 9 | Train Loss: 0.169 Vali Loss: 0.437 Vali Acc: 0.826 Test Loss: 0.437 Test Acc: 0.826
Validation loss decreased (-0.804342 --> -0.826083).  Saving model ...
Epoch: 6 cost time: 4.7996826171875
Epoch: 6, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.440 Vali Acc: 0.841 Test Loss: 0.440 Test Acc: 0.841
Validation loss decreased (-0.826083 --> -0.840575).  Saving model ...
Epoch: 7 cost time: 4.8470683097839355
Epoch: 7, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.486 Vali Acc: 0.833 Test Loss: 0.486 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.57571816444397
Epoch: 8, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.427 Vali Acc: 0.870 Test Loss: 0.427 Test Acc: 0.870
Validation loss decreased (-0.840575 --> -0.869561).  Saving model ...
Epoch: 9 cost time: 4.804725885391235
Epoch: 9, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.371 Vali Acc: 0.862 Test Loss: 0.371 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.832348585128784
Epoch: 10, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.408 Vali Acc: 0.884 Test Loss: 0.408 Test Acc: 0.884
Validation loss decreased (-0.869561 --> -0.884054).  Saving model ...
Epoch: 11 cost time: 4.805835008621216
Epoch: 11, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.424 Vali Acc: 0.841 Test Loss: 0.424 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.6354217529296875
Epoch: 12, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.819 Vali Acc: 0.841 Test Loss: 0.819 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.78759241104126
Epoch: 13, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.404 Vali Acc: 0.884 Test Loss: 0.404 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 14 cost time: 4.755699157714844
Epoch: 14, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.411 Vali Acc: 0.899 Test Loss: 0.411 Test Acc: 0.899
Validation loss decreased (-0.884054 --> -0.898547).  Saving model ...
Epoch: 15 cost time: 4.9513466358184814
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.485 Vali Acc: 0.877 Test Loss: 0.485 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.021815538406372
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.525 Vali Acc: 0.870 Test Loss: 0.525 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.070051908493042
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.491 Vali Acc: 0.877 Test Loss: 0.491 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.87842869758606
Epoch: 18, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.511 Vali Acc: 0.862 Test Loss: 0.511 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 5.183995246887207
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.938 Vali Acc: 0.804 Test Loss: 0.938 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 5.061810731887817
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.998 Vali Acc: 0.761 Test Loss: 0.998 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 5.105974912643433
Epoch: 21, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.724 Vali Acc: 0.812 Test Loss: 0.724 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.956547498703003
Epoch: 22, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.240 Vali Acc: 0.761 Test Loss: 1.240 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.992836952209473
Epoch: 23, Steps: 9 | Train Loss: 0.026 Vali Loss: 1.029 Vali Acc: 0.775 Test Loss: 1.029 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 4.855428457260132
Epoch: 24, Steps: 9 | Train Loss: 0.457 Vali Loss: 0.687 Vali Acc: 0.804 Test Loss: 0.687 Test Acc: 0.804
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 18853764
model size : 74.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.025171756744385
Epoch: 1, Steps: 9 | Train Loss: 1.440 Vali Loss: 1.167 Vali Acc: 0.565 Test Loss: 1.167 Test Acc: 0.565
Validation loss decreased (inf --> -0.565206).  Saving model ...
Epoch: 2 cost time: 2.4603967666625977
Epoch: 2, Steps: 9 | Train Loss: 1.007 Vali Loss: 0.853 Vali Acc: 0.652 Test Loss: 0.853 Test Acc: 0.652
Validation loss decreased (-0.565206 --> -0.652165).  Saving model ...
Epoch: 3 cost time: 2.461487293243408
Epoch: 3, Steps: 9 | Train Loss: 0.588 Vali Loss: 0.601 Vali Acc: 0.790 Test Loss: 0.601 Test Acc: 0.790
Validation loss decreased (-0.652165 --> -0.789849).  Saving model ...
Epoch: 4 cost time: 2.4500269889831543
Epoch: 4, Steps: 9 | Train Loss: 0.304 Vali Loss: 0.516 Vali Acc: 0.812 Test Loss: 0.516 Test Acc: 0.812
Validation loss decreased (-0.789849 --> -0.811589).  Saving model ...
Epoch: 5 cost time: 2.552813768386841
Epoch: 5, Steps: 9 | Train Loss: 0.154 Vali Loss: 0.373 Vali Acc: 0.899 Test Loss: 0.373 Test Acc: 0.899
Validation loss decreased (-0.811589 --> -0.898547).  Saving model ...
Epoch: 6 cost time: 2.451084852218628
Epoch: 6, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.444 Vali Acc: 0.855 Test Loss: 0.444 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.6044397354125977
Epoch: 7, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.330 Vali Acc: 0.899 Test Loss: 0.330 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 8 cost time: 2.510587453842163
Epoch: 8, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.414 Vali Acc: 0.862 Test Loss: 0.414 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.6387600898742676
Epoch: 9, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.677 Vali Acc: 0.797 Test Loss: 0.677 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.5577425956726074
Epoch: 10, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.508 Vali Acc: 0.877 Test Loss: 0.508 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.591320514678955
Epoch: 11, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.468 Vali Acc: 0.877 Test Loss: 0.468 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.4882326126098633
Epoch: 12, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.454 Vali Acc: 0.877 Test Loss: 0.454 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.5081634521484375
Epoch: 13, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.445 Vali Acc: 0.877 Test Loss: 0.445 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.484471321105957
Epoch: 14, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.528 Vali Acc: 0.841 Test Loss: 0.528 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.5835769176483154
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.611 Vali Acc: 0.804 Test Loss: 0.611 Test Acc: 0.804
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.496535062789917
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.626 Vali Acc: 0.797 Test Loss: 0.626 Test Acc: 0.797
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.5722122192382812
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.589 Vali Acc: 0.826 Test Loss: 0.589 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 5614468
model size : 23.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 14.244601964950562
Epoch: 1, Steps: 9 | Train Loss: 1.426 Vali Loss: 1.249 Vali Acc: 0.471 Test Loss: 1.249 Test Acc: 0.471
Validation loss decreased (inf --> -0.471002).  Saving model ...
Epoch: 2 cost time: 12.156110525131226
Epoch: 2, Steps: 9 | Train Loss: 1.042 Vali Loss: 0.826 Vali Acc: 0.717 Test Loss: 0.826 Test Acc: 0.717
Validation loss decreased (-0.471002 --> -0.717383).  Saving model ...
Epoch: 3 cost time: 12.125038862228394
Epoch: 3, Steps: 9 | Train Loss: 0.664 Vali Loss: 0.568 Vali Acc: 0.783 Test Loss: 0.568 Test Acc: 0.783
Validation loss decreased (-0.717383 --> -0.782603).  Saving model ...
Epoch: 4 cost time: 12.16443157196045
Epoch: 4, Steps: 9 | Train Loss: 0.352 Vali Loss: 0.392 Vali Acc: 0.841 Test Loss: 0.392 Test Acc: 0.841
Validation loss decreased (-0.782603 --> -0.840576).  Saving model ...
Epoch: 5 cost time: 12.227786540985107
Epoch: 5, Steps: 9 | Train Loss: 0.277 Vali Loss: 0.417 Vali Acc: 0.855 Test Loss: 0.417 Test Acc: 0.855
Validation loss decreased (-0.840576 --> -0.855068).  Saving model ...
Epoch: 6 cost time: 11.918782949447632
Epoch: 6, Steps: 9 | Train Loss: 0.158 Vali Loss: 0.450 Vali Acc: 0.833 Test Loss: 0.450 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 12.584880113601685
Epoch: 7, Steps: 9 | Train Loss: 0.099 Vali Loss: 0.385 Vali Acc: 0.877 Test Loss: 0.385 Test Acc: 0.877
Validation loss decreased (-0.855068 --> -0.876808).  Saving model ...
Epoch: 8 cost time: 12.793549060821533
Epoch: 8, Steps: 9 | Train Loss: 0.236 Vali Loss: 0.555 Vali Acc: 0.841 Test Loss: 0.555 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 12.584686756134033
Epoch: 9, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.451 Vali Acc: 0.870 Test Loss: 0.451 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 12.613531112670898
Epoch: 10, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.527 Vali Acc: 0.833 Test Loss: 0.527 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 12.666397333145142
Epoch: 11, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.553 Vali Acc: 0.841 Test Loss: 0.553 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 12.103570938110352
Epoch: 12, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.473 Vali Acc: 0.862 Test Loss: 0.473 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 12.20773983001709
Epoch: 13, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.521 Vali Acc: 0.862 Test Loss: 0.521 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 12.097978115081787
Epoch: 14, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.594 Vali Acc: 0.833 Test Loss: 0.594 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 12.01437520980835
Epoch: 15, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.587 Vali Acc: 0.833 Test Loss: 0.587 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 11.268191814422607
Epoch: 16, Steps: 9 | Train Loss: 0.281 Vali Loss: 0.651 Vali Acc: 0.819 Test Loss: 0.651 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 11.840893507003784
Epoch: 17, Steps: 9 | Train Loss: 0.292 Vali Loss: 0.587 Vali Acc: 0.855 Test Loss: 0.587 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 18800836
model size : 72.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 6.836727142333984
Epoch: 1, Steps: 9 | Train Loss: 1.360 Vali Loss: 1.194 Vali Acc: 0.529 Test Loss: 1.194 Test Acc: 0.529
Validation loss decreased (inf --> -0.528974).  Saving model ...
Epoch: 2 cost time: 5.102457046508789
Epoch: 2, Steps: 9 | Train Loss: 1.020 Vali Loss: 0.802 Vali Acc: 0.739 Test Loss: 0.802 Test Acc: 0.739
Validation loss decreased (-0.528974 --> -0.739122).  Saving model ...
Epoch: 3 cost time: 5.0302064418792725
Epoch: 3, Steps: 9 | Train Loss: 0.602 Vali Loss: 0.541 Vali Acc: 0.797 Test Loss: 0.541 Test Acc: 0.797
Validation loss decreased (-0.739122 --> -0.797096).  Saving model ...
Epoch: 4 cost time: 5.084205150604248
Epoch: 4, Steps: 9 | Train Loss: 0.361 Vali Loss: 0.362 Vali Acc: 0.884 Test Loss: 0.362 Test Acc: 0.884
Validation loss decreased (-0.797096 --> -0.884054).  Saving model ...
Epoch: 5 cost time: 4.9933459758758545
Epoch: 5, Steps: 9 | Train Loss: 0.231 Vali Loss: 0.436 Vali Acc: 0.848 Test Loss: 0.436 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.123651027679443
Epoch: 6, Steps: 9 | Train Loss: 0.156 Vali Loss: 0.483 Vali Acc: 0.848 Test Loss: 0.483 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.049037933349609
Epoch: 7, Steps: 9 | Train Loss: 0.217 Vali Loss: 0.414 Vali Acc: 0.848 Test Loss: 0.414 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.047790050506592
Epoch: 8, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.422 Vali Acc: 0.870 Test Loss: 0.422 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.116934537887573
Epoch: 9, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.473 Vali Acc: 0.826 Test Loss: 0.473 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.219639778137207
Epoch: 10, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.371 Vali Acc: 0.884 Test Loss: 0.371 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.989342212677002
Epoch: 11, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.445 Vali Acc: 0.877 Test Loss: 0.445 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.037996530532837
Epoch: 12, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.536 Vali Acc: 0.833 Test Loss: 0.536 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.083798408508301
Epoch: 13, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.564 Vali Acc: 0.833 Test Loss: 0.564 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 5.04327392578125
Epoch: 14, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.394 Vali Acc: 0.884 Test Loss: 0.394 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 5561284
model size : 22.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 10.530073881149292
Epoch: 1, Steps: 9 | Train Loss: 1.426 Vali Loss: 1.254 Vali Acc: 0.464 Test Loss: 1.254 Test Acc: 0.464
Validation loss decreased (inf --> -0.463756).  Saving model ...
Epoch: 2 cost time: 8.925600290298462
Epoch: 2, Steps: 9 | Train Loss: 1.072 Vali Loss: 0.857 Vali Acc: 0.703 Test Loss: 0.857 Test Acc: 0.703
Validation loss decreased (-0.463756 --> -0.702890).  Saving model ...
Epoch: 3 cost time: 8.54364800453186
Epoch: 3, Steps: 9 | Train Loss: 0.741 Vali Loss: 0.636 Vali Acc: 0.754 Test Loss: 0.636 Test Acc: 0.754
Validation loss decreased (-0.702890 --> -0.753617).  Saving model ...
Epoch: 4 cost time: 8.839955806732178
Epoch: 4, Steps: 9 | Train Loss: 0.405 Vali Loss: 0.400 Vali Acc: 0.848 Test Loss: 0.400 Test Acc: 0.848
Validation loss decreased (-0.753617 --> -0.847822).  Saving model ...
Epoch: 5 cost time: 8.611714124679565
Epoch: 5, Steps: 9 | Train Loss: 0.311 Vali Loss: 0.414 Vali Acc: 0.819 Test Loss: 0.414 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.776649713516235
Epoch: 6, Steps: 9 | Train Loss: 0.164 Vali Loss: 0.385 Vali Acc: 0.848 Test Loss: 0.385 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 7 cost time: 8.877463340759277
Epoch: 7, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.358 Vali Acc: 0.870 Test Loss: 0.358 Test Acc: 0.870
Validation loss decreased (-0.847822 --> -0.869562).  Saving model ...
Epoch: 8 cost time: 8.850605487823486
Epoch: 8, Steps: 9 | Train Loss: 0.233 Vali Loss: 0.463 Vali Acc: 0.826 Test Loss: 0.463 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 8.819456577301025
Epoch: 9, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.484 Vali Acc: 0.841 Test Loss: 0.484 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 8.86010193824768
Epoch: 10, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.683 Vali Acc: 0.826 Test Loss: 0.683 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 8.830511093139648
Epoch: 11, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.664 Vali Acc: 0.819 Test Loss: 0.664 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 8.929748773574829
Epoch: 12, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.420 Vali Acc: 0.862 Test Loss: 0.420 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 8.543023824691772
Epoch: 13, Steps: 9 | Train Loss: 0.412 Vali Loss: 0.600 Vali Acc: 0.797 Test Loss: 0.600 Test Acc: 0.797
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 8.66427731513977
Epoch: 14, Steps: 9 | Train Loss: 0.170 Vali Loss: 0.583 Vali Acc: 0.812 Test Loss: 0.583 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 8.590083837509155
Epoch: 15, Steps: 9 | Train Loss: 0.102 Vali Loss: 0.683 Vali Acc: 0.812 Test Loss: 0.683 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 8.606285095214844
Epoch: 16, Steps: 9 | Train Loss: 0.266 Vali Loss: 0.478 Vali Acc: 0.884 Test Loss: 0.478 Test Acc: 0.884
Validation loss decreased (-0.869562 --> -0.884053).  Saving model ...
Epoch: 17 cost time: 8.487751245498657
Epoch: 17, Steps: 9 | Train Loss: 0.911 Vali Loss: 0.318 Vali Acc: 0.877 Test Loss: 0.318 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 8.605615854263306
Epoch: 18, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.926 Vali Acc: 0.797 Test Loss: 0.926 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 8.733923435211182
Epoch: 19, Steps: 9 | Train Loss: 0.176 Vali Loss: 0.636 Vali Acc: 0.797 Test Loss: 0.636 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 8.42067813873291
Epoch: 20, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.266 Vali Acc: 0.899 Test Loss: 0.266 Test Acc: 0.899
Validation loss decreased (-0.884053 --> -0.898548).  Saving model ...
Epoch: 21 cost time: 8.436909675598145
Epoch: 21, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.517 Vali Acc: 0.848 Test Loss: 0.517 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 8.367245435714722
Epoch: 22, Steps: 9 | Train Loss: 0.178 Vali Loss: 0.753 Vali Acc: 0.848 Test Loss: 0.753 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 8.277060270309448
Epoch: 23, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.462 Vali Acc: 0.855 Test Loss: 0.462 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 8.231184244155884
Epoch: 24, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.452 Vali Acc: 0.855 Test Loss: 0.452 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 8.85616946220398
Epoch: 25, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.438 Vali Acc: 0.870 Test Loss: 0.438 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 8.733933210372925
Epoch: 26, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.441 Vali Acc: 0.884 Test Loss: 0.441 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 8.598754167556763
Epoch: 27, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.507 Vali Acc: 0.870 Test Loss: 0.507 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 9.429121017456055
Epoch: 28, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.599 Vali Acc: 0.833 Test Loss: 0.599 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 9.395270586013794
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.549 Vali Acc: 0.862 Test Loss: 0.549 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 9.329716205596924
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.536 Vali Acc: 0.870 Test Loss: 0.536 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 18800836
model size : 72.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.841112375259399
Epoch: 1, Steps: 9 | Train Loss: 1.362 Vali Loss: 1.212 Vali Acc: 0.478 Test Loss: 1.212 Test Acc: 0.478
Validation loss decreased (inf --> -0.478249).  Saving model ...
Epoch: 2 cost time: 4.059276342391968
Epoch: 2, Steps: 9 | Train Loss: 1.046 Vali Loss: 0.862 Vali Acc: 0.703 Test Loss: 0.862 Test Acc: 0.703
Validation loss decreased (-0.478249 --> -0.702890).  Saving model ...
Epoch: 3 cost time: 4.090421199798584
Epoch: 3, Steps: 9 | Train Loss: 0.678 Vali Loss: 0.615 Vali Acc: 0.783 Test Loss: 0.615 Test Acc: 0.783
Validation loss decreased (-0.702890 --> -0.782603).  Saving model ...
Epoch: 4 cost time: 3.9606258869171143
Epoch: 4, Steps: 9 | Train Loss: 0.444 Vali Loss: 0.404 Vali Acc: 0.862 Test Loss: 0.404 Test Acc: 0.862
Validation loss decreased (-0.782603 --> -0.862315).  Saving model ...
Epoch: 5 cost time: 4.068393230438232
Epoch: 5, Steps: 9 | Train Loss: 0.282 Vali Loss: 0.441 Vali Acc: 0.826 Test Loss: 0.441 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.040395021438599
Epoch: 6, Steps: 9 | Train Loss: 0.222 Vali Loss: 0.355 Vali Acc: 0.870 Test Loss: 0.355 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869562).  Saving model ...
Epoch: 7 cost time: 4.003404140472412
Epoch: 7, Steps: 9 | Train Loss: 0.121 Vali Loss: 0.411 Vali Acc: 0.848 Test Loss: 0.411 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.079010725021362
Epoch: 8, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.431 Vali Acc: 0.862 Test Loss: 0.431 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.091019630432129
Epoch: 9, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.416 Vali Acc: 0.848 Test Loss: 0.416 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.116250276565552
Epoch: 10, Steps: 9 | Train Loss: 0.273 Vali Loss: 0.430 Vali Acc: 0.804 Test Loss: 0.430 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.903930902481079
Epoch: 11, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.620 Vali Acc: 0.768 Test Loss: 0.620 Test Acc: 0.768
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.059681415557861
Epoch: 12, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.440 Vali Acc: 0.855 Test Loss: 0.440 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.9990346431732178
Epoch: 13, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.497 Vali Acc: 0.848 Test Loss: 0.497 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.9541358947753906
Epoch: 14, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.447 Vali Acc: 0.891 Test Loss: 0.447 Test Acc: 0.891
Validation loss decreased (-0.869562 --> -0.891300).  Saving model ...
Epoch: 15 cost time: 4.056532621383667
Epoch: 15, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.397 Vali Acc: 0.884 Test Loss: 0.397 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.044071435928345
Epoch: 16, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.389 Vali Acc: 0.884 Test Loss: 0.389 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.882678270339966
Epoch: 17, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.401 Vali Acc: 0.884 Test Loss: 0.401 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.854170560836792
Epoch: 18, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.405 Vali Acc: 0.884 Test Loss: 0.405 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.924168586730957
Epoch: 19, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.437 Vali Acc: 0.920 Test Loss: 0.437 Test Acc: 0.920
Validation loss decreased (-0.891300 --> -0.920285).  Saving model ...
Epoch: 20 cost time: 3.907078266143799
Epoch: 20, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.316 Vali Acc: 0.928 Test Loss: 0.316 Test Acc: 0.928
Validation loss decreased (-0.920285 --> -0.927533).  Saving model ...
Epoch: 21 cost time: 3.954699754714966
Epoch: 21, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.407 Vali Acc: 0.870 Test Loss: 0.407 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.8700146675109863
Epoch: 22, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.431 Vali Acc: 0.891 Test Loss: 0.431 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.942228317260742
Epoch: 23, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.572 Vali Acc: 0.819 Test Loss: 0.572 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.031792640686035
Epoch: 24, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.464 Vali Acc: 0.884 Test Loss: 0.464 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.973153829574585
Epoch: 25, Steps: 9 | Train Loss: 0.199 Vali Loss: 0.530 Vali Acc: 0.826 Test Loss: 0.530 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.029792547225952
Epoch: 26, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.449 Vali Acc: 0.884 Test Loss: 0.449 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.916013479232788
Epoch: 27, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.492 Vali Acc: 0.877 Test Loss: 0.492 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.9835193157196045
Epoch: 28, Steps: 9 | Train Loss: 0.205 Vali Loss: 0.414 Vali Acc: 0.877 Test Loss: 0.414 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 4.032001495361328
Epoch: 29, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.507 Vali Acc: 0.855 Test Loss: 0.507 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.994445562362671
Epoch: 30, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.715 Vali Acc: 0.848 Test Loss: 0.715 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.927536231884058
model parameter : 5561284
model size : 22.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 7.374117136001587
Epoch: 1, Steps: 9 | Train Loss: 1.427 Vali Loss: 1.288 Vali Acc: 0.435 Test Loss: 1.288 Test Acc: 0.435
Validation loss decreased (inf --> -0.434770).  Saving model ...
Epoch: 2 cost time: 5.582709312438965
Epoch: 2, Steps: 9 | Train Loss: 1.103 Vali Loss: 0.972 Vali Acc: 0.623 Test Loss: 0.972 Test Acc: 0.623
Validation loss decreased (-0.434770 --> -0.623179).  Saving model ...
Epoch: 3 cost time: 5.7768707275390625
Epoch: 3, Steps: 9 | Train Loss: 0.803 Vali Loss: 0.778 Vali Acc: 0.674 Test Loss: 0.778 Test Acc: 0.674
Validation loss decreased (-0.623179 --> -0.673905).  Saving model ...
Epoch: 4 cost time: 5.81312370300293
Epoch: 4, Steps: 9 | Train Loss: 0.517 Vali Loss: 0.629 Vali Acc: 0.732 Test Loss: 0.629 Test Acc: 0.732
Validation loss decreased (-0.673905 --> -0.731878).  Saving model ...
Epoch: 5 cost time: 5.860806465148926
Epoch: 5, Steps: 9 | Train Loss: 0.364 Vali Loss: 0.570 Vali Acc: 0.790 Test Loss: 0.570 Test Acc: 0.790
Validation loss decreased (-0.731878 --> -0.789849).  Saving model ...
Epoch: 6 cost time: 5.872546434402466
Epoch: 6, Steps: 9 | Train Loss: 0.195 Vali Loss: 0.522 Vali Acc: 0.797 Test Loss: 0.522 Test Acc: 0.797
Validation loss decreased (-0.789849 --> -0.797096).  Saving model ...
Epoch: 7 cost time: 5.6754961013793945
Epoch: 7, Steps: 9 | Train Loss: 0.147 Vali Loss: 0.476 Vali Acc: 0.833 Test Loss: 0.476 Test Acc: 0.833
Validation loss decreased (-0.797096 --> -0.833329).  Saving model ...
Epoch: 8 cost time: 5.913602590560913
Epoch: 8, Steps: 9 | Train Loss: 0.143 Vali Loss: 0.453 Vali Acc: 0.855 Test Loss: 0.453 Test Acc: 0.855
Validation loss decreased (-0.833329 --> -0.855068).  Saving model ...
Epoch: 9 cost time: 5.820646047592163
Epoch: 9, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.660 Vali Acc: 0.790 Test Loss: 0.660 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.827816963195801
Epoch: 10, Steps: 9 | Train Loss: 0.776 Vali Loss: 0.644 Vali Acc: 0.826 Test Loss: 0.644 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.603755950927734
Epoch: 11, Steps: 9 | Train Loss: 0.084 Vali Loss: 1.012 Vali Acc: 0.732 Test Loss: 1.012 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.882684230804443
Epoch: 12, Steps: 9 | Train Loss: 0.019 Vali Loss: 1.280 Vali Acc: 0.717 Test Loss: 1.280 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.579049110412598
Epoch: 13, Steps: 9 | Train Loss: 0.026 Vali Loss: 1.127 Vali Acc: 0.739 Test Loss: 1.127 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.66620135307312
Epoch: 14, Steps: 9 | Train Loss: 0.051 Vali Loss: 1.068 Vali Acc: 0.717 Test Loss: 1.068 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.646929740905762
Epoch: 15, Steps: 9 | Train Loss: 0.035 Vali Loss: 1.219 Vali Acc: 0.696 Test Loss: 1.219 Test Acc: 0.696
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.66984224319458
Epoch: 16, Steps: 9 | Train Loss: 0.287 Vali Loss: 0.705 Vali Acc: 0.833 Test Loss: 0.705 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 5.652164936065674
Epoch: 17, Steps: 9 | Train Loss: 0.620 Vali Loss: 0.503 Vali Acc: 0.862 Test Loss: 0.503 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862314).  Saving model ...
Epoch: 18 cost time: 5.8847315311431885
Epoch: 18, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.301 Vali Acc: 0.899 Test Loss: 0.301 Test Acc: 0.899
Validation loss decreased (-0.862314 --> -0.898548).  Saving model ...
Epoch: 19 cost time: 5.636364221572876
Epoch: 19, Steps: 9 | Train Loss: 0.435 Vali Loss: 1.069 Vali Acc: 0.732 Test Loss: 1.069 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.86003303527832
Epoch: 20, Steps: 9 | Train Loss: 0.323 Vali Loss: 0.999 Vali Acc: 0.761 Test Loss: 0.999 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.886357069015503
Epoch: 21, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.441 Vali Acc: 0.891 Test Loss: 0.441 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 5.811183929443359
Epoch: 22, Steps: 9 | Train Loss: 0.152 Vali Loss: 0.646 Vali Acc: 0.812 Test Loss: 0.646 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 5.772066593170166
Epoch: 23, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.731 Vali Acc: 0.790 Test Loss: 0.731 Test Acc: 0.790
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 5.723543643951416
Epoch: 24, Steps: 9 | Train Loss: 0.153 Vali Loss: 0.658 Vali Acc: 0.826 Test Loss: 0.658 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 6.025680303573608
Epoch: 25, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.708 Vali Acc: 0.674 Test Loss: 1.708 Test Acc: 0.674
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 6.018803119659424
Epoch: 26, Steps: 9 | Train Loss: 0.002 Vali Loss: 2.156 Vali Acc: 0.667 Test Loss: 2.156 Test Acc: 0.667
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 5.983034133911133
Epoch: 27, Steps: 9 | Train Loss: 0.049 Vali Loss: 2.640 Vali Acc: 0.609 Test Loss: 2.640 Test Acc: 0.609
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 6.105260133743286
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 2.697 Vali Acc: 0.594 Test Loss: 2.697 Test Acc: 0.594
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 18800836
model size : 72.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.668675661087036
Epoch: 1, Steps: 9 | Train Loss: 1.355 Vali Loss: 1.239 Vali Acc: 0.457 Test Loss: 1.239 Test Acc: 0.457
Validation loss decreased (inf --> -0.456509).  Saving model ...
Epoch: 2 cost time: 2.71743106842041
Epoch: 2, Steps: 9 | Train Loss: 1.085 Vali Loss: 0.977 Vali Acc: 0.623 Test Loss: 0.977 Test Acc: 0.623
Validation loss decreased (-0.456509 --> -0.623179).  Saving model ...
Epoch: 3 cost time: 2.6766717433929443
Epoch: 3, Steps: 9 | Train Loss: 0.750 Vali Loss: 0.766 Vali Acc: 0.725 Test Loss: 0.766 Test Acc: 0.725
Validation loss decreased (-0.623179 --> -0.724630).  Saving model ...
Epoch: 4 cost time: 2.6346681118011475
Epoch: 4, Steps: 9 | Train Loss: 0.498 Vali Loss: 0.551 Vali Acc: 0.812 Test Loss: 0.551 Test Acc: 0.812
Validation loss decreased (-0.724630 --> -0.811589).  Saving model ...
Epoch: 5 cost time: 2.7798471450805664
Epoch: 5, Steps: 9 | Train Loss: 0.331 Vali Loss: 0.560 Vali Acc: 0.797 Test Loss: 0.560 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.814152240753174
Epoch: 6, Steps: 9 | Train Loss: 0.193 Vali Loss: 0.428 Vali Acc: 0.848 Test Loss: 0.428 Test Acc: 0.848
Validation loss decreased (-0.811589 --> -0.847822).  Saving model ...
Epoch: 7 cost time: 2.642007827758789
Epoch: 7, Steps: 9 | Train Loss: 0.128 Vali Loss: 0.463 Vali Acc: 0.812 Test Loss: 0.463 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.7188642024993896
Epoch: 8, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.660 Vali Acc: 0.775 Test Loss: 0.660 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.7265994548797607
Epoch: 9, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.547 Vali Acc: 0.790 Test Loss: 0.547 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.6803903579711914
Epoch: 10, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.718 Vali Acc: 0.833 Test Loss: 0.718 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.739725112915039
Epoch: 11, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.847 Vali Acc: 0.768 Test Loss: 0.847 Test Acc: 0.768
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.7933034896850586
Epoch: 12, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.950 Vali Acc: 0.761 Test Loss: 0.950 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.7183051109313965
Epoch: 13, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.552 Vali Acc: 0.804 Test Loss: 0.552 Test Acc: 0.804
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.7333984375
Epoch: 14, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.867 Vali Acc: 0.739 Test Loss: 0.867 Test Acc: 0.739
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.5765035152435303
Epoch: 15, Steps: 9 | Train Loss: 0.114 Vali Loss: 0.554 Vali Acc: 0.833 Test Loss: 0.554 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.6766464710235596
Epoch: 16, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.869 Vali Acc: 0.783 Test Loss: 0.869 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 5561284
model size : 22.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 8.92992353439331
Epoch: 1, Steps: 9 | Train Loss: 1.353 Vali Loss: 1.257 Vali Acc: 0.420 Test Loss: 1.257 Test Acc: 0.420
Validation loss decreased (inf --> -0.420277).  Saving model ...
Epoch: 2 cost time: 6.966667413711548
Epoch: 2, Steps: 9 | Train Loss: 1.055 Vali Loss: 0.872 Vali Acc: 0.645 Test Loss: 0.872 Test Acc: 0.645
Validation loss decreased (-0.420277 --> -0.644919).  Saving model ...
Epoch: 3 cost time: 7.041379928588867
Epoch: 3, Steps: 9 | Train Loss: 0.690 Vali Loss: 0.620 Vali Acc: 0.725 Test Loss: 0.620 Test Acc: 0.725
Validation loss decreased (-0.644919 --> -0.724631).  Saving model ...
Epoch: 4 cost time: 7.015818357467651
Epoch: 4, Steps: 9 | Train Loss: 0.459 Vali Loss: 0.521 Vali Acc: 0.804 Test Loss: 0.521 Test Acc: 0.804
Validation loss decreased (-0.724631 --> -0.804343).  Saving model ...
Epoch: 5 cost time: 7.0274152755737305
Epoch: 5, Steps: 9 | Train Loss: 0.275 Vali Loss: 0.468 Vali Acc: 0.826 Test Loss: 0.468 Test Acc: 0.826
Validation loss decreased (-0.804343 --> -0.826082).  Saving model ...
Epoch: 6 cost time: 7.029665946960449
Epoch: 6, Steps: 9 | Train Loss: 0.233 Vali Loss: 0.527 Vali Acc: 0.812 Test Loss: 0.527 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.1557042598724365
Epoch: 7, Steps: 9 | Train Loss: 0.153 Vali Loss: 0.517 Vali Acc: 0.826 Test Loss: 0.517 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.8470752239227295
Epoch: 8, Steps: 9 | Train Loss: 0.129 Vali Loss: 0.436 Vali Acc: 0.855 Test Loss: 0.436 Test Acc: 0.855
Validation loss decreased (-0.826082 --> -0.855068).  Saving model ...
Epoch: 9 cost time: 6.937117099761963
Epoch: 9, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.471 Vali Acc: 0.841 Test Loss: 0.471 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.0498292446136475
Epoch: 10, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.277 Vali Acc: 0.906 Test Loss: 0.277 Test Acc: 0.906
Validation loss decreased (-0.855068 --> -0.905794).  Saving model ...
Epoch: 11 cost time: 7.112515211105347
Epoch: 11, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.394 Vali Acc: 0.870 Test Loss: 0.394 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.2592761516571045
Epoch: 12, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.473 Vali Acc: 0.862 Test Loss: 0.473 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 7.062246084213257
Epoch: 13, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.501 Vali Acc: 0.848 Test Loss: 0.501 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 7.073085784912109
Epoch: 14, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.528 Vali Acc: 0.848 Test Loss: 0.528 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 7.072567939758301
Epoch: 15, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.576 Vali Acc: 0.862 Test Loss: 0.576 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 7.200418949127197
Epoch: 16, Steps: 9 | Train Loss: 0.397 Vali Loss: 0.439 Vali Acc: 0.891 Test Loss: 0.439 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 7.183908939361572
Epoch: 17, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.506 Vali Acc: 0.877 Test Loss: 0.506 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 7.1042914390563965
Epoch: 18, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.416 Vali Acc: 0.884 Test Loss: 0.416 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 7.25421929359436
Epoch: 19, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.462 Vali Acc: 0.884 Test Loss: 0.462 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 7.2105185985565186
Epoch: 20, Steps: 9 | Train Loss: 0.296 Vali Loss: 1.332 Vali Acc: 0.725 Test Loss: 1.332 Test Acc: 0.725
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 9427652
model size : 37.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.998997211456299
Epoch: 1, Steps: 9 | Train Loss: 1.418 Vali Loss: 1.302 Vali Acc: 0.370 Test Loss: 1.302 Test Acc: 0.370
Validation loss decreased (inf --> -0.369552).  Saving model ...
Epoch: 2 cost time: 2.9411299228668213
Epoch: 2, Steps: 9 | Train Loss: 1.117 Vali Loss: 0.952 Vali Acc: 0.652 Test Loss: 0.952 Test Acc: 0.652
Validation loss decreased (-0.369552 --> -0.652164).  Saving model ...
Epoch: 3 cost time: 3.1220693588256836
Epoch: 3, Steps: 9 | Train Loss: 0.756 Vali Loss: 0.650 Vali Acc: 0.775 Test Loss: 0.650 Test Acc: 0.775
Validation loss decreased (-0.652164 --> -0.775356).  Saving model ...
Epoch: 4 cost time: 2.8781545162200928
Epoch: 4, Steps: 9 | Train Loss: 0.478 Vali Loss: 0.474 Vali Acc: 0.819 Test Loss: 0.474 Test Acc: 0.819
Validation loss decreased (-0.775356 --> -0.818836).  Saving model ...
Epoch: 5 cost time: 3.3380606174468994
Epoch: 5, Steps: 9 | Train Loss: 0.348 Vali Loss: 0.420 Vali Acc: 0.826 Test Loss: 0.420 Test Acc: 0.826
Validation loss decreased (-0.818836 --> -0.826083).  Saving model ...
Epoch: 6 cost time: 3.2607052326202393
Epoch: 6, Steps: 9 | Train Loss: 0.203 Vali Loss: 0.407 Vali Acc: 0.826 Test Loss: 0.407 Test Acc: 0.826
Validation loss decreased (-0.826083 --> -0.826083).  Saving model ...
Epoch: 7 cost time: 3.2543060779571533
Epoch: 7, Steps: 9 | Train Loss: 0.108 Vali Loss: 0.426 Vali Acc: 0.848 Test Loss: 0.426 Test Acc: 0.848
Validation loss decreased (-0.826083 --> -0.847822).  Saving model ...
Epoch: 8 cost time: 3.0231335163116455
Epoch: 8, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.388 Vali Acc: 0.855 Test Loss: 0.388 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855069).  Saving model ...
Epoch: 9 cost time: 3.294461250305176
Epoch: 9, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.525 Vali Acc: 0.833 Test Loss: 0.525 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.3496525287628174
Epoch: 10, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.436 Vali Acc: 0.841 Test Loss: 0.436 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.201894760131836
Epoch: 11, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.469 Vali Acc: 0.841 Test Loss: 0.469 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.2181313037872314
Epoch: 12, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.398 Vali Acc: 0.862 Test Loss: 0.398 Test Acc: 0.862
Validation loss decreased (-0.855069 --> -0.862315).  Saving model ...
Epoch: 13 cost time: 3.283740282058716
Epoch: 13, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.380 Vali Acc: 0.877 Test Loss: 0.380 Test Acc: 0.877
Validation loss decreased (-0.862315 --> -0.876808).  Saving model ...
Epoch: 14 cost time: 3.3596956729888916
Epoch: 14, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.530 Vali Acc: 0.848 Test Loss: 0.530 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.2364909648895264
Epoch: 15, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.450 Vali Acc: 0.870 Test Loss: 0.450 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.2592825889587402
Epoch: 16, Steps: 9 | Train Loss: 0.086 Vali Loss: 0.395 Vali Acc: 0.906 Test Loss: 0.395 Test Acc: 0.906
Validation loss decreased (-0.876808 --> -0.905793).  Saving model ...
Epoch: 17 cost time: 3.3806636333465576
Epoch: 17, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.347 Vali Acc: 0.899 Test Loss: 0.347 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.396225929260254
Epoch: 18, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.368 Vali Acc: 0.884 Test Loss: 0.368 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.4192447662353516
Epoch: 19, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.411 Vali Acc: 0.906 Test Loss: 0.411 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.4141244888305664
Epoch: 20, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.431 Vali Acc: 0.899 Test Loss: 0.431 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.3510022163391113
Epoch: 21, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.365 Vali Acc: 0.913 Test Loss: 0.365 Test Acc: 0.913
Validation loss decreased (-0.905793 --> -0.913040).  Saving model ...
Epoch: 22 cost time: 3.4308745861053467
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.372 Vali Acc: 0.913 Test Loss: 0.372 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.3236992359161377
Epoch: 23, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.389 Vali Acc: 0.906 Test Loss: 0.389 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.446950912475586
Epoch: 24, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.417 Vali Acc: 0.891 Test Loss: 0.417 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.2841672897338867
Epoch: 25, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.451 Vali Acc: 0.891 Test Loss: 0.451 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.2635843753814697
Epoch: 26, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.394 Vali Acc: 0.913 Test Loss: 0.394 Test Acc: 0.913
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.2424051761627197
Epoch: 27, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.473 Vali Acc: 0.899 Test Loss: 0.473 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.402026653289795
Epoch: 28, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.473 Vali Acc: 0.884 Test Loss: 0.473 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.4138216972351074
Epoch: 29, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.510 Vali Acc: 0.891 Test Loss: 0.510 Test Acc: 0.891
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.4057042598724365
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.497 Vali Acc: 0.899 Test Loss: 0.497 Test Acc: 0.899
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 2807748
model size : 11.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 7.1999733448028564
Epoch: 1, Steps: 9 | Train Loss: 1.357 Vali Loss: 1.263 Vali Acc: 0.428 Test Loss: 1.263 Test Acc: 0.428
Validation loss decreased (inf --> -0.427524).  Saving model ...
Epoch: 2 cost time: 5.5361855030059814
Epoch: 2, Steps: 9 | Train Loss: 1.083 Vali Loss: 0.921 Vali Acc: 0.630 Test Loss: 0.921 Test Acc: 0.630
Validation loss decreased (-0.427524 --> -0.630426).  Saving model ...
Epoch: 3 cost time: 5.654081583023071
Epoch: 3, Steps: 9 | Train Loss: 0.777 Vali Loss: 0.673 Vali Acc: 0.725 Test Loss: 0.673 Test Acc: 0.725
Validation loss decreased (-0.630426 --> -0.724631).  Saving model ...
Epoch: 4 cost time: 5.547534704208374
Epoch: 4, Steps: 9 | Train Loss: 0.564 Vali Loss: 0.544 Vali Acc: 0.804 Test Loss: 0.544 Test Acc: 0.804
Validation loss decreased (-0.724631 --> -0.804342).  Saving model ...
Epoch: 5 cost time: 5.5978171825408936
Epoch: 5, Steps: 9 | Train Loss: 0.356 Vali Loss: 0.408 Vali Acc: 0.848 Test Loss: 0.408 Test Acc: 0.848
Validation loss decreased (-0.804342 --> -0.847822).  Saving model ...
Epoch: 6 cost time: 5.526520252227783
Epoch: 6, Steps: 9 | Train Loss: 0.245 Vali Loss: 0.442 Vali Acc: 0.826 Test Loss: 0.442 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.540530443191528
Epoch: 7, Steps: 9 | Train Loss: 0.158 Vali Loss: 0.369 Vali Acc: 0.855 Test Loss: 0.369 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855069).  Saving model ...
Epoch: 8 cost time: 5.583351135253906
Epoch: 8, Steps: 9 | Train Loss: 0.095 Vali Loss: 0.383 Vali Acc: 0.848 Test Loss: 0.383 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.550478935241699
Epoch: 9, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.356 Vali Acc: 0.862 Test Loss: 0.356 Test Acc: 0.862
Validation loss decreased (-0.855069 --> -0.862315).  Saving model ...
Epoch: 10 cost time: 5.561768054962158
Epoch: 10, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.252 Vali Acc: 0.906 Test Loss: 0.252 Test Acc: 0.906
Validation loss decreased (-0.862315 --> -0.905795).  Saving model ...
Epoch: 11 cost time: 5.71102499961853
Epoch: 11, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.375 Vali Acc: 0.884 Test Loss: 0.375 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.592941761016846
Epoch: 12, Steps: 9 | Train Loss: 0.419 Vali Loss: 0.364 Vali Acc: 0.906 Test Loss: 0.364 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.693440675735474
Epoch: 13, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.453 Vali Acc: 0.855 Test Loss: 0.453 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.589545488357544
Epoch: 14, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.387 Vali Acc: 0.855 Test Loss: 0.387 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.522562265396118
Epoch: 15, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.345 Vali Acc: 0.891 Test Loss: 0.345 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.6070945262908936
Epoch: 16, Steps: 9 | Train Loss: 0.146 Vali Loss: 0.389 Vali Acc: 0.891 Test Loss: 0.389 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 5.609777927398682
Epoch: 17, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.349 Vali Acc: 0.906 Test Loss: 0.349 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 5.53566312789917
Epoch: 18, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.352 Vali Acc: 0.891 Test Loss: 0.352 Test Acc: 0.891
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 5.503266334533691
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.357 Vali Acc: 0.870 Test Loss: 0.357 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 5.251373052597046
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.371 Vali Acc: 0.870 Test Loss: 0.371 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 9427652
model size : 37.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.440306663513184
Epoch: 1, Steps: 9 | Train Loss: 1.417 Vali Loss: 1.314 Vali Acc: 0.355 Test Loss: 1.314 Test Acc: 0.355
Validation loss decreased (inf --> -0.355059).  Saving model ...
Epoch: 2 cost time: 2.6393144130706787
Epoch: 2, Steps: 9 | Train Loss: 1.133 Vali Loss: 0.979 Vali Acc: 0.616 Test Loss: 0.979 Test Acc: 0.616
Validation loss decreased (-0.355059 --> -0.615932).  Saving model ...
Epoch: 3 cost time: 2.602919578552246
Epoch: 3, Steps: 9 | Train Loss: 0.802 Vali Loss: 0.699 Vali Acc: 0.732 Test Loss: 0.699 Test Acc: 0.732
Validation loss decreased (-0.615932 --> -0.731877).  Saving model ...
Epoch: 4 cost time: 2.700669527053833
Epoch: 4, Steps: 9 | Train Loss: 0.525 Vali Loss: 0.514 Vali Acc: 0.826 Test Loss: 0.514 Test Acc: 0.826
Validation loss decreased (-0.731877 --> -0.826082).  Saving model ...
Epoch: 5 cost time: 2.653815269470215
Epoch: 5, Steps: 9 | Train Loss: 0.348 Vali Loss: 0.411 Vali Acc: 0.855 Test Loss: 0.411 Test Acc: 0.855
Validation loss decreased (-0.826082 --> -0.855068).  Saving model ...
Epoch: 6 cost time: 2.582289695739746
Epoch: 6, Steps: 9 | Train Loss: 0.219 Vali Loss: 0.366 Vali Acc: 0.848 Test Loss: 0.366 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.8201677799224854
Epoch: 7, Steps: 9 | Train Loss: 0.116 Vali Loss: 0.427 Vali Acc: 0.841 Test Loss: 0.427 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.682725667953491
Epoch: 8, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.347 Vali Acc: 0.848 Test Loss: 0.347 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.6640427112579346
Epoch: 9, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.391 Vali Acc: 0.833 Test Loss: 0.391 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.676879644393921
Epoch: 10, Steps: 9 | Train Loss: 0.249 Vali Loss: 0.398 Vali Acc: 0.877 Test Loss: 0.398 Test Acc: 0.877
Validation loss decreased (-0.855068 --> -0.876808).  Saving model ...
Epoch: 11 cost time: 2.6858081817626953
Epoch: 11, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.411 Vali Acc: 0.848 Test Loss: 0.411 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.7205419540405273
Epoch: 12, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.372 Vali Acc: 0.877 Test Loss: 0.372 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 13 cost time: 2.7166006565093994
Epoch: 13, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.403 Vali Acc: 0.877 Test Loss: 0.403 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.7206552028656006
Epoch: 14, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.381 Vali Acc: 0.899 Test Loss: 0.381 Test Acc: 0.899
Validation loss decreased (-0.876808 --> -0.898547).  Saving model ...
Epoch: 15 cost time: 2.7267727851867676
Epoch: 15, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.428 Vali Acc: 0.862 Test Loss: 0.428 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.6792304515838623
Epoch: 16, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.461 Vali Acc: 0.862 Test Loss: 0.461 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.7097017765045166
Epoch: 17, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.430 Vali Acc: 0.870 Test Loss: 0.430 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.712270975112915
Epoch: 18, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.429 Vali Acc: 0.877 Test Loss: 0.429 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.6598076820373535
Epoch: 19, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.385 Vali Acc: 0.906 Test Loss: 0.385 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905793).  Saving model ...
Epoch: 20 cost time: 2.710186719894409
Epoch: 20, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.336 Vali Acc: 0.913 Test Loss: 0.336 Test Acc: 0.913
Validation loss decreased (-0.905793 --> -0.913040).  Saving model ...
Epoch: 21 cost time: 2.8193883895874023
Epoch: 21, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.363 Vali Acc: 0.877 Test Loss: 0.363 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.5834226608276367
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.417 Vali Acc: 0.891 Test Loss: 0.417 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.6191091537475586
Epoch: 23, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.447 Vali Acc: 0.884 Test Loss: 0.447 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.646080732345581
Epoch: 24, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.456 Vali Acc: 0.884 Test Loss: 0.456 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.523477792739868
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.444 Vali Acc: 0.899 Test Loss: 0.444 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.599644422531128
Epoch: 26, Steps: 9 | Train Loss: 0.104 Vali Loss: 0.427 Vali Acc: 0.906 Test Loss: 0.427 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.712830066680908
Epoch: 27, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.407 Vali Acc: 0.913 Test Loss: 0.407 Test Acc: 0.913
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.639129400253296
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.408 Vali Acc: 0.884 Test Loss: 0.408 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.7343082427978516
Epoch: 29, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.402 Vali Acc: 0.891 Test Loss: 0.402 Test Acc: 0.891
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.7233359813690186
Epoch: 30, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.515 Vali Acc: 0.899 Test Loss: 0.515 Test Acc: 0.899
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 2807748
model size : 11.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.240561008453369
Epoch: 1, Steps: 9 | Train Loss: 1.358 Vali Loss: 1.295 Vali Acc: 0.355 Test Loss: 1.295 Test Acc: 0.355
Validation loss decreased (inf --> -0.355060).  Saving model ...
Epoch: 2 cost time: 3.5323996543884277
Epoch: 2, Steps: 9 | Train Loss: 1.110 Vali Loss: 1.044 Vali Acc: 0.514 Test Loss: 1.044 Test Acc: 0.514
Validation loss decreased (-0.355060 --> -0.514482).  Saving model ...
Epoch: 3 cost time: 3.2520267963409424
Epoch: 3, Steps: 9 | Train Loss: 0.806 Vali Loss: 0.858 Vali Acc: 0.623 Test Loss: 0.858 Test Acc: 0.623
Validation loss decreased (-0.514482 --> -0.623180).  Saving model ...
Epoch: 4 cost time: 3.347139835357666
Epoch: 4, Steps: 9 | Train Loss: 0.595 Vali Loss: 0.710 Vali Acc: 0.703 Test Loss: 0.710 Test Acc: 0.703
Validation loss decreased (-0.623180 --> -0.702891).  Saving model ...
Epoch: 5 cost time: 3.448429822921753
Epoch: 5, Steps: 9 | Train Loss: 0.419 Vali Loss: 0.564 Vali Acc: 0.768 Test Loss: 0.564 Test Acc: 0.768
Validation loss decreased (-0.702891 --> -0.768110).  Saving model ...
Epoch: 6 cost time: 3.5206525325775146
Epoch: 6, Steps: 9 | Train Loss: 0.297 Vali Loss: 0.591 Vali Acc: 0.725 Test Loss: 0.591 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.693962812423706
Epoch: 7, Steps: 9 | Train Loss: 0.183 Vali Loss: 0.591 Vali Acc: 0.754 Test Loss: 0.591 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.565464973449707
Epoch: 8, Steps: 9 | Train Loss: 0.099 Vali Loss: 0.608 Vali Acc: 0.761 Test Loss: 0.608 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.5298452377319336
Epoch: 9, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.517 Vali Acc: 0.797 Test Loss: 0.517 Test Acc: 0.797
Validation loss decreased (-0.768110 --> -0.797096).  Saving model ...
Epoch: 10 cost time: 3.6625285148620605
Epoch: 10, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.342 Vali Acc: 0.870 Test Loss: 0.342 Test Acc: 0.870
Validation loss decreased (-0.797096 --> -0.869562).  Saving model ...
Epoch: 11 cost time: 3.6144192218780518
Epoch: 11, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.458 Vali Acc: 0.841 Test Loss: 0.458 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.618743658065796
Epoch: 12, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.758 Vali Acc: 0.775 Test Loss: 0.758 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.6802077293395996
Epoch: 13, Steps: 9 | Train Loss: 0.112 Vali Loss: 0.852 Vali Acc: 0.761 Test Loss: 0.852 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.663813352584839
Epoch: 14, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.369 Vali Acc: 0.884 Test Loss: 0.369 Test Acc: 0.884
Validation loss decreased (-0.869562 --> -0.884054).  Saving model ...
Epoch: 15 cost time: 3.706794023513794
Epoch: 15, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.351 Vali Acc: 0.870 Test Loss: 0.351 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.389216899871826
Epoch: 16, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.455 Vali Acc: 0.862 Test Loss: 0.455 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.4333488941192627
Epoch: 17, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.545 Vali Acc: 0.819 Test Loss: 0.545 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.467262029647827
Epoch: 18, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.721 Vali Acc: 0.746 Test Loss: 0.721 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.673766613006592
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.784 Vali Acc: 0.746 Test Loss: 0.784 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.6265578269958496
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.816 Vali Acc: 0.739 Test Loss: 0.816 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.6871495246887207
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.831 Vali Acc: 0.732 Test Loss: 0.831 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.566478967666626
Epoch: 22, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.030 Vali Acc: 0.703 Test Loss: 1.030 Test Acc: 0.703
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.664884567260742
Epoch: 23, Steps: 9 | Train Loss: 0.007 Vali Loss: 1.430 Vali Acc: 0.688 Test Loss: 1.430 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.5124669075012207
Epoch: 24, Steps: 9 | Train Loss: 0.272 Vali Loss: 2.078 Vali Acc: 0.710 Test Loss: 2.078 Test Acc: 0.710
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 9427652
model size : 37.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.7206711769104004
Epoch: 1, Steps: 9 | Train Loss: 1.414 Vali Loss: 1.336 Vali Acc: 0.319 Test Loss: 1.336 Test Acc: 0.319
Validation loss decreased (inf --> -0.318827).  Saving model ...
Epoch: 2 cost time: 1.9855155944824219
Epoch: 2, Steps: 9 | Train Loss: 1.150 Vali Loss: 1.080 Vali Acc: 0.522 Test Loss: 1.080 Test Acc: 0.522
Validation loss decreased (-0.318827 --> -0.521728).  Saving model ...
Epoch: 3 cost time: 1.994755506515503
Epoch: 3, Steps: 9 | Train Loss: 0.849 Vali Loss: 0.823 Vali Acc: 0.652 Test Loss: 0.823 Test Acc: 0.652
Validation loss decreased (-0.521728 --> -0.652166).  Saving model ...
Epoch: 4 cost time: 2.0381367206573486
Epoch: 4, Steps: 9 | Train Loss: 0.599 Vali Loss: 0.668 Vali Acc: 0.739 Test Loss: 0.668 Test Acc: 0.739
Validation loss decreased (-0.652166 --> -0.739124).  Saving model ...
Epoch: 5 cost time: 1.9773681163787842
Epoch: 5, Steps: 9 | Train Loss: 0.417 Vali Loss: 0.548 Vali Acc: 0.790 Test Loss: 0.548 Test Acc: 0.790
Validation loss decreased (-0.739124 --> -0.789850).  Saving model ...
Epoch: 6 cost time: 2.0198733806610107
Epoch: 6, Steps: 9 | Train Loss: 0.260 Vali Loss: 0.465 Vali Acc: 0.819 Test Loss: 0.465 Test Acc: 0.819
Validation loss decreased (-0.789850 --> -0.818836).  Saving model ...
Epoch: 7 cost time: 1.9201738834381104
Epoch: 7, Steps: 9 | Train Loss: 0.145 Vali Loss: 0.479 Vali Acc: 0.826 Test Loss: 0.479 Test Acc: 0.826
Validation loss decreased (-0.818836 --> -0.826082).  Saving model ...
Epoch: 8 cost time: 1.94638991355896
Epoch: 8, Steps: 9 | Train Loss: 0.089 Vali Loss: 0.384 Vali Acc: 0.848 Test Loss: 0.384 Test Acc: 0.848
Validation loss decreased (-0.826082 --> -0.847822).  Saving model ...
Epoch: 9 cost time: 1.9305014610290527
Epoch: 9, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.410 Vali Acc: 0.855 Test Loss: 0.410 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855068).  Saving model ...
Epoch: 10 cost time: 1.896993637084961
Epoch: 10, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.483 Vali Acc: 0.812 Test Loss: 0.483 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8353164196014404
Epoch: 11, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.494 Vali Acc: 0.841 Test Loss: 0.494 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.084144353866577
Epoch: 12, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.377 Vali Acc: 0.870 Test Loss: 0.377 Test Acc: 0.870
Validation loss decreased (-0.855068 --> -0.869561).  Saving model ...
Epoch: 13 cost time: 1.9350218772888184
Epoch: 13, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.776 Vali Acc: 0.783 Test Loss: 0.776 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8577969074249268
Epoch: 14, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.433 Vali Acc: 0.877 Test Loss: 0.433 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876807).  Saving model ...
Epoch: 15 cost time: 2.056654453277588
Epoch: 15, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.392 Vali Acc: 0.877 Test Loss: 0.392 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876808).  Saving model ...
Epoch: 16 cost time: 1.9353694915771484
Epoch: 16, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.580 Vali Acc: 0.877 Test Loss: 0.580 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9875004291534424
Epoch: 17, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.505 Vali Acc: 0.855 Test Loss: 0.505 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.991913080215454
Epoch: 18, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.532 Vali Acc: 0.826 Test Loss: 0.532 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.9590981006622314
Epoch: 19, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.479 Vali Acc: 0.862 Test Loss: 0.479 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.9615135192871094
Epoch: 20, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.502 Vali Acc: 0.833 Test Loss: 0.502 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.0672805309295654
Epoch: 21, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.443 Vali Acc: 0.877 Test Loss: 0.443 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.9419920444488525
Epoch: 22, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.455 Vali Acc: 0.855 Test Loss: 0.455 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.9890389442443848
Epoch: 23, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.462 Vali Acc: 0.877 Test Loss: 0.462 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.9611046314239502
Epoch: 24, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.520 Vali Acc: 0.870 Test Loss: 0.520 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.9940457344055176
Epoch: 25, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.467 Vali Acc: 0.877 Test Loss: 0.467 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 2807748
model size : 11.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 6.406207799911499
Epoch: 1, Steps: 9 | Train Loss: 1.314 Vali Loss: 1.198 Vali Acc: 0.486 Test Loss: 1.198 Test Acc: 0.486
Validation loss decreased (inf --> -0.485495).  Saving model ...
Epoch: 2 cost time: 4.694314956665039
Epoch: 2, Steps: 9 | Train Loss: 1.040 Vali Loss: 0.910 Vali Acc: 0.645 Test Loss: 0.910 Test Acc: 0.645
Validation loss decreased (-0.485495 --> -0.644918).  Saving model ...
Epoch: 3 cost time: 4.501269340515137
Epoch: 3, Steps: 9 | Train Loss: 0.680 Vali Loss: 0.646 Vali Acc: 0.761 Test Loss: 0.646 Test Acc: 0.761
Validation loss decreased (-0.644918 --> -0.760863).  Saving model ...
Epoch: 4 cost time: 4.71248197555542
Epoch: 4, Steps: 9 | Train Loss: 0.419 Vali Loss: 0.465 Vali Acc: 0.833 Test Loss: 0.465 Test Acc: 0.833
Validation loss decreased (-0.760863 --> -0.833329).  Saving model ...
Epoch: 5 cost time: 4.734353065490723
Epoch: 5, Steps: 9 | Train Loss: 0.328 Vali Loss: 0.444 Vali Acc: 0.848 Test Loss: 0.444 Test Acc: 0.848
Validation loss decreased (-0.833329 --> -0.847822).  Saving model ...
Epoch: 6 cost time: 4.733643054962158
Epoch: 6, Steps: 9 | Train Loss: 0.186 Vali Loss: 0.440 Vali Acc: 0.819 Test Loss: 0.440 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.786526679992676
Epoch: 7, Steps: 9 | Train Loss: 0.157 Vali Loss: 0.337 Vali Acc: 0.855 Test Loss: 0.337 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855069).  Saving model ...
Epoch: 8 cost time: 4.747038125991821
Epoch: 8, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.517 Vali Acc: 0.804 Test Loss: 0.517 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.670661687850952
Epoch: 9, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.363 Vali Acc: 0.870 Test Loss: 0.363 Test Acc: 0.870
Validation loss decreased (-0.855069 --> -0.869562).  Saving model ...
Epoch: 10 cost time: 4.758307456970215
Epoch: 10, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.324 Vali Acc: 0.891 Test Loss: 0.324 Test Acc: 0.891
Validation loss decreased (-0.869562 --> -0.891301).  Saving model ...
Epoch: 11 cost time: 4.896477699279785
Epoch: 11, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.494 Vali Acc: 0.833 Test Loss: 0.494 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.885926961898804
Epoch: 12, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.443 Vali Acc: 0.862 Test Loss: 0.443 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.669249773025513
Epoch: 13, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.461 Vali Acc: 0.841 Test Loss: 0.461 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.86735463142395
Epoch: 14, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.491 Vali Acc: 0.848 Test Loss: 0.491 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.765814542770386
Epoch: 15, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.368 Vali Acc: 0.891 Test Loss: 0.368 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.935950994491577
Epoch: 16, Steps: 9 | Train Loss: 0.080 Vali Loss: 0.416 Vali Acc: 0.899 Test Loss: 0.416 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898547).  Saving model ...
Epoch: 17 cost time: 4.957235336303711
Epoch: 17, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.439 Vali Acc: 0.877 Test Loss: 0.439 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.754279851913452
Epoch: 18, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.450 Vali Acc: 0.870 Test Loss: 0.450 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.82628059387207
Epoch: 19, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.401 Vali Acc: 0.884 Test Loss: 0.401 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.765892505645752
Epoch: 20, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.404 Vali Acc: 0.891 Test Loss: 0.404 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 4.764750003814697
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.420 Vali Acc: 0.891 Test Loss: 0.420 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 4.819465398788452
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.421 Vali Acc: 0.891 Test Loss: 0.421 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 4.771137475967407
Epoch: 23, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.432 Vali Acc: 0.884 Test Loss: 0.432 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 4.539961099624634
Epoch: 24, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.448 Vali Acc: 0.884 Test Loss: 0.448 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 4.740039825439453
Epoch: 25, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.537 Vali Acc: 0.855 Test Loss: 0.537 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 4.702394962310791
Epoch: 26, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.503 Vali Acc: 0.855 Test Loss: 0.503 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 4741060
model size : 19.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.113510847091675
Epoch: 1, Steps: 9 | Train Loss: 1.438 Vali Loss: 1.290 Vali Acc: 0.348 Test Loss: 1.290 Test Acc: 0.348
Validation loss decreased (inf --> -0.347813).  Saving model ...
Epoch: 2 cost time: 2.377244234085083
Epoch: 2, Steps: 9 | Train Loss: 1.107 Vali Loss: 0.961 Vali Acc: 0.587 Test Loss: 0.961 Test Acc: 0.587
Validation loss decreased (-0.347813 --> -0.586947).  Saving model ...
Epoch: 3 cost time: 2.29267954826355
Epoch: 3, Steps: 9 | Train Loss: 0.717 Vali Loss: 0.725 Vali Acc: 0.696 Test Loss: 0.725 Test Acc: 0.696
Validation loss decreased (-0.586947 --> -0.695645).  Saving model ...
Epoch: 4 cost time: 2.5425899028778076
Epoch: 4, Steps: 9 | Train Loss: 0.482 Vali Loss: 0.496 Vali Acc: 0.819 Test Loss: 0.496 Test Acc: 0.819
Validation loss decreased (-0.695645 --> -0.818836).  Saving model ...
Epoch: 5 cost time: 2.53470516204834
Epoch: 5, Steps: 9 | Train Loss: 0.285 Vali Loss: 0.474 Vali Acc: 0.804 Test Loss: 0.474 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.450321912765503
Epoch: 6, Steps: 9 | Train Loss: 0.207 Vali Loss: 0.398 Vali Acc: 0.855 Test Loss: 0.398 Test Acc: 0.855
Validation loss decreased (-0.818836 --> -0.855068).  Saving model ...
Epoch: 7 cost time: 2.5813426971435547
Epoch: 7, Steps: 9 | Train Loss: 0.136 Vali Loss: 0.436 Vali Acc: 0.848 Test Loss: 0.436 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.421398639678955
Epoch: 8, Steps: 9 | Train Loss: 0.104 Vali Loss: 0.458 Vali Acc: 0.819 Test Loss: 0.458 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.531665563583374
Epoch: 9, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.463 Vali Acc: 0.841 Test Loss: 0.463 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.5097222328186035
Epoch: 10, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.427 Vali Acc: 0.848 Test Loss: 0.427 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.437302589416504
Epoch: 11, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.427 Vali Acc: 0.870 Test Loss: 0.427 Test Acc: 0.870
Validation loss decreased (-0.855068 --> -0.869561).  Saving model ...
Epoch: 12 cost time: 2.4690096378326416
Epoch: 12, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.462 Vali Acc: 0.848 Test Loss: 0.462 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.486290216445923
Epoch: 13, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.473 Vali Acc: 0.841 Test Loss: 0.473 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.44616961479187
Epoch: 14, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.459 Vali Acc: 0.841 Test Loss: 0.459 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.464951276779175
Epoch: 15, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.371 Vali Acc: 0.891 Test Loss: 0.371 Test Acc: 0.891
Validation loss decreased (-0.869561 --> -0.891301).  Saving model ...
Epoch: 16 cost time: 2.5737388134002686
Epoch: 16, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.387 Vali Acc: 0.891 Test Loss: 0.387 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.4630446434020996
Epoch: 17, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.428 Vali Acc: 0.899 Test Loss: 0.428 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898546).  Saving model ...
Epoch: 18 cost time: 2.478257656097412
Epoch: 18, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.461 Vali Acc: 0.855 Test Loss: 0.461 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.51393985748291
Epoch: 19, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.438 Vali Acc: 0.855 Test Loss: 0.438 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.45522403717041
Epoch: 20, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.413 Vali Acc: 0.891 Test Loss: 0.413 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.5370445251464844
Epoch: 21, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.460 Vali Acc: 0.877 Test Loss: 0.460 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.474381923675537
Epoch: 22, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.515 Vali Acc: 0.855 Test Loss: 0.515 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.4976487159729004
Epoch: 23, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.469 Vali Acc: 0.884 Test Loss: 0.469 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.612200975418091
Epoch: 24, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.502 Vali Acc: 0.870 Test Loss: 0.502 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.4633636474609375
Epoch: 25, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.618 Vali Acc: 0.841 Test Loss: 0.618 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.417896032333374
Epoch: 26, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.554 Vali Acc: 0.870 Test Loss: 0.554 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.4772732257843018
Epoch: 27, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.526 Vali Acc: 0.891 Test Loss: 0.526 Test Acc: 0.891
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 1430980
model size : 6.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.488675117492676
Epoch: 1, Steps: 9 | Train Loss: 1.318 Vali Loss: 1.208 Vali Acc: 0.478 Test Loss: 1.208 Test Acc: 0.478
Validation loss decreased (inf --> -0.478249).  Saving model ...
Epoch: 2 cost time: 3.7396764755249023
Epoch: 2, Steps: 9 | Train Loss: 1.057 Vali Loss: 0.945 Vali Acc: 0.630 Test Loss: 0.945 Test Acc: 0.630
Validation loss decreased (-0.478249 --> -0.630425).  Saving model ...
Epoch: 3 cost time: 3.750272035598755
Epoch: 3, Steps: 9 | Train Loss: 0.745 Vali Loss: 0.703 Vali Acc: 0.703 Test Loss: 0.703 Test Acc: 0.703
Validation loss decreased (-0.630425 --> -0.702892).  Saving model ...
Epoch: 4 cost time: 3.837230920791626
Epoch: 4, Steps: 9 | Train Loss: 0.523 Vali Loss: 0.505 Vali Acc: 0.819 Test Loss: 0.505 Test Acc: 0.819
Validation loss decreased (-0.702892 --> -0.818836).  Saving model ...
Epoch: 5 cost time: 3.71356463432312
Epoch: 5, Steps: 9 | Train Loss: 0.381 Vali Loss: 0.482 Vali Acc: 0.797 Test Loss: 0.482 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.6806507110595703
Epoch: 6, Steps: 9 | Train Loss: 0.220 Vali Loss: 0.447 Vali Acc: 0.797 Test Loss: 0.447 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.6844289302825928
Epoch: 7, Steps: 9 | Train Loss: 0.158 Vali Loss: 0.378 Vali Acc: 0.833 Test Loss: 0.378 Test Acc: 0.833
Validation loss decreased (-0.818836 --> -0.833330).  Saving model ...
Epoch: 8 cost time: 3.6909303665161133
Epoch: 8, Steps: 9 | Train Loss: 0.087 Vali Loss: 0.479 Vali Acc: 0.797 Test Loss: 0.479 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.961653470993042
Epoch: 9, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.390 Vali Acc: 0.870 Test Loss: 0.390 Test Acc: 0.870
Validation loss decreased (-0.833330 --> -0.869561).  Saving model ...
Epoch: 10 cost time: 3.8885304927825928
Epoch: 10, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.431 Vali Acc: 0.848 Test Loss: 0.431 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.8791539669036865
Epoch: 11, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.438 Vali Acc: 0.855 Test Loss: 0.438 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.816755533218384
Epoch: 12, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.380 Vali Acc: 0.877 Test Loss: 0.380 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876808).  Saving model ...
Epoch: 13 cost time: 3.850593328475952
Epoch: 13, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.462 Vali Acc: 0.877 Test Loss: 0.462 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.842348098754883
Epoch: 14, Steps: 9 | Train Loss: 0.622 Vali Loss: 0.492 Vali Acc: 0.862 Test Loss: 0.492 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.9054529666900635
Epoch: 15, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.421 Vali Acc: 0.870 Test Loss: 0.421 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.8287911415100098
Epoch: 16, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.357 Vali Acc: 0.891 Test Loss: 0.357 Test Acc: 0.891
Validation loss decreased (-0.876808 --> -0.891301).  Saving model ...
Epoch: 17 cost time: 3.9564969539642334
Epoch: 17, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.409 Vali Acc: 0.891 Test Loss: 0.409 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.9264731407165527
Epoch: 18, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.452 Vali Acc: 0.877 Test Loss: 0.452 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.921656847000122
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.463 Vali Acc: 0.870 Test Loss: 0.463 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.034788370132446
Epoch: 20, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.413 Vali Acc: 0.891 Test Loss: 0.413 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.95098876953125
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.394 Vali Acc: 0.906 Test Loss: 0.394 Test Acc: 0.906
Validation loss decreased (-0.891301 --> -0.905793).  Saving model ...
Epoch: 22 cost time: 3.926884174346924
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.406 Vali Acc: 0.906 Test Loss: 0.406 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.939979076385498
Epoch: 23, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.580 Vali Acc: 0.862 Test Loss: 0.580 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.931124448776245
Epoch: 24, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.588 Vali Acc: 0.855 Test Loss: 0.588 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.938676118850708
Epoch: 25, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.580 Vali Acc: 0.855 Test Loss: 0.580 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.9585824012756348
Epoch: 26, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.580 Vali Acc: 0.870 Test Loss: 0.580 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.967867374420166
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.624 Vali Acc: 0.870 Test Loss: 0.624 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.9971296787261963
Epoch: 28, Steps: 9 | Train Loss: 0.122 Vali Loss: 0.554 Vali Acc: 0.884 Test Loss: 0.554 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.9341249465942383
Epoch: 29, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.727 Vali Acc: 0.848 Test Loss: 0.727 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.8878097534179688
Epoch: 30, Steps: 9 | Train Loss: 0.159 Vali Loss: 0.659 Vali Acc: 0.870 Test Loss: 0.659 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 4741060
model size : 19.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.8032381534576416
Epoch: 1, Steps: 9 | Train Loss: 1.426 Vali Loss: 1.299 Vali Acc: 0.341 Test Loss: 1.299 Test Acc: 0.341
Validation loss decreased (inf --> -0.340567).  Saving model ...
Epoch: 2 cost time: 2.125204086303711
Epoch: 2, Steps: 9 | Train Loss: 1.123 Vali Loss: 0.992 Vali Acc: 0.565 Test Loss: 0.992 Test Acc: 0.565
Validation loss decreased (-0.340567 --> -0.565207).  Saving model ...
Epoch: 3 cost time: 2.1062541007995605
Epoch: 3, Steps: 9 | Train Loss: 0.748 Vali Loss: 0.769 Vali Acc: 0.645 Test Loss: 0.769 Test Acc: 0.645
Validation loss decreased (-0.565207 --> -0.644920).  Saving model ...
Epoch: 4 cost time: 2.1673829555511475
Epoch: 4, Steps: 9 | Train Loss: 0.507 Vali Loss: 0.526 Vali Acc: 0.826 Test Loss: 0.526 Test Acc: 0.826
Validation loss decreased (-0.644920 --> -0.826082).  Saving model ...
Epoch: 5 cost time: 2.1842589378356934
Epoch: 5, Steps: 9 | Train Loss: 0.336 Vali Loss: 0.481 Vali Acc: 0.790 Test Loss: 0.481 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.133549213409424
Epoch: 6, Steps: 9 | Train Loss: 0.251 Vali Loss: 0.377 Vali Acc: 0.870 Test Loss: 0.377 Test Acc: 0.870
Validation loss decreased (-0.826082 --> -0.869561).  Saving model ...
Epoch: 7 cost time: 2.1182708740234375
Epoch: 7, Steps: 9 | Train Loss: 0.156 Vali Loss: 0.407 Vali Acc: 0.841 Test Loss: 0.407 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.1581835746765137
Epoch: 8, Steps: 9 | Train Loss: 0.117 Vali Loss: 0.388 Vali Acc: 0.848 Test Loss: 0.388 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.021249532699585
Epoch: 9, Steps: 9 | Train Loss: 0.108 Vali Loss: 0.410 Vali Acc: 0.848 Test Loss: 0.410 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.037898540496826
Epoch: 10, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.422 Vali Acc: 0.862 Test Loss: 0.422 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.1165928840637207
Epoch: 11, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.459 Vali Acc: 0.855 Test Loss: 0.459 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.0510025024414062
Epoch: 12, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.503 Vali Acc: 0.848 Test Loss: 0.503 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.9210257530212402
Epoch: 13, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.474 Vali Acc: 0.848 Test Loss: 0.474 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.0288543701171875
Epoch: 14, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.421 Vali Acc: 0.870 Test Loss: 0.421 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.9306015968322754
Epoch: 15, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.430 Vali Acc: 0.855 Test Loss: 0.430 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.0260396003723145
Epoch: 16, Steps: 9 | Train Loss: 0.182 Vali Loss: 0.485 Vali Acc: 0.862 Test Loss: 0.485 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 1430980
model size : 6.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.8414087295532227
Epoch: 1, Steps: 9 | Train Loss: 1.314 Vali Loss: 1.220 Vali Acc: 0.449 Test Loss: 1.220 Test Acc: 0.449
Validation loss decreased (inf --> -0.449263).  Saving model ...
Epoch: 2 cost time: 2.3799540996551514
Epoch: 2, Steps: 9 | Train Loss: 1.077 Vali Loss: 1.005 Vali Acc: 0.580 Test Loss: 1.005 Test Acc: 0.580
Validation loss decreased (-0.449263 --> -0.579700).  Saving model ...
Epoch: 3 cost time: 2.5113022327423096
Epoch: 3, Steps: 9 | Train Loss: 0.785 Vali Loss: 0.842 Vali Acc: 0.638 Test Loss: 0.842 Test Acc: 0.638
Validation loss decreased (-0.579700 --> -0.637673).  Saving model ...
Epoch: 4 cost time: 2.35331654548645
Epoch: 4, Steps: 9 | Train Loss: 0.559 Vali Loss: 0.694 Vali Acc: 0.725 Test Loss: 0.694 Test Acc: 0.725
Validation loss decreased (-0.637673 --> -0.724631).  Saving model ...
Epoch: 5 cost time: 2.3435957431793213
Epoch: 5, Steps: 9 | Train Loss: 0.417 Vali Loss: 0.592 Vali Acc: 0.761 Test Loss: 0.592 Test Acc: 0.761
Validation loss decreased (-0.724631 --> -0.760864).  Saving model ...
Epoch: 6 cost time: 2.3250105381011963
Epoch: 6, Steps: 9 | Train Loss: 0.257 Vali Loss: 0.537 Vali Acc: 0.768 Test Loss: 0.537 Test Acc: 0.768
Validation loss decreased (-0.760864 --> -0.768111).  Saving model ...
Epoch: 7 cost time: 2.394493579864502
Epoch: 7, Steps: 9 | Train Loss: 0.170 Vali Loss: 0.436 Vali Acc: 0.819 Test Loss: 0.436 Test Acc: 0.819
Validation loss decreased (-0.768111 --> -0.818836).  Saving model ...
Epoch: 8 cost time: 2.3965251445770264
Epoch: 8, Steps: 9 | Train Loss: 0.099 Vali Loss: 0.488 Vali Acc: 0.819 Test Loss: 0.488 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.4357669353485107
Epoch: 9, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.527 Vali Acc: 0.819 Test Loss: 0.527 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.3968307971954346
Epoch: 10, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.563 Vali Acc: 0.819 Test Loss: 0.563 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.403172492980957
Epoch: 11, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.541 Vali Acc: 0.826 Test Loss: 0.541 Test Acc: 0.826
Validation loss decreased (-0.818836 --> -0.826082).  Saving model ...
Epoch: 12 cost time: 2.42158842086792
Epoch: 12, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.530 Vali Acc: 0.833 Test Loss: 0.530 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833328).  Saving model ...
Epoch: 13 cost time: 2.516650438308716
Epoch: 13, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.639 Vali Acc: 0.804 Test Loss: 0.639 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.4910900592803955
Epoch: 14, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.564 Vali Acc: 0.804 Test Loss: 0.564 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.4320168495178223
Epoch: 15, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.494 Vali Acc: 0.841 Test Loss: 0.494 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840575).  Saving model ...
Epoch: 16 cost time: 2.5015463829040527
Epoch: 16, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.539 Vali Acc: 0.841 Test Loss: 0.539 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.4640767574310303
Epoch: 17, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.553 Vali Acc: 0.848 Test Loss: 0.553 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847821).  Saving model ...
Epoch: 18 cost time: 2.5485355854034424
Epoch: 18, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.416 Vali Acc: 0.899 Test Loss: 0.416 Test Acc: 0.899
Validation loss decreased (-0.847821 --> -0.898547).  Saving model ...
Epoch: 19 cost time: 2.542938470840454
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.406 Vali Acc: 0.906 Test Loss: 0.406 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905793).  Saving model ...
Epoch: 20 cost time: 2.5505363941192627
Epoch: 20, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.445 Vali Acc: 0.899 Test Loss: 0.445 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.5491976737976074
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.475 Vali Acc: 0.884 Test Loss: 0.475 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.6535181999206543
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.467 Vali Acc: 0.884 Test Loss: 0.467 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.571655750274658
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.446 Vali Acc: 0.899 Test Loss: 0.446 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.546220064163208
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.450 Vali Acc: 0.899 Test Loss: 0.450 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.586672782897949
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.457 Vali Acc: 0.899 Test Loss: 0.457 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.604418992996216
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.467 Vali Acc: 0.899 Test Loss: 0.467 Test Acc: 0.899
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.5426058769226074
Epoch: 27, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.462 Vali Acc: 0.899 Test Loss: 0.462 Test Acc: 0.899
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.367595672607422
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.463 Vali Acc: 0.891 Test Loss: 0.463 Test Acc: 0.891
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.5346193313598633
Epoch: 29, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.484 Vali Acc: 0.899 Test Loss: 0.484 Test Acc: 0.899
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 4741060
model size : 19.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.9459686279296875
Epoch: 1, Steps: 9 | Train Loss: 1.410 Vali Loss: 1.311 Vali Acc: 0.348 Test Loss: 1.311 Test Acc: 0.348
Validation loss decreased (inf --> -0.347813).  Saving model ...
Epoch: 2 cost time: 1.4713211059570312
Epoch: 2, Steps: 9 | Train Loss: 1.128 Vali Loss: 1.060 Vali Acc: 0.500 Test Loss: 1.060 Test Acc: 0.500
Validation loss decreased (-0.347813 --> -0.499989).  Saving model ...
Epoch: 3 cost time: 1.4937264919281006
Epoch: 3, Steps: 9 | Train Loss: 0.783 Vali Loss: 0.882 Vali Acc: 0.601 Test Loss: 0.882 Test Acc: 0.601
Validation loss decreased (-0.499989 --> -0.601440).  Saving model ...
Epoch: 4 cost time: 1.5114789009094238
Epoch: 4, Steps: 9 | Train Loss: 0.566 Vali Loss: 0.696 Vali Acc: 0.696 Test Loss: 0.696 Test Acc: 0.696
Validation loss decreased (-0.601440 --> -0.695645).  Saving model ...
Epoch: 5 cost time: 1.5156848430633545
Epoch: 5, Steps: 9 | Train Loss: 0.373 Vali Loss: 0.602 Vali Acc: 0.739 Test Loss: 0.602 Test Acc: 0.739
Validation loss decreased (-0.695645 --> -0.739124).  Saving model ...
Epoch: 6 cost time: 1.4944186210632324
Epoch: 6, Steps: 9 | Train Loss: 0.288 Vali Loss: 0.503 Vali Acc: 0.812 Test Loss: 0.503 Test Acc: 0.812
Validation loss decreased (-0.739124 --> -0.811589).  Saving model ...
Epoch: 7 cost time: 1.503753662109375
Epoch: 7, Steps: 9 | Train Loss: 0.149 Vali Loss: 0.483 Vali Acc: 0.819 Test Loss: 0.483 Test Acc: 0.819
Validation loss decreased (-0.811589 --> -0.818836).  Saving model ...
Epoch: 8 cost time: 1.549259901046753
Epoch: 8, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.452 Vali Acc: 0.819 Test Loss: 0.452 Test Acc: 0.819
Validation loss decreased (-0.818836 --> -0.818836).  Saving model ...
Epoch: 9 cost time: 1.5633354187011719
Epoch: 9, Steps: 9 | Train Loss: 0.179 Vali Loss: 0.529 Vali Acc: 0.812 Test Loss: 0.529 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4593892097473145
Epoch: 10, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.449 Vali Acc: 0.862 Test Loss: 0.449 Test Acc: 0.862
Validation loss decreased (-0.818836 --> -0.862314).  Saving model ...
Epoch: 11 cost time: 1.455878496170044
Epoch: 11, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.490 Vali Acc: 0.855 Test Loss: 0.490 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.500389814376831
Epoch: 12, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.496 Vali Acc: 0.841 Test Loss: 0.496 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4858405590057373
Epoch: 13, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.508 Vali Acc: 0.848 Test Loss: 0.508 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5350642204284668
Epoch: 14, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.464 Vali Acc: 0.855 Test Loss: 0.464 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.4718117713928223
Epoch: 15, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.479 Vali Acc: 0.826 Test Loss: 0.479 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.5439696311950684
Epoch: 16, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.574 Vali Acc: 0.826 Test Loss: 0.574 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.4678888320922852
Epoch: 17, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.629 Vali Acc: 0.833 Test Loss: 0.629 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.4671380519866943
Epoch: 18, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.550 Vali Acc: 0.841 Test Loss: 0.550 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.4571290016174316
Epoch: 19, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.518 Vali Acc: 0.855 Test Loss: 0.518 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.508662462234497
Epoch: 20, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.528 Vali Acc: 0.833 Test Loss: 0.528 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 1430980
model size : 6.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 6.883374214172363
Epoch: 1, Steps: 9 | Train Loss: 1.415 Vali Loss: 1.333 Vali Acc: 0.420 Test Loss: 1.333 Test Acc: 0.420
Validation loss decreased (inf --> -0.420277).  Saving model ...
Epoch: 2 cost time: 4.952317237854004
Epoch: 2, Steps: 9 | Train Loss: 1.162 Vali Loss: 1.074 Vali Acc: 0.638 Test Loss: 1.074 Test Acc: 0.638
Validation loss decreased (-0.420277 --> -0.637670).  Saving model ...
Epoch: 3 cost time: 4.944941997528076
Epoch: 3, Steps: 9 | Train Loss: 0.907 Vali Loss: 0.793 Vali Acc: 0.732 Test Loss: 0.793 Test Acc: 0.732
Validation loss decreased (-0.637670 --> -0.731876).  Saving model ...
Epoch: 4 cost time: 4.9414026737213135
Epoch: 4, Steps: 9 | Train Loss: 0.656 Vali Loss: 0.583 Vali Acc: 0.775 Test Loss: 0.583 Test Acc: 0.775
Validation loss decreased (-0.731876 --> -0.775356).  Saving model ...
Epoch: 5 cost time: 5.061603784561157
Epoch: 5, Steps: 9 | Train Loss: 0.474 Vali Loss: 0.462 Vali Acc: 0.841 Test Loss: 0.462 Test Acc: 0.841
Validation loss decreased (-0.775356 --> -0.840575).  Saving model ...
Epoch: 6 cost time: 4.9860520362854
Epoch: 6, Steps: 9 | Train Loss: 0.329 Vali Loss: 0.440 Vali Acc: 0.797 Test Loss: 0.440 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.101014137268066
Epoch: 7, Steps: 9 | Train Loss: 0.241 Vali Loss: 0.454 Vali Acc: 0.819 Test Loss: 0.454 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.026116371154785
Epoch: 8, Steps: 9 | Train Loss: 0.409 Vali Loss: 0.456 Vali Acc: 0.819 Test Loss: 0.456 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.66051983833313
Epoch: 9, Steps: 9 | Train Loss: 0.099 Vali Loss: 0.410 Vali Acc: 0.833 Test Loss: 0.410 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.3529534339904785
Epoch: 10, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.345 Vali Acc: 0.862 Test Loss: 0.345 Test Acc: 0.862
Validation loss decreased (-0.840575 --> -0.862315).  Saving model ...
Epoch: 11 cost time: 5.149965286254883
Epoch: 11, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.456 Vali Acc: 0.870 Test Loss: 0.456 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869561).  Saving model ...
Epoch: 12 cost time: 5.01413369178772
Epoch: 12, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.463 Vali Acc: 0.870 Test Loss: 0.463 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.042797565460205
Epoch: 13, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.414 Vali Acc: 0.862 Test Loss: 0.414 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.090761184692383
Epoch: 14, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.315 Vali Acc: 0.906 Test Loss: 0.315 Test Acc: 0.906
Validation loss decreased (-0.869561 --> -0.905794).  Saving model ...
Epoch: 15 cost time: 5.079171419143677
Epoch: 15, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.356 Vali Acc: 0.899 Test Loss: 0.356 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.018762826919556
Epoch: 16, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.350 Vali Acc: 0.899 Test Loss: 0.350 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.106354475021362
Epoch: 17, Steps: 9 | Train Loss: 0.305 Vali Loss: 0.320 Vali Acc: 0.913 Test Loss: 0.320 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913040).  Saving model ...
Epoch: 18 cost time: 5.068293571472168
Epoch: 18, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.364 Vali Acc: 0.906 Test Loss: 0.364 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.095403671264648
Epoch: 19, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.355 Vali Acc: 0.913 Test Loss: 0.355 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.984118938446045
Epoch: 20, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.320 Vali Acc: 0.920 Test Loss: 0.320 Test Acc: 0.920
Validation loss decreased (-0.913040 --> -0.920287).  Saving model ...
Epoch: 21 cost time: 5.040525913238525
Epoch: 21, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.341 Vali Acc: 0.906 Test Loss: 0.341 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.003150701522827
Epoch: 22, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.426 Vali Acc: 0.906 Test Loss: 0.426 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.070743799209595
Epoch: 23, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.417 Vali Acc: 0.906 Test Loss: 0.417 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 5.2200398445129395
Epoch: 24, Steps: 9 | Train Loss: 0.143 Vali Loss: 0.385 Vali Acc: 0.891 Test Loss: 0.385 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 4.953054428100586
Epoch: 25, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.682 Vali Acc: 0.862 Test Loss: 0.682 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.828864812850952
Epoch: 26, Steps: 9 | Train Loss: 0.410 Vali Loss: 0.429 Vali Acc: 0.877 Test Loss: 0.429 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 4.886817932128906
Epoch: 27, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.630 Vali Acc: 0.848 Test Loss: 0.630 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 4.687469720840454
Epoch: 28, Steps: 9 | Train Loss: 0.208 Vali Loss: 0.553 Vali Acc: 0.877 Test Loss: 0.553 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 4.7289392948150635
Epoch: 29, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.552 Vali Acc: 0.855 Test Loss: 0.552 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 4.81941032409668
Epoch: 30, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.305 Vali Acc: 0.913 Test Loss: 0.305 Test Acc: 0.913
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 4714596
model size : 18.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.277055501937866
Epoch: 1, Steps: 9 | Train Loss: 1.351 Vali Loss: 1.281 Vali Acc: 0.457 Test Loss: 1.281 Test Acc: 0.457
Validation loss decreased (inf --> -0.456509).  Saving model ...
Epoch: 2 cost time: 2.6427369117736816
Epoch: 2, Steps: 9 | Train Loss: 1.154 Vali Loss: 1.068 Vali Acc: 0.609 Test Loss: 1.068 Test Acc: 0.609
Validation loss decreased (-0.456509 --> -0.608685).  Saving model ...
Epoch: 3 cost time: 2.5931289196014404
Epoch: 3, Steps: 9 | Train Loss: 0.865 Vali Loss: 0.835 Vali Acc: 0.696 Test Loss: 0.835 Test Acc: 0.696
Validation loss decreased (-0.608685 --> -0.695644).  Saving model ...
Epoch: 4 cost time: 2.554661989212036
Epoch: 4, Steps: 9 | Train Loss: 0.647 Vali Loss: 0.632 Vali Acc: 0.754 Test Loss: 0.632 Test Acc: 0.754
Validation loss decreased (-0.695644 --> -0.753617).  Saving model ...
Epoch: 5 cost time: 2.593829870223999
Epoch: 5, Steps: 9 | Train Loss: 0.439 Vali Loss: 0.490 Vali Acc: 0.804 Test Loss: 0.490 Test Acc: 0.804
Validation loss decreased (-0.753617 --> -0.804343).  Saving model ...
Epoch: 6 cost time: 2.5990872383117676
Epoch: 6, Steps: 9 | Train Loss: 0.298 Vali Loss: 0.424 Vali Acc: 0.841 Test Loss: 0.424 Test Acc: 0.841
Validation loss decreased (-0.804343 --> -0.840575).  Saving model ...
Epoch: 7 cost time: 2.591501235961914
Epoch: 7, Steps: 9 | Train Loss: 0.239 Vali Loss: 0.437 Vali Acc: 0.841 Test Loss: 0.437 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.6118102073669434
Epoch: 8, Steps: 9 | Train Loss: 0.203 Vali Loss: 0.368 Vali Acc: 0.884 Test Loss: 0.368 Test Acc: 0.884
Validation loss decreased (-0.840575 --> -0.884054).  Saving model ...
Epoch: 9 cost time: 2.7423553466796875
Epoch: 9, Steps: 9 | Train Loss: 0.117 Vali Loss: 0.411 Vali Acc: 0.862 Test Loss: 0.411 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.7083966732025146
Epoch: 10, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.446 Vali Acc: 0.855 Test Loss: 0.446 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.770451784133911
Epoch: 11, Steps: 9 | Train Loss: 0.261 Vali Loss: 0.389 Vali Acc: 0.884 Test Loss: 0.389 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.677338123321533
Epoch: 12, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.383 Vali Acc: 0.891 Test Loss: 0.383 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891301).  Saving model ...
Epoch: 13 cost time: 2.6212656497955322
Epoch: 13, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.381 Vali Acc: 0.884 Test Loss: 0.381 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.654906988143921
Epoch: 14, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.402 Vali Acc: 0.891 Test Loss: 0.402 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.8170201778411865
Epoch: 15, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.403 Vali Acc: 0.891 Test Loss: 0.403 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.7326858043670654
Epoch: 16, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.435 Vali Acc: 0.877 Test Loss: 0.435 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.742034435272217
Epoch: 17, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.401 Vali Acc: 0.884 Test Loss: 0.401 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.64841890335083
Epoch: 18, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.421 Vali Acc: 0.877 Test Loss: 0.421 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.6036570072174072
Epoch: 19, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.428 Vali Acc: 0.884 Test Loss: 0.428 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.7323431968688965
Epoch: 20, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.395 Vali Acc: 0.906 Test Loss: 0.395 Test Acc: 0.906
Validation loss decreased (-0.891301 --> -0.905793).  Saving model ...
Epoch: 21 cost time: 2.680586099624634
Epoch: 21, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.440 Vali Acc: 0.877 Test Loss: 0.440 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.6936843395233154
Epoch: 22, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.419 Vali Acc: 0.884 Test Loss: 0.419 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.7275936603546143
Epoch: 23, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.347 Vali Acc: 0.906 Test Loss: 0.347 Test Acc: 0.906
Validation loss decreased (-0.905793 --> -0.905794).  Saving model ...
Epoch: 24 cost time: 2.765866756439209
Epoch: 24, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.348 Vali Acc: 0.920 Test Loss: 0.348 Test Acc: 0.920
Validation loss decreased (-0.905794 --> -0.920286).  Saving model ...
Epoch: 25 cost time: 2.6526293754577637
Epoch: 25, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.446 Vali Acc: 0.891 Test Loss: 0.446 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.6897366046905518
Epoch: 26, Steps: 9 | Train Loss: 0.096 Vali Loss: 0.435 Vali Acc: 0.870 Test Loss: 0.435 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.7275826930999756
Epoch: 27, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.440 Vali Acc: 0.884 Test Loss: 0.440 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.7810258865356445
Epoch: 28, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.431 Vali Acc: 0.899 Test Loss: 0.431 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.7931723594665527
Epoch: 29, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.423 Vali Acc: 0.899 Test Loss: 0.423 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.739226818084717
Epoch: 30, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.423 Vali Acc: 0.884 Test Loss: 0.423 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 1404388
model size : 5.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.317480087280273
Epoch: 1, Steps: 9 | Train Loss: 1.414 Vali Loss: 1.336 Vali Acc: 0.435 Test Loss: 1.336 Test Acc: 0.435
Validation loss decreased (inf --> -0.434769).  Saving model ...
Epoch: 2 cost time: 3.687718152999878
Epoch: 2, Steps: 9 | Train Loss: 1.180 Vali Loss: 1.083 Vali Acc: 0.623 Test Loss: 1.083 Test Acc: 0.623
Validation loss decreased (-0.434769 --> -0.623178).  Saving model ...
Epoch: 3 cost time: 3.7647151947021484
Epoch: 3, Steps: 9 | Train Loss: 0.976 Vali Loss: 0.843 Vali Acc: 0.717 Test Loss: 0.843 Test Acc: 0.717
Validation loss decreased (-0.623178 --> -0.717383).  Saving model ...
Epoch: 4 cost time: 3.7284765243530273
Epoch: 4, Steps: 9 | Train Loss: 0.727 Vali Loss: 0.640 Vali Acc: 0.783 Test Loss: 0.640 Test Acc: 0.783
Validation loss decreased (-0.717383 --> -0.782602).  Saving model ...
Epoch: 5 cost time: 3.7581751346588135
Epoch: 5, Steps: 9 | Train Loss: 0.582 Vali Loss: 0.466 Vali Acc: 0.848 Test Loss: 0.466 Test Acc: 0.848
Validation loss decreased (-0.782602 --> -0.847821).  Saving model ...
Epoch: 6 cost time: 3.7977116107940674
Epoch: 6, Steps: 9 | Train Loss: 0.421 Vali Loss: 0.418 Vali Acc: 0.848 Test Loss: 0.418 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847822).  Saving model ...
Epoch: 7 cost time: 3.7985856533050537
Epoch: 7, Steps: 9 | Train Loss: 0.501 Vali Loss: 0.367 Vali Acc: 0.870 Test Loss: 0.367 Test Acc: 0.870
Validation loss decreased (-0.847822 --> -0.869562).  Saving model ...
Epoch: 8 cost time: 3.7452104091644287
Epoch: 8, Steps: 9 | Train Loss: 0.340 Vali Loss: 0.403 Vali Acc: 0.870 Test Loss: 0.403 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.7778656482696533
Epoch: 9, Steps: 9 | Train Loss: 0.183 Vali Loss: 0.419 Vali Acc: 0.855 Test Loss: 0.419 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.8271398544311523
Epoch: 10, Steps: 9 | Train Loss: 0.129 Vali Loss: 0.323 Vali Acc: 0.877 Test Loss: 0.323 Test Acc: 0.877
Validation loss decreased (-0.869562 --> -0.876808).  Saving model ...
Epoch: 11 cost time: 3.739680767059326
Epoch: 11, Steps: 9 | Train Loss: 0.142 Vali Loss: 0.393 Vali Acc: 0.884 Test Loss: 0.393 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884054).  Saving model ...
Epoch: 12 cost time: 3.782919406890869
Epoch: 12, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.359 Vali Acc: 0.891 Test Loss: 0.359 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891301).  Saving model ...
Epoch: 13 cost time: 3.7906975746154785
Epoch: 13, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.363 Vali Acc: 0.862 Test Loss: 0.363 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.818363904953003
Epoch: 14, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.303 Vali Acc: 0.899 Test Loss: 0.303 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898548).  Saving model ...
Epoch: 15 cost time: 3.7843024730682373
Epoch: 15, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.335 Vali Acc: 0.906 Test Loss: 0.335 Test Acc: 0.906
Validation loss decreased (-0.898548 --> -0.905794).  Saving model ...
Epoch: 16 cost time: 3.757657766342163
Epoch: 16, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.392 Vali Acc: 0.891 Test Loss: 0.392 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.7780539989471436
Epoch: 17, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.358 Vali Acc: 0.899 Test Loss: 0.358 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.767550468444824
Epoch: 18, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.312 Vali Acc: 0.899 Test Loss: 0.312 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.8072967529296875
Epoch: 19, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.310 Vali Acc: 0.899 Test Loss: 0.310 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.7959909439086914
Epoch: 20, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.314 Vali Acc: 0.891 Test Loss: 0.314 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.691016912460327
Epoch: 21, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.322 Vali Acc: 0.906 Test Loss: 0.322 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 22 cost time: 3.7142388820648193
Epoch: 22, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.323 Vali Acc: 0.913 Test Loss: 0.323 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913040).  Saving model ...
Epoch: 23 cost time: 3.7985613346099854
Epoch: 23, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.313 Vali Acc: 0.913 Test Loss: 0.313 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913040).  Saving model ...
Epoch: 24 cost time: 4.759703874588013
Epoch: 24, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.290 Vali Acc: 0.913 Test Loss: 0.290 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913041).  Saving model ...
Epoch: 25 cost time: 4.6642420291900635
Epoch: 25, Steps: 9 | Train Loss: 0.317 Vali Loss: 0.316 Vali Acc: 0.913 Test Loss: 0.316 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.602065324783325
Epoch: 26, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.737 Vali Acc: 0.804 Test Loss: 0.737 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 4.419462203979492
Epoch: 27, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.681 Vali Acc: 0.819 Test Loss: 0.681 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 4.60409140586853
Epoch: 28, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.479 Vali Acc: 0.877 Test Loss: 0.479 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 4.602497816085815
Epoch: 29, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.408 Vali Acc: 0.899 Test Loss: 0.408 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 4.511749982833862
Epoch: 30, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.350 Vali Acc: 0.899 Test Loss: 0.350 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 4714596
model size : 18.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.434616565704346
Epoch: 1, Steps: 9 | Train Loss: 1.349 Vali Loss: 1.276 Vali Acc: 0.478 Test Loss: 1.276 Test Acc: 0.478
Validation loss decreased (inf --> -0.478248).  Saving model ...
Epoch: 2 cost time: 2.544088125228882
Epoch: 2, Steps: 9 | Train Loss: 1.169 Vali Loss: 1.083 Vali Acc: 0.587 Test Loss: 1.083 Test Acc: 0.587
Validation loss decreased (-0.478248 --> -0.586946).  Saving model ...
Epoch: 3 cost time: 2.521212339401245
Epoch: 3, Steps: 9 | Train Loss: 0.910 Vali Loss: 0.872 Vali Acc: 0.659 Test Loss: 0.872 Test Acc: 0.659
Validation loss decreased (-0.586946 --> -0.659412).  Saving model ...
Epoch: 4 cost time: 2.5272443294525146
Epoch: 4, Steps: 9 | Train Loss: 0.715 Vali Loss: 0.670 Vali Acc: 0.725 Test Loss: 0.670 Test Acc: 0.725
Validation loss decreased (-0.659412 --> -0.724631).  Saving model ...
Epoch: 5 cost time: 2.551825761795044
Epoch: 5, Steps: 9 | Train Loss: 0.496 Vali Loss: 0.548 Vali Acc: 0.761 Test Loss: 0.548 Test Acc: 0.761
Validation loss decreased (-0.724631 --> -0.760864).  Saving model ...
Epoch: 6 cost time: 2.4788246154785156
Epoch: 6, Steps: 9 | Train Loss: 0.326 Vali Loss: 0.485 Vali Acc: 0.797 Test Loss: 0.485 Test Acc: 0.797
Validation loss decreased (-0.760864 --> -0.797097).  Saving model ...
Epoch: 7 cost time: 2.539487361907959
Epoch: 7, Steps: 9 | Train Loss: 0.235 Vali Loss: 0.565 Vali Acc: 0.804 Test Loss: 0.565 Test Acc: 0.804
Validation loss decreased (-0.797097 --> -0.804342).  Saving model ...
Epoch: 8 cost time: 2.323587417602539
Epoch: 8, Steps: 9 | Train Loss: 0.337 Vali Loss: 0.464 Vali Acc: 0.833 Test Loss: 0.464 Test Acc: 0.833
Validation loss decreased (-0.804342 --> -0.833329).  Saving model ...
Epoch: 9 cost time: 2.5395219326019287
Epoch: 9, Steps: 9 | Train Loss: 0.123 Vali Loss: 0.376 Vali Acc: 0.848 Test Loss: 0.376 Test Acc: 0.848
Validation loss decreased (-0.833329 --> -0.847822).  Saving model ...
Epoch: 10 cost time: 2.4517598152160645
Epoch: 10, Steps: 9 | Train Loss: 0.111 Vali Loss: 0.372 Vali Acc: 0.877 Test Loss: 0.372 Test Acc: 0.877
Validation loss decreased (-0.847822 --> -0.876808).  Saving model ...
Epoch: 11 cost time: 2.469388484954834
Epoch: 11, Steps: 9 | Train Loss: 0.080 Vali Loss: 0.367 Vali Acc: 0.862 Test Loss: 0.367 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.4633946418762207
Epoch: 12, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.383 Vali Acc: 0.877 Test Loss: 0.383 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.9634437561035156
Epoch: 13, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.377 Vali Acc: 0.891 Test Loss: 0.377 Test Acc: 0.891
Validation loss decreased (-0.876808 --> -0.891301).  Saving model ...
Epoch: 14 cost time: 2.4830355644226074
Epoch: 14, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.400 Vali Acc: 0.891 Test Loss: 0.400 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.378314971923828
Epoch: 15, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.363 Vali Acc: 0.891 Test Loss: 0.363 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 16 cost time: 2.380699872970581
Epoch: 16, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.438 Vali Acc: 0.870 Test Loss: 0.438 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.503716230392456
Epoch: 17, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.456 Vali Acc: 0.862 Test Loss: 0.456 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.837904691696167
Epoch: 18, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.468 Vali Acc: 0.855 Test Loss: 0.468 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.460948944091797
Epoch: 19, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.455 Vali Acc: 0.870 Test Loss: 0.455 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.45902681350708
Epoch: 20, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.444 Vali Acc: 0.870 Test Loss: 0.444 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.345773935317993
Epoch: 21, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.593 Vali Acc: 0.826 Test Loss: 0.593 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.3075830936431885
Epoch: 22, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.436 Vali Acc: 0.862 Test Loss: 0.436 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.3531553745269775
Epoch: 23, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.324 Vali Acc: 0.906 Test Loss: 0.324 Test Acc: 0.906
Validation loss decreased (-0.891301 --> -0.905794).  Saving model ...
Epoch: 24 cost time: 2.330294132232666
Epoch: 24, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.362 Vali Acc: 0.906 Test Loss: 0.362 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.1798272132873535
Epoch: 25, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.552 Vali Acc: 0.841 Test Loss: 0.552 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.333207845687866
Epoch: 26, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.483 Vali Acc: 0.848 Test Loss: 0.483 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.4004385471343994
Epoch: 27, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.455 Vali Acc: 0.884 Test Loss: 0.455 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.288163423538208
Epoch: 28, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.431 Vali Acc: 0.884 Test Loss: 0.431 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.9597785472869873
Epoch: 29, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.395 Vali Acc: 0.906 Test Loss: 0.395 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.282200574874878
Epoch: 30, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.384 Vali Acc: 0.913 Test Loss: 0.384 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913040).  Saving model ...
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 1404388
model size : 5.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.409923791885376
Epoch: 1, Steps: 9 | Train Loss: 1.414 Vali Loss: 1.342 Vali Acc: 0.428 Test Loss: 1.342 Test Acc: 0.428
Validation loss decreased (inf --> -0.427523).  Saving model ...
Epoch: 2 cost time: 3.018427610397339
Epoch: 2, Steps: 9 | Train Loss: 1.226 Vali Loss: 1.159 Vali Acc: 0.522 Test Loss: 1.159 Test Acc: 0.522
Validation loss decreased (-0.427523 --> -0.521728).  Saving model ...
Epoch: 3 cost time: 2.881992816925049
Epoch: 3, Steps: 9 | Train Loss: 1.051 Vali Loss: 0.991 Vali Acc: 0.587 Test Loss: 0.991 Test Acc: 0.587
Validation loss decreased (-0.521728 --> -0.586947).  Saving model ...
Epoch: 4 cost time: 2.68107008934021
Epoch: 4, Steps: 9 | Train Loss: 0.857 Vali Loss: 0.845 Vali Acc: 0.652 Test Loss: 0.845 Test Acc: 0.652
Validation loss decreased (-0.586947 --> -0.652165).  Saving model ...
Epoch: 5 cost time: 2.873900890350342
Epoch: 5, Steps: 9 | Train Loss: 0.685 Vali Loss: 0.690 Vali Acc: 0.754 Test Loss: 0.690 Test Acc: 0.754
Validation loss decreased (-0.652165 --> -0.753616).  Saving model ...
Epoch: 6 cost time: 2.6912050247192383
Epoch: 6, Steps: 9 | Train Loss: 0.499 Vali Loss: 0.571 Vali Acc: 0.754 Test Loss: 0.571 Test Acc: 0.754
Validation loss decreased (-0.753616 --> -0.753617).  Saving model ...
Epoch: 7 cost time: 2.986159324645996
Epoch: 7, Steps: 9 | Train Loss: 0.385 Vali Loss: 0.487 Vali Acc: 0.797 Test Loss: 0.487 Test Acc: 0.797
Validation loss decreased (-0.753617 --> -0.797097).  Saving model ...
Epoch: 8 cost time: 2.9415841102600098
Epoch: 8, Steps: 9 | Train Loss: 0.235 Vali Loss: 0.482 Vali Acc: 0.833 Test Loss: 0.482 Test Acc: 0.833
Validation loss decreased (-0.797097 --> -0.833329).  Saving model ...
Epoch: 9 cost time: 2.8840086460113525
Epoch: 9, Steps: 9 | Train Loss: 0.172 Vali Loss: 0.498 Vali Acc: 0.826 Test Loss: 0.498 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.8999218940734863
Epoch: 10, Steps: 9 | Train Loss: 0.275 Vali Loss: 0.393 Vali Acc: 0.848 Test Loss: 0.393 Test Acc: 0.848
Validation loss decreased (-0.833329 --> -0.847822).  Saving model ...
Epoch: 11 cost time: 3.170004367828369
Epoch: 11, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.427 Vali Acc: 0.870 Test Loss: 0.427 Test Acc: 0.870
Validation loss decreased (-0.847822 --> -0.869561).  Saving model ...
Epoch: 12 cost time: 3.0468528270721436
Epoch: 12, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.367 Vali Acc: 0.877 Test Loss: 0.367 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876808).  Saving model ...
Epoch: 13 cost time: 2.950911045074463
Epoch: 13, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.284 Vali Acc: 0.899 Test Loss: 0.284 Test Acc: 0.899
Validation loss decreased (-0.876808 --> -0.898548).  Saving model ...
Epoch: 14 cost time: 3.0534884929656982
Epoch: 14, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.304 Vali Acc: 0.891 Test Loss: 0.304 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.4357354640960693
Epoch: 15, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.389 Vali Acc: 0.862 Test Loss: 0.389 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.087019205093384
Epoch: 16, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.633 Vali Acc: 0.790 Test Loss: 0.633 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.080399751663208
Epoch: 17, Steps: 9 | Train Loss: 0.337 Vali Loss: 0.601 Vali Acc: 0.797 Test Loss: 0.601 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.9255383014678955
Epoch: 18, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.808 Vali Acc: 0.812 Test Loss: 0.808 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.7892398834228516
Epoch: 19, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.660 Vali Acc: 0.790 Test Loss: 0.660 Test Acc: 0.790
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.2248072624206543
Epoch: 20, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.659 Vali Acc: 0.775 Test Loss: 0.659 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.0308749675750732
Epoch: 21, Steps: 9 | Train Loss: 0.107 Vali Loss: 1.115 Vali Acc: 0.768 Test Loss: 1.115 Test Acc: 0.768
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.747159719467163
Epoch: 22, Steps: 9 | Train Loss: 0.080 Vali Loss: 0.741 Vali Acc: 0.797 Test Loss: 0.741 Test Acc: 0.797
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.06083607673645
Epoch: 23, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.642 Vali Acc: 0.826 Test Loss: 0.642 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 4714596
model size : 18.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.496199369430542
Epoch: 1, Steps: 9 | Train Loss: 1.348 Vali Loss: 1.285 Vali Acc: 0.464 Test Loss: 1.285 Test Acc: 0.464
Validation loss decreased (inf --> -0.463755).  Saving model ...
Epoch: 2 cost time: 1.9416232109069824
Epoch: 2, Steps: 9 | Train Loss: 1.180 Vali Loss: 1.113 Vali Acc: 0.551 Test Loss: 1.113 Test Acc: 0.551
Validation loss decreased (-0.463755 --> -0.550714).  Saving model ...
Epoch: 3 cost time: 2.030855894088745
Epoch: 3, Steps: 9 | Train Loss: 0.948 Vali Loss: 0.928 Vali Acc: 0.630 Test Loss: 0.928 Test Acc: 0.630
Validation loss decreased (-0.550714 --> -0.630425).  Saving model ...
Epoch: 4 cost time: 2.081462860107422
Epoch: 4, Steps: 9 | Train Loss: 0.774 Vali Loss: 0.771 Vali Acc: 0.681 Test Loss: 0.771 Test Acc: 0.681
Validation loss decreased (-0.630425 --> -0.681152).  Saving model ...
Epoch: 5 cost time: 1.973299503326416
Epoch: 5, Steps: 9 | Train Loss: 0.576 Vali Loss: 0.639 Vali Acc: 0.717 Test Loss: 0.639 Test Acc: 0.717
Validation loss decreased (-0.681152 --> -0.717385).  Saving model ...
Epoch: 6 cost time: 2.058832883834839
Epoch: 6, Steps: 9 | Train Loss: 0.412 Vali Loss: 0.545 Vali Acc: 0.783 Test Loss: 0.545 Test Acc: 0.783
Validation loss decreased (-0.717385 --> -0.782603).  Saving model ...
Epoch: 7 cost time: 1.9552054405212402
Epoch: 7, Steps: 9 | Train Loss: 0.328 Vali Loss: 0.507 Vali Acc: 0.797 Test Loss: 0.507 Test Acc: 0.797
Validation loss decreased (-0.782603 --> -0.797096).  Saving model ...
Epoch: 8 cost time: 1.9098563194274902
Epoch: 8, Steps: 9 | Train Loss: 0.246 Vali Loss: 0.433 Vali Acc: 0.848 Test Loss: 0.433 Test Acc: 0.848
Validation loss decreased (-0.797096 --> -0.847822).  Saving model ...
Epoch: 9 cost time: 1.7914013862609863
Epoch: 9, Steps: 9 | Train Loss: 0.145 Vali Loss: 0.407 Vali Acc: 0.870 Test Loss: 0.407 Test Acc: 0.870
Validation loss decreased (-0.847822 --> -0.869561).  Saving model ...
Epoch: 10 cost time: 2.0053975582122803
Epoch: 10, Steps: 9 | Train Loss: 0.102 Vali Loss: 0.405 Vali Acc: 0.862 Test Loss: 0.405 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.894897222518921
Epoch: 11, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.419 Vali Acc: 0.848 Test Loss: 0.419 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.9491209983825684
Epoch: 12, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.488 Vali Acc: 0.826 Test Loss: 0.488 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.9822289943695068
Epoch: 13, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.531 Vali Acc: 0.797 Test Loss: 0.531 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.9474647045135498
Epoch: 14, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.494 Vali Acc: 0.819 Test Loss: 0.494 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.8808073997497559
Epoch: 15, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.405 Vali Acc: 0.877 Test Loss: 0.405 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876808).  Saving model ...
Epoch: 16 cost time: 1.8906006813049316
Epoch: 16, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.422 Vali Acc: 0.877 Test Loss: 0.422 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9764745235443115
Epoch: 17, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.400 Vali Acc: 0.899 Test Loss: 0.400 Test Acc: 0.899
Validation loss decreased (-0.876808 --> -0.898547).  Saving model ...
Epoch: 18 cost time: 1.9650766849517822
Epoch: 18, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.378 Vali Acc: 0.899 Test Loss: 0.378 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 19 cost time: 2.0469791889190674
Epoch: 19, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.369 Vali Acc: 0.906 Test Loss: 0.369 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905793).  Saving model ...
Epoch: 20 cost time: 2.0796544551849365
Epoch: 20, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.528 Vali Acc: 0.819 Test Loss: 0.528 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.051762104034424
Epoch: 21, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.511 Vali Acc: 0.848 Test Loss: 0.511 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.033745765686035
Epoch: 22, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.528 Vali Acc: 0.862 Test Loss: 0.528 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.05254864692688
Epoch: 23, Steps: 9 | Train Loss: 0.114 Vali Loss: 0.511 Vali Acc: 0.855 Test Loss: 0.511 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.042390823364258
Epoch: 24, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.501 Vali Acc: 0.848 Test Loss: 0.501 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.029764413833618
Epoch: 25, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.453 Vali Acc: 0.870 Test Loss: 0.453 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.9673221111297607
Epoch: 26, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.327 Vali Acc: 0.913 Test Loss: 0.327 Test Acc: 0.913
Validation loss decreased (-0.905793 --> -0.913040).  Saving model ...
Epoch: 27 cost time: 2.135745048522949
Epoch: 27, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.368 Vali Acc: 0.891 Test Loss: 0.368 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.0637285709381104
Epoch: 28, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.386 Vali Acc: 0.884 Test Loss: 0.386 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.0467233657836914
Epoch: 29, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.452 Vali Acc: 0.862 Test Loss: 0.452 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.0520973205566406
Epoch: 30, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.397 Vali Acc: 0.877 Test Loss: 0.397 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 1404388
model size : 5.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 6.242221355438232
Epoch: 1, Steps: 9 | Train Loss: 1.387 Vali Loss: 1.297 Vali Acc: 0.370 Test Loss: 1.297 Test Acc: 0.370
Validation loss decreased (inf --> -0.369552).  Saving model ...
Epoch: 2 cost time: 4.187151193618774
Epoch: 2, Steps: 9 | Train Loss: 1.208 Vali Loss: 1.099 Vali Acc: 0.601 Test Loss: 1.099 Test Acc: 0.601
Validation loss decreased (-0.369552 --> -0.601438).  Saving model ...
Epoch: 3 cost time: 4.264997243881226
Epoch: 3, Steps: 9 | Train Loss: 0.957 Vali Loss: 0.907 Vali Acc: 0.645 Test Loss: 0.907 Test Acc: 0.645
Validation loss decreased (-0.601438 --> -0.644918).  Saving model ...
Epoch: 4 cost time: 4.318818092346191
Epoch: 4, Steps: 9 | Train Loss: 0.730 Vali Loss: 0.713 Vali Acc: 0.732 Test Loss: 0.713 Test Acc: 0.732
Validation loss decreased (-0.644918 --> -0.731877).  Saving model ...
Epoch: 5 cost time: 4.2945876121521
Epoch: 5, Steps: 9 | Train Loss: 0.541 Vali Loss: 0.555 Vali Acc: 0.819 Test Loss: 0.555 Test Acc: 0.819
Validation loss decreased (-0.731877 --> -0.818835).  Saving model ...
Epoch: 6 cost time: 4.094094753265381
Epoch: 6, Steps: 9 | Train Loss: 0.364 Vali Loss: 0.459 Vali Acc: 0.877 Test Loss: 0.459 Test Acc: 0.877
Validation loss decreased (-0.818835 --> -0.876807).  Saving model ...
Epoch: 7 cost time: 4.317898511886597
Epoch: 7, Steps: 9 | Train Loss: 0.255 Vali Loss: 0.434 Vali Acc: 0.877 Test Loss: 0.434 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876807).  Saving model ...
Epoch: 8 cost time: 3.4749064445495605
Epoch: 8, Steps: 9 | Train Loss: 0.471 Vali Loss: 0.412 Vali Acc: 0.877 Test Loss: 0.412 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876807).  Saving model ...
Epoch: 9 cost time: 3.639678478240967
Epoch: 9, Steps: 9 | Train Loss: 0.182 Vali Loss: 0.427 Vali Acc: 0.862 Test Loss: 0.427 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.931873083114624
Epoch: 10, Steps: 9 | Train Loss: 0.161 Vali Loss: 0.361 Vali Acc: 0.870 Test Loss: 0.361 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.1597819328308105
Epoch: 11, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.383 Vali Acc: 0.870 Test Loss: 0.383 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.033623933792114
Epoch: 12, Steps: 9 | Train Loss: 0.080 Vali Loss: 0.367 Vali Acc: 0.884 Test Loss: 0.367 Test Acc: 0.884
Validation loss decreased (-0.876807 --> -0.884054).  Saving model ...
Epoch: 13 cost time: 4.024963855743408
Epoch: 13, Steps: 9 | Train Loss: 0.187 Vali Loss: 0.351 Vali Acc: 0.899 Test Loss: 0.351 Test Acc: 0.899
Validation loss decreased (-0.884054 --> -0.898547).  Saving model ...
Epoch: 14 cost time: 3.8639309406280518
Epoch: 14, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.421 Vali Acc: 0.855 Test Loss: 0.421 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.9941046237945557
Epoch: 15, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.455 Vali Acc: 0.833 Test Loss: 0.455 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.023907661437988
Epoch: 16, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.380 Vali Acc: 0.848 Test Loss: 0.380 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.9898855686187744
Epoch: 17, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.431 Vali Acc: 0.855 Test Loss: 0.431 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.934770107269287
Epoch: 18, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.423 Vali Acc: 0.870 Test Loss: 0.423 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.9803736209869385
Epoch: 19, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.391 Vali Acc: 0.884 Test Loss: 0.391 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.064162492752075
Epoch: 20, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.381 Vali Acc: 0.891 Test Loss: 0.381 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.7752068042755127
Epoch: 21, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.362 Vali Acc: 0.899 Test Loss: 0.362 Test Acc: 0.899
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.968031644821167
Epoch: 22, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.506 Vali Acc: 0.826 Test Loss: 0.506 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.083152770996094
Epoch: 23, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.522 Vali Acc: 0.819 Test Loss: 0.522 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 2370916
model size : 9.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.397937774658203
Epoch: 1, Steps: 9 | Train Loss: 1.438 Vali Loss: 1.335 Vali Acc: 0.333 Test Loss: 1.335 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 2.337941884994507
Epoch: 2, Steps: 9 | Train Loss: 1.246 Vali Loss: 1.126 Vali Acc: 0.594 Test Loss: 1.126 Test Acc: 0.594
Validation loss decreased (-0.333320 --> -0.594192).  Saving model ...
Epoch: 3 cost time: 2.2703545093536377
Epoch: 3, Steps: 9 | Train Loss: 1.001 Vali Loss: 0.907 Vali Acc: 0.696 Test Loss: 0.907 Test Acc: 0.696
Validation loss decreased (-0.594192 --> -0.695643).  Saving model ...
Epoch: 4 cost time: 2.0855698585510254
Epoch: 4, Steps: 9 | Train Loss: 0.751 Vali Loss: 0.699 Vali Acc: 0.790 Test Loss: 0.699 Test Acc: 0.790
Validation loss decreased (-0.695643 --> -0.789848).  Saving model ...
Epoch: 5 cost time: 2.2782442569732666
Epoch: 5, Steps: 9 | Train Loss: 0.530 Vali Loss: 0.530 Vali Acc: 0.819 Test Loss: 0.530 Test Acc: 0.819
Validation loss decreased (-0.789848 --> -0.818835).  Saving model ...
Epoch: 6 cost time: 2.348818778991699
Epoch: 6, Steps: 9 | Train Loss: 0.399 Vali Loss: 0.469 Vali Acc: 0.826 Test Loss: 0.469 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826082).  Saving model ...
Epoch: 7 cost time: 2.3499088287353516
Epoch: 7, Steps: 9 | Train Loss: 0.326 Vali Loss: 0.417 Vali Acc: 0.833 Test Loss: 0.417 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833329).  Saving model ...
Epoch: 8 cost time: 2.2796566486358643
Epoch: 8, Steps: 9 | Train Loss: 0.190 Vali Loss: 0.417 Vali Acc: 0.826 Test Loss: 0.417 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.2163052558898926
Epoch: 9, Steps: 9 | Train Loss: 0.189 Vali Loss: 0.374 Vali Acc: 0.848 Test Loss: 0.374 Test Acc: 0.848
Validation loss decreased (-0.833329 --> -0.847822).  Saving model ...
Epoch: 10 cost time: 2.3131942749023438
Epoch: 10, Steps: 9 | Train Loss: 0.114 Vali Loss: 0.352 Vali Acc: 0.848 Test Loss: 0.352 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847823).  Saving model ...
Epoch: 11 cost time: 2.3521804809570312
Epoch: 11, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.361 Vali Acc: 0.848 Test Loss: 0.361 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.261490821838379
Epoch: 12, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.316 Vali Acc: 0.862 Test Loss: 0.316 Test Acc: 0.862
Validation loss decreased (-0.847823 --> -0.862316).  Saving model ...
Epoch: 13 cost time: 2.368043899536133
Epoch: 13, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.347 Vali Acc: 0.862 Test Loss: 0.347 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.3842039108276367
Epoch: 14, Steps: 9 | Train Loss: 0.108 Vali Loss: 0.334 Vali Acc: 0.870 Test Loss: 0.334 Test Acc: 0.870
Validation loss decreased (-0.862316 --> -0.869562).  Saving model ...
Epoch: 15 cost time: 2.2442967891693115
Epoch: 15, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.301 Vali Acc: 0.884 Test Loss: 0.301 Test Acc: 0.884
Validation loss decreased (-0.869562 --> -0.884055).  Saving model ...
Epoch: 16 cost time: 2.2423691749572754
Epoch: 16, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.297 Vali Acc: 0.862 Test Loss: 0.297 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.4175689220428467
Epoch: 17, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.305 Vali Acc: 0.870 Test Loss: 0.305 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.2700304985046387
Epoch: 18, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.315 Vali Acc: 0.884 Test Loss: 0.315 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.326145648956299
Epoch: 19, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.331 Vali Acc: 0.870 Test Loss: 0.331 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.273077964782715
Epoch: 20, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.363 Vali Acc: 0.870 Test Loss: 0.363 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.3318092823028564
Epoch: 21, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.356 Vali Acc: 0.877 Test Loss: 0.356 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.212385892868042
Epoch: 22, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.305 Vali Acc: 0.913 Test Loss: 0.305 Test Acc: 0.913
Validation loss decreased (-0.884055 --> -0.913040).  Saving model ...
Epoch: 23 cost time: 2.281247138977051
Epoch: 23, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.298 Vali Acc: 0.913 Test Loss: 0.298 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913041).  Saving model ...
Epoch: 24 cost time: 2.268314838409424
Epoch: 24, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.331 Vali Acc: 0.899 Test Loss: 0.331 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.283125400543213
Epoch: 25, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.362 Vali Acc: 0.891 Test Loss: 0.362 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.2137415409088135
Epoch: 26, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.345 Vali Acc: 0.906 Test Loss: 0.345 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.3123373985290527
Epoch: 27, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.323 Vali Acc: 0.899 Test Loss: 0.323 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.543865203857422
Epoch: 28, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.342 Vali Acc: 0.884 Test Loss: 0.342 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.352999448776245
Epoch: 29, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.345 Vali Acc: 0.891 Test Loss: 0.345 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.3961868286132812
Epoch: 30, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.293 Vali Acc: 0.899 Test Loss: 0.293 Test Acc: 0.899
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 715748
model size : 3.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.175726652145386
Epoch: 1, Steps: 9 | Train Loss: 1.386 Vali Loss: 1.293 Vali Acc: 0.348 Test Loss: 1.293 Test Acc: 0.348
Validation loss decreased (inf --> -0.347813).  Saving model ...
Epoch: 2 cost time: 3.048916816711426
Epoch: 2, Steps: 9 | Train Loss: 1.217 Vali Loss: 1.107 Vali Acc: 0.587 Test Loss: 1.107 Test Acc: 0.587
Validation loss decreased (-0.347813 --> -0.586945).  Saving model ...
Epoch: 3 cost time: 3.1704318523406982
Epoch: 3, Steps: 9 | Train Loss: 0.999 Vali Loss: 0.947 Vali Acc: 0.601 Test Loss: 0.947 Test Acc: 0.601
Validation loss decreased (-0.586945 --> -0.601440).  Saving model ...
Epoch: 4 cost time: 3.0710952281951904
Epoch: 4, Steps: 9 | Train Loss: 0.776 Vali Loss: 0.774 Vali Acc: 0.696 Test Loss: 0.774 Test Acc: 0.696
Validation loss decreased (-0.601440 --> -0.695644).  Saving model ...
Epoch: 5 cost time: 3.135622262954712
Epoch: 5, Steps: 9 | Train Loss: 0.610 Vali Loss: 0.605 Vali Acc: 0.812 Test Loss: 0.605 Test Acc: 0.812
Validation loss decreased (-0.695644 --> -0.811588).  Saving model ...
Epoch: 6 cost time: 3.1767609119415283
Epoch: 6, Steps: 9 | Train Loss: 0.439 Vali Loss: 0.469 Vali Acc: 0.855 Test Loss: 0.469 Test Acc: 0.855
Validation loss decreased (-0.811588 --> -0.855068).  Saving model ...
Epoch: 7 cost time: 3.2621898651123047
Epoch: 7, Steps: 9 | Train Loss: 0.308 Vali Loss: 0.423 Vali Acc: 0.870 Test Loss: 0.423 Test Acc: 0.870
Validation loss decreased (-0.855068 --> -0.869561).  Saving model ...
Epoch: 8 cost time: 3.3089263439178467
Epoch: 8, Steps: 9 | Train Loss: 0.480 Vali Loss: 0.366 Vali Acc: 0.877 Test Loss: 0.366 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876808).  Saving model ...
Epoch: 9 cost time: 3.334792137145996
Epoch: 9, Steps: 9 | Train Loss: 0.284 Vali Loss: 0.368 Vali Acc: 0.884 Test Loss: 0.368 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884054).  Saving model ...
Epoch: 10 cost time: 3.220767021179199
Epoch: 10, Steps: 9 | Train Loss: 0.143 Vali Loss: 0.375 Vali Acc: 0.891 Test Loss: 0.375 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891301).  Saving model ...
Epoch: 11 cost time: 3.2722907066345215
Epoch: 11, Steps: 9 | Train Loss: 0.133 Vali Loss: 0.464 Vali Acc: 0.833 Test Loss: 0.464 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.267137050628662
Epoch: 12, Steps: 9 | Train Loss: 0.126 Vali Loss: 0.417 Vali Acc: 0.862 Test Loss: 0.417 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.2557389736175537
Epoch: 13, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.398 Vali Acc: 0.833 Test Loss: 0.398 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.2962381839752197
Epoch: 14, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.416 Vali Acc: 0.848 Test Loss: 0.416 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.0606915950775146
Epoch: 15, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.411 Vali Acc: 0.848 Test Loss: 0.411 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.7576067447662354
Epoch: 16, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.391 Vali Acc: 0.870 Test Loss: 0.391 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.89300537109375
Epoch: 17, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.351 Vali Acc: 0.891 Test Loss: 0.351 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 18 cost time: 3.339608907699585
Epoch: 18, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.377 Vali Acc: 0.877 Test Loss: 0.377 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.3138017654418945
Epoch: 19, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.419 Vali Acc: 0.870 Test Loss: 0.419 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.3641858100891113
Epoch: 20, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.402 Vali Acc: 0.870 Test Loss: 0.402 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.354015588760376
Epoch: 21, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.363 Vali Acc: 0.884 Test Loss: 0.363 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.4371023178100586
Epoch: 22, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.361 Vali Acc: 0.891 Test Loss: 0.361 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.9222991466522217
Epoch: 23, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.380 Vali Acc: 0.884 Test Loss: 0.380 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.4570844173431396
Epoch: 24, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.355 Vali Acc: 0.899 Test Loss: 0.355 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898547).  Saving model ...
Epoch: 25 cost time: 3.379446029663086
Epoch: 25, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.337 Vali Acc: 0.891 Test Loss: 0.337 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.0046215057373047
Epoch: 26, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.346 Vali Acc: 0.891 Test Loss: 0.346 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.4346418380737305
Epoch: 27, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.372 Vali Acc: 0.899 Test Loss: 0.372 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.313404083251953
Epoch: 28, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.391 Vali Acc: 0.899 Test Loss: 0.391 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.0087900161743164
Epoch: 29, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.541 Vali Acc: 0.841 Test Loss: 0.541 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.4394872188568115
Epoch: 30, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.486 Vali Acc: 0.862 Test Loss: 0.486 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 2370916
model size : 9.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.827470541000366
Epoch: 1, Steps: 9 | Train Loss: 1.441 Vali Loss: 1.332 Vali Acc: 0.326 Test Loss: 1.332 Test Acc: 0.326
Validation loss decreased (inf --> -0.326074).  Saving model ...
Epoch: 2 cost time: 2.08198618888855
Epoch: 2, Steps: 9 | Train Loss: 1.257 Vali Loss: 1.138 Vali Acc: 0.543 Test Loss: 1.138 Test Acc: 0.543
Validation loss decreased (-0.326074 --> -0.543467).  Saving model ...
Epoch: 3 cost time: 2.0519473552703857
Epoch: 3, Steps: 9 | Train Loss: 1.032 Vali Loss: 0.941 Vali Acc: 0.630 Test Loss: 0.941 Test Acc: 0.630
Validation loss decreased (-0.543467 --> -0.630425).  Saving model ...
Epoch: 4 cost time: 1.7291984558105469
Epoch: 4, Steps: 9 | Train Loss: 0.788 Vali Loss: 0.756 Vali Acc: 0.717 Test Loss: 0.756 Test Acc: 0.717
Validation loss decreased (-0.630425 --> -0.717384).  Saving model ...
Epoch: 5 cost time: 2.004392385482788
Epoch: 5, Steps: 9 | Train Loss: 0.571 Vali Loss: 0.585 Vali Acc: 0.775 Test Loss: 0.585 Test Acc: 0.775
Validation loss decreased (-0.717384 --> -0.775356).  Saving model ...
Epoch: 6 cost time: 2.033480644226074
Epoch: 6, Steps: 9 | Train Loss: 0.437 Vali Loss: 0.464 Vali Acc: 0.826 Test Loss: 0.464 Test Acc: 0.826
Validation loss decreased (-0.775356 --> -0.826082).  Saving model ...
Epoch: 7 cost time: 2.137138843536377
Epoch: 7, Steps: 9 | Train Loss: 0.399 Vali Loss: 0.410 Vali Acc: 0.855 Test Loss: 0.410 Test Acc: 0.855
Validation loss decreased (-0.826082 --> -0.855068).  Saving model ...
Epoch: 8 cost time: 2.0606844425201416
Epoch: 8, Steps: 9 | Train Loss: 0.246 Vali Loss: 0.452 Vali Acc: 0.833 Test Loss: 0.452 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.070343494415283
Epoch: 9, Steps: 9 | Train Loss: 0.204 Vali Loss: 0.376 Vali Acc: 0.862 Test Loss: 0.376 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862315).  Saving model ...
Epoch: 10 cost time: 2.0202672481536865
Epoch: 10, Steps: 9 | Train Loss: 0.124 Vali Loss: 0.310 Vali Acc: 0.870 Test Loss: 0.310 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869562).  Saving model ...
Epoch: 11 cost time: 1.9503307342529297
Epoch: 11, Steps: 9 | Train Loss: 0.087 Vali Loss: 0.343 Vali Acc: 0.855 Test Loss: 0.343 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9746832847595215
Epoch: 12, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.311 Vali Acc: 0.862 Test Loss: 0.311 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6217677593231201
Epoch: 13, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.318 Vali Acc: 0.855 Test Loss: 0.318 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.071531057357788
Epoch: 14, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.320 Vali Acc: 0.877 Test Loss: 0.320 Test Acc: 0.877
Validation loss decreased (-0.869562 --> -0.876808).  Saving model ...
Epoch: 15 cost time: 1.9172520637512207
Epoch: 15, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.372 Vali Acc: 0.862 Test Loss: 0.372 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9553987979888916
Epoch: 16, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.363 Vali Acc: 0.862 Test Loss: 0.363 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.8033413887023926
Epoch: 17, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.317 Vali Acc: 0.870 Test Loss: 0.317 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.9912779331207275
Epoch: 18, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.314 Vali Acc: 0.877 Test Loss: 0.314 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 19 cost time: 2.006016969680786
Epoch: 19, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.368 Vali Acc: 0.877 Test Loss: 0.368 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.0855050086975098
Epoch: 20, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.397 Vali Acc: 0.877 Test Loss: 0.397 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.8881964683532715
Epoch: 21, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.353 Vali Acc: 0.884 Test Loss: 0.353 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884054).  Saving model ...
Epoch: 22 cost time: 1.7691471576690674
Epoch: 22, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.313 Vali Acc: 0.891 Test Loss: 0.313 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891301).  Saving model ...
Epoch: 23 cost time: 1.9537684917449951
Epoch: 23, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.409 Vali Acc: 0.862 Test Loss: 0.409 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.9813697338104248
Epoch: 24, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.382 Vali Acc: 0.870 Test Loss: 0.382 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.958451271057129
Epoch: 25, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.371 Vali Acc: 0.884 Test Loss: 0.371 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.6278221607208252
Epoch: 26, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.350 Vali Acc: 0.899 Test Loss: 0.350 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898547).  Saving model ...
Epoch: 27 cost time: 1.9698288440704346
Epoch: 27, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.327 Vali Acc: 0.899 Test Loss: 0.327 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 28 cost time: 2.0526554584503174
Epoch: 28, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.331 Vali Acc: 0.877 Test Loss: 0.331 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.9584062099456787
Epoch: 29, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.319 Vali Acc: 0.891 Test Loss: 0.319 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.019685745239258
Epoch: 30, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.292 Vali Acc: 0.899 Test Loss: 0.292 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898548).  Saving model ...
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 715748
model size : 3.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.9170563220977783
Epoch: 1, Steps: 9 | Train Loss: 1.385 Vali Loss: 1.299 Vali Acc: 0.370 Test Loss: 1.299 Test Acc: 0.370
Validation loss decreased (inf --> -0.369552).  Saving model ...
Epoch: 2 cost time: 2.3541667461395264
Epoch: 2, Steps: 9 | Train Loss: 1.229 Vali Loss: 1.138 Vali Acc: 0.543 Test Loss: 1.138 Test Acc: 0.543
Validation loss decreased (-0.369552 --> -0.543467).  Saving model ...
Epoch: 3 cost time: 2.2183167934417725
Epoch: 3, Steps: 9 | Train Loss: 1.017 Vali Loss: 1.007 Vali Acc: 0.580 Test Loss: 1.007 Test Acc: 0.580
Validation loss decreased (-0.543467 --> -0.579700).  Saving model ...
Epoch: 4 cost time: 2.120436191558838
Epoch: 4, Steps: 9 | Train Loss: 0.834 Vali Loss: 0.878 Vali Acc: 0.638 Test Loss: 0.878 Test Acc: 0.638
Validation loss decreased (-0.579700 --> -0.637672).  Saving model ...
Epoch: 5 cost time: 2.219367742538452
Epoch: 5, Steps: 9 | Train Loss: 0.678 Vali Loss: 0.737 Vali Acc: 0.703 Test Loss: 0.737 Test Acc: 0.703
Validation loss decreased (-0.637672 --> -0.702891).  Saving model ...
Epoch: 6 cost time: 2.390015125274658
Epoch: 6, Steps: 9 | Train Loss: 0.518 Vali Loss: 0.600 Vali Acc: 0.783 Test Loss: 0.600 Test Acc: 0.783
Validation loss decreased (-0.702891 --> -0.782603).  Saving model ...
Epoch: 7 cost time: 2.273420572280884
Epoch: 7, Steps: 9 | Train Loss: 0.410 Vali Loss: 0.555 Vali Acc: 0.797 Test Loss: 0.555 Test Acc: 0.797
Validation loss decreased (-0.782603 --> -0.797096).  Saving model ...
Epoch: 8 cost time: 2.2821314334869385
Epoch: 8, Steps: 9 | Train Loss: 0.267 Vali Loss: 0.480 Vali Acc: 0.826 Test Loss: 0.480 Test Acc: 0.826
Validation loss decreased (-0.797096 --> -0.826082).  Saving model ...
Epoch: 9 cost time: 2.3551766872406006
Epoch: 9, Steps: 9 | Train Loss: 0.219 Vali Loss: 0.475 Vali Acc: 0.841 Test Loss: 0.475 Test Acc: 0.841
Validation loss decreased (-0.826082 --> -0.840575).  Saving model ...
Epoch: 10 cost time: 2.2855241298675537
Epoch: 10, Steps: 9 | Train Loss: 0.156 Vali Loss: 0.505 Vali Acc: 0.790 Test Loss: 0.505 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.2581450939178467
Epoch: 11, Steps: 9 | Train Loss: 0.094 Vali Loss: 0.561 Vali Acc: 0.775 Test Loss: 0.561 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.247321128845215
Epoch: 12, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.596 Vali Acc: 0.783 Test Loss: 0.596 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.1498260498046875
Epoch: 13, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.735 Vali Acc: 0.710 Test Loss: 0.735 Test Acc: 0.710
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.2533411979675293
Epoch: 14, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.649 Vali Acc: 0.790 Test Loss: 0.649 Test Acc: 0.790
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.2146005630493164
Epoch: 15, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.543 Vali Acc: 0.804 Test Loss: 0.543 Test Acc: 0.804
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.2248241901397705
Epoch: 16, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.571 Vali Acc: 0.783 Test Loss: 0.571 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.3145220279693604
Epoch: 17, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.854 Vali Acc: 0.717 Test Loss: 0.854 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.158250093460083
Epoch: 18, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.764 Vali Acc: 0.725 Test Loss: 0.764 Test Acc: 0.725
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.0412144660949707
Epoch: 19, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.709 Vali Acc: 0.768 Test Loss: 0.709 Test Acc: 0.768
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8405797101449275
model parameter : 2370916
model size : 9.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.2964529991149902
Epoch: 1, Steps: 9 | Train Loss: 1.448 Vali Loss: 1.337 Vali Acc: 0.333 Test Loss: 1.337 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 1.5921165943145752
Epoch: 2, Steps: 9 | Train Loss: 1.270 Vali Loss: 1.170 Vali Acc: 0.522 Test Loss: 1.170 Test Acc: 0.522
Validation loss decreased (-0.333320 --> -0.521727).  Saving model ...
Epoch: 3 cost time: 1.6386566162109375
Epoch: 3, Steps: 9 | Train Loss: 1.062 Vali Loss: 1.007 Vali Acc: 0.609 Test Loss: 1.007 Test Acc: 0.609
Validation loss decreased (-0.521727 --> -0.608686).  Saving model ...
Epoch: 4 cost time: 1.5381128787994385
Epoch: 4, Steps: 9 | Train Loss: 0.851 Vali Loss: 0.843 Vali Acc: 0.652 Test Loss: 0.843 Test Acc: 0.652
Validation loss decreased (-0.608686 --> -0.652165).  Saving model ...
Epoch: 5 cost time: 1.4911398887634277
Epoch: 5, Steps: 9 | Train Loss: 0.659 Vali Loss: 0.698 Vali Acc: 0.725 Test Loss: 0.698 Test Acc: 0.725
Validation loss decreased (-0.652165 --> -0.724631).  Saving model ...
Epoch: 6 cost time: 1.5539627075195312
Epoch: 6, Steps: 9 | Train Loss: 0.495 Vali Loss: 0.575 Vali Acc: 0.768 Test Loss: 0.575 Test Acc: 0.768
Validation loss decreased (-0.724631 --> -0.768110).  Saving model ...
Epoch: 7 cost time: 1.407416820526123
Epoch: 7, Steps: 9 | Train Loss: 0.407 Vali Loss: 0.491 Vali Acc: 0.819 Test Loss: 0.491 Test Acc: 0.819
Validation loss decreased (-0.768110 --> -0.818836).  Saving model ...
Epoch: 8 cost time: 1.578094244003296
Epoch: 8, Steps: 9 | Train Loss: 0.272 Vali Loss: 0.509 Vali Acc: 0.819 Test Loss: 0.509 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5687255859375
Epoch: 9, Steps: 9 | Train Loss: 0.191 Vali Loss: 0.470 Vali Acc: 0.833 Test Loss: 0.470 Test Acc: 0.833
Validation loss decreased (-0.818836 --> -0.833329).  Saving model ...
Epoch: 10 cost time: 1.3174214363098145
Epoch: 10, Steps: 9 | Train Loss: 0.143 Vali Loss: 0.409 Vali Acc: 0.855 Test Loss: 0.409 Test Acc: 0.855
Validation loss decreased (-0.833329 --> -0.855068).  Saving model ...
Epoch: 11 cost time: 1.5210349559783936
Epoch: 11, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.425 Vali Acc: 0.841 Test Loss: 0.425 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5846304893493652
Epoch: 12, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.421 Vali Acc: 0.855 Test Loss: 0.421 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.601301670074463
Epoch: 13, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.390 Vali Acc: 0.855 Test Loss: 0.390 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855069).  Saving model ...
Epoch: 14 cost time: 1.563857078552246
Epoch: 14, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.410 Vali Acc: 0.848 Test Loss: 0.410 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5737416744232178
Epoch: 15, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.401 Vali Acc: 0.848 Test Loss: 0.401 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4986529350280762
Epoch: 16, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.413 Vali Acc: 0.848 Test Loss: 0.413 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.640897512435913
Epoch: 17, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.364 Vali Acc: 0.870 Test Loss: 0.364 Test Acc: 0.870
Validation loss decreased (-0.855069 --> -0.869562).  Saving model ...
Epoch: 18 cost time: 1.4444050788879395
Epoch: 18, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.355 Vali Acc: 0.870 Test Loss: 0.355 Test Acc: 0.870
Validation loss decreased (-0.869562 --> -0.869562).  Saving model ...
Epoch: 19 cost time: 1.2317988872528076
Epoch: 19, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.355 Vali Acc: 0.884 Test Loss: 0.355 Test Acc: 0.884
Validation loss decreased (-0.869562 --> -0.884054).  Saving model ...
Epoch: 20 cost time: 1.2372970581054688
Epoch: 20, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.360 Vali Acc: 0.884 Test Loss: 0.360 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.302438497543335
Epoch: 21, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.348 Vali Acc: 0.891 Test Loss: 0.348 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891301).  Saving model ...
Epoch: 22 cost time: 1.3606269359588623
Epoch: 22, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.324 Vali Acc: 0.891 Test Loss: 0.324 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 23 cost time: 1.5030341148376465
Epoch: 23, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.377 Vali Acc: 0.862 Test Loss: 0.377 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4636573791503906
Epoch: 24, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.438 Vali Acc: 0.870 Test Loss: 0.438 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.2394700050354004
Epoch: 25, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.458 Vali Acc: 0.862 Test Loss: 0.458 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.531461238861084
Epoch: 26, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.466 Vali Acc: 0.855 Test Loss: 0.466 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.3802504539489746
Epoch: 27, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.376 Vali Acc: 0.884 Test Loss: 0.376 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.547966480255127
Epoch: 28, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.397 Vali Acc: 0.870 Test Loss: 0.397 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.5232274532318115
Epoch: 29, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.342 Vali Acc: 0.884 Test Loss: 0.342 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.526301383972168
Epoch: 30, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.510 Vali Acc: 0.841 Test Loss: 0.510 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 715748
model size : 3.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.604399681091309
Epoch: 1, Steps: 9 | Train Loss: 1.354 Vali Loss: 1.303 Vali Acc: 0.326 Test Loss: 1.303 Test Acc: 0.326
Validation loss decreased (inf --> -0.326074).  Saving model ...
Epoch: 2 cost time: 2.784463882446289
Epoch: 2, Steps: 9 | Train Loss: 1.209 Vali Loss: 1.131 Vali Acc: 0.565 Test Loss: 1.131 Test Acc: 0.565
Validation loss decreased (-0.326074 --> -0.565206).  Saving model ...
Epoch: 3 cost time: 2.8400604724884033
Epoch: 3, Steps: 9 | Train Loss: 0.960 Vali Loss: 0.929 Vali Acc: 0.652 Test Loss: 0.929 Test Acc: 0.652
Validation loss decreased (-0.565206 --> -0.652165).  Saving model ...
Epoch: 4 cost time: 2.9076108932495117
Epoch: 4, Steps: 9 | Train Loss: 0.766 Vali Loss: 0.723 Vali Acc: 0.739 Test Loss: 0.723 Test Acc: 0.739
Validation loss decreased (-0.652165 --> -0.739123).  Saving model ...
Epoch: 5 cost time: 2.830409049987793
Epoch: 5, Steps: 9 | Train Loss: 0.538 Vali Loss: 0.597 Vali Acc: 0.783 Test Loss: 0.597 Test Acc: 0.783
Validation loss decreased (-0.739123 --> -0.782603).  Saving model ...
Epoch: 6 cost time: 2.6653976440429688
Epoch: 6, Steps: 9 | Train Loss: 0.430 Vali Loss: 0.539 Vali Acc: 0.812 Test Loss: 0.539 Test Acc: 0.812
Validation loss decreased (-0.782603 --> -0.811589).  Saving model ...
Epoch: 7 cost time: 2.8502416610717773
Epoch: 7, Steps: 9 | Train Loss: 0.307 Vali Loss: 0.524 Vali Acc: 0.804 Test Loss: 0.524 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.88970685005188
Epoch: 8, Steps: 9 | Train Loss: 0.232 Vali Loss: 0.456 Vali Acc: 0.848 Test Loss: 0.456 Test Acc: 0.848
Validation loss decreased (-0.811589 --> -0.847822).  Saving model ...
Epoch: 9 cost time: 2.8035271167755127
Epoch: 9, Steps: 9 | Train Loss: 0.201 Vali Loss: 0.412 Vali Acc: 0.855 Test Loss: 0.412 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855068).  Saving model ...
Epoch: 10 cost time: 2.825850486755371
Epoch: 10, Steps: 9 | Train Loss: 0.666 Vali Loss: 0.417 Vali Acc: 0.841 Test Loss: 0.417 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.803706407546997
Epoch: 11, Steps: 9 | Train Loss: 0.114 Vali Loss: 0.373 Vali Acc: 0.848 Test Loss: 0.373 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.8482697010040283
Epoch: 12, Steps: 9 | Train Loss: 0.112 Vali Loss: 0.309 Vali Acc: 0.884 Test Loss: 0.309 Test Acc: 0.884
Validation loss decreased (-0.855068 --> -0.884055).  Saving model ...
Epoch: 13 cost time: 2.633765935897827
Epoch: 13, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.337 Vali Acc: 0.884 Test Loss: 0.337 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.8480191230773926
Epoch: 14, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.338 Vali Acc: 0.870 Test Loss: 0.338 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.0482053756713867
Epoch: 15, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.345 Vali Acc: 0.855 Test Loss: 0.345 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.9622585773468018
Epoch: 16, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.345 Vali Acc: 0.862 Test Loss: 0.345 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.939894914627075
Epoch: 17, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.354 Vali Acc: 0.862 Test Loss: 0.354 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.9286227226257324
Epoch: 18, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.376 Vali Acc: 0.870 Test Loss: 0.376 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.974215269088745
Epoch: 19, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.384 Vali Acc: 0.870 Test Loss: 0.384 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.9793996810913086
Epoch: 20, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.371 Vali Acc: 0.884 Test Loss: 0.371 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.982098340988159
Epoch: 21, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.340 Vali Acc: 0.884 Test Loss: 0.340 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.92960524559021
Epoch: 22, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.398 Vali Acc: 0.855 Test Loss: 0.398 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 1199076
model size : 5.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.139178276062012
Epoch: 1, Steps: 9 | Train Loss: 1.435 Vali Loss: 1.358 Vali Acc: 0.312 Test Loss: 1.358 Test Acc: 0.312
Validation loss decreased (inf --> -0.311581).  Saving model ...
Epoch: 2 cost time: 1.949638843536377
Epoch: 2, Steps: 9 | Train Loss: 1.248 Vali Loss: 1.190 Vali Acc: 0.420 Test Loss: 1.190 Test Acc: 0.420
Validation loss decreased (-0.311581 --> -0.420278).  Saving model ...
Epoch: 3 cost time: 1.9973773956298828
Epoch: 3, Steps: 9 | Train Loss: 1.013 Vali Loss: 1.001 Vali Acc: 0.543 Test Loss: 1.001 Test Acc: 0.543
Validation loss decreased (-0.420278 --> -0.543468).  Saving model ...
Epoch: 4 cost time: 2.032582998275757
Epoch: 4, Steps: 9 | Train Loss: 0.811 Vali Loss: 0.831 Vali Acc: 0.623 Test Loss: 0.831 Test Acc: 0.623
Validation loss decreased (-0.543468 --> -0.623180).  Saving model ...
Epoch: 5 cost time: 1.9734141826629639
Epoch: 5, Steps: 9 | Train Loss: 0.589 Vali Loss: 0.635 Vali Acc: 0.783 Test Loss: 0.635 Test Acc: 0.783
Validation loss decreased (-0.623180 --> -0.782602).  Saving model ...
Epoch: 6 cost time: 1.9533021450042725
Epoch: 6, Steps: 9 | Train Loss: 0.423 Vali Loss: 0.484 Vali Acc: 0.812 Test Loss: 0.484 Test Acc: 0.812
Validation loss decreased (-0.782602 --> -0.811589).  Saving model ...
Epoch: 7 cost time: 1.959324598312378
Epoch: 7, Steps: 9 | Train Loss: 0.314 Vali Loss: 0.426 Vali Acc: 0.848 Test Loss: 0.426 Test Acc: 0.848
Validation loss decreased (-0.811589 --> -0.847822).  Saving model ...
Epoch: 8 cost time: 1.9822092056274414
Epoch: 8, Steps: 9 | Train Loss: 0.202 Vali Loss: 0.389 Vali Acc: 0.855 Test Loss: 0.389 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855069).  Saving model ...
Epoch: 9 cost time: 1.9288568496704102
Epoch: 9, Steps: 9 | Train Loss: 0.220 Vali Loss: 0.378 Vali Acc: 0.884 Test Loss: 0.378 Test Acc: 0.884
Validation loss decreased (-0.855069 --> -0.884054).  Saving model ...
Epoch: 10 cost time: 1.8785161972045898
Epoch: 10, Steps: 9 | Train Loss: 0.127 Vali Loss: 0.343 Vali Acc: 0.906 Test Loss: 0.343 Test Acc: 0.906
Validation loss decreased (-0.884054 --> -0.905794).  Saving model ...
Epoch: 11 cost time: 1.8366971015930176
Epoch: 11, Steps: 9 | Train Loss: 0.153 Vali Loss: 0.367 Vali Acc: 0.877 Test Loss: 0.367 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9474892616271973
Epoch: 12, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.445 Vali Acc: 0.826 Test Loss: 0.445 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.9330227375030518
Epoch: 13, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.431 Vali Acc: 0.848 Test Loss: 0.431 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.9403958320617676
Epoch: 14, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.423 Vali Acc: 0.855 Test Loss: 0.423 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.847299337387085
Epoch: 15, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.401 Vali Acc: 0.877 Test Loss: 0.401 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.07766056060791
Epoch: 16, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.420 Vali Acc: 0.862 Test Loss: 0.420 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.928570032119751
Epoch: 17, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.409 Vali Acc: 0.877 Test Loss: 0.409 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.936326503753662
Epoch: 18, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.428 Vali Acc: 0.870 Test Loss: 0.428 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.8960373401641846
Epoch: 19, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.449 Vali Acc: 0.855 Test Loss: 0.449 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.870187759399414
Epoch: 20, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.414 Vali Acc: 0.870 Test Loss: 0.414 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 371428
model size : 2.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.2105207443237305
Epoch: 1, Steps: 9 | Train Loss: 1.354 Vali Loss: 1.305 Vali Acc: 0.319 Test Loss: 1.305 Test Acc: 0.319
Validation loss decreased (inf --> -0.318828).  Saving model ...
Epoch: 2 cost time: 2.373664140701294
Epoch: 2, Steps: 9 | Train Loss: 1.216 Vali Loss: 1.139 Vali Acc: 0.543 Test Loss: 1.139 Test Acc: 0.543
Validation loss decreased (-0.318828 --> -0.543467).  Saving model ...
Epoch: 3 cost time: 1.9917325973510742
Epoch: 3, Steps: 9 | Train Loss: 0.988 Vali Loss: 0.955 Vali Acc: 0.630 Test Loss: 0.955 Test Acc: 0.630
Validation loss decreased (-0.543467 --> -0.630425).  Saving model ...
Epoch: 4 cost time: 1.9952991008758545
Epoch: 4, Steps: 9 | Train Loss: 0.838 Vali Loss: 0.786 Vali Acc: 0.739 Test Loss: 0.786 Test Acc: 0.739
Validation loss decreased (-0.630425 --> -0.739123).  Saving model ...
Epoch: 5 cost time: 2.06522274017334
Epoch: 5, Steps: 9 | Train Loss: 0.646 Vali Loss: 0.659 Vali Acc: 0.790 Test Loss: 0.659 Test Acc: 0.790
Validation loss decreased (-0.739123 --> -0.789848).  Saving model ...
Epoch: 6 cost time: 2.456876516342163
Epoch: 6, Steps: 9 | Train Loss: 0.499 Vali Loss: 0.565 Vali Acc: 0.812 Test Loss: 0.565 Test Acc: 0.812
Validation loss decreased (-0.789848 --> -0.811589).  Saving model ...
Epoch: 7 cost time: 2.4224600791931152
Epoch: 7, Steps: 9 | Train Loss: 0.360 Vali Loss: 0.499 Vali Acc: 0.804 Test Loss: 0.499 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4069008827209473
Epoch: 8, Steps: 9 | Train Loss: 0.306 Vali Loss: 0.481 Vali Acc: 0.870 Test Loss: 0.481 Test Acc: 0.870
Validation loss decreased (-0.811589 --> -0.869560).  Saving model ...
Epoch: 9 cost time: 2.445141077041626
Epoch: 9, Steps: 9 | Train Loss: 0.555 Vali Loss: 0.419 Vali Acc: 0.848 Test Loss: 0.419 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.2674615383148193
Epoch: 10, Steps: 9 | Train Loss: 0.444 Vali Loss: 0.379 Vali Acc: 0.862 Test Loss: 0.379 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.4041218757629395
Epoch: 11, Steps: 9 | Train Loss: 0.137 Vali Loss: 0.359 Vali Acc: 0.855 Test Loss: 0.359 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.372671365737915
Epoch: 12, Steps: 9 | Train Loss: 0.117 Vali Loss: 0.355 Vali Acc: 0.870 Test Loss: 0.355 Test Acc: 0.870
Validation loss decreased (-0.869560 --> -0.869562).  Saving model ...
Epoch: 13 cost time: 2.453477621078491
Epoch: 13, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.340 Vali Acc: 0.877 Test Loss: 0.340 Test Acc: 0.877
Validation loss decreased (-0.869562 --> -0.876808).  Saving model ...
Epoch: 14 cost time: 2.3943164348602295
Epoch: 14, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.325 Vali Acc: 0.862 Test Loss: 0.325 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.0747687816619873
Epoch: 15, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.353 Vali Acc: 0.862 Test Loss: 0.353 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.4406020641326904
Epoch: 16, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.359 Vali Acc: 0.855 Test Loss: 0.359 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.3993284702301025
Epoch: 17, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.359 Vali Acc: 0.870 Test Loss: 0.359 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.4665374755859375
Epoch: 18, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.353 Vali Acc: 0.884 Test Loss: 0.353 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884054).  Saving model ...
Epoch: 19 cost time: 2.2911853790283203
Epoch: 19, Steps: 9 | Train Loss: 0.221 Vali Loss: 0.346 Vali Acc: 0.891 Test Loss: 0.346 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891301).  Saving model ...
Epoch: 20 cost time: 2.0965607166290283
Epoch: 20, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.350 Vali Acc: 0.891 Test Loss: 0.350 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.362791061401367
Epoch: 21, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.440 Vali Acc: 0.841 Test Loss: 0.440 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.3733203411102295
Epoch: 22, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.451 Vali Acc: 0.855 Test Loss: 0.451 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.164884328842163
Epoch: 23, Steps: 9 | Train Loss: 0.191 Vali Loss: 0.390 Vali Acc: 0.862 Test Loss: 0.390 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.3663277626037598
Epoch: 24, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.369 Vali Acc: 0.877 Test Loss: 0.369 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.3893744945526123
Epoch: 25, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.358 Vali Acc: 0.877 Test Loss: 0.358 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.4485979080200195
Epoch: 26, Steps: 9 | Train Loss: 0.174 Vali Loss: 0.383 Vali Acc: 0.870 Test Loss: 0.383 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.382741689682007
Epoch: 27, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.336 Vali Acc: 0.877 Test Loss: 0.336 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.01788592338562
Epoch: 28, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.344 Vali Acc: 0.884 Test Loss: 0.344 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.517679214477539
Epoch: 29, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.305 Vali Acc: 0.891 Test Loss: 0.305 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 30 cost time: 2.519160270690918
Epoch: 30, Steps: 9 | Train Loss: 0.112 Vali Loss: 0.272 Vali Acc: 0.920 Test Loss: 0.272 Test Acc: 0.920
Validation loss decreased (-0.891301 --> -0.920287).  Saving model ...
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 1199076
model size : 5.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.405056953430176
Epoch: 1, Steps: 9 | Train Loss: 1.429 Vali Loss: 1.357 Vali Acc: 0.304 Test Loss: 1.357 Test Acc: 0.304
Validation loss decreased (inf --> -0.304334).  Saving model ...
Epoch: 2 cost time: 1.6007194519042969
Epoch: 2, Steps: 9 | Train Loss: 1.248 Vali Loss: 1.199 Vali Acc: 0.391 Test Loss: 1.199 Test Acc: 0.391
Validation loss decreased (-0.304334 --> -0.391292).  Saving model ...
Epoch: 3 cost time: 1.6231122016906738
Epoch: 3, Steps: 9 | Train Loss: 1.040 Vali Loss: 1.024 Vali Acc: 0.536 Test Loss: 1.024 Test Acc: 0.536
Validation loss decreased (-0.391292 --> -0.536222).  Saving model ...
Epoch: 4 cost time: 1.5800423622131348
Epoch: 4, Steps: 9 | Train Loss: 0.845 Vali Loss: 0.873 Vali Acc: 0.587 Test Loss: 0.873 Test Acc: 0.587
Validation loss decreased (-0.536222 --> -0.586948).  Saving model ...
Epoch: 5 cost time: 1.6173014640808105
Epoch: 5, Steps: 9 | Train Loss: 0.653 Vali Loss: 0.700 Vali Acc: 0.732 Test Loss: 0.700 Test Acc: 0.732
Validation loss decreased (-0.586948 --> -0.731877).  Saving model ...
Epoch: 6 cost time: 1.6251907348632812
Epoch: 6, Steps: 9 | Train Loss: 0.488 Vali Loss: 0.534 Vali Acc: 0.833 Test Loss: 0.534 Test Acc: 0.833
Validation loss decreased (-0.731877 --> -0.833328).  Saving model ...
Epoch: 7 cost time: 1.7475881576538086
Epoch: 7, Steps: 9 | Train Loss: 0.384 Vali Loss: 0.458 Vali Acc: 0.848 Test Loss: 0.458 Test Acc: 0.848
Validation loss decreased (-0.833328 --> -0.847822).  Saving model ...
Epoch: 8 cost time: 1.646880865097046
Epoch: 8, Steps: 9 | Train Loss: 0.253 Vali Loss: 0.403 Vali Acc: 0.841 Test Loss: 0.403 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6050896644592285
Epoch: 9, Steps: 9 | Train Loss: 0.264 Vali Loss: 0.388 Vali Acc: 0.855 Test Loss: 0.388 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855069).  Saving model ...
Epoch: 10 cost time: 1.6414580345153809
Epoch: 10, Steps: 9 | Train Loss: 0.156 Vali Loss: 0.363 Vali Acc: 0.884 Test Loss: 0.363 Test Acc: 0.884
Validation loss decreased (-0.855069 --> -0.884054).  Saving model ...
Epoch: 11 cost time: 1.5322096347808838
Epoch: 11, Steps: 9 | Train Loss: 0.133 Vali Loss: 0.352 Vali Acc: 0.877 Test Loss: 0.352 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5996181964874268
Epoch: 12, Steps: 9 | Train Loss: 0.106 Vali Loss: 0.419 Vali Acc: 0.848 Test Loss: 0.419 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6544249057769775
Epoch: 13, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.373 Vali Acc: 0.884 Test Loss: 0.373 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5398342609405518
Epoch: 14, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.372 Vali Acc: 0.870 Test Loss: 0.372 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.5463218688964844
Epoch: 15, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.375 Vali Acc: 0.870 Test Loss: 0.375 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.6626641750335693
Epoch: 16, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.377 Vali Acc: 0.870 Test Loss: 0.377 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.6057884693145752
Epoch: 17, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.365 Vali Acc: 0.877 Test Loss: 0.365 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.5898237228393555
Epoch: 18, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.377 Vali Acc: 0.891 Test Loss: 0.377 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891301).  Saving model ...
Epoch: 19 cost time: 1.6402778625488281
Epoch: 19, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.393 Vali Acc: 0.884 Test Loss: 0.393 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5994136333465576
Epoch: 20, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.413 Vali Acc: 0.877 Test Loss: 0.413 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.6291723251342773
Epoch: 21, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.393 Vali Acc: 0.884 Test Loss: 0.393 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.7512624263763428
Epoch: 22, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.385 Vali Acc: 0.899 Test Loss: 0.385 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898547).  Saving model ...
Epoch: 23 cost time: 1.4850678443908691
Epoch: 23, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.401 Vali Acc: 0.891 Test Loss: 0.401 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.6263854503631592
Epoch: 24, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.379 Vali Acc: 0.899 Test Loss: 0.379 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 25 cost time: 1.638916254043579
Epoch: 25, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.414 Vali Acc: 0.891 Test Loss: 0.414 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.539754867553711
Epoch: 26, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.481 Vali Acc: 0.870 Test Loss: 0.481 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.5507793426513672
Epoch: 27, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.461 Vali Acc: 0.891 Test Loss: 0.461 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.6144943237304688
Epoch: 28, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.423 Vali Acc: 0.884 Test Loss: 0.423 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.6296231746673584
Epoch: 29, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.389 Vali Acc: 0.899 Test Loss: 0.389 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.633683443069458
Epoch: 30, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.390 Vali Acc: 0.899 Test Loss: 0.390 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 371428
model size : 2.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.5374977588653564
Epoch: 1, Steps: 9 | Train Loss: 1.358 Vali Loss: 1.316 Vali Acc: 0.283 Test Loss: 1.316 Test Acc: 0.283
Validation loss decreased (inf --> -0.282596).  Saving model ...
Epoch: 2 cost time: 1.8379898071289062
Epoch: 2, Steps: 9 | Train Loss: 1.233 Vali Loss: 1.180 Vali Acc: 0.507 Test Loss: 1.180 Test Acc: 0.507
Validation loss decreased (-0.282596 --> -0.507235).  Saving model ...
Epoch: 3 cost time: 1.9260506629943848
Epoch: 3, Steps: 9 | Train Loss: 1.017 Vali Loss: 1.048 Vali Acc: 0.529 Test Loss: 1.048 Test Acc: 0.529
Validation loss decreased (-0.507235 --> -0.528975).  Saving model ...
Epoch: 4 cost time: 1.8360912799835205
Epoch: 4, Steps: 9 | Train Loss: 0.879 Vali Loss: 0.905 Vali Acc: 0.659 Test Loss: 0.905 Test Acc: 0.659
Validation loss decreased (-0.528975 --> -0.659411).  Saving model ...
Epoch: 5 cost time: 1.9329884052276611
Epoch: 5, Steps: 9 | Train Loss: 0.712 Vali Loss: 0.796 Vali Acc: 0.696 Test Loss: 0.796 Test Acc: 0.696
Validation loss decreased (-0.659411 --> -0.695644).  Saving model ...
Epoch: 6 cost time: 1.743333339691162
Epoch: 6, Steps: 9 | Train Loss: 0.594 Vali Loss: 0.704 Vali Acc: 0.732 Test Loss: 0.704 Test Acc: 0.732
Validation loss decreased (-0.695644 --> -0.731877).  Saving model ...
Epoch: 7 cost time: 1.8608665466308594
Epoch: 7, Steps: 9 | Train Loss: 0.482 Vali Loss: 0.661 Vali Acc: 0.746 Test Loss: 0.661 Test Acc: 0.746
Validation loss decreased (-0.731877 --> -0.746370).  Saving model ...
Epoch: 8 cost time: 1.9437952041625977
Epoch: 8, Steps: 9 | Train Loss: 0.353 Vali Loss: 0.602 Vali Acc: 0.783 Test Loss: 0.602 Test Acc: 0.783
Validation loss decreased (-0.746370 --> -0.782603).  Saving model ...
Epoch: 9 cost time: 1.9108624458312988
Epoch: 9, Steps: 9 | Train Loss: 0.261 Vali Loss: 0.547 Vali Acc: 0.790 Test Loss: 0.547 Test Acc: 0.790
Validation loss decreased (-0.782603 --> -0.789850).  Saving model ...
Epoch: 10 cost time: 1.840815544128418
Epoch: 10, Steps: 9 | Train Loss: 0.203 Vali Loss: 0.483 Vali Acc: 0.826 Test Loss: 0.483 Test Acc: 0.826
Validation loss decreased (-0.789850 --> -0.826082).  Saving model ...
Epoch: 11 cost time: 1.7017426490783691
Epoch: 11, Steps: 9 | Train Loss: 0.139 Vali Loss: 0.458 Vali Acc: 0.812 Test Loss: 0.458 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6075069904327393
Epoch: 12, Steps: 9 | Train Loss: 0.106 Vali Loss: 0.385 Vali Acc: 0.841 Test Loss: 0.385 Test Acc: 0.841
Validation loss decreased (-0.826082 --> -0.840576).  Saving model ...
Epoch: 13 cost time: 1.5838525295257568
Epoch: 13, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.365 Vali Acc: 0.855 Test Loss: 0.365 Test Acc: 0.855
Validation loss decreased (-0.840576 --> -0.855069).  Saving model ...
Epoch: 14 cost time: 1.614464521408081
Epoch: 14, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.421 Vali Acc: 0.848 Test Loss: 0.421 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7912909984588623
Epoch: 15, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.475 Vali Acc: 0.826 Test Loss: 0.475 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7573521137237549
Epoch: 16, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.417 Vali Acc: 0.848 Test Loss: 0.417 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.7948851585388184
Epoch: 17, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.371 Vali Acc: 0.877 Test Loss: 0.371 Test Acc: 0.877
Validation loss decreased (-0.855069 --> -0.876808).  Saving model ...
Epoch: 18 cost time: 1.8173129558563232
Epoch: 18, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.424 Vali Acc: 0.848 Test Loss: 0.424 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8151543140411377
Epoch: 19, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.422 Vali Acc: 0.855 Test Loss: 0.422 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.8036298751831055
Epoch: 20, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.383 Vali Acc: 0.870 Test Loss: 0.383 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.8356940746307373
Epoch: 21, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.374 Vali Acc: 0.870 Test Loss: 0.374 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.8130700588226318
Epoch: 22, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.368 Vali Acc: 0.870 Test Loss: 0.368 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.6618714332580566
Epoch: 23, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.395 Vali Acc: 0.862 Test Loss: 0.395 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.7837953567504883
Epoch: 24, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.699 Vali Acc: 0.768 Test Loss: 0.699 Test Acc: 0.768
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.7112314701080322
Epoch: 25, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.584 Vali Acc: 0.790 Test Loss: 0.584 Test Acc: 0.790
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.8721837997436523
Epoch: 26, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.497 Vali Acc: 0.819 Test Loss: 0.497 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.7647409439086914
Epoch: 27, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.379 Vali Acc: 0.891 Test Loss: 0.379 Test Acc: 0.891
Validation loss decreased (-0.876808 --> -0.891301).  Saving model ...
Epoch: 28 cost time: 1.8072569370269775
Epoch: 28, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.397 Vali Acc: 0.870 Test Loss: 0.397 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.7704343795776367
Epoch: 29, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.486 Vali Acc: 0.848 Test Loss: 0.486 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.8071527481079102
Epoch: 30, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.446 Vali Acc: 0.862 Test Loss: 0.446 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 1199076
model size : 5.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.083054780960083
Epoch: 1, Steps: 9 | Train Loss: 1.430 Vali Loss: 1.357 Vali Acc: 0.290 Test Loss: 1.357 Test Acc: 0.290
Validation loss decreased (inf --> -0.289842).  Saving model ...
Epoch: 2 cost time: 1.2814958095550537
Epoch: 2, Steps: 9 | Train Loss: 1.252 Vali Loss: 1.203 Vali Acc: 0.370 Test Loss: 1.203 Test Acc: 0.370
Validation loss decreased (-0.289842 --> -0.369553).  Saving model ...
Epoch: 3 cost time: 1.2510778903961182
Epoch: 3, Steps: 9 | Train Loss: 1.054 Vali Loss: 1.044 Vali Acc: 0.522 Test Loss: 1.044 Test Acc: 0.522
Validation loss decreased (-0.369553 --> -0.521729).  Saving model ...
Epoch: 4 cost time: 1.2875115871429443
Epoch: 4, Steps: 9 | Train Loss: 0.874 Vali Loss: 0.929 Vali Acc: 0.558 Test Loss: 0.929 Test Acc: 0.558
Validation loss decreased (-0.521729 --> -0.557962).  Saving model ...
Epoch: 5 cost time: 1.313093900680542
Epoch: 5, Steps: 9 | Train Loss: 0.704 Vali Loss: 0.809 Vali Acc: 0.609 Test Loss: 0.809 Test Acc: 0.609
Validation loss decreased (-0.557962 --> -0.608688).  Saving model ...
Epoch: 6 cost time: 1.3171603679656982
Epoch: 6, Steps: 9 | Train Loss: 0.541 Vali Loss: 0.684 Vali Acc: 0.732 Test Loss: 0.684 Test Acc: 0.732
Validation loss decreased (-0.608688 --> -0.731877).  Saving model ...
Epoch: 7 cost time: 1.269608736038208
Epoch: 7, Steps: 9 | Train Loss: 0.437 Vali Loss: 0.601 Vali Acc: 0.783 Test Loss: 0.601 Test Acc: 0.783
Validation loss decreased (-0.731877 --> -0.782603).  Saving model ...
Epoch: 8 cost time: 1.2087945938110352
Epoch: 8, Steps: 9 | Train Loss: 0.336 Vali Loss: 0.524 Vali Acc: 0.826 Test Loss: 0.524 Test Acc: 0.826
Validation loss decreased (-0.782603 --> -0.826082).  Saving model ...
Epoch: 9 cost time: 1.260535478591919
Epoch: 9, Steps: 9 | Train Loss: 0.233 Vali Loss: 0.466 Vali Acc: 0.848 Test Loss: 0.466 Test Acc: 0.848
Validation loss decreased (-0.826082 --> -0.847821).  Saving model ...
Epoch: 10 cost time: 1.2120716571807861
Epoch: 10, Steps: 9 | Train Loss: 0.168 Vali Loss: 0.449 Vali Acc: 0.848 Test Loss: 0.449 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847822).  Saving model ...
Epoch: 11 cost time: 1.2861146926879883
Epoch: 11, Steps: 9 | Train Loss: 0.126 Vali Loss: 0.441 Vali Acc: 0.819 Test Loss: 0.441 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.296663761138916
Epoch: 12, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.490 Vali Acc: 0.833 Test Loss: 0.490 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3163506984710693
Epoch: 13, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.470 Vali Acc: 0.855 Test Loss: 0.470 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855068).  Saving model ...
Epoch: 14 cost time: 1.2397286891937256
Epoch: 14, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.459 Vali Acc: 0.855 Test Loss: 0.459 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 15 cost time: 1.2995810508728027
Epoch: 15, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.439 Vali Acc: 0.862 Test Loss: 0.439 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862314).  Saving model ...
Epoch: 16 cost time: 1.2634894847869873
Epoch: 16, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.435 Vali Acc: 0.862 Test Loss: 0.435 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 17 cost time: 1.3350050449371338
Epoch: 17, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.423 Vali Acc: 0.870 Test Loss: 0.423 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869561).  Saving model ...
Epoch: 18 cost time: 1.3048357963562012
Epoch: 18, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.418 Vali Acc: 0.870 Test Loss: 0.418 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 19 cost time: 1.294806718826294
Epoch: 19, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.407 Vali Acc: 0.877 Test Loss: 0.407 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876808).  Saving model ...
Epoch: 20 cost time: 1.2764086723327637
Epoch: 20, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.417 Vali Acc: 0.877 Test Loss: 0.417 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3284335136413574
Epoch: 21, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.424 Vali Acc: 0.877 Test Loss: 0.424 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.3172574043273926
Epoch: 22, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.417 Vali Acc: 0.877 Test Loss: 0.417 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.2972979545593262
Epoch: 23, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.425 Vali Acc: 0.877 Test Loss: 0.425 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.249544620513916
Epoch: 24, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.410 Vali Acc: 0.877 Test Loss: 0.410 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.3029758930206299
Epoch: 25, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.408 Vali Acc: 0.877 Test Loss: 0.408 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.204345464706421
Epoch: 26, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.432 Vali Acc: 0.870 Test Loss: 0.432 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.1347723007202148
Epoch: 27, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.447 Vali Acc: 0.870 Test Loss: 0.447 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.2840449810028076
Epoch: 28, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.446 Vali Acc: 0.877 Test Loss: 0.446 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.350562334060669
Epoch: 29, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.449 Vali Acc: 0.877 Test Loss: 0.449 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 371428
model size : 2.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.022507667541504
Epoch: 1, Steps: 9 | Train Loss: 1.473 Vali Loss: 1.410 Vali Acc: 0.319 Test Loss: 1.410 Test Acc: 0.319
Validation loss decreased (inf --> -0.318826).  Saving model ...
Epoch: 2 cost time: 3.2777113914489746
Epoch: 2, Steps: 9 | Train Loss: 1.376 Vali Loss: 1.290 Vali Acc: 0.399 Test Loss: 1.290 Test Acc: 0.399
Validation loss decreased (-0.318826 --> -0.398538).  Saving model ...
Epoch: 3 cost time: 3.3767576217651367
Epoch: 3, Steps: 9 | Train Loss: 1.191 Vali Loss: 1.159 Vali Acc: 0.500 Test Loss: 1.159 Test Acc: 0.500
Validation loss decreased (-0.398538 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 3.167030096054077
Epoch: 4, Steps: 9 | Train Loss: 1.056 Vali Loss: 1.031 Vali Acc: 0.645 Test Loss: 1.031 Test Acc: 0.645
Validation loss decreased (-0.499988 --> -0.644917).  Saving model ...
Epoch: 5 cost time: 2.8675711154937744
Epoch: 5, Steps: 9 | Train Loss: 0.894 Vali Loss: 0.906 Vali Acc: 0.688 Test Loss: 0.906 Test Acc: 0.688
Validation loss decreased (-0.644917 --> -0.688397).  Saving model ...
Epoch: 6 cost time: 2.836660146713257
Epoch: 6, Steps: 9 | Train Loss: 0.786 Vali Loss: 0.777 Vali Acc: 0.717 Test Loss: 0.777 Test Acc: 0.717
Validation loss decreased (-0.688397 --> -0.717384).  Saving model ...
Epoch: 7 cost time: 2.5586750507354736
Epoch: 7, Steps: 9 | Train Loss: 0.656 Vali Loss: 0.667 Vali Acc: 0.717 Test Loss: 0.667 Test Acc: 0.717
Validation loss decreased (-0.717384 --> -0.717385).  Saving model ...
Epoch: 8 cost time: 2.6757962703704834
Epoch: 8, Steps: 9 | Train Loss: 0.543 Vali Loss: 0.578 Vali Acc: 0.790 Test Loss: 0.578 Test Acc: 0.790
Validation loss decreased (-0.717385 --> -0.789849).  Saving model ...
Epoch: 9 cost time: 3.27480149269104
Epoch: 9, Steps: 9 | Train Loss: 0.459 Vali Loss: 0.521 Vali Acc: 0.812 Test Loss: 0.521 Test Acc: 0.812
Validation loss decreased (-0.789849 --> -0.811589).  Saving model ...
Epoch: 10 cost time: 3.240981101989746
Epoch: 10, Steps: 9 | Train Loss: 0.346 Vali Loss: 0.486 Vali Acc: 0.826 Test Loss: 0.486 Test Acc: 0.826
Validation loss decreased (-0.811589 --> -0.826082).  Saving model ...
Epoch: 11 cost time: 3.6456620693206787
Epoch: 11, Steps: 9 | Train Loss: 0.314 Vali Loss: 0.409 Vali Acc: 0.855 Test Loss: 0.409 Test Acc: 0.855
Validation loss decreased (-0.826082 --> -0.855068).  Saving model ...
Epoch: 12 cost time: 3.5913443565368652
Epoch: 12, Steps: 9 | Train Loss: 0.233 Vali Loss: 0.397 Vali Acc: 0.862 Test Loss: 0.397 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862315).  Saving model ...
Epoch: 13 cost time: 3.430962324142456
Epoch: 13, Steps: 9 | Train Loss: 0.178 Vali Loss: 0.366 Vali Acc: 0.870 Test Loss: 0.366 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869562).  Saving model ...
Epoch: 14 cost time: 3.650771379470825
Epoch: 14, Steps: 9 | Train Loss: 0.155 Vali Loss: 0.371 Vali Acc: 0.862 Test Loss: 0.371 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.671069383621216
Epoch: 15, Steps: 9 | Train Loss: 0.119 Vali Loss: 0.359 Vali Acc: 0.862 Test Loss: 0.359 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.6446938514709473
Epoch: 16, Steps: 9 | Train Loss: 0.087 Vali Loss: 0.406 Vali Acc: 0.841 Test Loss: 0.406 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.439882755279541
Epoch: 17, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.383 Vali Acc: 0.877 Test Loss: 0.383 Test Acc: 0.877
Validation loss decreased (-0.869562 --> -0.876808).  Saving model ...
Epoch: 18 cost time: 3.3209733963012695
Epoch: 18, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.329 Vali Acc: 0.877 Test Loss: 0.329 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 19 cost time: 3.562730312347412
Epoch: 19, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.407 Vali Acc: 0.870 Test Loss: 0.407 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.7101731300354004
Epoch: 20, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.390 Vali Acc: 0.862 Test Loss: 0.390 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.6687917709350586
Epoch: 21, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.387 Vali Acc: 0.877 Test Loss: 0.387 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.5672731399536133
Epoch: 22, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.410 Vali Acc: 0.877 Test Loss: 0.410 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.274911880493164
Epoch: 23, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.380 Vali Acc: 0.884 Test Loss: 0.380 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884054).  Saving model ...
Epoch: 24 cost time: 3.51251220703125
Epoch: 24, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.323 Vali Acc: 0.899 Test Loss: 0.323 Test Acc: 0.899
Validation loss decreased (-0.884054 --> -0.898547).  Saving model ...
Epoch: 25 cost time: 3.6331279277801514
Epoch: 25, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.348 Vali Acc: 0.899 Test Loss: 0.348 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.626612424850464
Epoch: 26, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.363 Vali Acc: 0.913 Test Loss: 0.363 Test Acc: 0.913
Validation loss decreased (-0.898547 --> -0.913040).  Saving model ...
Epoch: 27 cost time: 3.58695387840271
Epoch: 27, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.381 Vali Acc: 0.877 Test Loss: 0.381 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.3791325092315674
Epoch: 28, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.381 Vali Acc: 0.862 Test Loss: 0.381 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.6487929821014404
Epoch: 29, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.391 Vali Acc: 0.877 Test Loss: 0.391 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.4001758098602295
Epoch: 30, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.405 Vali Acc: 0.877 Test Loss: 0.405 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 1185844
model size : 4.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.405317544937134
Epoch: 1, Steps: 9 | Train Loss: 1.481 Vali Loss: 1.376 Vali Acc: 0.319 Test Loss: 1.376 Test Acc: 0.319
Validation loss decreased (inf --> -0.318827).  Saving model ...
Epoch: 2 cost time: 2.2443134784698486
Epoch: 2, Steps: 9 | Train Loss: 1.370 Vali Loss: 1.256 Vali Acc: 0.507 Test Loss: 1.256 Test Acc: 0.507
Validation loss decreased (-0.318827 --> -0.507234).  Saving model ...
Epoch: 3 cost time: 2.2609987258911133
Epoch: 3, Steps: 9 | Train Loss: 1.178 Vali Loss: 1.117 Vali Acc: 0.623 Test Loss: 1.117 Test Acc: 0.623
Validation loss decreased (-0.507234 --> -0.623177).  Saving model ...
Epoch: 4 cost time: 2.132016897201538
Epoch: 4, Steps: 9 | Train Loss: 1.051 Vali Loss: 0.976 Vali Acc: 0.688 Test Loss: 0.976 Test Acc: 0.688
Validation loss decreased (-0.623177 --> -0.688396).  Saving model ...
Epoch: 5 cost time: 2.2583565711975098
Epoch: 5, Steps: 9 | Train Loss: 0.892 Vali Loss: 0.838 Vali Acc: 0.739 Test Loss: 0.838 Test Acc: 0.739
Validation loss decreased (-0.688396 --> -0.739122).  Saving model ...
Epoch: 6 cost time: 2.314188003540039
Epoch: 6, Steps: 9 | Train Loss: 0.695 Vali Loss: 0.683 Vali Acc: 0.754 Test Loss: 0.683 Test Acc: 0.754
Validation loss decreased (-0.739122 --> -0.753616).  Saving model ...
Epoch: 7 cost time: 2.090959310531616
Epoch: 7, Steps: 9 | Train Loss: 0.646 Vali Loss: 0.586 Vali Acc: 0.775 Test Loss: 0.586 Test Acc: 0.775
Validation loss decreased (-0.753616 --> -0.775356).  Saving model ...
Epoch: 8 cost time: 2.158196449279785
Epoch: 8, Steps: 9 | Train Loss: 0.454 Vali Loss: 0.523 Vali Acc: 0.804 Test Loss: 0.523 Test Acc: 0.804
Validation loss decreased (-0.775356 --> -0.804343).  Saving model ...
Epoch: 9 cost time: 2.3078010082244873
Epoch: 9, Steps: 9 | Train Loss: 0.426 Vali Loss: 0.481 Vali Acc: 0.833 Test Loss: 0.481 Test Acc: 0.833
Validation loss decreased (-0.804343 --> -0.833329).  Saving model ...
Epoch: 10 cost time: 2.0610928535461426
Epoch: 10, Steps: 9 | Train Loss: 0.296 Vali Loss: 0.477 Vali Acc: 0.826 Test Loss: 0.477 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.215791940689087
Epoch: 11, Steps: 9 | Train Loss: 0.233 Vali Loss: 0.456 Vali Acc: 0.826 Test Loss: 0.456 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.258692502975464
Epoch: 12, Steps: 9 | Train Loss: 0.207 Vali Loss: 0.447 Vali Acc: 0.826 Test Loss: 0.447 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.2262895107269287
Epoch: 13, Steps: 9 | Train Loss: 0.190 Vali Loss: 0.425 Vali Acc: 0.841 Test Loss: 0.425 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840575).  Saving model ...
Epoch: 14 cost time: 2.2358169555664062
Epoch: 14, Steps: 9 | Train Loss: 0.151 Vali Loss: 0.453 Vali Acc: 0.862 Test Loss: 0.453 Test Acc: 0.862
Validation loss decreased (-0.840575 --> -0.862314).  Saving model ...
Epoch: 15 cost time: 2.308192014694214
Epoch: 15, Steps: 9 | Train Loss: 0.127 Vali Loss: 0.442 Vali Acc: 0.870 Test Loss: 0.442 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869561).  Saving model ...
Epoch: 16 cost time: 2.34564471244812
Epoch: 16, Steps: 9 | Train Loss: 0.096 Vali Loss: 0.401 Vali Acc: 0.855 Test Loss: 0.401 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.1443593502044678
Epoch: 17, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.433 Vali Acc: 0.862 Test Loss: 0.433 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.278290271759033
Epoch: 18, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.428 Vali Acc: 0.877 Test Loss: 0.428 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876807).  Saving model ...
Epoch: 19 cost time: 2.3279855251312256
Epoch: 19, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.436 Vali Acc: 0.870 Test Loss: 0.436 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.1396713256835938
Epoch: 20, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.408 Vali Acc: 0.870 Test Loss: 0.408 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.324570417404175
Epoch: 21, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.402 Vali Acc: 0.870 Test Loss: 0.402 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.3523693084716797
Epoch: 22, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.420 Vali Acc: 0.884 Test Loss: 0.420 Test Acc: 0.884
Validation loss decreased (-0.876807 --> -0.884054).  Saving model ...
Epoch: 23 cost time: 2.5449137687683105
Epoch: 23, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.395 Vali Acc: 0.877 Test Loss: 0.395 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.5375561714172363
Epoch: 24, Steps: 9 | Train Loss: 0.165 Vali Loss: 0.387 Vali Acc: 0.877 Test Loss: 0.387 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.4021663665771484
Epoch: 25, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.361 Vali Acc: 0.891 Test Loss: 0.361 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891301).  Saving model ...
Epoch: 26 cost time: 2.3678672313690186
Epoch: 26, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.476 Vali Acc: 0.841 Test Loss: 0.476 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.352576971054077
Epoch: 27, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.364 Vali Acc: 0.877 Test Loss: 0.364 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.374988079071045
Epoch: 28, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.337 Vali Acc: 0.884 Test Loss: 0.337 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.4618136882781982
Epoch: 29, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.298 Vali Acc: 0.913 Test Loss: 0.298 Test Acc: 0.913
Validation loss decreased (-0.891301 --> -0.913041).  Saving model ...
Epoch: 30 cost time: 2.36167573928833
Epoch: 30, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.335 Vali Acc: 0.891 Test Loss: 0.335 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 358132
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.612730979919434
Epoch: 1, Steps: 9 | Train Loss: 1.471 Vali Loss: 1.412 Vali Acc: 0.312 Test Loss: 1.412 Test Acc: 0.312
Validation loss decreased (inf --> -0.311580).  Saving model ...
Epoch: 2 cost time: 2.948857307434082
Epoch: 2, Steps: 9 | Train Loss: 1.377 Vali Loss: 1.302 Vali Acc: 0.391 Test Loss: 1.302 Test Acc: 0.391
Validation loss decreased (-0.311580 --> -0.391291).  Saving model ...
Epoch: 3 cost time: 2.9714159965515137
Epoch: 3, Steps: 9 | Train Loss: 1.204 Vali Loss: 1.175 Vali Acc: 0.486 Test Loss: 1.175 Test Acc: 0.486
Validation loss decreased (-0.391291 --> -0.485495).  Saving model ...
Epoch: 4 cost time: 2.902700185775757
Epoch: 4, Steps: 9 | Train Loss: 1.082 Vali Loss: 1.057 Vali Acc: 0.609 Test Loss: 1.057 Test Acc: 0.609
Validation loss decreased (-0.485495 --> -0.608685).  Saving model ...
Epoch: 5 cost time: 2.4263339042663574
Epoch: 5, Steps: 9 | Train Loss: 0.935 Vali Loss: 0.962 Vali Acc: 0.659 Test Loss: 0.962 Test Acc: 0.659
Validation loss decreased (-0.608685 --> -0.659411).  Saving model ...
Epoch: 6 cost time: 2.3849523067474365
Epoch: 6, Steps: 9 | Train Loss: 0.841 Vali Loss: 0.874 Vali Acc: 0.681 Test Loss: 0.874 Test Acc: 0.681
Validation loss decreased (-0.659411 --> -0.681151).  Saving model ...
Epoch: 7 cost time: 2.617734432220459
Epoch: 7, Steps: 9 | Train Loss: 0.731 Vali Loss: 0.778 Vali Acc: 0.696 Test Loss: 0.778 Test Acc: 0.696
Validation loss decreased (-0.681151 --> -0.695644).  Saving model ...
Epoch: 8 cost time: 2.737259864807129
Epoch: 8, Steps: 9 | Train Loss: 0.607 Vali Loss: 0.693 Vali Acc: 0.739 Test Loss: 0.693 Test Acc: 0.739
Validation loss decreased (-0.695644 --> -0.739124).  Saving model ...
Epoch: 9 cost time: 2.707841157913208
Epoch: 9, Steps: 9 | Train Loss: 0.492 Vali Loss: 0.609 Vali Acc: 0.783 Test Loss: 0.609 Test Acc: 0.783
Validation loss decreased (-0.739124 --> -0.782603).  Saving model ...
Epoch: 10 cost time: 2.5887155532836914
Epoch: 10, Steps: 9 | Train Loss: 0.389 Vali Loss: 0.554 Vali Acc: 0.790 Test Loss: 0.554 Test Acc: 0.790
Validation loss decreased (-0.782603 --> -0.789850).  Saving model ...
Epoch: 11 cost time: 2.779397487640381
Epoch: 11, Steps: 9 | Train Loss: 0.331 Vali Loss: 0.507 Vali Acc: 0.826 Test Loss: 0.507 Test Acc: 0.826
Validation loss decreased (-0.789850 --> -0.826082).  Saving model ...
Epoch: 12 cost time: 2.672727346420288
Epoch: 12, Steps: 9 | Train Loss: 0.259 Vali Loss: 0.473 Vali Acc: 0.833 Test Loss: 0.473 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833329).  Saving model ...
Epoch: 13 cost time: 2.643176794052124
Epoch: 13, Steps: 9 | Train Loss: 0.191 Vali Loss: 0.448 Vali Acc: 0.826 Test Loss: 0.448 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.649231433868408
Epoch: 14, Steps: 9 | Train Loss: 0.159 Vali Loss: 0.432 Vali Acc: 0.819 Test Loss: 0.432 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.626075029373169
Epoch: 15, Steps: 9 | Train Loss: 0.139 Vali Loss: 0.407 Vali Acc: 0.841 Test Loss: 0.407 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840576).  Saving model ...
Epoch: 16 cost time: 2.707044839859009
Epoch: 16, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.423 Vali Acc: 0.841 Test Loss: 0.423 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.822298765182495
Epoch: 17, Steps: 9 | Train Loss: 0.087 Vali Loss: 0.420 Vali Acc: 0.833 Test Loss: 0.420 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.6752169132232666
Epoch: 18, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.420 Vali Acc: 0.826 Test Loss: 0.420 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.783869743347168
Epoch: 19, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.444 Vali Acc: 0.833 Test Loss: 0.444 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.8323044776916504
Epoch: 20, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.413 Vali Acc: 0.848 Test Loss: 0.413 Test Acc: 0.848
Validation loss decreased (-0.840576 --> -0.847822).  Saving model ...
Epoch: 21 cost time: 2.7956600189208984
Epoch: 21, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.397 Vali Acc: 0.855 Test Loss: 0.397 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855068).  Saving model ...
Epoch: 22 cost time: 2.775664806365967
Epoch: 22, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.420 Vali Acc: 0.848 Test Loss: 0.420 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.7019221782684326
Epoch: 23, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.382 Vali Acc: 0.877 Test Loss: 0.382 Test Acc: 0.877
Validation loss decreased (-0.855068 --> -0.876808).  Saving model ...
Epoch: 24 cost time: 2.791208505630493
Epoch: 24, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.420 Vali Acc: 0.862 Test Loss: 0.420 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.8232035636901855
Epoch: 25, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.423 Vali Acc: 0.862 Test Loss: 0.423 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.6852259635925293
Epoch: 26, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.373 Vali Acc: 0.877 Test Loss: 0.373 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 27 cost time: 2.7170114517211914
Epoch: 27, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.430 Vali Acc: 0.870 Test Loss: 0.430 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.783460855484009
Epoch: 28, Steps: 9 | Train Loss: 0.255 Vali Loss: 0.393 Vali Acc: 0.884 Test Loss: 0.393 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884054).  Saving model ...
Epoch: 29 cost time: 2.7872073650360107
Epoch: 29, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.482 Vali Acc: 0.833 Test Loss: 0.482 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.792095184326172
Epoch: 30, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.442 Vali Acc: 0.870 Test Loss: 0.442 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 1185844
model size : 4.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.797081232070923
Epoch: 1, Steps: 9 | Train Loss: 1.480 Vali Loss: 1.386 Vali Acc: 0.290 Test Loss: 1.386 Test Acc: 0.290
Validation loss decreased (inf --> -0.289841).  Saving model ...
Epoch: 2 cost time: 1.8849599361419678
Epoch: 2, Steps: 9 | Train Loss: 1.381 Vali Loss: 1.270 Vali Acc: 0.486 Test Loss: 1.270 Test Acc: 0.486
Validation loss decreased (-0.289841 --> -0.485495).  Saving model ...
Epoch: 3 cost time: 1.8434689044952393
Epoch: 3, Steps: 9 | Train Loss: 1.197 Vali Loss: 1.140 Vali Acc: 0.616 Test Loss: 1.140 Test Acc: 0.616
Validation loss decreased (-0.485495 --> -0.615931).  Saving model ...
Epoch: 4 cost time: 1.8878068923950195
Epoch: 4, Steps: 9 | Train Loss: 1.072 Vali Loss: 1.006 Vali Acc: 0.674 Test Loss: 1.006 Test Acc: 0.674
Validation loss decreased (-0.615931 --> -0.673903).  Saving model ...
Epoch: 5 cost time: 1.8851337432861328
Epoch: 5, Steps: 9 | Train Loss: 0.924 Vali Loss: 0.879 Vali Acc: 0.725 Test Loss: 0.879 Test Acc: 0.725
Validation loss decreased (-0.673903 --> -0.724629).  Saving model ...
Epoch: 6 cost time: 1.865882158279419
Epoch: 6, Steps: 9 | Train Loss: 0.742 Vali Loss: 0.730 Vali Acc: 0.746 Test Loss: 0.730 Test Acc: 0.746
Validation loss decreased (-0.724629 --> -0.746370).  Saving model ...
Epoch: 7 cost time: 1.9300825595855713
Epoch: 7, Steps: 9 | Train Loss: 0.662 Vali Loss: 0.623 Vali Acc: 0.746 Test Loss: 0.623 Test Acc: 0.746
Validation loss decreased (-0.746370 --> -0.746371).  Saving model ...
Epoch: 8 cost time: 1.9307990074157715
Epoch: 8, Steps: 9 | Train Loss: 0.523 Vali Loss: 0.562 Vali Acc: 0.783 Test Loss: 0.562 Test Acc: 0.783
Validation loss decreased (-0.746371 --> -0.782603).  Saving model ...
Epoch: 9 cost time: 1.899735927581787
Epoch: 9, Steps: 9 | Train Loss: 0.475 Vali Loss: 0.525 Vali Acc: 0.804 Test Loss: 0.525 Test Acc: 0.804
Validation loss decreased (-0.782603 --> -0.804343).  Saving model ...
Epoch: 10 cost time: 1.8381710052490234
Epoch: 10, Steps: 9 | Train Loss: 0.370 Vali Loss: 0.530 Vali Acc: 0.812 Test Loss: 0.530 Test Acc: 0.812
Validation loss decreased (-0.804343 --> -0.811589).  Saving model ...
Epoch: 11 cost time: 1.918231725692749
Epoch: 11, Steps: 9 | Train Loss: 0.309 Vali Loss: 0.498 Vali Acc: 0.812 Test Loss: 0.498 Test Acc: 0.812
Validation loss decreased (-0.811589 --> -0.811589).  Saving model ...
Epoch: 12 cost time: 1.8880681991577148
Epoch: 12, Steps: 9 | Train Loss: 0.291 Vali Loss: 0.423 Vali Acc: 0.812 Test Loss: 0.423 Test Acc: 0.812
Validation loss decreased (-0.811589 --> -0.811590).  Saving model ...
Epoch: 13 cost time: 1.9212253093719482
Epoch: 13, Steps: 9 | Train Loss: 0.308 Vali Loss: 0.425 Vali Acc: 0.819 Test Loss: 0.425 Test Acc: 0.819
Validation loss decreased (-0.811590 --> -0.818836).  Saving model ...
Epoch: 14 cost time: 1.9312634468078613
Epoch: 14, Steps: 9 | Train Loss: 0.163 Vali Loss: 0.440 Vali Acc: 0.819 Test Loss: 0.440 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.854919672012329
Epoch: 15, Steps: 9 | Train Loss: 0.197 Vali Loss: 0.406 Vali Acc: 0.819 Test Loss: 0.406 Test Acc: 0.819
Validation loss decreased (-0.818836 --> -0.818837).  Saving model ...
Epoch: 16 cost time: 1.9194881916046143
Epoch: 16, Steps: 9 | Train Loss: 0.130 Vali Loss: 0.386 Vali Acc: 0.833 Test Loss: 0.386 Test Acc: 0.833
Validation loss decreased (-0.818837 --> -0.833329).  Saving model ...
Epoch: 17 cost time: 1.9472739696502686
Epoch: 17, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.421 Vali Acc: 0.812 Test Loss: 0.421 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8836708068847656
Epoch: 18, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.383 Vali Acc: 0.833 Test Loss: 0.383 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833330).  Saving model ...
Epoch: 19 cost time: 1.8677470684051514
Epoch: 19, Steps: 9 | Train Loss: 0.117 Vali Loss: 0.373 Vali Acc: 0.848 Test Loss: 0.373 Test Acc: 0.848
Validation loss decreased (-0.833330 --> -0.847822).  Saving model ...
Epoch: 20 cost time: 1.9152805805206299
Epoch: 20, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.439 Vali Acc: 0.804 Test Loss: 0.439 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8628451824188232
Epoch: 21, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.373 Vali Acc: 0.848 Test Loss: 0.373 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 22 cost time: 1.8291904926300049
Epoch: 22, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.368 Vali Acc: 0.848 Test Loss: 0.368 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 23 cost time: 1.7613561153411865
Epoch: 23, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.352 Vali Acc: 0.855 Test Loss: 0.352 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855069).  Saving model ...
Epoch: 24 cost time: 1.8698434829711914
Epoch: 24, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.367 Vali Acc: 0.870 Test Loss: 0.367 Test Acc: 0.870
Validation loss decreased (-0.855069 --> -0.869562).  Saving model ...
Epoch: 25 cost time: 1.855422019958496
Epoch: 25, Steps: 9 | Train Loss: 0.114 Vali Loss: 0.347 Vali Acc: 0.877 Test Loss: 0.347 Test Acc: 0.877
Validation loss decreased (-0.869562 --> -0.876808).  Saving model ...
Epoch: 26 cost time: 1.8558681011199951
Epoch: 26, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.329 Vali Acc: 0.891 Test Loss: 0.329 Test Acc: 0.891
Validation loss decreased (-0.876808 --> -0.891301).  Saving model ...
Epoch: 27 cost time: 1.8300058841705322
Epoch: 27, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.329 Vali Acc: 0.899 Test Loss: 0.329 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898547).  Saving model ...
Epoch: 28 cost time: 1.856243371963501
Epoch: 28, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.348 Vali Acc: 0.884 Test Loss: 0.348 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.665140151977539
Epoch: 29, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.339 Vali Acc: 0.891 Test Loss: 0.339 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.6946756839752197
Epoch: 30, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.335 Vali Acc: 0.891 Test Loss: 0.335 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 358132
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.7059028148651123
Epoch: 1, Steps: 9 | Train Loss: 1.471 Vali Loss: 1.409 Vali Acc: 0.326 Test Loss: 1.409 Test Acc: 0.326
Validation loss decreased (inf --> -0.326073).  Saving model ...
Epoch: 2 cost time: 1.9642925262451172
Epoch: 2, Steps: 9 | Train Loss: 1.381 Vali Loss: 1.307 Vali Acc: 0.384 Test Loss: 1.307 Test Acc: 0.384
Validation loss decreased (-0.326073 --> -0.384045).  Saving model ...
Epoch: 3 cost time: 2.0554676055908203
Epoch: 3, Steps: 9 | Train Loss: 1.210 Vali Loss: 1.195 Vali Acc: 0.449 Test Loss: 1.195 Test Acc: 0.449
Validation loss decreased (-0.384045 --> -0.449263).  Saving model ...
Epoch: 4 cost time: 1.7566933631896973
Epoch: 4, Steps: 9 | Train Loss: 1.087 Vali Loss: 1.096 Vali Acc: 0.565 Test Loss: 1.096 Test Acc: 0.565
Validation loss decreased (-0.449263 --> -0.565206).  Saving model ...
Epoch: 5 cost time: 2.013293504714966
Epoch: 5, Steps: 9 | Train Loss: 0.951 Vali Loss: 1.015 Vali Acc: 0.616 Test Loss: 1.015 Test Acc: 0.616
Validation loss decreased (-0.565206 --> -0.615932).  Saving model ...
Epoch: 6 cost time: 1.9885458946228027
Epoch: 6, Steps: 9 | Train Loss: 0.862 Vali Loss: 0.945 Vali Acc: 0.652 Test Loss: 0.945 Test Acc: 0.652
Validation loss decreased (-0.615932 --> -0.652164).  Saving model ...
Epoch: 7 cost time: 1.7728297710418701
Epoch: 7, Steps: 9 | Train Loss: 0.754 Vali Loss: 0.871 Vali Acc: 0.674 Test Loss: 0.871 Test Acc: 0.674
Validation loss decreased (-0.652164 --> -0.673904).  Saving model ...
Epoch: 8 cost time: 2.060605764389038
Epoch: 8, Steps: 9 | Train Loss: 0.621 Vali Loss: 0.804 Vali Acc: 0.717 Test Loss: 0.804 Test Acc: 0.717
Validation loss decreased (-0.673904 --> -0.717383).  Saving model ...
Epoch: 9 cost time: 2.039846658706665
Epoch: 9, Steps: 9 | Train Loss: 0.540 Vali Loss: 0.730 Vali Acc: 0.754 Test Loss: 0.730 Test Acc: 0.754
Validation loss decreased (-0.717383 --> -0.753616).  Saving model ...
Epoch: 10 cost time: 2.0857627391815186
Epoch: 10, Steps: 9 | Train Loss: 0.442 Vali Loss: 0.695 Vali Acc: 0.739 Test Loss: 0.695 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.956113576889038
Epoch: 11, Steps: 9 | Train Loss: 0.353 Vali Loss: 0.626 Vali Acc: 0.790 Test Loss: 0.626 Test Acc: 0.790
Validation loss decreased (-0.753616 --> -0.789849).  Saving model ...
Epoch: 12 cost time: 2.009197473526001
Epoch: 12, Steps: 9 | Train Loss: 0.283 Vali Loss: 0.586 Vali Acc: 0.804 Test Loss: 0.586 Test Acc: 0.804
Validation loss decreased (-0.789849 --> -0.804342).  Saving model ...
Epoch: 13 cost time: 1.917764663696289
Epoch: 13, Steps: 9 | Train Loss: 0.225 Vali Loss: 0.564 Vali Acc: 0.804 Test Loss: 0.564 Test Acc: 0.804
Validation loss decreased (-0.804342 --> -0.804342).  Saving model ...
Epoch: 14 cost time: 1.9811387062072754
Epoch: 14, Steps: 9 | Train Loss: 0.182 Vali Loss: 0.534 Vali Acc: 0.790 Test Loss: 0.534 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6914780139923096
Epoch: 15, Steps: 9 | Train Loss: 0.151 Vali Loss: 0.510 Vali Acc: 0.833 Test Loss: 0.510 Test Acc: 0.833
Validation loss decreased (-0.804342 --> -0.833328).  Saving model ...
Epoch: 16 cost time: 1.9510793685913086
Epoch: 16, Steps: 9 | Train Loss: 0.115 Vali Loss: 0.516 Vali Acc: 0.826 Test Loss: 0.516 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.0127084255218506
Epoch: 17, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.521 Vali Acc: 0.797 Test Loss: 0.521 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.9314849376678467
Epoch: 18, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.514 Vali Acc: 0.833 Test Loss: 0.514 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.0066497325897217
Epoch: 19, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.527 Vali Acc: 0.833 Test Loss: 0.527 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.9758110046386719
Epoch: 20, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.495 Vali Acc: 0.833 Test Loss: 0.495 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 21 cost time: 2.0041956901550293
Epoch: 21, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.504 Vali Acc: 0.833 Test Loss: 0.504 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.9063878059387207
Epoch: 22, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.529 Vali Acc: 0.848 Test Loss: 0.529 Test Acc: 0.848
Validation loss decreased (-0.833328 --> -0.847821).  Saving model ...
Epoch: 23 cost time: 1.8087046146392822
Epoch: 23, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.499 Vali Acc: 0.855 Test Loss: 0.499 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855067).  Saving model ...
Epoch: 24 cost time: 1.939873218536377
Epoch: 24, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.498 Vali Acc: 0.848 Test Loss: 0.498 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.9735846519470215
Epoch: 25, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.493 Vali Acc: 0.855 Test Loss: 0.493 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855068).  Saving model ...
Epoch: 26 cost time: 1.564819574356079
Epoch: 26, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.484 Vali Acc: 0.862 Test Loss: 0.484 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862314).  Saving model ...
Epoch: 27 cost time: 1.962040901184082
Epoch: 27, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.506 Vali Acc: 0.855 Test Loss: 0.506 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.0047872066497803
Epoch: 28, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.488 Vali Acc: 0.870 Test Loss: 0.488 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869560).  Saving model ...
Epoch: 29 cost time: 1.9175868034362793
Epoch: 29, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.534 Vali Acc: 0.826 Test Loss: 0.534 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.9511168003082275
Epoch: 30, Steps: 9 | Train Loss: 0.111 Vali Loss: 0.526 Vali Acc: 0.826 Test Loss: 0.526 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 1185844
model size : 4.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.156165599822998
Epoch: 1, Steps: 9 | Train Loss: 1.480 Vali Loss: 1.392 Vali Acc: 0.275 Test Loss: 1.392 Test Acc: 0.275
Validation loss decreased (inf --> -0.275348).  Saving model ...
Epoch: 2 cost time: 1.4646685123443604
Epoch: 2, Steps: 9 | Train Loss: 1.386 Vali Loss: 1.289 Vali Acc: 0.486 Test Loss: 1.289 Test Acc: 0.486
Validation loss decreased (-0.275348 --> -0.485494).  Saving model ...
Epoch: 3 cost time: 1.3486852645874023
Epoch: 3, Steps: 9 | Train Loss: 1.217 Vali Loss: 1.181 Vali Acc: 0.543 Test Loss: 1.181 Test Acc: 0.543
Validation loss decreased (-0.485494 --> -0.543466).  Saving model ...
Epoch: 4 cost time: 1.509155035018921
Epoch: 4, Steps: 9 | Train Loss: 1.103 Vali Loss: 1.082 Vali Acc: 0.645 Test Loss: 1.082 Test Acc: 0.645
Validation loss decreased (-0.543466 --> -0.644917).  Saving model ...
Epoch: 5 cost time: 1.4540696144104004
Epoch: 5, Steps: 9 | Train Loss: 0.987 Vali Loss: 0.998 Vali Acc: 0.659 Test Loss: 0.998 Test Acc: 0.659
Validation loss decreased (-0.644917 --> -0.659410).  Saving model ...
Epoch: 6 cost time: 1.4488458633422852
Epoch: 6, Steps: 9 | Train Loss: 0.835 Vali Loss: 0.906 Vali Acc: 0.681 Test Loss: 0.906 Test Acc: 0.681
Validation loss decreased (-0.659410 --> -0.681150).  Saving model ...
Epoch: 7 cost time: 1.6429941654205322
Epoch: 7, Steps: 9 | Train Loss: 0.748 Vali Loss: 0.820 Vali Acc: 0.725 Test Loss: 0.820 Test Acc: 0.725
Validation loss decreased (-0.681150 --> -0.724629).  Saving model ...
Epoch: 8 cost time: 1.4963312149047852
Epoch: 8, Steps: 9 | Train Loss: 0.622 Vali Loss: 0.751 Vali Acc: 0.739 Test Loss: 0.751 Test Acc: 0.739
Validation loss decreased (-0.724629 --> -0.739123).  Saving model ...
Epoch: 9 cost time: 1.4935834407806396
Epoch: 9, Steps: 9 | Train Loss: 0.530 Vali Loss: 0.651 Vali Acc: 0.783 Test Loss: 0.651 Test Acc: 0.783
Validation loss decreased (-0.739123 --> -0.782602).  Saving model ...
Epoch: 10 cost time: 1.5456836223602295
Epoch: 10, Steps: 9 | Train Loss: 0.434 Vali Loss: 0.599 Vali Acc: 0.797 Test Loss: 0.599 Test Acc: 0.797
Validation loss decreased (-0.782602 --> -0.797095).  Saving model ...
Epoch: 11 cost time: 1.4897072315216064
Epoch: 11, Steps: 9 | Train Loss: 0.375 Vali Loss: 0.573 Vali Acc: 0.790 Test Loss: 0.573 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5509519577026367
Epoch: 12, Steps: 9 | Train Loss: 0.326 Vali Loss: 0.513 Vali Acc: 0.804 Test Loss: 0.513 Test Acc: 0.804
Validation loss decreased (-0.797095 --> -0.804343).  Saving model ...
Epoch: 13 cost time: 1.5074748992919922
Epoch: 13, Steps: 9 | Train Loss: 0.274 Vali Loss: 0.510 Vali Acc: 0.804 Test Loss: 0.510 Test Acc: 0.804
Validation loss decreased (-0.804343 --> -0.804343).  Saving model ...
Epoch: 14 cost time: 1.504840612411499
Epoch: 14, Steps: 9 | Train Loss: 0.197 Vali Loss: 0.459 Vali Acc: 0.812 Test Loss: 0.459 Test Acc: 0.812
Validation loss decreased (-0.804343 --> -0.811590).  Saving model ...
Epoch: 15 cost time: 1.4898276329040527
Epoch: 15, Steps: 9 | Train Loss: 0.175 Vali Loss: 0.432 Vali Acc: 0.826 Test Loss: 0.432 Test Acc: 0.826
Validation loss decreased (-0.811590 --> -0.826083).  Saving model ...
Epoch: 16 cost time: 1.4841938018798828
Epoch: 16, Steps: 9 | Train Loss: 0.142 Vali Loss: 0.414 Vali Acc: 0.826 Test Loss: 0.414 Test Acc: 0.826
Validation loss decreased (-0.826083 --> -0.826083).  Saving model ...
Epoch: 17 cost time: 1.4814329147338867
Epoch: 17, Steps: 9 | Train Loss: 0.098 Vali Loss: 0.442 Vali Acc: 0.826 Test Loss: 0.442 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4726035594940186
Epoch: 18, Steps: 9 | Train Loss: 0.089 Vali Loss: 0.398 Vali Acc: 0.848 Test Loss: 0.398 Test Acc: 0.848
Validation loss decreased (-0.826083 --> -0.847822).  Saving model ...
Epoch: 19 cost time: 1.4154040813446045
Epoch: 19, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.380 Vali Acc: 0.870 Test Loss: 0.380 Test Acc: 0.870
Validation loss decreased (-0.847822 --> -0.869561).  Saving model ...
Epoch: 20 cost time: 1.5243642330169678
Epoch: 20, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.382 Vali Acc: 0.870 Test Loss: 0.382 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5265216827392578
Epoch: 21, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.373 Vali Acc: 0.884 Test Loss: 0.373 Test Acc: 0.884
Validation loss decreased (-0.869561 --> -0.884054).  Saving model ...
Epoch: 22 cost time: 1.413100242614746
Epoch: 22, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.357 Vali Acc: 0.884 Test Loss: 0.357 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 23 cost time: 1.528036117553711
Epoch: 23, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.347 Vali Acc: 0.884 Test Loss: 0.347 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884055).  Saving model ...
Epoch: 24 cost time: 1.5052471160888672
Epoch: 24, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.356 Vali Acc: 0.884 Test Loss: 0.356 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.412743330001831
Epoch: 25, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.345 Vali Acc: 0.884 Test Loss: 0.345 Test Acc: 0.884
Validation loss decreased (-0.884055 --> -0.884055).  Saving model ...
Epoch: 26 cost time: 1.503119707107544
Epoch: 26, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.323 Vali Acc: 0.899 Test Loss: 0.323 Test Acc: 0.899
Validation loss decreased (-0.884055 --> -0.898547).  Saving model ...
Epoch: 27 cost time: 1.4499537944793701
Epoch: 27, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.313 Vali Acc: 0.906 Test Loss: 0.313 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905794).  Saving model ...
Epoch: 28 cost time: 1.438901662826538
Epoch: 28, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.330 Vali Acc: 0.891 Test Loss: 0.330 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.4920573234558105
Epoch: 29, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.319 Vali Acc: 0.906 Test Loss: 0.319 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.0644176006317139
Epoch: 30, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.318 Vali Acc: 0.899 Test Loss: 0.318 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 358132
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.35442852973938
Epoch: 1, Steps: 9 | Train Loss: 1.366 Vali Loss: 1.333 Vali Acc: 0.391 Test Loss: 1.333 Test Acc: 0.391
Validation loss decreased (inf --> -0.391291).  Saving model ...
Epoch: 2 cost time: 2.418034791946411
Epoch: 2, Steps: 9 | Train Loss: 1.279 Vali Loss: 1.239 Vali Acc: 0.464 Test Loss: 1.239 Test Acc: 0.464
Validation loss decreased (-0.391291 --> -0.463756).  Saving model ...
Epoch: 3 cost time: 2.352937936782837
Epoch: 3, Steps: 9 | Train Loss: 1.146 Vali Loss: 1.121 Vali Acc: 0.536 Test Loss: 1.121 Test Acc: 0.536
Validation loss decreased (-0.463756 --> -0.536221).  Saving model ...
Epoch: 4 cost time: 2.298933744430542
Epoch: 4, Steps: 9 | Train Loss: 0.981 Vali Loss: 0.992 Vali Acc: 0.652 Test Loss: 0.992 Test Acc: 0.652
Validation loss decreased (-0.536221 --> -0.652164).  Saving model ...
Epoch: 5 cost time: 2.3235626220703125
Epoch: 5, Steps: 9 | Train Loss: 0.859 Vali Loss: 0.854 Vali Acc: 0.717 Test Loss: 0.854 Test Acc: 0.717
Validation loss decreased (-0.652164 --> -0.717383).  Saving model ...
Epoch: 6 cost time: 2.3030686378479004
Epoch: 6, Steps: 9 | Train Loss: 0.714 Vali Loss: 0.726 Vali Acc: 0.732 Test Loss: 0.726 Test Acc: 0.732
Validation loss decreased (-0.717383 --> -0.731877).  Saving model ...
Epoch: 7 cost time: 2.4192779064178467
Epoch: 7, Steps: 9 | Train Loss: 0.572 Vali Loss: 0.627 Vali Acc: 0.768 Test Loss: 0.627 Test Acc: 0.768
Validation loss decreased (-0.731877 --> -0.768110).  Saving model ...
Epoch: 8 cost time: 2.293180465698242
Epoch: 8, Steps: 9 | Train Loss: 0.456 Vali Loss: 0.567 Vali Acc: 0.775 Test Loss: 0.567 Test Acc: 0.775
Validation loss decreased (-0.768110 --> -0.775357).  Saving model ...
Epoch: 9 cost time: 2.3873279094696045
Epoch: 9, Steps: 9 | Train Loss: 0.387 Vali Loss: 0.537 Vali Acc: 0.783 Test Loss: 0.537 Test Acc: 0.783
Validation loss decreased (-0.775357 --> -0.782603).  Saving model ...
Epoch: 10 cost time: 2.3579185009002686
Epoch: 10, Steps: 9 | Train Loss: 0.313 Vali Loss: 0.491 Vali Acc: 0.812 Test Loss: 0.491 Test Acc: 0.812
Validation loss decreased (-0.782603 --> -0.811589).  Saving model ...
Epoch: 11 cost time: 2.318645477294922
Epoch: 11, Steps: 9 | Train Loss: 0.267 Vali Loss: 0.474 Vali Acc: 0.819 Test Loss: 0.474 Test Acc: 0.819
Validation loss decreased (-0.811589 --> -0.818836).  Saving model ...
Epoch: 12 cost time: 2.3787927627563477
Epoch: 12, Steps: 9 | Train Loss: 0.225 Vali Loss: 0.469 Vali Acc: 0.819 Test Loss: 0.469 Test Acc: 0.819
Validation loss decreased (-0.818836 --> -0.818836).  Saving model ...
Epoch: 13 cost time: 2.241938591003418
Epoch: 13, Steps: 9 | Train Loss: 0.168 Vali Loss: 0.426 Vali Acc: 0.855 Test Loss: 0.426 Test Acc: 0.855
Validation loss decreased (-0.818836 --> -0.855068).  Saving model ...
Epoch: 14 cost time: 2.197681427001953
Epoch: 14, Steps: 9 | Train Loss: 0.143 Vali Loss: 0.421 Vali Acc: 0.855 Test Loss: 0.421 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 15 cost time: 2.3015198707580566
Epoch: 15, Steps: 9 | Train Loss: 0.154 Vali Loss: 0.402 Vali Acc: 0.862 Test Loss: 0.402 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862315).  Saving model ...
Epoch: 16 cost time: 2.359919548034668
Epoch: 16, Steps: 9 | Train Loss: 0.126 Vali Loss: 0.432 Vali Acc: 0.877 Test Loss: 0.432 Test Acc: 0.877
Validation loss decreased (-0.862315 --> -0.876807).  Saving model ...
Epoch: 17 cost time: 2.2594311237335205
Epoch: 17, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.411 Vali Acc: 0.877 Test Loss: 0.411 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876807).  Saving model ...
Epoch: 18 cost time: 2.3332347869873047
Epoch: 18, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.390 Vali Acc: 0.870 Test Loss: 0.390 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.248974084854126
Epoch: 19, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.377 Vali Acc: 0.877 Test Loss: 0.377 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876808).  Saving model ...
Epoch: 20 cost time: 2.237781047821045
Epoch: 20, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.377 Vali Acc: 0.870 Test Loss: 0.377 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.3793983459472656
Epoch: 21, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.396 Vali Acc: 0.891 Test Loss: 0.396 Test Acc: 0.891
Validation loss decreased (-0.876808 --> -0.891300).  Saving model ...
Epoch: 22 cost time: 2.2453453540802
Epoch: 22, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.408 Vali Acc: 0.891 Test Loss: 0.408 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.2399208545684814
Epoch: 23, Steps: 9 | Train Loss: 0.234 Vali Loss: 0.352 Vali Acc: 0.891 Test Loss: 0.352 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891301).  Saving model ...
Epoch: 24 cost time: 2.3172781467437744
Epoch: 24, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.301 Vali Acc: 0.891 Test Loss: 0.301 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 25 cost time: 2.407944440841675
Epoch: 25, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.292 Vali Acc: 0.920 Test Loss: 0.292 Test Acc: 0.920
Validation loss decreased (-0.891301 --> -0.920287).  Saving model ...
Epoch: 26 cost time: 2.2216691970825195
Epoch: 26, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.293 Vali Acc: 0.913 Test Loss: 0.293 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.4275732040405273
Epoch: 27, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.280 Vali Acc: 0.906 Test Loss: 0.280 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.3326125144958496
Epoch: 28, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.278 Vali Acc: 0.913 Test Loss: 0.278 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.402357339859009
Epoch: 29, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.291 Vali Acc: 0.920 Test Loss: 0.291 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 30 cost time: 2.2986886501312256
Epoch: 30, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.285 Vali Acc: 0.920 Test Loss: 0.285 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 599732
model size : 2.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.7390706539154053
Epoch: 1, Steps: 9 | Train Loss: 1.441 Vali Loss: 1.370 Vali Acc: 0.341 Test Loss: 1.370 Test Acc: 0.341
Validation loss decreased (inf --> -0.340566).  Saving model ...
Epoch: 2 cost time: 1.7067086696624756
Epoch: 2, Steps: 9 | Train Loss: 1.332 Vali Loss: 1.280 Vali Acc: 0.428 Test Loss: 1.280 Test Acc: 0.428
Validation loss decreased (-0.340566 --> -0.427523).  Saving model ...
Epoch: 3 cost time: 1.3763020038604736
Epoch: 3, Steps: 9 | Train Loss: 1.197 Vali Loss: 1.169 Vali Acc: 0.522 Test Loss: 1.169 Test Acc: 0.522
Validation loss decreased (-0.427523 --> -0.521727).  Saving model ...
Epoch: 4 cost time: 1.6267199516296387
Epoch: 4, Steps: 9 | Train Loss: 1.036 Vali Loss: 1.058 Vali Acc: 0.616 Test Loss: 1.058 Test Acc: 0.616
Validation loss decreased (-0.521727 --> -0.615931).  Saving model ...
Epoch: 5 cost time: 1.6378169059753418
Epoch: 5, Steps: 9 | Train Loss: 0.931 Vali Loss: 0.936 Vali Acc: 0.659 Test Loss: 0.936 Test Acc: 0.659
Validation loss decreased (-0.615931 --> -0.659411).  Saving model ...
Epoch: 6 cost time: 1.6922969818115234
Epoch: 6, Steps: 9 | Train Loss: 0.756 Vali Loss: 0.803 Vali Acc: 0.732 Test Loss: 0.803 Test Acc: 0.732
Validation loss decreased (-0.659411 --> -0.731876).  Saving model ...
Epoch: 7 cost time: 1.7783315181732178
Epoch: 7, Steps: 9 | Train Loss: 0.623 Vali Loss: 0.689 Vali Acc: 0.739 Test Loss: 0.689 Test Acc: 0.739
Validation loss decreased (-0.731876 --> -0.739124).  Saving model ...
Epoch: 8 cost time: 1.6775305271148682
Epoch: 8, Steps: 9 | Train Loss: 0.512 Vali Loss: 0.611 Vali Acc: 0.804 Test Loss: 0.611 Test Acc: 0.804
Validation loss decreased (-0.739124 --> -0.804342).  Saving model ...
Epoch: 9 cost time: 1.6799027919769287
Epoch: 9, Steps: 9 | Train Loss: 0.533 Vali Loss: 0.562 Vali Acc: 0.819 Test Loss: 0.562 Test Acc: 0.819
Validation loss decreased (-0.804342 --> -0.818835).  Saving model ...
Epoch: 10 cost time: 1.6922664642333984
Epoch: 10, Steps: 9 | Train Loss: 0.352 Vali Loss: 0.517 Vali Acc: 0.826 Test Loss: 0.517 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826082).  Saving model ...
Epoch: 11 cost time: 1.5208141803741455
Epoch: 11, Steps: 9 | Train Loss: 0.245 Vali Loss: 0.515 Vali Acc: 0.833 Test Loss: 0.515 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833328).  Saving model ...
Epoch: 12 cost time: 1.4747440814971924
Epoch: 12, Steps: 9 | Train Loss: 0.218 Vali Loss: 0.524 Vali Acc: 0.833 Test Loss: 0.524 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4856140613555908
Epoch: 13, Steps: 9 | Train Loss: 0.223 Vali Loss: 0.545 Vali Acc: 0.841 Test Loss: 0.545 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840574).  Saving model ...
Epoch: 14 cost time: 1.6891798973083496
Epoch: 14, Steps: 9 | Train Loss: 0.319 Vali Loss: 0.393 Vali Acc: 0.870 Test Loss: 0.393 Test Acc: 0.870
Validation loss decreased (-0.840574 --> -0.869561).  Saving model ...
Epoch: 15 cost time: 1.8219811916351318
Epoch: 15, Steps: 9 | Train Loss: 0.151 Vali Loss: 0.357 Vali Acc: 0.877 Test Loss: 0.357 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876808).  Saving model ...
Epoch: 16 cost time: 1.7459137439727783
Epoch: 16, Steps: 9 | Train Loss: 0.134 Vali Loss: 0.359 Vali Acc: 0.877 Test Loss: 0.359 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7567617893218994
Epoch: 17, Steps: 9 | Train Loss: 0.099 Vali Loss: 0.362 Vali Acc: 0.870 Test Loss: 0.362 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.8019733428955078
Epoch: 18, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.336 Vali Acc: 0.877 Test Loss: 0.336 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 19 cost time: 1.766462802886963
Epoch: 19, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.331 Vali Acc: 0.870 Test Loss: 0.331 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.7749648094177246
Epoch: 20, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.320 Vali Acc: 0.877 Test Loss: 0.320 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 21 cost time: 1.7318110466003418
Epoch: 21, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.270 Vali Acc: 0.899 Test Loss: 0.270 Test Acc: 0.899
Validation loss decreased (-0.876808 --> -0.898548).  Saving model ...
Epoch: 22 cost time: 1.7301671504974365
Epoch: 22, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.264 Vali Acc: 0.891 Test Loss: 0.264 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.757683277130127
Epoch: 23, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.260 Vali Acc: 0.920 Test Loss: 0.260 Test Acc: 0.920
Validation loss decreased (-0.898548 --> -0.920287).  Saving model ...
Epoch: 24 cost time: 1.7749509811401367
Epoch: 24, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.261 Vali Acc: 0.920 Test Loss: 0.261 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.8189022541046143
Epoch: 25, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.257 Vali Acc: 0.913 Test Loss: 0.257 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.8758187294006348
Epoch: 26, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.270 Vali Acc: 0.906 Test Loss: 0.270 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.801002025604248
Epoch: 27, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.263 Vali Acc: 0.913 Test Loss: 0.263 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.8922545909881592
Epoch: 28, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.257 Vali Acc: 0.906 Test Loss: 0.257 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.8743138313293457
Epoch: 29, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.259 Vali Acc: 0.920 Test Loss: 0.259 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 30 cost time: 1.8803682327270508
Epoch: 30, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.224 Vali Acc: 0.920 Test Loss: 0.224 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920288).  Saving model ...
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 185844
model size : 1.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.9445080757141113
Epoch: 1, Steps: 9 | Train Loss: 1.366 Vali Loss: 1.335 Vali Acc: 0.399 Test Loss: 1.335 Test Acc: 0.399
Validation loss decreased (inf --> -0.398537).  Saving model ...
Epoch: 2 cost time: 1.9253599643707275
Epoch: 2, Steps: 9 | Train Loss: 1.284 Vali Loss: 1.243 Vali Acc: 0.464 Test Loss: 1.243 Test Acc: 0.464
Validation loss decreased (-0.398537 --> -0.463756).  Saving model ...
Epoch: 3 cost time: 2.036299228668213
Epoch: 3, Steps: 9 | Train Loss: 1.154 Vali Loss: 1.130 Vali Acc: 0.514 Test Loss: 1.130 Test Acc: 0.514
Validation loss decreased (-0.463756 --> -0.514481).  Saving model ...
Epoch: 4 cost time: 1.873722791671753
Epoch: 4, Steps: 9 | Train Loss: 0.996 Vali Loss: 1.011 Vali Acc: 0.623 Test Loss: 1.011 Test Acc: 0.623
Validation loss decreased (-0.514481 --> -0.623178).  Saving model ...
Epoch: 5 cost time: 1.9844815731048584
Epoch: 5, Steps: 9 | Train Loss: 0.873 Vali Loss: 0.882 Vali Acc: 0.688 Test Loss: 0.882 Test Acc: 0.688
Validation loss decreased (-0.623178 --> -0.688397).  Saving model ...
Epoch: 6 cost time: 1.8139045238494873
Epoch: 6, Steps: 9 | Train Loss: 0.752 Vali Loss: 0.757 Vali Acc: 0.739 Test Loss: 0.757 Test Acc: 0.739
Validation loss decreased (-0.688397 --> -0.739123).  Saving model ...
Epoch: 7 cost time: 1.9221770763397217
Epoch: 7, Steps: 9 | Train Loss: 0.602 Vali Loss: 0.650 Vali Acc: 0.761 Test Loss: 0.650 Test Acc: 0.761
Validation loss decreased (-0.739123 --> -0.760863).  Saving model ...
Epoch: 8 cost time: 1.8912935256958008
Epoch: 8, Steps: 9 | Train Loss: 0.530 Vali Loss: 0.587 Vali Acc: 0.754 Test Loss: 0.587 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.842275619506836
Epoch: 9, Steps: 9 | Train Loss: 0.414 Vali Loss: 0.526 Vali Acc: 0.783 Test Loss: 0.526 Test Acc: 0.783
Validation loss decreased (-0.760863 --> -0.782603).  Saving model ...
Epoch: 10 cost time: 1.8805556297302246
Epoch: 10, Steps: 9 | Train Loss: 0.350 Vali Loss: 0.483 Vali Acc: 0.797 Test Loss: 0.483 Test Acc: 0.797
Validation loss decreased (-0.782603 --> -0.797097).  Saving model ...
Epoch: 11 cost time: 1.9028189182281494
Epoch: 11, Steps: 9 | Train Loss: 0.439 Vali Loss: 0.464 Vali Acc: 0.819 Test Loss: 0.464 Test Acc: 0.819
Validation loss decreased (-0.797097 --> -0.818836).  Saving model ...
Epoch: 12 cost time: 1.8612492084503174
Epoch: 12, Steps: 9 | Train Loss: 0.254 Vali Loss: 0.442 Vali Acc: 0.819 Test Loss: 0.442 Test Acc: 0.819
Validation loss decreased (-0.818836 --> -0.818836).  Saving model ...
Epoch: 13 cost time: 1.9057981967926025
Epoch: 13, Steps: 9 | Train Loss: 0.200 Vali Loss: 0.419 Vali Acc: 0.841 Test Loss: 0.419 Test Acc: 0.841
Validation loss decreased (-0.818836 --> -0.840576).  Saving model ...
Epoch: 14 cost time: 1.9213972091674805
Epoch: 14, Steps: 9 | Train Loss: 0.173 Vali Loss: 0.400 Vali Acc: 0.833 Test Loss: 0.400 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.937788724899292
Epoch: 15, Steps: 9 | Train Loss: 0.161 Vali Loss: 0.387 Vali Acc: 0.841 Test Loss: 0.387 Test Acc: 0.841
Validation loss decreased (-0.840576 --> -0.840576).  Saving model ...
Epoch: 16 cost time: 2.0426924228668213
Epoch: 16, Steps: 9 | Train Loss: 0.149 Vali Loss: 0.394 Vali Acc: 0.862 Test Loss: 0.394 Test Acc: 0.862
Validation loss decreased (-0.840576 --> -0.862315).  Saving model ...
Epoch: 17 cost time: 1.9433751106262207
Epoch: 17, Steps: 9 | Train Loss: 0.132 Vali Loss: 0.355 Vali Acc: 0.877 Test Loss: 0.355 Test Acc: 0.877
Validation loss decreased (-0.862315 --> -0.876808).  Saving model ...
Epoch: 18 cost time: 1.9159870147705078
Epoch: 18, Steps: 9 | Train Loss: 0.158 Vali Loss: 0.342 Vali Acc: 0.891 Test Loss: 0.342 Test Acc: 0.891
Validation loss decreased (-0.876808 --> -0.891301).  Saving model ...
Epoch: 19 cost time: 2.116119623184204
Epoch: 19, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.355 Vali Acc: 0.884 Test Loss: 0.355 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.010540246963501
Epoch: 20, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.340 Vali Acc: 0.877 Test Loss: 0.340 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.0186755657196045
Epoch: 21, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.303 Vali Acc: 0.884 Test Loss: 0.303 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.0442044734954834
Epoch: 22, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.285 Vali Acc: 0.899 Test Loss: 0.285 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898548).  Saving model ...
Epoch: 23 cost time: 2.0473709106445312
Epoch: 23, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.291 Vali Acc: 0.906 Test Loss: 0.291 Test Acc: 0.906
Validation loss decreased (-0.898548 --> -0.905794).  Saving model ...
Epoch: 24 cost time: 1.8121874332427979
Epoch: 24, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.291 Vali Acc: 0.913 Test Loss: 0.291 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913041).  Saving model ...
Epoch: 25 cost time: 1.7197601795196533
Epoch: 25, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.294 Vali Acc: 0.906 Test Loss: 0.294 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.7554118633270264
Epoch: 26, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.320 Vali Acc: 0.884 Test Loss: 0.320 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.7414731979370117
Epoch: 27, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.288 Vali Acc: 0.920 Test Loss: 0.288 Test Acc: 0.920
Validation loss decreased (-0.913041 --> -0.920287).  Saving model ...
Epoch: 28 cost time: 1.8465659618377686
Epoch: 28, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.284 Vali Acc: 0.913 Test Loss: 0.284 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.9055967330932617
Epoch: 29, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.316 Vali Acc: 0.920 Test Loss: 0.316 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.9099359512329102
Epoch: 30, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.343 Vali Acc: 0.870 Test Loss: 0.343 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 599732
model size : 2.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.306805372238159
Epoch: 1, Steps: 9 | Train Loss: 1.437 Vali Loss: 1.367 Vali Acc: 0.370 Test Loss: 1.367 Test Acc: 0.370
Validation loss decreased (inf --> -0.369552).  Saving model ...
Epoch: 2 cost time: 1.410034418106079
Epoch: 2, Steps: 9 | Train Loss: 1.336 Vali Loss: 1.279 Vali Acc: 0.420 Test Loss: 1.279 Test Acc: 0.420
Validation loss decreased (-0.369552 --> -0.420277).  Saving model ...
Epoch: 3 cost time: 1.4276700019836426
Epoch: 3, Steps: 9 | Train Loss: 1.209 Vali Loss: 1.173 Vali Acc: 0.529 Test Loss: 1.173 Test Acc: 0.529
Validation loss decreased (-0.420277 --> -0.528974).  Saving model ...
Epoch: 4 cost time: 1.436264991760254
Epoch: 4, Steps: 9 | Train Loss: 1.057 Vali Loss: 1.071 Vali Acc: 0.616 Test Loss: 1.071 Test Acc: 0.616
Validation loss decreased (-0.528974 --> -0.615931).  Saving model ...
Epoch: 5 cost time: 1.4267098903656006
Epoch: 5, Steps: 9 | Train Loss: 0.958 Vali Loss: 0.965 Vali Acc: 0.681 Test Loss: 0.965 Test Acc: 0.681
Validation loss decreased (-0.615931 --> -0.681150).  Saving model ...
Epoch: 6 cost time: 1.4622762203216553
Epoch: 6, Steps: 9 | Train Loss: 0.797 Vali Loss: 0.862 Vali Acc: 0.681 Test Loss: 0.862 Test Acc: 0.681
Validation loss decreased (-0.681150 --> -0.681151).  Saving model ...
Epoch: 7 cost time: 1.423065185546875
Epoch: 7, Steps: 9 | Train Loss: 0.694 Vali Loss: 0.767 Vali Acc: 0.717 Test Loss: 0.767 Test Acc: 0.717
Validation loss decreased (-0.681151 --> -0.717384).  Saving model ...
Epoch: 8 cost time: 1.4323065280914307
Epoch: 8, Steps: 9 | Train Loss: 0.580 Vali Loss: 0.669 Vali Acc: 0.754 Test Loss: 0.669 Test Acc: 0.754
Validation loss decreased (-0.717384 --> -0.753617).  Saving model ...
Epoch: 9 cost time: 1.4524366855621338
Epoch: 9, Steps: 9 | Train Loss: 0.496 Vali Loss: 0.601 Vali Acc: 0.783 Test Loss: 0.601 Test Acc: 0.783
Validation loss decreased (-0.753617 --> -0.782603).  Saving model ...
Epoch: 10 cost time: 1.4584331512451172
Epoch: 10, Steps: 9 | Train Loss: 0.419 Vali Loss: 0.561 Vali Acc: 0.790 Test Loss: 0.561 Test Acc: 0.790
Validation loss decreased (-0.782603 --> -0.789849).  Saving model ...
Epoch: 11 cost time: 1.392399787902832
Epoch: 11, Steps: 9 | Train Loss: 0.295 Vali Loss: 0.534 Vali Acc: 0.804 Test Loss: 0.534 Test Acc: 0.804
Validation loss decreased (-0.789849 --> -0.804342).  Saving model ...
Epoch: 12 cost time: 1.398805856704712
Epoch: 12, Steps: 9 | Train Loss: 0.272 Vali Loss: 0.530 Vali Acc: 0.804 Test Loss: 0.530 Test Acc: 0.804
Validation loss decreased (-0.804342 --> -0.804343).  Saving model ...
Epoch: 13 cost time: 1.4879164695739746
Epoch: 13, Steps: 9 | Train Loss: 0.231 Vali Loss: 0.492 Vali Acc: 0.826 Test Loss: 0.492 Test Acc: 0.826
Validation loss decreased (-0.804343 --> -0.826082).  Saving model ...
Epoch: 14 cost time: 1.4795849323272705
Epoch: 14, Steps: 9 | Train Loss: 0.259 Vali Loss: 0.412 Vali Acc: 0.862 Test Loss: 0.412 Test Acc: 0.862
Validation loss decreased (-0.826082 --> -0.862315).  Saving model ...
Epoch: 15 cost time: 1.4671432971954346
Epoch: 15, Steps: 9 | Train Loss: 0.172 Vali Loss: 0.412 Vali Acc: 0.841 Test Loss: 0.412 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3828377723693848
Epoch: 16, Steps: 9 | Train Loss: 0.140 Vali Loss: 0.403 Vali Acc: 0.833 Test Loss: 0.403 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4012205600738525
Epoch: 17, Steps: 9 | Train Loss: 0.098 Vali Loss: 0.363 Vali Acc: 0.848 Test Loss: 0.363 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.4324562549591064
Epoch: 18, Steps: 9 | Train Loss: 0.099 Vali Loss: 0.347 Vali Acc: 0.862 Test Loss: 0.347 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 19 cost time: 1.468984603881836
Epoch: 19, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.357 Vali Acc: 0.855 Test Loss: 0.357 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4669852256774902
Epoch: 20, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.360 Vali Acc: 0.848 Test Loss: 0.360 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.395411729812622
Epoch: 21, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.297 Vali Acc: 0.891 Test Loss: 0.297 Test Acc: 0.891
Validation loss decreased (-0.862315 --> -0.891301).  Saving model ...
Epoch: 22 cost time: 1.4042160511016846
Epoch: 22, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.281 Vali Acc: 0.913 Test Loss: 0.281 Test Acc: 0.913
Validation loss decreased (-0.891301 --> -0.913041).  Saving model ...
Epoch: 23 cost time: 1.3850913047790527
Epoch: 23, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.277 Vali Acc: 0.913 Test Loss: 0.277 Test Acc: 0.913
Validation loss decreased (-0.913041 --> -0.913041).  Saving model ...
Epoch: 24 cost time: 1.418731451034546
Epoch: 24, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.268 Vali Acc: 0.920 Test Loss: 0.268 Test Acc: 0.920
Validation loss decreased (-0.913041 --> -0.920287).  Saving model ...
Epoch: 25 cost time: 1.5011084079742432
Epoch: 25, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.265 Vali Acc: 0.913 Test Loss: 0.265 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.442434310913086
Epoch: 26, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.265 Vali Acc: 0.906 Test Loss: 0.265 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.4159533977508545
Epoch: 27, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.313 Vali Acc: 0.862 Test Loss: 0.313 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.4840114116668701
Epoch: 28, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.283 Vali Acc: 0.891 Test Loss: 0.283 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.4726505279541016
Epoch: 29, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.279 Vali Acc: 0.891 Test Loss: 0.279 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.463550090789795
Epoch: 30, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.263 Vali Acc: 0.920 Test Loss: 0.263 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 185844
model size : 1.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.2368292808532715
Epoch: 1, Steps: 9 | Train Loss: 1.363 Vali Loss: 1.336 Vali Acc: 0.391 Test Loss: 1.336 Test Acc: 0.391
Validation loss decreased (inf --> -0.391291).  Saving model ...
Epoch: 2 cost time: 1.4943604469299316
Epoch: 2, Steps: 9 | Train Loss: 1.292 Vali Loss: 1.253 Vali Acc: 0.457 Test Loss: 1.253 Test Acc: 0.457
Validation loss decreased (-0.391291 --> -0.456509).  Saving model ...
Epoch: 3 cost time: 1.51088285446167
Epoch: 3, Steps: 9 | Train Loss: 1.174 Vali Loss: 1.159 Vali Acc: 0.493 Test Loss: 1.159 Test Acc: 0.493
Validation loss decreased (-0.456509 --> -0.492742).  Saving model ...
Epoch: 4 cost time: 1.4366304874420166
Epoch: 4, Steps: 9 | Train Loss: 1.028 Vali Loss: 1.067 Vali Acc: 0.551 Test Loss: 1.067 Test Acc: 0.551
Validation loss decreased (-0.492742 --> -0.550714).  Saving model ...
Epoch: 5 cost time: 1.4015467166900635
Epoch: 5, Steps: 9 | Train Loss: 0.924 Vali Loss: 0.980 Vali Acc: 0.601 Test Loss: 0.980 Test Acc: 0.601
Validation loss decreased (-0.550714 --> -0.601439).  Saving model ...
Epoch: 6 cost time: 1.4709646701812744
Epoch: 6, Steps: 9 | Train Loss: 0.837 Vali Loss: 0.904 Vali Acc: 0.623 Test Loss: 0.904 Test Acc: 0.623
Validation loss decreased (-0.601439 --> -0.623179).  Saving model ...
Epoch: 7 cost time: 1.4529318809509277
Epoch: 7, Steps: 9 | Train Loss: 0.707 Vali Loss: 0.828 Vali Acc: 0.667 Test Loss: 0.828 Test Acc: 0.667
Validation loss decreased (-0.623179 --> -0.666658).  Saving model ...
Epoch: 8 cost time: 1.4626481533050537
Epoch: 8, Steps: 9 | Train Loss: 0.628 Vali Loss: 0.737 Vali Acc: 0.717 Test Loss: 0.737 Test Acc: 0.717
Validation loss decreased (-0.666658 --> -0.717384).  Saving model ...
Epoch: 9 cost time: 1.4245054721832275
Epoch: 9, Steps: 9 | Train Loss: 0.542 Vali Loss: 0.660 Vali Acc: 0.761 Test Loss: 0.660 Test Acc: 0.761
Validation loss decreased (-0.717384 --> -0.760863).  Saving model ...
Epoch: 10 cost time: 1.393808364868164
Epoch: 10, Steps: 9 | Train Loss: 0.462 Vali Loss: 0.593 Vali Acc: 0.775 Test Loss: 0.593 Test Acc: 0.775
Validation loss decreased (-0.760863 --> -0.775356).  Saving model ...
Epoch: 11 cost time: 1.3606817722320557
Epoch: 11, Steps: 9 | Train Loss: 0.365 Vali Loss: 0.556 Vali Acc: 0.797 Test Loss: 0.556 Test Acc: 0.797
Validation loss decreased (-0.775356 --> -0.797096).  Saving model ...
Epoch: 12 cost time: 1.4713435173034668
Epoch: 12, Steps: 9 | Train Loss: 0.313 Vali Loss: 0.526 Vali Acc: 0.804 Test Loss: 0.526 Test Acc: 0.804
Validation loss decreased (-0.797096 --> -0.804343).  Saving model ...
Epoch: 13 cost time: 1.3825719356536865
Epoch: 13, Steps: 9 | Train Loss: 0.245 Vali Loss: 0.466 Vali Acc: 0.870 Test Loss: 0.466 Test Acc: 0.870
Validation loss decreased (-0.804343 --> -0.869561).  Saving model ...
Epoch: 14 cost time: 1.672729253768921
Epoch: 14, Steps: 9 | Train Loss: 0.203 Vali Loss: 0.431 Vali Acc: 0.848 Test Loss: 0.431 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7024424076080322
Epoch: 15, Steps: 9 | Train Loss: 0.179 Vali Loss: 0.399 Vali Acc: 0.855 Test Loss: 0.399 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5828120708465576
Epoch: 16, Steps: 9 | Train Loss: 0.133 Vali Loss: 0.389 Vali Acc: 0.862 Test Loss: 0.389 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.6097049713134766
Epoch: 17, Steps: 9 | Train Loss: 0.104 Vali Loss: 0.373 Vali Acc: 0.870 Test Loss: 0.373 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 18 cost time: 1.3867003917694092
Epoch: 18, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.392 Vali Acc: 0.870 Test Loss: 0.392 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7200720310211182
Epoch: 19, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.395 Vali Acc: 0.862 Test Loss: 0.395 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.6901602745056152
Epoch: 20, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.378 Vali Acc: 0.870 Test Loss: 0.378 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.6885850429534912
Epoch: 21, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.363 Vali Acc: 0.884 Test Loss: 0.363 Test Acc: 0.884
Validation loss decreased (-0.869561 --> -0.884054).  Saving model ...
Epoch: 22 cost time: 1.6882529258728027
Epoch: 22, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.354 Vali Acc: 0.877 Test Loss: 0.354 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.6587557792663574
Epoch: 23, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.357 Vali Acc: 0.884 Test Loss: 0.357 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 24 cost time: 1.7645008563995361
Epoch: 24, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.341 Vali Acc: 0.877 Test Loss: 0.341 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.7559218406677246
Epoch: 25, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.338 Vali Acc: 0.884 Test Loss: 0.338 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884055).  Saving model ...
Epoch: 26 cost time: 1.808335304260254
Epoch: 26, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.347 Vali Acc: 0.884 Test Loss: 0.347 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.722344160079956
Epoch: 27, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.329 Vali Acc: 0.899 Test Loss: 0.329 Test Acc: 0.899
Validation loss decreased (-0.884055 --> -0.898547).  Saving model ...
Epoch: 28 cost time: 1.7456426620483398
Epoch: 28, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.312 Vali Acc: 0.913 Test Loss: 0.312 Test Acc: 0.913
Validation loss decreased (-0.898547 --> -0.913040).  Saving model ...
Epoch: 29 cost time: 1.788008213043213
Epoch: 29, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.330 Vali Acc: 0.906 Test Loss: 0.330 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.7450473308563232
Epoch: 30, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.363 Vali Acc: 0.870 Test Loss: 0.363 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 599732
model size : 2.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.9951443672180176
Epoch: 1, Steps: 9 | Train Loss: 1.427 Vali Loss: 1.370 Vali Acc: 0.370 Test Loss: 1.370 Test Acc: 0.370
Validation loss decreased (inf --> -0.369552).  Saving model ...
Epoch: 2 cost time: 1.2865583896636963
Epoch: 2, Steps: 9 | Train Loss: 1.337 Vali Loss: 1.293 Vali Acc: 0.406 Test Loss: 1.293 Test Acc: 0.406
Validation loss decreased (-0.369552 --> -0.405784).  Saving model ...
Epoch: 3 cost time: 1.303116798400879
Epoch: 3, Steps: 9 | Train Loss: 1.220 Vali Loss: 1.202 Vali Acc: 0.500 Test Loss: 1.202 Test Acc: 0.500
Validation loss decreased (-0.405784 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 1.2846753597259521
Epoch: 4, Steps: 9 | Train Loss: 1.083 Vali Loss: 1.115 Vali Acc: 0.565 Test Loss: 1.115 Test Acc: 0.565
Validation loss decreased (-0.499988 --> -0.565206).  Saving model ...
Epoch: 5 cost time: 1.3825438022613525
Epoch: 5, Steps: 9 | Train Loss: 0.997 Vali Loss: 1.031 Vali Acc: 0.623 Test Loss: 1.031 Test Acc: 0.623
Validation loss decreased (-0.565206 --> -0.623178).  Saving model ...
Epoch: 6 cost time: 1.300776720046997
Epoch: 6, Steps: 9 | Train Loss: 0.846 Vali Loss: 0.944 Vali Acc: 0.645 Test Loss: 0.944 Test Acc: 0.645
Validation loss decreased (-0.623178 --> -0.644918).  Saving model ...
Epoch: 7 cost time: 1.3236620426177979
Epoch: 7, Steps: 9 | Train Loss: 0.759 Vali Loss: 0.868 Vali Acc: 0.696 Test Loss: 0.868 Test Acc: 0.696
Validation loss decreased (-0.644918 --> -0.695643).  Saving model ...
Epoch: 8 cost time: 1.2980036735534668
Epoch: 8, Steps: 9 | Train Loss: 0.638 Vali Loss: 0.789 Vali Acc: 0.732 Test Loss: 0.789 Test Acc: 0.732
Validation loss decreased (-0.695643 --> -0.731876).  Saving model ...
Epoch: 9 cost time: 1.3337652683258057
Epoch: 9, Steps: 9 | Train Loss: 0.553 Vali Loss: 0.725 Vali Acc: 0.746 Test Loss: 0.725 Test Acc: 0.746
Validation loss decreased (-0.731876 --> -0.746370).  Saving model ...
Epoch: 10 cost time: 1.119978904724121
Epoch: 10, Steps: 9 | Train Loss: 0.486 Vali Loss: 0.654 Vali Acc: 0.783 Test Loss: 0.654 Test Acc: 0.783
Validation loss decreased (-0.746370 --> -0.782602).  Saving model ...
Epoch: 11 cost time: 1.3259479999542236
Epoch: 11, Steps: 9 | Train Loss: 0.382 Vali Loss: 0.606 Vali Acc: 0.790 Test Loss: 0.606 Test Acc: 0.790
Validation loss decreased (-0.782602 --> -0.789849).  Saving model ...
Epoch: 12 cost time: 1.3311569690704346
Epoch: 12, Steps: 9 | Train Loss: 0.323 Vali Loss: 0.586 Vali Acc: 0.812 Test Loss: 0.586 Test Acc: 0.812
Validation loss decreased (-0.789849 --> -0.811588).  Saving model ...
Epoch: 13 cost time: 1.2597172260284424
Epoch: 13, Steps: 9 | Train Loss: 0.261 Vali Loss: 0.505 Vali Acc: 0.848 Test Loss: 0.505 Test Acc: 0.848
Validation loss decreased (-0.811588 --> -0.847821).  Saving model ...
Epoch: 14 cost time: 1.3369417190551758
Epoch: 14, Steps: 9 | Train Loss: 0.210 Vali Loss: 0.435 Vali Acc: 0.862 Test Loss: 0.435 Test Acc: 0.862
Validation loss decreased (-0.847821 --> -0.862314).  Saving model ...
Epoch: 15 cost time: 1.3213958740234375
Epoch: 15, Steps: 9 | Train Loss: 0.180 Vali Loss: 0.408 Vali Acc: 0.862 Test Loss: 0.408 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862315).  Saving model ...
Epoch: 16 cost time: 1.3785314559936523
Epoch: 16, Steps: 9 | Train Loss: 0.141 Vali Loss: 0.392 Vali Acc: 0.870 Test Loss: 0.392 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869561).  Saving model ...
Epoch: 17 cost time: 1.3160896301269531
Epoch: 17, Steps: 9 | Train Loss: 0.103 Vali Loss: 0.341 Vali Acc: 0.891 Test Loss: 0.341 Test Acc: 0.891
Validation loss decreased (-0.869561 --> -0.891301).  Saving model ...
Epoch: 18 cost time: 1.3055741786956787
Epoch: 18, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.316 Vali Acc: 0.899 Test Loss: 0.316 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898548).  Saving model ...
Epoch: 19 cost time: 1.3383524417877197
Epoch: 19, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.316 Vali Acc: 0.899 Test Loss: 0.316 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3849849700927734
Epoch: 20, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.306 Vali Acc: 0.891 Test Loss: 0.306 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3701186180114746
Epoch: 21, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.285 Vali Acc: 0.891 Test Loss: 0.285 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.3611130714416504
Epoch: 22, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.290 Vali Acc: 0.928 Test Loss: 0.290 Test Acc: 0.928
Validation loss decreased (-0.898548 --> -0.927533).  Saving model ...
Epoch: 23 cost time: 1.3813087940216064
Epoch: 23, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.286 Vali Acc: 0.920 Test Loss: 0.286 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3138833045959473
Epoch: 24, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.274 Vali Acc: 0.920 Test Loss: 0.274 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.3546488285064697
Epoch: 25, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.259 Vali Acc: 0.920 Test Loss: 0.259 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.1672754287719727
Epoch: 26, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.247 Vali Acc: 0.920 Test Loss: 0.247 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.361807107925415
Epoch: 27, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.235 Vali Acc: 0.920 Test Loss: 0.235 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.3395934104919434
Epoch: 28, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.240 Vali Acc: 0.920 Test Loss: 0.240 Test Acc: 0.920
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.3537752628326416
Epoch: 29, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.244 Vali Acc: 0.913 Test Loss: 0.244 Test Acc: 0.913
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.3703739643096924
Epoch: 30, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.225 Vali Acc: 0.920 Test Loss: 0.225 Test Acc: 0.920
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.927536231884058
model parameter : 185844
model size : 1.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.216522693634033
Epoch: 1, Steps: 9 | Train Loss: 1.367 Vali Loss: 1.350 Vali Acc: 0.406 Test Loss: 1.350 Test Acc: 0.406
Validation loss decreased (inf --> -0.405784).  Saving model ...
Epoch: 2 cost time: 2.319225549697876
Epoch: 2, Steps: 9 | Train Loss: 1.318 Vali Loss: 1.264 Vali Acc: 0.514 Test Loss: 1.264 Test Acc: 0.514
Validation loss decreased (-0.405784 --> -0.514480).  Saving model ...
Epoch: 3 cost time: 2.4735653400421143
Epoch: 3, Steps: 9 | Train Loss: 1.183 Vali Loss: 1.152 Vali Acc: 0.572 Test Loss: 1.152 Test Acc: 0.572
Validation loss decreased (-0.514480 --> -0.572452).  Saving model ...
Epoch: 4 cost time: 2.330859899520874
Epoch: 4, Steps: 9 | Train Loss: 1.035 Vali Loss: 1.035 Vali Acc: 0.652 Test Loss: 1.035 Test Acc: 0.652
Validation loss decreased (-0.572452 --> -0.652164).  Saving model ...
Epoch: 5 cost time: 2.3262505531311035
Epoch: 5, Steps: 9 | Train Loss: 0.906 Vali Loss: 0.886 Vali Acc: 0.710 Test Loss: 0.886 Test Acc: 0.710
Validation loss decreased (-0.652164 --> -0.710136).  Saving model ...
Epoch: 6 cost time: 2.327728271484375
Epoch: 6, Steps: 9 | Train Loss: 0.742 Vali Loss: 0.722 Vali Acc: 0.761 Test Loss: 0.722 Test Acc: 0.761
Validation loss decreased (-0.710136 --> -0.760862).  Saving model ...
Epoch: 7 cost time: 1.9124293327331543
Epoch: 7, Steps: 9 | Train Loss: 0.605 Vali Loss: 0.595 Vali Acc: 0.797 Test Loss: 0.595 Test Acc: 0.797
Validation loss decreased (-0.760862 --> -0.797095).  Saving model ...
Epoch: 8 cost time: 2.282886505126953
Epoch: 8, Steps: 9 | Train Loss: 0.499 Vali Loss: 0.501 Vali Acc: 0.797 Test Loss: 0.501 Test Acc: 0.797
Validation loss decreased (-0.797095 --> -0.797096).  Saving model ...
Epoch: 9 cost time: 2.2190444469451904
Epoch: 9, Steps: 9 | Train Loss: 0.382 Vali Loss: 0.451 Vali Acc: 0.833 Test Loss: 0.451 Test Acc: 0.833
Validation loss decreased (-0.797096 --> -0.833329).  Saving model ...
Epoch: 10 cost time: 2.2845630645751953
Epoch: 10, Steps: 9 | Train Loss: 0.312 Vali Loss: 0.451 Vali Acc: 0.826 Test Loss: 0.451 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.165672540664673
Epoch: 11, Steps: 9 | Train Loss: 0.289 Vali Loss: 0.422 Vali Acc: 0.848 Test Loss: 0.422 Test Acc: 0.848
Validation loss decreased (-0.833329 --> -0.847822).  Saving model ...
Epoch: 12 cost time: 2.272242784500122
Epoch: 12, Steps: 9 | Train Loss: 0.200 Vali Loss: 0.399 Vali Acc: 0.855 Test Loss: 0.399 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855068).  Saving model ...
Epoch: 13 cost time: 2.1939778327941895
Epoch: 13, Steps: 9 | Train Loss: 0.167 Vali Loss: 0.356 Vali Acc: 0.877 Test Loss: 0.356 Test Acc: 0.877
Validation loss decreased (-0.855068 --> -0.876808).  Saving model ...
Epoch: 14 cost time: 2.2846853733062744
Epoch: 14, Steps: 9 | Train Loss: 0.238 Vali Loss: 0.388 Vali Acc: 0.855 Test Loss: 0.388 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.004875659942627
Epoch: 15, Steps: 9 | Train Loss: 0.121 Vali Loss: 0.372 Vali Acc: 0.870 Test Loss: 0.372 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.225929021835327
Epoch: 16, Steps: 9 | Train Loss: 0.134 Vali Loss: 0.392 Vali Acc: 0.848 Test Loss: 0.392 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.1525282859802246
Epoch: 17, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.370 Vali Acc: 0.862 Test Loss: 0.370 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.244823694229126
Epoch: 18, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.352 Vali Acc: 0.855 Test Loss: 0.352 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.8582446575164795
Epoch: 19, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.354 Vali Acc: 0.855 Test Loss: 0.354 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.141510486602783
Epoch: 20, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.360 Vali Acc: 0.862 Test Loss: 0.360 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.095078229904175
Epoch: 21, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.370 Vali Acc: 0.862 Test Loss: 0.370 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.2383878231048584
Epoch: 22, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.376 Vali Acc: 0.862 Test Loss: 0.376 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.1230692863464355
Epoch: 23, Steps: 9 | Train Loss: 0.141 Vali Loss: 0.389 Vali Acc: 0.862 Test Loss: 0.389 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 306676
model size : 1.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.3861334323883057
Epoch: 1, Steps: 9 | Train Loss: 1.370 Vali Loss: 1.337 Vali Acc: 0.297 Test Loss: 1.337 Test Acc: 0.297
Validation loss decreased (inf --> -0.297088).  Saving model ...
Epoch: 2 cost time: 1.699331521987915
Epoch: 2, Steps: 9 | Train Loss: 1.278 Vali Loss: 1.236 Vali Acc: 0.399 Test Loss: 1.236 Test Acc: 0.399
Validation loss decreased (-0.297088 --> -0.398538).  Saving model ...
Epoch: 3 cost time: 1.5748636722564697
Epoch: 3, Steps: 9 | Train Loss: 1.166 Vali Loss: 1.115 Vali Acc: 0.507 Test Loss: 1.115 Test Acc: 0.507
Validation loss decreased (-0.398538 --> -0.507235).  Saving model ...
Epoch: 4 cost time: 1.7392518520355225
Epoch: 4, Steps: 9 | Train Loss: 1.014 Vali Loss: 1.009 Vali Acc: 0.616 Test Loss: 1.009 Test Acc: 0.616
Validation loss decreased (-0.507235 --> -0.615932).  Saving model ...
Epoch: 5 cost time: 1.408060073852539
Epoch: 5, Steps: 9 | Train Loss: 0.910 Vali Loss: 0.913 Vali Acc: 0.710 Test Loss: 0.913 Test Acc: 0.710
Validation loss decreased (-0.615932 --> -0.710136).  Saving model ...
Epoch: 6 cost time: 1.7023966312408447
Epoch: 6, Steps: 9 | Train Loss: 0.774 Vali Loss: 0.826 Vali Acc: 0.696 Test Loss: 0.826 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7395071983337402
Epoch: 7, Steps: 9 | Train Loss: 0.691 Vali Loss: 0.729 Vali Acc: 0.768 Test Loss: 0.729 Test Acc: 0.768
Validation loss decreased (-0.710136 --> -0.768109).  Saving model ...
Epoch: 8 cost time: 1.63673734664917
Epoch: 8, Steps: 9 | Train Loss: 0.553 Vali Loss: 0.633 Vali Acc: 0.797 Test Loss: 0.633 Test Acc: 0.797
Validation loss decreased (-0.768109 --> -0.797095).  Saving model ...
Epoch: 9 cost time: 1.6479368209838867
Epoch: 9, Steps: 9 | Train Loss: 0.453 Vali Loss: 0.535 Vali Acc: 0.826 Test Loss: 0.535 Test Acc: 0.826
Validation loss decreased (-0.797095 --> -0.826082).  Saving model ...
Epoch: 10 cost time: 1.681727409362793
Epoch: 10, Steps: 9 | Train Loss: 0.381 Vali Loss: 0.483 Vali Acc: 0.833 Test Loss: 0.483 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833329).  Saving model ...
Epoch: 11 cost time: 1.7925899028778076
Epoch: 11, Steps: 9 | Train Loss: 0.289 Vali Loss: 0.454 Vali Acc: 0.848 Test Loss: 0.454 Test Acc: 0.848
Validation loss decreased (-0.833329 --> -0.847822).  Saving model ...
Epoch: 12 cost time: 1.6366519927978516
Epoch: 12, Steps: 9 | Train Loss: 0.343 Vali Loss: 0.442 Vali Acc: 0.855 Test Loss: 0.442 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855068).  Saving model ...
Epoch: 13 cost time: 1.6556506156921387
Epoch: 13, Steps: 9 | Train Loss: 0.220 Vali Loss: 0.399 Vali Acc: 0.870 Test Loss: 0.399 Test Acc: 0.870
Validation loss decreased (-0.855068 --> -0.869561).  Saving model ...
Epoch: 14 cost time: 1.634286880493164
Epoch: 14, Steps: 9 | Train Loss: 0.177 Vali Loss: 0.379 Vali Acc: 0.870 Test Loss: 0.379 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 15 cost time: 1.7159702777862549
Epoch: 15, Steps: 9 | Train Loss: 0.194 Vali Loss: 0.425 Vali Acc: 0.855 Test Loss: 0.425 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5685405731201172
Epoch: 16, Steps: 9 | Train Loss: 0.184 Vali Loss: 0.470 Vali Acc: 0.804 Test Loss: 0.470 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7025446891784668
Epoch: 17, Steps: 9 | Train Loss: 0.118 Vali Loss: 0.405 Vali Acc: 0.855 Test Loss: 0.405 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.442976951599121
Epoch: 18, Steps: 9 | Train Loss: 0.139 Vali Loss: 0.413 Vali Acc: 0.870 Test Loss: 0.413 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.7287828922271729
Epoch: 19, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.438 Vali Acc: 0.855 Test Loss: 0.438 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.770029067993164
Epoch: 20, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.380 Vali Acc: 0.884 Test Loss: 0.380 Test Acc: 0.884
Validation loss decreased (-0.869561 --> -0.884054).  Saving model ...
Epoch: 21 cost time: 1.7145845890045166
Epoch: 21, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.403 Vali Acc: 0.877 Test Loss: 0.403 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.7090535163879395
Epoch: 22, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.410 Vali Acc: 0.862 Test Loss: 0.410 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.8007848262786865
Epoch: 23, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.409 Vali Acc: 0.855 Test Loss: 0.409 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.6494338512420654
Epoch: 24, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.381 Vali Acc: 0.870 Test Loss: 0.381 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.7746362686157227
Epoch: 25, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.393 Vali Acc: 0.870 Test Loss: 0.393 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.7579121589660645
Epoch: 26, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.395 Vali Acc: 0.877 Test Loss: 0.395 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.759871244430542
Epoch: 27, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.381 Vali Acc: 0.877 Test Loss: 0.381 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.8226609230041504
Epoch: 28, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.398 Vali Acc: 0.870 Test Loss: 0.398 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.7905235290527344
Epoch: 29, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.413 Vali Acc: 0.870 Test Loss: 0.413 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.7341952323913574
Epoch: 30, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.426 Vali Acc: 0.877 Test Loss: 0.426 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 99700
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.048063278198242
Epoch: 1, Steps: 9 | Train Loss: 1.364 Vali Loss: 1.354 Vali Acc: 0.377 Test Loss: 1.354 Test Acc: 0.377
Validation loss decreased (inf --> -0.376798).  Saving model ...
Epoch: 2 cost time: 2.0485498905181885
Epoch: 2, Steps: 9 | Train Loss: 1.318 Vali Loss: 1.271 Vali Acc: 0.486 Test Loss: 1.271 Test Acc: 0.486
Validation loss decreased (-0.376798 --> -0.485495).  Saving model ...
Epoch: 3 cost time: 2.0005578994750977
Epoch: 3, Steps: 9 | Train Loss: 1.194 Vali Loss: 1.160 Vali Acc: 0.558 Test Loss: 1.160 Test Acc: 0.558
Validation loss decreased (-0.485495 --> -0.557959).  Saving model ...
Epoch: 4 cost time: 2.107851028442383
Epoch: 4, Steps: 9 | Train Loss: 1.049 Vali Loss: 1.050 Vali Acc: 0.645 Test Loss: 1.050 Test Acc: 0.645
Validation loss decreased (-0.557959 --> -0.644917).  Saving model ...
Epoch: 5 cost time: 2.039822578430176
Epoch: 5, Steps: 9 | Train Loss: 0.918 Vali Loss: 0.913 Vali Acc: 0.710 Test Loss: 0.913 Test Acc: 0.710
Validation loss decreased (-0.644917 --> -0.710136).  Saving model ...
Epoch: 6 cost time: 2.0201785564422607
Epoch: 6, Steps: 9 | Train Loss: 0.769 Vali Loss: 0.760 Vali Acc: 0.761 Test Loss: 0.760 Test Acc: 0.761
Validation loss decreased (-0.710136 --> -0.760862).  Saving model ...
Epoch: 7 cost time: 1.9207124710083008
Epoch: 7, Steps: 9 | Train Loss: 0.659 Vali Loss: 0.635 Vali Acc: 0.790 Test Loss: 0.635 Test Acc: 0.790
Validation loss decreased (-0.760862 --> -0.789849).  Saving model ...
Epoch: 8 cost time: 2.02894926071167
Epoch: 8, Steps: 9 | Train Loss: 0.589 Vali Loss: 0.547 Vali Acc: 0.797 Test Loss: 0.547 Test Acc: 0.797
Validation loss decreased (-0.789849 --> -0.797096).  Saving model ...
Epoch: 9 cost time: 1.983905553817749
Epoch: 9, Steps: 9 | Train Loss: 0.459 Vali Loss: 0.472 Vali Acc: 0.826 Test Loss: 0.472 Test Acc: 0.826
Validation loss decreased (-0.797096 --> -0.826082).  Saving model ...
Epoch: 10 cost time: 1.9902393817901611
Epoch: 10, Steps: 9 | Train Loss: 0.364 Vali Loss: 0.447 Vali Acc: 0.833 Test Loss: 0.447 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833329).  Saving model ...
Epoch: 11 cost time: 2.1389594078063965
Epoch: 11, Steps: 9 | Train Loss: 0.309 Vali Loss: 0.431 Vali Acc: 0.833 Test Loss: 0.431 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 12 cost time: 1.927293300628662
Epoch: 12, Steps: 9 | Train Loss: 0.243 Vali Loss: 0.416 Vali Acc: 0.841 Test Loss: 0.416 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840576).  Saving model ...
Epoch: 13 cost time: 2.0295863151550293
Epoch: 13, Steps: 9 | Train Loss: 0.187 Vali Loss: 0.372 Vali Acc: 0.855 Test Loss: 0.372 Test Acc: 0.855
Validation loss decreased (-0.840576 --> -0.855069).  Saving model ...
Epoch: 14 cost time: 1.9971966743469238
Epoch: 14, Steps: 9 | Train Loss: 0.218 Vali Loss: 0.396 Vali Acc: 0.848 Test Loss: 0.396 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9121153354644775
Epoch: 15, Steps: 9 | Train Loss: 0.144 Vali Loss: 0.397 Vali Acc: 0.848 Test Loss: 0.397 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.044297695159912
Epoch: 16, Steps: 9 | Train Loss: 0.146 Vali Loss: 0.411 Vali Acc: 0.833 Test Loss: 0.411 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.0570287704467773
Epoch: 17, Steps: 9 | Train Loss: 0.107 Vali Loss: 0.400 Vali Acc: 0.833 Test Loss: 0.400 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.916919231414795
Epoch: 18, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.381 Vali Acc: 0.855 Test Loss: 0.381 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.055530548095703
Epoch: 19, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.374 Vali Acc: 0.862 Test Loss: 0.374 Test Acc: 0.862
Validation loss decreased (-0.855069 --> -0.862315).  Saving model ...
Epoch: 20 cost time: 2.0527403354644775
Epoch: 20, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.390 Vali Acc: 0.870 Test Loss: 0.390 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869561).  Saving model ...
Epoch: 21 cost time: 2.03102707862854
Epoch: 21, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.431 Vali Acc: 0.862 Test Loss: 0.431 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.7391963005065918
Epoch: 22, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.425 Vali Acc: 0.862 Test Loss: 0.425 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.6541783809661865
Epoch: 23, Steps: 9 | Train Loss: 0.304 Vali Loss: 0.465 Vali Acc: 0.833 Test Loss: 0.465 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.678682565689087
Epoch: 24, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.423 Vali Acc: 0.841 Test Loss: 0.423 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.8745839595794678
Epoch: 25, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.375 Vali Acc: 0.848 Test Loss: 0.375 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.853437900543213
Epoch: 26, Steps: 9 | Train Loss: 0.102 Vali Loss: 0.376 Vali Acc: 0.855 Test Loss: 0.376 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.870485544204712
Epoch: 27, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.380 Vali Acc: 0.862 Test Loss: 0.380 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.907851219177246
Epoch: 28, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.393 Vali Acc: 0.862 Test Loss: 0.393 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.8901925086975098
Epoch: 29, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.402 Vali Acc: 0.855 Test Loss: 0.402 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.969261646270752
Epoch: 30, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.427 Vali Acc: 0.841 Test Loss: 0.427 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 306676
model size : 1.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.3362538814544678
Epoch: 1, Steps: 9 | Train Loss: 1.365 Vali Loss: 1.337 Vali Acc: 0.304 Test Loss: 1.337 Test Acc: 0.304
Validation loss decreased (inf --> -0.304334).  Saving model ...
Epoch: 2 cost time: 1.5262315273284912
Epoch: 2, Steps: 9 | Train Loss: 1.277 Vali Loss: 1.238 Vali Acc: 0.420 Test Loss: 1.238 Test Acc: 0.420
Validation loss decreased (-0.304334 --> -0.420277).  Saving model ...
Epoch: 3 cost time: 1.4525396823883057
Epoch: 3, Steps: 9 | Train Loss: 1.166 Vali Loss: 1.119 Vali Acc: 0.514 Test Loss: 1.119 Test Acc: 0.514
Validation loss decreased (-0.420277 --> -0.514482).  Saving model ...
Epoch: 4 cost time: 1.504568099975586
Epoch: 4, Steps: 9 | Train Loss: 1.014 Vali Loss: 1.016 Vali Acc: 0.609 Test Loss: 1.016 Test Acc: 0.609
Validation loss decreased (-0.514482 --> -0.608685).  Saving model ...
Epoch: 5 cost time: 1.4592924118041992
Epoch: 5, Steps: 9 | Train Loss: 0.921 Vali Loss: 0.925 Vali Acc: 0.703 Test Loss: 0.925 Test Acc: 0.703
Validation loss decreased (-0.608685 --> -0.702889).  Saving model ...
Epoch: 6 cost time: 1.4569497108459473
Epoch: 6, Steps: 9 | Train Loss: 0.793 Vali Loss: 0.851 Vali Acc: 0.674 Test Loss: 0.851 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5129096508026123
Epoch: 7, Steps: 9 | Train Loss: 0.721 Vali Loss: 0.766 Vali Acc: 0.761 Test Loss: 0.766 Test Acc: 0.761
Validation loss decreased (-0.702889 --> -0.760862).  Saving model ...
Epoch: 8 cost time: 1.4826927185058594
Epoch: 8, Steps: 9 | Train Loss: 0.600 Vali Loss: 0.688 Vali Acc: 0.797 Test Loss: 0.688 Test Acc: 0.797
Validation loss decreased (-0.760862 --> -0.797095).  Saving model ...
Epoch: 9 cost time: 1.4855027198791504
Epoch: 9, Steps: 9 | Train Loss: 0.519 Vali Loss: 0.593 Vali Acc: 0.819 Test Loss: 0.593 Test Acc: 0.819
Validation loss decreased (-0.797095 --> -0.818835).  Saving model ...
Epoch: 10 cost time: 1.5469751358032227
Epoch: 10, Steps: 9 | Train Loss: 0.443 Vali Loss: 0.530 Vali Acc: 0.826 Test Loss: 0.530 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826082).  Saving model ...
Epoch: 11 cost time: 1.455416202545166
Epoch: 11, Steps: 9 | Train Loss: 0.359 Vali Loss: 0.489 Vali Acc: 0.862 Test Loss: 0.489 Test Acc: 0.862
Validation loss decreased (-0.826082 --> -0.862314).  Saving model ...
Epoch: 12 cost time: 1.504643201828003
Epoch: 12, Steps: 9 | Train Loss: 0.314 Vali Loss: 0.467 Vali Acc: 0.855 Test Loss: 0.467 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5422251224517822
Epoch: 13, Steps: 9 | Train Loss: 0.251 Vali Loss: 0.430 Vali Acc: 0.870 Test Loss: 0.430 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869561).  Saving model ...
Epoch: 14 cost time: 1.5388569831848145
Epoch: 14, Steps: 9 | Train Loss: 0.208 Vali Loss: 0.428 Vali Acc: 0.877 Test Loss: 0.428 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876807).  Saving model ...
Epoch: 15 cost time: 1.4694545269012451
Epoch: 15, Steps: 9 | Train Loss: 0.185 Vali Loss: 0.447 Vali Acc: 0.855 Test Loss: 0.447 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4653112888336182
Epoch: 16, Steps: 9 | Train Loss: 0.182 Vali Loss: 0.454 Vali Acc: 0.833 Test Loss: 0.454 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.5514700412750244
Epoch: 17, Steps: 9 | Train Loss: 0.139 Vali Loss: 0.433 Vali Acc: 0.848 Test Loss: 0.433 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.4999070167541504
Epoch: 18, Steps: 9 | Train Loss: 0.113 Vali Loss: 0.415 Vali Acc: 0.862 Test Loss: 0.415 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.4254074096679688
Epoch: 19, Steps: 9 | Train Loss: 0.109 Vali Loss: 0.431 Vali Acc: 0.848 Test Loss: 0.431 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.4872381687164307
Epoch: 20, Steps: 9 | Train Loss: 0.104 Vali Loss: 0.413 Vali Acc: 0.848 Test Loss: 0.413 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.4712083339691162
Epoch: 21, Steps: 9 | Train Loss: 0.080 Vali Loss: 0.432 Vali Acc: 0.841 Test Loss: 0.432 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.4629969596862793
Epoch: 22, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.417 Vali Acc: 0.855 Test Loss: 0.417 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.446518898010254
Epoch: 23, Steps: 9 | Train Loss: 0.104 Vali Loss: 0.380 Vali Acc: 0.862 Test Loss: 0.380 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.4514071941375732
Epoch: 24, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.361 Vali Acc: 0.855 Test Loss: 0.361 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 99700
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.250199317932129
Epoch: 1, Steps: 9 | Train Loss: 1.361 Vali Loss: 1.356 Vali Acc: 0.377 Test Loss: 1.356 Test Acc: 0.377
Validation loss decreased (inf --> -0.376798).  Saving model ...
Epoch: 2 cost time: 1.5143628120422363
Epoch: 2, Steps: 9 | Train Loss: 1.316 Vali Loss: 1.279 Vali Acc: 0.493 Test Loss: 1.279 Test Acc: 0.493
Validation loss decreased (-0.376798 --> -0.492741).  Saving model ...
Epoch: 3 cost time: 1.4644749164581299
Epoch: 3, Steps: 9 | Train Loss: 1.198 Vali Loss: 1.185 Vali Acc: 0.543 Test Loss: 1.185 Test Acc: 0.543
Validation loss decreased (-0.492741 --> -0.543466).  Saving model ...
Epoch: 4 cost time: 1.488250732421875
Epoch: 4, Steps: 9 | Train Loss: 1.061 Vali Loss: 1.098 Vali Acc: 0.587 Test Loss: 1.098 Test Acc: 0.587
Validation loss decreased (-0.543466 --> -0.586946).  Saving model ...
Epoch: 5 cost time: 1.5393736362457275
Epoch: 5, Steps: 9 | Train Loss: 0.960 Vali Loss: 1.008 Vali Acc: 0.630 Test Loss: 1.008 Test Acc: 0.630
Validation loss decreased (-0.586946 --> -0.630425).  Saving model ...
Epoch: 6 cost time: 1.5048198699951172
Epoch: 6, Steps: 9 | Train Loss: 0.815 Vali Loss: 0.929 Vali Acc: 0.667 Test Loss: 0.929 Test Acc: 0.667
Validation loss decreased (-0.630425 --> -0.666657).  Saving model ...
Epoch: 7 cost time: 1.4634709358215332
Epoch: 7, Steps: 9 | Train Loss: 0.718 Vali Loss: 0.836 Vali Acc: 0.703 Test Loss: 0.836 Test Acc: 0.703
Validation loss decreased (-0.666657 --> -0.702890).  Saving model ...
Epoch: 8 cost time: 1.4711294174194336
Epoch: 8, Steps: 9 | Train Loss: 0.642 Vali Loss: 0.748 Vali Acc: 0.703 Test Loss: 0.748 Test Acc: 0.703
Validation loss decreased (-0.702890 --> -0.702891).  Saving model ...
Epoch: 9 cost time: 1.4109091758728027
Epoch: 9, Steps: 9 | Train Loss: 0.528 Vali Loss: 0.647 Vali Acc: 0.739 Test Loss: 0.647 Test Acc: 0.739
Validation loss decreased (-0.702891 --> -0.739124).  Saving model ...
Epoch: 10 cost time: 1.5558490753173828
Epoch: 10, Steps: 9 | Train Loss: 0.458 Vali Loss: 0.571 Vali Acc: 0.783 Test Loss: 0.571 Test Acc: 0.783
Validation loss decreased (-0.739124 --> -0.782603).  Saving model ...
Epoch: 11 cost time: 1.352971076965332
Epoch: 11, Steps: 9 | Train Loss: 0.347 Vali Loss: 0.528 Vali Acc: 0.804 Test Loss: 0.528 Test Acc: 0.804
Validation loss decreased (-0.782603 --> -0.804343).  Saving model ...
Epoch: 12 cost time: 1.5970616340637207
Epoch: 12, Steps: 9 | Train Loss: 0.305 Vali Loss: 0.503 Vali Acc: 0.826 Test Loss: 0.503 Test Acc: 0.826
Validation loss decreased (-0.804343 --> -0.826082).  Saving model ...
Epoch: 13 cost time: 1.5407142639160156
Epoch: 13, Steps: 9 | Train Loss: 0.235 Vali Loss: 0.461 Vali Acc: 0.826 Test Loss: 0.461 Test Acc: 0.826
Validation loss decreased (-0.826082 --> -0.826082).  Saving model ...
Epoch: 14 cost time: 1.5982611179351807
Epoch: 14, Steps: 9 | Train Loss: 0.220 Vali Loss: 0.463 Vali Acc: 0.819 Test Loss: 0.463 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.546048879623413
Epoch: 15, Steps: 9 | Train Loss: 0.162 Vali Loss: 0.468 Vali Acc: 0.812 Test Loss: 0.468 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6175332069396973
Epoch: 16, Steps: 9 | Train Loss: 0.132 Vali Loss: 0.494 Vali Acc: 0.812 Test Loss: 0.494 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.5368399620056152
Epoch: 17, Steps: 9 | Train Loss: 0.130 Vali Loss: 0.516 Vali Acc: 0.804 Test Loss: 0.516 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.4760661125183105
Epoch: 18, Steps: 9 | Train Loss: 0.096 Vali Loss: 0.502 Vali Acc: 0.797 Test Loss: 0.502 Test Acc: 0.797
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.4236865043640137
Epoch: 19, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.468 Vali Acc: 0.804 Test Loss: 0.468 Test Acc: 0.804
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.5754666328430176
Epoch: 20, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.434 Vali Acc: 0.841 Test Loss: 0.434 Test Acc: 0.841
Validation loss decreased (-0.826082 --> -0.840575).  Saving model ...
Epoch: 21 cost time: 1.5560379028320312
Epoch: 21, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.417 Vali Acc: 0.841 Test Loss: 0.417 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840576).  Saving model ...
Epoch: 22 cost time: 1.51495361328125
Epoch: 22, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.413 Vali Acc: 0.841 Test Loss: 0.413 Test Acc: 0.841
Validation loss decreased (-0.840576 --> -0.840576).  Saving model ...
Epoch: 23 cost time: 1.6072595119476318
Epoch: 23, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.410 Vali Acc: 0.841 Test Loss: 0.410 Test Acc: 0.841
Validation loss decreased (-0.840576 --> -0.840576).  Saving model ...
Epoch: 24 cost time: 1.6165688037872314
Epoch: 24, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.447 Vali Acc: 0.841 Test Loss: 0.447 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5887775421142578
Epoch: 25, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.416 Vali Acc: 0.833 Test Loss: 0.416 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.6543056964874268
Epoch: 26, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.413 Vali Acc: 0.841 Test Loss: 0.413 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.510596752166748
Epoch: 27, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.405 Vali Acc: 0.862 Test Loss: 0.405 Test Acc: 0.862
Validation loss decreased (-0.840576 --> -0.862315).  Saving model ...
Epoch: 28 cost time: 1.4984991550445557
Epoch: 28, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.393 Vali Acc: 0.870 Test Loss: 0.393 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869561).  Saving model ...
Epoch: 29 cost time: 1.6702775955200195
Epoch: 29, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.428 Vali Acc: 0.848 Test Loss: 0.428 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.6137783527374268
Epoch: 30, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.452 Vali Acc: 0.841 Test Loss: 0.452 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 306676
model size : 1.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.8376619815826416
Epoch: 1, Steps: 9 | Train Loss: 1.364 Vali Loss: 1.341 Vali Acc: 0.297 Test Loss: 1.341 Test Acc: 0.297
Validation loss decreased (inf --> -0.297088).  Saving model ...
Epoch: 2 cost time: 1.2084307670593262
Epoch: 2, Steps: 9 | Train Loss: 1.275 Vali Loss: 1.246 Vali Acc: 0.370 Test Loss: 1.246 Test Acc: 0.370
Validation loss decreased (-0.297088 --> -0.369553).  Saving model ...
Epoch: 3 cost time: 1.146111011505127
Epoch: 3, Steps: 9 | Train Loss: 1.170 Vali Loss: 1.133 Vali Acc: 0.457 Test Loss: 1.133 Test Acc: 0.457
Validation loss decreased (-0.369553 --> -0.456510).  Saving model ...
Epoch: 4 cost time: 1.2785043716430664
Epoch: 4, Steps: 9 | Train Loss: 1.022 Vali Loss: 1.041 Vali Acc: 0.565 Test Loss: 1.041 Test Acc: 0.565
Validation loss decreased (-0.456510 --> -0.565207).  Saving model ...
Epoch: 5 cost time: 1.248189926147461
Epoch: 5, Steps: 9 | Train Loss: 0.937 Vali Loss: 0.962 Vali Acc: 0.630 Test Loss: 0.962 Test Acc: 0.630
Validation loss decreased (-0.565207 --> -0.630425).  Saving model ...
Epoch: 6 cost time: 1.0697340965270996
Epoch: 6, Steps: 9 | Train Loss: 0.815 Vali Loss: 0.906 Vali Acc: 0.616 Test Loss: 0.906 Test Acc: 0.616
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1025030612945557
Epoch: 7, Steps: 9 | Train Loss: 0.730 Vali Loss: 0.844 Vali Acc: 0.688 Test Loss: 0.844 Test Acc: 0.688
Validation loss decreased (-0.630425 --> -0.688397).  Saving model ...
Epoch: 8 cost time: 1.136486291885376
Epoch: 8, Steps: 9 | Train Loss: 0.638 Vali Loss: 0.799 Vali Acc: 0.717 Test Loss: 0.799 Test Acc: 0.717
Validation loss decreased (-0.688397 --> -0.717383).  Saving model ...
Epoch: 9 cost time: 1.113684892654419
Epoch: 9, Steps: 9 | Train Loss: 0.582 Vali Loss: 0.750 Vali Acc: 0.732 Test Loss: 0.750 Test Acc: 0.732
Validation loss decreased (-0.717383 --> -0.731877).  Saving model ...
Epoch: 10 cost time: 1.1288292407989502
Epoch: 10, Steps: 9 | Train Loss: 0.504 Vali Loss: 0.702 Vali Acc: 0.775 Test Loss: 0.702 Test Acc: 0.775
Validation loss decreased (-0.731877 --> -0.775355).  Saving model ...
Epoch: 11 cost time: 1.3262577056884766
Epoch: 11, Steps: 9 | Train Loss: 0.403 Vali Loss: 0.655 Vali Acc: 0.804 Test Loss: 0.655 Test Acc: 0.804
Validation loss decreased (-0.775355 --> -0.804341).  Saving model ...
Epoch: 12 cost time: 1.2732014656066895
Epoch: 12, Steps: 9 | Train Loss: 0.343 Vali Loss: 0.622 Vali Acc: 0.797 Test Loss: 0.622 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.314269781112671
Epoch: 13, Steps: 9 | Train Loss: 0.290 Vali Loss: 0.573 Vali Acc: 0.819 Test Loss: 0.573 Test Acc: 0.819
Validation loss decreased (-0.804341 --> -0.818835).  Saving model ...
Epoch: 14 cost time: 1.1991899013519287
Epoch: 14, Steps: 9 | Train Loss: 0.243 Vali Loss: 0.541 Vali Acc: 0.804 Test Loss: 0.541 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2832677364349365
Epoch: 15, Steps: 9 | Train Loss: 0.209 Vali Loss: 0.522 Vali Acc: 0.812 Test Loss: 0.522 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.203747272491455
Epoch: 16, Steps: 9 | Train Loss: 0.175 Vali Loss: 0.497 Vali Acc: 0.804 Test Loss: 0.497 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2685949802398682
Epoch: 17, Steps: 9 | Train Loss: 0.139 Vali Loss: 0.476 Vali Acc: 0.804 Test Loss: 0.476 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1295759677886963
Epoch: 18, Steps: 9 | Train Loss: 0.120 Vali Loss: 0.483 Vali Acc: 0.819 Test Loss: 0.483 Test Acc: 0.819
Validation loss decreased (-0.818835 --> -0.818836).  Saving model ...
Epoch: 19 cost time: 1.3099768161773682
Epoch: 19, Steps: 9 | Train Loss: 0.106 Vali Loss: 0.494 Vali Acc: 0.826 Test Loss: 0.494 Test Acc: 0.826
Validation loss decreased (-0.818836 --> -0.826082).  Saving model ...
Epoch: 20 cost time: 1.1981465816497803
Epoch: 20, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.462 Vali Acc: 0.819 Test Loss: 0.462 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3983800411224365
Epoch: 21, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.471 Vali Acc: 0.819 Test Loss: 0.471 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.2916443347930908
Epoch: 22, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.462 Vali Acc: 0.812 Test Loss: 0.462 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.2680156230926514
Epoch: 23, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.463 Vali Acc: 0.819 Test Loss: 0.463 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.1459903717041016
Epoch: 24, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.460 Vali Acc: 0.841 Test Loss: 0.460 Test Acc: 0.841
Validation loss decreased (-0.826082 --> -0.840575).  Saving model ...
Epoch: 25 cost time: 1.1067876815795898
Epoch: 25, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.463 Vali Acc: 0.841 Test Loss: 0.463 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.442188024520874
Epoch: 26, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.460 Vali Acc: 0.833 Test Loss: 0.460 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.3081061840057373
Epoch: 27, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.454 Vali Acc: 0.833 Test Loss: 0.454 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.4006619453430176
Epoch: 28, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.455 Vali Acc: 0.848 Test Loss: 0.455 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847822).  Saving model ...
Epoch: 29 cost time: 1.3403549194335938
Epoch: 29, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.458 Vali Acc: 0.841 Test Loss: 0.458 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.4034199714660645
Epoch: 30, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.448 Vali Acc: 0.848 Test Loss: 0.448 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 99700
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.209051132202148
Epoch: 1, Steps: 9 | Train Loss: 1.413 Vali Loss: 1.366 Vali Acc: 0.275 Test Loss: 1.366 Test Acc: 0.275
Validation loss decreased (inf --> -0.275349).  Saving model ...
Epoch: 2 cost time: 3.0035312175750732
Epoch: 2, Steps: 9 | Train Loss: 1.351 Vali Loss: 1.290 Vali Acc: 0.355 Test Loss: 1.290 Test Acc: 0.355
Validation loss decreased (-0.275349 --> -0.355060).  Saving model ...
Epoch: 3 cost time: 3.2236523628234863
Epoch: 3, Steps: 9 | Train Loss: 1.215 Vali Loss: 1.190 Vali Acc: 0.457 Test Loss: 1.190 Test Acc: 0.457
Validation loss decreased (-0.355060 --> -0.456510).  Saving model ...
Epoch: 4 cost time: 3.0130748748779297
Epoch: 4, Steps: 9 | Train Loss: 1.086 Vali Loss: 1.077 Vali Acc: 0.558 Test Loss: 1.077 Test Acc: 0.558
Validation loss decreased (-0.456510 --> -0.557960).  Saving model ...
Epoch: 5 cost time: 3.279921770095825
Epoch: 5, Steps: 9 | Train Loss: 0.936 Vali Loss: 0.969 Vali Acc: 0.594 Test Loss: 0.969 Test Acc: 0.594
Validation loss decreased (-0.557960 --> -0.594193).  Saving model ...
Epoch: 6 cost time: 3.0317842960357666
Epoch: 6, Steps: 9 | Train Loss: 0.831 Vali Loss: 0.855 Vali Acc: 0.630 Test Loss: 0.855 Test Acc: 0.630
Validation loss decreased (-0.594193 --> -0.630426).  Saving model ...
Epoch: 7 cost time: 2.636101007461548
Epoch: 7, Steps: 9 | Train Loss: 0.734 Vali Loss: 0.761 Vali Acc: 0.703 Test Loss: 0.761 Test Acc: 0.703
Validation loss decreased (-0.630426 --> -0.702891).  Saving model ...
Epoch: 8 cost time: 3.129091262817383
Epoch: 8, Steps: 9 | Train Loss: 0.617 Vali Loss: 0.694 Vali Acc: 0.688 Test Loss: 0.694 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.128150701522827
Epoch: 9, Steps: 9 | Train Loss: 0.492 Vali Loss: 0.579 Vali Acc: 0.761 Test Loss: 0.579 Test Acc: 0.761
Validation loss decreased (-0.702891 --> -0.760864).  Saving model ...
Epoch: 10 cost time: 3.1482720375061035
Epoch: 10, Steps: 9 | Train Loss: 0.417 Vali Loss: 0.464 Vali Acc: 0.819 Test Loss: 0.464 Test Acc: 0.819
Validation loss decreased (-0.760864 --> -0.818836).  Saving model ...
Epoch: 11 cost time: 3.129502058029175
Epoch: 11, Steps: 9 | Train Loss: 0.353 Vali Loss: 0.429 Vali Acc: 0.862 Test Loss: 0.429 Test Acc: 0.862
Validation loss decreased (-0.818836 --> -0.862315).  Saving model ...
Epoch: 12 cost time: 3.0807740688323975
Epoch: 12, Steps: 9 | Train Loss: 0.330 Vali Loss: 0.418 Vali Acc: 0.870 Test Loss: 0.418 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869561).  Saving model ...
Epoch: 13 cost time: 3.018218517303467
Epoch: 13, Steps: 9 | Train Loss: 0.247 Vali Loss: 0.490 Vali Acc: 0.841 Test Loss: 0.490 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.8793647289276123
Epoch: 14, Steps: 9 | Train Loss: 0.289 Vali Loss: 0.452 Vali Acc: 0.841 Test Loss: 0.452 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.1022419929504395
Epoch: 15, Steps: 9 | Train Loss: 0.224 Vali Loss: 0.431 Vali Acc: 0.877 Test Loss: 0.431 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876807).  Saving model ...
Epoch: 16 cost time: 3.0871288776397705
Epoch: 16, Steps: 9 | Train Loss: 0.223 Vali Loss: 0.337 Vali Acc: 0.906 Test Loss: 0.337 Test Acc: 0.906
Validation loss decreased (-0.876807 --> -0.905794).  Saving model ...
Epoch: 17 cost time: 3.123248815536499
Epoch: 17, Steps: 9 | Train Loss: 0.154 Vali Loss: 0.588 Vali Acc: 0.841 Test Loss: 0.588 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.962306022644043
Epoch: 18, Steps: 9 | Train Loss: 0.142 Vali Loss: 0.535 Vali Acc: 0.826 Test Loss: 0.535 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.879636287689209
Epoch: 19, Steps: 9 | Train Loss: 0.116 Vali Loss: 0.357 Vali Acc: 0.877 Test Loss: 0.357 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.0404839515686035
Epoch: 20, Steps: 9 | Train Loss: 0.115 Vali Loss: 0.373 Vali Acc: 0.884 Test Loss: 0.373 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.0656473636627197
Epoch: 21, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.328 Vali Acc: 0.913 Test Loss: 0.328 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913040).  Saving model ...
Epoch: 22 cost time: 3.1749589443206787
Epoch: 22, Steps: 9 | Train Loss: 0.096 Vali Loss: 0.400 Vali Acc: 0.913 Test Loss: 0.400 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.1533424854278564
Epoch: 23, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.538 Vali Acc: 0.899 Test Loss: 0.538 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.2152321338653564
Epoch: 24, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.568 Vali Acc: 0.884 Test Loss: 0.568 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.0453176498413086
Epoch: 25, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.541 Vali Acc: 0.891 Test Loss: 0.541 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.841662883758545
Epoch: 26, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.558 Vali Acc: 0.884 Test Loss: 0.558 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.09989595413208
Epoch: 27, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.425 Vali Acc: 0.899 Test Loss: 0.425 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.1947808265686035
Epoch: 28, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.454 Vali Acc: 0.862 Test Loss: 0.454 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.2625133991241455
Epoch: 29, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.469 Vali Acc: 0.870 Test Loss: 0.469 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.0718002319335938
Epoch: 30, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.602 Vali Acc: 0.884 Test Loss: 0.602 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 593308
model size : 2.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.3584253787994385
Epoch: 1, Steps: 9 | Train Loss: 1.432 Vali Loss: 1.403 Vali Acc: 0.254 Test Loss: 1.403 Test Acc: 0.254
Validation loss decreased (inf --> -0.253609).  Saving model ...
Epoch: 2 cost time: 2.34995698928833
Epoch: 2, Steps: 9 | Train Loss: 1.358 Vali Loss: 1.349 Vali Acc: 0.377 Test Loss: 1.349 Test Acc: 0.377
Validation loss decreased (-0.253609 --> -0.376798).  Saving model ...
Epoch: 3 cost time: 2.2618401050567627
Epoch: 3, Steps: 9 | Train Loss: 1.328 Vali Loss: 1.290 Vali Acc: 0.420 Test Loss: 1.290 Test Acc: 0.420
Validation loss decreased (-0.376798 --> -0.420277).  Saving model ...
Epoch: 4 cost time: 2.3467025756835938
Epoch: 4, Steps: 9 | Train Loss: 1.209 Vali Loss: 1.219 Vali Acc: 0.514 Test Loss: 1.219 Test Acc: 0.514
Validation loss decreased (-0.420277 --> -0.514481).  Saving model ...
Epoch: 5 cost time: 2.257103204727173
Epoch: 5, Steps: 9 | Train Loss: 1.109 Vali Loss: 1.131 Vali Acc: 0.609 Test Loss: 1.131 Test Acc: 0.609
Validation loss decreased (-0.514481 --> -0.608684).  Saving model ...
Epoch: 6 cost time: 2.495544910430908
Epoch: 6, Steps: 9 | Train Loss: 1.017 Vali Loss: 1.040 Vali Acc: 0.638 Test Loss: 1.040 Test Acc: 0.638
Validation loss decreased (-0.608684 --> -0.637671).  Saving model ...
Epoch: 7 cost time: 2.340502977371216
Epoch: 7, Steps: 9 | Train Loss: 0.896 Vali Loss: 0.929 Vali Acc: 0.696 Test Loss: 0.929 Test Acc: 0.696
Validation loss decreased (-0.637671 --> -0.695643).  Saving model ...
Epoch: 8 cost time: 2.260446548461914
Epoch: 8, Steps: 9 | Train Loss: 0.775 Vali Loss: 0.835 Vali Acc: 0.710 Test Loss: 0.835 Test Acc: 0.710
Validation loss decreased (-0.695643 --> -0.710137).  Saving model ...
Epoch: 9 cost time: 2.3604440689086914
Epoch: 9, Steps: 9 | Train Loss: 0.675 Vali Loss: 0.742 Vali Acc: 0.746 Test Loss: 0.742 Test Acc: 0.746
Validation loss decreased (-0.710137 --> -0.746369).  Saving model ...
Epoch: 10 cost time: 2.280771017074585
Epoch: 10, Steps: 9 | Train Loss: 0.599 Vali Loss: 0.662 Vali Acc: 0.812 Test Loss: 0.662 Test Acc: 0.812
Validation loss decreased (-0.746369 --> -0.811588).  Saving model ...
Epoch: 11 cost time: 2.4094438552856445
Epoch: 11, Steps: 9 | Train Loss: 0.523 Vali Loss: 0.555 Vali Acc: 0.841 Test Loss: 0.555 Test Acc: 0.841
Validation loss decreased (-0.811588 --> -0.840574).  Saving model ...
Epoch: 12 cost time: 2.4252262115478516
Epoch: 12, Steps: 9 | Train Loss: 0.436 Vali Loss: 0.503 Vali Acc: 0.862 Test Loss: 0.503 Test Acc: 0.862
Validation loss decreased (-0.840574 --> -0.862314).  Saving model ...
Epoch: 13 cost time: 2.302417039871216
Epoch: 13, Steps: 9 | Train Loss: 0.364 Vali Loss: 0.467 Vali Acc: 0.862 Test Loss: 0.467 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 14 cost time: 2.3187572956085205
Epoch: 14, Steps: 9 | Train Loss: 0.285 Vali Loss: 0.420 Vali Acc: 0.855 Test Loss: 0.420 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.2718653678894043
Epoch: 15, Steps: 9 | Train Loss: 0.264 Vali Loss: 0.403 Vali Acc: 0.891 Test Loss: 0.403 Test Acc: 0.891
Validation loss decreased (-0.862314 --> -0.891300).  Saving model ...
Epoch: 16 cost time: 2.3382880687713623
Epoch: 16, Steps: 9 | Train Loss: 0.199 Vali Loss: 0.392 Vali Acc: 0.899 Test Loss: 0.392 Test Acc: 0.899
Validation loss decreased (-0.891300 --> -0.898547).  Saving model ...
Epoch: 17 cost time: 2.3810386657714844
Epoch: 17, Steps: 9 | Train Loss: 0.184 Vali Loss: 0.364 Vali Acc: 0.899 Test Loss: 0.364 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 18 cost time: 2.3048346042633057
Epoch: 18, Steps: 9 | Train Loss: 0.193 Vali Loss: 0.315 Vali Acc: 0.913 Test Loss: 0.315 Test Acc: 0.913
Validation loss decreased (-0.898547 --> -0.913040).  Saving model ...
Epoch: 19 cost time: 2.2550110816955566
Epoch: 19, Steps: 9 | Train Loss: 0.172 Vali Loss: 0.348 Vali Acc: 0.884 Test Loss: 0.348 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.4316256046295166
Epoch: 20, Steps: 9 | Train Loss: 0.134 Vali Loss: 0.412 Vali Acc: 0.848 Test Loss: 0.412 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.3190314769744873
Epoch: 21, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.393 Vali Acc: 0.870 Test Loss: 0.393 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.472747564315796
Epoch: 22, Steps: 9 | Train Loss: 0.098 Vali Loss: 0.275 Vali Acc: 0.928 Test Loss: 0.275 Test Acc: 0.928
Validation loss decreased (-0.913040 --> -0.927533).  Saving model ...
Epoch: 23 cost time: 2.3260610103607178
Epoch: 23, Steps: 9 | Train Loss: 0.099 Vali Loss: 0.259 Vali Acc: 0.928 Test Loss: 0.259 Test Acc: 0.928
Validation loss decreased (-0.927533 --> -0.927534).  Saving model ...
Epoch: 24 cost time: 2.2912983894348145
Epoch: 24, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.368 Vali Acc: 0.877 Test Loss: 0.368 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.453486680984497
Epoch: 25, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.351 Vali Acc: 0.891 Test Loss: 0.351 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.3728883266448975
Epoch: 26, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.279 Vali Acc: 0.942 Test Loss: 0.279 Test Acc: 0.942
Validation loss decreased (-0.927534 --> -0.942026).  Saving model ...
Epoch: 27 cost time: 2.1466174125671387
Epoch: 27, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.279 Vali Acc: 0.928 Test Loss: 0.279 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.1836671829223633
Epoch: 28, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.264 Vali Acc: 0.928 Test Loss: 0.264 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.0379951000213623
Epoch: 29, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.301 Vali Acc: 0.920 Test Loss: 0.301 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.9914491176605225
Epoch: 30, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.325 Vali Acc: 0.928 Test Loss: 0.325 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9420289855072463
model parameter : 179324
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.149439096450806
Epoch: 1, Steps: 9 | Train Loss: 1.417 Vali Loss: 1.366 Vali Acc: 0.275 Test Loss: 1.366 Test Acc: 0.275
Validation loss decreased (inf --> -0.275349).  Saving model ...
Epoch: 2 cost time: 2.370624303817749
Epoch: 2, Steps: 9 | Train Loss: 1.355 Vali Loss: 1.289 Vali Acc: 0.377 Test Loss: 1.289 Test Acc: 0.377
Validation loss decreased (-0.275349 --> -0.376799).  Saving model ...
Epoch: 3 cost time: 2.4017696380615234
Epoch: 3, Steps: 9 | Train Loss: 1.225 Vali Loss: 1.191 Vali Acc: 0.471 Test Loss: 1.191 Test Acc: 0.471
Validation loss decreased (-0.376799 --> -0.471003).  Saving model ...
Epoch: 4 cost time: 2.3375327587127686
Epoch: 4, Steps: 9 | Train Loss: 1.108 Vali Loss: 1.083 Vali Acc: 0.558 Test Loss: 1.083 Test Acc: 0.558
Validation loss decreased (-0.471003 --> -0.557960).  Saving model ...
Epoch: 5 cost time: 2.396148681640625
Epoch: 5, Steps: 9 | Train Loss: 0.964 Vali Loss: 0.983 Vali Acc: 0.587 Test Loss: 0.983 Test Acc: 0.587
Validation loss decreased (-0.557960 --> -0.586947).  Saving model ...
Epoch: 6 cost time: 2.3124940395355225
Epoch: 6, Steps: 9 | Train Loss: 0.855 Vali Loss: 0.874 Vali Acc: 0.638 Test Loss: 0.874 Test Acc: 0.638
Validation loss decreased (-0.586947 --> -0.637672).  Saving model ...
Epoch: 7 cost time: 2.377248764038086
Epoch: 7, Steps: 9 | Train Loss: 0.773 Vali Loss: 0.780 Vali Acc: 0.703 Test Loss: 0.780 Test Acc: 0.703
Validation loss decreased (-0.637672 --> -0.702891).  Saving model ...
Epoch: 8 cost time: 2.364694356918335
Epoch: 8, Steps: 9 | Train Loss: 0.670 Vali Loss: 0.728 Vali Acc: 0.696 Test Loss: 0.728 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.370671033859253
Epoch: 9, Steps: 9 | Train Loss: 0.566 Vali Loss: 0.656 Vali Acc: 0.725 Test Loss: 0.656 Test Acc: 0.725
Validation loss decreased (-0.702891 --> -0.724631).  Saving model ...
Epoch: 10 cost time: 2.2834312915802
Epoch: 10, Steps: 9 | Train Loss: 0.504 Vali Loss: 0.581 Vali Acc: 0.775 Test Loss: 0.581 Test Acc: 0.775
Validation loss decreased (-0.724631 --> -0.775357).  Saving model ...
Epoch: 11 cost time: 2.381798028945923
Epoch: 11, Steps: 9 | Train Loss: 0.473 Vali Loss: 0.514 Vali Acc: 0.797 Test Loss: 0.514 Test Acc: 0.797
Validation loss decreased (-0.775357 --> -0.797096).  Saving model ...
Epoch: 12 cost time: 2.435875654220581
Epoch: 12, Steps: 9 | Train Loss: 0.512 Vali Loss: 0.535 Vali Acc: 0.804 Test Loss: 0.535 Test Acc: 0.804
Validation loss decreased (-0.797096 --> -0.804342).  Saving model ...
Epoch: 13 cost time: 2.3235108852386475
Epoch: 13, Steps: 9 | Train Loss: 0.318 Vali Loss: 0.375 Vali Acc: 0.899 Test Loss: 0.375 Test Acc: 0.899
Validation loss decreased (-0.804342 --> -0.898547).  Saving model ...
Epoch: 14 cost time: 2.274592161178589
Epoch: 14, Steps: 9 | Train Loss: 0.429 Vali Loss: 0.367 Vali Acc: 0.899 Test Loss: 0.367 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 15 cost time: 2.211130380630493
Epoch: 15, Steps: 9 | Train Loss: 0.333 Vali Loss: 0.339 Vali Acc: 0.920 Test Loss: 0.339 Test Acc: 0.920
Validation loss decreased (-0.898547 --> -0.920286).  Saving model ...
Epoch: 16 cost time: 2.418844699859619
Epoch: 16, Steps: 9 | Train Loss: 0.290 Vali Loss: 0.305 Vali Acc: 0.935 Test Loss: 0.305 Test Acc: 0.935
Validation loss decreased (-0.920286 --> -0.934780).  Saving model ...
Epoch: 17 cost time: 2.0803074836730957
Epoch: 17, Steps: 9 | Train Loss: 0.207 Vali Loss: 0.283 Vali Acc: 0.928 Test Loss: 0.283 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.1336514949798584
Epoch: 18, Steps: 9 | Train Loss: 0.193 Vali Loss: 0.313 Vali Acc: 0.920 Test Loss: 0.313 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.0398097038269043
Epoch: 19, Steps: 9 | Train Loss: 0.168 Vali Loss: 0.372 Vali Acc: 0.884 Test Loss: 0.372 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.0595507621765137
Epoch: 20, Steps: 9 | Train Loss: 0.115 Vali Loss: 0.355 Vali Acc: 0.899 Test Loss: 0.355 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.1672563552856445
Epoch: 21, Steps: 9 | Train Loss: 0.116 Vali Loss: 0.322 Vali Acc: 0.899 Test Loss: 0.322 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.213616371154785
Epoch: 22, Steps: 9 | Train Loss: 0.119 Vali Loss: 0.322 Vali Acc: 0.891 Test Loss: 0.322 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.0050597190856934
Epoch: 23, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.281 Vali Acc: 0.913 Test Loss: 0.281 Test Acc: 0.913
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.0373146533966064
Epoch: 24, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.283 Vali Acc: 0.920 Test Loss: 0.283 Test Acc: 0.920
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.190826654434204
Epoch: 25, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.263 Vali Acc: 0.928 Test Loss: 0.263 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.0948591232299805
Epoch: 26, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.248 Vali Acc: 0.942 Test Loss: 0.248 Test Acc: 0.942
Validation loss decreased (-0.934780 --> -0.942027).  Saving model ...
Epoch: 27 cost time: 2.0479791164398193
Epoch: 27, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.270 Vali Acc: 0.920 Test Loss: 0.270 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.0406808853149414
Epoch: 28, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.347 Vali Acc: 0.899 Test Loss: 0.347 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.1426281929016113
Epoch: 29, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.336 Vali Acc: 0.891 Test Loss: 0.336 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.2034173011779785
Epoch: 30, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.390 Vali Acc: 0.891 Test Loss: 0.390 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9420289855072463
model parameter : 593308
model size : 2.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.616445302963257
Epoch: 1, Steps: 9 | Train Loss: 1.430 Vali Loss: 1.396 Vali Acc: 0.246 Test Loss: 1.396 Test Acc: 0.246
Validation loss decreased (inf --> -0.246363).  Saving model ...
Epoch: 2 cost time: 1.6843757629394531
Epoch: 2, Steps: 9 | Train Loss: 1.359 Vali Loss: 1.342 Vali Acc: 0.399 Test Loss: 1.342 Test Acc: 0.399
Validation loss decreased (-0.246363 --> -0.398537).  Saving model ...
Epoch: 3 cost time: 1.5443522930145264
Epoch: 3, Steps: 9 | Train Loss: 1.332 Vali Loss: 1.283 Vali Acc: 0.449 Test Loss: 1.283 Test Acc: 0.449
Validation loss decreased (-0.398537 --> -0.449263).  Saving model ...
Epoch: 4 cost time: 1.6768479347229004
Epoch: 4, Steps: 9 | Train Loss: 1.211 Vali Loss: 1.212 Vali Acc: 0.514 Test Loss: 1.212 Test Acc: 0.514
Validation loss decreased (-0.449263 --> -0.514481).  Saving model ...
Epoch: 5 cost time: 1.7595829963684082
Epoch: 5, Steps: 9 | Train Loss: 1.119 Vali Loss: 1.129 Vali Acc: 0.630 Test Loss: 1.129 Test Acc: 0.630
Validation loss decreased (-0.514481 --> -0.630423).  Saving model ...
Epoch: 6 cost time: 1.7890374660491943
Epoch: 6, Steps: 9 | Train Loss: 1.032 Vali Loss: 1.046 Vali Acc: 0.645 Test Loss: 1.046 Test Acc: 0.645
Validation loss decreased (-0.630423 --> -0.644917).  Saving model ...
Epoch: 7 cost time: 1.7656278610229492
Epoch: 7, Steps: 9 | Train Loss: 0.928 Vali Loss: 0.945 Vali Acc: 0.717 Test Loss: 0.945 Test Acc: 0.717
Validation loss decreased (-0.644917 --> -0.717382).  Saving model ...
Epoch: 8 cost time: 1.7590224742889404
Epoch: 8, Steps: 9 | Train Loss: 0.801 Vali Loss: 0.854 Vali Acc: 0.703 Test Loss: 0.854 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8386402130126953
Epoch: 9, Steps: 9 | Train Loss: 0.715 Vali Loss: 0.761 Vali Acc: 0.725 Test Loss: 0.761 Test Acc: 0.725
Validation loss decreased (-0.717382 --> -0.724630).  Saving model ...
Epoch: 10 cost time: 1.848083257675171
Epoch: 10, Steps: 9 | Train Loss: 0.647 Vali Loss: 0.679 Vali Acc: 0.754 Test Loss: 0.679 Test Acc: 0.754
Validation loss decreased (-0.724630 --> -0.753616).  Saving model ...
Epoch: 11 cost time: 1.689549446105957
Epoch: 11, Steps: 9 | Train Loss: 0.593 Vali Loss: 0.593 Vali Acc: 0.812 Test Loss: 0.593 Test Acc: 0.812
Validation loss decreased (-0.753616 --> -0.811588).  Saving model ...
Epoch: 12 cost time: 1.7800939083099365
Epoch: 12, Steps: 9 | Train Loss: 0.524 Vali Loss: 0.561 Vali Acc: 0.804 Test Loss: 0.561 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7921743392944336
Epoch: 13, Steps: 9 | Train Loss: 0.432 Vali Loss: 0.527 Vali Acc: 0.833 Test Loss: 0.527 Test Acc: 0.833
Validation loss decreased (-0.811588 --> -0.833328).  Saving model ...
Epoch: 14 cost time: 1.8549907207489014
Epoch: 14, Steps: 9 | Train Loss: 0.364 Vali Loss: 0.496 Vali Acc: 0.841 Test Loss: 0.496 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840575).  Saving model ...
Epoch: 15 cost time: 1.812119483947754
Epoch: 15, Steps: 9 | Train Loss: 0.333 Vali Loss: 0.438 Vali Acc: 0.855 Test Loss: 0.438 Test Acc: 0.855
Validation loss decreased (-0.840575 --> -0.855068).  Saving model ...
Epoch: 16 cost time: 1.7180263996124268
Epoch: 16, Steps: 9 | Train Loss: 0.280 Vali Loss: 0.418 Vali Acc: 0.855 Test Loss: 0.418 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 17 cost time: 1.6319878101348877
Epoch: 17, Steps: 9 | Train Loss: 0.275 Vali Loss: 0.367 Vali Acc: 0.855 Test Loss: 0.367 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855069).  Saving model ...
Epoch: 18 cost time: 1.61075758934021
Epoch: 18, Steps: 9 | Train Loss: 0.216 Vali Loss: 0.375 Vali Acc: 0.870 Test Loss: 0.375 Test Acc: 0.870
Validation loss decreased (-0.855069 --> -0.869561).  Saving model ...
Epoch: 19 cost time: 1.8416688442230225
Epoch: 19, Steps: 9 | Train Loss: 0.207 Vali Loss: 0.329 Vali Acc: 0.899 Test Loss: 0.329 Test Acc: 0.899
Validation loss decreased (-0.869561 --> -0.898547).  Saving model ...
Epoch: 20 cost time: 1.900465488433838
Epoch: 20, Steps: 9 | Train Loss: 0.157 Vali Loss: 0.310 Vali Acc: 0.899 Test Loss: 0.310 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898548).  Saving model ...
Epoch: 21 cost time: 1.9044339656829834
Epoch: 21, Steps: 9 | Train Loss: 0.147 Vali Loss: 0.316 Vali Acc: 0.899 Test Loss: 0.316 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.9397695064544678
Epoch: 22, Steps: 9 | Train Loss: 0.136 Vali Loss: 0.288 Vali Acc: 0.913 Test Loss: 0.288 Test Acc: 0.913
Validation loss decreased (-0.898548 --> -0.913041).  Saving model ...
Epoch: 23 cost time: 1.913996934890747
Epoch: 23, Steps: 9 | Train Loss: 0.117 Vali Loss: 0.288 Vali Acc: 0.920 Test Loss: 0.288 Test Acc: 0.920
Validation loss decreased (-0.913041 --> -0.920287).  Saving model ...
Epoch: 24 cost time: 1.8590631484985352
Epoch: 24, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.290 Vali Acc: 0.913 Test Loss: 0.290 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.929840326309204
Epoch: 25, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.296 Vali Acc: 0.920 Test Loss: 0.296 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.725555419921875
Epoch: 26, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.271 Vali Acc: 0.935 Test Loss: 0.271 Test Acc: 0.935
Validation loss decreased (-0.920287 --> -0.934780).  Saving model ...
Epoch: 27 cost time: 1.9208662509918213
Epoch: 27, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.230 Vali Acc: 0.942 Test Loss: 0.230 Test Acc: 0.942
Validation loss decreased (-0.934780 --> -0.942027).  Saving model ...
Epoch: 28 cost time: 1.9345827102661133
Epoch: 28, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.213 Vali Acc: 0.942 Test Loss: 0.213 Test Acc: 0.942
Validation loss decreased (-0.942027 --> -0.942027).  Saving model ...
Epoch: 29 cost time: 1.8354957103729248
Epoch: 29, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.192 Vali Acc: 0.949 Test Loss: 0.192 Test Acc: 0.949
Validation loss decreased (-0.942027 --> -0.949273).  Saving model ...
Epoch: 30 cost time: 1.8187556266784668
Epoch: 30, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.178 Vali Acc: 0.942 Test Loss: 0.178 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9492753623188406
model parameter : 179324
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.4722065925598145
Epoch: 1, Steps: 9 | Train Loss: 1.417 Vali Loss: 1.366 Vali Acc: 0.312 Test Loss: 1.366 Test Acc: 0.312
Validation loss decreased (inf --> -0.311581).  Saving model ...
Epoch: 2 cost time: 1.7972180843353271
Epoch: 2, Steps: 9 | Train Loss: 1.365 Vali Loss: 1.297 Vali Acc: 0.384 Test Loss: 1.297 Test Acc: 0.384
Validation loss decreased (-0.311581 --> -0.384045).  Saving model ...
Epoch: 3 cost time: 1.841177225112915
Epoch: 3, Steps: 9 | Train Loss: 1.240 Vali Loss: 1.210 Vali Acc: 0.420 Test Loss: 1.210 Test Acc: 0.420
Validation loss decreased (-0.384045 --> -0.420278).  Saving model ...
Epoch: 4 cost time: 1.7030465602874756
Epoch: 4, Steps: 9 | Train Loss: 1.129 Vali Loss: 1.110 Vali Acc: 0.529 Test Loss: 1.110 Test Acc: 0.529
Validation loss decreased (-0.420278 --> -0.528974).  Saving model ...
Epoch: 5 cost time: 1.8202300071716309
Epoch: 5, Steps: 9 | Train Loss: 1.006 Vali Loss: 1.020 Vali Acc: 0.558 Test Loss: 1.020 Test Acc: 0.558
Validation loss decreased (-0.528974 --> -0.557961).  Saving model ...
Epoch: 6 cost time: 1.7275640964508057
Epoch: 6, Steps: 9 | Train Loss: 0.921 Vali Loss: 0.918 Vali Acc: 0.609 Test Loss: 0.918 Test Acc: 0.609
Validation loss decreased (-0.557961 --> -0.608686).  Saving model ...
Epoch: 7 cost time: 1.5771682262420654
Epoch: 7, Steps: 9 | Train Loss: 0.832 Vali Loss: 0.842 Vali Acc: 0.645 Test Loss: 0.842 Test Acc: 0.645
Validation loss decreased (-0.608686 --> -0.644919).  Saving model ...
Epoch: 8 cost time: 1.7313268184661865
Epoch: 8, Steps: 9 | Train Loss: 0.742 Vali Loss: 0.791 Vali Acc: 0.674 Test Loss: 0.791 Test Acc: 0.674
Validation loss decreased (-0.644919 --> -0.673905).  Saving model ...
Epoch: 9 cost time: 1.6241874694824219
Epoch: 9, Steps: 9 | Train Loss: 0.637 Vali Loss: 0.749 Vali Acc: 0.703 Test Loss: 0.749 Test Acc: 0.703
Validation loss decreased (-0.673905 --> -0.702891).  Saving model ...
Epoch: 10 cost time: 1.6704835891723633
Epoch: 10, Steps: 9 | Train Loss: 0.598 Vali Loss: 0.733 Vali Acc: 0.710 Test Loss: 0.733 Test Acc: 0.710
Validation loss decreased (-0.702891 --> -0.710138).  Saving model ...
Epoch: 11 cost time: 1.741917610168457
Epoch: 11, Steps: 9 | Train Loss: 0.516 Vali Loss: 0.718 Vali Acc: 0.688 Test Loss: 0.718 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8548319339752197
Epoch: 12, Steps: 9 | Train Loss: 0.481 Vali Loss: 0.703 Vali Acc: 0.725 Test Loss: 0.703 Test Acc: 0.725
Validation loss decreased (-0.710138 --> -0.724631).  Saving model ...
Epoch: 13 cost time: 1.647702693939209
Epoch: 13, Steps: 9 | Train Loss: 0.424 Vali Loss: 0.682 Vali Acc: 0.710 Test Loss: 0.682 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.528444528579712
Epoch: 14, Steps: 9 | Train Loss: 0.394 Vali Loss: 0.554 Vali Acc: 0.819 Test Loss: 0.554 Test Acc: 0.819
Validation loss decreased (-0.724631 --> -0.818835).  Saving model ...
Epoch: 15 cost time: 1.6863923072814941
Epoch: 15, Steps: 9 | Train Loss: 0.278 Vali Loss: 0.444 Vali Acc: 0.870 Test Loss: 0.444 Test Acc: 0.870
Validation loss decreased (-0.818835 --> -0.869561).  Saving model ...
Epoch: 16 cost time: 1.768688440322876
Epoch: 16, Steps: 9 | Train Loss: 0.276 Vali Loss: 0.576 Vali Acc: 0.783 Test Loss: 0.576 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7632675170898438
Epoch: 17, Steps: 9 | Train Loss: 0.207 Vali Loss: 0.475 Vali Acc: 0.804 Test Loss: 0.475 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.6380879878997803
Epoch: 18, Steps: 9 | Train Loss: 0.159 Vali Loss: 0.449 Vali Acc: 0.841 Test Loss: 0.449 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.56024169921875
Epoch: 19, Steps: 9 | Train Loss: 0.158 Vali Loss: 0.418 Vali Acc: 0.862 Test Loss: 0.418 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.7117974758148193
Epoch: 20, Steps: 9 | Train Loss: 0.115 Vali Loss: 0.394 Vali Acc: 0.877 Test Loss: 0.394 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876808).  Saving model ...
Epoch: 21 cost time: 1.7438716888427734
Epoch: 21, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.488 Vali Acc: 0.812 Test Loss: 0.488 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4957304000854492
Epoch: 22, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.469 Vali Acc: 0.812 Test Loss: 0.469 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.7736876010894775
Epoch: 23, Steps: 9 | Train Loss: 0.086 Vali Loss: 0.356 Vali Acc: 0.891 Test Loss: 0.356 Test Acc: 0.891
Validation loss decreased (-0.876808 --> -0.891301).  Saving model ...
Epoch: 24 cost time: 1.7823233604431152
Epoch: 24, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.329 Vali Acc: 0.899 Test Loss: 0.329 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898547).  Saving model ...
Epoch: 25 cost time: 1.7024288177490234
Epoch: 25, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.455 Vali Acc: 0.812 Test Loss: 0.455 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.7665390968322754
Epoch: 26, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.560 Vali Acc: 0.783 Test Loss: 0.560 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.8718247413635254
Epoch: 27, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.562 Vali Acc: 0.790 Test Loss: 0.562 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.7026081085205078
Epoch: 28, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.613 Vali Acc: 0.761 Test Loss: 0.613 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.5100576877593994
Epoch: 29, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.492 Vali Acc: 0.826 Test Loss: 0.492 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.7059476375579834
Epoch: 30, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.492 Vali Acc: 0.804 Test Loss: 0.492 Test Acc: 0.804
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 593308
model size : 2.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.6492340564727783
Epoch: 1, Steps: 9 | Train Loss: 1.425 Vali Loss: 1.395 Vali Acc: 0.268 Test Loss: 1.395 Test Acc: 0.268
Validation loss decreased (inf --> -0.268102).  Saving model ...
Epoch: 2 cost time: 1.5851993560791016
Epoch: 2, Steps: 9 | Train Loss: 1.363 Vali Loss: 1.342 Vali Acc: 0.384 Test Loss: 1.342 Test Acc: 0.384
Validation loss decreased (-0.268102 --> -0.384045).  Saving model ...
Epoch: 3 cost time: 1.5902035236358643
Epoch: 3, Steps: 9 | Train Loss: 1.336 Vali Loss: 1.286 Vali Acc: 0.428 Test Loss: 1.286 Test Acc: 0.428
Validation loss decreased (-0.384045 --> -0.427523).  Saving model ...
Epoch: 4 cost time: 1.4772992134094238
Epoch: 4, Steps: 9 | Train Loss: 1.218 Vali Loss: 1.226 Vali Acc: 0.471 Test Loss: 1.226 Test Acc: 0.471
Validation loss decreased (-0.427523 --> -0.471002).  Saving model ...
Epoch: 5 cost time: 1.5473463535308838
Epoch: 5, Steps: 9 | Train Loss: 1.122 Vali Loss: 1.154 Vali Acc: 0.529 Test Loss: 1.154 Test Acc: 0.529
Validation loss decreased (-0.471002 --> -0.528974).  Saving model ...
Epoch: 6 cost time: 1.5888621807098389
Epoch: 6, Steps: 9 | Train Loss: 1.043 Vali Loss: 1.080 Vali Acc: 0.580 Test Loss: 1.080 Test Acc: 0.580
Validation loss decreased (-0.528974 --> -0.579699).  Saving model ...
Epoch: 7 cost time: 1.550325870513916
Epoch: 7, Steps: 9 | Train Loss: 0.950 Vali Loss: 0.994 Vali Acc: 0.652 Test Loss: 0.994 Test Acc: 0.652
Validation loss decreased (-0.579699 --> -0.652164).  Saving model ...
Epoch: 8 cost time: 1.5406570434570312
Epoch: 8, Steps: 9 | Train Loss: 0.838 Vali Loss: 0.928 Vali Acc: 0.667 Test Loss: 0.928 Test Acc: 0.667
Validation loss decreased (-0.652164 --> -0.666657).  Saving model ...
Epoch: 9 cost time: 1.5490689277648926
Epoch: 9, Steps: 9 | Train Loss: 0.780 Vali Loss: 0.851 Vali Acc: 0.696 Test Loss: 0.851 Test Acc: 0.696
Validation loss decreased (-0.666657 --> -0.695644).  Saving model ...
Epoch: 10 cost time: 1.5027649402618408
Epoch: 10, Steps: 9 | Train Loss: 0.703 Vali Loss: 0.793 Vali Acc: 0.616 Test Loss: 0.793 Test Acc: 0.616
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5336673259735107
Epoch: 11, Steps: 9 | Train Loss: 0.653 Vali Loss: 0.712 Vali Acc: 0.790 Test Loss: 0.712 Test Acc: 0.790
Validation loss decreased (-0.695644 --> -0.789848).  Saving model ...
Epoch: 12 cost time: 1.5634081363677979
Epoch: 12, Steps: 9 | Train Loss: 0.560 Vali Loss: 0.670 Vali Acc: 0.790 Test Loss: 0.670 Test Acc: 0.790
Validation loss decreased (-0.789848 --> -0.789848).  Saving model ...
Epoch: 13 cost time: 1.4753413200378418
Epoch: 13, Steps: 9 | Train Loss: 0.479 Vali Loss: 0.647 Vali Acc: 0.783 Test Loss: 0.647 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4459888935089111
Epoch: 14, Steps: 9 | Train Loss: 0.423 Vali Loss: 0.624 Vali Acc: 0.790 Test Loss: 0.624 Test Acc: 0.790
Validation loss decreased (-0.789848 --> -0.789849).  Saving model ...
Epoch: 15 cost time: 1.5128695964813232
Epoch: 15, Steps: 9 | Train Loss: 0.402 Vali Loss: 0.472 Vali Acc: 0.841 Test Loss: 0.472 Test Acc: 0.841
Validation loss decreased (-0.789849 --> -0.840575).  Saving model ...
Epoch: 16 cost time: 1.6263794898986816
Epoch: 16, Steps: 9 | Train Loss: 0.364 Vali Loss: 0.429 Vali Acc: 0.841 Test Loss: 0.429 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 17 cost time: 1.5193848609924316
Epoch: 17, Steps: 9 | Train Loss: 0.316 Vali Loss: 0.432 Vali Acc: 0.833 Test Loss: 0.432 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6600844860076904
Epoch: 18, Steps: 9 | Train Loss: 0.294 Vali Loss: 0.420 Vali Acc: 0.826 Test Loss: 0.420 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.5892925262451172
Epoch: 19, Steps: 9 | Train Loss: 0.261 Vali Loss: 0.405 Vali Acc: 0.855 Test Loss: 0.405 Test Acc: 0.855
Validation loss decreased (-0.840575 --> -0.855068).  Saving model ...
Epoch: 20 cost time: 1.5877346992492676
Epoch: 20, Steps: 9 | Train Loss: 0.226 Vali Loss: 0.381 Vali Acc: 0.862 Test Loss: 0.381 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862315).  Saving model ...
Epoch: 21 cost time: 1.6421515941619873
Epoch: 21, Steps: 9 | Train Loss: 0.191 Vali Loss: 0.380 Vali Acc: 0.848 Test Loss: 0.380 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4791488647460938
Epoch: 22, Steps: 9 | Train Loss: 0.217 Vali Loss: 0.406 Vali Acc: 0.848 Test Loss: 0.406 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.4072585105895996
Epoch: 23, Steps: 9 | Train Loss: 0.168 Vali Loss: 0.471 Vali Acc: 0.819 Test Loss: 0.471 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.4594411849975586
Epoch: 24, Steps: 9 | Train Loss: 0.163 Vali Loss: 0.357 Vali Acc: 0.870 Test Loss: 0.357 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869562).  Saving model ...
Epoch: 25 cost time: 1.5378103256225586
Epoch: 25, Steps: 9 | Train Loss: 0.128 Vali Loss: 0.365 Vali Acc: 0.884 Test Loss: 0.365 Test Acc: 0.884
Validation loss decreased (-0.869562 --> -0.884054).  Saving model ...
Epoch: 26 cost time: 1.5579757690429688
Epoch: 26, Steps: 9 | Train Loss: 0.102 Vali Loss: 0.371 Vali Acc: 0.870 Test Loss: 0.371 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.4996800422668457
Epoch: 27, Steps: 9 | Train Loss: 0.118 Vali Loss: 0.359 Vali Acc: 0.877 Test Loss: 0.359 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.5164539813995361
Epoch: 28, Steps: 9 | Train Loss: 0.125 Vali Loss: 0.317 Vali Acc: 0.877 Test Loss: 0.317 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.5688061714172363
Epoch: 29, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.346 Vali Acc: 0.877 Test Loss: 0.346 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.5352864265441895
Epoch: 30, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.357 Vali Acc: 0.884 Test Loss: 0.357 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 179324
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.240551948547363
Epoch: 1, Steps: 9 | Train Loss: 1.374 Vali Loss: 1.324 Vali Acc: 0.413 Test Loss: 1.324 Test Acc: 0.413
Validation loss decreased (inf --> -0.413030).  Saving model ...
Epoch: 2 cost time: 2.296642303466797
Epoch: 2, Steps: 9 | Train Loss: 1.321 Vali Loss: 1.259 Vali Acc: 0.442 Test Loss: 1.259 Test Acc: 0.442
Validation loss decreased (-0.413030 --> -0.442016).  Saving model ...
Epoch: 3 cost time: 2.4955427646636963
Epoch: 3, Steps: 9 | Train Loss: 1.222 Vali Loss: 1.182 Vali Acc: 0.464 Test Loss: 1.182 Test Acc: 0.464
Validation loss decreased (-0.442016 --> -0.463756).  Saving model ...
Epoch: 4 cost time: 2.420908212661743
Epoch: 4, Steps: 9 | Train Loss: 1.135 Vali Loss: 1.096 Vali Acc: 0.500 Test Loss: 1.096 Test Acc: 0.500
Validation loss decreased (-0.463756 --> -0.499989).  Saving model ...
Epoch: 5 cost time: 2.531251907348633
Epoch: 5, Steps: 9 | Train Loss: 1.027 Vali Loss: 1.012 Vali Acc: 0.493 Test Loss: 1.012 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.4306373596191406
Epoch: 6, Steps: 9 | Train Loss: 0.908 Vali Loss: 0.928 Vali Acc: 0.536 Test Loss: 0.928 Test Acc: 0.536
Validation loss decreased (-0.499989 --> -0.536223).  Saving model ...
Epoch: 7 cost time: 2.4557645320892334
Epoch: 7, Steps: 9 | Train Loss: 0.819 Vali Loss: 0.854 Vali Acc: 0.572 Test Loss: 0.854 Test Acc: 0.572
Validation loss decreased (-0.536223 --> -0.572455).  Saving model ...
Epoch: 8 cost time: 2.365640878677368
Epoch: 8, Steps: 9 | Train Loss: 0.726 Vali Loss: 0.779 Vali Acc: 0.638 Test Loss: 0.779 Test Acc: 0.638
Validation loss decreased (-0.572455 --> -0.637673).  Saving model ...
Epoch: 9 cost time: 2.3116424083709717
Epoch: 9, Steps: 9 | Train Loss: 0.635 Vali Loss: 0.728 Vali Acc: 0.659 Test Loss: 0.728 Test Acc: 0.659
Validation loss decreased (-0.637673 --> -0.659413).  Saving model ...
Epoch: 10 cost time: 2.4148693084716797
Epoch: 10, Steps: 9 | Train Loss: 0.574 Vali Loss: 0.664 Vali Acc: 0.674 Test Loss: 0.664 Test Acc: 0.674
Validation loss decreased (-0.659413 --> -0.673906).  Saving model ...
Epoch: 11 cost time: 2.3080217838287354
Epoch: 11, Steps: 9 | Train Loss: 0.536 Vali Loss: 0.624 Vali Acc: 0.746 Test Loss: 0.624 Test Acc: 0.746
Validation loss decreased (-0.673906 --> -0.746371).  Saving model ...
Epoch: 12 cost time: 2.3870089054107666
Epoch: 12, Steps: 9 | Train Loss: 0.428 Vali Loss: 0.582 Vali Acc: 0.746 Test Loss: 0.582 Test Acc: 0.746
Validation loss decreased (-0.746371 --> -0.746371).  Saving model ...
Epoch: 13 cost time: 2.3012306690216064
Epoch: 13, Steps: 9 | Train Loss: 0.425 Vali Loss: 0.531 Vali Acc: 0.783 Test Loss: 0.531 Test Acc: 0.783
Validation loss decreased (-0.746371 --> -0.782603).  Saving model ...
Epoch: 14 cost time: 2.4048523902893066
Epoch: 14, Steps: 9 | Train Loss: 0.338 Vali Loss: 0.505 Vali Acc: 0.797 Test Loss: 0.505 Test Acc: 0.797
Validation loss decreased (-0.782603 --> -0.797096).  Saving model ...
Epoch: 15 cost time: 2.321070909500122
Epoch: 15, Steps: 9 | Train Loss: 0.284 Vali Loss: 0.523 Vali Acc: 0.775 Test Loss: 0.523 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.384024143218994
Epoch: 16, Steps: 9 | Train Loss: 0.259 Vali Loss: 0.477 Vali Acc: 0.790 Test Loss: 0.477 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.326570987701416
Epoch: 17, Steps: 9 | Train Loss: 0.215 Vali Loss: 0.425 Vali Acc: 0.812 Test Loss: 0.425 Test Acc: 0.812
Validation loss decreased (-0.797096 --> -0.811590).  Saving model ...
Epoch: 18 cost time: 2.4937520027160645
Epoch: 18, Steps: 9 | Train Loss: 0.206 Vali Loss: 0.462 Vali Acc: 0.804 Test Loss: 0.462 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.4251654148101807
Epoch: 19, Steps: 9 | Train Loss: 0.167 Vali Loss: 0.448 Vali Acc: 0.804 Test Loss: 0.448 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.5125393867492676
Epoch: 20, Steps: 9 | Train Loss: 0.141 Vali Loss: 0.462 Vali Acc: 0.819 Test Loss: 0.462 Test Acc: 0.819
Validation loss decreased (-0.811590 --> -0.818836).  Saving model ...
Epoch: 21 cost time: 2.5698232650756836
Epoch: 21, Steps: 9 | Train Loss: 0.212 Vali Loss: 0.480 Vali Acc: 0.804 Test Loss: 0.480 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.3708536624908447
Epoch: 22, Steps: 9 | Train Loss: 0.159 Vali Loss: 0.505 Vali Acc: 0.812 Test Loss: 0.505 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.42290997505188
Epoch: 23, Steps: 9 | Train Loss: 0.112 Vali Loss: 0.484 Vali Acc: 0.833 Test Loss: 0.484 Test Acc: 0.833
Validation loss decreased (-0.818836 --> -0.833328).  Saving model ...
Epoch: 24 cost time: 2.6548476219177246
Epoch: 24, Steps: 9 | Train Loss: 0.142 Vali Loss: 0.407 Vali Acc: 0.870 Test Loss: 0.407 Test Acc: 0.870
Validation loss decreased (-0.833328 --> -0.869561).  Saving model ...
Epoch: 25 cost time: 2.496584177017212
Epoch: 25, Steps: 9 | Train Loss: 0.105 Vali Loss: 0.492 Vali Acc: 0.812 Test Loss: 0.492 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.5073564052581787
Epoch: 26, Steps: 9 | Train Loss: 0.110 Vali Loss: 0.462 Vali Acc: 0.848 Test Loss: 0.462 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.4741311073303223
Epoch: 27, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.387 Vali Acc: 0.848 Test Loss: 0.387 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.385385751724243
Epoch: 28, Steps: 9 | Train Loss: 0.080 Vali Loss: 0.407 Vali Acc: 0.841 Test Loss: 0.407 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.3968162536621094
Epoch: 29, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.466 Vali Acc: 0.819 Test Loss: 0.466 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.9935011863708496
Epoch: 30, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.362 Vali Acc: 0.870 Test Loss: 0.362 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869562).  Saving model ...
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 300060
model size : 1.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.092649698257446
Epoch: 1, Steps: 9 | Train Loss: 1.345 Vali Loss: 1.270 Vali Acc: 0.384 Test Loss: 1.270 Test Acc: 0.384
Validation loss decreased (inf --> -0.384045).  Saving model ...
Epoch: 2 cost time: 1.7662327289581299
Epoch: 2, Steps: 9 | Train Loss: 1.266 Vali Loss: 1.202 Vali Acc: 0.442 Test Loss: 1.202 Test Acc: 0.442
Validation loss decreased (-0.384045 --> -0.442017).  Saving model ...
Epoch: 3 cost time: 1.9341204166412354
Epoch: 3, Steps: 9 | Train Loss: 1.185 Vali Loss: 1.126 Vali Acc: 0.471 Test Loss: 1.126 Test Acc: 0.471
Validation loss decreased (-0.442017 --> -0.471003).  Saving model ...
Epoch: 4 cost time: 1.9245877265930176
Epoch: 4, Steps: 9 | Train Loss: 1.092 Vali Loss: 1.043 Vali Acc: 0.493 Test Loss: 1.043 Test Acc: 0.493
Validation loss decreased (-0.471003 --> -0.492743).  Saving model ...
Epoch: 5 cost time: 1.813500165939331
Epoch: 5, Steps: 9 | Train Loss: 1.007 Vali Loss: 0.972 Vali Acc: 0.543 Test Loss: 0.972 Test Acc: 0.543
Validation loss decreased (-0.492743 --> -0.543469).  Saving model ...
Epoch: 6 cost time: 2.038264751434326
Epoch: 6, Steps: 9 | Train Loss: 0.922 Vali Loss: 0.898 Vali Acc: 0.601 Test Loss: 0.898 Test Acc: 0.601
Validation loss decreased (-0.543469 --> -0.601440).  Saving model ...
Epoch: 7 cost time: 1.9824881553649902
Epoch: 7, Steps: 9 | Train Loss: 0.849 Vali Loss: 0.831 Vali Acc: 0.645 Test Loss: 0.831 Test Acc: 0.645
Validation loss decreased (-0.601440 --> -0.644919).  Saving model ...
Epoch: 8 cost time: 2.0010361671447754
Epoch: 8, Steps: 9 | Train Loss: 0.758 Vali Loss: 0.768 Vali Acc: 0.703 Test Loss: 0.768 Test Acc: 0.703
Validation loss decreased (-0.644919 --> -0.702891).  Saving model ...
Epoch: 9 cost time: 1.9524571895599365
Epoch: 9, Steps: 9 | Train Loss: 0.672 Vali Loss: 0.704 Vali Acc: 0.725 Test Loss: 0.704 Test Acc: 0.725
Validation loss decreased (-0.702891 --> -0.724631).  Saving model ...
Epoch: 10 cost time: 1.6014902591705322
Epoch: 10, Steps: 9 | Train Loss: 0.600 Vali Loss: 0.659 Vali Acc: 0.761 Test Loss: 0.659 Test Acc: 0.761
Validation loss decreased (-0.724631 --> -0.760863).  Saving model ...
Epoch: 11 cost time: 1.5100579261779785
Epoch: 11, Steps: 9 | Train Loss: 0.512 Vali Loss: 0.598 Vali Acc: 0.761 Test Loss: 0.598 Test Acc: 0.761
Validation loss decreased (-0.760863 --> -0.760864).  Saving model ...
Epoch: 12 cost time: 1.5225465297698975
Epoch: 12, Steps: 9 | Train Loss: 0.479 Vali Loss: 0.549 Vali Acc: 0.797 Test Loss: 0.549 Test Acc: 0.797
Validation loss decreased (-0.760864 --> -0.797096).  Saving model ...
Epoch: 13 cost time: 1.8547980785369873
Epoch: 13, Steps: 9 | Train Loss: 0.400 Vali Loss: 0.496 Vali Acc: 0.812 Test Loss: 0.496 Test Acc: 0.812
Validation loss decreased (-0.797096 --> -0.811589).  Saving model ...
Epoch: 14 cost time: 1.9688365459442139
Epoch: 14, Steps: 9 | Train Loss: 0.352 Vali Loss: 0.456 Vali Acc: 0.812 Test Loss: 0.456 Test Acc: 0.812
Validation loss decreased (-0.811589 --> -0.811590).  Saving model ...
Epoch: 15 cost time: 1.9742729663848877
Epoch: 15, Steps: 9 | Train Loss: 0.294 Vali Loss: 0.416 Vali Acc: 0.833 Test Loss: 0.416 Test Acc: 0.833
Validation loss decreased (-0.811590 --> -0.833329).  Saving model ...
Epoch: 16 cost time: 2.104740619659424
Epoch: 16, Steps: 9 | Train Loss: 0.252 Vali Loss: 0.381 Vali Acc: 0.855 Test Loss: 0.381 Test Acc: 0.855
Validation loss decreased (-0.833329 --> -0.855069).  Saving model ...
Epoch: 17 cost time: 2.0635359287261963
Epoch: 17, Steps: 9 | Train Loss: 0.236 Vali Loss: 0.368 Vali Acc: 0.862 Test Loss: 0.368 Test Acc: 0.862
Validation loss decreased (-0.855069 --> -0.862315).  Saving model ...
Epoch: 18 cost time: 1.9095978736877441
Epoch: 18, Steps: 9 | Train Loss: 0.172 Vali Loss: 0.358 Vali Acc: 0.855 Test Loss: 0.358 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8271944522857666
Epoch: 19, Steps: 9 | Train Loss: 0.176 Vali Loss: 0.321 Vali Acc: 0.884 Test Loss: 0.321 Test Acc: 0.884
Validation loss decreased (-0.862315 --> -0.884055).  Saving model ...
Epoch: 20 cost time: 1.8677043914794922
Epoch: 20, Steps: 9 | Train Loss: 0.155 Vali Loss: 0.314 Vali Acc: 0.877 Test Loss: 0.314 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.9605257511138916
Epoch: 21, Steps: 9 | Train Loss: 0.121 Vali Loss: 0.330 Vali Acc: 0.870 Test Loss: 0.330 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.90549898147583
Epoch: 22, Steps: 9 | Train Loss: 0.158 Vali Loss: 0.314 Vali Acc: 0.884 Test Loss: 0.314 Test Acc: 0.884
Validation loss decreased (-0.884055 --> -0.884055).  Saving model ...
Epoch: 23 cost time: 1.8612627983093262
Epoch: 23, Steps: 9 | Train Loss: 0.117 Vali Loss: 0.301 Vali Acc: 0.884 Test Loss: 0.301 Test Acc: 0.884
Validation loss decreased (-0.884055 --> -0.884055).  Saving model ...
Epoch: 24 cost time: 1.919684886932373
Epoch: 24, Steps: 9 | Train Loss: 0.103 Vali Loss: 0.313 Vali Acc: 0.862 Test Loss: 0.313 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.9375922679901123
Epoch: 25, Steps: 9 | Train Loss: 0.094 Vali Loss: 0.328 Vali Acc: 0.884 Test Loss: 0.328 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.9624667167663574
Epoch: 26, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.329 Vali Acc: 0.877 Test Loss: 0.329 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.0456488132476807
Epoch: 27, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.314 Vali Acc: 0.877 Test Loss: 0.314 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.8987948894500732
Epoch: 28, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.323 Vali Acc: 0.877 Test Loss: 0.323 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.9393858909606934
Epoch: 29, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.323 Vali Acc: 0.891 Test Loss: 0.323 Test Acc: 0.891
Validation loss decreased (-0.884055 --> -0.891301).  Saving model ...
Epoch: 30 cost time: 1.952085256576538
Epoch: 30, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.348 Vali Acc: 0.877 Test Loss: 0.348 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 93052
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.9103171825408936
Epoch: 1, Steps: 9 | Train Loss: 1.374 Vali Loss: 1.328 Vali Acc: 0.384 Test Loss: 1.328 Test Acc: 0.384
Validation loss decreased (inf --> -0.384045).  Saving model ...
Epoch: 2 cost time: 2.0083534717559814
Epoch: 2, Steps: 9 | Train Loss: 1.323 Vali Loss: 1.263 Vali Acc: 0.420 Test Loss: 1.263 Test Acc: 0.420
Validation loss decreased (-0.384045 --> -0.420277).  Saving model ...
Epoch: 3 cost time: 2.0086746215820312
Epoch: 3, Steps: 9 | Train Loss: 1.228 Vali Loss: 1.185 Vali Acc: 0.471 Test Loss: 1.185 Test Acc: 0.471
Validation loss decreased (-0.420277 --> -0.471003).  Saving model ...
Epoch: 4 cost time: 2.0831971168518066
Epoch: 4, Steps: 9 | Train Loss: 1.146 Vali Loss: 1.108 Vali Acc: 0.478 Test Loss: 1.108 Test Acc: 0.478
Validation loss decreased (-0.471003 --> -0.478250).  Saving model ...
Epoch: 5 cost time: 2.2709975242614746
Epoch: 5, Steps: 9 | Train Loss: 1.051 Vali Loss: 1.030 Vali Acc: 0.486 Test Loss: 1.030 Test Acc: 0.486
Validation loss decreased (-0.478250 --> -0.485497).  Saving model ...
Epoch: 6 cost time: 2.150674343109131
Epoch: 6, Steps: 9 | Train Loss: 0.936 Vali Loss: 0.956 Vali Acc: 0.507 Test Loss: 0.956 Test Acc: 0.507
Validation loss decreased (-0.485497 --> -0.507237).  Saving model ...
Epoch: 7 cost time: 2.0409586429595947
Epoch: 7, Steps: 9 | Train Loss: 0.864 Vali Loss: 0.890 Vali Acc: 0.565 Test Loss: 0.890 Test Acc: 0.565
Validation loss decreased (-0.507237 --> -0.565208).  Saving model ...
Epoch: 8 cost time: 2.0952227115631104
Epoch: 8, Steps: 9 | Train Loss: 0.769 Vali Loss: 0.801 Vali Acc: 0.630 Test Loss: 0.801 Test Acc: 0.630
Validation loss decreased (-0.565208 --> -0.630427).  Saving model ...
Epoch: 9 cost time: 2.0268139839172363
Epoch: 9, Steps: 9 | Train Loss: 0.673 Vali Loss: 0.727 Vali Acc: 0.725 Test Loss: 0.727 Test Acc: 0.725
Validation loss decreased (-0.630427 --> -0.724630).  Saving model ...
Epoch: 10 cost time: 2.120028257369995
Epoch: 10, Steps: 9 | Train Loss: 0.633 Vali Loss: 0.672 Vali Acc: 0.710 Test Loss: 0.672 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9893007278442383
Epoch: 11, Steps: 9 | Train Loss: 0.594 Vali Loss: 0.626 Vali Acc: 0.768 Test Loss: 0.626 Test Acc: 0.768
Validation loss decreased (-0.724630 --> -0.768110).  Saving model ...
Epoch: 12 cost time: 2.10522723197937
Epoch: 12, Steps: 9 | Train Loss: 0.493 Vali Loss: 0.554 Vali Acc: 0.819 Test Loss: 0.554 Test Acc: 0.819
Validation loss decreased (-0.768110 --> -0.818835).  Saving model ...
Epoch: 13 cost time: 2.0514309406280518
Epoch: 13, Steps: 9 | Train Loss: 0.532 Vali Loss: 0.601 Vali Acc: 0.819 Test Loss: 0.601 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.081385612487793
Epoch: 14, Steps: 9 | Train Loss: 0.444 Vali Loss: 0.518 Vali Acc: 0.841 Test Loss: 0.518 Test Acc: 0.841
Validation loss decreased (-0.818835 --> -0.840575).  Saving model ...
Epoch: 15 cost time: 2.1174468994140625
Epoch: 15, Steps: 9 | Train Loss: 0.358 Vali Loss: 0.487 Vali Acc: 0.848 Test Loss: 0.487 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847821).  Saving model ...
Epoch: 16 cost time: 1.9905457496643066
Epoch: 16, Steps: 9 | Train Loss: 0.355 Vali Loss: 0.503 Vali Acc: 0.833 Test Loss: 0.503 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.153447389602661
Epoch: 17, Steps: 9 | Train Loss: 0.271 Vali Loss: 0.422 Vali Acc: 0.855 Test Loss: 0.422 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855068).  Saving model ...
Epoch: 18 cost time: 2.036891460418701
Epoch: 18, Steps: 9 | Train Loss: 0.264 Vali Loss: 0.396 Vali Acc: 0.862 Test Loss: 0.396 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862315).  Saving model ...
Epoch: 19 cost time: 2.0930798053741455
Epoch: 19, Steps: 9 | Train Loss: 0.221 Vali Loss: 0.430 Vali Acc: 0.855 Test Loss: 0.430 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.0758533477783203
Epoch: 20, Steps: 9 | Train Loss: 0.221 Vali Loss: 0.363 Vali Acc: 0.877 Test Loss: 0.363 Test Acc: 0.877
Validation loss decreased (-0.862315 --> -0.876808).  Saving model ...
Epoch: 21 cost time: 1.8871057033538818
Epoch: 21, Steps: 9 | Train Loss: 0.247 Vali Loss: 0.413 Vali Acc: 0.870 Test Loss: 0.413 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.9152915477752686
Epoch: 22, Steps: 9 | Train Loss: 0.181 Vali Loss: 0.429 Vali Acc: 0.877 Test Loss: 0.429 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.9714794158935547
Epoch: 23, Steps: 9 | Train Loss: 0.153 Vali Loss: 0.423 Vali Acc: 0.855 Test Loss: 0.423 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.106546640396118
Epoch: 24, Steps: 9 | Train Loss: 0.149 Vali Loss: 0.400 Vali Acc: 0.862 Test Loss: 0.400 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.9614012241363525
Epoch: 25, Steps: 9 | Train Loss: 0.117 Vali Loss: 0.392 Vali Acc: 0.862 Test Loss: 0.392 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.9464187622070312
Epoch: 26, Steps: 9 | Train Loss: 0.134 Vali Loss: 0.341 Vali Acc: 0.877 Test Loss: 0.341 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 27 cost time: 1.9862959384918213
Epoch: 27, Steps: 9 | Train Loss: 0.128 Vali Loss: 0.326 Vali Acc: 0.899 Test Loss: 0.326 Test Acc: 0.899
Validation loss decreased (-0.876808 --> -0.898547).  Saving model ...
Epoch: 28 cost time: 2.04878568649292
Epoch: 28, Steps: 9 | Train Loss: 0.107 Vali Loss: 0.346 Vali Acc: 0.891 Test Loss: 0.346 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.936830759048462
Epoch: 29, Steps: 9 | Train Loss: 0.096 Vali Loss: 0.369 Vali Acc: 0.884 Test Loss: 0.369 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.9247608184814453
Epoch: 30, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.356 Vali Acc: 0.899 Test Loss: 0.356 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 300060
model size : 1.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.5850157737731934
Epoch: 1, Steps: 9 | Train Loss: 1.348 Vali Loss: 1.270 Vali Acc: 0.391 Test Loss: 1.270 Test Acc: 0.391
Validation loss decreased (inf --> -0.391292).  Saving model ...
Epoch: 2 cost time: 1.7378551959991455
Epoch: 2, Steps: 9 | Train Loss: 1.269 Vali Loss: 1.202 Vali Acc: 0.420 Test Loss: 1.202 Test Acc: 0.420
Validation loss decreased (-0.391292 --> -0.420278).  Saving model ...
Epoch: 3 cost time: 1.7567095756530762
Epoch: 3, Steps: 9 | Train Loss: 1.186 Vali Loss: 1.127 Vali Acc: 0.471 Test Loss: 1.127 Test Acc: 0.471
Validation loss decreased (-0.420278 --> -0.471003).  Saving model ...
Epoch: 4 cost time: 1.6643798351287842
Epoch: 4, Steps: 9 | Train Loss: 1.096 Vali Loss: 1.046 Vali Acc: 0.500 Test Loss: 1.046 Test Acc: 0.500
Validation loss decreased (-0.471003 --> -0.499990).  Saving model ...
Epoch: 5 cost time: 1.6873760223388672
Epoch: 5, Steps: 9 | Train Loss: 1.012 Vali Loss: 0.975 Vali Acc: 0.507 Test Loss: 0.975 Test Acc: 0.507
Validation loss decreased (-0.499990 --> -0.507237).  Saving model ...
Epoch: 6 cost time: 1.85410475730896
Epoch: 6, Steps: 9 | Train Loss: 0.935 Vali Loss: 0.906 Vali Acc: 0.572 Test Loss: 0.906 Test Acc: 0.572
Validation loss decreased (-0.507237 --> -0.572455).  Saving model ...
Epoch: 7 cost time: 1.818389654159546
Epoch: 7, Steps: 9 | Train Loss: 0.865 Vali Loss: 0.840 Vali Acc: 0.630 Test Loss: 0.840 Test Acc: 0.630
Validation loss decreased (-0.572455 --> -0.630426).  Saving model ...
Epoch: 8 cost time: 1.4548852443695068
Epoch: 8, Steps: 9 | Train Loss: 0.772 Vali Loss: 0.779 Vali Acc: 0.703 Test Loss: 0.779 Test Acc: 0.703
Validation loss decreased (-0.630426 --> -0.702891).  Saving model ...
Epoch: 9 cost time: 1.661205768585205
Epoch: 9, Steps: 9 | Train Loss: 0.700 Vali Loss: 0.716 Vali Acc: 0.725 Test Loss: 0.716 Test Acc: 0.725
Validation loss decreased (-0.702891 --> -0.724631).  Saving model ...
Epoch: 10 cost time: 1.6715834140777588
Epoch: 10, Steps: 9 | Train Loss: 0.635 Vali Loss: 0.662 Vali Acc: 0.746 Test Loss: 0.662 Test Acc: 0.746
Validation loss decreased (-0.724631 --> -0.746370).  Saving model ...
Epoch: 11 cost time: 1.4899868965148926
Epoch: 11, Steps: 9 | Train Loss: 0.554 Vali Loss: 0.604 Vali Acc: 0.775 Test Loss: 0.604 Test Acc: 0.775
Validation loss decreased (-0.746370 --> -0.775356).  Saving model ...
Epoch: 12 cost time: 1.6999282836914062
Epoch: 12, Steps: 9 | Train Loss: 0.526 Vali Loss: 0.557 Vali Acc: 0.775 Test Loss: 0.557 Test Acc: 0.775
Validation loss decreased (-0.775356 --> -0.775357).  Saving model ...
Epoch: 13 cost time: 1.6874115467071533
Epoch: 13, Steps: 9 | Train Loss: 0.468 Vali Loss: 0.507 Vali Acc: 0.804 Test Loss: 0.507 Test Acc: 0.804
Validation loss decreased (-0.775357 --> -0.804343).  Saving model ...
Epoch: 14 cost time: 1.5992944240570068
Epoch: 14, Steps: 9 | Train Loss: 0.415 Vali Loss: 0.493 Vali Acc: 0.775 Test Loss: 0.493 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8512263298034668
Epoch: 15, Steps: 9 | Train Loss: 0.360 Vali Loss: 0.449 Vali Acc: 0.819 Test Loss: 0.449 Test Acc: 0.819
Validation loss decreased (-0.804343 --> -0.818836).  Saving model ...
Epoch: 16 cost time: 1.8161540031433105
Epoch: 16, Steps: 9 | Train Loss: 0.303 Vali Loss: 0.423 Vali Acc: 0.826 Test Loss: 0.423 Test Acc: 0.826
Validation loss decreased (-0.818836 --> -0.826083).  Saving model ...
Epoch: 17 cost time: 1.5657126903533936
Epoch: 17, Steps: 9 | Train Loss: 0.271 Vali Loss: 0.405 Vali Acc: 0.819 Test Loss: 0.405 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8475041389465332
Epoch: 18, Steps: 9 | Train Loss: 0.221 Vali Loss: 0.378 Vali Acc: 0.819 Test Loss: 0.378 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.6573729515075684
Epoch: 19, Steps: 9 | Train Loss: 0.202 Vali Loss: 0.341 Vali Acc: 0.870 Test Loss: 0.341 Test Acc: 0.870
Validation loss decreased (-0.826083 --> -0.869562).  Saving model ...
Epoch: 20 cost time: 1.4366583824157715
Epoch: 20, Steps: 9 | Train Loss: 0.166 Vali Loss: 0.336 Vali Acc: 0.877 Test Loss: 0.336 Test Acc: 0.877
Validation loss decreased (-0.869562 --> -0.876808).  Saving model ...
Epoch: 21 cost time: 1.5886797904968262
Epoch: 21, Steps: 9 | Train Loss: 0.202 Vali Loss: 0.321 Vali Acc: 0.884 Test Loss: 0.321 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884055).  Saving model ...
Epoch: 22 cost time: 1.8428313732147217
Epoch: 22, Steps: 9 | Train Loss: 0.178 Vali Loss: 0.321 Vali Acc: 0.884 Test Loss: 0.321 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.638267993927002
Epoch: 23, Steps: 9 | Train Loss: 0.159 Vali Loss: 0.340 Vali Acc: 0.855 Test Loss: 0.340 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.7718589305877686
Epoch: 24, Steps: 9 | Train Loss: 0.142 Vali Loss: 0.341 Vali Acc: 0.848 Test Loss: 0.341 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.6736581325531006
Epoch: 25, Steps: 9 | Train Loss: 0.146 Vali Loss: 0.322 Vali Acc: 0.870 Test Loss: 0.322 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.6422431468963623
Epoch: 26, Steps: 9 | Train Loss: 0.128 Vali Loss: 0.338 Vali Acc: 0.884 Test Loss: 0.338 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.6972811222076416
Epoch: 27, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.362 Vali Acc: 0.870 Test Loss: 0.362 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.5686028003692627
Epoch: 28, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.322 Vali Acc: 0.870 Test Loss: 0.322 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.6043431758880615
Epoch: 29, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.305 Vali Acc: 0.891 Test Loss: 0.305 Test Acc: 0.891
Validation loss decreased (-0.884055 --> -0.891301).  Saving model ...
Epoch: 30 cost time: 1.614220142364502
Epoch: 30, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.287 Vali Acc: 0.891 Test Loss: 0.287 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 93052
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.567715883255005
Epoch: 1, Steps: 9 | Train Loss: 1.369 Vali Loss: 1.331 Vali Acc: 0.399 Test Loss: 1.331 Test Acc: 0.399
Validation loss decreased (inf --> -0.398537).  Saving model ...
Epoch: 2 cost time: 1.438586950302124
Epoch: 2, Steps: 9 | Train Loss: 1.330 Vali Loss: 1.271 Vali Acc: 0.413 Test Loss: 1.271 Test Acc: 0.413
Validation loss decreased (-0.398537 --> -0.413031).  Saving model ...
Epoch: 3 cost time: 1.5690672397613525
Epoch: 3, Steps: 9 | Train Loss: 1.230 Vali Loss: 1.201 Vali Acc: 0.442 Test Loss: 1.201 Test Acc: 0.442
Validation loss decreased (-0.413031 --> -0.442017).  Saving model ...
Epoch: 4 cost time: 1.5253565311431885
Epoch: 4, Steps: 9 | Train Loss: 1.162 Vali Loss: 1.125 Vali Acc: 0.478 Test Loss: 1.125 Test Acc: 0.478
Validation loss decreased (-0.442017 --> -0.478250).  Saving model ...
Epoch: 5 cost time: 1.3975789546966553
Epoch: 5, Steps: 9 | Train Loss: 1.070 Vali Loss: 1.047 Vali Acc: 0.493 Test Loss: 1.047 Test Acc: 0.493
Validation loss decreased (-0.478250 --> -0.492743).  Saving model ...
Epoch: 6 cost time: 1.4915375709533691
Epoch: 6, Steps: 9 | Train Loss: 0.969 Vali Loss: 0.966 Vali Acc: 0.514 Test Loss: 0.966 Test Acc: 0.514
Validation loss decreased (-0.492743 --> -0.514483).  Saving model ...
Epoch: 7 cost time: 1.505516529083252
Epoch: 7, Steps: 9 | Train Loss: 0.931 Vali Loss: 0.895 Vali Acc: 0.543 Test Loss: 0.895 Test Acc: 0.543
Validation loss decreased (-0.514483 --> -0.543469).  Saving model ...
Epoch: 8 cost time: 1.4725127220153809
Epoch: 8, Steps: 9 | Train Loss: 0.826 Vali Loss: 0.818 Vali Acc: 0.630 Test Loss: 0.818 Test Acc: 0.630
Validation loss decreased (-0.543469 --> -0.630427).  Saving model ...
Epoch: 9 cost time: 1.4598360061645508
Epoch: 9, Steps: 9 | Train Loss: 0.745 Vali Loss: 0.746 Vali Acc: 0.674 Test Loss: 0.746 Test Acc: 0.674
Validation loss decreased (-0.630427 --> -0.673906).  Saving model ...
Epoch: 10 cost time: 1.5724554061889648
Epoch: 10, Steps: 9 | Train Loss: 0.703 Vali Loss: 0.698 Vali Acc: 0.696 Test Loss: 0.698 Test Acc: 0.696
Validation loss decreased (-0.673906 --> -0.695645).  Saving model ...
Epoch: 11 cost time: 1.3535728454589844
Epoch: 11, Steps: 9 | Train Loss: 0.656 Vali Loss: 0.651 Vali Acc: 0.717 Test Loss: 0.651 Test Acc: 0.717
Validation loss decreased (-0.695645 --> -0.717385).  Saving model ...
Epoch: 12 cost time: 1.3453972339630127
Epoch: 12, Steps: 9 | Train Loss: 0.590 Vali Loss: 0.608 Vali Acc: 0.746 Test Loss: 0.608 Test Acc: 0.746
Validation loss decreased (-0.717385 --> -0.746371).  Saving model ...
Epoch: 13 cost time: 1.3362598419189453
Epoch: 13, Steps: 9 | Train Loss: 0.566 Vali Loss: 0.551 Vali Acc: 0.797 Test Loss: 0.551 Test Acc: 0.797
Validation loss decreased (-0.746371 --> -0.797096).  Saving model ...
Epoch: 14 cost time: 1.338456630706787
Epoch: 14, Steps: 9 | Train Loss: 0.509 Vali Loss: 0.535 Vali Acc: 0.819 Test Loss: 0.535 Test Acc: 0.819
Validation loss decreased (-0.797096 --> -0.818835).  Saving model ...
Epoch: 15 cost time: 1.369300127029419
Epoch: 15, Steps: 9 | Train Loss: 0.467 Vali Loss: 0.519 Vali Acc: 0.812 Test Loss: 0.519 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3491485118865967
Epoch: 16, Steps: 9 | Train Loss: 0.412 Vali Loss: 0.507 Vali Acc: 0.826 Test Loss: 0.507 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826082).  Saving model ...
Epoch: 17 cost time: 1.3630166053771973
Epoch: 17, Steps: 9 | Train Loss: 0.368 Vali Loss: 0.469 Vali Acc: 0.819 Test Loss: 0.469 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4089808464050293
Epoch: 18, Steps: 9 | Train Loss: 0.362 Vali Loss: 0.449 Vali Acc: 0.812 Test Loss: 0.449 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3718104362487793
Epoch: 19, Steps: 9 | Train Loss: 0.273 Vali Loss: 0.439 Vali Acc: 0.833 Test Loss: 0.439 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833329).  Saving model ...
Epoch: 20 cost time: 1.44451904296875
Epoch: 20, Steps: 9 | Train Loss: 0.253 Vali Loss: 0.426 Vali Acc: 0.826 Test Loss: 0.426 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.254284381866455
Epoch: 21, Steps: 9 | Train Loss: 0.237 Vali Loss: 0.446 Vali Acc: 0.819 Test Loss: 0.446 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.3477976322174072
Epoch: 22, Steps: 9 | Train Loss: 0.214 Vali Loss: 0.400 Vali Acc: 0.833 Test Loss: 0.400 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 23 cost time: 1.2972221374511719
Epoch: 23, Steps: 9 | Train Loss: 0.164 Vali Loss: 0.397 Vali Acc: 0.855 Test Loss: 0.397 Test Acc: 0.855
Validation loss decreased (-0.833329 --> -0.855068).  Saving model ...
Epoch: 24 cost time: 1.2585694789886475
Epoch: 24, Steps: 9 | Train Loss: 0.172 Vali Loss: 0.397 Vali Acc: 0.833 Test Loss: 0.397 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3739049434661865
Epoch: 25, Steps: 9 | Train Loss: 0.138 Vali Loss: 0.354 Vali Acc: 0.848 Test Loss: 0.354 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.3665821552276611
Epoch: 26, Steps: 9 | Train Loss: 0.121 Vali Loss: 0.386 Vali Acc: 0.841 Test Loss: 0.386 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.554304838180542
Epoch: 27, Steps: 9 | Train Loss: 0.133 Vali Loss: 0.357 Vali Acc: 0.862 Test Loss: 0.357 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862315).  Saving model ...
Epoch: 28 cost time: 1.497797966003418
Epoch: 28, Steps: 9 | Train Loss: 0.124 Vali Loss: 0.374 Vali Acc: 0.862 Test Loss: 0.374 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.4478859901428223
Epoch: 29, Steps: 9 | Train Loss: 0.109 Vali Loss: 0.403 Vali Acc: 0.855 Test Loss: 0.403 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.5574915409088135
Epoch: 30, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.377 Vali Acc: 0.862 Test Loss: 0.377 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 300060
model size : 1.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.3110620975494385
Epoch: 1, Steps: 9 | Train Loss: 1.352 Vali Loss: 1.272 Vali Acc: 0.406 Test Loss: 1.272 Test Acc: 0.406
Validation loss decreased (inf --> -0.405784).  Saving model ...
Epoch: 2 cost time: 1.412172555923462
Epoch: 2, Steps: 9 | Train Loss: 1.268 Vali Loss: 1.209 Vali Acc: 0.391 Test Loss: 1.209 Test Acc: 0.391
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3594517707824707
Epoch: 3, Steps: 9 | Train Loss: 1.198 Vali Loss: 1.138 Vali Acc: 0.449 Test Loss: 1.138 Test Acc: 0.449
Validation loss decreased (-0.405784 --> -0.449264).  Saving model ...
Epoch: 4 cost time: 1.3777835369110107
Epoch: 4, Steps: 9 | Train Loss: 1.098 Vali Loss: 1.063 Vali Acc: 0.478 Test Loss: 1.063 Test Acc: 0.478
Validation loss decreased (-0.449264 --> -0.478250).  Saving model ...
Epoch: 5 cost time: 1.4155383110046387
Epoch: 5, Steps: 9 | Train Loss: 1.027 Vali Loss: 0.998 Vali Acc: 0.500 Test Loss: 0.998 Test Acc: 0.500
Validation loss decreased (-0.478250 --> -0.499990).  Saving model ...
Epoch: 6 cost time: 1.371133804321289
Epoch: 6, Steps: 9 | Train Loss: 0.964 Vali Loss: 0.937 Vali Acc: 0.551 Test Loss: 0.937 Test Acc: 0.551
Validation loss decreased (-0.499990 --> -0.550715).  Saving model ...
Epoch: 7 cost time: 1.2685546875
Epoch: 7, Steps: 9 | Train Loss: 0.882 Vali Loss: 0.878 Vali Acc: 0.616 Test Loss: 0.878 Test Acc: 0.616
Validation loss decreased (-0.550715 --> -0.615933).  Saving model ...
Epoch: 8 cost time: 1.2269182205200195
Epoch: 8, Steps: 9 | Train Loss: 0.797 Vali Loss: 0.825 Vali Acc: 0.645 Test Loss: 0.825 Test Acc: 0.645
Validation loss decreased (-0.615933 --> -0.644919).  Saving model ...
Epoch: 9 cost time: 1.1874034404754639
Epoch: 9, Steps: 9 | Train Loss: 0.744 Vali Loss: 0.773 Vali Acc: 0.667 Test Loss: 0.773 Test Acc: 0.667
Validation loss decreased (-0.644919 --> -0.666659).  Saving model ...
Epoch: 10 cost time: 1.1711022853851318
Epoch: 10, Steps: 9 | Train Loss: 0.682 Vali Loss: 0.721 Vali Acc: 0.696 Test Loss: 0.721 Test Acc: 0.696
Validation loss decreased (-0.666659 --> -0.695645).  Saving model ...
Epoch: 11 cost time: 1.1117873191833496
Epoch: 11, Steps: 9 | Train Loss: 0.613 Vali Loss: 0.677 Vali Acc: 0.725 Test Loss: 0.677 Test Acc: 0.725
Validation loss decreased (-0.695645 --> -0.724631).  Saving model ...
Epoch: 12 cost time: 1.2938990592956543
Epoch: 12, Steps: 9 | Train Loss: 0.585 Vali Loss: 0.632 Vali Acc: 0.746 Test Loss: 0.632 Test Acc: 0.746
Validation loss decreased (-0.724631 --> -0.746370).  Saving model ...
Epoch: 13 cost time: 1.412078857421875
Epoch: 13, Steps: 9 | Train Loss: 0.526 Vali Loss: 0.584 Vali Acc: 0.761 Test Loss: 0.584 Test Acc: 0.761
Validation loss decreased (-0.746370 --> -0.760864).  Saving model ...
Epoch: 14 cost time: 1.4241433143615723
Epoch: 14, Steps: 9 | Train Loss: 0.459 Vali Loss: 0.557 Vali Acc: 0.761 Test Loss: 0.557 Test Acc: 0.761
Validation loss decreased (-0.760864 --> -0.760864).  Saving model ...
Epoch: 15 cost time: 1.4714484214782715
Epoch: 15, Steps: 9 | Train Loss: 0.408 Vali Loss: 0.532 Vali Acc: 0.768 Test Loss: 0.532 Test Acc: 0.768
Validation loss decreased (-0.760864 --> -0.768111).  Saving model ...
Epoch: 16 cost time: 1.4405033588409424
Epoch: 16, Steps: 9 | Train Loss: 0.358 Vali Loss: 0.506 Vali Acc: 0.790 Test Loss: 0.506 Test Acc: 0.790
Validation loss decreased (-0.768111 --> -0.789850).  Saving model ...
Epoch: 17 cost time: 1.2673451900482178
Epoch: 17, Steps: 9 | Train Loss: 0.361 Vali Loss: 0.476 Vali Acc: 0.790 Test Loss: 0.476 Test Acc: 0.790
Validation loss decreased (-0.789850 --> -0.789850).  Saving model ...
Epoch: 18 cost time: 1.505974531173706
Epoch: 18, Steps: 9 | Train Loss: 0.278 Vali Loss: 0.462 Vali Acc: 0.790 Test Loss: 0.462 Test Acc: 0.790
Validation loss decreased (-0.789850 --> -0.789850).  Saving model ...
Epoch: 19 cost time: 1.4941997528076172
Epoch: 19, Steps: 9 | Train Loss: 0.267 Vali Loss: 0.448 Vali Acc: 0.797 Test Loss: 0.448 Test Acc: 0.797
Validation loss decreased (-0.789850 --> -0.797097).  Saving model ...
Epoch: 20 cost time: 1.4103484153747559
Epoch: 20, Steps: 9 | Train Loss: 0.246 Vali Loss: 0.423 Vali Acc: 0.833 Test Loss: 0.423 Test Acc: 0.833
Validation loss decreased (-0.797097 --> -0.833329).  Saving model ...
Epoch: 21 cost time: 1.4855473041534424
Epoch: 21, Steps: 9 | Train Loss: 0.203 Vali Loss: 0.409 Vali Acc: 0.841 Test Loss: 0.409 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840576).  Saving model ...
Epoch: 22 cost time: 1.2670037746429443
Epoch: 22, Steps: 9 | Train Loss: 0.229 Vali Loss: 0.411 Vali Acc: 0.841 Test Loss: 0.411 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3615694046020508
Epoch: 23, Steps: 9 | Train Loss: 0.188 Vali Loss: 0.426 Vali Acc: 0.833 Test Loss: 0.426 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.3861746788024902
Epoch: 24, Steps: 9 | Train Loss: 0.181 Vali Loss: 0.442 Vali Acc: 0.812 Test Loss: 0.442 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.5578649044036865
Epoch: 25, Steps: 9 | Train Loss: 0.164 Vali Loss: 0.419 Vali Acc: 0.833 Test Loss: 0.419 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.3736107349395752
Epoch: 26, Steps: 9 | Train Loss: 0.127 Vali Loss: 0.418 Vali Acc: 0.841 Test Loss: 0.418 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.4575488567352295
Epoch: 27, Steps: 9 | Train Loss: 0.106 Vali Loss: 0.438 Vali Acc: 0.819 Test Loss: 0.438 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.463698148727417
Epoch: 28, Steps: 9 | Train Loss: 0.112 Vali Loss: 0.424 Vali Acc: 0.841 Test Loss: 0.424 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.4589180946350098
Epoch: 29, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.424 Vali Acc: 0.841 Test Loss: 0.424 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.5122065544128418
Epoch: 30, Steps: 9 | Train Loss: 0.105 Vali Loss: 0.414 Vali Acc: 0.833 Test Loss: 0.414 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8405797101449275
model parameter : 93052
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.377715349197388
Epoch: 1, Steps: 9 | Train Loss: 1.465 Vali Loss: 1.425 Vali Acc: 0.283 Test Loss: 1.425 Test Acc: 0.283
Validation loss decreased (inf --> -0.282594).  Saving model ...
Epoch: 2 cost time: 2.2990331649780273
Epoch: 2, Steps: 9 | Train Loss: 1.392 Vali Loss: 1.330 Vali Acc: 0.420 Test Loss: 1.330 Test Acc: 0.420
Validation loss decreased (-0.282594 --> -0.420277).  Saving model ...
Epoch: 3 cost time: 2.1694653034210205
Epoch: 3, Steps: 9 | Train Loss: 1.270 Vali Loss: 1.223 Vali Acc: 0.522 Test Loss: 1.223 Test Acc: 0.522
Validation loss decreased (-0.420277 --> -0.521727).  Saving model ...
Epoch: 4 cost time: 2.2626688480377197
Epoch: 4, Steps: 9 | Train Loss: 1.167 Vali Loss: 1.116 Vali Acc: 0.514 Test Loss: 1.116 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.231285333633423
Epoch: 5, Steps: 9 | Train Loss: 1.041 Vali Loss: 1.014 Vali Acc: 0.551 Test Loss: 1.014 Test Acc: 0.551
Validation loss decreased (-0.521727 --> -0.550714).  Saving model ...
Epoch: 6 cost time: 2.198303699493408
Epoch: 6, Steps: 9 | Train Loss: 0.953 Vali Loss: 0.919 Vali Acc: 0.551 Test Loss: 0.919 Test Acc: 0.551
Validation loss decreased (-0.550714 --> -0.550715).  Saving model ...
Epoch: 7 cost time: 2.3089754581451416
Epoch: 7, Steps: 9 | Train Loss: 0.832 Vali Loss: 0.817 Vali Acc: 0.587 Test Loss: 0.817 Test Acc: 0.587
Validation loss decreased (-0.550715 --> -0.586948).  Saving model ...
Epoch: 8 cost time: 2.132347822189331
Epoch: 8, Steps: 9 | Train Loss: 0.726 Vali Loss: 0.712 Vali Acc: 0.674 Test Loss: 0.712 Test Acc: 0.674
Validation loss decreased (-0.586948 --> -0.673906).  Saving model ...
Epoch: 9 cost time: 2.3281335830688477
Epoch: 9, Steps: 9 | Train Loss: 0.629 Vali Loss: 0.614 Vali Acc: 0.732 Test Loss: 0.614 Test Acc: 0.732
Validation loss decreased (-0.673906 --> -0.731878).  Saving model ...
Epoch: 10 cost time: 2.086333990097046
Epoch: 10, Steps: 9 | Train Loss: 0.537 Vali Loss: 0.540 Vali Acc: 0.775 Test Loss: 0.540 Test Acc: 0.775
Validation loss decreased (-0.731878 --> -0.775357).  Saving model ...
Epoch: 11 cost time: 2.291031837463379
Epoch: 11, Steps: 9 | Train Loss: 0.443 Vali Loss: 0.460 Vali Acc: 0.841 Test Loss: 0.460 Test Acc: 0.841
Validation loss decreased (-0.775357 --> -0.840575).  Saving model ...
Epoch: 12 cost time: 2.0731959342956543
Epoch: 12, Steps: 9 | Train Loss: 0.381 Vali Loss: 0.406 Vali Acc: 0.848 Test Loss: 0.406 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847822).  Saving model ...
Epoch: 13 cost time: 2.139432430267334
Epoch: 13, Steps: 9 | Train Loss: 0.331 Vali Loss: 0.368 Vali Acc: 0.848 Test Loss: 0.368 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 14 cost time: 2.3228819370269775
Epoch: 14, Steps: 9 | Train Loss: 0.319 Vali Loss: 0.330 Vali Acc: 0.870 Test Loss: 0.330 Test Acc: 0.870
Validation loss decreased (-0.847822 --> -0.869562).  Saving model ...
Epoch: 15 cost time: 2.1958529949188232
Epoch: 15, Steps: 9 | Train Loss: 0.272 Vali Loss: 0.304 Vali Acc: 0.877 Test Loss: 0.304 Test Acc: 0.877
Validation loss decreased (-0.869562 --> -0.876809).  Saving model ...
Epoch: 16 cost time: 2.474346399307251
Epoch: 16, Steps: 9 | Train Loss: 0.242 Vali Loss: 0.266 Vali Acc: 0.920 Test Loss: 0.266 Test Acc: 0.920
Validation loss decreased (-0.876809 --> -0.920287).  Saving model ...
Epoch: 17 cost time: 2.4109690189361572
Epoch: 17, Steps: 9 | Train Loss: 0.205 Vali Loss: 0.269 Vali Acc: 0.913 Test Loss: 0.269 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.3828885555267334
Epoch: 18, Steps: 9 | Train Loss: 0.179 Vali Loss: 0.278 Vali Acc: 0.899 Test Loss: 0.278 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.4100778102874756
Epoch: 19, Steps: 9 | Train Loss: 0.184 Vali Loss: 0.277 Vali Acc: 0.891 Test Loss: 0.277 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.3117165565490723
Epoch: 20, Steps: 9 | Train Loss: 0.165 Vali Loss: 0.339 Vali Acc: 0.884 Test Loss: 0.339 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.4124667644500732
Epoch: 21, Steps: 9 | Train Loss: 0.129 Vali Loss: 0.293 Vali Acc: 0.877 Test Loss: 0.293 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.3287978172302246
Epoch: 22, Steps: 9 | Train Loss: 0.132 Vali Loss: 0.250 Vali Acc: 0.899 Test Loss: 0.250 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.193380117416382
Epoch: 23, Steps: 9 | Train Loss: 0.099 Vali Loss: 0.289 Vali Acc: 0.884 Test Loss: 0.289 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.2696847915649414
Epoch: 24, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.271 Vali Acc: 0.891 Test Loss: 0.271 Test Acc: 0.891
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.282564163208008
Epoch: 25, Steps: 9 | Train Loss: 0.124 Vali Loss: 0.252 Vali Acc: 0.899 Test Loss: 0.252 Test Acc: 0.899
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.2843706607818604
Epoch: 26, Steps: 9 | Train Loss: 0.086 Vali Loss: 0.291 Vali Acc: 0.891 Test Loss: 0.291 Test Acc: 0.891
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 153436
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.695469379425049
Epoch: 1, Steps: 9 | Train Loss: 1.354 Vali Loss: 1.355 Vali Acc: 0.319 Test Loss: 1.355 Test Acc: 0.319
Validation loss decreased (inf --> -0.318827).  Saving model ...
Epoch: 2 cost time: 1.9440484046936035
Epoch: 2, Steps: 9 | Train Loss: 1.294 Vali Loss: 1.276 Vali Acc: 0.377 Test Loss: 1.276 Test Acc: 0.377
Validation loss decreased (-0.318827 --> -0.376799).  Saving model ...
Epoch: 3 cost time: 1.9622244834899902
Epoch: 3, Steps: 9 | Train Loss: 1.227 Vali Loss: 1.181 Vali Acc: 0.514 Test Loss: 1.181 Test Acc: 0.514
Validation loss decreased (-0.376799 --> -0.514481).  Saving model ...
Epoch: 4 cost time: 1.804581642150879
Epoch: 4, Steps: 9 | Train Loss: 1.117 Vali Loss: 1.089 Vali Acc: 0.565 Test Loss: 1.089 Test Acc: 0.565
Validation loss decreased (-0.514481 --> -0.565206).  Saving model ...
Epoch: 5 cost time: 1.9231846332550049
Epoch: 5, Steps: 9 | Train Loss: 1.027 Vali Loss: 1.002 Vali Acc: 0.616 Test Loss: 1.002 Test Acc: 0.616
Validation loss decreased (-0.565206 --> -0.615932).  Saving model ...
Epoch: 6 cost time: 1.9375348091125488
Epoch: 6, Steps: 9 | Train Loss: 0.928 Vali Loss: 0.925 Vali Acc: 0.638 Test Loss: 0.925 Test Acc: 0.638
Validation loss decreased (-0.615932 --> -0.637672).  Saving model ...
Epoch: 7 cost time: 1.9813590049743652
Epoch: 7, Steps: 9 | Train Loss: 0.832 Vali Loss: 0.864 Vali Acc: 0.659 Test Loss: 0.864 Test Acc: 0.659
Validation loss decreased (-0.637672 --> -0.659412).  Saving model ...
Epoch: 8 cost time: 2.0540599822998047
Epoch: 8, Steps: 9 | Train Loss: 0.754 Vali Loss: 0.801 Vali Acc: 0.688 Test Loss: 0.801 Test Acc: 0.688
Validation loss decreased (-0.659412 --> -0.688398).  Saving model ...
Epoch: 9 cost time: 2.027108907699585
Epoch: 9, Steps: 9 | Train Loss: 0.680 Vali Loss: 0.734 Vali Acc: 0.732 Test Loss: 0.734 Test Acc: 0.732
Validation loss decreased (-0.688398 --> -0.731877).  Saving model ...
Epoch: 10 cost time: 1.999234676361084
Epoch: 10, Steps: 9 | Train Loss: 0.590 Vali Loss: 0.676 Vali Acc: 0.746 Test Loss: 0.676 Test Acc: 0.746
Validation loss decreased (-0.731877 --> -0.746370).  Saving model ...
Epoch: 11 cost time: 1.794011116027832
Epoch: 11, Steps: 9 | Train Loss: 0.514 Vali Loss: 0.617 Vali Acc: 0.775 Test Loss: 0.617 Test Acc: 0.775
Validation loss decreased (-0.746370 --> -0.775356).  Saving model ...
Epoch: 12 cost time: 1.6708266735076904
Epoch: 12, Steps: 9 | Train Loss: 0.441 Vali Loss: 0.562 Vali Acc: 0.797 Test Loss: 0.562 Test Acc: 0.797
Validation loss decreased (-0.775356 --> -0.797096).  Saving model ...
Epoch: 13 cost time: 1.702873706817627
Epoch: 13, Steps: 9 | Train Loss: 0.366 Vali Loss: 0.520 Vali Acc: 0.790 Test Loss: 0.520 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.665015459060669
Epoch: 14, Steps: 9 | Train Loss: 0.310 Vali Loss: 0.469 Vali Acc: 0.804 Test Loss: 0.469 Test Acc: 0.804
Validation loss decreased (-0.797096 --> -0.804343).  Saving model ...
Epoch: 15 cost time: 1.867035150527954
Epoch: 15, Steps: 9 | Train Loss: 0.262 Vali Loss: 0.430 Vali Acc: 0.826 Test Loss: 0.430 Test Acc: 0.826
Validation loss decreased (-0.804343 --> -0.826083).  Saving model ...
Epoch: 16 cost time: 1.9138493537902832
Epoch: 16, Steps: 9 | Train Loss: 0.237 Vali Loss: 0.382 Vali Acc: 0.841 Test Loss: 0.382 Test Acc: 0.841
Validation loss decreased (-0.826083 --> -0.840576).  Saving model ...
Epoch: 17 cost time: 1.9043772220611572
Epoch: 17, Steps: 9 | Train Loss: 0.194 Vali Loss: 0.353 Vali Acc: 0.841 Test Loss: 0.353 Test Acc: 0.841
Validation loss decreased (-0.840576 --> -0.840576).  Saving model ...
Epoch: 18 cost time: 1.96498703956604
Epoch: 18, Steps: 9 | Train Loss: 0.180 Vali Loss: 0.335 Vali Acc: 0.855 Test Loss: 0.335 Test Acc: 0.855
Validation loss decreased (-0.840576 --> -0.855069).  Saving model ...
Epoch: 19 cost time: 1.7186548709869385
Epoch: 19, Steps: 9 | Train Loss: 0.174 Vali Loss: 0.321 Vali Acc: 0.877 Test Loss: 0.321 Test Acc: 0.877
Validation loss decreased (-0.855069 --> -0.876808).  Saving model ...
Epoch: 20 cost time: 2.010411262512207
Epoch: 20, Steps: 9 | Train Loss: 0.139 Vali Loss: 0.326 Vali Acc: 0.855 Test Loss: 0.326 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.002692937850952
Epoch: 21, Steps: 9 | Train Loss: 0.117 Vali Loss: 0.321 Vali Acc: 0.870 Test Loss: 0.321 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.8042750358581543
Epoch: 22, Steps: 9 | Train Loss: 0.120 Vali Loss: 0.290 Vali Acc: 0.891 Test Loss: 0.290 Test Acc: 0.891
Validation loss decreased (-0.876808 --> -0.891301).  Saving model ...
Epoch: 23 cost time: 1.685614824295044
Epoch: 23, Steps: 9 | Train Loss: 0.095 Vali Loss: 0.287 Vali Acc: 0.884 Test Loss: 0.287 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.7846004962921143
Epoch: 24, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.274 Vali Acc: 0.891 Test Loss: 0.274 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891302).  Saving model ...
Epoch: 25 cost time: 1.7472422122955322
Epoch: 25, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.246 Vali Acc: 0.899 Test Loss: 0.246 Test Acc: 0.899
Validation loss decreased (-0.891302 --> -0.898548).  Saving model ...
Epoch: 26 cost time: 1.626131534576416
Epoch: 26, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.244 Vali Acc: 0.891 Test Loss: 0.244 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.8363215923309326
Epoch: 27, Steps: 9 | Train Loss: 0.080 Vali Loss: 0.256 Vali Acc: 0.891 Test Loss: 0.256 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.6722302436828613
Epoch: 28, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.265 Vali Acc: 0.884 Test Loss: 0.265 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.744295358657837
Epoch: 29, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.266 Vali Acc: 0.891 Test Loss: 0.266 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.9185233116149902
Epoch: 30, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.249 Vali Acc: 0.906 Test Loss: 0.249 Test Acc: 0.906
Validation loss decreased (-0.898548 --> -0.905795).  Saving model ...
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 49916
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.747204542160034
Epoch: 1, Steps: 9 | Train Loss: 1.465 Vali Loss: 1.427 Vali Acc: 0.275 Test Loss: 1.427 Test Acc: 0.275
Validation loss decreased (inf --> -0.275348).  Saving model ...
Epoch: 2 cost time: 2.0268664360046387
Epoch: 2, Steps: 9 | Train Loss: 1.392 Vali Loss: 1.331 Vali Acc: 0.413 Test Loss: 1.331 Test Acc: 0.413
Validation loss decreased (-0.275348 --> -0.413030).  Saving model ...
Epoch: 3 cost time: 1.9338061809539795
Epoch: 3, Steps: 9 | Train Loss: 1.275 Vali Loss: 1.225 Vali Acc: 0.529 Test Loss: 1.225 Test Acc: 0.529
Validation loss decreased (-0.413030 --> -0.528973).  Saving model ...
Epoch: 4 cost time: 1.7892341613769531
Epoch: 4, Steps: 9 | Train Loss: 1.175 Vali Loss: 1.119 Vali Acc: 0.514 Test Loss: 1.119 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7932302951812744
Epoch: 5, Steps: 9 | Train Loss: 1.052 Vali Loss: 1.020 Vali Acc: 0.536 Test Loss: 1.020 Test Acc: 0.536
Validation loss decreased (-0.528973 --> -0.536222).  Saving model ...
Epoch: 6 cost time: 1.8201961517333984
Epoch: 6, Steps: 9 | Train Loss: 0.976 Vali Loss: 0.931 Vali Acc: 0.543 Test Loss: 0.931 Test Acc: 0.543
Validation loss decreased (-0.536222 --> -0.543469).  Saving model ...
Epoch: 7 cost time: 1.8122994899749756
Epoch: 7, Steps: 9 | Train Loss: 0.849 Vali Loss: 0.841 Vali Acc: 0.580 Test Loss: 0.841 Test Acc: 0.580
Validation loss decreased (-0.543469 --> -0.579702).  Saving model ...
Epoch: 8 cost time: 1.9724419116973877
Epoch: 8, Steps: 9 | Train Loss: 0.758 Vali Loss: 0.745 Vali Acc: 0.652 Test Loss: 0.745 Test Acc: 0.652
Validation loss decreased (-0.579702 --> -0.652166).  Saving model ...
Epoch: 9 cost time: 2.102999448776245
Epoch: 9, Steps: 9 | Train Loss: 0.682 Vali Loss: 0.657 Vali Acc: 0.732 Test Loss: 0.657 Test Acc: 0.732
Validation loss decreased (-0.652166 --> -0.731877).  Saving model ...
Epoch: 10 cost time: 1.958714485168457
Epoch: 10, Steps: 9 | Train Loss: 0.571 Vali Loss: 0.597 Vali Acc: 0.761 Test Loss: 0.597 Test Acc: 0.761
Validation loss decreased (-0.731877 --> -0.760864).  Saving model ...
Epoch: 11 cost time: 2.021435499191284
Epoch: 11, Steps: 9 | Train Loss: 0.496 Vali Loss: 0.523 Vali Acc: 0.833 Test Loss: 0.523 Test Acc: 0.833
Validation loss decreased (-0.760864 --> -0.833328).  Saving model ...
Epoch: 12 cost time: 1.9223058223724365
Epoch: 12, Steps: 9 | Train Loss: 0.436 Vali Loss: 0.459 Vali Acc: 0.833 Test Loss: 0.459 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833329).  Saving model ...
Epoch: 13 cost time: 2.044609785079956
Epoch: 13, Steps: 9 | Train Loss: 0.372 Vali Loss: 0.430 Vali Acc: 0.819 Test Loss: 0.430 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9818840026855469
Epoch: 14, Steps: 9 | Train Loss: 0.362 Vali Loss: 0.387 Vali Acc: 0.848 Test Loss: 0.387 Test Acc: 0.848
Validation loss decreased (-0.833329 --> -0.847822).  Saving model ...
Epoch: 15 cost time: 1.9245073795318604
Epoch: 15, Steps: 9 | Train Loss: 0.316 Vali Loss: 0.354 Vali Acc: 0.841 Test Loss: 0.354 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.0392301082611084
Epoch: 16, Steps: 9 | Train Loss: 0.265 Vali Loss: 0.290 Vali Acc: 0.920 Test Loss: 0.290 Test Acc: 0.920
Validation loss decreased (-0.847822 --> -0.920287).  Saving model ...
Epoch: 17 cost time: 2.0350069999694824
Epoch: 17, Steps: 9 | Train Loss: 0.229 Vali Loss: 0.285 Vali Acc: 0.920 Test Loss: 0.285 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 18 cost time: 1.9864728450775146
Epoch: 18, Steps: 9 | Train Loss: 0.186 Vali Loss: 0.267 Vali Acc: 0.920 Test Loss: 0.267 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 19 cost time: 1.974341630935669
Epoch: 19, Steps: 9 | Train Loss: 0.175 Vali Loss: 0.254 Vali Acc: 0.942 Test Loss: 0.254 Test Acc: 0.942
Validation loss decreased (-0.920287 --> -0.942026).  Saving model ...
Epoch: 20 cost time: 1.882244348526001
Epoch: 20, Steps: 9 | Train Loss: 0.162 Vali Loss: 0.251 Vali Acc: 0.928 Test Loss: 0.251 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.134359121322632
Epoch: 21, Steps: 9 | Train Loss: 0.136 Vali Loss: 0.258 Vali Acc: 0.906 Test Loss: 0.258 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.8009989261627197
Epoch: 22, Steps: 9 | Train Loss: 0.119 Vali Loss: 0.234 Vali Acc: 0.935 Test Loss: 0.234 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.6973340511322021
Epoch: 23, Steps: 9 | Train Loss: 0.089 Vali Loss: 0.213 Vali Acc: 0.935 Test Loss: 0.213 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.8743269443511963
Epoch: 24, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.201 Vali Acc: 0.935 Test Loss: 0.201 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.7434813976287842
Epoch: 25, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.197 Vali Acc: 0.935 Test Loss: 0.197 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.9585437774658203
Epoch: 26, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.218 Vali Acc: 0.928 Test Loss: 0.218 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.081550359725952
Epoch: 27, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.201 Vali Acc: 0.928 Test Loss: 0.201 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.173940896987915
Epoch: 28, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.201 Vali Acc: 0.920 Test Loss: 0.201 Test Acc: 0.920
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.9242761135101318
Epoch: 29, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.192 Vali Acc: 0.920 Test Loss: 0.192 Test Acc: 0.920
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9420289855072463
model parameter : 153436
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.410053014755249
Epoch: 1, Steps: 9 | Train Loss: 1.353 Vali Loss: 1.362 Vali Acc: 0.319 Test Loss: 1.362 Test Acc: 0.319
Validation loss decreased (inf --> -0.318827).  Saving model ...
Epoch: 2 cost time: 1.7943799495697021
Epoch: 2, Steps: 9 | Train Loss: 1.298 Vali Loss: 1.285 Vali Acc: 0.391 Test Loss: 1.285 Test Acc: 0.391
Validation loss decreased (-0.318827 --> -0.391292).  Saving model ...
Epoch: 3 cost time: 1.8445754051208496
Epoch: 3, Steps: 9 | Train Loss: 1.231 Vali Loss: 1.191 Vali Acc: 0.522 Test Loss: 1.191 Test Acc: 0.522
Validation loss decreased (-0.391292 --> -0.521727).  Saving model ...
Epoch: 4 cost time: 1.7714872360229492
Epoch: 4, Steps: 9 | Train Loss: 1.122 Vali Loss: 1.100 Vali Acc: 0.543 Test Loss: 1.100 Test Acc: 0.543
Validation loss decreased (-0.521727 --> -0.543467).  Saving model ...
Epoch: 5 cost time: 1.7873775959014893
Epoch: 5, Steps: 9 | Train Loss: 1.029 Vali Loss: 1.012 Vali Acc: 0.587 Test Loss: 1.012 Test Acc: 0.587
Validation loss decreased (-0.543467 --> -0.586946).  Saving model ...
Epoch: 6 cost time: 1.8829913139343262
Epoch: 6, Steps: 9 | Train Loss: 0.932 Vali Loss: 0.935 Vali Acc: 0.638 Test Loss: 0.935 Test Acc: 0.638
Validation loss decreased (-0.586946 --> -0.637672).  Saving model ...
Epoch: 7 cost time: 1.7436001300811768
Epoch: 7, Steps: 9 | Train Loss: 0.844 Vali Loss: 0.874 Vali Acc: 0.659 Test Loss: 0.874 Test Acc: 0.659
Validation loss decreased (-0.637672 --> -0.659412).  Saving model ...
Epoch: 8 cost time: 1.6251475811004639
Epoch: 8, Steps: 9 | Train Loss: 0.767 Vali Loss: 0.812 Vali Acc: 0.667 Test Loss: 0.812 Test Acc: 0.667
Validation loss decreased (-0.659412 --> -0.666659).  Saving model ...
Epoch: 9 cost time: 1.8166084289550781
Epoch: 9, Steps: 9 | Train Loss: 0.709 Vali Loss: 0.748 Vali Acc: 0.725 Test Loss: 0.748 Test Acc: 0.725
Validation loss decreased (-0.666659 --> -0.724630).  Saving model ...
Epoch: 10 cost time: 1.7078392505645752
Epoch: 10, Steps: 9 | Train Loss: 0.605 Vali Loss: 0.695 Vali Acc: 0.717 Test Loss: 0.695 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.564967155456543
Epoch: 11, Steps: 9 | Train Loss: 0.535 Vali Loss: 0.639 Vali Acc: 0.754 Test Loss: 0.639 Test Acc: 0.754
Validation loss decreased (-0.724630 --> -0.753617).  Saving model ...
Epoch: 12 cost time: 1.8069195747375488
Epoch: 12, Steps: 9 | Train Loss: 0.482 Vali Loss: 0.579 Vali Acc: 0.783 Test Loss: 0.579 Test Acc: 0.783
Validation loss decreased (-0.753617 --> -0.782603).  Saving model ...
Epoch: 13 cost time: 1.5110490322113037
Epoch: 13, Steps: 9 | Train Loss: 0.403 Vali Loss: 0.528 Vali Acc: 0.812 Test Loss: 0.528 Test Acc: 0.812
Validation loss decreased (-0.782603 --> -0.811589).  Saving model ...
Epoch: 14 cost time: 1.5144295692443848
Epoch: 14, Steps: 9 | Train Loss: 0.347 Vali Loss: 0.480 Vali Acc: 0.819 Test Loss: 0.480 Test Acc: 0.819
Validation loss decreased (-0.811589 --> -0.818836).  Saving model ...
Epoch: 15 cost time: 1.7026255130767822
Epoch: 15, Steps: 9 | Train Loss: 0.309 Vali Loss: 0.439 Vali Acc: 0.826 Test Loss: 0.439 Test Acc: 0.826
Validation loss decreased (-0.818836 --> -0.826083).  Saving model ...
Epoch: 16 cost time: 1.629709243774414
Epoch: 16, Steps: 9 | Train Loss: 0.274 Vali Loss: 0.393 Vali Acc: 0.826 Test Loss: 0.393 Test Acc: 0.826
Validation loss decreased (-0.826083 --> -0.826083).  Saving model ...
Epoch: 17 cost time: 1.736374855041504
Epoch: 17, Steps: 9 | Train Loss: 0.227 Vali Loss: 0.351 Vali Acc: 0.848 Test Loss: 0.351 Test Acc: 0.848
Validation loss decreased (-0.826083 --> -0.847823).  Saving model ...
Epoch: 18 cost time: 1.6439127922058105
Epoch: 18, Steps: 9 | Train Loss: 0.204 Vali Loss: 0.324 Vali Acc: 0.855 Test Loss: 0.324 Test Acc: 0.855
Validation loss decreased (-0.847823 --> -0.855069).  Saving model ...
Epoch: 19 cost time: 1.4985847473144531
Epoch: 19, Steps: 9 | Train Loss: 0.209 Vali Loss: 0.317 Vali Acc: 0.862 Test Loss: 0.317 Test Acc: 0.862
Validation loss decreased (-0.855069 --> -0.862316).  Saving model ...
Epoch: 20 cost time: 1.5684115886688232
Epoch: 20, Steps: 9 | Train Loss: 0.166 Vali Loss: 0.299 Vali Acc: 0.870 Test Loss: 0.299 Test Acc: 0.870
Validation loss decreased (-0.862316 --> -0.869562).  Saving model ...
Epoch: 21 cost time: 1.8203504085540771
Epoch: 21, Steps: 9 | Train Loss: 0.148 Vali Loss: 0.279 Vali Acc: 0.884 Test Loss: 0.279 Test Acc: 0.884
Validation loss decreased (-0.869562 --> -0.884055).  Saving model ...
Epoch: 22 cost time: 1.7416656017303467
Epoch: 22, Steps: 9 | Train Loss: 0.132 Vali Loss: 0.262 Vali Acc: 0.906 Test Loss: 0.262 Test Acc: 0.906
Validation loss decreased (-0.884055 --> -0.905794).  Saving model ...
Epoch: 23 cost time: 1.7024562358856201
Epoch: 23, Steps: 9 | Train Loss: 0.120 Vali Loss: 0.255 Vali Acc: 0.899 Test Loss: 0.255 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.7049298286437988
Epoch: 24, Steps: 9 | Train Loss: 0.120 Vali Loss: 0.241 Vali Acc: 0.899 Test Loss: 0.241 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.7698979377746582
Epoch: 25, Steps: 9 | Train Loss: 0.120 Vali Loss: 0.227 Vali Acc: 0.920 Test Loss: 0.227 Test Acc: 0.920
Validation loss decreased (-0.905794 --> -0.920288).  Saving model ...
Epoch: 26 cost time: 1.608588695526123
Epoch: 26, Steps: 9 | Train Loss: 0.107 Vali Loss: 0.223 Vali Acc: 0.913 Test Loss: 0.223 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.8464136123657227
Epoch: 27, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.221 Vali Acc: 0.913 Test Loss: 0.221 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.8423717021942139
Epoch: 28, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.206 Vali Acc: 0.935 Test Loss: 0.206 Test Acc: 0.935
Validation loss decreased (-0.920288 --> -0.934781).  Saving model ...
Epoch: 29 cost time: 1.808701753616333
Epoch: 29, Steps: 9 | Train Loss: 0.080 Vali Loss: 0.210 Vali Acc: 0.913 Test Loss: 0.210 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.7130956649780273
Epoch: 30, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.198 Vali Acc: 0.942 Test Loss: 0.198 Test Acc: 0.942
Validation loss decreased (-0.934781 --> -0.942027).  Saving model ...
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9420289855072463
model parameter : 49916
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.3142623901367188
Epoch: 1, Steps: 9 | Train Loss: 1.467 Vali Loss: 1.437 Vali Acc: 0.275 Test Loss: 1.437 Test Acc: 0.275
Validation loss decreased (inf --> -0.275348).  Saving model ...
Epoch: 2 cost time: 1.6858034133911133
Epoch: 2, Steps: 9 | Train Loss: 1.395 Vali Loss: 1.344 Vali Acc: 0.406 Test Loss: 1.344 Test Acc: 0.406
Validation loss decreased (-0.275348 --> -0.405784).  Saving model ...
Epoch: 3 cost time: 1.457266092300415
Epoch: 3, Steps: 9 | Train Loss: 1.274 Vali Loss: 1.241 Vali Acc: 0.522 Test Loss: 1.241 Test Acc: 0.522
Validation loss decreased (-0.405784 --> -0.521727).  Saving model ...
Epoch: 4 cost time: 1.3421075344085693
Epoch: 4, Steps: 9 | Train Loss: 1.182 Vali Loss: 1.142 Vali Acc: 0.514 Test Loss: 1.142 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.510225772857666
Epoch: 5, Steps: 9 | Train Loss: 1.073 Vali Loss: 1.053 Vali Acc: 0.536 Test Loss: 1.053 Test Acc: 0.536
Validation loss decreased (-0.521727 --> -0.536221).  Saving model ...
Epoch: 6 cost time: 1.5513067245483398
Epoch: 6, Steps: 9 | Train Loss: 1.007 Vali Loss: 0.972 Vali Acc: 0.536 Test Loss: 0.972 Test Acc: 0.536
Validation loss decreased (-0.536221 --> -0.536222).  Saving model ...
Epoch: 7 cost time: 1.6142306327819824
Epoch: 7, Steps: 9 | Train Loss: 0.883 Vali Loss: 0.890 Vali Acc: 0.565 Test Loss: 0.890 Test Acc: 0.565
Validation loss decreased (-0.536222 --> -0.565208).  Saving model ...
Epoch: 8 cost time: 1.644028902053833
Epoch: 8, Steps: 9 | Train Loss: 0.822 Vali Loss: 0.814 Vali Acc: 0.652 Test Loss: 0.814 Test Acc: 0.652
Validation loss decreased (-0.565208 --> -0.652166).  Saving model ...
Epoch: 9 cost time: 1.6205694675445557
Epoch: 9, Steps: 9 | Train Loss: 0.733 Vali Loss: 0.749 Vali Acc: 0.732 Test Loss: 0.749 Test Acc: 0.732
Validation loss decreased (-0.652166 --> -0.731877).  Saving model ...
Epoch: 10 cost time: 1.4374141693115234
Epoch: 10, Steps: 9 | Train Loss: 0.629 Vali Loss: 0.698 Vali Acc: 0.768 Test Loss: 0.698 Test Acc: 0.768
Validation loss decreased (-0.731877 --> -0.768109).  Saving model ...
Epoch: 11 cost time: 1.4876046180725098
Epoch: 11, Steps: 9 | Train Loss: 0.569 Vali Loss: 0.632 Vali Acc: 0.761 Test Loss: 0.632 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3950817584991455
Epoch: 12, Steps: 9 | Train Loss: 0.524 Vali Loss: 0.588 Vali Acc: 0.775 Test Loss: 0.588 Test Acc: 0.775
Validation loss decreased (-0.768109 --> -0.775356).  Saving model ...
Epoch: 13 cost time: 1.4525277614593506
Epoch: 13, Steps: 9 | Train Loss: 0.446 Vali Loss: 0.550 Vali Acc: 0.775 Test Loss: 0.550 Test Acc: 0.775
Validation loss decreased (-0.775356 --> -0.775357).  Saving model ...
Epoch: 14 cost time: 1.3967339992523193
Epoch: 14, Steps: 9 | Train Loss: 0.425 Vali Loss: 0.508 Vali Acc: 0.797 Test Loss: 0.508 Test Acc: 0.797
Validation loss decreased (-0.775357 --> -0.797096).  Saving model ...
Epoch: 15 cost time: 1.4213578701019287
Epoch: 15, Steps: 9 | Train Loss: 0.387 Vali Loss: 0.479 Vali Acc: 0.826 Test Loss: 0.479 Test Acc: 0.826
Validation loss decreased (-0.797096 --> -0.826082).  Saving model ...
Epoch: 16 cost time: 1.4082510471343994
Epoch: 16, Steps: 9 | Train Loss: 0.308 Vali Loss: 0.441 Vali Acc: 0.819 Test Loss: 0.441 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4576241970062256
Epoch: 17, Steps: 9 | Train Loss: 0.290 Vali Loss: 0.458 Vali Acc: 0.819 Test Loss: 0.458 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.5525641441345215
Epoch: 18, Steps: 9 | Train Loss: 0.252 Vali Loss: 0.406 Vali Acc: 0.826 Test Loss: 0.406 Test Acc: 0.826
Validation loss decreased (-0.826082 --> -0.826083).  Saving model ...
Epoch: 19 cost time: 1.4669137001037598
Epoch: 19, Steps: 9 | Train Loss: 0.217 Vali Loss: 0.376 Vali Acc: 0.848 Test Loss: 0.376 Test Acc: 0.848
Validation loss decreased (-0.826083 --> -0.847822).  Saving model ...
Epoch: 20 cost time: 1.3359737396240234
Epoch: 20, Steps: 9 | Train Loss: 0.206 Vali Loss: 0.368 Vali Acc: 0.855 Test Loss: 0.368 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855069).  Saving model ...
Epoch: 21 cost time: 1.6465866565704346
Epoch: 21, Steps: 9 | Train Loss: 0.150 Vali Loss: 0.358 Vali Acc: 0.862 Test Loss: 0.358 Test Acc: 0.862
Validation loss decreased (-0.855069 --> -0.862315).  Saving model ...
Epoch: 22 cost time: 1.4070773124694824
Epoch: 22, Steps: 9 | Train Loss: 0.131 Vali Loss: 0.347 Vali Acc: 0.848 Test Loss: 0.347 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3982915878295898
Epoch: 23, Steps: 9 | Train Loss: 0.110 Vali Loss: 0.342 Vali Acc: 0.833 Test Loss: 0.342 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.418680191040039
Epoch: 24, Steps: 9 | Train Loss: 0.133 Vali Loss: 0.321 Vali Acc: 0.848 Test Loss: 0.321 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.3788869380950928
Epoch: 25, Steps: 9 | Train Loss: 0.111 Vali Loss: 0.325 Vali Acc: 0.848 Test Loss: 0.325 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.439621925354004
Epoch: 26, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.367 Vali Acc: 0.848 Test Loss: 0.367 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.457817554473877
Epoch: 27, Steps: 9 | Train Loss: 0.095 Vali Loss: 0.379 Vali Acc: 0.855 Test Loss: 0.379 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.585808277130127
Epoch: 28, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.346 Vali Acc: 0.862 Test Loss: 0.346 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 29 cost time: 1.5490877628326416
Epoch: 29, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.310 Vali Acc: 0.877 Test Loss: 0.310 Test Acc: 0.877
Validation loss decreased (-0.862315 --> -0.876808).  Saving model ...
Epoch: 30 cost time: 1.40378999710083
Epoch: 30, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.302 Vali Acc: 0.877 Test Loss: 0.302 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876809).  Saving model ...
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 153436
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.0620930194854736
Epoch: 1, Steps: 9 | Train Loss: 1.353 Vali Loss: 1.358 Vali Acc: 0.326 Test Loss: 1.358 Test Acc: 0.326
Validation loss decreased (inf --> -0.326073).  Saving model ...
Epoch: 2 cost time: 1.2200744152069092
Epoch: 2, Steps: 9 | Train Loss: 1.305 Vali Loss: 1.284 Vali Acc: 0.413 Test Loss: 1.284 Test Acc: 0.413
Validation loss decreased (-0.326073 --> -0.413031).  Saving model ...
Epoch: 3 cost time: 1.250542163848877
Epoch: 3, Steps: 9 | Train Loss: 1.236 Vali Loss: 1.193 Vali Acc: 0.543 Test Loss: 1.193 Test Acc: 0.543
Validation loss decreased (-0.413031 --> -0.543466).  Saving model ...
Epoch: 4 cost time: 1.2752652168273926
Epoch: 4, Steps: 9 | Train Loss: 1.129 Vali Loss: 1.107 Vali Acc: 0.558 Test Loss: 1.107 Test Acc: 0.558
Validation loss decreased (-0.543466 --> -0.557960).  Saving model ...
Epoch: 5 cost time: 1.136256217956543
Epoch: 5, Steps: 9 | Train Loss: 1.032 Vali Loss: 1.021 Vali Acc: 0.594 Test Loss: 1.021 Test Acc: 0.594
Validation loss decreased (-0.557960 --> -0.594193).  Saving model ...
Epoch: 6 cost time: 1.2587237358093262
Epoch: 6, Steps: 9 | Train Loss: 0.937 Vali Loss: 0.947 Vali Acc: 0.630 Test Loss: 0.947 Test Acc: 0.630
Validation loss decreased (-0.594193 --> -0.630425).  Saving model ...
Epoch: 7 cost time: 1.2700116634368896
Epoch: 7, Steps: 9 | Train Loss: 0.860 Vali Loss: 0.893 Vali Acc: 0.638 Test Loss: 0.893 Test Acc: 0.638
Validation loss decreased (-0.630425 --> -0.637672).  Saving model ...
Epoch: 8 cost time: 1.30257248878479
Epoch: 8, Steps: 9 | Train Loss: 0.798 Vali Loss: 0.836 Vali Acc: 0.645 Test Loss: 0.836 Test Acc: 0.645
Validation loss decreased (-0.637672 --> -0.644919).  Saving model ...
Epoch: 9 cost time: 1.312781572341919
Epoch: 9, Steps: 9 | Train Loss: 0.729 Vali Loss: 0.779 Vali Acc: 0.659 Test Loss: 0.779 Test Acc: 0.659
Validation loss decreased (-0.644919 --> -0.659413).  Saving model ...
Epoch: 10 cost time: 1.414759874343872
Epoch: 10, Steps: 9 | Train Loss: 0.625 Vali Loss: 0.734 Vali Acc: 0.659 Test Loss: 0.734 Test Acc: 0.659
Validation loss decreased (-0.659413 --> -0.659413).  Saving model ...
Epoch: 11 cost time: 1.3346776962280273
Epoch: 11, Steps: 9 | Train Loss: 0.580 Vali Loss: 0.686 Vali Acc: 0.703 Test Loss: 0.686 Test Acc: 0.703
Validation loss decreased (-0.659413 --> -0.702892).  Saving model ...
Epoch: 12 cost time: 1.3994395732879639
Epoch: 12, Steps: 9 | Train Loss: 0.528 Vali Loss: 0.635 Vali Acc: 0.739 Test Loss: 0.635 Test Acc: 0.739
Validation loss decreased (-0.702892 --> -0.739124).  Saving model ...
Epoch: 13 cost time: 1.3298444747924805
Epoch: 13, Steps: 9 | Train Loss: 0.465 Vali Loss: 0.592 Vali Acc: 0.761 Test Loss: 0.592 Test Acc: 0.761
Validation loss decreased (-0.739124 --> -0.760864).  Saving model ...
Epoch: 14 cost time: 1.3811473846435547
Epoch: 14, Steps: 9 | Train Loss: 0.402 Vali Loss: 0.551 Vali Acc: 0.790 Test Loss: 0.551 Test Acc: 0.790
Validation loss decreased (-0.760864 --> -0.789850).  Saving model ...
Epoch: 15 cost time: 1.3726975917816162
Epoch: 15, Steps: 9 | Train Loss: 0.362 Vali Loss: 0.514 Vali Acc: 0.797 Test Loss: 0.514 Test Acc: 0.797
Validation loss decreased (-0.789850 --> -0.797096).  Saving model ...
Epoch: 16 cost time: 1.2944576740264893
Epoch: 16, Steps: 9 | Train Loss: 0.338 Vali Loss: 0.478 Vali Acc: 0.812 Test Loss: 0.478 Test Acc: 0.812
Validation loss decreased (-0.797096 --> -0.811589).  Saving model ...
Epoch: 17 cost time: 1.4004745483398438
Epoch: 17, Steps: 9 | Train Loss: 0.288 Vali Loss: 0.437 Vali Acc: 0.848 Test Loss: 0.437 Test Acc: 0.848
Validation loss decreased (-0.811589 --> -0.847822).  Saving model ...
Epoch: 18 cost time: 1.423145055770874
Epoch: 18, Steps: 9 | Train Loss: 0.262 Vali Loss: 0.412 Vali Acc: 0.841 Test Loss: 0.412 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2702643871307373
Epoch: 19, Steps: 9 | Train Loss: 0.237 Vali Loss: 0.393 Vali Acc: 0.848 Test Loss: 0.393 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 20 cost time: 1.3197009563446045
Epoch: 20, Steps: 9 | Train Loss: 0.200 Vali Loss: 0.382 Vali Acc: 0.848 Test Loss: 0.382 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 21 cost time: 1.3390576839447021
Epoch: 21, Steps: 9 | Train Loss: 0.188 Vali Loss: 0.369 Vali Acc: 0.848 Test Loss: 0.369 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 22 cost time: 1.308946132659912
Epoch: 22, Steps: 9 | Train Loss: 0.157 Vali Loss: 0.359 Vali Acc: 0.855 Test Loss: 0.359 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855069).  Saving model ...
Epoch: 23 cost time: 1.2861404418945312
Epoch: 23, Steps: 9 | Train Loss: 0.159 Vali Loss: 0.347 Vali Acc: 0.870 Test Loss: 0.347 Test Acc: 0.870
Validation loss decreased (-0.855069 --> -0.869562).  Saving model ...
Epoch: 24 cost time: 1.2649056911468506
Epoch: 24, Steps: 9 | Train Loss: 0.154 Vali Loss: 0.326 Vali Acc: 0.877 Test Loss: 0.326 Test Acc: 0.877
Validation loss decreased (-0.869562 --> -0.876808).  Saving model ...
Epoch: 25 cost time: 1.2731971740722656
Epoch: 25, Steps: 9 | Train Loss: 0.124 Vali Loss: 0.322 Vali Acc: 0.877 Test Loss: 0.322 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 26 cost time: 1.2528231143951416
Epoch: 26, Steps: 9 | Train Loss: 0.132 Vali Loss: 0.317 Vali Acc: 0.870 Test Loss: 0.317 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.5858650207519531
Epoch: 27, Steps: 9 | Train Loss: 0.125 Vali Loss: 0.331 Vali Acc: 0.870 Test Loss: 0.331 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.5632174015045166
Epoch: 28, Steps: 9 | Train Loss: 0.098 Vali Loss: 0.299 Vali Acc: 0.870 Test Loss: 0.299 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.5685045719146729
Epoch: 29, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.288 Vali Acc: 0.877 Test Loss: 0.288 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876809).  Saving model ...
Epoch: 30 cost time: 1.5005543231964111
Epoch: 30, Steps: 9 | Train Loss: 0.098 Vali Loss: 0.291 Vali Acc: 0.877 Test Loss: 0.291 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_TimesNet_UEA_ftM_sl206_ll0_pl0_el2_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 49916
model size : 0.36MB
