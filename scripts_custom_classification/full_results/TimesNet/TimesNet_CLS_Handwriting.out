Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 32.90477657318115
Epoch: 1, Steps: 10 | Train Loss: 3.343 Vali Loss: 3.271 Vali Acc: 0.085 Test Loss: 3.271 Test Acc: 0.085
Validation loss decreased (inf --> -0.084673).  Saving model ...
Epoch: 2 cost time: 25.375977277755737
Epoch: 2, Steps: 10 | Train Loss: 2.781 Vali Loss: 3.191 Vali Acc: 0.134 Test Loss: 3.191 Test Acc: 0.134
Validation loss decreased (-0.084673 --> -0.134086).  Saving model ...
Epoch: 3 cost time: 34.135002851486206
Epoch: 3, Steps: 10 | Train Loss: 1.791 Vali Loss: 3.045 Vali Acc: 0.205 Test Loss: 3.045 Test Acc: 0.205
Validation loss decreased (-0.134086 --> -0.204675).  Saving model ...
Epoch: 4 cost time: 32.76601767539978
Epoch: 4, Steps: 10 | Train Loss: 1.178 Vali Loss: 3.079 Vali Acc: 0.209 Test Loss: 3.079 Test Acc: 0.209
Validation loss decreased (-0.204675 --> -0.209381).  Saving model ...
Epoch: 5 cost time: 33.49056792259216
Epoch: 5, Steps: 10 | Train Loss: 0.631 Vali Loss: 3.001 Vali Acc: 0.253 Test Loss: 3.001 Test Acc: 0.253
Validation loss decreased (-0.209381 --> -0.252911).  Saving model ...
Epoch: 6 cost time: 30.895143747329712
Epoch: 6, Steps: 10 | Train Loss: 0.322 Vali Loss: 3.119 Vali Acc: 0.296 Test Loss: 3.119 Test Acc: 0.296
Validation loss decreased (-0.252911 --> -0.296439).  Saving model ...
Epoch: 7 cost time: 30.58617377281189
Epoch: 7, Steps: 10 | Train Loss: 0.153 Vali Loss: 3.335 Vali Acc: 0.276 Test Loss: 3.335 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 33.34607768058777
Epoch: 8, Steps: 10 | Train Loss: 0.076 Vali Loss: 3.481 Vali Acc: 0.296 Test Loss: 3.481 Test Acc: 0.296
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 31.53402090072632
Epoch: 9, Steps: 10 | Train Loss: 0.085 Vali Loss: 3.511 Vali Acc: 0.296 Test Loss: 3.511 Test Acc: 0.296
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 29.73768138885498
Epoch: 10, Steps: 10 | Train Loss: 0.058 Vali Loss: 3.623 Vali Acc: 0.287 Test Loss: 3.623 Test Acc: 0.287
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 33.236058950424194
Epoch: 11, Steps: 10 | Train Loss: 0.109 Vali Loss: 3.455 Vali Acc: 0.291 Test Loss: 3.455 Test Acc: 0.291
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 31.816710472106934
Epoch: 12, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.622 Vali Acc: 0.296 Test Loss: 3.622 Test Acc: 0.296
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 29.295351266860962
Epoch: 13, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.642 Vali Acc: 0.298 Test Loss: 3.642 Test Acc: 0.298
Validation loss decreased (-0.296439 --> -0.297611).  Saving model ...
Epoch: 14 cost time: 32.22084307670593
Epoch: 14, Steps: 10 | Train Loss: 0.069 Vali Loss: 3.447 Vali Acc: 0.313 Test Loss: 3.447 Test Acc: 0.313
Validation loss decreased (-0.297611 --> -0.312907).  Saving model ...
Epoch: 15 cost time: 27.35867977142334
Epoch: 15, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.568 Vali Acc: 0.296 Test Loss: 3.568 Test Acc: 0.296
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 28.667718172073364
Epoch: 16, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.953 Vali Acc: 0.291 Test Loss: 3.953 Test Acc: 0.291
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 27.581920623779297
Epoch: 17, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.943 Vali Acc: 0.306 Test Loss: 3.943 Test Acc: 0.306
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 28.161054849624634
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.789 Vali Acc: 0.300 Test Loss: 3.789 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 32.31801986694336
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.876 Vali Acc: 0.289 Test Loss: 3.876 Test Acc: 0.289
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 33.16543126106262
Epoch: 20, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.923 Vali Acc: 0.304 Test Loss: 3.923 Test Acc: 0.304
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 31.17674469947815
Epoch: 21, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.886 Vali Acc: 0.288 Test Loss: 3.886 Test Acc: 0.288
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 32.803436040878296
Epoch: 22, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.787 Vali Acc: 0.288 Test Loss: 3.787 Test Acc: 0.288
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 28.923970460891724
Epoch: 23, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.326 Vali Acc: 0.261 Test Loss: 4.326 Test Acc: 0.261
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 29.598812341690063
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.989 Vali Acc: 0.309 Test Loss: 3.989 Test Acc: 0.309
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3129411764705882
model parameter : 75490202
model size : 290.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 11.33349084854126
Epoch: 1, Steps: 10 | Train Loss: 3.368 Vali Loss: 3.293 Vali Acc: 0.041 Test Loss: 3.293 Test Acc: 0.041
Validation loss decreased (inf --> -0.041144).  Saving model ...
Epoch: 2 cost time: 11.143292903900146
Epoch: 2, Steps: 10 | Train Loss: 2.855 Vali Loss: 3.314 Vali Acc: 0.131 Test Loss: 3.314 Test Acc: 0.131
Validation loss decreased (-0.041144 --> -0.130555).  Saving model ...
Epoch: 3 cost time: 10.980016708374023
Epoch: 3, Steps: 10 | Train Loss: 2.003 Vali Loss: 3.049 Vali Acc: 0.199 Test Loss: 3.049 Test Acc: 0.199
Validation loss decreased (-0.130555 --> -0.198793).  Saving model ...
Epoch: 4 cost time: 9.93919587135315
Epoch: 4, Steps: 10 | Train Loss: 1.159 Vali Loss: 3.006 Vali Acc: 0.221 Test Loss: 3.006 Test Acc: 0.221
Validation loss decreased (-0.198793 --> -0.221146).  Saving model ...
Epoch: 5 cost time: 9.580143213272095
Epoch: 5, Steps: 10 | Train Loss: 0.599 Vali Loss: 2.972 Vali Acc: 0.251 Test Loss: 2.972 Test Acc: 0.251
Validation loss decreased (-0.221146 --> -0.250559).  Saving model ...
Epoch: 6 cost time: 10.793382406234741
Epoch: 6, Steps: 10 | Train Loss: 0.250 Vali Loss: 3.217 Vali Acc: 0.261 Test Loss: 3.217 Test Acc: 0.261
Validation loss decreased (-0.250559 --> -0.261144).  Saving model ...
Epoch: 7 cost time: 9.066539287567139
Epoch: 7, Steps: 10 | Train Loss: 0.146 Vali Loss: 3.297 Vali Acc: 0.281 Test Loss: 3.297 Test Acc: 0.281
Validation loss decreased (-0.261144 --> -0.281144).  Saving model ...
Epoch: 8 cost time: 9.21877670288086
Epoch: 8, Steps: 10 | Train Loss: 0.118 Vali Loss: 3.249 Vali Acc: 0.305 Test Loss: 3.249 Test Acc: 0.305
Validation loss decreased (-0.281144 --> -0.304673).  Saving model ...
Epoch: 9 cost time: 9.607205629348755
Epoch: 9, Steps: 10 | Train Loss: 0.076 Vali Loss: 3.263 Vali Acc: 0.284 Test Loss: 3.263 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 8.013872861862183
Epoch: 10, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.410 Vali Acc: 0.298 Test Loss: 3.410 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 8.9448881149292
Epoch: 11, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.403 Vali Acc: 0.288 Test Loss: 3.403 Test Acc: 0.288
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 9.12253713607788
Epoch: 12, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.413 Vali Acc: 0.315 Test Loss: 3.413 Test Acc: 0.315
Validation loss decreased (-0.304673 --> -0.315260).  Saving model ...
Epoch: 13 cost time: 10.229184865951538
Epoch: 13, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.511 Vali Acc: 0.331 Test Loss: 3.511 Test Acc: 0.331
Validation loss decreased (-0.315260 --> -0.330553).  Saving model ...
Epoch: 14 cost time: 10.716272830963135
Epoch: 14, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.684 Vali Acc: 0.319 Test Loss: 3.684 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 10.09600281715393
Epoch: 15, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.524 Vali Acc: 0.306 Test Loss: 3.524 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 10.108324527740479
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.482 Vali Acc: 0.322 Test Loss: 3.482 Test Acc: 0.322
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 10.836374759674072
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.583 Vali Acc: 0.319 Test Loss: 3.583 Test Acc: 0.319
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 10.194691896438599
Epoch: 18, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.646 Vali Acc: 0.324 Test Loss: 3.646 Test Acc: 0.324
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 9.089235067367554
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.708 Vali Acc: 0.300 Test Loss: 3.708 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 10.375344514846802
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.565 Vali Acc: 0.326 Test Loss: 3.565 Test Acc: 0.326
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 10.533835887908936
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.592 Vali Acc: 0.331 Test Loss: 3.592 Test Acc: 0.331
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 9.474838972091675
Epoch: 22, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.733 Vali Acc: 0.324 Test Loss: 3.733 Test Acc: 0.324
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 9.975768327713013
Epoch: 23, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.928 Vali Acc: 0.295 Test Loss: 3.928 Test Acc: 0.295
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3305882352941176
model parameter : 22534042
model size : 88.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 21.735271215438843
Epoch: 1, Steps: 10 | Train Loss: 3.344 Vali Loss: 3.282 Vali Acc: 0.092 Test Loss: 3.282 Test Acc: 0.092
Validation loss decreased (inf --> -0.091732).  Saving model ...
Epoch: 2 cost time: 21.330878257751465
Epoch: 2, Steps: 10 | Train Loss: 2.823 Vali Loss: 3.214 Vali Acc: 0.131 Test Loss: 3.214 Test Acc: 0.131
Validation loss decreased (-0.091732 --> -0.130556).  Saving model ...
Epoch: 3 cost time: 20.226991176605225
Epoch: 3, Steps: 10 | Train Loss: 1.943 Vali Loss: 3.050 Vali Acc: 0.192 Test Loss: 3.050 Test Acc: 0.192
Validation loss decreased (-0.130556 --> -0.191734).  Saving model ...
Epoch: 4 cost time: 19.387850761413574
Epoch: 4, Steps: 10 | Train Loss: 1.319 Vali Loss: 3.052 Vali Acc: 0.222 Test Loss: 3.052 Test Acc: 0.222
Validation loss decreased (-0.191734 --> -0.222322).  Saving model ...
Epoch: 5 cost time: 19.028905630111694
Epoch: 5, Steps: 10 | Train Loss: 0.720 Vali Loss: 3.064 Vali Acc: 0.254 Test Loss: 3.064 Test Acc: 0.254
Validation loss decreased (-0.222322 --> -0.254087).  Saving model ...
Epoch: 6 cost time: 19.171668529510498
Epoch: 6, Steps: 10 | Train Loss: 0.449 Vali Loss: 3.224 Vali Acc: 0.266 Test Loss: 3.224 Test Acc: 0.266
Validation loss decreased (-0.254087 --> -0.265850).  Saving model ...
Epoch: 7 cost time: 19.922406911849976
Epoch: 7, Steps: 10 | Train Loss: 0.265 Vali Loss: 3.227 Vali Acc: 0.261 Test Loss: 3.227 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 19.388309717178345
Epoch: 8, Steps: 10 | Train Loss: 0.186 Vali Loss: 3.367 Vali Acc: 0.285 Test Loss: 3.367 Test Acc: 0.285
Validation loss decreased (-0.265850 --> -0.284672).  Saving model ...
Epoch: 9 cost time: 19.91959857940674
Epoch: 9, Steps: 10 | Train Loss: 0.082 Vali Loss: 3.521 Vali Acc: 0.295 Test Loss: 3.521 Test Acc: 0.295
Validation loss decreased (-0.284672 --> -0.295259).  Saving model ...
Epoch: 10 cost time: 19.180320262908936
Epoch: 10, Steps: 10 | Train Loss: 0.093 Vali Loss: 3.405 Vali Acc: 0.311 Test Loss: 3.405 Test Acc: 0.311
Validation loss decreased (-0.295259 --> -0.310554).  Saving model ...
Epoch: 11 cost time: 20.076590299606323
Epoch: 11, Steps: 10 | Train Loss: 0.075 Vali Loss: 3.773 Vali Acc: 0.293 Test Loss: 3.773 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 20.784400701522827
Epoch: 12, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.680 Vali Acc: 0.305 Test Loss: 3.680 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 21.173213481903076
Epoch: 13, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.618 Vali Acc: 0.315 Test Loss: 3.618 Test Acc: 0.315
Validation loss decreased (-0.310554 --> -0.315258).  Saving model ...
Epoch: 14 cost time: 17.753339529037476
Epoch: 14, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.642 Vali Acc: 0.316 Test Loss: 3.642 Test Acc: 0.316
Validation loss decreased (-0.315258 --> -0.316434).  Saving model ...
Epoch: 15 cost time: 20.390082359313965
Epoch: 15, Steps: 10 | Train Loss: 0.113 Vali Loss: 3.714 Vali Acc: 0.307 Test Loss: 3.714 Test Acc: 0.307
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 18.777658462524414
Epoch: 16, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.780 Vali Acc: 0.282 Test Loss: 3.780 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 20.304375886917114
Epoch: 17, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.832 Vali Acc: 0.298 Test Loss: 3.832 Test Acc: 0.298
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 20.806790113449097
Epoch: 18, Steps: 10 | Train Loss: 0.113 Vali Loss: 4.029 Vali Acc: 0.281 Test Loss: 4.029 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 19.83254909515381
Epoch: 19, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.295 Vali Acc: 0.261 Test Loss: 4.295 Test Acc: 0.261
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 19.490493059158325
Epoch: 20, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.127 Vali Acc: 0.304 Test Loss: 4.127 Test Acc: 0.304
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 20.739089965820312
Epoch: 21, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.262 Vali Acc: 0.262 Test Loss: 4.262 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 19.23083782196045
Epoch: 22, Steps: 10 | Train Loss: 0.054 Vali Loss: 4.035 Vali Acc: 0.301 Test Loss: 4.035 Test Acc: 0.301
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 18.601561307907104
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.143 Vali Acc: 0.289 Test Loss: 4.143 Test Acc: 0.289
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 18.94578981399536
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.177 Vali Acc: 0.294 Test Loss: 4.177 Test Acc: 0.294
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3164705882352941
model parameter : 75490202
model size : 290.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 8.041016578674316
Epoch: 1, Steps: 10 | Train Loss: 3.365 Vali Loss: 3.294 Vali Acc: 0.040 Test Loss: 3.294 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 6.937542200088501
Epoch: 2, Steps: 10 | Train Loss: 2.894 Vali Loss: 3.339 Vali Acc: 0.114 Test Loss: 3.339 Test Acc: 0.114
Validation loss decreased (-0.039967 --> -0.114084).  Saving model ...
Epoch: 3 cost time: 7.440172910690308
Epoch: 3, Steps: 10 | Train Loss: 2.143 Vali Loss: 3.060 Vali Acc: 0.194 Test Loss: 3.060 Test Acc: 0.194
Validation loss decreased (-0.114084 --> -0.194087).  Saving model ...
Epoch: 4 cost time: 7.268640995025635
Epoch: 4, Steps: 10 | Train Loss: 1.274 Vali Loss: 3.095 Vali Acc: 0.205 Test Loss: 3.095 Test Acc: 0.205
Validation loss decreased (-0.194087 --> -0.204675).  Saving model ...
Epoch: 5 cost time: 7.107328414916992
Epoch: 5, Steps: 10 | Train Loss: 0.899 Vali Loss: 2.990 Vali Acc: 0.232 Test Loss: 2.990 Test Acc: 0.232
Validation loss decreased (-0.204675 --> -0.231735).  Saving model ...
Epoch: 6 cost time: 5.6384782791137695
Epoch: 6, Steps: 10 | Train Loss: 0.458 Vali Loss: 3.214 Vali Acc: 0.276 Test Loss: 3.214 Test Acc: 0.276
Validation loss decreased (-0.231735 --> -0.276438).  Saving model ...
Epoch: 7 cost time: 6.191577196121216
Epoch: 7, Steps: 10 | Train Loss: 0.278 Vali Loss: 3.173 Vali Acc: 0.294 Test Loss: 3.173 Test Acc: 0.294
Validation loss decreased (-0.276438 --> -0.294086).  Saving model ...
Epoch: 8 cost time: 7.110195159912109
Epoch: 8, Steps: 10 | Train Loss: 0.156 Vali Loss: 3.217 Vali Acc: 0.298 Test Loss: 3.217 Test Acc: 0.298
Validation loss decreased (-0.294086 --> -0.297615).  Saving model ...
Epoch: 9 cost time: 6.401744842529297
Epoch: 9, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.710 Vali Acc: 0.275 Test Loss: 3.710 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.706744432449341
Epoch: 10, Steps: 10 | Train Loss: 0.059 Vali Loss: 3.375 Vali Acc: 0.319 Test Loss: 3.375 Test Acc: 0.319
Validation loss decreased (-0.297615 --> -0.318790).  Saving model ...
Epoch: 11 cost time: 6.168258428573608
Epoch: 11, Steps: 10 | Train Loss: 0.075 Vali Loss: 3.373 Vali Acc: 0.318 Test Loss: 3.373 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.016491174697876
Epoch: 12, Steps: 10 | Train Loss: 0.073 Vali Loss: 3.917 Vali Acc: 0.272 Test Loss: 3.917 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.120082139968872
Epoch: 13, Steps: 10 | Train Loss: 0.104 Vali Loss: 3.771 Vali Acc: 0.285 Test Loss: 3.771 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.3809967041015625
Epoch: 14, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.645 Vali Acc: 0.300 Test Loss: 3.645 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.0807044506073
Epoch: 15, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.628 Vali Acc: 0.289 Test Loss: 3.628 Test Acc: 0.289
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 6.163656234741211
Epoch: 16, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.912 Vali Acc: 0.279 Test Loss: 3.912 Test Acc: 0.279
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 7.037714719772339
Epoch: 17, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.681 Vali Acc: 0.293 Test Loss: 3.681 Test Acc: 0.293
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 7.531805992126465
Epoch: 18, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.852 Vali Acc: 0.304 Test Loss: 3.852 Test Acc: 0.304
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 6.3096208572387695
Epoch: 19, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.232 Vali Acc: 0.282 Test Loss: 4.232 Test Acc: 0.282
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 6.031665802001953
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.912 Vali Acc: 0.307 Test Loss: 3.912 Test Acc: 0.307
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.31882352941176473
model parameter : 22534042
model size : 88.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 14.397187948226929
Epoch: 1, Steps: 10 | Train Loss: 3.341 Vali Loss: 3.295 Vali Acc: 0.069 Test Loss: 3.295 Test Acc: 0.069
Validation loss decreased (inf --> -0.069379).  Saving model ...
Epoch: 2 cost time: 11.53679633140564
Epoch: 2, Steps: 10 | Train Loss: 2.909 Vali Loss: 3.274 Vali Acc: 0.122 Test Loss: 3.274 Test Acc: 0.122
Validation loss decreased (-0.069379 --> -0.122320).  Saving model ...
Epoch: 3 cost time: 12.180471181869507
Epoch: 3, Steps: 10 | Train Loss: 2.238 Vali Loss: 3.129 Vali Acc: 0.172 Test Loss: 3.129 Test Acc: 0.172
Validation loss decreased (-0.122320 --> -0.171733).  Saving model ...
Epoch: 4 cost time: 10.362942934036255
Epoch: 4, Steps: 10 | Train Loss: 1.621 Vali Loss: 3.212 Vali Acc: 0.185 Test Loss: 3.212 Test Acc: 0.185
Validation loss decreased (-0.171733 --> -0.184674).  Saving model ...
Epoch: 5 cost time: 9.092098951339722
Epoch: 5, Steps: 10 | Train Loss: 1.200 Vali Loss: 3.184 Vali Acc: 0.236 Test Loss: 3.184 Test Acc: 0.236
Validation loss decreased (-0.184674 --> -0.236439).  Saving model ...
Epoch: 6 cost time: 8.710390329360962
Epoch: 6, Steps: 10 | Train Loss: 0.576 Vali Loss: 3.118 Vali Acc: 0.280 Test Loss: 3.118 Test Acc: 0.280
Validation loss decreased (-0.236439 --> -0.279969).  Saving model ...
Epoch: 7 cost time: 8.643847227096558
Epoch: 7, Steps: 10 | Train Loss: 0.306 Vali Loss: 3.300 Vali Acc: 0.275 Test Loss: 3.300 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.56370210647583
Epoch: 8, Steps: 10 | Train Loss: 0.236 Vali Loss: 3.248 Vali Acc: 0.306 Test Loss: 3.248 Test Acc: 0.306
Validation loss decreased (-0.279969 --> -0.305850).  Saving model ...
Epoch: 9 cost time: 9.28921890258789
Epoch: 9, Steps: 10 | Train Loss: 0.134 Vali Loss: 3.404 Vali Acc: 0.286 Test Loss: 3.404 Test Acc: 0.286
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 10.822765588760376
Epoch: 10, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.751 Vali Acc: 0.269 Test Loss: 3.751 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 9.170808792114258
Epoch: 11, Steps: 10 | Train Loss: 0.120 Vali Loss: 3.565 Vali Acc: 0.300 Test Loss: 3.565 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 9.90345549583435
Epoch: 12, Steps: 10 | Train Loss: 0.076 Vali Loss: 3.558 Vali Acc: 0.306 Test Loss: 3.558 Test Acc: 0.306
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 9.644752025604248
Epoch: 13, Steps: 10 | Train Loss: 0.066 Vali Loss: 3.762 Vali Acc: 0.299 Test Loss: 3.762 Test Acc: 0.299
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 10.292749643325806
Epoch: 14, Steps: 10 | Train Loss: 0.082 Vali Loss: 3.931 Vali Acc: 0.288 Test Loss: 3.931 Test Acc: 0.288
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 10.032784938812256
Epoch: 15, Steps: 10 | Train Loss: 0.079 Vali Loss: 3.899 Vali Acc: 0.293 Test Loss: 3.899 Test Acc: 0.293
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 10.820889472961426
Epoch: 16, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.885 Vali Acc: 0.272 Test Loss: 3.885 Test Acc: 0.272
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 10.614733934402466
Epoch: 17, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.939 Vali Acc: 0.288 Test Loss: 3.939 Test Acc: 0.288
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 10.030625820159912
Epoch: 18, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.963 Vali Acc: 0.288 Test Loss: 3.963 Test Acc: 0.288
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3058823529411765
model parameter : 75490202
model size : 290.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 6.222675800323486
Epoch: 1, Steps: 10 | Train Loss: 3.366 Vali Loss: 3.308 Vali Acc: 0.042 Test Loss: 3.308 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 3.307054042816162
Epoch: 2, Steps: 10 | Train Loss: 2.974 Vali Loss: 3.379 Vali Acc: 0.096 Test Loss: 3.379 Test Acc: 0.096
Validation loss decreased (-0.042320 --> -0.096437).  Saving model ...
Epoch: 3 cost time: 4.079326629638672
Epoch: 3, Steps: 10 | Train Loss: 2.382 Vali Loss: 3.104 Vali Acc: 0.173 Test Loss: 3.104 Test Acc: 0.173
Validation loss decreased (-0.096437 --> -0.172910).  Saving model ...
Epoch: 4 cost time: 5.125869274139404
Epoch: 4, Steps: 10 | Train Loss: 1.590 Vali Loss: 3.074 Vali Acc: 0.206 Test Loss: 3.074 Test Acc: 0.206
Validation loss decreased (-0.172910 --> -0.205852).  Saving model ...
Epoch: 5 cost time: 4.568373680114746
Epoch: 5, Steps: 10 | Train Loss: 1.105 Vali Loss: 3.044 Vali Acc: 0.234 Test Loss: 3.044 Test Acc: 0.234
Validation loss decreased (-0.205852 --> -0.234087).  Saving model ...
Epoch: 6 cost time: 4.1331939697265625
Epoch: 6, Steps: 10 | Train Loss: 0.656 Vali Loss: 3.225 Vali Acc: 0.249 Test Loss: 3.225 Test Acc: 0.249
Validation loss decreased (-0.234087 --> -0.249380).  Saving model ...
Epoch: 7 cost time: 3.9175963401794434
Epoch: 7, Steps: 10 | Train Loss: 0.423 Vali Loss: 3.209 Vali Acc: 0.274 Test Loss: 3.209 Test Acc: 0.274
Validation loss decreased (-0.249380 --> -0.274086).  Saving model ...
Epoch: 8 cost time: 3.905428409576416
Epoch: 8, Steps: 10 | Train Loss: 0.227 Vali Loss: 3.141 Vali Acc: 0.294 Test Loss: 3.141 Test Acc: 0.294
Validation loss decreased (-0.274086 --> -0.294086).  Saving model ...
Epoch: 9 cost time: 3.835139274597168
Epoch: 9, Steps: 10 | Train Loss: 0.110 Vali Loss: 3.422 Vali Acc: 0.285 Test Loss: 3.422 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.2349166870117188
Epoch: 10, Steps: 10 | Train Loss: 0.096 Vali Loss: 3.330 Vali Acc: 0.295 Test Loss: 3.330 Test Acc: 0.295
Validation loss decreased (-0.294086 --> -0.295261).  Saving model ...
Epoch: 11 cost time: 4.057043552398682
Epoch: 11, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.465 Vali Acc: 0.321 Test Loss: 3.465 Test Acc: 0.321
Validation loss decreased (-0.295261 --> -0.321142).  Saving model ...
Epoch: 12 cost time: 3.8597018718719482
Epoch: 12, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.684 Vali Acc: 0.300 Test Loss: 3.684 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.198520660400391
Epoch: 13, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.717 Vali Acc: 0.305 Test Loss: 3.717 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.053023815155029
Epoch: 14, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.690 Vali Acc: 0.296 Test Loss: 3.690 Test Acc: 0.296
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.844602584838867
Epoch: 15, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.626 Vali Acc: 0.313 Test Loss: 3.626 Test Acc: 0.313
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.9752039909362793
Epoch: 16, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.791 Vali Acc: 0.305 Test Loss: 3.791 Test Acc: 0.305
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.189394474029541
Epoch: 17, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.062 Vali Acc: 0.279 Test Loss: 4.062 Test Acc: 0.279
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.908092737197876
Epoch: 18, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.766 Vali Acc: 0.301 Test Loss: 3.766 Test Acc: 0.301
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.4088783264160156
Epoch: 19, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.822 Vali Acc: 0.311 Test Loss: 3.822 Test Acc: 0.311
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.376150608062744
Epoch: 20, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.197 Vali Acc: 0.267 Test Loss: 4.197 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.8309078216552734
Epoch: 21, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.010 Vali Acc: 0.286 Test Loss: 4.010 Test Acc: 0.286
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3211764705882353
model parameter : 22534042
model size : 88.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 14.247762680053711
Epoch: 1, Steps: 10 | Train Loss: 3.298 Vali Loss: 3.251 Vali Acc: 0.086 Test Loss: 3.251 Test Acc: 0.086
Validation loss decreased (inf --> -0.085850).  Saving model ...
Epoch: 2 cost time: 17.451723098754883
Epoch: 2, Steps: 10 | Train Loss: 2.852 Vali Loss: 3.258 Vali Acc: 0.129 Test Loss: 3.258 Test Acc: 0.129
Validation loss decreased (-0.085850 --> -0.129379).  Saving model ...
Epoch: 3 cost time: 18.234496593475342
Epoch: 3, Steps: 10 | Train Loss: 1.991 Vali Loss: 3.023 Vali Acc: 0.194 Test Loss: 3.023 Test Acc: 0.194
Validation loss decreased (-0.129379 --> -0.194087).  Saving model ...
Epoch: 4 cost time: 17.97454309463501
Epoch: 4, Steps: 10 | Train Loss: 1.214 Vali Loss: 2.965 Vali Acc: 0.222 Test Loss: 2.965 Test Acc: 0.222
Validation loss decreased (-0.194087 --> -0.222323).  Saving model ...
Epoch: 5 cost time: 15.724252223968506
Epoch: 5, Steps: 10 | Train Loss: 0.635 Vali Loss: 3.048 Vali Acc: 0.252 Test Loss: 3.048 Test Acc: 0.252
Validation loss decreased (-0.222323 --> -0.251734).  Saving model ...
Epoch: 6 cost time: 15.172130823135376
Epoch: 6, Steps: 10 | Train Loss: 0.265 Vali Loss: 3.086 Vali Acc: 0.274 Test Loss: 3.086 Test Acc: 0.274
Validation loss decreased (-0.251734 --> -0.274087).  Saving model ...
Epoch: 7 cost time: 16.603934049606323
Epoch: 7, Steps: 10 | Train Loss: 0.120 Vali Loss: 3.311 Vali Acc: 0.292 Test Loss: 3.311 Test Acc: 0.292
Validation loss decreased (-0.274087 --> -0.291732).  Saving model ...
Epoch: 8 cost time: 19.245128393173218
Epoch: 8, Steps: 10 | Train Loss: 0.134 Vali Loss: 3.399 Vali Acc: 0.274 Test Loss: 3.399 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 18.45744514465332
Epoch: 9, Steps: 10 | Train Loss: 0.117 Vali Loss: 3.293 Vali Acc: 0.306 Test Loss: 3.293 Test Acc: 0.306
Validation loss decreased (-0.291732 --> -0.305849).  Saving model ...
Epoch: 10 cost time: 18.984811067581177
Epoch: 10, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.380 Vali Acc: 0.326 Test Loss: 3.380 Test Acc: 0.326
Validation loss decreased (-0.305849 --> -0.325849).  Saving model ...
Epoch: 11 cost time: 18.449007511138916
Epoch: 11, Steps: 10 | Train Loss: 0.063 Vali Loss: 3.507 Vali Acc: 0.316 Test Loss: 3.507 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 18.574710607528687
Epoch: 12, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.525 Vali Acc: 0.301 Test Loss: 3.525 Test Acc: 0.301
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 13.262828826904297
Epoch: 13, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.498 Vali Acc: 0.321 Test Loss: 3.498 Test Acc: 0.321
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 14.777099132537842
Epoch: 14, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.521 Vali Acc: 0.309 Test Loss: 3.521 Test Acc: 0.309
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 18.697508811950684
Epoch: 15, Steps: 10 | Train Loss: 0.059 Vali Loss: 3.622 Vali Acc: 0.315 Test Loss: 3.622 Test Acc: 0.315
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 16.859514236450195
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.669 Vali Acc: 0.311 Test Loss: 3.669 Test Acc: 0.311
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 17.102389097213745
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.680 Vali Acc: 0.315 Test Loss: 3.680 Test Acc: 0.315
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 16.977452278137207
Epoch: 18, Steps: 10 | Train Loss: 0.069 Vali Loss: 3.723 Vali Acc: 0.289 Test Loss: 3.723 Test Acc: 0.289
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 17.976975440979004
Epoch: 19, Steps: 10 | Train Loss: 0.096 Vali Loss: 3.828 Vali Acc: 0.287 Test Loss: 3.828 Test Acc: 0.287
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 18.56139302253723
Epoch: 20, Steps: 10 | Train Loss: 0.077 Vali Loss: 3.570 Vali Acc: 0.308 Test Loss: 3.570 Test Acc: 0.308
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.32588235294117646
model parameter : 38000538
model size : 147.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 8.9282066822052
Epoch: 1, Steps: 10 | Train Loss: 3.394 Vali Loss: 3.299 Vali Acc: 0.052 Test Loss: 3.299 Test Acc: 0.052
Validation loss decreased (inf --> -0.051732).  Saving model ...
Epoch: 2 cost time: 6.624959707260132
Epoch: 2, Steps: 10 | Train Loss: 2.898 Vali Loss: 3.329 Vali Acc: 0.125 Test Loss: 3.329 Test Acc: 0.125
Validation loss decreased (-0.051732 --> -0.124673).  Saving model ...
Epoch: 3 cost time: 6.089801549911499
Epoch: 3, Steps: 10 | Train Loss: 2.146 Vali Loss: 3.086 Vali Acc: 0.195 Test Loss: 3.086 Test Acc: 0.195
Validation loss decreased (-0.124673 --> -0.195263).  Saving model ...
Epoch: 4 cost time: 6.065741062164307
Epoch: 4, Steps: 10 | Train Loss: 1.351 Vali Loss: 3.005 Vali Acc: 0.235 Test Loss: 3.005 Test Acc: 0.235
Validation loss decreased (-0.195263 --> -0.235264).  Saving model ...
Epoch: 5 cost time: 6.120705604553223
Epoch: 5, Steps: 10 | Train Loss: 0.702 Vali Loss: 3.043 Vali Acc: 0.259 Test Loss: 3.043 Test Acc: 0.259
Validation loss decreased (-0.235264 --> -0.258793).  Saving model ...
Epoch: 6 cost time: 5.228314161300659
Epoch: 6, Steps: 10 | Train Loss: 0.345 Vali Loss: 3.036 Vali Acc: 0.294 Test Loss: 3.036 Test Acc: 0.294
Validation loss decreased (-0.258793 --> -0.294087).  Saving model ...
Epoch: 7 cost time: 6.67517876625061
Epoch: 7, Steps: 10 | Train Loss: 0.185 Vali Loss: 3.317 Vali Acc: 0.293 Test Loss: 3.317 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.777653217315674
Epoch: 8, Steps: 10 | Train Loss: 0.090 Vali Loss: 3.281 Vali Acc: 0.313 Test Loss: 3.281 Test Acc: 0.313
Validation loss decreased (-0.294087 --> -0.312908).  Saving model ...
Epoch: 9 cost time: 6.770179033279419
Epoch: 9, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.329 Vali Acc: 0.314 Test Loss: 3.329 Test Acc: 0.314
Validation loss decreased (-0.312908 --> -0.314084).  Saving model ...
Epoch: 10 cost time: 6.729332447052002
Epoch: 10, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.287 Vali Acc: 0.302 Test Loss: 3.287 Test Acc: 0.302
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.49737286567688
Epoch: 11, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.340 Vali Acc: 0.313 Test Loss: 3.340 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.453401327133179
Epoch: 12, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.532 Vali Acc: 0.332 Test Loss: 3.532 Test Acc: 0.332
Validation loss decreased (-0.314084 --> -0.331729).  Saving model ...
Epoch: 13 cost time: 5.424860715866089
Epoch: 13, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.687 Vali Acc: 0.305 Test Loss: 3.687 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.964813470840454
Epoch: 14, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.564 Vali Acc: 0.316 Test Loss: 3.564 Test Acc: 0.316
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.237829208374023
Epoch: 15, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.562 Vali Acc: 0.320 Test Loss: 3.562 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.963347911834717
Epoch: 16, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.922 Vali Acc: 0.286 Test Loss: 3.922 Test Acc: 0.286
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.994234323501587
Epoch: 17, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.731 Vali Acc: 0.311 Test Loss: 3.731 Test Acc: 0.311
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.205602645874023
Epoch: 18, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.664 Vali Acc: 0.338 Test Loss: 3.664 Test Acc: 0.338
Validation loss decreased (-0.331729 --> -0.337610).  Saving model ...
Epoch: 19 cost time: 6.2927327156066895
Epoch: 19, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.883 Vali Acc: 0.318 Test Loss: 3.883 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.3321850299835205
Epoch: 20, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.710 Vali Acc: 0.329 Test Loss: 3.710 Test Acc: 0.329
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.370006322860718
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.717 Vali Acc: 0.335 Test Loss: 3.717 Test Acc: 0.335
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 5.5672221183776855
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.723 Vali Acc: 0.341 Test Loss: 3.723 Test Acc: 0.341
Validation loss decreased (-0.337610 --> -0.341139).  Saving model ...
Epoch: 23 cost time: 4.431939601898193
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.732 Vali Acc: 0.353 Test Loss: 3.732 Test Acc: 0.353
Validation loss decreased (-0.341139 --> -0.352904).  Saving model ...
Epoch: 24 cost time: 6.884527206420898
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.742 Vali Acc: 0.347 Test Loss: 3.742 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 6.869799852371216
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.746 Vali Acc: 0.348 Test Loss: 3.746 Test Acc: 0.348
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 7.11780309677124
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.733 Vali Acc: 0.347 Test Loss: 3.733 Test Acc: 0.347
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 6.93161678314209
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.728 Vali Acc: 0.349 Test Loss: 3.728 Test Acc: 0.349
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 6.415460586547852
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.734 Vali Acc: 0.349 Test Loss: 3.734 Test Acc: 0.349
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 7.252639293670654
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.741 Vali Acc: 0.346 Test Loss: 3.741 Test Acc: 0.346
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 7.112666606903076
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 3.748 Vali Acc: 0.342 Test Loss: 3.748 Test Acc: 0.342
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.35294117647058826
model parameter : 11521946
model size : 46.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 13.197739839553833
Epoch: 1, Steps: 10 | Train Loss: 3.296 Vali Loss: 3.256 Vali Acc: 0.091 Test Loss: 3.256 Test Acc: 0.091
Validation loss decreased (inf --> -0.090556).  Saving model ...
Epoch: 2 cost time: 10.378772020339966
Epoch: 2, Steps: 10 | Train Loss: 2.888 Vali Loss: 3.285 Vali Acc: 0.115 Test Loss: 3.285 Test Acc: 0.115
Validation loss decreased (-0.090556 --> -0.115261).  Saving model ...
Epoch: 3 cost time: 10.075147151947021
Epoch: 3, Steps: 10 | Train Loss: 2.085 Vali Loss: 3.057 Vali Acc: 0.194 Test Loss: 3.057 Test Acc: 0.194
Validation loss decreased (-0.115261 --> -0.194087).  Saving model ...
Epoch: 4 cost time: 12.287575960159302
Epoch: 4, Steps: 10 | Train Loss: 1.348 Vali Loss: 3.043 Vali Acc: 0.225 Test Loss: 3.043 Test Acc: 0.225
Validation loss decreased (-0.194087 --> -0.224675).  Saving model ...
Epoch: 5 cost time: 12.33609938621521
Epoch: 5, Steps: 10 | Train Loss: 0.834 Vali Loss: 3.037 Vali Acc: 0.271 Test Loss: 3.037 Test Acc: 0.271
Validation loss decreased (-0.224675 --> -0.270558).  Saving model ...
Epoch: 6 cost time: 10.848695039749146
Epoch: 6, Steps: 10 | Train Loss: 0.423 Vali Loss: 3.186 Vali Acc: 0.264 Test Loss: 3.186 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 11.508880138397217
Epoch: 7, Steps: 10 | Train Loss: 0.262 Vali Loss: 3.263 Vali Acc: 0.289 Test Loss: 3.263 Test Acc: 0.289
Validation loss decreased (-0.270558 --> -0.289379).  Saving model ...
Epoch: 8 cost time: 11.426051616668701
Epoch: 8, Steps: 10 | Train Loss: 0.125 Vali Loss: 3.269 Vali Acc: 0.309 Test Loss: 3.269 Test Acc: 0.309
Validation loss decreased (-0.289379 --> -0.309379).  Saving model ...
Epoch: 9 cost time: 12.013474464416504
Epoch: 9, Steps: 10 | Train Loss: 0.129 Vali Loss: 3.404 Vali Acc: 0.299 Test Loss: 3.404 Test Acc: 0.299
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 10.548920154571533
Epoch: 10, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.368 Vali Acc: 0.332 Test Loss: 3.368 Test Acc: 0.332
Validation loss decreased (-0.309379 --> -0.331731).  Saving model ...
Epoch: 11 cost time: 10.894021987915039
Epoch: 11, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.466 Vali Acc: 0.314 Test Loss: 3.466 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 11.396695852279663
Epoch: 12, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.691 Vali Acc: 0.285 Test Loss: 3.691 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 11.409331560134888
Epoch: 13, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.771 Vali Acc: 0.302 Test Loss: 3.771 Test Acc: 0.302
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 11.259350538253784
Epoch: 14, Steps: 10 | Train Loss: 0.060 Vali Loss: 3.607 Vali Acc: 0.327 Test Loss: 3.607 Test Acc: 0.327
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 10.641043663024902
Epoch: 15, Steps: 10 | Train Loss: 0.063 Vali Loss: 3.813 Vali Acc: 0.304 Test Loss: 3.813 Test Acc: 0.304
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 10.141376733779907
Epoch: 16, Steps: 10 | Train Loss: 0.043 Vali Loss: 3.943 Vali Acc: 0.305 Test Loss: 3.943 Test Acc: 0.305
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 8.89309048652649
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.974 Vali Acc: 0.306 Test Loss: 3.974 Test Acc: 0.306
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 13.045912504196167
Epoch: 18, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.710 Vali Acc: 0.325 Test Loss: 3.710 Test Acc: 0.325
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 12.456607341766357
Epoch: 19, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.822 Vali Acc: 0.318 Test Loss: 3.822 Test Acc: 0.318
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 12.612678050994873
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.913 Vali Acc: 0.300 Test Loss: 3.913 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.33176470588235296
model parameter : 38000538
model size : 147.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.97959041595459
Epoch: 1, Steps: 10 | Train Loss: 3.374 Vali Loss: 3.302 Vali Acc: 0.053 Test Loss: 3.302 Test Acc: 0.053
Validation loss decreased (inf --> -0.052908).  Saving model ...
Epoch: 2 cost time: 3.9200921058654785
Epoch: 2, Steps: 10 | Train Loss: 2.920 Vali Loss: 3.353 Vali Acc: 0.115 Test Loss: 3.353 Test Acc: 0.115
Validation loss decreased (-0.052908 --> -0.115261).  Saving model ...
Epoch: 3 cost time: 4.49574089050293
Epoch: 3, Steps: 10 | Train Loss: 2.226 Vali Loss: 3.133 Vali Acc: 0.191 Test Loss: 3.133 Test Acc: 0.191
Validation loss decreased (-0.115261 --> -0.190557).  Saving model ...
Epoch: 4 cost time: 4.548643112182617
Epoch: 4, Steps: 10 | Train Loss: 1.512 Vali Loss: 3.048 Vali Acc: 0.229 Test Loss: 3.048 Test Acc: 0.229
Validation loss decreased (-0.190557 --> -0.229381).  Saving model ...
Epoch: 5 cost time: 4.623631000518799
Epoch: 5, Steps: 10 | Train Loss: 0.827 Vali Loss: 3.103 Vali Acc: 0.253 Test Loss: 3.103 Test Acc: 0.253
Validation loss decreased (-0.229381 --> -0.252910).  Saving model ...
Epoch: 6 cost time: 3.3275983333587646
Epoch: 6, Steps: 10 | Train Loss: 0.585 Vali Loss: 3.044 Vali Acc: 0.294 Test Loss: 3.044 Test Acc: 0.294
Validation loss decreased (-0.252910 --> -0.294087).  Saving model ...
Epoch: 7 cost time: 4.703980445861816
Epoch: 7, Steps: 10 | Train Loss: 0.310 Vali Loss: 3.316 Vali Acc: 0.261 Test Loss: 3.316 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.808135271072388
Epoch: 8, Steps: 10 | Train Loss: 0.169 Vali Loss: 3.276 Vali Acc: 0.287 Test Loss: 3.276 Test Acc: 0.287
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.429195165634155
Epoch: 9, Steps: 10 | Train Loss: 0.182 Vali Loss: 3.485 Vali Acc: 0.306 Test Loss: 3.485 Test Acc: 0.306
Validation loss decreased (-0.294087 --> -0.305848).  Saving model ...
Epoch: 10 cost time: 4.658228158950806
Epoch: 10, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.409 Vali Acc: 0.321 Test Loss: 3.409 Test Acc: 0.321
Validation loss decreased (-0.305848 --> -0.321142).  Saving model ...
Epoch: 11 cost time: 3.402501344680786
Epoch: 11, Steps: 10 | Train Loss: 0.099 Vali Loss: 3.612 Vali Acc: 0.301 Test Loss: 3.612 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.3349239826202393
Epoch: 12, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.647 Vali Acc: 0.315 Test Loss: 3.647 Test Acc: 0.315
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.046176195144653
Epoch: 13, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.565 Vali Acc: 0.321 Test Loss: 3.565 Test Acc: 0.321
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.836817741394043
Epoch: 14, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.741 Vali Acc: 0.311 Test Loss: 3.741 Test Acc: 0.311
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.7760119438171387
Epoch: 15, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.892 Vali Acc: 0.306 Test Loss: 3.892 Test Acc: 0.306
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.417443752288818
Epoch: 16, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.757 Vali Acc: 0.327 Test Loss: 3.757 Test Acc: 0.327
Validation loss decreased (-0.321142 --> -0.327021).  Saving model ...
Epoch: 17 cost time: 4.130829334259033
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.743 Vali Acc: 0.326 Test Loss: 3.743 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.352749586105347
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.737 Vali Acc: 0.334 Test Loss: 3.737 Test Acc: 0.334
Validation loss decreased (-0.327021 --> -0.334080).  Saving model ...
Epoch: 19 cost time: 4.666052579879761
Epoch: 19, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.903 Vali Acc: 0.314 Test Loss: 3.903 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.347032070159912
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.869 Vali Acc: 0.331 Test Loss: 3.869 Test Acc: 0.331
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.10425591468811
Epoch: 21, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.778 Vali Acc: 0.347 Test Loss: 3.778 Test Acc: 0.347
Validation loss decreased (-0.334080 --> -0.347021).  Saving model ...
Epoch: 22 cost time: 3.349550485610962
Epoch: 22, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.039 Vali Acc: 0.325 Test Loss: 4.039 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.320216178894043
Epoch: 23, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.937 Vali Acc: 0.313 Test Loss: 3.937 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.3513875007629395
Epoch: 24, Steps: 10 | Train Loss: 0.242 Vali Loss: 4.434 Vali Acc: 0.265 Test Loss: 4.434 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 4.688831806182861
Epoch: 25, Steps: 10 | Train Loss: 0.120 Vali Loss: 4.279 Vali Acc: 0.275 Test Loss: 4.279 Test Acc: 0.275
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 4.204874277114868
Epoch: 26, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.269 Vali Acc: 0.295 Test Loss: 4.269 Test Acc: 0.295
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.274467706680298
Epoch: 27, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.041 Vali Acc: 0.313 Test Loss: 4.041 Test Acc: 0.313
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 4.199627161026001
Epoch: 28, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.168 Vali Acc: 0.304 Test Loss: 4.168 Test Acc: 0.304
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 4.563978672027588
Epoch: 29, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.185 Vali Acc: 0.311 Test Loss: 4.185 Test Acc: 0.311
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 4.039825916290283
Epoch: 30, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.380 Vali Acc: 0.294 Test Loss: 4.380 Test Acc: 0.294
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.34705882352941175
model parameter : 11521946
model size : 46.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 8.706428289413452
Epoch: 1, Steps: 10 | Train Loss: 3.295 Vali Loss: 3.263 Vali Acc: 0.085 Test Loss: 3.263 Test Acc: 0.085
Validation loss decreased (inf --> -0.084673).  Saving model ...
Epoch: 2 cost time: 7.010254383087158
Epoch: 2, Steps: 10 | Train Loss: 2.932 Vali Loss: 3.326 Vali Acc: 0.107 Test Loss: 3.326 Test Acc: 0.107
Validation loss decreased (-0.084673 --> -0.107026).  Saving model ...
Epoch: 3 cost time: 7.0441200733184814
Epoch: 3, Steps: 10 | Train Loss: 2.250 Vali Loss: 3.107 Vali Acc: 0.167 Test Loss: 3.107 Test Acc: 0.167
Validation loss decreased (-0.107026 --> -0.167028).  Saving model ...
Epoch: 4 cost time: 6.281758785247803
Epoch: 4, Steps: 10 | Train Loss: 1.542 Vali Loss: 3.116 Vali Acc: 0.188 Test Loss: 3.116 Test Acc: 0.188
Validation loss decreased (-0.167028 --> -0.188204).  Saving model ...
Epoch: 5 cost time: 5.3720457553863525
Epoch: 5, Steps: 10 | Train Loss: 1.049 Vali Loss: 3.197 Vali Acc: 0.234 Test Loss: 3.197 Test Acc: 0.234
Validation loss decreased (-0.188204 --> -0.234086).  Saving model ...
Epoch: 6 cost time: 4.117775917053223
Epoch: 6, Steps: 10 | Train Loss: 0.413 Vali Loss: 3.259 Vali Acc: 0.234 Test Loss: 3.259 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.5347933769226074
Epoch: 7, Steps: 10 | Train Loss: 0.232 Vali Loss: 3.163 Vali Acc: 0.292 Test Loss: 3.163 Test Acc: 0.292
Validation loss decreased (-0.234086 --> -0.291733).  Saving model ...
Epoch: 8 cost time: 4.636422395706177
Epoch: 8, Steps: 10 | Train Loss: 0.151 Vali Loss: 3.399 Vali Acc: 0.275 Test Loss: 3.399 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.778027534484863
Epoch: 9, Steps: 10 | Train Loss: 0.162 Vali Loss: 3.294 Vali Acc: 0.296 Test Loss: 3.294 Test Acc: 0.296
Validation loss decreased (-0.291733 --> -0.296438).  Saving model ...
Epoch: 10 cost time: 5.303679943084717
Epoch: 10, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.348 Vali Acc: 0.288 Test Loss: 3.348 Test Acc: 0.288
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.611313104629517
Epoch: 11, Steps: 10 | Train Loss: 0.070 Vali Loss: 3.620 Vali Acc: 0.304 Test Loss: 3.620 Test Acc: 0.304
Validation loss decreased (-0.296438 --> -0.303493).  Saving model ...
Epoch: 12 cost time: 6.4321160316467285
Epoch: 12, Steps: 10 | Train Loss: 0.078 Vali Loss: 3.565 Vali Acc: 0.299 Test Loss: 3.565 Test Acc: 0.299
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.681110382080078
Epoch: 13, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.684 Vali Acc: 0.304 Test Loss: 3.684 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.974086046218872
Epoch: 14, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.870 Vali Acc: 0.302 Test Loss: 3.870 Test Acc: 0.302
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.10425066947937
Epoch: 15, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.666 Vali Acc: 0.322 Test Loss: 3.666 Test Acc: 0.322
Validation loss decreased (-0.303493 --> -0.322316).  Saving model ...
Epoch: 16 cost time: 6.118979215621948
Epoch: 16, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.705 Vali Acc: 0.321 Test Loss: 3.705 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.9133219718933105
Epoch: 17, Steps: 10 | Train Loss: 0.054 Vali Loss: 4.013 Vali Acc: 0.316 Test Loss: 4.013 Test Acc: 0.316
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.191125869750977
Epoch: 18, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.949 Vali Acc: 0.325 Test Loss: 3.949 Test Acc: 0.325
Validation loss decreased (-0.322316 --> -0.324666).  Saving model ...
Epoch: 19 cost time: 5.639333248138428
Epoch: 19, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.009 Vali Acc: 0.324 Test Loss: 4.009 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.266586780548096
Epoch: 20, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.809 Vali Acc: 0.327 Test Loss: 3.809 Test Acc: 0.327
Validation loss decreased (-0.324666 --> -0.327021).  Saving model ...
Epoch: 21 cost time: 6.066002607345581
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.836 Vali Acc: 0.322 Test Loss: 3.836 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.008410215377808
Epoch: 22, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.968 Vali Acc: 0.314 Test Loss: 3.968 Test Acc: 0.314
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 6.658684492111206
Epoch: 23, Steps: 10 | Train Loss: 0.075 Vali Loss: 4.061 Vali Acc: 0.307 Test Loss: 4.061 Test Acc: 0.307
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 5.556125640869141
Epoch: 24, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.426 Vali Acc: 0.274 Test Loss: 4.426 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 6.4930055141448975
Epoch: 25, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.837 Vali Acc: 0.313 Test Loss: 3.837 Test Acc: 0.313
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 5.459695816040039
Epoch: 26, Steps: 10 | Train Loss: 0.078 Vali Loss: 4.261 Vali Acc: 0.289 Test Loss: 4.261 Test Acc: 0.289
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 6.022118330001831
Epoch: 27, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.564 Vali Acc: 0.273 Test Loss: 4.564 Test Acc: 0.273
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 5.654600620269775
Epoch: 28, Steps: 10 | Train Loss: 0.074 Vali Loss: 4.808 Vali Acc: 0.264 Test Loss: 4.808 Test Acc: 0.264
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 4.162514686584473
Epoch: 29, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.496 Vali Acc: 0.284 Test Loss: 4.496 Test Acc: 0.284
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 4.757938861846924
Epoch: 30, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.418 Vali Acc: 0.289 Test Loss: 4.418 Test Acc: 0.289
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3270588235294118
model parameter : 38000538
model size : 147.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.313144207000732
Epoch: 1, Steps: 10 | Train Loss: 3.388 Vali Loss: 3.307 Vali Acc: 0.064 Test Loss: 3.307 Test Acc: 0.064
Validation loss decreased (inf --> -0.063496).  Saving model ...
Epoch: 2 cost time: 2.564619541168213
Epoch: 2, Steps: 10 | Train Loss: 2.983 Vali Loss: 3.379 Vali Acc: 0.119 Test Loss: 3.379 Test Acc: 0.119
Validation loss decreased (-0.063496 --> -0.118790).  Saving model ...
Epoch: 3 cost time: 2.070948362350464
Epoch: 3, Steps: 10 | Train Loss: 2.362 Vali Loss: 3.170 Vali Acc: 0.180 Test Loss: 3.170 Test Acc: 0.180
Validation loss decreased (-0.118790 --> -0.179968).  Saving model ...
Epoch: 4 cost time: 3.055392265319824
Epoch: 4, Steps: 10 | Train Loss: 1.708 Vali Loss: 3.077 Vali Acc: 0.224 Test Loss: 3.077 Test Acc: 0.224
Validation loss decreased (-0.179968 --> -0.223499).  Saving model ...
Epoch: 5 cost time: 3.107642412185669
Epoch: 5, Steps: 10 | Train Loss: 1.075 Vali Loss: 3.170 Vali Acc: 0.227 Test Loss: 3.170 Test Acc: 0.227
Validation loss decreased (-0.223499 --> -0.227027).  Saving model ...
Epoch: 6 cost time: 2.9575254917144775
Epoch: 6, Steps: 10 | Train Loss: 0.809 Vali Loss: 3.107 Vali Acc: 0.267 Test Loss: 3.107 Test Acc: 0.267
Validation loss decreased (-0.227027 --> -0.267028).  Saving model ...
Epoch: 7 cost time: 2.9081215858459473
Epoch: 7, Steps: 10 | Train Loss: 0.426 Vali Loss: 3.256 Vali Acc: 0.284 Test Loss: 3.256 Test Acc: 0.284
Validation loss decreased (-0.267028 --> -0.283497).  Saving model ...
Epoch: 8 cost time: 2.317422389984131
Epoch: 8, Steps: 10 | Train Loss: 0.272 Vali Loss: 3.378 Vali Acc: 0.296 Test Loss: 3.378 Test Acc: 0.296
Validation loss decreased (-0.283497 --> -0.296437).  Saving model ...
Epoch: 9 cost time: 2.6077117919921875
Epoch: 9, Steps: 10 | Train Loss: 0.169 Vali Loss: 3.501 Vali Acc: 0.278 Test Loss: 3.501 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.2918810844421387
Epoch: 10, Steps: 10 | Train Loss: 0.131 Vali Loss: 3.548 Vali Acc: 0.286 Test Loss: 3.548 Test Acc: 0.286
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.754493236541748
Epoch: 11, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.491 Vali Acc: 0.313 Test Loss: 3.491 Test Acc: 0.313
Validation loss decreased (-0.296437 --> -0.312906).  Saving model ...
Epoch: 12 cost time: 2.8737144470214844
Epoch: 12, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.601 Vali Acc: 0.301 Test Loss: 3.601 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.019803285598755
Epoch: 13, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.618 Vali Acc: 0.306 Test Loss: 3.618 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.0076661109924316
Epoch: 14, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.745 Vali Acc: 0.302 Test Loss: 3.745 Test Acc: 0.302
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.258028030395508
Epoch: 15, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.647 Vali Acc: 0.314 Test Loss: 3.647 Test Acc: 0.314
Validation loss decreased (-0.312906 --> -0.314081).  Saving model ...
Epoch: 16 cost time: 2.229849100112915
Epoch: 16, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.837 Vali Acc: 0.306 Test Loss: 3.837 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.6304101943969727
Epoch: 17, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.007 Vali Acc: 0.295 Test Loss: 4.007 Test Acc: 0.295
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.8226287364959717
Epoch: 18, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.973 Vali Acc: 0.320 Test Loss: 3.973 Test Acc: 0.320
Validation loss decreased (-0.314081 --> -0.319960).  Saving model ...
Epoch: 19 cost time: 2.323601007461548
Epoch: 19, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.131 Vali Acc: 0.288 Test Loss: 4.131 Test Acc: 0.288
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.2377336025238037
Epoch: 20, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.930 Vali Acc: 0.311 Test Loss: 3.930 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.5126969814300537
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.873 Vali Acc: 0.329 Test Loss: 3.873 Test Acc: 0.329
Validation loss decreased (-0.319960 --> -0.329373).  Saving model ...
Epoch: 22 cost time: 2.1402759552001953
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.026 Vali Acc: 0.307 Test Loss: 4.026 Test Acc: 0.307
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.035290002822876
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.016 Vali Acc: 0.308 Test Loss: 4.016 Test Acc: 0.308
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.9702951908111572
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.875 Vali Acc: 0.328 Test Loss: 3.875 Test Acc: 0.328
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.3463704586029053
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.921 Vali Acc: 0.331 Test Loss: 3.921 Test Acc: 0.331
Validation loss decreased (-0.329373 --> -0.330549).  Saving model ...
Epoch: 26 cost time: 2.4546167850494385
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.952 Vali Acc: 0.336 Test Loss: 3.952 Test Acc: 0.336
Validation loss decreased (-0.330549 --> -0.336431).  Saving model ...
Epoch: 27 cost time: 2.9694948196411133
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.937 Vali Acc: 0.339 Test Loss: 3.937 Test Acc: 0.339
Validation loss decreased (-0.336431 --> -0.338784).  Saving model ...
Epoch: 28 cost time: 2.614910364151001
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.288 Vali Acc: 0.299 Test Loss: 4.288 Test Acc: 0.299
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.2133629322052
Epoch: 29, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.194 Vali Acc: 0.307 Test Loss: 4.194 Test Acc: 0.307
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.484149217605591
Epoch: 30, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.139 Vali Acc: 0.315 Test Loss: 4.139 Test Acc: 0.315
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3388235294117647
model parameter : 11521946
model size : 46.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 14.246851682662964
Epoch: 1, Steps: 10 | Train Loss: 3.400 Vali Loss: 3.275 Vali Acc: 0.046 Test Loss: 3.275 Test Acc: 0.046
Validation loss decreased (inf --> -0.045850).  Saving model ...
Epoch: 2 cost time: 16.68626356124878
Epoch: 2, Steps: 10 | Train Loss: 2.950 Vali Loss: 3.252 Vali Acc: 0.107 Test Loss: 3.252 Test Acc: 0.107
Validation loss decreased (-0.045850 --> -0.107026).  Saving model ...
Epoch: 3 cost time: 15.776450157165527
Epoch: 3, Steps: 10 | Train Loss: 2.295 Vali Loss: 3.126 Vali Acc: 0.162 Test Loss: 3.126 Test Acc: 0.162
Validation loss decreased (-0.107026 --> -0.162322).  Saving model ...
Epoch: 4 cost time: 13.122954845428467
Epoch: 4, Steps: 10 | Train Loss: 1.702 Vali Loss: 3.105 Vali Acc: 0.171 Test Loss: 3.105 Test Acc: 0.171
Validation loss decreased (-0.162322 --> -0.170557).  Saving model ...
Epoch: 5 cost time: 13.758508205413818
Epoch: 5, Steps: 10 | Train Loss: 1.166 Vali Loss: 3.056 Vali Acc: 0.206 Test Loss: 3.056 Test Acc: 0.206
Validation loss decreased (-0.170557 --> -0.205852).  Saving model ...
Epoch: 6 cost time: 15.264862775802612
Epoch: 6, Steps: 10 | Train Loss: 0.759 Vali Loss: 2.968 Vali Acc: 0.267 Test Loss: 2.968 Test Acc: 0.267
Validation loss decreased (-0.205852 --> -0.267029).  Saving model ...
Epoch: 7 cost time: 12.802728652954102
Epoch: 7, Steps: 10 | Train Loss: 0.472 Vali Loss: 2.999 Vali Acc: 0.258 Test Loss: 2.999 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 14.262542247772217
Epoch: 8, Steps: 10 | Train Loss: 0.299 Vali Loss: 3.062 Vali Acc: 0.284 Test Loss: 3.062 Test Acc: 0.284
Validation loss decreased (-0.267029 --> -0.283499).  Saving model ...
Epoch: 9 cost time: 15.327886819839478
Epoch: 9, Steps: 10 | Train Loss: 0.137 Vali Loss: 3.017 Vali Acc: 0.289 Test Loss: 3.017 Test Acc: 0.289
Validation loss decreased (-0.283499 --> -0.289382).  Saving model ...
Epoch: 10 cost time: 14.387513637542725
Epoch: 10, Steps: 10 | Train Loss: 0.113 Vali Loss: 3.094 Vali Acc: 0.309 Test Loss: 3.094 Test Acc: 0.309
Validation loss decreased (-0.289382 --> -0.309381).  Saving model ...
Epoch: 11 cost time: 13.22927188873291
Epoch: 11, Steps: 10 | Train Loss: 0.091 Vali Loss: 3.008 Vali Acc: 0.319 Test Loss: 3.008 Test Acc: 0.319
Validation loss decreased (-0.309381 --> -0.318793).  Saving model ...
Epoch: 12 cost time: 13.34787654876709
Epoch: 12, Steps: 10 | Train Loss: 0.067 Vali Loss: 3.167 Vali Acc: 0.280 Test Loss: 3.167 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 13.441850662231445
Epoch: 13, Steps: 10 | Train Loss: 0.043 Vali Loss: 3.417 Vali Acc: 0.282 Test Loss: 3.417 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 12.791808128356934
Epoch: 14, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.308 Vali Acc: 0.301 Test Loss: 3.308 Test Acc: 0.301
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 13.217768907546997
Epoch: 15, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.189 Vali Acc: 0.314 Test Loss: 3.189 Test Acc: 0.314
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 14.01085877418518
Epoch: 16, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.376 Vali Acc: 0.288 Test Loss: 3.376 Test Acc: 0.288
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 16.710718154907227
Epoch: 17, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.495 Vali Acc: 0.267 Test Loss: 3.495 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 14.518041372299194
Epoch: 18, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.440 Vali Acc: 0.296 Test Loss: 3.440 Test Acc: 0.296
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 13.198565006256104
Epoch: 19, Steps: 10 | Train Loss: 0.060 Vali Loss: 3.430 Vali Acc: 0.302 Test Loss: 3.430 Test Acc: 0.302
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 14.889975786209106
Epoch: 20, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.364 Vali Acc: 0.302 Test Loss: 3.364 Test Acc: 0.302
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 15.33717393875122
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.384 Vali Acc: 0.305 Test Loss: 3.384 Test Acc: 0.305
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.31882352941176473
model parameter : 37748186
model size : 145.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 7.139955282211304
Epoch: 1, Steps: 10 | Train Loss: 3.259 Vali Loss: 3.263 Vali Acc: 0.054 Test Loss: 3.263 Test Acc: 0.054
Validation loss decreased (inf --> -0.054085).  Saving model ...
Epoch: 2 cost time: 5.363735198974609
Epoch: 2, Steps: 10 | Train Loss: 2.921 Vali Loss: 3.261 Vali Acc: 0.105 Test Loss: 3.261 Test Acc: 0.105
Validation loss decreased (-0.054085 --> -0.104673).  Saving model ...
Epoch: 3 cost time: 4.895387649536133
Epoch: 3, Steps: 10 | Train Loss: 2.450 Vali Loss: 3.141 Vali Acc: 0.155 Test Loss: 3.141 Test Acc: 0.155
Validation loss decreased (-0.104673 --> -0.155263).  Saving model ...
Epoch: 4 cost time: 5.800310373306274
Epoch: 4, Steps: 10 | Train Loss: 1.887 Vali Loss: 2.996 Vali Acc: 0.212 Test Loss: 2.996 Test Acc: 0.212
Validation loss decreased (-0.155263 --> -0.211735).  Saving model ...
Epoch: 5 cost time: 6.070509195327759
Epoch: 5, Steps: 10 | Train Loss: 1.311 Vali Loss: 2.958 Vali Acc: 0.209 Test Loss: 2.958 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.536861419677734
Epoch: 6, Steps: 10 | Train Loss: 0.957 Vali Loss: 2.909 Vali Acc: 0.247 Test Loss: 2.909 Test Acc: 0.247
Validation loss decreased (-0.211735 --> -0.247030).  Saving model ...
Epoch: 7 cost time: 6.3625288009643555
Epoch: 7, Steps: 10 | Train Loss: 0.528 Vali Loss: 2.932 Vali Acc: 0.274 Test Loss: 2.932 Test Acc: 0.274
Validation loss decreased (-0.247030 --> -0.274088).  Saving model ...
Epoch: 8 cost time: 5.237421989440918
Epoch: 8, Steps: 10 | Train Loss: 0.305 Vali Loss: 2.901 Vali Acc: 0.319 Test Loss: 2.901 Test Acc: 0.319
Validation loss decreased (-0.274088 --> -0.318795).  Saving model ...
Epoch: 9 cost time: 5.732369899749756
Epoch: 9, Steps: 10 | Train Loss: 0.196 Vali Loss: 3.047 Vali Acc: 0.286 Test Loss: 3.047 Test Acc: 0.286
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.367457628250122
Epoch: 10, Steps: 10 | Train Loss: 0.128 Vali Loss: 3.012 Vali Acc: 0.314 Test Loss: 3.012 Test Acc: 0.314
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.50310754776001
Epoch: 11, Steps: 10 | Train Loss: 0.092 Vali Loss: 3.199 Vali Acc: 0.294 Test Loss: 3.199 Test Acc: 0.294
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.082881212234497
Epoch: 12, Steps: 10 | Train Loss: 0.070 Vali Loss: 3.075 Vali Acc: 0.313 Test Loss: 3.075 Test Acc: 0.313
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.318991422653198
Epoch: 13, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.181 Vali Acc: 0.321 Test Loss: 3.181 Test Acc: 0.321
Validation loss decreased (-0.318795 --> -0.321145).  Saving model ...
Epoch: 14 cost time: 5.742269039154053
Epoch: 14, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.237 Vali Acc: 0.328 Test Loss: 3.237 Test Acc: 0.328
Validation loss decreased (-0.321145 --> -0.328203).  Saving model ...
Epoch: 15 cost time: 5.59482479095459
Epoch: 15, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.192 Vali Acc: 0.336 Test Loss: 3.192 Test Acc: 0.336
Validation loss decreased (-0.328203 --> -0.336439).  Saving model ...
Epoch: 16 cost time: 5.923439025878906
Epoch: 16, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.144 Vali Acc: 0.344 Test Loss: 3.144 Test Acc: 0.344
Validation loss decreased (-0.336439 --> -0.343498).  Saving model ...
Epoch: 17 cost time: 5.848756313323975
Epoch: 17, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.171 Vali Acc: 0.339 Test Loss: 3.171 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.004650354385376
Epoch: 18, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.225 Vali Acc: 0.333 Test Loss: 3.225 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.122986793518066
Epoch: 19, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.270 Vali Acc: 0.338 Test Loss: 3.270 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.196078300476074
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.448 Vali Acc: 0.326 Test Loss: 3.448 Test Acc: 0.326
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 5.503077030181885
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.307 Vali Acc: 0.336 Test Loss: 3.307 Test Acc: 0.336
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 5.56188702583313
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.300 Vali Acc: 0.336 Test Loss: 3.300 Test Acc: 0.336
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 4.233292818069458
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.227 Vali Acc: 0.346 Test Loss: 3.227 Test Acc: 0.346
Validation loss decreased (-0.343498 --> -0.345850).  Saving model ...
Epoch: 24 cost time: 5.331433057785034
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.253 Vali Acc: 0.338 Test Loss: 3.253 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 5.383998394012451
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.256 Vali Acc: 0.339 Test Loss: 3.256 Test Acc: 0.339
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 5.07153058052063
Epoch: 26, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.355 Vali Acc: 0.326 Test Loss: 3.355 Test Acc: 0.326
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 5.689042091369629
Epoch: 27, Steps: 10 | Train Loss: 0.082 Vali Loss: 3.310 Vali Acc: 0.326 Test Loss: 3.310 Test Acc: 0.326
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 5.731816053390503
Epoch: 28, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.334 Vali Acc: 0.306 Test Loss: 3.334 Test Acc: 0.306
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 5.4073326587677
Epoch: 29, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.572 Vali Acc: 0.299 Test Loss: 3.572 Test Acc: 0.299
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 5.342478036880493
Epoch: 30, Steps: 10 | Train Loss: 0.064 Vali Loss: 3.598 Vali Acc: 0.251 Test Loss: 3.598 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3458823529411765
model parameter : 11269082
model size : 44.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 11.65780258178711
Epoch: 1, Steps: 10 | Train Loss: 3.404 Vali Loss: 3.279 Vali Acc: 0.040 Test Loss: 3.279 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 9.23772644996643
Epoch: 2, Steps: 10 | Train Loss: 2.972 Vali Loss: 3.258 Vali Acc: 0.102 Test Loss: 3.258 Test Acc: 0.102
Validation loss decreased (-0.039967 --> -0.102320).  Saving model ...
Epoch: 3 cost time: 10.646751403808594
Epoch: 3, Steps: 10 | Train Loss: 2.344 Vali Loss: 3.136 Vali Acc: 0.164 Test Loss: 3.136 Test Acc: 0.164
Validation loss decreased (-0.102320 --> -0.163498).  Saving model ...
Epoch: 4 cost time: 10.081910848617554
Epoch: 4, Steps: 10 | Train Loss: 1.680 Vali Loss: 3.043 Vali Acc: 0.192 Test Loss: 3.043 Test Acc: 0.192
Validation loss decreased (-0.163498 --> -0.191734).  Saving model ...
Epoch: 5 cost time: 10.901088237762451
Epoch: 5, Steps: 10 | Train Loss: 1.267 Vali Loss: 3.038 Vali Acc: 0.221 Test Loss: 3.038 Test Acc: 0.221
Validation loss decreased (-0.191734 --> -0.221146).  Saving model ...
Epoch: 6 cost time: 9.388231992721558
Epoch: 6, Steps: 10 | Train Loss: 0.921 Vali Loss: 2.975 Vali Acc: 0.253 Test Loss: 2.975 Test Acc: 0.253
Validation loss decreased (-0.221146 --> -0.252911).  Saving model ...
Epoch: 7 cost time: 8.99023723602295
Epoch: 7, Steps: 10 | Train Loss: 0.471 Vali Loss: 2.965 Vali Acc: 0.273 Test Loss: 2.965 Test Acc: 0.273
Validation loss decreased (-0.252911 --> -0.272912).  Saving model ...
Epoch: 8 cost time: 7.7372119426727295
Epoch: 8, Steps: 10 | Train Loss: 0.334 Vali Loss: 3.001 Vali Acc: 0.296 Test Loss: 3.001 Test Acc: 0.296
Validation loss decreased (-0.272912 --> -0.296441).  Saving model ...
Epoch: 9 cost time: 8.363381147384644
Epoch: 9, Steps: 10 | Train Loss: 0.165 Vali Loss: 3.048 Vali Acc: 0.299 Test Loss: 3.048 Test Acc: 0.299
Validation loss decreased (-0.296441 --> -0.298793).  Saving model ...
Epoch: 10 cost time: 8.086911678314209
Epoch: 10, Steps: 10 | Train Loss: 0.103 Vali Loss: 3.142 Vali Acc: 0.311 Test Loss: 3.142 Test Acc: 0.311
Validation loss decreased (-0.298793 --> -0.310557).  Saving model ...
Epoch: 11 cost time: 7.680683374404907
Epoch: 11, Steps: 10 | Train Loss: 0.139 Vali Loss: 3.137 Vali Acc: 0.308 Test Loss: 3.137 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 9.245068073272705
Epoch: 12, Steps: 10 | Train Loss: 0.124 Vali Loss: 3.310 Vali Acc: 0.287 Test Loss: 3.310 Test Acc: 0.287
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 9.839481592178345
Epoch: 13, Steps: 10 | Train Loss: 0.146 Vali Loss: 3.116 Vali Acc: 0.313 Test Loss: 3.116 Test Acc: 0.313
Validation loss decreased (-0.310557 --> -0.312910).  Saving model ...
Epoch: 14 cost time: 10.594420433044434
Epoch: 14, Steps: 10 | Train Loss: 0.089 Vali Loss: 3.158 Vali Acc: 0.322 Test Loss: 3.158 Test Acc: 0.322
Validation loss decreased (-0.312910 --> -0.322321).  Saving model ...
Epoch: 15 cost time: 9.648252487182617
Epoch: 15, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.295 Vali Acc: 0.315 Test Loss: 3.295 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 9.705493927001953
Epoch: 16, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.301 Vali Acc: 0.308 Test Loss: 3.301 Test Acc: 0.308
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 8.734148979187012
Epoch: 17, Steps: 10 | Train Loss: 0.056 Vali Loss: 3.332 Vali Acc: 0.305 Test Loss: 3.332 Test Acc: 0.305
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 9.256773710250854
Epoch: 18, Steps: 10 | Train Loss: 0.079 Vali Loss: 3.244 Vali Acc: 0.313 Test Loss: 3.244 Test Acc: 0.313
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 8.962875366210938
Epoch: 19, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.385 Vali Acc: 0.304 Test Loss: 3.385 Test Acc: 0.304
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 8.395933151245117
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.371 Vali Acc: 0.307 Test Loss: 3.371 Test Acc: 0.307
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 8.698867321014404
Epoch: 21, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.424 Vali Acc: 0.304 Test Loss: 3.424 Test Acc: 0.304
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 8.665245771408081
Epoch: 22, Steps: 10 | Train Loss: 0.058 Vali Loss: 3.490 Vali Acc: 0.286 Test Loss: 3.490 Test Acc: 0.286
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 7.443607807159424
Epoch: 23, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.418 Vali Acc: 0.288 Test Loss: 3.418 Test Acc: 0.288
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 9.040585994720459
Epoch: 24, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.474 Vali Acc: 0.301 Test Loss: 3.474 Test Acc: 0.301
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.32235294117647056
model parameter : 37748186
model size : 145.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.509307622909546
Epoch: 1, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.262 Vali Acc: 0.061 Test Loss: 3.262 Test Acc: 0.061
Validation loss decreased (inf --> -0.061144).  Saving model ...
Epoch: 2 cost time: 3.6327641010284424
Epoch: 2, Steps: 10 | Train Loss: 2.944 Vali Loss: 3.266 Vali Acc: 0.100 Test Loss: 3.266 Test Acc: 0.100
Validation loss decreased (-0.061144 --> -0.099967).  Saving model ...
Epoch: 3 cost time: 3.95627760887146
Epoch: 3, Steps: 10 | Train Loss: 2.491 Vali Loss: 3.183 Vali Acc: 0.138 Test Loss: 3.183 Test Acc: 0.138
Validation loss decreased (-0.099967 --> -0.137615).  Saving model ...
Epoch: 4 cost time: 2.9983973503112793
Epoch: 4, Steps: 10 | Train Loss: 2.029 Vali Loss: 3.016 Vali Acc: 0.211 Test Loss: 3.016 Test Acc: 0.211
Validation loss decreased (-0.137615 --> -0.210558).  Saving model ...
Epoch: 5 cost time: 3.486593723297119
Epoch: 5, Steps: 10 | Train Loss: 1.367 Vali Loss: 2.970 Vali Acc: 0.224 Test Loss: 2.970 Test Acc: 0.224
Validation loss decreased (-0.210558 --> -0.223500).  Saving model ...
Epoch: 6 cost time: 3.2008063793182373
Epoch: 6, Steps: 10 | Train Loss: 1.031 Vali Loss: 2.952 Vali Acc: 0.233 Test Loss: 2.952 Test Acc: 0.233
Validation loss decreased (-0.223500 --> -0.232912).  Saving model ...
Epoch: 7 cost time: 2.74503755569458
Epoch: 7, Steps: 10 | Train Loss: 0.736 Vali Loss: 2.987 Vali Acc: 0.254 Test Loss: 2.987 Test Acc: 0.254
Validation loss decreased (-0.232912 --> -0.254088).  Saving model ...
Epoch: 8 cost time: 3.0158309936523438
Epoch: 8, Steps: 10 | Train Loss: 0.427 Vali Loss: 2.979 Vali Acc: 0.285 Test Loss: 2.979 Test Acc: 0.285
Validation loss decreased (-0.254088 --> -0.284676).  Saving model ...
Epoch: 9 cost time: 3.5747530460357666
Epoch: 9, Steps: 10 | Train Loss: 0.359 Vali Loss: 3.035 Vali Acc: 0.282 Test Loss: 3.035 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.2572834491729736
Epoch: 10, Steps: 10 | Train Loss: 0.281 Vali Loss: 3.030 Vali Acc: 0.321 Test Loss: 3.030 Test Acc: 0.321
Validation loss decreased (-0.284676 --> -0.321146).  Saving model ...
Epoch: 11 cost time: 3.051889419555664
Epoch: 11, Steps: 10 | Train Loss: 0.127 Vali Loss: 3.037 Vali Acc: 0.318 Test Loss: 3.037 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.9926304817199707
Epoch: 12, Steps: 10 | Train Loss: 0.096 Vali Loss: 3.156 Vali Acc: 0.312 Test Loss: 3.156 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.382758855819702
Epoch: 13, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.178 Vali Acc: 0.321 Test Loss: 3.178 Test Acc: 0.321
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.360748052597046
Epoch: 14, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.045 Vali Acc: 0.342 Test Loss: 3.045 Test Acc: 0.342
Validation loss decreased (-0.321146 --> -0.342322).  Saving model ...
Epoch: 15 cost time: 4.815936326980591
Epoch: 15, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.272 Vali Acc: 0.313 Test Loss: 3.272 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.759080410003662
Epoch: 16, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.291 Vali Acc: 0.316 Test Loss: 3.291 Test Acc: 0.316
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.326756477355957
Epoch: 17, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.325 Vali Acc: 0.322 Test Loss: 3.325 Test Acc: 0.322
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.177403926849365
Epoch: 18, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.455 Vali Acc: 0.319 Test Loss: 3.455 Test Acc: 0.319
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.4801981449127197
Epoch: 19, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.405 Vali Acc: 0.339 Test Loss: 3.405 Test Acc: 0.339
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.437304973602295
Epoch: 20, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.501 Vali Acc: 0.315 Test Loss: 3.501 Test Acc: 0.315
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.117510795593262
Epoch: 21, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.326 Vali Acc: 0.332 Test Loss: 3.326 Test Acc: 0.332
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.767569541931152
Epoch: 22, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.334 Vali Acc: 0.332 Test Loss: 3.334 Test Acc: 0.332
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.7393882274627686
Epoch: 23, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.302 Vali Acc: 0.362 Test Loss: 3.302 Test Acc: 0.362
Validation loss decreased (-0.342322 --> -0.362320).  Saving model ...
Epoch: 24 cost time: 4.95644998550415
Epoch: 24, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.349 Vali Acc: 0.347 Test Loss: 3.349 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.788785696029663
Epoch: 25, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.478 Vali Acc: 0.332 Test Loss: 3.478 Test Acc: 0.332
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 5.193509340286255
Epoch: 26, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.277 Vali Acc: 0.331 Test Loss: 3.277 Test Acc: 0.331
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 4.955518960952759
Epoch: 27, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.573 Vali Acc: 0.313 Test Loss: 3.573 Test Acc: 0.313
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 5.1905436515808105
Epoch: 28, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.550 Vali Acc: 0.320 Test Loss: 3.550 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 4.822237253189087
Epoch: 29, Steps: 10 | Train Loss: 0.069 Vali Loss: 3.484 Vali Acc: 0.324 Test Loss: 3.484 Test Acc: 0.324
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 5.191870927810669
Epoch: 30, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.478 Vali Acc: 0.320 Test Loss: 3.478 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3623529411764706
model parameter : 11269082
model size : 44.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 9.304023027420044
Epoch: 1, Steps: 10 | Train Loss: 3.396 Vali Loss: 3.289 Vali Acc: 0.045 Test Loss: 3.289 Test Acc: 0.045
Validation loss decreased (inf --> -0.044673).  Saving model ...
Epoch: 2 cost time: 7.440126419067383
Epoch: 2, Steps: 10 | Train Loss: 3.063 Vali Loss: 3.307 Vali Acc: 0.084 Test Loss: 3.307 Test Acc: 0.084
Validation loss decreased (-0.044673 --> -0.083496).  Saving model ...
Epoch: 3 cost time: 7.464441299438477
Epoch: 3, Steps: 10 | Train Loss: 2.582 Vali Loss: 3.207 Vali Acc: 0.129 Test Loss: 3.207 Test Acc: 0.129
Validation loss decreased (-0.083496 --> -0.129380).  Saving model ...
Epoch: 4 cost time: 7.120769739151001
Epoch: 4, Steps: 10 | Train Loss: 2.089 Vali Loss: 3.115 Vali Acc: 0.166 Test Loss: 3.115 Test Acc: 0.166
Validation loss decreased (-0.129380 --> -0.165851).  Saving model ...
Epoch: 5 cost time: 6.706408977508545
Epoch: 5, Steps: 10 | Train Loss: 1.524 Vali Loss: 3.080 Vali Acc: 0.226 Test Loss: 3.080 Test Acc: 0.226
Validation loss decreased (-0.165851 --> -0.225852).  Saving model ...
Epoch: 6 cost time: 6.621608734130859
Epoch: 6, Steps: 10 | Train Loss: 0.934 Vali Loss: 3.043 Vali Acc: 0.228 Test Loss: 3.043 Test Acc: 0.228
Validation loss decreased (-0.225852 --> -0.228205).  Saving model ...
Epoch: 7 cost time: 6.993146181106567
Epoch: 7, Steps: 10 | Train Loss: 0.486 Vali Loss: 3.047 Vali Acc: 0.262 Test Loss: 3.047 Test Acc: 0.262
Validation loss decreased (-0.228205 --> -0.262322).  Saving model ...
Epoch: 8 cost time: 6.705057382583618
Epoch: 8, Steps: 10 | Train Loss: 0.205 Vali Loss: 3.123 Vali Acc: 0.284 Test Loss: 3.123 Test Acc: 0.284
Validation loss decreased (-0.262322 --> -0.283498).  Saving model ...
Epoch: 9 cost time: 6.5081164836883545
Epoch: 9, Steps: 10 | Train Loss: 0.298 Vali Loss: 3.105 Vali Acc: 0.291 Test Loss: 3.105 Test Acc: 0.291
Validation loss decreased (-0.283498 --> -0.290557).  Saving model ...
Epoch: 10 cost time: 6.690725803375244
Epoch: 10, Steps: 10 | Train Loss: 0.159 Vali Loss: 3.120 Vali Acc: 0.304 Test Loss: 3.120 Test Acc: 0.304
Validation loss decreased (-0.290557 --> -0.303498).  Saving model ...
Epoch: 11 cost time: 6.970439195632935
Epoch: 11, Steps: 10 | Train Loss: 0.104 Vali Loss: 3.165 Vali Acc: 0.306 Test Loss: 3.165 Test Acc: 0.306
Validation loss decreased (-0.303498 --> -0.305851).  Saving model ...
Epoch: 12 cost time: 6.207257986068726
Epoch: 12, Steps: 10 | Train Loss: 0.132 Vali Loss: 3.171 Vali Acc: 0.292 Test Loss: 3.171 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.389509916305542
Epoch: 13, Steps: 10 | Train Loss: 0.102 Vali Loss: 3.202 Vali Acc: 0.301 Test Loss: 3.202 Test Acc: 0.301
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.665746688842773
Epoch: 14, Steps: 10 | Train Loss: 0.176 Vali Loss: 3.229 Vali Acc: 0.281 Test Loss: 3.229 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.854117155075073
Epoch: 15, Steps: 10 | Train Loss: 0.067 Vali Loss: 3.333 Vali Acc: 0.295 Test Loss: 3.333 Test Acc: 0.295
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 6.462324619293213
Epoch: 16, Steps: 10 | Train Loss: 0.056 Vali Loss: 3.288 Vali Acc: 0.329 Test Loss: 3.288 Test Acc: 0.329
Validation loss decreased (-0.305851 --> -0.329379).  Saving model ...
Epoch: 17 cost time: 6.623300790786743
Epoch: 17, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.319 Vali Acc: 0.326 Test Loss: 3.319 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.806286811828613
Epoch: 18, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.405 Vali Acc: 0.320 Test Loss: 3.405 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 6.461800575256348
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.426 Vali Acc: 0.322 Test Loss: 3.426 Test Acc: 0.322
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 6.865793228149414
Epoch: 20, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.491 Vali Acc: 0.318 Test Loss: 3.491 Test Acc: 0.318
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 6.479621887207031
Epoch: 21, Steps: 10 | Train Loss: 0.066 Vali Loss: 3.460 Vali Acc: 0.313 Test Loss: 3.460 Test Acc: 0.313
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 5.525919437408447
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.448 Vali Acc: 0.308 Test Loss: 3.448 Test Acc: 0.308
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 5.966936111450195
Epoch: 23, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.435 Vali Acc: 0.329 Test Loss: 3.435 Test Acc: 0.329
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 6.7451331615448
Epoch: 24, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.585 Vali Acc: 0.325 Test Loss: 3.585 Test Acc: 0.325
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 6.208794116973877
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.597 Vali Acc: 0.322 Test Loss: 3.597 Test Acc: 0.322
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 6.736316680908203
Epoch: 26, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.652 Vali Acc: 0.305 Test Loss: 3.652 Test Acc: 0.305
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.32941176470588235
model parameter : 37748186
model size : 145.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.9891417026519775
Epoch: 1, Steps: 10 | Train Loss: 3.260 Vali Loss: 3.276 Vali Acc: 0.055 Test Loss: 3.276 Test Acc: 0.055
Validation loss decreased (inf --> -0.055261).  Saving model ...
Epoch: 2 cost time: 3.5904152393341064
Epoch: 2, Steps: 10 | Train Loss: 3.014 Vali Loss: 3.308 Vali Acc: 0.075 Test Loss: 3.308 Test Acc: 0.075
Validation loss decreased (-0.055261 --> -0.075261).  Saving model ...
Epoch: 3 cost time: 3.600677728652954
Epoch: 3, Steps: 10 | Train Loss: 2.678 Vali Loss: 3.236 Vali Acc: 0.128 Test Loss: 3.236 Test Acc: 0.128
Validation loss decreased (-0.075261 --> -0.128203).  Saving model ...
Epoch: 4 cost time: 2.3328473567962646
Epoch: 4, Steps: 10 | Train Loss: 2.272 Vali Loss: 3.105 Vali Acc: 0.187 Test Loss: 3.105 Test Acc: 0.187
Validation loss decreased (-0.128203 --> -0.187028).  Saving model ...
Epoch: 5 cost time: 2.934743881225586
Epoch: 5, Steps: 10 | Train Loss: 1.687 Vali Loss: 3.085 Vali Acc: 0.200 Test Loss: 3.085 Test Acc: 0.200
Validation loss decreased (-0.187028 --> -0.199969).  Saving model ...
Epoch: 6 cost time: 2.8962080478668213
Epoch: 6, Steps: 10 | Train Loss: 1.333 Vali Loss: 3.069 Vali Acc: 0.194 Test Loss: 3.069 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.8247876167297363
Epoch: 7, Steps: 10 | Train Loss: 0.840 Vali Loss: 3.067 Vali Acc: 0.245 Test Loss: 3.067 Test Acc: 0.245
Validation loss decreased (-0.199969 --> -0.244675).  Saving model ...
Epoch: 8 cost time: 2.189080238342285
Epoch: 8, Steps: 10 | Train Loss: 0.590 Vali Loss: 3.014 Vali Acc: 0.251 Test Loss: 3.014 Test Acc: 0.251
Validation loss decreased (-0.244675 --> -0.250558).  Saving model ...
Epoch: 9 cost time: 2.7785463333129883
Epoch: 9, Steps: 10 | Train Loss: 0.430 Vali Loss: 3.044 Vali Acc: 0.275 Test Loss: 3.044 Test Acc: 0.275
Validation loss decreased (-0.250558 --> -0.275264).  Saving model ...
Epoch: 10 cost time: 2.593235492706299
Epoch: 10, Steps: 10 | Train Loss: 0.301 Vali Loss: 3.032 Vali Acc: 0.305 Test Loss: 3.032 Test Acc: 0.305
Validation loss decreased (-0.275264 --> -0.304676).  Saving model ...
Epoch: 11 cost time: 2.192472457885742
Epoch: 11, Steps: 10 | Train Loss: 0.126 Vali Loss: 3.092 Vali Acc: 0.308 Test Loss: 3.092 Test Acc: 0.308
Validation loss decreased (-0.304676 --> -0.308204).  Saving model ...
Epoch: 12 cost time: 2.774517297744751
Epoch: 12, Steps: 10 | Train Loss: 0.089 Vali Loss: 3.206 Vali Acc: 0.305 Test Loss: 3.206 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.052457332611084
Epoch: 13, Steps: 10 | Train Loss: 0.131 Vali Loss: 3.143 Vali Acc: 0.336 Test Loss: 3.143 Test Acc: 0.336
Validation loss decreased (-0.308204 --> -0.336439).  Saving model ...
Epoch: 14 cost time: 3.148916006088257
Epoch: 14, Steps: 10 | Train Loss: 0.102 Vali Loss: 3.198 Vali Acc: 0.332 Test Loss: 3.198 Test Acc: 0.332
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.235213041305542
Epoch: 15, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.335 Vali Acc: 0.324 Test Loss: 3.335 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.0539538860321045
Epoch: 16, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.326 Vali Acc: 0.344 Test Loss: 3.326 Test Acc: 0.344
Validation loss decreased (-0.336439 --> -0.343496).  Saving model ...
Epoch: 17 cost time: 2.7056498527526855
Epoch: 17, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.276 Vali Acc: 0.352 Test Loss: 3.276 Test Acc: 0.352
Validation loss decreased (-0.343496 --> -0.351732).  Saving model ...
Epoch: 18 cost time: 3.2946197986602783
Epoch: 18, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.432 Vali Acc: 0.344 Test Loss: 3.432 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.914186477661133
Epoch: 19, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.358 Vali Acc: 0.348 Test Loss: 3.358 Test Acc: 0.348
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.987644672393799
Epoch: 20, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.492 Vali Acc: 0.324 Test Loss: 3.492 Test Acc: 0.324
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.057467222213745
Epoch: 21, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.620 Vali Acc: 0.327 Test Loss: 3.620 Test Acc: 0.327
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.407323122024536
Epoch: 22, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.335 Vali Acc: 0.339 Test Loss: 3.335 Test Acc: 0.339
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.8571720123291016
Epoch: 23, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.475 Vali Acc: 0.318 Test Loss: 3.475 Test Acc: 0.318
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.888136148452759
Epoch: 24, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.456 Vali Acc: 0.346 Test Loss: 3.456 Test Acc: 0.346
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.0341031551361084
Epoch: 25, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.526 Vali Acc: 0.329 Test Loss: 3.526 Test Acc: 0.329
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.9271938800811768
Epoch: 26, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.536 Vali Acc: 0.331 Test Loss: 3.536 Test Acc: 0.331
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.8101601600646973
Epoch: 27, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.608 Vali Acc: 0.322 Test Loss: 3.608 Test Acc: 0.322
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3517647058823529
model parameter : 11269082
model size : 44.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 8.191929817199707
Epoch: 1, Steps: 10 | Train Loss: 3.315 Vali Loss: 3.241 Vali Acc: 0.061 Test Loss: 3.241 Test Acc: 0.061
Validation loss decreased (inf --> -0.061144).  Saving model ...
Epoch: 2 cost time: 10.354863405227661
Epoch: 2, Steps: 10 | Train Loss: 2.872 Vali Loss: 3.233 Vali Acc: 0.120 Test Loss: 3.233 Test Acc: 0.120
Validation loss decreased (-0.061144 --> -0.119968).  Saving model ...
Epoch: 3 cost time: 10.76646876335144
Epoch: 3, Steps: 10 | Train Loss: 2.415 Vali Loss: 3.148 Vali Acc: 0.160 Test Loss: 3.148 Test Acc: 0.160
Validation loss decreased (-0.119968 --> -0.159969).  Saving model ...
Epoch: 4 cost time: 10.020004034042358
Epoch: 4, Steps: 10 | Train Loss: 1.769 Vali Loss: 3.014 Vali Acc: 0.199 Test Loss: 3.014 Test Acc: 0.199
Validation loss decreased (-0.159969 --> -0.198793).  Saving model ...
Epoch: 5 cost time: 10.694123268127441
Epoch: 5, Steps: 10 | Train Loss: 1.229 Vali Loss: 2.961 Vali Acc: 0.232 Test Loss: 2.961 Test Acc: 0.232
Validation loss decreased (-0.198793 --> -0.231735).  Saving model ...
Epoch: 6 cost time: 9.501106262207031
Epoch: 6, Steps: 10 | Train Loss: 0.770 Vali Loss: 2.932 Vali Acc: 0.261 Test Loss: 2.932 Test Acc: 0.261
Validation loss decreased (-0.231735 --> -0.261147).  Saving model ...
Epoch: 7 cost time: 9.382267236709595
Epoch: 7, Steps: 10 | Train Loss: 0.427 Vali Loss: 2.920 Vali Acc: 0.287 Test Loss: 2.920 Test Acc: 0.287
Validation loss decreased (-0.261147 --> -0.287030).  Saving model ...
Epoch: 8 cost time: 10.063539266586304
Epoch: 8, Steps: 10 | Train Loss: 0.330 Vali Loss: 3.050 Vali Acc: 0.272 Test Loss: 3.050 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 10.250770568847656
Epoch: 9, Steps: 10 | Train Loss: 0.182 Vali Loss: 2.993 Vali Acc: 0.311 Test Loss: 2.993 Test Acc: 0.311
Validation loss decreased (-0.287030 --> -0.310558).  Saving model ...
Epoch: 10 cost time: 10.210209608078003
Epoch: 10, Steps: 10 | Train Loss: 0.106 Vali Loss: 3.034 Vali Acc: 0.318 Test Loss: 3.034 Test Acc: 0.318
Validation loss decreased (-0.310558 --> -0.317617).  Saving model ...
Epoch: 11 cost time: 10.096703052520752
Epoch: 11, Steps: 10 | Train Loss: 0.056 Vali Loss: 2.998 Vali Acc: 0.326 Test Loss: 2.998 Test Acc: 0.326
Validation loss decreased (-0.317617 --> -0.325852).  Saving model ...
Epoch: 12 cost time: 9.272742986679077
Epoch: 12, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.131 Vali Acc: 0.309 Test Loss: 3.131 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 8.9709951877594
Epoch: 13, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.281 Vali Acc: 0.314 Test Loss: 3.281 Test Acc: 0.314
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 9.296552419662476
Epoch: 14, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.096 Vali Acc: 0.331 Test Loss: 3.096 Test Acc: 0.331
Validation loss decreased (-0.325852 --> -0.330557).  Saving model ...
Epoch: 15 cost time: 10.395483255386353
Epoch: 15, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.118 Vali Acc: 0.334 Test Loss: 3.118 Test Acc: 0.334
Validation loss decreased (-0.330557 --> -0.334086).  Saving model ...
Epoch: 16 cost time: 9.343344926834106
Epoch: 16, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.115 Vali Acc: 0.327 Test Loss: 3.115 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 9.685492515563965
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.165 Vali Acc: 0.329 Test Loss: 3.165 Test Acc: 0.329
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 10.337537050247192
Epoch: 18, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.186 Vali Acc: 0.335 Test Loss: 3.186 Test Acc: 0.335
Validation loss decreased (-0.334086 --> -0.335262).  Saving model ...
Epoch: 19 cost time: 9.301153182983398
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.247 Vali Acc: 0.328 Test Loss: 3.247 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 9.613298654556274
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.281 Vali Acc: 0.332 Test Loss: 3.281 Test Acc: 0.332
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 9.984972953796387
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.300 Vali Acc: 0.339 Test Loss: 3.300 Test Acc: 0.339
Validation loss decreased (-0.335262 --> -0.338791).  Saving model ...
Epoch: 22 cost time: 10.009515285491943
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.302 Vali Acc: 0.340 Test Loss: 3.302 Test Acc: 0.340
Validation loss decreased (-0.338791 --> -0.339967).  Saving model ...
Epoch: 23 cost time: 9.947450876235962
Epoch: 23, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.267 Vali Acc: 0.336 Test Loss: 3.267 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 10.149962902069092
Epoch: 24, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.185 Vali Acc: 0.328 Test Loss: 3.185 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 9.424204349517822
Epoch: 25, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.290 Vali Acc: 0.326 Test Loss: 3.290 Test Acc: 0.326
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 9.18555498123169
Epoch: 26, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.419 Vali Acc: 0.322 Test Loss: 3.419 Test Acc: 0.322
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 8.704566478729248
Epoch: 27, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.444 Vali Acc: 0.333 Test Loss: 3.444 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 9.506958961486816
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.368 Vali Acc: 0.333 Test Loss: 3.368 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 9.637113571166992
Epoch: 29, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.546 Vali Acc: 0.315 Test Loss: 3.546 Test Acc: 0.315
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 7.461313724517822
Epoch: 30, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.523 Vali Acc: 0.309 Test Loss: 3.523 Test Acc: 0.309
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.34
model parameter : 19001818
model size : 73.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 6.185244560241699
Epoch: 1, Steps: 10 | Train Loss: 3.293 Vali Loss: 3.275 Vali Acc: 0.045 Test Loss: 3.275 Test Acc: 0.045
Validation loss decreased (inf --> -0.044673).  Saving model ...
Epoch: 2 cost time: 4.113199710845947
Epoch: 2, Steps: 10 | Train Loss: 3.022 Vali Loss: 3.280 Vali Acc: 0.088 Test Loss: 3.280 Test Acc: 0.088
Validation loss decreased (-0.044673 --> -0.088202).  Saving model ...
Epoch: 3 cost time: 4.158616781234741
Epoch: 3, Steps: 10 | Train Loss: 2.545 Vali Loss: 3.195 Vali Acc: 0.132 Test Loss: 3.195 Test Acc: 0.132
Validation loss decreased (-0.088202 --> -0.131733).  Saving model ...
Epoch: 4 cost time: 3.281231164932251
Epoch: 4, Steps: 10 | Train Loss: 2.059 Vali Loss: 3.074 Vali Acc: 0.187 Test Loss: 3.074 Test Acc: 0.187
Validation loss decreased (-0.131733 --> -0.187028).  Saving model ...
Epoch: 5 cost time: 3.743546724319458
Epoch: 5, Steps: 10 | Train Loss: 1.461 Vali Loss: 2.956 Vali Acc: 0.216 Test Loss: 2.956 Test Acc: 0.216
Validation loss decreased (-0.187028 --> -0.216441).  Saving model ...
Epoch: 6 cost time: 3.960167646408081
Epoch: 6, Steps: 10 | Train Loss: 0.986 Vali Loss: 2.908 Vali Acc: 0.247 Test Loss: 2.908 Test Acc: 0.247
Validation loss decreased (-0.216441 --> -0.247030).  Saving model ...
Epoch: 7 cost time: 4.650593519210815
Epoch: 7, Steps: 10 | Train Loss: 0.624 Vali Loss: 2.908 Vali Acc: 0.260 Test Loss: 2.908 Test Acc: 0.260
Validation loss decreased (-0.247030 --> -0.259971).  Saving model ...
Epoch: 8 cost time: 4.546009063720703
Epoch: 8, Steps: 10 | Train Loss: 0.342 Vali Loss: 2.910 Vali Acc: 0.288 Test Loss: 2.910 Test Acc: 0.288
Validation loss decreased (-0.259971 --> -0.288206).  Saving model ...
Epoch: 9 cost time: 4.436218738555908
Epoch: 9, Steps: 10 | Train Loss: 0.195 Vali Loss: 2.974 Vali Acc: 0.314 Test Loss: 2.974 Test Acc: 0.314
Validation loss decreased (-0.288206 --> -0.314088).  Saving model ...
Epoch: 10 cost time: 4.388119220733643
Epoch: 10, Steps: 10 | Train Loss: 0.131 Vali Loss: 3.077 Vali Acc: 0.308 Test Loss: 3.077 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.423957824707031
Epoch: 11, Steps: 10 | Train Loss: 0.095 Vali Loss: 3.129 Vali Acc: 0.300 Test Loss: 3.129 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.357372522354126
Epoch: 12, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.122 Vali Acc: 0.309 Test Loss: 3.122 Test Acc: 0.309
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.161181211471558
Epoch: 13, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.066 Vali Acc: 0.318 Test Loss: 3.066 Test Acc: 0.318
Validation loss decreased (-0.314088 --> -0.317616).  Saving model ...
Epoch: 14 cost time: 4.426165580749512
Epoch: 14, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.232 Vali Acc: 0.316 Test Loss: 3.232 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.08914852142334
Epoch: 15, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.198 Vali Acc: 0.324 Test Loss: 3.198 Test Acc: 0.324
Validation loss decreased (-0.317616 --> -0.323497).  Saving model ...
Epoch: 16 cost time: 3.9995620250701904
Epoch: 16, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.170 Vali Acc: 0.325 Test Loss: 3.170 Test Acc: 0.325
Validation loss decreased (-0.323497 --> -0.324674).  Saving model ...
Epoch: 17 cost time: 4.041295051574707
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.181 Vali Acc: 0.334 Test Loss: 3.181 Test Acc: 0.334
Validation loss decreased (-0.324674 --> -0.334086).  Saving model ...
Epoch: 18 cost time: 4.1285083293914795
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.198 Vali Acc: 0.338 Test Loss: 3.198 Test Acc: 0.338
Validation loss decreased (-0.334086 --> -0.337615).  Saving model ...
Epoch: 19 cost time: 4.498112678527832
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.210 Vali Acc: 0.340 Test Loss: 3.210 Test Acc: 0.340
Validation loss decreased (-0.337615 --> -0.339968).  Saving model ...
Epoch: 20 cost time: 4.467916011810303
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.221 Vali Acc: 0.339 Test Loss: 3.221 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.0909693241119385
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.224 Vali Acc: 0.351 Test Loss: 3.224 Test Acc: 0.351
Validation loss decreased (-0.339968 --> -0.350556).  Saving model ...
Epoch: 22 cost time: 4.216346502304077
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.227 Vali Acc: 0.346 Test Loss: 3.227 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.123255014419556
Epoch: 23, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.431 Vali Acc: 0.286 Test Loss: 3.431 Test Acc: 0.286
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.00580096244812
Epoch: 24, Steps: 10 | Train Loss: 0.068 Vali Loss: 3.268 Vali Acc: 0.324 Test Loss: 3.268 Test Acc: 0.324
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.8522753715515137
Epoch: 25, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.380 Vali Acc: 0.295 Test Loss: 3.380 Test Acc: 0.295
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.956923246383667
Epoch: 26, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.379 Vali Acc: 0.306 Test Loss: 3.379 Test Acc: 0.306
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.3208041191101074
Epoch: 27, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.332 Vali Acc: 0.316 Test Loss: 3.332 Test Acc: 0.316
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.5427980422973633
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.411 Vali Acc: 0.320 Test Loss: 3.411 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.7300772666931152
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.405 Vali Acc: 0.327 Test Loss: 3.405 Test Acc: 0.327
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 4.152064800262451
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.398 Vali Acc: 0.331 Test Loss: 3.398 Test Acc: 0.331
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.35058823529411764
model parameter : 5762010
model size : 23.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 8.898699760437012
Epoch: 1, Steps: 10 | Train Loss: 3.328 Vali Loss: 3.242 Vali Acc: 0.061 Test Loss: 3.242 Test Acc: 0.061
Validation loss decreased (inf --> -0.061144).  Saving model ...
Epoch: 2 cost time: 5.326482057571411
Epoch: 2, Steps: 10 | Train Loss: 2.883 Vali Loss: 3.240 Vali Acc: 0.111 Test Loss: 3.240 Test Acc: 0.111
Validation loss decreased (-0.061144 --> -0.110556).  Saving model ...
Epoch: 3 cost time: 7.283297300338745
Epoch: 3, Steps: 10 | Train Loss: 2.430 Vali Loss: 3.162 Vali Acc: 0.164 Test Loss: 3.162 Test Acc: 0.164
Validation loss decreased (-0.110556 --> -0.163498).  Saving model ...
Epoch: 4 cost time: 7.5578553676605225
Epoch: 4, Steps: 10 | Train Loss: 1.854 Vali Loss: 3.037 Vali Acc: 0.202 Test Loss: 3.037 Test Acc: 0.202
Validation loss decreased (-0.163498 --> -0.202323).  Saving model ...
Epoch: 5 cost time: 7.178967714309692
Epoch: 5, Steps: 10 | Train Loss: 1.438 Vali Loss: 3.110 Vali Acc: 0.211 Test Loss: 3.110 Test Acc: 0.211
Validation loss decreased (-0.202323 --> -0.210557).  Saving model ...
Epoch: 6 cost time: 6.092867374420166
Epoch: 6, Steps: 10 | Train Loss: 0.955 Vali Loss: 2.973 Vali Acc: 0.259 Test Loss: 2.973 Test Acc: 0.259
Validation loss decreased (-0.210557 --> -0.258794).  Saving model ...
Epoch: 7 cost time: 6.377503395080566
Epoch: 7, Steps: 10 | Train Loss: 0.580 Vali Loss: 3.024 Vali Acc: 0.280 Test Loss: 3.024 Test Acc: 0.280
Validation loss decreased (-0.258794 --> -0.279970).  Saving model ...
Epoch: 8 cost time: 5.033376455307007
Epoch: 8, Steps: 10 | Train Loss: 0.355 Vali Loss: 3.030 Vali Acc: 0.286 Test Loss: 3.030 Test Acc: 0.286
Validation loss decreased (-0.279970 --> -0.285852).  Saving model ...
Epoch: 9 cost time: 6.471075773239136
Epoch: 9, Steps: 10 | Train Loss: 0.226 Vali Loss: 3.060 Vali Acc: 0.314 Test Loss: 3.060 Test Acc: 0.314
Validation loss decreased (-0.285852 --> -0.314087).  Saving model ...
Epoch: 10 cost time: 6.829691410064697
Epoch: 10, Steps: 10 | Train Loss: 0.120 Vali Loss: 3.070 Vali Acc: 0.304 Test Loss: 3.070 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.278314113616943
Epoch: 11, Steps: 10 | Train Loss: 0.158 Vali Loss: 3.182 Vali Acc: 0.298 Test Loss: 3.182 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.874236345291138
Epoch: 12, Steps: 10 | Train Loss: 0.089 Vali Loss: 3.132 Vali Acc: 0.319 Test Loss: 3.132 Test Acc: 0.319
Validation loss decreased (-0.314087 --> -0.318792).  Saving model ...
Epoch: 13 cost time: 6.4964447021484375
Epoch: 13, Steps: 10 | Train Loss: 0.086 Vali Loss: 3.351 Vali Acc: 0.305 Test Loss: 3.351 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.815235614776611
Epoch: 14, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.210 Vali Acc: 0.327 Test Loss: 3.210 Test Acc: 0.327
Validation loss decreased (-0.318792 --> -0.327027).  Saving model ...
Epoch: 15 cost time: 4.454117298126221
Epoch: 15, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.196 Vali Acc: 0.322 Test Loss: 3.196 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.138749122619629
Epoch: 16, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.295 Vali Acc: 0.315 Test Loss: 3.295 Test Acc: 0.315
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.835018634796143
Epoch: 17, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.461 Vali Acc: 0.307 Test Loss: 3.461 Test Acc: 0.307
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.590714454650879
Epoch: 18, Steps: 10 | Train Loss: 0.111 Vali Loss: 3.355 Vali Acc: 0.311 Test Loss: 3.355 Test Acc: 0.311
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 6.197205066680908
Epoch: 19, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.565 Vali Acc: 0.289 Test Loss: 3.565 Test Acc: 0.289
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.073526620864868
Epoch: 20, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.249 Vali Acc: 0.327 Test Loss: 3.249 Test Acc: 0.327
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.9022862911224365
Epoch: 21, Steps: 10 | Train Loss: 0.068 Vali Loss: 3.263 Vali Acc: 0.340 Test Loss: 3.263 Test Acc: 0.340
Validation loss decreased (-0.327027 --> -0.339967).  Saving model ...
Epoch: 22 cost time: 7.2585365772247314
Epoch: 22, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.379 Vali Acc: 0.327 Test Loss: 3.379 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 6.492087125778198
Epoch: 23, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.628 Vali Acc: 0.322 Test Loss: 3.628 Test Acc: 0.322
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.989799499511719
Epoch: 24, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.729 Vali Acc: 0.305 Test Loss: 3.729 Test Acc: 0.305
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 5.631527662277222
Epoch: 25, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.673 Vali Acc: 0.332 Test Loss: 3.673 Test Acc: 0.332
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 6.5307207107543945
Epoch: 26, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.650 Vali Acc: 0.338 Test Loss: 3.650 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 6.087856769561768
Epoch: 27, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.591 Vali Acc: 0.336 Test Loss: 3.591 Test Acc: 0.336
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 6.654186010360718
Epoch: 28, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.780 Vali Acc: 0.320 Test Loss: 3.780 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 5.910322666168213
Epoch: 29, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.662 Vali Acc: 0.315 Test Loss: 3.662 Test Acc: 0.315
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 5.786393642425537
Epoch: 30, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.480 Vali Acc: 0.329 Test Loss: 3.480 Test Acc: 0.329
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.34
model parameter : 19001818
model size : 73.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.818782091140747
Epoch: 1, Steps: 10 | Train Loss: 3.290 Vali Loss: 3.273 Vali Acc: 0.045 Test Loss: 3.273 Test Acc: 0.045
Validation loss decreased (inf --> -0.044673).  Saving model ...
Epoch: 2 cost time: 2.9969658851623535
Epoch: 2, Steps: 10 | Train Loss: 3.033 Vali Loss: 3.280 Vali Acc: 0.092 Test Loss: 3.280 Test Acc: 0.092
Validation loss decreased (-0.044673 --> -0.091732).  Saving model ...
Epoch: 3 cost time: 1.7705833911895752
Epoch: 3, Steps: 10 | Train Loss: 2.578 Vali Loss: 3.204 Vali Acc: 0.124 Test Loss: 3.204 Test Acc: 0.124
Validation loss decreased (-0.091732 --> -0.123497).  Saving model ...
Epoch: 4 cost time: 2.326409101486206
Epoch: 4, Steps: 10 | Train Loss: 2.059 Vali Loss: 3.102 Vali Acc: 0.178 Test Loss: 3.102 Test Acc: 0.178
Validation loss decreased (-0.123497 --> -0.177616).  Saving model ...
Epoch: 5 cost time: 2.665437698364258
Epoch: 5, Steps: 10 | Train Loss: 1.454 Vali Loss: 2.997 Vali Acc: 0.200 Test Loss: 2.997 Test Acc: 0.200
Validation loss decreased (-0.177616 --> -0.199970).  Saving model ...
Epoch: 6 cost time: 3.288158416748047
Epoch: 6, Steps: 10 | Train Loss: 1.118 Vali Loss: 2.941 Vali Acc: 0.236 Test Loss: 2.941 Test Acc: 0.236
Validation loss decreased (-0.199970 --> -0.236441).  Saving model ...
Epoch: 7 cost time: 3.1616790294647217
Epoch: 7, Steps: 10 | Train Loss: 0.795 Vali Loss: 2.978 Vali Acc: 0.247 Test Loss: 2.978 Test Acc: 0.247
Validation loss decreased (-0.236441 --> -0.247029).  Saving model ...
Epoch: 8 cost time: 2.8976731300354004
Epoch: 8, Steps: 10 | Train Loss: 0.644 Vali Loss: 2.974 Vali Acc: 0.274 Test Loss: 2.974 Test Acc: 0.274
Validation loss decreased (-0.247029 --> -0.274088).  Saving model ...
Epoch: 9 cost time: 2.926696538925171
Epoch: 9, Steps: 10 | Train Loss: 0.288 Vali Loss: 3.007 Vali Acc: 0.281 Test Loss: 3.007 Test Acc: 0.281
Validation loss decreased (-0.274088 --> -0.281146).  Saving model ...
Epoch: 10 cost time: 1.9254837036132812
Epoch: 10, Steps: 10 | Train Loss: 0.173 Vali Loss: 3.000 Vali Acc: 0.306 Test Loss: 3.000 Test Acc: 0.306
Validation loss decreased (-0.281146 --> -0.305852).  Saving model ...
Epoch: 11 cost time: 1.749985694885254
Epoch: 11, Steps: 10 | Train Loss: 0.123 Vali Loss: 3.160 Vali Acc: 0.293 Test Loss: 3.160 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.892493963241577
Epoch: 12, Steps: 10 | Train Loss: 0.085 Vali Loss: 3.101 Vali Acc: 0.301 Test Loss: 3.101 Test Acc: 0.301
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.1621549129486084
Epoch: 13, Steps: 10 | Train Loss: 0.124 Vali Loss: 3.127 Vali Acc: 0.307 Test Loss: 3.127 Test Acc: 0.307
Validation loss decreased (-0.305852 --> -0.307028).  Saving model ...
Epoch: 14 cost time: 3.1969916820526123
Epoch: 14, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.283 Vali Acc: 0.315 Test Loss: 3.283 Test Acc: 0.315
Validation loss decreased (-0.307028 --> -0.315261).  Saving model ...
Epoch: 15 cost time: 3.066687822341919
Epoch: 15, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.261 Vali Acc: 0.319 Test Loss: 3.261 Test Acc: 0.319
Validation loss decreased (-0.315261 --> -0.318791).  Saving model ...
Epoch: 16 cost time: 2.3051517009735107
Epoch: 16, Steps: 10 | Train Loss: 0.082 Vali Loss: 3.215 Vali Acc: 0.327 Test Loss: 3.215 Test Acc: 0.327
Validation loss decreased (-0.318791 --> -0.327027).  Saving model ...
Epoch: 17 cost time: 3.2968130111694336
Epoch: 17, Steps: 10 | Train Loss: 0.064 Vali Loss: 3.496 Vali Acc: 0.300 Test Loss: 3.496 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.80193829536438
Epoch: 18, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.336 Vali Acc: 0.292 Test Loss: 3.336 Test Acc: 0.292
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.693753480911255
Epoch: 19, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.246 Vali Acc: 0.325 Test Loss: 3.246 Test Acc: 0.325
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.8543031215667725
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.296 Vali Acc: 0.328 Test Loss: 3.296 Test Acc: 0.328
Validation loss decreased (-0.327027 --> -0.328202).  Saving model ...
Epoch: 21 cost time: 3.3002476692199707
Epoch: 21, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.348 Vali Acc: 0.331 Test Loss: 3.348 Test Acc: 0.331
Validation loss decreased (-0.328202 --> -0.330555).  Saving model ...
Epoch: 22 cost time: 2.993194580078125
Epoch: 22, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.445 Vali Acc: 0.311 Test Loss: 3.445 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.4562530517578125
Epoch: 23, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.525 Vali Acc: 0.319 Test Loss: 3.525 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.3053603172302246
Epoch: 24, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.435 Vali Acc: 0.333 Test Loss: 3.435 Test Acc: 0.333
Validation loss decreased (-0.330555 --> -0.332907).  Saving model ...
Epoch: 25 cost time: 2.7657406330108643
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.440 Vali Acc: 0.322 Test Loss: 3.440 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.8731086254119873
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.384 Vali Acc: 0.339 Test Loss: 3.384 Test Acc: 0.339
Validation loss decreased (-0.332907 --> -0.338790).  Saving model ...
Epoch: 27 cost time: 2.8339426517486572
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.371 Vali Acc: 0.344 Test Loss: 3.371 Test Acc: 0.344
Validation loss decreased (-0.338790 --> -0.343496).  Saving model ...
Epoch: 28 cost time: 1.8969197273254395
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.384 Vali Acc: 0.351 Test Loss: 3.384 Test Acc: 0.351
Validation loss decreased (-0.343496 --> -0.350554).  Saving model ...
Epoch: 29 cost time: 3.2722156047821045
Epoch: 29, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.653 Vali Acc: 0.327 Test Loss: 3.653 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.2744297981262207
Epoch: 30, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.565 Vali Acc: 0.340 Test Loss: 3.565 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.35058823529411764
model parameter : 5762010
model size : 23.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 6.102376222610474
Epoch: 1, Steps: 10 | Train Loss: 3.331 Vali Loss: 3.257 Vali Acc: 0.060 Test Loss: 3.257 Test Acc: 0.060
Validation loss decreased (inf --> -0.059967).  Saving model ...
Epoch: 2 cost time: 4.010961055755615
Epoch: 2, Steps: 10 | Train Loss: 2.947 Vali Loss: 3.278 Vali Acc: 0.088 Test Loss: 3.278 Test Acc: 0.088
Validation loss decreased (-0.059967 --> -0.088203).  Saving model ...
Epoch: 3 cost time: 4.130550146102905
Epoch: 3, Steps: 10 | Train Loss: 2.587 Vali Loss: 3.237 Vali Acc: 0.133 Test Loss: 3.237 Test Acc: 0.133
Validation loss decreased (-0.088203 --> -0.132909).  Saving model ...
Epoch: 4 cost time: 3.4149155616760254
Epoch: 4, Steps: 10 | Train Loss: 2.128 Vali Loss: 3.118 Vali Acc: 0.184 Test Loss: 3.118 Test Acc: 0.184
Validation loss decreased (-0.132909 --> -0.183498).  Saving model ...
Epoch: 5 cost time: 2.4587488174438477
Epoch: 5, Steps: 10 | Train Loss: 1.758 Vali Loss: 3.090 Vali Acc: 0.206 Test Loss: 3.090 Test Acc: 0.206
Validation loss decreased (-0.183498 --> -0.205851).  Saving model ...
Epoch: 6 cost time: 3.722107172012329
Epoch: 6, Steps: 10 | Train Loss: 1.159 Vali Loss: 3.016 Vali Acc: 0.259 Test Loss: 3.016 Test Acc: 0.259
Validation loss decreased (-0.205851 --> -0.258793).  Saving model ...
Epoch: 7 cost time: 3.7741119861602783
Epoch: 7, Steps: 10 | Train Loss: 0.654 Vali Loss: 3.034 Vali Acc: 0.267 Test Loss: 3.034 Test Acc: 0.267
Validation loss decreased (-0.258793 --> -0.267028).  Saving model ...
Epoch: 8 cost time: 2.5604002475738525
Epoch: 8, Steps: 10 | Train Loss: 0.377 Vali Loss: 3.215 Vali Acc: 0.276 Test Loss: 3.215 Test Acc: 0.276
Validation loss decreased (-0.267028 --> -0.276438).  Saving model ...
Epoch: 9 cost time: 3.186217784881592
Epoch: 9, Steps: 10 | Train Loss: 0.365 Vali Loss: 3.049 Vali Acc: 0.306 Test Loss: 3.049 Test Acc: 0.306
Validation loss decreased (-0.276438 --> -0.305852).  Saving model ...
Epoch: 10 cost time: 3.3353564739227295
Epoch: 10, Steps: 10 | Train Loss: 0.126 Vali Loss: 3.117 Vali Acc: 0.304 Test Loss: 3.117 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.006273508071899
Epoch: 11, Steps: 10 | Train Loss: 0.147 Vali Loss: 3.209 Vali Acc: 0.308 Test Loss: 3.209 Test Acc: 0.308
Validation loss decreased (-0.305852 --> -0.308203).  Saving model ...
Epoch: 12 cost time: 3.326711654663086
Epoch: 12, Steps: 10 | Train Loss: 0.099 Vali Loss: 3.167 Vali Acc: 0.321 Test Loss: 3.167 Test Acc: 0.321
Validation loss decreased (-0.308203 --> -0.321145).  Saving model ...
Epoch: 13 cost time: 3.5896239280700684
Epoch: 13, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.141 Vali Acc: 0.331 Test Loss: 3.141 Test Acc: 0.331
Validation loss decreased (-0.321145 --> -0.330557).  Saving model ...
Epoch: 14 cost time: 3.6771514415740967
Epoch: 14, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.118 Vali Acc: 0.338 Test Loss: 3.118 Test Acc: 0.338
Validation loss decreased (-0.330557 --> -0.337616).  Saving model ...
Epoch: 15 cost time: 3.3769636154174805
Epoch: 15, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.098 Vali Acc: 0.336 Test Loss: 3.098 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.6930599212646484
Epoch: 16, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.296 Vali Acc: 0.314 Test Loss: 3.296 Test Acc: 0.314
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.3351078033447266
Epoch: 17, Steps: 10 | Train Loss: 0.072 Vali Loss: 3.327 Vali Acc: 0.334 Test Loss: 3.327 Test Acc: 0.334
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.891207218170166
Epoch: 18, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.256 Vali Acc: 0.328 Test Loss: 3.256 Test Acc: 0.328
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.6894495487213135
Epoch: 19, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.390 Vali Acc: 0.320 Test Loss: 3.390 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.645251512527466
Epoch: 20, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.314 Vali Acc: 0.342 Test Loss: 3.314 Test Acc: 0.342
Validation loss decreased (-0.337616 --> -0.342320).  Saving model ...
Epoch: 21 cost time: 3.6851806640625
Epoch: 21, Steps: 10 | Train Loss: 0.075 Vali Loss: 3.366 Vali Acc: 0.322 Test Loss: 3.366 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.64038348197937
Epoch: 22, Steps: 10 | Train Loss: 0.043 Vali Loss: 3.501 Vali Acc: 0.335 Test Loss: 3.501 Test Acc: 0.335
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.052147388458252
Epoch: 23, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.502 Vali Acc: 0.340 Test Loss: 3.502 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.744584560394287
Epoch: 24, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.769 Vali Acc: 0.302 Test Loss: 3.769 Test Acc: 0.302
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 4.3534932136535645
Epoch: 25, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.523 Vali Acc: 0.315 Test Loss: 3.523 Test Acc: 0.315
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.020715713500977
Epoch: 26, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.750 Vali Acc: 0.299 Test Loss: 3.750 Test Acc: 0.299
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.9943463802337646
Epoch: 27, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.663 Vali Acc: 0.327 Test Loss: 3.663 Test Acc: 0.327
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 4.011955738067627
Epoch: 28, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.656 Vali Acc: 0.333 Test Loss: 3.656 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.5861170291900635
Epoch: 29, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.603 Vali Acc: 0.329 Test Loss: 3.603 Test Acc: 0.329
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.280141830444336
Epoch: 30, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.698 Vali Acc: 0.329 Test Loss: 3.698 Test Acc: 0.329
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3423529411764706
model parameter : 19001818
model size : 73.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.936411142349243
Epoch: 1, Steps: 10 | Train Loss: 3.326 Vali Loss: 3.275 Vali Acc: 0.041 Test Loss: 3.275 Test Acc: 0.041
Validation loss decreased (inf --> -0.041144).  Saving model ...
Epoch: 2 cost time: 1.2759740352630615
Epoch: 2, Steps: 10 | Train Loss: 3.087 Vali Loss: 3.298 Vali Acc: 0.068 Test Loss: 3.298 Test Acc: 0.068
Validation loss decreased (-0.041144 --> -0.068202).  Saving model ...
Epoch: 3 cost time: 1.7318456172943115
Epoch: 3, Steps: 10 | Train Loss: 2.699 Vali Loss: 3.239 Vali Acc: 0.120 Test Loss: 3.239 Test Acc: 0.120
Validation loss decreased (-0.068202 --> -0.119968).  Saving model ...
Epoch: 4 cost time: 1.8540167808532715
Epoch: 4, Steps: 10 | Train Loss: 2.269 Vali Loss: 3.152 Vali Acc: 0.167 Test Loss: 3.152 Test Acc: 0.167
Validation loss decreased (-0.119968 --> -0.167027).  Saving model ...
Epoch: 5 cost time: 1.9239442348480225
Epoch: 5, Steps: 10 | Train Loss: 1.746 Vali Loss: 3.082 Vali Acc: 0.182 Test Loss: 3.082 Test Acc: 0.182
Validation loss decreased (-0.167027 --> -0.182322).  Saving model ...
Epoch: 6 cost time: 2.4952573776245117
Epoch: 6, Steps: 10 | Train Loss: 1.396 Vali Loss: 3.016 Vali Acc: 0.216 Test Loss: 3.016 Test Acc: 0.216
Validation loss decreased (-0.182322 --> -0.216440).  Saving model ...
Epoch: 7 cost time: 2.482876777648926
Epoch: 7, Steps: 10 | Train Loss: 0.982 Vali Loss: 3.028 Vali Acc: 0.231 Test Loss: 3.028 Test Acc: 0.231
Validation loss decreased (-0.216440 --> -0.230558).  Saving model ...
Epoch: 8 cost time: 2.295222759246826
Epoch: 8, Steps: 10 | Train Loss: 0.672 Vali Loss: 3.013 Vali Acc: 0.258 Test Loss: 3.013 Test Acc: 0.258
Validation loss decreased (-0.230558 --> -0.257617).  Saving model ...
Epoch: 9 cost time: 1.991915225982666
Epoch: 9, Steps: 10 | Train Loss: 0.459 Vali Loss: 2.999 Vali Acc: 0.294 Test Loss: 2.999 Test Acc: 0.294
Validation loss decreased (-0.257617 --> -0.294088).  Saving model ...
Epoch: 10 cost time: 2.204709053039551
Epoch: 10, Steps: 10 | Train Loss: 0.215 Vali Loss: 3.075 Vali Acc: 0.296 Test Loss: 3.075 Test Acc: 0.296
Validation loss decreased (-0.294088 --> -0.296440).  Saving model ...
Epoch: 11 cost time: 2.379753351211548
Epoch: 11, Steps: 10 | Train Loss: 0.147 Vali Loss: 3.096 Vali Acc: 0.308 Test Loss: 3.096 Test Acc: 0.308
Validation loss decreased (-0.296440 --> -0.308204).  Saving model ...
Epoch: 12 cost time: 2.309832811355591
Epoch: 12, Steps: 10 | Train Loss: 0.110 Vali Loss: 3.148 Vali Acc: 0.312 Test Loss: 3.148 Test Acc: 0.312
Validation loss decreased (-0.308204 --> -0.311733).  Saving model ...
Epoch: 13 cost time: 2.338906764984131
Epoch: 13, Steps: 10 | Train Loss: 0.059 Vali Loss: 3.195 Vali Acc: 0.315 Test Loss: 3.195 Test Acc: 0.315
Validation loss decreased (-0.311733 --> -0.315262).  Saving model ...
Epoch: 14 cost time: 2.609929084777832
Epoch: 14, Steps: 10 | Train Loss: 0.117 Vali Loss: 3.406 Vali Acc: 0.307 Test Loss: 3.406 Test Acc: 0.307
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.4297680854797363
Epoch: 15, Steps: 10 | Train Loss: 0.082 Vali Loss: 3.221 Vali Acc: 0.313 Test Loss: 3.221 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.6014270782470703
Epoch: 16, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.366 Vali Acc: 0.298 Test Loss: 3.366 Test Acc: 0.298
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.2942264080047607
Epoch: 17, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.266 Vali Acc: 0.309 Test Loss: 3.266 Test Acc: 0.309
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.528795003890991
Epoch: 18, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.426 Vali Acc: 0.315 Test Loss: 3.426 Test Acc: 0.315
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.542996883392334
Epoch: 19, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.319 Vali Acc: 0.328 Test Loss: 3.319 Test Acc: 0.328
Validation loss decreased (-0.315262 --> -0.328202).  Saving model ...
Epoch: 20 cost time: 2.363767147064209
Epoch: 20, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.566 Vali Acc: 0.298 Test Loss: 3.566 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.630847215652466
Epoch: 21, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.375 Vali Acc: 0.340 Test Loss: 3.375 Test Acc: 0.340
Validation loss decreased (-0.328202 --> -0.339966).  Saving model ...
Epoch: 22 cost time: 2.548809766769409
Epoch: 22, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.375 Vali Acc: 0.339 Test Loss: 3.375 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.5289342403411865
Epoch: 23, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.457 Vali Acc: 0.325 Test Loss: 3.457 Test Acc: 0.325
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.0358290672302246
Epoch: 24, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.426 Vali Acc: 0.331 Test Loss: 3.426 Test Acc: 0.331
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.500993013381958
Epoch: 25, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.510 Vali Acc: 0.335 Test Loss: 3.510 Test Acc: 0.335
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.3345723152160645
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.567 Vali Acc: 0.342 Test Loss: 3.567 Test Acc: 0.342
Validation loss decreased (-0.339966 --> -0.342317).  Saving model ...
Epoch: 27 cost time: 1.9151108264923096
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.484 Vali Acc: 0.351 Test Loss: 3.484 Test Acc: 0.351
Validation loss decreased (-0.342317 --> -0.350553).  Saving model ...
Epoch: 28 cost time: 1.9292571544647217
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.499 Vali Acc: 0.349 Test Loss: 3.499 Test Acc: 0.349
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.3436279296875
Epoch: 29, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.726 Vali Acc: 0.325 Test Loss: 3.726 Test Acc: 0.325
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.350316047668457
Epoch: 30, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.605 Vali Acc: 0.332 Test Loss: 3.605 Test Acc: 0.332
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.35058823529411764
model parameter : 5762010
model size : 23.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 8.668928384780884
Epoch: 1, Steps: 10 | Train Loss: 3.309 Vali Loss: 3.282 Vali Acc: 0.039 Test Loss: 3.282 Test Acc: 0.039
Validation loss decreased (inf --> -0.038791).  Saving model ...
Epoch: 2 cost time: 6.373194694519043
Epoch: 2, Steps: 10 | Train Loss: 3.068 Vali Loss: 3.298 Vali Acc: 0.087 Test Loss: 3.298 Test Acc: 0.087
Validation loss decreased (-0.038791 --> -0.087026).  Saving model ...
Epoch: 3 cost time: 7.13991117477417
Epoch: 3, Steps: 10 | Train Loss: 2.604 Vali Loss: 3.168 Vali Acc: 0.147 Test Loss: 3.168 Test Acc: 0.147
Validation loss decreased (-0.087026 --> -0.147027).  Saving model ...
Epoch: 4 cost time: 6.404409646987915
Epoch: 4, Steps: 10 | Train Loss: 2.108 Vali Loss: 3.072 Vali Acc: 0.173 Test Loss: 3.072 Test Acc: 0.173
Validation loss decreased (-0.147027 --> -0.172910).  Saving model ...
Epoch: 5 cost time: 7.0276477336883545
Epoch: 5, Steps: 10 | Train Loss: 1.421 Vali Loss: 3.049 Vali Acc: 0.196 Test Loss: 3.049 Test Acc: 0.196
Validation loss decreased (-0.172910 --> -0.196440).  Saving model ...
Epoch: 6 cost time: 6.786871910095215
Epoch: 6, Steps: 10 | Train Loss: 1.050 Vali Loss: 3.005 Vali Acc: 0.251 Test Loss: 3.005 Test Acc: 0.251
Validation loss decreased (-0.196440 --> -0.250558).  Saving model ...
Epoch: 7 cost time: 6.685688495635986
Epoch: 7, Steps: 10 | Train Loss: 0.583 Vali Loss: 3.025 Vali Acc: 0.260 Test Loss: 3.025 Test Acc: 0.260
Validation loss decreased (-0.250558 --> -0.259970).  Saving model ...
Epoch: 8 cost time: 6.9802305698394775
Epoch: 8, Steps: 10 | Train Loss: 0.348 Vali Loss: 3.080 Vali Acc: 0.272 Test Loss: 3.080 Test Acc: 0.272
Validation loss decreased (-0.259970 --> -0.271734).  Saving model ...
Epoch: 9 cost time: 5.811663389205933
Epoch: 9, Steps: 10 | Train Loss: 0.187 Vali Loss: 3.122 Vali Acc: 0.281 Test Loss: 3.122 Test Acc: 0.281
Validation loss decreased (-0.271734 --> -0.281145).  Saving model ...
Epoch: 10 cost time: 6.793647766113281
Epoch: 10, Steps: 10 | Train Loss: 0.091 Vali Loss: 3.136 Vali Acc: 0.288 Test Loss: 3.136 Test Acc: 0.288
Validation loss decreased (-0.281145 --> -0.288204).  Saving model ...
Epoch: 11 cost time: 6.666687250137329
Epoch: 11, Steps: 10 | Train Loss: 0.101 Vali Loss: 3.241 Vali Acc: 0.294 Test Loss: 3.241 Test Acc: 0.294
Validation loss decreased (-0.288204 --> -0.294085).  Saving model ...
Epoch: 12 cost time: 6.409827709197998
Epoch: 12, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.225 Vali Acc: 0.315 Test Loss: 3.225 Test Acc: 0.315
Validation loss decreased (-0.294085 --> -0.315262).  Saving model ...
Epoch: 13 cost time: 5.871094465255737
Epoch: 13, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.276 Vali Acc: 0.315 Test Loss: 3.276 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.442669868469238
Epoch: 14, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.190 Vali Acc: 0.312 Test Loss: 3.190 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.733245611190796
Epoch: 15, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.310 Vali Acc: 0.314 Test Loss: 3.310 Test Acc: 0.314
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.862131118774414
Epoch: 16, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.385 Vali Acc: 0.306 Test Loss: 3.385 Test Acc: 0.306
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 6.619246244430542
Epoch: 17, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.571 Vali Acc: 0.300 Test Loss: 3.571 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 6.919670343399048
Epoch: 18, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.337 Vali Acc: 0.324 Test Loss: 3.337 Test Acc: 0.324
Validation loss decreased (-0.315262 --> -0.323496).  Saving model ...
Epoch: 19 cost time: 6.934798955917358
Epoch: 19, Steps: 10 | Train Loss: 0.043 Vali Loss: 3.609 Vali Acc: 0.280 Test Loss: 3.609 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.954802751541138
Epoch: 20, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.590 Vali Acc: 0.274 Test Loss: 3.590 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 6.392779350280762
Epoch: 21, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.531 Vali Acc: 0.280 Test Loss: 3.531 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 6.88754940032959
Epoch: 22, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.554 Vali Acc: 0.305 Test Loss: 3.554 Test Acc: 0.305
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 6.513504505157471
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.595 Vali Acc: 0.309 Test Loss: 3.595 Test Acc: 0.309
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 5.858852863311768
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.578 Vali Acc: 0.315 Test Loss: 3.578 Test Acc: 0.315
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 6.314803123474121
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.593 Vali Acc: 0.312 Test Loss: 3.593 Test Acc: 0.312
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 5.918017148971558
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.596 Vali Acc: 0.313 Test Loss: 3.596 Test Acc: 0.313
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 6.382117748260498
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.607 Vali Acc: 0.312 Test Loss: 3.607 Test Acc: 0.312
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 4.98550820350647
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.619 Vali Acc: 0.312 Test Loss: 3.619 Test Acc: 0.312
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3235294117647059
model parameter : 9628634
model size : 37.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.23716402053833
Epoch: 1, Steps: 10 | Train Loss: 3.299 Vali Loss: 3.266 Vali Acc: 0.062 Test Loss: 3.266 Test Acc: 0.062
Validation loss decreased (inf --> -0.062320).  Saving model ...
Epoch: 2 cost time: 3.249605178833008
Epoch: 2, Steps: 10 | Train Loss: 3.097 Vali Loss: 3.297 Vali Acc: 0.080 Test Loss: 3.297 Test Acc: 0.080
Validation loss decreased (-0.062320 --> -0.079967).  Saving model ...
Epoch: 3 cost time: 3.197340965270996
Epoch: 3, Steps: 10 | Train Loss: 2.694 Vali Loss: 3.219 Vali Acc: 0.139 Test Loss: 3.219 Test Acc: 0.139
Validation loss decreased (-0.079967 --> -0.138791).  Saving model ...
Epoch: 4 cost time: 3.3813278675079346
Epoch: 4, Steps: 10 | Train Loss: 2.167 Vali Loss: 3.072 Vali Acc: 0.172 Test Loss: 3.072 Test Acc: 0.172
Validation loss decreased (-0.138791 --> -0.171734).  Saving model ...
Epoch: 5 cost time: 3.312497854232788
Epoch: 5, Steps: 10 | Train Loss: 1.678 Vali Loss: 2.991 Vali Acc: 0.216 Test Loss: 2.991 Test Acc: 0.216
Validation loss decreased (-0.171734 --> -0.216441).  Saving model ...
Epoch: 6 cost time: 3.444875478744507
Epoch: 6, Steps: 10 | Train Loss: 1.200 Vali Loss: 2.973 Vali Acc: 0.231 Test Loss: 2.973 Test Acc: 0.231
Validation loss decreased (-0.216441 --> -0.230559).  Saving model ...
Epoch: 7 cost time: 3.325986385345459
Epoch: 7, Steps: 10 | Train Loss: 0.800 Vali Loss: 2.964 Vali Acc: 0.259 Test Loss: 2.964 Test Acc: 0.259
Validation loss decreased (-0.230559 --> -0.258794).  Saving model ...
Epoch: 8 cost time: 3.243924617767334
Epoch: 8, Steps: 10 | Train Loss: 0.495 Vali Loss: 2.949 Vali Acc: 0.289 Test Loss: 2.949 Test Acc: 0.289
Validation loss decreased (-0.258794 --> -0.289382).  Saving model ...
Epoch: 9 cost time: 3.066927433013916
Epoch: 9, Steps: 10 | Train Loss: 0.258 Vali Loss: 3.047 Vali Acc: 0.285 Test Loss: 3.047 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.153596878051758
Epoch: 10, Steps: 10 | Train Loss: 0.175 Vali Loss: 3.051 Vali Acc: 0.301 Test Loss: 3.051 Test Acc: 0.301
Validation loss decreased (-0.289382 --> -0.301146).  Saving model ...
Epoch: 11 cost time: 3.0991106033325195
Epoch: 11, Steps: 10 | Train Loss: 0.078 Vali Loss: 3.127 Vali Acc: 0.316 Test Loss: 3.127 Test Acc: 0.316
Validation loss decreased (-0.301146 --> -0.316439).  Saving model ...
Epoch: 12 cost time: 3.3214242458343506
Epoch: 12, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.113 Vali Acc: 0.324 Test Loss: 3.113 Test Acc: 0.324
Validation loss decreased (-0.316439 --> -0.323498).  Saving model ...
Epoch: 13 cost time: 3.3695337772369385
Epoch: 13, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.174 Vali Acc: 0.319 Test Loss: 3.174 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.3837645053863525
Epoch: 14, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.233 Vali Acc: 0.314 Test Loss: 3.233 Test Acc: 0.314
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.12978196144104
Epoch: 15, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.177 Vali Acc: 0.320 Test Loss: 3.177 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.7437212467193604
Epoch: 16, Steps: 10 | Train Loss: 0.095 Vali Loss: 3.245 Vali Acc: 0.316 Test Loss: 3.245 Test Acc: 0.316
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.8865997791290283
Epoch: 17, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.328 Vali Acc: 0.299 Test Loss: 3.328 Test Acc: 0.299
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.119828462600708
Epoch: 18, Steps: 10 | Train Loss: 0.064 Vali Loss: 3.283 Vali Acc: 0.334 Test Loss: 3.283 Test Acc: 0.334
Validation loss decreased (-0.323498 --> -0.334085).  Saving model ...
Epoch: 19 cost time: 3.219636917114258
Epoch: 19, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.309 Vali Acc: 0.318 Test Loss: 3.309 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.986053705215454
Epoch: 20, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.428 Vali Acc: 0.305 Test Loss: 3.428 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.4264883995056152
Epoch: 21, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.426 Vali Acc: 0.312 Test Loss: 3.426 Test Acc: 0.312
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.3409476280212402
Epoch: 22, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.303 Vali Acc: 0.328 Test Loss: 3.303 Test Acc: 0.328
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.4144108295440674
Epoch: 23, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.312 Vali Acc: 0.325 Test Loss: 3.312 Test Acc: 0.325
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.02020263671875
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.335 Vali Acc: 0.333 Test Loss: 3.335 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.474945306777954
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.365 Vali Acc: 0.332 Test Loss: 3.365 Test Acc: 0.332
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.4911577701568604
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.396 Vali Acc: 0.339 Test Loss: 3.396 Test Acc: 0.339
Validation loss decreased (-0.334085 --> -0.338790).  Saving model ...
Epoch: 27 cost time: 3.5834522247314453
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.412 Vali Acc: 0.334 Test Loss: 3.412 Test Acc: 0.334
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.4630231857299805
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.419 Vali Acc: 0.336 Test Loss: 3.419 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.9710936546325684
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.436 Vali Acc: 0.340 Test Loss: 3.436 Test Acc: 0.340
Validation loss decreased (-0.338790 --> -0.339966).  Saving model ...
Epoch: 30 cost time: 3.4808783531188965
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.462 Vali Acc: 0.338 Test Loss: 3.462 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.34
model parameter : 3008474
model size : 12.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 6.790842294692993
Epoch: 1, Steps: 10 | Train Loss: 3.305 Vali Loss: 3.282 Vali Acc: 0.039 Test Loss: 3.282 Test Acc: 0.039
Validation loss decreased (inf --> -0.038791).  Saving model ...
Epoch: 2 cost time: 5.104953765869141
Epoch: 2, Steps: 10 | Train Loss: 3.066 Vali Loss: 3.303 Vali Acc: 0.095 Test Loss: 3.303 Test Acc: 0.095
Validation loss decreased (-0.038791 --> -0.095261).  Saving model ...
Epoch: 3 cost time: 4.942424297332764
Epoch: 3, Steps: 10 | Train Loss: 2.628 Vali Loss: 3.176 Vali Acc: 0.134 Test Loss: 3.176 Test Acc: 0.134
Validation loss decreased (-0.095261 --> -0.134086).  Saving model ...
Epoch: 4 cost time: 4.915715932846069
Epoch: 4, Steps: 10 | Train Loss: 2.184 Vali Loss: 3.082 Vali Acc: 0.176 Test Loss: 3.082 Test Acc: 0.176
Validation loss decreased (-0.134086 --> -0.176440).  Saving model ...
Epoch: 5 cost time: 5.064396381378174
Epoch: 5, Steps: 10 | Train Loss: 1.511 Vali Loss: 3.044 Vali Acc: 0.214 Test Loss: 3.044 Test Acc: 0.214
Validation loss decreased (-0.176440 --> -0.214087).  Saving model ...
Epoch: 6 cost time: 4.951601266860962
Epoch: 6, Steps: 10 | Train Loss: 1.152 Vali Loss: 3.065 Vali Acc: 0.231 Test Loss: 3.065 Test Acc: 0.231
Validation loss decreased (-0.214087 --> -0.230558).  Saving model ...
Epoch: 7 cost time: 4.870136737823486
Epoch: 7, Steps: 10 | Train Loss: 0.750 Vali Loss: 3.054 Vali Acc: 0.240 Test Loss: 3.054 Test Acc: 0.240
Validation loss decreased (-0.230558 --> -0.239969).  Saving model ...
Epoch: 8 cost time: 4.380414962768555
Epoch: 8, Steps: 10 | Train Loss: 0.544 Vali Loss: 3.099 Vali Acc: 0.268 Test Loss: 3.099 Test Acc: 0.268
Validation loss decreased (-0.239969 --> -0.268204).  Saving model ...
Epoch: 9 cost time: 4.706569194793701
Epoch: 9, Steps: 10 | Train Loss: 0.269 Vali Loss: 3.072 Vali Acc: 0.292 Test Loss: 3.072 Test Acc: 0.292
Validation loss decreased (-0.268204 --> -0.291734).  Saving model ...
Epoch: 10 cost time: 4.648213863372803
Epoch: 10, Steps: 10 | Train Loss: 0.190 Vali Loss: 3.117 Vali Acc: 0.300 Test Loss: 3.117 Test Acc: 0.300
Validation loss decreased (-0.291734 --> -0.299969).  Saving model ...
Epoch: 11 cost time: 4.8495934009552
Epoch: 11, Steps: 10 | Train Loss: 0.128 Vali Loss: 3.241 Vali Acc: 0.316 Test Loss: 3.241 Test Acc: 0.316
Validation loss decreased (-0.299969 --> -0.316438).  Saving model ...
Epoch: 12 cost time: 4.529120206832886
Epoch: 12, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.201 Vali Acc: 0.324 Test Loss: 3.201 Test Acc: 0.324
Validation loss decreased (-0.316438 --> -0.323497).  Saving model ...
Epoch: 13 cost time: 4.4657511711120605
Epoch: 13, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.300 Vali Acc: 0.322 Test Loss: 3.300 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.49213719367981
Epoch: 14, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.331 Vali Acc: 0.311 Test Loss: 3.331 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.0315141677856445
Epoch: 15, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.355 Vali Acc: 0.333 Test Loss: 3.355 Test Acc: 0.333
Validation loss decreased (-0.323497 --> -0.332908).  Saving model ...
Epoch: 16 cost time: 4.647140026092529
Epoch: 16, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.309 Vali Acc: 0.342 Test Loss: 3.309 Test Acc: 0.342
Validation loss decreased (-0.332908 --> -0.342320).  Saving model ...
Epoch: 17 cost time: 4.73288631439209
Epoch: 17, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.355 Vali Acc: 0.344 Test Loss: 3.355 Test Acc: 0.344
Validation loss decreased (-0.342320 --> -0.343496).  Saving model ...
Epoch: 18 cost time: 5.140764951705933
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.418 Vali Acc: 0.339 Test Loss: 3.418 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.028529405593872
Epoch: 19, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.402 Vali Acc: 0.340 Test Loss: 3.402 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.396849632263184
Epoch: 20, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.451 Vali Acc: 0.336 Test Loss: 3.451 Test Acc: 0.336
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.759206771850586
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.552 Vali Acc: 0.319 Test Loss: 3.552 Test Acc: 0.319
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.717913866043091
Epoch: 22, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.565 Vali Acc: 0.300 Test Loss: 3.565 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.125514030456543
Epoch: 23, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.372 Vali Acc: 0.342 Test Loss: 3.372 Test Acc: 0.342
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.3351707458496094
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.645 Vali Acc: 0.315 Test Loss: 3.645 Test Acc: 0.315
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 4.507250070571899
Epoch: 25, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.547 Vali Acc: 0.335 Test Loss: 3.547 Test Acc: 0.335
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 4.479165315628052
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.471 Vali Acc: 0.340 Test Loss: 3.471 Test Acc: 0.340
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 4.962578535079956
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.518 Vali Acc: 0.329 Test Loss: 3.518 Test Acc: 0.329
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.34352941176470586
model parameter : 9628634
model size : 37.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.3317506313323975
Epoch: 1, Steps: 10 | Train Loss: 3.298 Vali Loss: 3.263 Vali Acc: 0.068 Test Loss: 3.263 Test Acc: 0.068
Validation loss decreased (inf --> -0.068203).  Saving model ...
Epoch: 2 cost time: 2.2097644805908203
Epoch: 2, Steps: 10 | Train Loss: 3.088 Vali Loss: 3.297 Vali Acc: 0.079 Test Loss: 3.297 Test Acc: 0.079
Validation loss decreased (-0.068203 --> -0.078791).  Saving model ...
Epoch: 3 cost time: 2.7821707725524902
Epoch: 3, Steps: 10 | Train Loss: 2.711 Vali Loss: 3.228 Vali Acc: 0.135 Test Loss: 3.228 Test Acc: 0.135
Validation loss decreased (-0.078791 --> -0.135262).  Saving model ...
Epoch: 4 cost time: 2.581289052963257
Epoch: 4, Steps: 10 | Train Loss: 2.199 Vali Loss: 3.085 Vali Acc: 0.166 Test Loss: 3.085 Test Acc: 0.166
Validation loss decreased (-0.135262 --> -0.165852).  Saving model ...
Epoch: 5 cost time: 2.7222001552581787
Epoch: 5, Steps: 10 | Train Loss: 1.722 Vali Loss: 3.008 Vali Acc: 0.201 Test Loss: 3.008 Test Acc: 0.201
Validation loss decreased (-0.165852 --> -0.201146).  Saving model ...
Epoch: 6 cost time: 2.755896806716919
Epoch: 6, Steps: 10 | Train Loss: 1.241 Vali Loss: 2.982 Vali Acc: 0.225 Test Loss: 2.982 Test Acc: 0.225
Validation loss decreased (-0.201146 --> -0.224676).  Saving model ...
Epoch: 7 cost time: 2.3358712196350098
Epoch: 7, Steps: 10 | Train Loss: 0.898 Vali Loss: 2.983 Vali Acc: 0.259 Test Loss: 2.983 Test Acc: 0.259
Validation loss decreased (-0.224676 --> -0.258794).  Saving model ...
Epoch: 8 cost time: 2.7956361770629883
Epoch: 8, Steps: 10 | Train Loss: 0.565 Vali Loss: 2.933 Vali Acc: 0.266 Test Loss: 2.933 Test Acc: 0.266
Validation loss decreased (-0.258794 --> -0.265853).  Saving model ...
Epoch: 9 cost time: 2.5269198417663574
Epoch: 9, Steps: 10 | Train Loss: 0.396 Vali Loss: 3.062 Vali Acc: 0.265 Test Loss: 3.062 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.7275872230529785
Epoch: 10, Steps: 10 | Train Loss: 0.261 Vali Loss: 3.018 Vali Acc: 0.295 Test Loss: 3.018 Test Acc: 0.295
Validation loss decreased (-0.265853 --> -0.295264).  Saving model ...
Epoch: 11 cost time: 2.6112945079803467
Epoch: 11, Steps: 10 | Train Loss: 0.123 Vali Loss: 3.120 Vali Acc: 0.315 Test Loss: 3.120 Test Acc: 0.315
Validation loss decreased (-0.295264 --> -0.315263).  Saving model ...
Epoch: 12 cost time: 2.2894747257232666
Epoch: 12, Steps: 10 | Train Loss: 0.110 Vali Loss: 3.176 Vali Acc: 0.315 Test Loss: 3.176 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.706793785095215
Epoch: 13, Steps: 10 | Train Loss: 0.076 Vali Loss: 3.229 Vali Acc: 0.324 Test Loss: 3.229 Test Acc: 0.324
Validation loss decreased (-0.315263 --> -0.323497).  Saving model ...
Epoch: 14 cost time: 2.4619362354278564
Epoch: 14, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.287 Vali Acc: 0.302 Test Loss: 3.287 Test Acc: 0.302
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.474976062774658
Epoch: 15, Steps: 10 | Train Loss: 0.082 Vali Loss: 3.283 Vali Acc: 0.299 Test Loss: 3.283 Test Acc: 0.299
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.47583270072937
Epoch: 16, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.326 Vali Acc: 0.329 Test Loss: 3.326 Test Acc: 0.329
Validation loss decreased (-0.323497 --> -0.329379).  Saving model ...
Epoch: 17 cost time: 2.1931324005126953
Epoch: 17, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.340 Vali Acc: 0.321 Test Loss: 3.340 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.5787391662597656
Epoch: 18, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.300 Vali Acc: 0.336 Test Loss: 3.300 Test Acc: 0.336
Validation loss decreased (-0.329379 --> -0.336438).  Saving model ...
Epoch: 19 cost time: 2.199399709701538
Epoch: 19, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.335 Vali Acc: 0.332 Test Loss: 3.335 Test Acc: 0.332
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.7851839065551758
Epoch: 20, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.328 Vali Acc: 0.331 Test Loss: 3.328 Test Acc: 0.331
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.6360514163970947
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.390 Vali Acc: 0.328 Test Loss: 3.390 Test Acc: 0.328
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.1028242111206055
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.380 Vali Acc: 0.341 Test Loss: 3.380 Test Acc: 0.341
Validation loss decreased (-0.336438 --> -0.341143).  Saving model ...
Epoch: 23 cost time: 2.6560776233673096
Epoch: 23, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.449 Vali Acc: 0.335 Test Loss: 3.449 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.3166418075561523
Epoch: 24, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.640 Vali Acc: 0.311 Test Loss: 3.640 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.447850465774536
Epoch: 25, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.669 Vali Acc: 0.307 Test Loss: 3.669 Test Acc: 0.307
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.508173942565918
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.565 Vali Acc: 0.332 Test Loss: 3.565 Test Acc: 0.332
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.206183910369873
Epoch: 27, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.632 Vali Acc: 0.344 Test Loss: 3.632 Test Acc: 0.344
Validation loss decreased (-0.341143 --> -0.343493).  Saving model ...
Epoch: 28 cost time: 1.8265008926391602
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.528 Vali Acc: 0.355 Test Loss: 3.528 Test Acc: 0.355
Validation loss decreased (-0.343493 --> -0.355259).  Saving model ...
Epoch: 29 cost time: 2.7244322299957275
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.493 Vali Acc: 0.346 Test Loss: 3.493 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.8063695430755615
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.508 Vali Acc: 0.344 Test Loss: 3.508 Test Acc: 0.344
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3552941176470588
model parameter : 3008474
model size : 12.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.797646999359131
Epoch: 1, Steps: 10 | Train Loss: 3.303 Vali Loss: 3.289 Vali Acc: 0.035 Test Loss: 3.289 Test Acc: 0.035
Validation loss decreased (inf --> -0.035261).  Saving model ...
Epoch: 2 cost time: 3.432311534881592
Epoch: 2, Steps: 10 | Train Loss: 3.106 Vali Loss: 3.325 Vali Acc: 0.079 Test Loss: 3.325 Test Acc: 0.079
Validation loss decreased (-0.035261 --> -0.078790).  Saving model ...
Epoch: 3 cost time: 3.453185558319092
Epoch: 3, Steps: 10 | Train Loss: 2.695 Vali Loss: 3.218 Vali Acc: 0.116 Test Loss: 3.218 Test Acc: 0.116
Validation loss decreased (-0.078790 --> -0.116438).  Saving model ...
Epoch: 4 cost time: 3.5498766899108887
Epoch: 4, Steps: 10 | Train Loss: 2.322 Vali Loss: 3.112 Vali Acc: 0.172 Test Loss: 3.112 Test Acc: 0.172
Validation loss decreased (-0.116438 --> -0.171734).  Saving model ...
Epoch: 5 cost time: 2.8715271949768066
Epoch: 5, Steps: 10 | Train Loss: 1.759 Vali Loss: 3.119 Vali Acc: 0.205 Test Loss: 3.119 Test Acc: 0.205
Validation loss decreased (-0.171734 --> -0.204675).  Saving model ...
Epoch: 6 cost time: 2.6709365844726562
Epoch: 6, Steps: 10 | Train Loss: 1.309 Vali Loss: 3.056 Vali Acc: 0.254 Test Loss: 3.056 Test Acc: 0.254
Validation loss decreased (-0.204675 --> -0.254087).  Saving model ...
Epoch: 7 cost time: 2.470757007598877
Epoch: 7, Steps: 10 | Train Loss: 0.793 Vali Loss: 3.063 Vali Acc: 0.262 Test Loss: 3.063 Test Acc: 0.262
Validation loss decreased (-0.254087 --> -0.262322).  Saving model ...
Epoch: 8 cost time: 2.569103717803955
Epoch: 8, Steps: 10 | Train Loss: 0.475 Vali Loss: 3.039 Vali Acc: 0.306 Test Loss: 3.039 Test Acc: 0.306
Validation loss decreased (-0.262322 --> -0.305852).  Saving model ...
Epoch: 9 cost time: 2.4399750232696533
Epoch: 9, Steps: 10 | Train Loss: 0.229 Vali Loss: 3.110 Vali Acc: 0.313 Test Loss: 3.110 Test Acc: 0.313
Validation loss decreased (-0.305852 --> -0.312910).  Saving model ...
Epoch: 10 cost time: 2.243952751159668
Epoch: 10, Steps: 10 | Train Loss: 0.084 Vali Loss: 3.183 Vali Acc: 0.308 Test Loss: 3.183 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8537883758544922
Epoch: 11, Steps: 10 | Train Loss: 0.234 Vali Loss: 3.218 Vali Acc: 0.309 Test Loss: 3.218 Test Acc: 0.309
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.37762451171875
Epoch: 12, Steps: 10 | Train Loss: 0.063 Vali Loss: 3.200 Vali Acc: 0.319 Test Loss: 3.200 Test Acc: 0.319
Validation loss decreased (-0.312910 --> -0.318792).  Saving model ...
Epoch: 13 cost time: 2.8498218059539795
Epoch: 13, Steps: 10 | Train Loss: 0.070 Vali Loss: 3.362 Vali Acc: 0.314 Test Loss: 3.362 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.6248812675476074
Epoch: 14, Steps: 10 | Train Loss: 0.058 Vali Loss: 3.308 Vali Acc: 0.316 Test Loss: 3.308 Test Acc: 0.316
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.610441207885742
Epoch: 15, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.343 Vali Acc: 0.335 Test Loss: 3.343 Test Acc: 0.335
Validation loss decreased (-0.318792 --> -0.335261).  Saving model ...
Epoch: 16 cost time: 3.0082294940948486
Epoch: 16, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.438 Vali Acc: 0.305 Test Loss: 3.438 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.4283206462860107
Epoch: 17, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.504 Vali Acc: 0.307 Test Loss: 3.504 Test Acc: 0.307
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.7399380207061768
Epoch: 18, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.405 Vali Acc: 0.329 Test Loss: 3.405 Test Acc: 0.329
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.810029983520508
Epoch: 19, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.404 Vali Acc: 0.340 Test Loss: 3.404 Test Acc: 0.340
Validation loss decreased (-0.335261 --> -0.339966).  Saving model ...
Epoch: 20 cost time: 2.1940343379974365
Epoch: 20, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.524 Vali Acc: 0.336 Test Loss: 3.524 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.446930170059204
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.442 Vali Acc: 0.340 Test Loss: 3.442 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.9811859130859375
Epoch: 22, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.481 Vali Acc: 0.340 Test Loss: 3.481 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.057680606842041
Epoch: 23, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.420 Vali Acc: 0.335 Test Loss: 3.420 Test Acc: 0.335
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.7384376525878906
Epoch: 24, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.452 Vali Acc: 0.325 Test Loss: 3.452 Test Acc: 0.325
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.7725706100463867
Epoch: 25, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.780 Vali Acc: 0.304 Test Loss: 3.780 Test Acc: 0.304
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.748657703399658
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.619 Vali Acc: 0.327 Test Loss: 3.619 Test Acc: 0.327
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.3152365684509277
Epoch: 27, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.791 Vali Acc: 0.299 Test Loss: 3.791 Test Acc: 0.299
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.6555700302124023
Epoch: 28, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.795 Vali Acc: 0.304 Test Loss: 3.795 Test Acc: 0.304
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.733982563018799
Epoch: 29, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.552 Vali Acc: 0.332 Test Loss: 3.552 Test Acc: 0.332
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.34
model parameter : 9628634
model size : 37.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.71958589553833
Epoch: 1, Steps: 10 | Train Loss: 3.284 Vali Loss: 3.265 Vali Acc: 0.062 Test Loss: 3.265 Test Acc: 0.062
Validation loss decreased (inf --> -0.062320).  Saving model ...
Epoch: 2 cost time: 1.3830382823944092
Epoch: 2, Steps: 10 | Train Loss: 3.083 Vali Loss: 3.311 Vali Acc: 0.081 Test Loss: 3.311 Test Acc: 0.081
Validation loss decreased (-0.062320 --> -0.081143).  Saving model ...
Epoch: 3 cost time: 1.5138752460479736
Epoch: 3, Steps: 10 | Train Loss: 2.779 Vali Loss: 3.263 Vali Acc: 0.120 Test Loss: 3.263 Test Acc: 0.120
Validation loss decreased (-0.081143 --> -0.119967).  Saving model ...
Epoch: 4 cost time: 1.4707820415496826
Epoch: 4, Steps: 10 | Train Loss: 2.343 Vali Loss: 3.140 Vali Acc: 0.162 Test Loss: 3.140 Test Acc: 0.162
Validation loss decreased (-0.119967 --> -0.162322).  Saving model ...
Epoch: 5 cost time: 1.5065789222717285
Epoch: 5, Steps: 10 | Train Loss: 1.885 Vali Loss: 3.072 Vali Acc: 0.193 Test Loss: 3.072 Test Acc: 0.193
Validation loss decreased (-0.162322 --> -0.192910).  Saving model ...
Epoch: 6 cost time: 1.635939598083496
Epoch: 6, Steps: 10 | Train Loss: 1.421 Vali Loss: 3.077 Vali Acc: 0.205 Test Loss: 3.077 Test Acc: 0.205
Validation loss decreased (-0.192910 --> -0.204675).  Saving model ...
Epoch: 7 cost time: 1.6778895854949951
Epoch: 7, Steps: 10 | Train Loss: 1.074 Vali Loss: 3.105 Vali Acc: 0.229 Test Loss: 3.105 Test Acc: 0.229
Validation loss decreased (-0.204675 --> -0.229381).  Saving model ...
Epoch: 8 cost time: 1.8445641994476318
Epoch: 8, Steps: 10 | Train Loss: 0.720 Vali Loss: 3.101 Vali Acc: 0.256 Test Loss: 3.101 Test Acc: 0.256
Validation loss decreased (-0.229381 --> -0.256440).  Saving model ...
Epoch: 9 cost time: 1.8933141231536865
Epoch: 9, Steps: 10 | Train Loss: 0.493 Vali Loss: 3.157 Vali Acc: 0.275 Test Loss: 3.157 Test Acc: 0.275
Validation loss decreased (-0.256440 --> -0.275263).  Saving model ...
Epoch: 10 cost time: 1.5802037715911865
Epoch: 10, Steps: 10 | Train Loss: 0.343 Vali Loss: 3.169 Vali Acc: 0.289 Test Loss: 3.169 Test Acc: 0.289
Validation loss decreased (-0.275263 --> -0.289380).  Saving model ...
Epoch: 11 cost time: 1.2908141613006592
Epoch: 11, Steps: 10 | Train Loss: 0.263 Vali Loss: 3.182 Vali Acc: 0.300 Test Loss: 3.182 Test Acc: 0.300
Validation loss decreased (-0.289380 --> -0.299968).  Saving model ...
Epoch: 12 cost time: 1.9598639011383057
Epoch: 12, Steps: 10 | Train Loss: 0.142 Vali Loss: 3.194 Vali Acc: 0.301 Test Loss: 3.194 Test Acc: 0.301
Validation loss decreased (-0.299968 --> -0.301145).  Saving model ...
Epoch: 13 cost time: 1.776637315750122
Epoch: 13, Steps: 10 | Train Loss: 0.137 Vali Loss: 3.294 Vali Acc: 0.315 Test Loss: 3.294 Test Acc: 0.315
Validation loss decreased (-0.301145 --> -0.315261).  Saving model ...
Epoch: 14 cost time: 1.9754009246826172
Epoch: 14, Steps: 10 | Train Loss: 0.079 Vali Loss: 3.287 Vali Acc: 0.319 Test Loss: 3.287 Test Acc: 0.319
Validation loss decreased (-0.315261 --> -0.318791).  Saving model ...
Epoch: 15 cost time: 1.724968671798706
Epoch: 15, Steps: 10 | Train Loss: 0.058 Vali Loss: 3.326 Vali Acc: 0.325 Test Loss: 3.326 Test Acc: 0.325
Validation loss decreased (-0.318791 --> -0.324673).  Saving model ...
Epoch: 16 cost time: 2.003004789352417
Epoch: 16, Steps: 10 | Train Loss: 0.043 Vali Loss: 3.563 Vali Acc: 0.295 Test Loss: 3.563 Test Acc: 0.295
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9600615501403809
Epoch: 17, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.404 Vali Acc: 0.328 Test Loss: 3.404 Test Acc: 0.328
Validation loss decreased (-0.324673 --> -0.328201).  Saving model ...
Epoch: 18 cost time: 2.0114943981170654
Epoch: 18, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.423 Vali Acc: 0.335 Test Loss: 3.423 Test Acc: 0.335
Validation loss decreased (-0.328201 --> -0.335260).  Saving model ...
Epoch: 19 cost time: 2.0832080841064453
Epoch: 19, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.642 Vali Acc: 0.320 Test Loss: 3.642 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.9555141925811768
Epoch: 20, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.585 Vali Acc: 0.332 Test Loss: 3.585 Test Acc: 0.332
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.0283586978912354
Epoch: 21, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.595 Vali Acc: 0.333 Test Loss: 3.595 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.085610866546631
Epoch: 22, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.557 Vali Acc: 0.340 Test Loss: 3.557 Test Acc: 0.340
Validation loss decreased (-0.335260 --> -0.339964).  Saving model ...
Epoch: 23 cost time: 1.8069398403167725
Epoch: 23, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.598 Vali Acc: 0.336 Test Loss: 3.598 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.939136266708374
Epoch: 24, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.584 Vali Acc: 0.342 Test Loss: 3.584 Test Acc: 0.342
Validation loss decreased (-0.339964 --> -0.342317).  Saving model ...
Epoch: 25 cost time: 1.7066478729248047
Epoch: 25, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.728 Vali Acc: 0.334 Test Loss: 3.728 Test Acc: 0.334
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.9284722805023193
Epoch: 26, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.740 Vali Acc: 0.328 Test Loss: 3.740 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.008099317550659
Epoch: 27, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.635 Vali Acc: 0.341 Test Loss: 3.635 Test Acc: 0.341
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.882716417312622
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.653 Vali Acc: 0.342 Test Loss: 3.653 Test Acc: 0.342
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.968916654586792
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.773 Vali Acc: 0.327 Test Loss: 3.773 Test Acc: 0.327
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.8971443176269531
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.638 Vali Acc: 0.340 Test Loss: 3.638 Test Acc: 0.340
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3423529411764706
model parameter : 3008474
model size : 12.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.264113903045654
Epoch: 1, Steps: 10 | Train Loss: 3.282 Vali Loss: 3.284 Vali Acc: 0.039 Test Loss: 3.284 Test Acc: 0.039
Validation loss decreased (inf --> -0.038791).  Saving model ...
Epoch: 2 cost time: 5.879381895065308
Epoch: 2, Steps: 10 | Train Loss: 3.132 Vali Loss: 3.262 Vali Acc: 0.061 Test Loss: 3.262 Test Acc: 0.061
Validation loss decreased (-0.038791 --> -0.061144).  Saving model ...
Epoch: 3 cost time: 6.248029947280884
Epoch: 3, Steps: 10 | Train Loss: 2.805 Vali Loss: 3.226 Vali Acc: 0.109 Test Loss: 3.226 Test Acc: 0.109
Validation loss decreased (-0.061144 --> -0.109380).  Saving model ...
Epoch: 4 cost time: 6.2228102684021
Epoch: 4, Steps: 10 | Train Loss: 2.539 Vali Loss: 3.162 Vali Acc: 0.133 Test Loss: 3.162 Test Acc: 0.133
Validation loss decreased (-0.109380 --> -0.132910).  Saving model ...
Epoch: 5 cost time: 6.607246160507202
Epoch: 5, Steps: 10 | Train Loss: 2.177 Vali Loss: 3.105 Vali Acc: 0.142 Test Loss: 3.105 Test Acc: 0.142
Validation loss decreased (-0.132910 --> -0.142322).  Saving model ...
Epoch: 6 cost time: 6.744210720062256
Epoch: 6, Steps: 10 | Train Loss: 1.896 Vali Loss: 3.066 Vali Acc: 0.173 Test Loss: 3.066 Test Acc: 0.173
Validation loss decreased (-0.142322 --> -0.172911).  Saving model ...
Epoch: 7 cost time: 6.668962717056274
Epoch: 7, Steps: 10 | Train Loss: 1.581 Vali Loss: 3.007 Vali Acc: 0.187 Test Loss: 3.007 Test Acc: 0.187
Validation loss decreased (-0.172911 --> -0.187029).  Saving model ...
Epoch: 8 cost time: 6.662281274795532
Epoch: 8, Steps: 10 | Train Loss: 1.203 Vali Loss: 2.974 Vali Acc: 0.219 Test Loss: 2.974 Test Acc: 0.219
Validation loss decreased (-0.187029 --> -0.218794).  Saving model ...
Epoch: 9 cost time: 6.684687376022339
Epoch: 9, Steps: 10 | Train Loss: 0.923 Vali Loss: 2.989 Vali Acc: 0.222 Test Loss: 2.989 Test Acc: 0.222
Validation loss decreased (-0.218794 --> -0.222323).  Saving model ...
Epoch: 10 cost time: 5.067138671875
Epoch: 10, Steps: 10 | Train Loss: 0.681 Vali Loss: 2.964 Vali Acc: 0.268 Test Loss: 2.964 Test Acc: 0.268
Validation loss decreased (-0.222323 --> -0.268206).  Saving model ...
Epoch: 11 cost time: 6.227344036102295
Epoch: 11, Steps: 10 | Train Loss: 0.400 Vali Loss: 2.951 Vali Acc: 0.274 Test Loss: 2.951 Test Acc: 0.274
Validation loss decreased (-0.268206 --> -0.274088).  Saving model ...
Epoch: 12 cost time: 6.272056579589844
Epoch: 12, Steps: 10 | Train Loss: 0.265 Vali Loss: 3.066 Vali Acc: 0.272 Test Loss: 3.066 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.867605686187744
Epoch: 13, Steps: 10 | Train Loss: 0.176 Vali Loss: 3.021 Vali Acc: 0.278 Test Loss: 3.021 Test Acc: 0.278
Validation loss decreased (-0.274088 --> -0.277617).  Saving model ...
Epoch: 14 cost time: 6.213217258453369
Epoch: 14, Steps: 10 | Train Loss: 0.109 Vali Loss: 3.075 Vali Acc: 0.293 Test Loss: 3.075 Test Acc: 0.293
Validation loss decreased (-0.277617 --> -0.292910).  Saving model ...
Epoch: 15 cost time: 6.039936304092407
Epoch: 15, Steps: 10 | Train Loss: 0.119 Vali Loss: 3.106 Vali Acc: 0.285 Test Loss: 3.106 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.4201319217681885
Epoch: 16, Steps: 10 | Train Loss: 0.078 Vali Loss: 3.172 Vali Acc: 0.288 Test Loss: 3.172 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.333703279495239
Epoch: 17, Steps: 10 | Train Loss: 0.097 Vali Loss: 3.170 Vali Acc: 0.299 Test Loss: 3.170 Test Acc: 0.299
Validation loss decreased (-0.292910 --> -0.298792).  Saving model ...
Epoch: 18 cost time: 6.6015636920928955
Epoch: 18, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.088 Vali Acc: 0.320 Test Loss: 3.088 Test Acc: 0.320
Validation loss decreased (-0.298792 --> -0.319969).  Saving model ...
Epoch: 19 cost time: 6.212123870849609
Epoch: 19, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.152 Vali Acc: 0.314 Test Loss: 3.152 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.657198905944824
Epoch: 20, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.188 Vali Acc: 0.306 Test Loss: 3.188 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 6.171505689620972
Epoch: 21, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.131 Vali Acc: 0.322 Test Loss: 3.131 Test Acc: 0.322
Validation loss decreased (-0.319969 --> -0.322322).  Saving model ...
Epoch: 22 cost time: 6.236239194869995
Epoch: 22, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.143 Vali Acc: 0.311 Test Loss: 3.143 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 6.058690786361694
Epoch: 23, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.207 Vali Acc: 0.308 Test Loss: 3.207 Test Acc: 0.308
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.781359672546387
Epoch: 24, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.183 Vali Acc: 0.320 Test Loss: 3.183 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 6.495635032653809
Epoch: 25, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.195 Vali Acc: 0.318 Test Loss: 3.195 Test Acc: 0.318
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 6.124637842178345
Epoch: 26, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.236 Vali Acc: 0.320 Test Loss: 3.236 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 5.551646709442139
Epoch: 27, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.241 Vali Acc: 0.334 Test Loss: 3.241 Test Acc: 0.334
Validation loss decreased (-0.322322 --> -0.334085).  Saving model ...
Epoch: 28 cost time: 5.91054892539978
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.222 Vali Acc: 0.328 Test Loss: 3.222 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 6.150634527206421
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.225 Vali Acc: 0.326 Test Loss: 3.225 Test Acc: 0.326
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 5.647615194320679
Epoch: 30, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.233 Vali Acc: 0.326 Test Loss: 3.233 Test Acc: 0.326
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3341176470588235
model parameter : 9502458
model size : 36.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.3828125
Epoch: 1, Steps: 10 | Train Loss: 3.289 Vali Loss: 3.307 Vali Acc: 0.045 Test Loss: 3.307 Test Acc: 0.045
Validation loss decreased (inf --> -0.044673).  Saving model ...
Epoch: 2 cost time: 2.5360472202301025
Epoch: 2, Steps: 10 | Train Loss: 3.108 Vali Loss: 3.283 Vali Acc: 0.056 Test Loss: 3.283 Test Acc: 0.056
Validation loss decreased (-0.044673 --> -0.056438).  Saving model ...
Epoch: 3 cost time: 2.5441734790802
Epoch: 3, Steps: 10 | Train Loss: 2.823 Vali Loss: 3.253 Vali Acc: 0.111 Test Loss: 3.253 Test Acc: 0.111
Validation loss decreased (-0.056438 --> -0.110556).  Saving model ...
Epoch: 4 cost time: 2.0326435565948486
Epoch: 4, Steps: 10 | Train Loss: 2.531 Vali Loss: 3.187 Vali Acc: 0.135 Test Loss: 3.187 Test Acc: 0.135
Validation loss decreased (-0.110556 --> -0.135262).  Saving model ...
Epoch: 5 cost time: 1.804854154586792
Epoch: 5, Steps: 10 | Train Loss: 2.200 Vali Loss: 3.113 Vali Acc: 0.164 Test Loss: 3.113 Test Acc: 0.164
Validation loss decreased (-0.135262 --> -0.163498).  Saving model ...
Epoch: 6 cost time: 2.6069648265838623
Epoch: 6, Steps: 10 | Train Loss: 1.751 Vali Loss: 3.064 Vali Acc: 0.186 Test Loss: 3.064 Test Acc: 0.186
Validation loss decreased (-0.163498 --> -0.185852).  Saving model ...
Epoch: 7 cost time: 2.290165424346924
Epoch: 7, Steps: 10 | Train Loss: 1.472 Vali Loss: 3.001 Vali Acc: 0.208 Test Loss: 3.001 Test Acc: 0.208
Validation loss decreased (-0.185852 --> -0.208205).  Saving model ...
Epoch: 8 cost time: 2.9631764888763428
Epoch: 8, Steps: 10 | Train Loss: 1.179 Vali Loss: 3.017 Vali Acc: 0.218 Test Loss: 3.017 Test Acc: 0.218
Validation loss decreased (-0.208205 --> -0.217617).  Saving model ...
Epoch: 9 cost time: 3.1562745571136475
Epoch: 9, Steps: 10 | Train Loss: 0.830 Vali Loss: 2.962 Vali Acc: 0.245 Test Loss: 2.962 Test Acc: 0.245
Validation loss decreased (-0.217617 --> -0.244676).  Saving model ...
Epoch: 10 cost time: 3.154924154281616
Epoch: 10, Steps: 10 | Train Loss: 0.628 Vali Loss: 2.951 Vali Acc: 0.271 Test Loss: 2.951 Test Acc: 0.271
Validation loss decreased (-0.244676 --> -0.270559).  Saving model ...
Epoch: 11 cost time: 3.1599719524383545
Epoch: 11, Steps: 10 | Train Loss: 0.412 Vali Loss: 2.983 Vali Acc: 0.272 Test Loss: 2.983 Test Acc: 0.272
Validation loss decreased (-0.270559 --> -0.271735).  Saving model ...
Epoch: 12 cost time: 2.423614263534546
Epoch: 12, Steps: 10 | Train Loss: 0.232 Vali Loss: 2.989 Vali Acc: 0.275 Test Loss: 2.989 Test Acc: 0.275
Validation loss decreased (-0.271735 --> -0.275264).  Saving model ...
Epoch: 13 cost time: 2.549088478088379
Epoch: 13, Steps: 10 | Train Loss: 0.240 Vali Loss: 2.969 Vali Acc: 0.285 Test Loss: 2.969 Test Acc: 0.285
Validation loss decreased (-0.275264 --> -0.284676).  Saving model ...
Epoch: 14 cost time: 2.5030171871185303
Epoch: 14, Steps: 10 | Train Loss: 0.166 Vali Loss: 3.022 Vali Acc: 0.286 Test Loss: 3.022 Test Acc: 0.286
Validation loss decreased (-0.284676 --> -0.285852).  Saving model ...
Epoch: 15 cost time: 2.885890007019043
Epoch: 15, Steps: 10 | Train Loss: 0.096 Vali Loss: 3.083 Vali Acc: 0.304 Test Loss: 3.083 Test Acc: 0.304
Validation loss decreased (-0.285852 --> -0.303499).  Saving model ...
Epoch: 16 cost time: 3.2079286575317383
Epoch: 16, Steps: 10 | Train Loss: 0.074 Vali Loss: 3.110 Vali Acc: 0.301 Test Loss: 3.110 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.14717435836792
Epoch: 17, Steps: 10 | Train Loss: 0.067 Vali Loss: 3.201 Vali Acc: 0.316 Test Loss: 3.201 Test Acc: 0.316
Validation loss decreased (-0.303499 --> -0.316439).  Saving model ...
Epoch: 18 cost time: 2.827240228652954
Epoch: 18, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.114 Vali Acc: 0.318 Test Loss: 3.114 Test Acc: 0.318
Validation loss decreased (-0.316439 --> -0.317616).  Saving model ...
Epoch: 19 cost time: 2.8815648555755615
Epoch: 19, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.137 Vali Acc: 0.325 Test Loss: 3.137 Test Acc: 0.325
Validation loss decreased (-0.317616 --> -0.324675).  Saving model ...
Epoch: 20 cost time: 2.5491409301757812
Epoch: 20, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.159 Vali Acc: 0.326 Test Loss: 3.159 Test Acc: 0.326
Validation loss decreased (-0.324675 --> -0.325851).  Saving model ...
Epoch: 21 cost time: 2.9107162952423096
Epoch: 21, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.165 Vali Acc: 0.321 Test Loss: 3.165 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.0664005279541016
Epoch: 22, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.198 Vali Acc: 0.328 Test Loss: 3.198 Test Acc: 0.328
Validation loss decreased (-0.325851 --> -0.328203).  Saving model ...
Epoch: 23 cost time: 2.46028470993042
Epoch: 23, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.203 Vali Acc: 0.336 Test Loss: 3.203 Test Acc: 0.336
Validation loss decreased (-0.328203 --> -0.336439).  Saving model ...
Epoch: 24 cost time: 2.2177391052246094
Epoch: 24, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.230 Vali Acc: 0.331 Test Loss: 3.230 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.014376640319824
Epoch: 25, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.207 Vali Acc: 0.327 Test Loss: 3.207 Test Acc: 0.327
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.45027494430542
Epoch: 26, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.209 Vali Acc: 0.325 Test Loss: 3.209 Test Acc: 0.325
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.1174466609954834
Epoch: 27, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.223 Vali Acc: 0.328 Test Loss: 3.223 Test Acc: 0.328
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.1196603775024414
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.257 Vali Acc: 0.329 Test Loss: 3.257 Test Acc: 0.329
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.1837868690490723
Epoch: 29, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.319 Vali Acc: 0.333 Test Loss: 3.319 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.803864002227783
Epoch: 30, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.247 Vali Acc: 0.322 Test Loss: 3.247 Test Acc: 0.322
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.33647058823529413
model parameter : 2882042
model size : 11.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.421000719070435
Epoch: 1, Steps: 10 | Train Loss: 3.287 Vali Loss: 3.288 Vali Acc: 0.038 Test Loss: 3.288 Test Acc: 0.038
Validation loss decreased (inf --> -0.037614).  Saving model ...
Epoch: 2 cost time: 4.029651403427124
Epoch: 2, Steps: 10 | Train Loss: 3.150 Vali Loss: 3.270 Vali Acc: 0.053 Test Loss: 3.270 Test Acc: 0.053
Validation loss decreased (-0.037614 --> -0.052908).  Saving model ...
Epoch: 3 cost time: 3.2490901947021484
Epoch: 3, Steps: 10 | Train Loss: 2.860 Vali Loss: 3.242 Vali Acc: 0.111 Test Loss: 3.242 Test Acc: 0.111
Validation loss decreased (-0.052908 --> -0.110556).  Saving model ...
Epoch: 4 cost time: 4.024139642715454
Epoch: 4, Steps: 10 | Train Loss: 2.637 Vali Loss: 3.200 Vali Acc: 0.129 Test Loss: 3.200 Test Acc: 0.129
Validation loss decreased (-0.110556 --> -0.129380).  Saving model ...
Epoch: 5 cost time: 3.776329755783081
Epoch: 5, Steps: 10 | Train Loss: 2.335 Vali Loss: 3.121 Vali Acc: 0.141 Test Loss: 3.121 Test Acc: 0.141
Validation loss decreased (-0.129380 --> -0.141145).  Saving model ...
Epoch: 6 cost time: 3.7373368740081787
Epoch: 6, Steps: 10 | Train Loss: 1.993 Vali Loss: 3.108 Vali Acc: 0.164 Test Loss: 3.108 Test Acc: 0.164
Validation loss decreased (-0.141145 --> -0.163498).  Saving model ...
Epoch: 7 cost time: 2.8976011276245117
Epoch: 7, Steps: 10 | Train Loss: 1.755 Vali Loss: 3.088 Vali Acc: 0.176 Test Loss: 3.088 Test Acc: 0.176
Validation loss decreased (-0.163498 --> -0.176440).  Saving model ...
Epoch: 8 cost time: 3.6950061321258545
Epoch: 8, Steps: 10 | Train Loss: 1.509 Vali Loss: 2.994 Vali Acc: 0.198 Test Loss: 2.994 Test Acc: 0.198
Validation loss decreased (-0.176440 --> -0.197617).  Saving model ...
Epoch: 9 cost time: 4.096272945404053
Epoch: 9, Steps: 10 | Train Loss: 1.124 Vali Loss: 3.017 Vali Acc: 0.221 Test Loss: 3.017 Test Acc: 0.221
Validation loss decreased (-0.197617 --> -0.221146).  Saving model ...
Epoch: 10 cost time: 4.074437618255615
Epoch: 10, Steps: 10 | Train Loss: 0.843 Vali Loss: 2.962 Vali Acc: 0.258 Test Loss: 2.962 Test Acc: 0.258
Validation loss decreased (-0.221146 --> -0.257617).  Saving model ...
Epoch: 11 cost time: 4.2914299964904785
Epoch: 11, Steps: 10 | Train Loss: 0.679 Vali Loss: 2.981 Vali Acc: 0.253 Test Loss: 2.981 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.084292411804199
Epoch: 12, Steps: 10 | Train Loss: 0.452 Vali Loss: 3.053 Vali Acc: 0.260 Test Loss: 3.053 Test Acc: 0.260
Validation loss decreased (-0.257617 --> -0.259969).  Saving model ...
Epoch: 13 cost time: 4.206103801727295
Epoch: 13, Steps: 10 | Train Loss: 0.421 Vali Loss: 2.992 Vali Acc: 0.295 Test Loss: 2.992 Test Acc: 0.295
Validation loss decreased (-0.259969 --> -0.295264).  Saving model ...
Epoch: 14 cost time: 4.469893217086792
Epoch: 14, Steps: 10 | Train Loss: 0.279 Vali Loss: 2.963 Vali Acc: 0.301 Test Loss: 2.963 Test Acc: 0.301
Validation loss decreased (-0.295264 --> -0.301147).  Saving model ...
Epoch: 15 cost time: 2.8272547721862793
Epoch: 15, Steps: 10 | Train Loss: 0.169 Vali Loss: 3.020 Vali Acc: 0.305 Test Loss: 3.020 Test Acc: 0.305
Validation loss decreased (-0.301147 --> -0.304676).  Saving model ...
Epoch: 16 cost time: 3.3921172618865967
Epoch: 16, Steps: 10 | Train Loss: 0.133 Vali Loss: 3.155 Vali Acc: 0.295 Test Loss: 3.155 Test Acc: 0.295
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.4555306434631348
Epoch: 17, Steps: 10 | Train Loss: 0.153 Vali Loss: 3.116 Vali Acc: 0.289 Test Loss: 3.116 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.9104907512664795
Epoch: 18, Steps: 10 | Train Loss: 0.130 Vali Loss: 3.053 Vali Acc: 0.314 Test Loss: 3.053 Test Acc: 0.314
Validation loss decreased (-0.304676 --> -0.314087).  Saving model ...
Epoch: 19 cost time: 3.2742996215820312
Epoch: 19, Steps: 10 | Train Loss: 0.061 Vali Loss: 3.197 Vali Acc: 0.291 Test Loss: 3.197 Test Acc: 0.291
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.23641037940979
Epoch: 20, Steps: 10 | Train Loss: 0.106 Vali Loss: 3.207 Vali Acc: 0.299 Test Loss: 3.207 Test Acc: 0.299
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.105618953704834
Epoch: 21, Steps: 10 | Train Loss: 0.077 Vali Loss: 3.150 Vali Acc: 0.319 Test Loss: 3.150 Test Acc: 0.319
Validation loss decreased (-0.314087 --> -0.318792).  Saving model ...
Epoch: 22 cost time: 3.8027966022491455
Epoch: 22, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.156 Vali Acc: 0.327 Test Loss: 3.156 Test Acc: 0.327
Validation loss decreased (-0.318792 --> -0.327027).  Saving model ...
Epoch: 23 cost time: 3.652991533279419
Epoch: 23, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.197 Vali Acc: 0.306 Test Loss: 3.197 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.5541772842407227
Epoch: 24, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.209 Vali Acc: 0.318 Test Loss: 3.209 Test Acc: 0.318
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.516171932220459
Epoch: 25, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.268 Vali Acc: 0.313 Test Loss: 3.268 Test Acc: 0.313
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.405754327774048
Epoch: 26, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.282 Vali Acc: 0.315 Test Loss: 3.282 Test Acc: 0.315
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.945359230041504
Epoch: 27, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.329 Vali Acc: 0.301 Test Loss: 3.329 Test Acc: 0.301
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 4.001383066177368
Epoch: 28, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.243 Vali Acc: 0.326 Test Loss: 3.243 Test Acc: 0.326
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 4.135669469833374
Epoch: 29, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.295 Vali Acc: 0.301 Test Loss: 3.295 Test Acc: 0.301
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.3640105724334717
Epoch: 30, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.271 Vali Acc: 0.311 Test Loss: 3.271 Test Acc: 0.311
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3270588235294118
model parameter : 9502458
model size : 36.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.172522783279419
Epoch: 1, Steps: 10 | Train Loss: 3.312 Vali Loss: 3.309 Vali Acc: 0.040 Test Loss: 3.309 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 2.40793776512146
Epoch: 2, Steps: 10 | Train Loss: 3.132 Vali Loss: 3.293 Vali Acc: 0.062 Test Loss: 3.293 Test Acc: 0.062
Validation loss decreased (-0.039967 --> -0.062320).  Saving model ...
Epoch: 3 cost time: 2.3921892642974854
Epoch: 3, Steps: 10 | Train Loss: 2.875 Vali Loss: 3.274 Vali Acc: 0.098 Test Loss: 3.274 Test Acc: 0.098
Validation loss decreased (-0.062320 --> -0.097614).  Saving model ...
Epoch: 4 cost time: 2.4870784282684326
Epoch: 4, Steps: 10 | Train Loss: 2.637 Vali Loss: 3.221 Vali Acc: 0.126 Test Loss: 3.221 Test Acc: 0.126
Validation loss decreased (-0.097614 --> -0.125850).  Saving model ...
Epoch: 5 cost time: 2.4099502563476562
Epoch: 5, Steps: 10 | Train Loss: 2.374 Vali Loss: 3.158 Vali Acc: 0.156 Test Loss: 3.158 Test Acc: 0.156
Validation loss decreased (-0.125850 --> -0.156439).  Saving model ...
Epoch: 6 cost time: 2.3937954902648926
Epoch: 6, Steps: 10 | Train Loss: 1.986 Vali Loss: 3.095 Vali Acc: 0.179 Test Loss: 3.095 Test Acc: 0.179
Validation loss decreased (-0.156439 --> -0.178793).  Saving model ...
Epoch: 7 cost time: 2.47428035736084
Epoch: 7, Steps: 10 | Train Loss: 1.739 Vali Loss: 3.033 Vali Acc: 0.195 Test Loss: 3.033 Test Acc: 0.195
Validation loss decreased (-0.178793 --> -0.195264).  Saving model ...
Epoch: 8 cost time: 1.975618600845337
Epoch: 8, Steps: 10 | Train Loss: 1.401 Vali Loss: 3.015 Vali Acc: 0.213 Test Loss: 3.015 Test Acc: 0.213
Validation loss decreased (-0.195264 --> -0.212911).  Saving model ...
Epoch: 9 cost time: 1.8587348461151123
Epoch: 9, Steps: 10 | Train Loss: 1.032 Vali Loss: 2.976 Vali Acc: 0.232 Test Loss: 2.976 Test Acc: 0.232
Validation loss decreased (-0.212911 --> -0.231735).  Saving model ...
Epoch: 10 cost time: 1.7988560199737549
Epoch: 10, Steps: 10 | Train Loss: 0.879 Vali Loss: 2.976 Vali Acc: 0.255 Test Loss: 2.976 Test Acc: 0.255
Validation loss decreased (-0.231735 --> -0.255264).  Saving model ...
Epoch: 11 cost time: 1.835287094116211
Epoch: 11, Steps: 10 | Train Loss: 0.692 Vali Loss: 2.962 Vali Acc: 0.269 Test Loss: 2.962 Test Acc: 0.269
Validation loss decreased (-0.255264 --> -0.269382).  Saving model ...
Epoch: 12 cost time: 1.703648328781128
Epoch: 12, Steps: 10 | Train Loss: 0.466 Vali Loss: 2.968 Vali Acc: 0.282 Test Loss: 2.968 Test Acc: 0.282
Validation loss decreased (-0.269382 --> -0.282323).  Saving model ...
Epoch: 13 cost time: 1.9968550205230713
Epoch: 13, Steps: 10 | Train Loss: 0.336 Vali Loss: 2.965 Vali Acc: 0.288 Test Loss: 2.965 Test Acc: 0.288
Validation loss decreased (-0.282323 --> -0.288206).  Saving model ...
Epoch: 14 cost time: 2.085172653198242
Epoch: 14, Steps: 10 | Train Loss: 0.249 Vali Loss: 2.982 Vali Acc: 0.300 Test Loss: 2.982 Test Acc: 0.300
Validation loss decreased (-0.288206 --> -0.299970).  Saving model ...
Epoch: 15 cost time: 2.135622024536133
Epoch: 15, Steps: 10 | Train Loss: 0.199 Vali Loss: 3.128 Vali Acc: 0.328 Test Loss: 3.128 Test Acc: 0.328
Validation loss decreased (-0.299970 --> -0.328204).  Saving model ...
Epoch: 16 cost time: 2.012416362762451
Epoch: 16, Steps: 10 | Train Loss: 0.149 Vali Loss: 3.102 Vali Acc: 0.293 Test Loss: 3.102 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9010515213012695
Epoch: 17, Steps: 10 | Train Loss: 0.109 Vali Loss: 3.141 Vali Acc: 0.318 Test Loss: 3.141 Test Acc: 0.318
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.0017647743225098
Epoch: 18, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.199 Vali Acc: 0.316 Test Loss: 3.199 Test Acc: 0.316
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.6721251010894775
Epoch: 19, Steps: 10 | Train Loss: 0.080 Vali Loss: 3.130 Vali Acc: 0.322 Test Loss: 3.130 Test Acc: 0.322
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.5539839267730713
Epoch: 20, Steps: 10 | Train Loss: 0.074 Vali Loss: 3.201 Vali Acc: 0.331 Test Loss: 3.201 Test Acc: 0.331
Validation loss decreased (-0.328204 --> -0.330556).  Saving model ...
Epoch: 21 cost time: 1.7069225311279297
Epoch: 21, Steps: 10 | Train Loss: 0.081 Vali Loss: 3.215 Vali Acc: 0.322 Test Loss: 3.215 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.1421058177948
Epoch: 22, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.259 Vali Acc: 0.322 Test Loss: 3.259 Test Acc: 0.322
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.192981243133545
Epoch: 23, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.222 Vali Acc: 0.324 Test Loss: 3.222 Test Acc: 0.324
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.165410041809082
Epoch: 24, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.250 Vali Acc: 0.325 Test Loss: 3.250 Test Acc: 0.325
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.045776844024658
Epoch: 25, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.206 Vali Acc: 0.327 Test Loss: 3.206 Test Acc: 0.327
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.166534423828125
Epoch: 26, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.255 Vali Acc: 0.336 Test Loss: 3.255 Test Acc: 0.336
Validation loss decreased (-0.330556 --> -0.336438).  Saving model ...
Epoch: 27 cost time: 2.006988525390625
Epoch: 27, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.372 Vali Acc: 0.331 Test Loss: 3.372 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.193291187286377
Epoch: 28, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.403 Vali Acc: 0.335 Test Loss: 3.403 Test Acc: 0.335
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.0710127353668213
Epoch: 29, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.366 Vali Acc: 0.345 Test Loss: 3.366 Test Acc: 0.345
Validation loss decreased (-0.336438 --> -0.344672).  Saving model ...
Epoch: 30 cost time: 1.5977838039398193
Epoch: 30, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.323 Vali Acc: 0.353 Test Loss: 3.323 Test Acc: 0.353
Validation loss decreased (-0.344672 --> -0.352908).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.35294117647058826
model parameter : 2882042
model size : 11.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.014722585678101
Epoch: 1, Steps: 10 | Train Loss: 3.283 Vali Loss: 3.295 Vali Acc: 0.032 Test Loss: 3.295 Test Acc: 0.032
Validation loss decreased (inf --> -0.031732).  Saving model ...
Epoch: 2 cost time: 2.553471326828003
Epoch: 2, Steps: 10 | Train Loss: 3.165 Vali Loss: 3.287 Vali Acc: 0.045 Test Loss: 3.287 Test Acc: 0.045
Validation loss decreased (-0.031732 --> -0.044673).  Saving model ...
Epoch: 3 cost time: 2.57401180267334
Epoch: 3, Steps: 10 | Train Loss: 2.893 Vali Loss: 3.276 Vali Acc: 0.101 Test Loss: 3.276 Test Acc: 0.101
Validation loss decreased (-0.044673 --> -0.101144).  Saving model ...
Epoch: 4 cost time: 2.2398264408111572
Epoch: 4, Steps: 10 | Train Loss: 2.761 Vali Loss: 3.236 Vali Acc: 0.127 Test Loss: 3.236 Test Acc: 0.127
Validation loss decreased (-0.101144 --> -0.127026).  Saving model ...
Epoch: 5 cost time: 2.763239622116089
Epoch: 5, Steps: 10 | Train Loss: 2.381 Vali Loss: 3.164 Vali Acc: 0.136 Test Loss: 3.164 Test Acc: 0.136
Validation loss decreased (-0.127026 --> -0.136439).  Saving model ...
Epoch: 6 cost time: 2.997621774673462
Epoch: 6, Steps: 10 | Train Loss: 2.102 Vali Loss: 3.173 Vali Acc: 0.160 Test Loss: 3.173 Test Acc: 0.160
Validation loss decreased (-0.136439 --> -0.159968).  Saving model ...
Epoch: 7 cost time: 2.399068832397461
Epoch: 7, Steps: 10 | Train Loss: 1.840 Vali Loss: 3.127 Vali Acc: 0.176 Test Loss: 3.127 Test Acc: 0.176
Validation loss decreased (-0.159968 --> -0.176439).  Saving model ...
Epoch: 8 cost time: 2.600576400756836
Epoch: 8, Steps: 10 | Train Loss: 1.591 Vali Loss: 3.073 Vali Acc: 0.195 Test Loss: 3.073 Test Acc: 0.195
Validation loss decreased (-0.176439 --> -0.195263).  Saving model ...
Epoch: 9 cost time: 2.4413881301879883
Epoch: 9, Steps: 10 | Train Loss: 1.231 Vali Loss: 3.085 Vali Acc: 0.209 Test Loss: 3.085 Test Acc: 0.209
Validation loss decreased (-0.195263 --> -0.209381).  Saving model ...
Epoch: 10 cost time: 2.148909330368042
Epoch: 10, Steps: 10 | Train Loss: 0.832 Vali Loss: 2.997 Vali Acc: 0.235 Test Loss: 2.997 Test Acc: 0.235
Validation loss decreased (-0.209381 --> -0.235264).  Saving model ...
Epoch: 11 cost time: 2.151366710662842
Epoch: 11, Steps: 10 | Train Loss: 0.753 Vali Loss: 2.994 Vali Acc: 0.256 Test Loss: 2.994 Test Acc: 0.256
Validation loss decreased (-0.235264 --> -0.256441).  Saving model ...
Epoch: 12 cost time: 2.846365451812744
Epoch: 12, Steps: 10 | Train Loss: 0.499 Vali Loss: 3.118 Vali Acc: 0.248 Test Loss: 3.118 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.675208806991577
Epoch: 13, Steps: 10 | Train Loss: 0.357 Vali Loss: 3.045 Vali Acc: 0.259 Test Loss: 3.045 Test Acc: 0.259
Validation loss decreased (-0.256441 --> -0.258793).  Saving model ...
Epoch: 14 cost time: 2.4133033752441406
Epoch: 14, Steps: 10 | Train Loss: 0.292 Vali Loss: 3.056 Vali Acc: 0.271 Test Loss: 3.056 Test Acc: 0.271
Validation loss decreased (-0.258793 --> -0.270558).  Saving model ...
Epoch: 15 cost time: 2.831458568572998
Epoch: 15, Steps: 10 | Train Loss: 0.212 Vali Loss: 3.107 Vali Acc: 0.268 Test Loss: 3.107 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.5093283653259277
Epoch: 16, Steps: 10 | Train Loss: 0.159 Vali Loss: 3.119 Vali Acc: 0.291 Test Loss: 3.119 Test Acc: 0.291
Validation loss decreased (-0.270558 --> -0.290557).  Saving model ...
Epoch: 17 cost time: 1.9372360706329346
Epoch: 17, Steps: 10 | Train Loss: 0.234 Vali Loss: 3.175 Vali Acc: 0.286 Test Loss: 3.175 Test Acc: 0.286
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.685056447982788
Epoch: 18, Steps: 10 | Train Loss: 0.102 Vali Loss: 3.208 Vali Acc: 0.285 Test Loss: 3.208 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.002774477005005
Epoch: 19, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.236 Vali Acc: 0.287 Test Loss: 3.236 Test Acc: 0.287
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.302586793899536
Epoch: 20, Steps: 10 | Train Loss: 0.088 Vali Loss: 3.224 Vali Acc: 0.309 Test Loss: 3.224 Test Acc: 0.309
Validation loss decreased (-0.290557 --> -0.309380).  Saving model ...
Epoch: 21 cost time: 2.0517356395721436
Epoch: 21, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.179 Vali Acc: 0.311 Test Loss: 3.179 Test Acc: 0.311
Validation loss decreased (-0.309380 --> -0.310556).  Saving model ...
Epoch: 22 cost time: 2.361179828643799
Epoch: 22, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.234 Vali Acc: 0.319 Test Loss: 3.234 Test Acc: 0.319
Validation loss decreased (-0.310556 --> -0.318791).  Saving model ...
Epoch: 23 cost time: 2.532438278198242
Epoch: 23, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.240 Vali Acc: 0.311 Test Loss: 3.240 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.5827176570892334
Epoch: 24, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.252 Vali Acc: 0.312 Test Loss: 3.252 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.0813865661621094
Epoch: 25, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.264 Vali Acc: 0.316 Test Loss: 3.264 Test Acc: 0.316
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.7444560527801514
Epoch: 26, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.343 Vali Acc: 0.319 Test Loss: 3.343 Test Acc: 0.319
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.914752244949341
Epoch: 27, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.320 Vali Acc: 0.321 Test Loss: 3.320 Test Acc: 0.321
Validation loss decreased (-0.318791 --> -0.321143).  Saving model ...
Epoch: 28 cost time: 2.8156044483184814
Epoch: 28, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.345 Vali Acc: 0.326 Test Loss: 3.345 Test Acc: 0.326
Validation loss decreased (-0.321143 --> -0.325849).  Saving model ...
Epoch: 29 cost time: 2.296006202697754
Epoch: 29, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.361 Vali Acc: 0.319 Test Loss: 3.361 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.1947686672210693
Epoch: 30, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.290 Vali Acc: 0.341 Test Loss: 3.290 Test Acc: 0.341
Validation loss decreased (-0.325849 --> -0.341144).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3411764705882353
model parameter : 9502458
model size : 36.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.3046159744262695
Epoch: 1, Steps: 10 | Train Loss: 3.333 Vali Loss: 3.315 Vali Acc: 0.040 Test Loss: 3.315 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 1.4414653778076172
Epoch: 2, Steps: 10 | Train Loss: 3.164 Vali Loss: 3.303 Vali Acc: 0.054 Test Loss: 3.303 Test Acc: 0.054
Validation loss decreased (-0.039967 --> -0.054085).  Saving model ...
Epoch: 3 cost time: 1.3934063911437988
Epoch: 3, Steps: 10 | Train Loss: 2.914 Vali Loss: 3.296 Vali Acc: 0.096 Test Loss: 3.296 Test Acc: 0.096
Validation loss decreased (-0.054085 --> -0.096438).  Saving model ...
Epoch: 4 cost time: 1.35306715965271
Epoch: 4, Steps: 10 | Train Loss: 2.701 Vali Loss: 3.259 Vali Acc: 0.105 Test Loss: 3.259 Test Acc: 0.105
Validation loss decreased (-0.096438 --> -0.104673).  Saving model ...
Epoch: 5 cost time: 1.40114164352417
Epoch: 5, Steps: 10 | Train Loss: 2.461 Vali Loss: 3.202 Vali Acc: 0.135 Test Loss: 3.202 Test Acc: 0.135
Validation loss decreased (-0.104673 --> -0.135262).  Saving model ...
Epoch: 6 cost time: 1.4165830612182617
Epoch: 6, Steps: 10 | Train Loss: 2.098 Vali Loss: 3.159 Vali Acc: 0.149 Test Loss: 3.159 Test Acc: 0.149
Validation loss decreased (-0.135262 --> -0.149380).  Saving model ...
Epoch: 7 cost time: 1.4121191501617432
Epoch: 7, Steps: 10 | Train Loss: 1.881 Vali Loss: 3.119 Vali Acc: 0.176 Test Loss: 3.119 Test Acc: 0.176
Validation loss decreased (-0.149380 --> -0.176439).  Saving model ...
Epoch: 8 cost time: 1.3262825012207031
Epoch: 8, Steps: 10 | Train Loss: 1.548 Vali Loss: 3.114 Vali Acc: 0.200 Test Loss: 3.114 Test Acc: 0.200
Validation loss decreased (-0.176439 --> -0.199969).  Saving model ...
Epoch: 9 cost time: 1.2212133407592773
Epoch: 9, Steps: 10 | Train Loss: 1.255 Vali Loss: 3.076 Vali Acc: 0.218 Test Loss: 3.076 Test Acc: 0.218
Validation loss decreased (-0.199969 --> -0.217616).  Saving model ...
Epoch: 10 cost time: 1.1854093074798584
Epoch: 10, Steps: 10 | Train Loss: 1.042 Vali Loss: 3.071 Vali Acc: 0.225 Test Loss: 3.071 Test Acc: 0.225
Validation loss decreased (-0.217616 --> -0.224675).  Saving model ...
Epoch: 11 cost time: 1.111177682876587
Epoch: 11, Steps: 10 | Train Loss: 0.750 Vali Loss: 3.044 Vali Acc: 0.247 Test Loss: 3.044 Test Acc: 0.247
Validation loss decreased (-0.224675 --> -0.247028).  Saving model ...
Epoch: 12 cost time: 0.9493067264556885
Epoch: 12, Steps: 10 | Train Loss: 0.610 Vali Loss: 3.047 Vali Acc: 0.264 Test Loss: 3.047 Test Acc: 0.264
Validation loss decreased (-0.247028 --> -0.263499).  Saving model ...
Epoch: 13 cost time: 1.2609941959381104
Epoch: 13, Steps: 10 | Train Loss: 0.434 Vali Loss: 3.043 Vali Acc: 0.272 Test Loss: 3.043 Test Acc: 0.272
Validation loss decreased (-0.263499 --> -0.271734).  Saving model ...
Epoch: 14 cost time: 1.222425937652588
Epoch: 14, Steps: 10 | Train Loss: 0.304 Vali Loss: 3.138 Vali Acc: 0.267 Test Loss: 3.138 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.310070514678955
Epoch: 15, Steps: 10 | Train Loss: 0.261 Vali Loss: 3.166 Vali Acc: 0.292 Test Loss: 3.166 Test Acc: 0.292
Validation loss decreased (-0.271734 --> -0.291733).  Saving model ...
Epoch: 16 cost time: 1.2848787307739258
Epoch: 16, Steps: 10 | Train Loss: 0.219 Vali Loss: 3.176 Vali Acc: 0.307 Test Loss: 3.176 Test Acc: 0.307
Validation loss decreased (-0.291733 --> -0.307027).  Saving model ...
Epoch: 17 cost time: 1.394913911819458
Epoch: 17, Steps: 10 | Train Loss: 0.207 Vali Loss: 3.146 Vali Acc: 0.324 Test Loss: 3.146 Test Acc: 0.324
Validation loss decreased (-0.307027 --> -0.323498).  Saving model ...
Epoch: 18 cost time: 1.3407599925994873
Epoch: 18, Steps: 10 | Train Loss: 0.116 Vali Loss: 3.114 Vali Acc: 0.334 Test Loss: 3.114 Test Acc: 0.334
Validation loss decreased (-0.323498 --> -0.334087).  Saving model ...
Epoch: 19 cost time: 1.4644193649291992
Epoch: 19, Steps: 10 | Train Loss: 0.109 Vali Loss: 3.152 Vali Acc: 0.346 Test Loss: 3.152 Test Acc: 0.346
Validation loss decreased (-0.334087 --> -0.345851).  Saving model ...
Epoch: 20 cost time: 1.3922638893127441
Epoch: 20, Steps: 10 | Train Loss: 0.074 Vali Loss: 3.287 Vali Acc: 0.324 Test Loss: 3.287 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6754674911499023
Epoch: 21, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.238 Vali Acc: 0.309 Test Loss: 3.238 Test Acc: 0.309
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.3291196823120117
Epoch: 22, Steps: 10 | Train Loss: 0.074 Vali Loss: 3.372 Vali Acc: 0.315 Test Loss: 3.372 Test Acc: 0.315
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.4379603862762451
Epoch: 23, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.276 Vali Acc: 0.325 Test Loss: 3.276 Test Acc: 0.325
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.2925493717193604
Epoch: 24, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.331 Vali Acc: 0.327 Test Loss: 3.331 Test Acc: 0.327
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.2257909774780273
Epoch: 25, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.376 Vali Acc: 0.321 Test Loss: 3.376 Test Acc: 0.321
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.9998178482055664
Epoch: 26, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.374 Vali Acc: 0.332 Test Loss: 3.374 Test Acc: 0.332
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.047226905822754
Epoch: 27, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.304 Vali Acc: 0.329 Test Loss: 3.304 Test Acc: 0.329
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.251086711883545
Epoch: 28, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.402 Vali Acc: 0.320 Test Loss: 3.402 Test Acc: 0.320
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.5100960731506348
Epoch: 29, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.525 Vali Acc: 0.316 Test Loss: 3.525 Test Acc: 0.316
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3458823529411765
model parameter : 2882042
model size : 11.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.056375503540039
Epoch: 1, Steps: 10 | Train Loss: 3.358 Vali Loss: 3.302 Vali Acc: 0.047 Test Loss: 3.302 Test Acc: 0.047
Validation loss decreased (inf --> -0.047026).  Saving model ...
Epoch: 2 cost time: 3.494828701019287
Epoch: 2, Steps: 10 | Train Loss: 3.167 Vali Loss: 3.270 Vali Acc: 0.078 Test Loss: 3.270 Test Acc: 0.078
Validation loss decreased (-0.047026 --> -0.077614).  Saving model ...
Epoch: 3 cost time: 3.6585922241210938
Epoch: 3, Steps: 10 | Train Loss: 2.903 Vali Loss: 3.267 Vali Acc: 0.102 Test Loss: 3.267 Test Acc: 0.102
Validation loss decreased (-0.077614 --> -0.102320).  Saving model ...
Epoch: 4 cost time: 3.7655861377716064
Epoch: 4, Steps: 10 | Train Loss: 2.646 Vali Loss: 3.205 Vali Acc: 0.129 Test Loss: 3.205 Test Acc: 0.129
Validation loss decreased (-0.102320 --> -0.129380).  Saving model ...
Epoch: 5 cost time: 3.092538833618164
Epoch: 5, Steps: 10 | Train Loss: 2.308 Vali Loss: 3.121 Vali Acc: 0.165 Test Loss: 3.121 Test Acc: 0.165
Validation loss decreased (-0.129380 --> -0.164675).  Saving model ...
Epoch: 6 cost time: 3.832505464553833
Epoch: 6, Steps: 10 | Train Loss: 1.928 Vali Loss: 3.039 Vali Acc: 0.189 Test Loss: 3.039 Test Acc: 0.189
Validation loss decreased (-0.164675 --> -0.189381).  Saving model ...
Epoch: 7 cost time: 3.8264803886413574
Epoch: 7, Steps: 10 | Train Loss: 1.595 Vali Loss: 2.993 Vali Acc: 0.195 Test Loss: 2.993 Test Acc: 0.195
Validation loss decreased (-0.189381 --> -0.195264).  Saving model ...
Epoch: 8 cost time: 3.1196107864379883
Epoch: 8, Steps: 10 | Train Loss: 1.246 Vali Loss: 3.033 Vali Acc: 0.208 Test Loss: 3.033 Test Acc: 0.208
Validation loss decreased (-0.195264 --> -0.208205).  Saving model ...
Epoch: 9 cost time: 3.4596762657165527
Epoch: 9, Steps: 10 | Train Loss: 1.003 Vali Loss: 3.030 Vali Acc: 0.233 Test Loss: 3.030 Test Acc: 0.233
Validation loss decreased (-0.208205 --> -0.232911).  Saving model ...
Epoch: 10 cost time: 3.509793281555176
Epoch: 10, Steps: 10 | Train Loss: 0.643 Vali Loss: 2.936 Vali Acc: 0.272 Test Loss: 2.936 Test Acc: 0.272
Validation loss decreased (-0.232911 --> -0.271735).  Saving model ...
Epoch: 11 cost time: 2.9755911827087402
Epoch: 11, Steps: 10 | Train Loss: 0.406 Vali Loss: 2.938 Vali Acc: 0.301 Test Loss: 2.938 Test Acc: 0.301
Validation loss decreased (-0.271735 --> -0.301147).  Saving model ...
Epoch: 12 cost time: 2.1886186599731445
Epoch: 12, Steps: 10 | Train Loss: 0.222 Vali Loss: 2.933 Vali Acc: 0.313 Test Loss: 2.933 Test Acc: 0.313
Validation loss decreased (-0.301147 --> -0.312912).  Saving model ...
Epoch: 13 cost time: 3.149059534072876
Epoch: 13, Steps: 10 | Train Loss: 0.139 Vali Loss: 2.980 Vali Acc: 0.320 Test Loss: 2.980 Test Acc: 0.320
Validation loss decreased (-0.312912 --> -0.319970).  Saving model ...
Epoch: 14 cost time: 3.567174196243286
Epoch: 14, Steps: 10 | Train Loss: 0.103 Vali Loss: 3.074 Vali Acc: 0.320 Test Loss: 3.074 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.5072216987609863
Epoch: 15, Steps: 10 | Train Loss: 0.086 Vali Loss: 2.973 Vali Acc: 0.316 Test Loss: 2.973 Test Acc: 0.316
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.96773099899292
Epoch: 16, Steps: 10 | Train Loss: 0.092 Vali Loss: 3.027 Vali Acc: 0.315 Test Loss: 3.027 Test Acc: 0.315
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.542050361633301
Epoch: 17, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.081 Vali Acc: 0.334 Test Loss: 3.081 Test Acc: 0.334
Validation loss decreased (-0.319970 --> -0.334087).  Saving model ...
Epoch: 18 cost time: 2.9749019145965576
Epoch: 18, Steps: 10 | Train Loss: 0.038 Vali Loss: 2.998 Vali Acc: 0.331 Test Loss: 2.998 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.4637563228607178
Epoch: 19, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.107 Vali Acc: 0.333 Test Loss: 3.107 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.032477855682373
Epoch: 20, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.111 Vali Acc: 0.331 Test Loss: 3.111 Test Acc: 0.331
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.4519457817077637
Epoch: 21, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.144 Vali Acc: 0.329 Test Loss: 3.144 Test Acc: 0.329
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.4078874588012695
Epoch: 22, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.125 Vali Acc: 0.334 Test Loss: 3.125 Test Acc: 0.334
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.3810155391693115
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.129 Vali Acc: 0.340 Test Loss: 3.129 Test Acc: 0.340
Validation loss decreased (-0.334087 --> -0.339969).  Saving model ...
Epoch: 24 cost time: 3.4382174015045166
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.143 Vali Acc: 0.339 Test Loss: 3.143 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.5927019119262695
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.160 Vali Acc: 0.335 Test Loss: 3.160 Test Acc: 0.335
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.8718128204345703
Epoch: 26, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.115 Vali Acc: 0.334 Test Loss: 3.115 Test Acc: 0.334
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.1886205673217773
Epoch: 27, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.180 Vali Acc: 0.339 Test Loss: 3.180 Test Acc: 0.339
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.957213878631592
Epoch: 28, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.248 Vali Acc: 0.327 Test Loss: 3.248 Test Acc: 0.327
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.5607221126556396
Epoch: 29, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.251 Vali Acc: 0.326 Test Loss: 3.251 Test Acc: 0.326
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.1332943439483643
Epoch: 30, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.204 Vali Acc: 0.334 Test Loss: 3.204 Test Acc: 0.334
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.34
model parameter : 4815098
model size : 19.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.4441728591918945
Epoch: 1, Steps: 10 | Train Loss: 3.263 Vali Loss: 3.298 Vali Acc: 0.038 Test Loss: 3.298 Test Acc: 0.038
Validation loss decreased (inf --> -0.037614).  Saving model ...
Epoch: 2 cost time: 1.7513985633850098
Epoch: 2, Steps: 10 | Train Loss: 3.158 Vali Loss: 3.282 Vali Acc: 0.055 Test Loss: 3.282 Test Acc: 0.055
Validation loss decreased (-0.037614 --> -0.055261).  Saving model ...
Epoch: 3 cost time: 1.639345407485962
Epoch: 3, Steps: 10 | Train Loss: 2.935 Vali Loss: 3.283 Vali Acc: 0.096 Test Loss: 3.283 Test Acc: 0.096
Validation loss decreased (-0.055261 --> -0.096438).  Saving model ...
Epoch: 4 cost time: 1.7395071983337402
Epoch: 4, Steps: 10 | Train Loss: 2.629 Vali Loss: 3.224 Vali Acc: 0.119 Test Loss: 3.224 Test Acc: 0.119
Validation loss decreased (-0.096438 --> -0.118791).  Saving model ...
Epoch: 5 cost time: 1.5534985065460205
Epoch: 5, Steps: 10 | Train Loss: 2.398 Vali Loss: 3.136 Vali Acc: 0.166 Test Loss: 3.136 Test Acc: 0.166
Validation loss decreased (-0.118791 --> -0.165851).  Saving model ...
Epoch: 6 cost time: 2.278935432434082
Epoch: 6, Steps: 10 | Train Loss: 2.066 Vali Loss: 3.059 Vali Acc: 0.179 Test Loss: 3.059 Test Acc: 0.179
Validation loss decreased (-0.165851 --> -0.178793).  Saving model ...
Epoch: 7 cost time: 1.9536511898040771
Epoch: 7, Steps: 10 | Train Loss: 1.672 Vali Loss: 2.994 Vali Acc: 0.196 Test Loss: 2.994 Test Acc: 0.196
Validation loss decreased (-0.178793 --> -0.196441).  Saving model ...
Epoch: 8 cost time: 2.1541748046875
Epoch: 8, Steps: 10 | Train Loss: 1.427 Vali Loss: 2.981 Vali Acc: 0.206 Test Loss: 2.981 Test Acc: 0.206
Validation loss decreased (-0.196441 --> -0.205853).  Saving model ...
Epoch: 9 cost time: 2.3791749477386475
Epoch: 9, Steps: 10 | Train Loss: 1.013 Vali Loss: 2.969 Vali Acc: 0.219 Test Loss: 2.969 Test Acc: 0.219
Validation loss decreased (-0.205853 --> -0.218794).  Saving model ...
Epoch: 10 cost time: 2.052401065826416
Epoch: 10, Steps: 10 | Train Loss: 0.816 Vali Loss: 2.972 Vali Acc: 0.238 Test Loss: 2.972 Test Acc: 0.238
Validation loss decreased (-0.218794 --> -0.237617).  Saving model ...
Epoch: 11 cost time: 2.033047676086426
Epoch: 11, Steps: 10 | Train Loss: 0.607 Vali Loss: 3.003 Vali Acc: 0.229 Test Loss: 3.003 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.021381378173828
Epoch: 12, Steps: 10 | Train Loss: 0.451 Vali Loss: 2.910 Vali Acc: 0.271 Test Loss: 2.910 Test Acc: 0.271
Validation loss decreased (-0.237617 --> -0.270559).  Saving model ...
Epoch: 13 cost time: 2.0078628063201904
Epoch: 13, Steps: 10 | Train Loss: 0.267 Vali Loss: 2.945 Vali Acc: 0.287 Test Loss: 2.945 Test Acc: 0.287
Validation loss decreased (-0.270559 --> -0.287029).  Saving model ...
Epoch: 14 cost time: 1.299104928970337
Epoch: 14, Steps: 10 | Train Loss: 0.180 Vali Loss: 2.967 Vali Acc: 0.286 Test Loss: 2.967 Test Acc: 0.286
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8834114074707031
Epoch: 15, Steps: 10 | Train Loss: 0.131 Vali Loss: 3.028 Vali Acc: 0.284 Test Loss: 3.028 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.060081720352173
Epoch: 16, Steps: 10 | Train Loss: 0.107 Vali Loss: 3.061 Vali Acc: 0.306 Test Loss: 3.061 Test Acc: 0.306
Validation loss decreased (-0.287029 --> -0.305852).  Saving model ...
Epoch: 17 cost time: 1.7856276035308838
Epoch: 17, Steps: 10 | Train Loss: 0.113 Vali Loss: 3.094 Vali Acc: 0.301 Test Loss: 3.094 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.052097797393799
Epoch: 18, Steps: 10 | Train Loss: 0.081 Vali Loss: 3.113 Vali Acc: 0.311 Test Loss: 3.113 Test Acc: 0.311
Validation loss decreased (-0.305852 --> -0.310557).  Saving model ...
Epoch: 19 cost time: 2.1527371406555176
Epoch: 19, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.026 Vali Acc: 0.308 Test Loss: 3.026 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.8087141513824463
Epoch: 20, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.127 Vali Acc: 0.306 Test Loss: 3.127 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.2737746238708496
Epoch: 21, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.089 Vali Acc: 0.314 Test Loss: 3.089 Test Acc: 0.314
Validation loss decreased (-0.310557 --> -0.314087).  Saving model ...
Epoch: 22 cost time: 1.7426128387451172
Epoch: 22, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.103 Vali Acc: 0.313 Test Loss: 3.103 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.8436880111694336
Epoch: 23, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.157 Vali Acc: 0.308 Test Loss: 3.157 Test Acc: 0.308
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.828324794769287
Epoch: 24, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.194 Vali Acc: 0.318 Test Loss: 3.194 Test Acc: 0.318
Validation loss decreased (-0.314087 --> -0.317615).  Saving model ...
Epoch: 25 cost time: 1.768460988998413
Epoch: 25, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.126 Vali Acc: 0.305 Test Loss: 3.126 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.8400170803070068
Epoch: 26, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.149 Vali Acc: 0.315 Test Loss: 3.149 Test Acc: 0.315
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.9685125350952148
Epoch: 27, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.229 Vali Acc: 0.321 Test Loss: 3.229 Test Acc: 0.321
Validation loss decreased (-0.317615 --> -0.321144).  Saving model ...
Epoch: 28 cost time: 2.2261481285095215
Epoch: 28, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.130 Vali Acc: 0.316 Test Loss: 3.130 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.9703395366668701
Epoch: 29, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.173 Vali Acc: 0.326 Test Loss: 3.173 Test Acc: 0.326
Validation loss decreased (-0.321144 --> -0.325851).  Saving model ...
Epoch: 30 cost time: 1.7515676021575928
Epoch: 30, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.236 Vali Acc: 0.316 Test Loss: 3.236 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.32588235294117646
model parameter : 1504762
model size : 6.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.631916761398315
Epoch: 1, Steps: 10 | Train Loss: 3.350 Vali Loss: 3.302 Vali Acc: 0.049 Test Loss: 3.302 Test Acc: 0.049
Validation loss decreased (inf --> -0.049379).  Saving model ...
Epoch: 2 cost time: 2.3294177055358887
Epoch: 2, Steps: 10 | Train Loss: 3.171 Vali Loss: 3.271 Vali Acc: 0.080 Test Loss: 3.271 Test Acc: 0.080
Validation loss decreased (-0.049379 --> -0.079967).  Saving model ...
Epoch: 3 cost time: 2.239837646484375
Epoch: 3, Steps: 10 | Train Loss: 2.925 Vali Loss: 3.268 Vali Acc: 0.098 Test Loss: 3.268 Test Acc: 0.098
Validation loss decreased (-0.079967 --> -0.097614).  Saving model ...
Epoch: 4 cost time: 2.0949716567993164
Epoch: 4, Steps: 10 | Train Loss: 2.682 Vali Loss: 3.213 Vali Acc: 0.125 Test Loss: 3.213 Test Acc: 0.125
Validation loss decreased (-0.097614 --> -0.124674).  Saving model ...
Epoch: 5 cost time: 2.6557607650756836
Epoch: 5, Steps: 10 | Train Loss: 2.348 Vali Loss: 3.135 Vali Acc: 0.156 Test Loss: 3.135 Test Acc: 0.156
Validation loss decreased (-0.124674 --> -0.156439).  Saving model ...
Epoch: 6 cost time: 2.2969677448272705
Epoch: 6, Steps: 10 | Train Loss: 2.033 Vali Loss: 3.049 Vali Acc: 0.180 Test Loss: 3.049 Test Acc: 0.180
Validation loss decreased (-0.156439 --> -0.179970).  Saving model ...
Epoch: 7 cost time: 2.9164011478424072
Epoch: 7, Steps: 10 | Train Loss: 1.715 Vali Loss: 2.980 Vali Acc: 0.209 Test Loss: 2.980 Test Acc: 0.209
Validation loss decreased (-0.179970 --> -0.209382).  Saving model ...
Epoch: 8 cost time: 2.729598045349121
Epoch: 8, Steps: 10 | Train Loss: 1.428 Vali Loss: 3.012 Vali Acc: 0.209 Test Loss: 3.012 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.7922191619873047
Epoch: 9, Steps: 10 | Train Loss: 1.220 Vali Loss: 3.003 Vali Acc: 0.245 Test Loss: 3.003 Test Acc: 0.245
Validation loss decreased (-0.209382 --> -0.244676).  Saving model ...
Epoch: 10 cost time: 2.291192054748535
Epoch: 10, Steps: 10 | Train Loss: 0.938 Vali Loss: 2.956 Vali Acc: 0.278 Test Loss: 2.956 Test Acc: 0.278
Validation loss decreased (-0.244676 --> -0.277617).  Saving model ...
Epoch: 11 cost time: 2.4525301456451416
Epoch: 11, Steps: 10 | Train Loss: 0.562 Vali Loss: 2.918 Vali Acc: 0.285 Test Loss: 2.918 Test Acc: 0.285
Validation loss decreased (-0.277617 --> -0.284677).  Saving model ...
Epoch: 12 cost time: 1.9355764389038086
Epoch: 12, Steps: 10 | Train Loss: 0.344 Vali Loss: 2.889 Vali Acc: 0.312 Test Loss: 2.889 Test Acc: 0.312
Validation loss decreased (-0.284677 --> -0.311736).  Saving model ...
Epoch: 13 cost time: 1.906890630722046
Epoch: 13, Steps: 10 | Train Loss: 0.261 Vali Loss: 2.970 Vali Acc: 0.299 Test Loss: 2.970 Test Acc: 0.299
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.237095832824707
Epoch: 14, Steps: 10 | Train Loss: 0.237 Vali Loss: 2.973 Vali Acc: 0.328 Test Loss: 2.973 Test Acc: 0.328
Validation loss decreased (-0.311736 --> -0.328206).  Saving model ...
Epoch: 15 cost time: 2.275331735610962
Epoch: 15, Steps: 10 | Train Loss: 0.128 Vali Loss: 3.041 Vali Acc: 0.331 Test Loss: 3.041 Test Acc: 0.331
Validation loss decreased (-0.328206 --> -0.330558).  Saving model ...
Epoch: 16 cost time: 2.4237918853759766
Epoch: 16, Steps: 10 | Train Loss: 0.160 Vali Loss: 3.033 Vali Acc: 0.340 Test Loss: 3.033 Test Acc: 0.340
Validation loss decreased (-0.330558 --> -0.339970).  Saving model ...
Epoch: 17 cost time: 2.2820355892181396
Epoch: 17, Steps: 10 | Train Loss: 0.101 Vali Loss: 3.012 Vali Acc: 0.334 Test Loss: 3.012 Test Acc: 0.334
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.122544527053833
Epoch: 18, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.004 Vali Acc: 0.336 Test Loss: 3.004 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.894094228744507
Epoch: 19, Steps: 10 | Train Loss: 0.075 Vali Loss: 3.032 Vali Acc: 0.328 Test Loss: 3.032 Test Acc: 0.328
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.8595707416534424
Epoch: 20, Steps: 10 | Train Loss: 0.061 Vali Loss: 3.022 Vali Acc: 0.345 Test Loss: 3.022 Test Acc: 0.345
Validation loss decreased (-0.339970 --> -0.344676).  Saving model ...
Epoch: 21 cost time: 2.906160593032837
Epoch: 21, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.055 Vali Acc: 0.354 Test Loss: 3.055 Test Acc: 0.354
Validation loss decreased (-0.344676 --> -0.354087).  Saving model ...
Epoch: 22 cost time: 3.243746042251587
Epoch: 22, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.085 Vali Acc: 0.358 Test Loss: 3.085 Test Acc: 0.358
Validation loss decreased (-0.354087 --> -0.357616).  Saving model ...
Epoch: 23 cost time: 2.979943037033081
Epoch: 23, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.053 Vali Acc: 0.361 Test Loss: 3.053 Test Acc: 0.361
Validation loss decreased (-0.357616 --> -0.361146).  Saving model ...
Epoch: 24 cost time: 2.7913918495178223
Epoch: 24, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.055 Vali Acc: 0.365 Test Loss: 3.055 Test Acc: 0.365
Validation loss decreased (-0.361146 --> -0.364675).  Saving model ...
Epoch: 25 cost time: 2.8767614364624023
Epoch: 25, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.043 Vali Acc: 0.375 Test Loss: 3.043 Test Acc: 0.375
Validation loss decreased (-0.364675 --> -0.375264).  Saving model ...
Epoch: 26 cost time: 2.473593235015869
Epoch: 26, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.165 Vali Acc: 0.344 Test Loss: 3.165 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.884653091430664
Epoch: 27, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.135 Vali Acc: 0.351 Test Loss: 3.135 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.9943335056304932
Epoch: 28, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.184 Vali Acc: 0.345 Test Loss: 3.184 Test Acc: 0.345
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.98720121383667
Epoch: 29, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.264 Vali Acc: 0.318 Test Loss: 3.264 Test Acc: 0.318
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.6049633026123047
Epoch: 30, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.212 Vali Acc: 0.338 Test Loss: 3.212 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.37529411764705883
model parameter : 4815098
model size : 19.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.2669525146484375
Epoch: 1, Steps: 10 | Train Loss: 3.266 Vali Loss: 3.296 Vali Acc: 0.047 Test Loss: 3.296 Test Acc: 0.047
Validation loss decreased (inf --> -0.047026).  Saving model ...
Epoch: 2 cost time: 1.8664436340332031
Epoch: 2, Steps: 10 | Train Loss: 3.165 Vali Loss: 3.283 Vali Acc: 0.055 Test Loss: 3.283 Test Acc: 0.055
Validation loss decreased (-0.047026 --> -0.055261).  Saving model ...
Epoch: 3 cost time: 1.5185821056365967
Epoch: 3, Steps: 10 | Train Loss: 2.957 Vali Loss: 3.289 Vali Acc: 0.099 Test Loss: 3.289 Test Acc: 0.099
Validation loss decreased (-0.055261 --> -0.098791).  Saving model ...
Epoch: 4 cost time: 1.431838035583496
Epoch: 4, Steps: 10 | Train Loss: 2.694 Vali Loss: 3.238 Vali Acc: 0.113 Test Loss: 3.238 Test Acc: 0.113
Validation loss decreased (-0.098791 --> -0.112909).  Saving model ...
Epoch: 5 cost time: 1.9342820644378662
Epoch: 5, Steps: 10 | Train Loss: 2.475 Vali Loss: 3.150 Vali Acc: 0.153 Test Loss: 3.150 Test Acc: 0.153
Validation loss decreased (-0.112909 --> -0.152910).  Saving model ...
Epoch: 6 cost time: 1.717344045639038
Epoch: 6, Steps: 10 | Train Loss: 2.170 Vali Loss: 3.083 Vali Acc: 0.178 Test Loss: 3.083 Test Acc: 0.178
Validation loss decreased (-0.152910 --> -0.177616).  Saving model ...
Epoch: 7 cost time: 1.717426061630249
Epoch: 7, Steps: 10 | Train Loss: 1.829 Vali Loss: 3.031 Vali Acc: 0.196 Test Loss: 3.031 Test Acc: 0.196
Validation loss decreased (-0.177616 --> -0.196440).  Saving model ...
Epoch: 8 cost time: 1.6529953479766846
Epoch: 8, Steps: 10 | Train Loss: 1.563 Vali Loss: 3.025 Vali Acc: 0.205 Test Loss: 3.025 Test Acc: 0.205
Validation loss decreased (-0.196440 --> -0.204676).  Saving model ...
Epoch: 9 cost time: 1.371082067489624
Epoch: 9, Steps: 10 | Train Loss: 1.132 Vali Loss: 2.993 Vali Acc: 0.214 Test Loss: 2.993 Test Acc: 0.214
Validation loss decreased (-0.204676 --> -0.214088).  Saving model ...
Epoch: 10 cost time: 1.7954719066619873
Epoch: 10, Steps: 10 | Train Loss: 1.044 Vali Loss: 2.938 Vali Acc: 0.256 Test Loss: 2.938 Test Acc: 0.256
Validation loss decreased (-0.214088 --> -0.256441).  Saving model ...
Epoch: 11 cost time: 1.4782285690307617
Epoch: 11, Steps: 10 | Train Loss: 0.706 Vali Loss: 2.958 Vali Acc: 0.256 Test Loss: 2.958 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7642717361450195
Epoch: 12, Steps: 10 | Train Loss: 0.596 Vali Loss: 2.967 Vali Acc: 0.293 Test Loss: 2.967 Test Acc: 0.293
Validation loss decreased (-0.256441 --> -0.292912).  Saving model ...
Epoch: 13 cost time: 1.3198649883270264
Epoch: 13, Steps: 10 | Train Loss: 0.435 Vali Loss: 2.969 Vali Acc: 0.279 Test Loss: 2.969 Test Acc: 0.279
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2922492027282715
Epoch: 14, Steps: 10 | Train Loss: 0.373 Vali Loss: 2.991 Vali Acc: 0.281 Test Loss: 2.991 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8306944370269775
Epoch: 15, Steps: 10 | Train Loss: 0.316 Vali Loss: 3.034 Vali Acc: 0.292 Test Loss: 3.034 Test Acc: 0.292
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9402236938476562
Epoch: 16, Steps: 10 | Train Loss: 0.173 Vali Loss: 2.983 Vali Acc: 0.309 Test Loss: 2.983 Test Acc: 0.309
Validation loss decreased (-0.292912 --> -0.309382).  Saving model ...
Epoch: 17 cost time: 0.9025399684906006
Epoch: 17, Steps: 10 | Train Loss: 0.126 Vali Loss: 3.053 Vali Acc: 0.307 Test Loss: 3.053 Test Acc: 0.307
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0166079998016357
Epoch: 18, Steps: 10 | Train Loss: 0.090 Vali Loss: 3.099 Vali Acc: 0.327 Test Loss: 3.099 Test Acc: 0.327
Validation loss decreased (-0.309382 --> -0.327028).  Saving model ...
Epoch: 19 cost time: 1.8525135517120361
Epoch: 19, Steps: 10 | Train Loss: 0.081 Vali Loss: 3.068 Vali Acc: 0.320 Test Loss: 3.068 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.9070560932159424
Epoch: 20, Steps: 10 | Train Loss: 0.069 Vali Loss: 3.163 Vali Acc: 0.315 Test Loss: 3.163 Test Acc: 0.315
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.895263433456421
Epoch: 21, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.138 Vali Acc: 0.327 Test Loss: 3.138 Test Acc: 0.327
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.8616657257080078
Epoch: 22, Steps: 10 | Train Loss: 0.097 Vali Loss: 3.258 Vali Acc: 0.325 Test Loss: 3.258 Test Acc: 0.325
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.8697781562805176
Epoch: 23, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.155 Vali Acc: 0.335 Test Loss: 3.155 Test Acc: 0.335
Validation loss decreased (-0.327028 --> -0.335263).  Saving model ...
Epoch: 24 cost time: 1.6493022441864014
Epoch: 24, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.238 Vali Acc: 0.327 Test Loss: 3.238 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.63065767288208
Epoch: 25, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.206 Vali Acc: 0.327 Test Loss: 3.206 Test Acc: 0.327
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.5891797542572021
Epoch: 26, Steps: 10 | Train Loss: 0.043 Vali Loss: 3.149 Vali Acc: 0.341 Test Loss: 3.149 Test Acc: 0.341
Validation loss decreased (-0.335263 --> -0.341145).  Saving model ...
Epoch: 27 cost time: 1.5396816730499268
Epoch: 27, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.213 Vali Acc: 0.324 Test Loss: 3.213 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.9065828323364258
Epoch: 28, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.153 Vali Acc: 0.333 Test Loss: 3.153 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.6916725635528564
Epoch: 29, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.133 Vali Acc: 0.346 Test Loss: 3.133 Test Acc: 0.346
Validation loss decreased (-0.341145 --> -0.345851).  Saving model ...
Epoch: 30 cost time: 1.902705192565918
Epoch: 30, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.156 Vali Acc: 0.349 Test Loss: 3.156 Test Acc: 0.349
Validation loss decreased (-0.345851 --> -0.349380).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.34941176470588237
model parameter : 1504762
model size : 6.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.490253210067749
Epoch: 1, Steps: 10 | Train Loss: 3.343 Vali Loss: 3.304 Vali Acc: 0.046 Test Loss: 3.304 Test Acc: 0.046
Validation loss decreased (inf --> -0.045849).  Saving model ...
Epoch: 2 cost time: 2.0853092670440674
Epoch: 2, Steps: 10 | Train Loss: 3.199 Vali Loss: 3.283 Vali Acc: 0.066 Test Loss: 3.283 Test Acc: 0.066
Validation loss decreased (-0.045849 --> -0.065850).  Saving model ...
Epoch: 3 cost time: 1.7728333473205566
Epoch: 3, Steps: 10 | Train Loss: 2.993 Vali Loss: 3.293 Vali Acc: 0.086 Test Loss: 3.293 Test Acc: 0.086
Validation loss decreased (-0.065850 --> -0.085849).  Saving model ...
Epoch: 4 cost time: 1.724651575088501
Epoch: 4, Steps: 10 | Train Loss: 2.785 Vali Loss: 3.256 Vali Acc: 0.105 Test Loss: 3.256 Test Acc: 0.105
Validation loss decreased (-0.085849 --> -0.104673).  Saving model ...
Epoch: 5 cost time: 1.790177583694458
Epoch: 5, Steps: 10 | Train Loss: 2.545 Vali Loss: 3.198 Vali Acc: 0.140 Test Loss: 3.198 Test Acc: 0.140
Validation loss decreased (-0.104673 --> -0.139968).  Saving model ...
Epoch: 6 cost time: 1.9191780090332031
Epoch: 6, Steps: 10 | Train Loss: 2.221 Vali Loss: 3.128 Vali Acc: 0.162 Test Loss: 3.128 Test Acc: 0.162
Validation loss decreased (-0.139968 --> -0.162322).  Saving model ...
Epoch: 7 cost time: 2.068758249282837
Epoch: 7, Steps: 10 | Train Loss: 1.945 Vali Loss: 3.065 Vali Acc: 0.180 Test Loss: 3.065 Test Acc: 0.180
Validation loss decreased (-0.162322 --> -0.179969).  Saving model ...
Epoch: 8 cost time: 1.7241244316101074
Epoch: 8, Steps: 10 | Train Loss: 1.659 Vali Loss: 3.039 Vali Acc: 0.194 Test Loss: 3.039 Test Acc: 0.194
Validation loss decreased (-0.179969 --> -0.194087).  Saving model ...
Epoch: 9 cost time: 1.905735731124878
Epoch: 9, Steps: 10 | Train Loss: 1.341 Vali Loss: 3.117 Vali Acc: 0.204 Test Loss: 3.117 Test Acc: 0.204
Validation loss decreased (-0.194087 --> -0.203498).  Saving model ...
Epoch: 10 cost time: 1.6949801445007324
Epoch: 10, Steps: 10 | Train Loss: 0.979 Vali Loss: 2.993 Vali Acc: 0.254 Test Loss: 2.993 Test Acc: 0.254
Validation loss decreased (-0.203498 --> -0.254088).  Saving model ...
Epoch: 11 cost time: 1.643362045288086
Epoch: 11, Steps: 10 | Train Loss: 0.664 Vali Loss: 2.967 Vali Acc: 0.249 Test Loss: 2.967 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8373229503631592
Epoch: 12, Steps: 10 | Train Loss: 0.526 Vali Loss: 2.955 Vali Acc: 0.267 Test Loss: 2.955 Test Acc: 0.267
Validation loss decreased (-0.254088 --> -0.267029).  Saving model ...
Epoch: 13 cost time: 2.304349660873413
Epoch: 13, Steps: 10 | Train Loss: 0.512 Vali Loss: 3.009 Vali Acc: 0.280 Test Loss: 3.009 Test Acc: 0.280
Validation loss decreased (-0.267029 --> -0.279970).  Saving model ...
Epoch: 14 cost time: 2.213350772857666
Epoch: 14, Steps: 10 | Train Loss: 0.320 Vali Loss: 2.976 Vali Acc: 0.293 Test Loss: 2.976 Test Acc: 0.293
Validation loss decreased (-0.279970 --> -0.292911).  Saving model ...
Epoch: 15 cost time: 1.90061354637146
Epoch: 15, Steps: 10 | Train Loss: 0.252 Vali Loss: 2.999 Vali Acc: 0.314 Test Loss: 2.999 Test Acc: 0.314
Validation loss decreased (-0.292911 --> -0.314088).  Saving model ...
Epoch: 16 cost time: 1.8860199451446533
Epoch: 16, Steps: 10 | Train Loss: 0.191 Vali Loss: 3.052 Vali Acc: 0.308 Test Loss: 3.052 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9194557666778564
Epoch: 17, Steps: 10 | Train Loss: 0.145 Vali Loss: 3.011 Vali Acc: 0.321 Test Loss: 3.011 Test Acc: 0.321
Validation loss decreased (-0.314088 --> -0.321146).  Saving model ...
Epoch: 18 cost time: 2.0043492317199707
Epoch: 18, Steps: 10 | Train Loss: 0.112 Vali Loss: 3.048 Vali Acc: 0.315 Test Loss: 3.048 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7191181182861328
Epoch: 19, Steps: 10 | Train Loss: 0.085 Vali Loss: 2.993 Vali Acc: 0.335 Test Loss: 2.993 Test Acc: 0.335
Validation loss decreased (-0.321146 --> -0.335264).  Saving model ...
Epoch: 20 cost time: 1.666142463684082
Epoch: 20, Steps: 10 | Train Loss: 0.066 Vali Loss: 3.152 Vali Acc: 0.306 Test Loss: 3.152 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.835921049118042
Epoch: 21, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.032 Vali Acc: 0.345 Test Loss: 3.032 Test Acc: 0.345
Validation loss decreased (-0.335264 --> -0.344676).  Saving model ...
Epoch: 22 cost time: 0.9930465221405029
Epoch: 22, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.092 Vali Acc: 0.341 Test Loss: 3.092 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4994008541107178
Epoch: 23, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.113 Vali Acc: 0.333 Test Loss: 3.113 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.6643052101135254
Epoch: 24, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.116 Vali Acc: 0.333 Test Loss: 3.116 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.871748447418213
Epoch: 25, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.163 Vali Acc: 0.331 Test Loss: 3.163 Test Acc: 0.331
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.061803102493286
Epoch: 26, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.161 Vali Acc: 0.334 Test Loss: 3.161 Test Acc: 0.334
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.0856406688690186
Epoch: 27, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.139 Vali Acc: 0.354 Test Loss: 3.139 Test Acc: 0.354
Validation loss decreased (-0.344676 --> -0.354086).  Saving model ...
Epoch: 28 cost time: 1.977318286895752
Epoch: 28, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.174 Vali Acc: 0.349 Test Loss: 3.174 Test Acc: 0.349
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.916975498199463
Epoch: 29, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.156 Vali Acc: 0.356 Test Loss: 3.156 Test Acc: 0.356
Validation loss decreased (-0.354086 --> -0.356439).  Saving model ...
Epoch: 30 cost time: 1.9323334693908691
Epoch: 30, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.227 Vali Acc: 0.349 Test Loss: 3.227 Test Acc: 0.349
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3564705882352941
model parameter : 4815098
model size : 19.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.782283306121826
Epoch: 1, Steps: 10 | Train Loss: 3.272 Vali Loss: 3.297 Vali Acc: 0.039 Test Loss: 3.297 Test Acc: 0.039
Validation loss decreased (inf --> -0.038791).  Saving model ...
Epoch: 2 cost time: 1.3987030982971191
Epoch: 2, Steps: 10 | Train Loss: 3.172 Vali Loss: 3.294 Vali Acc: 0.049 Test Loss: 3.294 Test Acc: 0.049
Validation loss decreased (-0.038791 --> -0.049379).  Saving model ...
Epoch: 3 cost time: 1.2186088562011719
Epoch: 3, Steps: 10 | Train Loss: 3.008 Vali Loss: 3.313 Vali Acc: 0.084 Test Loss: 3.313 Test Acc: 0.084
Validation loss decreased (-0.049379 --> -0.083496).  Saving model ...
Epoch: 4 cost time: 1.4793009757995605
Epoch: 4, Steps: 10 | Train Loss: 2.775 Vali Loss: 3.277 Vali Acc: 0.106 Test Loss: 3.277 Test Acc: 0.106
Validation loss decreased (-0.083496 --> -0.105850).  Saving model ...
Epoch: 5 cost time: 1.5030088424682617
Epoch: 5, Steps: 10 | Train Loss: 2.555 Vali Loss: 3.203 Vali Acc: 0.153 Test Loss: 3.203 Test Acc: 0.153
Validation loss decreased (-0.105850 --> -0.152909).  Saving model ...
Epoch: 6 cost time: 1.603621006011963
Epoch: 6, Steps: 10 | Train Loss: 2.312 Vali Loss: 3.137 Vali Acc: 0.166 Test Loss: 3.137 Test Acc: 0.166
Validation loss decreased (-0.152909 --> -0.165851).  Saving model ...
Epoch: 7 cost time: 1.3753364086151123
Epoch: 7, Steps: 10 | Train Loss: 1.983 Vali Loss: 3.096 Vali Acc: 0.186 Test Loss: 3.096 Test Acc: 0.186
Validation loss decreased (-0.165851 --> -0.185851).  Saving model ...
Epoch: 8 cost time: 1.5083653926849365
Epoch: 8, Steps: 10 | Train Loss: 1.757 Vali Loss: 3.097 Vali Acc: 0.185 Test Loss: 3.097 Test Acc: 0.185
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4669935703277588
Epoch: 9, Steps: 10 | Train Loss: 1.433 Vali Loss: 3.035 Vali Acc: 0.207 Test Loss: 3.035 Test Acc: 0.207
Validation loss decreased (-0.185851 --> -0.207028).  Saving model ...
Epoch: 10 cost time: 1.2487430572509766
Epoch: 10, Steps: 10 | Train Loss: 1.251 Vali Loss: 3.034 Vali Acc: 0.225 Test Loss: 3.034 Test Acc: 0.225
Validation loss decreased (-0.207028 --> -0.224676).  Saving model ...
Epoch: 11 cost time: 1.3061764240264893
Epoch: 11, Steps: 10 | Train Loss: 0.951 Vali Loss: 3.012 Vali Acc: 0.232 Test Loss: 3.012 Test Acc: 0.232
Validation loss decreased (-0.224676 --> -0.231735).  Saving model ...
Epoch: 12 cost time: 1.1744794845581055
Epoch: 12, Steps: 10 | Train Loss: 0.720 Vali Loss: 3.024 Vali Acc: 0.254 Test Loss: 3.024 Test Acc: 0.254
Validation loss decreased (-0.231735 --> -0.254087).  Saving model ...
Epoch: 13 cost time: 1.1001737117767334
Epoch: 13, Steps: 10 | Train Loss: 0.556 Vali Loss: 2.992 Vali Acc: 0.265 Test Loss: 2.992 Test Acc: 0.265
Validation loss decreased (-0.254087 --> -0.264676).  Saving model ...
Epoch: 14 cost time: 1.2548086643218994
Epoch: 14, Steps: 10 | Train Loss: 0.436 Vali Loss: 3.070 Vali Acc: 0.269 Test Loss: 3.070 Test Acc: 0.269
Validation loss decreased (-0.264676 --> -0.269381).  Saving model ...
Epoch: 15 cost time: 1.0927369594573975
Epoch: 15, Steps: 10 | Train Loss: 0.322 Vali Loss: 3.053 Vali Acc: 0.292 Test Loss: 3.053 Test Acc: 0.292
Validation loss decreased (-0.269381 --> -0.291734).  Saving model ...
Epoch: 16 cost time: 1.2718780040740967
Epoch: 16, Steps: 10 | Train Loss: 0.175 Vali Loss: 3.075 Vali Acc: 0.287 Test Loss: 3.075 Test Acc: 0.287
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.496612548828125
Epoch: 17, Steps: 10 | Train Loss: 0.142 Vali Loss: 3.083 Vali Acc: 0.308 Test Loss: 3.083 Test Acc: 0.308
Validation loss decreased (-0.291734 --> -0.308204).  Saving model ...
Epoch: 18 cost time: 1.3005344867706299
Epoch: 18, Steps: 10 | Train Loss: 0.112 Vali Loss: 3.131 Vali Acc: 0.312 Test Loss: 3.131 Test Acc: 0.312
Validation loss decreased (-0.308204 --> -0.311733).  Saving model ...
Epoch: 19 cost time: 1.4826853275299072
Epoch: 19, Steps: 10 | Train Loss: 0.090 Vali Loss: 3.106 Vali Acc: 0.326 Test Loss: 3.106 Test Acc: 0.326
Validation loss decreased (-0.311733 --> -0.325851).  Saving model ...
Epoch: 20 cost time: 1.3452038764953613
Epoch: 20, Steps: 10 | Train Loss: 0.064 Vali Loss: 3.154 Vali Acc: 0.314 Test Loss: 3.154 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.438213586807251
Epoch: 21, Steps: 10 | Train Loss: 0.076 Vali Loss: 3.214 Vali Acc: 0.314 Test Loss: 3.214 Test Acc: 0.314
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.2703649997711182
Epoch: 22, Steps: 10 | Train Loss: 0.078 Vali Loss: 3.204 Vali Acc: 0.318 Test Loss: 3.204 Test Acc: 0.318
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.302241325378418
Epoch: 23, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.233 Vali Acc: 0.321 Test Loss: 3.233 Test Acc: 0.321
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.374079942703247
Epoch: 24, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.192 Vali Acc: 0.328 Test Loss: 3.192 Test Acc: 0.328
Validation loss decreased (-0.325851 --> -0.328203).  Saving model ...
Epoch: 25 cost time: 1.320868730545044
Epoch: 25, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.244 Vali Acc: 0.326 Test Loss: 3.244 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.536968469619751
Epoch: 26, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.270 Vali Acc: 0.316 Test Loss: 3.270 Test Acc: 0.316
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.3665931224822998
Epoch: 27, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.269 Vali Acc: 0.329 Test Loss: 3.269 Test Acc: 0.329
Validation loss decreased (-0.328203 --> -0.329379).  Saving model ...
Epoch: 28 cost time: 1.5069997310638428
Epoch: 28, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.259 Vali Acc: 0.333 Test Loss: 3.259 Test Acc: 0.333
Validation loss decreased (-0.329379 --> -0.332909).  Saving model ...
Epoch: 29 cost time: 1.4907119274139404
Epoch: 29, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.264 Vali Acc: 0.331 Test Loss: 3.264 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1451056003570557
Epoch: 30, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.353 Vali Acc: 0.331 Test Loss: 3.353 Test Acc: 0.331
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.33294117647058824
model parameter : 1504762
model size : 6.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.6451833248138428
Epoch: 1, Steps: 10 | Train Loss: 3.329 Vali Loss: 3.323 Vali Acc: 0.040 Test Loss: 3.323 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 2.4749178886413574
Epoch: 2, Steps: 10 | Train Loss: 3.158 Vali Loss: 3.278 Vali Acc: 0.066 Test Loss: 3.278 Test Acc: 0.066
Validation loss decreased (-0.039967 --> -0.065850).  Saving model ...
Epoch: 3 cost time: 2.3722174167633057
Epoch: 3, Steps: 10 | Train Loss: 2.942 Vali Loss: 3.258 Vali Acc: 0.101 Test Loss: 3.258 Test Acc: 0.101
Validation loss decreased (-0.065850 --> -0.101144).  Saving model ...
Epoch: 4 cost time: 2.701416254043579
Epoch: 4, Steps: 10 | Train Loss: 2.664 Vali Loss: 3.219 Vali Acc: 0.126 Test Loss: 3.219 Test Acc: 0.126
Validation loss decreased (-0.101144 --> -0.125850).  Saving model ...
Epoch: 5 cost time: 2.6320619583129883
Epoch: 5, Steps: 10 | Train Loss: 2.391 Vali Loss: 3.140 Vali Acc: 0.147 Test Loss: 3.140 Test Acc: 0.147
Validation loss decreased (-0.125850 --> -0.147027).  Saving model ...
Epoch: 6 cost time: 2.6898462772369385
Epoch: 6, Steps: 10 | Train Loss: 2.039 Vali Loss: 3.054 Vali Acc: 0.185 Test Loss: 3.054 Test Acc: 0.185
Validation loss decreased (-0.147027 --> -0.184675).  Saving model ...
Epoch: 7 cost time: 3.1491730213165283
Epoch: 7, Steps: 10 | Train Loss: 1.673 Vali Loss: 2.999 Vali Acc: 0.195 Test Loss: 2.999 Test Acc: 0.195
Validation loss decreased (-0.184675 --> -0.195264).  Saving model ...
Epoch: 8 cost time: 2.852248430252075
Epoch: 8, Steps: 10 | Train Loss: 1.295 Vali Loss: 2.985 Vali Acc: 0.208 Test Loss: 2.985 Test Acc: 0.208
Validation loss decreased (-0.195264 --> -0.208205).  Saving model ...
Epoch: 9 cost time: 2.9761219024658203
Epoch: 9, Steps: 10 | Train Loss: 1.051 Vali Loss: 2.949 Vali Acc: 0.227 Test Loss: 2.949 Test Acc: 0.227
Validation loss decreased (-0.208205 --> -0.227029).  Saving model ...
Epoch: 10 cost time: 3.0907418727874756
Epoch: 10, Steps: 10 | Train Loss: 0.818 Vali Loss: 2.914 Vali Acc: 0.261 Test Loss: 2.914 Test Acc: 0.261
Validation loss decreased (-0.227029 --> -0.261147).  Saving model ...
Epoch: 11 cost time: 3.025397777557373
Epoch: 11, Steps: 10 | Train Loss: 0.583 Vali Loss: 2.936 Vali Acc: 0.256 Test Loss: 2.936 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.8204755783081055
Epoch: 12, Steps: 10 | Train Loss: 0.416 Vali Loss: 2.948 Vali Acc: 0.281 Test Loss: 2.948 Test Acc: 0.281
Validation loss decreased (-0.261147 --> -0.281147).  Saving model ...
Epoch: 13 cost time: 3.0818214416503906
Epoch: 13, Steps: 10 | Train Loss: 0.264 Vali Loss: 2.994 Vali Acc: 0.294 Test Loss: 2.994 Test Acc: 0.294
Validation loss decreased (-0.281147 --> -0.294088).  Saving model ...
Epoch: 14 cost time: 2.150418996810913
Epoch: 14, Steps: 10 | Train Loss: 0.199 Vali Loss: 2.982 Vali Acc: 0.289 Test Loss: 2.982 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.6486597061157227
Epoch: 15, Steps: 10 | Train Loss: 0.133 Vali Loss: 3.042 Vali Acc: 0.307 Test Loss: 3.042 Test Acc: 0.307
Validation loss decreased (-0.294088 --> -0.307028).  Saving model ...
Epoch: 16 cost time: 2.1734390258789062
Epoch: 16, Steps: 10 | Train Loss: 0.099 Vali Loss: 3.077 Vali Acc: 0.304 Test Loss: 3.077 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.4896328449249268
Epoch: 17, Steps: 10 | Train Loss: 0.079 Vali Loss: 3.045 Vali Acc: 0.315 Test Loss: 3.045 Test Acc: 0.315
Validation loss decreased (-0.307028 --> -0.315264).  Saving model ...
Epoch: 18 cost time: 2.5608506202697754
Epoch: 18, Steps: 10 | Train Loss: 0.061 Vali Loss: 3.173 Vali Acc: 0.302 Test Loss: 3.173 Test Acc: 0.302
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.740105628967285
Epoch: 19, Steps: 10 | Train Loss: 0.043 Vali Loss: 3.138 Vali Acc: 0.318 Test Loss: 3.138 Test Acc: 0.318
Validation loss decreased (-0.315264 --> -0.317616).  Saving model ...
Epoch: 20 cost time: 2.5074880123138428
Epoch: 20, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.177 Vali Acc: 0.315 Test Loss: 3.177 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.918227195739746
Epoch: 21, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.153 Vali Acc: 0.309 Test Loss: 3.153 Test Acc: 0.309
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.998903751373291
Epoch: 22, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.157 Vali Acc: 0.312 Test Loss: 3.157 Test Acc: 0.312
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.9706146717071533
Epoch: 23, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.181 Vali Acc: 0.318 Test Loss: 3.181 Test Acc: 0.318
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.67354154586792
Epoch: 24, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.192 Vali Acc: 0.320 Test Loss: 3.192 Test Acc: 0.320
Validation loss decreased (-0.317616 --> -0.319968).  Saving model ...
Epoch: 25 cost time: 3.0163347721099854
Epoch: 25, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.236 Vali Acc: 0.301 Test Loss: 3.236 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.410318374633789
Epoch: 26, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.273 Vali Acc: 0.311 Test Loss: 3.273 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.7049622535705566
Epoch: 27, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.250 Vali Acc: 0.314 Test Loss: 3.250 Test Acc: 0.314
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.3467347621917725
Epoch: 28, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.262 Vali Acc: 0.312 Test Loss: 3.262 Test Acc: 0.312
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.372664213180542
Epoch: 29, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.248 Vali Acc: 0.320 Test Loss: 3.248 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.4653842449188232
Epoch: 30, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.267 Vali Acc: 0.325 Test Loss: 3.267 Test Acc: 0.325
Validation loss decreased (-0.319968 --> -0.324673).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3247058823529412
model parameter : 2471418
model size : 10.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.056514263153076
Epoch: 1, Steps: 10 | Train Loss: 3.299 Vali Loss: 3.286 Vali Acc: 0.040 Test Loss: 3.286 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 1.8488543033599854
Epoch: 2, Steps: 10 | Train Loss: 3.141 Vali Loss: 3.275 Vali Acc: 0.069 Test Loss: 3.275 Test Acc: 0.069
Validation loss decreased (-0.039967 --> -0.069379).  Saving model ...
Epoch: 3 cost time: 1.7384181022644043
Epoch: 3, Steps: 10 | Train Loss: 2.919 Vali Loss: 3.289 Vali Acc: 0.088 Test Loss: 3.289 Test Acc: 0.088
Validation loss decreased (-0.069379 --> -0.088202).  Saving model ...
Epoch: 4 cost time: 1.9379990100860596
Epoch: 4, Steps: 10 | Train Loss: 2.723 Vali Loss: 3.249 Vali Acc: 0.113 Test Loss: 3.249 Test Acc: 0.113
Validation loss decreased (-0.088202 --> -0.112909).  Saving model ...
Epoch: 5 cost time: 1.817084550857544
Epoch: 5, Steps: 10 | Train Loss: 2.475 Vali Loss: 3.175 Vali Acc: 0.154 Test Loss: 3.175 Test Acc: 0.154
Validation loss decreased (-0.112909 --> -0.154086).  Saving model ...
Epoch: 6 cost time: 1.9169666767120361
Epoch: 6, Steps: 10 | Train Loss: 2.146 Vali Loss: 3.119 Vali Acc: 0.161 Test Loss: 3.119 Test Acc: 0.161
Validation loss decreased (-0.154086 --> -0.161145).  Saving model ...
Epoch: 7 cost time: 1.970973253250122
Epoch: 7, Steps: 10 | Train Loss: 1.866 Vali Loss: 3.053 Vali Acc: 0.174 Test Loss: 3.053 Test Acc: 0.174
Validation loss decreased (-0.161145 --> -0.174087).  Saving model ...
Epoch: 8 cost time: 1.846426248550415
Epoch: 8, Steps: 10 | Train Loss: 1.573 Vali Loss: 3.000 Vali Acc: 0.195 Test Loss: 3.000 Test Acc: 0.195
Validation loss decreased (-0.174087 --> -0.195264).  Saving model ...
Epoch: 9 cost time: 1.7207670211791992
Epoch: 9, Steps: 10 | Train Loss: 1.252 Vali Loss: 2.957 Vali Acc: 0.222 Test Loss: 2.957 Test Acc: 0.222
Validation loss decreased (-0.195264 --> -0.222323).  Saving model ...
Epoch: 10 cost time: 1.8517005443572998
Epoch: 10, Steps: 10 | Train Loss: 0.972 Vali Loss: 2.963 Vali Acc: 0.224 Test Loss: 2.963 Test Acc: 0.224
Validation loss decreased (-0.222323 --> -0.223500).  Saving model ...
Epoch: 11 cost time: 1.8549480438232422
Epoch: 11, Steps: 10 | Train Loss: 0.712 Vali Loss: 2.926 Vali Acc: 0.267 Test Loss: 2.926 Test Acc: 0.267
Validation loss decreased (-0.223500 --> -0.267030).  Saving model ...
Epoch: 12 cost time: 1.8013465404510498
Epoch: 12, Steps: 10 | Train Loss: 0.490 Vali Loss: 2.911 Vali Acc: 0.274 Test Loss: 2.911 Test Acc: 0.274
Validation loss decreased (-0.267030 --> -0.274089).  Saving model ...
Epoch: 13 cost time: 1.7252717018127441
Epoch: 13, Steps: 10 | Train Loss: 0.345 Vali Loss: 2.932 Vali Acc: 0.285 Test Loss: 2.932 Test Acc: 0.285
Validation loss decreased (-0.274089 --> -0.284677).  Saving model ...
Epoch: 14 cost time: 1.725890874862671
Epoch: 14, Steps: 10 | Train Loss: 0.255 Vali Loss: 2.959 Vali Acc: 0.288 Test Loss: 2.959 Test Acc: 0.288
Validation loss decreased (-0.284677 --> -0.288206).  Saving model ...
Epoch: 15 cost time: 1.7718050479888916
Epoch: 15, Steps: 10 | Train Loss: 0.165 Vali Loss: 2.973 Vali Acc: 0.295 Test Loss: 2.973 Test Acc: 0.295
Validation loss decreased (-0.288206 --> -0.295264).  Saving model ...
Epoch: 16 cost time: 1.5951776504516602
Epoch: 16, Steps: 10 | Train Loss: 0.126 Vali Loss: 3.020 Vali Acc: 0.300 Test Loss: 3.020 Test Acc: 0.300
Validation loss decreased (-0.295264 --> -0.299970).  Saving model ...
Epoch: 17 cost time: 2.596388816833496
Epoch: 17, Steps: 10 | Train Loss: 0.083 Vali Loss: 3.062 Vali Acc: 0.304 Test Loss: 3.062 Test Acc: 0.304
Validation loss decreased (-0.299970 --> -0.303499).  Saving model ...
Epoch: 18 cost time: 2.5674397945404053
Epoch: 18, Steps: 10 | Train Loss: 0.060 Vali Loss: 3.072 Vali Acc: 0.304 Test Loss: 3.072 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.6222050189971924
Epoch: 19, Steps: 10 | Train Loss: 0.058 Vali Loss: 3.063 Vali Acc: 0.331 Test Loss: 3.063 Test Acc: 0.331
Validation loss decreased (-0.303499 --> -0.330558).  Saving model ...
Epoch: 20 cost time: 2.7036681175231934
Epoch: 20, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.110 Vali Acc: 0.328 Test Loss: 3.110 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.554558753967285
Epoch: 21, Steps: 10 | Train Loss: 0.068 Vali Loss: 3.121 Vali Acc: 0.332 Test Loss: 3.121 Test Acc: 0.332
Validation loss decreased (-0.330558 --> -0.331733).  Saving model ...
Epoch: 22 cost time: 2.552994966506958
Epoch: 22, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.143 Vali Acc: 0.326 Test Loss: 3.143 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.6358115673065186
Epoch: 23, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.125 Vali Acc: 0.329 Test Loss: 3.125 Test Acc: 0.329
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.7480976581573486
Epoch: 24, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.112 Vali Acc: 0.336 Test Loss: 3.112 Test Acc: 0.336
Validation loss decreased (-0.331733 --> -0.336439).  Saving model ...
Epoch: 25 cost time: 2.6078925132751465
Epoch: 25, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.119 Vali Acc: 0.326 Test Loss: 3.119 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.6065499782562256
Epoch: 26, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.198 Vali Acc: 0.324 Test Loss: 3.198 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.6015102863311768
Epoch: 27, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.177 Vali Acc: 0.336 Test Loss: 3.177 Test Acc: 0.336
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.626746654510498
Epoch: 28, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.177 Vali Acc: 0.339 Test Loss: 3.177 Test Acc: 0.339
Validation loss decreased (-0.336439 --> -0.338792).  Saving model ...
Epoch: 29 cost time: 2.5122177600860596
Epoch: 29, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.193 Vali Acc: 0.339 Test Loss: 3.193 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.6237270832061768
Epoch: 30, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.196 Vali Acc: 0.335 Test Loss: 3.196 Test Acc: 0.335
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3388235294117647
model parameter : 816122
model size : 3.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.2480363845825195
Epoch: 1, Steps: 10 | Train Loss: 3.327 Vali Loss: 3.319 Vali Acc: 0.040 Test Loss: 3.319 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 2.8736798763275146
Epoch: 2, Steps: 10 | Train Loss: 3.159 Vali Loss: 3.276 Vali Acc: 0.069 Test Loss: 3.276 Test Acc: 0.069
Validation loss decreased (-0.039967 --> -0.069379).  Saving model ...
Epoch: 3 cost time: 2.81779146194458
Epoch: 3, Steps: 10 | Train Loss: 2.938 Vali Loss: 3.260 Vali Acc: 0.102 Test Loss: 3.260 Test Acc: 0.102
Validation loss decreased (-0.069379 --> -0.102320).  Saving model ...
Epoch: 4 cost time: 2.9603638648986816
Epoch: 4, Steps: 10 | Train Loss: 2.711 Vali Loss: 3.231 Vali Acc: 0.121 Test Loss: 3.231 Test Acc: 0.121
Validation loss decreased (-0.102320 --> -0.121144).  Saving model ...
Epoch: 5 cost time: 2.9564552307128906
Epoch: 5, Steps: 10 | Train Loss: 2.438 Vali Loss: 3.162 Vali Acc: 0.144 Test Loss: 3.162 Test Acc: 0.144
Validation loss decreased (-0.121144 --> -0.143498).  Saving model ...
Epoch: 6 cost time: 2.7695412635803223
Epoch: 6, Steps: 10 | Train Loss: 2.120 Vali Loss: 3.081 Vali Acc: 0.182 Test Loss: 3.081 Test Acc: 0.182
Validation loss decreased (-0.143498 --> -0.182322).  Saving model ...
Epoch: 7 cost time: 3.078314781188965
Epoch: 7, Steps: 10 | Train Loss: 1.783 Vali Loss: 3.028 Vali Acc: 0.192 Test Loss: 3.028 Test Acc: 0.192
Validation loss decreased (-0.182322 --> -0.191734).  Saving model ...
Epoch: 8 cost time: 2.9614627361297607
Epoch: 8, Steps: 10 | Train Loss: 1.483 Vali Loss: 3.027 Vali Acc: 0.201 Test Loss: 3.027 Test Acc: 0.201
Validation loss decreased (-0.191734 --> -0.201146).  Saving model ...
Epoch: 9 cost time: 3.097252130508423
Epoch: 9, Steps: 10 | Train Loss: 1.254 Vali Loss: 3.021 Vali Acc: 0.213 Test Loss: 3.021 Test Acc: 0.213
Validation loss decreased (-0.201146 --> -0.212911).  Saving model ...
Epoch: 10 cost time: 2.94402813911438
Epoch: 10, Steps: 10 | Train Loss: 0.919 Vali Loss: 2.940 Vali Acc: 0.245 Test Loss: 2.940 Test Acc: 0.245
Validation loss decreased (-0.212911 --> -0.244676).  Saving model ...
Epoch: 11 cost time: 3.1019833087921143
Epoch: 11, Steps: 10 | Train Loss: 0.677 Vali Loss: 2.986 Vali Acc: 0.262 Test Loss: 2.986 Test Acc: 0.262
Validation loss decreased (-0.244676 --> -0.262323).  Saving model ...
Epoch: 12 cost time: 3.1653873920440674
Epoch: 12, Steps: 10 | Train Loss: 0.511 Vali Loss: 2.969 Vali Acc: 0.264 Test Loss: 2.969 Test Acc: 0.264
Validation loss decreased (-0.262323 --> -0.263500).  Saving model ...
Epoch: 13 cost time: 2.7275733947753906
Epoch: 13, Steps: 10 | Train Loss: 0.312 Vali Loss: 2.996 Vali Acc: 0.296 Test Loss: 2.996 Test Acc: 0.296
Validation loss decreased (-0.263500 --> -0.296441).  Saving model ...
Epoch: 14 cost time: 2.981234312057495
Epoch: 14, Steps: 10 | Train Loss: 0.271 Vali Loss: 3.046 Vali Acc: 0.294 Test Loss: 3.046 Test Acc: 0.294
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.8621666431427
Epoch: 15, Steps: 10 | Train Loss: 0.140 Vali Loss: 3.146 Vali Acc: 0.292 Test Loss: 3.146 Test Acc: 0.292
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.887157917022705
Epoch: 16, Steps: 10 | Train Loss: 0.166 Vali Loss: 3.134 Vali Acc: 0.308 Test Loss: 3.134 Test Acc: 0.308
Validation loss decreased (-0.296441 --> -0.308204).  Saving model ...
Epoch: 17 cost time: 3.1808359622955322
Epoch: 17, Steps: 10 | Train Loss: 0.098 Vali Loss: 3.133 Vali Acc: 0.313 Test Loss: 3.133 Test Acc: 0.313
Validation loss decreased (-0.308204 --> -0.312910).  Saving model ...
Epoch: 18 cost time: 1.9457926750183105
Epoch: 18, Steps: 10 | Train Loss: 0.107 Vali Loss: 3.180 Vali Acc: 0.314 Test Loss: 3.180 Test Acc: 0.314
Validation loss decreased (-0.312910 --> -0.314086).  Saving model ...
Epoch: 19 cost time: 1.8282134532928467
Epoch: 19, Steps: 10 | Train Loss: 0.096 Vali Loss: 3.152 Vali Acc: 0.309 Test Loss: 3.152 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.936570405960083
Epoch: 20, Steps: 10 | Train Loss: 0.069 Vali Loss: 3.214 Vali Acc: 0.319 Test Loss: 3.214 Test Acc: 0.319
Validation loss decreased (-0.314086 --> -0.318791).  Saving model ...
Epoch: 21 cost time: 2.9036154747009277
Epoch: 21, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.204 Vali Acc: 0.308 Test Loss: 3.204 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.861539363861084
Epoch: 22, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.223 Vali Acc: 0.320 Test Loss: 3.223 Test Acc: 0.320
Validation loss decreased (-0.318791 --> -0.319968).  Saving model ...
Epoch: 23 cost time: 2.4867982864379883
Epoch: 23, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.226 Vali Acc: 0.336 Test Loss: 3.226 Test Acc: 0.336
Validation loss decreased (-0.319968 --> -0.336438).  Saving model ...
Epoch: 24 cost time: 3.1118109226226807
Epoch: 24, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.257 Vali Acc: 0.334 Test Loss: 3.257 Test Acc: 0.334
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.8806021213531494
Epoch: 25, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.269 Vali Acc: 0.318 Test Loss: 3.269 Test Acc: 0.318
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.0593883991241455
Epoch: 26, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.273 Vali Acc: 0.332 Test Loss: 3.273 Test Acc: 0.332
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.15818190574646
Epoch: 27, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.258 Vali Acc: 0.331 Test Loss: 3.258 Test Acc: 0.331
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.1365373134613037
Epoch: 28, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.257 Vali Acc: 0.336 Test Loss: 3.257 Test Acc: 0.336
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.9881439208984375
Epoch: 29, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.254 Vali Acc: 0.339 Test Loss: 3.254 Test Acc: 0.339
Validation loss decreased (-0.336438 --> -0.338791).  Saving model ...
Epoch: 30 cost time: 2.874204397201538
Epoch: 30, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.314 Vali Acc: 0.336 Test Loss: 3.314 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3388235294117647
model parameter : 2471418
model size : 10.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.538081407546997
Epoch: 1, Steps: 10 | Train Loss: 3.299 Vali Loss: 3.283 Vali Acc: 0.044 Test Loss: 3.283 Test Acc: 0.044
Validation loss decreased (inf --> -0.043497).  Saving model ...
Epoch: 2 cost time: 2.1859090328216553
Epoch: 2, Steps: 10 | Train Loss: 3.155 Vali Loss: 3.275 Vali Acc: 0.069 Test Loss: 3.275 Test Acc: 0.069
Validation loss decreased (-0.043497 --> -0.069379).  Saving model ...
Epoch: 3 cost time: 2.142152786254883
Epoch: 3, Steps: 10 | Train Loss: 2.955 Vali Loss: 3.292 Vali Acc: 0.091 Test Loss: 3.292 Test Acc: 0.091
Validation loss decreased (-0.069379 --> -0.090555).  Saving model ...
Epoch: 4 cost time: 2.1868808269500732
Epoch: 4, Steps: 10 | Train Loss: 2.759 Vali Loss: 3.257 Vali Acc: 0.107 Test Loss: 3.257 Test Acc: 0.107
Validation loss decreased (-0.090555 --> -0.107026).  Saving model ...
Epoch: 5 cost time: 2.015986204147339
Epoch: 5, Steps: 10 | Train Loss: 2.530 Vali Loss: 3.187 Vali Acc: 0.141 Test Loss: 3.187 Test Acc: 0.141
Validation loss decreased (-0.107026 --> -0.141145).  Saving model ...
Epoch: 6 cost time: 1.9476103782653809
Epoch: 6, Steps: 10 | Train Loss: 2.237 Vali Loss: 3.137 Vali Acc: 0.155 Test Loss: 3.137 Test Acc: 0.155
Validation loss decreased (-0.141145 --> -0.155263).  Saving model ...
Epoch: 7 cost time: 2.0882728099823
Epoch: 7, Steps: 10 | Train Loss: 1.963 Vali Loss: 3.074 Vali Acc: 0.175 Test Loss: 3.074 Test Acc: 0.175
Validation loss decreased (-0.155263 --> -0.175263).  Saving model ...
Epoch: 8 cost time: 1.8295061588287354
Epoch: 8, Steps: 10 | Train Loss: 1.725 Vali Loss: 3.023 Vali Acc: 0.208 Test Loss: 3.023 Test Acc: 0.208
Validation loss decreased (-0.175263 --> -0.208205).  Saving model ...
Epoch: 9 cost time: 1.9977445602416992
Epoch: 9, Steps: 10 | Train Loss: 1.399 Vali Loss: 2.996 Vali Acc: 0.215 Test Loss: 2.996 Test Acc: 0.215
Validation loss decreased (-0.208205 --> -0.215264).  Saving model ...
Epoch: 10 cost time: 1.289691686630249
Epoch: 10, Steps: 10 | Train Loss: 1.123 Vali Loss: 2.988 Vali Acc: 0.221 Test Loss: 2.988 Test Acc: 0.221
Validation loss decreased (-0.215264 --> -0.221147).  Saving model ...
Epoch: 11 cost time: 2.018669366836548
Epoch: 11, Steps: 10 | Train Loss: 0.912 Vali Loss: 2.991 Vali Acc: 0.255 Test Loss: 2.991 Test Acc: 0.255
Validation loss decreased (-0.221147 --> -0.255264).  Saving model ...
Epoch: 12 cost time: 2.075066328048706
Epoch: 12, Steps: 10 | Train Loss: 0.730 Vali Loss: 3.001 Vali Acc: 0.259 Test Loss: 3.001 Test Acc: 0.259
Validation loss decreased (-0.255264 --> -0.258794).  Saving model ...
Epoch: 13 cost time: 2.08980655670166
Epoch: 13, Steps: 10 | Train Loss: 0.482 Vali Loss: 3.000 Vali Acc: 0.272 Test Loss: 3.000 Test Acc: 0.272
Validation loss decreased (-0.258794 --> -0.271735).  Saving model ...
Epoch: 14 cost time: 2.0883054733276367
Epoch: 14, Steps: 10 | Train Loss: 0.403 Vali Loss: 3.054 Vali Acc: 0.274 Test Loss: 3.054 Test Acc: 0.274
Validation loss decreased (-0.271735 --> -0.274087).  Saving model ...
Epoch: 15 cost time: 2.1232669353485107
Epoch: 15, Steps: 10 | Train Loss: 0.260 Vali Loss: 3.038 Vali Acc: 0.299 Test Loss: 3.038 Test Acc: 0.299
Validation loss decreased (-0.274087 --> -0.298793).  Saving model ...
Epoch: 16 cost time: 2.0801379680633545
Epoch: 16, Steps: 10 | Train Loss: 0.272 Vali Loss: 3.038 Vali Acc: 0.294 Test Loss: 3.038 Test Acc: 0.294
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.132831573486328
Epoch: 17, Steps: 10 | Train Loss: 0.144 Vali Loss: 3.104 Vali Acc: 0.293 Test Loss: 3.104 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.066437005996704
Epoch: 18, Steps: 10 | Train Loss: 0.115 Vali Loss: 3.195 Vali Acc: 0.321 Test Loss: 3.195 Test Acc: 0.321
Validation loss decreased (-0.298793 --> -0.321145).  Saving model ...
Epoch: 19 cost time: 2.188660144805908
Epoch: 19, Steps: 10 | Train Loss: 0.105 Vali Loss: 3.146 Vali Acc: 0.306 Test Loss: 3.146 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.7801756858825684
Epoch: 20, Steps: 10 | Train Loss: 0.073 Vali Loss: 3.218 Vali Acc: 0.325 Test Loss: 3.218 Test Acc: 0.325
Validation loss decreased (-0.321145 --> -0.324674).  Saving model ...
Epoch: 21 cost time: 2.186760663986206
Epoch: 21, Steps: 10 | Train Loss: 0.097 Vali Loss: 3.221 Vali Acc: 0.313 Test Loss: 3.221 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.1545252799987793
Epoch: 22, Steps: 10 | Train Loss: 0.087 Vali Loss: 3.211 Vali Acc: 0.319 Test Loss: 3.211 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.113272190093994
Epoch: 23, Steps: 10 | Train Loss: 0.074 Vali Loss: 3.266 Vali Acc: 0.319 Test Loss: 3.266 Test Acc: 0.319
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.1204540729522705
Epoch: 24, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.265 Vali Acc: 0.325 Test Loss: 3.265 Test Acc: 0.325
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.880232572555542
Epoch: 25, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.233 Vali Acc: 0.308 Test Loss: 3.233 Test Acc: 0.308
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.158503293991089
Epoch: 26, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.360 Vali Acc: 0.295 Test Loss: 3.360 Test Acc: 0.295
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.024836540222168
Epoch: 27, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.341 Vali Acc: 0.318 Test Loss: 3.341 Test Acc: 0.318
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.1257376670837402
Epoch: 28, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.356 Vali Acc: 0.320 Test Loss: 3.356 Test Acc: 0.320
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.0406272411346436
Epoch: 29, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.351 Vali Acc: 0.321 Test Loss: 3.351 Test Acc: 0.321
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.7523086071014404
Epoch: 30, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.369 Vali Acc: 0.315 Test Loss: 3.369 Test Acc: 0.315
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3247058823529412
model parameter : 816122
model size : 3.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.5056071281433105
Epoch: 1, Steps: 10 | Train Loss: 3.329 Vali Loss: 3.320 Vali Acc: 0.042 Test Loss: 3.320 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 2.001708984375
Epoch: 2, Steps: 10 | Train Loss: 3.170 Vali Loss: 3.281 Vali Acc: 0.072 Test Loss: 3.281 Test Acc: 0.072
Validation loss decreased (-0.042320 --> -0.071732).  Saving model ...
Epoch: 3 cost time: 2.0692405700683594
Epoch: 3, Steps: 10 | Train Loss: 2.957 Vali Loss: 3.271 Vali Acc: 0.105 Test Loss: 3.271 Test Acc: 0.105
Validation loss decreased (-0.071732 --> -0.104673).  Saving model ...
Epoch: 4 cost time: 2.055574655532837
Epoch: 4, Steps: 10 | Train Loss: 2.756 Vali Loss: 3.252 Vali Acc: 0.116 Test Loss: 3.252 Test Acc: 0.116
Validation loss decreased (-0.104673 --> -0.116438).  Saving model ...
Epoch: 5 cost time: 2.185045003890991
Epoch: 5, Steps: 10 | Train Loss: 2.511 Vali Loss: 3.191 Vali Acc: 0.129 Test Loss: 3.191 Test Acc: 0.129
Validation loss decreased (-0.116438 --> -0.129380).  Saving model ...
Epoch: 6 cost time: 2.127924680709839
Epoch: 6, Steps: 10 | Train Loss: 2.222 Vali Loss: 3.116 Vali Acc: 0.176 Test Loss: 3.116 Test Acc: 0.176
Validation loss decreased (-0.129380 --> -0.176439).  Saving model ...
Epoch: 7 cost time: 2.090147018432617
Epoch: 7, Steps: 10 | Train Loss: 1.998 Vali Loss: 3.078 Vali Acc: 0.198 Test Loss: 3.078 Test Acc: 0.198
Validation loss decreased (-0.176439 --> -0.197616).  Saving model ...
Epoch: 8 cost time: 2.218177318572998
Epoch: 8, Steps: 10 | Train Loss: 1.661 Vali Loss: 3.062 Vali Acc: 0.205 Test Loss: 3.062 Test Acc: 0.205
Validation loss decreased (-0.197616 --> -0.204675).  Saving model ...
Epoch: 9 cost time: 2.2035140991210938
Epoch: 9, Steps: 10 | Train Loss: 1.426 Vali Loss: 3.051 Vali Acc: 0.212 Test Loss: 3.051 Test Acc: 0.212
Validation loss decreased (-0.204675 --> -0.211734).  Saving model ...
Epoch: 10 cost time: 1.996253252029419
Epoch: 10, Steps: 10 | Train Loss: 1.139 Vali Loss: 3.021 Vali Acc: 0.241 Test Loss: 3.021 Test Acc: 0.241
Validation loss decreased (-0.211734 --> -0.241146).  Saving model ...
Epoch: 11 cost time: 2.0117621421813965
Epoch: 11, Steps: 10 | Train Loss: 0.849 Vali Loss: 2.991 Vali Acc: 0.260 Test Loss: 2.991 Test Acc: 0.260
Validation loss decreased (-0.241146 --> -0.259970).  Saving model ...
Epoch: 12 cost time: 1.860018014907837
Epoch: 12, Steps: 10 | Train Loss: 0.633 Vali Loss: 3.035 Vali Acc: 0.268 Test Loss: 3.035 Test Acc: 0.268
Validation loss decreased (-0.259970 --> -0.268205).  Saving model ...
Epoch: 13 cost time: 2.054882764816284
Epoch: 13, Steps: 10 | Train Loss: 0.533 Vali Loss: 3.020 Vali Acc: 0.300 Test Loss: 3.020 Test Acc: 0.300
Validation loss decreased (-0.268205 --> -0.299970).  Saving model ...
Epoch: 14 cost time: 1.538081407546997
Epoch: 14, Steps: 10 | Train Loss: 0.409 Vali Loss: 3.047 Vali Acc: 0.275 Test Loss: 3.047 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3057539463043213
Epoch: 15, Steps: 10 | Train Loss: 0.264 Vali Loss: 3.065 Vali Acc: 0.305 Test Loss: 3.065 Test Acc: 0.305
Validation loss decreased (-0.299970 --> -0.304675).  Saving model ...
Epoch: 16 cost time: 1.720879077911377
Epoch: 16, Steps: 10 | Train Loss: 0.217 Vali Loss: 3.142 Vali Acc: 0.312 Test Loss: 3.142 Test Acc: 0.312
Validation loss decreased (-0.304675 --> -0.311733).  Saving model ...
Epoch: 17 cost time: 1.9207043647766113
Epoch: 17, Steps: 10 | Train Loss: 0.198 Vali Loss: 3.121 Vali Acc: 0.302 Test Loss: 3.121 Test Acc: 0.302
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7007882595062256
Epoch: 18, Steps: 10 | Train Loss: 0.123 Vali Loss: 3.322 Vali Acc: 0.305 Test Loss: 3.322 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.865605115890503
Epoch: 19, Steps: 10 | Train Loss: 0.158 Vali Loss: 3.161 Vali Acc: 0.307 Test Loss: 3.161 Test Acc: 0.307
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.5758204460144043
Epoch: 20, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.243 Vali Acc: 0.321 Test Loss: 3.243 Test Acc: 0.321
Validation loss decreased (-0.311733 --> -0.321144).  Saving model ...
Epoch: 21 cost time: 1.9366576671600342
Epoch: 21, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.222 Vali Acc: 0.325 Test Loss: 3.222 Test Acc: 0.325
Validation loss decreased (-0.321144 --> -0.324674).  Saving model ...
Epoch: 22 cost time: 1.7967896461486816
Epoch: 22, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.290 Vali Acc: 0.327 Test Loss: 3.290 Test Acc: 0.327
Validation loss decreased (-0.324674 --> -0.327026).  Saving model ...
Epoch: 23 cost time: 1.7646880149841309
Epoch: 23, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.243 Vali Acc: 0.351 Test Loss: 3.243 Test Acc: 0.351
Validation loss decreased (-0.327026 --> -0.350556).  Saving model ...
Epoch: 24 cost time: 1.8670868873596191
Epoch: 24, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.255 Vali Acc: 0.346 Test Loss: 3.255 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.7503952980041504
Epoch: 25, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.307 Vali Acc: 0.331 Test Loss: 3.307 Test Acc: 0.331
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.9521617889404297
Epoch: 26, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.352 Vali Acc: 0.320 Test Loss: 3.352 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.6885509490966797
Epoch: 27, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.309 Vali Acc: 0.342 Test Loss: 3.309 Test Acc: 0.342
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.7812857627868652
Epoch: 28, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.315 Vali Acc: 0.347 Test Loss: 3.315 Test Acc: 0.347
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.341651201248169
Epoch: 29, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.365 Vali Acc: 0.347 Test Loss: 3.365 Test Acc: 0.347
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.7749154567718506
Epoch: 30, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.342 Vali Acc: 0.346 Test Loss: 3.342 Test Acc: 0.346
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.35058823529411764
model parameter : 2471418
model size : 10.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.5045223236083984
Epoch: 1, Steps: 10 | Train Loss: 3.315 Vali Loss: 3.287 Vali Acc: 0.041 Test Loss: 3.287 Test Acc: 0.041
Validation loss decreased (inf --> -0.041144).  Saving model ...
Epoch: 2 cost time: 1.0952732563018799
Epoch: 2, Steps: 10 | Train Loss: 3.159 Vali Loss: 3.283 Vali Acc: 0.071 Test Loss: 3.283 Test Acc: 0.071
Validation loss decreased (-0.041144 --> -0.070555).  Saving model ...
Epoch: 3 cost time: 1.3829376697540283
Epoch: 3, Steps: 10 | Train Loss: 2.987 Vali Loss: 3.303 Vali Acc: 0.087 Test Loss: 3.303 Test Acc: 0.087
Validation loss decreased (-0.070555 --> -0.087026).  Saving model ...
Epoch: 4 cost time: 1.5152561664581299
Epoch: 4, Steps: 10 | Train Loss: 2.791 Vali Loss: 3.276 Vali Acc: 0.101 Test Loss: 3.276 Test Acc: 0.101
Validation loss decreased (-0.087026 --> -0.101144).  Saving model ...
Epoch: 5 cost time: 0.9602746963500977
Epoch: 5, Steps: 10 | Train Loss: 2.577 Vali Loss: 3.216 Vali Acc: 0.140 Test Loss: 3.216 Test Acc: 0.140
Validation loss decreased (-0.101144 --> -0.139968).  Saving model ...
Epoch: 6 cost time: 1.4438591003417969
Epoch: 6, Steps: 10 | Train Loss: 2.320 Vali Loss: 3.178 Vali Acc: 0.149 Test Loss: 3.178 Test Acc: 0.149
Validation loss decreased (-0.139968 --> -0.149380).  Saving model ...
Epoch: 7 cost time: 1.4320600032806396
Epoch: 7, Steps: 10 | Train Loss: 2.089 Vali Loss: 3.118 Vali Acc: 0.166 Test Loss: 3.118 Test Acc: 0.166
Validation loss decreased (-0.149380 --> -0.165851).  Saving model ...
Epoch: 8 cost time: 1.068504810333252
Epoch: 8, Steps: 10 | Train Loss: 1.825 Vali Loss: 3.070 Vali Acc: 0.184 Test Loss: 3.070 Test Acc: 0.184
Validation loss decreased (-0.165851 --> -0.183499).  Saving model ...
Epoch: 9 cost time: 1.3343536853790283
Epoch: 9, Steps: 10 | Train Loss: 1.543 Vali Loss: 3.050 Vali Acc: 0.193 Test Loss: 3.050 Test Acc: 0.193
Validation loss decreased (-0.183499 --> -0.192911).  Saving model ...
Epoch: 10 cost time: 1.319821834564209
Epoch: 10, Steps: 10 | Train Loss: 1.282 Vali Loss: 3.043 Vali Acc: 0.202 Test Loss: 3.043 Test Acc: 0.202
Validation loss decreased (-0.192911 --> -0.202323).  Saving model ...
Epoch: 11 cost time: 1.2054383754730225
Epoch: 11, Steps: 10 | Train Loss: 1.072 Vali Loss: 3.049 Vali Acc: 0.227 Test Loss: 3.049 Test Acc: 0.227
Validation loss decreased (-0.202323 --> -0.227028).  Saving model ...
Epoch: 12 cost time: 1.2873339653015137
Epoch: 12, Steps: 10 | Train Loss: 0.778 Vali Loss: 3.028 Vali Acc: 0.249 Test Loss: 3.028 Test Acc: 0.249
Validation loss decreased (-0.227028 --> -0.249381).  Saving model ...
Epoch: 13 cost time: 1.3616700172424316
Epoch: 13, Steps: 10 | Train Loss: 0.571 Vali Loss: 3.058 Vali Acc: 0.253 Test Loss: 3.058 Test Acc: 0.253
Validation loss decreased (-0.249381 --> -0.252911).  Saving model ...
Epoch: 14 cost time: 1.4871399402618408
Epoch: 14, Steps: 10 | Train Loss: 0.474 Vali Loss: 3.083 Vali Acc: 0.272 Test Loss: 3.083 Test Acc: 0.272
Validation loss decreased (-0.252911 --> -0.271734).  Saving model ...
Epoch: 15 cost time: 1.390977144241333
Epoch: 15, Steps: 10 | Train Loss: 0.338 Vali Loss: 3.104 Vali Acc: 0.287 Test Loss: 3.104 Test Acc: 0.287
Validation loss decreased (-0.271734 --> -0.287028).  Saving model ...
Epoch: 16 cost time: 1.4625155925750732
Epoch: 16, Steps: 10 | Train Loss: 0.254 Vali Loss: 3.123 Vali Acc: 0.282 Test Loss: 3.123 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5410196781158447
Epoch: 17, Steps: 10 | Train Loss: 0.184 Vali Loss: 3.200 Vali Acc: 0.291 Test Loss: 3.200 Test Acc: 0.291
Validation loss decreased (-0.287028 --> -0.290556).  Saving model ...
Epoch: 18 cost time: 1.582606315612793
Epoch: 18, Steps: 10 | Train Loss: 0.211 Vali Loss: 3.304 Vali Acc: 0.296 Test Loss: 3.304 Test Acc: 0.296
Validation loss decreased (-0.290556 --> -0.296438).  Saving model ...
Epoch: 19 cost time: 1.3325800895690918
Epoch: 19, Steps: 10 | Train Loss: 0.119 Vali Loss: 3.278 Vali Acc: 0.296 Test Loss: 3.278 Test Acc: 0.296
Validation loss decreased (-0.296438 --> -0.296438).  Saving model ...
Epoch: 20 cost time: 1.5402302742004395
Epoch: 20, Steps: 10 | Train Loss: 0.067 Vali Loss: 3.289 Vali Acc: 0.302 Test Loss: 3.289 Test Acc: 0.302
Validation loss decreased (-0.296438 --> -0.302320).  Saving model ...
Epoch: 21 cost time: 1.5291647911071777
Epoch: 21, Steps: 10 | Train Loss: 0.101 Vali Loss: 3.311 Vali Acc: 0.292 Test Loss: 3.311 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3976836204528809
Epoch: 22, Steps: 10 | Train Loss: 0.064 Vali Loss: 3.332 Vali Acc: 0.308 Test Loss: 3.332 Test Acc: 0.308
Validation loss decreased (-0.302320 --> -0.308202).  Saving model ...
Epoch: 23 cost time: 1.2281277179718018
Epoch: 23, Steps: 10 | Train Loss: 0.076 Vali Loss: 3.322 Vali Acc: 0.309 Test Loss: 3.322 Test Acc: 0.309
Validation loss decreased (-0.308202 --> -0.309379).  Saving model ...
Epoch: 24 cost time: 1.3213105201721191
Epoch: 24, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.366 Vali Acc: 0.313 Test Loss: 3.366 Test Acc: 0.313
Validation loss decreased (-0.309379 --> -0.312908).  Saving model ...
Epoch: 25 cost time: 1.381394624710083
Epoch: 25, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.428 Vali Acc: 0.312 Test Loss: 3.428 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3706762790679932
Epoch: 26, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.491 Vali Acc: 0.322 Test Loss: 3.491 Test Acc: 0.322
Validation loss decreased (-0.312908 --> -0.322318).  Saving model ...
Epoch: 27 cost time: 1.4438707828521729
Epoch: 27, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.456 Vali Acc: 0.305 Test Loss: 3.456 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3903188705444336
Epoch: 28, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.503 Vali Acc: 0.302 Test Loss: 3.503 Test Acc: 0.302
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.5494048595428467
Epoch: 29, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.542 Vali Acc: 0.307 Test Loss: 3.542 Test Acc: 0.307
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.514709234237671
Epoch: 30, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.478 Vali Acc: 0.320 Test Loss: 3.478 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.32235294117647056
model parameter : 816122
model size : 3.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.12227988243103
Epoch: 1, Steps: 10 | Train Loss: 3.259 Vali Loss: 3.281 Vali Acc: 0.035 Test Loss: 3.281 Test Acc: 0.035
Validation loss decreased (inf --> -0.035261).  Saving model ...
Epoch: 2 cost time: 3.086533784866333
Epoch: 2, Steps: 10 | Train Loss: 3.154 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.035261 --> -0.050556).  Saving model ...
Epoch: 3 cost time: 2.9026856422424316
Epoch: 3, Steps: 10 | Train Loss: 3.041 Vali Loss: 3.245 Vali Acc: 0.092 Test Loss: 3.245 Test Acc: 0.092
Validation loss decreased (-0.050556 --> -0.091732).  Saving model ...
Epoch: 4 cost time: 3.2257726192474365
Epoch: 4, Steps: 10 | Train Loss: 2.834 Vali Loss: 3.214 Vali Acc: 0.100 Test Loss: 3.214 Test Acc: 0.100
Validation loss decreased (-0.091732 --> -0.099968).  Saving model ...
Epoch: 5 cost time: 3.7082571983337402
Epoch: 5, Steps: 10 | Train Loss: 2.653 Vali Loss: 3.176 Vali Acc: 0.121 Test Loss: 3.176 Test Acc: 0.121
Validation loss decreased (-0.099968 --> -0.121145).  Saving model ...
Epoch: 6 cost time: 3.566179037094116
Epoch: 6, Steps: 10 | Train Loss: 2.400 Vali Loss: 3.118 Vali Acc: 0.146 Test Loss: 3.118 Test Acc: 0.146
Validation loss decreased (-0.121145 --> -0.145851).  Saving model ...
Epoch: 7 cost time: 2.281806468963623
Epoch: 7, Steps: 10 | Train Loss: 2.199 Vali Loss: 3.087 Vali Acc: 0.168 Test Loss: 3.087 Test Acc: 0.168
Validation loss decreased (-0.145851 --> -0.168204).  Saving model ...
Epoch: 8 cost time: 3.0571367740631104
Epoch: 8, Steps: 10 | Train Loss: 1.956 Vali Loss: 3.021 Vali Acc: 0.193 Test Loss: 3.021 Test Acc: 0.193
Validation loss decreased (-0.168204 --> -0.192911).  Saving model ...
Epoch: 9 cost time: 3.3185324668884277
Epoch: 9, Steps: 10 | Train Loss: 1.668 Vali Loss: 2.950 Vali Acc: 0.206 Test Loss: 2.950 Test Acc: 0.206
Validation loss decreased (-0.192911 --> -0.205853).  Saving model ...
Epoch: 10 cost time: 2.2111117839813232
Epoch: 10, Steps: 10 | Train Loss: 1.405 Vali Loss: 2.947 Vali Acc: 0.218 Test Loss: 2.947 Test Acc: 0.218
Validation loss decreased (-0.205853 --> -0.217618).  Saving model ...
Epoch: 11 cost time: 3.1103320121765137
Epoch: 11, Steps: 10 | Train Loss: 1.213 Vali Loss: 2.895 Vali Acc: 0.228 Test Loss: 2.895 Test Acc: 0.228
Validation loss decreased (-0.217618 --> -0.228206).  Saving model ...
Epoch: 12 cost time: 2.5655455589294434
Epoch: 12, Steps: 10 | Train Loss: 0.978 Vali Loss: 2.933 Vali Acc: 0.241 Test Loss: 2.933 Test Acc: 0.241
Validation loss decreased (-0.228206 --> -0.241147).  Saving model ...
Epoch: 13 cost time: 3.4554736614227295
Epoch: 13, Steps: 10 | Train Loss: 0.839 Vali Loss: 2.870 Vali Acc: 0.265 Test Loss: 2.870 Test Acc: 0.265
Validation loss decreased (-0.241147 --> -0.264677).  Saving model ...
Epoch: 14 cost time: 2.79975962638855
Epoch: 14, Steps: 10 | Train Loss: 0.744 Vali Loss: 2.852 Vali Acc: 0.278 Test Loss: 2.852 Test Acc: 0.278
Validation loss decreased (-0.264677 --> -0.277619).  Saving model ...
Epoch: 15 cost time: 2.9583544731140137
Epoch: 15, Steps: 10 | Train Loss: 0.525 Vali Loss: 2.817 Vali Acc: 0.291 Test Loss: 2.817 Test Acc: 0.291
Validation loss decreased (-0.277619 --> -0.290560).  Saving model ...
Epoch: 16 cost time: 3.2482492923736572
Epoch: 16, Steps: 10 | Train Loss: 0.357 Vali Loss: 2.791 Vali Acc: 0.301 Test Loss: 2.791 Test Acc: 0.301
Validation loss decreased (-0.290560 --> -0.301149).  Saving model ...
Epoch: 17 cost time: 2.075047492980957
Epoch: 17, Steps: 10 | Train Loss: 0.269 Vali Loss: 2.839 Vali Acc: 0.298 Test Loss: 2.839 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.9472191333770752
Epoch: 18, Steps: 10 | Train Loss: 0.215 Vali Loss: 2.869 Vali Acc: 0.304 Test Loss: 2.869 Test Acc: 0.304
Validation loss decreased (-0.301149 --> -0.303501).  Saving model ...
Epoch: 19 cost time: 1.9496779441833496
Epoch: 19, Steps: 10 | Train Loss: 0.169 Vali Loss: 2.884 Vali Acc: 0.296 Test Loss: 2.884 Test Acc: 0.296
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.398332118988037
Epoch: 20, Steps: 10 | Train Loss: 0.141 Vali Loss: 2.872 Vali Acc: 0.306 Test Loss: 2.872 Test Acc: 0.306
Validation loss decreased (-0.303501 --> -0.305854).  Saving model ...
Epoch: 21 cost time: 3.0326082706451416
Epoch: 21, Steps: 10 | Train Loss: 0.095 Vali Loss: 2.919 Vali Acc: 0.307 Test Loss: 2.919 Test Acc: 0.307
Validation loss decreased (-0.305854 --> -0.307030).  Saving model ...
Epoch: 22 cost time: 2.729374647140503
Epoch: 22, Steps: 10 | Train Loss: 0.093 Vali Loss: 2.952 Vali Acc: 0.311 Test Loss: 2.952 Test Acc: 0.311
Validation loss decreased (-0.307030 --> -0.310559).  Saving model ...
Epoch: 23 cost time: 3.1484317779541016
Epoch: 23, Steps: 10 | Train Loss: 0.097 Vali Loss: 2.897 Vali Acc: 0.306 Test Loss: 2.897 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.968698263168335
Epoch: 24, Steps: 10 | Train Loss: 0.050 Vali Loss: 2.904 Vali Acc: 0.301 Test Loss: 2.904 Test Acc: 0.301
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.722616672515869
Epoch: 25, Steps: 10 | Train Loss: 0.049 Vali Loss: 2.903 Vali Acc: 0.315 Test Loss: 2.903 Test Acc: 0.315
Validation loss decreased (-0.310559 --> -0.315265).  Saving model ...
Epoch: 26 cost time: 3.082921266555786
Epoch: 26, Steps: 10 | Train Loss: 0.053 Vali Loss: 2.913 Vali Acc: 0.318 Test Loss: 2.913 Test Acc: 0.318
Validation loss decreased (-0.315265 --> -0.317618).  Saving model ...
Epoch: 27 cost time: 3.0429253578186035
Epoch: 27, Steps: 10 | Train Loss: 0.033 Vali Loss: 2.977 Vali Acc: 0.315 Test Loss: 2.977 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.462631940841675
Epoch: 28, Steps: 10 | Train Loss: 0.049 Vali Loss: 2.961 Vali Acc: 0.320 Test Loss: 2.961 Test Acc: 0.320
Validation loss decreased (-0.317618 --> -0.319970).  Saving model ...
Epoch: 29 cost time: 3.438434600830078
Epoch: 29, Steps: 10 | Train Loss: 0.032 Vali Loss: 2.966 Vali Acc: 0.319 Test Loss: 2.966 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.5041165351867676
Epoch: 30, Steps: 10 | Train Loss: 0.027 Vali Loss: 2.951 Vali Acc: 0.325 Test Loss: 2.951 Test Acc: 0.325
Validation loss decreased (-0.319970 --> -0.324676).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3247058823529412
model parameter : 2408330
model size : 9.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.012576580047607
Epoch: 1, Steps: 10 | Train Loss: 3.276 Vali Loss: 3.288 Vali Acc: 0.055 Test Loss: 3.288 Test Acc: 0.055
Validation loss decreased (inf --> -0.055261).  Saving model ...
Epoch: 2 cost time: 2.114027738571167
Epoch: 2, Steps: 10 | Train Loss: 3.190 Vali Loss: 3.267 Vali Acc: 0.064 Test Loss: 3.267 Test Acc: 0.064
Validation loss decreased (-0.055261 --> -0.063497).  Saving model ...
Epoch: 3 cost time: 1.9618921279907227
Epoch: 3, Steps: 10 | Train Loss: 3.068 Vali Loss: 3.262 Vali Acc: 0.075 Test Loss: 3.262 Test Acc: 0.075
Validation loss decreased (-0.063497 --> -0.075261).  Saving model ...
Epoch: 4 cost time: 1.7973847389221191
Epoch: 4, Steps: 10 | Train Loss: 2.927 Vali Loss: 3.255 Vali Acc: 0.085 Test Loss: 3.255 Test Acc: 0.085
Validation loss decreased (-0.075261 --> -0.084673).  Saving model ...
Epoch: 5 cost time: 1.8319754600524902
Epoch: 5, Steps: 10 | Train Loss: 2.730 Vali Loss: 3.235 Vali Acc: 0.111 Test Loss: 3.235 Test Acc: 0.111
Validation loss decreased (-0.084673 --> -0.110556).  Saving model ...
Epoch: 6 cost time: 2.2496492862701416
Epoch: 6, Steps: 10 | Train Loss: 2.606 Vali Loss: 3.209 Vali Acc: 0.127 Test Loss: 3.209 Test Acc: 0.127
Validation loss decreased (-0.110556 --> -0.127027).  Saving model ...
Epoch: 7 cost time: 2.258446455001831
Epoch: 7, Steps: 10 | Train Loss: 2.363 Vali Loss: 3.164 Vali Acc: 0.140 Test Loss: 3.164 Test Acc: 0.140
Validation loss decreased (-0.127027 --> -0.139968).  Saving model ...
Epoch: 8 cost time: 1.515794277191162
Epoch: 8, Steps: 10 | Train Loss: 2.104 Vali Loss: 3.114 Vali Acc: 0.167 Test Loss: 3.114 Test Acc: 0.167
Validation loss decreased (-0.139968 --> -0.167028).  Saving model ...
Epoch: 9 cost time: 2.1060144901275635
Epoch: 9, Steps: 10 | Train Loss: 1.900 Vali Loss: 3.067 Vali Acc: 0.175 Test Loss: 3.067 Test Acc: 0.175
Validation loss decreased (-0.167028 --> -0.175263).  Saving model ...
Epoch: 10 cost time: 1.8978331089019775
Epoch: 10, Steps: 10 | Train Loss: 1.627 Vali Loss: 3.041 Vali Acc: 0.192 Test Loss: 3.041 Test Acc: 0.192
Validation loss decreased (-0.175263 --> -0.191734).  Saving model ...
Epoch: 11 cost time: 1.730597734451294
Epoch: 11, Steps: 10 | Train Loss: 1.451 Vali Loss: 3.002 Vali Acc: 0.201 Test Loss: 3.002 Test Acc: 0.201
Validation loss decreased (-0.191734 --> -0.201146).  Saving model ...
Epoch: 12 cost time: 1.9451019763946533
Epoch: 12, Steps: 10 | Train Loss: 1.237 Vali Loss: 2.964 Vali Acc: 0.205 Test Loss: 2.964 Test Acc: 0.205
Validation loss decreased (-0.201146 --> -0.204676).  Saving model ...
Epoch: 13 cost time: 2.0783700942993164
Epoch: 13, Steps: 10 | Train Loss: 1.007 Vali Loss: 2.947 Vali Acc: 0.215 Test Loss: 2.947 Test Acc: 0.215
Validation loss decreased (-0.204676 --> -0.215265).  Saving model ...
Epoch: 14 cost time: 1.8753705024719238
Epoch: 14, Steps: 10 | Train Loss: 0.823 Vali Loss: 2.923 Vali Acc: 0.255 Test Loss: 2.923 Test Acc: 0.255
Validation loss decreased (-0.215265 --> -0.255265).  Saving model ...
Epoch: 15 cost time: 2.0043036937713623
Epoch: 15, Steps: 10 | Train Loss: 0.696 Vali Loss: 2.881 Vali Acc: 0.264 Test Loss: 2.881 Test Acc: 0.264
Validation loss decreased (-0.255265 --> -0.263501).  Saving model ...
Epoch: 16 cost time: 2.047196388244629
Epoch: 16, Steps: 10 | Train Loss: 0.518 Vali Loss: 2.908 Vali Acc: 0.272 Test Loss: 2.908 Test Acc: 0.272
Validation loss decreased (-0.263501 --> -0.271736).  Saving model ...
Epoch: 17 cost time: 1.9530446529388428
Epoch: 17, Steps: 10 | Train Loss: 0.417 Vali Loss: 2.932 Vali Acc: 0.274 Test Loss: 2.932 Test Acc: 0.274
Validation loss decreased (-0.271736 --> -0.274088).  Saving model ...
Epoch: 18 cost time: 1.8957836627960205
Epoch: 18, Steps: 10 | Train Loss: 0.291 Vali Loss: 2.917 Vali Acc: 0.285 Test Loss: 2.917 Test Acc: 0.285
Validation loss decreased (-0.274088 --> -0.284677).  Saving model ...
Epoch: 19 cost time: 2.1459195613861084
Epoch: 19, Steps: 10 | Train Loss: 0.262 Vali Loss: 2.974 Vali Acc: 0.291 Test Loss: 2.974 Test Acc: 0.291
Validation loss decreased (-0.284677 --> -0.290558).  Saving model ...
Epoch: 20 cost time: 1.2890031337738037
Epoch: 20, Steps: 10 | Train Loss: 0.208 Vali Loss: 2.941 Vali Acc: 0.288 Test Loss: 2.941 Test Acc: 0.288
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.0230391025543213
Epoch: 21, Steps: 10 | Train Loss: 0.139 Vali Loss: 2.952 Vali Acc: 0.299 Test Loss: 2.952 Test Acc: 0.299
Validation loss decreased (-0.290558 --> -0.298794).  Saving model ...
Epoch: 22 cost time: 2.0951902866363525
Epoch: 22, Steps: 10 | Train Loss: 0.156 Vali Loss: 2.993 Vali Acc: 0.284 Test Loss: 2.993 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.040881633758545
Epoch: 23, Steps: 10 | Train Loss: 0.140 Vali Loss: 2.993 Vali Acc: 0.292 Test Loss: 2.993 Test Acc: 0.292
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.2934463024139404
Epoch: 24, Steps: 10 | Train Loss: 0.113 Vali Loss: 2.996 Vali Acc: 0.298 Test Loss: 2.996 Test Acc: 0.298
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.291923999786377
Epoch: 25, Steps: 10 | Train Loss: 0.077 Vali Loss: 2.975 Vali Acc: 0.314 Test Loss: 2.975 Test Acc: 0.314
Validation loss decreased (-0.298794 --> -0.314088).  Saving model ...
Epoch: 26 cost time: 2.248979091644287
Epoch: 26, Steps: 10 | Train Loss: 0.084 Vali Loss: 2.980 Vali Acc: 0.319 Test Loss: 2.980 Test Acc: 0.319
Validation loss decreased (-0.314088 --> -0.318794).  Saving model ...
Epoch: 27 cost time: 2.1368191242218018
Epoch: 27, Steps: 10 | Train Loss: 0.070 Vali Loss: 3.006 Vali Acc: 0.313 Test Loss: 3.006 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.0890421867370605
Epoch: 28, Steps: 10 | Train Loss: 0.074 Vali Loss: 3.049 Vali Acc: 0.316 Test Loss: 3.049 Test Acc: 0.316
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.856581687927246
Epoch: 29, Steps: 10 | Train Loss: 0.092 Vali Loss: 2.929 Vali Acc: 0.324 Test Loss: 2.929 Test Acc: 0.324
Validation loss decreased (-0.318794 --> -0.323500).  Saving model ...
Epoch: 30 cost time: 2.1068339347839355
Epoch: 30, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.025 Vali Acc: 0.316 Test Loss: 3.025 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3235294117647059
model parameter : 752906
model size : 3.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.133296489715576
Epoch: 1, Steps: 10 | Train Loss: 3.265 Vali Loss: 3.279 Vali Acc: 0.035 Test Loss: 3.279 Test Acc: 0.035
Validation loss decreased (inf --> -0.035261).  Saving model ...
Epoch: 2 cost time: 2.7532036304473877
Epoch: 2, Steps: 10 | Train Loss: 3.163 Vali Loss: 3.263 Vali Acc: 0.048 Test Loss: 3.263 Test Acc: 0.048
Validation loss decreased (-0.035261 --> -0.048203).  Saving model ...
Epoch: 3 cost time: 2.8645272254943848
Epoch: 3, Steps: 10 | Train Loss: 3.064 Vali Loss: 3.259 Vali Acc: 0.081 Test Loss: 3.259 Test Acc: 0.081
Validation loss decreased (-0.048203 --> -0.081144).  Saving model ...
Epoch: 4 cost time: 1.8752985000610352
Epoch: 4, Steps: 10 | Train Loss: 2.865 Vali Loss: 3.239 Vali Acc: 0.084 Test Loss: 3.239 Test Acc: 0.084
Validation loss decreased (-0.081144 --> -0.083497).  Saving model ...
Epoch: 5 cost time: 2.16499662399292
Epoch: 5, Steps: 10 | Train Loss: 2.722 Vali Loss: 3.210 Vali Acc: 0.098 Test Loss: 3.210 Test Acc: 0.098
Validation loss decreased (-0.083497 --> -0.097615).  Saving model ...
Epoch: 6 cost time: 2.7672810554504395
Epoch: 6, Steps: 10 | Train Loss: 2.514 Vali Loss: 3.157 Vali Acc: 0.118 Test Loss: 3.157 Test Acc: 0.118
Validation loss decreased (-0.097615 --> -0.117615).  Saving model ...
Epoch: 7 cost time: 2.0573842525482178
Epoch: 7, Steps: 10 | Train Loss: 2.355 Vali Loss: 3.132 Vali Acc: 0.129 Test Loss: 3.132 Test Acc: 0.129
Validation loss decreased (-0.117615 --> -0.129380).  Saving model ...
Epoch: 8 cost time: 2.1330361366271973
Epoch: 8, Steps: 10 | Train Loss: 2.156 Vali Loss: 3.061 Vali Acc: 0.164 Test Loss: 3.061 Test Acc: 0.164
Validation loss decreased (-0.129380 --> -0.163499).  Saving model ...
Epoch: 9 cost time: 2.4737462997436523
Epoch: 9, Steps: 10 | Train Loss: 1.909 Vali Loss: 3.036 Vali Acc: 0.188 Test Loss: 3.036 Test Acc: 0.188
Validation loss decreased (-0.163499 --> -0.188205).  Saving model ...
Epoch: 10 cost time: 1.88102388381958
Epoch: 10, Steps: 10 | Train Loss: 1.715 Vali Loss: 3.038 Vali Acc: 0.196 Test Loss: 3.038 Test Acc: 0.196
Validation loss decreased (-0.188205 --> -0.196440).  Saving model ...
Epoch: 11 cost time: 2.0861175060272217
Epoch: 11, Steps: 10 | Train Loss: 1.627 Vali Loss: 2.990 Vali Acc: 0.226 Test Loss: 2.990 Test Acc: 0.226
Validation loss decreased (-0.196440 --> -0.225852).  Saving model ...
Epoch: 12 cost time: 2.505016803741455
Epoch: 12, Steps: 10 | Train Loss: 1.237 Vali Loss: 2.951 Vali Acc: 0.240 Test Loss: 2.951 Test Acc: 0.240
Validation loss decreased (-0.225852 --> -0.239970).  Saving model ...
Epoch: 13 cost time: 1.6373481750488281
Epoch: 13, Steps: 10 | Train Loss: 1.136 Vali Loss: 2.913 Vali Acc: 0.260 Test Loss: 2.913 Test Acc: 0.260
Validation loss decreased (-0.239970 --> -0.259971).  Saving model ...
Epoch: 14 cost time: 1.6325523853302002
Epoch: 14, Steps: 10 | Train Loss: 0.817 Vali Loss: 2.878 Vali Acc: 0.266 Test Loss: 2.878 Test Acc: 0.266
Validation loss decreased (-0.259971 --> -0.265854).  Saving model ...
Epoch: 15 cost time: 2.5499229431152344
Epoch: 15, Steps: 10 | Train Loss: 0.648 Vali Loss: 2.877 Vali Acc: 0.301 Test Loss: 2.877 Test Acc: 0.301
Validation loss decreased (-0.265854 --> -0.301148).  Saving model ...
Epoch: 16 cost time: 1.8594903945922852
Epoch: 16, Steps: 10 | Train Loss: 0.535 Vali Loss: 2.910 Vali Acc: 0.278 Test Loss: 2.910 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.1788363456726074
Epoch: 17, Steps: 10 | Train Loss: 0.457 Vali Loss: 2.822 Vali Acc: 0.308 Test Loss: 2.822 Test Acc: 0.308
Validation loss decreased (-0.301148 --> -0.308207).  Saving model ...
Epoch: 18 cost time: 1.7875196933746338
Epoch: 18, Steps: 10 | Train Loss: 0.316 Vali Loss: 2.851 Vali Acc: 0.304 Test Loss: 2.851 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.276505708694458
Epoch: 19, Steps: 10 | Train Loss: 0.225 Vali Loss: 2.803 Vali Acc: 0.324 Test Loss: 2.803 Test Acc: 0.324
Validation loss decreased (-0.308207 --> -0.323501).  Saving model ...
Epoch: 20 cost time: 2.1780452728271484
Epoch: 20, Steps: 10 | Train Loss: 0.243 Vali Loss: 2.825 Vali Acc: 0.327 Test Loss: 2.825 Test Acc: 0.327
Validation loss decreased (-0.323501 --> -0.327031).  Saving model ...
Epoch: 21 cost time: 2.512904167175293
Epoch: 21, Steps: 10 | Train Loss: 0.146 Vali Loss: 2.848 Vali Acc: 0.322 Test Loss: 2.848 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.0973870754241943
Epoch: 22, Steps: 10 | Train Loss: 0.123 Vali Loss: 2.850 Vali Acc: 0.320 Test Loss: 2.850 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.465921640396118
Epoch: 23, Steps: 10 | Train Loss: 0.115 Vali Loss: 2.946 Vali Acc: 0.322 Test Loss: 2.946 Test Acc: 0.322
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.4057230949401855
Epoch: 24, Steps: 10 | Train Loss: 0.083 Vali Loss: 2.895 Vali Acc: 0.340 Test Loss: 2.895 Test Acc: 0.340
Validation loss decreased (-0.327031 --> -0.339971).  Saving model ...
Epoch: 25 cost time: 1.7839982509613037
Epoch: 25, Steps: 10 | Train Loss: 0.066 Vali Loss: 2.903 Vali Acc: 0.358 Test Loss: 2.903 Test Acc: 0.358
Validation loss decreased (-0.339971 --> -0.357618).  Saving model ...
Epoch: 26 cost time: 2.308213472366333
Epoch: 26, Steps: 10 | Train Loss: 0.073 Vali Loss: 2.920 Vali Acc: 0.347 Test Loss: 2.920 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.926206111907959
Epoch: 27, Steps: 10 | Train Loss: 0.042 Vali Loss: 2.882 Vali Acc: 0.349 Test Loss: 2.882 Test Acc: 0.349
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.514723777770996
Epoch: 28, Steps: 10 | Train Loss: 0.056 Vali Loss: 2.915 Vali Acc: 0.349 Test Loss: 2.915 Test Acc: 0.349
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.7130801677703857
Epoch: 29, Steps: 10 | Train Loss: 0.034 Vali Loss: 2.887 Vali Acc: 0.353 Test Loss: 2.887 Test Acc: 0.353
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.2677736282348633
Epoch: 30, Steps: 10 | Train Loss: 0.034 Vali Loss: 2.899 Vali Acc: 0.351 Test Loss: 2.899 Test Acc: 0.351
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.35764705882352943
model parameter : 2408330
model size : 9.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.9830877780914307
Epoch: 1, Steps: 10 | Train Loss: 3.289 Vali Loss: 3.288 Vali Acc: 0.054 Test Loss: 3.288 Test Acc: 0.054
Validation loss decreased (inf --> -0.054085).  Saving model ...
Epoch: 2 cost time: 1.686220645904541
Epoch: 2, Steps: 10 | Train Loss: 3.192 Vali Loss: 3.269 Vali Acc: 0.062 Test Loss: 3.269 Test Acc: 0.062
Validation loss decreased (-0.054085 --> -0.062320).  Saving model ...
Epoch: 3 cost time: 1.3354692459106445
Epoch: 3, Steps: 10 | Train Loss: 3.081 Vali Loss: 3.268 Vali Acc: 0.071 Test Loss: 3.268 Test Acc: 0.071
Validation loss decreased (-0.062320 --> -0.070556).  Saving model ...
Epoch: 4 cost time: 1.776829481124878
Epoch: 4, Steps: 10 | Train Loss: 2.956 Vali Loss: 3.266 Vali Acc: 0.076 Test Loss: 3.266 Test Acc: 0.076
Validation loss decreased (-0.070556 --> -0.076438).  Saving model ...
Epoch: 5 cost time: 1.1893832683563232
Epoch: 5, Steps: 10 | Train Loss: 2.790 Vali Loss: 3.249 Vali Acc: 0.094 Test Loss: 3.249 Test Acc: 0.094
Validation loss decreased (-0.076438 --> -0.094085).  Saving model ...
Epoch: 6 cost time: 1.0567352771759033
Epoch: 6, Steps: 10 | Train Loss: 2.658 Vali Loss: 3.234 Vali Acc: 0.105 Test Loss: 3.234 Test Acc: 0.105
Validation loss decreased (-0.094085 --> -0.104674).  Saving model ...
Epoch: 7 cost time: 1.9961426258087158
Epoch: 7, Steps: 10 | Train Loss: 2.449 Vali Loss: 3.195 Vali Acc: 0.122 Test Loss: 3.195 Test Acc: 0.122
Validation loss decreased (-0.104674 --> -0.122321).  Saving model ...
Epoch: 8 cost time: 1.5982944965362549
Epoch: 8, Steps: 10 | Train Loss: 2.252 Vali Loss: 3.141 Vali Acc: 0.159 Test Loss: 3.141 Test Acc: 0.159
Validation loss decreased (-0.122321 --> -0.158792).  Saving model ...
Epoch: 9 cost time: 2.0789949893951416
Epoch: 9, Steps: 10 | Train Loss: 2.088 Vali Loss: 3.096 Vali Acc: 0.172 Test Loss: 3.096 Test Acc: 0.172
Validation loss decreased (-0.158792 --> -0.171734).  Saving model ...
Epoch: 10 cost time: 2.044389009475708
Epoch: 10, Steps: 10 | Train Loss: 1.809 Vali Loss: 3.045 Vali Acc: 0.182 Test Loss: 3.045 Test Acc: 0.182
Validation loss decreased (-0.171734 --> -0.182322).  Saving model ...
Epoch: 11 cost time: 1.6766083240509033
Epoch: 11, Steps: 10 | Train Loss: 1.666 Vali Loss: 3.008 Vali Acc: 0.202 Test Loss: 3.008 Test Acc: 0.202
Validation loss decreased (-0.182322 --> -0.202323).  Saving model ...
Epoch: 12 cost time: 1.947962999343872
Epoch: 12, Steps: 10 | Train Loss: 1.486 Vali Loss: 3.008 Vali Acc: 0.205 Test Loss: 3.008 Test Acc: 0.205
Validation loss decreased (-0.202323 --> -0.204676).  Saving model ...
Epoch: 13 cost time: 1.722287654876709
Epoch: 13, Steps: 10 | Train Loss: 1.302 Vali Loss: 2.938 Vali Acc: 0.228 Test Loss: 2.938 Test Acc: 0.228
Validation loss decreased (-0.204676 --> -0.228206).  Saving model ...
Epoch: 14 cost time: 1.427231788635254
Epoch: 14, Steps: 10 | Train Loss: 1.052 Vali Loss: 2.952 Vali Acc: 0.231 Test Loss: 2.952 Test Acc: 0.231
Validation loss decreased (-0.228206 --> -0.230559).  Saving model ...
Epoch: 15 cost time: 1.7454800605773926
Epoch: 15, Steps: 10 | Train Loss: 0.974 Vali Loss: 2.918 Vali Acc: 0.256 Test Loss: 2.918 Test Acc: 0.256
Validation loss decreased (-0.230559 --> -0.256441).  Saving model ...
Epoch: 16 cost time: 1.768829584121704
Epoch: 16, Steps: 10 | Train Loss: 0.666 Vali Loss: 2.910 Vali Acc: 0.276 Test Loss: 2.910 Test Acc: 0.276
Validation loss decreased (-0.256441 --> -0.276441).  Saving model ...
Epoch: 17 cost time: 1.4989097118377686
Epoch: 17, Steps: 10 | Train Loss: 0.541 Vali Loss: 2.980 Vali Acc: 0.273 Test Loss: 2.980 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8720202445983887
Epoch: 18, Steps: 10 | Train Loss: 0.486 Vali Loss: 2.914 Vali Acc: 0.292 Test Loss: 2.914 Test Acc: 0.292
Validation loss decreased (-0.276441 --> -0.291736).  Saving model ...
Epoch: 19 cost time: 1.953857660293579
Epoch: 19, Steps: 10 | Train Loss: 0.406 Vali Loss: 2.933 Vali Acc: 0.314 Test Loss: 2.933 Test Acc: 0.314
Validation loss decreased (-0.291736 --> -0.314088).  Saving model ...
Epoch: 20 cost time: 1.6462962627410889
Epoch: 20, Steps: 10 | Train Loss: 0.334 Vali Loss: 2.919 Vali Acc: 0.293 Test Loss: 2.919 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.9265117645263672
Epoch: 21, Steps: 10 | Train Loss: 0.199 Vali Loss: 2.981 Vali Acc: 0.305 Test Loss: 2.981 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.9247767925262451
Epoch: 22, Steps: 10 | Train Loss: 0.270 Vali Loss: 2.924 Vali Acc: 0.308 Test Loss: 2.924 Test Acc: 0.308
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.664585828781128
Epoch: 23, Steps: 10 | Train Loss: 0.221 Vali Loss: 2.964 Vali Acc: 0.322 Test Loss: 2.964 Test Acc: 0.322
Validation loss decreased (-0.314088 --> -0.322323).  Saving model ...
Epoch: 24 cost time: 1.6409618854522705
Epoch: 24, Steps: 10 | Train Loss: 0.182 Vali Loss: 2.996 Vali Acc: 0.321 Test Loss: 2.996 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.7674245834350586
Epoch: 25, Steps: 10 | Train Loss: 0.107 Vali Loss: 2.935 Vali Acc: 0.331 Test Loss: 2.935 Test Acc: 0.331
Validation loss decreased (-0.322323 --> -0.330559).  Saving model ...
Epoch: 26 cost time: 1.7247071266174316
Epoch: 26, Steps: 10 | Train Loss: 0.099 Vali Loss: 3.035 Vali Acc: 0.326 Test Loss: 3.035 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.6652283668518066
Epoch: 27, Steps: 10 | Train Loss: 0.086 Vali Loss: 2.970 Vali Acc: 0.328 Test Loss: 2.970 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.9262781143188477
Epoch: 28, Steps: 10 | Train Loss: 0.091 Vali Loss: 3.003 Vali Acc: 0.335 Test Loss: 3.003 Test Acc: 0.335
Validation loss decreased (-0.330559 --> -0.335264).  Saving model ...
Epoch: 29 cost time: 1.9474565982818604
Epoch: 29, Steps: 10 | Train Loss: 0.117 Vali Loss: 3.021 Vali Acc: 0.333 Test Loss: 3.021 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.905165672302246
Epoch: 30, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.056 Vali Acc: 0.347 Test Loss: 3.056 Test Acc: 0.347
Validation loss decreased (-0.335264 --> -0.347028).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.34705882352941175
model parameter : 752906
model size : 3.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.588425874710083
Epoch: 1, Steps: 10 | Train Loss: 3.263 Vali Loss: 3.284 Vali Acc: 0.031 Test Loss: 3.284 Test Acc: 0.031
Validation loss decreased (inf --> -0.030555).  Saving model ...
Epoch: 2 cost time: 1.778285026550293
Epoch: 2, Steps: 10 | Train Loss: 3.167 Vali Loss: 3.272 Vali Acc: 0.041 Test Loss: 3.272 Test Acc: 0.041
Validation loss decreased (-0.030555 --> -0.041144).  Saving model ...
Epoch: 3 cost time: 1.659712314605713
Epoch: 3, Steps: 10 | Train Loss: 3.083 Vali Loss: 3.277 Vali Acc: 0.062 Test Loss: 3.277 Test Acc: 0.062
Validation loss decreased (-0.041144 --> -0.062320).  Saving model ...
Epoch: 4 cost time: 1.9346671104431152
Epoch: 4, Steps: 10 | Train Loss: 2.940 Vali Loss: 3.270 Vali Acc: 0.075 Test Loss: 3.270 Test Acc: 0.075
Validation loss decreased (-0.062320 --> -0.075261).  Saving model ...
Epoch: 5 cost time: 1.8767168521881104
Epoch: 5, Steps: 10 | Train Loss: 2.841 Vali Loss: 3.262 Vali Acc: 0.091 Test Loss: 3.262 Test Acc: 0.091
Validation loss decreased (-0.075261 --> -0.090556).  Saving model ...
Epoch: 6 cost time: 1.561985731124878
Epoch: 6, Steps: 10 | Train Loss: 2.669 Vali Loss: 3.232 Vali Acc: 0.112 Test Loss: 3.232 Test Acc: 0.112
Validation loss decreased (-0.090556 --> -0.111732).  Saving model ...
Epoch: 7 cost time: 1.3862664699554443
Epoch: 7, Steps: 10 | Train Loss: 2.540 Vali Loss: 3.206 Vali Acc: 0.121 Test Loss: 3.206 Test Acc: 0.121
Validation loss decreased (-0.111732 --> -0.121144).  Saving model ...
Epoch: 8 cost time: 2.105853319168091
Epoch: 8, Steps: 10 | Train Loss: 2.357 Vali Loss: 3.152 Vali Acc: 0.155 Test Loss: 3.152 Test Acc: 0.155
Validation loss decreased (-0.121144 --> -0.155263).  Saving model ...
Epoch: 9 cost time: 1.724973201751709
Epoch: 9, Steps: 10 | Train Loss: 2.181 Vali Loss: 3.127 Vali Acc: 0.164 Test Loss: 3.127 Test Acc: 0.164
Validation loss decreased (-0.155263 --> -0.163498).  Saving model ...
Epoch: 10 cost time: 1.775792121887207
Epoch: 10, Steps: 10 | Train Loss: 1.870 Vali Loss: 3.089 Vali Acc: 0.176 Test Loss: 3.089 Test Acc: 0.176
Validation loss decreased (-0.163498 --> -0.176440).  Saving model ...
Epoch: 11 cost time: 1.511152744293213
Epoch: 11, Steps: 10 | Train Loss: 1.689 Vali Loss: 3.022 Vali Acc: 0.192 Test Loss: 3.022 Test Acc: 0.192
Validation loss decreased (-0.176440 --> -0.191734).  Saving model ...
Epoch: 12 cost time: 1.7396659851074219
Epoch: 12, Steps: 10 | Train Loss: 1.439 Vali Loss: 3.016 Vali Acc: 0.201 Test Loss: 3.016 Test Acc: 0.201
Validation loss decreased (-0.191734 --> -0.201146).  Saving model ...
Epoch: 13 cost time: 1.1814906597137451
Epoch: 13, Steps: 10 | Train Loss: 1.177 Vali Loss: 2.963 Vali Acc: 0.232 Test Loss: 2.963 Test Acc: 0.232
Validation loss decreased (-0.201146 --> -0.231735).  Saving model ...
Epoch: 14 cost time: 1.694986343383789
Epoch: 14, Steps: 10 | Train Loss: 1.031 Vali Loss: 2.946 Vali Acc: 0.229 Test Loss: 2.946 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6026842594146729
Epoch: 15, Steps: 10 | Train Loss: 0.875 Vali Loss: 2.930 Vali Acc: 0.245 Test Loss: 2.930 Test Acc: 0.245
Validation loss decreased (-0.231735 --> -0.244677).  Saving model ...
Epoch: 16 cost time: 1.734464168548584
Epoch: 16, Steps: 10 | Train Loss: 0.824 Vali Loss: 2.965 Vali Acc: 0.258 Test Loss: 2.965 Test Acc: 0.258
Validation loss decreased (-0.244677 --> -0.257617).  Saving model ...
Epoch: 17 cost time: 1.589810848236084
Epoch: 17, Steps: 10 | Train Loss: 0.632 Vali Loss: 2.906 Vali Acc: 0.288 Test Loss: 2.906 Test Acc: 0.288
Validation loss decreased (-0.257617 --> -0.288206).  Saving model ...
Epoch: 18 cost time: 1.737083911895752
Epoch: 18, Steps: 10 | Train Loss: 0.497 Vali Loss: 2.918 Vali Acc: 0.278 Test Loss: 2.918 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.9083025455474854
Epoch: 19, Steps: 10 | Train Loss: 0.395 Vali Loss: 2.908 Vali Acc: 0.295 Test Loss: 2.908 Test Acc: 0.295
Validation loss decreased (-0.288206 --> -0.295265).  Saving model ...
Epoch: 20 cost time: 1.7796618938446045
Epoch: 20, Steps: 10 | Train Loss: 0.415 Vali Loss: 3.086 Vali Acc: 0.248 Test Loss: 3.086 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.347240686416626
Epoch: 21, Steps: 10 | Train Loss: 0.276 Vali Loss: 2.975 Vali Acc: 0.298 Test Loss: 2.975 Test Acc: 0.298
Validation loss decreased (-0.295265 --> -0.297617).  Saving model ...
Epoch: 22 cost time: 1.2766814231872559
Epoch: 22, Steps: 10 | Train Loss: 0.230 Vali Loss: 3.000 Vali Acc: 0.307 Test Loss: 3.000 Test Acc: 0.307
Validation loss decreased (-0.297617 --> -0.307029).  Saving model ...
Epoch: 23 cost time: 1.8987324237823486
Epoch: 23, Steps: 10 | Train Loss: 0.201 Vali Loss: 2.970 Vali Acc: 0.313 Test Loss: 2.970 Test Acc: 0.313
Validation loss decreased (-0.307029 --> -0.312911).  Saving model ...
Epoch: 24 cost time: 1.9074761867523193
Epoch: 24, Steps: 10 | Train Loss: 0.146 Vali Loss: 2.989 Vali Acc: 0.309 Test Loss: 2.989 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.8556346893310547
Epoch: 25, Steps: 10 | Train Loss: 0.115 Vali Loss: 2.978 Vali Acc: 0.327 Test Loss: 2.978 Test Acc: 0.327
Validation loss decreased (-0.312911 --> -0.327029).  Saving model ...
Epoch: 26 cost time: 1.619532823562622
Epoch: 26, Steps: 10 | Train Loss: 0.102 Vali Loss: 3.001 Vali Acc: 0.324 Test Loss: 3.001 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.123290777206421
Epoch: 27, Steps: 10 | Train Loss: 0.070 Vali Loss: 2.994 Vali Acc: 0.324 Test Loss: 2.994 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.3982577323913574
Epoch: 28, Steps: 10 | Train Loss: 0.071 Vali Loss: 3.029 Vali Acc: 0.322 Test Loss: 3.029 Test Acc: 0.322
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.9839320182800293
Epoch: 29, Steps: 10 | Train Loss: 0.075 Vali Loss: 3.014 Vali Acc: 0.324 Test Loss: 3.014 Test Acc: 0.324
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.0069050788879395
Epoch: 30, Steps: 10 | Train Loss: 0.060 Vali Loss: 3.009 Vali Acc: 0.331 Test Loss: 3.009 Test Acc: 0.331
Validation loss decreased (-0.327029 --> -0.330558).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3305882352941176
model parameter : 2408330
model size : 9.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.013308525085449
Epoch: 1, Steps: 10 | Train Loss: 3.295 Vali Loss: 3.282 Vali Acc: 0.058 Test Loss: 3.282 Test Acc: 0.058
Validation loss decreased (inf --> -0.057614).  Saving model ...
Epoch: 2 cost time: 1.5803232192993164
Epoch: 2, Steps: 10 | Train Loss: 3.220 Vali Loss: 3.268 Vali Acc: 0.056 Test Loss: 3.268 Test Acc: 0.056
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3249719142913818
Epoch: 3, Steps: 10 | Train Loss: 3.107 Vali Loss: 3.272 Vali Acc: 0.067 Test Loss: 3.272 Test Acc: 0.067
Validation loss decreased (-0.057614 --> -0.067026).  Saving model ...
Epoch: 4 cost time: 1.6154754161834717
Epoch: 4, Steps: 10 | Train Loss: 3.033 Vali Loss: 3.273 Vali Acc: 0.072 Test Loss: 3.273 Test Acc: 0.072
Validation loss decreased (-0.067026 --> -0.071732).  Saving model ...
Epoch: 5 cost time: 1.445770263671875
Epoch: 5, Steps: 10 | Train Loss: 2.859 Vali Loss: 3.265 Vali Acc: 0.093 Test Loss: 3.265 Test Acc: 0.093
Validation loss decreased (-0.071732 --> -0.092909).  Saving model ...
Epoch: 6 cost time: 1.4471793174743652
Epoch: 6, Steps: 10 | Train Loss: 2.788 Vali Loss: 3.256 Vali Acc: 0.091 Test Loss: 3.256 Test Acc: 0.091
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3847951889038086
Epoch: 7, Steps: 10 | Train Loss: 2.613 Vali Loss: 3.229 Vali Acc: 0.105 Test Loss: 3.229 Test Acc: 0.105
Validation loss decreased (-0.092909 --> -0.104674).  Saving model ...
Epoch: 8 cost time: 1.3495299816131592
Epoch: 8, Steps: 10 | Train Loss: 2.483 Vali Loss: 3.196 Vali Acc: 0.135 Test Loss: 3.196 Test Acc: 0.135
Validation loss decreased (-0.104674 --> -0.135262).  Saving model ...
Epoch: 9 cost time: 1.5072007179260254
Epoch: 9, Steps: 10 | Train Loss: 2.332 Vali Loss: 3.165 Vali Acc: 0.154 Test Loss: 3.165 Test Acc: 0.154
Validation loss decreased (-0.135262 --> -0.154086).  Saving model ...
Epoch: 10 cost time: 1.5829205513000488
Epoch: 10, Steps: 10 | Train Loss: 2.125 Vali Loss: 3.134 Vali Acc: 0.162 Test Loss: 3.134 Test Acc: 0.162
Validation loss decreased (-0.154086 --> -0.162322).  Saving model ...
Epoch: 11 cost time: 1.381692886352539
Epoch: 11, Steps: 10 | Train Loss: 1.953 Vali Loss: 3.107 Vali Acc: 0.178 Test Loss: 3.107 Test Acc: 0.178
Validation loss decreased (-0.162322 --> -0.177616).  Saving model ...
Epoch: 12 cost time: 1.0859272480010986
Epoch: 12, Steps: 10 | Train Loss: 1.733 Vali Loss: 3.097 Vali Acc: 0.185 Test Loss: 3.097 Test Acc: 0.185
Validation loss decreased (-0.177616 --> -0.184675).  Saving model ...
Epoch: 13 cost time: 1.3244898319244385
Epoch: 13, Steps: 10 | Train Loss: 1.514 Vali Loss: 3.076 Vali Acc: 0.200 Test Loss: 3.076 Test Acc: 0.200
Validation loss decreased (-0.184675 --> -0.199969).  Saving model ...
Epoch: 14 cost time: 1.3208355903625488
Epoch: 14, Steps: 10 | Train Loss: 1.365 Vali Loss: 3.036 Vali Acc: 0.214 Test Loss: 3.036 Test Acc: 0.214
Validation loss decreased (-0.199969 --> -0.214087).  Saving model ...
Epoch: 15 cost time: 1.555488109588623
Epoch: 15, Steps: 10 | Train Loss: 1.226 Vali Loss: 3.013 Vali Acc: 0.215 Test Loss: 3.013 Test Acc: 0.215
Validation loss decreased (-0.214087 --> -0.215264).  Saving model ...
Epoch: 16 cost time: 1.2366514205932617
Epoch: 16, Steps: 10 | Train Loss: 0.984 Vali Loss: 2.990 Vali Acc: 0.231 Test Loss: 2.990 Test Acc: 0.231
Validation loss decreased (-0.215264 --> -0.230558).  Saving model ...
Epoch: 17 cost time: 1.083533525466919
Epoch: 17, Steps: 10 | Train Loss: 0.842 Vali Loss: 3.017 Vali Acc: 0.241 Test Loss: 3.017 Test Acc: 0.241
Validation loss decreased (-0.230558 --> -0.241146).  Saving model ...
Epoch: 18 cost time: 1.362818717956543
Epoch: 18, Steps: 10 | Train Loss: 0.662 Vali Loss: 2.993 Vali Acc: 0.248 Test Loss: 2.993 Test Acc: 0.248
Validation loss decreased (-0.241146 --> -0.248205).  Saving model ...
Epoch: 19 cost time: 1.1131105422973633
Epoch: 19, Steps: 10 | Train Loss: 0.558 Vali Loss: 3.062 Vali Acc: 0.255 Test Loss: 3.062 Test Acc: 0.255
Validation loss decreased (-0.248205 --> -0.255264).  Saving model ...
Epoch: 20 cost time: 1.168940544128418
Epoch: 20, Steps: 10 | Train Loss: 0.513 Vali Loss: 3.006 Vali Acc: 0.274 Test Loss: 3.006 Test Acc: 0.274
Validation loss decreased (-0.255264 --> -0.274088).  Saving model ...
Epoch: 21 cost time: 1.5159502029418945
Epoch: 21, Steps: 10 | Train Loss: 0.374 Vali Loss: 3.006 Vali Acc: 0.284 Test Loss: 3.006 Test Acc: 0.284
Validation loss decreased (-0.274088 --> -0.283499).  Saving model ...
Epoch: 22 cost time: 1.2796039581298828
Epoch: 22, Steps: 10 | Train Loss: 0.304 Vali Loss: 3.008 Vali Acc: 0.298 Test Loss: 3.008 Test Acc: 0.298
Validation loss decreased (-0.283499 --> -0.297617).  Saving model ...
Epoch: 23 cost time: 1.348768711090088
Epoch: 23, Steps: 10 | Train Loss: 0.258 Vali Loss: 3.028 Vali Acc: 0.304 Test Loss: 3.028 Test Acc: 0.304
Validation loss decreased (-0.297617 --> -0.303499).  Saving model ...
Epoch: 24 cost time: 1.5061132907867432
Epoch: 24, Steps: 10 | Train Loss: 0.207 Vali Loss: 3.009 Vali Acc: 0.314 Test Loss: 3.009 Test Acc: 0.314
Validation loss decreased (-0.303499 --> -0.314088).  Saving model ...
Epoch: 25 cost time: 1.4686777591705322
Epoch: 25, Steps: 10 | Train Loss: 0.193 Vali Loss: 3.004 Vali Acc: 0.313 Test Loss: 3.004 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2757933139801025
Epoch: 26, Steps: 10 | Train Loss: 0.157 Vali Loss: 3.051 Vali Acc: 0.318 Test Loss: 3.051 Test Acc: 0.318
Validation loss decreased (-0.314088 --> -0.317617).  Saving model ...
Epoch: 27 cost time: 1.5224082469940186
Epoch: 27, Steps: 10 | Train Loss: 0.143 Vali Loss: 3.107 Vali Acc: 0.312 Test Loss: 3.107 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.280907154083252
Epoch: 28, Steps: 10 | Train Loss: 0.095 Vali Loss: 3.089 Vali Acc: 0.311 Test Loss: 3.089 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.1548774242401123
Epoch: 29, Steps: 10 | Train Loss: 0.086 Vali Loss: 3.097 Vali Acc: 0.319 Test Loss: 3.097 Test Acc: 0.319
Validation loss decreased (-0.317617 --> -0.318793).  Saving model ...
Epoch: 30 cost time: 1.3988738059997559
Epoch: 30, Steps: 10 | Train Loss: 0.079 Vali Loss: 3.130 Vali Acc: 0.322 Test Loss: 3.130 Test Acc: 0.322
Validation loss decreased (-0.318793 --> -0.322322).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.32235294117647056
model parameter : 752906
model size : 3.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.45189356803894
Epoch: 1, Steps: 10 | Train Loss: 3.264 Vali Loss: 3.275 Vali Acc: 0.047 Test Loss: 3.275 Test Acc: 0.047
Validation loss decreased (inf --> -0.047026).  Saving model ...
Epoch: 2 cost time: 2.4930837154388428
Epoch: 2, Steps: 10 | Train Loss: 3.146 Vali Loss: 3.255 Vali Acc: 0.053 Test Loss: 3.255 Test Acc: 0.053
Validation loss decreased (-0.047026 --> -0.052909).  Saving model ...
Epoch: 3 cost time: 2.9294633865356445
Epoch: 3, Steps: 10 | Train Loss: 3.030 Vali Loss: 3.252 Vali Acc: 0.074 Test Loss: 3.252 Test Acc: 0.074
Validation loss decreased (-0.052909 --> -0.074085).  Saving model ...
Epoch: 4 cost time: 2.1919093132019043
Epoch: 4, Steps: 10 | Train Loss: 2.902 Vali Loss: 3.238 Vali Acc: 0.100 Test Loss: 3.238 Test Acc: 0.100
Validation loss decreased (-0.074085 --> -0.099968).  Saving model ...
Epoch: 5 cost time: 2.6149485111236572
Epoch: 5, Steps: 10 | Train Loss: 2.721 Vali Loss: 3.209 Vali Acc: 0.102 Test Loss: 3.209 Test Acc: 0.102
Validation loss decreased (-0.099968 --> -0.102321).  Saving model ...
Epoch: 6 cost time: 2.6733031272888184
Epoch: 6, Steps: 10 | Train Loss: 2.496 Vali Loss: 3.153 Vali Acc: 0.133 Test Loss: 3.153 Test Acc: 0.133
Validation loss decreased (-0.102321 --> -0.132910).  Saving model ...
Epoch: 7 cost time: 2.028240203857422
Epoch: 7, Steps: 10 | Train Loss: 2.302 Vali Loss: 3.109 Vali Acc: 0.148 Test Loss: 3.109 Test Acc: 0.148
Validation loss decreased (-0.132910 --> -0.148204).  Saving model ...
Epoch: 8 cost time: 2.3023812770843506
Epoch: 8, Steps: 10 | Train Loss: 2.045 Vali Loss: 3.062 Vali Acc: 0.185 Test Loss: 3.062 Test Acc: 0.185
Validation loss decreased (-0.148204 --> -0.184675).  Saving model ...
Epoch: 9 cost time: 2.9921061992645264
Epoch: 9, Steps: 10 | Train Loss: 1.854 Vali Loss: 3.044 Vali Acc: 0.191 Test Loss: 3.044 Test Acc: 0.191
Validation loss decreased (-0.184675 --> -0.190558).  Saving model ...
Epoch: 10 cost time: 2.988611936569214
Epoch: 10, Steps: 10 | Train Loss: 1.590 Vali Loss: 3.002 Vali Acc: 0.208 Test Loss: 3.002 Test Acc: 0.208
Validation loss decreased (-0.190558 --> -0.208205).  Saving model ...
Epoch: 11 cost time: 2.776597023010254
Epoch: 11, Steps: 10 | Train Loss: 1.371 Vali Loss: 2.940 Vali Acc: 0.239 Test Loss: 2.940 Test Acc: 0.239
Validation loss decreased (-0.208205 --> -0.238794).  Saving model ...
Epoch: 12 cost time: 2.6446826457977295
Epoch: 12, Steps: 10 | Train Loss: 1.111 Vali Loss: 2.925 Vali Acc: 0.244 Test Loss: 2.925 Test Acc: 0.244
Validation loss decreased (-0.238794 --> -0.243500).  Saving model ...
Epoch: 13 cost time: 1.3758606910705566
Epoch: 13, Steps: 10 | Train Loss: 0.935 Vali Loss: 2.924 Vali Acc: 0.248 Test Loss: 2.924 Test Acc: 0.248
Validation loss decreased (-0.243500 --> -0.248206).  Saving model ...
Epoch: 14 cost time: 2.5021235942840576
Epoch: 14, Steps: 10 | Train Loss: 0.734 Vali Loss: 2.872 Vali Acc: 0.264 Test Loss: 2.872 Test Acc: 0.264
Validation loss decreased (-0.248206 --> -0.263501).  Saving model ...
Epoch: 15 cost time: 2.1412370204925537
Epoch: 15, Steps: 10 | Train Loss: 0.556 Vali Loss: 2.925 Vali Acc: 0.252 Test Loss: 2.925 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.2983038425445557
Epoch: 16, Steps: 10 | Train Loss: 0.461 Vali Loss: 2.917 Vali Acc: 0.276 Test Loss: 2.917 Test Acc: 0.276
Validation loss decreased (-0.263501 --> -0.276441).  Saving model ...
Epoch: 17 cost time: 2.252811908721924
Epoch: 17, Steps: 10 | Train Loss: 0.391 Vali Loss: 2.947 Vali Acc: 0.281 Test Loss: 2.947 Test Acc: 0.281
Validation loss decreased (-0.276441 --> -0.281147).  Saving model ...
Epoch: 18 cost time: 2.3295376300811768
Epoch: 18, Steps: 10 | Train Loss: 0.262 Vali Loss: 2.912 Vali Acc: 0.282 Test Loss: 2.912 Test Acc: 0.282
Validation loss decreased (-0.281147 --> -0.282324).  Saving model ...
Epoch: 19 cost time: 2.7174715995788574
Epoch: 19, Steps: 10 | Train Loss: 0.201 Vali Loss: 2.923 Vali Acc: 0.272 Test Loss: 2.923 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.7628538608551025
Epoch: 20, Steps: 10 | Train Loss: 0.181 Vali Loss: 2.929 Vali Acc: 0.295 Test Loss: 2.929 Test Acc: 0.295
Validation loss decreased (-0.282324 --> -0.295265).  Saving model ...
Epoch: 21 cost time: 2.4411449432373047
Epoch: 21, Steps: 10 | Train Loss: 0.154 Vali Loss: 2.916 Vali Acc: 0.301 Test Loss: 2.916 Test Acc: 0.301
Validation loss decreased (-0.295265 --> -0.301147).  Saving model ...
Epoch: 22 cost time: 2.5223758220672607
Epoch: 22, Steps: 10 | Train Loss: 0.116 Vali Loss: 2.927 Vali Acc: 0.298 Test Loss: 2.927 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.5753064155578613
Epoch: 23, Steps: 10 | Train Loss: 0.115 Vali Loss: 2.975 Vali Acc: 0.301 Test Loss: 2.975 Test Acc: 0.301
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.8824739456176758
Epoch: 24, Steps: 10 | Train Loss: 0.110 Vali Loss: 3.042 Vali Acc: 0.289 Test Loss: 3.042 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.0658650398254395
Epoch: 25, Steps: 10 | Train Loss: 0.079 Vali Loss: 2.983 Vali Acc: 0.324 Test Loss: 2.983 Test Acc: 0.324
Validation loss decreased (-0.301147 --> -0.323500).  Saving model ...
Epoch: 26 cost time: 2.7737998962402344
Epoch: 26, Steps: 10 | Train Loss: 0.058 Vali Loss: 3.003 Vali Acc: 0.309 Test Loss: 3.003 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.075521945953369
Epoch: 27, Steps: 10 | Train Loss: 0.052 Vali Loss: 2.980 Vali Acc: 0.316 Test Loss: 2.980 Test Acc: 0.316
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.9887733459472656
Epoch: 28, Steps: 10 | Train Loss: 0.052 Vali Loss: 2.993 Vali Acc: 0.321 Test Loss: 2.993 Test Acc: 0.321
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.6307713985443115
Epoch: 29, Steps: 10 | Train Loss: 0.067 Vali Loss: 3.036 Vali Acc: 0.315 Test Loss: 3.036 Test Acc: 0.315
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.6312172412872314
Epoch: 30, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.081 Vali Acc: 0.306 Test Loss: 3.081 Test Acc: 0.306
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3235294117647059
model parameter : 1236106
model size : 5.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.5985631942749023
Epoch: 1, Steps: 10 | Train Loss: 3.293 Vali Loss: 3.309 Vali Acc: 0.048 Test Loss: 3.309 Test Acc: 0.048
Validation loss decreased (inf --> -0.048202).  Saving model ...
Epoch: 2 cost time: 1.778709888458252
Epoch: 2, Steps: 10 | Train Loss: 3.208 Vali Loss: 3.289 Vali Acc: 0.052 Test Loss: 3.289 Test Acc: 0.052
Validation loss decreased (-0.048202 --> -0.051732).  Saving model ...
Epoch: 3 cost time: 2.211069107055664
Epoch: 3, Steps: 10 | Train Loss: 3.115 Vali Loss: 3.274 Vali Acc: 0.071 Test Loss: 3.274 Test Acc: 0.071
Validation loss decreased (-0.051732 --> -0.070555).  Saving model ...
Epoch: 4 cost time: 2.116821050643921
Epoch: 4, Steps: 10 | Train Loss: 2.993 Vali Loss: 3.267 Vali Acc: 0.076 Test Loss: 3.267 Test Acc: 0.076
Validation loss decreased (-0.070555 --> -0.076438).  Saving model ...
Epoch: 5 cost time: 2.181225061416626
Epoch: 5, Steps: 10 | Train Loss: 2.828 Vali Loss: 3.238 Vali Acc: 0.099 Test Loss: 3.238 Test Acc: 0.099
Validation loss decreased (-0.076438 --> -0.098791).  Saving model ...
Epoch: 6 cost time: 1.760366439819336
Epoch: 6, Steps: 10 | Train Loss: 2.668 Vali Loss: 3.198 Vali Acc: 0.127 Test Loss: 3.198 Test Acc: 0.127
Validation loss decreased (-0.098791 --> -0.127027).  Saving model ...
Epoch: 7 cost time: 1.922563076019287
Epoch: 7, Steps: 10 | Train Loss: 2.474 Vali Loss: 3.140 Vali Acc: 0.131 Test Loss: 3.140 Test Acc: 0.131
Validation loss decreased (-0.127027 --> -0.130557).  Saving model ...
Epoch: 8 cost time: 1.922957420349121
Epoch: 8, Steps: 10 | Train Loss: 2.241 Vali Loss: 3.088 Vali Acc: 0.153 Test Loss: 3.088 Test Acc: 0.153
Validation loss decreased (-0.130557 --> -0.152910).  Saving model ...
Epoch: 9 cost time: 1.9017980098724365
Epoch: 9, Steps: 10 | Train Loss: 2.068 Vali Loss: 3.060 Vali Acc: 0.158 Test Loss: 3.060 Test Acc: 0.158
Validation loss decreased (-0.152910 --> -0.157616).  Saving model ...
Epoch: 10 cost time: 1.4369137287139893
Epoch: 10, Steps: 10 | Train Loss: 1.828 Vali Loss: 3.011 Vali Acc: 0.195 Test Loss: 3.011 Test Acc: 0.195
Validation loss decreased (-0.157616 --> -0.195264).  Saving model ...
Epoch: 11 cost time: 1.771207332611084
Epoch: 11, Steps: 10 | Train Loss: 1.598 Vali Loss: 2.976 Vali Acc: 0.207 Test Loss: 2.976 Test Acc: 0.207
Validation loss decreased (-0.195264 --> -0.207029).  Saving model ...
Epoch: 12 cost time: 2.259411573410034
Epoch: 12, Steps: 10 | Train Loss: 1.405 Vali Loss: 2.948 Vali Acc: 0.220 Test Loss: 2.948 Test Acc: 0.220
Validation loss decreased (-0.207029 --> -0.219971).  Saving model ...
Epoch: 13 cost time: 2.1432418823242188
Epoch: 13, Steps: 10 | Train Loss: 1.134 Vali Loss: 2.955 Vali Acc: 0.221 Test Loss: 2.955 Test Acc: 0.221
Validation loss decreased (-0.219971 --> -0.221147).  Saving model ...
Epoch: 14 cost time: 2.111393928527832
Epoch: 14, Steps: 10 | Train Loss: 0.993 Vali Loss: 2.920 Vali Acc: 0.234 Test Loss: 2.920 Test Acc: 0.234
Validation loss decreased (-0.221147 --> -0.234088).  Saving model ...
Epoch: 15 cost time: 1.961949110031128
Epoch: 15, Steps: 10 | Train Loss: 0.860 Vali Loss: 2.957 Vali Acc: 0.231 Test Loss: 2.957 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9369449615478516
Epoch: 16, Steps: 10 | Train Loss: 0.712 Vali Loss: 2.900 Vali Acc: 0.249 Test Loss: 2.900 Test Acc: 0.249
Validation loss decreased (-0.234088 --> -0.249383).  Saving model ...
Epoch: 17 cost time: 1.3650879859924316
Epoch: 17, Steps: 10 | Train Loss: 0.606 Vali Loss: 2.905 Vali Acc: 0.272 Test Loss: 2.905 Test Acc: 0.272
Validation loss decreased (-0.249383 --> -0.271736).  Saving model ...
Epoch: 18 cost time: 1.3319308757781982
Epoch: 18, Steps: 10 | Train Loss: 0.435 Vali Loss: 2.917 Vali Acc: 0.278 Test Loss: 2.917 Test Acc: 0.278
Validation loss decreased (-0.271736 --> -0.277618).  Saving model ...
Epoch: 19 cost time: 1.978104829788208
Epoch: 19, Steps: 10 | Train Loss: 0.336 Vali Loss: 2.939 Vali Acc: 0.287 Test Loss: 2.939 Test Acc: 0.287
Validation loss decreased (-0.277618 --> -0.287029).  Saving model ...
Epoch: 20 cost time: 2.0103821754455566
Epoch: 20, Steps: 10 | Train Loss: 0.302 Vali Loss: 2.962 Vali Acc: 0.293 Test Loss: 2.962 Test Acc: 0.293
Validation loss decreased (-0.287029 --> -0.292912).  Saving model ...
Epoch: 21 cost time: 1.775641679763794
Epoch: 21, Steps: 10 | Train Loss: 0.217 Vali Loss: 2.968 Vali Acc: 0.293 Test Loss: 2.968 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.0783207416534424
Epoch: 22, Steps: 10 | Train Loss: 0.197 Vali Loss: 3.042 Vali Acc: 0.282 Test Loss: 3.042 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.6999266147613525
Epoch: 23, Steps: 10 | Train Loss: 0.201 Vali Loss: 3.066 Vali Acc: 0.285 Test Loss: 3.066 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.1609766483306885
Epoch: 24, Steps: 10 | Train Loss: 0.173 Vali Loss: 3.039 Vali Acc: 0.291 Test Loss: 3.039 Test Acc: 0.291
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.7367455959320068
Epoch: 25, Steps: 10 | Train Loss: 0.150 Vali Loss: 3.052 Vali Acc: 0.296 Test Loss: 3.052 Test Acc: 0.296
Validation loss decreased (-0.292912 --> -0.296440).  Saving model ...
Epoch: 26 cost time: 2.0636799335479736
Epoch: 26, Steps: 10 | Train Loss: 0.171 Vali Loss: 3.040 Vali Acc: 0.295 Test Loss: 3.040 Test Acc: 0.295
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.6639494895935059
Epoch: 27, Steps: 10 | Train Loss: 0.080 Vali Loss: 3.033 Vali Acc: 0.305 Test Loss: 3.033 Test Acc: 0.305
Validation loss decreased (-0.296440 --> -0.304676).  Saving model ...
Epoch: 28 cost time: 1.9109630584716797
Epoch: 28, Steps: 10 | Train Loss: 0.072 Vali Loss: 3.064 Vali Acc: 0.301 Test Loss: 3.064 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.0524535179138184
Epoch: 29, Steps: 10 | Train Loss: 0.069 Vali Loss: 3.130 Vali Acc: 0.302 Test Loss: 3.130 Test Acc: 0.302
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.9512698650360107
Epoch: 30, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.082 Vali Acc: 0.307 Test Loss: 3.082 Test Acc: 0.307
Validation loss decreased (-0.304676 --> -0.307028).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3070588235294118
model parameter : 408330
model size : 1.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.081976413726807
Epoch: 1, Steps: 10 | Train Loss: 3.271 Vali Loss: 3.276 Vali Acc: 0.048 Test Loss: 3.276 Test Acc: 0.048
Validation loss decreased (inf --> -0.048203).  Saving model ...
Epoch: 2 cost time: 2.0330734252929688
Epoch: 2, Steps: 10 | Train Loss: 3.157 Vali Loss: 3.259 Vali Acc: 0.049 Test Loss: 3.259 Test Acc: 0.049
Validation loss decreased (-0.048203 --> -0.049379).  Saving model ...
Epoch: 3 cost time: 1.8262364864349365
Epoch: 3, Steps: 10 | Train Loss: 3.052 Vali Loss: 3.259 Vali Acc: 0.067 Test Loss: 3.259 Test Acc: 0.067
Validation loss decreased (-0.049379 --> -0.067026).  Saving model ...
Epoch: 4 cost time: 2.0769882202148438
Epoch: 4, Steps: 10 | Train Loss: 2.939 Vali Loss: 3.249 Vali Acc: 0.089 Test Loss: 3.249 Test Acc: 0.089
Validation loss decreased (-0.067026 --> -0.089379).  Saving model ...
Epoch: 5 cost time: 1.7903163433074951
Epoch: 5, Steps: 10 | Train Loss: 2.775 Vali Loss: 3.226 Vali Acc: 0.094 Test Loss: 3.226 Test Acc: 0.094
Validation loss decreased (-0.089379 --> -0.094085).  Saving model ...
Epoch: 6 cost time: 2.0435192584991455
Epoch: 6, Steps: 10 | Train Loss: 2.579 Vali Loss: 3.178 Vali Acc: 0.124 Test Loss: 3.178 Test Acc: 0.124
Validation loss decreased (-0.094085 --> -0.123498).  Saving model ...
Epoch: 7 cost time: 1.6377511024475098
Epoch: 7, Steps: 10 | Train Loss: 2.422 Vali Loss: 3.138 Vali Acc: 0.144 Test Loss: 3.138 Test Acc: 0.144
Validation loss decreased (-0.123498 --> -0.143498).  Saving model ...
Epoch: 8 cost time: 1.737823724746704
Epoch: 8, Steps: 10 | Train Loss: 2.189 Vali Loss: 3.097 Vali Acc: 0.159 Test Loss: 3.097 Test Acc: 0.159
Validation loss decreased (-0.143498 --> -0.158793).  Saving model ...
Epoch: 9 cost time: 1.5333597660064697
Epoch: 9, Steps: 10 | Train Loss: 2.015 Vali Loss: 3.065 Vali Acc: 0.171 Test Loss: 3.065 Test Acc: 0.171
Validation loss decreased (-0.158793 --> -0.170558).  Saving model ...
Epoch: 10 cost time: 1.2902932167053223
Epoch: 10, Steps: 10 | Train Loss: 1.835 Vali Loss: 3.040 Vali Acc: 0.192 Test Loss: 3.040 Test Acc: 0.192
Validation loss decreased (-0.170558 --> -0.191734).  Saving model ...
Epoch: 11 cost time: 2.414505958557129
Epoch: 11, Steps: 10 | Train Loss: 1.564 Vali Loss: 2.994 Vali Acc: 0.212 Test Loss: 2.994 Test Acc: 0.212
Validation loss decreased (-0.191734 --> -0.211735).  Saving model ...
Epoch: 12 cost time: 2.3241193294525146
Epoch: 12, Steps: 10 | Train Loss: 1.330 Vali Loss: 2.959 Vali Acc: 0.228 Test Loss: 2.959 Test Acc: 0.228
Validation loss decreased (-0.211735 --> -0.228206).  Saving model ...
Epoch: 13 cost time: 1.9518818855285645
Epoch: 13, Steps: 10 | Train Loss: 1.169 Vali Loss: 2.938 Vali Acc: 0.244 Test Loss: 2.938 Test Acc: 0.244
Validation loss decreased (-0.228206 --> -0.243500).  Saving model ...
Epoch: 14 cost time: 2.390002727508545
Epoch: 14, Steps: 10 | Train Loss: 0.967 Vali Loss: 2.920 Vali Acc: 0.254 Test Loss: 2.920 Test Acc: 0.254
Validation loss decreased (-0.243500 --> -0.254088).  Saving model ...
Epoch: 15 cost time: 2.4448556900024414
Epoch: 15, Steps: 10 | Train Loss: 0.738 Vali Loss: 2.935 Vali Acc: 0.268 Test Loss: 2.935 Test Acc: 0.268
Validation loss decreased (-0.254088 --> -0.268206).  Saving model ...
Epoch: 16 cost time: 2.0336763858795166
Epoch: 16, Steps: 10 | Train Loss: 0.687 Vali Loss: 2.922 Vali Acc: 0.267 Test Loss: 2.922 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5720582008361816
Epoch: 17, Steps: 10 | Train Loss: 0.599 Vali Loss: 2.913 Vali Acc: 0.289 Test Loss: 2.913 Test Acc: 0.289
Validation loss decreased (-0.268206 --> -0.289383).  Saving model ...
Epoch: 18 cost time: 2.170175552368164
Epoch: 18, Steps: 10 | Train Loss: 0.356 Vali Loss: 2.915 Vali Acc: 0.302 Test Loss: 2.915 Test Acc: 0.302
Validation loss decreased (-0.289383 --> -0.302324).  Saving model ...
Epoch: 19 cost time: 1.568882942199707
Epoch: 19, Steps: 10 | Train Loss: 0.293 Vali Loss: 2.950 Vali Acc: 0.312 Test Loss: 2.950 Test Acc: 0.312
Validation loss decreased (-0.302324 --> -0.311735).  Saving model ...
Epoch: 20 cost time: 1.852555274963379
Epoch: 20, Steps: 10 | Train Loss: 0.328 Vali Loss: 2.943 Vali Acc: 0.315 Test Loss: 2.943 Test Acc: 0.315
Validation loss decreased (-0.311735 --> -0.315265).  Saving model ...
Epoch: 21 cost time: 1.9418389797210693
Epoch: 21, Steps: 10 | Train Loss: 0.233 Vali Loss: 2.975 Vali Acc: 0.311 Test Loss: 2.975 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5734550952911377
Epoch: 22, Steps: 10 | Train Loss: 0.205 Vali Loss: 2.965 Vali Acc: 0.311 Test Loss: 2.965 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.1622211933135986
Epoch: 23, Steps: 10 | Train Loss: 0.175 Vali Loss: 3.014 Vali Acc: 0.315 Test Loss: 3.014 Test Acc: 0.315
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.887000322341919
Epoch: 24, Steps: 10 | Train Loss: 0.148 Vali Loss: 3.002 Vali Acc: 0.316 Test Loss: 3.002 Test Acc: 0.316
Validation loss decreased (-0.315265 --> -0.316441).  Saving model ...
Epoch: 25 cost time: 1.8614990711212158
Epoch: 25, Steps: 10 | Train Loss: 0.137 Vali Loss: 2.967 Vali Acc: 0.316 Test Loss: 2.967 Test Acc: 0.316
Validation loss decreased (-0.316441 --> -0.316441).  Saving model ...
Epoch: 26 cost time: 2.0945966243743896
Epoch: 26, Steps: 10 | Train Loss: 0.108 Vali Loss: 3.018 Vali Acc: 0.314 Test Loss: 3.018 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.092519521713257
Epoch: 27, Steps: 10 | Train Loss: 0.070 Vali Loss: 2.988 Vali Acc: 0.312 Test Loss: 2.988 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.8397560119628906
Epoch: 28, Steps: 10 | Train Loss: 0.081 Vali Loss: 3.034 Vali Acc: 0.315 Test Loss: 3.034 Test Acc: 0.315
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.0266735553741455
Epoch: 29, Steps: 10 | Train Loss: 0.070 Vali Loss: 3.063 Vali Acc: 0.315 Test Loss: 3.063 Test Acc: 0.315
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.6104278564453125
Epoch: 30, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.096 Vali Acc: 0.325 Test Loss: 3.096 Test Acc: 0.325
Validation loss decreased (-0.316441 --> -0.324675).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3247058823529412
model parameter : 1236106
model size : 5.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.587402582168579
Epoch: 1, Steps: 10 | Train Loss: 3.290 Vali Loss: 3.308 Vali Acc: 0.045 Test Loss: 3.308 Test Acc: 0.045
Validation loss decreased (inf --> -0.044673).  Saving model ...
Epoch: 2 cost time: 1.3861336708068848
Epoch: 2, Steps: 10 | Train Loss: 3.205 Vali Loss: 3.289 Vali Acc: 0.055 Test Loss: 3.289 Test Acc: 0.055
Validation loss decreased (-0.044673 --> -0.055261).  Saving model ...
Epoch: 3 cost time: 1.4024016857147217
Epoch: 3, Steps: 10 | Train Loss: 3.120 Vali Loss: 3.277 Vali Acc: 0.067 Test Loss: 3.277 Test Acc: 0.067
Validation loss decreased (-0.055261 --> -0.067026).  Saving model ...
Epoch: 4 cost time: 1.3890950679779053
Epoch: 4, Steps: 10 | Train Loss: 3.003 Vali Loss: 3.274 Vali Acc: 0.074 Test Loss: 3.274 Test Acc: 0.074
Validation loss decreased (-0.067026 --> -0.074085).  Saving model ...
Epoch: 5 cost time: 1.8865838050842285
Epoch: 5, Steps: 10 | Train Loss: 2.878 Vali Loss: 3.251 Vali Acc: 0.086 Test Loss: 3.251 Test Acc: 0.086
Validation loss decreased (-0.074085 --> -0.085850).  Saving model ...
Epoch: 6 cost time: 1.8986990451812744
Epoch: 6, Steps: 10 | Train Loss: 2.712 Vali Loss: 3.218 Vali Acc: 0.111 Test Loss: 3.218 Test Acc: 0.111
Validation loss decreased (-0.085850 --> -0.110556).  Saving model ...
Epoch: 7 cost time: 1.7883822917938232
Epoch: 7, Steps: 10 | Train Loss: 2.578 Vali Loss: 3.174 Vali Acc: 0.121 Test Loss: 3.174 Test Acc: 0.121
Validation loss decreased (-0.110556 --> -0.121145).  Saving model ...
Epoch: 8 cost time: 1.8382937908172607
Epoch: 8, Steps: 10 | Train Loss: 2.343 Vali Loss: 3.130 Vali Acc: 0.133 Test Loss: 3.130 Test Acc: 0.133
Validation loss decreased (-0.121145 --> -0.132910).  Saving model ...
Epoch: 9 cost time: 1.9092926979064941
Epoch: 9, Steps: 10 | Train Loss: 2.182 Vali Loss: 3.100 Vali Acc: 0.152 Test Loss: 3.100 Test Acc: 0.152
Validation loss decreased (-0.132910 --> -0.151734).  Saving model ...
Epoch: 10 cost time: 1.2490110397338867
Epoch: 10, Steps: 10 | Train Loss: 1.969 Vali Loss: 3.066 Vali Acc: 0.181 Test Loss: 3.066 Test Acc: 0.181
Validation loss decreased (-0.151734 --> -0.181146).  Saving model ...
Epoch: 11 cost time: 1.271252155303955
Epoch: 11, Steps: 10 | Train Loss: 1.777 Vali Loss: 3.031 Vali Acc: 0.192 Test Loss: 3.031 Test Acc: 0.192
Validation loss decreased (-0.181146 --> -0.191734).  Saving model ...
Epoch: 12 cost time: 1.648364782333374
Epoch: 12, Steps: 10 | Train Loss: 1.539 Vali Loss: 3.027 Vali Acc: 0.201 Test Loss: 3.027 Test Acc: 0.201
Validation loss decreased (-0.191734 --> -0.201146).  Saving model ...
Epoch: 13 cost time: 1.0513176918029785
Epoch: 13, Steps: 10 | Train Loss: 1.308 Vali Loss: 3.009 Vali Acc: 0.205 Test Loss: 3.009 Test Acc: 0.205
Validation loss decreased (-0.201146 --> -0.204676).  Saving model ...
Epoch: 14 cost time: 1.316727638244629
Epoch: 14, Steps: 10 | Train Loss: 1.255 Vali Loss: 2.999 Vali Acc: 0.225 Test Loss: 2.999 Test Acc: 0.225
Validation loss decreased (-0.204676 --> -0.224676).  Saving model ...
Epoch: 15 cost time: 1.4216830730438232
Epoch: 15, Steps: 10 | Train Loss: 0.981 Vali Loss: 2.973 Vali Acc: 0.232 Test Loss: 2.973 Test Acc: 0.232
Validation loss decreased (-0.224676 --> -0.231735).  Saving model ...
Epoch: 16 cost time: 1.299609899520874
Epoch: 16, Steps: 10 | Train Loss: 0.924 Vali Loss: 2.971 Vali Acc: 0.245 Test Loss: 2.971 Test Acc: 0.245
Validation loss decreased (-0.231735 --> -0.244676).  Saving model ...
Epoch: 17 cost time: 1.4104948043823242
Epoch: 17, Steps: 10 | Train Loss: 0.727 Vali Loss: 2.960 Vali Acc: 0.265 Test Loss: 2.960 Test Acc: 0.265
Validation loss decreased (-0.244676 --> -0.264676).  Saving model ...
Epoch: 18 cost time: 1.819817066192627
Epoch: 18, Steps: 10 | Train Loss: 0.639 Vali Loss: 2.956 Vali Acc: 0.265 Test Loss: 2.956 Test Acc: 0.265
Validation loss decreased (-0.264676 --> -0.264676).  Saving model ...
Epoch: 19 cost time: 1.678135871887207
Epoch: 19, Steps: 10 | Train Loss: 0.480 Vali Loss: 2.982 Vali Acc: 0.274 Test Loss: 2.982 Test Acc: 0.274
Validation loss decreased (-0.264676 --> -0.274088).  Saving model ...
Epoch: 20 cost time: 1.9648916721343994
Epoch: 20, Steps: 10 | Train Loss: 0.399 Vali Loss: 3.012 Vali Acc: 0.281 Test Loss: 3.012 Test Acc: 0.281
Validation loss decreased (-0.274088 --> -0.281146).  Saving model ...
Epoch: 21 cost time: 1.494365930557251
Epoch: 21, Steps: 10 | Train Loss: 0.339 Vali Loss: 3.022 Vali Acc: 0.280 Test Loss: 3.022 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.0482800006866455
Epoch: 22, Steps: 10 | Train Loss: 0.302 Vali Loss: 3.092 Vali Acc: 0.278 Test Loss: 3.092 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.702146053314209
Epoch: 23, Steps: 10 | Train Loss: 0.208 Vali Loss: 3.038 Vali Acc: 0.291 Test Loss: 3.038 Test Acc: 0.291
Validation loss decreased (-0.281146 --> -0.290558).  Saving model ...
Epoch: 24 cost time: 1.7813796997070312
Epoch: 24, Steps: 10 | Train Loss: 0.244 Vali Loss: 3.031 Vali Acc: 0.298 Test Loss: 3.031 Test Acc: 0.298
Validation loss decreased (-0.290558 --> -0.297617).  Saving model ...
Epoch: 25 cost time: 2.07822322845459
Epoch: 25, Steps: 10 | Train Loss: 0.198 Vali Loss: 3.040 Vali Acc: 0.305 Test Loss: 3.040 Test Acc: 0.305
Validation loss decreased (-0.297617 --> -0.304675).  Saving model ...
Epoch: 26 cost time: 1.9415767192840576
Epoch: 26, Steps: 10 | Train Loss: 0.151 Vali Loss: 3.047 Vali Acc: 0.301 Test Loss: 3.047 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.7105021476745605
Epoch: 27, Steps: 10 | Train Loss: 0.129 Vali Loss: 3.100 Vali Acc: 0.308 Test Loss: 3.100 Test Acc: 0.308
Validation loss decreased (-0.304675 --> -0.308204).  Saving model ...
Epoch: 28 cost time: 1.5389385223388672
Epoch: 28, Steps: 10 | Train Loss: 0.108 Vali Loss: 3.129 Vali Acc: 0.306 Test Loss: 3.129 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.6913821697235107
Epoch: 29, Steps: 10 | Train Loss: 0.082 Vali Loss: 3.176 Vali Acc: 0.302 Test Loss: 3.176 Test Acc: 0.302
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.0074758529663086
Epoch: 30, Steps: 10 | Train Loss: 0.095 Vali Loss: 3.100 Vali Acc: 0.314 Test Loss: 3.100 Test Acc: 0.314
Validation loss decreased (-0.308204 --> -0.314087).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.31411764705882356
model parameter : 408330
model size : 1.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.415354013442993
Epoch: 1, Steps: 10 | Train Loss: 3.276 Vali Loss: 3.273 Vali Acc: 0.049 Test Loss: 3.273 Test Acc: 0.049
Validation loss decreased (inf --> -0.049379).  Saving model ...
Epoch: 2 cost time: 1.786266803741455
Epoch: 2, Steps: 10 | Train Loss: 3.150 Vali Loss: 3.259 Vali Acc: 0.052 Test Loss: 3.259 Test Acc: 0.052
Validation loss decreased (-0.049379 --> -0.051732).  Saving model ...
Epoch: 3 cost time: 1.782944917678833
Epoch: 3, Steps: 10 | Train Loss: 3.086 Vali Loss: 3.260 Vali Acc: 0.069 Test Loss: 3.260 Test Acc: 0.069
Validation loss decreased (-0.051732 --> -0.069379).  Saving model ...
Epoch: 4 cost time: 1.7918400764465332
Epoch: 4, Steps: 10 | Train Loss: 3.000 Vali Loss: 3.256 Vali Acc: 0.093 Test Loss: 3.256 Test Acc: 0.093
Validation loss decreased (-0.069379 --> -0.092909).  Saving model ...
Epoch: 5 cost time: 1.5919344425201416
Epoch: 5, Steps: 10 | Train Loss: 2.845 Vali Loss: 3.239 Vali Acc: 0.107 Test Loss: 3.239 Test Acc: 0.107
Validation loss decreased (-0.092909 --> -0.107026).  Saving model ...
Epoch: 6 cost time: 1.9926633834838867
Epoch: 6, Steps: 10 | Train Loss: 2.686 Vali Loss: 3.195 Vali Acc: 0.125 Test Loss: 3.195 Test Acc: 0.125
Validation loss decreased (-0.107026 --> -0.124674).  Saving model ...
Epoch: 7 cost time: 1.525904893875122
Epoch: 7, Steps: 10 | Train Loss: 2.549 Vali Loss: 3.162 Vali Acc: 0.134 Test Loss: 3.162 Test Acc: 0.134
Validation loss decreased (-0.124674 --> -0.134086).  Saving model ...
Epoch: 8 cost time: 1.712350845336914
Epoch: 8, Steps: 10 | Train Loss: 2.362 Vali Loss: 3.118 Vali Acc: 0.147 Test Loss: 3.118 Test Acc: 0.147
Validation loss decreased (-0.134086 --> -0.147028).  Saving model ...
Epoch: 9 cost time: 1.2782824039459229
Epoch: 9, Steps: 10 | Train Loss: 2.170 Vali Loss: 3.101 Vali Acc: 0.161 Test Loss: 3.101 Test Acc: 0.161
Validation loss decreased (-0.147028 --> -0.161145).  Saving model ...
Epoch: 10 cost time: 1.2572150230407715
Epoch: 10, Steps: 10 | Train Loss: 1.962 Vali Loss: 3.064 Vali Acc: 0.174 Test Loss: 3.064 Test Acc: 0.174
Validation loss decreased (-0.161145 --> -0.174087).  Saving model ...
Epoch: 11 cost time: 1.3075034618377686
Epoch: 11, Steps: 10 | Train Loss: 1.804 Vali Loss: 3.052 Vali Acc: 0.184 Test Loss: 3.052 Test Acc: 0.184
Validation loss decreased (-0.174087 --> -0.183499).  Saving model ...
Epoch: 12 cost time: 1.5831830501556396
Epoch: 12, Steps: 10 | Train Loss: 1.550 Vali Loss: 3.026 Vali Acc: 0.202 Test Loss: 3.026 Test Acc: 0.202
Validation loss decreased (-0.183499 --> -0.202323).  Saving model ...
Epoch: 13 cost time: 1.599431037902832
Epoch: 13, Steps: 10 | Train Loss: 1.381 Vali Loss: 3.041 Vali Acc: 0.214 Test Loss: 3.041 Test Acc: 0.214
Validation loss decreased (-0.202323 --> -0.214087).  Saving model ...
Epoch: 14 cost time: 1.7592017650604248
Epoch: 14, Steps: 10 | Train Loss: 1.219 Vali Loss: 2.985 Vali Acc: 0.219 Test Loss: 2.985 Test Acc: 0.219
Validation loss decreased (-0.214087 --> -0.218794).  Saving model ...
Epoch: 15 cost time: 1.4900767803192139
Epoch: 15, Steps: 10 | Train Loss: 1.065 Vali Loss: 2.977 Vali Acc: 0.225 Test Loss: 2.977 Test Acc: 0.225
Validation loss decreased (-0.218794 --> -0.224676).  Saving model ...
Epoch: 16 cost time: 1.4866385459899902
Epoch: 16, Steps: 10 | Train Loss: 0.957 Vali Loss: 3.175 Vali Acc: 0.216 Test Loss: 3.175 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.742823839187622
Epoch: 17, Steps: 10 | Train Loss: 0.803 Vali Loss: 3.003 Vali Acc: 0.242 Test Loss: 3.003 Test Acc: 0.242
Validation loss decreased (-0.224676 --> -0.242323).  Saving model ...
Epoch: 18 cost time: 1.4170262813568115
Epoch: 18, Steps: 10 | Train Loss: 0.641 Vali Loss: 3.030 Vali Acc: 0.249 Test Loss: 3.030 Test Acc: 0.249
Validation loss decreased (-0.242323 --> -0.249381).  Saving model ...
Epoch: 19 cost time: 1.6501383781433105
Epoch: 19, Steps: 10 | Train Loss: 0.505 Vali Loss: 3.038 Vali Acc: 0.268 Test Loss: 3.038 Test Acc: 0.268
Validation loss decreased (-0.249381 --> -0.268205).  Saving model ...
Epoch: 20 cost time: 1.3451688289642334
Epoch: 20, Steps: 10 | Train Loss: 0.430 Vali Loss: 3.021 Vali Acc: 0.278 Test Loss: 3.021 Test Acc: 0.278
Validation loss decreased (-0.268205 --> -0.277617).  Saving model ...
Epoch: 21 cost time: 1.2646818161010742
Epoch: 21, Steps: 10 | Train Loss: 0.336 Vali Loss: 3.003 Vali Acc: 0.276 Test Loss: 3.003 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.6109554767608643
Epoch: 22, Steps: 10 | Train Loss: 0.281 Vali Loss: 3.079 Vali Acc: 0.286 Test Loss: 3.079 Test Acc: 0.286
Validation loss decreased (-0.277617 --> -0.285852).  Saving model ...
Epoch: 23 cost time: 1.7440483570098877
Epoch: 23, Steps: 10 | Train Loss: 0.218 Vali Loss: 3.036 Vali Acc: 0.305 Test Loss: 3.036 Test Acc: 0.305
Validation loss decreased (-0.285852 --> -0.304676).  Saving model ...
Epoch: 24 cost time: 1.6037204265594482
Epoch: 24, Steps: 10 | Train Loss: 0.228 Vali Loss: 3.038 Vali Acc: 0.306 Test Loss: 3.038 Test Acc: 0.306
Validation loss decreased (-0.304676 --> -0.305852).  Saving model ...
Epoch: 25 cost time: 1.4688222408294678
Epoch: 25, Steps: 10 | Train Loss: 0.155 Vali Loss: 3.080 Vali Acc: 0.311 Test Loss: 3.080 Test Acc: 0.311
Validation loss decreased (-0.305852 --> -0.310557).  Saving model ...
Epoch: 26 cost time: 1.2017176151275635
Epoch: 26, Steps: 10 | Train Loss: 0.129 Vali Loss: 3.054 Vali Acc: 0.319 Test Loss: 3.054 Test Acc: 0.319
Validation loss decreased (-0.310557 --> -0.318793).  Saving model ...
Epoch: 27 cost time: 1.4684631824493408
Epoch: 27, Steps: 10 | Train Loss: 0.107 Vali Loss: 3.091 Vali Acc: 0.312 Test Loss: 3.091 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.6316766738891602
Epoch: 28, Steps: 10 | Train Loss: 0.102 Vali Loss: 3.141 Vali Acc: 0.321 Test Loss: 3.141 Test Acc: 0.321
Validation loss decreased (-0.318793 --> -0.321145).  Saving model ...
Epoch: 29 cost time: 1.6213054656982422
Epoch: 29, Steps: 10 | Train Loss: 0.067 Vali Loss: 3.144 Vali Acc: 0.314 Test Loss: 3.144 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.6023039817810059
Epoch: 30, Steps: 10 | Train Loss: 0.088 Vali Loss: 3.154 Vali Acc: 0.312 Test Loss: 3.154 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3211764705882353
model parameter : 1236106
model size : 5.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.7962393760681152
Epoch: 1, Steps: 10 | Train Loss: 3.276 Vali Loss: 3.304 Vali Acc: 0.048 Test Loss: 3.304 Test Acc: 0.048
Validation loss decreased (inf --> -0.048202).  Saving model ...
Epoch: 2 cost time: 1.1828835010528564
Epoch: 2, Steps: 10 | Train Loss: 3.204 Vali Loss: 3.289 Vali Acc: 0.061 Test Loss: 3.289 Test Acc: 0.061
Validation loss decreased (-0.048202 --> -0.061144).  Saving model ...
Epoch: 3 cost time: 1.5001177787780762
Epoch: 3, Steps: 10 | Train Loss: 3.135 Vali Loss: 3.283 Vali Acc: 0.060 Test Loss: 3.283 Test Acc: 0.060
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5313055515289307
Epoch: 4, Steps: 10 | Train Loss: 3.025 Vali Loss: 3.287 Vali Acc: 0.066 Test Loss: 3.287 Test Acc: 0.066
Validation loss decreased (-0.061144 --> -0.065849).  Saving model ...
Epoch: 5 cost time: 1.059131383895874
Epoch: 5, Steps: 10 | Train Loss: 2.914 Vali Loss: 3.274 Vali Acc: 0.076 Test Loss: 3.274 Test Acc: 0.076
Validation loss decreased (-0.065849 --> -0.076438).  Saving model ...
Epoch: 6 cost time: 0.9227919578552246
Epoch: 6, Steps: 10 | Train Loss: 2.768 Vali Loss: 3.248 Vali Acc: 0.089 Test Loss: 3.248 Test Acc: 0.089
Validation loss decreased (-0.076438 --> -0.089379).  Saving model ...
Epoch: 7 cost time: 0.8929591178894043
Epoch: 7, Steps: 10 | Train Loss: 2.631 Vali Loss: 3.215 Vali Acc: 0.104 Test Loss: 3.215 Test Acc: 0.104
Validation loss decreased (-0.089379 --> -0.103497).  Saving model ...
Epoch: 8 cost time: 0.9798521995544434
Epoch: 8, Steps: 10 | Train Loss: 2.464 Vali Loss: 3.184 Vali Acc: 0.121 Test Loss: 3.184 Test Acc: 0.121
Validation loss decreased (-0.103497 --> -0.121145).  Saving model ...
Epoch: 9 cost time: 0.9180095195770264
Epoch: 9, Steps: 10 | Train Loss: 2.298 Vali Loss: 3.167 Vali Acc: 0.135 Test Loss: 3.167 Test Acc: 0.135
Validation loss decreased (-0.121145 --> -0.135262).  Saving model ...
Epoch: 10 cost time: 1.2843985557556152
Epoch: 10, Steps: 10 | Train Loss: 2.156 Vali Loss: 3.129 Vali Acc: 0.152 Test Loss: 3.129 Test Acc: 0.152
Validation loss decreased (-0.135262 --> -0.151733).  Saving model ...
Epoch: 11 cost time: 1.2893857955932617
Epoch: 11, Steps: 10 | Train Loss: 1.920 Vali Loss: 3.097 Vali Acc: 0.178 Test Loss: 3.097 Test Acc: 0.178
Validation loss decreased (-0.151733 --> -0.177616).  Saving model ...
Epoch: 12 cost time: 1.4312779903411865
Epoch: 12, Steps: 10 | Train Loss: 1.718 Vali Loss: 3.100 Vali Acc: 0.176 Test Loss: 3.100 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4187064170837402
Epoch: 13, Steps: 10 | Train Loss: 1.471 Vali Loss: 3.098 Vali Acc: 0.182 Test Loss: 3.098 Test Acc: 0.182
Validation loss decreased (-0.177616 --> -0.182322).  Saving model ...
Epoch: 14 cost time: 1.2579739093780518
Epoch: 14, Steps: 10 | Train Loss: 1.376 Vali Loss: 3.073 Vali Acc: 0.205 Test Loss: 3.073 Test Acc: 0.205
Validation loss decreased (-0.182322 --> -0.204675).  Saving model ...
Epoch: 15 cost time: 1.2953267097473145
Epoch: 15, Steps: 10 | Train Loss: 1.153 Vali Loss: 3.034 Vali Acc: 0.211 Test Loss: 3.034 Test Acc: 0.211
Validation loss decreased (-0.204675 --> -0.210558).  Saving model ...
Epoch: 16 cost time: 1.3343353271484375
Epoch: 16, Steps: 10 | Train Loss: 0.976 Vali Loss: 3.003 Vali Acc: 0.220 Test Loss: 3.003 Test Acc: 0.220
Validation loss decreased (-0.210558 --> -0.219970).  Saving model ...
Epoch: 17 cost time: 1.4103121757507324
Epoch: 17, Steps: 10 | Train Loss: 0.921 Vali Loss: 3.003 Vali Acc: 0.229 Test Loss: 3.003 Test Acc: 0.229
Validation loss decreased (-0.219970 --> -0.229382).  Saving model ...
Epoch: 18 cost time: 1.1829960346221924
Epoch: 18, Steps: 10 | Train Loss: 0.721 Vali Loss: 3.006 Vali Acc: 0.248 Test Loss: 3.006 Test Acc: 0.248
Validation loss decreased (-0.229382 --> -0.248205).  Saving model ...
Epoch: 19 cost time: 1.1335556507110596
Epoch: 19, Steps: 10 | Train Loss: 0.556 Vali Loss: 3.026 Vali Acc: 0.254 Test Loss: 3.026 Test Acc: 0.254
Validation loss decreased (-0.248205 --> -0.254087).  Saving model ...
Epoch: 20 cost time: 1.2402758598327637
Epoch: 20, Steps: 10 | Train Loss: 0.489 Vali Loss: 2.998 Vali Acc: 0.259 Test Loss: 2.998 Test Acc: 0.259
Validation loss decreased (-0.254087 --> -0.258794).  Saving model ...
Epoch: 21 cost time: 1.1959750652313232
Epoch: 21, Steps: 10 | Train Loss: 0.340 Vali Loss: 3.035 Vali Acc: 0.258 Test Loss: 3.035 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0957374572753906
Epoch: 22, Steps: 10 | Train Loss: 0.350 Vali Loss: 2.998 Vali Acc: 0.284 Test Loss: 2.998 Test Acc: 0.284
Validation loss decreased (-0.258794 --> -0.283499).  Saving model ...
Epoch: 23 cost time: 1.4800198078155518
Epoch: 23, Steps: 10 | Train Loss: 0.211 Vali Loss: 2.999 Vali Acc: 0.292 Test Loss: 2.999 Test Acc: 0.292
Validation loss decreased (-0.283499 --> -0.291735).  Saving model ...
Epoch: 24 cost time: 1.5057322978973389
Epoch: 24, Steps: 10 | Train Loss: 0.306 Vali Loss: 3.100 Vali Acc: 0.291 Test Loss: 3.100 Test Acc: 0.291
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5699646472930908
Epoch: 25, Steps: 10 | Train Loss: 0.300 Vali Loss: 3.027 Vali Acc: 0.275 Test Loss: 3.027 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.3299667835235596
Epoch: 26, Steps: 10 | Train Loss: 0.227 Vali Loss: 3.050 Vali Acc: 0.295 Test Loss: 3.050 Test Acc: 0.295
Validation loss decreased (-0.291735 --> -0.295264).  Saving model ...
Epoch: 27 cost time: 1.5968213081359863
Epoch: 27, Steps: 10 | Train Loss: 0.188 Vali Loss: 3.086 Vali Acc: 0.289 Test Loss: 3.086 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1730952262878418
Epoch: 28, Steps: 10 | Train Loss: 0.100 Vali Loss: 3.166 Vali Acc: 0.289 Test Loss: 3.166 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.0992231369018555
Epoch: 29, Steps: 10 | Train Loss: 0.185 Vali Loss: 3.137 Vali Acc: 0.292 Test Loss: 3.137 Test Acc: 0.292
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.2403039932250977
Epoch: 30, Steps: 10 | Train Loss: 0.080 Vali Loss: 3.184 Vali Acc: 0.312 Test Loss: 3.184 Test Acc: 0.312
Validation loss decreased (-0.295264 --> -0.311733).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.31176470588235294
model parameter : 408330
model size : 1.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.9581198692321777
Epoch: 1, Steps: 10 | Train Loss: 3.313 Vali Loss: 3.316 Vali Acc: 0.044 Test Loss: 3.316 Test Acc: 0.044
Validation loss decreased (inf --> -0.043496).  Saving model ...
Epoch: 2 cost time: 2.0224106311798096
Epoch: 2, Steps: 10 | Train Loss: 3.241 Vali Loss: 3.288 Vali Acc: 0.053 Test Loss: 3.288 Test Acc: 0.053
Validation loss decreased (-0.043496 --> -0.052908).  Saving model ...
Epoch: 3 cost time: 2.0721347332000732
Epoch: 3, Steps: 10 | Train Loss: 3.116 Vali Loss: 3.275 Vali Acc: 0.058 Test Loss: 3.275 Test Acc: 0.058
Validation loss decreased (-0.052908 --> -0.057614).  Saving model ...
Epoch: 4 cost time: 1.6377274990081787
Epoch: 4, Steps: 10 | Train Loss: 2.972 Vali Loss: 3.273 Vali Acc: 0.078 Test Loss: 3.273 Test Acc: 0.078
Validation loss decreased (-0.057614 --> -0.077614).  Saving model ...
Epoch: 5 cost time: 1.794895887374878
Epoch: 5, Steps: 10 | Train Loss: 2.759 Vali Loss: 3.246 Vali Acc: 0.099 Test Loss: 3.246 Test Acc: 0.099
Validation loss decreased (-0.077614 --> -0.098791).  Saving model ...
Epoch: 6 cost time: 3.130218029022217
Epoch: 6, Steps: 10 | Train Loss: 2.630 Vali Loss: 3.202 Vali Acc: 0.126 Test Loss: 3.202 Test Acc: 0.126
Validation loss decreased (-0.098791 --> -0.125850).  Saving model ...
Epoch: 7 cost time: 2.7147469520568848
Epoch: 7, Steps: 10 | Train Loss: 2.397 Vali Loss: 3.163 Vali Acc: 0.146 Test Loss: 3.163 Test Acc: 0.146
Validation loss decreased (-0.125850 --> -0.145851).  Saving model ...
Epoch: 8 cost time: 3.0830976963043213
Epoch: 8, Steps: 10 | Train Loss: 2.233 Vali Loss: 3.113 Vali Acc: 0.154 Test Loss: 3.113 Test Acc: 0.154
Validation loss decreased (-0.145851 --> -0.154087).  Saving model ...
Epoch: 9 cost time: 2.5181057453155518
Epoch: 9, Steps: 10 | Train Loss: 1.982 Vali Loss: 3.075 Vali Acc: 0.175 Test Loss: 3.075 Test Acc: 0.175
Validation loss decreased (-0.154087 --> -0.175263).  Saving model ...
Epoch: 10 cost time: 3.066117525100708
Epoch: 10, Steps: 10 | Train Loss: 1.756 Vali Loss: 3.047 Vali Acc: 0.195 Test Loss: 3.047 Test Acc: 0.195
Validation loss decreased (-0.175263 --> -0.195264).  Saving model ...
Epoch: 11 cost time: 3.028074264526367
Epoch: 11, Steps: 10 | Train Loss: 1.535 Vali Loss: 2.995 Vali Acc: 0.199 Test Loss: 2.995 Test Acc: 0.199
Validation loss decreased (-0.195264 --> -0.198794).  Saving model ...
Epoch: 12 cost time: 2.4265992641448975
Epoch: 12, Steps: 10 | Train Loss: 1.304 Vali Loss: 2.992 Vali Acc: 0.215 Test Loss: 2.992 Test Acc: 0.215
Validation loss decreased (-0.198794 --> -0.215264).  Saving model ...
Epoch: 13 cost time: 2.754636287689209
Epoch: 13, Steps: 10 | Train Loss: 1.099 Vali Loss: 2.953 Vali Acc: 0.228 Test Loss: 2.953 Test Acc: 0.228
Validation loss decreased (-0.215264 --> -0.228206).  Saving model ...
Epoch: 14 cost time: 2.373929262161255
Epoch: 14, Steps: 10 | Train Loss: 0.905 Vali Loss: 2.937 Vali Acc: 0.258 Test Loss: 2.937 Test Acc: 0.258
Validation loss decreased (-0.228206 --> -0.257618).  Saving model ...
Epoch: 15 cost time: 2.6725568771362305
Epoch: 15, Steps: 10 | Train Loss: 0.767 Vali Loss: 2.905 Vali Acc: 0.266 Test Loss: 2.905 Test Acc: 0.266
Validation loss decreased (-0.257618 --> -0.265853).  Saving model ...
Epoch: 16 cost time: 1.326411247253418
Epoch: 16, Steps: 10 | Train Loss: 0.579 Vali Loss: 2.925 Vali Acc: 0.279 Test Loss: 2.925 Test Acc: 0.279
Validation loss decreased (-0.265853 --> -0.278794).  Saving model ...
Epoch: 17 cost time: 3.0409491062164307
Epoch: 17, Steps: 10 | Train Loss: 0.485 Vali Loss: 2.967 Vali Acc: 0.259 Test Loss: 2.967 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.4366190433502197
Epoch: 18, Steps: 10 | Train Loss: 0.392 Vali Loss: 2.955 Vali Acc: 0.285 Test Loss: 2.955 Test Acc: 0.285
Validation loss decreased (-0.278794 --> -0.284676).  Saving model ...
Epoch: 19 cost time: 2.952463150024414
Epoch: 19, Steps: 10 | Train Loss: 0.300 Vali Loss: 2.944 Vali Acc: 0.305 Test Loss: 2.944 Test Acc: 0.305
Validation loss decreased (-0.284676 --> -0.304676).  Saving model ...
Epoch: 20 cost time: 2.418377637863159
Epoch: 20, Steps: 10 | Train Loss: 0.250 Vali Loss: 2.935 Vali Acc: 0.306 Test Loss: 2.935 Test Acc: 0.306
Validation loss decreased (-0.304676 --> -0.305853).  Saving model ...
Epoch: 21 cost time: 3.0226333141326904
Epoch: 21, Steps: 10 | Train Loss: 0.182 Vali Loss: 2.929 Vali Acc: 0.314 Test Loss: 2.929 Test Acc: 0.314
Validation loss decreased (-0.305853 --> -0.314088).  Saving model ...
Epoch: 22 cost time: 2.651975154876709
Epoch: 22, Steps: 10 | Train Loss: 0.149 Vali Loss: 2.974 Vali Acc: 0.308 Test Loss: 2.974 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.687166929244995
Epoch: 23, Steps: 10 | Train Loss: 0.183 Vali Loss: 3.000 Vali Acc: 0.309 Test Loss: 3.000 Test Acc: 0.309
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.6581952571868896
Epoch: 24, Steps: 10 | Train Loss: 0.108 Vali Loss: 3.036 Vali Acc: 0.307 Test Loss: 3.036 Test Acc: 0.307
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.8727755546569824
Epoch: 25, Steps: 10 | Train Loss: 0.103 Vali Loss: 3.035 Vali Acc: 0.313 Test Loss: 3.035 Test Acc: 0.313
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.698498249053955
Epoch: 26, Steps: 10 | Train Loss: 0.094 Vali Loss: 3.038 Vali Acc: 0.307 Test Loss: 3.038 Test Acc: 0.307
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.0335214138031006
Epoch: 27, Steps: 10 | Train Loss: 0.072 Vali Loss: 3.055 Vali Acc: 0.309 Test Loss: 3.055 Test Acc: 0.309
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.9680397510528564
Epoch: 28, Steps: 10 | Train Loss: 0.089 Vali Loss: 3.083 Vali Acc: 0.315 Test Loss: 3.083 Test Acc: 0.315
Validation loss decreased (-0.314088 --> -0.315263).  Saving model ...
Epoch: 29 cost time: 3.0018796920776367
Epoch: 29, Steps: 10 | Train Loss: 0.058 Vali Loss: 3.066 Vali Acc: 0.318 Test Loss: 3.066 Test Acc: 0.318
Validation loss decreased (-0.315263 --> -0.317616).  Saving model ...
Epoch: 30 cost time: 2.863562822341919
Epoch: 30, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.066 Vali Acc: 0.321 Test Loss: 3.066 Test Acc: 0.321
Validation loss decreased (-0.317616 --> -0.321146).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3211764705882353
model parameter : 649994
model size : 2.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.3128108978271484
Epoch: 1, Steps: 10 | Train Loss: 3.336 Vali Loss: 3.325 Vali Acc: 0.038 Test Loss: 3.325 Test Acc: 0.038
Validation loss decreased (inf --> -0.037614).  Saving model ...
Epoch: 2 cost time: 2.1500589847564697
Epoch: 2, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.290 Vali Acc: 0.034 Test Loss: 3.290 Test Acc: 0.034
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9698965549468994
Epoch: 3, Steps: 10 | Train Loss: 3.119 Vali Loss: 3.266 Vali Acc: 0.069 Test Loss: 3.266 Test Acc: 0.069
Validation loss decreased (-0.037614 --> -0.069379).  Saving model ...
Epoch: 4 cost time: 1.681929111480713
Epoch: 4, Steps: 10 | Train Loss: 3.026 Vali Loss: 3.257 Vali Acc: 0.088 Test Loss: 3.257 Test Acc: 0.088
Validation loss decreased (-0.069379 --> -0.088203).  Saving model ...
Epoch: 5 cost time: 1.7885735034942627
Epoch: 5, Steps: 10 | Train Loss: 2.827 Vali Loss: 3.241 Vali Acc: 0.091 Test Loss: 3.241 Test Acc: 0.091
Validation loss decreased (-0.088203 --> -0.090556).  Saving model ...
Epoch: 6 cost time: 2.118542194366455
Epoch: 6, Steps: 10 | Train Loss: 2.721 Vali Loss: 3.209 Vali Acc: 0.104 Test Loss: 3.209 Test Acc: 0.104
Validation loss decreased (-0.090556 --> -0.103497).  Saving model ...
Epoch: 7 cost time: 1.6703460216522217
Epoch: 7, Steps: 10 | Train Loss: 2.488 Vali Loss: 3.159 Vali Acc: 0.127 Test Loss: 3.159 Test Acc: 0.127
Validation loss decreased (-0.103497 --> -0.127027).  Saving model ...
Epoch: 8 cost time: 1.6153626441955566
Epoch: 8, Steps: 10 | Train Loss: 2.322 Vali Loss: 3.117 Vali Acc: 0.142 Test Loss: 3.117 Test Acc: 0.142
Validation loss decreased (-0.127027 --> -0.142322).  Saving model ...
Epoch: 9 cost time: 1.702665090560913
Epoch: 9, Steps: 10 | Train Loss: 2.111 Vali Loss: 3.077 Vali Acc: 0.159 Test Loss: 3.077 Test Acc: 0.159
Validation loss decreased (-0.142322 --> -0.158793).  Saving model ...
Epoch: 10 cost time: 1.9299647808074951
Epoch: 10, Steps: 10 | Train Loss: 1.904 Vali Loss: 3.039 Vali Acc: 0.169 Test Loss: 3.039 Test Acc: 0.169
Validation loss decreased (-0.158793 --> -0.169381).  Saving model ...
Epoch: 11 cost time: 1.0591881275177002
Epoch: 11, Steps: 10 | Train Loss: 1.736 Vali Loss: 3.004 Vali Acc: 0.179 Test Loss: 3.004 Test Acc: 0.179
Validation loss decreased (-0.169381 --> -0.178793).  Saving model ...
Epoch: 12 cost time: 1.0988099575042725
Epoch: 12, Steps: 10 | Train Loss: 1.521 Vali Loss: 2.967 Vali Acc: 0.200 Test Loss: 2.967 Test Acc: 0.200
Validation loss decreased (-0.178793 --> -0.199970).  Saving model ...
Epoch: 13 cost time: 1.0204546451568604
Epoch: 13, Steps: 10 | Train Loss: 1.257 Vali Loss: 2.950 Vali Acc: 0.208 Test Loss: 2.950 Test Acc: 0.208
Validation loss decreased (-0.199970 --> -0.208206).  Saving model ...
Epoch: 14 cost time: 1.4782183170318604
Epoch: 14, Steps: 10 | Train Loss: 1.054 Vali Loss: 2.921 Vali Acc: 0.226 Test Loss: 2.921 Test Acc: 0.226
Validation loss decreased (-0.208206 --> -0.225853).  Saving model ...
Epoch: 15 cost time: 1.1723339557647705
Epoch: 15, Steps: 10 | Train Loss: 0.857 Vali Loss: 2.932 Vali Acc: 0.232 Test Loss: 2.932 Test Acc: 0.232
Validation loss decreased (-0.225853 --> -0.231735).  Saving model ...
Epoch: 16 cost time: 1.4073200225830078
Epoch: 16, Steps: 10 | Train Loss: 0.756 Vali Loss: 2.912 Vali Acc: 0.245 Test Loss: 2.912 Test Acc: 0.245
Validation loss decreased (-0.231735 --> -0.244677).  Saving model ...
Epoch: 17 cost time: 1.3018839359283447
Epoch: 17, Steps: 10 | Train Loss: 0.630 Vali Loss: 2.953 Vali Acc: 0.246 Test Loss: 2.953 Test Acc: 0.246
Validation loss decreased (-0.244677 --> -0.245853).  Saving model ...
Epoch: 18 cost time: 1.7476916313171387
Epoch: 18, Steps: 10 | Train Loss: 0.515 Vali Loss: 2.901 Vali Acc: 0.276 Test Loss: 2.901 Test Acc: 0.276
Validation loss decreased (-0.245853 --> -0.276442).  Saving model ...
Epoch: 19 cost time: 2.169907331466675
Epoch: 19, Steps: 10 | Train Loss: 0.387 Vali Loss: 2.935 Vali Acc: 0.269 Test Loss: 2.935 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.7380759716033936
Epoch: 20, Steps: 10 | Train Loss: 0.341 Vali Loss: 2.971 Vali Acc: 0.280 Test Loss: 2.971 Test Acc: 0.280
Validation loss decreased (-0.276442 --> -0.279970).  Saving model ...
Epoch: 21 cost time: 1.553907871246338
Epoch: 21, Steps: 10 | Train Loss: 0.272 Vali Loss: 2.992 Vali Acc: 0.281 Test Loss: 2.992 Test Acc: 0.281
Validation loss decreased (-0.279970 --> -0.281147).  Saving model ...
Epoch: 22 cost time: 1.3260316848754883
Epoch: 22, Steps: 10 | Train Loss: 0.206 Vali Loss: 3.019 Vali Acc: 0.284 Test Loss: 3.019 Test Acc: 0.284
Validation loss decreased (-0.281147 --> -0.283499).  Saving model ...
Epoch: 23 cost time: 1.2735602855682373
Epoch: 23, Steps: 10 | Train Loss: 0.162 Vali Loss: 2.970 Vali Acc: 0.306 Test Loss: 2.970 Test Acc: 0.306
Validation loss decreased (-0.283499 --> -0.305853).  Saving model ...
Epoch: 24 cost time: 1.6796932220458984
Epoch: 24, Steps: 10 | Train Loss: 0.205 Vali Loss: 3.036 Vali Acc: 0.308 Test Loss: 3.036 Test Acc: 0.308
Validation loss decreased (-0.305853 --> -0.308205).  Saving model ...
Epoch: 25 cost time: 2.0635905265808105
Epoch: 25, Steps: 10 | Train Loss: 0.179 Vali Loss: 3.025 Vali Acc: 0.309 Test Loss: 3.025 Test Acc: 0.309
Validation loss decreased (-0.308205 --> -0.309382).  Saving model ...
Epoch: 26 cost time: 2.2281036376953125
Epoch: 26, Steps: 10 | Train Loss: 0.117 Vali Loss: 3.028 Vali Acc: 0.300 Test Loss: 3.028 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3522322177886963
Epoch: 27, Steps: 10 | Train Loss: 0.125 Vali Loss: 3.075 Vali Acc: 0.308 Test Loss: 3.075 Test Acc: 0.308
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.0573484897613525
Epoch: 28, Steps: 10 | Train Loss: 0.084 Vali Loss: 3.059 Vali Acc: 0.304 Test Loss: 3.059 Test Acc: 0.304
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.254878044128418
Epoch: 29, Steps: 10 | Train Loss: 0.085 Vali Loss: 3.075 Vali Acc: 0.307 Test Loss: 3.075 Test Acc: 0.307
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.955895185470581
Epoch: 30, Steps: 10 | Train Loss: 0.081 Vali Loss: 3.159 Vali Acc: 0.306 Test Loss: 3.159 Test Acc: 0.306
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.30941176470588233
model parameter : 236042
model size : 1.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.01496958732605
Epoch: 1, Steps: 10 | Train Loss: 3.318 Vali Loss: 3.318 Vali Acc: 0.039 Test Loss: 3.318 Test Acc: 0.039
Validation loss decreased (inf --> -0.038790).  Saving model ...
Epoch: 2 cost time: 1.160898208618164
Epoch: 2, Steps: 10 | Train Loss: 3.247 Vali Loss: 3.292 Vali Acc: 0.047 Test Loss: 3.292 Test Acc: 0.047
Validation loss decreased (-0.038790 --> -0.047026).  Saving model ...
Epoch: 3 cost time: 1.2587969303131104
Epoch: 3, Steps: 10 | Train Loss: 3.139 Vali Loss: 3.280 Vali Acc: 0.061 Test Loss: 3.280 Test Acc: 0.061
Validation loss decreased (-0.047026 --> -0.061144).  Saving model ...
Epoch: 4 cost time: 1.8268892765045166
Epoch: 4, Steps: 10 | Train Loss: 2.981 Vali Loss: 3.280 Vali Acc: 0.067 Test Loss: 3.280 Test Acc: 0.067
Validation loss decreased (-0.061144 --> -0.067026).  Saving model ...
Epoch: 5 cost time: 1.6577653884887695
Epoch: 5, Steps: 10 | Train Loss: 2.801 Vali Loss: 3.258 Vali Acc: 0.091 Test Loss: 3.258 Test Acc: 0.091
Validation loss decreased (-0.067026 --> -0.090556).  Saving model ...
Epoch: 6 cost time: 1.662552833557129
Epoch: 6, Steps: 10 | Train Loss: 2.667 Vali Loss: 3.223 Vali Acc: 0.111 Test Loss: 3.223 Test Acc: 0.111
Validation loss decreased (-0.090556 --> -0.110556).  Saving model ...
Epoch: 7 cost time: 1.53294038772583
Epoch: 7, Steps: 10 | Train Loss: 2.442 Vali Loss: 3.188 Vali Acc: 0.127 Test Loss: 3.188 Test Acc: 0.127
Validation loss decreased (-0.110556 --> -0.127027).  Saving model ...
Epoch: 8 cost time: 1.407963514328003
Epoch: 8, Steps: 10 | Train Loss: 2.278 Vali Loss: 3.142 Vali Acc: 0.148 Test Loss: 3.142 Test Acc: 0.148
Validation loss decreased (-0.127027 --> -0.148204).  Saving model ...
Epoch: 9 cost time: 1.2949740886688232
Epoch: 9, Steps: 10 | Train Loss: 2.082 Vali Loss: 3.106 Vali Acc: 0.166 Test Loss: 3.106 Test Acc: 0.166
Validation loss decreased (-0.148204 --> -0.165851).  Saving model ...
Epoch: 10 cost time: 1.2206120491027832
Epoch: 10, Steps: 10 | Train Loss: 1.890 Vali Loss: 3.071 Vali Acc: 0.185 Test Loss: 3.071 Test Acc: 0.185
Validation loss decreased (-0.165851 --> -0.184675).  Saving model ...
Epoch: 11 cost time: 1.4598653316497803
Epoch: 11, Steps: 10 | Train Loss: 1.638 Vali Loss: 3.027 Vali Acc: 0.198 Test Loss: 3.027 Test Acc: 0.198
Validation loss decreased (-0.184675 --> -0.197617).  Saving model ...
Epoch: 12 cost time: 2.153658628463745
Epoch: 12, Steps: 10 | Train Loss: 1.467 Vali Loss: 3.005 Vali Acc: 0.206 Test Loss: 3.005 Test Acc: 0.206
Validation loss decreased (-0.197617 --> -0.205852).  Saving model ...
Epoch: 13 cost time: 2.054988384246826
Epoch: 13, Steps: 10 | Train Loss: 1.256 Vali Loss: 2.987 Vali Acc: 0.213 Test Loss: 2.987 Test Acc: 0.213
Validation loss decreased (-0.205852 --> -0.212911).  Saving model ...
Epoch: 14 cost time: 1.5443496704101562
Epoch: 14, Steps: 10 | Train Loss: 1.028 Vali Loss: 2.961 Vali Acc: 0.233 Test Loss: 2.961 Test Acc: 0.233
Validation loss decreased (-0.212911 --> -0.232912).  Saving model ...
Epoch: 15 cost time: 1.8266117572784424
Epoch: 15, Steps: 10 | Train Loss: 1.097 Vali Loss: 2.954 Vali Acc: 0.258 Test Loss: 2.954 Test Acc: 0.258
Validation loss decreased (-0.232912 --> -0.257618).  Saving model ...
Epoch: 16 cost time: 1.9028940200805664
Epoch: 16, Steps: 10 | Train Loss: 0.853 Vali Loss: 2.917 Vali Acc: 0.261 Test Loss: 2.917 Test Acc: 0.261
Validation loss decreased (-0.257618 --> -0.261147).  Saving model ...
Epoch: 17 cost time: 1.71156644821167
Epoch: 17, Steps: 10 | Train Loss: 0.701 Vali Loss: 2.906 Vali Acc: 0.262 Test Loss: 2.906 Test Acc: 0.262
Validation loss decreased (-0.261147 --> -0.262324).  Saving model ...
Epoch: 18 cost time: 1.8513338565826416
Epoch: 18, Steps: 10 | Train Loss: 0.594 Vali Loss: 2.922 Vali Acc: 0.284 Test Loss: 2.922 Test Acc: 0.284
Validation loss decreased (-0.262324 --> -0.283500).  Saving model ...
Epoch: 19 cost time: 2.2258825302124023
Epoch: 19, Steps: 10 | Train Loss: 0.437 Vali Loss: 2.919 Vali Acc: 0.296 Test Loss: 2.919 Test Acc: 0.296
Validation loss decreased (-0.283500 --> -0.296441).  Saving model ...
Epoch: 20 cost time: 1.415144920349121
Epoch: 20, Steps: 10 | Train Loss: 0.445 Vali Loss: 2.928 Vali Acc: 0.292 Test Loss: 2.928 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.7770698070526123
Epoch: 21, Steps: 10 | Train Loss: 0.350 Vali Loss: 2.914 Vali Acc: 0.316 Test Loss: 2.914 Test Acc: 0.316
Validation loss decreased (-0.296441 --> -0.316441).  Saving model ...
Epoch: 22 cost time: 1.5917158126831055
Epoch: 22, Steps: 10 | Train Loss: 0.272 Vali Loss: 2.987 Vali Acc: 0.314 Test Loss: 2.987 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.642463207244873
Epoch: 23, Steps: 10 | Train Loss: 0.224 Vali Loss: 2.980 Vali Acc: 0.320 Test Loss: 2.980 Test Acc: 0.320
Validation loss decreased (-0.316441 --> -0.319970).  Saving model ...
Epoch: 24 cost time: 2.181762933731079
Epoch: 24, Steps: 10 | Train Loss: 0.197 Vali Loss: 3.020 Vali Acc: 0.306 Test Loss: 3.020 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.6776814460754395
Epoch: 25, Steps: 10 | Train Loss: 0.186 Vali Loss: 2.986 Vali Acc: 0.319 Test Loss: 2.986 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.4185700416564941
Epoch: 26, Steps: 10 | Train Loss: 0.140 Vali Loss: 3.063 Vali Acc: 0.308 Test Loss: 3.063 Test Acc: 0.308
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.5978116989135742
Epoch: 27, Steps: 10 | Train Loss: 0.101 Vali Loss: 3.017 Vali Acc: 0.322 Test Loss: 3.017 Test Acc: 0.322
Validation loss decreased (-0.319970 --> -0.322323).  Saving model ...
Epoch: 28 cost time: 1.902475357055664
Epoch: 28, Steps: 10 | Train Loss: 0.151 Vali Loss: 3.025 Vali Acc: 0.318 Test Loss: 3.025 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.8153138160705566
Epoch: 29, Steps: 10 | Train Loss: 0.136 Vali Loss: 3.177 Vali Acc: 0.305 Test Loss: 3.177 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.7511858940124512
Epoch: 30, Steps: 10 | Train Loss: 0.127 Vali Loss: 3.067 Vali Acc: 0.321 Test Loss: 3.067 Test Acc: 0.321
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.32235294117647056
model parameter : 649994
model size : 2.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.717068672180176
Epoch: 1, Steps: 10 | Train Loss: 3.348 Vali Loss: 3.334 Vali Acc: 0.028 Test Loss: 3.334 Test Acc: 0.028
Validation loss decreased (inf --> -0.028202).  Saving model ...
Epoch: 2 cost time: 1.1327259540557861
Epoch: 2, Steps: 10 | Train Loss: 3.271 Vali Loss: 3.301 Vali Acc: 0.031 Test Loss: 3.301 Test Acc: 0.031
Validation loss decreased (-0.028202 --> -0.030555).  Saving model ...
Epoch: 3 cost time: 1.0995235443115234
Epoch: 3, Steps: 10 | Train Loss: 3.132 Vali Loss: 3.281 Vali Acc: 0.058 Test Loss: 3.281 Test Acc: 0.058
Validation loss decreased (-0.030555 --> -0.057614).  Saving model ...
Epoch: 4 cost time: 1.0816535949707031
Epoch: 4, Steps: 10 | Train Loss: 3.051 Vali Loss: 3.277 Vali Acc: 0.076 Test Loss: 3.277 Test Acc: 0.076
Validation loss decreased (-0.057614 --> -0.076438).  Saving model ...
Epoch: 5 cost time: 1.2806189060211182
Epoch: 5, Steps: 10 | Train Loss: 2.866 Vali Loss: 3.264 Vali Acc: 0.084 Test Loss: 3.264 Test Acc: 0.084
Validation loss decreased (-0.076438 --> -0.083497).  Saving model ...
Epoch: 6 cost time: 1.5152864456176758
Epoch: 6, Steps: 10 | Train Loss: 2.771 Vali Loss: 3.237 Vali Acc: 0.099 Test Loss: 3.237 Test Acc: 0.099
Validation loss decreased (-0.083497 --> -0.098791).  Saving model ...
Epoch: 7 cost time: 1.4693574905395508
Epoch: 7, Steps: 10 | Train Loss: 2.591 Vali Loss: 3.193 Vali Acc: 0.121 Test Loss: 3.193 Test Acc: 0.121
Validation loss decreased (-0.098791 --> -0.121145).  Saving model ...
Epoch: 8 cost time: 1.049736499786377
Epoch: 8, Steps: 10 | Train Loss: 2.415 Vali Loss: 3.157 Vali Acc: 0.131 Test Loss: 3.157 Test Acc: 0.131
Validation loss decreased (-0.121145 --> -0.130557).  Saving model ...
Epoch: 9 cost time: 1.2328131198883057
Epoch: 9, Steps: 10 | Train Loss: 2.248 Vali Loss: 3.118 Vali Acc: 0.142 Test Loss: 3.118 Test Acc: 0.142
Validation loss decreased (-0.130557 --> -0.142322).  Saving model ...
Epoch: 10 cost time: 1.2265725135803223
Epoch: 10, Steps: 10 | Train Loss: 2.059 Vali Loss: 3.077 Vali Acc: 0.155 Test Loss: 3.077 Test Acc: 0.155
Validation loss decreased (-0.142322 --> -0.155263).  Saving model ...
Epoch: 11 cost time: 1.251460075378418
Epoch: 11, Steps: 10 | Train Loss: 1.911 Vali Loss: 3.046 Vali Acc: 0.176 Test Loss: 3.046 Test Acc: 0.176
Validation loss decreased (-0.155263 --> -0.176440).  Saving model ...
Epoch: 12 cost time: 1.3196656703948975
Epoch: 12, Steps: 10 | Train Loss: 1.730 Vali Loss: 3.004 Vali Acc: 0.200 Test Loss: 3.004 Test Acc: 0.200
Validation loss decreased (-0.176440 --> -0.199970).  Saving model ...
Epoch: 13 cost time: 1.5211164951324463
Epoch: 13, Steps: 10 | Train Loss: 1.466 Vali Loss: 2.990 Vali Acc: 0.204 Test Loss: 2.990 Test Acc: 0.204
Validation loss decreased (-0.199970 --> -0.203500).  Saving model ...
Epoch: 14 cost time: 1.4603567123413086
Epoch: 14, Steps: 10 | Train Loss: 1.312 Vali Loss: 2.952 Vali Acc: 0.221 Test Loss: 2.952 Test Acc: 0.221
Validation loss decreased (-0.203500 --> -0.221147).  Saving model ...
Epoch: 15 cost time: 1.0508921146392822
Epoch: 15, Steps: 10 | Train Loss: 1.134 Vali Loss: 2.942 Vali Acc: 0.209 Test Loss: 2.942 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9424946308135986
Epoch: 16, Steps: 10 | Train Loss: 1.019 Vali Loss: 2.974 Vali Acc: 0.218 Test Loss: 2.974 Test Acc: 0.218
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0713160037994385
Epoch: 17, Steps: 10 | Train Loss: 0.901 Vali Loss: 2.930 Vali Acc: 0.238 Test Loss: 2.930 Test Acc: 0.238
Validation loss decreased (-0.221147 --> -0.237618).  Saving model ...
Epoch: 18 cost time: 1.2864537239074707
Epoch: 18, Steps: 10 | Train Loss: 0.752 Vali Loss: 2.931 Vali Acc: 0.247 Test Loss: 2.931 Test Acc: 0.247
Validation loss decreased (-0.237618 --> -0.247030).  Saving model ...
Epoch: 19 cost time: 1.383847713470459
Epoch: 19, Steps: 10 | Train Loss: 0.622 Vali Loss: 2.884 Vali Acc: 0.269 Test Loss: 2.884 Test Acc: 0.269
Validation loss decreased (-0.247030 --> -0.269383).  Saving model ...
Epoch: 20 cost time: 1.651564359664917
Epoch: 20, Steps: 10 | Train Loss: 0.554 Vali Loss: 2.913 Vali Acc: 0.272 Test Loss: 2.913 Test Acc: 0.272
Validation loss decreased (-0.269383 --> -0.271736).  Saving model ...
Epoch: 21 cost time: 1.549027442932129
Epoch: 21, Steps: 10 | Train Loss: 0.465 Vali Loss: 2.949 Vali Acc: 0.280 Test Loss: 2.949 Test Acc: 0.280
Validation loss decreased (-0.271736 --> -0.279971).  Saving model ...
Epoch: 22 cost time: 1.2007591724395752
Epoch: 22, Steps: 10 | Train Loss: 0.373 Vali Loss: 2.972 Vali Acc: 0.281 Test Loss: 2.972 Test Acc: 0.281
Validation loss decreased (-0.279971 --> -0.281147).  Saving model ...
Epoch: 23 cost time: 1.2002573013305664
Epoch: 23, Steps: 10 | Train Loss: 0.309 Vali Loss: 2.964 Vali Acc: 0.293 Test Loss: 2.964 Test Acc: 0.293
Validation loss decreased (-0.281147 --> -0.292912).  Saving model ...
Epoch: 24 cost time: 1.4380180835723877
Epoch: 24, Steps: 10 | Train Loss: 0.291 Vali Loss: 3.007 Vali Acc: 0.286 Test Loss: 3.007 Test Acc: 0.286
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3830702304840088
Epoch: 25, Steps: 10 | Train Loss: 0.290 Vali Loss: 2.984 Vali Acc: 0.284 Test Loss: 2.984 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.3039350509643555
Epoch: 26, Steps: 10 | Train Loss: 0.206 Vali Loss: 2.987 Vali Acc: 0.293 Test Loss: 2.987 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.333087682723999
Epoch: 27, Steps: 10 | Train Loss: 0.186 Vali Loss: 3.016 Vali Acc: 0.306 Test Loss: 3.016 Test Acc: 0.306
Validation loss decreased (-0.292912 --> -0.305852).  Saving model ...
Epoch: 28 cost time: 1.087690830230713
Epoch: 28, Steps: 10 | Train Loss: 0.192 Vali Loss: 3.070 Vali Acc: 0.305 Test Loss: 3.070 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0637049674987793
Epoch: 29, Steps: 10 | Train Loss: 0.149 Vali Loss: 3.019 Vali Acc: 0.306 Test Loss: 3.019 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.180530071258545
Epoch: 30, Steps: 10 | Train Loss: 0.116 Vali Loss: 3.066 Vali Acc: 0.315 Test Loss: 3.066 Test Acc: 0.315
Validation loss decreased (-0.305852 --> -0.315263).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.31529411764705884
model parameter : 236042
model size : 1.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.69435715675354
Epoch: 1, Steps: 10 | Train Loss: 3.322 Vali Loss: 3.316 Vali Acc: 0.042 Test Loss: 3.316 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 1.2741930484771729
Epoch: 2, Steps: 10 | Train Loss: 3.250 Vali Loss: 3.293 Vali Acc: 0.053 Test Loss: 3.293 Test Acc: 0.053
Validation loss decreased (-0.042320 --> -0.052908).  Saving model ...
Epoch: 3 cost time: 1.1252288818359375
Epoch: 3, Steps: 10 | Train Loss: 3.160 Vali Loss: 3.287 Vali Acc: 0.053 Test Loss: 3.287 Test Acc: 0.053
Validation loss decreased (-0.052908 --> -0.052908).  Saving model ...
Epoch: 4 cost time: 1.3209319114685059
Epoch: 4, Steps: 10 | Train Loss: 3.003 Vali Loss: 3.293 Vali Acc: 0.054 Test Loss: 3.293 Test Acc: 0.054
Validation loss decreased (-0.052908 --> -0.054085).  Saving model ...
Epoch: 5 cost time: 1.2295763492584229
Epoch: 5, Steps: 10 | Train Loss: 2.846 Vali Loss: 3.278 Vali Acc: 0.068 Test Loss: 3.278 Test Acc: 0.068
Validation loss decreased (-0.054085 --> -0.068203).  Saving model ...
Epoch: 6 cost time: 1.182145357131958
Epoch: 6, Steps: 10 | Train Loss: 2.730 Vali Loss: 3.251 Vali Acc: 0.100 Test Loss: 3.251 Test Acc: 0.100
Validation loss decreased (-0.068203 --> -0.099967).  Saving model ...
Epoch: 7 cost time: 1.117690086364746
Epoch: 7, Steps: 10 | Train Loss: 2.533 Vali Loss: 3.223 Vali Acc: 0.111 Test Loss: 3.223 Test Acc: 0.111
Validation loss decreased (-0.099967 --> -0.110556).  Saving model ...
Epoch: 8 cost time: 1.5196113586425781
Epoch: 8, Steps: 10 | Train Loss: 2.371 Vali Loss: 3.187 Vali Acc: 0.132 Test Loss: 3.187 Test Acc: 0.132
Validation loss decreased (-0.110556 --> -0.131733).  Saving model ...
Epoch: 9 cost time: 1.4554212093353271
Epoch: 9, Steps: 10 | Train Loss: 2.218 Vali Loss: 3.153 Vali Acc: 0.165 Test Loss: 3.153 Test Acc: 0.165
Validation loss decreased (-0.131733 --> -0.164674).  Saving model ...
Epoch: 10 cost time: 1.2467217445373535
Epoch: 10, Steps: 10 | Train Loss: 2.019 Vali Loss: 3.131 Vali Acc: 0.171 Test Loss: 3.131 Test Acc: 0.171
Validation loss decreased (-0.164674 --> -0.170557).  Saving model ...
Epoch: 11 cost time: 1.1095101833343506
Epoch: 11, Steps: 10 | Train Loss: 1.817 Vali Loss: 3.100 Vali Acc: 0.193 Test Loss: 3.100 Test Acc: 0.193
Validation loss decreased (-0.170557 --> -0.192910).  Saving model ...
Epoch: 12 cost time: 1.1668999195098877
Epoch: 12, Steps: 10 | Train Loss: 1.639 Vali Loss: 3.054 Vali Acc: 0.209 Test Loss: 3.054 Test Acc: 0.209
Validation loss decreased (-0.192910 --> -0.209381).  Saving model ...
Epoch: 13 cost time: 0.9005405902862549
Epoch: 13, Steps: 10 | Train Loss: 1.388 Vali Loss: 3.031 Vali Acc: 0.232 Test Loss: 3.031 Test Acc: 0.232
Validation loss decreased (-0.209381 --> -0.231734).  Saving model ...
Epoch: 14 cost time: 1.7318224906921387
Epoch: 14, Steps: 10 | Train Loss: 1.199 Vali Loss: 2.993 Vali Acc: 0.244 Test Loss: 2.993 Test Acc: 0.244
Validation loss decreased (-0.231734 --> -0.243499).  Saving model ...
Epoch: 15 cost time: 1.6041300296783447
Epoch: 15, Steps: 10 | Train Loss: 1.029 Vali Loss: 2.976 Vali Acc: 0.251 Test Loss: 2.976 Test Acc: 0.251
Validation loss decreased (-0.243499 --> -0.250558).  Saving model ...
Epoch: 16 cost time: 1.2847156524658203
Epoch: 16, Steps: 10 | Train Loss: 0.842 Vali Loss: 3.001 Vali Acc: 0.273 Test Loss: 3.001 Test Acc: 0.273
Validation loss decreased (-0.250558 --> -0.272911).  Saving model ...
Epoch: 17 cost time: 1.734560489654541
Epoch: 17, Steps: 10 | Train Loss: 0.758 Vali Loss: 2.960 Vali Acc: 0.265 Test Loss: 2.960 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4502205848693848
Epoch: 18, Steps: 10 | Train Loss: 0.660 Vali Loss: 2.959 Vali Acc: 0.278 Test Loss: 2.959 Test Acc: 0.278
Validation loss decreased (-0.272911 --> -0.277617).  Saving model ...
Epoch: 19 cost time: 0.9990737438201904
Epoch: 19, Steps: 10 | Train Loss: 0.476 Vali Loss: 2.979 Vali Acc: 0.285 Test Loss: 2.979 Test Acc: 0.285
Validation loss decreased (-0.277617 --> -0.284676).  Saving model ...
Epoch: 20 cost time: 0.9948334693908691
Epoch: 20, Steps: 10 | Train Loss: 0.455 Vali Loss: 2.996 Vali Acc: 0.280 Test Loss: 2.996 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0361695289611816
Epoch: 21, Steps: 10 | Train Loss: 0.375 Vali Loss: 2.990 Vali Acc: 0.301 Test Loss: 2.990 Test Acc: 0.301
Validation loss decreased (-0.284676 --> -0.301147).  Saving model ...
Epoch: 22 cost time: 1.1409120559692383
Epoch: 22, Steps: 10 | Train Loss: 0.299 Vali Loss: 3.097 Vali Acc: 0.293 Test Loss: 3.097 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8646738529205322
Epoch: 23, Steps: 10 | Train Loss: 0.274 Vali Loss: 3.021 Vali Acc: 0.301 Test Loss: 3.021 Test Acc: 0.301
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8355987071990967
Epoch: 24, Steps: 10 | Train Loss: 0.199 Vali Loss: 3.027 Vali Acc: 0.314 Test Loss: 3.027 Test Acc: 0.314
Validation loss decreased (-0.301147 --> -0.314087).  Saving model ...
Epoch: 25 cost time: 0.8101985454559326
Epoch: 25, Steps: 10 | Train Loss: 0.178 Vali Loss: 3.042 Vali Acc: 0.313 Test Loss: 3.042 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9077401161193848
Epoch: 26, Steps: 10 | Train Loss: 0.140 Vali Loss: 3.083 Vali Acc: 0.314 Test Loss: 3.083 Test Acc: 0.314
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8919305801391602
Epoch: 27, Steps: 10 | Train Loss: 0.134 Vali Loss: 3.087 Vali Acc: 0.329 Test Loss: 3.087 Test Acc: 0.329
Validation loss decreased (-0.314087 --> -0.329381).  Saving model ...
Epoch: 28 cost time: 1.1531264781951904
Epoch: 28, Steps: 10 | Train Loss: 0.116 Vali Loss: 3.072 Vali Acc: 0.316 Test Loss: 3.072 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.5740339756011963
Epoch: 29, Steps: 10 | Train Loss: 0.123 Vali Loss: 3.178 Vali Acc: 0.315 Test Loss: 3.178 Test Acc: 0.315
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.5317792892456055
Epoch: 30, Steps: 10 | Train Loss: 0.098 Vali Loss: 3.131 Vali Acc: 0.314 Test Loss: 3.131 Test Acc: 0.314
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.32941176470588235
model parameter : 649994
model size : 2.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.718440532684326
Epoch: 1, Steps: 10 | Train Loss: 3.338 Vali Loss: 3.343 Vali Acc: 0.027 Test Loss: 3.343 Test Acc: 0.027
Validation loss decreased (inf --> -0.027025).  Saving model ...
Epoch: 2 cost time: 1.6464252471923828
Epoch: 2, Steps: 10 | Train Loss: 3.266 Vali Loss: 3.312 Vali Acc: 0.025 Test Loss: 3.312 Test Acc: 0.025
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.246546983718872
Epoch: 3, Steps: 10 | Train Loss: 3.145 Vali Loss: 3.296 Vali Acc: 0.049 Test Loss: 3.296 Test Acc: 0.049
Validation loss decreased (-0.027025 --> -0.049379).  Saving model ...
Epoch: 4 cost time: 1.523308277130127
Epoch: 4, Steps: 10 | Train Loss: 3.042 Vali Loss: 3.296 Vali Acc: 0.074 Test Loss: 3.296 Test Acc: 0.074
Validation loss decreased (-0.049379 --> -0.074085).  Saving model ...
Epoch: 5 cost time: 1.2968254089355469
Epoch: 5, Steps: 10 | Train Loss: 2.888 Vali Loss: 3.290 Vali Acc: 0.080 Test Loss: 3.290 Test Acc: 0.080
Validation loss decreased (-0.074085 --> -0.079967).  Saving model ...
Epoch: 6 cost time: 1.2852046489715576
Epoch: 6, Steps: 10 | Train Loss: 2.813 Vali Loss: 3.268 Vali Acc: 0.087 Test Loss: 3.268 Test Acc: 0.087
Validation loss decreased (-0.079967 --> -0.087026).  Saving model ...
Epoch: 7 cost time: 1.4386909008026123
Epoch: 7, Steps: 10 | Train Loss: 2.639 Vali Loss: 3.228 Vali Acc: 0.100 Test Loss: 3.228 Test Acc: 0.100
Validation loss decreased (-0.087026 --> -0.099968).  Saving model ...
Epoch: 8 cost time: 1.1896095275878906
Epoch: 8, Steps: 10 | Train Loss: 2.508 Vali Loss: 3.199 Vali Acc: 0.106 Test Loss: 3.199 Test Acc: 0.106
Validation loss decreased (-0.099968 --> -0.105850).  Saving model ...
Epoch: 9 cost time: 1.3870387077331543
Epoch: 9, Steps: 10 | Train Loss: 2.346 Vali Loss: 3.170 Vali Acc: 0.121 Test Loss: 3.170 Test Acc: 0.121
Validation loss decreased (-0.105850 --> -0.121145).  Saving model ...
Epoch: 10 cost time: 1.20455002784729
Epoch: 10, Steps: 10 | Train Loss: 2.205 Vali Loss: 3.138 Vali Acc: 0.139 Test Loss: 3.138 Test Acc: 0.139
Validation loss decreased (-0.121145 --> -0.138792).  Saving model ...
Epoch: 11 cost time: 1.646545171737671
Epoch: 11, Steps: 10 | Train Loss: 2.073 Vali Loss: 3.114 Vali Acc: 0.149 Test Loss: 3.114 Test Acc: 0.149
Validation loss decreased (-0.138792 --> -0.149381).  Saving model ...
Epoch: 12 cost time: 1.21647047996521
Epoch: 12, Steps: 10 | Train Loss: 1.863 Vali Loss: 3.073 Vali Acc: 0.181 Test Loss: 3.073 Test Acc: 0.181
Validation loss decreased (-0.149381 --> -0.181146).  Saving model ...
Epoch: 13 cost time: 1.1839287281036377
Epoch: 13, Steps: 10 | Train Loss: 1.657 Vali Loss: 3.056 Vali Acc: 0.188 Test Loss: 3.056 Test Acc: 0.188
Validation loss decreased (-0.181146 --> -0.188205).  Saving model ...
Epoch: 14 cost time: 1.3566091060638428
Epoch: 14, Steps: 10 | Train Loss: 1.487 Vali Loss: 3.030 Vali Acc: 0.206 Test Loss: 3.030 Test Acc: 0.206
Validation loss decreased (-0.188205 --> -0.205852).  Saving model ...
Epoch: 15 cost time: 1.2457482814788818
Epoch: 15, Steps: 10 | Train Loss: 1.393 Vali Loss: 3.013 Vali Acc: 0.201 Test Loss: 3.013 Test Acc: 0.201
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4111568927764893
Epoch: 16, Steps: 10 | Train Loss: 1.228 Vali Loss: 3.015 Vali Acc: 0.219 Test Loss: 3.015 Test Acc: 0.219
Validation loss decreased (-0.205852 --> -0.218793).  Saving model ...
Epoch: 17 cost time: 1.3990709781646729
Epoch: 17, Steps: 10 | Train Loss: 1.015 Vali Loss: 2.994 Vali Acc: 0.228 Test Loss: 2.994 Test Acc: 0.228
Validation loss decreased (-0.218793 --> -0.228205).  Saving model ...
Epoch: 18 cost time: 1.3764824867248535
Epoch: 18, Steps: 10 | Train Loss: 0.887 Vali Loss: 2.976 Vali Acc: 0.236 Test Loss: 2.976 Test Acc: 0.236
Validation loss decreased (-0.228205 --> -0.236441).  Saving model ...
Epoch: 19 cost time: 1.415341854095459
Epoch: 19, Steps: 10 | Train Loss: 0.770 Vali Loss: 2.973 Vali Acc: 0.235 Test Loss: 2.973 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.474409818649292
Epoch: 20, Steps: 10 | Train Loss: 0.613 Vali Loss: 2.981 Vali Acc: 0.238 Test Loss: 2.981 Test Acc: 0.238
Validation loss decreased (-0.236441 --> -0.237617).  Saving model ...
Epoch: 21 cost time: 1.259936809539795
Epoch: 21, Steps: 10 | Train Loss: 0.572 Vali Loss: 2.988 Vali Acc: 0.259 Test Loss: 2.988 Test Acc: 0.259
Validation loss decreased (-0.237617 --> -0.258794).  Saving model ...
Epoch: 22 cost time: 1.1675488948822021
Epoch: 22, Steps: 10 | Train Loss: 0.454 Vali Loss: 3.022 Vali Acc: 0.252 Test Loss: 3.022 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1645195484161377
Epoch: 23, Steps: 10 | Train Loss: 0.379 Vali Loss: 3.001 Vali Acc: 0.262 Test Loss: 3.001 Test Acc: 0.262
Validation loss decreased (-0.258794 --> -0.262323).  Saving model ...
Epoch: 24 cost time: 1.4628262519836426
Epoch: 24, Steps: 10 | Train Loss: 0.347 Vali Loss: 3.063 Vali Acc: 0.266 Test Loss: 3.063 Test Acc: 0.266
Validation loss decreased (-0.262323 --> -0.265852).  Saving model ...
Epoch: 25 cost time: 1.584707498550415
Epoch: 25, Steps: 10 | Train Loss: 0.273 Vali Loss: 3.017 Vali Acc: 0.276 Test Loss: 3.017 Test Acc: 0.276
Validation loss decreased (-0.265852 --> -0.276440).  Saving model ...
Epoch: 26 cost time: 1.5784878730773926
Epoch: 26, Steps: 10 | Train Loss: 0.256 Vali Loss: 3.105 Vali Acc: 0.279 Test Loss: 3.105 Test Acc: 0.279
Validation loss decreased (-0.276440 --> -0.278792).  Saving model ...
Epoch: 27 cost time: 1.457245111465454
Epoch: 27, Steps: 10 | Train Loss: 0.181 Vali Loss: 3.079 Vali Acc: 0.274 Test Loss: 3.079 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.210763931274414
Epoch: 28, Steps: 10 | Train Loss: 0.176 Vali Loss: 3.097 Vali Acc: 0.278 Test Loss: 3.097 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.3538932800292969
Epoch: 29, Steps: 10 | Train Loss: 0.138 Vali Loss: 3.094 Vali Acc: 0.291 Test Loss: 3.094 Test Acc: 0.291
Validation loss decreased (-0.278792 --> -0.290557).  Saving model ...
Epoch: 30 cost time: 1.4884498119354248
Epoch: 30, Steps: 10 | Train Loss: 0.144 Vali Loss: 3.121 Vali Acc: 0.296 Test Loss: 3.121 Test Acc: 0.296
Validation loss decreased (-0.290557 --> -0.296439).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2964705882352941
model parameter : 236042
model size : 1.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.245038747787476
Epoch: 1, Steps: 10 | Train Loss: 3.307 Vali Loss: 3.290 Vali Acc: 0.049 Test Loss: 3.290 Test Acc: 0.049
Validation loss decreased (inf --> -0.049379).  Saving model ...
Epoch: 2 cost time: 2.4199187755584717
Epoch: 2, Steps: 10 | Train Loss: 3.215 Vali Loss: 3.262 Vali Acc: 0.061 Test Loss: 3.262 Test Acc: 0.061
Validation loss decreased (-0.049379 --> -0.061144).  Saving model ...
Epoch: 3 cost time: 2.4259722232818604
Epoch: 3, Steps: 10 | Train Loss: 3.068 Vali Loss: 3.241 Vali Acc: 0.078 Test Loss: 3.241 Test Acc: 0.078
Validation loss decreased (-0.061144 --> -0.077615).  Saving model ...
Epoch: 4 cost time: 2.512820243835449
Epoch: 4, Steps: 10 | Train Loss: 2.983 Vali Loss: 3.231 Vali Acc: 0.092 Test Loss: 3.231 Test Acc: 0.092
Validation loss decreased (-0.077615 --> -0.091732).  Saving model ...
Epoch: 5 cost time: 2.457858085632324
Epoch: 5, Steps: 10 | Train Loss: 2.880 Vali Loss: 3.212 Vali Acc: 0.106 Test Loss: 3.212 Test Acc: 0.106
Validation loss decreased (-0.091732 --> -0.105850).  Saving model ...
Epoch: 6 cost time: 2.2582240104675293
Epoch: 6, Steps: 10 | Train Loss: 2.738 Vali Loss: 3.191 Vali Acc: 0.114 Test Loss: 3.191 Test Acc: 0.114
Validation loss decreased (-0.105850 --> -0.114086).  Saving model ...
Epoch: 7 cost time: 2.949937343597412
Epoch: 7, Steps: 10 | Train Loss: 2.611 Vali Loss: 3.169 Vali Acc: 0.122 Test Loss: 3.169 Test Acc: 0.122
Validation loss decreased (-0.114086 --> -0.122321).  Saving model ...
Epoch: 8 cost time: 3.134765863418579
Epoch: 8, Steps: 10 | Train Loss: 2.427 Vali Loss: 3.151 Vali Acc: 0.128 Test Loss: 3.151 Test Acc: 0.128
Validation loss decreased (-0.122321 --> -0.128204).  Saving model ...
Epoch: 9 cost time: 3.049751043319702
Epoch: 9, Steps: 10 | Train Loss: 2.306 Vali Loss: 3.116 Vali Acc: 0.152 Test Loss: 3.116 Test Acc: 0.152
Validation loss decreased (-0.128204 --> -0.151734).  Saving model ...
Epoch: 10 cost time: 2.614682674407959
Epoch: 10, Steps: 10 | Train Loss: 2.088 Vali Loss: 3.102 Vali Acc: 0.162 Test Loss: 3.102 Test Acc: 0.162
Validation loss decreased (-0.151734 --> -0.162322).  Saving model ...
Epoch: 11 cost time: 3.0083236694335938
Epoch: 11, Steps: 10 | Train Loss: 1.995 Vali Loss: 3.079 Vali Acc: 0.166 Test Loss: 3.079 Test Acc: 0.166
Validation loss decreased (-0.162322 --> -0.165852).  Saving model ...
Epoch: 12 cost time: 2.9713926315307617
Epoch: 12, Steps: 10 | Train Loss: 1.812 Vali Loss: 3.066 Vali Acc: 0.176 Test Loss: 3.066 Test Acc: 0.176
Validation loss decreased (-0.165852 --> -0.176440).  Saving model ...
Epoch: 13 cost time: 2.756795644760132
Epoch: 13, Steps: 10 | Train Loss: 1.582 Vali Loss: 3.025 Vali Acc: 0.194 Test Loss: 3.025 Test Acc: 0.194
Validation loss decreased (-0.176440 --> -0.194087).  Saving model ...
Epoch: 14 cost time: 2.6643118858337402
Epoch: 14, Steps: 10 | Train Loss: 1.423 Vali Loss: 3.032 Vali Acc: 0.194 Test Loss: 3.032 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.059433937072754
Epoch: 15, Steps: 10 | Train Loss: 1.327 Vali Loss: 3.014 Vali Acc: 0.213 Test Loss: 3.014 Test Acc: 0.213
Validation loss decreased (-0.194087 --> -0.212911).  Saving model ...
Epoch: 16 cost time: 2.171138286590576
Epoch: 16, Steps: 10 | Train Loss: 1.152 Vali Loss: 3.005 Vali Acc: 0.220 Test Loss: 3.005 Test Acc: 0.220
Validation loss decreased (-0.212911 --> -0.219970).  Saving model ...
Epoch: 17 cost time: 2.740983724594116
Epoch: 17, Steps: 10 | Train Loss: 1.015 Vali Loss: 2.990 Vali Acc: 0.209 Test Loss: 2.990 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.563964605331421
Epoch: 18, Steps: 10 | Train Loss: 0.931 Vali Loss: 2.981 Vali Acc: 0.224 Test Loss: 2.981 Test Acc: 0.224
Validation loss decreased (-0.219970 --> -0.223500).  Saving model ...
Epoch: 19 cost time: 2.6450517177581787
Epoch: 19, Steps: 10 | Train Loss: 0.754 Vali Loss: 3.000 Vali Acc: 0.222 Test Loss: 3.000 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.3617746829986572
Epoch: 20, Steps: 10 | Train Loss: 0.621 Vali Loss: 2.949 Vali Acc: 0.251 Test Loss: 2.949 Test Acc: 0.251
Validation loss decreased (-0.223500 --> -0.250559).  Saving model ...
Epoch: 21 cost time: 2.286752700805664
Epoch: 21, Steps: 10 | Train Loss: 0.588 Vali Loss: 3.021 Vali Acc: 0.242 Test Loss: 3.021 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.1502950191497803
Epoch: 22, Steps: 10 | Train Loss: 0.523 Vali Loss: 2.978 Vali Acc: 0.241 Test Loss: 2.978 Test Acc: 0.241
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.9757864475250244
Epoch: 23, Steps: 10 | Train Loss: 0.389 Vali Loss: 2.988 Vali Acc: 0.264 Test Loss: 2.988 Test Acc: 0.264
Validation loss decreased (-0.250559 --> -0.263500).  Saving model ...
Epoch: 24 cost time: 2.7452666759490967
Epoch: 24, Steps: 10 | Train Loss: 0.343 Vali Loss: 2.970 Vali Acc: 0.264 Test Loss: 2.970 Test Acc: 0.264
Validation loss decreased (-0.263500 --> -0.263500).  Saving model ...
Epoch: 25 cost time: 2.8230979442596436
Epoch: 25, Steps: 10 | Train Loss: 0.388 Vali Loss: 3.060 Vali Acc: 0.249 Test Loss: 3.060 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.7481014728546143
Epoch: 26, Steps: 10 | Train Loss: 0.243 Vali Loss: 2.979 Vali Acc: 0.268 Test Loss: 2.979 Test Acc: 0.268
Validation loss decreased (-0.263500 --> -0.268206).  Saving model ...
Epoch: 27 cost time: 2.4003124237060547
Epoch: 27, Steps: 10 | Train Loss: 0.306 Vali Loss: 2.979 Vali Acc: 0.273 Test Loss: 2.979 Test Acc: 0.273
Validation loss decreased (-0.268206 --> -0.272911).  Saving model ...
Epoch: 28 cost time: 1.8331389427185059
Epoch: 28, Steps: 10 | Train Loss: 0.255 Vali Loss: 2.986 Vali Acc: 0.280 Test Loss: 2.986 Test Acc: 0.280
Validation loss decreased (-0.272911 --> -0.279970).  Saving model ...
Epoch: 29 cost time: 2.836583375930786
Epoch: 29, Steps: 10 | Train Loss: 0.191 Vali Loss: 3.016 Vali Acc: 0.275 Test Loss: 3.016 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.082489013671875
Epoch: 30, Steps: 10 | Train Loss: 0.132 Vali Loss: 3.013 Vali Acc: 0.278 Test Loss: 3.013 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28
model parameter : 1204946
model size : 4.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.5675625801086426
Epoch: 1, Steps: 10 | Train Loss: 3.314 Vali Loss: 3.310 Vali Acc: 0.034 Test Loss: 3.310 Test Acc: 0.034
Validation loss decreased (inf --> -0.034085).  Saving model ...
Epoch: 2 cost time: 1.7475695610046387
Epoch: 2, Steps: 10 | Train Loss: 3.209 Vali Loss: 3.290 Vali Acc: 0.041 Test Loss: 3.290 Test Acc: 0.041
Validation loss decreased (-0.034085 --> -0.041144).  Saving model ...
Epoch: 3 cost time: 1.715043067932129
Epoch: 3, Steps: 10 | Train Loss: 3.159 Vali Loss: 3.278 Vali Acc: 0.044 Test Loss: 3.278 Test Acc: 0.044
Validation loss decreased (-0.041144 --> -0.043497).  Saving model ...
Epoch: 4 cost time: 1.6920051574707031
Epoch: 4, Steps: 10 | Train Loss: 3.072 Vali Loss: 3.268 Vali Acc: 0.065 Test Loss: 3.268 Test Acc: 0.065
Validation loss decreased (-0.043497 --> -0.064673).  Saving model ...
Epoch: 5 cost time: 1.9913604259490967
Epoch: 5, Steps: 10 | Train Loss: 3.003 Vali Loss: 3.262 Vali Acc: 0.074 Test Loss: 3.262 Test Acc: 0.074
Validation loss decreased (-0.064673 --> -0.074085).  Saving model ...
Epoch: 6 cost time: 1.7462549209594727
Epoch: 6, Steps: 10 | Train Loss: 2.880 Vali Loss: 3.247 Vali Acc: 0.096 Test Loss: 3.247 Test Acc: 0.096
Validation loss decreased (-0.074085 --> -0.096438).  Saving model ...
Epoch: 7 cost time: 1.5974221229553223
Epoch: 7, Steps: 10 | Train Loss: 2.798 Vali Loss: 3.226 Vali Acc: 0.106 Test Loss: 3.226 Test Acc: 0.106
Validation loss decreased (-0.096438 --> -0.105850).  Saving model ...
Epoch: 8 cost time: 1.9247729778289795
Epoch: 8, Steps: 10 | Train Loss: 2.684 Vali Loss: 3.205 Vali Acc: 0.127 Test Loss: 3.205 Test Acc: 0.127
Validation loss decreased (-0.105850 --> -0.127027).  Saving model ...
Epoch: 9 cost time: 1.9449124336242676
Epoch: 9, Steps: 10 | Train Loss: 2.539 Vali Loss: 3.188 Vali Acc: 0.129 Test Loss: 3.188 Test Acc: 0.129
Validation loss decreased (-0.127027 --> -0.129380).  Saving model ...
Epoch: 10 cost time: 1.9848930835723877
Epoch: 10, Steps: 10 | Train Loss: 2.360 Vali Loss: 3.167 Vali Acc: 0.140 Test Loss: 3.167 Test Acc: 0.140
Validation loss decreased (-0.129380 --> -0.139968).  Saving model ...
Epoch: 11 cost time: 2.0343008041381836
Epoch: 11, Steps: 10 | Train Loss: 2.228 Vali Loss: 3.133 Vali Acc: 0.153 Test Loss: 3.133 Test Acc: 0.153
Validation loss decreased (-0.139968 --> -0.152910).  Saving model ...
Epoch: 12 cost time: 2.117820978164673
Epoch: 12, Steps: 10 | Train Loss: 2.073 Vali Loss: 3.091 Vali Acc: 0.159 Test Loss: 3.091 Test Acc: 0.159
Validation loss decreased (-0.152910 --> -0.158793).  Saving model ...
Epoch: 13 cost time: 1.9980764389038086
Epoch: 13, Steps: 10 | Train Loss: 1.893 Vali Loss: 3.113 Vali Acc: 0.174 Test Loss: 3.113 Test Acc: 0.174
Validation loss decreased (-0.158793 --> -0.174087).  Saving model ...
Epoch: 14 cost time: 2.0518550872802734
Epoch: 14, Steps: 10 | Train Loss: 1.763 Vali Loss: 3.086 Vali Acc: 0.174 Test Loss: 3.086 Test Acc: 0.174
Validation loss decreased (-0.174087 --> -0.174087).  Saving model ...
Epoch: 15 cost time: 1.61594820022583
Epoch: 15, Steps: 10 | Train Loss: 1.625 Vali Loss: 3.060 Vali Acc: 0.173 Test Loss: 3.060 Test Acc: 0.173
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7303016185760498
Epoch: 16, Steps: 10 | Train Loss: 1.538 Vali Loss: 3.041 Vali Acc: 0.198 Test Loss: 3.041 Test Acc: 0.198
Validation loss decreased (-0.174087 --> -0.197617).  Saving model ...
Epoch: 17 cost time: 1.7620429992675781
Epoch: 17, Steps: 10 | Train Loss: 1.344 Vali Loss: 3.098 Vali Acc: 0.198 Test Loss: 3.098 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7495529651641846
Epoch: 18, Steps: 10 | Train Loss: 1.190 Vali Loss: 3.011 Vali Acc: 0.194 Test Loss: 3.011 Test Acc: 0.194
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.59002685546875
Epoch: 19, Steps: 10 | Train Loss: 1.077 Vali Loss: 2.998 Vali Acc: 0.208 Test Loss: 2.998 Test Acc: 0.208
Validation loss decreased (-0.197617 --> -0.208205).  Saving model ...
Epoch: 20 cost time: 1.5967082977294922
Epoch: 20, Steps: 10 | Train Loss: 0.907 Vali Loss: 3.003 Vali Acc: 0.212 Test Loss: 3.003 Test Acc: 0.212
Validation loss decreased (-0.208205 --> -0.211735).  Saving model ...
Epoch: 21 cost time: 1.6013813018798828
Epoch: 21, Steps: 10 | Train Loss: 0.797 Vali Loss: 2.975 Vali Acc: 0.234 Test Loss: 2.975 Test Acc: 0.234
Validation loss decreased (-0.211735 --> -0.234088).  Saving model ...
Epoch: 22 cost time: 1.594282627105713
Epoch: 22, Steps: 10 | Train Loss: 0.696 Vali Loss: 2.989 Vali Acc: 0.229 Test Loss: 2.989 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.8466553688049316
Epoch: 23, Steps: 10 | Train Loss: 0.625 Vali Loss: 2.977 Vali Acc: 0.233 Test Loss: 2.977 Test Acc: 0.233
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.182107448577881
Epoch: 24, Steps: 10 | Train Loss: 0.573 Vali Loss: 3.011 Vali Acc: 0.255 Test Loss: 3.011 Test Acc: 0.255
Validation loss decreased (-0.234088 --> -0.255264).  Saving model ...
Epoch: 25 cost time: 2.007504940032959
Epoch: 25, Steps: 10 | Train Loss: 0.526 Vali Loss: 2.985 Vali Acc: 0.245 Test Loss: 2.985 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.9388923645019531
Epoch: 26, Steps: 10 | Train Loss: 0.440 Vali Loss: 2.992 Vali Acc: 0.261 Test Loss: 2.992 Test Acc: 0.261
Validation loss decreased (-0.255264 --> -0.261147).  Saving model ...
Epoch: 27 cost time: 1.988750696182251
Epoch: 27, Steps: 10 | Train Loss: 0.380 Vali Loss: 3.010 Vali Acc: 0.264 Test Loss: 3.010 Test Acc: 0.264
Validation loss decreased (-0.261147 --> -0.263499).  Saving model ...
Epoch: 28 cost time: 1.9560375213623047
Epoch: 28, Steps: 10 | Train Loss: 0.330 Vali Loss: 3.054 Vali Acc: 0.262 Test Loss: 3.054 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.0006864070892334
Epoch: 29, Steps: 10 | Train Loss: 0.312 Vali Loss: 3.014 Vali Acc: 0.259 Test Loss: 3.014 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.7204935550689697
Epoch: 30, Steps: 10 | Train Loss: 0.258 Vali Loss: 2.986 Vali Acc: 0.272 Test Loss: 2.986 Test Acc: 0.272
Validation loss decreased (-0.263499 --> -0.271735).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27176470588235296
model parameter : 376978
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.8824944496154785
Epoch: 1, Steps: 10 | Train Loss: 3.308 Vali Loss: 3.289 Vali Acc: 0.053 Test Loss: 3.289 Test Acc: 0.053
Validation loss decreased (inf --> -0.052908).  Saving model ...
Epoch: 2 cost time: 1.9379463195800781
Epoch: 2, Steps: 10 | Train Loss: 3.204 Vali Loss: 3.264 Vali Acc: 0.059 Test Loss: 3.264 Test Acc: 0.059
Validation loss decreased (-0.052908 --> -0.058791).  Saving model ...
Epoch: 3 cost time: 2.032757043838501
Epoch: 3, Steps: 10 | Train Loss: 3.067 Vali Loss: 3.249 Vali Acc: 0.074 Test Loss: 3.249 Test Acc: 0.074
Validation loss decreased (-0.058791 --> -0.074085).  Saving model ...
Epoch: 4 cost time: 2.166285753250122
Epoch: 4, Steps: 10 | Train Loss: 3.007 Vali Loss: 3.243 Vali Acc: 0.086 Test Loss: 3.243 Test Acc: 0.086
Validation loss decreased (-0.074085 --> -0.085850).  Saving model ...
Epoch: 5 cost time: 1.9394726753234863
Epoch: 5, Steps: 10 | Train Loss: 2.908 Vali Loss: 3.228 Vali Acc: 0.086 Test Loss: 3.228 Test Acc: 0.086
Validation loss decreased (-0.085850 --> -0.085850).  Saving model ...
Epoch: 6 cost time: 1.7663280963897705
Epoch: 6, Steps: 10 | Train Loss: 2.807 Vali Loss: 3.208 Vali Acc: 0.102 Test Loss: 3.208 Test Acc: 0.102
Validation loss decreased (-0.085850 --> -0.102321).  Saving model ...
Epoch: 7 cost time: 1.7200539112091064
Epoch: 7, Steps: 10 | Train Loss: 2.655 Vali Loss: 3.187 Vali Acc: 0.118 Test Loss: 3.187 Test Acc: 0.118
Validation loss decreased (-0.102321 --> -0.117615).  Saving model ...
Epoch: 8 cost time: 1.995389461517334
Epoch: 8, Steps: 10 | Train Loss: 2.525 Vali Loss: 3.167 Vali Acc: 0.132 Test Loss: 3.167 Test Acc: 0.132
Validation loss decreased (-0.117615 --> -0.131733).  Saving model ...
Epoch: 9 cost time: 2.097811460494995
Epoch: 9, Steps: 10 | Train Loss: 2.399 Vali Loss: 3.142 Vali Acc: 0.138 Test Loss: 3.142 Test Acc: 0.138
Validation loss decreased (-0.131733 --> -0.137616).  Saving model ...
Epoch: 10 cost time: 2.0976948738098145
Epoch: 10, Steps: 10 | Train Loss: 2.240 Vali Loss: 3.135 Vali Acc: 0.152 Test Loss: 3.135 Test Acc: 0.152
Validation loss decreased (-0.137616 --> -0.151733).  Saving model ...
Epoch: 11 cost time: 2.0859196186065674
Epoch: 11, Steps: 10 | Train Loss: 2.109 Vali Loss: 3.118 Vali Acc: 0.159 Test Loss: 3.118 Test Acc: 0.159
Validation loss decreased (-0.151733 --> -0.158792).  Saving model ...
Epoch: 12 cost time: 2.0421812534332275
Epoch: 12, Steps: 10 | Train Loss: 2.004 Vali Loss: 3.098 Vali Acc: 0.169 Test Loss: 3.098 Test Acc: 0.169
Validation loss decreased (-0.158792 --> -0.169381).  Saving model ...
Epoch: 13 cost time: 2.1177659034729004
Epoch: 13, Steps: 10 | Train Loss: 1.757 Vali Loss: 3.081 Vali Acc: 0.179 Test Loss: 3.081 Test Acc: 0.179
Validation loss decreased (-0.169381 --> -0.178793).  Saving model ...
Epoch: 14 cost time: 2.1593191623687744
Epoch: 14, Steps: 10 | Train Loss: 1.604 Vali Loss: 3.048 Vali Acc: 0.196 Test Loss: 3.048 Test Acc: 0.196
Validation loss decreased (-0.178793 --> -0.196440).  Saving model ...
Epoch: 15 cost time: 1.7519540786743164
Epoch: 15, Steps: 10 | Train Loss: 1.448 Vali Loss: 3.025 Vali Acc: 0.206 Test Loss: 3.025 Test Acc: 0.206
Validation loss decreased (-0.196440 --> -0.205852).  Saving model ...
Epoch: 16 cost time: 1.8664298057556152
Epoch: 16, Steps: 10 | Train Loss: 1.320 Vali Loss: 3.025 Vali Acc: 0.221 Test Loss: 3.025 Test Acc: 0.221
Validation loss decreased (-0.205852 --> -0.221146).  Saving model ...
Epoch: 17 cost time: 1.8919637203216553
Epoch: 17, Steps: 10 | Train Loss: 1.198 Vali Loss: 2.999 Vali Acc: 0.212 Test Loss: 2.999 Test Acc: 0.212
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7824480533599854
Epoch: 18, Steps: 10 | Train Loss: 1.058 Vali Loss: 2.995 Vali Acc: 0.233 Test Loss: 2.995 Test Acc: 0.233
Validation loss decreased (-0.221146 --> -0.232911).  Saving model ...
Epoch: 19 cost time: 2.0353899002075195
Epoch: 19, Steps: 10 | Train Loss: 0.940 Vali Loss: 2.990 Vali Acc: 0.238 Test Loss: 2.990 Test Acc: 0.238
Validation loss decreased (-0.232911 --> -0.237617).  Saving model ...
Epoch: 20 cost time: 1.9165303707122803
Epoch: 20, Steps: 10 | Train Loss: 0.849 Vali Loss: 2.981 Vali Acc: 0.241 Test Loss: 2.981 Test Acc: 0.241
Validation loss decreased (-0.237617 --> -0.241147).  Saving model ...
Epoch: 21 cost time: 1.6808092594146729
Epoch: 21, Steps: 10 | Train Loss: 0.739 Vali Loss: 2.972 Vali Acc: 0.251 Test Loss: 2.972 Test Acc: 0.251
Validation loss decreased (-0.241147 --> -0.250559).  Saving model ...
Epoch: 22 cost time: 1.8866987228393555
Epoch: 22, Steps: 10 | Train Loss: 0.621 Vali Loss: 2.953 Vali Acc: 0.259 Test Loss: 2.953 Test Acc: 0.259
Validation loss decreased (-0.250559 --> -0.258794).  Saving model ...
Epoch: 23 cost time: 1.60722017288208
Epoch: 23, Steps: 10 | Train Loss: 0.562 Vali Loss: 2.936 Vali Acc: 0.269 Test Loss: 2.936 Test Acc: 0.269
Validation loss decreased (-0.258794 --> -0.269382).  Saving model ...
Epoch: 24 cost time: 2.1134135723114014
Epoch: 24, Steps: 10 | Train Loss: 0.455 Vali Loss: 2.915 Vali Acc: 0.267 Test Loss: 2.915 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.131870985031128
Epoch: 25, Steps: 10 | Train Loss: 0.386 Vali Loss: 2.980 Vali Acc: 0.279 Test Loss: 2.980 Test Acc: 0.279
Validation loss decreased (-0.269382 --> -0.278794).  Saving model ...
Epoch: 26 cost time: 2.2130770683288574
Epoch: 26, Steps: 10 | Train Loss: 0.335 Vali Loss: 2.957 Vali Acc: 0.274 Test Loss: 2.957 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.163085699081421
Epoch: 27, Steps: 10 | Train Loss: 0.335 Vali Loss: 2.965 Vali Acc: 0.286 Test Loss: 2.965 Test Acc: 0.286
Validation loss decreased (-0.278794 --> -0.285853).  Saving model ...
Epoch: 28 cost time: 2.2411794662475586
Epoch: 28, Steps: 10 | Train Loss: 0.262 Vali Loss: 2.938 Vali Acc: 0.296 Test Loss: 2.938 Test Acc: 0.296
Validation loss decreased (-0.285853 --> -0.296441).  Saving model ...
Epoch: 29 cost time: 1.8350012302398682
Epoch: 29, Steps: 10 | Train Loss: 0.209 Vali Loss: 2.941 Vali Acc: 0.296 Test Loss: 2.941 Test Acc: 0.296
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.9400286674499512
Epoch: 30, Steps: 10 | Train Loss: 0.216 Vali Loss: 2.972 Vali Acc: 0.285 Test Loss: 2.972 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2964705882352941
model parameter : 1204946
model size : 4.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.06573486328125
Epoch: 1, Steps: 10 | Train Loss: 3.317 Vali Loss: 3.305 Vali Acc: 0.027 Test Loss: 3.305 Test Acc: 0.027
Validation loss decreased (inf --> -0.027026).  Saving model ...
Epoch: 2 cost time: 1.447950839996338
Epoch: 2, Steps: 10 | Train Loss: 3.202 Vali Loss: 3.285 Vali Acc: 0.034 Test Loss: 3.285 Test Acc: 0.034
Validation loss decreased (-0.027026 --> -0.034085).  Saving model ...
Epoch: 3 cost time: 1.4008617401123047
Epoch: 3, Steps: 10 | Train Loss: 3.165 Vali Loss: 3.271 Vali Acc: 0.053 Test Loss: 3.271 Test Acc: 0.053
Validation loss decreased (-0.034085 --> -0.052908).  Saving model ...
Epoch: 4 cost time: 1.351208209991455
Epoch: 4, Steps: 10 | Train Loss: 3.058 Vali Loss: 3.263 Vali Acc: 0.066 Test Loss: 3.263 Test Acc: 0.066
Validation loss decreased (-0.052908 --> -0.065850).  Saving model ...
Epoch: 5 cost time: 1.7632551193237305
Epoch: 5, Steps: 10 | Train Loss: 2.983 Vali Loss: 3.256 Vali Acc: 0.076 Test Loss: 3.256 Test Acc: 0.076
Validation loss decreased (-0.065850 --> -0.076438).  Saving model ...
Epoch: 6 cost time: 1.6492366790771484
Epoch: 6, Steps: 10 | Train Loss: 2.868 Vali Loss: 3.239 Vali Acc: 0.096 Test Loss: 3.239 Test Acc: 0.096
Validation loss decreased (-0.076438 --> -0.096438).  Saving model ...
Epoch: 7 cost time: 1.944990873336792
Epoch: 7, Steps: 10 | Train Loss: 2.784 Vali Loss: 3.213 Vali Acc: 0.108 Test Loss: 3.213 Test Acc: 0.108
Validation loss decreased (-0.096438 --> -0.108203).  Saving model ...
Epoch: 8 cost time: 1.5154249668121338
Epoch: 8, Steps: 10 | Train Loss: 2.660 Vali Loss: 3.192 Vali Acc: 0.121 Test Loss: 3.192 Test Acc: 0.121
Validation loss decreased (-0.108203 --> -0.121145).  Saving model ...
Epoch: 9 cost time: 1.907026767730713
Epoch: 9, Steps: 10 | Train Loss: 2.502 Vali Loss: 3.175 Vali Acc: 0.127 Test Loss: 3.175 Test Acc: 0.127
Validation loss decreased (-0.121145 --> -0.127027).  Saving model ...
Epoch: 10 cost time: 1.7284739017486572
Epoch: 10, Steps: 10 | Train Loss: 2.358 Vali Loss: 3.158 Vali Acc: 0.146 Test Loss: 3.158 Test Acc: 0.146
Validation loss decreased (-0.127027 --> -0.145851).  Saving model ...
Epoch: 11 cost time: 1.5488018989562988
Epoch: 11, Steps: 10 | Train Loss: 2.272 Vali Loss: 3.125 Vali Acc: 0.153 Test Loss: 3.125 Test Acc: 0.153
Validation loss decreased (-0.145851 --> -0.152910).  Saving model ...
Epoch: 12 cost time: 1.8158586025238037
Epoch: 12, Steps: 10 | Train Loss: 2.081 Vali Loss: 3.088 Vali Acc: 0.153 Test Loss: 3.088 Test Acc: 0.153
Validation loss decreased (-0.152910 --> -0.152910).  Saving model ...
Epoch: 13 cost time: 1.3851895332336426
Epoch: 13, Steps: 10 | Train Loss: 1.904 Vali Loss: 3.077 Vali Acc: 0.169 Test Loss: 3.077 Test Acc: 0.169
Validation loss decreased (-0.152910 --> -0.169381).  Saving model ...
Epoch: 14 cost time: 1.4485516548156738
Epoch: 14, Steps: 10 | Train Loss: 1.788 Vali Loss: 3.056 Vali Acc: 0.193 Test Loss: 3.056 Test Acc: 0.193
Validation loss decreased (-0.169381 --> -0.192911).  Saving model ...
Epoch: 15 cost time: 1.5154199600219727
Epoch: 15, Steps: 10 | Train Loss: 1.647 Vali Loss: 3.024 Vali Acc: 0.192 Test Loss: 3.024 Test Acc: 0.192
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6350059509277344
Epoch: 16, Steps: 10 | Train Loss: 1.526 Vali Loss: 3.011 Vali Acc: 0.186 Test Loss: 3.011 Test Acc: 0.186
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.6136174201965332
Epoch: 17, Steps: 10 | Train Loss: 1.356 Vali Loss: 3.111 Vali Acc: 0.193 Test Loss: 3.111 Test Acc: 0.193
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.5671582221984863
Epoch: 18, Steps: 10 | Train Loss: 1.284 Vali Loss: 3.044 Vali Acc: 0.206 Test Loss: 3.044 Test Acc: 0.206
Validation loss decreased (-0.192911 --> -0.205852).  Saving model ...
Epoch: 19 cost time: 1.4095878601074219
Epoch: 19, Steps: 10 | Train Loss: 1.154 Vali Loss: 3.009 Vali Acc: 0.212 Test Loss: 3.009 Test Acc: 0.212
Validation loss decreased (-0.205852 --> -0.211735).  Saving model ...
Epoch: 20 cost time: 1.6058974266052246
Epoch: 20, Steps: 10 | Train Loss: 0.943 Vali Loss: 2.980 Vali Acc: 0.221 Test Loss: 2.980 Test Acc: 0.221
Validation loss decreased (-0.211735 --> -0.221147).  Saving model ...
Epoch: 21 cost time: 1.5473551750183105
Epoch: 21, Steps: 10 | Train Loss: 0.919 Vali Loss: 3.006 Vali Acc: 0.224 Test Loss: 3.006 Test Acc: 0.224
Validation loss decreased (-0.221147 --> -0.223499).  Saving model ...
Epoch: 22 cost time: 0.8899176120758057
Epoch: 22, Steps: 10 | Train Loss: 0.761 Vali Loss: 2.991 Vali Acc: 0.229 Test Loss: 2.991 Test Acc: 0.229
Validation loss decreased (-0.223499 --> -0.229382).  Saving model ...
Epoch: 23 cost time: 1.5070910453796387
Epoch: 23, Steps: 10 | Train Loss: 0.650 Vali Loss: 2.965 Vali Acc: 0.245 Test Loss: 2.965 Test Acc: 0.245
Validation loss decreased (-0.229382 --> -0.244676).  Saving model ...
Epoch: 24 cost time: 1.5338609218597412
Epoch: 24, Steps: 10 | Train Loss: 0.543 Vali Loss: 3.010 Vali Acc: 0.252 Test Loss: 3.010 Test Acc: 0.252
Validation loss decreased (-0.244676 --> -0.251735).  Saving model ...
Epoch: 25 cost time: 1.5453262329101562
Epoch: 25, Steps: 10 | Train Loss: 0.482 Vali Loss: 2.980 Vali Acc: 0.256 Test Loss: 2.980 Test Acc: 0.256
Validation loss decreased (-0.251735 --> -0.256441).  Saving model ...
Epoch: 26 cost time: 1.4619245529174805
Epoch: 26, Steps: 10 | Train Loss: 0.498 Vali Loss: 2.976 Vali Acc: 0.261 Test Loss: 2.976 Test Acc: 0.261
Validation loss decreased (-0.256441 --> -0.261147).  Saving model ...
Epoch: 27 cost time: 1.4961426258087158
Epoch: 27, Steps: 10 | Train Loss: 0.555 Vali Loss: 2.981 Vali Acc: 0.262 Test Loss: 2.981 Test Acc: 0.262
Validation loss decreased (-0.261147 --> -0.262323).  Saving model ...
Epoch: 28 cost time: 1.5495717525482178
Epoch: 28, Steps: 10 | Train Loss: 0.405 Vali Loss: 2.999 Vali Acc: 0.279 Test Loss: 2.999 Test Acc: 0.279
Validation loss decreased (-0.262323 --> -0.278794).  Saving model ...
Epoch: 29 cost time: 1.601257085800171
Epoch: 29, Steps: 10 | Train Loss: 0.334 Vali Loss: 3.016 Vali Acc: 0.288 Test Loss: 3.016 Test Acc: 0.288
Validation loss decreased (-0.278794 --> -0.288205).  Saving model ...
Epoch: 30 cost time: 1.6407973766326904
Epoch: 30, Steps: 10 | Train Loss: 0.233 Vali Loss: 3.019 Vali Acc: 0.272 Test Loss: 3.019 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28823529411764703
model parameter : 376978
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.1158688068389893
Epoch: 1, Steps: 10 | Train Loss: 3.296 Vali Loss: 3.285 Vali Acc: 0.055 Test Loss: 3.285 Test Acc: 0.055
Validation loss decreased (inf --> -0.055261).  Saving model ...
Epoch: 2 cost time: 1.3690614700317383
Epoch: 2, Steps: 10 | Train Loss: 3.212 Vali Loss: 3.264 Vali Acc: 0.059 Test Loss: 3.264 Test Acc: 0.059
Validation loss decreased (-0.055261 --> -0.058791).  Saving model ...
Epoch: 3 cost time: 1.4348478317260742
Epoch: 3, Steps: 10 | Train Loss: 3.076 Vali Loss: 3.246 Vali Acc: 0.073 Test Loss: 3.246 Test Acc: 0.073
Validation loss decreased (-0.058791 --> -0.072909).  Saving model ...
Epoch: 4 cost time: 1.4473190307617188
Epoch: 4, Steps: 10 | Train Loss: 3.009 Vali Loss: 3.240 Vali Acc: 0.087 Test Loss: 3.240 Test Acc: 0.087
Validation loss decreased (-0.072909 --> -0.087026).  Saving model ...
Epoch: 5 cost time: 1.3820686340332031
Epoch: 5, Steps: 10 | Train Loss: 2.933 Vali Loss: 3.233 Vali Acc: 0.096 Test Loss: 3.233 Test Acc: 0.096
Validation loss decreased (-0.087026 --> -0.096438).  Saving model ...
Epoch: 6 cost time: 1.5084452629089355
Epoch: 6, Steps: 10 | Train Loss: 2.812 Vali Loss: 3.220 Vali Acc: 0.105 Test Loss: 3.220 Test Acc: 0.105
Validation loss decreased (-0.096438 --> -0.104674).  Saving model ...
Epoch: 7 cost time: 1.5806455612182617
Epoch: 7, Steps: 10 | Train Loss: 2.743 Vali Loss: 3.199 Vali Acc: 0.105 Test Loss: 3.199 Test Acc: 0.105
Validation loss decreased (-0.104674 --> -0.104674).  Saving model ...
Epoch: 8 cost time: 1.3526453971862793
Epoch: 8, Steps: 10 | Train Loss: 2.600 Vali Loss: 3.187 Vali Acc: 0.108 Test Loss: 3.187 Test Acc: 0.108
Validation loss decreased (-0.104674 --> -0.108203).  Saving model ...
Epoch: 9 cost time: 1.258840799331665
Epoch: 9, Steps: 10 | Train Loss: 2.495 Vali Loss: 3.168 Vali Acc: 0.120 Test Loss: 3.168 Test Acc: 0.120
Validation loss decreased (-0.108203 --> -0.119968).  Saving model ...
Epoch: 10 cost time: 1.2951548099517822
Epoch: 10, Steps: 10 | Train Loss: 2.370 Vali Loss: 3.176 Vali Acc: 0.126 Test Loss: 3.176 Test Acc: 0.126
Validation loss decreased (-0.119968 --> -0.125851).  Saving model ...
Epoch: 11 cost time: 1.3563287258148193
Epoch: 11, Steps: 10 | Train Loss: 2.216 Vali Loss: 3.162 Vali Acc: 0.139 Test Loss: 3.162 Test Acc: 0.139
Validation loss decreased (-0.125851 --> -0.138792).  Saving model ...
Epoch: 12 cost time: 1.4346082210540771
Epoch: 12, Steps: 10 | Train Loss: 2.112 Vali Loss: 3.141 Vali Acc: 0.142 Test Loss: 3.141 Test Acc: 0.142
Validation loss decreased (-0.138792 --> -0.142322).  Saving model ...
Epoch: 13 cost time: 1.3371047973632812
Epoch: 13, Steps: 10 | Train Loss: 1.977 Vali Loss: 3.131 Vali Acc: 0.153 Test Loss: 3.131 Test Acc: 0.153
Validation loss decreased (-0.142322 --> -0.152910).  Saving model ...
Epoch: 14 cost time: 1.3006997108459473
Epoch: 14, Steps: 10 | Train Loss: 1.791 Vali Loss: 3.111 Vali Acc: 0.169 Test Loss: 3.111 Test Acc: 0.169
Validation loss decreased (-0.152910 --> -0.169381).  Saving model ...
Epoch: 15 cost time: 1.2464675903320312
Epoch: 15, Steps: 10 | Train Loss: 1.681 Vali Loss: 3.105 Vali Acc: 0.180 Test Loss: 3.105 Test Acc: 0.180
Validation loss decreased (-0.169381 --> -0.179969).  Saving model ...
Epoch: 16 cost time: 1.260075330734253
Epoch: 16, Steps: 10 | Train Loss: 1.599 Vali Loss: 3.078 Vali Acc: 0.193 Test Loss: 3.078 Test Acc: 0.193
Validation loss decreased (-0.179969 --> -0.192910).  Saving model ...
Epoch: 17 cost time: 1.3662395477294922
Epoch: 17, Steps: 10 | Train Loss: 1.459 Vali Loss: 3.072 Vali Acc: 0.208 Test Loss: 3.072 Test Acc: 0.208
Validation loss decreased (-0.192910 --> -0.208205).  Saving model ...
Epoch: 18 cost time: 1.7292678356170654
Epoch: 18, Steps: 10 | Train Loss: 1.307 Vali Loss: 3.074 Vali Acc: 0.206 Test Loss: 3.074 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3703391551971436
Epoch: 19, Steps: 10 | Train Loss: 1.115 Vali Loss: 3.057 Vali Acc: 0.228 Test Loss: 3.057 Test Acc: 0.228
Validation loss decreased (-0.208205 --> -0.228205).  Saving model ...
Epoch: 20 cost time: 1.7049410343170166
Epoch: 20, Steps: 10 | Train Loss: 1.089 Vali Loss: 3.039 Vali Acc: 0.229 Test Loss: 3.039 Test Acc: 0.229
Validation loss decreased (-0.228205 --> -0.229381).  Saving model ...
Epoch: 21 cost time: 1.3463215827941895
Epoch: 21, Steps: 10 | Train Loss: 1.050 Vali Loss: 3.042 Vali Acc: 0.233 Test Loss: 3.042 Test Acc: 0.233
Validation loss decreased (-0.229381 --> -0.232911).  Saving model ...
Epoch: 22 cost time: 1.776827335357666
Epoch: 22, Steps: 10 | Train Loss: 0.841 Vali Loss: 3.045 Vali Acc: 0.238 Test Loss: 3.045 Test Acc: 0.238
Validation loss decreased (-0.232911 --> -0.237617).  Saving model ...
Epoch: 23 cost time: 1.3001089096069336
Epoch: 23, Steps: 10 | Train Loss: 0.820 Vali Loss: 3.032 Vali Acc: 0.252 Test Loss: 3.032 Test Acc: 0.252
Validation loss decreased (-0.237617 --> -0.251734).  Saving model ...
Epoch: 24 cost time: 1.6938540935516357
Epoch: 24, Steps: 10 | Train Loss: 0.743 Vali Loss: 3.001 Vali Acc: 0.262 Test Loss: 3.001 Test Acc: 0.262
Validation loss decreased (-0.251734 --> -0.262323).  Saving model ...
Epoch: 25 cost time: 1.6207640171051025
Epoch: 25, Steps: 10 | Train Loss: 0.804 Vali Loss: 3.090 Vali Acc: 0.254 Test Loss: 3.090 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.6775310039520264
Epoch: 26, Steps: 10 | Train Loss: 0.540 Vali Loss: 3.008 Vali Acc: 0.271 Test Loss: 3.008 Test Acc: 0.271
Validation loss decreased (-0.262323 --> -0.270558).  Saving model ...
Epoch: 27 cost time: 1.425489902496338
Epoch: 27, Steps: 10 | Train Loss: 0.519 Vali Loss: 3.046 Vali Acc: 0.274 Test Loss: 3.046 Test Acc: 0.274
Validation loss decreased (-0.270558 --> -0.274087).  Saving model ...
Epoch: 28 cost time: 1.3550269603729248
Epoch: 28, Steps: 10 | Train Loss: 0.521 Vali Loss: 3.047 Vali Acc: 0.281 Test Loss: 3.047 Test Acc: 0.281
Validation loss decreased (-0.274087 --> -0.281146).  Saving model ...
Epoch: 29 cost time: 1.682246208190918
Epoch: 29, Steps: 10 | Train Loss: 0.408 Vali Loss: 3.081 Vali Acc: 0.260 Test Loss: 3.081 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.5091254711151123
Epoch: 30, Steps: 10 | Train Loss: 0.501 Vali Loss: 3.027 Vali Acc: 0.286 Test Loss: 3.027 Test Acc: 0.286
Validation loss decreased (-0.281146 --> -0.285852).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2858823529411765
model parameter : 1204946
model size : 4.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.907135486602783
Epoch: 1, Steps: 10 | Train Loss: 3.326 Vali Loss: 3.312 Vali Acc: 0.026 Test Loss: 3.312 Test Acc: 0.026
Validation loss decreased (inf --> -0.025849).  Saving model ...
Epoch: 2 cost time: 1.1970243453979492
Epoch: 2, Steps: 10 | Train Loss: 3.210 Vali Loss: 3.293 Vali Acc: 0.039 Test Loss: 3.293 Test Acc: 0.039
Validation loss decreased (-0.025849 --> -0.038791).  Saving model ...
Epoch: 3 cost time: 1.1175453662872314
Epoch: 3, Steps: 10 | Train Loss: 3.182 Vali Loss: 3.281 Vali Acc: 0.049 Test Loss: 3.281 Test Acc: 0.049
Validation loss decreased (-0.038791 --> -0.049379).  Saving model ...
Epoch: 4 cost time: 1.1844844818115234
Epoch: 4, Steps: 10 | Train Loss: 3.099 Vali Loss: 3.274 Vali Acc: 0.062 Test Loss: 3.274 Test Acc: 0.062
Validation loss decreased (-0.049379 --> -0.062320).  Saving model ...
Epoch: 5 cost time: 1.118415355682373
Epoch: 5, Steps: 10 | Train Loss: 3.044 Vali Loss: 3.271 Vali Acc: 0.079 Test Loss: 3.271 Test Acc: 0.079
Validation loss decreased (-0.062320 --> -0.078791).  Saving model ...
Epoch: 6 cost time: 1.0828771591186523
Epoch: 6, Steps: 10 | Train Loss: 2.935 Vali Loss: 3.257 Vali Acc: 0.089 Test Loss: 3.257 Test Acc: 0.089
Validation loss decreased (-0.078791 --> -0.089379).  Saving model ...
Epoch: 7 cost time: 1.0740330219268799
Epoch: 7, Steps: 10 | Train Loss: 2.865 Vali Loss: 3.237 Vali Acc: 0.112 Test Loss: 3.237 Test Acc: 0.112
Validation loss decreased (-0.089379 --> -0.111732).  Saving model ...
Epoch: 8 cost time: 1.3635940551757812
Epoch: 8, Steps: 10 | Train Loss: 2.788 Vali Loss: 3.218 Vali Acc: 0.119 Test Loss: 3.218 Test Acc: 0.119
Validation loss decreased (-0.111732 --> -0.118791).  Saving model ...
Epoch: 9 cost time: 1.4947497844696045
Epoch: 9, Steps: 10 | Train Loss: 2.662 Vali Loss: 3.198 Vali Acc: 0.126 Test Loss: 3.198 Test Acc: 0.126
Validation loss decreased (-0.118791 --> -0.125850).  Saving model ...
Epoch: 10 cost time: 1.3191030025482178
Epoch: 10, Steps: 10 | Train Loss: 2.552 Vali Loss: 3.185 Vali Acc: 0.139 Test Loss: 3.185 Test Acc: 0.139
Validation loss decreased (-0.125850 --> -0.138792).  Saving model ...
Epoch: 11 cost time: 1.1392951011657715
Epoch: 11, Steps: 10 | Train Loss: 2.429 Vali Loss: 3.160 Vali Acc: 0.155 Test Loss: 3.160 Test Acc: 0.155
Validation loss decreased (-0.138792 --> -0.155263).  Saving model ...
Epoch: 12 cost time: 1.2036733627319336
Epoch: 12, Steps: 10 | Train Loss: 2.316 Vali Loss: 3.140 Vali Acc: 0.156 Test Loss: 3.140 Test Acc: 0.156
Validation loss decreased (-0.155263 --> -0.156439).  Saving model ...
Epoch: 13 cost time: 1.1607940196990967
Epoch: 13, Steps: 10 | Train Loss: 2.172 Vali Loss: 3.127 Vali Acc: 0.168 Test Loss: 3.127 Test Acc: 0.168
Validation loss decreased (-0.156439 --> -0.168204).  Saving model ...
Epoch: 14 cost time: 1.1637725830078125
Epoch: 14, Steps: 10 | Train Loss: 2.068 Vali Loss: 3.109 Vali Acc: 0.188 Test Loss: 3.109 Test Acc: 0.188
Validation loss decreased (-0.168204 --> -0.188204).  Saving model ...
Epoch: 15 cost time: 1.2663276195526123
Epoch: 15, Steps: 10 | Train Loss: 1.892 Vali Loss: 3.084 Vali Acc: 0.184 Test Loss: 3.084 Test Acc: 0.184
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.350426197052002
Epoch: 16, Steps: 10 | Train Loss: 1.830 Vali Loss: 3.066 Vali Acc: 0.185 Test Loss: 3.066 Test Acc: 0.185
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3083539009094238
Epoch: 17, Steps: 10 | Train Loss: 1.650 Vali Loss: 3.094 Vali Acc: 0.189 Test Loss: 3.094 Test Acc: 0.189
Validation loss decreased (-0.188204 --> -0.189381).  Saving model ...
Epoch: 18 cost time: 0.8451385498046875
Epoch: 18, Steps: 10 | Train Loss: 1.567 Vali Loss: 3.046 Vali Acc: 0.200 Test Loss: 3.046 Test Acc: 0.200
Validation loss decreased (-0.189381 --> -0.199970).  Saving model ...
Epoch: 19 cost time: 1.0810563564300537
Epoch: 19, Steps: 10 | Train Loss: 1.412 Vali Loss: 3.036 Vali Acc: 0.195 Test Loss: 3.036 Test Acc: 0.195
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2595055103302002
Epoch: 20, Steps: 10 | Train Loss: 1.269 Vali Loss: 3.009 Vali Acc: 0.211 Test Loss: 3.009 Test Acc: 0.211
Validation loss decreased (-0.199970 --> -0.210558).  Saving model ...
Epoch: 21 cost time: 1.0718507766723633
Epoch: 21, Steps: 10 | Train Loss: 1.147 Vali Loss: 3.026 Vali Acc: 0.228 Test Loss: 3.026 Test Acc: 0.228
Validation loss decreased (-0.210558 --> -0.228205).  Saving model ...
Epoch: 22 cost time: 1.166231632232666
Epoch: 22, Steps: 10 | Train Loss: 1.010 Vali Loss: 3.021 Vali Acc: 0.235 Test Loss: 3.021 Test Acc: 0.235
Validation loss decreased (-0.228205 --> -0.235264).  Saving model ...
Epoch: 23 cost time: 1.2980544567108154
Epoch: 23, Steps: 10 | Train Loss: 1.005 Vali Loss: 3.022 Vali Acc: 0.239 Test Loss: 3.022 Test Acc: 0.239
Validation loss decreased (-0.235264 --> -0.238793).  Saving model ...
Epoch: 24 cost time: 1.1280620098114014
Epoch: 24, Steps: 10 | Train Loss: 0.999 Vali Loss: 3.000 Vali Acc: 0.234 Test Loss: 3.000 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.182650089263916
Epoch: 25, Steps: 10 | Train Loss: 0.856 Vali Loss: 2.975 Vali Acc: 0.255 Test Loss: 2.975 Test Acc: 0.255
Validation loss decreased (-0.238793 --> -0.255264).  Saving model ...
Epoch: 26 cost time: 1.1440658569335938
Epoch: 26, Steps: 10 | Train Loss: 0.755 Vali Loss: 3.042 Vali Acc: 0.252 Test Loss: 3.042 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1594886779785156
Epoch: 27, Steps: 10 | Train Loss: 0.665 Vali Loss: 3.009 Vali Acc: 0.267 Test Loss: 3.009 Test Acc: 0.267
Validation loss decreased (-0.255264 --> -0.267029).  Saving model ...
Epoch: 28 cost time: 1.0662758350372314
Epoch: 28, Steps: 10 | Train Loss: 0.591 Vali Loss: 3.030 Vali Acc: 0.264 Test Loss: 3.030 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0597481727600098
Epoch: 29, Steps: 10 | Train Loss: 0.587 Vali Loss: 3.018 Vali Acc: 0.266 Test Loss: 3.018 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.1334493160247803
Epoch: 30, Steps: 10 | Train Loss: 0.537 Vali Loss: 2.986 Vali Acc: 0.276 Test Loss: 2.986 Test Acc: 0.276
Validation loss decreased (-0.267029 --> -0.276441).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27647058823529413
model parameter : 376978
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.15123176574707
Epoch: 1, Steps: 10 | Train Loss: 3.341 Vali Loss: 3.283 Vali Acc: 0.038 Test Loss: 3.283 Test Acc: 0.038
Validation loss decreased (inf --> -0.037614).  Saving model ...
Epoch: 2 cost time: 2.4544365406036377
Epoch: 2, Steps: 10 | Train Loss: 3.253 Vali Loss: 3.269 Vali Acc: 0.047 Test Loss: 3.269 Test Acc: 0.047
Validation loss decreased (-0.037614 --> -0.047026).  Saving model ...
Epoch: 3 cost time: 2.4223690032958984
Epoch: 3, Steps: 10 | Train Loss: 3.216 Vali Loss: 3.262 Vali Acc: 0.061 Test Loss: 3.262 Test Acc: 0.061
Validation loss decreased (-0.047026 --> -0.061144).  Saving model ...
Epoch: 4 cost time: 2.3106374740600586
Epoch: 4, Steps: 10 | Train Loss: 3.087 Vali Loss: 3.264 Vali Acc: 0.071 Test Loss: 3.264 Test Acc: 0.071
Validation loss decreased (-0.061144 --> -0.070556).  Saving model ...
Epoch: 5 cost time: 2.088850736618042
Epoch: 5, Steps: 10 | Train Loss: 3.004 Vali Loss: 3.264 Vali Acc: 0.076 Test Loss: 3.264 Test Acc: 0.076
Validation loss decreased (-0.070556 --> -0.076438).  Saving model ...
Epoch: 6 cost time: 2.4027109146118164
Epoch: 6, Steps: 10 | Train Loss: 2.899 Vali Loss: 3.266 Vali Acc: 0.078 Test Loss: 3.266 Test Acc: 0.078
Validation loss decreased (-0.076438 --> -0.077614).  Saving model ...
Epoch: 7 cost time: 2.203368663787842
Epoch: 7, Steps: 10 | Train Loss: 2.803 Vali Loss: 3.253 Vali Acc: 0.092 Test Loss: 3.253 Test Acc: 0.092
Validation loss decreased (-0.077614 --> -0.091732).  Saving model ...
Epoch: 8 cost time: 2.425534963607788
Epoch: 8, Steps: 10 | Train Loss: 2.719 Vali Loss: 3.236 Vali Acc: 0.115 Test Loss: 3.236 Test Acc: 0.115
Validation loss decreased (-0.091732 --> -0.115262).  Saving model ...
Epoch: 9 cost time: 2.3184709548950195
Epoch: 9, Steps: 10 | Train Loss: 2.512 Vali Loss: 3.206 Vali Acc: 0.127 Test Loss: 3.206 Test Acc: 0.127
Validation loss decreased (-0.115262 --> -0.127027).  Saving model ...
Epoch: 10 cost time: 2.299008846282959
Epoch: 10, Steps: 10 | Train Loss: 2.399 Vali Loss: 3.187 Vali Acc: 0.119 Test Loss: 3.187 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.0186147689819336
Epoch: 11, Steps: 10 | Train Loss: 2.250 Vali Loss: 3.169 Vali Acc: 0.154 Test Loss: 3.169 Test Acc: 0.154
Validation loss decreased (-0.127027 --> -0.154086).  Saving model ...
Epoch: 12 cost time: 2.526787281036377
Epoch: 12, Steps: 10 | Train Loss: 2.084 Vali Loss: 3.143 Vali Acc: 0.155 Test Loss: 3.143 Test Acc: 0.155
Validation loss decreased (-0.154086 --> -0.155263).  Saving model ...
Epoch: 13 cost time: 2.4896318912506104
Epoch: 13, Steps: 10 | Train Loss: 1.868 Vali Loss: 3.119 Vali Acc: 0.155 Test Loss: 3.119 Test Acc: 0.155
Validation loss decreased (-0.155263 --> -0.155263).  Saving model ...
Epoch: 14 cost time: 2.3224925994873047
Epoch: 14, Steps: 10 | Train Loss: 1.719 Vali Loss: 3.077 Vali Acc: 0.167 Test Loss: 3.077 Test Acc: 0.167
Validation loss decreased (-0.155263 --> -0.167028).  Saving model ...
Epoch: 15 cost time: 2.5677719116210938
Epoch: 15, Steps: 10 | Train Loss: 1.517 Vali Loss: 3.067 Vali Acc: 0.180 Test Loss: 3.067 Test Acc: 0.180
Validation loss decreased (-0.167028 --> -0.179969).  Saving model ...
Epoch: 16 cost time: 2.478813648223877
Epoch: 16, Steps: 10 | Train Loss: 1.382 Vali Loss: 3.116 Vali Acc: 0.173 Test Loss: 3.116 Test Acc: 0.173
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.601236343383789
Epoch: 17, Steps: 10 | Train Loss: 1.244 Vali Loss: 3.053 Vali Acc: 0.194 Test Loss: 3.053 Test Acc: 0.194
Validation loss decreased (-0.179969 --> -0.194087).  Saving model ...
Epoch: 18 cost time: 2.33780574798584
Epoch: 18, Steps: 10 | Train Loss: 1.047 Vali Loss: 3.017 Vali Acc: 0.202 Test Loss: 3.017 Test Acc: 0.202
Validation loss decreased (-0.194087 --> -0.202323).  Saving model ...
Epoch: 19 cost time: 1.9875190258026123
Epoch: 19, Steps: 10 | Train Loss: 0.951 Vali Loss: 3.010 Vali Acc: 0.207 Test Loss: 3.010 Test Acc: 0.207
Validation loss decreased (-0.202323 --> -0.207029).  Saving model ...
Epoch: 20 cost time: 2.2301130294799805
Epoch: 20, Steps: 10 | Train Loss: 0.813 Vali Loss: 3.015 Vali Acc: 0.198 Test Loss: 3.015 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.030747413635254
Epoch: 21, Steps: 10 | Train Loss: 0.786 Vali Loss: 3.032 Vali Acc: 0.207 Test Loss: 3.032 Test Acc: 0.207
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.181885242462158
Epoch: 22, Steps: 10 | Train Loss: 0.635 Vali Loss: 3.022 Vali Acc: 0.229 Test Loss: 3.022 Test Acc: 0.229
Validation loss decreased (-0.207029 --> -0.229382).  Saving model ...
Epoch: 23 cost time: 2.0804569721221924
Epoch: 23, Steps: 10 | Train Loss: 0.523 Vali Loss: 3.116 Vali Acc: 0.204 Test Loss: 3.116 Test Acc: 0.204
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.092965602874756
Epoch: 24, Steps: 10 | Train Loss: 0.392 Vali Loss: 3.042 Vali Acc: 0.225 Test Loss: 3.042 Test Acc: 0.225
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.1291751861572266
Epoch: 25, Steps: 10 | Train Loss: 0.371 Vali Loss: 3.095 Vali Acc: 0.226 Test Loss: 3.095 Test Acc: 0.226
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.9475181102752686
Epoch: 26, Steps: 10 | Train Loss: 0.332 Vali Loss: 3.105 Vali Acc: 0.234 Test Loss: 3.105 Test Acc: 0.234
Validation loss decreased (-0.229382 --> -0.234087).  Saving model ...
Epoch: 27 cost time: 2.2777020931243896
Epoch: 27, Steps: 10 | Train Loss: 0.253 Vali Loss: 3.077 Vali Acc: 0.238 Test Loss: 3.077 Test Acc: 0.238
Validation loss decreased (-0.234087 --> -0.237616).  Saving model ...
Epoch: 28 cost time: 2.3135223388671875
Epoch: 28, Steps: 10 | Train Loss: 0.243 Vali Loss: 3.106 Vali Acc: 0.236 Test Loss: 3.106 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.3754799365997314
Epoch: 29, Steps: 10 | Train Loss: 0.216 Vali Loss: 3.090 Vali Acc: 0.247 Test Loss: 3.090 Test Acc: 0.247
Validation loss decreased (-0.237616 --> -0.247028).  Saving model ...
Epoch: 30 cost time: 2.44094181060791
Epoch: 30, Steps: 10 | Train Loss: 0.182 Vali Loss: 3.148 Vali Acc: 0.238 Test Loss: 3.148 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.24705882352941178
model parameter : 618450
model size : 2.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.6059460639953613
Epoch: 1, Steps: 10 | Train Loss: 3.318 Vali Loss: 3.304 Vali Acc: 0.051 Test Loss: 3.304 Test Acc: 0.051
Validation loss decreased (inf --> -0.050555).  Saving model ...
Epoch: 2 cost time: 1.6623804569244385
Epoch: 2, Steps: 10 | Train Loss: 3.270 Vali Loss: 3.285 Vali Acc: 0.052 Test Loss: 3.285 Test Acc: 0.052
Validation loss decreased (-0.050555 --> -0.051732).  Saving model ...
Epoch: 3 cost time: 1.6466455459594727
Epoch: 3, Steps: 10 | Train Loss: 3.185 Vali Loss: 3.272 Vali Acc: 0.069 Test Loss: 3.272 Test Acc: 0.069
Validation loss decreased (-0.051732 --> -0.069379).  Saving model ...
Epoch: 4 cost time: 1.7235767841339111
Epoch: 4, Steps: 10 | Train Loss: 3.105 Vali Loss: 3.264 Vali Acc: 0.071 Test Loss: 3.264 Test Acc: 0.071
Validation loss decreased (-0.069379 --> -0.070556).  Saving model ...
Epoch: 5 cost time: 1.7589428424835205
Epoch: 5, Steps: 10 | Train Loss: 3.017 Vali Loss: 3.259 Vali Acc: 0.073 Test Loss: 3.259 Test Acc: 0.073
Validation loss decreased (-0.070556 --> -0.072909).  Saving model ...
Epoch: 6 cost time: 1.7072792053222656
Epoch: 6, Steps: 10 | Train Loss: 2.934 Vali Loss: 3.255 Vali Acc: 0.084 Test Loss: 3.255 Test Acc: 0.084
Validation loss decreased (-0.072909 --> -0.083497).  Saving model ...
Epoch: 7 cost time: 1.8203790187835693
Epoch: 7, Steps: 10 | Train Loss: 2.787 Vali Loss: 3.244 Vali Acc: 0.088 Test Loss: 3.244 Test Acc: 0.088
Validation loss decreased (-0.083497 --> -0.088203).  Saving model ...
Epoch: 8 cost time: 1.7297377586364746
Epoch: 8, Steps: 10 | Train Loss: 2.693 Vali Loss: 3.226 Vali Acc: 0.096 Test Loss: 3.226 Test Acc: 0.096
Validation loss decreased (-0.088203 --> -0.096438).  Saving model ...
Epoch: 9 cost time: 1.696678876876831
Epoch: 9, Steps: 10 | Train Loss: 2.621 Vali Loss: 3.216 Vali Acc: 0.100 Test Loss: 3.216 Test Acc: 0.100
Validation loss decreased (-0.096438 --> -0.099968).  Saving model ...
Epoch: 10 cost time: 1.623370885848999
Epoch: 10, Steps: 10 | Train Loss: 2.490 Vali Loss: 3.194 Vali Acc: 0.118 Test Loss: 3.194 Test Acc: 0.118
Validation loss decreased (-0.099968 --> -0.117615).  Saving model ...
Epoch: 11 cost time: 1.743830680847168
Epoch: 11, Steps: 10 | Train Loss: 2.385 Vali Loss: 3.160 Vali Acc: 0.126 Test Loss: 3.160 Test Acc: 0.126
Validation loss decreased (-0.117615 --> -0.125851).  Saving model ...
Epoch: 12 cost time: 1.8145794868469238
Epoch: 12, Steps: 10 | Train Loss: 2.241 Vali Loss: 3.133 Vali Acc: 0.131 Test Loss: 3.133 Test Acc: 0.131
Validation loss decreased (-0.125851 --> -0.130557).  Saving model ...
Epoch: 13 cost time: 1.756873607635498
Epoch: 13, Steps: 10 | Train Loss: 2.105 Vali Loss: 3.112 Vali Acc: 0.133 Test Loss: 3.112 Test Acc: 0.133
Validation loss decreased (-0.130557 --> -0.132910).  Saving model ...
Epoch: 14 cost time: 1.6697814464569092
Epoch: 14, Steps: 10 | Train Loss: 1.931 Vali Loss: 3.081 Vali Acc: 0.152 Test Loss: 3.081 Test Acc: 0.152
Validation loss decreased (-0.132910 --> -0.151734).  Saving model ...
Epoch: 15 cost time: 1.7651183605194092
Epoch: 15, Steps: 10 | Train Loss: 1.737 Vali Loss: 3.046 Vali Acc: 0.171 Test Loss: 3.046 Test Acc: 0.171
Validation loss decreased (-0.151734 --> -0.170558).  Saving model ...
Epoch: 16 cost time: 1.818047285079956
Epoch: 16, Steps: 10 | Train Loss: 1.653 Vali Loss: 3.023 Vali Acc: 0.187 Test Loss: 3.023 Test Acc: 0.187
Validation loss decreased (-0.170558 --> -0.187029).  Saving model ...
Epoch: 17 cost time: 1.671048879623413
Epoch: 17, Steps: 10 | Train Loss: 1.459 Vali Loss: 2.993 Vali Acc: 0.188 Test Loss: 2.993 Test Acc: 0.188
Validation loss decreased (-0.187029 --> -0.188205).  Saving model ...
Epoch: 18 cost time: 1.701373815536499
Epoch: 18, Steps: 10 | Train Loss: 1.381 Vali Loss: 2.986 Vali Acc: 0.195 Test Loss: 2.986 Test Acc: 0.195
Validation loss decreased (-0.188205 --> -0.195264).  Saving model ...
Epoch: 19 cost time: 1.6355791091918945
Epoch: 19, Steps: 10 | Train Loss: 1.223 Vali Loss: 2.963 Vali Acc: 0.204 Test Loss: 2.963 Test Acc: 0.204
Validation loss decreased (-0.195264 --> -0.203500).  Saving model ...
Epoch: 20 cost time: 1.7645375728607178
Epoch: 20, Steps: 10 | Train Loss: 1.043 Vali Loss: 2.994 Vali Acc: 0.211 Test Loss: 2.994 Test Acc: 0.211
Validation loss decreased (-0.203500 --> -0.210558).  Saving model ...
Epoch: 21 cost time: 1.7944812774658203
Epoch: 21, Steps: 10 | Train Loss: 0.947 Vali Loss: 2.972 Vali Acc: 0.222 Test Loss: 2.972 Test Acc: 0.222
Validation loss decreased (-0.210558 --> -0.222323).  Saving model ...
Epoch: 22 cost time: 1.5651359558105469
Epoch: 22, Steps: 10 | Train Loss: 0.840 Vali Loss: 2.944 Vali Acc: 0.225 Test Loss: 2.944 Test Acc: 0.225
Validation loss decreased (-0.222323 --> -0.224676).  Saving model ...
Epoch: 23 cost time: 1.5951008796691895
Epoch: 23, Steps: 10 | Train Loss: 0.691 Vali Loss: 2.940 Vali Acc: 0.234 Test Loss: 2.940 Test Acc: 0.234
Validation loss decreased (-0.224676 --> -0.234088).  Saving model ...
Epoch: 24 cost time: 1.6001410484313965
Epoch: 24, Steps: 10 | Train Loss: 0.636 Vali Loss: 2.938 Vali Acc: 0.245 Test Loss: 2.938 Test Acc: 0.245
Validation loss decreased (-0.234088 --> -0.244677).  Saving model ...
Epoch: 25 cost time: 2.0739121437072754
Epoch: 25, Steps: 10 | Train Loss: 0.536 Vali Loss: 3.005 Vali Acc: 0.235 Test Loss: 3.005 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.9670984745025635
Epoch: 26, Steps: 10 | Train Loss: 0.516 Vali Loss: 2.938 Vali Acc: 0.266 Test Loss: 2.938 Test Acc: 0.266
Validation loss decreased (-0.244677 --> -0.265853).  Saving model ...
Epoch: 27 cost time: 1.8702247142791748
Epoch: 27, Steps: 10 | Train Loss: 0.451 Vali Loss: 2.954 Vali Acc: 0.252 Test Loss: 2.954 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.0944948196411133
Epoch: 28, Steps: 10 | Train Loss: 0.317 Vali Loss: 2.987 Vali Acc: 0.246 Test Loss: 2.987 Test Acc: 0.246
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.8334629535675049
Epoch: 29, Steps: 10 | Train Loss: 0.296 Vali Loss: 3.006 Vali Acc: 0.255 Test Loss: 3.006 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.8774950504302979
Epoch: 30, Steps: 10 | Train Loss: 0.299 Vali Loss: 3.007 Vali Acc: 0.251 Test Loss: 3.007 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26588235294117646
model parameter : 204434
model size : 0.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.467559576034546
Epoch: 1, Steps: 10 | Train Loss: 3.338 Vali Loss: 3.284 Vali Acc: 0.038 Test Loss: 3.284 Test Acc: 0.038
Validation loss decreased (inf --> -0.037614).  Saving model ...
Epoch: 2 cost time: 1.694265604019165
Epoch: 2, Steps: 10 | Train Loss: 3.242 Vali Loss: 3.270 Vali Acc: 0.047 Test Loss: 3.270 Test Acc: 0.047
Validation loss decreased (-0.037614 --> -0.047026).  Saving model ...
Epoch: 3 cost time: 1.8840932846069336
Epoch: 3, Steps: 10 | Train Loss: 3.211 Vali Loss: 3.263 Vali Acc: 0.053 Test Loss: 3.263 Test Acc: 0.053
Validation loss decreased (-0.047026 --> -0.052909).  Saving model ...
Epoch: 4 cost time: 1.7557222843170166
Epoch: 4, Steps: 10 | Train Loss: 3.087 Vali Loss: 3.267 Vali Acc: 0.066 Test Loss: 3.267 Test Acc: 0.066
Validation loss decreased (-0.052909 --> -0.065850).  Saving model ...
Epoch: 5 cost time: 1.955094337463379
Epoch: 5, Steps: 10 | Train Loss: 3.002 Vali Loss: 3.271 Vali Acc: 0.081 Test Loss: 3.271 Test Acc: 0.081
Validation loss decreased (-0.065850 --> -0.081144).  Saving model ...
Epoch: 6 cost time: 2.063431978225708
Epoch: 6, Steps: 10 | Train Loss: 2.902 Vali Loss: 3.275 Vali Acc: 0.082 Test Loss: 3.275 Test Acc: 0.082
Validation loss decreased (-0.081144 --> -0.082320).  Saving model ...
Epoch: 7 cost time: 1.7486159801483154
Epoch: 7, Steps: 10 | Train Loss: 2.817 Vali Loss: 3.262 Vali Acc: 0.094 Test Loss: 3.262 Test Acc: 0.094
Validation loss decreased (-0.082320 --> -0.094085).  Saving model ...
Epoch: 8 cost time: 2.0044310092926025
Epoch: 8, Steps: 10 | Train Loss: 2.735 Vali Loss: 3.246 Vali Acc: 0.102 Test Loss: 3.246 Test Acc: 0.102
Validation loss decreased (-0.094085 --> -0.102320).  Saving model ...
Epoch: 9 cost time: 2.002544403076172
Epoch: 9, Steps: 10 | Train Loss: 2.521 Vali Loss: 3.214 Vali Acc: 0.125 Test Loss: 3.214 Test Acc: 0.125
Validation loss decreased (-0.102320 --> -0.124674).  Saving model ...
Epoch: 10 cost time: 2.0326578617095947
Epoch: 10, Steps: 10 | Train Loss: 2.408 Vali Loss: 3.193 Vali Acc: 0.126 Test Loss: 3.193 Test Acc: 0.126
Validation loss decreased (-0.124674 --> -0.125850).  Saving model ...
Epoch: 11 cost time: 1.7832005023956299
Epoch: 11, Steps: 10 | Train Loss: 2.241 Vali Loss: 3.179 Vali Acc: 0.144 Test Loss: 3.179 Test Acc: 0.144
Validation loss decreased (-0.125850 --> -0.143498).  Saving model ...
Epoch: 12 cost time: 1.600820779800415
Epoch: 12, Steps: 10 | Train Loss: 2.122 Vali Loss: 3.162 Vali Acc: 0.151 Test Loss: 3.162 Test Acc: 0.151
Validation loss decreased (-0.143498 --> -0.150557).  Saving model ...
Epoch: 13 cost time: 1.9615812301635742
Epoch: 13, Steps: 10 | Train Loss: 1.873 Vali Loss: 3.138 Vali Acc: 0.159 Test Loss: 3.138 Test Acc: 0.159
Validation loss decreased (-0.150557 --> -0.158792).  Saving model ...
Epoch: 14 cost time: 1.848992109298706
Epoch: 14, Steps: 10 | Train Loss: 1.764 Vali Loss: 3.106 Vali Acc: 0.176 Test Loss: 3.106 Test Acc: 0.176
Validation loss decreased (-0.158792 --> -0.176440).  Saving model ...
Epoch: 15 cost time: 1.647251844406128
Epoch: 15, Steps: 10 | Train Loss: 1.552 Vali Loss: 3.093 Vali Acc: 0.192 Test Loss: 3.093 Test Acc: 0.192
Validation loss decreased (-0.176440 --> -0.191734).  Saving model ...
Epoch: 16 cost time: 1.664473056793213
Epoch: 16, Steps: 10 | Train Loss: 1.388 Vali Loss: 3.145 Vali Acc: 0.181 Test Loss: 3.145 Test Acc: 0.181
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6847636699676514
Epoch: 17, Steps: 10 | Train Loss: 1.286 Vali Loss: 3.066 Vali Acc: 0.206 Test Loss: 3.066 Test Acc: 0.206
Validation loss decreased (-0.191734 --> -0.205852).  Saving model ...
Epoch: 18 cost time: 1.6853928565979004
Epoch: 18, Steps: 10 | Train Loss: 1.079 Vali Loss: 3.015 Vali Acc: 0.214 Test Loss: 3.015 Test Acc: 0.214
Validation loss decreased (-0.205852 --> -0.214088).  Saving model ...
Epoch: 19 cost time: 1.7423477172851562
Epoch: 19, Steps: 10 | Train Loss: 0.945 Vali Loss: 3.005 Vali Acc: 0.218 Test Loss: 3.005 Test Acc: 0.218
Validation loss decreased (-0.214088 --> -0.217617).  Saving model ...
Epoch: 20 cost time: 1.750873327255249
Epoch: 20, Steps: 10 | Train Loss: 0.850 Vali Loss: 3.021 Vali Acc: 0.214 Test Loss: 3.021 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.9558093547821045
Epoch: 21, Steps: 10 | Train Loss: 0.764 Vali Loss: 3.015 Vali Acc: 0.219 Test Loss: 3.015 Test Acc: 0.219
Validation loss decreased (-0.217617 --> -0.218793).  Saving model ...
Epoch: 22 cost time: 1.8283905982971191
Epoch: 22, Steps: 10 | Train Loss: 0.543 Vali Loss: 3.028 Vali Acc: 0.232 Test Loss: 3.028 Test Acc: 0.232
Validation loss decreased (-0.218793 --> -0.231734).  Saving model ...
Epoch: 23 cost time: 1.7689168453216553
Epoch: 23, Steps: 10 | Train Loss: 0.589 Vali Loss: 3.057 Vali Acc: 0.240 Test Loss: 3.057 Test Acc: 0.240
Validation loss decreased (-0.231734 --> -0.239969).  Saving model ...
Epoch: 24 cost time: 1.9968271255493164
Epoch: 24, Steps: 10 | Train Loss: 0.384 Vali Loss: 3.013 Vali Acc: 0.255 Test Loss: 3.013 Test Acc: 0.255
Validation loss decreased (-0.239969 --> -0.255264).  Saving model ...
Epoch: 25 cost time: 1.932009220123291
Epoch: 25, Steps: 10 | Train Loss: 0.384 Vali Loss: 3.033 Vali Acc: 0.245 Test Loss: 3.033 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.1059563159942627
Epoch: 26, Steps: 10 | Train Loss: 0.348 Vali Loss: 3.052 Vali Acc: 0.255 Test Loss: 3.052 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.022144317626953
Epoch: 27, Steps: 10 | Train Loss: 0.230 Vali Loss: 3.094 Vali Acc: 0.247 Test Loss: 3.094 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.9151747226715088
Epoch: 28, Steps: 10 | Train Loss: 0.294 Vali Loss: 3.086 Vali Acc: 0.254 Test Loss: 3.086 Test Acc: 0.254
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.8823647499084473
Epoch: 29, Steps: 10 | Train Loss: 0.276 Vali Loss: 3.061 Vali Acc: 0.238 Test Loss: 3.061 Test Acc: 0.238
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.7129559516906738
Epoch: 30, Steps: 10 | Train Loss: 0.216 Vali Loss: 3.162 Vali Acc: 0.255 Test Loss: 3.162 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.25529411764705884
model parameter : 618450
model size : 2.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.914076805114746
Epoch: 1, Steps: 10 | Train Loss: 3.323 Vali Loss: 3.301 Vali Acc: 0.052 Test Loss: 3.301 Test Acc: 0.052
Validation loss decreased (inf --> -0.051732).  Saving model ...
Epoch: 2 cost time: 1.4611811637878418
Epoch: 2, Steps: 10 | Train Loss: 3.275 Vali Loss: 3.283 Vali Acc: 0.058 Test Loss: 3.283 Test Acc: 0.058
Validation loss decreased (-0.051732 --> -0.057614).  Saving model ...
Epoch: 3 cost time: 1.4155046939849854
Epoch: 3, Steps: 10 | Train Loss: 3.190 Vali Loss: 3.270 Vali Acc: 0.072 Test Loss: 3.270 Test Acc: 0.072
Validation loss decreased (-0.057614 --> -0.071732).  Saving model ...
Epoch: 4 cost time: 1.5502583980560303
Epoch: 4, Steps: 10 | Train Loss: 3.116 Vali Loss: 3.264 Vali Acc: 0.073 Test Loss: 3.264 Test Acc: 0.073
Validation loss decreased (-0.071732 --> -0.072909).  Saving model ...
Epoch: 5 cost time: 1.3671259880065918
Epoch: 5, Steps: 10 | Train Loss: 3.017 Vali Loss: 3.260 Vali Acc: 0.073 Test Loss: 3.260 Test Acc: 0.073
Validation loss decreased (-0.072909 --> -0.072909).  Saving model ...
Epoch: 6 cost time: 1.4405624866485596
Epoch: 6, Steps: 10 | Train Loss: 2.941 Vali Loss: 3.256 Vali Acc: 0.081 Test Loss: 3.256 Test Acc: 0.081
Validation loss decreased (-0.072909 --> -0.081144).  Saving model ...
Epoch: 7 cost time: 1.4472241401672363
Epoch: 7, Steps: 10 | Train Loss: 2.760 Vali Loss: 3.244 Vali Acc: 0.086 Test Loss: 3.244 Test Acc: 0.086
Validation loss decreased (-0.081144 --> -0.085850).  Saving model ...
Epoch: 8 cost time: 1.39351487159729
Epoch: 8, Steps: 10 | Train Loss: 2.688 Vali Loss: 3.225 Vali Acc: 0.096 Test Loss: 3.225 Test Acc: 0.096
Validation loss decreased (-0.085850 --> -0.096438).  Saving model ...
Epoch: 9 cost time: 1.3474788665771484
Epoch: 9, Steps: 10 | Train Loss: 2.623 Vali Loss: 3.215 Vali Acc: 0.107 Test Loss: 3.215 Test Acc: 0.107
Validation loss decreased (-0.096438 --> -0.107027).  Saving model ...
Epoch: 10 cost time: 1.3148486614227295
Epoch: 10, Steps: 10 | Train Loss: 2.491 Vali Loss: 3.194 Vali Acc: 0.115 Test Loss: 3.194 Test Acc: 0.115
Validation loss decreased (-0.107027 --> -0.115262).  Saving model ...
Epoch: 11 cost time: 1.2845063209533691
Epoch: 11, Steps: 10 | Train Loss: 2.396 Vali Loss: 3.166 Vali Acc: 0.131 Test Loss: 3.166 Test Acc: 0.131
Validation loss decreased (-0.115262 --> -0.130557).  Saving model ...
Epoch: 12 cost time: 1.4236700534820557
Epoch: 12, Steps: 10 | Train Loss: 2.256 Vali Loss: 3.137 Vali Acc: 0.128 Test Loss: 3.137 Test Acc: 0.128
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5183701515197754
Epoch: 13, Steps: 10 | Train Loss: 2.138 Vali Loss: 3.125 Vali Acc: 0.141 Test Loss: 3.125 Test Acc: 0.141
Validation loss decreased (-0.130557 --> -0.141145).  Saving model ...
Epoch: 14 cost time: 1.447547197341919
Epoch: 14, Steps: 10 | Train Loss: 1.970 Vali Loss: 3.097 Vali Acc: 0.153 Test Loss: 3.097 Test Acc: 0.153
Validation loss decreased (-0.141145 --> -0.152910).  Saving model ...
Epoch: 15 cost time: 1.4463286399841309
Epoch: 15, Steps: 10 | Train Loss: 1.829 Vali Loss: 3.054 Vali Acc: 0.160 Test Loss: 3.054 Test Acc: 0.160
Validation loss decreased (-0.152910 --> -0.159969).  Saving model ...
Epoch: 16 cost time: 1.3123915195465088
Epoch: 16, Steps: 10 | Train Loss: 1.696 Vali Loss: 3.040 Vali Acc: 0.175 Test Loss: 3.040 Test Acc: 0.175
Validation loss decreased (-0.159969 --> -0.175264).  Saving model ...
Epoch: 17 cost time: 1.3348796367645264
Epoch: 17, Steps: 10 | Train Loss: 1.501 Vali Loss: 3.020 Vali Acc: 0.181 Test Loss: 3.020 Test Acc: 0.181
Validation loss decreased (-0.175264 --> -0.181146).  Saving model ...
Epoch: 18 cost time: 1.4564194679260254
Epoch: 18, Steps: 10 | Train Loss: 1.360 Vali Loss: 3.001 Vali Acc: 0.189 Test Loss: 3.001 Test Acc: 0.189
Validation loss decreased (-0.181146 --> -0.189382).  Saving model ...
Epoch: 19 cost time: 1.4707417488098145
Epoch: 19, Steps: 10 | Train Loss: 1.232 Vali Loss: 2.976 Vali Acc: 0.206 Test Loss: 2.976 Test Acc: 0.206
Validation loss decreased (-0.189382 --> -0.205853).  Saving model ...
Epoch: 20 cost time: 1.6087384223937988
Epoch: 20, Steps: 10 | Train Loss: 1.074 Vali Loss: 2.979 Vali Acc: 0.214 Test Loss: 2.979 Test Acc: 0.214
Validation loss decreased (-0.205853 --> -0.214088).  Saving model ...
Epoch: 21 cost time: 1.4520926475524902
Epoch: 21, Steps: 10 | Train Loss: 1.008 Vali Loss: 2.987 Vali Acc: 0.220 Test Loss: 2.987 Test Acc: 0.220
Validation loss decreased (-0.214088 --> -0.219970).  Saving model ...
Epoch: 22 cost time: 1.564877986907959
Epoch: 22, Steps: 10 | Train Loss: 0.813 Vali Loss: 2.960 Vali Acc: 0.227 Test Loss: 2.960 Test Acc: 0.227
Validation loss decreased (-0.219970 --> -0.227029).  Saving model ...
Epoch: 23 cost time: 1.7897562980651855
Epoch: 23, Steps: 10 | Train Loss: 0.748 Vali Loss: 2.969 Vali Acc: 0.234 Test Loss: 2.969 Test Acc: 0.234
Validation loss decreased (-0.227029 --> -0.234088).  Saving model ...
Epoch: 24 cost time: 1.5046329498291016
Epoch: 24, Steps: 10 | Train Loss: 0.657 Vali Loss: 2.964 Vali Acc: 0.238 Test Loss: 2.964 Test Acc: 0.238
Validation loss decreased (-0.234088 --> -0.237617).  Saving model ...
Epoch: 25 cost time: 1.5893681049346924
Epoch: 25, Steps: 10 | Train Loss: 0.505 Vali Loss: 2.999 Vali Acc: 0.242 Test Loss: 2.999 Test Acc: 0.242
Validation loss decreased (-0.237617 --> -0.242323).  Saving model ...
Epoch: 26 cost time: 1.5745396614074707
Epoch: 26, Steps: 10 | Train Loss: 0.504 Vali Loss: 2.947 Vali Acc: 0.253 Test Loss: 2.947 Test Acc: 0.253
Validation loss decreased (-0.242323 --> -0.252912).  Saving model ...
Epoch: 27 cost time: 1.5032379627227783
Epoch: 27, Steps: 10 | Train Loss: 0.441 Vali Loss: 2.986 Vali Acc: 0.255 Test Loss: 2.986 Test Acc: 0.255
Validation loss decreased (-0.252912 --> -0.255264).  Saving model ...
Epoch: 28 cost time: 1.5534389019012451
Epoch: 28, Steps: 10 | Train Loss: 0.457 Vali Loss: 2.947 Vali Acc: 0.261 Test Loss: 2.947 Test Acc: 0.261
Validation loss decreased (-0.255264 --> -0.261147).  Saving model ...
Epoch: 29 cost time: 1.6629753112792969
Epoch: 29, Steps: 10 | Train Loss: 0.315 Vali Loss: 2.954 Vali Acc: 0.275 Test Loss: 2.954 Test Acc: 0.275
Validation loss decreased (-0.261147 --> -0.275265).  Saving model ...
Epoch: 30 cost time: 1.6971509456634521
Epoch: 30, Steps: 10 | Train Loss: 0.396 Vali Loss: 2.981 Vali Acc: 0.271 Test Loss: 2.981 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2752941176470588
model parameter : 204434
model size : 0.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.8933298587799072
Epoch: 1, Steps: 10 | Train Loss: 3.346 Vali Loss: 3.288 Vali Acc: 0.039 Test Loss: 3.288 Test Acc: 0.039
Validation loss decreased (inf --> -0.038791).  Saving model ...
Epoch: 2 cost time: 1.3382747173309326
Epoch: 2, Steps: 10 | Train Loss: 3.249 Vali Loss: 3.277 Vali Acc: 0.045 Test Loss: 3.277 Test Acc: 0.045
Validation loss decreased (-0.038791 --> -0.044673).  Saving model ...
Epoch: 3 cost time: 1.3633487224578857
Epoch: 3, Steps: 10 | Train Loss: 3.228 Vali Loss: 3.271 Vali Acc: 0.048 Test Loss: 3.271 Test Acc: 0.048
Validation loss decreased (-0.044673 --> -0.048203).  Saving model ...
Epoch: 4 cost time: 1.3194801807403564
Epoch: 4, Steps: 10 | Train Loss: 3.126 Vali Loss: 3.271 Vali Acc: 0.060 Test Loss: 3.271 Test Acc: 0.060
Validation loss decreased (-0.048203 --> -0.059967).  Saving model ...
Epoch: 5 cost time: 1.3290574550628662
Epoch: 5, Steps: 10 | Train Loss: 3.040 Vali Loss: 3.276 Vali Acc: 0.072 Test Loss: 3.276 Test Acc: 0.072
Validation loss decreased (-0.059967 --> -0.071732).  Saving model ...
Epoch: 6 cost time: 1.31596040725708
Epoch: 6, Steps: 10 | Train Loss: 2.956 Vali Loss: 3.280 Vali Acc: 0.079 Test Loss: 3.280 Test Acc: 0.079
Validation loss decreased (-0.071732 --> -0.078791).  Saving model ...
Epoch: 7 cost time: 1.3563039302825928
Epoch: 7, Steps: 10 | Train Loss: 2.892 Vali Loss: 3.278 Vali Acc: 0.087 Test Loss: 3.278 Test Acc: 0.087
Validation loss decreased (-0.078791 --> -0.087026).  Saving model ...
Epoch: 8 cost time: 1.3724353313446045
Epoch: 8, Steps: 10 | Train Loss: 2.836 Vali Loss: 3.271 Vali Acc: 0.092 Test Loss: 3.271 Test Acc: 0.092
Validation loss decreased (-0.087026 --> -0.091732).  Saving model ...
Epoch: 9 cost time: 1.3567521572113037
Epoch: 9, Steps: 10 | Train Loss: 2.656 Vali Loss: 3.248 Vali Acc: 0.104 Test Loss: 3.248 Test Acc: 0.104
Validation loss decreased (-0.091732 --> -0.103497).  Saving model ...
Epoch: 10 cost time: 1.248272180557251
Epoch: 10, Steps: 10 | Train Loss: 2.565 Vali Loss: 3.225 Vali Acc: 0.116 Test Loss: 3.225 Test Acc: 0.116
Validation loss decreased (-0.103497 --> -0.116438).  Saving model ...
Epoch: 11 cost time: 1.3467817306518555
Epoch: 11, Steps: 10 | Train Loss: 2.446 Vali Loss: 3.209 Vali Acc: 0.139 Test Loss: 3.209 Test Acc: 0.139
Validation loss decreased (-0.116438 --> -0.138791).  Saving model ...
Epoch: 12 cost time: 1.3483901023864746
Epoch: 12, Steps: 10 | Train Loss: 2.266 Vali Loss: 3.189 Vali Acc: 0.159 Test Loss: 3.189 Test Acc: 0.159
Validation loss decreased (-0.138791 --> -0.158792).  Saving model ...
Epoch: 13 cost time: 1.3402135372161865
Epoch: 13, Steps: 10 | Train Loss: 2.057 Vali Loss: 3.158 Vali Acc: 0.167 Test Loss: 3.158 Test Acc: 0.167
Validation loss decreased (-0.158792 --> -0.167027).  Saving model ...
Epoch: 14 cost time: 1.336352825164795
Epoch: 14, Steps: 10 | Train Loss: 2.004 Vali Loss: 3.159 Vali Acc: 0.153 Test Loss: 3.159 Test Acc: 0.153
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2339773178100586
Epoch: 15, Steps: 10 | Train Loss: 1.844 Vali Loss: 3.122 Vali Acc: 0.171 Test Loss: 3.122 Test Acc: 0.171
Validation loss decreased (-0.167027 --> -0.170557).  Saving model ...
Epoch: 16 cost time: 1.1974155902862549
Epoch: 16, Steps: 10 | Train Loss: 1.773 Vali Loss: 3.130 Vali Acc: 0.171 Test Loss: 3.130 Test Acc: 0.171
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2969255447387695
Epoch: 17, Steps: 10 | Train Loss: 1.681 Vali Loss: 3.086 Vali Acc: 0.184 Test Loss: 3.086 Test Acc: 0.184
Validation loss decreased (-0.170557 --> -0.183499).  Saving model ...
Epoch: 18 cost time: 1.2484726905822754
Epoch: 18, Steps: 10 | Train Loss: 1.434 Vali Loss: 3.054 Vali Acc: 0.201 Test Loss: 3.054 Test Acc: 0.201
Validation loss decreased (-0.183499 --> -0.201146).  Saving model ...
Epoch: 19 cost time: 1.2206625938415527
Epoch: 19, Steps: 10 | Train Loss: 1.291 Vali Loss: 3.037 Vali Acc: 0.202 Test Loss: 3.037 Test Acc: 0.202
Validation loss decreased (-0.201146 --> -0.202323).  Saving model ...
Epoch: 20 cost time: 1.3651556968688965
Epoch: 20, Steps: 10 | Train Loss: 1.194 Vali Loss: 3.046 Vali Acc: 0.202 Test Loss: 3.046 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3046917915344238
Epoch: 21, Steps: 10 | Train Loss: 1.081 Vali Loss: 3.049 Vali Acc: 0.207 Test Loss: 3.049 Test Acc: 0.207
Validation loss decreased (-0.202323 --> -0.207028).  Saving model ...
Epoch: 22 cost time: 1.3321127891540527
Epoch: 22, Steps: 10 | Train Loss: 0.997 Vali Loss: 3.127 Vali Acc: 0.196 Test Loss: 3.127 Test Acc: 0.196
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.382152795791626
Epoch: 23, Steps: 10 | Train Loss: 0.910 Vali Loss: 3.099 Vali Acc: 0.213 Test Loss: 3.099 Test Acc: 0.213
Validation loss decreased (-0.207028 --> -0.212910).  Saving model ...
Epoch: 24 cost time: 1.318070888519287
Epoch: 24, Steps: 10 | Train Loss: 0.694 Vali Loss: 3.052 Vali Acc: 0.215 Test Loss: 3.052 Test Acc: 0.215
Validation loss decreased (-0.212910 --> -0.215264).  Saving model ...
Epoch: 25 cost time: 1.308518886566162
Epoch: 25, Steps: 10 | Train Loss: 0.733 Vali Loss: 3.249 Vali Acc: 0.201 Test Loss: 3.249 Test Acc: 0.201
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3664250373840332
Epoch: 26, Steps: 10 | Train Loss: 0.712 Vali Loss: 3.089 Vali Acc: 0.232 Test Loss: 3.089 Test Acc: 0.232
Validation loss decreased (-0.215264 --> -0.231734).  Saving model ...
Epoch: 27 cost time: 1.4472301006317139
Epoch: 27, Steps: 10 | Train Loss: 0.564 Vali Loss: 3.125 Vali Acc: 0.235 Test Loss: 3.125 Test Acc: 0.235
Validation loss decreased (-0.231734 --> -0.235263).  Saving model ...
Epoch: 28 cost time: 1.395833969116211
Epoch: 28, Steps: 10 | Train Loss: 0.482 Vali Loss: 3.084 Vali Acc: 0.232 Test Loss: 3.084 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.3251996040344238
Epoch: 29, Steps: 10 | Train Loss: 0.493 Vali Loss: 3.086 Vali Acc: 0.248 Test Loss: 3.086 Test Acc: 0.248
Validation loss decreased (-0.235263 --> -0.248204).  Saving model ...
Epoch: 30 cost time: 1.3546359539031982
Epoch: 30, Steps: 10 | Train Loss: 0.425 Vali Loss: 3.141 Vali Acc: 0.240 Test Loss: 3.141 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.24823529411764705
model parameter : 618450
model size : 2.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.751464366912842
Epoch: 1, Steps: 10 | Train Loss: 3.304 Vali Loss: 3.305 Vali Acc: 0.051 Test Loss: 3.305 Test Acc: 0.051
Validation loss decreased (inf --> -0.050555).  Saving model ...
Epoch: 2 cost time: 1.2762601375579834
Epoch: 2, Steps: 10 | Train Loss: 3.272 Vali Loss: 3.288 Vali Acc: 0.058 Test Loss: 3.288 Test Acc: 0.058
Validation loss decreased (-0.050555 --> -0.057614).  Saving model ...
Epoch: 3 cost time: 1.243422508239746
Epoch: 3, Steps: 10 | Train Loss: 3.212 Vali Loss: 3.275 Vali Acc: 0.064 Test Loss: 3.275 Test Acc: 0.064
Validation loss decreased (-0.057614 --> -0.063497).  Saving model ...
Epoch: 4 cost time: 1.2725136280059814
Epoch: 4, Steps: 10 | Train Loss: 3.134 Vali Loss: 3.270 Vali Acc: 0.067 Test Loss: 3.270 Test Acc: 0.067
Validation loss decreased (-0.063497 --> -0.067026).  Saving model ...
Epoch: 5 cost time: 1.2728040218353271
Epoch: 5, Steps: 10 | Train Loss: 3.053 Vali Loss: 3.267 Vali Acc: 0.073 Test Loss: 3.267 Test Acc: 0.073
Validation loss decreased (-0.067026 --> -0.072909).  Saving model ...
Epoch: 6 cost time: 1.2529456615447998
Epoch: 6, Steps: 10 | Train Loss: 2.990 Vali Loss: 3.268 Vali Acc: 0.081 Test Loss: 3.268 Test Acc: 0.081
Validation loss decreased (-0.072909 --> -0.081144).  Saving model ...
Epoch: 7 cost time: 1.3466758728027344
Epoch: 7, Steps: 10 | Train Loss: 2.821 Vali Loss: 3.261 Vali Acc: 0.085 Test Loss: 3.261 Test Acc: 0.085
Validation loss decreased (-0.081144 --> -0.084673).  Saving model ...
Epoch: 8 cost time: 1.2420353889465332
Epoch: 8, Steps: 10 | Train Loss: 2.742 Vali Loss: 3.242 Vali Acc: 0.093 Test Loss: 3.242 Test Acc: 0.093
Validation loss decreased (-0.084673 --> -0.092909).  Saving model ...
Epoch: 9 cost time: 1.2625646591186523
Epoch: 9, Steps: 10 | Train Loss: 2.683 Vali Loss: 3.235 Vali Acc: 0.096 Test Loss: 3.235 Test Acc: 0.096
Validation loss decreased (-0.092909 --> -0.096438).  Saving model ...
Epoch: 10 cost time: 1.279543161392212
Epoch: 10, Steps: 10 | Train Loss: 2.555 Vali Loss: 3.216 Vali Acc: 0.111 Test Loss: 3.216 Test Acc: 0.111
Validation loss decreased (-0.096438 --> -0.110556).  Saving model ...
Epoch: 11 cost time: 1.2702760696411133
Epoch: 11, Steps: 10 | Train Loss: 2.517 Vali Loss: 3.187 Vali Acc: 0.129 Test Loss: 3.187 Test Acc: 0.129
Validation loss decreased (-0.110556 --> -0.129380).  Saving model ...
Epoch: 12 cost time: 1.0999693870544434
Epoch: 12, Steps: 10 | Train Loss: 2.364 Vali Loss: 3.161 Vali Acc: 0.139 Test Loss: 3.161 Test Acc: 0.139
Validation loss decreased (-0.129380 --> -0.138792).  Saving model ...
Epoch: 13 cost time: 1.1806602478027344
Epoch: 13, Steps: 10 | Train Loss: 2.288 Vali Loss: 3.156 Vali Acc: 0.144 Test Loss: 3.156 Test Acc: 0.144
Validation loss decreased (-0.138792 --> -0.143498).  Saving model ...
Epoch: 14 cost time: 1.1786351203918457
Epoch: 14, Steps: 10 | Train Loss: 2.143 Vali Loss: 3.142 Vali Acc: 0.151 Test Loss: 3.142 Test Acc: 0.151
Validation loss decreased (-0.143498 --> -0.150557).  Saving model ...
Epoch: 15 cost time: 1.2092957496643066
Epoch: 15, Steps: 10 | Train Loss: 2.021 Vali Loss: 3.106 Vali Acc: 0.165 Test Loss: 3.106 Test Acc: 0.165
Validation loss decreased (-0.150557 --> -0.164675).  Saving model ...
Epoch: 16 cost time: 1.1542143821716309
Epoch: 16, Steps: 10 | Train Loss: 1.947 Vali Loss: 3.101 Vali Acc: 0.169 Test Loss: 3.101 Test Acc: 0.169
Validation loss decreased (-0.164675 --> -0.169381).  Saving model ...
Epoch: 17 cost time: 1.0815191268920898
Epoch: 17, Steps: 10 | Train Loss: 1.838 Vali Loss: 3.090 Vali Acc: 0.173 Test Loss: 3.090 Test Acc: 0.173
Validation loss decreased (-0.169381 --> -0.172910).  Saving model ...
Epoch: 18 cost time: 1.0826082229614258
Epoch: 18, Steps: 10 | Train Loss: 1.738 Vali Loss: 3.072 Vali Acc: 0.182 Test Loss: 3.072 Test Acc: 0.182
Validation loss decreased (-0.172910 --> -0.182322).  Saving model ...
Epoch: 19 cost time: 1.1629807949066162
Epoch: 19, Steps: 10 | Train Loss: 1.565 Vali Loss: 3.063 Vali Acc: 0.182 Test Loss: 3.063 Test Acc: 0.182
Validation loss decreased (-0.182322 --> -0.182322).  Saving model ...
Epoch: 20 cost time: 1.073366403579712
Epoch: 20, Steps: 10 | Train Loss: 1.437 Vali Loss: 3.043 Vali Acc: 0.192 Test Loss: 3.043 Test Acc: 0.192
Validation loss decreased (-0.182322 --> -0.191734).  Saving model ...
Epoch: 21 cost time: 1.1411571502685547
Epoch: 21, Steps: 10 | Train Loss: 1.428 Vali Loss: 3.031 Vali Acc: 0.200 Test Loss: 3.031 Test Acc: 0.200
Validation loss decreased (-0.191734 --> -0.199970).  Saving model ...
Epoch: 22 cost time: 1.0091485977172852
Epoch: 22, Steps: 10 | Train Loss: 1.263 Vali Loss: 3.039 Vali Acc: 0.204 Test Loss: 3.039 Test Acc: 0.204
Validation loss decreased (-0.199970 --> -0.203499).  Saving model ...
Epoch: 23 cost time: 1.0483036041259766
Epoch: 23, Steps: 10 | Train Loss: 1.109 Vali Loss: 3.033 Vali Acc: 0.225 Test Loss: 3.033 Test Acc: 0.225
Validation loss decreased (-0.203499 --> -0.224676).  Saving model ...
Epoch: 24 cost time: 1.1379547119140625
Epoch: 24, Steps: 10 | Train Loss: 0.993 Vali Loss: 3.018 Vali Acc: 0.226 Test Loss: 3.018 Test Acc: 0.226
Validation loss decreased (-0.224676 --> -0.225852).  Saving model ...
Epoch: 25 cost time: 1.1316986083984375
Epoch: 25, Steps: 10 | Train Loss: 0.942 Vali Loss: 3.031 Vali Acc: 0.233 Test Loss: 3.031 Test Acc: 0.233
Validation loss decreased (-0.225852 --> -0.232911).  Saving model ...
Epoch: 26 cost time: 1.2679579257965088
Epoch: 26, Steps: 10 | Train Loss: 0.860 Vali Loss: 2.988 Vali Acc: 0.239 Test Loss: 2.988 Test Acc: 0.239
Validation loss decreased (-0.232911 --> -0.238794).  Saving model ...
Epoch: 27 cost time: 1.1880595684051514
Epoch: 27, Steps: 10 | Train Loss: 0.696 Vali Loss: 3.050 Vali Acc: 0.251 Test Loss: 3.050 Test Acc: 0.251
Validation loss decreased (-0.238794 --> -0.250558).  Saving model ...
Epoch: 28 cost time: 1.2100474834442139
Epoch: 28, Steps: 10 | Train Loss: 0.659 Vali Loss: 3.013 Vali Acc: 0.253 Test Loss: 3.013 Test Acc: 0.253
Validation loss decreased (-0.250558 --> -0.252911).  Saving model ...
Epoch: 29 cost time: 1.1426920890808105
Epoch: 29, Steps: 10 | Train Loss: 0.626 Vali Loss: 3.068 Vali Acc: 0.258 Test Loss: 3.068 Test Acc: 0.258
Validation loss decreased (-0.252911 --> -0.257616).  Saving model ...
Epoch: 30 cost time: 1.1616334915161133
Epoch: 30, Steps: 10 | Train Loss: 0.548 Vali Loss: 3.015 Vali Acc: 0.259 Test Loss: 3.015 Test Acc: 0.259
Validation loss decreased (-0.257616 --> -0.258793).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.25882352941176473
model parameter : 204434
model size : 0.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.6153345108032227
Epoch: 1, Steps: 10 | Train Loss: 3.358 Vali Loss: 3.282 Vali Acc: 0.041 Test Loss: 3.282 Test Acc: 0.041
Validation loss decreased (inf --> -0.041144).  Saving model ...
Epoch: 2 cost time: 1.8310339450836182
Epoch: 2, Steps: 10 | Train Loss: 3.310 Vali Loss: 3.264 Vali Acc: 0.041 Test Loss: 3.264 Test Acc: 0.041
Validation loss decreased (-0.041144 --> -0.041144).  Saving model ...
Epoch: 3 cost time: 1.8844585418701172
Epoch: 3, Steps: 10 | Train Loss: 3.204 Vali Loss: 3.251 Vali Acc: 0.040 Test Loss: 3.251 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8149914741516113
Epoch: 4, Steps: 10 | Train Loss: 3.129 Vali Loss: 3.245 Vali Acc: 0.053 Test Loss: 3.245 Test Acc: 0.053
Validation loss decreased (-0.041144 --> -0.052909).  Saving model ...
Epoch: 5 cost time: 1.8592777252197266
Epoch: 5, Steps: 10 | Train Loss: 2.989 Vali Loss: 3.246 Vali Acc: 0.068 Test Loss: 3.246 Test Acc: 0.068
Validation loss decreased (-0.052909 --> -0.068203).  Saving model ...
Epoch: 6 cost time: 1.8907034397125244
Epoch: 6, Steps: 10 | Train Loss: 2.935 Vali Loss: 3.245 Vali Acc: 0.069 Test Loss: 3.245 Test Acc: 0.069
Validation loss decreased (-0.068203 --> -0.069379).  Saving model ...
Epoch: 7 cost time: 1.9657893180847168
Epoch: 7, Steps: 10 | Train Loss: 2.857 Vali Loss: 3.236 Vali Acc: 0.088 Test Loss: 3.236 Test Acc: 0.088
Validation loss decreased (-0.069379 --> -0.088203).  Saving model ...
Epoch: 8 cost time: 1.8499906063079834
Epoch: 8, Steps: 10 | Train Loss: 2.733 Vali Loss: 3.221 Vali Acc: 0.099 Test Loss: 3.221 Test Acc: 0.099
Validation loss decreased (-0.088203 --> -0.098791).  Saving model ...
Epoch: 9 cost time: 1.9587960243225098
Epoch: 9, Steps: 10 | Train Loss: 2.709 Vali Loss: 3.202 Vali Acc: 0.126 Test Loss: 3.202 Test Acc: 0.126
Validation loss decreased (-0.098791 --> -0.125850).  Saving model ...
Epoch: 10 cost time: 1.8378689289093018
Epoch: 10, Steps: 10 | Train Loss: 2.505 Vali Loss: 3.170 Vali Acc: 0.139 Test Loss: 3.170 Test Acc: 0.139
Validation loss decreased (-0.125850 --> -0.138792).  Saving model ...
Epoch: 11 cost time: 1.780179738998413
Epoch: 11, Steps: 10 | Train Loss: 2.367 Vali Loss: 3.155 Vali Acc: 0.142 Test Loss: 3.155 Test Acc: 0.142
Validation loss decreased (-0.138792 --> -0.142321).  Saving model ...
Epoch: 12 cost time: 1.8693037033081055
Epoch: 12, Steps: 10 | Train Loss: 2.190 Vali Loss: 3.133 Vali Acc: 0.149 Test Loss: 3.133 Test Acc: 0.149
Validation loss decreased (-0.142321 --> -0.149380).  Saving model ...
Epoch: 13 cost time: 1.7326505184173584
Epoch: 13, Steps: 10 | Train Loss: 2.042 Vali Loss: 3.111 Vali Acc: 0.174 Test Loss: 3.111 Test Acc: 0.174
Validation loss decreased (-0.149380 --> -0.174087).  Saving model ...
Epoch: 14 cost time: 1.8179442882537842
Epoch: 14, Steps: 10 | Train Loss: 1.867 Vali Loss: 3.091 Vali Acc: 0.172 Test Loss: 3.091 Test Acc: 0.172
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7770731449127197
Epoch: 15, Steps: 10 | Train Loss: 1.682 Vali Loss: 3.075 Vali Acc: 0.179 Test Loss: 3.075 Test Acc: 0.179
Validation loss decreased (-0.174087 --> -0.178793).  Saving model ...
Epoch: 16 cost time: 1.791623592376709
Epoch: 16, Steps: 10 | Train Loss: 1.532 Vali Loss: 3.057 Vali Acc: 0.189 Test Loss: 3.057 Test Acc: 0.189
Validation loss decreased (-0.178793 --> -0.189381).  Saving model ...
Epoch: 17 cost time: 1.8199658393859863
Epoch: 17, Steps: 10 | Train Loss: 1.405 Vali Loss: 3.032 Vali Acc: 0.202 Test Loss: 3.032 Test Acc: 0.202
Validation loss decreased (-0.189381 --> -0.202323).  Saving model ...
Epoch: 18 cost time: 1.7387681007385254
Epoch: 18, Steps: 10 | Train Loss: 1.327 Vali Loss: 3.034 Vali Acc: 0.199 Test Loss: 3.034 Test Acc: 0.199
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7713704109191895
Epoch: 19, Steps: 10 | Train Loss: 1.089 Vali Loss: 3.012 Vali Acc: 0.208 Test Loss: 3.012 Test Acc: 0.208
Validation loss decreased (-0.202323 --> -0.208205).  Saving model ...
Epoch: 20 cost time: 1.8021061420440674
Epoch: 20, Steps: 10 | Train Loss: 0.932 Vali Loss: 3.005 Vali Acc: 0.222 Test Loss: 3.005 Test Acc: 0.222
Validation loss decreased (-0.208205 --> -0.222323).  Saving model ...
Epoch: 21 cost time: 1.9030506610870361
Epoch: 21, Steps: 10 | Train Loss: 0.851 Vali Loss: 3.002 Vali Acc: 0.222 Test Loss: 3.002 Test Acc: 0.222
Validation loss decreased (-0.222323 --> -0.222323).  Saving model ...
Epoch: 22 cost time: 1.8174471855163574
Epoch: 22, Steps: 10 | Train Loss: 0.756 Vali Loss: 3.011 Vali Acc: 0.231 Test Loss: 3.011 Test Acc: 0.231
Validation loss decreased (-0.222323 --> -0.230558).  Saving model ...
Epoch: 23 cost time: 1.917090892791748
Epoch: 23, Steps: 10 | Train Loss: 0.641 Vali Loss: 3.013 Vali Acc: 0.236 Test Loss: 3.013 Test Acc: 0.236
Validation loss decreased (-0.230558 --> -0.236440).  Saving model ...
Epoch: 24 cost time: 1.7815661430358887
Epoch: 24, Steps: 10 | Train Loss: 0.575 Vali Loss: 3.007 Vali Acc: 0.251 Test Loss: 3.007 Test Acc: 0.251
Validation loss decreased (-0.236440 --> -0.250558).  Saving model ...
Epoch: 25 cost time: 1.9322559833526611
Epoch: 25, Steps: 10 | Train Loss: 0.446 Vali Loss: 2.991 Vali Acc: 0.264 Test Loss: 2.991 Test Acc: 0.264
Validation loss decreased (-0.250558 --> -0.263500).  Saving model ...
Epoch: 26 cost time: 1.950077772140503
Epoch: 26, Steps: 10 | Train Loss: 0.424 Vali Loss: 3.006 Vali Acc: 0.256 Test Loss: 3.006 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.8797638416290283
Epoch: 27, Steps: 10 | Train Loss: 0.313 Vali Loss: 3.028 Vali Acc: 0.261 Test Loss: 3.028 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.8814067840576172
Epoch: 28, Steps: 10 | Train Loss: 0.357 Vali Loss: 3.020 Vali Acc: 0.274 Test Loss: 3.020 Test Acc: 0.274
Validation loss decreased (-0.263500 --> -0.274087).  Saving model ...
Epoch: 29 cost time: 1.911756992340088
Epoch: 29, Steps: 10 | Train Loss: 0.281 Vali Loss: 3.013 Vali Acc: 0.272 Test Loss: 3.013 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.8927137851715088
Epoch: 30, Steps: 10 | Train Loss: 0.190 Vali Loss: 3.014 Vali Acc: 0.272 Test Loss: 3.014 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2741176470588235
model parameter : 325202
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.3935608863830566
Epoch: 1, Steps: 10 | Train Loss: 3.314 Vali Loss: 3.319 Vali Acc: 0.039 Test Loss: 3.319 Test Acc: 0.039
Validation loss decreased (inf --> -0.038790).  Saving model ...
Epoch: 2 cost time: 1.4727942943572998
Epoch: 2, Steps: 10 | Train Loss: 3.294 Vali Loss: 3.300 Vali Acc: 0.040 Test Loss: 3.300 Test Acc: 0.040
Validation loss decreased (-0.038790 --> -0.039967).  Saving model ...
Epoch: 3 cost time: 1.4801714420318604
Epoch: 3, Steps: 10 | Train Loss: 3.220 Vali Loss: 3.284 Vali Acc: 0.044 Test Loss: 3.284 Test Acc: 0.044
Validation loss decreased (-0.039967 --> -0.043497).  Saving model ...
Epoch: 4 cost time: 1.51511812210083
Epoch: 4, Steps: 10 | Train Loss: 3.100 Vali Loss: 3.271 Vali Acc: 0.045 Test Loss: 3.271 Test Acc: 0.045
Validation loss decreased (-0.043497 --> -0.044673).  Saving model ...
Epoch: 5 cost time: 1.566035509109497
Epoch: 5, Steps: 10 | Train Loss: 3.050 Vali Loss: 3.271 Vali Acc: 0.060 Test Loss: 3.271 Test Acc: 0.060
Validation loss decreased (-0.044673 --> -0.059967).  Saving model ...
Epoch: 6 cost time: 1.4898428916931152
Epoch: 6, Steps: 10 | Train Loss: 2.982 Vali Loss: 3.270 Vali Acc: 0.066 Test Loss: 3.270 Test Acc: 0.066
Validation loss decreased (-0.059967 --> -0.065850).  Saving model ...
Epoch: 7 cost time: 1.5188777446746826
Epoch: 7, Steps: 10 | Train Loss: 2.890 Vali Loss: 3.258 Vali Acc: 0.088 Test Loss: 3.258 Test Acc: 0.088
Validation loss decreased (-0.065850 --> -0.088203).  Saving model ...
Epoch: 8 cost time: 1.4443352222442627
Epoch: 8, Steps: 10 | Train Loss: 2.803 Vali Loss: 3.248 Vali Acc: 0.089 Test Loss: 3.248 Test Acc: 0.089
Validation loss decreased (-0.088203 --> -0.089379).  Saving model ...
Epoch: 9 cost time: 1.4259305000305176
Epoch: 9, Steps: 10 | Train Loss: 2.686 Vali Loss: 3.227 Vali Acc: 0.104 Test Loss: 3.227 Test Acc: 0.104
Validation loss decreased (-0.089379 --> -0.103497).  Saving model ...
Epoch: 10 cost time: 1.472604513168335
Epoch: 10, Steps: 10 | Train Loss: 2.610 Vali Loss: 3.204 Vali Acc: 0.129 Test Loss: 3.204 Test Acc: 0.129
Validation loss decreased (-0.103497 --> -0.129380).  Saving model ...
Epoch: 11 cost time: 1.5176739692687988
Epoch: 11, Steps: 10 | Train Loss: 2.479 Vali Loss: 3.182 Vali Acc: 0.136 Test Loss: 3.182 Test Acc: 0.136
Validation loss decreased (-0.129380 --> -0.136439).  Saving model ...
Epoch: 12 cost time: 1.4302244186401367
Epoch: 12, Steps: 10 | Train Loss: 2.382 Vali Loss: 3.160 Vali Acc: 0.147 Test Loss: 3.160 Test Acc: 0.147
Validation loss decreased (-0.136439 --> -0.147027).  Saving model ...
Epoch: 13 cost time: 1.5018603801727295
Epoch: 13, Steps: 10 | Train Loss: 2.260 Vali Loss: 3.145 Vali Acc: 0.142 Test Loss: 3.145 Test Acc: 0.142
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.409494161605835
Epoch: 14, Steps: 10 | Train Loss: 2.158 Vali Loss: 3.124 Vali Acc: 0.160 Test Loss: 3.124 Test Acc: 0.160
Validation loss decreased (-0.147027 --> -0.159969).  Saving model ...
Epoch: 15 cost time: 1.3809442520141602
Epoch: 15, Steps: 10 | Train Loss: 1.987 Vali Loss: 3.105 Vali Acc: 0.173 Test Loss: 3.105 Test Acc: 0.173
Validation loss decreased (-0.159969 --> -0.172910).  Saving model ...
Epoch: 16 cost time: 1.4624738693237305
Epoch: 16, Steps: 10 | Train Loss: 1.869 Vali Loss: 3.088 Vali Acc: 0.185 Test Loss: 3.088 Test Acc: 0.185
Validation loss decreased (-0.172910 --> -0.184675).  Saving model ...
Epoch: 17 cost time: 1.4269921779632568
Epoch: 17, Steps: 10 | Train Loss: 1.720 Vali Loss: 3.072 Vali Acc: 0.188 Test Loss: 3.072 Test Acc: 0.188
Validation loss decreased (-0.184675 --> -0.188205).  Saving model ...
Epoch: 18 cost time: 1.5218660831451416
Epoch: 18, Steps: 10 | Train Loss: 1.600 Vali Loss: 3.071 Vali Acc: 0.196 Test Loss: 3.071 Test Acc: 0.196
Validation loss decreased (-0.188205 --> -0.196440).  Saving model ...
Epoch: 19 cost time: 1.548792839050293
Epoch: 19, Steps: 10 | Train Loss: 1.475 Vali Loss: 3.045 Vali Acc: 0.207 Test Loss: 3.045 Test Acc: 0.207
Validation loss decreased (-0.196440 --> -0.207028).  Saving model ...
Epoch: 20 cost time: 1.503551721572876
Epoch: 20, Steps: 10 | Train Loss: 1.327 Vali Loss: 3.022 Vali Acc: 0.215 Test Loss: 3.022 Test Acc: 0.215
Validation loss decreased (-0.207028 --> -0.215264).  Saving model ...
Epoch: 21 cost time: 1.575627088546753
Epoch: 21, Steps: 10 | Train Loss: 1.148 Vali Loss: 3.020 Vali Acc: 0.225 Test Loss: 3.020 Test Acc: 0.225
Validation loss decreased (-0.215264 --> -0.224676).  Saving model ...
Epoch: 22 cost time: 1.0357470512390137
Epoch: 22, Steps: 10 | Train Loss: 1.072 Vali Loss: 3.008 Vali Acc: 0.233 Test Loss: 3.008 Test Acc: 0.233
Validation loss decreased (-0.224676 --> -0.232911).  Saving model ...
Epoch: 23 cost time: 1.1097450256347656
Epoch: 23, Steps: 10 | Train Loss: 0.945 Vali Loss: 2.998 Vali Acc: 0.236 Test Loss: 2.998 Test Acc: 0.236
Validation loss decreased (-0.232911 --> -0.236441).  Saving model ...
Epoch: 24 cost time: 1.0470123291015625
Epoch: 24, Steps: 10 | Train Loss: 0.876 Vali Loss: 3.004 Vali Acc: 0.238 Test Loss: 3.004 Test Acc: 0.238
Validation loss decreased (-0.236441 --> -0.237617).  Saving model ...
Epoch: 25 cost time: 1.0505187511444092
Epoch: 25, Steps: 10 | Train Loss: 0.730 Vali Loss: 2.993 Vali Acc: 0.256 Test Loss: 2.993 Test Acc: 0.256
Validation loss decreased (-0.237617 --> -0.256441).  Saving model ...
Epoch: 26 cost time: 1.0655925273895264
Epoch: 26, Steps: 10 | Train Loss: 0.642 Vali Loss: 3.005 Vali Acc: 0.266 Test Loss: 3.005 Test Acc: 0.266
Validation loss decreased (-0.256441 --> -0.265852).  Saving model ...
Epoch: 27 cost time: 1.0961921215057373
Epoch: 27, Steps: 10 | Train Loss: 0.561 Vali Loss: 3.012 Vali Acc: 0.254 Test Loss: 3.012 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4532041549682617
Epoch: 28, Steps: 10 | Train Loss: 0.488 Vali Loss: 2.995 Vali Acc: 0.269 Test Loss: 2.995 Test Acc: 0.269
Validation loss decreased (-0.265852 --> -0.269382).  Saving model ...
Epoch: 29 cost time: 1.4046015739440918
Epoch: 29, Steps: 10 | Train Loss: 0.421 Vali Loss: 3.025 Vali Acc: 0.274 Test Loss: 3.025 Test Acc: 0.274
Validation loss decreased (-0.269382 --> -0.274087).  Saving model ...
Epoch: 30 cost time: 1.4758055210113525
Epoch: 30, Steps: 10 | Train Loss: 0.395 Vali Loss: 3.024 Vali Acc: 0.274 Test Loss: 3.024 Test Acc: 0.274
Validation loss decreased (-0.274087 --> -0.274087).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2741176470588235
model parameter : 118162
model size : 0.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.128535509109497
Epoch: 1, Steps: 10 | Train Loss: 3.355 Vali Loss: 3.281 Vali Acc: 0.045 Test Loss: 3.281 Test Acc: 0.045
Validation loss decreased (inf --> -0.044673).  Saving model ...
Epoch: 2 cost time: 1.406458854675293
Epoch: 2, Steps: 10 | Train Loss: 3.309 Vali Loss: 3.263 Vali Acc: 0.048 Test Loss: 3.263 Test Acc: 0.048
Validation loss decreased (-0.044673 --> -0.048203).  Saving model ...
Epoch: 3 cost time: 1.3526620864868164
Epoch: 3, Steps: 10 | Train Loss: 3.211 Vali Loss: 3.249 Vali Acc: 0.046 Test Loss: 3.249 Test Acc: 0.046
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2396347522735596
Epoch: 4, Steps: 10 | Train Loss: 3.137 Vali Loss: 3.244 Vali Acc: 0.060 Test Loss: 3.244 Test Acc: 0.060
Validation loss decreased (-0.048203 --> -0.059968).  Saving model ...
Epoch: 5 cost time: 1.4246881008148193
Epoch: 5, Steps: 10 | Train Loss: 3.001 Vali Loss: 3.246 Vali Acc: 0.066 Test Loss: 3.246 Test Acc: 0.066
Validation loss decreased (-0.059968 --> -0.065850).  Saving model ...
Epoch: 6 cost time: 1.2783222198486328
Epoch: 6, Steps: 10 | Train Loss: 2.945 Vali Loss: 3.249 Vali Acc: 0.072 Test Loss: 3.249 Test Acc: 0.072
Validation loss decreased (-0.065850 --> -0.071732).  Saving model ...
Epoch: 7 cost time: 1.419097900390625
Epoch: 7, Steps: 10 | Train Loss: 2.858 Vali Loss: 3.241 Vali Acc: 0.080 Test Loss: 3.241 Test Acc: 0.080
Validation loss decreased (-0.071732 --> -0.079968).  Saving model ...
Epoch: 8 cost time: 1.3913235664367676
Epoch: 8, Steps: 10 | Train Loss: 2.744 Vali Loss: 3.227 Vali Acc: 0.098 Test Loss: 3.227 Test Acc: 0.098
Validation loss decreased (-0.079968 --> -0.097615).  Saving model ...
Epoch: 9 cost time: 1.4709062576293945
Epoch: 9, Steps: 10 | Train Loss: 2.730 Vali Loss: 3.208 Vali Acc: 0.118 Test Loss: 3.208 Test Acc: 0.118
Validation loss decreased (-0.097615 --> -0.117615).  Saving model ...
Epoch: 10 cost time: 1.4391815662384033
Epoch: 10, Steps: 10 | Train Loss: 2.547 Vali Loss: 3.178 Vali Acc: 0.136 Test Loss: 3.178 Test Acc: 0.136
Validation loss decreased (-0.117615 --> -0.136439).  Saving model ...
Epoch: 11 cost time: 1.4243767261505127
Epoch: 11, Steps: 10 | Train Loss: 2.411 Vali Loss: 3.167 Vali Acc: 0.129 Test Loss: 3.167 Test Acc: 0.129
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3786311149597168
Epoch: 12, Steps: 10 | Train Loss: 2.287 Vali Loss: 3.146 Vali Acc: 0.146 Test Loss: 3.146 Test Acc: 0.146
Validation loss decreased (-0.136439 --> -0.145851).  Saving model ...
Epoch: 13 cost time: 1.503824234008789
Epoch: 13, Steps: 10 | Train Loss: 2.143 Vali Loss: 3.131 Vali Acc: 0.159 Test Loss: 3.131 Test Acc: 0.159
Validation loss decreased (-0.145851 --> -0.158792).  Saving model ...
Epoch: 14 cost time: 1.4351997375488281
Epoch: 14, Steps: 10 | Train Loss: 2.002 Vali Loss: 3.110 Vali Acc: 0.160 Test Loss: 3.110 Test Acc: 0.160
Validation loss decreased (-0.158792 --> -0.159969).  Saving model ...
Epoch: 15 cost time: 1.3159072399139404
Epoch: 15, Steps: 10 | Train Loss: 1.855 Vali Loss: 3.093 Vali Acc: 0.184 Test Loss: 3.093 Test Acc: 0.184
Validation loss decreased (-0.159969 --> -0.183498).  Saving model ...
Epoch: 16 cost time: 1.2578372955322266
Epoch: 16, Steps: 10 | Train Loss: 1.676 Vali Loss: 3.080 Vali Acc: 0.189 Test Loss: 3.080 Test Acc: 0.189
Validation loss decreased (-0.183498 --> -0.189381).  Saving model ...
Epoch: 17 cost time: 0.9937188625335693
Epoch: 17, Steps: 10 | Train Loss: 1.543 Vali Loss: 3.059 Vali Acc: 0.193 Test Loss: 3.059 Test Acc: 0.193
Validation loss decreased (-0.189381 --> -0.192911).  Saving model ...
Epoch: 18 cost time: 1.2943274974822998
Epoch: 18, Steps: 10 | Train Loss: 1.420 Vali Loss: 3.039 Vali Acc: 0.213 Test Loss: 3.039 Test Acc: 0.213
Validation loss decreased (-0.192911 --> -0.212911).  Saving model ...
Epoch: 19 cost time: 1.2086751461029053
Epoch: 19, Steps: 10 | Train Loss: 1.282 Vali Loss: 3.018 Vali Acc: 0.213 Test Loss: 3.018 Test Acc: 0.213
Validation loss decreased (-0.212911 --> -0.212911).  Saving model ...
Epoch: 20 cost time: 1.5031521320343018
Epoch: 20, Steps: 10 | Train Loss: 1.117 Vali Loss: 3.020 Vali Acc: 0.221 Test Loss: 3.020 Test Acc: 0.221
Validation loss decreased (-0.212911 --> -0.221146).  Saving model ...
Epoch: 21 cost time: 1.5155324935913086
Epoch: 21, Steps: 10 | Train Loss: 1.030 Vali Loss: 3.024 Vali Acc: 0.221 Test Loss: 3.024 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4211702346801758
Epoch: 22, Steps: 10 | Train Loss: 0.899 Vali Loss: 3.017 Vali Acc: 0.229 Test Loss: 3.017 Test Acc: 0.229
Validation loss decreased (-0.221146 --> -0.229382).  Saving model ...
Epoch: 23 cost time: 1.5847194194793701
Epoch: 23, Steps: 10 | Train Loss: 0.812 Vali Loss: 3.005 Vali Acc: 0.242 Test Loss: 3.005 Test Acc: 0.242
Validation loss decreased (-0.229382 --> -0.242323).  Saving model ...
Epoch: 24 cost time: 1.501417636871338
Epoch: 24, Steps: 10 | Train Loss: 0.658 Vali Loss: 2.993 Vali Acc: 0.236 Test Loss: 2.993 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.55548095703125
Epoch: 25, Steps: 10 | Train Loss: 0.647 Vali Loss: 3.013 Vali Acc: 0.254 Test Loss: 3.013 Test Acc: 0.254
Validation loss decreased (-0.242323 --> -0.254088).  Saving model ...
Epoch: 26 cost time: 1.4467434883117676
Epoch: 26, Steps: 10 | Train Loss: 0.488 Vali Loss: 2.986 Vali Acc: 0.246 Test Loss: 2.986 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.364342212677002
Epoch: 27, Steps: 10 | Train Loss: 0.414 Vali Loss: 3.053 Vali Acc: 0.254 Test Loss: 3.053 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.3202285766601562
Epoch: 28, Steps: 10 | Train Loss: 0.462 Vali Loss: 3.021 Vali Acc: 0.244 Test Loss: 3.021 Test Acc: 0.244
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.4200561046600342
Epoch: 29, Steps: 10 | Train Loss: 0.344 Vali Loss: 3.013 Vali Acc: 0.254 Test Loss: 3.013 Test Acc: 0.254
Validation loss decreased (-0.254088 --> -0.254088).  Saving model ...
Epoch: 30 cost time: 1.449465274810791
Epoch: 30, Steps: 10 | Train Loss: 0.268 Vali Loss: 3.015 Vali Acc: 0.258 Test Loss: 3.015 Test Acc: 0.258
Validation loss decreased (-0.254088 --> -0.257617).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2576470588235294
model parameter : 325202
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.561537027359009
Epoch: 1, Steps: 10 | Train Loss: 3.319 Vali Loss: 3.319 Vali Acc: 0.042 Test Loss: 3.319 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 1.2643694877624512
Epoch: 2, Steps: 10 | Train Loss: 3.292 Vali Loss: 3.301 Vali Acc: 0.041 Test Loss: 3.301 Test Acc: 0.041
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2682034969329834
Epoch: 3, Steps: 10 | Train Loss: 3.234 Vali Loss: 3.287 Vali Acc: 0.046 Test Loss: 3.287 Test Acc: 0.046
Validation loss decreased (-0.042320 --> -0.045849).  Saving model ...
Epoch: 4 cost time: 1.2503764629364014
Epoch: 4, Steps: 10 | Train Loss: 3.122 Vali Loss: 3.273 Vali Acc: 0.046 Test Loss: 3.273 Test Acc: 0.046
Validation loss decreased (-0.045849 --> -0.045850).  Saving model ...
Epoch: 5 cost time: 1.2943634986877441
Epoch: 5, Steps: 10 | Train Loss: 3.066 Vali Loss: 3.273 Vali Acc: 0.061 Test Loss: 3.273 Test Acc: 0.061
Validation loss decreased (-0.045850 --> -0.061144).  Saving model ...
Epoch: 6 cost time: 1.2650675773620605
Epoch: 6, Steps: 10 | Train Loss: 2.991 Vali Loss: 3.273 Vali Acc: 0.069 Test Loss: 3.273 Test Acc: 0.069
Validation loss decreased (-0.061144 --> -0.069379).  Saving model ...
Epoch: 7 cost time: 1.1901137828826904
Epoch: 7, Steps: 10 | Train Loss: 2.897 Vali Loss: 3.260 Vali Acc: 0.080 Test Loss: 3.260 Test Acc: 0.080
Validation loss decreased (-0.069379 --> -0.079967).  Saving model ...
Epoch: 8 cost time: 1.17657470703125
Epoch: 8, Steps: 10 | Train Loss: 2.824 Vali Loss: 3.249 Vali Acc: 0.086 Test Loss: 3.249 Test Acc: 0.086
Validation loss decreased (-0.079967 --> -0.085850).  Saving model ...
Epoch: 9 cost time: 1.128253698348999
Epoch: 9, Steps: 10 | Train Loss: 2.710 Vali Loss: 3.230 Vali Acc: 0.106 Test Loss: 3.230 Test Acc: 0.106
Validation loss decreased (-0.085850 --> -0.105850).  Saving model ...
Epoch: 10 cost time: 1.1081244945526123
Epoch: 10, Steps: 10 | Train Loss: 2.641 Vali Loss: 3.208 Vali Acc: 0.115 Test Loss: 3.208 Test Acc: 0.115
Validation loss decreased (-0.105850 --> -0.115262).  Saving model ...
Epoch: 11 cost time: 1.110865831375122
Epoch: 11, Steps: 10 | Train Loss: 2.515 Vali Loss: 3.185 Vali Acc: 0.135 Test Loss: 3.185 Test Acc: 0.135
Validation loss decreased (-0.115262 --> -0.135262).  Saving model ...
Epoch: 12 cost time: 1.1778907775878906
Epoch: 12, Steps: 10 | Train Loss: 2.398 Vali Loss: 3.161 Vali Acc: 0.152 Test Loss: 3.161 Test Acc: 0.152
Validation loss decreased (-0.135262 --> -0.151733).  Saving model ...
Epoch: 13 cost time: 1.2145888805389404
Epoch: 13, Steps: 10 | Train Loss: 2.293 Vali Loss: 3.144 Vali Acc: 0.142 Test Loss: 3.144 Test Acc: 0.142
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2505664825439453
Epoch: 14, Steps: 10 | Train Loss: 2.189 Vali Loss: 3.125 Vali Acc: 0.158 Test Loss: 3.125 Test Acc: 0.158
Validation loss decreased (-0.151733 --> -0.157616).  Saving model ...
Epoch: 15 cost time: 1.2336759567260742
Epoch: 15, Steps: 10 | Train Loss: 2.023 Vali Loss: 3.106 Vali Acc: 0.168 Test Loss: 3.106 Test Acc: 0.168
Validation loss decreased (-0.157616 --> -0.168204).  Saving model ...
Epoch: 16 cost time: 1.1864936351776123
Epoch: 16, Steps: 10 | Train Loss: 1.923 Vali Loss: 3.085 Vali Acc: 0.171 Test Loss: 3.085 Test Acc: 0.171
Validation loss decreased (-0.168204 --> -0.170557).  Saving model ...
Epoch: 17 cost time: 1.2375099658966064
Epoch: 17, Steps: 10 | Train Loss: 1.781 Vali Loss: 3.062 Vali Acc: 0.188 Test Loss: 3.062 Test Acc: 0.188
Validation loss decreased (-0.170557 --> -0.188205).  Saving model ...
Epoch: 18 cost time: 1.2609543800354004
Epoch: 18, Steps: 10 | Train Loss: 1.672 Vali Loss: 3.053 Vali Acc: 0.192 Test Loss: 3.053 Test Acc: 0.192
Validation loss decreased (-0.188205 --> -0.191734).  Saving model ...
Epoch: 19 cost time: 1.2829558849334717
Epoch: 19, Steps: 10 | Train Loss: 1.570 Vali Loss: 3.029 Vali Acc: 0.199 Test Loss: 3.029 Test Acc: 0.199
Validation loss decreased (-0.191734 --> -0.198793).  Saving model ...
Epoch: 20 cost time: 1.326850414276123
Epoch: 20, Steps: 10 | Train Loss: 1.426 Vali Loss: 3.006 Vali Acc: 0.207 Test Loss: 3.006 Test Acc: 0.207
Validation loss decreased (-0.198793 --> -0.207029).  Saving model ...
Epoch: 21 cost time: 1.307978630065918
Epoch: 21, Steps: 10 | Train Loss: 1.216 Vali Loss: 3.001 Vali Acc: 0.221 Test Loss: 3.001 Test Acc: 0.221
Validation loss decreased (-0.207029 --> -0.221146).  Saving model ...
Epoch: 22 cost time: 1.2695438861846924
Epoch: 22, Steps: 10 | Train Loss: 1.160 Vali Loss: 2.988 Vali Acc: 0.226 Test Loss: 2.988 Test Acc: 0.226
Validation loss decreased (-0.221146 --> -0.225852).  Saving model ...
Epoch: 23 cost time: 1.1832683086395264
Epoch: 23, Steps: 10 | Train Loss: 1.042 Vali Loss: 2.974 Vali Acc: 0.244 Test Loss: 2.974 Test Acc: 0.244
Validation loss decreased (-0.225852 --> -0.243500).  Saving model ...
Epoch: 24 cost time: 1.1212832927703857
Epoch: 24, Steps: 10 | Train Loss: 0.943 Vali Loss: 2.985 Vali Acc: 0.241 Test Loss: 2.985 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2165944576263428
Epoch: 25, Steps: 10 | Train Loss: 0.803 Vali Loss: 2.971 Vali Acc: 0.248 Test Loss: 2.971 Test Acc: 0.248
Validation loss decreased (-0.243500 --> -0.248206).  Saving model ...
Epoch: 26 cost time: 1.257493495941162
Epoch: 26, Steps: 10 | Train Loss: 0.777 Vali Loss: 2.971 Vali Acc: 0.253 Test Loss: 2.971 Test Acc: 0.253
Validation loss decreased (-0.248206 --> -0.252911).  Saving model ...
Epoch: 27 cost time: 1.2534403800964355
Epoch: 27, Steps: 10 | Train Loss: 0.643 Vali Loss: 2.969 Vali Acc: 0.249 Test Loss: 2.969 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2158403396606445
Epoch: 28, Steps: 10 | Train Loss: 0.555 Vali Loss: 2.969 Vali Acc: 0.258 Test Loss: 2.969 Test Acc: 0.258
Validation loss decreased (-0.252911 --> -0.257617).  Saving model ...
Epoch: 29 cost time: 1.2466249465942383
Epoch: 29, Steps: 10 | Train Loss: 0.486 Vali Loss: 2.965 Vali Acc: 0.271 Test Loss: 2.965 Test Acc: 0.271
Validation loss decreased (-0.257617 --> -0.270559).  Saving model ...
Epoch: 30 cost time: 1.2148144245147705
Epoch: 30, Steps: 10 | Train Loss: 0.428 Vali Loss: 2.972 Vali Acc: 0.266 Test Loss: 2.972 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27058823529411763
model parameter : 118162
model size : 0.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.8335630893707275
Epoch: 1, Steps: 10 | Train Loss: 3.353 Vali Loss: 3.281 Vali Acc: 0.049 Test Loss: 3.281 Test Acc: 0.049
Validation loss decreased (inf --> -0.049379).  Saving model ...
Epoch: 2 cost time: 1.1589527130126953
Epoch: 2, Steps: 10 | Train Loss: 3.299 Vali Loss: 3.262 Vali Acc: 0.044 Test Loss: 3.262 Test Acc: 0.044
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1795942783355713
Epoch: 3, Steps: 10 | Train Loss: 3.206 Vali Loss: 3.250 Vali Acc: 0.044 Test Loss: 3.250 Test Acc: 0.044
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0556144714355469
Epoch: 4, Steps: 10 | Train Loss: 3.135 Vali Loss: 3.248 Vali Acc: 0.066 Test Loss: 3.248 Test Acc: 0.066
Validation loss decreased (-0.049379 --> -0.065850).  Saving model ...
Epoch: 5 cost time: 1.0142345428466797
Epoch: 5, Steps: 10 | Train Loss: 2.999 Vali Loss: 3.250 Vali Acc: 0.054 Test Loss: 3.250 Test Acc: 0.054
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.059288501739502
Epoch: 6, Steps: 10 | Train Loss: 2.948 Vali Loss: 3.252 Vali Acc: 0.078 Test Loss: 3.252 Test Acc: 0.078
Validation loss decreased (-0.065850 --> -0.077615).  Saving model ...
Epoch: 7 cost time: 1.0363056659698486
Epoch: 7, Steps: 10 | Train Loss: 2.864 Vali Loss: 3.246 Vali Acc: 0.081 Test Loss: 3.246 Test Acc: 0.081
Validation loss decreased (-0.077615 --> -0.081144).  Saving model ...
Epoch: 8 cost time: 1.1499443054199219
Epoch: 8, Steps: 10 | Train Loss: 2.797 Vali Loss: 3.236 Vali Acc: 0.087 Test Loss: 3.236 Test Acc: 0.087
Validation loss decreased (-0.081144 --> -0.087026).  Saving model ...
Epoch: 9 cost time: 1.3185718059539795
Epoch: 9, Steps: 10 | Train Loss: 2.761 Vali Loss: 3.222 Vali Acc: 0.094 Test Loss: 3.222 Test Acc: 0.094
Validation loss decreased (-0.087026 --> -0.094085).  Saving model ...
Epoch: 10 cost time: 1.2251620292663574
Epoch: 10, Steps: 10 | Train Loss: 2.598 Vali Loss: 3.199 Vali Acc: 0.111 Test Loss: 3.199 Test Acc: 0.111
Validation loss decreased (-0.094085 --> -0.110556).  Saving model ...
Epoch: 11 cost time: 1.163724660873413
Epoch: 11, Steps: 10 | Train Loss: 2.481 Vali Loss: 3.189 Vali Acc: 0.116 Test Loss: 3.189 Test Acc: 0.116
Validation loss decreased (-0.110556 --> -0.116439).  Saving model ...
Epoch: 12 cost time: 1.1611096858978271
Epoch: 12, Steps: 10 | Train Loss: 2.349 Vali Loss: 3.173 Vali Acc: 0.133 Test Loss: 3.173 Test Acc: 0.133
Validation loss decreased (-0.116439 --> -0.132909).  Saving model ...
Epoch: 13 cost time: 1.1787102222442627
Epoch: 13, Steps: 10 | Train Loss: 2.250 Vali Loss: 3.166 Vali Acc: 0.136 Test Loss: 3.166 Test Acc: 0.136
Validation loss decreased (-0.132909 --> -0.136439).  Saving model ...
Epoch: 14 cost time: 1.3000717163085938
Epoch: 14, Steps: 10 | Train Loss: 2.056 Vali Loss: 3.160 Vali Acc: 0.142 Test Loss: 3.160 Test Acc: 0.142
Validation loss decreased (-0.136439 --> -0.142321).  Saving model ...
Epoch: 15 cost time: 1.3376216888427734
Epoch: 15, Steps: 10 | Train Loss: 2.043 Vali Loss: 3.147 Vali Acc: 0.146 Test Loss: 3.147 Test Acc: 0.146
Validation loss decreased (-0.142321 --> -0.145851).  Saving model ...
Epoch: 16 cost time: 1.3322639465332031
Epoch: 16, Steps: 10 | Train Loss: 1.877 Vali Loss: 3.138 Vali Acc: 0.154 Test Loss: 3.138 Test Acc: 0.154
Validation loss decreased (-0.145851 --> -0.154086).  Saving model ...
Epoch: 17 cost time: 1.1092808246612549
Epoch: 17, Steps: 10 | Train Loss: 1.742 Vali Loss: 3.128 Vali Acc: 0.153 Test Loss: 3.128 Test Acc: 0.153
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1165027618408203
Epoch: 18, Steps: 10 | Train Loss: 1.615 Vali Loss: 3.124 Vali Acc: 0.168 Test Loss: 3.124 Test Acc: 0.168
Validation loss decreased (-0.154086 --> -0.168204).  Saving model ...
Epoch: 19 cost time: 1.1970088481903076
Epoch: 19, Steps: 10 | Train Loss: 1.502 Vali Loss: 3.115 Vali Acc: 0.181 Test Loss: 3.115 Test Acc: 0.181
Validation loss decreased (-0.168204 --> -0.181145).  Saving model ...
Epoch: 20 cost time: 1.0914883613586426
Epoch: 20, Steps: 10 | Train Loss: 1.270 Vali Loss: 3.104 Vali Acc: 0.188 Test Loss: 3.104 Test Acc: 0.188
Validation loss decreased (-0.181145 --> -0.188204).  Saving model ...
Epoch: 21 cost time: 1.1986310482025146
Epoch: 21, Steps: 10 | Train Loss: 1.198 Vali Loss: 3.103 Vali Acc: 0.196 Test Loss: 3.103 Test Acc: 0.196
Validation loss decreased (-0.188204 --> -0.196440).  Saving model ...
Epoch: 22 cost time: 1.2491438388824463
Epoch: 22, Steps: 10 | Train Loss: 1.136 Vali Loss: 3.094 Vali Acc: 0.199 Test Loss: 3.094 Test Acc: 0.199
Validation loss decreased (-0.196440 --> -0.198793).  Saving model ...
Epoch: 23 cost time: 1.3227455615997314
Epoch: 23, Steps: 10 | Train Loss: 1.009 Vali Loss: 3.095 Vali Acc: 0.224 Test Loss: 3.095 Test Acc: 0.224
Validation loss decreased (-0.198793 --> -0.223498).  Saving model ...
Epoch: 24 cost time: 1.254833698272705
Epoch: 24, Steps: 10 | Train Loss: 0.800 Vali Loss: 3.105 Vali Acc: 0.225 Test Loss: 3.105 Test Acc: 0.225
Validation loss decreased (-0.223498 --> -0.224675).  Saving model ...
Epoch: 25 cost time: 1.2940552234649658
Epoch: 25, Steps: 10 | Train Loss: 0.837 Vali Loss: 3.090 Vali Acc: 0.240 Test Loss: 3.090 Test Acc: 0.240
Validation loss decreased (-0.224675 --> -0.239969).  Saving model ...
Epoch: 26 cost time: 1.2424628734588623
Epoch: 26, Steps: 10 | Train Loss: 0.735 Vali Loss: 3.090 Vali Acc: 0.233 Test Loss: 3.090 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.258624792098999
Epoch: 27, Steps: 10 | Train Loss: 0.551 Vali Loss: 3.075 Vali Acc: 0.249 Test Loss: 3.075 Test Acc: 0.249
Validation loss decreased (-0.239969 --> -0.249381).  Saving model ...
Epoch: 28 cost time: 1.2016844749450684
Epoch: 28, Steps: 10 | Train Loss: 0.505 Vali Loss: 3.100 Vali Acc: 0.251 Test Loss: 3.100 Test Acc: 0.251
Validation loss decreased (-0.249381 --> -0.250557).  Saving model ...
Epoch: 29 cost time: 1.2406561374664307
Epoch: 29, Steps: 10 | Train Loss: 0.462 Vali Loss: 3.116 Vali Acc: 0.254 Test Loss: 3.116 Test Acc: 0.254
Validation loss decreased (-0.250557 --> -0.254086).  Saving model ...
Epoch: 30 cost time: 0.9532186985015869
Epoch: 30, Steps: 10 | Train Loss: 0.501 Vali Loss: 3.129 Vali Acc: 0.254 Test Loss: 3.129 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2541176470588235
model parameter : 325202
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.172100782394409
Epoch: 1, Steps: 10 | Train Loss: 3.315 Vali Loss: 3.327 Vali Acc: 0.035 Test Loss: 3.327 Test Acc: 0.035
Validation loss decreased (inf --> -0.035261).  Saving model ...
Epoch: 2 cost time: 0.9386048316955566
Epoch: 2, Steps: 10 | Train Loss: 3.285 Vali Loss: 3.308 Vali Acc: 0.035 Test Loss: 3.308 Test Acc: 0.035
Validation loss decreased (-0.035261 --> -0.035261).  Saving model ...
Epoch: 3 cost time: 1.0026862621307373
Epoch: 3, Steps: 10 | Train Loss: 3.221 Vali Loss: 3.293 Vali Acc: 0.032 Test Loss: 3.293 Test Acc: 0.032
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1062071323394775
Epoch: 4, Steps: 10 | Train Loss: 3.129 Vali Loss: 3.280 Vali Acc: 0.036 Test Loss: 3.280 Test Acc: 0.036
Validation loss decreased (-0.035261 --> -0.036438).  Saving model ...
Epoch: 5 cost time: 1.000290870666504
Epoch: 5, Steps: 10 | Train Loss: 3.081 Vali Loss: 3.282 Vali Acc: 0.049 Test Loss: 3.282 Test Acc: 0.049
Validation loss decreased (-0.036438 --> -0.049379).  Saving model ...
Epoch: 6 cost time: 1.0651662349700928
Epoch: 6, Steps: 10 | Train Loss: 3.011 Vali Loss: 3.282 Vali Acc: 0.061 Test Loss: 3.282 Test Acc: 0.061
Validation loss decreased (-0.049379 --> -0.061144).  Saving model ...
Epoch: 7 cost time: 1.0064702033996582
Epoch: 7, Steps: 10 | Train Loss: 2.918 Vali Loss: 3.272 Vali Acc: 0.073 Test Loss: 3.272 Test Acc: 0.073
Validation loss decreased (-0.061144 --> -0.072908).  Saving model ...
Epoch: 8 cost time: 0.9559707641601562
Epoch: 8, Steps: 10 | Train Loss: 2.855 Vali Loss: 3.263 Vali Acc: 0.079 Test Loss: 3.263 Test Acc: 0.079
Validation loss decreased (-0.072908 --> -0.078791).  Saving model ...
Epoch: 9 cost time: 1.0517215728759766
Epoch: 9, Steps: 10 | Train Loss: 2.780 Vali Loss: 3.248 Vali Acc: 0.091 Test Loss: 3.248 Test Acc: 0.091
Validation loss decreased (-0.078791 --> -0.090556).  Saving model ...
Epoch: 10 cost time: 1.0317974090576172
Epoch: 10, Steps: 10 | Train Loss: 2.685 Vali Loss: 3.231 Vali Acc: 0.104 Test Loss: 3.231 Test Acc: 0.104
Validation loss decreased (-0.090556 --> -0.103497).  Saving model ...
Epoch: 11 cost time: 1.0666751861572266
Epoch: 11, Steps: 10 | Train Loss: 2.589 Vali Loss: 3.213 Vali Acc: 0.114 Test Loss: 3.213 Test Acc: 0.114
Validation loss decreased (-0.103497 --> -0.114086).  Saving model ...
Epoch: 12 cost time: 1.016206979751587
Epoch: 12, Steps: 10 | Train Loss: 2.488 Vali Loss: 3.196 Vali Acc: 0.125 Test Loss: 3.196 Test Acc: 0.125
Validation loss decreased (-0.114086 --> -0.124674).  Saving model ...
Epoch: 13 cost time: 0.9399712085723877
Epoch: 13, Steps: 10 | Train Loss: 2.387 Vali Loss: 3.181 Vali Acc: 0.119 Test Loss: 3.181 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9935088157653809
Epoch: 14, Steps: 10 | Train Loss: 2.276 Vali Loss: 3.160 Vali Acc: 0.131 Test Loss: 3.160 Test Acc: 0.131
Validation loss decreased (-0.124674 --> -0.130557).  Saving model ...
Epoch: 15 cost time: 0.8772070407867432
Epoch: 15, Steps: 10 | Train Loss: 2.138 Vali Loss: 3.147 Vali Acc: 0.141 Test Loss: 3.147 Test Acc: 0.141
Validation loss decreased (-0.130557 --> -0.141145).  Saving model ...
Epoch: 16 cost time: 0.9000074863433838
Epoch: 16, Steps: 10 | Train Loss: 2.046 Vali Loss: 3.130 Vali Acc: 0.142 Test Loss: 3.130 Test Acc: 0.142
Validation loss decreased (-0.141145 --> -0.142322).  Saving model ...
Epoch: 17 cost time: 0.9988367557525635
Epoch: 17, Steps: 10 | Train Loss: 1.978 Vali Loss: 3.110 Vali Acc: 0.155 Test Loss: 3.110 Test Acc: 0.155
Validation loss decreased (-0.142322 --> -0.155263).  Saving model ...
Epoch: 18 cost time: 1.020573616027832
Epoch: 18, Steps: 10 | Train Loss: 1.817 Vali Loss: 3.108 Vali Acc: 0.156 Test Loss: 3.108 Test Acc: 0.156
Validation loss decreased (-0.155263 --> -0.156440).  Saving model ...
Epoch: 19 cost time: 1.028223991394043
Epoch: 19, Steps: 10 | Train Loss: 1.737 Vali Loss: 3.090 Vali Acc: 0.162 Test Loss: 3.090 Test Acc: 0.162
Validation loss decreased (-0.156440 --> -0.162322).  Saving model ...
Epoch: 20 cost time: 1.0251233577728271
Epoch: 20, Steps: 10 | Train Loss: 1.593 Vali Loss: 3.071 Vali Acc: 0.168 Test Loss: 3.071 Test Acc: 0.168
Validation loss decreased (-0.162322 --> -0.168205).  Saving model ...
Epoch: 21 cost time: 1.0847368240356445
Epoch: 21, Steps: 10 | Train Loss: 1.436 Vali Loss: 3.067 Vali Acc: 0.178 Test Loss: 3.067 Test Acc: 0.178
Validation loss decreased (-0.168205 --> -0.177616).  Saving model ...
Epoch: 22 cost time: 1.0748350620269775
Epoch: 22, Steps: 10 | Train Loss: 1.371 Vali Loss: 3.053 Vali Acc: 0.189 Test Loss: 3.053 Test Acc: 0.189
Validation loss decreased (-0.177616 --> -0.189381).  Saving model ...
Epoch: 23 cost time: 1.045942783355713
Epoch: 23, Steps: 10 | Train Loss: 1.269 Vali Loss: 3.028 Vali Acc: 0.205 Test Loss: 3.028 Test Acc: 0.205
Validation loss decreased (-0.189381 --> -0.204676).  Saving model ...
Epoch: 24 cost time: 1.029141902923584
Epoch: 24, Steps: 10 | Train Loss: 1.217 Vali Loss: 3.038 Vali Acc: 0.216 Test Loss: 3.038 Test Acc: 0.216
Validation loss decreased (-0.204676 --> -0.216440).  Saving model ...
Epoch: 25 cost time: 1.068666934967041
Epoch: 25, Steps: 10 | Train Loss: 1.044 Vali Loss: 3.034 Vali Acc: 0.221 Test Loss: 3.034 Test Acc: 0.221
Validation loss decreased (-0.216440 --> -0.221146).  Saving model ...
Epoch: 26 cost time: 1.1272718906402588
Epoch: 26, Steps: 10 | Train Loss: 0.983 Vali Loss: 3.033 Vali Acc: 0.235 Test Loss: 3.033 Test Acc: 0.235
Validation loss decreased (-0.221146 --> -0.235264).  Saving model ...
Epoch: 27 cost time: 1.0097997188568115
Epoch: 27, Steps: 10 | Train Loss: 0.849 Vali Loss: 3.019 Vali Acc: 0.232 Test Loss: 3.019 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.90378737449646
Epoch: 28, Steps: 10 | Train Loss: 0.723 Vali Loss: 3.038 Vali Acc: 0.239 Test Loss: 3.038 Test Acc: 0.239
Validation loss decreased (-0.235264 --> -0.238793).  Saving model ...
Epoch: 29 cost time: 0.8622963428497314
Epoch: 29, Steps: 10 | Train Loss: 0.700 Vali Loss: 3.039 Vali Acc: 0.242 Test Loss: 3.039 Test Acc: 0.242
Validation loss decreased (-0.238793 --> -0.242323).  Saving model ...
Epoch: 30 cost time: 0.8661375045776367
Epoch: 30, Steps: 10 | Train Loss: 0.647 Vali Loss: 3.036 Vali Acc: 0.254 Test Loss: 3.036 Test Acc: 0.254
Validation loss decreased (-0.242323 --> -0.254087).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el4_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2541176470588235
model parameter : 118162
model size : 0.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 13.642656564712524
Epoch: 1, Steps: 10 | Train Loss: 3.299 Vali Loss: 3.280 Vali Acc: 0.059 Test Loss: 3.280 Test Acc: 0.059
Validation loss decreased (inf --> -0.058791).  Saving model ...
Epoch: 2 cost time: 13.032042503356934
Epoch: 2, Steps: 10 | Train Loss: 2.723 Vali Loss: 3.233 Vali Acc: 0.139 Test Loss: 3.233 Test Acc: 0.139
Validation loss decreased (-0.058791 --> -0.138791).  Saving model ...
Epoch: 3 cost time: 10.535584688186646
Epoch: 3, Steps: 10 | Train Loss: 1.742 Vali Loss: 3.037 Vali Acc: 0.199 Test Loss: 3.037 Test Acc: 0.199
Validation loss decreased (-0.138791 --> -0.198793).  Saving model ...
Epoch: 4 cost time: 12.60253643989563
Epoch: 4, Steps: 10 | Train Loss: 1.008 Vali Loss: 3.075 Vali Acc: 0.229 Test Loss: 3.075 Test Acc: 0.229
Validation loss decreased (-0.198793 --> -0.229381).  Saving model ...
Epoch: 5 cost time: 12.455631732940674
Epoch: 5, Steps: 10 | Train Loss: 0.560 Vali Loss: 3.054 Vali Acc: 0.255 Test Loss: 3.054 Test Acc: 0.255
Validation loss decreased (-0.229381 --> -0.255264).  Saving model ...
Epoch: 6 cost time: 10.50881052017212
Epoch: 6, Steps: 10 | Train Loss: 0.205 Vali Loss: 3.167 Vali Acc: 0.273 Test Loss: 3.167 Test Acc: 0.273
Validation loss decreased (-0.255264 --> -0.272910).  Saving model ...
Epoch: 7 cost time: 12.617536544799805
Epoch: 7, Steps: 10 | Train Loss: 0.212 Vali Loss: 3.129 Vali Acc: 0.296 Test Loss: 3.129 Test Acc: 0.296
Validation loss decreased (-0.272910 --> -0.296439).  Saving model ...
Epoch: 8 cost time: 12.566275596618652
Epoch: 8, Steps: 10 | Train Loss: 0.060 Vali Loss: 3.193 Vali Acc: 0.306 Test Loss: 3.193 Test Acc: 0.306
Validation loss decreased (-0.296439 --> -0.305850).  Saving model ...
Epoch: 9 cost time: 10.9096200466156
Epoch: 9, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.421 Vali Acc: 0.311 Test Loss: 3.421 Test Acc: 0.311
Validation loss decreased (-0.305850 --> -0.310554).  Saving model ...
Epoch: 10 cost time: 12.641432523727417
Epoch: 10, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.536 Vali Acc: 0.281 Test Loss: 3.536 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 11.539334535598755
Epoch: 11, Steps: 10 | Train Loss: 0.067 Vali Loss: 3.517 Vali Acc: 0.279 Test Loss: 3.517 Test Acc: 0.279
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 10.776053190231323
Epoch: 12, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.579 Vali Acc: 0.302 Test Loss: 3.579 Test Acc: 0.302
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 12.507418632507324
Epoch: 13, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.566 Vali Acc: 0.318 Test Loss: 3.566 Test Acc: 0.318
Validation loss decreased (-0.310554 --> -0.317611).  Saving model ...
Epoch: 14 cost time: 10.956254959106445
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.559 Vali Acc: 0.318 Test Loss: 3.559 Test Acc: 0.318
Validation loss decreased (-0.317611 --> -0.317611).  Saving model ...
Epoch: 15 cost time: 10.006231784820557
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.544 Vali Acc: 0.322 Test Loss: 3.544 Test Acc: 0.322
Validation loss decreased (-0.317611 --> -0.322317).  Saving model ...
Epoch: 16 cost time: 7.198287487030029
Epoch: 16, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.439 Vali Acc: 0.316 Test Loss: 3.439 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 13.22715950012207
Epoch: 17, Steps: 10 | Train Loss: 0.081 Vali Loss: 3.853 Vali Acc: 0.288 Test Loss: 3.853 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 13.308844327926636
Epoch: 18, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.611 Vali Acc: 0.306 Test Loss: 3.611 Test Acc: 0.306
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 12.810333728790283
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.681 Vali Acc: 0.301 Test Loss: 3.681 Test Acc: 0.301
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 12.210012435913086
Epoch: 20, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.459 Vali Acc: 0.302 Test Loss: 3.459 Test Acc: 0.302
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 12.003824949264526
Epoch: 21, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.108 Vali Acc: 0.271 Test Loss: 4.108 Test Acc: 0.271
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 13.659588098526001
Epoch: 22, Steps: 10 | Train Loss: 0.055 Vali Loss: 4.181 Vali Acc: 0.245 Test Loss: 4.181 Test Acc: 0.245
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 13.123798608779907
Epoch: 23, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.176 Vali Acc: 0.266 Test Loss: 4.176 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 13.628688097000122
Epoch: 24, Steps: 10 | Train Loss: 0.064 Vali Loss: 4.196 Vali Acc: 0.246 Test Loss: 4.196 Test Acc: 0.246
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 12.156902313232422
Epoch: 25, Steps: 10 | Train Loss: 0.101 Vali Loss: 3.902 Vali Acc: 0.273 Test Loss: 3.902 Test Acc: 0.273
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.32235294117647056
model parameter : 56744602
model size : 218.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.961655855178833
Epoch: 1, Steps: 10 | Train Loss: 3.321 Vali Loss: 3.280 Vali Acc: 0.065 Test Loss: 3.280 Test Acc: 0.065
Validation loss decreased (inf --> -0.064673).  Saving model ...
Epoch: 2 cost time: 4.5182623863220215
Epoch: 2, Steps: 10 | Train Loss: 2.863 Vali Loss: 3.317 Vali Acc: 0.111 Test Loss: 3.317 Test Acc: 0.111
Validation loss decreased (-0.064673 --> -0.110555).  Saving model ...
Epoch: 3 cost time: 4.363715887069702
Epoch: 3, Steps: 10 | Train Loss: 2.000 Vali Loss: 2.996 Vali Acc: 0.208 Test Loss: 2.996 Test Acc: 0.208
Validation loss decreased (-0.110555 --> -0.208205).  Saving model ...
Epoch: 4 cost time: 4.556853771209717
Epoch: 4, Steps: 10 | Train Loss: 1.180 Vali Loss: 3.044 Vali Acc: 0.222 Test Loss: 3.044 Test Acc: 0.222
Validation loss decreased (-0.208205 --> -0.222323).  Saving model ...
Epoch: 5 cost time: 4.332537412643433
Epoch: 5, Steps: 10 | Train Loss: 0.665 Vali Loss: 3.009 Vali Acc: 0.273 Test Loss: 3.009 Test Acc: 0.273
Validation loss decreased (-0.222323 --> -0.272911).  Saving model ...
Epoch: 6 cost time: 4.488528251647949
Epoch: 6, Steps: 10 | Train Loss: 0.299 Vali Loss: 3.160 Vali Acc: 0.269 Test Loss: 3.160 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.18118691444397
Epoch: 7, Steps: 10 | Train Loss: 0.129 Vali Loss: 3.292 Vali Acc: 0.280 Test Loss: 3.292 Test Acc: 0.280
Validation loss decreased (-0.272911 --> -0.279967).  Saving model ...
Epoch: 8 cost time: 4.145704507827759
Epoch: 8, Steps: 10 | Train Loss: 0.116 Vali Loss: 3.260 Vali Acc: 0.299 Test Loss: 3.260 Test Acc: 0.299
Validation loss decreased (-0.279967 --> -0.298791).  Saving model ...
Epoch: 9 cost time: 4.036814212799072
Epoch: 9, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.518 Vali Acc: 0.305 Test Loss: 3.518 Test Acc: 0.305
Validation loss decreased (-0.298791 --> -0.304671).  Saving model ...
Epoch: 10 cost time: 4.135424375534058
Epoch: 10, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.365 Vali Acc: 0.308 Test Loss: 3.365 Test Acc: 0.308
Validation loss decreased (-0.304671 --> -0.308202).  Saving model ...
Epoch: 11 cost time: 4.250408887863159
Epoch: 11, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.785 Vali Acc: 0.286 Test Loss: 3.785 Test Acc: 0.286
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.370496034622192
Epoch: 12, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.564 Vali Acc: 0.286 Test Loss: 3.564 Test Acc: 0.286
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.393323659896851
Epoch: 13, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.587 Vali Acc: 0.300 Test Loss: 3.587 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.4377570152282715
Epoch: 14, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.771 Vali Acc: 0.287 Test Loss: 3.771 Test Acc: 0.287
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.486175537109375
Epoch: 15, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.855 Vali Acc: 0.304 Test Loss: 3.855 Test Acc: 0.304
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.451628923416138
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.720 Vali Acc: 0.335 Test Loss: 3.720 Test Acc: 0.335
Validation loss decreased (-0.308202 --> -0.335257).  Saving model ...
Epoch: 17 cost time: 4.520270347595215
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.669 Vali Acc: 0.334 Test Loss: 3.669 Test Acc: 0.334
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.4554407596588135
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.633 Vali Acc: 0.329 Test Loss: 3.633 Test Acc: 0.329
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.48668360710144
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.645 Vali Acc: 0.334 Test Loss: 3.645 Test Acc: 0.334
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.240007400512695
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.660 Vali Acc: 0.332 Test Loss: 3.660 Test Acc: 0.332
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 4.144933462142944
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.662 Vali Acc: 0.333 Test Loss: 3.662 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 4.146472692489624
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.678 Vali Acc: 0.334 Test Loss: 3.678 Test Acc: 0.334
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 4.10349440574646
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.691 Vali Acc: 0.335 Test Loss: 3.691 Test Acc: 0.335
Validation loss decreased (-0.335257 --> -0.335257).  Saving model ...
Epoch: 24 cost time: 4.515416622161865
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.699 Vali Acc: 0.340 Test Loss: 3.699 Test Acc: 0.340
Validation loss decreased (-0.335257 --> -0.339963).  Saving model ...
Epoch: 25 cost time: 4.432645082473755
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.712 Vali Acc: 0.339 Test Loss: 3.712 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.542535781860352
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.726 Vali Acc: 0.339 Test Loss: 3.726 Test Acc: 0.339
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 4.449979782104492
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.735 Vali Acc: 0.342 Test Loss: 3.735 Test Acc: 0.342
Validation loss decreased (-0.339963 --> -0.342316).  Saving model ...
Epoch: 28 cost time: 4.370914459228516
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.733 Vali Acc: 0.342 Test Loss: 3.733 Test Acc: 0.342
Validation loss decreased (-0.342316 --> -0.342316).  Saving model ...
Epoch: 29 cost time: 4.461440801620483
Epoch: 29, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.965 Vali Acc: 0.322 Test Loss: 3.965 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 4.330232381820679
Epoch: 30, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.042 Vali Acc: 0.275 Test Loss: 4.042 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3423529411764706
model parameter : 17027482
model size : 67.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 10.02968168258667
Epoch: 1, Steps: 10 | Train Loss: 3.300 Vali Loss: 3.287 Vali Acc: 0.062 Test Loss: 3.287 Test Acc: 0.062
Validation loss decreased (inf --> -0.062320).  Saving model ...
Epoch: 2 cost time: 8.905683517456055
Epoch: 2, Steps: 10 | Train Loss: 2.795 Vali Loss: 3.240 Vali Acc: 0.133 Test Loss: 3.240 Test Acc: 0.133
Validation loss decreased (-0.062320 --> -0.132909).  Saving model ...
Epoch: 3 cost time: 9.606976747512817
Epoch: 3, Steps: 10 | Train Loss: 1.973 Vali Loss: 3.022 Vali Acc: 0.202 Test Loss: 3.022 Test Acc: 0.202
Validation loss decreased (-0.132909 --> -0.202323).  Saving model ...
Epoch: 4 cost time: 8.594184160232544
Epoch: 4, Steps: 10 | Train Loss: 1.323 Vali Loss: 3.159 Vali Acc: 0.196 Test Loss: 3.159 Test Acc: 0.196
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.505940437316895
Epoch: 5, Steps: 10 | Train Loss: 0.767 Vali Loss: 3.087 Vali Acc: 0.259 Test Loss: 3.087 Test Acc: 0.259
Validation loss decreased (-0.202323 --> -0.258793).  Saving model ...
Epoch: 6 cost time: 8.561169147491455
Epoch: 6, Steps: 10 | Train Loss: 0.417 Vali Loss: 3.301 Vali Acc: 0.256 Test Loss: 3.301 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.379184722900391
Epoch: 7, Steps: 10 | Train Loss: 0.239 Vali Loss: 3.250 Vali Acc: 0.292 Test Loss: 3.250 Test Acc: 0.292
Validation loss decreased (-0.258793 --> -0.291732).  Saving model ...
Epoch: 8 cost time: 7.174625635147095
Epoch: 8, Steps: 10 | Train Loss: 0.128 Vali Loss: 3.431 Vali Acc: 0.305 Test Loss: 3.431 Test Acc: 0.305
Validation loss decreased (-0.291732 --> -0.304672).  Saving model ...
Epoch: 9 cost time: 7.896727800369263
Epoch: 9, Steps: 10 | Train Loss: 0.068 Vali Loss: 3.538 Vali Acc: 0.302 Test Loss: 3.538 Test Acc: 0.302
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 8.496628284454346
Epoch: 10, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.595 Vali Acc: 0.304 Test Loss: 3.595 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 8.583922147750854
Epoch: 11, Steps: 10 | Train Loss: 0.076 Vali Loss: 3.533 Vali Acc: 0.296 Test Loss: 3.533 Test Acc: 0.296
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 8.712675333023071
Epoch: 12, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.821 Vali Acc: 0.307 Test Loss: 3.821 Test Acc: 0.307
Validation loss decreased (-0.304672 --> -0.307021).  Saving model ...
Epoch: 13 cost time: 8.940500259399414
Epoch: 13, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.000 Vali Acc: 0.272 Test Loss: 4.000 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 8.282341241836548
Epoch: 14, Steps: 10 | Train Loss: 0.058 Vali Loss: 3.585 Vali Acc: 0.319 Test Loss: 3.585 Test Acc: 0.319
Validation loss decreased (-0.307021 --> -0.318788).  Saving model ...
Epoch: 15 cost time: 7.539914131164551
Epoch: 15, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.756 Vali Acc: 0.314 Test Loss: 3.756 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 7.780592441558838
Epoch: 16, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.740 Vali Acc: 0.301 Test Loss: 3.740 Test Acc: 0.301
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 8.568442106246948
Epoch: 17, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.891 Vali Acc: 0.311 Test Loss: 3.891 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 8.534237623214722
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.895 Vali Acc: 0.307 Test Loss: 3.895 Test Acc: 0.307
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 8.676175355911255
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.889 Vali Acc: 0.321 Test Loss: 3.889 Test Acc: 0.321
Validation loss decreased (-0.318788 --> -0.321138).  Saving model ...
Epoch: 20 cost time: 8.582480430603027
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.846 Vali Acc: 0.324 Test Loss: 3.846 Test Acc: 0.324
Validation loss decreased (-0.321138 --> -0.323491).  Saving model ...
Epoch: 21 cost time: 8.397275447845459
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.861 Vali Acc: 0.334 Test Loss: 3.861 Test Acc: 0.334
Validation loss decreased (-0.323491 --> -0.334079).  Saving model ...
Epoch: 22 cost time: 7.824360370635986
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.856 Vali Acc: 0.334 Test Loss: 3.856 Test Acc: 0.334
Validation loss decreased (-0.334079 --> -0.334079).  Saving model ...
Epoch: 23 cost time: 8.003143072128296
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.919 Vali Acc: 0.328 Test Loss: 3.919 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 8.446532011032104
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.970 Vali Acc: 0.326 Test Loss: 3.970 Test Acc: 0.326
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 8.554147243499756
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.948 Vali Acc: 0.331 Test Loss: 3.948 Test Acc: 0.331
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 8.546746492385864
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 3.923 Vali Acc: 0.331 Test Loss: 3.923 Test Acc: 0.331
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 8.539857149124146
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 3.916 Vali Acc: 0.338 Test Loss: 3.916 Test Acc: 0.338
Validation loss decreased (-0.334079 --> -0.337608).  Saving model ...
Epoch: 28 cost time: 8.750677824020386
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 3.911 Vali Acc: 0.338 Test Loss: 3.911 Test Acc: 0.338
Validation loss decreased (-0.337608 --> -0.337608).  Saving model ...
Epoch: 29 cost time: 7.809698820114136
Epoch: 29, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.022 Vali Acc: 0.322 Test Loss: 4.022 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 8.055419206619263
Epoch: 30, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.041 Vali Acc: 0.305 Test Loss: 4.041 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3376470588235294
model parameter : 56744602
model size : 218.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.76697564125061
Epoch: 1, Steps: 10 | Train Loss: 3.322 Vali Loss: 3.286 Vali Acc: 0.059 Test Loss: 3.286 Test Acc: 0.059
Validation loss decreased (inf --> -0.058791).  Saving model ...
Epoch: 2 cost time: 3.413198709487915
Epoch: 2, Steps: 10 | Train Loss: 2.911 Vali Loss: 3.336 Vali Acc: 0.119 Test Loss: 3.336 Test Acc: 0.119
Validation loss decreased (-0.058791 --> -0.118790).  Saving model ...
Epoch: 3 cost time: 3.1877408027648926
Epoch: 3, Steps: 10 | Train Loss: 2.086 Vali Loss: 3.032 Vali Acc: 0.195 Test Loss: 3.032 Test Acc: 0.195
Validation loss decreased (-0.118790 --> -0.195264).  Saving model ...
Epoch: 4 cost time: 3.4076311588287354
Epoch: 4, Steps: 10 | Train Loss: 1.397 Vali Loss: 3.058 Vali Acc: 0.220 Test Loss: 3.058 Test Acc: 0.220
Validation loss decreased (-0.195264 --> -0.219969).  Saving model ...
Epoch: 5 cost time: 3.3848371505737305
Epoch: 5, Steps: 10 | Train Loss: 0.887 Vali Loss: 2.985 Vali Acc: 0.264 Test Loss: 2.985 Test Acc: 0.264
Validation loss decreased (-0.219969 --> -0.263500).  Saving model ...
Epoch: 6 cost time: 3.4465715885162354
Epoch: 6, Steps: 10 | Train Loss: 0.450 Vali Loss: 3.021 Vali Acc: 0.294 Test Loss: 3.021 Test Acc: 0.294
Validation loss decreased (-0.263500 --> -0.294087).  Saving model ...
Epoch: 7 cost time: 3.374203681945801
Epoch: 7, Steps: 10 | Train Loss: 0.253 Vali Loss: 3.352 Vali Acc: 0.273 Test Loss: 3.352 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.1079764366149902
Epoch: 8, Steps: 10 | Train Loss: 0.267 Vali Loss: 3.359 Vali Acc: 0.301 Test Loss: 3.359 Test Acc: 0.301
Validation loss decreased (-0.294087 --> -0.301143).  Saving model ...
Epoch: 9 cost time: 3.1422181129455566
Epoch: 9, Steps: 10 | Train Loss: 0.087 Vali Loss: 3.421 Vali Acc: 0.312 Test Loss: 3.421 Test Acc: 0.312
Validation loss decreased (-0.301143 --> -0.311730).  Saving model ...
Epoch: 10 cost time: 2.787558078765869
Epoch: 10, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.766 Vali Acc: 0.299 Test Loss: 3.766 Test Acc: 0.299
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.0694949626922607
Epoch: 11, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.615 Vali Acc: 0.295 Test Loss: 3.615 Test Acc: 0.295
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.0734026432037354
Epoch: 12, Steps: 10 | Train Loss: 0.071 Vali Loss: 3.515 Vali Acc: 0.312 Test Loss: 3.515 Test Acc: 0.312
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.390392780303955
Epoch: 13, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.644 Vali Acc: 0.300 Test Loss: 3.644 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.2898025512695312
Epoch: 14, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.675 Vali Acc: 0.315 Test Loss: 3.675 Test Acc: 0.315
Validation loss decreased (-0.311730 --> -0.315257).  Saving model ...
Epoch: 15 cost time: 3.1910040378570557
Epoch: 15, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.569 Vali Acc: 0.300 Test Loss: 3.569 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.9901034832000732
Epoch: 16, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.710 Vali Acc: 0.304 Test Loss: 3.710 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.1000521183013916
Epoch: 17, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.884 Vali Acc: 0.299 Test Loss: 3.884 Test Acc: 0.299
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.0509986877441406
Epoch: 18, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.911 Vali Acc: 0.298 Test Loss: 3.911 Test Acc: 0.298
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.306863307952881
Epoch: 19, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.911 Vali Acc: 0.302 Test Loss: 3.911 Test Acc: 0.302
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.3339617252349854
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.864 Vali Acc: 0.309 Test Loss: 3.864 Test Acc: 0.309
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.2909421920776367
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.094 Vali Acc: 0.300 Test Loss: 4.094 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.318873882293701
Epoch: 22, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.156 Vali Acc: 0.299 Test Loss: 4.156 Test Acc: 0.299
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.087195873260498
Epoch: 23, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.997 Vali Acc: 0.294 Test Loss: 3.997 Test Acc: 0.294
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.128235101699829
Epoch: 24, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.094 Vali Acc: 0.304 Test Loss: 4.094 Test Acc: 0.304
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.31529411764705884
model parameter : 17027482
model size : 67.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 6.659023284912109
Epoch: 1, Steps: 10 | Train Loss: 3.296 Vali Loss: 3.303 Vali Acc: 0.054 Test Loss: 3.303 Test Acc: 0.054
Validation loss decreased (inf --> -0.054085).  Saving model ...
Epoch: 2 cost time: 5.65281343460083
Epoch: 2, Steps: 10 | Train Loss: 2.863 Vali Loss: 3.309 Vali Acc: 0.104 Test Loss: 3.309 Test Acc: 0.104
Validation loss decreased (-0.054085 --> -0.103496).  Saving model ...
Epoch: 3 cost time: 5.639307737350464
Epoch: 3, Steps: 10 | Train Loss: 2.169 Vali Loss: 3.128 Vali Acc: 0.179 Test Loss: 3.128 Test Acc: 0.179
Validation loss decreased (-0.103496 --> -0.178792).  Saving model ...
Epoch: 4 cost time: 5.206581354141235
Epoch: 4, Steps: 10 | Train Loss: 1.442 Vali Loss: 3.172 Vali Acc: 0.219 Test Loss: 3.172 Test Acc: 0.219
Validation loss decreased (-0.178792 --> -0.218792).  Saving model ...
Epoch: 5 cost time: 4.668389797210693
Epoch: 5, Steps: 10 | Train Loss: 1.017 Vali Loss: 3.239 Vali Acc: 0.238 Test Loss: 3.239 Test Acc: 0.238
Validation loss decreased (-0.218792 --> -0.237615).  Saving model ...
Epoch: 6 cost time: 4.6621668338775635
Epoch: 6, Steps: 10 | Train Loss: 0.512 Vali Loss: 3.279 Vali Acc: 0.244 Test Loss: 3.279 Test Acc: 0.244
Validation loss decreased (-0.237615 --> -0.243497).  Saving model ...
Epoch: 7 cost time: 4.6274354457855225
Epoch: 7, Steps: 10 | Train Loss: 0.193 Vali Loss: 3.240 Vali Acc: 0.286 Test Loss: 3.240 Test Acc: 0.286
Validation loss decreased (-0.243497 --> -0.285850).  Saving model ...
Epoch: 8 cost time: 4.710266828536987
Epoch: 8, Steps: 10 | Train Loss: 0.157 Vali Loss: 3.437 Vali Acc: 0.295 Test Loss: 3.437 Test Acc: 0.295
Validation loss decreased (-0.285850 --> -0.295260).  Saving model ...
Epoch: 9 cost time: 4.535065174102783
Epoch: 9, Steps: 10 | Train Loss: 0.131 Vali Loss: 3.367 Vali Acc: 0.298 Test Loss: 3.367 Test Acc: 0.298
Validation loss decreased (-0.295260 --> -0.297613).  Saving model ...
Epoch: 10 cost time: 4.8117594718933105
Epoch: 10, Steps: 10 | Train Loss: 0.086 Vali Loss: 3.416 Vali Acc: 0.315 Test Loss: 3.416 Test Acc: 0.315
Validation loss decreased (-0.297613 --> -0.315260).  Saving model ...
Epoch: 11 cost time: 4.597819805145264
Epoch: 11, Steps: 10 | Train Loss: 0.152 Vali Loss: 3.594 Vali Acc: 0.269 Test Loss: 3.594 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.938342571258545
Epoch: 12, Steps: 10 | Train Loss: 0.085 Vali Loss: 3.725 Vali Acc: 0.293 Test Loss: 3.725 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.293383359909058
Epoch: 13, Steps: 10 | Train Loss: 0.064 Vali Loss: 3.646 Vali Acc: 0.318 Test Loss: 3.646 Test Acc: 0.318
Validation loss decreased (-0.315260 --> -0.317611).  Saving model ...
Epoch: 14 cost time: 5.156507253646851
Epoch: 14, Steps: 10 | Train Loss: 0.079 Vali Loss: 3.665 Vali Acc: 0.313 Test Loss: 3.665 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.729948282241821
Epoch: 15, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.895 Vali Acc: 0.291 Test Loss: 3.895 Test Acc: 0.291
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.304940938949585
Epoch: 16, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.762 Vali Acc: 0.316 Test Loss: 3.762 Test Acc: 0.316
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.268694877624512
Epoch: 17, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.961 Vali Acc: 0.301 Test Loss: 3.961 Test Acc: 0.301
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.901320695877075
Epoch: 18, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.069 Vali Acc: 0.288 Test Loss: 4.069 Test Acc: 0.288
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 5.205336809158325
Epoch: 19, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.049 Vali Acc: 0.286 Test Loss: 4.049 Test Acc: 0.286
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.861922979354858
Epoch: 20, Steps: 10 | Train Loss: 0.083 Vali Loss: 4.034 Vali Acc: 0.289 Test Loss: 4.034 Test Acc: 0.289
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.618488311767578
Epoch: 21, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.286 Vali Acc: 0.276 Test Loss: 4.286 Test Acc: 0.276
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.56492805480957
Epoch: 22, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.053 Vali Acc: 0.311 Test Loss: 4.053 Test Acc: 0.311
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.572435140609741
Epoch: 23, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.227 Vali Acc: 0.276 Test Loss: 4.227 Test Acc: 0.276
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3176470588235294
model parameter : 56744602
model size : 218.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.642301321029663
Epoch: 1, Steps: 10 | Train Loss: 3.326 Vali Loss: 3.287 Vali Acc: 0.059 Test Loss: 3.287 Test Acc: 0.059
Validation loss decreased (inf --> -0.058791).  Saving model ...
Epoch: 2 cost time: 2.415203809738159
Epoch: 2, Steps: 10 | Train Loss: 2.931 Vali Loss: 3.383 Vali Acc: 0.084 Test Loss: 3.383 Test Acc: 0.084
Validation loss decreased (-0.058791 --> -0.083496).  Saving model ...
Epoch: 3 cost time: 2.4036977291107178
Epoch: 3, Steps: 10 | Train Loss: 2.204 Vali Loss: 3.091 Vali Acc: 0.178 Test Loss: 3.091 Test Acc: 0.178
Validation loss decreased (-0.083496 --> -0.177616).  Saving model ...
Epoch: 4 cost time: 2.347099781036377
Epoch: 4, Steps: 10 | Train Loss: 1.662 Vali Loss: 3.085 Vali Acc: 0.201 Test Loss: 3.085 Test Acc: 0.201
Validation loss decreased (-0.177616 --> -0.201146).  Saving model ...
Epoch: 5 cost time: 2.2038726806640625
Epoch: 5, Steps: 10 | Train Loss: 1.104 Vali Loss: 3.111 Vali Acc: 0.233 Test Loss: 3.111 Test Acc: 0.233
Validation loss decreased (-0.201146 --> -0.232910).  Saving model ...
Epoch: 6 cost time: 1.8606665134429932
Epoch: 6, Steps: 10 | Train Loss: 0.677 Vali Loss: 3.133 Vali Acc: 0.258 Test Loss: 3.133 Test Acc: 0.258
Validation loss decreased (-0.232910 --> -0.257616).  Saving model ...
Epoch: 7 cost time: 1.995887279510498
Epoch: 7, Steps: 10 | Train Loss: 0.344 Vali Loss: 3.282 Vali Acc: 0.268 Test Loss: 3.282 Test Acc: 0.268
Validation loss decreased (-0.257616 --> -0.268202).  Saving model ...
Epoch: 8 cost time: 1.9149024486541748
Epoch: 8, Steps: 10 | Train Loss: 0.294 Vali Loss: 3.342 Vali Acc: 0.287 Test Loss: 3.342 Test Acc: 0.287
Validation loss decreased (-0.268202 --> -0.287025).  Saving model ...
Epoch: 9 cost time: 2.0274288654327393
Epoch: 9, Steps: 10 | Train Loss: 0.192 Vali Loss: 3.469 Vali Acc: 0.291 Test Loss: 3.469 Test Acc: 0.291
Validation loss decreased (-0.287025 --> -0.290554).  Saving model ...
Epoch: 10 cost time: 1.9701755046844482
Epoch: 10, Steps: 10 | Train Loss: 0.096 Vali Loss: 3.275 Vali Acc: 0.309 Test Loss: 3.275 Test Acc: 0.309
Validation loss decreased (-0.290554 --> -0.309379).  Saving model ...
Epoch: 11 cost time: 1.932037115097046
Epoch: 11, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.420 Vali Acc: 0.336 Test Loss: 3.420 Test Acc: 0.336
Validation loss decreased (-0.309379 --> -0.336436).  Saving model ...
Epoch: 12 cost time: 1.8420417308807373
Epoch: 12, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.531 Vali Acc: 0.336 Test Loss: 3.531 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.931649923324585
Epoch: 13, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.794 Vali Acc: 0.282 Test Loss: 3.794 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.9345757961273193
Epoch: 14, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.571 Vali Acc: 0.313 Test Loss: 3.571 Test Acc: 0.313
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.0156664848327637
Epoch: 15, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.986 Vali Acc: 0.295 Test Loss: 3.986 Test Acc: 0.295
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.0286848545074463
Epoch: 16, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.666 Vali Acc: 0.328 Test Loss: 3.666 Test Acc: 0.328
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.080324411392212
Epoch: 17, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.737 Vali Acc: 0.331 Test Loss: 3.737 Test Acc: 0.331
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.070983409881592
Epoch: 18, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.870 Vali Acc: 0.334 Test Loss: 3.870 Test Acc: 0.334
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.131965398788452
Epoch: 19, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.880 Vali Acc: 0.333 Test Loss: 3.880 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.0872082710266113
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.000 Vali Acc: 0.329 Test Loss: 4.000 Test Acc: 0.329
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.9170255661010742
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.965 Vali Acc: 0.335 Test Loss: 3.965 Test Acc: 0.335
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.33647058823529413
model parameter : 17027482
model size : 67.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 8.668789625167847
Epoch: 1, Steps: 10 | Train Loss: 3.368 Vali Loss: 3.264 Vali Acc: 0.074 Test Loss: 3.264 Test Acc: 0.074
Validation loss decreased (inf --> -0.074085).  Saving model ...
Epoch: 2 cost time: 7.35910964012146
Epoch: 2, Steps: 10 | Train Loss: 2.846 Vali Loss: 3.289 Vali Acc: 0.112 Test Loss: 3.289 Test Acc: 0.112
Validation loss decreased (-0.074085 --> -0.111732).  Saving model ...
Epoch: 3 cost time: 7.25703763961792
Epoch: 3, Steps: 10 | Train Loss: 1.963 Vali Loss: 3.022 Vali Acc: 0.207 Test Loss: 3.022 Test Acc: 0.207
Validation loss decreased (-0.111732 --> -0.207029).  Saving model ...
Epoch: 4 cost time: 6.6989312171936035
Epoch: 4, Steps: 10 | Train Loss: 1.138 Vali Loss: 3.035 Vali Acc: 0.238 Test Loss: 3.035 Test Acc: 0.238
Validation loss decreased (-0.207029 --> -0.237617).  Saving model ...
Epoch: 5 cost time: 6.737791299819946
Epoch: 5, Steps: 10 | Train Loss: 0.615 Vali Loss: 3.010 Vali Acc: 0.267 Test Loss: 3.010 Test Acc: 0.267
Validation loss decreased (-0.237617 --> -0.267029).  Saving model ...
Epoch: 6 cost time: 7.24109673500061
Epoch: 6, Steps: 10 | Train Loss: 0.261 Vali Loss: 3.372 Vali Acc: 0.254 Test Loss: 3.372 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.727231979370117
Epoch: 7, Steps: 10 | Train Loss: 0.157 Vali Loss: 3.369 Vali Acc: 0.288 Test Loss: 3.369 Test Acc: 0.288
Validation loss decreased (-0.267029 --> -0.288202).  Saving model ...
Epoch: 8 cost time: 6.915125131607056
Epoch: 8, Steps: 10 | Train Loss: 0.075 Vali Loss: 3.299 Vali Acc: 0.302 Test Loss: 3.299 Test Acc: 0.302
Validation loss decreased (-0.288202 --> -0.302320).  Saving model ...
Epoch: 9 cost time: 7.157137632369995
Epoch: 9, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.474 Vali Acc: 0.312 Test Loss: 3.474 Test Acc: 0.312
Validation loss decreased (-0.302320 --> -0.311730).  Saving model ...
Epoch: 10 cost time: 6.954484939575195
Epoch: 10, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.446 Vali Acc: 0.319 Test Loss: 3.446 Test Acc: 0.319
Validation loss decreased (-0.311730 --> -0.318789).  Saving model ...
Epoch: 11 cost time: 5.879178524017334
Epoch: 11, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.771 Vali Acc: 0.311 Test Loss: 3.771 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.511261224746704
Epoch: 12, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.639 Vali Acc: 0.309 Test Loss: 3.639 Test Acc: 0.309
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.471914291381836
Epoch: 13, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.632 Vali Acc: 0.309 Test Loss: 3.632 Test Acc: 0.309
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.769426584243774
Epoch: 14, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.751 Vali Acc: 0.305 Test Loss: 3.751 Test Acc: 0.305
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.875086069107056
Epoch: 15, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.571 Vali Acc: 0.313 Test Loss: 3.571 Test Acc: 0.313
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 6.961841344833374
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.682 Vali Acc: 0.301 Test Loss: 3.682 Test Acc: 0.301
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 7.13242244720459
Epoch: 17, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.748 Vali Acc: 0.318 Test Loss: 3.748 Test Acc: 0.318
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 7.299386501312256
Epoch: 18, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.587 Vali Acc: 0.291 Test Loss: 3.587 Test Acc: 0.291
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 6.565459251403809
Epoch: 19, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.783 Vali Acc: 0.321 Test Loss: 3.783 Test Acc: 0.321
Validation loss decreased (-0.318789 --> -0.321139).  Saving model ...
Epoch: 20 cost time: 6.766981601715088
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.851 Vali Acc: 0.319 Test Loss: 3.851 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 6.739379405975342
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.032 Vali Acc: 0.298 Test Loss: 4.032 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 7.36649227142334
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.818 Vali Acc: 0.333 Test Loss: 3.818 Test Acc: 0.333
Validation loss decreased (-0.321139 --> -0.332903).  Saving model ...
Epoch: 23 cost time: 7.419217586517334
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.813 Vali Acc: 0.329 Test Loss: 3.813 Test Acc: 0.329
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 7.5843799114227295
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.799 Vali Acc: 0.335 Test Loss: 3.799 Test Acc: 0.335
Validation loss decreased (-0.332903 --> -0.335256).  Saving model ...
Epoch: 25 cost time: 7.344763994216919
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.785 Vali Acc: 0.333 Test Loss: 3.785 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 7.5306077003479
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.794 Vali Acc: 0.333 Test Loss: 3.794 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 6.842496156692505
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.833 Vali Acc: 0.331 Test Loss: 3.833 Test Acc: 0.331
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 6.58782696723938
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.852 Vali Acc: 0.333 Test Loss: 3.852 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 6.477508306503296
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 3.873 Vali Acc: 0.338 Test Loss: 3.873 Test Acc: 0.338
Validation loss decreased (-0.335256 --> -0.337608).  Saving model ...
Epoch: 30 cost time: 7.3176960945129395
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 3.892 Vali Acc: 0.338 Test Loss: 3.892 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3376470588235294
model parameter : 28627354
model size : 111.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.2280027866363525
Epoch: 1, Steps: 10 | Train Loss: 3.346 Vali Loss: 3.277 Vali Acc: 0.048 Test Loss: 3.277 Test Acc: 0.048
Validation loss decreased (inf --> -0.048203).  Saving model ...
Epoch: 2 cost time: 2.8905699253082275
Epoch: 2, Steps: 10 | Train Loss: 2.942 Vali Loss: 3.337 Vali Acc: 0.115 Test Loss: 3.337 Test Acc: 0.115
Validation loss decreased (-0.048203 --> -0.115261).  Saving model ...
Epoch: 3 cost time: 3.0300004482269287
Epoch: 3, Steps: 10 | Train Loss: 2.218 Vali Loss: 3.055 Vali Acc: 0.188 Test Loss: 3.055 Test Acc: 0.188
Validation loss decreased (-0.115261 --> -0.188205).  Saving model ...
Epoch: 4 cost time: 2.8279383182525635
Epoch: 4, Steps: 10 | Train Loss: 1.418 Vali Loss: 3.038 Vali Acc: 0.218 Test Loss: 3.038 Test Acc: 0.218
Validation loss decreased (-0.188205 --> -0.217617).  Saving model ...
Epoch: 5 cost time: 2.9424355030059814
Epoch: 5, Steps: 10 | Train Loss: 0.769 Vali Loss: 3.037 Vali Acc: 0.254 Test Loss: 3.037 Test Acc: 0.254
Validation loss decreased (-0.217617 --> -0.254087).  Saving model ...
Epoch: 6 cost time: 2.5101547241210938
Epoch: 6, Steps: 10 | Train Loss: 0.373 Vali Loss: 3.219 Vali Acc: 0.256 Test Loss: 3.219 Test Acc: 0.256
Validation loss decreased (-0.254087 --> -0.256438).  Saving model ...
Epoch: 7 cost time: 2.671243667602539
Epoch: 7, Steps: 10 | Train Loss: 0.213 Vali Loss: 3.176 Vali Acc: 0.288 Test Loss: 3.176 Test Acc: 0.288
Validation loss decreased (-0.256438 --> -0.288204).  Saving model ...
Epoch: 8 cost time: 2.729560613632202
Epoch: 8, Steps: 10 | Train Loss: 0.095 Vali Loss: 3.318 Vali Acc: 0.294 Test Loss: 3.318 Test Acc: 0.294
Validation loss decreased (-0.288204 --> -0.294084).  Saving model ...
Epoch: 9 cost time: 2.6778035163879395
Epoch: 9, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.225 Vali Acc: 0.312 Test Loss: 3.225 Test Acc: 0.312
Validation loss decreased (-0.294084 --> -0.311732).  Saving model ...
Epoch: 10 cost time: 2.6613049507141113
Epoch: 10, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.405 Vali Acc: 0.300 Test Loss: 3.405 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.2535834312438965
Epoch: 11, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.786 Vali Acc: 0.300 Test Loss: 3.786 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.8516361713409424
Epoch: 12, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.623 Vali Acc: 0.311 Test Loss: 3.623 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.9757964611053467
Epoch: 13, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.649 Vali Acc: 0.309 Test Loss: 3.649 Test Acc: 0.309
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.7781968116760254
Epoch: 14, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.506 Vali Acc: 0.318 Test Loss: 3.506 Test Acc: 0.318
Validation loss decreased (-0.311732 --> -0.317612).  Saving model ...
Epoch: 15 cost time: 2.8632051944732666
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.560 Vali Acc: 0.318 Test Loss: 3.560 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.890298843383789
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.612 Vali Acc: 0.319 Test Loss: 3.612 Test Acc: 0.319
Validation loss decreased (-0.317612 --> -0.318787).  Saving model ...
Epoch: 17 cost time: 2.9586386680603027
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.596 Vali Acc: 0.332 Test Loss: 3.596 Test Acc: 0.332
Validation loss decreased (-0.318787 --> -0.331729).  Saving model ...
Epoch: 18 cost time: 2.969203472137451
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.615 Vali Acc: 0.345 Test Loss: 3.615 Test Acc: 0.345
Validation loss decreased (-0.331729 --> -0.344670).  Saving model ...
Epoch: 19 cost time: 2.864011526107788
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.646 Vali Acc: 0.339 Test Loss: 3.646 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.8157050609588623
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.676 Vali Acc: 0.341 Test Loss: 3.676 Test Acc: 0.341
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.800736665725708
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.668 Vali Acc: 0.339 Test Loss: 3.668 Test Acc: 0.339
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.611037492752075
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.829 Vali Acc: 0.300 Test Loss: 3.829 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.6254971027374268
Epoch: 23, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.980 Vali Acc: 0.300 Test Loss: 3.980 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.9723362922668457
Epoch: 24, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.704 Vali Acc: 0.324 Test Loss: 3.704 Test Acc: 0.324
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.6655373573303223
Epoch: 25, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.566 Vali Acc: 0.328 Test Loss: 3.566 Test Acc: 0.328
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.717515468597412
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.567 Vali Acc: 0.319 Test Loss: 3.567 Test Acc: 0.319
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.8349287509918213
Epoch: 27, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.843 Vali Acc: 0.307 Test Loss: 3.843 Test Acc: 0.307
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.8546640872955322
Epoch: 28, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.046 Vali Acc: 0.291 Test Loss: 4.046 Test Acc: 0.291
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3447058823529412
model parameter : 8768410
model size : 35.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 6.890499830245972
Epoch: 1, Steps: 10 | Train Loss: 3.371 Vali Loss: 3.267 Vali Acc: 0.080 Test Loss: 3.267 Test Acc: 0.080
Validation loss decreased (inf --> -0.079967).  Saving model ...
Epoch: 2 cost time: 5.437578916549683
Epoch: 2, Steps: 10 | Train Loss: 2.885 Vali Loss: 3.309 Vali Acc: 0.114 Test Loss: 3.309 Test Acc: 0.114
Validation loss decreased (-0.079967 --> -0.114085).  Saving model ...
Epoch: 3 cost time: 5.519028663635254
Epoch: 3, Steps: 10 | Train Loss: 2.008 Vali Loss: 3.040 Vali Acc: 0.188 Test Loss: 3.040 Test Acc: 0.188
Validation loss decreased (-0.114085 --> -0.188205).  Saving model ...
Epoch: 4 cost time: 5.501288175582886
Epoch: 4, Steps: 10 | Train Loss: 1.280 Vali Loss: 3.022 Vali Acc: 0.236 Test Loss: 3.022 Test Acc: 0.236
Validation loss decreased (-0.188205 --> -0.236440).  Saving model ...
Epoch: 5 cost time: 4.670690536499023
Epoch: 5, Steps: 10 | Train Loss: 0.824 Vali Loss: 3.026 Vali Acc: 0.285 Test Loss: 3.026 Test Acc: 0.285
Validation loss decreased (-0.236440 --> -0.284676).  Saving model ...
Epoch: 6 cost time: 4.908301830291748
Epoch: 6, Steps: 10 | Train Loss: 0.416 Vali Loss: 3.252 Vali Acc: 0.279 Test Loss: 3.252 Test Acc: 0.279
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.9555559158325195
Epoch: 7, Steps: 10 | Train Loss: 0.189 Vali Loss: 3.188 Vali Acc: 0.300 Test Loss: 3.188 Test Acc: 0.300
Validation loss decreased (-0.284676 --> -0.299968).  Saving model ...
Epoch: 8 cost time: 5.051377773284912
Epoch: 8, Steps: 10 | Train Loss: 0.169 Vali Loss: 3.278 Vali Acc: 0.301 Test Loss: 3.278 Test Acc: 0.301
Validation loss decreased (-0.299968 --> -0.301144).  Saving model ...
Epoch: 9 cost time: 4.513097763061523
Epoch: 9, Steps: 10 | Train Loss: 0.152 Vali Loss: 3.476 Vali Acc: 0.304 Test Loss: 3.476 Test Acc: 0.304
Validation loss decreased (-0.301144 --> -0.303495).  Saving model ...
Epoch: 10 cost time: 3.325788736343384
Epoch: 10, Steps: 10 | Train Loss: 0.068 Vali Loss: 3.483 Vali Acc: 0.321 Test Loss: 3.483 Test Acc: 0.321
Validation loss decreased (-0.303495 --> -0.321142).  Saving model ...
Epoch: 11 cost time: 2.731322765350342
Epoch: 11, Steps: 10 | Train Loss: 0.090 Vali Loss: 3.570 Vali Acc: 0.301 Test Loss: 3.570 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.49949049949646
Epoch: 12, Steps: 10 | Train Loss: 0.043 Vali Loss: 3.752 Vali Acc: 0.304 Test Loss: 3.752 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.760437726974487
Epoch: 13, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.787 Vali Acc: 0.288 Test Loss: 3.787 Test Acc: 0.288
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.272965669631958
Epoch: 14, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.706 Vali Acc: 0.326 Test Loss: 3.706 Test Acc: 0.326
Validation loss decreased (-0.321142 --> -0.325845).  Saving model ...
Epoch: 15 cost time: 4.104583263397217
Epoch: 15, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.588 Vali Acc: 0.340 Test Loss: 3.588 Test Acc: 0.340
Validation loss decreased (-0.325845 --> -0.339964).  Saving model ...
Epoch: 16 cost time: 4.46977686882019
Epoch: 16, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.683 Vali Acc: 0.308 Test Loss: 3.683 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.968235492706299
Epoch: 17, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.640 Vali Acc: 0.326 Test Loss: 3.640 Test Acc: 0.326
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.880170583724976
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.830 Vali Acc: 0.318 Test Loss: 3.830 Test Acc: 0.318
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.773359060287476
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.832 Vali Acc: 0.327 Test Loss: 3.832 Test Acc: 0.327
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.577899694442749
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.773 Vali Acc: 0.334 Test Loss: 3.773 Test Acc: 0.334
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.71502161026001
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.755 Vali Acc: 0.336 Test Loss: 3.755 Test Acc: 0.336
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.636712074279785
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.735 Vali Acc: 0.339 Test Loss: 3.735 Test Acc: 0.339
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.502527713775635
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.744 Vali Acc: 0.347 Test Loss: 3.744 Test Acc: 0.347
Validation loss decreased (-0.339964 --> -0.347021).  Saving model ...
Epoch: 24 cost time: 3.80134654045105
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.768 Vali Acc: 0.349 Test Loss: 3.768 Test Acc: 0.349
Validation loss decreased (-0.347021 --> -0.349374).  Saving model ...
Epoch: 25 cost time: 4.067683458328247
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.778 Vali Acc: 0.344 Test Loss: 3.778 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.535793304443359
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.815 Vali Acc: 0.345 Test Loss: 3.815 Test Acc: 0.345
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 4.622409343719482
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.834 Vali Acc: 0.346 Test Loss: 3.834 Test Acc: 0.346
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 4.774498701095581
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.980 Vali Acc: 0.335 Test Loss: 3.980 Test Acc: 0.335
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 4.152284860610962
Epoch: 29, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.890 Vali Acc: 0.321 Test Loss: 3.890 Test Acc: 0.321
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 4.481191635131836
Epoch: 30, Steps: 10 | Train Loss: 0.113 Vali Loss: 4.149 Vali Acc: 0.276 Test Loss: 4.149 Test Acc: 0.276
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.34941176470588237
model parameter : 28627354
model size : 111.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.425847053527832
Epoch: 1, Steps: 10 | Train Loss: 3.345 Vali Loss: 3.282 Vali Acc: 0.047 Test Loss: 3.282 Test Acc: 0.047
Validation loss decreased (inf --> -0.047026).  Saving model ...
Epoch: 2 cost time: 2.0410702228546143
Epoch: 2, Steps: 10 | Train Loss: 2.955 Vali Loss: 3.352 Vali Acc: 0.109 Test Loss: 3.352 Test Acc: 0.109
Validation loss decreased (-0.047026 --> -0.109378).  Saving model ...
Epoch: 3 cost time: 1.5314791202545166
Epoch: 3, Steps: 10 | Train Loss: 2.311 Vali Loss: 3.078 Vali Acc: 0.185 Test Loss: 3.078 Test Acc: 0.185
Validation loss decreased (-0.109378 --> -0.184675).  Saving model ...
Epoch: 4 cost time: 1.8045268058776855
Epoch: 4, Steps: 10 | Train Loss: 1.533 Vali Loss: 3.060 Vali Acc: 0.206 Test Loss: 3.060 Test Acc: 0.206
Validation loss decreased (-0.184675 --> -0.205852).  Saving model ...
Epoch: 5 cost time: 1.8176698684692383
Epoch: 5, Steps: 10 | Train Loss: 0.947 Vali Loss: 3.025 Vali Acc: 0.246 Test Loss: 3.025 Test Acc: 0.246
Validation loss decreased (-0.205852 --> -0.245852).  Saving model ...
Epoch: 6 cost time: 1.626105546951294
Epoch: 6, Steps: 10 | Train Loss: 0.543 Vali Loss: 3.186 Vali Acc: 0.261 Test Loss: 3.186 Test Acc: 0.261
Validation loss decreased (-0.245852 --> -0.261145).  Saving model ...
Epoch: 7 cost time: 1.9838154315948486
Epoch: 7, Steps: 10 | Train Loss: 0.302 Vali Loss: 3.177 Vali Acc: 0.304 Test Loss: 3.177 Test Acc: 0.304
Validation loss decreased (-0.261145 --> -0.303498).  Saving model ...
Epoch: 8 cost time: 2.133139133453369
Epoch: 8, Steps: 10 | Train Loss: 0.161 Vali Loss: 3.351 Vali Acc: 0.289 Test Loss: 3.351 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.026747941970825
Epoch: 9, Steps: 10 | Train Loss: 0.076 Vali Loss: 3.329 Vali Acc: 0.311 Test Loss: 3.329 Test Acc: 0.311
Validation loss decreased (-0.303498 --> -0.310555).  Saving model ...
Epoch: 10 cost time: 1.9448060989379883
Epoch: 10, Steps: 10 | Train Loss: 0.059 Vali Loss: 3.392 Vali Acc: 0.300 Test Loss: 3.392 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.1803178787231445
Epoch: 11, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.636 Vali Acc: 0.302 Test Loss: 3.636 Test Acc: 0.302
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7713911533355713
Epoch: 12, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.540 Vali Acc: 0.319 Test Loss: 3.540 Test Acc: 0.319
Validation loss decreased (-0.310555 --> -0.318788).  Saving model ...
Epoch: 13 cost time: 1.642888069152832
Epoch: 13, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.690 Vali Acc: 0.305 Test Loss: 3.690 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7513155937194824
Epoch: 14, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.627 Vali Acc: 0.315 Test Loss: 3.627 Test Acc: 0.315
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.1361587047576904
Epoch: 15, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.782 Vali Acc: 0.281 Test Loss: 3.782 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.059478998184204
Epoch: 16, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.804 Vali Acc: 0.304 Test Loss: 3.804 Test Acc: 0.304
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.0604844093322754
Epoch: 17, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.858 Vali Acc: 0.318 Test Loss: 3.858 Test Acc: 0.318
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.1927621364593506
Epoch: 18, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.974 Vali Acc: 0.312 Test Loss: 3.974 Test Acc: 0.312
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.0763731002807617
Epoch: 19, Steps: 10 | Train Loss: 0.069 Vali Loss: 3.964 Vali Acc: 0.308 Test Loss: 3.964 Test Acc: 0.308
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.364713191986084
Epoch: 20, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.864 Vali Acc: 0.324 Test Loss: 3.864 Test Acc: 0.324
Validation loss decreased (-0.318788 --> -0.323491).  Saving model ...
Epoch: 21 cost time: 1.8652927875518799
Epoch: 21, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.795 Vali Acc: 0.318 Test Loss: 3.795 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.7838268280029297
Epoch: 22, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.907 Vali Acc: 0.304 Test Loss: 3.907 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.803532361984253
Epoch: 23, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.907 Vali Acc: 0.327 Test Loss: 3.907 Test Acc: 0.327
Validation loss decreased (-0.323491 --> -0.327020).  Saving model ...
Epoch: 24 cost time: 2.1197667121887207
Epoch: 24, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.017 Vali Acc: 0.332 Test Loss: 4.017 Test Acc: 0.332
Validation loss decreased (-0.327020 --> -0.331725).  Saving model ...
Epoch: 25 cost time: 2.126723289489746
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.200 Vali Acc: 0.315 Test Loss: 4.200 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.144386053085327
Epoch: 26, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.064 Vali Acc: 0.301 Test Loss: 4.064 Test Acc: 0.301
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.1196842193603516
Epoch: 27, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.042 Vali Acc: 0.309 Test Loss: 4.042 Test Acc: 0.309
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.076017141342163
Epoch: 28, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.994 Vali Acc: 0.327 Test Loss: 3.994 Test Acc: 0.327
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.8215036392211914
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.956 Vali Acc: 0.322 Test Loss: 3.956 Test Acc: 0.322
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.7769012451171875
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.027 Vali Acc: 0.308 Test Loss: 4.027 Test Acc: 0.308
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.33176470588235296
model parameter : 8768410
model size : 35.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.633903741836548
Epoch: 1, Steps: 10 | Train Loss: 3.371 Vali Loss: 3.273 Vali Acc: 0.078 Test Loss: 3.273 Test Acc: 0.078
Validation loss decreased (inf --> -0.077614).  Saving model ...
Epoch: 2 cost time: 3.1323304176330566
Epoch: 2, Steps: 10 | Train Loss: 2.932 Vali Loss: 3.347 Vali Acc: 0.098 Test Loss: 3.347 Test Acc: 0.098
Validation loss decreased (-0.077614 --> -0.097614).  Saving model ...
Epoch: 3 cost time: 3.2020769119262695
Epoch: 3, Steps: 10 | Train Loss: 2.211 Vali Loss: 3.100 Vali Acc: 0.175 Test Loss: 3.100 Test Acc: 0.175
Validation loss decreased (-0.097614 --> -0.175263).  Saving model ...
Epoch: 4 cost time: 2.9890308380126953
Epoch: 4, Steps: 10 | Train Loss: 1.513 Vali Loss: 3.060 Vali Acc: 0.213 Test Loss: 3.060 Test Acc: 0.213
Validation loss decreased (-0.175263 --> -0.212911).  Saving model ...
Epoch: 5 cost time: 1.8438217639923096
Epoch: 5, Steps: 10 | Train Loss: 0.980 Vali Loss: 3.121 Vali Acc: 0.227 Test Loss: 3.121 Test Acc: 0.227
Validation loss decreased (-0.212911 --> -0.227028).  Saving model ...
Epoch: 6 cost time: 2.1927149295806885
Epoch: 6, Steps: 10 | Train Loss: 0.555 Vali Loss: 3.308 Vali Acc: 0.241 Test Loss: 3.308 Test Acc: 0.241
Validation loss decreased (-0.227028 --> -0.241143).  Saving model ...
Epoch: 7 cost time: 2.695504665374756
Epoch: 7, Steps: 10 | Train Loss: 0.326 Vali Loss: 3.331 Vali Acc: 0.276 Test Loss: 3.331 Test Acc: 0.276
Validation loss decreased (-0.241143 --> -0.276437).  Saving model ...
Epoch: 8 cost time: 2.870192289352417
Epoch: 8, Steps: 10 | Train Loss: 0.200 Vali Loss: 3.354 Vali Acc: 0.298 Test Loss: 3.354 Test Acc: 0.298
Validation loss decreased (-0.276437 --> -0.297614).  Saving model ...
Epoch: 9 cost time: 2.5733935832977295
Epoch: 9, Steps: 10 | Train Loss: 0.173 Vali Loss: 3.380 Vali Acc: 0.292 Test Loss: 3.380 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.837458372116089
Epoch: 10, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.444 Vali Acc: 0.311 Test Loss: 3.444 Test Acc: 0.311
Validation loss decreased (-0.297614 --> -0.310554).  Saving model ...
Epoch: 11 cost time: 2.4687819480895996
Epoch: 11, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.672 Vali Acc: 0.304 Test Loss: 3.672 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.421781539916992
Epoch: 12, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.618 Vali Acc: 0.315 Test Loss: 3.618 Test Acc: 0.315
Validation loss decreased (-0.310554 --> -0.315258).  Saving model ...
Epoch: 13 cost time: 2.866912364959717
Epoch: 13, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.868 Vali Acc: 0.306 Test Loss: 3.868 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.8036866188049316
Epoch: 14, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.697 Vali Acc: 0.319 Test Loss: 3.697 Test Acc: 0.319
Validation loss decreased (-0.315258 --> -0.318787).  Saving model ...
Epoch: 15 cost time: 2.7597222328186035
Epoch: 15, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.642 Vali Acc: 0.322 Test Loss: 3.642 Test Acc: 0.322
Validation loss decreased (-0.318787 --> -0.322317).  Saving model ...
Epoch: 16 cost time: 2.6791749000549316
Epoch: 16, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.680 Vali Acc: 0.315 Test Loss: 3.680 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.467738151550293
Epoch: 17, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.890 Vali Acc: 0.305 Test Loss: 3.890 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.314817190170288
Epoch: 18, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.096 Vali Acc: 0.304 Test Loss: 4.096 Test Acc: 0.304
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.342463493347168
Epoch: 19, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.552 Vali Acc: 0.236 Test Loss: 4.552 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.717604160308838
Epoch: 20, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.343 Vali Acc: 0.273 Test Loss: 4.343 Test Acc: 0.273
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.8696727752685547
Epoch: 21, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.122 Vali Acc: 0.299 Test Loss: 4.122 Test Acc: 0.299
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.8079862594604492
Epoch: 22, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.194 Vali Acc: 0.299 Test Loss: 4.194 Test Acc: 0.299
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.9052162170410156
Epoch: 23, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.191 Vali Acc: 0.299 Test Loss: 4.191 Test Acc: 0.299
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.025514602661133
Epoch: 24, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.311 Vali Acc: 0.302 Test Loss: 4.311 Test Acc: 0.302
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.0847418308258057
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.352 Vali Acc: 0.311 Test Loss: 4.352 Test Acc: 0.311
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.32235294117647056
model parameter : 28627354
model size : 111.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.9132354259490967
Epoch: 1, Steps: 10 | Train Loss: 3.329 Vali Loss: 3.293 Vali Acc: 0.051 Test Loss: 3.293 Test Acc: 0.051
Validation loss decreased (inf --> -0.050555).  Saving model ...
Epoch: 2 cost time: 1.5758557319641113
Epoch: 2, Steps: 10 | Train Loss: 2.984 Vali Loss: 3.386 Vali Acc: 0.112 Test Loss: 3.386 Test Acc: 0.112
Validation loss decreased (-0.050555 --> -0.111731).  Saving model ...
Epoch: 3 cost time: 1.6175651550292969
Epoch: 3, Steps: 10 | Train Loss: 2.459 Vali Loss: 3.132 Vali Acc: 0.167 Test Loss: 3.132 Test Acc: 0.167
Validation loss decreased (-0.111731 --> -0.167028).  Saving model ...
Epoch: 4 cost time: 1.5172889232635498
Epoch: 4, Steps: 10 | Train Loss: 1.769 Vali Loss: 3.118 Vali Acc: 0.199 Test Loss: 3.118 Test Acc: 0.199
Validation loss decreased (-0.167028 --> -0.198792).  Saving model ...
Epoch: 5 cost time: 1.4339220523834229
Epoch: 5, Steps: 10 | Train Loss: 1.124 Vali Loss: 3.109 Vali Acc: 0.245 Test Loss: 3.109 Test Acc: 0.245
Validation loss decreased (-0.198792 --> -0.244675).  Saving model ...
Epoch: 6 cost time: 0.9005224704742432
Epoch: 6, Steps: 10 | Train Loss: 0.744 Vali Loss: 3.225 Vali Acc: 0.251 Test Loss: 3.225 Test Acc: 0.251
Validation loss decreased (-0.244675 --> -0.250556).  Saving model ...
Epoch: 7 cost time: 1.3136320114135742
Epoch: 7, Steps: 10 | Train Loss: 0.368 Vali Loss: 3.193 Vali Acc: 0.278 Test Loss: 3.193 Test Acc: 0.278
Validation loss decreased (-0.250556 --> -0.277615).  Saving model ...
Epoch: 8 cost time: 1.3115859031677246
Epoch: 8, Steps: 10 | Train Loss: 0.259 Vali Loss: 3.277 Vali Acc: 0.292 Test Loss: 3.277 Test Acc: 0.292
Validation loss decreased (-0.277615 --> -0.291732).  Saving model ...
Epoch: 9 cost time: 1.441232681274414
Epoch: 9, Steps: 10 | Train Loss: 0.153 Vali Loss: 3.393 Vali Acc: 0.293 Test Loss: 3.393 Test Acc: 0.293
Validation loss decreased (-0.291732 --> -0.292907).  Saving model ...
Epoch: 10 cost time: 1.4080698490142822
Epoch: 10, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.492 Vali Acc: 0.318 Test Loss: 3.492 Test Acc: 0.318
Validation loss decreased (-0.292907 --> -0.317612).  Saving model ...
Epoch: 11 cost time: 1.4225306510925293
Epoch: 11, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.619 Vali Acc: 0.307 Test Loss: 3.619 Test Acc: 0.307
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.507493495941162
Epoch: 12, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.623 Vali Acc: 0.298 Test Loss: 3.623 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.5035772323608398
Epoch: 13, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.802 Vali Acc: 0.295 Test Loss: 3.802 Test Acc: 0.295
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.445688009262085
Epoch: 14, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.791 Vali Acc: 0.295 Test Loss: 3.791 Test Acc: 0.295
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.5501351356506348
Epoch: 15, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.815 Vali Acc: 0.307 Test Loss: 3.815 Test Acc: 0.307
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.5050926208496094
Epoch: 16, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.930 Vali Acc: 0.293 Test Loss: 3.930 Test Acc: 0.293
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.5197217464447021
Epoch: 17, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.941 Vali Acc: 0.293 Test Loss: 3.941 Test Acc: 0.293
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.3628056049346924
Epoch: 18, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.000 Vali Acc: 0.322 Test Loss: 4.000 Test Acc: 0.322
Validation loss decreased (-0.317612 --> -0.322313).  Saving model ...
Epoch: 19 cost time: 1.3324623107910156
Epoch: 19, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.980 Vali Acc: 0.295 Test Loss: 3.980 Test Acc: 0.295
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.369333267211914
Epoch: 20, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.834 Vali Acc: 0.319 Test Loss: 3.834 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.311969518661499
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.857 Vali Acc: 0.324 Test Loss: 3.857 Test Acc: 0.324
Validation loss decreased (-0.322313 --> -0.323491).  Saving model ...
Epoch: 22 cost time: 1.1191673278808594
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.992 Vali Acc: 0.327 Test Loss: 3.992 Test Acc: 0.327
Validation loss decreased (-0.323491 --> -0.327019).  Saving model ...
Epoch: 23 cost time: 1.5931756496429443
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.946 Vali Acc: 0.324 Test Loss: 3.946 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5710692405700684
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.962 Vali Acc: 0.325 Test Loss: 3.962 Test Acc: 0.325
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.4421279430389404
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.068 Vali Acc: 0.326 Test Loss: 4.068 Test Acc: 0.326
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.550797939300537
Epoch: 26, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.260 Vali Acc: 0.299 Test Loss: 4.260 Test Acc: 0.299
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.5707447528839111
Epoch: 27, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.074 Vali Acc: 0.327 Test Loss: 4.074 Test Acc: 0.327
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.6177034378051758
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.268 Vali Acc: 0.308 Test Loss: 4.268 Test Acc: 0.308
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.5405409336090088
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.168 Vali Acc: 0.315 Test Loss: 4.168 Test Acc: 0.315
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.6386306285858154
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.122 Vali Acc: 0.329 Test Loss: 4.122 Test Acc: 0.329
Validation loss decreased (-0.327019 --> -0.329371).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.32941176470588235
model parameter : 8768410
model size : 35.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 9.052754163742065
Epoch: 1, Steps: 10 | Train Loss: 3.323 Vali Loss: 3.259 Vali Acc: 0.065 Test Loss: 3.259 Test Acc: 0.065
Validation loss decreased (inf --> -0.064673).  Saving model ...
Epoch: 2 cost time: 8.543055772781372
Epoch: 2, Steps: 10 | Train Loss: 2.887 Vali Loss: 3.213 Vali Acc: 0.126 Test Loss: 3.213 Test Acc: 0.126
Validation loss decreased (-0.064673 --> -0.125850).  Saving model ...
Epoch: 3 cost time: 8.277583599090576
Epoch: 3, Steps: 10 | Train Loss: 2.319 Vali Loss: 3.095 Vali Acc: 0.174 Test Loss: 3.095 Test Acc: 0.174
Validation loss decreased (-0.125850 --> -0.174087).  Saving model ...
Epoch: 4 cost time: 7.926205158233643
Epoch: 4, Steps: 10 | Train Loss: 1.701 Vali Loss: 3.027 Vali Acc: 0.194 Test Loss: 3.027 Test Acc: 0.194
Validation loss decreased (-0.174087 --> -0.194087).  Saving model ...
Epoch: 5 cost time: 7.476196765899658
Epoch: 5, Steps: 10 | Train Loss: 1.133 Vali Loss: 3.020 Vali Acc: 0.232 Test Loss: 3.020 Test Acc: 0.232
Validation loss decreased (-0.194087 --> -0.231735).  Saving model ...
Epoch: 6 cost time: 8.288367748260498
Epoch: 6, Steps: 10 | Train Loss: 0.679 Vali Loss: 3.055 Vali Acc: 0.241 Test Loss: 3.055 Test Acc: 0.241
Validation loss decreased (-0.231735 --> -0.241146).  Saving model ...
Epoch: 7 cost time: 8.450956583023071
Epoch: 7, Steps: 10 | Train Loss: 0.485 Vali Loss: 3.047 Vali Acc: 0.253 Test Loss: 3.047 Test Acc: 0.253
Validation loss decreased (-0.241146 --> -0.252911).  Saving model ...
Epoch: 8 cost time: 7.117886304855347
Epoch: 8, Steps: 10 | Train Loss: 0.249 Vali Loss: 3.090 Vali Acc: 0.274 Test Loss: 3.090 Test Acc: 0.274
Validation loss decreased (-0.252911 --> -0.274087).  Saving model ...
Epoch: 9 cost time: 7.0817742347717285
Epoch: 9, Steps: 10 | Train Loss: 0.167 Vali Loss: 3.038 Vali Acc: 0.312 Test Loss: 3.038 Test Acc: 0.312
Validation loss decreased (-0.274087 --> -0.311734).  Saving model ...
Epoch: 10 cost time: 8.195815801620483
Epoch: 10, Steps: 10 | Train Loss: 0.114 Vali Loss: 3.126 Vali Acc: 0.325 Test Loss: 3.126 Test Acc: 0.325
Validation loss decreased (-0.311734 --> -0.324675).  Saving model ...
Epoch: 11 cost time: 8.10463547706604
Epoch: 11, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.138 Vali Acc: 0.311 Test Loss: 3.138 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.1064980030059814
Epoch: 12, Steps: 10 | Train Loss: 0.075 Vali Loss: 3.197 Vali Acc: 0.318 Test Loss: 3.197 Test Acc: 0.318
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.893629789352417
Epoch: 13, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.273 Vali Acc: 0.314 Test Loss: 3.273 Test Acc: 0.314
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 8.050090074539185
Epoch: 14, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.275 Vali Acc: 0.305 Test Loss: 3.275 Test Acc: 0.305
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 8.19266963005066
Epoch: 15, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.261 Vali Acc: 0.315 Test Loss: 3.261 Test Acc: 0.315
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 7.900146484375
Epoch: 16, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.312 Vali Acc: 0.315 Test Loss: 3.312 Test Acc: 0.315
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 6.708423137664795
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.289 Vali Acc: 0.328 Test Loss: 3.289 Test Acc: 0.328
Validation loss decreased (-0.324675 --> -0.328202).  Saving model ...
Epoch: 18 cost time: 7.953083276748657
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.365 Vali Acc: 0.327 Test Loss: 3.365 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 8.074127435684204
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.393 Vali Acc: 0.329 Test Loss: 3.393 Test Acc: 0.329
Validation loss decreased (-0.328202 --> -0.329378).  Saving model ...
Epoch: 20 cost time: 7.969697952270508
Epoch: 20, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.418 Vali Acc: 0.326 Test Loss: 3.418 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 6.650909662246704
Epoch: 21, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.458 Vali Acc: 0.318 Test Loss: 3.458 Test Acc: 0.318
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 7.841650485992432
Epoch: 22, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.325 Vali Acc: 0.308 Test Loss: 3.325 Test Acc: 0.308
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 7.949813604354858
Epoch: 23, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.362 Vali Acc: 0.306 Test Loss: 3.362 Test Acc: 0.306
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 8.204921960830688
Epoch: 24, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.802 Vali Acc: 0.262 Test Loss: 3.802 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 7.599485397338867
Epoch: 25, Steps: 10 | Train Loss: 0.131 Vali Loss: 3.516 Vali Acc: 0.272 Test Loss: 3.516 Test Acc: 0.272
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 7.647916316986084
Epoch: 26, Steps: 10 | Train Loss: 0.060 Vali Loss: 3.511 Vali Acc: 0.295 Test Loss: 3.511 Test Acc: 0.295
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 8.758809804916382
Epoch: 27, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.556 Vali Acc: 0.318 Test Loss: 3.556 Test Acc: 0.318
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 8.485569953918457
Epoch: 28, Steps: 10 | Train Loss: 0.234 Vali Loss: 3.522 Vali Acc: 0.324 Test Loss: 3.522 Test Acc: 0.324
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 7.573917388916016
Epoch: 29, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.467 Vali Acc: 0.311 Test Loss: 3.467 Test Acc: 0.311
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.32941176470588235
model parameter : 28374618
model size : 109.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.685726642608643
Epoch: 1, Steps: 10 | Train Loss: 3.353 Vali Loss: 3.274 Vali Acc: 0.040 Test Loss: 3.274 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 3.1307222843170166
Epoch: 2, Steps: 10 | Train Loss: 3.020 Vali Loss: 3.285 Vali Acc: 0.089 Test Loss: 3.285 Test Acc: 0.089
Validation loss decreased (-0.039967 --> -0.089379).  Saving model ...
Epoch: 3 cost time: 3.12196946144104
Epoch: 3, Steps: 10 | Train Loss: 2.583 Vali Loss: 3.195 Vali Acc: 0.141 Test Loss: 3.195 Test Acc: 0.141
Validation loss decreased (-0.089379 --> -0.141145).  Saving model ...
Epoch: 4 cost time: 3.170543670654297
Epoch: 4, Steps: 10 | Train Loss: 1.954 Vali Loss: 3.023 Vali Acc: 0.198 Test Loss: 3.023 Test Acc: 0.198
Validation loss decreased (-0.141145 --> -0.197617).  Saving model ...
Epoch: 5 cost time: 2.531893491744995
Epoch: 5, Steps: 10 | Train Loss: 1.440 Vali Loss: 2.992 Vali Acc: 0.218 Test Loss: 2.992 Test Acc: 0.218
Validation loss decreased (-0.197617 --> -0.217617).  Saving model ...
Epoch: 6 cost time: 2.781716823577881
Epoch: 6, Steps: 10 | Train Loss: 0.918 Vali Loss: 3.006 Vali Acc: 0.240 Test Loss: 3.006 Test Acc: 0.240
Validation loss decreased (-0.217617 --> -0.239970).  Saving model ...
Epoch: 7 cost time: 2.6858060359954834
Epoch: 7, Steps: 10 | Train Loss: 0.558 Vali Loss: 2.994 Vali Acc: 0.265 Test Loss: 2.994 Test Acc: 0.265
Validation loss decreased (-0.239970 --> -0.264676).  Saving model ...
Epoch: 8 cost time: 1.9319813251495361
Epoch: 8, Steps: 10 | Train Loss: 0.374 Vali Loss: 3.067 Vali Acc: 0.274 Test Loss: 3.067 Test Acc: 0.274
Validation loss decreased (-0.264676 --> -0.274087).  Saving model ...
Epoch: 9 cost time: 2.9371368885040283
Epoch: 9, Steps: 10 | Train Loss: 0.213 Vali Loss: 3.040 Vali Acc: 0.289 Test Loss: 3.040 Test Acc: 0.289
Validation loss decreased (-0.274087 --> -0.289381).  Saving model ...
Epoch: 10 cost time: 1.8262314796447754
Epoch: 10, Steps: 10 | Train Loss: 0.106 Vali Loss: 3.145 Vali Acc: 0.308 Test Loss: 3.145 Test Acc: 0.308
Validation loss decreased (-0.289381 --> -0.308204).  Saving model ...
Epoch: 11 cost time: 1.8833978176116943
Epoch: 11, Steps: 10 | Train Loss: 0.085 Vali Loss: 3.229 Vali Acc: 0.294 Test Loss: 3.229 Test Acc: 0.294
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.870518684387207
Epoch: 12, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.253 Vali Acc: 0.296 Test Loss: 3.253 Test Acc: 0.296
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.8482789993286133
Epoch: 13, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.333 Vali Acc: 0.315 Test Loss: 3.333 Test Acc: 0.315
Validation loss decreased (-0.308204 --> -0.315261).  Saving model ...
Epoch: 14 cost time: 2.795548915863037
Epoch: 14, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.232 Vali Acc: 0.333 Test Loss: 3.232 Test Acc: 0.333
Validation loss decreased (-0.315261 --> -0.332909).  Saving model ...
Epoch: 15 cost time: 2.1543619632720947
Epoch: 15, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.277 Vali Acc: 0.332 Test Loss: 3.277 Test Acc: 0.332
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.153848886489868
Epoch: 16, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.376 Vali Acc: 0.316 Test Loss: 3.376 Test Acc: 0.316
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.027333974838257
Epoch: 17, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.463 Vali Acc: 0.321 Test Loss: 3.463 Test Acc: 0.321
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.7278616428375244
Epoch: 18, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.359 Vali Acc: 0.307 Test Loss: 3.359 Test Acc: 0.307
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.9070956707000732
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.375 Vali Acc: 0.319 Test Loss: 3.375 Test Acc: 0.319
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.56878399848938
Epoch: 20, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.443 Vali Acc: 0.327 Test Loss: 3.443 Test Acc: 0.327
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.1486451625823975
Epoch: 21, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.447 Vali Acc: 0.326 Test Loss: 3.447 Test Acc: 0.326
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.203044891357422
Epoch: 22, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.296 Vali Acc: 0.315 Test Loss: 3.296 Test Acc: 0.315
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.7250137329101562
Epoch: 23, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.327 Vali Acc: 0.322 Test Loss: 3.327 Test Acc: 0.322
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.6406567096710205
Epoch: 24, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.431 Vali Acc: 0.324 Test Loss: 3.431 Test Acc: 0.324
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.33294117647058824
model parameter : 8515290
model size : 33.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 6.497396945953369
Epoch: 1, Steps: 10 | Train Loss: 3.324 Vali Loss: 3.264 Vali Acc: 0.055 Test Loss: 3.264 Test Acc: 0.055
Validation loss decreased (inf --> -0.055261).  Saving model ...
Epoch: 2 cost time: 5.492264032363892
Epoch: 2, Steps: 10 | Train Loss: 2.928 Vali Loss: 3.239 Vali Acc: 0.107 Test Loss: 3.239 Test Acc: 0.107
Validation loss decreased (-0.055261 --> -0.107026).  Saving model ...
Epoch: 3 cost time: 4.914662599563599
Epoch: 3, Steps: 10 | Train Loss: 2.344 Vali Loss: 3.125 Vali Acc: 0.160 Test Loss: 3.125 Test Acc: 0.160
Validation loss decreased (-0.107026 --> -0.159969).  Saving model ...
Epoch: 4 cost time: 5.523946046829224
Epoch: 4, Steps: 10 | Train Loss: 1.802 Vali Loss: 3.091 Vali Acc: 0.192 Test Loss: 3.091 Test Acc: 0.192
Validation loss decreased (-0.159969 --> -0.191734).  Saving model ...
Epoch: 5 cost time: 5.111466646194458
Epoch: 5, Steps: 10 | Train Loss: 1.473 Vali Loss: 3.152 Vali Acc: 0.220 Test Loss: 3.152 Test Acc: 0.220
Validation loss decreased (-0.191734 --> -0.219968).  Saving model ...
Epoch: 6 cost time: 4.199050426483154
Epoch: 6, Steps: 10 | Train Loss: 1.009 Vali Loss: 3.105 Vali Acc: 0.235 Test Loss: 3.105 Test Acc: 0.235
Validation loss decreased (-0.219968 --> -0.235263).  Saving model ...
Epoch: 7 cost time: 4.858958959579468
Epoch: 7, Steps: 10 | Train Loss: 0.610 Vali Loss: 3.027 Vali Acc: 0.273 Test Loss: 3.027 Test Acc: 0.273
Validation loss decreased (-0.235263 --> -0.272911).  Saving model ...
Epoch: 8 cost time: 4.901594638824463
Epoch: 8, Steps: 10 | Train Loss: 0.254 Vali Loss: 3.101 Vali Acc: 0.294 Test Loss: 3.101 Test Acc: 0.294
Validation loss decreased (-0.272911 --> -0.294087).  Saving model ...
Epoch: 9 cost time: 4.229149580001831
Epoch: 9, Steps: 10 | Train Loss: 0.230 Vali Loss: 3.228 Vali Acc: 0.299 Test Loss: 3.228 Test Acc: 0.299
Validation loss decreased (-0.294087 --> -0.298791).  Saving model ...
Epoch: 10 cost time: 4.954485893249512
Epoch: 10, Steps: 10 | Train Loss: 0.096 Vali Loss: 3.220 Vali Acc: 0.302 Test Loss: 3.220 Test Acc: 0.302
Validation loss decreased (-0.298791 --> -0.302321).  Saving model ...
Epoch: 11 cost time: 5.0002570152282715
Epoch: 11, Steps: 10 | Train Loss: 0.056 Vali Loss: 3.326 Vali Acc: 0.302 Test Loss: 3.326 Test Acc: 0.302
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.0917253494262695
Epoch: 12, Steps: 10 | Train Loss: 0.135 Vali Loss: 3.503 Vali Acc: 0.276 Test Loss: 3.503 Test Acc: 0.276
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.244997978210449
Epoch: 13, Steps: 10 | Train Loss: 0.120 Vali Loss: 3.345 Vali Acc: 0.281 Test Loss: 3.345 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.992513656616211
Epoch: 14, Steps: 10 | Train Loss: 0.111 Vali Loss: 3.420 Vali Acc: 0.288 Test Loss: 3.420 Test Acc: 0.288
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.867057800292969
Epoch: 15, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.370 Vali Acc: 0.315 Test Loss: 3.370 Test Acc: 0.315
Validation loss decreased (-0.302321 --> -0.315260).  Saving model ...
Epoch: 16 cost time: 4.219721078872681
Epoch: 16, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.429 Vali Acc: 0.319 Test Loss: 3.429 Test Acc: 0.319
Validation loss decreased (-0.315260 --> -0.318789).  Saving model ...
Epoch: 17 cost time: 4.9882214069366455
Epoch: 17, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.544 Vali Acc: 0.314 Test Loss: 3.544 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.970102787017822
Epoch: 18, Steps: 10 | Train Loss: 0.085 Vali Loss: 3.622 Vali Acc: 0.300 Test Loss: 3.622 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.9097440242767334
Epoch: 19, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.563 Vali Acc: 0.311 Test Loss: 3.563 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.103003740310669
Epoch: 20, Steps: 10 | Train Loss: 0.073 Vali Loss: 3.526 Vali Acc: 0.315 Test Loss: 3.526 Test Acc: 0.315
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 5.033430576324463
Epoch: 21, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.564 Vali Acc: 0.308 Test Loss: 3.564 Test Acc: 0.308
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 4.179931640625
Epoch: 22, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.518 Vali Acc: 0.321 Test Loss: 3.518 Test Acc: 0.321
Validation loss decreased (-0.318789 --> -0.321141).  Saving model ...
Epoch: 23 cost time: 4.597205400466919
Epoch: 23, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.739 Vali Acc: 0.304 Test Loss: 3.739 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 5.157714128494263
Epoch: 24, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.660 Vali Acc: 0.304 Test Loss: 3.660 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.317340135574341
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.634 Vali Acc: 0.302 Test Loss: 3.634 Test Acc: 0.302
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 4.592071056365967
Epoch: 26, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.597 Vali Acc: 0.315 Test Loss: 3.597 Test Acc: 0.315
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 4.845390558242798
Epoch: 27, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.593 Vali Acc: 0.324 Test Loss: 3.593 Test Acc: 0.324
Validation loss decreased (-0.321141 --> -0.323493).  Saving model ...
Epoch: 28 cost time: 4.676012754440308
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.600 Vali Acc: 0.327 Test Loss: 3.600 Test Acc: 0.327
Validation loss decreased (-0.323493 --> -0.327023).  Saving model ...
Epoch: 29 cost time: 4.231901407241821
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.557 Vali Acc: 0.341 Test Loss: 3.557 Test Acc: 0.341
Validation loss decreased (-0.327023 --> -0.341141).  Saving model ...
Epoch: 30 cost time: 4.963090658187866
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.557 Vali Acc: 0.342 Test Loss: 3.557 Test Acc: 0.342
Validation loss decreased (-0.341141 --> -0.342317).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3423529411764706
model parameter : 28374618
model size : 109.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.5950827598571777
Epoch: 1, Steps: 10 | Train Loss: 3.354 Vali Loss: 3.270 Vali Acc: 0.038 Test Loss: 3.270 Test Acc: 0.038
Validation loss decreased (inf --> -0.037614).  Saving model ...
Epoch: 2 cost time: 2.1643035411834717
Epoch: 2, Steps: 10 | Train Loss: 3.043 Vali Loss: 3.288 Vali Acc: 0.084 Test Loss: 3.288 Test Acc: 0.084
Validation loss decreased (-0.037614 --> -0.083497).  Saving model ...
Epoch: 3 cost time: 2.1855552196502686
Epoch: 3, Steps: 10 | Train Loss: 2.616 Vali Loss: 3.199 Vali Acc: 0.134 Test Loss: 3.199 Test Acc: 0.134
Validation loss decreased (-0.083497 --> -0.134086).  Saving model ...
Epoch: 4 cost time: 2.2189230918884277
Epoch: 4, Steps: 10 | Train Loss: 2.021 Vali Loss: 3.027 Vali Acc: 0.200 Test Loss: 3.027 Test Acc: 0.200
Validation loss decreased (-0.134086 --> -0.199970).  Saving model ...
Epoch: 5 cost time: 2.0011653900146484
Epoch: 5, Steps: 10 | Train Loss: 1.593 Vali Loss: 3.035 Vali Acc: 0.211 Test Loss: 3.035 Test Acc: 0.211
Validation loss decreased (-0.199970 --> -0.210558).  Saving model ...
Epoch: 6 cost time: 1.9411118030548096
Epoch: 6, Steps: 10 | Train Loss: 1.024 Vali Loss: 2.979 Vali Acc: 0.233 Test Loss: 2.979 Test Acc: 0.233
Validation loss decreased (-0.210558 --> -0.232911).  Saving model ...
Epoch: 7 cost time: 2.3929240703582764
Epoch: 7, Steps: 10 | Train Loss: 0.758 Vali Loss: 2.983 Vali Acc: 0.273 Test Loss: 2.983 Test Acc: 0.273
Validation loss decreased (-0.232911 --> -0.272911).  Saving model ...
Epoch: 8 cost time: 1.9518139362335205
Epoch: 8, Steps: 10 | Train Loss: 0.637 Vali Loss: 3.064 Vali Acc: 0.276 Test Loss: 3.064 Test Acc: 0.276
Validation loss decreased (-0.272911 --> -0.276440).  Saving model ...
Epoch: 9 cost time: 1.940708875656128
Epoch: 9, Steps: 10 | Train Loss: 0.350 Vali Loss: 2.994 Vali Acc: 0.296 Test Loss: 2.994 Test Acc: 0.296
Validation loss decreased (-0.276440 --> -0.296441).  Saving model ...
Epoch: 10 cost time: 2.002000570297241
Epoch: 10, Steps: 10 | Train Loss: 0.175 Vali Loss: 3.183 Vali Acc: 0.295 Test Loss: 3.183 Test Acc: 0.295
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6400952339172363
Epoch: 11, Steps: 10 | Train Loss: 0.122 Vali Loss: 3.225 Vali Acc: 0.293 Test Loss: 3.225 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6315462589263916
Epoch: 12, Steps: 10 | Train Loss: 0.083 Vali Loss: 3.297 Vali Acc: 0.309 Test Loss: 3.297 Test Acc: 0.309
Validation loss decreased (-0.296441 --> -0.309379).  Saving model ...
Epoch: 13 cost time: 1.402923583984375
Epoch: 13, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.336 Vali Acc: 0.315 Test Loss: 3.336 Test Acc: 0.315
Validation loss decreased (-0.309379 --> -0.315261).  Saving model ...
Epoch: 14 cost time: 2.0483832359313965
Epoch: 14, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.300 Vali Acc: 0.318 Test Loss: 3.300 Test Acc: 0.318
Validation loss decreased (-0.315261 --> -0.317614).  Saving model ...
Epoch: 15 cost time: 1.9064955711364746
Epoch: 15, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.271 Vali Acc: 0.332 Test Loss: 3.271 Test Acc: 0.332
Validation loss decreased (-0.317614 --> -0.331732).  Saving model ...
Epoch: 16 cost time: 1.9476580619812012
Epoch: 16, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.428 Vali Acc: 0.299 Test Loss: 3.428 Test Acc: 0.299
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7414562702178955
Epoch: 17, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.491 Vali Acc: 0.312 Test Loss: 3.491 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4434735774993896
Epoch: 18, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.401 Vali Acc: 0.328 Test Loss: 3.401 Test Acc: 0.328
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.655545711517334
Epoch: 19, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.393 Vali Acc: 0.319 Test Loss: 3.393 Test Acc: 0.319
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.89296555519104
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.546 Vali Acc: 0.313 Test Loss: 3.546 Test Acc: 0.313
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.9304404258728027
Epoch: 21, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.622 Vali Acc: 0.315 Test Loss: 3.622 Test Acc: 0.315
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.930284023284912
Epoch: 22, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.436 Vali Acc: 0.339 Test Loss: 3.436 Test Acc: 0.339
Validation loss decreased (-0.331732 --> -0.338789).  Saving model ...
Epoch: 23 cost time: 1.8838098049163818
Epoch: 23, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.478 Vali Acc: 0.329 Test Loss: 3.478 Test Acc: 0.329
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.6445977687835693
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.541 Vali Acc: 0.329 Test Loss: 3.541 Test Acc: 0.329
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.6779065132141113
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.490 Vali Acc: 0.347 Test Loss: 3.490 Test Acc: 0.347
Validation loss decreased (-0.338789 --> -0.347024).  Saving model ...
Epoch: 26 cost time: 1.8223416805267334
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.460 Vali Acc: 0.353 Test Loss: 3.460 Test Acc: 0.353
Validation loss decreased (-0.347024 --> -0.352907).  Saving model ...
Epoch: 27 cost time: 1.9264686107635498
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.537 Vali Acc: 0.347 Test Loss: 3.537 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.9132328033447266
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.577 Vali Acc: 0.348 Test Loss: 3.577 Test Acc: 0.348
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.8943533897399902
Epoch: 29, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.583 Vali Acc: 0.349 Test Loss: 3.583 Test Acc: 0.349
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.6406781673431396
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.772 Vali Acc: 0.318 Test Loss: 3.772 Test Acc: 0.318
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.35294117647058826
model parameter : 8515290
model size : 33.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.755636930465698
Epoch: 1, Steps: 10 | Train Loss: 3.335 Vali Loss: 3.276 Vali Acc: 0.047 Test Loss: 3.276 Test Acc: 0.047
Validation loss decreased (inf --> -0.047026).  Saving model ...
Epoch: 2 cost time: 3.5158190727233887
Epoch: 2, Steps: 10 | Train Loss: 2.963 Vali Loss: 3.296 Vali Acc: 0.093 Test Loss: 3.296 Test Acc: 0.093
Validation loss decreased (-0.047026 --> -0.092908).  Saving model ...
Epoch: 3 cost time: 2.850043773651123
Epoch: 3, Steps: 10 | Train Loss: 2.495 Vali Loss: 3.191 Vali Acc: 0.141 Test Loss: 3.191 Test Acc: 0.141
Validation loss decreased (-0.092908 --> -0.141145).  Saving model ...
Epoch: 4 cost time: 2.5839664936065674
Epoch: 4, Steps: 10 | Train Loss: 2.059 Vali Loss: 3.161 Vali Acc: 0.181 Test Loss: 3.161 Test Acc: 0.181
Validation loss decreased (-0.141145 --> -0.181145).  Saving model ...
Epoch: 5 cost time: 2.4573090076446533
Epoch: 5, Steps: 10 | Train Loss: 1.549 Vali Loss: 3.085 Vali Acc: 0.227 Test Loss: 3.085 Test Acc: 0.227
Validation loss decreased (-0.181145 --> -0.227028).  Saving model ...
Epoch: 6 cost time: 1.8075270652770996
Epoch: 6, Steps: 10 | Train Loss: 0.967 Vali Loss: 3.116 Vali Acc: 0.234 Test Loss: 3.116 Test Acc: 0.234
Validation loss decreased (-0.227028 --> -0.234086).  Saving model ...
Epoch: 7 cost time: 1.7805614471435547
Epoch: 7, Steps: 10 | Train Loss: 0.581 Vali Loss: 3.068 Vali Acc: 0.273 Test Loss: 3.068 Test Acc: 0.273
Validation loss decreased (-0.234086 --> -0.272910).  Saving model ...
Epoch: 8 cost time: 1.8626117706298828
Epoch: 8, Steps: 10 | Train Loss: 0.344 Vali Loss: 3.087 Vali Acc: 0.295 Test Loss: 3.087 Test Acc: 0.295
Validation loss decreased (-0.272910 --> -0.295263).  Saving model ...
Epoch: 9 cost time: 3.1673550605773926
Epoch: 9, Steps: 10 | Train Loss: 0.166 Vali Loss: 3.154 Vali Acc: 0.319 Test Loss: 3.154 Test Acc: 0.319
Validation loss decreased (-0.295263 --> -0.318792).  Saving model ...
Epoch: 10 cost time: 3.2244250774383545
Epoch: 10, Steps: 10 | Train Loss: 0.227 Vali Loss: 3.200 Vali Acc: 0.315 Test Loss: 3.200 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.2480640411376953
Epoch: 11, Steps: 10 | Train Loss: 0.077 Vali Loss: 3.164 Vali Acc: 0.319 Test Loss: 3.164 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.1931705474853516
Epoch: 12, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.236 Vali Acc: 0.309 Test Loss: 3.236 Test Acc: 0.309
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.2945363521575928
Epoch: 13, Steps: 10 | Train Loss: 0.067 Vali Loss: 3.192 Vali Acc: 0.315 Test Loss: 3.192 Test Acc: 0.315
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.2054619789123535
Epoch: 14, Steps: 10 | Train Loss: 0.115 Vali Loss: 3.505 Vali Acc: 0.275 Test Loss: 3.505 Test Acc: 0.275
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.3860182762145996
Epoch: 15, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.291 Vali Acc: 0.315 Test Loss: 3.291 Test Acc: 0.315
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.270742177963257
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.360 Vali Acc: 0.318 Test Loss: 3.360 Test Acc: 0.318
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.028000831604004
Epoch: 17, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.381 Vali Acc: 0.327 Test Loss: 3.381 Test Acc: 0.327
Validation loss decreased (-0.318792 --> -0.327025).  Saving model ...
Epoch: 18 cost time: 2.98480224609375
Epoch: 18, Steps: 10 | Train Loss: 0.069 Vali Loss: 3.283 Vali Acc: 0.325 Test Loss: 3.283 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.0909194946289062
Epoch: 19, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.296 Vali Acc: 0.320 Test Loss: 3.296 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.0682828426361084
Epoch: 20, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.438 Vali Acc: 0.296 Test Loss: 3.438 Test Acc: 0.296
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.396357297897339
Epoch: 21, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.423 Vali Acc: 0.315 Test Loss: 3.423 Test Acc: 0.315
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.3467984199523926
Epoch: 22, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.426 Vali Acc: 0.314 Test Loss: 3.426 Test Acc: 0.314
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.545410394668579
Epoch: 23, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.493 Vali Acc: 0.291 Test Loss: 3.493 Test Acc: 0.291
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.5210816860198975
Epoch: 24, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.550 Vali Acc: 0.315 Test Loss: 3.550 Test Acc: 0.315
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.2682483196258545
Epoch: 25, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.568 Vali Acc: 0.311 Test Loss: 3.568 Test Acc: 0.311
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.4826884269714355
Epoch: 26, Steps: 10 | Train Loss: 0.163 Vali Loss: 3.532 Vali Acc: 0.313 Test Loss: 3.532 Test Acc: 0.313
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.493025064468384
Epoch: 27, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.563 Vali Acc: 0.314 Test Loss: 3.563 Test Acc: 0.314
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3270588235294118
model parameter : 28374618
model size : 109.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.0132639408111572
Epoch: 1, Steps: 10 | Train Loss: 3.368 Vali Loss: 3.274 Vali Acc: 0.033 Test Loss: 3.274 Test Acc: 0.033
Validation loss decreased (inf --> -0.032908).  Saving model ...
Epoch: 2 cost time: 1.6275014877319336
Epoch: 2, Steps: 10 | Train Loss: 3.089 Vali Loss: 3.320 Vali Acc: 0.073 Test Loss: 3.320 Test Acc: 0.073
Validation loss decreased (-0.032908 --> -0.072908).  Saving model ...
Epoch: 3 cost time: 1.6849513053894043
Epoch: 3, Steps: 10 | Train Loss: 2.771 Vali Loss: 3.273 Vali Acc: 0.122 Test Loss: 3.273 Test Acc: 0.122
Validation loss decreased (-0.072908 --> -0.122320).  Saving model ...
Epoch: 4 cost time: 1.571462869644165
Epoch: 4, Steps: 10 | Train Loss: 2.235 Vali Loss: 3.120 Vali Acc: 0.168 Test Loss: 3.120 Test Acc: 0.168
Validation loss decreased (-0.122320 --> -0.168204).  Saving model ...
Epoch: 5 cost time: 1.4663543701171875
Epoch: 5, Steps: 10 | Train Loss: 1.737 Vali Loss: 3.091 Vali Acc: 0.181 Test Loss: 3.091 Test Acc: 0.181
Validation loss decreased (-0.168204 --> -0.181146).  Saving model ...
Epoch: 6 cost time: 1.287081003189087
Epoch: 6, Steps: 10 | Train Loss: 1.332 Vali Loss: 3.132 Vali Acc: 0.204 Test Loss: 3.132 Test Acc: 0.204
Validation loss decreased (-0.181146 --> -0.203498).  Saving model ...
Epoch: 7 cost time: 0.8321957588195801
Epoch: 7, Steps: 10 | Train Loss: 0.886 Vali Loss: 3.087 Vali Acc: 0.236 Test Loss: 3.087 Test Acc: 0.236
Validation loss decreased (-0.203498 --> -0.236440).  Saving model ...
Epoch: 8 cost time: 1.4793601036071777
Epoch: 8, Steps: 10 | Train Loss: 0.620 Vali Loss: 3.067 Vali Acc: 0.259 Test Loss: 3.067 Test Acc: 0.259
Validation loss decreased (-0.236440 --> -0.258793).  Saving model ...
Epoch: 9 cost time: 1.4452221393585205
Epoch: 9, Steps: 10 | Train Loss: 0.382 Vali Loss: 3.082 Vali Acc: 0.266 Test Loss: 3.082 Test Acc: 0.266
Validation loss decreased (-0.258793 --> -0.265852).  Saving model ...
Epoch: 10 cost time: 1.4791650772094727
Epoch: 10, Steps: 10 | Train Loss: 0.287 Vali Loss: 3.114 Vali Acc: 0.292 Test Loss: 3.114 Test Acc: 0.292
Validation loss decreased (-0.265852 --> -0.291734).  Saving model ...
Epoch: 11 cost time: 1.5425026416778564
Epoch: 11, Steps: 10 | Train Loss: 0.111 Vali Loss: 3.160 Vali Acc: 0.295 Test Loss: 3.160 Test Acc: 0.295
Validation loss decreased (-0.291734 --> -0.295263).  Saving model ...
Epoch: 12 cost time: 1.39459228515625
Epoch: 12, Steps: 10 | Train Loss: 0.116 Vali Loss: 3.236 Vali Acc: 0.299 Test Loss: 3.236 Test Acc: 0.299
Validation loss decreased (-0.295263 --> -0.298791).  Saving model ...
Epoch: 13 cost time: 1.5878403186798096
Epoch: 13, Steps: 10 | Train Loss: 0.083 Vali Loss: 3.209 Vali Acc: 0.313 Test Loss: 3.209 Test Acc: 0.313
Validation loss decreased (-0.298791 --> -0.312909).  Saving model ...
Epoch: 14 cost time: 1.4172086715698242
Epoch: 14, Steps: 10 | Train Loss: 0.080 Vali Loss: 3.230 Vali Acc: 0.314 Test Loss: 3.230 Test Acc: 0.314
Validation loss decreased (-0.312909 --> -0.314085).  Saving model ...
Epoch: 15 cost time: 1.541219711303711
Epoch: 15, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.276 Vali Acc: 0.319 Test Loss: 3.276 Test Acc: 0.319
Validation loss decreased (-0.314085 --> -0.318791).  Saving model ...
Epoch: 16 cost time: 1.543351173400879
Epoch: 16, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.331 Vali Acc: 0.318 Test Loss: 3.331 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4327480792999268
Epoch: 17, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.342 Vali Acc: 0.313 Test Loss: 3.342 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4291048049926758
Epoch: 18, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.337 Vali Acc: 0.324 Test Loss: 3.337 Test Acc: 0.324
Validation loss decreased (-0.318791 --> -0.323496).  Saving model ...
Epoch: 19 cost time: 1.4687213897705078
Epoch: 19, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.424 Vali Acc: 0.318 Test Loss: 3.424 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.269141435623169
Epoch: 20, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.445 Vali Acc: 0.318 Test Loss: 3.445 Test Acc: 0.318
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2845439910888672
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.457 Vali Acc: 0.322 Test Loss: 3.457 Test Acc: 0.322
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.2854409217834473
Epoch: 22, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.476 Vali Acc: 0.325 Test Loss: 3.476 Test Acc: 0.325
Validation loss decreased (-0.323496 --> -0.324671).  Saving model ...
Epoch: 23 cost time: 1.2487127780914307
Epoch: 23, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.537 Vali Acc: 0.306 Test Loss: 3.537 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0972137451171875
Epoch: 24, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.543 Vali Acc: 0.296 Test Loss: 3.543 Test Acc: 0.296
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.5906832218170166
Epoch: 25, Steps: 10 | Train Loss: 0.058 Vali Loss: 3.668 Vali Acc: 0.292 Test Loss: 3.668 Test Acc: 0.292
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.5707640647888184
Epoch: 26, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.646 Vali Acc: 0.314 Test Loss: 3.646 Test Acc: 0.314
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.3974406719207764
Epoch: 27, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.641 Vali Acc: 0.300 Test Loss: 3.641 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.5346486568450928
Epoch: 28, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.700 Vali Acc: 0.287 Test Loss: 3.700 Test Acc: 0.287
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.542961597442627
Epoch: 29, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.829 Vali Acc: 0.274 Test Loss: 3.829 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.525507926940918
Epoch: 30, Steps: 10 | Train Loss: 0.043 Vali Loss: 3.853 Vali Acc: 0.288 Test Loss: 3.853 Test Acc: 0.288
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3247058823529412
model parameter : 8515290
model size : 33.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 6.616578578948975
Epoch: 1, Steps: 10 | Train Loss: 3.361 Vali Loss: 3.290 Vali Acc: 0.051 Test Loss: 3.290 Test Acc: 0.051
Validation loss decreased (inf --> -0.050555).  Saving model ...
Epoch: 2 cost time: 4.8559730052948
Epoch: 2, Steps: 10 | Train Loss: 2.968 Vali Loss: 3.247 Vali Acc: 0.108 Test Loss: 3.247 Test Acc: 0.108
Validation loss decreased (-0.050555 --> -0.108203).  Saving model ...
Epoch: 3 cost time: 4.829024791717529
Epoch: 3, Steps: 10 | Train Loss: 2.560 Vali Loss: 3.182 Vali Acc: 0.147 Test Loss: 3.182 Test Acc: 0.147
Validation loss decreased (-0.108203 --> -0.147027).  Saving model ...
Epoch: 4 cost time: 5.189606428146362
Epoch: 4, Steps: 10 | Train Loss: 1.942 Vali Loss: 3.031 Vali Acc: 0.185 Test Loss: 3.031 Test Acc: 0.185
Validation loss decreased (-0.147027 --> -0.184676).  Saving model ...
Epoch: 5 cost time: 4.5919554233551025
Epoch: 5, Steps: 10 | Train Loss: 1.345 Vali Loss: 2.956 Vali Acc: 0.216 Test Loss: 2.956 Test Acc: 0.216
Validation loss decreased (-0.184676 --> -0.216441).  Saving model ...
Epoch: 6 cost time: 4.561023712158203
Epoch: 6, Steps: 10 | Train Loss: 0.860 Vali Loss: 2.967 Vali Acc: 0.234 Test Loss: 2.967 Test Acc: 0.234
Validation loss decreased (-0.216441 --> -0.234088).  Saving model ...
Epoch: 7 cost time: 4.582263469696045
Epoch: 7, Steps: 10 | Train Loss: 0.626 Vali Loss: 3.003 Vali Acc: 0.256 Test Loss: 3.003 Test Acc: 0.256
Validation loss decreased (-0.234088 --> -0.256441).  Saving model ...
Epoch: 8 cost time: 4.935556888580322
Epoch: 8, Steps: 10 | Train Loss: 0.399 Vali Loss: 3.042 Vali Acc: 0.273 Test Loss: 3.042 Test Acc: 0.273
Validation loss decreased (-0.256441 --> -0.272911).  Saving model ...
Epoch: 9 cost time: 4.901386260986328
Epoch: 9, Steps: 10 | Train Loss: 0.196 Vali Loss: 2.989 Vali Acc: 0.304 Test Loss: 2.989 Test Acc: 0.304
Validation loss decreased (-0.272911 --> -0.303500).  Saving model ...
Epoch: 10 cost time: 4.852465391159058
Epoch: 10, Steps: 10 | Train Loss: 0.105 Vali Loss: 3.100 Vali Acc: 0.316 Test Loss: 3.100 Test Acc: 0.316
Validation loss decreased (-0.303500 --> -0.316440).  Saving model ...
Epoch: 11 cost time: 4.974758148193359
Epoch: 11, Steps: 10 | Train Loss: 0.078 Vali Loss: 3.110 Vali Acc: 0.315 Test Loss: 3.110 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.7404701709747314
Epoch: 12, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.112 Vali Acc: 0.318 Test Loss: 3.112 Test Acc: 0.318
Validation loss decreased (-0.316440 --> -0.317616).  Saving model ...
Epoch: 13 cost time: 4.368066310882568
Epoch: 13, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.125 Vali Acc: 0.339 Test Loss: 3.125 Test Acc: 0.339
Validation loss decreased (-0.317616 --> -0.338792).  Saving model ...
Epoch: 14 cost time: 4.52524733543396
Epoch: 14, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.156 Vali Acc: 0.336 Test Loss: 3.156 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.275094985961914
Epoch: 15, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.201 Vali Acc: 0.332 Test Loss: 3.201 Test Acc: 0.332
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.040585041046143
Epoch: 16, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.212 Vali Acc: 0.329 Test Loss: 3.212 Test Acc: 0.329
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.873907566070557
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.201 Vali Acc: 0.338 Test Loss: 3.201 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.640798568725586
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.221 Vali Acc: 0.336 Test Loss: 3.221 Test Acc: 0.336
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 5.157254457473755
Epoch: 19, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.503 Vali Acc: 0.311 Test Loss: 3.503 Test Acc: 0.311
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.849101305007935
Epoch: 20, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.194 Vali Acc: 0.321 Test Loss: 3.194 Test Acc: 0.321
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.809463977813721
Epoch: 21, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.278 Vali Acc: 0.333 Test Loss: 3.278 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.591336011886597
Epoch: 22, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.262 Vali Acc: 0.326 Test Loss: 3.262 Test Acc: 0.326
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.494807481765747
Epoch: 23, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.161 Vali Acc: 0.326 Test Loss: 3.161 Test Acc: 0.326
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3388235294117647
model parameter : 14314842
model size : 55.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.78661847114563
Epoch: 1, Steps: 10 | Train Loss: 3.378 Vali Loss: 3.294 Vali Acc: 0.055 Test Loss: 3.294 Test Acc: 0.055
Validation loss decreased (inf --> -0.055261).  Saving model ...
Epoch: 2 cost time: 2.2264888286590576
Epoch: 2, Steps: 10 | Train Loss: 3.040 Vali Loss: 3.281 Vali Acc: 0.104 Test Loss: 3.281 Test Acc: 0.104
Validation loss decreased (-0.055261 --> -0.103497).  Saving model ...
Epoch: 3 cost time: 2.305314064025879
Epoch: 3, Steps: 10 | Train Loss: 2.615 Vali Loss: 3.216 Vali Acc: 0.154 Test Loss: 3.216 Test Acc: 0.154
Validation loss decreased (-0.103497 --> -0.154085).  Saving model ...
Epoch: 4 cost time: 2.1924326419830322
Epoch: 4, Steps: 10 | Train Loss: 2.115 Vali Loss: 3.066 Vali Acc: 0.168 Test Loss: 3.066 Test Acc: 0.168
Validation loss decreased (-0.154085 --> -0.168205).  Saving model ...
Epoch: 5 cost time: 2.2069437503814697
Epoch: 5, Steps: 10 | Train Loss: 1.551 Vali Loss: 3.020 Vali Acc: 0.200 Test Loss: 3.020 Test Acc: 0.200
Validation loss decreased (-0.168205 --> -0.199970).  Saving model ...
Epoch: 6 cost time: 2.240739583969116
Epoch: 6, Steps: 10 | Train Loss: 1.041 Vali Loss: 2.967 Vali Acc: 0.216 Test Loss: 2.967 Test Acc: 0.216
Validation loss decreased (-0.199970 --> -0.216441).  Saving model ...
Epoch: 7 cost time: 2.219170331954956
Epoch: 7, Steps: 10 | Train Loss: 0.662 Vali Loss: 2.962 Vali Acc: 0.244 Test Loss: 2.962 Test Acc: 0.244
Validation loss decreased (-0.216441 --> -0.243500).  Saving model ...
Epoch: 8 cost time: 2.28104567527771
Epoch: 8, Steps: 10 | Train Loss: 0.424 Vali Loss: 3.033 Vali Acc: 0.271 Test Loss: 3.033 Test Acc: 0.271
Validation loss decreased (-0.243500 --> -0.270558).  Saving model ...
Epoch: 9 cost time: 2.2673308849334717
Epoch: 9, Steps: 10 | Train Loss: 0.219 Vali Loss: 3.067 Vali Acc: 0.286 Test Loss: 3.067 Test Acc: 0.286
Validation loss decreased (-0.270558 --> -0.285852).  Saving model ...
Epoch: 10 cost time: 2.3131301403045654
Epoch: 10, Steps: 10 | Train Loss: 0.143 Vali Loss: 3.143 Vali Acc: 0.289 Test Loss: 3.143 Test Acc: 0.289
Validation loss decreased (-0.285852 --> -0.289380).  Saving model ...
Epoch: 11 cost time: 2.024902582168579
Epoch: 11, Steps: 10 | Train Loss: 0.069 Vali Loss: 3.262 Vali Acc: 0.289 Test Loss: 3.262 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9930939674377441
Epoch: 12, Steps: 10 | Train Loss: 0.064 Vali Loss: 3.263 Vali Acc: 0.301 Test Loss: 3.263 Test Acc: 0.301
Validation loss decreased (-0.289380 --> -0.301144).  Saving model ...
Epoch: 13 cost time: 1.9925222396850586
Epoch: 13, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.410 Vali Acc: 0.301 Test Loss: 3.410 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.0043723583221436
Epoch: 14, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.361 Vali Acc: 0.300 Test Loss: 3.361 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.0614891052246094
Epoch: 15, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.300 Vali Acc: 0.322 Test Loss: 3.300 Test Acc: 0.322
Validation loss decreased (-0.301144 --> -0.322320).  Saving model ...
Epoch: 16 cost time: 1.8682441711425781
Epoch: 16, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.290 Vali Acc: 0.322 Test Loss: 3.290 Test Acc: 0.322
Validation loss decreased (-0.322320 --> -0.322320).  Saving model ...
Epoch: 17 cost time: 2.250046491622925
Epoch: 17, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.311 Vali Acc: 0.320 Test Loss: 3.311 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.1558446884155273
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.336 Vali Acc: 0.320 Test Loss: 3.336 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.160200357437134
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.356 Vali Acc: 0.320 Test Loss: 3.356 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.230384349822998
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.348 Vali Acc: 0.320 Test Loss: 3.348 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.2170162200927734
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.372 Vali Acc: 0.319 Test Loss: 3.372 Test Acc: 0.319
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.122973680496216
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.372 Vali Acc: 0.333 Test Loss: 3.372 Test Acc: 0.333
Validation loss decreased (-0.322320 --> -0.332907).  Saving model ...
Epoch: 23 cost time: 2.3358542919158936
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.410 Vali Acc: 0.333 Test Loss: 3.410 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.2249317169189453
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.474 Vali Acc: 0.329 Test Loss: 3.474 Test Acc: 0.329
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.3388912677764893
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.464 Vali Acc: 0.309 Test Loss: 3.464 Test Acc: 0.309
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.2379727363586426
Epoch: 26, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.629 Vali Acc: 0.285 Test Loss: 3.629 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.9839849472045898
Epoch: 27, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.485 Vali Acc: 0.321 Test Loss: 3.485 Test Acc: 0.321
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.9957242012023926
Epoch: 28, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.716 Vali Acc: 0.311 Test Loss: 3.716 Test Acc: 0.311
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.942152976989746
Epoch: 29, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.562 Vali Acc: 0.295 Test Loss: 3.562 Test Acc: 0.295
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.0206234455108643
Epoch: 30, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.650 Vali Acc: 0.301 Test Loss: 3.650 Test Acc: 0.301
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.33294117647058824
model parameter : 4384986
model size : 17.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.0397326946258545
Epoch: 1, Steps: 10 | Train Loss: 3.361 Vali Loss: 3.288 Vali Acc: 0.049 Test Loss: 3.288 Test Acc: 0.049
Validation loss decreased (inf --> -0.049379).  Saving model ...
Epoch: 2 cost time: 3.773132562637329
Epoch: 2, Steps: 10 | Train Loss: 2.969 Vali Loss: 3.252 Vali Acc: 0.114 Test Loss: 3.252 Test Acc: 0.114
Validation loss decreased (-0.049379 --> -0.114085).  Saving model ...
Epoch: 3 cost time: 3.849355936050415
Epoch: 3, Steps: 10 | Train Loss: 2.579 Vali Loss: 3.193 Vali Acc: 0.156 Test Loss: 3.193 Test Acc: 0.156
Validation loss decreased (-0.114085 --> -0.156439).  Saving model ...
Epoch: 4 cost time: 3.788475751876831
Epoch: 4, Steps: 10 | Train Loss: 2.030 Vali Loss: 3.049 Vali Acc: 0.182 Test Loss: 3.049 Test Acc: 0.182
Validation loss decreased (-0.156439 --> -0.182322).  Saving model ...
Epoch: 5 cost time: 3.7435147762298584
Epoch: 5, Steps: 10 | Train Loss: 1.502 Vali Loss: 2.996 Vali Acc: 0.195 Test Loss: 2.996 Test Acc: 0.195
Validation loss decreased (-0.182322 --> -0.195264).  Saving model ...
Epoch: 6 cost time: 3.6497373580932617
Epoch: 6, Steps: 10 | Train Loss: 1.075 Vali Loss: 3.015 Vali Acc: 0.229 Test Loss: 3.015 Test Acc: 0.229
Validation loss decreased (-0.195264 --> -0.229382).  Saving model ...
Epoch: 7 cost time: 3.44454288482666
Epoch: 7, Steps: 10 | Train Loss: 0.752 Vali Loss: 3.001 Vali Acc: 0.268 Test Loss: 3.001 Test Acc: 0.268
Validation loss decreased (-0.229382 --> -0.268205).  Saving model ...
Epoch: 8 cost time: 3.054617404937744
Epoch: 8, Steps: 10 | Train Loss: 0.424 Vali Loss: 3.012 Vali Acc: 0.291 Test Loss: 3.012 Test Acc: 0.291
Validation loss decreased (-0.268205 --> -0.290558).  Saving model ...
Epoch: 9 cost time: 3.1049728393554688
Epoch: 9, Steps: 10 | Train Loss: 0.249 Vali Loss: 3.052 Vali Acc: 0.311 Test Loss: 3.052 Test Acc: 0.311
Validation loss decreased (-0.290558 --> -0.310558).  Saving model ...
Epoch: 10 cost time: 3.027737855911255
Epoch: 10, Steps: 10 | Train Loss: 0.166 Vali Loss: 3.044 Vali Acc: 0.352 Test Loss: 3.044 Test Acc: 0.352
Validation loss decreased (-0.310558 --> -0.351734).  Saving model ...
Epoch: 11 cost time: 3.054202079772949
Epoch: 11, Steps: 10 | Train Loss: 0.116 Vali Loss: 3.162 Vali Acc: 0.314 Test Loss: 3.162 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.528308629989624
Epoch: 12, Steps: 10 | Train Loss: 0.066 Vali Loss: 3.146 Vali Acc: 0.319 Test Loss: 3.146 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.3824923038482666
Epoch: 13, Steps: 10 | Train Loss: 0.087 Vali Loss: 3.189 Vali Acc: 0.335 Test Loss: 3.189 Test Acc: 0.335
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.388481378555298
Epoch: 14, Steps: 10 | Train Loss: 0.101 Vali Loss: 3.154 Vali Acc: 0.342 Test Loss: 3.154 Test Acc: 0.342
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.546687364578247
Epoch: 15, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.224 Vali Acc: 0.338 Test Loss: 3.224 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.458739995956421
Epoch: 16, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.198 Vali Acc: 0.333 Test Loss: 3.198 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.4103846549987793
Epoch: 17, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.295 Vali Acc: 0.329 Test Loss: 3.295 Test Acc: 0.329
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.41890025138855
Epoch: 18, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.360 Vali Acc: 0.344 Test Loss: 3.360 Test Acc: 0.344
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.431190252304077
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.327 Vali Acc: 0.352 Test Loss: 3.327 Test Acc: 0.352
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.0180575847625732
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.276 Vali Acc: 0.344 Test Loss: 3.276 Test Acc: 0.344
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3517647058823529
model parameter : 14314842
model size : 55.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.840662717819214
Epoch: 1, Steps: 10 | Train Loss: 3.367 Vali Loss: 3.294 Vali Acc: 0.059 Test Loss: 3.294 Test Acc: 0.059
Validation loss decreased (inf --> -0.058791).  Saving model ...
Epoch: 2 cost time: 1.6572577953338623
Epoch: 2, Steps: 10 | Train Loss: 3.047 Vali Loss: 3.284 Vali Acc: 0.100 Test Loss: 3.284 Test Acc: 0.100
Validation loss decreased (-0.058791 --> -0.099967).  Saving model ...
Epoch: 3 cost time: 1.7330644130706787
Epoch: 3, Steps: 10 | Train Loss: 2.644 Vali Loss: 3.223 Vali Acc: 0.149 Test Loss: 3.223 Test Acc: 0.149
Validation loss decreased (-0.099967 --> -0.149380).  Saving model ...
Epoch: 4 cost time: 1.7735745906829834
Epoch: 4, Steps: 10 | Train Loss: 2.162 Vali Loss: 3.080 Vali Acc: 0.171 Test Loss: 3.080 Test Acc: 0.171
Validation loss decreased (-0.149380 --> -0.170557).  Saving model ...
Epoch: 5 cost time: 1.7320895195007324
Epoch: 5, Steps: 10 | Train Loss: 1.628 Vali Loss: 3.033 Vali Acc: 0.214 Test Loss: 3.033 Test Acc: 0.214
Validation loss decreased (-0.170557 --> -0.214087).  Saving model ...
Epoch: 6 cost time: 1.789522409439087
Epoch: 6, Steps: 10 | Train Loss: 1.203 Vali Loss: 2.991 Vali Acc: 0.225 Test Loss: 2.991 Test Acc: 0.225
Validation loss decreased (-0.214087 --> -0.224676).  Saving model ...
Epoch: 7 cost time: 1.656919240951538
Epoch: 7, Steps: 10 | Train Loss: 0.802 Vali Loss: 2.975 Vali Acc: 0.249 Test Loss: 2.975 Test Acc: 0.249
Validation loss decreased (-0.224676 --> -0.249382).  Saving model ...
Epoch: 8 cost time: 1.678938627243042
Epoch: 8, Steps: 10 | Train Loss: 0.536 Vali Loss: 3.058 Vali Acc: 0.281 Test Loss: 3.058 Test Acc: 0.281
Validation loss decreased (-0.249382 --> -0.281146).  Saving model ...
Epoch: 9 cost time: 1.7901883125305176
Epoch: 9, Steps: 10 | Train Loss: 0.259 Vali Loss: 3.072 Vali Acc: 0.307 Test Loss: 3.072 Test Acc: 0.307
Validation loss decreased (-0.281146 --> -0.307028).  Saving model ...
Epoch: 10 cost time: 1.6597261428833008
Epoch: 10, Steps: 10 | Train Loss: 0.234 Vali Loss: 3.131 Vali Acc: 0.309 Test Loss: 3.131 Test Acc: 0.309
Validation loss decreased (-0.307028 --> -0.309380).  Saving model ...
Epoch: 11 cost time: 1.619978904724121
Epoch: 11, Steps: 10 | Train Loss: 0.152 Vali Loss: 3.270 Vali Acc: 0.304 Test Loss: 3.270 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6419003009796143
Epoch: 12, Steps: 10 | Train Loss: 0.100 Vali Loss: 3.406 Vali Acc: 0.300 Test Loss: 3.406 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.625396490097046
Epoch: 13, Steps: 10 | Train Loss: 0.083 Vali Loss: 3.407 Vali Acc: 0.299 Test Loss: 3.407 Test Acc: 0.299
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.6134741306304932
Epoch: 14, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.418 Vali Acc: 0.315 Test Loss: 3.418 Test Acc: 0.315
Validation loss decreased (-0.309380 --> -0.315260).  Saving model ...
Epoch: 15 cost time: 1.514279842376709
Epoch: 15, Steps: 10 | Train Loss: 0.082 Vali Loss: 3.342 Vali Acc: 0.329 Test Loss: 3.342 Test Acc: 0.329
Validation loss decreased (-0.315260 --> -0.329378).  Saving model ...
Epoch: 16 cost time: 1.422353982925415
Epoch: 16, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.439 Vali Acc: 0.316 Test Loss: 3.439 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4747240543365479
Epoch: 17, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.386 Vali Acc: 0.327 Test Loss: 3.386 Test Acc: 0.327
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.426295280456543
Epoch: 18, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.491 Vali Acc: 0.324 Test Loss: 3.491 Test Acc: 0.324
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.4598407745361328
Epoch: 19, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.622 Vali Acc: 0.320 Test Loss: 3.622 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.4320733547210693
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.556 Vali Acc: 0.320 Test Loss: 3.556 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.5455355644226074
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.548 Vali Acc: 0.334 Test Loss: 3.548 Test Acc: 0.334
Validation loss decreased (-0.329378 --> -0.334082).  Saving model ...
Epoch: 22 cost time: 1.61855149269104
Epoch: 22, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.757 Vali Acc: 0.311 Test Loss: 3.757 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.604078769683838
Epoch: 23, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.653 Vali Acc: 0.322 Test Loss: 3.653 Test Acc: 0.322
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.5935485363006592
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.551 Vali Acc: 0.334 Test Loss: 3.551 Test Acc: 0.334
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.589939832687378
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.537 Vali Acc: 0.331 Test Loss: 3.537 Test Acc: 0.331
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.6149818897247314
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.534 Vali Acc: 0.333 Test Loss: 3.534 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.543992519378662
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.535 Vali Acc: 0.344 Test Loss: 3.535 Test Acc: 0.344
Validation loss decreased (-0.334082 --> -0.343494).  Saving model ...
Epoch: 28 cost time: 1.6549243927001953
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.562 Vali Acc: 0.334 Test Loss: 3.562 Test Acc: 0.334
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.6749968528747559
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.630 Vali Acc: 0.328 Test Loss: 3.630 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.6229312419891357
Epoch: 30, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.650 Vali Acc: 0.335 Test Loss: 3.650 Test Acc: 0.335
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.34352941176470586
model parameter : 4384986
model size : 17.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.7714550495147705
Epoch: 1, Steps: 10 | Train Loss: 3.365 Vali Loss: 3.296 Vali Acc: 0.051 Test Loss: 3.296 Test Acc: 0.051
Validation loss decreased (inf --> -0.050555).  Saving model ...
Epoch: 2 cost time: 2.1849029064178467
Epoch: 2, Steps: 10 | Train Loss: 3.008 Vali Loss: 3.283 Vali Acc: 0.092 Test Loss: 3.283 Test Acc: 0.092
Validation loss decreased (-0.050555 --> -0.091732).  Saving model ...
Epoch: 3 cost time: 2.1701273918151855
Epoch: 3, Steps: 10 | Train Loss: 2.698 Vali Loss: 3.258 Vali Acc: 0.122 Test Loss: 3.258 Test Acc: 0.122
Validation loss decreased (-0.091732 --> -0.122320).  Saving model ...
Epoch: 4 cost time: 2.2385566234588623
Epoch: 4, Steps: 10 | Train Loss: 2.276 Vali Loss: 3.125 Vali Acc: 0.165 Test Loss: 3.125 Test Acc: 0.165
Validation loss decreased (-0.122320 --> -0.164675).  Saving model ...
Epoch: 5 cost time: 2.0585408210754395
Epoch: 5, Steps: 10 | Train Loss: 1.775 Vali Loss: 3.072 Vali Acc: 0.200 Test Loss: 3.072 Test Acc: 0.200
Validation loss decreased (-0.164675 --> -0.199969).  Saving model ...
Epoch: 6 cost time: 1.8931472301483154
Epoch: 6, Steps: 10 | Train Loss: 1.292 Vali Loss: 3.074 Vali Acc: 0.212 Test Loss: 3.074 Test Acc: 0.212
Validation loss decreased (-0.199969 --> -0.211734).  Saving model ...
Epoch: 7 cost time: 1.8152549266815186
Epoch: 7, Steps: 10 | Train Loss: 0.877 Vali Loss: 2.968 Vali Acc: 0.267 Test Loss: 2.968 Test Acc: 0.267
Validation loss decreased (-0.211734 --> -0.267029).  Saving model ...
Epoch: 8 cost time: 1.9587461948394775
Epoch: 8, Steps: 10 | Train Loss: 0.545 Vali Loss: 3.064 Vali Acc: 0.276 Test Loss: 3.064 Test Acc: 0.276
Validation loss decreased (-0.267029 --> -0.276440).  Saving model ...
Epoch: 9 cost time: 1.8277192115783691
Epoch: 9, Steps: 10 | Train Loss: 0.318 Vali Loss: 2.996 Vali Acc: 0.315 Test Loss: 2.996 Test Acc: 0.315
Validation loss decreased (-0.276440 --> -0.315264).  Saving model ...
Epoch: 10 cost time: 1.9273552894592285
Epoch: 10, Steps: 10 | Train Loss: 0.147 Vali Loss: 3.025 Vali Acc: 0.326 Test Loss: 3.025 Test Acc: 0.326
Validation loss decreased (-0.315264 --> -0.325852).  Saving model ...
Epoch: 11 cost time: 1.1967442035675049
Epoch: 11, Steps: 10 | Train Loss: 0.194 Vali Loss: 3.136 Vali Acc: 0.313 Test Loss: 3.136 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2241113185882568
Epoch: 12, Steps: 10 | Train Loss: 0.140 Vali Loss: 3.180 Vali Acc: 0.309 Test Loss: 3.180 Test Acc: 0.309
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1571323871612549
Epoch: 13, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.131 Vali Acc: 0.329 Test Loss: 3.131 Test Acc: 0.329
Validation loss decreased (-0.325852 --> -0.329380).  Saving model ...
Epoch: 14 cost time: 1.836136817932129
Epoch: 14, Steps: 10 | Train Loss: 0.071 Vali Loss: 3.153 Vali Acc: 0.348 Test Loss: 3.153 Test Acc: 0.348
Validation loss decreased (-0.329380 --> -0.348204).  Saving model ...
Epoch: 15 cost time: 1.9085421562194824
Epoch: 15, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.243 Vali Acc: 0.336 Test Loss: 3.243 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.856945514678955
Epoch: 16, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.232 Vali Acc: 0.340 Test Loss: 3.232 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.9596874713897705
Epoch: 17, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.240 Vali Acc: 0.331 Test Loss: 3.240 Test Acc: 0.331
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.6632976531982422
Epoch: 18, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.354 Vali Acc: 0.332 Test Loss: 3.354 Test Acc: 0.332
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.658630609512329
Epoch: 19, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.270 Vali Acc: 0.341 Test Loss: 3.270 Test Acc: 0.341
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.6495909690856934
Epoch: 20, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.245 Vali Acc: 0.347 Test Loss: 3.245 Test Acc: 0.347
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.8897860050201416
Epoch: 21, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.404 Vali Acc: 0.328 Test Loss: 3.404 Test Acc: 0.328
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.9365882873535156
Epoch: 22, Steps: 10 | Train Loss: 0.073 Vali Loss: 3.571 Vali Acc: 0.300 Test Loss: 3.571 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.1442019939422607
Epoch: 23, Steps: 10 | Train Loss: 0.059 Vali Loss: 3.489 Vali Acc: 0.316 Test Loss: 3.489 Test Acc: 0.316
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.0163798332214355
Epoch: 24, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.450 Vali Acc: 0.318 Test Loss: 3.450 Test Acc: 0.318
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.34823529411764703
model parameter : 14314842
model size : 55.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.622389793395996
Epoch: 1, Steps: 10 | Train Loss: 3.381 Vali Loss: 3.292 Vali Acc: 0.059 Test Loss: 3.292 Test Acc: 0.059
Validation loss decreased (inf --> -0.058791).  Saving model ...
Epoch: 2 cost time: 1.0644352436065674
Epoch: 2, Steps: 10 | Train Loss: 3.045 Vali Loss: 3.298 Vali Acc: 0.098 Test Loss: 3.298 Test Acc: 0.098
Validation loss decreased (-0.058791 --> -0.097614).  Saving model ...
Epoch: 3 cost time: 1.2393851280212402
Epoch: 3, Steps: 10 | Train Loss: 2.647 Vali Loss: 3.258 Vali Acc: 0.140 Test Loss: 3.258 Test Acc: 0.140
Validation loss decreased (-0.097614 --> -0.139967).  Saving model ...
Epoch: 4 cost time: 1.2399606704711914
Epoch: 4, Steps: 10 | Train Loss: 2.286 Vali Loss: 3.129 Vali Acc: 0.166 Test Loss: 3.129 Test Acc: 0.166
Validation loss decreased (-0.139967 --> -0.165851).  Saving model ...
Epoch: 5 cost time: 1.293656826019287
Epoch: 5, Steps: 10 | Train Loss: 1.827 Vali Loss: 3.107 Vali Acc: 0.198 Test Loss: 3.107 Test Acc: 0.198
Validation loss decreased (-0.165851 --> -0.197616).  Saving model ...
Epoch: 6 cost time: 1.094724178314209
Epoch: 6, Steps: 10 | Train Loss: 1.427 Vali Loss: 3.072 Vali Acc: 0.224 Test Loss: 3.072 Test Acc: 0.224
Validation loss decreased (-0.197616 --> -0.223499).  Saving model ...
Epoch: 7 cost time: 1.0825934410095215
Epoch: 7, Steps: 10 | Train Loss: 0.924 Vali Loss: 3.105 Vali Acc: 0.240 Test Loss: 3.105 Test Acc: 0.240
Validation loss decreased (-0.223499 --> -0.239969).  Saving model ...
Epoch: 8 cost time: 1.0566203594207764
Epoch: 8, Steps: 10 | Train Loss: 0.660 Vali Loss: 3.183 Vali Acc: 0.265 Test Loss: 3.183 Test Acc: 0.265
Validation loss decreased (-0.239969 --> -0.264674).  Saving model ...
Epoch: 9 cost time: 0.8891355991363525
Epoch: 9, Steps: 10 | Train Loss: 0.380 Vali Loss: 3.207 Vali Acc: 0.281 Test Loss: 3.207 Test Acc: 0.281
Validation loss decreased (-0.264674 --> -0.281144).  Saving model ...
Epoch: 10 cost time: 0.9553823471069336
Epoch: 10, Steps: 10 | Train Loss: 0.210 Vali Loss: 3.153 Vali Acc: 0.313 Test Loss: 3.153 Test Acc: 0.313
Validation loss decreased (-0.281144 --> -0.312910).  Saving model ...
Epoch: 11 cost time: 0.9422690868377686
Epoch: 11, Steps: 10 | Train Loss: 0.087 Vali Loss: 3.209 Vali Acc: 0.315 Test Loss: 3.209 Test Acc: 0.315
Validation loss decreased (-0.312910 --> -0.315262).  Saving model ...
Epoch: 12 cost time: 0.8840515613555908
Epoch: 12, Steps: 10 | Train Loss: 0.066 Vali Loss: 3.299 Vali Acc: 0.311 Test Loss: 3.299 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.61004638671875
Epoch: 13, Steps: 10 | Train Loss: 0.103 Vali Loss: 3.294 Vali Acc: 0.311 Test Loss: 3.294 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.005244255065918
Epoch: 14, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.364 Vali Acc: 0.313 Test Loss: 3.364 Test Acc: 0.313
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9845774173736572
Epoch: 15, Steps: 10 | Train Loss: 0.092 Vali Loss: 3.278 Vali Acc: 0.307 Test Loss: 3.278 Test Acc: 0.307
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.0655310153961182
Epoch: 16, Steps: 10 | Train Loss: 0.083 Vali Loss: 3.324 Vali Acc: 0.313 Test Loss: 3.324 Test Acc: 0.313
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.991114616394043
Epoch: 17, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.391 Vali Acc: 0.300 Test Loss: 3.391 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.0607211589813232
Epoch: 18, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.497 Vali Acc: 0.311 Test Loss: 3.497 Test Acc: 0.311
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.117077112197876
Epoch: 19, Steps: 10 | Train Loss: 0.104 Vali Loss: 3.387 Vali Acc: 0.332 Test Loss: 3.387 Test Acc: 0.332
Validation loss decreased (-0.315262 --> -0.331731).  Saving model ...
Epoch: 20 cost time: 0.9092128276824951
Epoch: 20, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.469 Vali Acc: 0.304 Test Loss: 3.469 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8968684673309326
Epoch: 21, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.507 Vali Acc: 0.311 Test Loss: 3.507 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8996889591217041
Epoch: 22, Steps: 10 | Train Loss: 0.056 Vali Loss: 3.593 Vali Acc: 0.328 Test Loss: 3.593 Test Acc: 0.328
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8409295082092285
Epoch: 23, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.785 Vali Acc: 0.311 Test Loss: 3.785 Test Acc: 0.311
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.8098127841949463
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.728 Vali Acc: 0.312 Test Loss: 3.728 Test Acc: 0.312
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.081735610961914
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.650 Vali Acc: 0.319 Test Loss: 3.650 Test Acc: 0.319
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.1737792491912842
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.622 Vali Acc: 0.327 Test Loss: 3.622 Test Acc: 0.327
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.1656787395477295
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.601 Vali Acc: 0.329 Test Loss: 3.601 Test Acc: 0.329
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.1395485401153564
Epoch: 28, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.602 Vali Acc: 0.331 Test Loss: 3.602 Test Acc: 0.331
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.0591914653778076
Epoch: 29, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.752 Vali Acc: 0.331 Test Loss: 3.752 Test Acc: 0.331
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.33176470588235296
model parameter : 4384986
model size : 17.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.01662278175354
Epoch: 1, Steps: 10 | Train Loss: 3.326 Vali Loss: 3.290 Vali Acc: 0.066 Test Loss: 3.290 Test Acc: 0.066
Validation loss decreased (inf --> -0.065849).  Saving model ...
Epoch: 2 cost time: 3.1609725952148438
Epoch: 2, Steps: 10 | Train Loss: 3.049 Vali Loss: 3.313 Vali Acc: 0.085 Test Loss: 3.313 Test Acc: 0.085
Validation loss decreased (-0.065849 --> -0.084673).  Saving model ...
Epoch: 3 cost time: 3.157104730606079
Epoch: 3, Steps: 10 | Train Loss: 2.648 Vali Loss: 3.219 Vali Acc: 0.139 Test Loss: 3.219 Test Acc: 0.139
Validation loss decreased (-0.084673 --> -0.138791).  Saving model ...
Epoch: 4 cost time: 3.1718759536743164
Epoch: 4, Steps: 10 | Train Loss: 2.077 Vali Loss: 3.087 Vali Acc: 0.185 Test Loss: 3.087 Test Acc: 0.185
Validation loss decreased (-0.138791 --> -0.184675).  Saving model ...
Epoch: 5 cost time: 2.7575175762176514
Epoch: 5, Steps: 10 | Train Loss: 1.604 Vali Loss: 3.018 Vali Acc: 0.215 Test Loss: 3.018 Test Acc: 0.215
Validation loss decreased (-0.184675 --> -0.215264).  Saving model ...
Epoch: 6 cost time: 2.5584046840667725
Epoch: 6, Steps: 10 | Train Loss: 1.041 Vali Loss: 2.981 Vali Acc: 0.226 Test Loss: 2.981 Test Acc: 0.226
Validation loss decreased (-0.215264 --> -0.225853).  Saving model ...
Epoch: 7 cost time: 2.4836084842681885
Epoch: 7, Steps: 10 | Train Loss: 0.682 Vali Loss: 3.036 Vali Acc: 0.261 Test Loss: 3.036 Test Acc: 0.261
Validation loss decreased (-0.225853 --> -0.261146).  Saving model ...
Epoch: 8 cost time: 3.10440993309021
Epoch: 8, Steps: 10 | Train Loss: 0.448 Vali Loss: 3.007 Vali Acc: 0.284 Test Loss: 3.007 Test Acc: 0.284
Validation loss decreased (-0.261146 --> -0.283499).  Saving model ...
Epoch: 9 cost time: 3.152595043182373
Epoch: 9, Steps: 10 | Train Loss: 0.230 Vali Loss: 2.997 Vali Acc: 0.304 Test Loss: 2.997 Test Acc: 0.304
Validation loss decreased (-0.283499 --> -0.303499).  Saving model ...
Epoch: 10 cost time: 2.989637613296509
Epoch: 10, Steps: 10 | Train Loss: 0.154 Vali Loss: 3.136 Vali Acc: 0.298 Test Loss: 3.136 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.602445125579834
Epoch: 11, Steps: 10 | Train Loss: 0.084 Vali Loss: 3.146 Vali Acc: 0.322 Test Loss: 3.146 Test Acc: 0.322
Validation loss decreased (-0.303499 --> -0.322321).  Saving model ...
Epoch: 12 cost time: 2.6917409896850586
Epoch: 12, Steps: 10 | Train Loss: 0.077 Vali Loss: 3.136 Vali Acc: 0.325 Test Loss: 3.136 Test Acc: 0.325
Validation loss decreased (-0.322321 --> -0.324675).  Saving model ...
Epoch: 13 cost time: 3.093719482421875
Epoch: 13, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.270 Vali Acc: 0.306 Test Loss: 3.270 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.1235883235931396
Epoch: 14, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.171 Vali Acc: 0.332 Test Loss: 3.171 Test Acc: 0.332
Validation loss decreased (-0.324675 --> -0.331733).  Saving model ...
Epoch: 15 cost time: 3.061340808868408
Epoch: 15, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.157 Vali Acc: 0.334 Test Loss: 3.157 Test Acc: 0.334
Validation loss decreased (-0.331733 --> -0.334086).  Saving model ...
Epoch: 16 cost time: 2.681638240814209
Epoch: 16, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.151 Vali Acc: 0.349 Test Loss: 3.151 Test Acc: 0.349
Validation loss decreased (-0.334086 --> -0.349380).  Saving model ...
Epoch: 17 cost time: 2.683502197265625
Epoch: 17, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.211 Vali Acc: 0.331 Test Loss: 3.211 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.990142345428467
Epoch: 18, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.496 Vali Acc: 0.305 Test Loss: 3.496 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.112327814102173
Epoch: 19, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.199 Vali Acc: 0.335 Test Loss: 3.199 Test Acc: 0.335
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.0436439514160156
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.227 Vali Acc: 0.335 Test Loss: 3.227 Test Acc: 0.335
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.5657341480255127
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.305 Vali Acc: 0.333 Test Loss: 3.305 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.6651337146759033
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.313 Vali Acc: 0.340 Test Loss: 3.313 Test Acc: 0.340
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.595635175704956
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.305 Vali Acc: 0.339 Test Loss: 3.305 Test Acc: 0.339
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.9528708457946777
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.316 Vali Acc: 0.333 Test Loss: 3.316 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.9578499794006348
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.342 Vali Acc: 0.338 Test Loss: 3.342 Test Acc: 0.338
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.949488401412964
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.352 Vali Acc: 0.344 Test Loss: 3.352 Test Acc: 0.344
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.34941176470588237
model parameter : 7284954
model size : 29.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.872633218765259
Epoch: 1, Steps: 10 | Train Loss: 3.320 Vali Loss: 3.281 Vali Acc: 0.064 Test Loss: 3.281 Test Acc: 0.064
Validation loss decreased (inf --> -0.063497).  Saving model ...
Epoch: 2 cost time: 1.5418164730072021
Epoch: 2, Steps: 10 | Train Loss: 3.025 Vali Loss: 3.243 Vali Acc: 0.084 Test Loss: 3.243 Test Acc: 0.084
Validation loss decreased (-0.063497 --> -0.083497).  Saving model ...
Epoch: 3 cost time: 1.562607765197754
Epoch: 3, Steps: 10 | Train Loss: 2.673 Vali Loss: 3.208 Vali Acc: 0.141 Test Loss: 3.208 Test Acc: 0.141
Validation loss decreased (-0.083497 --> -0.141144).  Saving model ...
Epoch: 4 cost time: 1.5684168338775635
Epoch: 4, Steps: 10 | Train Loss: 2.134 Vali Loss: 3.053 Vali Acc: 0.202 Test Loss: 3.053 Test Acc: 0.202
Validation loss decreased (-0.141144 --> -0.202322).  Saving model ...
Epoch: 5 cost time: 1.5466694831848145
Epoch: 5, Steps: 10 | Train Loss: 1.647 Vali Loss: 2.990 Vali Acc: 0.215 Test Loss: 2.990 Test Acc: 0.215
Validation loss decreased (-0.202322 --> -0.215264).  Saving model ...
Epoch: 6 cost time: 1.3753607273101807
Epoch: 6, Steps: 10 | Train Loss: 1.172 Vali Loss: 2.915 Vali Acc: 0.249 Test Loss: 2.915 Test Acc: 0.249
Validation loss decreased (-0.215264 --> -0.249383).  Saving model ...
Epoch: 7 cost time: 1.4568586349487305
Epoch: 7, Steps: 10 | Train Loss: 0.797 Vali Loss: 2.953 Vali Acc: 0.255 Test Loss: 2.953 Test Acc: 0.255
Validation loss decreased (-0.249383 --> -0.255265).  Saving model ...
Epoch: 8 cost time: 1.3556866645812988
Epoch: 8, Steps: 10 | Train Loss: 0.455 Vali Loss: 2.934 Vali Acc: 0.273 Test Loss: 2.934 Test Acc: 0.273
Validation loss decreased (-0.255265 --> -0.272912).  Saving model ...
Epoch: 9 cost time: 1.4644782543182373
Epoch: 9, Steps: 10 | Train Loss: 0.255 Vali Loss: 3.034 Vali Acc: 0.278 Test Loss: 3.034 Test Acc: 0.278
Validation loss decreased (-0.272912 --> -0.277617).  Saving model ...
Epoch: 10 cost time: 1.6932404041290283
Epoch: 10, Steps: 10 | Train Loss: 0.141 Vali Loss: 3.045 Vali Acc: 0.320 Test Loss: 3.045 Test Acc: 0.320
Validation loss decreased (-0.277617 --> -0.319970).  Saving model ...
Epoch: 11 cost time: 1.5625228881835938
Epoch: 11, Steps: 10 | Train Loss: 0.079 Vali Loss: 3.100 Vali Acc: 0.311 Test Loss: 3.100 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6945796012878418
Epoch: 12, Steps: 10 | Train Loss: 0.056 Vali Loss: 3.110 Vali Acc: 0.309 Test Loss: 3.110 Test Acc: 0.309
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.521254062652588
Epoch: 13, Steps: 10 | Train Loss: 0.064 Vali Loss: 3.272 Vali Acc: 0.301 Test Loss: 3.272 Test Acc: 0.301
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.3896679878234863
Epoch: 14, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.180 Vali Acc: 0.312 Test Loss: 3.180 Test Acc: 0.312
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.3775246143341064
Epoch: 15, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.339 Vali Acc: 0.327 Test Loss: 3.339 Test Acc: 0.327
Validation loss decreased (-0.319970 --> -0.327025).  Saving model ...
Epoch: 16 cost time: 1.3898155689239502
Epoch: 16, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.306 Vali Acc: 0.325 Test Loss: 3.306 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2593355178833008
Epoch: 17, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.295 Vali Acc: 0.333 Test Loss: 3.295 Test Acc: 0.333
Validation loss decreased (-0.327025 --> -0.332908).  Saving model ...
Epoch: 18 cost time: 1.3722848892211914
Epoch: 18, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.367 Vali Acc: 0.318 Test Loss: 3.367 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.948728084564209
Epoch: 19, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.356 Vali Acc: 0.324 Test Loss: 3.356 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.934290885925293
Epoch: 20, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.338 Vali Acc: 0.338 Test Loss: 3.338 Test Acc: 0.338
Validation loss decreased (-0.332908 --> -0.337614).  Saving model ...
Epoch: 21 cost time: 0.9430301189422607
Epoch: 21, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.352 Vali Acc: 0.324 Test Loss: 3.352 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9718596935272217
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.472 Vali Acc: 0.326 Test Loss: 3.472 Test Acc: 0.326
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0563554763793945
Epoch: 23, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.544 Vali Acc: 0.332 Test Loss: 3.544 Test Acc: 0.332
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1365113258361816
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.386 Vali Acc: 0.342 Test Loss: 3.386 Test Acc: 0.342
Validation loss decreased (-0.337614 --> -0.342319).  Saving model ...
Epoch: 25 cost time: 1.66593337059021
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.366 Vali Acc: 0.349 Test Loss: 3.366 Test Acc: 0.349
Validation loss decreased (-0.342319 --> -0.349378).  Saving model ...
Epoch: 26 cost time: 1.6667811870574951
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.416 Vali Acc: 0.352 Test Loss: 3.416 Test Acc: 0.352
Validation loss decreased (-0.349378 --> -0.351731).  Saving model ...
Epoch: 27 cost time: 1.704272747039795
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.439 Vali Acc: 0.352 Test Loss: 3.439 Test Acc: 0.352
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.6967108249664307
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.436 Vali Acc: 0.348 Test Loss: 3.436 Test Acc: 0.348
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.771153450012207
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.428 Vali Acc: 0.349 Test Loss: 3.428 Test Acc: 0.349
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.6782832145690918
Epoch: 30, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.725 Vali Acc: 0.320 Test Loss: 3.725 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3517647058823529
model parameter : 2319834
model size : 10.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.6948046684265137
Epoch: 1, Steps: 10 | Train Loss: 3.328 Vali Loss: 3.288 Vali Acc: 0.064 Test Loss: 3.288 Test Acc: 0.064
Validation loss decreased (inf --> -0.063497).  Saving model ...
Epoch: 2 cost time: 2.368415355682373
Epoch: 2, Steps: 10 | Train Loss: 3.054 Vali Loss: 3.312 Vali Acc: 0.084 Test Loss: 3.312 Test Acc: 0.084
Validation loss decreased (-0.063497 --> -0.083496).  Saving model ...
Epoch: 3 cost time: 2.4395244121551514
Epoch: 3, Steps: 10 | Train Loss: 2.682 Vali Loss: 3.224 Vali Acc: 0.132 Test Loss: 3.224 Test Acc: 0.132
Validation loss decreased (-0.083496 --> -0.131732).  Saving model ...
Epoch: 4 cost time: 2.3503808975219727
Epoch: 4, Steps: 10 | Train Loss: 2.175 Vali Loss: 3.094 Vali Acc: 0.182 Test Loss: 3.094 Test Acc: 0.182
Validation loss decreased (-0.131732 --> -0.182322).  Saving model ...
Epoch: 5 cost time: 2.620532512664795
Epoch: 5, Steps: 10 | Train Loss: 1.747 Vali Loss: 3.048 Vali Acc: 0.208 Test Loss: 3.048 Test Acc: 0.208
Validation loss decreased (-0.182322 --> -0.208205).  Saving model ...
Epoch: 6 cost time: 2.604750394821167
Epoch: 6, Steps: 10 | Train Loss: 1.123 Vali Loss: 3.001 Vali Acc: 0.233 Test Loss: 3.001 Test Acc: 0.233
Validation loss decreased (-0.208205 --> -0.232911).  Saving model ...
Epoch: 7 cost time: 2.6727800369262695
Epoch: 7, Steps: 10 | Train Loss: 0.785 Vali Loss: 3.014 Vali Acc: 0.275 Test Loss: 3.014 Test Acc: 0.275
Validation loss decreased (-0.232911 --> -0.275264).  Saving model ...
Epoch: 8 cost time: 2.5784354209899902
Epoch: 8, Steps: 10 | Train Loss: 0.518 Vali Loss: 3.046 Vali Acc: 0.286 Test Loss: 3.046 Test Acc: 0.286
Validation loss decreased (-0.275264 --> -0.285852).  Saving model ...
Epoch: 9 cost time: 2.5323102474212646
Epoch: 9, Steps: 10 | Train Loss: 0.377 Vali Loss: 3.058 Vali Acc: 0.284 Test Loss: 3.058 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.5094621181488037
Epoch: 10, Steps: 10 | Train Loss: 0.247 Vali Loss: 3.028 Vali Acc: 0.326 Test Loss: 3.028 Test Acc: 0.326
Validation loss decreased (-0.285852 --> -0.325852).  Saving model ...
Epoch: 11 cost time: 2.2479066848754883
Epoch: 11, Steps: 10 | Train Loss: 0.125 Vali Loss: 3.220 Vali Acc: 0.309 Test Loss: 3.220 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.1333260536193848
Epoch: 12, Steps: 10 | Train Loss: 0.094 Vali Loss: 3.253 Vali Acc: 0.322 Test Loss: 3.253 Test Acc: 0.322
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.1251509189605713
Epoch: 13, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.271 Vali Acc: 0.316 Test Loss: 3.271 Test Acc: 0.316
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.2373764514923096
Epoch: 14, Steps: 10 | Train Loss: 0.080 Vali Loss: 3.214 Vali Acc: 0.328 Test Loss: 3.214 Test Acc: 0.328
Validation loss decreased (-0.325852 --> -0.328203).  Saving model ...
Epoch: 15 cost time: 2.383798360824585
Epoch: 15, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.211 Vali Acc: 0.342 Test Loss: 3.211 Test Acc: 0.342
Validation loss decreased (-0.328203 --> -0.342321).  Saving model ...
Epoch: 16 cost time: 2.4093565940856934
Epoch: 16, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.198 Vali Acc: 0.344 Test Loss: 3.198 Test Acc: 0.344
Validation loss decreased (-0.342321 --> -0.343497).  Saving model ...
Epoch: 17 cost time: 2.53450083732605
Epoch: 17, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.338 Vali Acc: 0.335 Test Loss: 3.338 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.4566729068756104
Epoch: 18, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.331 Vali Acc: 0.338 Test Loss: 3.331 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.4888134002685547
Epoch: 19, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.397 Vali Acc: 0.335 Test Loss: 3.397 Test Acc: 0.335
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.495326042175293
Epoch: 20, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.352 Vali Acc: 0.332 Test Loss: 3.352 Test Acc: 0.332
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.1659116744995117
Epoch: 21, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.357 Vali Acc: 0.324 Test Loss: 3.357 Test Acc: 0.324
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.1938648223876953
Epoch: 22, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.531 Vali Acc: 0.324 Test Loss: 3.531 Test Acc: 0.324
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.2566978931427
Epoch: 23, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.432 Vali Acc: 0.345 Test Loss: 3.432 Test Acc: 0.345
Validation loss decreased (-0.343497 --> -0.344672).  Saving model ...
Epoch: 24 cost time: 2.187809467315674
Epoch: 24, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.641 Vali Acc: 0.308 Test Loss: 3.641 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.504795789718628
Epoch: 25, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.470 Vali Acc: 0.315 Test Loss: 3.470 Test Acc: 0.315
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.5800609588623047
Epoch: 26, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.523 Vali Acc: 0.295 Test Loss: 3.523 Test Acc: 0.295
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.5366814136505127
Epoch: 27, Steps: 10 | Train Loss: 0.043 Vali Loss: 3.607 Vali Acc: 0.333 Test Loss: 3.607 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.5821313858032227
Epoch: 28, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.652 Vali Acc: 0.318 Test Loss: 3.652 Test Acc: 0.318
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.3946471214294434
Epoch: 29, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.513 Vali Acc: 0.325 Test Loss: 3.513 Test Acc: 0.325
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.526304006576538
Epoch: 30, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.564 Vali Acc: 0.332 Test Loss: 3.564 Test Acc: 0.332
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3447058823529412
model parameter : 7284954
model size : 29.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.551090717315674
Epoch: 1, Steps: 10 | Train Loss: 3.308 Vali Loss: 3.284 Vali Acc: 0.066 Test Loss: 3.284 Test Acc: 0.066
Validation loss decreased (inf --> -0.065850).  Saving model ...
Epoch: 2 cost time: 1.332252025604248
Epoch: 2, Steps: 10 | Train Loss: 3.024 Vali Loss: 3.249 Vali Acc: 0.086 Test Loss: 3.249 Test Acc: 0.086
Validation loss decreased (-0.065850 --> -0.085850).  Saving model ...
Epoch: 3 cost time: 1.3090574741363525
Epoch: 3, Steps: 10 | Train Loss: 2.687 Vali Loss: 3.215 Vali Acc: 0.128 Test Loss: 3.215 Test Acc: 0.128
Validation loss decreased (-0.085850 --> -0.128203).  Saving model ...
Epoch: 4 cost time: 0.9314529895782471
Epoch: 4, Steps: 10 | Train Loss: 2.149 Vali Loss: 3.064 Vali Acc: 0.202 Test Loss: 3.064 Test Acc: 0.202
Validation loss decreased (-0.128203 --> -0.202322).  Saving model ...
Epoch: 5 cost time: 1.4244160652160645
Epoch: 5, Steps: 10 | Train Loss: 1.730 Vali Loss: 3.016 Vali Acc: 0.207 Test Loss: 3.016 Test Acc: 0.207
Validation loss decreased (-0.202322 --> -0.207029).  Saving model ...
Epoch: 6 cost time: 1.4455206394195557
Epoch: 6, Steps: 10 | Train Loss: 1.293 Vali Loss: 2.932 Vali Acc: 0.266 Test Loss: 2.932 Test Acc: 0.266
Validation loss decreased (-0.207029 --> -0.265853).  Saving model ...
Epoch: 7 cost time: 1.4302332401275635
Epoch: 7, Steps: 10 | Train Loss: 0.960 Vali Loss: 2.979 Vali Acc: 0.261 Test Loss: 2.979 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5096657276153564
Epoch: 8, Steps: 10 | Train Loss: 0.603 Vali Loss: 2.974 Vali Acc: 0.264 Test Loss: 2.974 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4172194004058838
Epoch: 9, Steps: 10 | Train Loss: 0.436 Vali Loss: 3.043 Vali Acc: 0.268 Test Loss: 3.043 Test Acc: 0.268
Validation loss decreased (-0.265853 --> -0.268205).  Saving model ...
Epoch: 10 cost time: 1.4032566547393799
Epoch: 10, Steps: 10 | Train Loss: 0.215 Vali Loss: 3.062 Vali Acc: 0.312 Test Loss: 3.062 Test Acc: 0.312
Validation loss decreased (-0.268205 --> -0.311734).  Saving model ...
Epoch: 11 cost time: 1.4260926246643066
Epoch: 11, Steps: 10 | Train Loss: 0.139 Vali Loss: 3.230 Vali Acc: 0.306 Test Loss: 3.230 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4246373176574707
Epoch: 12, Steps: 10 | Train Loss: 0.084 Vali Loss: 3.141 Vali Acc: 0.312 Test Loss: 3.141 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4143805503845215
Epoch: 13, Steps: 10 | Train Loss: 0.083 Vali Loss: 3.309 Vali Acc: 0.313 Test Loss: 3.309 Test Acc: 0.313
Validation loss decreased (-0.311734 --> -0.312908).  Saving model ...
Epoch: 14 cost time: 1.4024255275726318
Epoch: 14, Steps: 10 | Train Loss: 0.083 Vali Loss: 3.210 Vali Acc: 0.320 Test Loss: 3.210 Test Acc: 0.320
Validation loss decreased (-0.312908 --> -0.319968).  Saving model ...
Epoch: 15 cost time: 1.3253607749938965
Epoch: 15, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.292 Vali Acc: 0.319 Test Loss: 3.292 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0272202491760254
Epoch: 16, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.305 Vali Acc: 0.314 Test Loss: 3.305 Test Acc: 0.314
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3191378116607666
Epoch: 17, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.296 Vali Acc: 0.335 Test Loss: 3.296 Test Acc: 0.335
Validation loss decreased (-0.319968 --> -0.335261).  Saving model ...
Epoch: 18 cost time: 1.3340530395507812
Epoch: 18, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.385 Vali Acc: 0.332 Test Loss: 3.385 Test Acc: 0.332
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3732492923736572
Epoch: 19, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.353 Vali Acc: 0.325 Test Loss: 3.353 Test Acc: 0.325
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.395770788192749
Epoch: 20, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.385 Vali Acc: 0.321 Test Loss: 3.385 Test Acc: 0.321
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.4510693550109863
Epoch: 21, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.528 Vali Acc: 0.314 Test Loss: 3.528 Test Acc: 0.314
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.3907244205474854
Epoch: 22, Steps: 10 | Train Loss: 0.056 Vali Loss: 3.476 Vali Acc: 0.306 Test Loss: 3.476 Test Acc: 0.306
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.5724568367004395
Epoch: 23, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.657 Vali Acc: 0.299 Test Loss: 3.657 Test Acc: 0.299
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.5543081760406494
Epoch: 24, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.499 Vali Acc: 0.315 Test Loss: 3.499 Test Acc: 0.315
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.4033496379852295
Epoch: 25, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.433 Vali Acc: 0.329 Test Loss: 3.433 Test Acc: 0.329
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.5557711124420166
Epoch: 26, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.502 Vali Acc: 0.311 Test Loss: 3.502 Test Acc: 0.311
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.5216193199157715
Epoch: 27, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.568 Vali Acc: 0.314 Test Loss: 3.568 Test Acc: 0.314
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3352941176470588
model parameter : 2319834
model size : 10.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.13344669342041
Epoch: 1, Steps: 10 | Train Loss: 3.309 Vali Loss: 3.287 Vali Acc: 0.064 Test Loss: 3.287 Test Acc: 0.064
Validation loss decreased (inf --> -0.063497).  Saving model ...
Epoch: 2 cost time: 1.596045732498169
Epoch: 2, Steps: 10 | Train Loss: 3.073 Vali Loss: 3.327 Vali Acc: 0.080 Test Loss: 3.327 Test Acc: 0.080
Validation loss decreased (-0.063497 --> -0.079967).  Saving model ...
Epoch: 3 cost time: 1.5698940753936768
Epoch: 3, Steps: 10 | Train Loss: 2.761 Vali Loss: 3.264 Vali Acc: 0.127 Test Loss: 3.264 Test Acc: 0.127
Validation loss decreased (-0.079967 --> -0.127026).  Saving model ...
Epoch: 4 cost time: 1.7132697105407715
Epoch: 4, Steps: 10 | Train Loss: 2.318 Vali Loss: 3.157 Vali Acc: 0.158 Test Loss: 3.157 Test Acc: 0.158
Validation loss decreased (-0.127026 --> -0.157615).  Saving model ...
Epoch: 5 cost time: 1.926802635192871
Epoch: 5, Steps: 10 | Train Loss: 1.957 Vali Loss: 3.107 Vali Acc: 0.187 Test Loss: 3.107 Test Acc: 0.187
Validation loss decreased (-0.157615 --> -0.187028).  Saving model ...
Epoch: 6 cost time: 1.673985481262207
Epoch: 6, Steps: 10 | Train Loss: 1.407 Vali Loss: 3.100 Vali Acc: 0.214 Test Loss: 3.100 Test Acc: 0.214
Validation loss decreased (-0.187028 --> -0.214087).  Saving model ...
Epoch: 7 cost time: 1.6533019542694092
Epoch: 7, Steps: 10 | Train Loss: 1.050 Vali Loss: 3.056 Vali Acc: 0.247 Test Loss: 3.056 Test Acc: 0.247
Validation loss decreased (-0.214087 --> -0.247028).  Saving model ...
Epoch: 8 cost time: 1.5866315364837646
Epoch: 8, Steps: 10 | Train Loss: 0.675 Vali Loss: 3.096 Vali Acc: 0.266 Test Loss: 3.096 Test Acc: 0.266
Validation loss decreased (-0.247028 --> -0.265851).  Saving model ...
Epoch: 9 cost time: 1.7806715965270996
Epoch: 9, Steps: 10 | Train Loss: 0.460 Vali Loss: 3.076 Vali Acc: 0.281 Test Loss: 3.076 Test Acc: 0.281
Validation loss decreased (-0.265851 --> -0.281146).  Saving model ...
Epoch: 10 cost time: 1.7441222667694092
Epoch: 10, Steps: 10 | Train Loss: 0.247 Vali Loss: 3.056 Vali Acc: 0.300 Test Loss: 3.056 Test Acc: 0.300
Validation loss decreased (-0.281146 --> -0.299969).  Saving model ...
Epoch: 11 cost time: 1.692176103591919
Epoch: 11, Steps: 10 | Train Loss: 0.140 Vali Loss: 3.152 Vali Acc: 0.325 Test Loss: 3.152 Test Acc: 0.325
Validation loss decreased (-0.299969 --> -0.324674).  Saving model ...
Epoch: 12 cost time: 1.5308434963226318
Epoch: 12, Steps: 10 | Train Loss: 0.102 Vali Loss: 3.273 Vali Acc: 0.301 Test Loss: 3.273 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5307626724243164
Epoch: 13, Steps: 10 | Train Loss: 0.092 Vali Loss: 3.140 Vali Acc: 0.326 Test Loss: 3.140 Test Acc: 0.326
Validation loss decreased (-0.324674 --> -0.325851).  Saving model ...
Epoch: 14 cost time: 1.5446383953094482
Epoch: 14, Steps: 10 | Train Loss: 0.063 Vali Loss: 3.296 Vali Acc: 0.316 Test Loss: 3.296 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4415969848632812
Epoch: 15, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.274 Vali Acc: 0.324 Test Loss: 3.274 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.477396011352539
Epoch: 16, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.393 Vali Acc: 0.334 Test Loss: 3.393 Test Acc: 0.334
Validation loss decreased (-0.325851 --> -0.334084).  Saving model ...
Epoch: 17 cost time: 1.7460267543792725
Epoch: 17, Steps: 10 | Train Loss: 0.069 Vali Loss: 3.393 Vali Acc: 0.325 Test Loss: 3.393 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6154932975769043
Epoch: 18, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.301 Vali Acc: 0.333 Test Loss: 3.301 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.6527774333953857
Epoch: 19, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.401 Vali Acc: 0.335 Test Loss: 3.401 Test Acc: 0.335
Validation loss decreased (-0.334084 --> -0.335260).  Saving model ...
Epoch: 20 cost time: 1.5995659828186035
Epoch: 20, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.505 Vali Acc: 0.329 Test Loss: 3.505 Test Acc: 0.329
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6387219429016113
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.426 Vali Acc: 0.342 Test Loss: 3.426 Test Acc: 0.342
Validation loss decreased (-0.335260 --> -0.342319).  Saving model ...
Epoch: 22 cost time: 1.6145403385162354
Epoch: 22, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.392 Vali Acc: 0.328 Test Loss: 3.392 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.6677448749542236
Epoch: 23, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.336 Vali Acc: 0.325 Test Loss: 3.336 Test Acc: 0.325
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.6179299354553223
Epoch: 24, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.370 Vali Acc: 0.335 Test Loss: 3.370 Test Acc: 0.335
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.4025914669036865
Epoch: 25, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.589 Vali Acc: 0.327 Test Loss: 3.589 Test Acc: 0.327
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.5276613235473633
Epoch: 26, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.550 Vali Acc: 0.328 Test Loss: 3.550 Test Acc: 0.328
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.507493495941162
Epoch: 27, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.759 Vali Acc: 0.311 Test Loss: 3.759 Test Acc: 0.311
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.468113660812378
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.669 Vali Acc: 0.332 Test Loss: 3.669 Test Acc: 0.332
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.4918584823608398
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.582 Vali Acc: 0.352 Test Loss: 3.582 Test Acc: 0.352
Validation loss decreased (-0.342319 --> -0.351729).  Saving model ...
Epoch: 30 cost time: 1.6117236614227295
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.571 Vali Acc: 0.348 Test Loss: 3.571 Test Acc: 0.348
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3517647058823529
model parameter : 7284954
model size : 29.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.5155060291290283
Epoch: 1, Steps: 10 | Train Loss: 3.315 Vali Loss: 3.292 Vali Acc: 0.059 Test Loss: 3.292 Test Acc: 0.059
Validation loss decreased (inf --> -0.058791).  Saving model ...
Epoch: 2 cost time: 1.0995824337005615
Epoch: 2, Steps: 10 | Train Loss: 3.058 Vali Loss: 3.268 Vali Acc: 0.076 Test Loss: 3.268 Test Acc: 0.076
Validation loss decreased (-0.058791 --> -0.076438).  Saving model ...
Epoch: 3 cost time: 1.103661298751831
Epoch: 3, Steps: 10 | Train Loss: 2.768 Vali Loss: 3.255 Vali Acc: 0.111 Test Loss: 3.255 Test Acc: 0.111
Validation loss decreased (-0.076438 --> -0.110556).  Saving model ...
Epoch: 4 cost time: 1.1043157577514648
Epoch: 4, Steps: 10 | Train Loss: 2.324 Vali Loss: 3.129 Vali Acc: 0.186 Test Loss: 3.129 Test Acc: 0.186
Validation loss decreased (-0.110556 --> -0.185851).  Saving model ...
Epoch: 5 cost time: 1.087118148803711
Epoch: 5, Steps: 10 | Train Loss: 1.881 Vali Loss: 3.090 Vali Acc: 0.201 Test Loss: 3.090 Test Acc: 0.201
Validation loss decreased (-0.185851 --> -0.201146).  Saving model ...
Epoch: 6 cost time: 1.0748960971832275
Epoch: 6, Steps: 10 | Train Loss: 1.481 Vali Loss: 3.024 Vali Acc: 0.236 Test Loss: 3.024 Test Acc: 0.236
Validation loss decreased (-0.201146 --> -0.236440).  Saving model ...
Epoch: 7 cost time: 1.00296950340271
Epoch: 7, Steps: 10 | Train Loss: 1.102 Vali Loss: 3.078 Vali Acc: 0.220 Test Loss: 3.078 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5752334594726562
Epoch: 8, Steps: 10 | Train Loss: 0.809 Vali Loss: 3.046 Vali Acc: 0.245 Test Loss: 3.046 Test Acc: 0.245
Validation loss decreased (-0.236440 --> -0.244675).  Saving model ...
Epoch: 9 cost time: 0.967609167098999
Epoch: 9, Steps: 10 | Train Loss: 0.435 Vali Loss: 3.138 Vali Acc: 0.256 Test Loss: 3.138 Test Acc: 0.256
Validation loss decreased (-0.244675 --> -0.256439).  Saving model ...
Epoch: 10 cost time: 0.926274299621582
Epoch: 10, Steps: 10 | Train Loss: 0.228 Vali Loss: 3.108 Vali Acc: 0.298 Test Loss: 3.108 Test Acc: 0.298
Validation loss decreased (-0.256439 --> -0.297616).  Saving model ...
Epoch: 11 cost time: 0.818859338760376
Epoch: 11, Steps: 10 | Train Loss: 0.158 Vali Loss: 3.248 Vali Acc: 0.292 Test Loss: 3.248 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9191586971282959
Epoch: 12, Steps: 10 | Train Loss: 0.107 Vali Loss: 3.185 Vali Acc: 0.309 Test Loss: 3.185 Test Acc: 0.309
Validation loss decreased (-0.297616 --> -0.309380).  Saving model ...
Epoch: 13 cost time: 0.892153263092041
Epoch: 13, Steps: 10 | Train Loss: 0.078 Vali Loss: 3.288 Vali Acc: 0.292 Test Loss: 3.288 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8826253414154053
Epoch: 14, Steps: 10 | Train Loss: 0.085 Vali Loss: 3.315 Vali Acc: 0.311 Test Loss: 3.315 Test Acc: 0.311
Validation loss decreased (-0.309380 --> -0.310555).  Saving model ...
Epoch: 15 cost time: 1.0017273426055908
Epoch: 15, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.424 Vali Acc: 0.309 Test Loss: 3.424 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0149812698364258
Epoch: 16, Steps: 10 | Train Loss: 0.071 Vali Loss: 3.346 Vali Acc: 0.316 Test Loss: 3.346 Test Acc: 0.316
Validation loss decreased (-0.310555 --> -0.316437).  Saving model ...
Epoch: 17 cost time: 1.025406837463379
Epoch: 17, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.458 Vali Acc: 0.304 Test Loss: 3.458 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9984838962554932
Epoch: 18, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.478 Vali Acc: 0.307 Test Loss: 3.478 Test Acc: 0.307
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9848027229309082
Epoch: 19, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.468 Vali Acc: 0.309 Test Loss: 3.468 Test Acc: 0.309
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9815597534179688
Epoch: 20, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.449 Vali Acc: 0.316 Test Loss: 3.449 Test Acc: 0.316
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9770462512969971
Epoch: 21, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.519 Vali Acc: 0.316 Test Loss: 3.519 Test Acc: 0.316
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.0947022438049316
Epoch: 22, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.644 Vali Acc: 0.308 Test Loss: 3.644 Test Acc: 0.308
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.0002427101135254
Epoch: 23, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.654 Vali Acc: 0.318 Test Loss: 3.654 Test Acc: 0.318
Validation loss decreased (-0.316437 --> -0.317611).  Saving model ...
Epoch: 24 cost time: 1.0995430946350098
Epoch: 24, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.743 Vali Acc: 0.300 Test Loss: 3.743 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0078868865966797
Epoch: 25, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.601 Vali Acc: 0.321 Test Loss: 3.601 Test Acc: 0.321
Validation loss decreased (-0.317611 --> -0.321140).  Saving model ...
Epoch: 26 cost time: 0.9512295722961426
Epoch: 26, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.613 Vali Acc: 0.309 Test Loss: 3.613 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9441530704498291
Epoch: 27, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.598 Vali Acc: 0.318 Test Loss: 3.598 Test Acc: 0.318
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9310648441314697
Epoch: 28, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.691 Vali Acc: 0.315 Test Loss: 3.691 Test Acc: 0.315
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.6582345962524414
Epoch: 29, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.586 Vali Acc: 0.333 Test Loss: 3.586 Test Acc: 0.333
Validation loss decreased (-0.321140 --> -0.332905).  Saving model ...
Epoch: 30 cost time: 0.9953773021697998
Epoch: 30, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.556 Vali Acc: 0.334 Test Loss: 3.556 Test Acc: 0.334
Validation loss decreased (-0.332905 --> -0.334082).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3341176470588235
model parameter : 2319834
model size : 10.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.795797348022461
Epoch: 1, Steps: 10 | Train Loss: 3.288 Vali Loss: 3.279 Vali Acc: 0.045 Test Loss: 3.279 Test Acc: 0.045
Validation loss decreased (inf --> -0.044673).  Saving model ...
Epoch: 2 cost time: 3.3968021869659424
Epoch: 2, Steps: 10 | Train Loss: 3.145 Vali Loss: 3.253 Vali Acc: 0.079 Test Loss: 3.253 Test Acc: 0.079
Validation loss decreased (-0.044673 --> -0.078791).  Saving model ...
Epoch: 3 cost time: 3.4238240718841553
Epoch: 3, Steps: 10 | Train Loss: 2.847 Vali Loss: 3.219 Vali Acc: 0.108 Test Loss: 3.219 Test Acc: 0.108
Validation loss decreased (-0.078791 --> -0.108203).  Saving model ...
Epoch: 4 cost time: 3.370645761489868
Epoch: 4, Steps: 10 | Train Loss: 2.438 Vali Loss: 3.137 Vali Acc: 0.154 Test Loss: 3.137 Test Acc: 0.154
Validation loss decreased (-0.108203 --> -0.154086).  Saving model ...
Epoch: 5 cost time: 3.458956003189087
Epoch: 5, Steps: 10 | Train Loss: 2.081 Vali Loss: 3.072 Vali Acc: 0.179 Test Loss: 3.072 Test Acc: 0.179
Validation loss decreased (-0.154086 --> -0.178793).  Saving model ...
Epoch: 6 cost time: 2.9558329582214355
Epoch: 6, Steps: 10 | Train Loss: 1.763 Vali Loss: 3.059 Vali Acc: 0.178 Test Loss: 3.059 Test Acc: 0.178
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.831047534942627
Epoch: 7, Steps: 10 | Train Loss: 1.441 Vali Loss: 3.039 Vali Acc: 0.209 Test Loss: 3.039 Test Acc: 0.209
Validation loss decreased (-0.178793 --> -0.209381).  Saving model ...
Epoch: 8 cost time: 2.9004714488983154
Epoch: 8, Steps: 10 | Train Loss: 1.013 Vali Loss: 2.999 Vali Acc: 0.247 Test Loss: 2.999 Test Acc: 0.247
Validation loss decreased (-0.209381 --> -0.247029).  Saving model ...
Epoch: 9 cost time: 2.6034739017486572
Epoch: 9, Steps: 10 | Train Loss: 0.686 Vali Loss: 2.978 Vali Acc: 0.258 Test Loss: 2.978 Test Acc: 0.258
Validation loss decreased (-0.247029 --> -0.257617).  Saving model ...
Epoch: 10 cost time: 3.22821307182312
Epoch: 10, Steps: 10 | Train Loss: 0.451 Vali Loss: 2.950 Vali Acc: 0.265 Test Loss: 2.950 Test Acc: 0.265
Validation loss decreased (-0.257617 --> -0.264676).  Saving model ...
Epoch: 11 cost time: 3.0985732078552246
Epoch: 11, Steps: 10 | Train Loss: 0.267 Vali Loss: 2.986 Vali Acc: 0.286 Test Loss: 2.986 Test Acc: 0.286
Validation loss decreased (-0.264676 --> -0.285852).  Saving model ...
Epoch: 12 cost time: 3.173069953918457
Epoch: 12, Steps: 10 | Train Loss: 0.204 Vali Loss: 2.929 Vali Acc: 0.291 Test Loss: 2.929 Test Acc: 0.291
Validation loss decreased (-0.285852 --> -0.290559).  Saving model ...
Epoch: 13 cost time: 3.168241262435913
Epoch: 13, Steps: 10 | Train Loss: 0.113 Vali Loss: 2.951 Vali Acc: 0.300 Test Loss: 2.951 Test Acc: 0.300
Validation loss decreased (-0.290559 --> -0.299970).  Saving model ...
Epoch: 14 cost time: 3.1736655235290527
Epoch: 14, Steps: 10 | Train Loss: 0.104 Vali Loss: 3.003 Vali Acc: 0.307 Test Loss: 3.003 Test Acc: 0.307
Validation loss decreased (-0.299970 --> -0.307029).  Saving model ...
Epoch: 15 cost time: 2.8278648853302
Epoch: 15, Steps: 10 | Train Loss: 0.071 Vali Loss: 3.023 Vali Acc: 0.320 Test Loss: 3.023 Test Acc: 0.320
Validation loss decreased (-0.307029 --> -0.319970).  Saving model ...
Epoch: 16 cost time: 2.8760931491851807
Epoch: 16, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.067 Vali Acc: 0.318 Test Loss: 3.067 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.8643603324890137
Epoch: 17, Steps: 10 | Train Loss: 0.032 Vali Loss: 2.977 Vali Acc: 0.338 Test Loss: 2.977 Test Acc: 0.338
Validation loss decreased (-0.319970 --> -0.337617).  Saving model ...
Epoch: 18 cost time: 1.8422691822052002
Epoch: 18, Steps: 10 | Train Loss: 0.020 Vali Loss: 2.993 Vali Acc: 0.321 Test Loss: 2.993 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.9310688972473145
Epoch: 19, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.018 Vali Acc: 0.333 Test Loss: 3.018 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.9419186115264893
Epoch: 20, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.004 Vali Acc: 0.336 Test Loss: 3.004 Test Acc: 0.336
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.8574175834655762
Epoch: 21, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.061 Vali Acc: 0.340 Test Loss: 3.061 Test Acc: 0.340
Validation loss decreased (-0.337617 --> -0.339969).  Saving model ...
Epoch: 22 cost time: 1.8757777214050293
Epoch: 22, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.070 Vali Acc: 0.327 Test Loss: 3.070 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.6963863372802734
Epoch: 23, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.077 Vali Acc: 0.338 Test Loss: 3.077 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.726773500442505
Epoch: 24, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.126 Vali Acc: 0.328 Test Loss: 3.126 Test Acc: 0.328
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.819605588912964
Epoch: 25, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.165 Vali Acc: 0.324 Test Loss: 3.165 Test Acc: 0.324
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.373835802078247
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.140 Vali Acc: 0.333 Test Loss: 3.140 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.404308795928955
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.121 Vali Acc: 0.340 Test Loss: 3.121 Test Acc: 0.340
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.9041545391082764
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.118 Vali Acc: 0.340 Test Loss: 3.118 Test Acc: 0.340
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.824490785598755
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.143 Vali Acc: 0.341 Test Loss: 3.143 Test Acc: 0.341
Validation loss decreased (-0.339969 --> -0.341145).  Saving model ...
Epoch: 30 cost time: 2.890301465988159
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.148 Vali Acc: 0.340 Test Loss: 3.148 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3411764705882353
model parameter : 7158586
model size : 27.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.11773419380188
Epoch: 1, Steps: 10 | Train Loss: 3.398 Vali Loss: 3.296 Vali Acc: 0.039 Test Loss: 3.296 Test Acc: 0.039
Validation loss decreased (inf --> -0.038791).  Saving model ...
Epoch: 2 cost time: 1.5324928760528564
Epoch: 2, Steps: 10 | Train Loss: 3.243 Vali Loss: 3.278 Vali Acc: 0.053 Test Loss: 3.278 Test Acc: 0.053
Validation loss decreased (-0.038791 --> -0.052908).  Saving model ...
Epoch: 3 cost time: 1.4764325618743896
Epoch: 3, Steps: 10 | Train Loss: 2.950 Vali Loss: 3.263 Vali Acc: 0.081 Test Loss: 3.263 Test Acc: 0.081
Validation loss decreased (-0.052908 --> -0.081144).  Saving model ...
Epoch: 4 cost time: 1.4859135150909424
Epoch: 4, Steps: 10 | Train Loss: 2.706 Vali Loss: 3.212 Vali Acc: 0.111 Test Loss: 3.212 Test Acc: 0.111
Validation loss decreased (-0.081144 --> -0.110556).  Saving model ...
Epoch: 5 cost time: 1.3159129619598389
Epoch: 5, Steps: 10 | Train Loss: 2.342 Vali Loss: 3.123 Vali Acc: 0.146 Test Loss: 3.123 Test Acc: 0.146
Validation loss decreased (-0.110556 --> -0.145851).  Saving model ...
Epoch: 6 cost time: 1.1425209045410156
Epoch: 6, Steps: 10 | Train Loss: 2.015 Vali Loss: 3.046 Vali Acc: 0.179 Test Loss: 3.046 Test Acc: 0.179
Validation loss decreased (-0.145851 --> -0.178793).  Saving model ...
Epoch: 7 cost time: 1.2960751056671143
Epoch: 7, Steps: 10 | Train Loss: 1.572 Vali Loss: 3.009 Vali Acc: 0.191 Test Loss: 3.009 Test Acc: 0.191
Validation loss decreased (-0.178793 --> -0.190558).  Saving model ...
Epoch: 8 cost time: 1.5917134284973145
Epoch: 8, Steps: 10 | Train Loss: 1.188 Vali Loss: 2.980 Vali Acc: 0.211 Test Loss: 2.980 Test Acc: 0.211
Validation loss decreased (-0.190558 --> -0.210558).  Saving model ...
Epoch: 9 cost time: 1.542250394821167
Epoch: 9, Steps: 10 | Train Loss: 0.903 Vali Loss: 2.966 Vali Acc: 0.227 Test Loss: 2.966 Test Acc: 0.227
Validation loss decreased (-0.210558 --> -0.227029).  Saving model ...
Epoch: 10 cost time: 1.4896588325500488
Epoch: 10, Steps: 10 | Train Loss: 0.651 Vali Loss: 2.977 Vali Acc: 0.249 Test Loss: 2.977 Test Acc: 0.249
Validation loss decreased (-0.227029 --> -0.249382).  Saving model ...
Epoch: 11 cost time: 1.460822343826294
Epoch: 11, Steps: 10 | Train Loss: 0.431 Vali Loss: 2.996 Vali Acc: 0.278 Test Loss: 2.996 Test Acc: 0.278
Validation loss decreased (-0.249382 --> -0.277617).  Saving model ...
Epoch: 12 cost time: 1.2271568775177002
Epoch: 12, Steps: 10 | Train Loss: 0.309 Vali Loss: 3.014 Vali Acc: 0.285 Test Loss: 3.014 Test Acc: 0.285
Validation loss decreased (-0.277617 --> -0.284676).  Saving model ...
Epoch: 13 cost time: 1.2292635440826416
Epoch: 13, Steps: 10 | Train Loss: 0.248 Vali Loss: 3.091 Vali Acc: 0.279 Test Loss: 3.091 Test Acc: 0.279
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2337768077850342
Epoch: 14, Steps: 10 | Train Loss: 0.165 Vali Loss: 3.032 Vali Acc: 0.293 Test Loss: 3.032 Test Acc: 0.293
Validation loss decreased (-0.284676 --> -0.292911).  Saving model ...
Epoch: 15 cost time: 1.4337599277496338
Epoch: 15, Steps: 10 | Train Loss: 0.115 Vali Loss: 3.119 Vali Acc: 0.299 Test Loss: 3.119 Test Acc: 0.299
Validation loss decreased (-0.292911 --> -0.298792).  Saving model ...
Epoch: 16 cost time: 1.4607679843902588
Epoch: 16, Steps: 10 | Train Loss: 0.078 Vali Loss: 3.081 Vali Acc: 0.300 Test Loss: 3.081 Test Acc: 0.300
Validation loss decreased (-0.298792 --> -0.299969).  Saving model ...
Epoch: 17 cost time: 1.4725208282470703
Epoch: 17, Steps: 10 | Train Loss: 0.073 Vali Loss: 3.154 Vali Acc: 0.319 Test Loss: 3.154 Test Acc: 0.319
Validation loss decreased (-0.299969 --> -0.318792).  Saving model ...
Epoch: 18 cost time: 1.4589672088623047
Epoch: 18, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.092 Vali Acc: 0.315 Test Loss: 3.092 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.244713306427002
Epoch: 19, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.096 Vali Acc: 0.320 Test Loss: 3.096 Test Acc: 0.320
Validation loss decreased (-0.318792 --> -0.319969).  Saving model ...
Epoch: 20 cost time: 1.0820200443267822
Epoch: 20, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.151 Vali Acc: 0.320 Test Loss: 3.151 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.211127758026123
Epoch: 21, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.152 Vali Acc: 0.311 Test Loss: 3.152 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.3955326080322266
Epoch: 22, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.142 Vali Acc: 0.306 Test Loss: 3.142 Test Acc: 0.306
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.4722938537597656
Epoch: 23, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.196 Vali Acc: 0.318 Test Loss: 3.196 Test Acc: 0.318
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.4382028579711914
Epoch: 24, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.167 Vali Acc: 0.322 Test Loss: 3.167 Test Acc: 0.322
Validation loss decreased (-0.319969 --> -0.322321).  Saving model ...
Epoch: 25 cost time: 1.5335516929626465
Epoch: 25, Steps: 10 | Train Loss: 0.083 Vali Loss: 3.231 Vali Acc: 0.320 Test Loss: 3.231 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2464616298675537
Epoch: 26, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.339 Vali Acc: 0.319 Test Loss: 3.339 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.2220237255096436
Epoch: 27, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.181 Vali Acc: 0.319 Test Loss: 3.181 Test Acc: 0.319
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.2308895587921143
Epoch: 28, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.244 Vali Acc: 0.315 Test Loss: 3.244 Test Acc: 0.315
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.405729055404663
Epoch: 29, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.240 Vali Acc: 0.322 Test Loss: 3.240 Test Acc: 0.322
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.422532558441162
Epoch: 30, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.270 Vali Acc: 0.319 Test Loss: 3.270 Test Acc: 0.319
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.32235294117647056
model parameter : 2193274
model size : 9.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.5234313011169434
Epoch: 1, Steps: 10 | Train Loss: 3.288 Vali Loss: 3.280 Vali Acc: 0.052 Test Loss: 3.280 Test Acc: 0.052
Validation loss decreased (inf --> -0.051732).  Saving model ...
Epoch: 2 cost time: 1.8918452262878418
Epoch: 2, Steps: 10 | Train Loss: 3.151 Vali Loss: 3.261 Vali Acc: 0.079 Test Loss: 3.261 Test Acc: 0.079
Validation loss decreased (-0.051732 --> -0.078791).  Saving model ...
Epoch: 3 cost time: 2.0676472187042236
Epoch: 3, Steps: 10 | Train Loss: 2.896 Vali Loss: 3.236 Vali Acc: 0.096 Test Loss: 3.236 Test Acc: 0.096
Validation loss decreased (-0.078791 --> -0.096438).  Saving model ...
Epoch: 4 cost time: 2.281806707382202
Epoch: 4, Steps: 10 | Train Loss: 2.521 Vali Loss: 3.150 Vali Acc: 0.149 Test Loss: 3.150 Test Acc: 0.149
Validation loss decreased (-0.096438 --> -0.149380).  Saving model ...
Epoch: 5 cost time: 2.188642978668213
Epoch: 5, Steps: 10 | Train Loss: 2.300 Vali Loss: 3.110 Vali Acc: 0.158 Test Loss: 3.110 Test Acc: 0.158
Validation loss decreased (-0.149380 --> -0.157616).  Saving model ...
Epoch: 6 cost time: 2.185037851333618
Epoch: 6, Steps: 10 | Train Loss: 1.927 Vali Loss: 3.063 Vali Acc: 0.173 Test Loss: 3.063 Test Acc: 0.173
Validation loss decreased (-0.157616 --> -0.172911).  Saving model ...
Epoch: 7 cost time: 1.8674061298370361
Epoch: 7, Steps: 10 | Train Loss: 1.579 Vali Loss: 3.008 Vali Acc: 0.201 Test Loss: 3.008 Test Acc: 0.201
Validation loss decreased (-0.172911 --> -0.201146).  Saving model ...
Epoch: 8 cost time: 1.7067782878875732
Epoch: 8, Steps: 10 | Train Loss: 1.257 Vali Loss: 2.986 Vali Acc: 0.220 Test Loss: 2.986 Test Acc: 0.220
Validation loss decreased (-0.201146 --> -0.219970).  Saving model ...
Epoch: 9 cost time: 2.038158655166626
Epoch: 9, Steps: 10 | Train Loss: 0.860 Vali Loss: 2.955 Vali Acc: 0.254 Test Loss: 2.955 Test Acc: 0.254
Validation loss decreased (-0.219970 --> -0.254088).  Saving model ...
Epoch: 10 cost time: 2.0387825965881348
Epoch: 10, Steps: 10 | Train Loss: 0.498 Vali Loss: 2.907 Vali Acc: 0.276 Test Loss: 2.907 Test Acc: 0.276
Validation loss decreased (-0.254088 --> -0.276442).  Saving model ...
Epoch: 11 cost time: 1.9781041145324707
Epoch: 11, Steps: 10 | Train Loss: 0.421 Vali Loss: 2.972 Vali Acc: 0.284 Test Loss: 2.972 Test Acc: 0.284
Validation loss decreased (-0.276442 --> -0.283500).  Saving model ...
Epoch: 12 cost time: 2.0828659534454346
Epoch: 12, Steps: 10 | Train Loss: 0.273 Vali Loss: 2.949 Vali Acc: 0.309 Test Loss: 2.949 Test Acc: 0.309
Validation loss decreased (-0.283500 --> -0.309382).  Saving model ...
Epoch: 13 cost time: 1.7536687850952148
Epoch: 13, Steps: 10 | Train Loss: 0.168 Vali Loss: 2.906 Vali Acc: 0.315 Test Loss: 2.906 Test Acc: 0.315
Validation loss decreased (-0.309382 --> -0.315265).  Saving model ...
Epoch: 14 cost time: 1.6584672927856445
Epoch: 14, Steps: 10 | Train Loss: 0.118 Vali Loss: 2.992 Vali Acc: 0.315 Test Loss: 2.992 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7408428192138672
Epoch: 15, Steps: 10 | Train Loss: 0.105 Vali Loss: 2.940 Vali Acc: 0.327 Test Loss: 2.940 Test Acc: 0.327
Validation loss decreased (-0.315265 --> -0.327029).  Saving model ...
Epoch: 16 cost time: 2.0536632537841797
Epoch: 16, Steps: 10 | Train Loss: 0.071 Vali Loss: 3.038 Vali Acc: 0.311 Test Loss: 3.038 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.0734939575195312
Epoch: 17, Steps: 10 | Train Loss: 0.062 Vali Loss: 2.951 Vali Acc: 0.340 Test Loss: 2.951 Test Acc: 0.340
Validation loss decreased (-0.327029 --> -0.339970).  Saving model ...
Epoch: 18 cost time: 2.0757620334625244
Epoch: 18, Steps: 10 | Train Loss: 0.070 Vali Loss: 3.055 Vali Acc: 0.332 Test Loss: 3.055 Test Acc: 0.332
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.719923973083496
Epoch: 19, Steps: 10 | Train Loss: 0.096 Vali Loss: 2.977 Vali Acc: 0.328 Test Loss: 2.977 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.8137478828430176
Epoch: 20, Steps: 10 | Train Loss: 0.102 Vali Loss: 3.173 Vali Acc: 0.324 Test Loss: 3.173 Test Acc: 0.324
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.9480290412902832
Epoch: 21, Steps: 10 | Train Loss: 0.098 Vali Loss: 3.032 Vali Acc: 0.327 Test Loss: 3.032 Test Acc: 0.327
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.015160322189331
Epoch: 22, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.060 Vali Acc: 0.325 Test Loss: 3.060 Test Acc: 0.325
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.9656686782836914
Epoch: 23, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.022 Vali Acc: 0.342 Test Loss: 3.022 Test Acc: 0.342
Validation loss decreased (-0.339970 --> -0.342323).  Saving model ...
Epoch: 24 cost time: 2.0475847721099854
Epoch: 24, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.061 Vali Acc: 0.336 Test Loss: 3.061 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.7245769500732422
Epoch: 25, Steps: 10 | Train Loss: 0.025 Vali Loss: 2.995 Vali Acc: 0.341 Test Loss: 2.995 Test Acc: 0.341
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.716919183731079
Epoch: 26, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.056 Vali Acc: 0.340 Test Loss: 3.056 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.7783493995666504
Epoch: 27, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.086 Vali Acc: 0.341 Test Loss: 3.086 Test Acc: 0.341
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.0602688789367676
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.112 Vali Acc: 0.344 Test Loss: 3.112 Test Acc: 0.344
Validation loss decreased (-0.342323 --> -0.343498).  Saving model ...
Epoch: 29 cost time: 2.06430721282959
Epoch: 29, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.196 Vali Acc: 0.340 Test Loss: 3.196 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.9993770122528076
Epoch: 30, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.104 Vali Acc: 0.345 Test Loss: 3.104 Test Acc: 0.345
Validation loss decreased (-0.343498 --> -0.344675).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3447058823529412
model parameter : 7158586
model size : 27.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.6565215587615967
Epoch: 1, Steps: 10 | Train Loss: 3.397 Vali Loss: 3.299 Vali Acc: 0.036 Test Loss: 3.299 Test Acc: 0.036
Validation loss decreased (inf --> -0.036438).  Saving model ...
Epoch: 2 cost time: 1.2525317668914795
Epoch: 2, Steps: 10 | Train Loss: 3.242 Vali Loss: 3.285 Vali Acc: 0.055 Test Loss: 3.285 Test Acc: 0.055
Validation loss decreased (-0.036438 --> -0.055261).  Saving model ...
Epoch: 3 cost time: 1.2487177848815918
Epoch: 3, Steps: 10 | Train Loss: 2.989 Vali Loss: 3.276 Vali Acc: 0.076 Test Loss: 3.276 Test Acc: 0.076
Validation loss decreased (-0.055261 --> -0.076438).  Saving model ...
Epoch: 4 cost time: 1.2518854141235352
Epoch: 4, Steps: 10 | Train Loss: 2.762 Vali Loss: 3.230 Vali Acc: 0.116 Test Loss: 3.230 Test Acc: 0.116
Validation loss decreased (-0.076438 --> -0.116438).  Saving model ...
Epoch: 5 cost time: 1.023937463760376
Epoch: 5, Steps: 10 | Train Loss: 2.406 Vali Loss: 3.152 Vali Acc: 0.135 Test Loss: 3.152 Test Acc: 0.135
Validation loss decreased (-0.116438 --> -0.135263).  Saving model ...
Epoch: 6 cost time: 1.0807323455810547
Epoch: 6, Steps: 10 | Train Loss: 2.069 Vali Loss: 3.074 Vali Acc: 0.175 Test Loss: 3.074 Test Acc: 0.175
Validation loss decreased (-0.135263 --> -0.175263).  Saving model ...
Epoch: 7 cost time: 1.1748018264770508
Epoch: 7, Steps: 10 | Train Loss: 1.751 Vali Loss: 3.049 Vali Acc: 0.205 Test Loss: 3.049 Test Acc: 0.205
Validation loss decreased (-0.175263 --> -0.204675).  Saving model ...
Epoch: 8 cost time: 1.0453627109527588
Epoch: 8, Steps: 10 | Train Loss: 1.407 Vali Loss: 3.006 Vali Acc: 0.206 Test Loss: 3.006 Test Acc: 0.206
Validation loss decreased (-0.204675 --> -0.205852).  Saving model ...
Epoch: 9 cost time: 1.1742429733276367
Epoch: 9, Steps: 10 | Train Loss: 1.063 Vali Loss: 3.006 Vali Acc: 0.226 Test Loss: 3.006 Test Acc: 0.226
Validation loss decreased (-0.205852 --> -0.225852).  Saving model ...
Epoch: 10 cost time: 1.18332839012146
Epoch: 10, Steps: 10 | Train Loss: 0.889 Vali Loss: 2.996 Vali Acc: 0.260 Test Loss: 2.996 Test Acc: 0.260
Validation loss decreased (-0.225852 --> -0.259970).  Saving model ...
Epoch: 11 cost time: 1.2317278385162354
Epoch: 11, Steps: 10 | Train Loss: 0.605 Vali Loss: 2.968 Vali Acc: 0.268 Test Loss: 2.968 Test Acc: 0.268
Validation loss decreased (-0.259970 --> -0.268206).  Saving model ...
Epoch: 12 cost time: 1.1905169486999512
Epoch: 12, Steps: 10 | Train Loss: 0.450 Vali Loss: 3.020 Vali Acc: 0.280 Test Loss: 3.020 Test Acc: 0.280
Validation loss decreased (-0.268206 --> -0.279970).  Saving model ...
Epoch: 13 cost time: 0.9867889881134033
Epoch: 13, Steps: 10 | Train Loss: 0.245 Vali Loss: 3.084 Vali Acc: 0.291 Test Loss: 3.084 Test Acc: 0.291
Validation loss decreased (-0.279970 --> -0.290557).  Saving model ...
Epoch: 14 cost time: 0.9991879463195801
Epoch: 14, Steps: 10 | Train Loss: 0.173 Vali Loss: 3.024 Vali Acc: 0.311 Test Loss: 3.024 Test Acc: 0.311
Validation loss decreased (-0.290557 --> -0.310558).  Saving model ...
Epoch: 15 cost time: 1.1016745567321777
Epoch: 15, Steps: 10 | Train Loss: 0.172 Vali Loss: 3.098 Vali Acc: 0.309 Test Loss: 3.098 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1468710899353027
Epoch: 16, Steps: 10 | Train Loss: 0.087 Vali Loss: 3.119 Vali Acc: 0.311 Test Loss: 3.119 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2922606468200684
Epoch: 17, Steps: 10 | Train Loss: 0.111 Vali Loss: 3.170 Vali Acc: 0.304 Test Loss: 3.170 Test Acc: 0.304
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1774206161499023
Epoch: 18, Steps: 10 | Train Loss: 0.125 Vali Loss: 3.052 Vali Acc: 0.321 Test Loss: 3.052 Test Acc: 0.321
Validation loss decreased (-0.310558 --> -0.321146).  Saving model ...
Epoch: 19 cost time: 1.1851143836975098
Epoch: 19, Steps: 10 | Train Loss: 0.106 Vali Loss: 3.126 Vali Acc: 0.325 Test Loss: 3.126 Test Acc: 0.325
Validation loss decreased (-0.321146 --> -0.324675).  Saving model ...
Epoch: 20 cost time: 1.1794636249542236
Epoch: 20, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.154 Vali Acc: 0.320 Test Loss: 3.154 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1559524536132812
Epoch: 21, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.095 Vali Acc: 0.313 Test Loss: 3.095 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8924150466918945
Epoch: 22, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.126 Vali Acc: 0.326 Test Loss: 3.126 Test Acc: 0.326
Validation loss decreased (-0.324675 --> -0.325851).  Saving model ...
Epoch: 23 cost time: 1.1745879650115967
Epoch: 23, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.169 Vali Acc: 0.332 Test Loss: 3.169 Test Acc: 0.332
Validation loss decreased (-0.325851 --> -0.331733).  Saving model ...
Epoch: 24 cost time: 0.8140666484832764
Epoch: 24, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.210 Vali Acc: 0.335 Test Loss: 3.210 Test Acc: 0.335
Validation loss decreased (-0.331733 --> -0.335262).  Saving model ...
Epoch: 25 cost time: 1.1110665798187256
Epoch: 25, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.334 Vali Acc: 0.321 Test Loss: 3.334 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9792497158050537
Epoch: 26, Steps: 10 | Train Loss: 0.058 Vali Loss: 3.202 Vali Acc: 0.322 Test Loss: 3.202 Test Acc: 0.322
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.923480749130249
Epoch: 27, Steps: 10 | Train Loss: 0.056 Vali Loss: 3.363 Vali Acc: 0.316 Test Loss: 3.363 Test Acc: 0.316
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9082732200622559
Epoch: 28, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.322 Vali Acc: 0.333 Test Loss: 3.322 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.9395346641540527
Epoch: 29, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.244 Vali Acc: 0.338 Test Loss: 3.244 Test Acc: 0.338
Validation loss decreased (-0.335262 --> -0.337615).  Saving model ...
Epoch: 30 cost time: 0.961367130279541
Epoch: 30, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.340 Vali Acc: 0.334 Test Loss: 3.340 Test Acc: 0.334
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3376470588235294
model parameter : 2193274
model size : 9.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.0374112129211426
Epoch: 1, Steps: 10 | Train Loss: 3.284 Vali Loss: 3.285 Vali Acc: 0.058 Test Loss: 3.285 Test Acc: 0.058
Validation loss decreased (inf --> -0.057614).  Saving model ...
Epoch: 2 cost time: 1.6779546737670898
Epoch: 2, Steps: 10 | Train Loss: 3.186 Vali Loss: 3.277 Vali Acc: 0.067 Test Loss: 3.277 Test Acc: 0.067
Validation loss decreased (-0.057614 --> -0.067026).  Saving model ...
Epoch: 3 cost time: 1.6147205829620361
Epoch: 3, Steps: 10 | Train Loss: 2.960 Vali Loss: 3.272 Vali Acc: 0.076 Test Loss: 3.272 Test Acc: 0.076
Validation loss decreased (-0.067026 --> -0.076438).  Saving model ...
Epoch: 4 cost time: 1.7055342197418213
Epoch: 4, Steps: 10 | Train Loss: 2.656 Vali Loss: 3.206 Vali Acc: 0.127 Test Loss: 3.206 Test Acc: 0.127
Validation loss decreased (-0.076438 --> -0.127027).  Saving model ...
Epoch: 5 cost time: 1.4582979679107666
Epoch: 5, Steps: 10 | Train Loss: 2.389 Vali Loss: 3.154 Vali Acc: 0.151 Test Loss: 3.154 Test Acc: 0.151
Validation loss decreased (-0.127027 --> -0.150557).  Saving model ...
Epoch: 6 cost time: 1.3698430061340332
Epoch: 6, Steps: 10 | Train Loss: 2.088 Vali Loss: 3.101 Vali Acc: 0.167 Test Loss: 3.101 Test Acc: 0.167
Validation loss decreased (-0.150557 --> -0.167028).  Saving model ...
Epoch: 7 cost time: 1.2115843296051025
Epoch: 7, Steps: 10 | Train Loss: 1.857 Vali Loss: 3.069 Vali Acc: 0.193 Test Loss: 3.069 Test Acc: 0.193
Validation loss decreased (-0.167028 --> -0.192910).  Saving model ...
Epoch: 8 cost time: 1.160982370376587
Epoch: 8, Steps: 10 | Train Loss: 1.481 Vali Loss: 3.018 Vali Acc: 0.204 Test Loss: 3.018 Test Acc: 0.204
Validation loss decreased (-0.192910 --> -0.203499).  Saving model ...
Epoch: 9 cost time: 1.3452444076538086
Epoch: 9, Steps: 10 | Train Loss: 1.176 Vali Loss: 3.011 Vali Acc: 0.229 Test Loss: 3.011 Test Acc: 0.229
Validation loss decreased (-0.203499 --> -0.229382).  Saving model ...
Epoch: 10 cost time: 1.4339334964752197
Epoch: 10, Steps: 10 | Train Loss: 0.794 Vali Loss: 2.941 Vali Acc: 0.264 Test Loss: 2.941 Test Acc: 0.264
Validation loss decreased (-0.229382 --> -0.263500).  Saving model ...
Epoch: 11 cost time: 1.4127023220062256
Epoch: 11, Steps: 10 | Train Loss: 0.646 Vali Loss: 2.922 Vali Acc: 0.275 Test Loss: 2.922 Test Acc: 0.275
Validation loss decreased (-0.263500 --> -0.275265).  Saving model ...
Epoch: 12 cost time: 1.3976385593414307
Epoch: 12, Steps: 10 | Train Loss: 0.485 Vali Loss: 2.975 Vali Acc: 0.286 Test Loss: 2.975 Test Acc: 0.286
Validation loss decreased (-0.275265 --> -0.285853).  Saving model ...
Epoch: 13 cost time: 1.4420697689056396
Epoch: 13, Steps: 10 | Train Loss: 0.253 Vali Loss: 2.940 Vali Acc: 0.295 Test Loss: 2.940 Test Acc: 0.295
Validation loss decreased (-0.285853 --> -0.295265).  Saving model ...
Epoch: 14 cost time: 1.2290165424346924
Epoch: 14, Steps: 10 | Train Loss: 0.209 Vali Loss: 3.060 Vali Acc: 0.286 Test Loss: 3.060 Test Acc: 0.286
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1818571090698242
Epoch: 15, Steps: 10 | Train Loss: 0.180 Vali Loss: 2.930 Vali Acc: 0.305 Test Loss: 2.930 Test Acc: 0.305
Validation loss decreased (-0.295265 --> -0.304677).  Saving model ...
Epoch: 16 cost time: 1.0209133625030518
Epoch: 16, Steps: 10 | Train Loss: 0.084 Vali Loss: 2.996 Vali Acc: 0.308 Test Loss: 2.996 Test Acc: 0.308
Validation loss decreased (-0.304677 --> -0.308205).  Saving model ...
Epoch: 17 cost time: 1.2705118656158447
Epoch: 17, Steps: 10 | Train Loss: 0.095 Vali Loss: 2.939 Vali Acc: 0.327 Test Loss: 2.939 Test Acc: 0.327
Validation loss decreased (-0.308205 --> -0.327029).  Saving model ...
Epoch: 18 cost time: 1.4564802646636963
Epoch: 18, Steps: 10 | Train Loss: 0.073 Vali Loss: 3.034 Vali Acc: 0.342 Test Loss: 3.034 Test Acc: 0.342
Validation loss decreased (-0.327029 --> -0.342323).  Saving model ...
Epoch: 19 cost time: 1.5214180946350098
Epoch: 19, Steps: 10 | Train Loss: 0.059 Vali Loss: 3.020 Vali Acc: 0.333 Test Loss: 3.020 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4800903797149658
Epoch: 20, Steps: 10 | Train Loss: 0.075 Vali Loss: 2.958 Vali Acc: 0.349 Test Loss: 2.958 Test Acc: 0.349
Validation loss decreased (-0.342323 --> -0.349382).  Saving model ...
Epoch: 21 cost time: 1.479405403137207
Epoch: 21, Steps: 10 | Train Loss: 0.044 Vali Loss: 2.995 Vali Acc: 0.341 Test Loss: 2.995 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5111925601959229
Epoch: 22, Steps: 10 | Train Loss: 0.072 Vali Loss: 3.044 Vali Acc: 0.345 Test Loss: 3.044 Test Acc: 0.345
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.4984118938446045
Epoch: 23, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.046 Vali Acc: 0.332 Test Loss: 3.046 Test Acc: 0.332
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.377873420715332
Epoch: 24, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.024 Vali Acc: 0.354 Test Loss: 3.024 Test Acc: 0.354
Validation loss decreased (-0.349382 --> -0.354087).  Saving model ...
Epoch: 25 cost time: 1.3810906410217285
Epoch: 25, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.053 Vali Acc: 0.348 Test Loss: 3.053 Test Acc: 0.348
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.296971321105957
Epoch: 26, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.122 Vali Acc: 0.347 Test Loss: 3.122 Test Acc: 0.347
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.125988483428955
Epoch: 27, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.203 Vali Acc: 0.338 Test Loss: 3.203 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.4789109230041504
Epoch: 28, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.152 Vali Acc: 0.342 Test Loss: 3.152 Test Acc: 0.342
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.5684101581573486
Epoch: 29, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.153 Vali Acc: 0.353 Test Loss: 3.153 Test Acc: 0.353
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.471393346786499
Epoch: 30, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.103 Vali Acc: 0.353 Test Loss: 3.103 Test Acc: 0.353
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.35411764705882354
model parameter : 7158586
model size : 27.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.430509328842163
Epoch: 1, Steps: 10 | Train Loss: 3.398 Vali Loss: 3.305 Vali Acc: 0.039 Test Loss: 3.305 Test Acc: 0.039
Validation loss decreased (inf --> -0.038790).  Saving model ...
Epoch: 2 cost time: 0.8888027667999268
Epoch: 2, Steps: 10 | Train Loss: 3.269 Vali Loss: 3.295 Vali Acc: 0.046 Test Loss: 3.295 Test Acc: 0.046
Validation loss decreased (-0.038790 --> -0.045849).  Saving model ...
Epoch: 3 cost time: 0.9407083988189697
Epoch: 3, Steps: 10 | Train Loss: 3.033 Vali Loss: 3.295 Vali Acc: 0.072 Test Loss: 3.295 Test Acc: 0.072
Validation loss decreased (-0.045849 --> -0.071732).  Saving model ...
Epoch: 4 cost time: 0.8982400894165039
Epoch: 4, Steps: 10 | Train Loss: 2.861 Vali Loss: 3.270 Vali Acc: 0.098 Test Loss: 3.270 Test Acc: 0.098
Validation loss decreased (-0.071732 --> -0.097614).  Saving model ...
Epoch: 5 cost time: 1.0216591358184814
Epoch: 5, Steps: 10 | Train Loss: 2.508 Vali Loss: 3.207 Vali Acc: 0.109 Test Loss: 3.207 Test Acc: 0.109
Validation loss decreased (-0.097614 --> -0.109380).  Saving model ...
Epoch: 6 cost time: 1.0575509071350098
Epoch: 6, Steps: 10 | Train Loss: 2.319 Vali Loss: 3.139 Vali Acc: 0.158 Test Loss: 3.139 Test Acc: 0.158
Validation loss decreased (-0.109380 --> -0.157616).  Saving model ...
Epoch: 7 cost time: 1.0174026489257812
Epoch: 7, Steps: 10 | Train Loss: 1.930 Vali Loss: 3.109 Vali Acc: 0.171 Test Loss: 3.109 Test Acc: 0.171
Validation loss decreased (-0.157616 --> -0.170557).  Saving model ...
Epoch: 8 cost time: 0.9693341255187988
Epoch: 8, Steps: 10 | Train Loss: 1.635 Vali Loss: 3.074 Vali Acc: 0.184 Test Loss: 3.074 Test Acc: 0.184
Validation loss decreased (-0.170557 --> -0.183499).  Saving model ...
Epoch: 9 cost time: 1.007643699645996
Epoch: 9, Steps: 10 | Train Loss: 1.330 Vali Loss: 3.073 Vali Acc: 0.193 Test Loss: 3.073 Test Acc: 0.193
Validation loss decreased (-0.183499 --> -0.192910).  Saving model ...
Epoch: 10 cost time: 1.0280320644378662
Epoch: 10, Steps: 10 | Train Loss: 0.974 Vali Loss: 3.067 Vali Acc: 0.216 Test Loss: 3.067 Test Acc: 0.216
Validation loss decreased (-0.192910 --> -0.216440).  Saving model ...
Epoch: 11 cost time: 0.9975097179412842
Epoch: 11, Steps: 10 | Train Loss: 0.874 Vali Loss: 3.029 Vali Acc: 0.227 Test Loss: 3.029 Test Acc: 0.227
Validation loss decreased (-0.216440 --> -0.227029).  Saving model ...
Epoch: 12 cost time: 0.8301417827606201
Epoch: 12, Steps: 10 | Train Loss: 0.560 Vali Loss: 3.040 Vali Acc: 0.260 Test Loss: 3.040 Test Acc: 0.260
Validation loss decreased (-0.227029 --> -0.259970).  Saving model ...
Epoch: 13 cost time: 0.794872522354126
Epoch: 13, Steps: 10 | Train Loss: 0.482 Vali Loss: 3.013 Vali Acc: 0.284 Test Loss: 3.013 Test Acc: 0.284
Validation loss decreased (-0.259970 --> -0.283499).  Saving model ...
Epoch: 14 cost time: 0.8225204944610596
Epoch: 14, Steps: 10 | Train Loss: 0.323 Vali Loss: 3.022 Vali Acc: 0.299 Test Loss: 3.022 Test Acc: 0.299
Validation loss decreased (-0.283499 --> -0.298793).  Saving model ...
Epoch: 15 cost time: 0.8381481170654297
Epoch: 15, Steps: 10 | Train Loss: 0.208 Vali Loss: 3.022 Vali Acc: 0.301 Test Loss: 3.022 Test Acc: 0.301
Validation loss decreased (-0.298793 --> -0.301146).  Saving model ...
Epoch: 16 cost time: 0.5773084163665771
Epoch: 16, Steps: 10 | Train Loss: 0.106 Vali Loss: 3.049 Vali Acc: 0.306 Test Loss: 3.049 Test Acc: 0.306
Validation loss decreased (-0.301146 --> -0.305852).  Saving model ...
Epoch: 17 cost time: 0.9058027267456055
Epoch: 17, Steps: 10 | Train Loss: 0.161 Vali Loss: 3.092 Vali Acc: 0.325 Test Loss: 3.092 Test Acc: 0.325
Validation loss decreased (-0.305852 --> -0.324675).  Saving model ...
Epoch: 18 cost time: 0.9853694438934326
Epoch: 18, Steps: 10 | Train Loss: 0.114 Vali Loss: 3.107 Vali Acc: 0.326 Test Loss: 3.107 Test Acc: 0.326
Validation loss decreased (-0.324675 --> -0.325851).  Saving model ...
Epoch: 19 cost time: 0.9475631713867188
Epoch: 19, Steps: 10 | Train Loss: 0.089 Vali Loss: 3.094 Vali Acc: 0.326 Test Loss: 3.094 Test Acc: 0.326
Validation loss decreased (-0.325851 --> -0.325851).  Saving model ...
Epoch: 20 cost time: 0.9836831092834473
Epoch: 20, Steps: 10 | Train Loss: 0.079 Vali Loss: 3.102 Vali Acc: 0.328 Test Loss: 3.102 Test Acc: 0.328
Validation loss decreased (-0.325851 --> -0.328204).  Saving model ...
Epoch: 21 cost time: 0.927546501159668
Epoch: 21, Steps: 10 | Train Loss: 0.064 Vali Loss: 3.116 Vali Acc: 0.326 Test Loss: 3.116 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9675452709197998
Epoch: 22, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.240 Vali Acc: 0.321 Test Loss: 3.240 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8742337226867676
Epoch: 23, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.141 Vali Acc: 0.340 Test Loss: 3.141 Test Acc: 0.340
Validation loss decreased (-0.328204 --> -0.339969).  Saving model ...
Epoch: 24 cost time: 0.7851040363311768
Epoch: 24, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.176 Vali Acc: 0.336 Test Loss: 3.176 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6174435615539551
Epoch: 25, Steps: 10 | Train Loss: 0.083 Vali Loss: 3.231 Vali Acc: 0.322 Test Loss: 3.231 Test Acc: 0.322
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8402731418609619
Epoch: 26, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.339 Vali Acc: 0.322 Test Loss: 3.339 Test Acc: 0.322
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8459255695343018
Epoch: 27, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.291 Vali Acc: 0.327 Test Loss: 3.291 Test Acc: 0.327
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.0611059665679932
Epoch: 28, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.368 Vali Acc: 0.326 Test Loss: 3.368 Test Acc: 0.326
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.9774188995361328
Epoch: 29, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.271 Vali Acc: 0.332 Test Loss: 3.271 Test Acc: 0.332
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.9645838737487793
Epoch: 30, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.281 Vali Acc: 0.342 Test Loss: 3.281 Test Acc: 0.342
Validation loss decreased (-0.339969 --> -0.342320).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3423529411764706
model parameter : 2193274
model size : 9.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.8318402767181396
Epoch: 1, Steps: 10 | Train Loss: 3.271 Vali Loss: 3.281 Vali Acc: 0.047 Test Loss: 3.281 Test Acc: 0.047
Validation loss decreased (inf --> -0.047026).  Saving model ...
Epoch: 2 cost time: 2.0220420360565186
Epoch: 2, Steps: 10 | Train Loss: 3.094 Vali Loss: 3.260 Vali Acc: 0.068 Test Loss: 3.260 Test Acc: 0.068
Validation loss decreased (-0.047026 --> -0.068203).  Saving model ...
Epoch: 3 cost time: 1.9621901512145996
Epoch: 3, Steps: 10 | Train Loss: 2.934 Vali Loss: 3.265 Vali Acc: 0.101 Test Loss: 3.265 Test Acc: 0.101
Validation loss decreased (-0.068203 --> -0.101144).  Saving model ...
Epoch: 4 cost time: 2.3183531761169434
Epoch: 4, Steps: 10 | Train Loss: 2.648 Vali Loss: 3.185 Vali Acc: 0.126 Test Loss: 3.185 Test Acc: 0.126
Validation loss decreased (-0.101144 --> -0.125851).  Saving model ...
Epoch: 5 cost time: 2.299398899078369
Epoch: 5, Steps: 10 | Train Loss: 2.325 Vali Loss: 3.083 Vali Acc: 0.167 Test Loss: 3.083 Test Acc: 0.167
Validation loss decreased (-0.125851 --> -0.167028).  Saving model ...
Epoch: 6 cost time: 2.4264297485351562
Epoch: 6, Steps: 10 | Train Loss: 1.924 Vali Loss: 3.028 Vali Acc: 0.185 Test Loss: 3.028 Test Acc: 0.185
Validation loss decreased (-0.167028 --> -0.184676).  Saving model ...
Epoch: 7 cost time: 2.3277781009674072
Epoch: 7, Steps: 10 | Train Loss: 1.540 Vali Loss: 2.991 Vali Acc: 0.191 Test Loss: 2.991 Test Acc: 0.191
Validation loss decreased (-0.184676 --> -0.190558).  Saving model ...
Epoch: 8 cost time: 2.00626540184021
Epoch: 8, Steps: 10 | Train Loss: 1.126 Vali Loss: 2.966 Vali Acc: 0.212 Test Loss: 2.966 Test Acc: 0.212
Validation loss decreased (-0.190558 --> -0.211735).  Saving model ...
Epoch: 9 cost time: 1.9864251613616943
Epoch: 9, Steps: 10 | Train Loss: 0.854 Vali Loss: 2.937 Vali Acc: 0.238 Test Loss: 2.937 Test Acc: 0.238
Validation loss decreased (-0.211735 --> -0.237618).  Saving model ...
Epoch: 10 cost time: 2.0769600868225098
Epoch: 10, Steps: 10 | Train Loss: 0.647 Vali Loss: 2.955 Vali Acc: 0.254 Test Loss: 2.955 Test Acc: 0.254
Validation loss decreased (-0.237618 --> -0.254088).  Saving model ...
Epoch: 11 cost time: 2.296372175216675
Epoch: 11, Steps: 10 | Train Loss: 0.467 Vali Loss: 2.934 Vali Acc: 0.278 Test Loss: 2.934 Test Acc: 0.278
Validation loss decreased (-0.254088 --> -0.277618).  Saving model ...
Epoch: 12 cost time: 2.3921282291412354
Epoch: 12, Steps: 10 | Train Loss: 0.378 Vali Loss: 2.948 Vali Acc: 0.271 Test Loss: 2.948 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.4635069370269775
Epoch: 13, Steps: 10 | Train Loss: 0.243 Vali Loss: 2.988 Vali Acc: 0.291 Test Loss: 2.988 Test Acc: 0.291
Validation loss decreased (-0.277618 --> -0.290558).  Saving model ...
Epoch: 14 cost time: 2.301326036453247
Epoch: 14, Steps: 10 | Train Loss: 0.190 Vali Loss: 2.943 Vali Acc: 0.306 Test Loss: 2.943 Test Acc: 0.306
Validation loss decreased (-0.290558 --> -0.305853).  Saving model ...
Epoch: 15 cost time: 2.042786121368408
Epoch: 15, Steps: 10 | Train Loss: 0.097 Vali Loss: 2.982 Vali Acc: 0.326 Test Loss: 2.982 Test Acc: 0.326
Validation loss decreased (-0.305853 --> -0.325853).  Saving model ...
Epoch: 16 cost time: 2.0787971019744873
Epoch: 16, Steps: 10 | Train Loss: 0.077 Vali Loss: 3.016 Vali Acc: 0.316 Test Loss: 3.016 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6347076892852783
Epoch: 17, Steps: 10 | Train Loss: 0.066 Vali Loss: 2.995 Vali Acc: 0.331 Test Loss: 2.995 Test Acc: 0.331
Validation loss decreased (-0.325853 --> -0.330558).  Saving model ...
Epoch: 18 cost time: 2.375227451324463
Epoch: 18, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.008 Vali Acc: 0.332 Test Loss: 3.008 Test Acc: 0.332
Validation loss decreased (-0.330558 --> -0.331735).  Saving model ...
Epoch: 19 cost time: 2.4408674240112305
Epoch: 19, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.039 Vali Acc: 0.331 Test Loss: 3.039 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.2743887901306152
Epoch: 20, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.039 Vali Acc: 0.338 Test Loss: 3.039 Test Acc: 0.338
Validation loss decreased (-0.331735 --> -0.337617).  Saving model ...
Epoch: 21 cost time: 2.0634877681732178
Epoch: 21, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.069 Vali Acc: 0.338 Test Loss: 3.069 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.9407274723052979
Epoch: 22, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.093 Vali Acc: 0.329 Test Loss: 3.093 Test Acc: 0.329
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.9474539756774902
Epoch: 23, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.094 Vali Acc: 0.329 Test Loss: 3.094 Test Acc: 0.329
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.36613392829895
Epoch: 24, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.096 Vali Acc: 0.328 Test Loss: 3.096 Test Acc: 0.328
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.4086954593658447
Epoch: 25, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.092 Vali Acc: 0.332 Test Loss: 3.092 Test Acc: 0.332
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.3099098205566406
Epoch: 26, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.103 Vali Acc: 0.342 Test Loss: 3.103 Test Acc: 0.342
Validation loss decreased (-0.337617 --> -0.342322).  Saving model ...
Epoch: 27 cost time: 2.359574317932129
Epoch: 27, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.119 Vali Acc: 0.340 Test Loss: 3.119 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.9488890171051025
Epoch: 28, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.170 Vali Acc: 0.336 Test Loss: 3.170 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.0069329738616943
Epoch: 29, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.158 Vali Acc: 0.347 Test Loss: 3.158 Test Acc: 0.347
Validation loss decreased (-0.342322 --> -0.347027).  Saving model ...
Epoch: 30 cost time: 1.7549073696136475
Epoch: 30, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.140 Vali Acc: 0.333 Test Loss: 3.140 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.34705882352941175
model parameter : 3643066
model size : 14.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.166733503341675
Epoch: 1, Steps: 10 | Train Loss: 3.304 Vali Loss: 3.278 Vali Acc: 0.036 Test Loss: 3.278 Test Acc: 0.036
Validation loss decreased (inf --> -0.036438).  Saving model ...
Epoch: 2 cost time: 1.3539023399353027
Epoch: 2, Steps: 10 | Train Loss: 3.169 Vali Loss: 3.270 Vali Acc: 0.058 Test Loss: 3.270 Test Acc: 0.058
Validation loss decreased (-0.036438 --> -0.057614).  Saving model ...
Epoch: 3 cost time: 1.0991041660308838
Epoch: 3, Steps: 10 | Train Loss: 2.954 Vali Loss: 3.268 Vali Acc: 0.084 Test Loss: 3.268 Test Acc: 0.084
Validation loss decreased (-0.057614 --> -0.083497).  Saving model ...
Epoch: 4 cost time: 1.1943905353546143
Epoch: 4, Steps: 10 | Train Loss: 2.726 Vali Loss: 3.216 Vali Acc: 0.115 Test Loss: 3.216 Test Acc: 0.115
Validation loss decreased (-0.083497 --> -0.115262).  Saving model ...
Epoch: 5 cost time: 1.1682207584381104
Epoch: 5, Steps: 10 | Train Loss: 2.423 Vali Loss: 3.145 Vali Acc: 0.138 Test Loss: 3.145 Test Acc: 0.138
Validation loss decreased (-0.115262 --> -0.137616).  Saving model ...
Epoch: 6 cost time: 1.2155697345733643
Epoch: 6, Steps: 10 | Train Loss: 2.103 Vali Loss: 3.061 Vali Acc: 0.169 Test Loss: 3.061 Test Acc: 0.169
Validation loss decreased (-0.137616 --> -0.169381).  Saving model ...
Epoch: 7 cost time: 1.2676241397857666
Epoch: 7, Steps: 10 | Train Loss: 1.842 Vali Loss: 3.033 Vali Acc: 0.191 Test Loss: 3.033 Test Acc: 0.191
Validation loss decreased (-0.169381 --> -0.190558).  Saving model ...
Epoch: 8 cost time: 1.2270660400390625
Epoch: 8, Steps: 10 | Train Loss: 1.483 Vali Loss: 2.993 Vali Acc: 0.208 Test Loss: 2.993 Test Acc: 0.208
Validation loss decreased (-0.190558 --> -0.208205).  Saving model ...
Epoch: 9 cost time: 0.9045946598052979
Epoch: 9, Steps: 10 | Train Loss: 1.162 Vali Loss: 2.959 Vali Acc: 0.235 Test Loss: 2.959 Test Acc: 0.235
Validation loss decreased (-0.208205 --> -0.235265).  Saving model ...
Epoch: 10 cost time: 0.9502396583557129
Epoch: 10, Steps: 10 | Train Loss: 0.895 Vali Loss: 2.943 Vali Acc: 0.241 Test Loss: 2.943 Test Acc: 0.241
Validation loss decreased (-0.235265 --> -0.241147).  Saving model ...
Epoch: 11 cost time: 0.8929843902587891
Epoch: 11, Steps: 10 | Train Loss: 0.627 Vali Loss: 2.973 Vali Acc: 0.268 Test Loss: 2.973 Test Acc: 0.268
Validation loss decreased (-0.241147 --> -0.268206).  Saving model ...
Epoch: 12 cost time: 0.8454897403717041
Epoch: 12, Steps: 10 | Train Loss: 0.448 Vali Loss: 2.941 Vali Acc: 0.278 Test Loss: 2.941 Test Acc: 0.278
Validation loss decreased (-0.268206 --> -0.277618).  Saving model ...
Epoch: 13 cost time: 0.8771777153015137
Epoch: 13, Steps: 10 | Train Loss: 0.305 Vali Loss: 2.959 Vali Acc: 0.286 Test Loss: 2.959 Test Acc: 0.286
Validation loss decreased (-0.277618 --> -0.285853).  Saving model ...
Epoch: 14 cost time: 1.0648643970489502
Epoch: 14, Steps: 10 | Train Loss: 0.245 Vali Loss: 3.026 Vali Acc: 0.279 Test Loss: 3.026 Test Acc: 0.279
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1440589427947998
Epoch: 15, Steps: 10 | Train Loss: 0.151 Vali Loss: 3.021 Vali Acc: 0.287 Test Loss: 3.021 Test Acc: 0.287
Validation loss decreased (-0.285853 --> -0.287029).  Saving model ...
Epoch: 16 cost time: 1.1890857219696045
Epoch: 16, Steps: 10 | Train Loss: 0.153 Vali Loss: 3.122 Vali Acc: 0.296 Test Loss: 3.122 Test Acc: 0.296
Validation loss decreased (-0.287029 --> -0.296439).  Saving model ...
Epoch: 17 cost time: 1.1645331382751465
Epoch: 17, Steps: 10 | Train Loss: 0.097 Vali Loss: 3.068 Vali Acc: 0.315 Test Loss: 3.068 Test Acc: 0.315
Validation loss decreased (-0.296439 --> -0.315263).  Saving model ...
Epoch: 18 cost time: 1.0565717220306396
Epoch: 18, Steps: 10 | Train Loss: 0.098 Vali Loss: 3.079 Vali Acc: 0.298 Test Loss: 3.079 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0437445640563965
Epoch: 19, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.091 Vali Acc: 0.306 Test Loss: 3.091 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1320126056671143
Epoch: 20, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.150 Vali Acc: 0.316 Test Loss: 3.150 Test Acc: 0.316
Validation loss decreased (-0.315263 --> -0.316439).  Saving model ...
Epoch: 21 cost time: 1.2030649185180664
Epoch: 21, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.124 Vali Acc: 0.327 Test Loss: 3.124 Test Acc: 0.327
Validation loss decreased (-0.316439 --> -0.327028).  Saving model ...
Epoch: 22 cost time: 1.1417253017425537
Epoch: 22, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.138 Vali Acc: 0.333 Test Loss: 3.138 Test Acc: 0.333
Validation loss decreased (-0.327028 --> -0.332910).  Saving model ...
Epoch: 23 cost time: 0.882230281829834
Epoch: 23, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.154 Vali Acc: 0.331 Test Loss: 3.154 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.025054693222046
Epoch: 24, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.187 Vali Acc: 0.327 Test Loss: 3.187 Test Acc: 0.327
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0324506759643555
Epoch: 25, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.183 Vali Acc: 0.326 Test Loss: 3.183 Test Acc: 0.326
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.1558470726013184
Epoch: 26, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.192 Vali Acc: 0.324 Test Loss: 3.192 Test Acc: 0.324
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.1761770248413086
Epoch: 27, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.217 Vali Acc: 0.325 Test Loss: 3.217 Test Acc: 0.325
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.209092140197754
Epoch: 28, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.197 Vali Acc: 0.334 Test Loss: 3.197 Test Acc: 0.334
Validation loss decreased (-0.332910 --> -0.334086).  Saving model ...
Epoch: 29 cost time: 1.0757739543914795
Epoch: 29, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.227 Vali Acc: 0.334 Test Loss: 3.227 Test Acc: 0.334
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8835375308990479
Epoch: 30, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.269 Vali Acc: 0.331 Test Loss: 3.269 Test Acc: 0.331
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3341176470588235
model parameter : 1160314
model size : 5.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.0735769271850586
Epoch: 1, Steps: 10 | Train Loss: 3.262 Vali Loss: 3.284 Vali Acc: 0.049 Test Loss: 3.284 Test Acc: 0.049
Validation loss decreased (inf --> -0.049379).  Saving model ...
Epoch: 2 cost time: 1.3342950344085693
Epoch: 2, Steps: 10 | Train Loss: 3.102 Vali Loss: 3.263 Vali Acc: 0.068 Test Loss: 3.263 Test Acc: 0.068
Validation loss decreased (-0.049379 --> -0.068203).  Saving model ...
Epoch: 3 cost time: 1.2977488040924072
Epoch: 3, Steps: 10 | Train Loss: 2.963 Vali Loss: 3.270 Vali Acc: 0.093 Test Loss: 3.270 Test Acc: 0.093
Validation loss decreased (-0.068203 --> -0.092908).  Saving model ...
Epoch: 4 cost time: 1.3485071659088135
Epoch: 4, Steps: 10 | Train Loss: 2.695 Vali Loss: 3.194 Vali Acc: 0.121 Test Loss: 3.194 Test Acc: 0.121
Validation loss decreased (-0.092908 --> -0.121145).  Saving model ...
Epoch: 5 cost time: 1.5710155963897705
Epoch: 5, Steps: 10 | Train Loss: 2.400 Vali Loss: 3.092 Vali Acc: 0.159 Test Loss: 3.092 Test Acc: 0.159
Validation loss decreased (-0.121145 --> -0.158793).  Saving model ...
Epoch: 6 cost time: 1.526266098022461
Epoch: 6, Steps: 10 | Train Loss: 2.085 Vali Loss: 3.046 Vali Acc: 0.180 Test Loss: 3.046 Test Acc: 0.180
Validation loss decreased (-0.158793 --> -0.179970).  Saving model ...
Epoch: 7 cost time: 1.3844249248504639
Epoch: 7, Steps: 10 | Train Loss: 1.649 Vali Loss: 3.011 Vali Acc: 0.187 Test Loss: 3.011 Test Acc: 0.187
Validation loss decreased (-0.179970 --> -0.187029).  Saving model ...
Epoch: 8 cost time: 1.4134390354156494
Epoch: 8, Steps: 10 | Train Loss: 1.279 Vali Loss: 3.008 Vali Acc: 0.206 Test Loss: 3.008 Test Acc: 0.206
Validation loss decreased (-0.187029 --> -0.205852).  Saving model ...
Epoch: 9 cost time: 1.4624302387237549
Epoch: 9, Steps: 10 | Train Loss: 0.973 Vali Loss: 2.999 Vali Acc: 0.233 Test Loss: 2.999 Test Acc: 0.233
Validation loss decreased (-0.205852 --> -0.232911).  Saving model ...
Epoch: 10 cost time: 1.672391653060913
Epoch: 10, Steps: 10 | Train Loss: 0.857 Vali Loss: 2.957 Vali Acc: 0.255 Test Loss: 2.957 Test Acc: 0.255
Validation loss decreased (-0.232911 --> -0.255265).  Saving model ...
Epoch: 11 cost time: 1.7415502071380615
Epoch: 11, Steps: 10 | Train Loss: 0.646 Vali Loss: 2.978 Vali Acc: 0.275 Test Loss: 2.978 Test Acc: 0.275
Validation loss decreased (-0.255265 --> -0.275264).  Saving model ...
Epoch: 12 cost time: 1.3743431568145752
Epoch: 12, Steps: 10 | Train Loss: 0.486 Vali Loss: 2.956 Vali Acc: 0.293 Test Loss: 2.956 Test Acc: 0.293
Validation loss decreased (-0.275264 --> -0.292912).  Saving model ...
Epoch: 13 cost time: 1.4365267753601074
Epoch: 13, Steps: 10 | Train Loss: 0.374 Vali Loss: 3.003 Vali Acc: 0.304 Test Loss: 3.003 Test Acc: 0.304
Validation loss decreased (-0.292912 --> -0.303499).  Saving model ...
Epoch: 14 cost time: 1.6920268535614014
Epoch: 14, Steps: 10 | Train Loss: 0.337 Vali Loss: 2.957 Vali Acc: 0.313 Test Loss: 2.957 Test Acc: 0.313
Validation loss decreased (-0.303499 --> -0.312912).  Saving model ...
Epoch: 15 cost time: 1.651010274887085
Epoch: 15, Steps: 10 | Train Loss: 0.184 Vali Loss: 2.981 Vali Acc: 0.326 Test Loss: 2.981 Test Acc: 0.326
Validation loss decreased (-0.312912 --> -0.325853).  Saving model ...
Epoch: 16 cost time: 1.6652929782867432
Epoch: 16, Steps: 10 | Train Loss: 0.150 Vali Loss: 3.076 Vali Acc: 0.316 Test Loss: 3.076 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3401157855987549
Epoch: 17, Steps: 10 | Train Loss: 0.076 Vali Loss: 3.023 Vali Acc: 0.325 Test Loss: 3.023 Test Acc: 0.325
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3546724319458008
Epoch: 18, Steps: 10 | Train Loss: 0.099 Vali Loss: 3.065 Vali Acc: 0.322 Test Loss: 3.065 Test Acc: 0.322
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.6816997528076172
Epoch: 19, Steps: 10 | Train Loss: 0.098 Vali Loss: 3.046 Vali Acc: 0.329 Test Loss: 3.046 Test Acc: 0.329
Validation loss decreased (-0.325853 --> -0.329381).  Saving model ...
Epoch: 20 cost time: 1.5772488117218018
Epoch: 20, Steps: 10 | Train Loss: 0.056 Vali Loss: 3.131 Vali Acc: 0.326 Test Loss: 3.131 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6566693782806396
Epoch: 21, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.110 Vali Acc: 0.336 Test Loss: 3.110 Test Acc: 0.336
Validation loss decreased (-0.329381 --> -0.336439).  Saving model ...
Epoch: 22 cost time: 1.4725191593170166
Epoch: 22, Steps: 10 | Train Loss: 0.063 Vali Loss: 3.112 Vali Acc: 0.346 Test Loss: 3.112 Test Acc: 0.346
Validation loss decreased (-0.336439 --> -0.345851).  Saving model ...
Epoch: 23 cost time: 1.4990079402923584
Epoch: 23, Steps: 10 | Train Loss: 0.073 Vali Loss: 3.074 Vali Acc: 0.339 Test Loss: 3.074 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.6165881156921387
Epoch: 24, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.155 Vali Acc: 0.326 Test Loss: 3.155 Test Acc: 0.326
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.6569890975952148
Epoch: 25, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.147 Vali Acc: 0.346 Test Loss: 3.147 Test Acc: 0.346
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.655074119567871
Epoch: 26, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.219 Vali Acc: 0.336 Test Loss: 3.219 Test Acc: 0.336
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.4034972190856934
Epoch: 27, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.161 Vali Acc: 0.340 Test Loss: 3.161 Test Acc: 0.340
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.342315673828125
Epoch: 28, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.163 Vali Acc: 0.342 Test Loss: 3.163 Test Acc: 0.342
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.54109787940979
Epoch: 29, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.197 Vali Acc: 0.346 Test Loss: 3.197 Test Acc: 0.346
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.6153252124786377
Epoch: 30, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.160 Vali Acc: 0.355 Test Loss: 3.160 Test Acc: 0.355
Validation loss decreased (-0.345851 --> -0.355263).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3552941176470588
model parameter : 3643066
model size : 14.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.4429898262023926
Epoch: 1, Steps: 10 | Train Loss: 3.288 Vali Loss: 3.275 Vali Acc: 0.034 Test Loss: 3.275 Test Acc: 0.034
Validation loss decreased (inf --> -0.034085).  Saving model ...
Epoch: 2 cost time: 0.9686293601989746
Epoch: 2, Steps: 10 | Train Loss: 3.182 Vali Loss: 3.270 Vali Acc: 0.060 Test Loss: 3.270 Test Acc: 0.060
Validation loss decreased (-0.034085 --> -0.059967).  Saving model ...
Epoch: 3 cost time: 1.0116119384765625
Epoch: 3, Steps: 10 | Train Loss: 2.988 Vali Loss: 3.274 Vali Acc: 0.081 Test Loss: 3.274 Test Acc: 0.081
Validation loss decreased (-0.059967 --> -0.081144).  Saving model ...
Epoch: 4 cost time: 0.970304012298584
Epoch: 4, Steps: 10 | Train Loss: 2.762 Vali Loss: 3.226 Vali Acc: 0.112 Test Loss: 3.226 Test Acc: 0.112
Validation loss decreased (-0.081144 --> -0.111732).  Saving model ...
Epoch: 5 cost time: 0.9245717525482178
Epoch: 5, Steps: 10 | Train Loss: 2.494 Vali Loss: 3.162 Vali Acc: 0.136 Test Loss: 3.162 Test Acc: 0.136
Validation loss decreased (-0.111732 --> -0.136439).  Saving model ...
Epoch: 6 cost time: 0.9070413112640381
Epoch: 6, Steps: 10 | Train Loss: 2.189 Vali Loss: 3.083 Vali Acc: 0.155 Test Loss: 3.083 Test Acc: 0.155
Validation loss decreased (-0.136439 --> -0.155263).  Saving model ...
Epoch: 7 cost time: 0.8589973449707031
Epoch: 7, Steps: 10 | Train Loss: 1.947 Vali Loss: 3.054 Vali Acc: 0.188 Test Loss: 3.054 Test Acc: 0.188
Validation loss decreased (-0.155263 --> -0.188205).  Saving model ...
Epoch: 8 cost time: 0.8165571689605713
Epoch: 8, Steps: 10 | Train Loss: 1.612 Vali Loss: 3.017 Vali Acc: 0.199 Test Loss: 3.017 Test Acc: 0.199
Validation loss decreased (-0.188205 --> -0.198793).  Saving model ...
Epoch: 9 cost time: 0.7989728450775146
Epoch: 9, Steps: 10 | Train Loss: 1.303 Vali Loss: 2.990 Vali Acc: 0.222 Test Loss: 2.990 Test Acc: 0.222
Validation loss decreased (-0.198793 --> -0.222323).  Saving model ...
Epoch: 10 cost time: 0.8324353694915771
Epoch: 10, Steps: 10 | Train Loss: 1.016 Vali Loss: 2.967 Vali Acc: 0.247 Test Loss: 2.967 Test Acc: 0.247
Validation loss decreased (-0.222323 --> -0.247029).  Saving model ...
Epoch: 11 cost time: 0.7642974853515625
Epoch: 11, Steps: 10 | Train Loss: 0.790 Vali Loss: 3.001 Vali Acc: 0.249 Test Loss: 3.001 Test Acc: 0.249
Validation loss decreased (-0.247029 --> -0.249382).  Saving model ...
Epoch: 12 cost time: 0.7742249965667725
Epoch: 12, Steps: 10 | Train Loss: 0.644 Vali Loss: 3.045 Vali Acc: 0.259 Test Loss: 3.045 Test Acc: 0.259
Validation loss decreased (-0.249382 --> -0.258793).  Saving model ...
Epoch: 13 cost time: 0.9093217849731445
Epoch: 13, Steps: 10 | Train Loss: 0.380 Vali Loss: 3.007 Vali Acc: 0.293 Test Loss: 3.007 Test Acc: 0.293
Validation loss decreased (-0.258793 --> -0.292911).  Saving model ...
Epoch: 14 cost time: 0.8185255527496338
Epoch: 14, Steps: 10 | Train Loss: 0.299 Vali Loss: 3.049 Vali Acc: 0.308 Test Loss: 3.049 Test Acc: 0.308
Validation loss decreased (-0.292911 --> -0.308205).  Saving model ...
Epoch: 15 cost time: 1.1498794555664062
Epoch: 15, Steps: 10 | Train Loss: 0.239 Vali Loss: 3.037 Vali Acc: 0.312 Test Loss: 3.037 Test Acc: 0.312
Validation loss decreased (-0.308205 --> -0.311734).  Saving model ...
Epoch: 16 cost time: 1.144683599472046
Epoch: 16, Steps: 10 | Train Loss: 0.186 Vali Loss: 3.082 Vali Acc: 0.308 Test Loss: 3.082 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2092046737670898
Epoch: 17, Steps: 10 | Train Loss: 0.148 Vali Loss: 3.037 Vali Acc: 0.309 Test Loss: 3.037 Test Acc: 0.309
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1663703918457031
Epoch: 18, Steps: 10 | Train Loss: 0.161 Vali Loss: 3.107 Vali Acc: 0.321 Test Loss: 3.107 Test Acc: 0.321
Validation loss decreased (-0.311734 --> -0.321145).  Saving model ...
Epoch: 19 cost time: 1.1922132968902588
Epoch: 19, Steps: 10 | Train Loss: 0.094 Vali Loss: 3.176 Vali Acc: 0.308 Test Loss: 3.176 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1612684726715088
Epoch: 20, Steps: 10 | Train Loss: 0.079 Vali Loss: 3.316 Vali Acc: 0.322 Test Loss: 3.316 Test Acc: 0.322
Validation loss decreased (-0.321145 --> -0.322320).  Saving model ...
Epoch: 21 cost time: 1.1177558898925781
Epoch: 21, Steps: 10 | Train Loss: 0.092 Vali Loss: 3.175 Vali Acc: 0.325 Test Loss: 3.175 Test Acc: 0.325
Validation loss decreased (-0.322320 --> -0.324674).  Saving model ...
Epoch: 22 cost time: 1.173842430114746
Epoch: 22, Steps: 10 | Train Loss: 0.067 Vali Loss: 3.309 Vali Acc: 0.332 Test Loss: 3.309 Test Acc: 0.332
Validation loss decreased (-0.324674 --> -0.331732).  Saving model ...
Epoch: 23 cost time: 1.1680307388305664
Epoch: 23, Steps: 10 | Train Loss: 0.060 Vali Loss: 3.263 Vali Acc: 0.335 Test Loss: 3.263 Test Acc: 0.335
Validation loss decreased (-0.331732 --> -0.335261).  Saving model ...
Epoch: 24 cost time: 1.144599437713623
Epoch: 24, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.281 Vali Acc: 0.342 Test Loss: 3.281 Test Acc: 0.342
Validation loss decreased (-0.335261 --> -0.342320).  Saving model ...
Epoch: 25 cost time: 1.1136066913604736
Epoch: 25, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.302 Vali Acc: 0.347 Test Loss: 3.302 Test Acc: 0.347
Validation loss decreased (-0.342320 --> -0.347026).  Saving model ...
Epoch: 26 cost time: 1.0592451095581055
Epoch: 26, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.288 Vali Acc: 0.326 Test Loss: 3.288 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0764105319976807
Epoch: 27, Steps: 10 | Train Loss: 0.076 Vali Loss: 3.266 Vali Acc: 0.334 Test Loss: 3.266 Test Acc: 0.334
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0789542198181152
Epoch: 28, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.228 Vali Acc: 0.339 Test Loss: 3.228 Test Acc: 0.339
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.0718727111816406
Epoch: 29, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.301 Vali Acc: 0.331 Test Loss: 3.301 Test Acc: 0.331
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.0535471439361572
Epoch: 30, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.319 Vali Acc: 0.336 Test Loss: 3.319 Test Acc: 0.336
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.34705882352941175
model parameter : 1160314
model size : 5.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.874422311782837
Epoch: 1, Steps: 10 | Train Loss: 3.272 Vali Loss: 3.287 Vali Acc: 0.047 Test Loss: 3.287 Test Acc: 0.047
Validation loss decreased (inf --> -0.047026).  Saving model ...
Epoch: 2 cost time: 1.3121047019958496
Epoch: 2, Steps: 10 | Train Loss: 3.124 Vali Loss: 3.272 Vali Acc: 0.074 Test Loss: 3.272 Test Acc: 0.074
Validation loss decreased (-0.047026 --> -0.074085).  Saving model ...
Epoch: 3 cost time: 1.3704164028167725
Epoch: 3, Steps: 10 | Train Loss: 3.006 Vali Loss: 3.289 Vali Acc: 0.082 Test Loss: 3.289 Test Acc: 0.082
Validation loss decreased (-0.074085 --> -0.082320).  Saving model ...
Epoch: 4 cost time: 1.3786940574645996
Epoch: 4, Steps: 10 | Train Loss: 2.768 Vali Loss: 3.225 Vali Acc: 0.106 Test Loss: 3.225 Test Acc: 0.106
Validation loss decreased (-0.082320 --> -0.105850).  Saving model ...
Epoch: 5 cost time: 1.434654712677002
Epoch: 5, Steps: 10 | Train Loss: 2.511 Vali Loss: 3.147 Vali Acc: 0.152 Test Loss: 3.147 Test Acc: 0.152
Validation loss decreased (-0.105850 --> -0.151733).  Saving model ...
Epoch: 6 cost time: 1.3081896305084229
Epoch: 6, Steps: 10 | Train Loss: 2.192 Vali Loss: 3.099 Vali Acc: 0.167 Test Loss: 3.099 Test Acc: 0.167
Validation loss decreased (-0.151733 --> -0.167028).  Saving model ...
Epoch: 7 cost time: 1.334930181503296
Epoch: 7, Steps: 10 | Train Loss: 1.839 Vali Loss: 3.074 Vali Acc: 0.167 Test Loss: 3.074 Test Acc: 0.167
Validation loss decreased (-0.167028 --> -0.167028).  Saving model ...
Epoch: 8 cost time: 1.2503578662872314
Epoch: 8, Steps: 10 | Train Loss: 1.497 Vali Loss: 3.052 Vali Acc: 0.202 Test Loss: 3.052 Test Acc: 0.202
Validation loss decreased (-0.167028 --> -0.202322).  Saving model ...
Epoch: 9 cost time: 1.127192735671997
Epoch: 9, Steps: 10 | Train Loss: 1.229 Vali Loss: 3.033 Vali Acc: 0.229 Test Loss: 3.033 Test Acc: 0.229
Validation loss decreased (-0.202322 --> -0.229381).  Saving model ...
Epoch: 10 cost time: 1.1994495391845703
Epoch: 10, Steps: 10 | Train Loss: 0.980 Vali Loss: 2.980 Vali Acc: 0.241 Test Loss: 2.980 Test Acc: 0.241
Validation loss decreased (-0.229381 --> -0.241147).  Saving model ...
Epoch: 11 cost time: 1.1379890441894531
Epoch: 11, Steps: 10 | Train Loss: 0.747 Vali Loss: 2.951 Vali Acc: 0.271 Test Loss: 2.951 Test Acc: 0.271
Validation loss decreased (-0.241147 --> -0.270559).  Saving model ...
Epoch: 12 cost time: 1.2051630020141602
Epoch: 12, Steps: 10 | Train Loss: 0.594 Vali Loss: 2.954 Vali Acc: 0.272 Test Loss: 2.954 Test Acc: 0.272
Validation loss decreased (-0.270559 --> -0.271735).  Saving model ...
Epoch: 13 cost time: 1.264491319656372
Epoch: 13, Steps: 10 | Train Loss: 0.436 Vali Loss: 2.963 Vali Acc: 0.312 Test Loss: 2.963 Test Acc: 0.312
Validation loss decreased (-0.271735 --> -0.311735).  Saving model ...
Epoch: 14 cost time: 1.2554075717926025
Epoch: 14, Steps: 10 | Train Loss: 0.311 Vali Loss: 2.963 Vali Acc: 0.316 Test Loss: 2.963 Test Acc: 0.316
Validation loss decreased (-0.311735 --> -0.316441).  Saving model ...
Epoch: 15 cost time: 1.2351136207580566
Epoch: 15, Steps: 10 | Train Loss: 0.161 Vali Loss: 2.957 Vali Acc: 0.335 Test Loss: 2.957 Test Acc: 0.335
Validation loss decreased (-0.316441 --> -0.335265).  Saving model ...
Epoch: 16 cost time: 1.2406277656555176
Epoch: 16, Steps: 10 | Train Loss: 0.225 Vali Loss: 2.995 Vali Acc: 0.335 Test Loss: 2.995 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.257563829421997
Epoch: 17, Steps: 10 | Train Loss: 0.083 Vali Loss: 2.982 Vali Acc: 0.339 Test Loss: 2.982 Test Acc: 0.339
Validation loss decreased (-0.335265 --> -0.338794).  Saving model ...
Epoch: 18 cost time: 1.2738614082336426
Epoch: 18, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.036 Vali Acc: 0.336 Test Loss: 3.036 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2817449569702148
Epoch: 19, Steps: 10 | Train Loss: 0.079 Vali Loss: 3.034 Vali Acc: 0.340 Test Loss: 3.034 Test Acc: 0.340
Validation loss decreased (-0.338794 --> -0.339970).  Saving model ...
Epoch: 20 cost time: 1.2240984439849854
Epoch: 20, Steps: 10 | Train Loss: 0.056 Vali Loss: 3.057 Vali Acc: 0.351 Test Loss: 3.057 Test Acc: 0.351
Validation loss decreased (-0.339970 --> -0.350558).  Saving model ...
Epoch: 21 cost time: 1.2648937702178955
Epoch: 21, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.049 Vali Acc: 0.340 Test Loss: 3.049 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2577340602874756
Epoch: 22, Steps: 10 | Train Loss: 0.071 Vali Loss: 3.172 Vali Acc: 0.335 Test Loss: 3.172 Test Acc: 0.335
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2417998313903809
Epoch: 23, Steps: 10 | Train Loss: 0.088 Vali Loss: 3.075 Vali Acc: 0.348 Test Loss: 3.075 Test Acc: 0.348
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.3031480312347412
Epoch: 24, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.123 Vali Acc: 0.351 Test Loss: 3.123 Test Acc: 0.351
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.151080846786499
Epoch: 25, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.181 Vali Acc: 0.361 Test Loss: 3.181 Test Acc: 0.361
Validation loss decreased (-0.350558 --> -0.361145).  Saving model ...
Epoch: 26 cost time: 1.182703971862793
Epoch: 26, Steps: 10 | Train Loss: 0.058 Vali Loss: 3.167 Vali Acc: 0.354 Test Loss: 3.167 Test Acc: 0.354
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1266703605651855
Epoch: 27, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.237 Vali Acc: 0.342 Test Loss: 3.237 Test Acc: 0.342
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2204020023345947
Epoch: 28, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.166 Vali Acc: 0.334 Test Loss: 3.166 Test Acc: 0.334
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.3205525875091553
Epoch: 29, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.206 Vali Acc: 0.346 Test Loss: 3.206 Test Acc: 0.346
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.1497955322265625
Epoch: 30, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.200 Vali Acc: 0.364 Test Loss: 3.200 Test Acc: 0.364
Validation loss decreased (-0.361145 --> -0.363497).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3635294117647059
model parameter : 3643066
model size : 14.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.3285789489746094
Epoch: 1, Steps: 10 | Train Loss: 3.297 Vali Loss: 3.281 Vali Acc: 0.034 Test Loss: 3.281 Test Acc: 0.034
Validation loss decreased (inf --> -0.034085).  Saving model ...
Epoch: 2 cost time: 0.9296267032623291
Epoch: 2, Steps: 10 | Train Loss: 3.198 Vali Loss: 3.280 Vali Acc: 0.061 Test Loss: 3.280 Test Acc: 0.061
Validation loss decreased (-0.034085 --> -0.061144).  Saving model ...
Epoch: 3 cost time: 0.880317211151123
Epoch: 3, Steps: 10 | Train Loss: 3.002 Vali Loss: 3.289 Vali Acc: 0.078 Test Loss: 3.289 Test Acc: 0.078
Validation loss decreased (-0.061144 --> -0.077614).  Saving model ...
Epoch: 4 cost time: 0.9495639801025391
Epoch: 4, Steps: 10 | Train Loss: 2.823 Vali Loss: 3.254 Vali Acc: 0.116 Test Loss: 3.254 Test Acc: 0.116
Validation loss decreased (-0.077614 --> -0.116438).  Saving model ...
Epoch: 5 cost time: 0.932776927947998
Epoch: 5, Steps: 10 | Train Loss: 2.579 Vali Loss: 3.205 Vali Acc: 0.125 Test Loss: 3.205 Test Acc: 0.125
Validation loss decreased (-0.116438 --> -0.124674).  Saving model ...
Epoch: 6 cost time: 0.9330775737762451
Epoch: 6, Steps: 10 | Train Loss: 2.332 Vali Loss: 3.146 Vali Acc: 0.140 Test Loss: 3.146 Test Acc: 0.140
Validation loss decreased (-0.124674 --> -0.139969).  Saving model ...
Epoch: 7 cost time: 0.9712526798248291
Epoch: 7, Steps: 10 | Train Loss: 2.126 Vali Loss: 3.137 Vali Acc: 0.174 Test Loss: 3.137 Test Acc: 0.174
Validation loss decreased (-0.139969 --> -0.174086).  Saving model ...
Epoch: 8 cost time: 0.9467141628265381
Epoch: 8, Steps: 10 | Train Loss: 1.873 Vali Loss: 3.104 Vali Acc: 0.193 Test Loss: 3.104 Test Acc: 0.193
Validation loss decreased (-0.174086 --> -0.192910).  Saving model ...
Epoch: 9 cost time: 0.9276328086853027
Epoch: 9, Steps: 10 | Train Loss: 1.568 Vali Loss: 3.082 Vali Acc: 0.200 Test Loss: 3.082 Test Acc: 0.200
Validation loss decreased (-0.192910 --> -0.199969).  Saving model ...
Epoch: 10 cost time: 0.5964305400848389
Epoch: 10, Steps: 10 | Train Loss: 1.283 Vali Loss: 3.052 Vali Acc: 0.213 Test Loss: 3.052 Test Acc: 0.213
Validation loss decreased (-0.199969 --> -0.212911).  Saving model ...
Epoch: 11 cost time: 0.8604075908660889
Epoch: 11, Steps: 10 | Train Loss: 1.032 Vali Loss: 3.064 Vali Acc: 0.225 Test Loss: 3.064 Test Acc: 0.225
Validation loss decreased (-0.212911 --> -0.224675).  Saving model ...
Epoch: 12 cost time: 0.8949050903320312
Epoch: 12, Steps: 10 | Train Loss: 0.800 Vali Loss: 3.024 Vali Acc: 0.253 Test Loss: 3.024 Test Acc: 0.253
Validation loss decreased (-0.224675 --> -0.252911).  Saving model ...
Epoch: 13 cost time: 0.8828153610229492
Epoch: 13, Steps: 10 | Train Loss: 0.568 Vali Loss: 3.070 Vali Acc: 0.272 Test Loss: 3.070 Test Acc: 0.272
Validation loss decreased (-0.252911 --> -0.271734).  Saving model ...
Epoch: 14 cost time: 0.9691028594970703
Epoch: 14, Steps: 10 | Train Loss: 0.514 Vali Loss: 3.039 Vali Acc: 0.281 Test Loss: 3.039 Test Acc: 0.281
Validation loss decreased (-0.271734 --> -0.281146).  Saving model ...
Epoch: 15 cost time: 0.8745098114013672
Epoch: 15, Steps: 10 | Train Loss: 0.331 Vali Loss: 3.075 Vali Acc: 0.292 Test Loss: 3.075 Test Acc: 0.292
Validation loss decreased (-0.281146 --> -0.291734).  Saving model ...
Epoch: 16 cost time: 0.8308980464935303
Epoch: 16, Steps: 10 | Train Loss: 0.241 Vali Loss: 3.097 Vali Acc: 0.304 Test Loss: 3.097 Test Acc: 0.304
Validation loss decreased (-0.291734 --> -0.303498).  Saving model ...
Epoch: 17 cost time: 0.6290910243988037
Epoch: 17, Steps: 10 | Train Loss: 0.203 Vali Loss: 3.141 Vali Acc: 0.293 Test Loss: 3.141 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8742077350616455
Epoch: 18, Steps: 10 | Train Loss: 0.173 Vali Loss: 3.125 Vali Acc: 0.301 Test Loss: 3.125 Test Acc: 0.301
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9130649566650391
Epoch: 19, Steps: 10 | Train Loss: 0.109 Vali Loss: 3.164 Vali Acc: 0.299 Test Loss: 3.164 Test Acc: 0.299
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9526441097259521
Epoch: 20, Steps: 10 | Train Loss: 0.098 Vali Loss: 3.369 Vali Acc: 0.295 Test Loss: 3.369 Test Acc: 0.295
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9332430362701416
Epoch: 21, Steps: 10 | Train Loss: 0.088 Vali Loss: 3.168 Vali Acc: 0.321 Test Loss: 3.168 Test Acc: 0.321
Validation loss decreased (-0.303498 --> -0.321145).  Saving model ...
Epoch: 22 cost time: 0.9574642181396484
Epoch: 22, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.254 Vali Acc: 0.315 Test Loss: 3.254 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9652566909790039
Epoch: 23, Steps: 10 | Train Loss: 0.056 Vali Loss: 3.206 Vali Acc: 0.321 Test Loss: 3.206 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8849318027496338
Epoch: 24, Steps: 10 | Train Loss: 0.056 Vali Loss: 3.254 Vali Acc: 0.326 Test Loss: 3.254 Test Acc: 0.326
Validation loss decreased (-0.321145 --> -0.325850).  Saving model ...
Epoch: 25 cost time: 0.929398775100708
Epoch: 25, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.313 Vali Acc: 0.316 Test Loss: 3.313 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9308168888092041
Epoch: 26, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.330 Vali Acc: 0.315 Test Loss: 3.330 Test Acc: 0.315
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9915142059326172
Epoch: 27, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.333 Vali Acc: 0.319 Test Loss: 3.333 Test Acc: 0.319
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9120733737945557
Epoch: 28, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.364 Vali Acc: 0.318 Test Loss: 3.364 Test Acc: 0.318
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.8119776248931885
Epoch: 29, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.373 Vali Acc: 0.325 Test Loss: 3.373 Test Acc: 0.325
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.843388557434082
Epoch: 30, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.399 Vali Acc: 0.319 Test Loss: 3.399 Test Acc: 0.319
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.32588235294117646
model parameter : 1160314
model size : 5.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.171919345855713
Epoch: 1, Steps: 10 | Train Loss: 3.324 Vali Loss: 3.300 Vali Acc: 0.040 Test Loss: 3.300 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 1.6052308082580566
Epoch: 2, Steps: 10 | Train Loss: 3.169 Vali Loss: 3.275 Vali Acc: 0.065 Test Loss: 3.275 Test Acc: 0.065
Validation loss decreased (-0.039967 --> -0.064673).  Saving model ...
Epoch: 3 cost time: 1.7894184589385986
Epoch: 3, Steps: 10 | Train Loss: 2.965 Vali Loss: 3.280 Vali Acc: 0.086 Test Loss: 3.280 Test Acc: 0.086
Validation loss decreased (-0.064673 --> -0.085850).  Saving model ...
Epoch: 4 cost time: 1.7789230346679688
Epoch: 4, Steps: 10 | Train Loss: 2.729 Vali Loss: 3.244 Vali Acc: 0.134 Test Loss: 3.244 Test Acc: 0.134
Validation loss decreased (-0.085850 --> -0.134085).  Saving model ...
Epoch: 5 cost time: 1.7735567092895508
Epoch: 5, Steps: 10 | Train Loss: 2.424 Vali Loss: 3.151 Vali Acc: 0.162 Test Loss: 3.151 Test Acc: 0.162
Validation loss decreased (-0.134085 --> -0.162321).  Saving model ...
Epoch: 6 cost time: 1.7910633087158203
Epoch: 6, Steps: 10 | Train Loss: 2.073 Vali Loss: 3.071 Vali Acc: 0.186 Test Loss: 3.071 Test Acc: 0.186
Validation loss decreased (-0.162321 --> -0.185852).  Saving model ...
Epoch: 7 cost time: 1.8247685432434082
Epoch: 7, Steps: 10 | Train Loss: 1.706 Vali Loss: 2.999 Vali Acc: 0.222 Test Loss: 2.999 Test Acc: 0.222
Validation loss decreased (-0.185852 --> -0.222323).  Saving model ...
Epoch: 8 cost time: 1.809278964996338
Epoch: 8, Steps: 10 | Train Loss: 1.366 Vali Loss: 2.942 Vali Acc: 0.234 Test Loss: 2.942 Test Acc: 0.234
Validation loss decreased (-0.222323 --> -0.234088).  Saving model ...
Epoch: 9 cost time: 1.7930505275726318
Epoch: 9, Steps: 10 | Train Loss: 1.048 Vali Loss: 2.920 Vali Acc: 0.248 Test Loss: 2.920 Test Acc: 0.248
Validation loss decreased (-0.234088 --> -0.248206).  Saving model ...
Epoch: 10 cost time: 1.2091286182403564
Epoch: 10, Steps: 10 | Train Loss: 0.744 Vali Loss: 2.872 Vali Acc: 0.268 Test Loss: 2.872 Test Acc: 0.268
Validation loss decreased (-0.248206 --> -0.268207).  Saving model ...
Epoch: 11 cost time: 1.5641653537750244
Epoch: 11, Steps: 10 | Train Loss: 0.517 Vali Loss: 2.910 Vali Acc: 0.284 Test Loss: 2.910 Test Acc: 0.284
Validation loss decreased (-0.268207 --> -0.283500).  Saving model ...
Epoch: 12 cost time: 1.5098333358764648
Epoch: 12, Steps: 10 | Train Loss: 0.372 Vali Loss: 2.859 Vali Acc: 0.320 Test Loss: 2.859 Test Acc: 0.320
Validation loss decreased (-0.283500 --> -0.319971).  Saving model ...
Epoch: 13 cost time: 1.659578800201416
Epoch: 13, Steps: 10 | Train Loss: 0.257 Vali Loss: 2.932 Vali Acc: 0.319 Test Loss: 2.932 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6196136474609375
Epoch: 14, Steps: 10 | Train Loss: 0.157 Vali Loss: 2.961 Vali Acc: 0.327 Test Loss: 2.961 Test Acc: 0.327
Validation loss decreased (-0.319971 --> -0.327029).  Saving model ...
Epoch: 15 cost time: 1.765897274017334
Epoch: 15, Steps: 10 | Train Loss: 0.112 Vali Loss: 3.010 Vali Acc: 0.314 Test Loss: 3.010 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.749967098236084
Epoch: 16, Steps: 10 | Train Loss: 0.111 Vali Loss: 3.155 Vali Acc: 0.316 Test Loss: 3.155 Test Acc: 0.316
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7477762699127197
Epoch: 17, Steps: 10 | Train Loss: 0.124 Vali Loss: 2.943 Vali Acc: 0.338 Test Loss: 2.943 Test Acc: 0.338
Validation loss decreased (-0.327029 --> -0.337618).  Saving model ...
Epoch: 18 cost time: 1.7668347358703613
Epoch: 18, Steps: 10 | Train Loss: 0.087 Vali Loss: 2.948 Vali Acc: 0.340 Test Loss: 2.948 Test Acc: 0.340
Validation loss decreased (-0.337618 --> -0.339971).  Saving model ...
Epoch: 19 cost time: 1.7714643478393555
Epoch: 19, Steps: 10 | Train Loss: 0.056 Vali Loss: 3.105 Vali Acc: 0.325 Test Loss: 3.105 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.7310657501220703
Epoch: 20, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.089 Vali Acc: 0.334 Test Loss: 3.089 Test Acc: 0.334
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.7316946983337402
Epoch: 21, Steps: 10 | Train Loss: 0.085 Vali Loss: 3.041 Vali Acc: 0.335 Test Loss: 3.041 Test Acc: 0.335
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.7370052337646484
Epoch: 22, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.069 Vali Acc: 0.327 Test Loss: 3.069 Test Acc: 0.327
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.582679271697998
Epoch: 23, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.116 Vali Acc: 0.326 Test Loss: 3.116 Test Acc: 0.326
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.5914297103881836
Epoch: 24, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.123 Vali Acc: 0.324 Test Loss: 3.123 Test Acc: 0.324
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.2318284511566162
Epoch: 25, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.138 Vali Acc: 0.332 Test Loss: 3.138 Test Acc: 0.332
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.6421208381652832
Epoch: 26, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.109 Vali Acc: 0.332 Test Loss: 3.109 Test Acc: 0.332
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.6360747814178467
Epoch: 27, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.121 Vali Acc: 0.344 Test Loss: 3.121 Test Acc: 0.344
Validation loss decreased (-0.339971 --> -0.343498).  Saving model ...
Epoch: 28 cost time: 1.7987382411956787
Epoch: 28, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.147 Vali Acc: 0.342 Test Loss: 3.147 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.7818622589111328
Epoch: 29, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.185 Vali Acc: 0.333 Test Loss: 3.185 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.7568256855010986
Epoch: 30, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.162 Vali Acc: 0.341 Test Loss: 3.162 Test Acc: 0.341
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.34352941176470586
model parameter : 1885306
model size : 7.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.6022982597351074
Epoch: 1, Steps: 10 | Train Loss: 3.319 Vali Loss: 3.326 Vali Acc: 0.027 Test Loss: 3.326 Test Acc: 0.027
Validation loss decreased (inf --> -0.027026).  Saving model ...
Epoch: 2 cost time: 1.3617119789123535
Epoch: 2, Steps: 10 | Train Loss: 3.178 Vali Loss: 3.306 Vali Acc: 0.042 Test Loss: 3.306 Test Acc: 0.042
Validation loss decreased (-0.027026 --> -0.042320).  Saving model ...
Epoch: 3 cost time: 1.2479503154754639
Epoch: 3, Steps: 10 | Train Loss: 2.966 Vali Loss: 3.314 Vali Acc: 0.076 Test Loss: 3.314 Test Acc: 0.076
Validation loss decreased (-0.042320 --> -0.076437).  Saving model ...
Epoch: 4 cost time: 1.1721439361572266
Epoch: 4, Steps: 10 | Train Loss: 2.780 Vali Loss: 3.280 Vali Acc: 0.098 Test Loss: 3.280 Test Acc: 0.098
Validation loss decreased (-0.076437 --> -0.097614).  Saving model ...
Epoch: 5 cost time: 1.1394243240356445
Epoch: 5, Steps: 10 | Train Loss: 2.490 Vali Loss: 3.211 Vali Acc: 0.122 Test Loss: 3.211 Test Acc: 0.122
Validation loss decreased (-0.097614 --> -0.122321).  Saving model ...
Epoch: 6 cost time: 1.200545310974121
Epoch: 6, Steps: 10 | Train Loss: 2.293 Vali Loss: 3.136 Vali Acc: 0.154 Test Loss: 3.136 Test Acc: 0.154
Validation loss decreased (-0.122321 --> -0.154086).  Saving model ...
Epoch: 7 cost time: 1.290104866027832
Epoch: 7, Steps: 10 | Train Loss: 1.918 Vali Loss: 3.074 Vali Acc: 0.168 Test Loss: 3.074 Test Acc: 0.168
Validation loss decreased (-0.154086 --> -0.168205).  Saving model ...
Epoch: 8 cost time: 1.155235767364502
Epoch: 8, Steps: 10 | Train Loss: 1.637 Vali Loss: 3.050 Vali Acc: 0.178 Test Loss: 3.050 Test Acc: 0.178
Validation loss decreased (-0.168205 --> -0.177617).  Saving model ...
Epoch: 9 cost time: 1.1515839099884033
Epoch: 9, Steps: 10 | Train Loss: 1.266 Vali Loss: 3.028 Vali Acc: 0.199 Test Loss: 3.028 Test Acc: 0.199
Validation loss decreased (-0.177617 --> -0.198793).  Saving model ...
Epoch: 10 cost time: 1.3025643825531006
Epoch: 10, Steps: 10 | Train Loss: 0.966 Vali Loss: 3.012 Vali Acc: 0.212 Test Loss: 3.012 Test Acc: 0.212
Validation loss decreased (-0.198793 --> -0.211735).  Saving model ...
Epoch: 11 cost time: 1.3050358295440674
Epoch: 11, Steps: 10 | Train Loss: 0.722 Vali Loss: 2.999 Vali Acc: 0.247 Test Loss: 2.999 Test Acc: 0.247
Validation loss decreased (-0.211735 --> -0.247029).  Saving model ...
Epoch: 12 cost time: 1.3316097259521484
Epoch: 12, Steps: 10 | Train Loss: 0.503 Vali Loss: 3.016 Vali Acc: 0.255 Test Loss: 3.016 Test Acc: 0.255
Validation loss decreased (-0.247029 --> -0.255264).  Saving model ...
Epoch: 13 cost time: 1.264113426208496
Epoch: 13, Steps: 10 | Train Loss: 0.331 Vali Loss: 3.045 Vali Acc: 0.271 Test Loss: 3.045 Test Acc: 0.271
Validation loss decreased (-0.255264 --> -0.270558).  Saving model ...
Epoch: 14 cost time: 1.2821342945098877
Epoch: 14, Steps: 10 | Train Loss: 0.248 Vali Loss: 3.102 Vali Acc: 0.267 Test Loss: 3.102 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2889316082000732
Epoch: 15, Steps: 10 | Train Loss: 0.192 Vali Loss: 3.054 Vali Acc: 0.289 Test Loss: 3.054 Test Acc: 0.289
Validation loss decreased (-0.270558 --> -0.289381).  Saving model ...
Epoch: 16 cost time: 1.2833633422851562
Epoch: 16, Steps: 10 | Train Loss: 0.152 Vali Loss: 3.102 Vali Acc: 0.304 Test Loss: 3.102 Test Acc: 0.304
Validation loss decreased (-0.289381 --> -0.303498).  Saving model ...
Epoch: 17 cost time: 1.321901798248291
Epoch: 17, Steps: 10 | Train Loss: 0.113 Vali Loss: 3.098 Vali Acc: 0.296 Test Loss: 3.098 Test Acc: 0.296
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2765061855316162
Epoch: 18, Steps: 10 | Train Loss: 0.138 Vali Loss: 3.144 Vali Acc: 0.299 Test Loss: 3.144 Test Acc: 0.299
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2088568210601807
Epoch: 19, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.152 Vali Acc: 0.312 Test Loss: 3.152 Test Acc: 0.312
Validation loss decreased (-0.303498 --> -0.311733).  Saving model ...
Epoch: 20 cost time: 1.2195594310760498
Epoch: 20, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.258 Vali Acc: 0.302 Test Loss: 3.258 Test Acc: 0.302
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2061586380004883
Epoch: 21, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.233 Vali Acc: 0.309 Test Loss: 3.233 Test Acc: 0.309
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.2216885089874268
Epoch: 22, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.212 Vali Acc: 0.311 Test Loss: 3.212 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.2201485633850098
Epoch: 23, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.236 Vali Acc: 0.307 Test Loss: 3.236 Test Acc: 0.307
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.2446093559265137
Epoch: 24, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.296 Vali Acc: 0.318 Test Loss: 3.296 Test Acc: 0.318
Validation loss decreased (-0.311733 --> -0.317614).  Saving model ...
Epoch: 25 cost time: 1.2470438480377197
Epoch: 25, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.283 Vali Acc: 0.314 Test Loss: 3.283 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3227546215057373
Epoch: 26, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.301 Vali Acc: 0.302 Test Loss: 3.301 Test Acc: 0.302
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.3268826007843018
Epoch: 27, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.297 Vali Acc: 0.308 Test Loss: 3.297 Test Acc: 0.308
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.3388755321502686
Epoch: 28, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.305 Vali Acc: 0.319 Test Loss: 3.305 Test Acc: 0.319
Validation loss decreased (-0.317614 --> -0.318790).  Saving model ...
Epoch: 29 cost time: 1.3318102359771729
Epoch: 29, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.294 Vali Acc: 0.315 Test Loss: 3.294 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3286292552947998
Epoch: 30, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.330 Vali Acc: 0.312 Test Loss: 3.330 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.31882352941176473
model parameter : 643834
model size : 3.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.8795900344848633
Epoch: 1, Steps: 10 | Train Loss: 3.312 Vali Loss: 3.296 Vali Acc: 0.044 Test Loss: 3.296 Test Acc: 0.044
Validation loss decreased (inf --> -0.043496).  Saving model ...
Epoch: 2 cost time: 1.3943655490875244
Epoch: 2, Steps: 10 | Train Loss: 3.169 Vali Loss: 3.272 Vali Acc: 0.064 Test Loss: 3.272 Test Acc: 0.064
Validation loss decreased (-0.043496 --> -0.063497).  Saving model ...
Epoch: 3 cost time: 1.415428876876831
Epoch: 3, Steps: 10 | Train Loss: 2.974 Vali Loss: 3.280 Vali Acc: 0.081 Test Loss: 3.280 Test Acc: 0.081
Validation loss decreased (-0.063497 --> -0.081144).  Saving model ...
Epoch: 4 cost time: 1.3848741054534912
Epoch: 4, Steps: 10 | Train Loss: 2.738 Vali Loss: 3.244 Vali Acc: 0.119 Test Loss: 3.244 Test Acc: 0.119
Validation loss decreased (-0.081144 --> -0.118791).  Saving model ...
Epoch: 5 cost time: 1.3583765029907227
Epoch: 5, Steps: 10 | Train Loss: 2.443 Vali Loss: 3.158 Vali Acc: 0.145 Test Loss: 3.158 Test Acc: 0.145
Validation loss decreased (-0.118791 --> -0.144674).  Saving model ...
Epoch: 6 cost time: 1.3738784790039062
Epoch: 6, Steps: 10 | Train Loss: 2.159 Vali Loss: 3.078 Vali Acc: 0.184 Test Loss: 3.078 Test Acc: 0.184
Validation loss decreased (-0.144674 --> -0.183499).  Saving model ...
Epoch: 7 cost time: 1.1135411262512207
Epoch: 7, Steps: 10 | Train Loss: 1.783 Vali Loss: 3.028 Vali Acc: 0.198 Test Loss: 3.028 Test Acc: 0.198
Validation loss decreased (-0.183499 --> -0.197617).  Saving model ...
Epoch: 8 cost time: 1.492849588394165
Epoch: 8, Steps: 10 | Train Loss: 1.570 Vali Loss: 2.980 Vali Acc: 0.214 Test Loss: 2.980 Test Acc: 0.214
Validation loss decreased (-0.197617 --> -0.214088).  Saving model ...
Epoch: 9 cost time: 1.4795515537261963
Epoch: 9, Steps: 10 | Train Loss: 1.213 Vali Loss: 2.952 Vali Acc: 0.235 Test Loss: 2.952 Test Acc: 0.235
Validation loss decreased (-0.214088 --> -0.235265).  Saving model ...
Epoch: 10 cost time: 1.4946212768554688
Epoch: 10, Steps: 10 | Train Loss: 0.937 Vali Loss: 2.911 Vali Acc: 0.260 Test Loss: 2.911 Test Acc: 0.260
Validation loss decreased (-0.235265 --> -0.259971).  Saving model ...
Epoch: 11 cost time: 1.4840388298034668
Epoch: 11, Steps: 10 | Train Loss: 0.764 Vali Loss: 2.909 Vali Acc: 0.286 Test Loss: 2.909 Test Acc: 0.286
Validation loss decreased (-0.259971 --> -0.285853).  Saving model ...
Epoch: 12 cost time: 1.5086345672607422
Epoch: 12, Steps: 10 | Train Loss: 0.493 Vali Loss: 2.932 Vali Acc: 0.286 Test Loss: 2.932 Test Acc: 0.286
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4700274467468262
Epoch: 13, Steps: 10 | Train Loss: 0.395 Vali Loss: 2.961 Vali Acc: 0.302 Test Loss: 2.961 Test Acc: 0.302
Validation loss decreased (-0.285853 --> -0.302323).  Saving model ...
Epoch: 14 cost time: 1.44282865524292
Epoch: 14, Steps: 10 | Train Loss: 0.260 Vali Loss: 3.080 Vali Acc: 0.296 Test Loss: 3.080 Test Acc: 0.296
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.461259126663208
Epoch: 15, Steps: 10 | Train Loss: 0.245 Vali Loss: 3.026 Vali Acc: 0.312 Test Loss: 3.026 Test Acc: 0.312
Validation loss decreased (-0.302323 --> -0.311734).  Saving model ...
Epoch: 16 cost time: 1.3069202899932861
Epoch: 16, Steps: 10 | Train Loss: 0.152 Vali Loss: 3.132 Vali Acc: 0.315 Test Loss: 3.132 Test Acc: 0.315
Validation loss decreased (-0.311734 --> -0.315263).  Saving model ...
Epoch: 17 cost time: 1.3504724502563477
Epoch: 17, Steps: 10 | Train Loss: 0.128 Vali Loss: 2.996 Vali Acc: 0.331 Test Loss: 2.996 Test Acc: 0.331
Validation loss decreased (-0.315263 --> -0.330558).  Saving model ...
Epoch: 18 cost time: 1.3033313751220703
Epoch: 18, Steps: 10 | Train Loss: 0.095 Vali Loss: 3.028 Vali Acc: 0.326 Test Loss: 3.028 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3040111064910889
Epoch: 19, Steps: 10 | Train Loss: 0.064 Vali Loss: 3.110 Vali Acc: 0.324 Test Loss: 3.110 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.3215429782867432
Epoch: 20, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.070 Vali Acc: 0.327 Test Loss: 3.070 Test Acc: 0.327
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.334437608718872
Epoch: 21, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.079 Vali Acc: 0.342 Test Loss: 3.079 Test Acc: 0.342
Validation loss decreased (-0.330558 --> -0.342322).  Saving model ...
Epoch: 22 cost time: 1.4971680641174316
Epoch: 22, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.177 Vali Acc: 0.334 Test Loss: 3.177 Test Acc: 0.334
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4079697132110596
Epoch: 23, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.066 Vali Acc: 0.339 Test Loss: 3.066 Test Acc: 0.339
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.4410741329193115
Epoch: 24, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.083 Vali Acc: 0.336 Test Loss: 3.083 Test Acc: 0.336
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.3983073234558105
Epoch: 25, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.150 Vali Acc: 0.348 Test Loss: 3.150 Test Acc: 0.348
Validation loss decreased (-0.342322 --> -0.348204).  Saving model ...
Epoch: 26 cost time: 1.4544849395751953
Epoch: 26, Steps: 10 | Train Loss: 0.060 Vali Loss: 3.071 Vali Acc: 0.362 Test Loss: 3.071 Test Acc: 0.362
Validation loss decreased (-0.348204 --> -0.362322).  Saving model ...
Epoch: 27 cost time: 1.4344263076782227
Epoch: 27, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.214 Vali Acc: 0.354 Test Loss: 3.214 Test Acc: 0.354
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4517450332641602
Epoch: 28, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.119 Vali Acc: 0.364 Test Loss: 3.119 Test Acc: 0.364
Validation loss decreased (-0.362322 --> -0.363498).  Saving model ...
Epoch: 29 cost time: 1.4766755104064941
Epoch: 29, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.268 Vali Acc: 0.351 Test Loss: 3.268 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3235697746276855
Epoch: 30, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.260 Vali Acc: 0.347 Test Loss: 3.260 Test Acc: 0.347
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3635294117647059
model parameter : 1885306
model size : 7.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.339141845703125
Epoch: 1, Steps: 10 | Train Loss: 3.318 Vali Loss: 3.331 Vali Acc: 0.028 Test Loss: 3.331 Test Acc: 0.028
Validation loss decreased (inf --> -0.028202).  Saving model ...
Epoch: 2 cost time: 1.0935561656951904
Epoch: 2, Steps: 10 | Train Loss: 3.184 Vali Loss: 3.314 Vali Acc: 0.047 Test Loss: 3.314 Test Acc: 0.047
Validation loss decreased (-0.028202 --> -0.047026).  Saving model ...
Epoch: 3 cost time: 1.0599830150604248
Epoch: 3, Steps: 10 | Train Loss: 2.973 Vali Loss: 3.325 Vali Acc: 0.075 Test Loss: 3.325 Test Acc: 0.075
Validation loss decreased (-0.047026 --> -0.075261).  Saving model ...
Epoch: 4 cost time: 1.0901532173156738
Epoch: 4, Steps: 10 | Train Loss: 2.783 Vali Loss: 3.295 Vali Acc: 0.100 Test Loss: 3.295 Test Acc: 0.100
Validation loss decreased (-0.075261 --> -0.099967).  Saving model ...
Epoch: 5 cost time: 1.0463576316833496
Epoch: 5, Steps: 10 | Train Loss: 2.519 Vali Loss: 3.233 Vali Acc: 0.111 Test Loss: 3.233 Test Acc: 0.111
Validation loss decreased (-0.099967 --> -0.110556).  Saving model ...
Epoch: 6 cost time: 1.0456430912017822
Epoch: 6, Steps: 10 | Train Loss: 2.340 Vali Loss: 3.164 Vali Acc: 0.155 Test Loss: 3.164 Test Acc: 0.155
Validation loss decreased (-0.110556 --> -0.155262).  Saving model ...
Epoch: 7 cost time: 0.740286111831665
Epoch: 7, Steps: 10 | Train Loss: 2.017 Vali Loss: 3.105 Vali Acc: 0.175 Test Loss: 3.105 Test Acc: 0.175
Validation loss decreased (-0.155262 --> -0.175263).  Saving model ...
Epoch: 8 cost time: 0.8697004318237305
Epoch: 8, Steps: 10 | Train Loss: 1.728 Vali Loss: 3.078 Vali Acc: 0.182 Test Loss: 3.078 Test Acc: 0.182
Validation loss decreased (-0.175263 --> -0.182322).  Saving model ...
Epoch: 9 cost time: 0.7331030368804932
Epoch: 9, Steps: 10 | Train Loss: 1.394 Vali Loss: 3.045 Vali Acc: 0.213 Test Loss: 3.045 Test Acc: 0.213
Validation loss decreased (-0.182322 --> -0.212911).  Saving model ...
Epoch: 10 cost time: 0.7881622314453125
Epoch: 10, Steps: 10 | Train Loss: 1.103 Vali Loss: 3.030 Vali Acc: 0.228 Test Loss: 3.030 Test Acc: 0.228
Validation loss decreased (-0.212911 --> -0.228205).  Saving model ...
Epoch: 11 cost time: 0.7477724552154541
Epoch: 11, Steps: 10 | Train Loss: 0.829 Vali Loss: 3.023 Vali Acc: 0.254 Test Loss: 3.023 Test Acc: 0.254
Validation loss decreased (-0.228205 --> -0.254087).  Saving model ...
Epoch: 12 cost time: 0.7971827983856201
Epoch: 12, Steps: 10 | Train Loss: 0.604 Vali Loss: 3.020 Vali Acc: 0.282 Test Loss: 3.020 Test Acc: 0.282
Validation loss decreased (-0.254087 --> -0.282323).  Saving model ...
Epoch: 13 cost time: 0.7639386653900146
Epoch: 13, Steps: 10 | Train Loss: 0.411 Vali Loss: 3.007 Vali Acc: 0.295 Test Loss: 3.007 Test Acc: 0.295
Validation loss decreased (-0.282323 --> -0.295264).  Saving model ...
Epoch: 14 cost time: 0.743973970413208
Epoch: 14, Steps: 10 | Train Loss: 0.327 Vali Loss: 3.049 Vali Acc: 0.292 Test Loss: 3.049 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.035536527633667
Epoch: 15, Steps: 10 | Train Loss: 0.267 Vali Loss: 3.067 Vali Acc: 0.308 Test Loss: 3.067 Test Acc: 0.308
Validation loss decreased (-0.295264 --> -0.308205).  Saving model ...
Epoch: 16 cost time: 1.0262062549591064
Epoch: 16, Steps: 10 | Train Loss: 0.246 Vali Loss: 3.143 Vali Acc: 0.309 Test Loss: 3.143 Test Acc: 0.309
Validation loss decreased (-0.308205 --> -0.309380).  Saving model ...
Epoch: 17 cost time: 1.0149061679840088
Epoch: 17, Steps: 10 | Train Loss: 0.152 Vali Loss: 3.144 Vali Acc: 0.306 Test Loss: 3.144 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9996588230133057
Epoch: 18, Steps: 10 | Train Loss: 0.215 Vali Loss: 3.172 Vali Acc: 0.321 Test Loss: 3.172 Test Acc: 0.321
Validation loss decreased (-0.309380 --> -0.321145).  Saving model ...
Epoch: 19 cost time: 1.026193380355835
Epoch: 19, Steps: 10 | Train Loss: 0.172 Vali Loss: 3.159 Vali Acc: 0.313 Test Loss: 3.159 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9820747375488281
Epoch: 20, Steps: 10 | Train Loss: 0.064 Vali Loss: 3.279 Vali Acc: 0.313 Test Loss: 3.279 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8816325664520264
Epoch: 21, Steps: 10 | Train Loss: 0.066 Vali Loss: 3.166 Vali Acc: 0.341 Test Loss: 3.166 Test Acc: 0.341
Validation loss decreased (-0.321145 --> -0.341145).  Saving model ...
Epoch: 22 cost time: 0.7714779376983643
Epoch: 22, Steps: 10 | Train Loss: 0.095 Vali Loss: 3.194 Vali Acc: 0.331 Test Loss: 3.194 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9338648319244385
Epoch: 23, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.273 Vali Acc: 0.326 Test Loss: 3.273 Test Acc: 0.326
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0638213157653809
Epoch: 24, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.332 Vali Acc: 0.335 Test Loss: 3.332 Test Acc: 0.335
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.995323657989502
Epoch: 25, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.310 Vali Acc: 0.332 Test Loss: 3.310 Test Acc: 0.332
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.0700325965881348
Epoch: 26, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.340 Vali Acc: 0.333 Test Loss: 3.340 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.0461583137512207
Epoch: 27, Steps: 10 | Train Loss: 0.043 Vali Loss: 3.411 Vali Acc: 0.321 Test Loss: 3.411 Test Acc: 0.321
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.0369453430175781
Epoch: 28, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.453 Vali Acc: 0.322 Test Loss: 3.453 Test Acc: 0.322
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.0497093200683594
Epoch: 29, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.392 Vali Acc: 0.327 Test Loss: 3.392 Test Acc: 0.327
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.030860185623169
Epoch: 30, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.323 Vali Acc: 0.336 Test Loss: 3.323 Test Acc: 0.336
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3411764705882353
model parameter : 643834
model size : 3.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.2885875701904297
Epoch: 1, Steps: 10 | Train Loss: 3.308 Vali Loss: 3.294 Vali Acc: 0.046 Test Loss: 3.294 Test Acc: 0.046
Validation loss decreased (inf --> -0.045849).  Saving model ...
Epoch: 2 cost time: 1.0154147148132324
Epoch: 2, Steps: 10 | Train Loss: 3.161 Vali Loss: 3.276 Vali Acc: 0.061 Test Loss: 3.276 Test Acc: 0.061
Validation loss decreased (-0.045849 --> -0.061144).  Saving model ...
Epoch: 3 cost time: 1.0164539813995361
Epoch: 3, Steps: 10 | Train Loss: 2.988 Vali Loss: 3.287 Vali Acc: 0.080 Test Loss: 3.287 Test Acc: 0.080
Validation loss decreased (-0.061144 --> -0.079967).  Saving model ...
Epoch: 4 cost time: 1.0158751010894775
Epoch: 4, Steps: 10 | Train Loss: 2.784 Vali Loss: 3.261 Vali Acc: 0.113 Test Loss: 3.261 Test Acc: 0.113
Validation loss decreased (-0.079967 --> -0.112909).  Saving model ...
Epoch: 5 cost time: 0.9977293014526367
Epoch: 5, Steps: 10 | Train Loss: 2.541 Vali Loss: 3.190 Vali Acc: 0.146 Test Loss: 3.190 Test Acc: 0.146
Validation loss decreased (-0.112909 --> -0.145850).  Saving model ...
Epoch: 6 cost time: 0.9311690330505371
Epoch: 6, Steps: 10 | Train Loss: 2.264 Vali Loss: 3.130 Vali Acc: 0.171 Test Loss: 3.130 Test Acc: 0.171
Validation loss decreased (-0.145850 --> -0.170557).  Saving model ...
Epoch: 7 cost time: 0.8380978107452393
Epoch: 7, Steps: 10 | Train Loss: 1.999 Vali Loss: 3.077 Vali Acc: 0.193 Test Loss: 3.077 Test Acc: 0.193
Validation loss decreased (-0.170557 --> -0.192910).  Saving model ...
Epoch: 8 cost time: 0.8276646137237549
Epoch: 8, Steps: 10 | Train Loss: 1.711 Vali Loss: 3.047 Vali Acc: 0.206 Test Loss: 3.047 Test Acc: 0.206
Validation loss decreased (-0.192910 --> -0.205852).  Saving model ...
Epoch: 9 cost time: 0.8912258148193359
Epoch: 9, Steps: 10 | Train Loss: 1.406 Vali Loss: 3.011 Vali Acc: 0.229 Test Loss: 3.011 Test Acc: 0.229
Validation loss decreased (-0.205852 --> -0.229382).  Saving model ...
Epoch: 10 cost time: 0.911801815032959
Epoch: 10, Steps: 10 | Train Loss: 1.135 Vali Loss: 2.998 Vali Acc: 0.241 Test Loss: 2.998 Test Acc: 0.241
Validation loss decreased (-0.229382 --> -0.241146).  Saving model ...
Epoch: 11 cost time: 1.041614294052124
Epoch: 11, Steps: 10 | Train Loss: 0.820 Vali Loss: 2.999 Vali Acc: 0.254 Test Loss: 2.999 Test Acc: 0.254
Validation loss decreased (-0.241146 --> -0.254088).  Saving model ...
Epoch: 12 cost time: 0.9765138626098633
Epoch: 12, Steps: 10 | Train Loss: 0.647 Vali Loss: 2.987 Vali Acc: 0.285 Test Loss: 2.987 Test Acc: 0.285
Validation loss decreased (-0.254088 --> -0.284676).  Saving model ...
Epoch: 13 cost time: 0.9551670551300049
Epoch: 13, Steps: 10 | Train Loss: 0.468 Vali Loss: 3.027 Vali Acc: 0.278 Test Loss: 3.027 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9624791145324707
Epoch: 14, Steps: 10 | Train Loss: 0.360 Vali Loss: 2.973 Vali Acc: 0.298 Test Loss: 2.973 Test Acc: 0.298
Validation loss decreased (-0.284676 --> -0.297617).  Saving model ...
Epoch: 15 cost time: 0.9827961921691895
Epoch: 15, Steps: 10 | Train Loss: 0.222 Vali Loss: 2.996 Vali Acc: 0.316 Test Loss: 2.996 Test Acc: 0.316
Validation loss decreased (-0.297617 --> -0.316441).  Saving model ...
Epoch: 16 cost time: 0.7503180503845215
Epoch: 16, Steps: 10 | Train Loss: 0.170 Vali Loss: 3.193 Vali Acc: 0.305 Test Loss: 3.193 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8861358165740967
Epoch: 17, Steps: 10 | Train Loss: 0.205 Vali Loss: 3.018 Vali Acc: 0.334 Test Loss: 3.018 Test Acc: 0.334
Validation loss decreased (-0.316441 --> -0.334087).  Saving model ...
Epoch: 18 cost time: 0.8312170505523682
Epoch: 18, Steps: 10 | Train Loss: 0.097 Vali Loss: 3.114 Vali Acc: 0.321 Test Loss: 3.114 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8076426982879639
Epoch: 19, Steps: 10 | Train Loss: 0.090 Vali Loss: 3.112 Vali Acc: 0.331 Test Loss: 3.112 Test Acc: 0.331
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9802892208099365
Epoch: 20, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.176 Vali Acc: 0.332 Test Loss: 3.176 Test Acc: 0.332
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9849090576171875
Epoch: 21, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.139 Vali Acc: 0.344 Test Loss: 3.139 Test Acc: 0.344
Validation loss decreased (-0.334087 --> -0.343498).  Saving model ...
Epoch: 22 cost time: 1.0690891742706299
Epoch: 22, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.162 Vali Acc: 0.336 Test Loss: 3.162 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9890055656433105
Epoch: 23, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.151 Vali Acc: 0.342 Test Loss: 3.151 Test Acc: 0.342
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9855661392211914
Epoch: 24, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.205 Vali Acc: 0.342 Test Loss: 3.205 Test Acc: 0.342
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9518589973449707
Epoch: 25, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.242 Vali Acc: 0.336 Test Loss: 3.242 Test Acc: 0.336
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.8308053016662598
Epoch: 26, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.221 Vali Acc: 0.338 Test Loss: 3.221 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.7942063808441162
Epoch: 27, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.287 Vali Acc: 0.339 Test Loss: 3.287 Test Acc: 0.339
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.8623855113983154
Epoch: 28, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.153 Vali Acc: 0.354 Test Loss: 3.153 Test Acc: 0.354
Validation loss decreased (-0.343498 --> -0.354086).  Saving model ...
Epoch: 29 cost time: 0.8005044460296631
Epoch: 29, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.228 Vali Acc: 0.352 Test Loss: 3.228 Test Acc: 0.352
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9721150398254395
Epoch: 30, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.226 Vali Acc: 0.360 Test Loss: 3.226 Test Acc: 0.360
Validation loss decreased (-0.354086 --> -0.359968).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.36
model parameter : 1885306
model size : 7.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.055042266845703
Epoch: 1, Steps: 10 | Train Loss: 3.312 Vali Loss: 3.330 Vali Acc: 0.027 Test Loss: 3.330 Test Acc: 0.027
Validation loss decreased (inf --> -0.027026).  Saving model ...
Epoch: 2 cost time: 0.7983453273773193
Epoch: 2, Steps: 10 | Train Loss: 3.195 Vali Loss: 3.314 Vali Acc: 0.047 Test Loss: 3.314 Test Acc: 0.047
Validation loss decreased (-0.027026 --> -0.047026).  Saving model ...
Epoch: 3 cost time: 0.8573365211486816
Epoch: 3, Steps: 10 | Train Loss: 2.998 Vali Loss: 3.328 Vali Acc: 0.072 Test Loss: 3.328 Test Acc: 0.072
Validation loss decreased (-0.047026 --> -0.071731).  Saving model ...
Epoch: 4 cost time: 0.7251741886138916
Epoch: 4, Steps: 10 | Train Loss: 2.845 Vali Loss: 3.305 Vali Acc: 0.092 Test Loss: 3.305 Test Acc: 0.092
Validation loss decreased (-0.071731 --> -0.091732).  Saving model ...
Epoch: 5 cost time: 0.7588202953338623
Epoch: 5, Steps: 10 | Train Loss: 2.594 Vali Loss: 3.252 Vali Acc: 0.101 Test Loss: 3.252 Test Acc: 0.101
Validation loss decreased (-0.091732 --> -0.101144).  Saving model ...
Epoch: 6 cost time: 0.7206346988677979
Epoch: 6, Steps: 10 | Train Loss: 2.454 Vali Loss: 3.196 Vali Acc: 0.134 Test Loss: 3.196 Test Acc: 0.134
Validation loss decreased (-0.101144 --> -0.134086).  Saving model ...
Epoch: 7 cost time: 0.7107203006744385
Epoch: 7, Steps: 10 | Train Loss: 2.141 Vali Loss: 3.143 Vali Acc: 0.160 Test Loss: 3.143 Test Acc: 0.160
Validation loss decreased (-0.134086 --> -0.159969).  Saving model ...
Epoch: 8 cost time: 0.6527364253997803
Epoch: 8, Steps: 10 | Train Loss: 1.878 Vali Loss: 3.126 Vali Acc: 0.178 Test Loss: 3.126 Test Acc: 0.178
Validation loss decreased (-0.159969 --> -0.177616).  Saving model ...
Epoch: 9 cost time: 0.8079049587249756
Epoch: 9, Steps: 10 | Train Loss: 1.568 Vali Loss: 3.097 Vali Acc: 0.195 Test Loss: 3.097 Test Acc: 0.195
Validation loss decreased (-0.177616 --> -0.195263).  Saving model ...
Epoch: 10 cost time: 0.8237285614013672
Epoch: 10, Steps: 10 | Train Loss: 1.327 Vali Loss: 3.085 Vali Acc: 0.221 Test Loss: 3.085 Test Acc: 0.221
Validation loss decreased (-0.195263 --> -0.221146).  Saving model ...
Epoch: 11 cost time: 0.8486356735229492
Epoch: 11, Steps: 10 | Train Loss: 1.076 Vali Loss: 3.085 Vali Acc: 0.236 Test Loss: 3.085 Test Acc: 0.236
Validation loss decreased (-0.221146 --> -0.236440).  Saving model ...
Epoch: 12 cost time: 0.8336541652679443
Epoch: 12, Steps: 10 | Train Loss: 0.860 Vali Loss: 3.069 Vali Acc: 0.255 Test Loss: 3.069 Test Acc: 0.255
Validation loss decreased (-0.236440 --> -0.255263).  Saving model ...
Epoch: 13 cost time: 0.8036561012268066
Epoch: 13, Steps: 10 | Train Loss: 0.684 Vali Loss: 3.035 Vali Acc: 0.281 Test Loss: 3.035 Test Acc: 0.281
Validation loss decreased (-0.255263 --> -0.281146).  Saving model ...
Epoch: 14 cost time: 0.8040263652801514
Epoch: 14, Steps: 10 | Train Loss: 0.435 Vali Loss: 3.086 Vali Acc: 0.284 Test Loss: 3.086 Test Acc: 0.284
Validation loss decreased (-0.281146 --> -0.283499).  Saving model ...
Epoch: 15 cost time: 0.6027486324310303
Epoch: 15, Steps: 10 | Train Loss: 0.424 Vali Loss: 3.109 Vali Acc: 0.293 Test Loss: 3.109 Test Acc: 0.293
Validation loss decreased (-0.283499 --> -0.292910).  Saving model ...
Epoch: 16 cost time: 0.7428138256072998
Epoch: 16, Steps: 10 | Train Loss: 0.255 Vali Loss: 3.122 Vali Acc: 0.312 Test Loss: 3.122 Test Acc: 0.312
Validation loss decreased (-0.292910 --> -0.311733).  Saving model ...
Epoch: 17 cost time: 0.691312313079834
Epoch: 17, Steps: 10 | Train Loss: 0.222 Vali Loss: 3.140 Vali Acc: 0.314 Test Loss: 3.140 Test Acc: 0.314
Validation loss decreased (-0.311733 --> -0.314086).  Saving model ...
Epoch: 18 cost time: 0.718041181564331
Epoch: 18, Steps: 10 | Train Loss: 0.267 Vali Loss: 3.131 Vali Acc: 0.305 Test Loss: 3.131 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7625939846038818
Epoch: 19, Steps: 10 | Train Loss: 0.152 Vali Loss: 3.211 Vali Acc: 0.305 Test Loss: 3.211 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8134219646453857
Epoch: 20, Steps: 10 | Train Loss: 0.091 Vali Loss: 3.266 Vali Acc: 0.315 Test Loss: 3.266 Test Acc: 0.315
Validation loss decreased (-0.314086 --> -0.315261).  Saving model ...
Epoch: 21 cost time: 0.884601354598999
Epoch: 21, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.239 Vali Acc: 0.327 Test Loss: 3.239 Test Acc: 0.327
Validation loss decreased (-0.315261 --> -0.327026).  Saving model ...
Epoch: 22 cost time: 0.842994213104248
Epoch: 22, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.246 Vali Acc: 0.339 Test Loss: 3.246 Test Acc: 0.339
Validation loss decreased (-0.327026 --> -0.338791).  Saving model ...
Epoch: 23 cost time: 0.8346903324127197
Epoch: 23, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.275 Vali Acc: 0.336 Test Loss: 3.275 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8471739292144775
Epoch: 24, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.292 Vali Acc: 0.338 Test Loss: 3.292 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8516232967376709
Epoch: 25, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.314 Vali Acc: 0.327 Test Loss: 3.314 Test Acc: 0.327
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8207664489746094
Epoch: 26, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.325 Vali Acc: 0.338 Test Loss: 3.325 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.7841758728027344
Epoch: 27, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.372 Vali Acc: 0.329 Test Loss: 3.372 Test Acc: 0.329
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.7962136268615723
Epoch: 28, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.355 Vali Acc: 0.336 Test Loss: 3.355 Test Acc: 0.336
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.7643296718597412
Epoch: 29, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.383 Vali Acc: 0.342 Test Loss: 3.383 Test Acc: 0.342
Validation loss decreased (-0.338791 --> -0.342319).  Saving model ...
Epoch: 30 cost time: 0.7467606067657471
Epoch: 30, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.436 Vali Acc: 0.331 Test Loss: 3.436 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3423529411764706
model parameter : 643834
model size : 3.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.1658236980438232
Epoch: 1, Steps: 10 | Train Loss: 3.328 Vali Loss: 3.306 Vali Acc: 0.045 Test Loss: 3.306 Test Acc: 0.045
Validation loss decreased (inf --> -0.044673).  Saving model ...
Epoch: 2 cost time: 1.669480562210083
Epoch: 2, Steps: 10 | Train Loss: 3.220 Vali Loss: 3.268 Vali Acc: 0.049 Test Loss: 3.268 Test Acc: 0.049
Validation loss decreased (-0.044673 --> -0.049379).  Saving model ...
Epoch: 3 cost time: 1.7430627346038818
Epoch: 3, Steps: 10 | Train Loss: 3.080 Vali Loss: 3.255 Vali Acc: 0.079 Test Loss: 3.255 Test Acc: 0.079
Validation loss decreased (-0.049379 --> -0.078791).  Saving model ...
Epoch: 4 cost time: 1.4674105644226074
Epoch: 4, Steps: 10 | Train Loss: 2.896 Vali Loss: 3.243 Vali Acc: 0.099 Test Loss: 3.243 Test Acc: 0.099
Validation loss decreased (-0.078791 --> -0.098791).  Saving model ...
Epoch: 5 cost time: 1.417639970779419
Epoch: 5, Steps: 10 | Train Loss: 2.645 Vali Loss: 3.221 Vali Acc: 0.129 Test Loss: 3.221 Test Acc: 0.129
Validation loss decreased (-0.098791 --> -0.129380).  Saving model ...
Epoch: 6 cost time: 1.4046614170074463
Epoch: 6, Steps: 10 | Train Loss: 2.498 Vali Loss: 3.183 Vali Acc: 0.140 Test Loss: 3.183 Test Acc: 0.140
Validation loss decreased (-0.129380 --> -0.139968).  Saving model ...
Epoch: 7 cost time: 1.7038536071777344
Epoch: 7, Steps: 10 | Train Loss: 2.223 Vali Loss: 3.130 Vali Acc: 0.147 Test Loss: 3.130 Test Acc: 0.147
Validation loss decreased (-0.139968 --> -0.147028).  Saving model ...
Epoch: 8 cost time: 1.7076525688171387
Epoch: 8, Steps: 10 | Train Loss: 1.959 Vali Loss: 3.110 Vali Acc: 0.174 Test Loss: 3.110 Test Acc: 0.174
Validation loss decreased (-0.147028 --> -0.174087).  Saving model ...
Epoch: 9 cost time: 1.815410852432251
Epoch: 9, Steps: 10 | Train Loss: 1.723 Vali Loss: 3.083 Vali Acc: 0.184 Test Loss: 3.083 Test Acc: 0.184
Validation loss decreased (-0.174087 --> -0.183499).  Saving model ...
Epoch: 10 cost time: 1.6591932773590088
Epoch: 10, Steps: 10 | Train Loss: 1.518 Vali Loss: 3.041 Vali Acc: 0.199 Test Loss: 3.041 Test Acc: 0.199
Validation loss decreased (-0.183499 --> -0.198793).  Saving model ...
Epoch: 11 cost time: 1.4355978965759277
Epoch: 11, Steps: 10 | Train Loss: 1.185 Vali Loss: 3.020 Vali Acc: 0.202 Test Loss: 3.020 Test Acc: 0.202
Validation loss decreased (-0.198793 --> -0.202323).  Saving model ...
Epoch: 12 cost time: 1.405909538269043
Epoch: 12, Steps: 10 | Train Loss: 0.980 Vali Loss: 2.995 Vali Acc: 0.226 Test Loss: 2.995 Test Acc: 0.226
Validation loss decreased (-0.202323 --> -0.225852).  Saving model ...
Epoch: 13 cost time: 1.4047508239746094
Epoch: 13, Steps: 10 | Train Loss: 0.862 Vali Loss: 2.976 Vali Acc: 0.242 Test Loss: 2.976 Test Acc: 0.242
Validation loss decreased (-0.225852 --> -0.242323).  Saving model ...
Epoch: 14 cost time: 1.5782787799835205
Epoch: 14, Steps: 10 | Train Loss: 0.700 Vali Loss: 2.999 Vali Acc: 0.258 Test Loss: 2.999 Test Acc: 0.258
Validation loss decreased (-0.242323 --> -0.257617).  Saving model ...
Epoch: 15 cost time: 1.6603758335113525
Epoch: 15, Steps: 10 | Train Loss: 0.545 Vali Loss: 2.934 Vali Acc: 0.260 Test Loss: 2.934 Test Acc: 0.260
Validation loss decreased (-0.257617 --> -0.259971).  Saving model ...
Epoch: 16 cost time: 1.5751140117645264
Epoch: 16, Steps: 10 | Train Loss: 0.408 Vali Loss: 2.932 Vali Acc: 0.276 Test Loss: 2.932 Test Acc: 0.276
Validation loss decreased (-0.259971 --> -0.276441).  Saving model ...
Epoch: 17 cost time: 1.5363621711730957
Epoch: 17, Steps: 10 | Train Loss: 0.357 Vali Loss: 2.954 Vali Acc: 0.282 Test Loss: 2.954 Test Acc: 0.282
Validation loss decreased (-0.276441 --> -0.282323).  Saving model ...
Epoch: 18 cost time: 1.5670337677001953
Epoch: 18, Steps: 10 | Train Loss: 0.256 Vali Loss: 2.928 Vali Acc: 0.294 Test Loss: 2.928 Test Acc: 0.294
Validation loss decreased (-0.282323 --> -0.294088).  Saving model ...
Epoch: 19 cost time: 1.3986263275146484
Epoch: 19, Steps: 10 | Train Loss: 0.197 Vali Loss: 2.943 Vali Acc: 0.282 Test Loss: 2.943 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2527055740356445
Epoch: 20, Steps: 10 | Train Loss: 0.182 Vali Loss: 2.923 Vali Acc: 0.289 Test Loss: 2.923 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2396748065948486
Epoch: 21, Steps: 10 | Train Loss: 0.090 Vali Loss: 2.975 Vali Acc: 0.298 Test Loss: 2.975 Test Acc: 0.298
Validation loss decreased (-0.294088 --> -0.297617).  Saving model ...
Epoch: 22 cost time: 1.5464565753936768
Epoch: 22, Steps: 10 | Train Loss: 0.088 Vali Loss: 2.997 Vali Acc: 0.301 Test Loss: 2.997 Test Acc: 0.301
Validation loss decreased (-0.297617 --> -0.301146).  Saving model ...
Epoch: 23 cost time: 1.5622680187225342
Epoch: 23, Steps: 10 | Train Loss: 0.108 Vali Loss: 2.997 Vali Acc: 0.307 Test Loss: 2.997 Test Acc: 0.307
Validation loss decreased (-0.301146 --> -0.307029).  Saving model ...
Epoch: 24 cost time: 1.570160150527954
Epoch: 24, Steps: 10 | Train Loss: 0.063 Vali Loss: 3.000 Vali Acc: 0.312 Test Loss: 3.000 Test Acc: 0.312
Validation loss decreased (-0.307029 --> -0.311735).  Saving model ...
Epoch: 25 cost time: 1.627920389175415
Epoch: 25, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.008 Vali Acc: 0.315 Test Loss: 3.008 Test Acc: 0.315
Validation loss decreased (-0.311735 --> -0.315264).  Saving model ...
Epoch: 26 cost time: 1.644836664199829
Epoch: 26, Steps: 10 | Train Loss: 0.039 Vali Loss: 2.962 Vali Acc: 0.312 Test Loss: 2.962 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.4049649238586426
Epoch: 27, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.042 Vali Acc: 0.318 Test Loss: 3.042 Test Acc: 0.318
Validation loss decreased (-0.315264 --> -0.317617).  Saving model ...
Epoch: 28 cost time: 1.149050235748291
Epoch: 28, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.038 Vali Acc: 0.318 Test Loss: 3.038 Test Acc: 0.318
Validation loss decreased (-0.317617 --> -0.317617).  Saving model ...
Epoch: 29 cost time: 1.3225600719451904
Epoch: 29, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.040 Vali Acc: 0.319 Test Loss: 3.040 Test Acc: 0.319
Validation loss decreased (-0.317617 --> -0.318793).  Saving model ...
Epoch: 30 cost time: 1.3194918632507324
Epoch: 30, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.027 Vali Acc: 0.318 Test Loss: 3.027 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.31882352941176473
model parameter : 1822122
model size : 7.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.302884101867676
Epoch: 1, Steps: 10 | Train Loss: 3.336 Vali Loss: 3.304 Vali Acc: 0.035 Test Loss: 3.304 Test Acc: 0.035
Validation loss decreased (inf --> -0.035261).  Saving model ...
Epoch: 2 cost time: 0.9805588722229004
Epoch: 2, Steps: 10 | Train Loss: 3.282 Vali Loss: 3.278 Vali Acc: 0.047 Test Loss: 3.278 Test Acc: 0.047
Validation loss decreased (-0.035261 --> -0.047026).  Saving model ...
Epoch: 3 cost time: 0.8551144599914551
Epoch: 3, Steps: 10 | Train Loss: 3.095 Vali Loss: 3.263 Vali Acc: 0.071 Test Loss: 3.263 Test Acc: 0.071
Validation loss decreased (-0.047026 --> -0.070556).  Saving model ...
Epoch: 4 cost time: 1.2421834468841553
Epoch: 4, Steps: 10 | Train Loss: 2.960 Vali Loss: 3.259 Vali Acc: 0.085 Test Loss: 3.259 Test Acc: 0.085
Validation loss decreased (-0.070556 --> -0.084673).  Saving model ...
Epoch: 5 cost time: 1.242870569229126
Epoch: 5, Steps: 10 | Train Loss: 2.754 Vali Loss: 3.237 Vali Acc: 0.100 Test Loss: 3.237 Test Acc: 0.100
Validation loss decreased (-0.084673 --> -0.099968).  Saving model ...
Epoch: 6 cost time: 1.300673484802246
Epoch: 6, Steps: 10 | Train Loss: 2.613 Vali Loss: 3.196 Vali Acc: 0.115 Test Loss: 3.196 Test Acc: 0.115
Validation loss decreased (-0.099968 --> -0.115262).  Saving model ...
Epoch: 7 cost time: 1.2786271572113037
Epoch: 7, Steps: 10 | Train Loss: 2.391 Vali Loss: 3.147 Vali Acc: 0.139 Test Loss: 3.147 Test Acc: 0.139
Validation loss decreased (-0.115262 --> -0.138792).  Saving model ...
Epoch: 8 cost time: 1.2151954174041748
Epoch: 8, Steps: 10 | Train Loss: 2.186 Vali Loss: 3.104 Vali Acc: 0.158 Test Loss: 3.104 Test Acc: 0.158
Validation loss decreased (-0.138792 --> -0.157616).  Saving model ...
Epoch: 9 cost time: 1.2536771297454834
Epoch: 9, Steps: 10 | Train Loss: 1.924 Vali Loss: 3.054 Vali Acc: 0.176 Test Loss: 3.054 Test Acc: 0.176
Validation loss decreased (-0.157616 --> -0.176440).  Saving model ...
Epoch: 10 cost time: 1.1439831256866455
Epoch: 10, Steps: 10 | Train Loss: 1.694 Vali Loss: 3.001 Vali Acc: 0.195 Test Loss: 3.001 Test Acc: 0.195
Validation loss decreased (-0.176440 --> -0.195264).  Saving model ...
Epoch: 11 cost time: 1.1697311401367188
Epoch: 11, Steps: 10 | Train Loss: 1.447 Vali Loss: 2.993 Vali Acc: 0.221 Test Loss: 2.993 Test Acc: 0.221
Validation loss decreased (-0.195264 --> -0.221147).  Saving model ...
Epoch: 12 cost time: 0.9469468593597412
Epoch: 12, Steps: 10 | Train Loss: 1.300 Vali Loss: 2.958 Vali Acc: 0.214 Test Loss: 2.958 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2295186519622803
Epoch: 13, Steps: 10 | Train Loss: 1.104 Vali Loss: 2.986 Vali Acc: 0.221 Test Loss: 2.986 Test Acc: 0.221
Validation loss decreased (-0.221147 --> -0.221147).  Saving model ...
Epoch: 14 cost time: 1.1810860633850098
Epoch: 14, Steps: 10 | Train Loss: 0.832 Vali Loss: 2.966 Vali Acc: 0.234 Test Loss: 2.966 Test Acc: 0.234
Validation loss decreased (-0.221147 --> -0.234088).  Saving model ...
Epoch: 15 cost time: 1.2632982730865479
Epoch: 15, Steps: 10 | Train Loss: 0.725 Vali Loss: 2.947 Vali Acc: 0.247 Test Loss: 2.947 Test Acc: 0.247
Validation loss decreased (-0.234088 --> -0.247029).  Saving model ...
Epoch: 16 cost time: 1.304180383682251
Epoch: 16, Steps: 10 | Train Loss: 0.538 Vali Loss: 2.963 Vali Acc: 0.251 Test Loss: 2.963 Test Acc: 0.251
Validation loss decreased (-0.247029 --> -0.250559).  Saving model ...
Epoch: 17 cost time: 1.3356428146362305
Epoch: 17, Steps: 10 | Train Loss: 0.507 Vali Loss: 2.979 Vali Acc: 0.261 Test Loss: 2.979 Test Acc: 0.261
Validation loss decreased (-0.250559 --> -0.261147).  Saving model ...
Epoch: 18 cost time: 1.2958033084869385
Epoch: 18, Steps: 10 | Train Loss: 0.388 Vali Loss: 2.979 Vali Acc: 0.274 Test Loss: 2.979 Test Acc: 0.274
Validation loss decreased (-0.261147 --> -0.274088).  Saving model ...
Epoch: 19 cost time: 1.4271631240844727
Epoch: 19, Steps: 10 | Train Loss: 0.274 Vali Loss: 2.953 Vali Acc: 0.269 Test Loss: 2.953 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4289348125457764
Epoch: 20, Steps: 10 | Train Loss: 0.265 Vali Loss: 2.976 Vali Acc: 0.289 Test Loss: 2.976 Test Acc: 0.289
Validation loss decreased (-0.274088 --> -0.289382).  Saving model ...
Epoch: 21 cost time: 1.2427630424499512
Epoch: 21, Steps: 10 | Train Loss: 0.167 Vali Loss: 3.046 Vali Acc: 0.274 Test Loss: 3.046 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3058280944824219
Epoch: 22, Steps: 10 | Train Loss: 0.135 Vali Loss: 3.020 Vali Acc: 0.278 Test Loss: 3.020 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.3570013046264648
Epoch: 23, Steps: 10 | Train Loss: 0.134 Vali Loss: 3.010 Vali Acc: 0.287 Test Loss: 3.010 Test Acc: 0.287
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2569859027862549
Epoch: 24, Steps: 10 | Train Loss: 0.121 Vali Loss: 3.067 Vali Acc: 0.294 Test Loss: 3.067 Test Acc: 0.294
Validation loss decreased (-0.289382 --> -0.294087).  Saving model ...
Epoch: 25 cost time: 1.434098482131958
Epoch: 25, Steps: 10 | Train Loss: 0.124 Vali Loss: 3.083 Vali Acc: 0.286 Test Loss: 3.083 Test Acc: 0.286
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4543132781982422
Epoch: 26, Steps: 10 | Train Loss: 0.112 Vali Loss: 3.026 Vali Acc: 0.296 Test Loss: 3.026 Test Acc: 0.296
Validation loss decreased (-0.294087 --> -0.296440).  Saving model ...
Epoch: 27 cost time: 1.3298523426055908
Epoch: 27, Steps: 10 | Train Loss: 0.076 Vali Loss: 3.033 Vali Acc: 0.304 Test Loss: 3.033 Test Acc: 0.304
Validation loss decreased (-0.296440 --> -0.303499).  Saving model ...
Epoch: 28 cost time: 1.4190027713775635
Epoch: 28, Steps: 10 | Train Loss: 0.067 Vali Loss: 3.076 Vali Acc: 0.304 Test Loss: 3.076 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.4635975360870361
Epoch: 29, Steps: 10 | Train Loss: 0.063 Vali Loss: 3.127 Vali Acc: 0.296 Test Loss: 3.127 Test Acc: 0.296
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.4681205749511719
Epoch: 30, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.107 Vali Acc: 0.300 Test Loss: 3.107 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3035294117647059
model parameter : 580554
model size : 2.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.1711208820343018
Epoch: 1, Steps: 10 | Train Loss: 3.330 Vali Loss: 3.306 Vali Acc: 0.041 Test Loss: 3.306 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 1.5259740352630615
Epoch: 2, Steps: 10 | Train Loss: 3.239 Vali Loss: 3.273 Vali Acc: 0.049 Test Loss: 3.273 Test Acc: 0.049
Validation loss decreased (-0.041143 --> -0.049379).  Saving model ...
Epoch: 3 cost time: 1.495086431503296
Epoch: 3, Steps: 10 | Train Loss: 3.100 Vali Loss: 3.263 Vali Acc: 0.059 Test Loss: 3.263 Test Acc: 0.059
Validation loss decreased (-0.049379 --> -0.058791).  Saving model ...
Epoch: 4 cost time: 1.567366361618042
Epoch: 4, Steps: 10 | Train Loss: 2.941 Vali Loss: 3.255 Vali Acc: 0.085 Test Loss: 3.255 Test Acc: 0.085
Validation loss decreased (-0.058791 --> -0.084673).  Saving model ...
Epoch: 5 cost time: 1.571465015411377
Epoch: 5, Steps: 10 | Train Loss: 2.742 Vali Loss: 3.235 Vali Acc: 0.109 Test Loss: 3.235 Test Acc: 0.109
Validation loss decreased (-0.084673 --> -0.109379).  Saving model ...
Epoch: 6 cost time: 1.4517014026641846
Epoch: 6, Steps: 10 | Train Loss: 2.579 Vali Loss: 3.194 Vali Acc: 0.127 Test Loss: 3.194 Test Acc: 0.127
Validation loss decreased (-0.109379 --> -0.127027).  Saving model ...
Epoch: 7 cost time: 1.4592723846435547
Epoch: 7, Steps: 10 | Train Loss: 2.357 Vali Loss: 3.143 Vali Acc: 0.135 Test Loss: 3.143 Test Acc: 0.135
Validation loss decreased (-0.127027 --> -0.135263).  Saving model ...
Epoch: 8 cost time: 1.4399254322052002
Epoch: 8, Steps: 10 | Train Loss: 2.197 Vali Loss: 3.129 Vali Acc: 0.158 Test Loss: 3.129 Test Acc: 0.158
Validation loss decreased (-0.135263 --> -0.157616).  Saving model ...
Epoch: 9 cost time: 1.2389168739318848
Epoch: 9, Steps: 10 | Train Loss: 1.980 Vali Loss: 3.064 Vali Acc: 0.173 Test Loss: 3.064 Test Acc: 0.173
Validation loss decreased (-0.157616 --> -0.172911).  Saving model ...
Epoch: 10 cost time: 1.2945075035095215
Epoch: 10, Steps: 10 | Train Loss: 1.694 Vali Loss: 3.023 Vali Acc: 0.194 Test Loss: 3.023 Test Acc: 0.194
Validation loss decreased (-0.172911 --> -0.194087).  Saving model ...
Epoch: 11 cost time: 1.2615954875946045
Epoch: 11, Steps: 10 | Train Loss: 1.403 Vali Loss: 2.980 Vali Acc: 0.212 Test Loss: 2.980 Test Acc: 0.212
Validation loss decreased (-0.194087 --> -0.211735).  Saving model ...
Epoch: 12 cost time: 1.2754795551300049
Epoch: 12, Steps: 10 | Train Loss: 1.215 Vali Loss: 2.985 Vali Acc: 0.222 Test Loss: 2.985 Test Acc: 0.222
Validation loss decreased (-0.211735 --> -0.222323).  Saving model ...
Epoch: 13 cost time: 1.4171044826507568
Epoch: 13, Steps: 10 | Train Loss: 1.059 Vali Loss: 2.959 Vali Acc: 0.228 Test Loss: 2.959 Test Acc: 0.228
Validation loss decreased (-0.222323 --> -0.228206).  Saving model ...
Epoch: 14 cost time: 1.4039015769958496
Epoch: 14, Steps: 10 | Train Loss: 0.853 Vali Loss: 2.938 Vali Acc: 0.258 Test Loss: 2.938 Test Acc: 0.258
Validation loss decreased (-0.228206 --> -0.257618).  Saving model ...
Epoch: 15 cost time: 1.3748831748962402
Epoch: 15, Steps: 10 | Train Loss: 0.698 Vali Loss: 2.928 Vali Acc: 0.265 Test Loss: 2.928 Test Acc: 0.265
Validation loss decreased (-0.257618 --> -0.264677).  Saving model ...
Epoch: 16 cost time: 1.3654160499572754
Epoch: 16, Steps: 10 | Train Loss: 0.532 Vali Loss: 2.881 Vali Acc: 0.295 Test Loss: 2.881 Test Acc: 0.295
Validation loss decreased (-0.264677 --> -0.295265).  Saving model ...
Epoch: 17 cost time: 1.3459937572479248
Epoch: 17, Steps: 10 | Train Loss: 0.456 Vali Loss: 2.869 Vali Acc: 0.306 Test Loss: 2.869 Test Acc: 0.306
Validation loss decreased (-0.295265 --> -0.305854).  Saving model ...
Epoch: 18 cost time: 1.4083051681518555
Epoch: 18, Steps: 10 | Train Loss: 0.338 Vali Loss: 2.881 Vali Acc: 0.313 Test Loss: 2.881 Test Acc: 0.313
Validation loss decreased (-0.305854 --> -0.312912).  Saving model ...
Epoch: 19 cost time: 1.3870322704315186
Epoch: 19, Steps: 10 | Train Loss: 0.402 Vali Loss: 2.839 Vali Acc: 0.313 Test Loss: 2.839 Test Acc: 0.313
Validation loss decreased (-0.312912 --> -0.312913).  Saving model ...
Epoch: 20 cost time: 1.1982038021087646
Epoch: 20, Steps: 10 | Train Loss: 0.249 Vali Loss: 2.906 Vali Acc: 0.320 Test Loss: 2.906 Test Acc: 0.320
Validation loss decreased (-0.312913 --> -0.319971).  Saving model ...
Epoch: 21 cost time: 1.2536447048187256
Epoch: 21, Steps: 10 | Train Loss: 0.175 Vali Loss: 2.864 Vali Acc: 0.331 Test Loss: 2.864 Test Acc: 0.331
Validation loss decreased (-0.319971 --> -0.330560).  Saving model ...
Epoch: 22 cost time: 0.9383444786071777
Epoch: 22, Steps: 10 | Train Loss: 0.145 Vali Loss: 2.917 Vali Acc: 0.334 Test Loss: 2.917 Test Acc: 0.334
Validation loss decreased (-0.330560 --> -0.334088).  Saving model ...
Epoch: 23 cost time: 1.277778148651123
Epoch: 23, Steps: 10 | Train Loss: 0.126 Vali Loss: 2.878 Vali Acc: 0.344 Test Loss: 2.878 Test Acc: 0.344
Validation loss decreased (-0.334088 --> -0.343501).  Saving model ...
Epoch: 24 cost time: 1.2071757316589355
Epoch: 24, Steps: 10 | Train Loss: 0.070 Vali Loss: 2.871 Vali Acc: 0.335 Test Loss: 2.871 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.39127516746521
Epoch: 25, Steps: 10 | Train Loss: 0.067 Vali Loss: 2.901 Vali Acc: 0.345 Test Loss: 2.901 Test Acc: 0.345
Validation loss decreased (-0.343501 --> -0.344677).  Saving model ...
Epoch: 26 cost time: 1.438249111175537
Epoch: 26, Steps: 10 | Train Loss: 0.060 Vali Loss: 2.881 Vali Acc: 0.346 Test Loss: 2.881 Test Acc: 0.346
Validation loss decreased (-0.344677 --> -0.345854).  Saving model ...
Epoch: 27 cost time: 1.338402271270752
Epoch: 27, Steps: 10 | Train Loss: 0.073 Vali Loss: 2.894 Vali Acc: 0.354 Test Loss: 2.894 Test Acc: 0.354
Validation loss decreased (-0.345854 --> -0.354089).  Saving model ...
Epoch: 28 cost time: 1.3366796970367432
Epoch: 28, Steps: 10 | Train Loss: 0.061 Vali Loss: 2.919 Vali Acc: 0.361 Test Loss: 2.919 Test Acc: 0.361
Validation loss decreased (-0.354089 --> -0.361147).  Saving model ...
Epoch: 29 cost time: 1.370457649230957
Epoch: 29, Steps: 10 | Train Loss: 0.040 Vali Loss: 2.932 Vali Acc: 0.358 Test Loss: 2.932 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3694195747375488
Epoch: 30, Steps: 10 | Train Loss: 0.057 Vali Loss: 2.944 Vali Acc: 0.365 Test Loss: 2.944 Test Acc: 0.365
Validation loss decreased (-0.361147 --> -0.364676).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.36470588235294116
model parameter : 1822122
model size : 7.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.468395471572876
Epoch: 1, Steps: 10 | Train Loss: 3.335 Vali Loss: 3.301 Vali Acc: 0.036 Test Loss: 3.301 Test Acc: 0.036
Validation loss decreased (inf --> -0.036438).  Saving model ...
Epoch: 2 cost time: 0.9791224002838135
Epoch: 2, Steps: 10 | Train Loss: 3.279 Vali Loss: 3.275 Vali Acc: 0.047 Test Loss: 3.275 Test Acc: 0.047
Validation loss decreased (-0.036438 --> -0.047026).  Saving model ...
Epoch: 3 cost time: 0.6948087215423584
Epoch: 3, Steps: 10 | Train Loss: 3.127 Vali Loss: 3.262 Vali Acc: 0.072 Test Loss: 3.262 Test Acc: 0.072
Validation loss decreased (-0.047026 --> -0.071732).  Saving model ...
Epoch: 4 cost time: 1.0612246990203857
Epoch: 4, Steps: 10 | Train Loss: 2.986 Vali Loss: 3.260 Vali Acc: 0.086 Test Loss: 3.260 Test Acc: 0.086
Validation loss decreased (-0.071732 --> -0.085850).  Saving model ...
Epoch: 5 cost time: 1.0544185638427734
Epoch: 5, Steps: 10 | Train Loss: 2.804 Vali Loss: 3.245 Vali Acc: 0.091 Test Loss: 3.245 Test Acc: 0.091
Validation loss decreased (-0.085850 --> -0.090556).  Saving model ...
Epoch: 6 cost time: 1.0835883617401123
Epoch: 6, Steps: 10 | Train Loss: 2.694 Vali Loss: 3.210 Vali Acc: 0.109 Test Loss: 3.210 Test Acc: 0.109
Validation loss decreased (-0.090556 --> -0.109380).  Saving model ...
Epoch: 7 cost time: 1.0461881160736084
Epoch: 7, Steps: 10 | Train Loss: 2.474 Vali Loss: 3.166 Vali Acc: 0.128 Test Loss: 3.166 Test Acc: 0.128
Validation loss decreased (-0.109380 --> -0.128204).  Saving model ...
Epoch: 8 cost time: 1.094665288925171
Epoch: 8, Steps: 10 | Train Loss: 2.282 Vali Loss: 3.127 Vali Acc: 0.147 Test Loss: 3.127 Test Acc: 0.147
Validation loss decreased (-0.128204 --> -0.147028).  Saving model ...
Epoch: 9 cost time: 1.0757677555084229
Epoch: 9, Steps: 10 | Train Loss: 2.055 Vali Loss: 3.095 Vali Acc: 0.172 Test Loss: 3.095 Test Acc: 0.172
Validation loss decreased (-0.147028 --> -0.171734).  Saving model ...
Epoch: 10 cost time: 1.1081855297088623
Epoch: 10, Steps: 10 | Train Loss: 1.881 Vali Loss: 3.047 Vali Acc: 0.194 Test Loss: 3.047 Test Acc: 0.194
Validation loss decreased (-0.171734 --> -0.194087).  Saving model ...
Epoch: 11 cost time: 1.0320281982421875
Epoch: 11, Steps: 10 | Train Loss: 1.656 Vali Loss: 3.040 Vali Acc: 0.212 Test Loss: 3.040 Test Acc: 0.212
Validation loss decreased (-0.194087 --> -0.211734).  Saving model ...
Epoch: 12 cost time: 1.0020370483398438
Epoch: 12, Steps: 10 | Train Loss: 1.495 Vali Loss: 3.010 Vali Acc: 0.215 Test Loss: 3.010 Test Acc: 0.215
Validation loss decreased (-0.211734 --> -0.215264).  Saving model ...
Epoch: 13 cost time: 0.9827132225036621
Epoch: 13, Steps: 10 | Train Loss: 1.277 Vali Loss: 2.990 Vali Acc: 0.222 Test Loss: 2.990 Test Acc: 0.222
Validation loss decreased (-0.215264 --> -0.222323).  Saving model ...
Epoch: 14 cost time: 0.9770269393920898
Epoch: 14, Steps: 10 | Train Loss: 0.999 Vali Loss: 2.976 Vali Acc: 0.233 Test Loss: 2.976 Test Acc: 0.233
Validation loss decreased (-0.222323 --> -0.232911).  Saving model ...
Epoch: 15 cost time: 0.9777810573577881
Epoch: 15, Steps: 10 | Train Loss: 0.925 Vali Loss: 2.953 Vali Acc: 0.241 Test Loss: 2.953 Test Acc: 0.241
Validation loss decreased (-0.232911 --> -0.241147).  Saving model ...
Epoch: 16 cost time: 1.0975897312164307
Epoch: 16, Steps: 10 | Train Loss: 0.775 Vali Loss: 2.988 Vali Acc: 0.269 Test Loss: 2.988 Test Acc: 0.269
Validation loss decreased (-0.241147 --> -0.269382).  Saving model ...
Epoch: 17 cost time: 1.0800633430480957
Epoch: 17, Steps: 10 | Train Loss: 0.723 Vali Loss: 2.983 Vali Acc: 0.255 Test Loss: 2.983 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1050004959106445
Epoch: 18, Steps: 10 | Train Loss: 0.510 Vali Loss: 2.994 Vali Acc: 0.285 Test Loss: 2.994 Test Acc: 0.285
Validation loss decreased (-0.269382 --> -0.284676).  Saving model ...
Epoch: 19 cost time: 1.069150686264038
Epoch: 19, Steps: 10 | Train Loss: 0.624 Vali Loss: 2.977 Vali Acc: 0.262 Test Loss: 2.977 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0317955017089844
Epoch: 20, Steps: 10 | Train Loss: 0.406 Vali Loss: 3.035 Vali Acc: 0.265 Test Loss: 3.035 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0778908729553223
Epoch: 21, Steps: 10 | Train Loss: 0.360 Vali Loss: 3.032 Vali Acc: 0.281 Test Loss: 3.032 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0387897491455078
Epoch: 22, Steps: 10 | Train Loss: 0.219 Vali Loss: 3.047 Vali Acc: 0.282 Test Loss: 3.047 Test Acc: 0.282
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.0224950313568115
Epoch: 23, Steps: 10 | Train Loss: 0.223 Vali Loss: 3.005 Vali Acc: 0.302 Test Loss: 3.005 Test Acc: 0.302
Validation loss decreased (-0.284676 --> -0.302323).  Saving model ...
Epoch: 24 cost time: 0.9589850902557373
Epoch: 24, Steps: 10 | Train Loss: 0.170 Vali Loss: 3.014 Vali Acc: 0.292 Test Loss: 3.014 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9794962406158447
Epoch: 25, Steps: 10 | Train Loss: 0.141 Vali Loss: 3.197 Vali Acc: 0.285 Test Loss: 3.197 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9508781433105469
Epoch: 26, Steps: 10 | Train Loss: 0.133 Vali Loss: 3.079 Vali Acc: 0.276 Test Loss: 3.079 Test Acc: 0.276
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8268423080444336
Epoch: 27, Steps: 10 | Train Loss: 0.154 Vali Loss: 3.163 Vali Acc: 0.300 Test Loss: 3.163 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.037600040435791
Epoch: 28, Steps: 10 | Train Loss: 0.101 Vali Loss: 3.061 Vali Acc: 0.313 Test Loss: 3.061 Test Acc: 0.313
Validation loss decreased (-0.302323 --> -0.312911).  Saving model ...
Epoch: 29 cost time: 1.0486087799072266
Epoch: 29, Steps: 10 | Train Loss: 0.086 Vali Loss: 3.107 Vali Acc: 0.305 Test Loss: 3.107 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0613114833831787
Epoch: 30, Steps: 10 | Train Loss: 0.073 Vali Loss: 3.071 Vali Acc: 0.316 Test Loss: 3.071 Test Acc: 0.316
Validation loss decreased (-0.312911 --> -0.316440).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3164705882352941
model parameter : 580554
model size : 2.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.6802618503570557
Epoch: 1, Steps: 10 | Train Loss: 3.326 Vali Loss: 3.313 Vali Acc: 0.042 Test Loss: 3.313 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 1.1100523471832275
Epoch: 2, Steps: 10 | Train Loss: 3.255 Vali Loss: 3.284 Vali Acc: 0.042 Test Loss: 3.284 Test Acc: 0.042
Validation loss decreased (-0.042320 --> -0.042320).  Saving model ...
Epoch: 3 cost time: 1.051274061203003
Epoch: 3, Steps: 10 | Train Loss: 3.132 Vali Loss: 3.282 Vali Acc: 0.039 Test Loss: 3.282 Test Acc: 0.039
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0532987117767334
Epoch: 4, Steps: 10 | Train Loss: 3.010 Vali Loss: 3.282 Vali Acc: 0.072 Test Loss: 3.282 Test Acc: 0.072
Validation loss decreased (-0.042320 --> -0.071732).  Saving model ...
Epoch: 5 cost time: 0.7522382736206055
Epoch: 5, Steps: 10 | Train Loss: 2.829 Vali Loss: 3.271 Vali Acc: 0.088 Test Loss: 3.271 Test Acc: 0.088
Validation loss decreased (-0.071732 --> -0.088203).  Saving model ...
Epoch: 6 cost time: 1.0007355213165283
Epoch: 6, Steps: 10 | Train Loss: 2.739 Vali Loss: 3.240 Vali Acc: 0.111 Test Loss: 3.240 Test Acc: 0.111
Validation loss decreased (-0.088203 --> -0.110556).  Saving model ...
Epoch: 7 cost time: 1.0077600479125977
Epoch: 7, Steps: 10 | Train Loss: 2.562 Vali Loss: 3.201 Vali Acc: 0.128 Test Loss: 3.201 Test Acc: 0.128
Validation loss decreased (-0.110556 --> -0.128203).  Saving model ...
Epoch: 8 cost time: 1.0336627960205078
Epoch: 8, Steps: 10 | Train Loss: 2.387 Vali Loss: 3.190 Vali Acc: 0.125 Test Loss: 3.190 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0559983253479004
Epoch: 9, Steps: 10 | Train Loss: 2.216 Vali Loss: 3.141 Vali Acc: 0.142 Test Loss: 3.141 Test Acc: 0.142
Validation loss decreased (-0.128203 --> -0.142322).  Saving model ...
Epoch: 10 cost time: 1.026167631149292
Epoch: 10, Steps: 10 | Train Loss: 2.042 Vali Loss: 3.093 Vali Acc: 0.185 Test Loss: 3.093 Test Acc: 0.185
Validation loss decreased (-0.142322 --> -0.184675).  Saving model ...
Epoch: 11 cost time: 1.0486364364624023
Epoch: 11, Steps: 10 | Train Loss: 1.745 Vali Loss: 3.083 Vali Acc: 0.192 Test Loss: 3.083 Test Acc: 0.192
Validation loss decreased (-0.184675 --> -0.191734).  Saving model ...
Epoch: 12 cost time: 1.0271580219268799
Epoch: 12, Steps: 10 | Train Loss: 1.563 Vali Loss: 3.043 Vali Acc: 0.213 Test Loss: 3.043 Test Acc: 0.213
Validation loss decreased (-0.191734 --> -0.212911).  Saving model ...
Epoch: 13 cost time: 1.0253510475158691
Epoch: 13, Steps: 10 | Train Loss: 1.306 Vali Loss: 3.013 Vali Acc: 0.232 Test Loss: 3.013 Test Acc: 0.232
Validation loss decreased (-0.212911 --> -0.231735).  Saving model ...
Epoch: 14 cost time: 1.0090341567993164
Epoch: 14, Steps: 10 | Train Loss: 1.169 Vali Loss: 2.980 Vali Acc: 0.231 Test Loss: 2.980 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9606928825378418
Epoch: 15, Steps: 10 | Train Loss: 0.987 Vali Loss: 2.967 Vali Acc: 0.245 Test Loss: 2.967 Test Acc: 0.245
Validation loss decreased (-0.231735 --> -0.244676).  Saving model ...
Epoch: 16 cost time: 0.9417016506195068
Epoch: 16, Steps: 10 | Train Loss: 0.846 Vali Loss: 2.933 Vali Acc: 0.269 Test Loss: 2.933 Test Acc: 0.269
Validation loss decreased (-0.244676 --> -0.269382).  Saving model ...
Epoch: 17 cost time: 0.889892578125
Epoch: 17, Steps: 10 | Train Loss: 0.727 Vali Loss: 2.902 Vali Acc: 0.291 Test Loss: 2.902 Test Acc: 0.291
Validation loss decreased (-0.269382 --> -0.290559).  Saving model ...
Epoch: 18 cost time: 0.8919308185577393
Epoch: 18, Steps: 10 | Train Loss: 0.639 Vali Loss: 2.966 Vali Acc: 0.301 Test Loss: 2.966 Test Acc: 0.301
Validation loss decreased (-0.290559 --> -0.301147).  Saving model ...
Epoch: 19 cost time: 0.875706672668457
Epoch: 19, Steps: 10 | Train Loss: 0.436 Vali Loss: 2.882 Vali Acc: 0.295 Test Loss: 2.882 Test Acc: 0.295
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9958803653717041
Epoch: 20, Steps: 10 | Train Loss: 0.368 Vali Loss: 2.893 Vali Acc: 0.321 Test Loss: 2.893 Test Acc: 0.321
Validation loss decreased (-0.301147 --> -0.321148).  Saving model ...
Epoch: 21 cost time: 0.9876875877380371
Epoch: 21, Steps: 10 | Train Loss: 0.298 Vali Loss: 2.932 Vali Acc: 0.307 Test Loss: 2.932 Test Acc: 0.307
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.033458948135376
Epoch: 22, Steps: 10 | Train Loss: 0.286 Vali Loss: 2.931 Vali Acc: 0.306 Test Loss: 2.931 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0411298274993896
Epoch: 23, Steps: 10 | Train Loss: 0.238 Vali Loss: 2.896 Vali Acc: 0.321 Test Loss: 2.896 Test Acc: 0.321
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.0307817459106445
Epoch: 24, Steps: 10 | Train Loss: 0.185 Vali Loss: 2.853 Vali Acc: 0.338 Test Loss: 2.853 Test Acc: 0.338
Validation loss decreased (-0.321148 --> -0.337619).  Saving model ...
Epoch: 25 cost time: 1.064643383026123
Epoch: 25, Steps: 10 | Train Loss: 0.122 Vali Loss: 2.865 Vali Acc: 0.342 Test Loss: 2.865 Test Acc: 0.342
Validation loss decreased (-0.337619 --> -0.342324).  Saving model ...
Epoch: 26 cost time: 1.040560007095337
Epoch: 26, Steps: 10 | Train Loss: 0.116 Vali Loss: 2.872 Vali Acc: 0.334 Test Loss: 2.872 Test Acc: 0.334
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0845870971679688
Epoch: 27, Steps: 10 | Train Loss: 0.096 Vali Loss: 2.909 Vali Acc: 0.342 Test Loss: 2.909 Test Acc: 0.342
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.1352722644805908
Epoch: 28, Steps: 10 | Train Loss: 0.113 Vali Loss: 2.915 Vali Acc: 0.348 Test Loss: 2.915 Test Acc: 0.348
Validation loss decreased (-0.342324 --> -0.348206).  Saving model ...
Epoch: 29 cost time: 0.8453755378723145
Epoch: 29, Steps: 10 | Train Loss: 0.084 Vali Loss: 2.918 Vali Acc: 0.351 Test Loss: 2.918 Test Acc: 0.351
Validation loss decreased (-0.348206 --> -0.350559).  Saving model ...
Epoch: 30 cost time: 1.0330286026000977
Epoch: 30, Steps: 10 | Train Loss: 0.063 Vali Loss: 2.980 Vali Acc: 0.335 Test Loss: 2.980 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.35058823529411764
model parameter : 1822122
model size : 7.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.9317312240600586
Epoch: 1, Steps: 10 | Train Loss: 3.346 Vali Loss: 3.304 Vali Acc: 0.036 Test Loss: 3.304 Test Acc: 0.036
Validation loss decreased (inf --> -0.036438).  Saving model ...
Epoch: 2 cost time: 0.9333024024963379
Epoch: 2, Steps: 10 | Train Loss: 3.280 Vali Loss: 3.280 Vali Acc: 0.044 Test Loss: 3.280 Test Acc: 0.044
Validation loss decreased (-0.036438 --> -0.043497).  Saving model ...
Epoch: 3 cost time: 0.8659307956695557
Epoch: 3, Steps: 10 | Train Loss: 3.140 Vali Loss: 3.270 Vali Acc: 0.059 Test Loss: 3.270 Test Acc: 0.059
Validation loss decreased (-0.043497 --> -0.058791).  Saving model ...
Epoch: 4 cost time: 0.8602607250213623
Epoch: 4, Steps: 10 | Train Loss: 3.027 Vali Loss: 3.272 Vali Acc: 0.079 Test Loss: 3.272 Test Acc: 0.079
Validation loss decreased (-0.058791 --> -0.078791).  Saving model ...
Epoch: 5 cost time: 0.8638949394226074
Epoch: 5, Steps: 10 | Train Loss: 2.875 Vali Loss: 3.262 Vali Acc: 0.084 Test Loss: 3.262 Test Acc: 0.084
Validation loss decreased (-0.078791 --> -0.083497).  Saving model ...
Epoch: 6 cost time: 0.931804895401001
Epoch: 6, Steps: 10 | Train Loss: 2.729 Vali Loss: 3.229 Vali Acc: 0.089 Test Loss: 3.229 Test Acc: 0.089
Validation loss decreased (-0.083497 --> -0.089379).  Saving model ...
Epoch: 7 cost time: 0.9227607250213623
Epoch: 7, Steps: 10 | Train Loss: 2.580 Vali Loss: 3.188 Vali Acc: 0.111 Test Loss: 3.188 Test Acc: 0.111
Validation loss decreased (-0.089379 --> -0.110556).  Saving model ...
Epoch: 8 cost time: 0.9356288909912109
Epoch: 8, Steps: 10 | Train Loss: 2.474 Vali Loss: 3.157 Vali Acc: 0.116 Test Loss: 3.157 Test Acc: 0.116
Validation loss decreased (-0.110556 --> -0.116439).  Saving model ...
Epoch: 9 cost time: 0.8685195446014404
Epoch: 9, Steps: 10 | Train Loss: 2.283 Vali Loss: 3.127 Vali Acc: 0.136 Test Loss: 3.127 Test Acc: 0.136
Validation loss decreased (-0.116439 --> -0.136439).  Saving model ...
Epoch: 10 cost time: 0.6582715511322021
Epoch: 10, Steps: 10 | Train Loss: 2.085 Vali Loss: 3.085 Vali Acc: 0.168 Test Loss: 3.085 Test Acc: 0.168
Validation loss decreased (-0.136439 --> -0.168204).  Saving model ...
Epoch: 11 cost time: 0.8652634620666504
Epoch: 11, Steps: 10 | Train Loss: 1.914 Vali Loss: 3.075 Vali Acc: 0.172 Test Loss: 3.075 Test Acc: 0.172
Validation loss decreased (-0.168204 --> -0.171734).  Saving model ...
Epoch: 12 cost time: 0.8223199844360352
Epoch: 12, Steps: 10 | Train Loss: 1.694 Vali Loss: 3.054 Vali Acc: 0.179 Test Loss: 3.054 Test Acc: 0.179
Validation loss decreased (-0.171734 --> -0.178793).  Saving model ...
Epoch: 13 cost time: 0.8353850841522217
Epoch: 13, Steps: 10 | Train Loss: 1.589 Vali Loss: 3.067 Vali Acc: 0.182 Test Loss: 3.067 Test Acc: 0.182
Validation loss decreased (-0.178793 --> -0.182322).  Saving model ...
Epoch: 14 cost time: 0.8068752288818359
Epoch: 14, Steps: 10 | Train Loss: 1.287 Vali Loss: 3.029 Vali Acc: 0.205 Test Loss: 3.029 Test Acc: 0.205
Validation loss decreased (-0.182322 --> -0.204676).  Saving model ...
Epoch: 15 cost time: 0.8185431957244873
Epoch: 15, Steps: 10 | Train Loss: 1.206 Vali Loss: 3.026 Vali Acc: 0.227 Test Loss: 3.026 Test Acc: 0.227
Validation loss decreased (-0.204676 --> -0.227029).  Saving model ...
Epoch: 16 cost time: 0.8461012840270996
Epoch: 16, Steps: 10 | Train Loss: 1.022 Vali Loss: 3.026 Vali Acc: 0.234 Test Loss: 3.026 Test Acc: 0.234
Validation loss decreased (-0.227029 --> -0.234087).  Saving model ...
Epoch: 17 cost time: 0.9360947608947754
Epoch: 17, Steps: 10 | Train Loss: 0.907 Vali Loss: 3.027 Vali Acc: 0.247 Test Loss: 3.027 Test Acc: 0.247
Validation loss decreased (-0.234087 --> -0.247029).  Saving model ...
Epoch: 18 cost time: 0.876446008682251
Epoch: 18, Steps: 10 | Train Loss: 0.733 Vali Loss: 3.066 Vali Acc: 0.253 Test Loss: 3.066 Test Acc: 0.253
Validation loss decreased (-0.247029 --> -0.252911).  Saving model ...
Epoch: 19 cost time: 0.8937005996704102
Epoch: 19, Steps: 10 | Train Loss: 0.670 Vali Loss: 3.003 Vali Acc: 0.259 Test Loss: 3.003 Test Acc: 0.259
Validation loss decreased (-0.252911 --> -0.258793).  Saving model ...
Epoch: 20 cost time: 0.9098496437072754
Epoch: 20, Steps: 10 | Train Loss: 0.548 Vali Loss: 3.085 Vali Acc: 0.266 Test Loss: 3.085 Test Acc: 0.266
Validation loss decreased (-0.258793 --> -0.265852).  Saving model ...
Epoch: 21 cost time: 0.9154486656188965
Epoch: 21, Steps: 10 | Train Loss: 0.415 Vali Loss: 3.052 Vali Acc: 0.280 Test Loss: 3.052 Test Acc: 0.280
Validation loss decreased (-0.265852 --> -0.279969).  Saving model ...
Epoch: 22 cost time: 0.8911442756652832
Epoch: 22, Steps: 10 | Train Loss: 0.332 Vali Loss: 3.085 Vali Acc: 0.281 Test Loss: 3.085 Test Acc: 0.281
Validation loss decreased (-0.279969 --> -0.281146).  Saving model ...
Epoch: 23 cost time: 0.9664995670318604
Epoch: 23, Steps: 10 | Train Loss: 0.290 Vali Loss: 3.153 Vali Acc: 0.287 Test Loss: 3.153 Test Acc: 0.287
Validation loss decreased (-0.281146 --> -0.287027).  Saving model ...
Epoch: 24 cost time: 0.8899192810058594
Epoch: 24, Steps: 10 | Train Loss: 0.266 Vali Loss: 3.102 Vali Acc: 0.278 Test Loss: 3.102 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8074703216552734
Epoch: 25, Steps: 10 | Train Loss: 0.235 Vali Loss: 3.290 Vali Acc: 0.280 Test Loss: 3.290 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8119010925292969
Epoch: 26, Steps: 10 | Train Loss: 0.177 Vali Loss: 3.120 Vali Acc: 0.294 Test Loss: 3.120 Test Acc: 0.294
Validation loss decreased (-0.287027 --> -0.294086).  Saving model ...
Epoch: 27 cost time: 0.7835783958435059
Epoch: 27, Steps: 10 | Train Loss: 0.165 Vali Loss: 3.154 Vali Acc: 0.305 Test Loss: 3.154 Test Acc: 0.305
Validation loss decreased (-0.294086 --> -0.304674).  Saving model ...
Epoch: 28 cost time: 0.7617459297180176
Epoch: 28, Steps: 10 | Train Loss: 0.131 Vali Loss: 3.139 Vali Acc: 0.324 Test Loss: 3.139 Test Acc: 0.324
Validation loss decreased (-0.304674 --> -0.323498).  Saving model ...
Epoch: 29 cost time: 0.7827091217041016
Epoch: 29, Steps: 10 | Train Loss: 0.118 Vali Loss: 3.200 Vali Acc: 0.319 Test Loss: 3.200 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6336045265197754
Epoch: 30, Steps: 10 | Train Loss: 0.107 Vali Loss: 3.189 Vali Acc: 0.320 Test Loss: 3.189 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3235294117647059
model parameter : 580554
model size : 2.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.3875539302825928
Epoch: 1, Steps: 10 | Train Loss: 3.328 Vali Loss: 3.297 Vali Acc: 0.038 Test Loss: 3.297 Test Acc: 0.038
Validation loss decreased (inf --> -0.037614).  Saving model ...
Epoch: 2 cost time: 1.0694572925567627
Epoch: 2, Steps: 10 | Train Loss: 3.253 Vali Loss: 3.275 Vali Acc: 0.038 Test Loss: 3.275 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 3 cost time: 1.013098955154419
Epoch: 3, Steps: 10 | Train Loss: 3.087 Vali Loss: 3.266 Vali Acc: 0.054 Test Loss: 3.266 Test Acc: 0.054
Validation loss decreased (-0.037614 --> -0.054085).  Saving model ...
Epoch: 4 cost time: 1.091712236404419
Epoch: 4, Steps: 10 | Train Loss: 2.979 Vali Loss: 3.257 Vali Acc: 0.087 Test Loss: 3.257 Test Acc: 0.087
Validation loss decreased (-0.054085 --> -0.087026).  Saving model ...
Epoch: 5 cost time: 1.3925909996032715
Epoch: 5, Steps: 10 | Train Loss: 2.763 Vali Loss: 3.219 Vali Acc: 0.113 Test Loss: 3.219 Test Acc: 0.113
Validation loss decreased (-0.087026 --> -0.112909).  Saving model ...
Epoch: 6 cost time: 1.492539405822754
Epoch: 6, Steps: 10 | Train Loss: 2.581 Vali Loss: 3.182 Vali Acc: 0.127 Test Loss: 3.182 Test Acc: 0.127
Validation loss decreased (-0.112909 --> -0.127027).  Saving model ...
Epoch: 7 cost time: 1.354515790939331
Epoch: 7, Steps: 10 | Train Loss: 2.375 Vali Loss: 3.141 Vali Acc: 0.154 Test Loss: 3.141 Test Acc: 0.154
Validation loss decreased (-0.127027 --> -0.154086).  Saving model ...
Epoch: 8 cost time: 1.2447564601898193
Epoch: 8, Steps: 10 | Train Loss: 2.174 Vali Loss: 3.106 Vali Acc: 0.161 Test Loss: 3.106 Test Acc: 0.161
Validation loss decreased (-0.154086 --> -0.161145).  Saving model ...
Epoch: 9 cost time: 1.1906542778015137
Epoch: 9, Steps: 10 | Train Loss: 1.885 Vali Loss: 3.067 Vali Acc: 0.161 Test Loss: 3.067 Test Acc: 0.161
Validation loss decreased (-0.161145 --> -0.161146).  Saving model ...
Epoch: 10 cost time: 1.018550157546997
Epoch: 10, Steps: 10 | Train Loss: 1.643 Vali Loss: 3.011 Vali Acc: 0.195 Test Loss: 3.011 Test Acc: 0.195
Validation loss decreased (-0.161146 --> -0.195264).  Saving model ...
Epoch: 11 cost time: 1.3956708908081055
Epoch: 11, Steps: 10 | Train Loss: 1.381 Vali Loss: 2.980 Vali Acc: 0.208 Test Loss: 2.980 Test Acc: 0.208
Validation loss decreased (-0.195264 --> -0.208205).  Saving model ...
Epoch: 12 cost time: 1.4032013416290283
Epoch: 12, Steps: 10 | Train Loss: 1.163 Vali Loss: 2.975 Vali Acc: 0.207 Test Loss: 2.975 Test Acc: 0.207
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4122729301452637
Epoch: 13, Steps: 10 | Train Loss: 0.955 Vali Loss: 2.982 Vali Acc: 0.220 Test Loss: 2.982 Test Acc: 0.220
Validation loss decreased (-0.208205 --> -0.219970).  Saving model ...
Epoch: 14 cost time: 1.3442184925079346
Epoch: 14, Steps: 10 | Train Loss: 0.786 Vali Loss: 2.931 Vali Acc: 0.255 Test Loss: 2.931 Test Acc: 0.255
Validation loss decreased (-0.219970 --> -0.255265).  Saving model ...
Epoch: 15 cost time: 1.207892894744873
Epoch: 15, Steps: 10 | Train Loss: 0.639 Vali Loss: 2.989 Vali Acc: 0.242 Test Loss: 2.989 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3389503955841064
Epoch: 16, Steps: 10 | Train Loss: 0.524 Vali Loss: 2.940 Vali Acc: 0.254 Test Loss: 2.940 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3903231620788574
Epoch: 17, Steps: 10 | Train Loss: 0.419 Vali Loss: 2.961 Vali Acc: 0.262 Test Loss: 2.961 Test Acc: 0.262
Validation loss decreased (-0.255265 --> -0.262323).  Saving model ...
Epoch: 18 cost time: 1.3300912380218506
Epoch: 18, Steps: 10 | Train Loss: 0.293 Vali Loss: 2.987 Vali Acc: 0.265 Test Loss: 2.987 Test Acc: 0.265
Validation loss decreased (-0.262323 --> -0.264676).  Saving model ...
Epoch: 19 cost time: 1.3335490226745605
Epoch: 19, Steps: 10 | Train Loss: 0.234 Vali Loss: 2.963 Vali Acc: 0.286 Test Loss: 2.963 Test Acc: 0.286
Validation loss decreased (-0.264676 --> -0.285853).  Saving model ...
Epoch: 20 cost time: 1.294595718383789
Epoch: 20, Steps: 10 | Train Loss: 0.171 Vali Loss: 2.985 Vali Acc: 0.280 Test Loss: 2.985 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1942789554595947
Epoch: 21, Steps: 10 | Train Loss: 0.154 Vali Loss: 3.038 Vali Acc: 0.282 Test Loss: 3.038 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.375232219696045
Epoch: 22, Steps: 10 | Train Loss: 0.103 Vali Loss: 3.003 Vali Acc: 0.291 Test Loss: 3.003 Test Acc: 0.291
Validation loss decreased (-0.285853 --> -0.290558).  Saving model ...
Epoch: 23 cost time: 1.4281530380249023
Epoch: 23, Steps: 10 | Train Loss: 0.092 Vali Loss: 3.011 Vali Acc: 0.295 Test Loss: 3.011 Test Acc: 0.295
Validation loss decreased (-0.290558 --> -0.295264).  Saving model ...
Epoch: 24 cost time: 1.499328374862671
Epoch: 24, Steps: 10 | Train Loss: 0.074 Vali Loss: 3.005 Vali Acc: 0.295 Test Loss: 3.005 Test Acc: 0.295
Validation loss decreased (-0.295264 --> -0.295264).  Saving model ...
Epoch: 25 cost time: 1.4723467826843262
Epoch: 25, Steps: 10 | Train Loss: 0.069 Vali Loss: 3.009 Vali Acc: 0.298 Test Loss: 3.009 Test Acc: 0.298
Validation loss decreased (-0.295264 --> -0.297617).  Saving model ...
Epoch: 26 cost time: 1.2779247760772705
Epoch: 26, Steps: 10 | Train Loss: 0.074 Vali Loss: 3.016 Vali Acc: 0.300 Test Loss: 3.016 Test Acc: 0.300
Validation loss decreased (-0.297617 --> -0.299970).  Saving model ...
Epoch: 27 cost time: 1.2019267082214355
Epoch: 27, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.038 Vali Acc: 0.288 Test Loss: 3.038 Test Acc: 0.288
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4405720233917236
Epoch: 28, Steps: 10 | Train Loss: 0.063 Vali Loss: 3.051 Vali Acc: 0.296 Test Loss: 3.051 Test Acc: 0.296
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.3479259014129639
Epoch: 29, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.141 Vali Acc: 0.305 Test Loss: 3.141 Test Acc: 0.305
Validation loss decreased (-0.299970 --> -0.304674).  Saving model ...
Epoch: 30 cost time: 1.5194201469421387
Epoch: 30, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.090 Vali Acc: 0.305 Test Loss: 3.090 Test Acc: 0.305
Validation loss decreased (-0.304674 --> -0.304675).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.30470588235294116
model parameter : 942954
model size : 3.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.4334797859191895
Epoch: 1, Steps: 10 | Train Loss: 3.343 Vali Loss: 3.315 Vali Acc: 0.042 Test Loss: 3.315 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 1.1222939491271973
Epoch: 2, Steps: 10 | Train Loss: 3.262 Vali Loss: 3.297 Vali Acc: 0.041 Test Loss: 3.297 Test Acc: 0.041
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1084895133972168
Epoch: 3, Steps: 10 | Train Loss: 3.137 Vali Loss: 3.295 Vali Acc: 0.051 Test Loss: 3.295 Test Acc: 0.051
Validation loss decreased (-0.042320 --> -0.050555).  Saving model ...
Epoch: 4 cost time: 1.187211275100708
Epoch: 4, Steps: 10 | Train Loss: 3.041 Vali Loss: 3.297 Vali Acc: 0.051 Test Loss: 3.297 Test Acc: 0.051
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9527838230133057
Epoch: 5, Steps: 10 | Train Loss: 2.920 Vali Loss: 3.287 Vali Acc: 0.078 Test Loss: 3.287 Test Acc: 0.078
Validation loss decreased (-0.050555 --> -0.077614).  Saving model ...
Epoch: 6 cost time: 0.9493513107299805
Epoch: 6, Steps: 10 | Train Loss: 2.764 Vali Loss: 3.254 Vali Acc: 0.105 Test Loss: 3.254 Test Acc: 0.105
Validation loss decreased (-0.077614 --> -0.104673).  Saving model ...
Epoch: 7 cost time: 1.008594036102295
Epoch: 7, Steps: 10 | Train Loss: 2.595 Vali Loss: 3.223 Vali Acc: 0.119 Test Loss: 3.223 Test Acc: 0.119
Validation loss decreased (-0.104673 --> -0.118791).  Saving model ...
Epoch: 8 cost time: 1.0917632579803467
Epoch: 8, Steps: 10 | Train Loss: 2.405 Vali Loss: 3.173 Vali Acc: 0.141 Test Loss: 3.173 Test Acc: 0.141
Validation loss decreased (-0.118791 --> -0.141145).  Saving model ...
Epoch: 9 cost time: 1.136486291885376
Epoch: 9, Steps: 10 | Train Loss: 2.182 Vali Loss: 3.128 Vali Acc: 0.164 Test Loss: 3.128 Test Acc: 0.164
Validation loss decreased (-0.141145 --> -0.163498).  Saving model ...
Epoch: 10 cost time: 1.1864123344421387
Epoch: 10, Steps: 10 | Train Loss: 1.989 Vali Loss: 3.083 Vali Acc: 0.191 Test Loss: 3.083 Test Acc: 0.191
Validation loss decreased (-0.163498 --> -0.190557).  Saving model ...
Epoch: 11 cost time: 1.1415891647338867
Epoch: 11, Steps: 10 | Train Loss: 1.755 Vali Loss: 3.072 Vali Acc: 0.187 Test Loss: 3.072 Test Acc: 0.187
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0449793338775635
Epoch: 12, Steps: 10 | Train Loss: 1.521 Vali Loss: 3.040 Vali Acc: 0.207 Test Loss: 3.040 Test Acc: 0.207
Validation loss decreased (-0.190557 --> -0.207028).  Saving model ...
Epoch: 13 cost time: 0.8782687187194824
Epoch: 13, Steps: 10 | Train Loss: 1.294 Vali Loss: 2.997 Vali Acc: 0.219 Test Loss: 2.997 Test Acc: 0.219
Validation loss decreased (-0.207028 --> -0.218794).  Saving model ...
Epoch: 14 cost time: 1.0469865798950195
Epoch: 14, Steps: 10 | Train Loss: 1.161 Vali Loss: 2.998 Vali Acc: 0.202 Test Loss: 2.998 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1336677074432373
Epoch: 15, Steps: 10 | Train Loss: 0.938 Vali Loss: 2.982 Vali Acc: 0.240 Test Loss: 2.982 Test Acc: 0.240
Validation loss decreased (-0.218794 --> -0.239970).  Saving model ...
Epoch: 16 cost time: 1.1200206279754639
Epoch: 16, Steps: 10 | Train Loss: 0.791 Vali Loss: 2.953 Vali Acc: 0.253 Test Loss: 2.953 Test Acc: 0.253
Validation loss decreased (-0.239970 --> -0.252912).  Saving model ...
Epoch: 17 cost time: 1.1980631351470947
Epoch: 17, Steps: 10 | Train Loss: 0.585 Vali Loss: 2.985 Vali Acc: 0.253 Test Loss: 2.985 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1529827117919922
Epoch: 18, Steps: 10 | Train Loss: 0.475 Vali Loss: 3.006 Vali Acc: 0.260 Test Loss: 3.006 Test Acc: 0.260
Validation loss decreased (-0.252912 --> -0.259970).  Saving model ...
Epoch: 19 cost time: 1.0128693580627441
Epoch: 19, Steps: 10 | Train Loss: 0.376 Vali Loss: 3.019 Vali Acc: 0.262 Test Loss: 3.019 Test Acc: 0.262
Validation loss decreased (-0.259970 --> -0.262323).  Saving model ...
Epoch: 20 cost time: 0.9644839763641357
Epoch: 20, Steps: 10 | Train Loss: 0.282 Vali Loss: 3.089 Vali Acc: 0.268 Test Loss: 3.089 Test Acc: 0.268
Validation loss decreased (-0.262323 --> -0.268204).  Saving model ...
Epoch: 21 cost time: 0.9889712333679199
Epoch: 21, Steps: 10 | Train Loss: 0.245 Vali Loss: 3.042 Vali Acc: 0.282 Test Loss: 3.042 Test Acc: 0.282
Validation loss decreased (-0.268204 --> -0.282323).  Saving model ...
Epoch: 22 cost time: 1.1019670963287354
Epoch: 22, Steps: 10 | Train Loss: 0.212 Vali Loss: 3.108 Vali Acc: 0.269 Test Loss: 3.108 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1444618701934814
Epoch: 23, Steps: 10 | Train Loss: 0.197 Vali Loss: 3.054 Vali Acc: 0.289 Test Loss: 3.054 Test Acc: 0.289
Validation loss decreased (-0.282323 --> -0.289381).  Saving model ...
Epoch: 24 cost time: 1.1702942848205566
Epoch: 24, Steps: 10 | Train Loss: 0.169 Vali Loss: 3.058 Vali Acc: 0.286 Test Loss: 3.058 Test Acc: 0.286
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1594724655151367
Epoch: 25, Steps: 10 | Train Loss: 0.114 Vali Loss: 3.126 Vali Acc: 0.286 Test Loss: 3.126 Test Acc: 0.286
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9722352027893066
Epoch: 26, Steps: 10 | Train Loss: 0.139 Vali Loss: 3.095 Vali Acc: 0.300 Test Loss: 3.095 Test Acc: 0.300
Validation loss decreased (-0.289381 --> -0.299969).  Saving model ...
Epoch: 27 cost time: 1.0347011089324951
Epoch: 27, Steps: 10 | Train Loss: 0.088 Vali Loss: 3.159 Vali Acc: 0.285 Test Loss: 3.159 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8781793117523193
Epoch: 28, Steps: 10 | Train Loss: 0.092 Vali Loss: 3.171 Vali Acc: 0.305 Test Loss: 3.171 Test Acc: 0.305
Validation loss decreased (-0.299969 --> -0.304674).  Saving model ...
Epoch: 29 cost time: 1.1270499229431152
Epoch: 29, Steps: 10 | Train Loss: 0.112 Vali Loss: 3.132 Vali Acc: 0.308 Test Loss: 3.132 Test Acc: 0.308
Validation loss decreased (-0.304674 --> -0.308204).  Saving model ...
Epoch: 30 cost time: 1.106978178024292
Epoch: 30, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.253 Vali Acc: 0.287 Test Loss: 3.253 Test Acc: 0.287
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.30823529411764705
model parameter : 322122
model size : 1.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.5037784576416016
Epoch: 1, Steps: 10 | Train Loss: 3.329 Vali Loss: 3.296 Vali Acc: 0.038 Test Loss: 3.296 Test Acc: 0.038
Validation loss decreased (inf --> -0.037614).  Saving model ...
Epoch: 2 cost time: 1.142249584197998
Epoch: 2, Steps: 10 | Train Loss: 3.255 Vali Loss: 3.276 Vali Acc: 0.034 Test Loss: 3.276 Test Acc: 0.034
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1600685119628906
Epoch: 3, Steps: 10 | Train Loss: 3.096 Vali Loss: 3.269 Vali Acc: 0.058 Test Loss: 3.269 Test Acc: 0.058
Validation loss decreased (-0.037614 --> -0.057614).  Saving model ...
Epoch: 4 cost time: 1.138970136642456
Epoch: 4, Steps: 10 | Train Loss: 2.996 Vali Loss: 3.262 Vali Acc: 0.084 Test Loss: 3.262 Test Acc: 0.084
Validation loss decreased (-0.057614 --> -0.083497).  Saving model ...
Epoch: 5 cost time: 1.131998062133789
Epoch: 5, Steps: 10 | Train Loss: 2.796 Vali Loss: 3.224 Vali Acc: 0.106 Test Loss: 3.224 Test Acc: 0.106
Validation loss decreased (-0.083497 --> -0.105850).  Saving model ...
Epoch: 6 cost time: 1.1822106838226318
Epoch: 6, Steps: 10 | Train Loss: 2.617 Vali Loss: 3.191 Vali Acc: 0.131 Test Loss: 3.191 Test Acc: 0.131
Validation loss decreased (-0.105850 --> -0.130556).  Saving model ...
Epoch: 7 cost time: 1.1202208995819092
Epoch: 7, Steps: 10 | Train Loss: 2.432 Vali Loss: 3.158 Vali Acc: 0.155 Test Loss: 3.158 Test Acc: 0.155
Validation loss decreased (-0.130556 --> -0.155263).  Saving model ...
Epoch: 8 cost time: 0.9732248783111572
Epoch: 8, Steps: 10 | Train Loss: 2.204 Vali Loss: 3.130 Vali Acc: 0.171 Test Loss: 3.130 Test Acc: 0.171
Validation loss decreased (-0.155263 --> -0.170557).  Saving model ...
Epoch: 9 cost time: 0.881995439529419
Epoch: 9, Steps: 10 | Train Loss: 2.003 Vali Loss: 3.099 Vali Acc: 0.182 Test Loss: 3.099 Test Acc: 0.182
Validation loss decreased (-0.170557 --> -0.182322).  Saving model ...
Epoch: 10 cost time: 1.1304752826690674
Epoch: 10, Steps: 10 | Train Loss: 1.763 Vali Loss: 3.046 Vali Acc: 0.207 Test Loss: 3.046 Test Acc: 0.207
Validation loss decreased (-0.182322 --> -0.207028).  Saving model ...
Epoch: 11 cost time: 1.209810495376587
Epoch: 11, Steps: 10 | Train Loss: 1.478 Vali Loss: 3.009 Vali Acc: 0.218 Test Loss: 3.009 Test Acc: 0.218
Validation loss decreased (-0.207028 --> -0.217617).  Saving model ...
Epoch: 12 cost time: 1.128727912902832
Epoch: 12, Steps: 10 | Train Loss: 1.238 Vali Loss: 3.017 Vali Acc: 0.215 Test Loss: 3.017 Test Acc: 0.215
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1138527393341064
Epoch: 13, Steps: 10 | Train Loss: 1.053 Vali Loss: 2.997 Vali Acc: 0.229 Test Loss: 2.997 Test Acc: 0.229
Validation loss decreased (-0.217617 --> -0.229382).  Saving model ...
Epoch: 14 cost time: 0.9589614868164062
Epoch: 14, Steps: 10 | Train Loss: 0.903 Vali Loss: 2.954 Vali Acc: 0.261 Test Loss: 2.954 Test Acc: 0.261
Validation loss decreased (-0.229382 --> -0.261147).  Saving model ...
Epoch: 15 cost time: 0.9367935657501221
Epoch: 15, Steps: 10 | Train Loss: 0.721 Vali Loss: 2.954 Vali Acc: 0.258 Test Loss: 2.954 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9420688152313232
Epoch: 16, Steps: 10 | Train Loss: 0.441 Vali Loss: 2.976 Vali Acc: 0.265 Test Loss: 2.976 Test Acc: 0.265
Validation loss decreased (-0.261147 --> -0.264676).  Saving model ...
Epoch: 17 cost time: 1.118398904800415
Epoch: 17, Steps: 10 | Train Loss: 0.371 Vali Loss: 2.972 Vali Acc: 0.284 Test Loss: 2.972 Test Acc: 0.284
Validation loss decreased (-0.264676 --> -0.283500).  Saving model ...
Epoch: 18 cost time: 1.1227483749389648
Epoch: 18, Steps: 10 | Train Loss: 0.374 Vali Loss: 2.962 Vali Acc: 0.292 Test Loss: 2.962 Test Acc: 0.292
Validation loss decreased (-0.283500 --> -0.291735).  Saving model ...
Epoch: 19 cost time: 1.1148219108581543
Epoch: 19, Steps: 10 | Train Loss: 0.278 Vali Loss: 2.970 Vali Acc: 0.295 Test Loss: 2.970 Test Acc: 0.295
Validation loss decreased (-0.291735 --> -0.295264).  Saving model ...
Epoch: 20 cost time: 1.1140470504760742
Epoch: 20, Steps: 10 | Train Loss: 0.334 Vali Loss: 3.048 Vali Acc: 0.289 Test Loss: 3.048 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9809489250183105
Epoch: 21, Steps: 10 | Train Loss: 0.226 Vali Loss: 2.984 Vali Acc: 0.302 Test Loss: 2.984 Test Acc: 0.302
Validation loss decreased (-0.295264 --> -0.302323).  Saving model ...
Epoch: 22 cost time: 0.9371297359466553
Epoch: 22, Steps: 10 | Train Loss: 0.184 Vali Loss: 3.020 Vali Acc: 0.305 Test Loss: 3.020 Test Acc: 0.305
Validation loss decreased (-0.302323 --> -0.304676).  Saving model ...
Epoch: 23 cost time: 0.9478855133056641
Epoch: 23, Steps: 10 | Train Loss: 0.203 Vali Loss: 3.036 Vali Acc: 0.319 Test Loss: 3.036 Test Acc: 0.319
Validation loss decreased (-0.304676 --> -0.318793).  Saving model ...
Epoch: 24 cost time: 1.1185572147369385
Epoch: 24, Steps: 10 | Train Loss: 0.114 Vali Loss: 2.985 Vali Acc: 0.319 Test Loss: 2.985 Test Acc: 0.319
Validation loss decreased (-0.318793 --> -0.318794).  Saving model ...
Epoch: 25 cost time: 1.0741546154022217
Epoch: 25, Steps: 10 | Train Loss: 0.101 Vali Loss: 2.988 Vali Acc: 0.322 Test Loss: 2.988 Test Acc: 0.322
Validation loss decreased (-0.318794 --> -0.322323).  Saving model ...
Epoch: 26 cost time: 1.076401948928833
Epoch: 26, Steps: 10 | Train Loss: 0.084 Vali Loss: 3.034 Vali Acc: 0.327 Test Loss: 3.034 Test Acc: 0.327
Validation loss decreased (-0.322323 --> -0.327028).  Saving model ...
Epoch: 27 cost time: 1.1370716094970703
Epoch: 27, Steps: 10 | Train Loss: 0.146 Vali Loss: 3.071 Vali Acc: 0.335 Test Loss: 3.071 Test Acc: 0.335
Validation loss decreased (-0.327028 --> -0.335263).  Saving model ...
Epoch: 28 cost time: 0.9509241580963135
Epoch: 28, Steps: 10 | Train Loss: 0.126 Vali Loss: 3.027 Vali Acc: 0.324 Test Loss: 3.027 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9802200794219971
Epoch: 29, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.115 Vali Acc: 0.334 Test Loss: 3.115 Test Acc: 0.334
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.0298066139221191
Epoch: 30, Steps: 10 | Train Loss: 0.043 Vali Loss: 3.070 Vali Acc: 0.319 Test Loss: 3.070 Test Acc: 0.319
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3352941176470588
model parameter : 942954
model size : 3.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.2371156215667725
Epoch: 1, Steps: 10 | Train Loss: 3.339 Vali Loss: 3.318 Vali Acc: 0.036 Test Loss: 3.318 Test Acc: 0.036
Validation loss decreased (inf --> -0.036437).  Saving model ...
Epoch: 2 cost time: 0.9932074546813965
Epoch: 2, Steps: 10 | Train Loss: 3.261 Vali Loss: 3.300 Vali Acc: 0.041 Test Loss: 3.300 Test Acc: 0.041
Validation loss decreased (-0.036437 --> -0.041143).  Saving model ...
Epoch: 3 cost time: 0.7392706871032715
Epoch: 3, Steps: 10 | Train Loss: 3.141 Vali Loss: 3.300 Vali Acc: 0.048 Test Loss: 3.300 Test Acc: 0.048
Validation loss decreased (-0.041143 --> -0.048202).  Saving model ...
Epoch: 4 cost time: 0.8907802104949951
Epoch: 4, Steps: 10 | Train Loss: 3.052 Vali Loss: 3.305 Vali Acc: 0.049 Test Loss: 3.305 Test Acc: 0.049
Validation loss decreased (-0.048202 --> -0.049379).  Saving model ...
Epoch: 5 cost time: 0.7553896903991699
Epoch: 5, Steps: 10 | Train Loss: 2.943 Vali Loss: 3.298 Vali Acc: 0.080 Test Loss: 3.298 Test Acc: 0.080
Validation loss decreased (-0.049379 --> -0.079967).  Saving model ...
Epoch: 6 cost time: 0.7659873962402344
Epoch: 6, Steps: 10 | Train Loss: 2.808 Vali Loss: 3.270 Vali Acc: 0.099 Test Loss: 3.270 Test Acc: 0.099
Validation loss decreased (-0.079967 --> -0.098791).  Saving model ...
Epoch: 7 cost time: 0.8642184734344482
Epoch: 7, Steps: 10 | Train Loss: 2.665 Vali Loss: 3.244 Vali Acc: 0.102 Test Loss: 3.244 Test Acc: 0.102
Validation loss decreased (-0.098791 --> -0.102321).  Saving model ...
Epoch: 8 cost time: 0.7065520286560059
Epoch: 8, Steps: 10 | Train Loss: 2.485 Vali Loss: 3.199 Vali Acc: 0.122 Test Loss: 3.199 Test Acc: 0.122
Validation loss decreased (-0.102321 --> -0.122321).  Saving model ...
Epoch: 9 cost time: 0.7876300811767578
Epoch: 9, Steps: 10 | Train Loss: 2.316 Vali Loss: 3.162 Vali Acc: 0.140 Test Loss: 3.162 Test Acc: 0.140
Validation loss decreased (-0.122321 --> -0.139968).  Saving model ...
Epoch: 10 cost time: 0.7044491767883301
Epoch: 10, Steps: 10 | Train Loss: 2.129 Vali Loss: 3.118 Vali Acc: 0.171 Test Loss: 3.118 Test Acc: 0.171
Validation loss decreased (-0.139968 --> -0.170557).  Saving model ...
Epoch: 11 cost time: 0.7288732528686523
Epoch: 11, Steps: 10 | Train Loss: 1.936 Vali Loss: 3.108 Vali Acc: 0.156 Test Loss: 3.108 Test Acc: 0.156
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7184195518493652
Epoch: 12, Steps: 10 | Train Loss: 1.723 Vali Loss: 3.091 Vali Acc: 0.184 Test Loss: 3.091 Test Acc: 0.184
Validation loss decreased (-0.170557 --> -0.183499).  Saving model ...
Epoch: 13 cost time: 0.7648067474365234
Epoch: 13, Steps: 10 | Train Loss: 1.555 Vali Loss: 3.061 Vali Acc: 0.199 Test Loss: 3.061 Test Acc: 0.199
Validation loss decreased (-0.183499 --> -0.198793).  Saving model ...
Epoch: 14 cost time: 0.6816275119781494
Epoch: 14, Steps: 10 | Train Loss: 1.377 Vali Loss: 3.040 Vali Acc: 0.191 Test Loss: 3.040 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0611190795898438
Epoch: 15, Steps: 10 | Train Loss: 1.246 Vali Loss: 3.089 Vali Acc: 0.204 Test Loss: 3.089 Test Acc: 0.204
Validation loss decreased (-0.198793 --> -0.203499).  Saving model ...
Epoch: 16 cost time: 1.0538291931152344
Epoch: 16, Steps: 10 | Train Loss: 1.040 Vali Loss: 2.980 Vali Acc: 0.240 Test Loss: 2.980 Test Acc: 0.240
Validation loss decreased (-0.203499 --> -0.239970).  Saving model ...
Epoch: 17 cost time: 1.0733880996704102
Epoch: 17, Steps: 10 | Train Loss: 0.865 Vali Loss: 3.057 Vali Acc: 0.238 Test Loss: 3.057 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0390958786010742
Epoch: 18, Steps: 10 | Train Loss: 0.714 Vali Loss: 2.977 Vali Acc: 0.241 Test Loss: 2.977 Test Acc: 0.241
Validation loss decreased (-0.239970 --> -0.241147).  Saving model ...
Epoch: 19 cost time: 0.8337869644165039
Epoch: 19, Steps: 10 | Train Loss: 0.598 Vali Loss: 2.972 Vali Acc: 0.266 Test Loss: 2.972 Test Acc: 0.266
Validation loss decreased (-0.241147 --> -0.265853).  Saving model ...
Epoch: 20 cost time: 0.9753539562225342
Epoch: 20, Steps: 10 | Train Loss: 0.477 Vali Loss: 3.175 Vali Acc: 0.255 Test Loss: 3.175 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8724820613861084
Epoch: 21, Steps: 10 | Train Loss: 0.374 Vali Loss: 3.011 Vali Acc: 0.295 Test Loss: 3.011 Test Acc: 0.295
Validation loss decreased (-0.265853 --> -0.295264).  Saving model ...
Epoch: 22 cost time: 0.9624896049499512
Epoch: 22, Steps: 10 | Train Loss: 0.317 Vali Loss: 3.042 Vali Acc: 0.295 Test Loss: 3.042 Test Acc: 0.295
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0114285945892334
Epoch: 23, Steps: 10 | Train Loss: 0.279 Vali Loss: 3.052 Vali Acc: 0.288 Test Loss: 3.052 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0093531608581543
Epoch: 24, Steps: 10 | Train Loss: 0.238 Vali Loss: 3.079 Vali Acc: 0.292 Test Loss: 3.079 Test Acc: 0.292
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0163702964782715
Epoch: 25, Steps: 10 | Train Loss: 0.149 Vali Loss: 3.088 Vali Acc: 0.309 Test Loss: 3.088 Test Acc: 0.309
Validation loss decreased (-0.295264 --> -0.309381).  Saving model ...
Epoch: 26 cost time: 1.001685619354248
Epoch: 26, Steps: 10 | Train Loss: 0.132 Vali Loss: 3.106 Vali Acc: 0.308 Test Loss: 3.106 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8656878471374512
Epoch: 27, Steps: 10 | Train Loss: 0.131 Vali Loss: 3.188 Vali Acc: 0.304 Test Loss: 3.188 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9706056118011475
Epoch: 28, Steps: 10 | Train Loss: 0.128 Vali Loss: 3.093 Vali Acc: 0.311 Test Loss: 3.093 Test Acc: 0.311
Validation loss decreased (-0.309381 --> -0.310557).  Saving model ...
Epoch: 29 cost time: 0.9419689178466797
Epoch: 29, Steps: 10 | Train Loss: 0.112 Vali Loss: 3.175 Vali Acc: 0.305 Test Loss: 3.175 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0413422584533691
Epoch: 30, Steps: 10 | Train Loss: 0.083 Vali Loss: 3.142 Vali Acc: 0.305 Test Loss: 3.142 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.31058823529411766
model parameter : 322122
model size : 1.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.3422224521636963
Epoch: 1, Steps: 10 | Train Loss: 3.320 Vali Loss: 3.297 Vali Acc: 0.031 Test Loss: 3.297 Test Acc: 0.031
Validation loss decreased (inf --> -0.030555).  Saving model ...
Epoch: 2 cost time: 0.8827898502349854
Epoch: 2, Steps: 10 | Train Loss: 3.246 Vali Loss: 3.280 Vali Acc: 0.040 Test Loss: 3.280 Test Acc: 0.040
Validation loss decreased (-0.030555 --> -0.039967).  Saving model ...
Epoch: 3 cost time: 0.7601284980773926
Epoch: 3, Steps: 10 | Train Loss: 3.103 Vali Loss: 3.276 Vali Acc: 0.047 Test Loss: 3.276 Test Acc: 0.047
Validation loss decreased (-0.039967 --> -0.047026).  Saving model ...
Epoch: 4 cost time: 0.8217325210571289
Epoch: 4, Steps: 10 | Train Loss: 3.017 Vali Loss: 3.275 Vali Acc: 0.069 Test Loss: 3.275 Test Acc: 0.069
Validation loss decreased (-0.047026 --> -0.069379).  Saving model ...
Epoch: 5 cost time: 0.9461140632629395
Epoch: 5, Steps: 10 | Train Loss: 2.851 Vali Loss: 3.247 Vali Acc: 0.095 Test Loss: 3.247 Test Acc: 0.095
Validation loss decreased (-0.069379 --> -0.095262).  Saving model ...
Epoch: 6 cost time: 0.9166624546051025
Epoch: 6, Steps: 10 | Train Loss: 2.724 Vali Loss: 3.224 Vali Acc: 0.109 Test Loss: 3.224 Test Acc: 0.109
Validation loss decreased (-0.095262 --> -0.109380).  Saving model ...
Epoch: 7 cost time: 0.9790451526641846
Epoch: 7, Steps: 10 | Train Loss: 2.543 Vali Loss: 3.191 Vali Acc: 0.127 Test Loss: 3.191 Test Acc: 0.127
Validation loss decreased (-0.109380 --> -0.127027).  Saving model ...
Epoch: 8 cost time: 0.8937911987304688
Epoch: 8, Steps: 10 | Train Loss: 2.413 Vali Loss: 3.172 Vali Acc: 0.139 Test Loss: 3.172 Test Acc: 0.139
Validation loss decreased (-0.127027 --> -0.138792).  Saving model ...
Epoch: 9 cost time: 0.9211959838867188
Epoch: 9, Steps: 10 | Train Loss: 2.239 Vali Loss: 3.150 Vali Acc: 0.141 Test Loss: 3.150 Test Acc: 0.141
Validation loss decreased (-0.138792 --> -0.141145).  Saving model ...
Epoch: 10 cost time: 0.8573808670043945
Epoch: 10, Steps: 10 | Train Loss: 2.003 Vali Loss: 3.100 Vali Acc: 0.181 Test Loss: 3.100 Test Acc: 0.181
Validation loss decreased (-0.141145 --> -0.181145).  Saving model ...
Epoch: 11 cost time: 0.7536039352416992
Epoch: 11, Steps: 10 | Train Loss: 1.783 Vali Loss: 3.078 Vali Acc: 0.191 Test Loss: 3.078 Test Acc: 0.191
Validation loss decreased (-0.181145 --> -0.190557).  Saving model ...
Epoch: 12 cost time: 0.7793126106262207
Epoch: 12, Steps: 10 | Train Loss: 1.538 Vali Loss: 3.065 Vali Acc: 0.200 Test Loss: 3.065 Test Acc: 0.200
Validation loss decreased (-0.190557 --> -0.199969).  Saving model ...
Epoch: 13 cost time: 0.6989552974700928
Epoch: 13, Steps: 10 | Train Loss: 1.418 Vali Loss: 3.035 Vali Acc: 0.212 Test Loss: 3.035 Test Acc: 0.212
Validation loss decreased (-0.199969 --> -0.211734).  Saving model ...
Epoch: 14 cost time: 0.8731913566589355
Epoch: 14, Steps: 10 | Train Loss: 1.126 Vali Loss: 3.001 Vali Acc: 0.236 Test Loss: 3.001 Test Acc: 0.236
Validation loss decreased (-0.211734 --> -0.236441).  Saving model ...
Epoch: 15 cost time: 0.921677827835083
Epoch: 15, Steps: 10 | Train Loss: 0.913 Vali Loss: 2.984 Vali Acc: 0.234 Test Loss: 2.984 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8567023277282715
Epoch: 16, Steps: 10 | Train Loss: 0.816 Vali Loss: 3.016 Vali Acc: 0.245 Test Loss: 3.016 Test Acc: 0.245
Validation loss decreased (-0.236441 --> -0.244676).  Saving model ...
Epoch: 17 cost time: 0.8627517223358154
Epoch: 17, Steps: 10 | Train Loss: 0.690 Vali Loss: 3.018 Vali Acc: 0.259 Test Loss: 3.018 Test Acc: 0.259
Validation loss decreased (-0.244676 --> -0.258793).  Saving model ...
Epoch: 18 cost time: 0.7965347766876221
Epoch: 18, Steps: 10 | Train Loss: 0.606 Vali Loss: 2.990 Vali Acc: 0.259 Test Loss: 2.990 Test Acc: 0.259
Validation loss decreased (-0.258793 --> -0.258794).  Saving model ...
Epoch: 19 cost time: 0.8094987869262695
Epoch: 19, Steps: 10 | Train Loss: 0.402 Vali Loss: 3.001 Vali Acc: 0.275 Test Loss: 3.001 Test Acc: 0.275
Validation loss decreased (-0.258794 --> -0.275264).  Saving model ...
Epoch: 20 cost time: 0.7812411785125732
Epoch: 20, Steps: 10 | Train Loss: 0.357 Vali Loss: 3.005 Vali Acc: 0.287 Test Loss: 3.005 Test Acc: 0.287
Validation loss decreased (-0.275264 --> -0.287029).  Saving model ...
Epoch: 21 cost time: 0.6469383239746094
Epoch: 21, Steps: 10 | Train Loss: 0.230 Vali Loss: 3.020 Vali Acc: 0.313 Test Loss: 3.020 Test Acc: 0.313
Validation loss decreased (-0.287029 --> -0.312911).  Saving model ...
Epoch: 22 cost time: 0.8991913795471191
Epoch: 22, Steps: 10 | Train Loss: 0.242 Vali Loss: 3.137 Vali Acc: 0.301 Test Loss: 3.137 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8642058372497559
Epoch: 23, Steps: 10 | Train Loss: 0.209 Vali Loss: 3.019 Vali Acc: 0.304 Test Loss: 3.019 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8977720737457275
Epoch: 24, Steps: 10 | Train Loss: 0.137 Vali Loss: 3.019 Vali Acc: 0.314 Test Loss: 3.019 Test Acc: 0.314
Validation loss decreased (-0.312911 --> -0.314087).  Saving model ...
Epoch: 25 cost time: 0.9040284156799316
Epoch: 25, Steps: 10 | Train Loss: 0.115 Vali Loss: 3.087 Vali Acc: 0.314 Test Loss: 3.087 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7988095283508301
Epoch: 26, Steps: 10 | Train Loss: 0.094 Vali Loss: 3.061 Vali Acc: 0.322 Test Loss: 3.061 Test Acc: 0.322
Validation loss decreased (-0.314087 --> -0.322322).  Saving model ...
Epoch: 27 cost time: 0.8046262264251709
Epoch: 27, Steps: 10 | Train Loss: 0.112 Vali Loss: 3.107 Vali Acc: 0.320 Test Loss: 3.107 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8338360786437988
Epoch: 28, Steps: 10 | Train Loss: 0.097 Vali Loss: 3.110 Vali Acc: 0.322 Test Loss: 3.110 Test Acc: 0.322
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7655408382415771
Epoch: 29, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.142 Vali Acc: 0.329 Test Loss: 3.142 Test Acc: 0.329
Validation loss decreased (-0.322322 --> -0.329380).  Saving model ...
Epoch: 30 cost time: 0.869049072265625
Epoch: 30, Steps: 10 | Train Loss: 0.079 Vali Loss: 3.159 Vali Acc: 0.332 Test Loss: 3.159 Test Acc: 0.332
Validation loss decreased (-0.329380 --> -0.331733).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.33176470588235296
model parameter : 942954
model size : 3.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.2672488689422607
Epoch: 1, Steps: 10 | Train Loss: 3.343 Vali Loss: 3.314 Vali Acc: 0.040 Test Loss: 3.314 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 0.7130143642425537
Epoch: 2, Steps: 10 | Train Loss: 3.266 Vali Loss: 3.298 Vali Acc: 0.042 Test Loss: 3.298 Test Acc: 0.042
Validation loss decreased (-0.039967 --> -0.042320).  Saving model ...
Epoch: 3 cost time: 0.745081901550293
Epoch: 3, Steps: 10 | Train Loss: 3.146 Vali Loss: 3.299 Vali Acc: 0.055 Test Loss: 3.299 Test Acc: 0.055
Validation loss decreased (-0.042320 --> -0.055261).  Saving model ...
Epoch: 4 cost time: 0.7163212299346924
Epoch: 4, Steps: 10 | Train Loss: 3.064 Vali Loss: 3.305 Vali Acc: 0.059 Test Loss: 3.305 Test Acc: 0.059
Validation loss decreased (-0.055261 --> -0.058790).  Saving model ...
Epoch: 5 cost time: 0.7926180362701416
Epoch: 5, Steps: 10 | Train Loss: 2.969 Vali Loss: 3.301 Vali Acc: 0.071 Test Loss: 3.301 Test Acc: 0.071
Validation loss decreased (-0.058790 --> -0.070555).  Saving model ...
Epoch: 6 cost time: 0.8377876281738281
Epoch: 6, Steps: 10 | Train Loss: 2.852 Vali Loss: 3.279 Vali Acc: 0.089 Test Loss: 3.279 Test Acc: 0.089
Validation loss decreased (-0.070555 --> -0.089379).  Saving model ...
Epoch: 7 cost time: 0.8245234489440918
Epoch: 7, Steps: 10 | Train Loss: 2.725 Vali Loss: 3.262 Vali Acc: 0.101 Test Loss: 3.262 Test Acc: 0.101
Validation loss decreased (-0.089379 --> -0.101144).  Saving model ...
Epoch: 8 cost time: 0.7993745803833008
Epoch: 8, Steps: 10 | Train Loss: 2.556 Vali Loss: 3.224 Vali Acc: 0.114 Test Loss: 3.224 Test Acc: 0.114
Validation loss decreased (-0.101144 --> -0.114085).  Saving model ...
Epoch: 9 cost time: 0.7952618598937988
Epoch: 9, Steps: 10 | Train Loss: 2.433 Vali Loss: 3.189 Vali Acc: 0.138 Test Loss: 3.189 Test Acc: 0.138
Validation loss decreased (-0.114085 --> -0.137615).  Saving model ...
Epoch: 10 cost time: 0.7323408126831055
Epoch: 10, Steps: 10 | Train Loss: 2.301 Vali Loss: 3.150 Vali Acc: 0.159 Test Loss: 3.150 Test Acc: 0.159
Validation loss decreased (-0.137615 --> -0.158792).  Saving model ...
Epoch: 11 cost time: 0.7241737842559814
Epoch: 11, Steps: 10 | Train Loss: 2.086 Vali Loss: 3.138 Vali Acc: 0.161 Test Loss: 3.138 Test Acc: 0.161
Validation loss decreased (-0.158792 --> -0.161145).  Saving model ...
Epoch: 12 cost time: 0.7020902633666992
Epoch: 12, Steps: 10 | Train Loss: 1.885 Vali Loss: 3.108 Vali Acc: 0.176 Test Loss: 3.108 Test Acc: 0.176
Validation loss decreased (-0.161145 --> -0.176440).  Saving model ...
Epoch: 13 cost time: 0.7937512397766113
Epoch: 13, Steps: 10 | Train Loss: 1.716 Vali Loss: 3.089 Vali Acc: 0.198 Test Loss: 3.089 Test Acc: 0.198
Validation loss decreased (-0.176440 --> -0.197616).  Saving model ...
Epoch: 14 cost time: 0.7811005115509033
Epoch: 14, Steps: 10 | Train Loss: 1.580 Vali Loss: 3.064 Vali Acc: 0.181 Test Loss: 3.064 Test Acc: 0.181
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8699185848236084
Epoch: 15, Steps: 10 | Train Loss: 1.404 Vali Loss: 3.076 Vali Acc: 0.211 Test Loss: 3.076 Test Acc: 0.211
Validation loss decreased (-0.197616 --> -0.210557).  Saving model ...
Epoch: 16 cost time: 0.7423877716064453
Epoch: 16, Steps: 10 | Train Loss: 1.272 Vali Loss: 3.024 Vali Acc: 0.226 Test Loss: 3.024 Test Acc: 0.226
Validation loss decreased (-0.210557 --> -0.225852).  Saving model ...
Epoch: 17 cost time: 0.7975311279296875
Epoch: 17, Steps: 10 | Train Loss: 1.078 Vali Loss: 3.036 Vali Acc: 0.229 Test Loss: 3.036 Test Acc: 0.229
Validation loss decreased (-0.225852 --> -0.229381).  Saving model ...
Epoch: 18 cost time: 0.7078571319580078
Epoch: 18, Steps: 10 | Train Loss: 0.914 Vali Loss: 3.024 Vali Acc: 0.246 Test Loss: 3.024 Test Acc: 0.246
Validation loss decreased (-0.229381 --> -0.245852).  Saving model ...
Epoch: 19 cost time: 0.7327649593353271
Epoch: 19, Steps: 10 | Train Loss: 0.772 Vali Loss: 3.007 Vali Acc: 0.258 Test Loss: 3.007 Test Acc: 0.258
Validation loss decreased (-0.245852 --> -0.257617).  Saving model ...
Epoch: 20 cost time: 0.718599796295166
Epoch: 20, Steps: 10 | Train Loss: 0.626 Vali Loss: 3.156 Vali Acc: 0.245 Test Loss: 3.156 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6052577495574951
Epoch: 21, Steps: 10 | Train Loss: 0.552 Vali Loss: 3.008 Vali Acc: 0.269 Test Loss: 3.008 Test Acc: 0.269
Validation loss decreased (-0.257617 --> -0.269382).  Saving model ...
Epoch: 22 cost time: 0.8137547969818115
Epoch: 22, Steps: 10 | Train Loss: 0.473 Vali Loss: 3.029 Vali Acc: 0.281 Test Loss: 3.029 Test Acc: 0.281
Validation loss decreased (-0.269382 --> -0.281146).  Saving model ...
Epoch: 23 cost time: 0.830599308013916
Epoch: 23, Steps: 10 | Train Loss: 0.380 Vali Loss: 3.102 Vali Acc: 0.289 Test Loss: 3.102 Test Acc: 0.289
Validation loss decreased (-0.281146 --> -0.289381).  Saving model ...
Epoch: 24 cost time: 0.8184449672698975
Epoch: 24, Steps: 10 | Train Loss: 0.318 Vali Loss: 3.033 Vali Acc: 0.287 Test Loss: 3.033 Test Acc: 0.287
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7964866161346436
Epoch: 25, Steps: 10 | Train Loss: 0.222 Vali Loss: 3.097 Vali Acc: 0.298 Test Loss: 3.097 Test Acc: 0.298
Validation loss decreased (-0.289381 --> -0.297616).  Saving model ...
Epoch: 26 cost time: 0.6642200946807861
Epoch: 26, Steps: 10 | Train Loss: 0.198 Vali Loss: 3.058 Vali Acc: 0.307 Test Loss: 3.058 Test Acc: 0.307
Validation loss decreased (-0.297616 --> -0.307028).  Saving model ...
Epoch: 27 cost time: 0.7296738624572754
Epoch: 27, Steps: 10 | Train Loss: 0.164 Vali Loss: 3.148 Vali Acc: 0.298 Test Loss: 3.148 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7412025928497314
Epoch: 28, Steps: 10 | Train Loss: 0.153 Vali Loss: 3.081 Vali Acc: 0.314 Test Loss: 3.081 Test Acc: 0.314
Validation loss decreased (-0.307028 --> -0.314087).  Saving model ...
Epoch: 29 cost time: 0.7861547470092773
Epoch: 29, Steps: 10 | Train Loss: 0.121 Vali Loss: 3.151 Vali Acc: 0.309 Test Loss: 3.151 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8016366958618164
Epoch: 30, Steps: 10 | Train Loss: 0.103 Vali Loss: 3.162 Vali Acc: 0.305 Test Loss: 3.162 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.31411764705882356
model parameter : 322122
model size : 1.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.6740458011627197
Epoch: 1, Steps: 10 | Train Loss: 3.302 Vali Loss: 3.292 Vali Acc: 0.036 Test Loss: 3.292 Test Acc: 0.036
Validation loss decreased (inf --> -0.036438).  Saving model ...
Epoch: 2 cost time: 1.1971073150634766
Epoch: 2, Steps: 10 | Train Loss: 3.236 Vali Loss: 3.281 Vali Acc: 0.058 Test Loss: 3.281 Test Acc: 0.058
Validation loss decreased (-0.036438 --> -0.057614).  Saving model ...
Epoch: 3 cost time: 1.2082109451293945
Epoch: 3, Steps: 10 | Train Loss: 3.105 Vali Loss: 3.278 Vali Acc: 0.060 Test Loss: 3.278 Test Acc: 0.060
Validation loss decreased (-0.057614 --> -0.059967).  Saving model ...
Epoch: 4 cost time: 1.3536155223846436
Epoch: 4, Steps: 10 | Train Loss: 2.973 Vali Loss: 3.276 Vali Acc: 0.072 Test Loss: 3.276 Test Acc: 0.072
Validation loss decreased (-0.059967 --> -0.071732).  Saving model ...
Epoch: 5 cost time: 1.3609566688537598
Epoch: 5, Steps: 10 | Train Loss: 2.862 Vali Loss: 3.258 Vali Acc: 0.086 Test Loss: 3.258 Test Acc: 0.086
Validation loss decreased (-0.071732 --> -0.085850).  Saving model ...
Epoch: 6 cost time: 1.3535161018371582
Epoch: 6, Steps: 10 | Train Loss: 2.700 Vali Loss: 3.219 Vali Acc: 0.111 Test Loss: 3.219 Test Acc: 0.111
Validation loss decreased (-0.085850 --> -0.110556).  Saving model ...
Epoch: 7 cost time: 1.4092152118682861
Epoch: 7, Steps: 10 | Train Loss: 2.466 Vali Loss: 3.160 Vali Acc: 0.136 Test Loss: 3.160 Test Acc: 0.136
Validation loss decreased (-0.110556 --> -0.136439).  Saving model ...
Epoch: 8 cost time: 1.210540771484375
Epoch: 8, Steps: 10 | Train Loss: 2.278 Vali Loss: 3.126 Vali Acc: 0.154 Test Loss: 3.126 Test Acc: 0.154
Validation loss decreased (-0.136439 --> -0.154086).  Saving model ...
Epoch: 9 cost time: 1.2128620147705078
Epoch: 9, Steps: 10 | Train Loss: 2.068 Vali Loss: 3.085 Vali Acc: 0.165 Test Loss: 3.085 Test Acc: 0.165
Validation loss decreased (-0.154086 --> -0.164675).  Saving model ...
Epoch: 10 cost time: 0.9377143383026123
Epoch: 10, Steps: 10 | Train Loss: 1.849 Vali Loss: 3.052 Vali Acc: 0.180 Test Loss: 3.052 Test Acc: 0.180
Validation loss decreased (-0.164675 --> -0.179969).  Saving model ...
Epoch: 11 cost time: 1.2954282760620117
Epoch: 11, Steps: 10 | Train Loss: 1.628 Vali Loss: 3.019 Vali Acc: 0.191 Test Loss: 3.019 Test Acc: 0.191
Validation loss decreased (-0.179969 --> -0.190558).  Saving model ...
Epoch: 12 cost time: 0.8815855979919434
Epoch: 12, Steps: 10 | Train Loss: 1.393 Vali Loss: 2.995 Vali Acc: 0.211 Test Loss: 2.995 Test Acc: 0.211
Validation loss decreased (-0.190558 --> -0.210558).  Saving model ...
Epoch: 13 cost time: 0.9714550971984863
Epoch: 13, Steps: 10 | Train Loss: 1.141 Vali Loss: 2.970 Vali Acc: 0.226 Test Loss: 2.970 Test Acc: 0.226
Validation loss decreased (-0.210558 --> -0.225853).  Saving model ...
Epoch: 14 cost time: 1.0120782852172852
Epoch: 14, Steps: 10 | Train Loss: 1.029 Vali Loss: 3.021 Vali Acc: 0.215 Test Loss: 3.021 Test Acc: 0.215
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9656438827514648
Epoch: 15, Steps: 10 | Train Loss: 0.798 Vali Loss: 2.923 Vali Acc: 0.268 Test Loss: 2.923 Test Acc: 0.268
Validation loss decreased (-0.225853 --> -0.268206).  Saving model ...
Epoch: 16 cost time: 1.09183669090271
Epoch: 16, Steps: 10 | Train Loss: 0.664 Vali Loss: 2.974 Vali Acc: 0.249 Test Loss: 2.974 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1830580234527588
Epoch: 17, Steps: 10 | Train Loss: 0.483 Vali Loss: 2.935 Vali Acc: 0.264 Test Loss: 2.935 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2571842670440674
Epoch: 18, Steps: 10 | Train Loss: 0.373 Vali Loss: 3.025 Vali Acc: 0.267 Test Loss: 3.025 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.062476396560669
Epoch: 19, Steps: 10 | Train Loss: 0.282 Vali Loss: 2.939 Vali Acc: 0.275 Test Loss: 2.939 Test Acc: 0.275
Validation loss decreased (-0.268206 --> -0.275265).  Saving model ...
Epoch: 20 cost time: 1.1964483261108398
Epoch: 20, Steps: 10 | Train Loss: 0.254 Vali Loss: 2.920 Vali Acc: 0.293 Test Loss: 2.920 Test Acc: 0.293
Validation loss decreased (-0.275265 --> -0.292912).  Saving model ...
Epoch: 21 cost time: 1.1952910423278809
Epoch: 21, Steps: 10 | Train Loss: 0.175 Vali Loss: 2.997 Vali Acc: 0.287 Test Loss: 2.997 Test Acc: 0.287
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1775012016296387
Epoch: 22, Steps: 10 | Train Loss: 0.154 Vali Loss: 2.942 Vali Acc: 0.288 Test Loss: 2.942 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1254920959472656
Epoch: 23, Steps: 10 | Train Loss: 0.162 Vali Loss: 3.005 Vali Acc: 0.304 Test Loss: 3.005 Test Acc: 0.304
Validation loss decreased (-0.292912 --> -0.303499).  Saving model ...
Epoch: 24 cost time: 1.0552263259887695
Epoch: 24, Steps: 10 | Train Loss: 0.152 Vali Loss: 3.052 Vali Acc: 0.300 Test Loss: 3.052 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0468201637268066
Epoch: 25, Steps: 10 | Train Loss: 0.138 Vali Loss: 3.014 Vali Acc: 0.306 Test Loss: 3.014 Test Acc: 0.306
Validation loss decreased (-0.303499 --> -0.305852).  Saving model ...
Epoch: 26 cost time: 1.1657698154449463
Epoch: 26, Steps: 10 | Train Loss: 0.092 Vali Loss: 2.967 Vali Acc: 0.304 Test Loss: 2.967 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1827812194824219
Epoch: 27, Steps: 10 | Train Loss: 0.070 Vali Loss: 3.055 Vali Acc: 0.301 Test Loss: 3.055 Test Acc: 0.301
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0924668312072754
Epoch: 28, Steps: 10 | Train Loss: 0.067 Vali Loss: 3.044 Vali Acc: 0.308 Test Loss: 3.044 Test Acc: 0.308
Validation loss decreased (-0.305852 --> -0.308205).  Saving model ...
Epoch: 29 cost time: 1.158165454864502
Epoch: 29, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.096 Vali Acc: 0.306 Test Loss: 3.096 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1924731731414795
Epoch: 30, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.093 Vali Acc: 0.311 Test Loss: 3.093 Test Acc: 0.311
Validation loss decreased (-0.308205 --> -0.310557).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.31058823529411766
model parameter : 503370
model size : 2.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.2668495178222656
Epoch: 1, Steps: 10 | Train Loss: 3.284 Vali Loss: 3.297 Vali Acc: 0.045 Test Loss: 3.297 Test Acc: 0.045
Validation loss decreased (inf --> -0.044673).  Saving model ...
Epoch: 2 cost time: 0.8824772834777832
Epoch: 2, Steps: 10 | Train Loss: 3.195 Vali Loss: 3.279 Vali Acc: 0.049 Test Loss: 3.279 Test Acc: 0.049
Validation loss decreased (-0.044673 --> -0.049379).  Saving model ...
Epoch: 3 cost time: 0.7804327011108398
Epoch: 3, Steps: 10 | Train Loss: 3.045 Vali Loss: 3.273 Vali Acc: 0.074 Test Loss: 3.273 Test Acc: 0.074
Validation loss decreased (-0.049379 --> -0.074085).  Saving model ...
Epoch: 4 cost time: 0.7963025569915771
Epoch: 4, Steps: 10 | Train Loss: 2.952 Vali Loss: 3.277 Vali Acc: 0.087 Test Loss: 3.277 Test Acc: 0.087
Validation loss decreased (-0.074085 --> -0.087026).  Saving model ...
Epoch: 5 cost time: 0.8846244812011719
Epoch: 5, Steps: 10 | Train Loss: 2.810 Vali Loss: 3.259 Vali Acc: 0.100 Test Loss: 3.259 Test Acc: 0.100
Validation loss decreased (-0.087026 --> -0.099967).  Saving model ...
Epoch: 6 cost time: 0.9250407218933105
Epoch: 6, Steps: 10 | Train Loss: 2.692 Vali Loss: 3.227 Vali Acc: 0.107 Test Loss: 3.227 Test Acc: 0.107
Validation loss decreased (-0.099967 --> -0.107027).  Saving model ...
Epoch: 7 cost time: 0.8794765472412109
Epoch: 7, Steps: 10 | Train Loss: 2.559 Vali Loss: 3.183 Vali Acc: 0.138 Test Loss: 3.183 Test Acc: 0.138
Validation loss decreased (-0.107027 --> -0.137615).  Saving model ...
Epoch: 8 cost time: 0.9022872447967529
Epoch: 8, Steps: 10 | Train Loss: 2.316 Vali Loss: 3.135 Vali Acc: 0.160 Test Loss: 3.135 Test Acc: 0.160
Validation loss decreased (-0.137615 --> -0.159969).  Saving model ...
Epoch: 9 cost time: 0.8830151557922363
Epoch: 9, Steps: 10 | Train Loss: 2.111 Vali Loss: 3.089 Vali Acc: 0.173 Test Loss: 3.089 Test Acc: 0.173
Validation loss decreased (-0.159969 --> -0.172910).  Saving model ...
Epoch: 10 cost time: 0.8057506084442139
Epoch: 10, Steps: 10 | Train Loss: 1.891 Vali Loss: 3.057 Vali Acc: 0.174 Test Loss: 3.057 Test Acc: 0.174
Validation loss decreased (-0.172910 --> -0.174087).  Saving model ...
Epoch: 11 cost time: 0.9679665565490723
Epoch: 11, Steps: 10 | Train Loss: 1.663 Vali Loss: 3.027 Vali Acc: 0.199 Test Loss: 3.027 Test Acc: 0.199
Validation loss decreased (-0.174087 --> -0.198793).  Saving model ...
Epoch: 12 cost time: 1.0672688484191895
Epoch: 12, Steps: 10 | Train Loss: 1.480 Vali Loss: 3.005 Vali Acc: 0.205 Test Loss: 3.005 Test Acc: 0.205
Validation loss decreased (-0.198793 --> -0.204676).  Saving model ...
Epoch: 13 cost time: 0.8178505897521973
Epoch: 13, Steps: 10 | Train Loss: 1.265 Vali Loss: 2.971 Vali Acc: 0.221 Test Loss: 2.971 Test Acc: 0.221
Validation loss decreased (-0.204676 --> -0.221147).  Saving model ...
Epoch: 14 cost time: 0.8466477394104004
Epoch: 14, Steps: 10 | Train Loss: 1.097 Vali Loss: 2.943 Vali Acc: 0.235 Test Loss: 2.943 Test Acc: 0.235
Validation loss decreased (-0.221147 --> -0.235265).  Saving model ...
Epoch: 15 cost time: 0.9405124187469482
Epoch: 15, Steps: 10 | Train Loss: 0.905 Vali Loss: 2.929 Vali Acc: 0.249 Test Loss: 2.929 Test Acc: 0.249
Validation loss decreased (-0.235265 --> -0.249382).  Saving model ...
Epoch: 16 cost time: 0.8925931453704834
Epoch: 16, Steps: 10 | Train Loss: 0.753 Vali Loss: 2.946 Vali Acc: 0.249 Test Loss: 2.946 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9396083354949951
Epoch: 17, Steps: 10 | Train Loss: 0.656 Vali Loss: 2.929 Vali Acc: 0.260 Test Loss: 2.929 Test Acc: 0.260
Validation loss decreased (-0.249382 --> -0.259971).  Saving model ...
Epoch: 18 cost time: 0.9204909801483154
Epoch: 18, Steps: 10 | Train Loss: 0.523 Vali Loss: 2.921 Vali Acc: 0.285 Test Loss: 2.921 Test Acc: 0.285
Validation loss decreased (-0.259971 --> -0.284677).  Saving model ...
Epoch: 19 cost time: 0.9666483402252197
Epoch: 19, Steps: 10 | Train Loss: 0.447 Vali Loss: 2.922 Vali Acc: 0.282 Test Loss: 2.922 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9263732433319092
Epoch: 20, Steps: 10 | Train Loss: 0.334 Vali Loss: 2.918 Vali Acc: 0.289 Test Loss: 2.918 Test Acc: 0.289
Validation loss decreased (-0.284677 --> -0.289383).  Saving model ...
Epoch: 21 cost time: 0.9579665660858154
Epoch: 21, Steps: 10 | Train Loss: 0.234 Vali Loss: 2.971 Vali Acc: 0.300 Test Loss: 2.971 Test Acc: 0.300
Validation loss decreased (-0.289383 --> -0.299970).  Saving model ...
Epoch: 22 cost time: 0.9623739719390869
Epoch: 22, Steps: 10 | Train Loss: 0.237 Vali Loss: 2.960 Vali Acc: 0.301 Test Loss: 2.960 Test Acc: 0.301
Validation loss decreased (-0.299970 --> -0.301147).  Saving model ...
Epoch: 23 cost time: 0.8714883327484131
Epoch: 23, Steps: 10 | Train Loss: 0.220 Vali Loss: 2.997 Vali Acc: 0.294 Test Loss: 2.997 Test Acc: 0.294
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8985538482666016
Epoch: 24, Steps: 10 | Train Loss: 0.156 Vali Loss: 3.022 Vali Acc: 0.298 Test Loss: 3.022 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9621481895446777
Epoch: 25, Steps: 10 | Train Loss: 0.138 Vali Loss: 3.023 Vali Acc: 0.309 Test Loss: 3.023 Test Acc: 0.309
Validation loss decreased (-0.301147 --> -0.309382).  Saving model ...
Epoch: 26 cost time: 0.9197309017181396
Epoch: 26, Steps: 10 | Train Loss: 0.130 Vali Loss: 3.018 Vali Acc: 0.318 Test Loss: 3.018 Test Acc: 0.318
Validation loss decreased (-0.309382 --> -0.317617).  Saving model ...
Epoch: 27 cost time: 1.103046178817749
Epoch: 27, Steps: 10 | Train Loss: 0.093 Vali Loss: 3.053 Vali Acc: 0.313 Test Loss: 3.053 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9821629524230957
Epoch: 28, Steps: 10 | Train Loss: 0.104 Vali Loss: 3.093 Vali Acc: 0.320 Test Loss: 3.093 Test Acc: 0.320
Validation loss decreased (-0.317617 --> -0.319969).  Saving model ...
Epoch: 29 cost time: 1.0365056991577148
Epoch: 29, Steps: 10 | Train Loss: 0.080 Vali Loss: 3.097 Vali Acc: 0.312 Test Loss: 3.097 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0180835723876953
Epoch: 30, Steps: 10 | Train Loss: 0.067 Vali Loss: 3.095 Vali Acc: 0.312 Test Loss: 3.095 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.32
model parameter : 192906
model size : 1.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.158820867538452
Epoch: 1, Steps: 10 | Train Loss: 3.299 Vali Loss: 3.293 Vali Acc: 0.038 Test Loss: 3.293 Test Acc: 0.038
Validation loss decreased (inf --> -0.037614).  Saving model ...
Epoch: 2 cost time: 0.8739767074584961
Epoch: 2, Steps: 10 | Train Loss: 3.240 Vali Loss: 3.283 Vali Acc: 0.054 Test Loss: 3.283 Test Acc: 0.054
Validation loss decreased (-0.037614 --> -0.054085).  Saving model ...
Epoch: 3 cost time: 0.9425232410430908
Epoch: 3, Steps: 10 | Train Loss: 3.110 Vali Loss: 3.283 Vali Acc: 0.059 Test Loss: 3.283 Test Acc: 0.059
Validation loss decreased (-0.054085 --> -0.058791).  Saving model ...
Epoch: 4 cost time: 0.9217197895050049
Epoch: 4, Steps: 10 | Train Loss: 2.984 Vali Loss: 3.283 Vali Acc: 0.075 Test Loss: 3.283 Test Acc: 0.075
Validation loss decreased (-0.058791 --> -0.075261).  Saving model ...
Epoch: 5 cost time: 0.8817291259765625
Epoch: 5, Steps: 10 | Train Loss: 2.885 Vali Loss: 3.270 Vali Acc: 0.081 Test Loss: 3.270 Test Acc: 0.081
Validation loss decreased (-0.075261 --> -0.081144).  Saving model ...
Epoch: 6 cost time: 0.8917365074157715
Epoch: 6, Steps: 10 | Train Loss: 2.719 Vali Loss: 3.239 Vali Acc: 0.105 Test Loss: 3.239 Test Acc: 0.105
Validation loss decreased (-0.081144 --> -0.104673).  Saving model ...
Epoch: 7 cost time: 0.9551143646240234
Epoch: 7, Steps: 10 | Train Loss: 2.549 Vali Loss: 3.188 Vali Acc: 0.135 Test Loss: 3.188 Test Acc: 0.135
Validation loss decreased (-0.104673 --> -0.135262).  Saving model ...
Epoch: 8 cost time: 0.8815538883209229
Epoch: 8, Steps: 10 | Train Loss: 2.327 Vali Loss: 3.156 Vali Acc: 0.141 Test Loss: 3.156 Test Acc: 0.141
Validation loss decreased (-0.135262 --> -0.141145).  Saving model ...
Epoch: 9 cost time: 0.8650205135345459
Epoch: 9, Steps: 10 | Train Loss: 2.168 Vali Loss: 3.129 Vali Acc: 0.153 Test Loss: 3.129 Test Acc: 0.153
Validation loss decreased (-0.141145 --> -0.152910).  Saving model ...
Epoch: 10 cost time: 0.8439550399780273
Epoch: 10, Steps: 10 | Train Loss: 1.985 Vali Loss: 3.110 Vali Acc: 0.169 Test Loss: 3.110 Test Acc: 0.169
Validation loss decreased (-0.152910 --> -0.169381).  Saving model ...
Epoch: 11 cost time: 0.8709349632263184
Epoch: 11, Steps: 10 | Train Loss: 1.788 Vali Loss: 3.069 Vali Acc: 0.176 Test Loss: 3.069 Test Acc: 0.176
Validation loss decreased (-0.169381 --> -0.176440).  Saving model ...
Epoch: 12 cost time: 0.8150899410247803
Epoch: 12, Steps: 10 | Train Loss: 1.531 Vali Loss: 3.039 Vali Acc: 0.211 Test Loss: 3.039 Test Acc: 0.211
Validation loss decreased (-0.176440 --> -0.210558).  Saving model ...
Epoch: 13 cost time: 0.8564653396606445
Epoch: 13, Steps: 10 | Train Loss: 1.301 Vali Loss: 3.032 Vali Acc: 0.213 Test Loss: 3.032 Test Acc: 0.213
Validation loss decreased (-0.210558 --> -0.212911).  Saving model ...
Epoch: 14 cost time: 1.314030647277832
Epoch: 14, Steps: 10 | Train Loss: 1.172 Vali Loss: 3.019 Vali Acc: 0.220 Test Loss: 3.019 Test Acc: 0.220
Validation loss decreased (-0.212911 --> -0.219970).  Saving model ...
Epoch: 15 cost time: 1.2847585678100586
Epoch: 15, Steps: 10 | Train Loss: 0.937 Vali Loss: 2.989 Vali Acc: 0.234 Test Loss: 2.989 Test Acc: 0.234
Validation loss decreased (-0.219970 --> -0.234088).  Saving model ...
Epoch: 16 cost time: 1.3025314807891846
Epoch: 16, Steps: 10 | Train Loss: 0.772 Vali Loss: 2.963 Vali Acc: 0.251 Test Loss: 2.963 Test Acc: 0.251
Validation loss decreased (-0.234088 --> -0.250559).  Saving model ...
Epoch: 17 cost time: 1.2682592868804932
Epoch: 17, Steps: 10 | Train Loss: 0.630 Vali Loss: 2.925 Vali Acc: 0.266 Test Loss: 2.925 Test Acc: 0.266
Validation loss decreased (-0.250559 --> -0.265853).  Saving model ...
Epoch: 18 cost time: 1.3368654251098633
Epoch: 18, Steps: 10 | Train Loss: 0.481 Vali Loss: 3.019 Vali Acc: 0.272 Test Loss: 3.019 Test Acc: 0.272
Validation loss decreased (-0.265853 --> -0.271735).  Saving model ...
Epoch: 19 cost time: 1.3674495220184326
Epoch: 19, Steps: 10 | Train Loss: 0.407 Vali Loss: 2.911 Vali Acc: 0.282 Test Loss: 2.911 Test Acc: 0.282
Validation loss decreased (-0.271735 --> -0.282324).  Saving model ...
Epoch: 20 cost time: 1.3089914321899414
Epoch: 20, Steps: 10 | Train Loss: 0.434 Vali Loss: 2.931 Vali Acc: 0.282 Test Loss: 2.931 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2880043983459473
Epoch: 21, Steps: 10 | Train Loss: 0.317 Vali Loss: 2.984 Vali Acc: 0.286 Test Loss: 2.984 Test Acc: 0.286
Validation loss decreased (-0.282324 --> -0.285853).  Saving model ...
Epoch: 22 cost time: 1.1801228523254395
Epoch: 22, Steps: 10 | Train Loss: 0.202 Vali Loss: 2.939 Vali Acc: 0.302 Test Loss: 2.939 Test Acc: 0.302
Validation loss decreased (-0.285853 --> -0.302324).  Saving model ...
Epoch: 23 cost time: 1.1734488010406494
Epoch: 23, Steps: 10 | Train Loss: 0.270 Vali Loss: 2.963 Vali Acc: 0.294 Test Loss: 2.963 Test Acc: 0.294
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.157294511795044
Epoch: 24, Steps: 10 | Train Loss: 0.183 Vali Loss: 2.989 Vali Acc: 0.305 Test Loss: 2.989 Test Acc: 0.305
Validation loss decreased (-0.302324 --> -0.304676).  Saving model ...
Epoch: 25 cost time: 1.199507474899292
Epoch: 25, Steps: 10 | Train Loss: 0.170 Vali Loss: 2.980 Vali Acc: 0.312 Test Loss: 2.980 Test Acc: 0.312
Validation loss decreased (-0.304676 --> -0.311735).  Saving model ...
Epoch: 26 cost time: 1.24824857711792
Epoch: 26, Steps: 10 | Train Loss: 0.142 Vali Loss: 2.997 Vali Acc: 0.313 Test Loss: 2.997 Test Acc: 0.313
Validation loss decreased (-0.311735 --> -0.312911).  Saving model ...
Epoch: 27 cost time: 0.9468948841094971
Epoch: 27, Steps: 10 | Train Loss: 0.114 Vali Loss: 2.982 Vali Acc: 0.311 Test Loss: 2.982 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3701708316802979
Epoch: 28, Steps: 10 | Train Loss: 0.102 Vali Loss: 3.003 Vali Acc: 0.318 Test Loss: 3.003 Test Acc: 0.318
Validation loss decreased (-0.312911 --> -0.317617).  Saving model ...
Epoch: 29 cost time: 1.3047935962677002
Epoch: 29, Steps: 10 | Train Loss: 0.107 Vali Loss: 3.049 Vali Acc: 0.314 Test Loss: 3.049 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3170363903045654
Epoch: 30, Steps: 10 | Train Loss: 0.074 Vali Loss: 3.017 Vali Acc: 0.316 Test Loss: 3.017 Test Acc: 0.316
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3176470588235294
model parameter : 503370
model size : 2.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.55971360206604
Epoch: 1, Steps: 10 | Train Loss: 3.288 Vali Loss: 3.301 Vali Acc: 0.040 Test Loss: 3.301 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 1.1141080856323242
Epoch: 2, Steps: 10 | Train Loss: 3.188 Vali Loss: 3.283 Vali Acc: 0.051 Test Loss: 3.283 Test Acc: 0.051
Validation loss decreased (-0.039967 --> -0.050555).  Saving model ...
Epoch: 3 cost time: 1.134523630142212
Epoch: 3, Steps: 10 | Train Loss: 3.060 Vali Loss: 3.277 Vali Acc: 0.067 Test Loss: 3.277 Test Acc: 0.067
Validation loss decreased (-0.050555 --> -0.067026).  Saving model ...
Epoch: 4 cost time: 1.0114595890045166
Epoch: 4, Steps: 10 | Train Loss: 2.953 Vali Loss: 3.282 Vali Acc: 0.084 Test Loss: 3.282 Test Acc: 0.084
Validation loss decreased (-0.067026 --> -0.083497).  Saving model ...
Epoch: 5 cost time: 1.0409159660339355
Epoch: 5, Steps: 10 | Train Loss: 2.810 Vali Loss: 3.264 Vali Acc: 0.088 Test Loss: 3.264 Test Acc: 0.088
Validation loss decreased (-0.083497 --> -0.088203).  Saving model ...
Epoch: 6 cost time: 0.9839839935302734
Epoch: 6, Steps: 10 | Train Loss: 2.707 Vali Loss: 3.235 Vali Acc: 0.107 Test Loss: 3.235 Test Acc: 0.107
Validation loss decreased (-0.088203 --> -0.107026).  Saving model ...
Epoch: 7 cost time: 1.1076157093048096
Epoch: 7, Steps: 10 | Train Loss: 2.584 Vali Loss: 3.195 Vali Acc: 0.122 Test Loss: 3.195 Test Acc: 0.122
Validation loss decreased (-0.107026 --> -0.122321).  Saving model ...
Epoch: 8 cost time: 1.0630621910095215
Epoch: 8, Steps: 10 | Train Loss: 2.387 Vali Loss: 3.150 Vali Acc: 0.140 Test Loss: 3.150 Test Acc: 0.140
Validation loss decreased (-0.122321 --> -0.139968).  Saving model ...
Epoch: 9 cost time: 0.9946393966674805
Epoch: 9, Steps: 10 | Train Loss: 2.200 Vali Loss: 3.108 Vali Acc: 0.154 Test Loss: 3.108 Test Acc: 0.154
Validation loss decreased (-0.139968 --> -0.154087).  Saving model ...
Epoch: 10 cost time: 1.1407878398895264
Epoch: 10, Steps: 10 | Train Loss: 1.944 Vali Loss: 3.078 Vali Acc: 0.173 Test Loss: 3.078 Test Acc: 0.173
Validation loss decreased (-0.154087 --> -0.172910).  Saving model ...
Epoch: 11 cost time: 1.0563442707061768
Epoch: 11, Steps: 10 | Train Loss: 1.733 Vali Loss: 3.052 Vali Acc: 0.192 Test Loss: 3.052 Test Acc: 0.192
Validation loss decreased (-0.172910 --> -0.191734).  Saving model ...
Epoch: 12 cost time: 1.1351888179779053
Epoch: 12, Steps: 10 | Train Loss: 1.567 Vali Loss: 3.032 Vali Acc: 0.195 Test Loss: 3.032 Test Acc: 0.195
Validation loss decreased (-0.191734 --> -0.195264).  Saving model ...
Epoch: 13 cost time: 1.1097438335418701
Epoch: 13, Steps: 10 | Train Loss: 1.468 Vali Loss: 2.985 Vali Acc: 0.213 Test Loss: 2.985 Test Acc: 0.213
Validation loss decreased (-0.195264 --> -0.212911).  Saving model ...
Epoch: 14 cost time: 1.0586943626403809
Epoch: 14, Steps: 10 | Train Loss: 1.230 Vali Loss: 2.967 Vali Acc: 0.231 Test Loss: 2.967 Test Acc: 0.231
Validation loss decreased (-0.212911 --> -0.230559).  Saving model ...
Epoch: 15 cost time: 1.0914862155914307
Epoch: 15, Steps: 10 | Train Loss: 1.081 Vali Loss: 2.953 Vali Acc: 0.240 Test Loss: 2.953 Test Acc: 0.240
Validation loss decreased (-0.230559 --> -0.239970).  Saving model ...
Epoch: 16 cost time: 1.1573371887207031
Epoch: 16, Steps: 10 | Train Loss: 0.974 Vali Loss: 2.947 Vali Acc: 0.254 Test Loss: 2.947 Test Acc: 0.254
Validation loss decreased (-0.239970 --> -0.254088).  Saving model ...
Epoch: 17 cost time: 1.122074842453003
Epoch: 17, Steps: 10 | Train Loss: 0.751 Vali Loss: 2.947 Vali Acc: 0.260 Test Loss: 2.947 Test Acc: 0.260
Validation loss decreased (-0.254088 --> -0.259971).  Saving model ...
Epoch: 18 cost time: 1.131950855255127
Epoch: 18, Steps: 10 | Train Loss: 0.605 Vali Loss: 2.929 Vali Acc: 0.293 Test Loss: 2.929 Test Acc: 0.293
Validation loss decreased (-0.259971 --> -0.292912).  Saving model ...
Epoch: 19 cost time: 1.0324079990386963
Epoch: 19, Steps: 10 | Train Loss: 0.504 Vali Loss: 2.910 Vali Acc: 0.287 Test Loss: 2.910 Test Acc: 0.287
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9909915924072266
Epoch: 20, Steps: 10 | Train Loss: 0.423 Vali Loss: 2.950 Vali Acc: 0.292 Test Loss: 2.950 Test Acc: 0.292
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0369524955749512
Epoch: 21, Steps: 10 | Train Loss: 0.306 Vali Loss: 2.967 Vali Acc: 0.296 Test Loss: 2.967 Test Acc: 0.296
Validation loss decreased (-0.292912 --> -0.296441).  Saving model ...
Epoch: 22 cost time: 1.057112216949463
Epoch: 22, Steps: 10 | Train Loss: 0.339 Vali Loss: 2.969 Vali Acc: 0.318 Test Loss: 2.969 Test Acc: 0.318
Validation loss decreased (-0.296441 --> -0.317617).  Saving model ...
Epoch: 23 cost time: 0.9748106002807617
Epoch: 23, Steps: 10 | Train Loss: 0.276 Vali Loss: 2.972 Vali Acc: 0.302 Test Loss: 2.972 Test Acc: 0.302
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0093207359313965
Epoch: 24, Steps: 10 | Train Loss: 0.205 Vali Loss: 3.041 Vali Acc: 0.312 Test Loss: 3.041 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0867600440979004
Epoch: 25, Steps: 10 | Train Loss: 0.207 Vali Loss: 3.033 Vali Acc: 0.315 Test Loss: 3.033 Test Acc: 0.315
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0748217105865479
Epoch: 26, Steps: 10 | Train Loss: 0.143 Vali Loss: 3.068 Vali Acc: 0.308 Test Loss: 3.068 Test Acc: 0.308
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.169306993484497
Epoch: 27, Steps: 10 | Train Loss: 0.105 Vali Loss: 3.061 Vali Acc: 0.328 Test Loss: 3.061 Test Acc: 0.328
Validation loss decreased (-0.317617 --> -0.328205).  Saving model ...
Epoch: 28 cost time: 1.1852970123291016
Epoch: 28, Steps: 10 | Train Loss: 0.142 Vali Loss: 3.038 Vali Acc: 0.327 Test Loss: 3.038 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1913585662841797
Epoch: 29, Steps: 10 | Train Loss: 0.103 Vali Loss: 3.102 Vali Acc: 0.329 Test Loss: 3.102 Test Acc: 0.329
Validation loss decreased (-0.328205 --> -0.329381).  Saving model ...
Epoch: 30 cost time: 1.1470646858215332
Epoch: 30, Steps: 10 | Train Loss: 0.119 Vali Loss: 3.072 Vali Acc: 0.325 Test Loss: 3.072 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.32941176470588235
model parameter : 192906
model size : 1.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.3813018798828125
Epoch: 1, Steps: 10 | Train Loss: 3.309 Vali Loss: 3.288 Vali Acc: 0.040 Test Loss: 3.288 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 0.9380073547363281
Epoch: 2, Steps: 10 | Train Loss: 3.238 Vali Loss: 3.279 Vali Acc: 0.061 Test Loss: 3.279 Test Acc: 0.061
Validation loss decreased (-0.039967 --> -0.061144).  Saving model ...
Epoch: 3 cost time: 0.8336188793182373
Epoch: 3, Steps: 10 | Train Loss: 3.116 Vali Loss: 3.280 Vali Acc: 0.062 Test Loss: 3.280 Test Acc: 0.062
Validation loss decreased (-0.061144 --> -0.062320).  Saving model ...
Epoch: 4 cost time: 0.8463270664215088
Epoch: 4, Steps: 10 | Train Loss: 3.003 Vali Loss: 3.283 Vali Acc: 0.071 Test Loss: 3.283 Test Acc: 0.071
Validation loss decreased (-0.062320 --> -0.070555).  Saving model ...
Epoch: 5 cost time: 0.8891746997833252
Epoch: 5, Steps: 10 | Train Loss: 2.917 Vali Loss: 3.275 Vali Acc: 0.076 Test Loss: 3.275 Test Acc: 0.076
Validation loss decreased (-0.070555 --> -0.076438).  Saving model ...
Epoch: 6 cost time: 0.9382379055023193
Epoch: 6, Steps: 10 | Train Loss: 2.764 Vali Loss: 3.250 Vali Acc: 0.096 Test Loss: 3.250 Test Acc: 0.096
Validation loss decreased (-0.076438 --> -0.096438).  Saving model ...
Epoch: 7 cost time: 0.9151747226715088
Epoch: 7, Steps: 10 | Train Loss: 2.570 Vali Loss: 3.206 Vali Acc: 0.126 Test Loss: 3.206 Test Acc: 0.126
Validation loss decreased (-0.096438 --> -0.125850).  Saving model ...
Epoch: 8 cost time: 0.6232631206512451
Epoch: 8, Steps: 10 | Train Loss: 2.434 Vali Loss: 3.182 Vali Acc: 0.131 Test Loss: 3.182 Test Acc: 0.131
Validation loss decreased (-0.125850 --> -0.130556).  Saving model ...
Epoch: 9 cost time: 1.0075867176055908
Epoch: 9, Steps: 10 | Train Loss: 2.265 Vali Loss: 3.154 Vali Acc: 0.149 Test Loss: 3.154 Test Acc: 0.149
Validation loss decreased (-0.130556 --> -0.149380).  Saving model ...
Epoch: 10 cost time: 0.9213848114013672
Epoch: 10, Steps: 10 | Train Loss: 2.092 Vali Loss: 3.140 Vali Acc: 0.167 Test Loss: 3.140 Test Acc: 0.167
Validation loss decreased (-0.149380 --> -0.167027).  Saving model ...
Epoch: 11 cost time: 0.9576222896575928
Epoch: 11, Steps: 10 | Train Loss: 1.949 Vali Loss: 3.105 Vali Acc: 0.178 Test Loss: 3.105 Test Acc: 0.178
Validation loss decreased (-0.167027 --> -0.177616).  Saving model ...
Epoch: 12 cost time: 0.9383597373962402
Epoch: 12, Steps: 10 | Train Loss: 1.662 Vali Loss: 3.076 Vali Acc: 0.184 Test Loss: 3.076 Test Acc: 0.184
Validation loss decreased (-0.177616 --> -0.183499).  Saving model ...
Epoch: 13 cost time: 0.9780139923095703
Epoch: 13, Steps: 10 | Train Loss: 1.450 Vali Loss: 3.067 Vali Acc: 0.196 Test Loss: 3.067 Test Acc: 0.196
Validation loss decreased (-0.183499 --> -0.196440).  Saving model ...
Epoch: 14 cost time: 0.9616131782531738
Epoch: 14, Steps: 10 | Train Loss: 1.321 Vali Loss: 3.036 Vali Acc: 0.216 Test Loss: 3.036 Test Acc: 0.216
Validation loss decreased (-0.196440 --> -0.216440).  Saving model ...
Epoch: 15 cost time: 0.9495413303375244
Epoch: 15, Steps: 10 | Train Loss: 1.076 Vali Loss: 3.026 Vali Acc: 0.235 Test Loss: 3.026 Test Acc: 0.235
Validation loss decreased (-0.216440 --> -0.235264).  Saving model ...
Epoch: 16 cost time: 0.9551730155944824
Epoch: 16, Steps: 10 | Train Loss: 0.956 Vali Loss: 3.019 Vali Acc: 0.239 Test Loss: 3.019 Test Acc: 0.239
Validation loss decreased (-0.235264 --> -0.238793).  Saving model ...
Epoch: 17 cost time: 1.0491130352020264
Epoch: 17, Steps: 10 | Train Loss: 0.735 Vali Loss: 2.983 Vali Acc: 0.249 Test Loss: 2.983 Test Acc: 0.249
Validation loss decreased (-0.238793 --> -0.249382).  Saving model ...
Epoch: 18 cost time: 0.9494140148162842
Epoch: 18, Steps: 10 | Train Loss: 0.614 Vali Loss: 3.082 Vali Acc: 0.238 Test Loss: 3.082 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9320404529571533
Epoch: 19, Steps: 10 | Train Loss: 0.529 Vali Loss: 3.008 Vali Acc: 0.255 Test Loss: 3.008 Test Acc: 0.255
Validation loss decreased (-0.249382 --> -0.255264).  Saving model ...
Epoch: 20 cost time: 0.8858528137207031
Epoch: 20, Steps: 10 | Train Loss: 0.514 Vali Loss: 2.967 Vali Acc: 0.271 Test Loss: 2.967 Test Acc: 0.271
Validation loss decreased (-0.255264 --> -0.270559).  Saving model ...
Epoch: 21 cost time: 0.9787013530731201
Epoch: 21, Steps: 10 | Train Loss: 0.479 Vali Loss: 3.017 Vali Acc: 0.272 Test Loss: 3.017 Test Acc: 0.272
Validation loss decreased (-0.270559 --> -0.271735).  Saving model ...
Epoch: 22 cost time: 0.8703353404998779
Epoch: 22, Steps: 10 | Train Loss: 0.281 Vali Loss: 2.996 Vali Acc: 0.288 Test Loss: 2.996 Test Acc: 0.288
Validation loss decreased (-0.271735 --> -0.288205).  Saving model ...
Epoch: 23 cost time: 0.9419896602630615
Epoch: 23, Steps: 10 | Train Loss: 0.289 Vali Loss: 3.024 Vali Acc: 0.288 Test Loss: 3.024 Test Acc: 0.288
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8679101467132568
Epoch: 24, Steps: 10 | Train Loss: 0.248 Vali Loss: 3.077 Vali Acc: 0.282 Test Loss: 3.077 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9824066162109375
Epoch: 25, Steps: 10 | Train Loss: 0.286 Vali Loss: 3.020 Vali Acc: 0.304 Test Loss: 3.020 Test Acc: 0.304
Validation loss decreased (-0.288205 --> -0.303499).  Saving model ...
Epoch: 26 cost time: 0.9974181652069092
Epoch: 26, Steps: 10 | Train Loss: 0.198 Vali Loss: 3.017 Vali Acc: 0.299 Test Loss: 3.017 Test Acc: 0.299
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9621407985687256
Epoch: 27, Steps: 10 | Train Loss: 0.155 Vali Loss: 3.036 Vali Acc: 0.312 Test Loss: 3.036 Test Acc: 0.312
Validation loss decreased (-0.303499 --> -0.311734).  Saving model ...
Epoch: 28 cost time: 1.1247718334197998
Epoch: 28, Steps: 10 | Train Loss: 0.154 Vali Loss: 3.171 Vali Acc: 0.308 Test Loss: 3.171 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1162254810333252
Epoch: 29, Steps: 10 | Train Loss: 0.140 Vali Loss: 3.042 Vali Acc: 0.315 Test Loss: 3.042 Test Acc: 0.315
Validation loss decreased (-0.311734 --> -0.315264).  Saving model ...
Epoch: 30 cost time: 1.075228214263916
Epoch: 30, Steps: 10 | Train Loss: 0.139 Vali Loss: 3.074 Vali Acc: 0.318 Test Loss: 3.074 Test Acc: 0.318
Validation loss decreased (-0.315264 --> -0.317616).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3176470588235294
model parameter : 503370
model size : 2.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.149188280105591
Epoch: 1, Steps: 10 | Train Loss: 3.287 Vali Loss: 3.297 Vali Acc: 0.044 Test Loss: 3.297 Test Acc: 0.044
Validation loss decreased (inf --> -0.043496).  Saving model ...
Epoch: 2 cost time: 0.8998215198516846
Epoch: 2, Steps: 10 | Train Loss: 3.201 Vali Loss: 3.282 Vali Acc: 0.060 Test Loss: 3.282 Test Acc: 0.060
Validation loss decreased (-0.043496 --> -0.059967).  Saving model ...
Epoch: 3 cost time: 0.8526036739349365
Epoch: 3, Steps: 10 | Train Loss: 3.062 Vali Loss: 3.279 Vali Acc: 0.075 Test Loss: 3.279 Test Acc: 0.075
Validation loss decreased (-0.059967 --> -0.075261).  Saving model ...
Epoch: 4 cost time: 0.8097047805786133
Epoch: 4, Steps: 10 | Train Loss: 2.981 Vali Loss: 3.288 Vali Acc: 0.084 Test Loss: 3.288 Test Acc: 0.084
Validation loss decreased (-0.075261 --> -0.083497).  Saving model ...
Epoch: 5 cost time: 0.857952356338501
Epoch: 5, Steps: 10 | Train Loss: 2.835 Vali Loss: 3.276 Vali Acc: 0.086 Test Loss: 3.276 Test Acc: 0.086
Validation loss decreased (-0.083497 --> -0.085850).  Saving model ...
Epoch: 6 cost time: 0.8229260444641113
Epoch: 6, Steps: 10 | Train Loss: 2.755 Vali Loss: 3.253 Vali Acc: 0.098 Test Loss: 3.253 Test Acc: 0.098
Validation loss decreased (-0.085850 --> -0.097615).  Saving model ...
Epoch: 7 cost time: 0.8269400596618652
Epoch: 7, Steps: 10 | Train Loss: 2.666 Vali Loss: 3.222 Vali Acc: 0.120 Test Loss: 3.222 Test Acc: 0.120
Validation loss decreased (-0.097615 --> -0.119968).  Saving model ...
Epoch: 8 cost time: 0.8964557647705078
Epoch: 8, Steps: 10 | Train Loss: 2.441 Vali Loss: 3.187 Vali Acc: 0.134 Test Loss: 3.187 Test Acc: 0.134
Validation loss decreased (-0.119968 --> -0.134086).  Saving model ...
Epoch: 9 cost time: 0.674475908279419
Epoch: 9, Steps: 10 | Train Loss: 2.297 Vali Loss: 3.151 Vali Acc: 0.152 Test Loss: 3.151 Test Acc: 0.152
Validation loss decreased (-0.134086 --> -0.151733).  Saving model ...
Epoch: 10 cost time: 0.8963146209716797
Epoch: 10, Steps: 10 | Train Loss: 2.121 Vali Loss: 3.125 Vali Acc: 0.155 Test Loss: 3.125 Test Acc: 0.155
Validation loss decreased (-0.151733 --> -0.155263).  Saving model ...
Epoch: 11 cost time: 0.9010701179504395
Epoch: 11, Steps: 10 | Train Loss: 1.935 Vali Loss: 3.103 Vali Acc: 0.174 Test Loss: 3.103 Test Acc: 0.174
Validation loss decreased (-0.155263 --> -0.174087).  Saving model ...
Epoch: 12 cost time: 0.8570032119750977
Epoch: 12, Steps: 10 | Train Loss: 1.784 Vali Loss: 3.083 Vali Acc: 0.184 Test Loss: 3.083 Test Acc: 0.184
Validation loss decreased (-0.174087 --> -0.183499).  Saving model ...
Epoch: 13 cost time: 0.8579936027526855
Epoch: 13, Steps: 10 | Train Loss: 1.597 Vali Loss: 3.050 Vali Acc: 0.211 Test Loss: 3.050 Test Acc: 0.211
Validation loss decreased (-0.183499 --> -0.210558).  Saving model ...
Epoch: 14 cost time: 0.8746912479400635
Epoch: 14, Steps: 10 | Train Loss: 1.477 Vali Loss: 3.031 Vali Acc: 0.220 Test Loss: 3.031 Test Acc: 0.220
Validation loss decreased (-0.210558 --> -0.219970).  Saving model ...
Epoch: 15 cost time: 0.8587079048156738
Epoch: 15, Steps: 10 | Train Loss: 1.245 Vali Loss: 3.015 Vali Acc: 0.228 Test Loss: 3.015 Test Acc: 0.228
Validation loss decreased (-0.219970 --> -0.228205).  Saving model ...
Epoch: 16 cost time: 0.9183230400085449
Epoch: 16, Steps: 10 | Train Loss: 1.125 Vali Loss: 3.007 Vali Acc: 0.240 Test Loss: 3.007 Test Acc: 0.240
Validation loss decreased (-0.228205 --> -0.239970).  Saving model ...
Epoch: 17 cost time: 0.8931128978729248
Epoch: 17, Steps: 10 | Train Loss: 0.980 Vali Loss: 3.000 Vali Acc: 0.238 Test Loss: 3.000 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0328760147094727
Epoch: 18, Steps: 10 | Train Loss: 0.816 Vali Loss: 2.981 Vali Acc: 0.246 Test Loss: 2.981 Test Acc: 0.246
Validation loss decreased (-0.239970 --> -0.245853).  Saving model ...
Epoch: 19 cost time: 0.9087076187133789
Epoch: 19, Steps: 10 | Train Loss: 0.705 Vali Loss: 2.983 Vali Acc: 0.256 Test Loss: 2.983 Test Acc: 0.256
Validation loss decreased (-0.245853 --> -0.256441).  Saving model ...
Epoch: 20 cost time: 0.5481600761413574
Epoch: 20, Steps: 10 | Train Loss: 0.633 Vali Loss: 2.969 Vali Acc: 0.271 Test Loss: 2.969 Test Acc: 0.271
Validation loss decreased (-0.256441 --> -0.270559).  Saving model ...
Epoch: 21 cost time: 0.9611687660217285
Epoch: 21, Steps: 10 | Train Loss: 0.455 Vali Loss: 3.027 Vali Acc: 0.271 Test Loss: 3.027 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8585939407348633
Epoch: 22, Steps: 10 | Train Loss: 0.421 Vali Loss: 2.966 Vali Acc: 0.292 Test Loss: 2.966 Test Acc: 0.292
Validation loss decreased (-0.270559 --> -0.291735).  Saving model ...
Epoch: 23 cost time: 0.7201979160308838
Epoch: 23, Steps: 10 | Train Loss: 0.324 Vali Loss: 3.016 Vali Acc: 0.300 Test Loss: 3.016 Test Acc: 0.300
Validation loss decreased (-0.291735 --> -0.299970).  Saving model ...
Epoch: 24 cost time: 0.8026199340820312
Epoch: 24, Steps: 10 | Train Loss: 0.301 Vali Loss: 3.015 Vali Acc: 0.316 Test Loss: 3.015 Test Acc: 0.316
Validation loss decreased (-0.299970 --> -0.316440).  Saving model ...
Epoch: 25 cost time: 0.8043675422668457
Epoch: 25, Steps: 10 | Train Loss: 0.275 Vali Loss: 3.034 Vali Acc: 0.322 Test Loss: 3.034 Test Acc: 0.322
Validation loss decreased (-0.316440 --> -0.322323).  Saving model ...
Epoch: 26 cost time: 0.8073115348815918
Epoch: 26, Steps: 10 | Train Loss: 0.186 Vali Loss: 3.019 Vali Acc: 0.314 Test Loss: 3.019 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8789315223693848
Epoch: 27, Steps: 10 | Train Loss: 0.139 Vali Loss: 3.051 Vali Acc: 0.320 Test Loss: 3.051 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0683608055114746
Epoch: 28, Steps: 10 | Train Loss: 0.124 Vali Loss: 3.055 Vali Acc: 0.325 Test Loss: 3.055 Test Acc: 0.325
Validation loss decreased (-0.322323 --> -0.324675).  Saving model ...
Epoch: 29 cost time: 1.0591747760772705
Epoch: 29, Steps: 10 | Train Loss: 0.130 Vali Loss: 3.127 Vali Acc: 0.311 Test Loss: 3.127 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9861268997192383
Epoch: 30, Steps: 10 | Train Loss: 0.120 Vali Loss: 3.096 Vali Acc: 0.326 Test Loss: 3.096 Test Acc: 0.326
Validation loss decreased (-0.324675 --> -0.325851).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.32588235294117646
model parameter : 192906
model size : 1.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.563830852508545
Epoch: 1, Steps: 10 | Train Loss: 3.370 Vali Loss: 3.306 Vali Acc: 0.047 Test Loss: 3.306 Test Acc: 0.047
Validation loss decreased (inf --> -0.047026).  Saving model ...
Epoch: 2 cost time: 1.7647716999053955
Epoch: 2, Steps: 10 | Train Loss: 3.299 Vali Loss: 3.288 Vali Acc: 0.046 Test Loss: 3.288 Test Acc: 0.046
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5397536754608154
Epoch: 3, Steps: 10 | Train Loss: 3.218 Vali Loss: 3.271 Vali Acc: 0.046 Test Loss: 3.271 Test Acc: 0.046
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5171003341674805
Epoch: 4, Steps: 10 | Train Loss: 3.123 Vali Loss: 3.262 Vali Acc: 0.066 Test Loss: 3.262 Test Acc: 0.066
Validation loss decreased (-0.047026 --> -0.065850).  Saving model ...
Epoch: 5 cost time: 1.527463674545288
Epoch: 5, Steps: 10 | Train Loss: 2.970 Vali Loss: 3.259 Vali Acc: 0.068 Test Loss: 3.259 Test Acc: 0.068
Validation loss decreased (-0.065850 --> -0.068203).  Saving model ...
Epoch: 6 cost time: 1.6860742568969727
Epoch: 6, Steps: 10 | Train Loss: 2.881 Vali Loss: 3.235 Vali Acc: 0.089 Test Loss: 3.235 Test Acc: 0.089
Validation loss decreased (-0.068203 --> -0.089379).  Saving model ...
Epoch: 7 cost time: 1.606837272644043
Epoch: 7, Steps: 10 | Train Loss: 2.754 Vali Loss: 3.199 Vali Acc: 0.115 Test Loss: 3.199 Test Acc: 0.115
Validation loss decreased (-0.089379 --> -0.115262).  Saving model ...
Epoch: 8 cost time: 1.631432056427002
Epoch: 8, Steps: 10 | Train Loss: 2.653 Vali Loss: 3.184 Vali Acc: 0.112 Test Loss: 3.184 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7020277976989746
Epoch: 9, Steps: 10 | Train Loss: 2.517 Vali Loss: 3.140 Vali Acc: 0.140 Test Loss: 3.140 Test Acc: 0.140
Validation loss decreased (-0.115262 --> -0.139969).  Saving model ...
Epoch: 10 cost time: 1.6709556579589844
Epoch: 10, Steps: 10 | Train Loss: 2.307 Vali Loss: 3.105 Vali Acc: 0.142 Test Loss: 3.105 Test Acc: 0.142
Validation loss decreased (-0.139969 --> -0.142322).  Saving model ...
Epoch: 11 cost time: 1.6423346996307373
Epoch: 11, Steps: 10 | Train Loss: 2.099 Vali Loss: 3.074 Vali Acc: 0.161 Test Loss: 3.074 Test Acc: 0.161
Validation loss decreased (-0.142322 --> -0.161146).  Saving model ...
Epoch: 12 cost time: 1.6098065376281738
Epoch: 12, Steps: 10 | Train Loss: 1.906 Vali Loss: 3.062 Vali Acc: 0.171 Test Loss: 3.062 Test Acc: 0.171
Validation loss decreased (-0.161146 --> -0.170558).  Saving model ...
Epoch: 13 cost time: 1.6680347919464111
Epoch: 13, Steps: 10 | Train Loss: 1.711 Vali Loss: 3.008 Vali Acc: 0.192 Test Loss: 3.008 Test Acc: 0.192
Validation loss decreased (-0.170558 --> -0.191735).  Saving model ...
Epoch: 14 cost time: 1.6463472843170166
Epoch: 14, Steps: 10 | Train Loss: 1.553 Vali Loss: 2.991 Vali Acc: 0.186 Test Loss: 2.991 Test Acc: 0.186
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5312769412994385
Epoch: 15, Steps: 10 | Train Loss: 1.403 Vali Loss: 2.945 Vali Acc: 0.209 Test Loss: 2.945 Test Acc: 0.209
Validation loss decreased (-0.191735 --> -0.209382).  Saving model ...
Epoch: 16 cost time: 1.5131285190582275
Epoch: 16, Steps: 10 | Train Loss: 1.206 Vali Loss: 2.917 Vali Acc: 0.218 Test Loss: 2.917 Test Acc: 0.218
Validation loss decreased (-0.209382 --> -0.217618).  Saving model ...
Epoch: 17 cost time: 1.2588179111480713
Epoch: 17, Steps: 10 | Train Loss: 1.045 Vali Loss: 2.930 Vali Acc: 0.229 Test Loss: 2.930 Test Acc: 0.229
Validation loss decreased (-0.217618 --> -0.229382).  Saving model ...
Epoch: 18 cost time: 1.6035962104797363
Epoch: 18, Steps: 10 | Train Loss: 0.930 Vali Loss: 2.889 Vali Acc: 0.235 Test Loss: 2.889 Test Acc: 0.235
Validation loss decreased (-0.229382 --> -0.235265).  Saving model ...
Epoch: 19 cost time: 1.2889766693115234
Epoch: 19, Steps: 10 | Train Loss: 0.805 Vali Loss: 2.893 Vali Acc: 0.255 Test Loss: 2.893 Test Acc: 0.255
Validation loss decreased (-0.235265 --> -0.255265).  Saving model ...
Epoch: 20 cost time: 1.7901582717895508
Epoch: 20, Steps: 10 | Train Loss: 0.685 Vali Loss: 2.895 Vali Acc: 0.245 Test Loss: 2.895 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6601548194885254
Epoch: 21, Steps: 10 | Train Loss: 0.525 Vali Loss: 2.885 Vali Acc: 0.267 Test Loss: 2.885 Test Acc: 0.267
Validation loss decreased (-0.255265 --> -0.267030).  Saving model ...
Epoch: 22 cost time: 1.7421085834503174
Epoch: 22, Steps: 10 | Train Loss: 0.463 Vali Loss: 2.911 Vali Acc: 0.268 Test Loss: 2.911 Test Acc: 0.268
Validation loss decreased (-0.267030 --> -0.268206).  Saving model ...
Epoch: 23 cost time: 1.7715506553649902
Epoch: 23, Steps: 10 | Train Loss: 0.422 Vali Loss: 2.915 Vali Acc: 0.267 Test Loss: 2.915 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.8169670104980469
Epoch: 24, Steps: 10 | Train Loss: 0.327 Vali Loss: 2.878 Vali Acc: 0.291 Test Loss: 2.878 Test Acc: 0.291
Validation loss decreased (-0.268206 --> -0.290559).  Saving model ...
Epoch: 25 cost time: 1.7184243202209473
Epoch: 25, Steps: 10 | Train Loss: 0.342 Vali Loss: 2.895 Vali Acc: 0.282 Test Loss: 2.895 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.7568511962890625
Epoch: 26, Steps: 10 | Train Loss: 0.325 Vali Loss: 2.927 Vali Acc: 0.281 Test Loss: 2.927 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.5544688701629639
Epoch: 27, Steps: 10 | Train Loss: 0.234 Vali Loss: 2.879 Vali Acc: 0.301 Test Loss: 2.879 Test Acc: 0.301
Validation loss decreased (-0.290559 --> -0.301148).  Saving model ...
Epoch: 28 cost time: 1.585343360900879
Epoch: 28, Steps: 10 | Train Loss: 0.205 Vali Loss: 2.888 Vali Acc: 0.296 Test Loss: 2.888 Test Acc: 0.296
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.6092333793640137
Epoch: 29, Steps: 10 | Train Loss: 0.175 Vali Loss: 2.898 Vali Acc: 0.305 Test Loss: 2.898 Test Acc: 0.305
Validation loss decreased (-0.301148 --> -0.304677).  Saving model ...
Epoch: 30 cost time: 1.5635831356048584
Epoch: 30, Steps: 10 | Train Loss: 0.142 Vali Loss: 2.901 Vali Acc: 0.302 Test Loss: 2.901 Test Acc: 0.302
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.30470588235294116
model parameter : 911650
model size : 3.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.8260841369628906
Epoch: 1, Steps: 10 | Train Loss: 3.332 Vali Loss: 3.300 Vali Acc: 0.033 Test Loss: 3.300 Test Acc: 0.033
Validation loss decreased (inf --> -0.032908).  Saving model ...
Epoch: 2 cost time: 1.2830266952514648
Epoch: 2, Steps: 10 | Train Loss: 3.283 Vali Loss: 3.290 Vali Acc: 0.035 Test Loss: 3.290 Test Acc: 0.035
Validation loss decreased (-0.032908 --> -0.035261).  Saving model ...
Epoch: 3 cost time: 1.3111283779144287
Epoch: 3, Steps: 10 | Train Loss: 3.193 Vali Loss: 3.281 Vali Acc: 0.045 Test Loss: 3.281 Test Acc: 0.045
Validation loss decreased (-0.035261 --> -0.044673).  Saving model ...
Epoch: 4 cost time: 1.3070638179779053
Epoch: 4, Steps: 10 | Train Loss: 3.152 Vali Loss: 3.280 Vali Acc: 0.048 Test Loss: 3.280 Test Acc: 0.048
Validation loss decreased (-0.044673 --> -0.048202).  Saving model ...
Epoch: 5 cost time: 1.2931976318359375
Epoch: 5, Steps: 10 | Train Loss: 3.021 Vali Loss: 3.279 Vali Acc: 0.055 Test Loss: 3.279 Test Acc: 0.055
Validation loss decreased (-0.048202 --> -0.055261).  Saving model ...
Epoch: 6 cost time: 1.2802660465240479
Epoch: 6, Steps: 10 | Train Loss: 2.941 Vali Loss: 3.276 Vali Acc: 0.087 Test Loss: 3.276 Test Acc: 0.087
Validation loss decreased (-0.055261 --> -0.087026).  Saving model ...
Epoch: 7 cost time: 1.2112643718719482
Epoch: 7, Steps: 10 | Train Loss: 2.874 Vali Loss: 3.262 Vali Acc: 0.094 Test Loss: 3.262 Test Acc: 0.094
Validation loss decreased (-0.087026 --> -0.094085).  Saving model ...
Epoch: 8 cost time: 1.099438190460205
Epoch: 8, Steps: 10 | Train Loss: 2.761 Vali Loss: 3.244 Vali Acc: 0.107 Test Loss: 3.244 Test Acc: 0.107
Validation loss decreased (-0.094085 --> -0.107026).  Saving model ...
Epoch: 9 cost time: 1.1794462203979492
Epoch: 9, Steps: 10 | Train Loss: 2.645 Vali Loss: 3.223 Vali Acc: 0.116 Test Loss: 3.223 Test Acc: 0.116
Validation loss decreased (-0.107026 --> -0.116438).  Saving model ...
Epoch: 10 cost time: 1.158076524734497
Epoch: 10, Steps: 10 | Train Loss: 2.527 Vali Loss: 3.202 Vali Acc: 0.121 Test Loss: 3.202 Test Acc: 0.121
Validation loss decreased (-0.116438 --> -0.121144).  Saving model ...
Epoch: 11 cost time: 1.1615285873413086
Epoch: 11, Steps: 10 | Train Loss: 2.401 Vali Loss: 3.188 Vali Acc: 0.126 Test Loss: 3.188 Test Acc: 0.126
Validation loss decreased (-0.121144 --> -0.125850).  Saving model ...
Epoch: 12 cost time: 1.2020502090454102
Epoch: 12, Steps: 10 | Train Loss: 2.294 Vali Loss: 3.161 Vali Acc: 0.128 Test Loss: 3.161 Test Acc: 0.128
Validation loss decreased (-0.125850 --> -0.128204).  Saving model ...
Epoch: 13 cost time: 1.2931797504425049
Epoch: 13, Steps: 10 | Train Loss: 2.186 Vali Loss: 3.129 Vali Acc: 0.146 Test Loss: 3.129 Test Acc: 0.146
Validation loss decreased (-0.128204 --> -0.145851).  Saving model ...
Epoch: 14 cost time: 1.2730703353881836
Epoch: 14, Steps: 10 | Train Loss: 1.999 Vali Loss: 3.119 Vali Acc: 0.151 Test Loss: 3.119 Test Acc: 0.151
Validation loss decreased (-0.145851 --> -0.150557).  Saving model ...
Epoch: 15 cost time: 1.2184464931488037
Epoch: 15, Steps: 10 | Train Loss: 1.851 Vali Loss: 3.087 Vali Acc: 0.162 Test Loss: 3.087 Test Acc: 0.162
Validation loss decreased (-0.150557 --> -0.162322).  Saving model ...
Epoch: 16 cost time: 1.2784149646759033
Epoch: 16, Steps: 10 | Train Loss: 1.750 Vali Loss: 3.071 Vali Acc: 0.168 Test Loss: 3.071 Test Acc: 0.168
Validation loss decreased (-0.162322 --> -0.168205).  Saving model ...
Epoch: 17 cost time: 1.234365701675415
Epoch: 17, Steps: 10 | Train Loss: 1.588 Vali Loss: 3.054 Vali Acc: 0.187 Test Loss: 3.054 Test Acc: 0.187
Validation loss decreased (-0.168205 --> -0.187028).  Saving model ...
Epoch: 18 cost time: 1.2387278079986572
Epoch: 18, Steps: 10 | Train Loss: 1.435 Vali Loss: 3.045 Vali Acc: 0.172 Test Loss: 3.045 Test Acc: 0.172
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2546954154968262
Epoch: 19, Steps: 10 | Train Loss: 1.367 Vali Loss: 3.026 Vali Acc: 0.191 Test Loss: 3.026 Test Acc: 0.191
Validation loss decreased (-0.187028 --> -0.190558).  Saving model ...
Epoch: 20 cost time: 1.1160838603973389
Epoch: 20, Steps: 10 | Train Loss: 1.196 Vali Loss: 3.022 Vali Acc: 0.191 Test Loss: 3.022 Test Acc: 0.191
Validation loss decreased (-0.190558 --> -0.190558).  Saving model ...
Epoch: 21 cost time: 1.2080254554748535
Epoch: 21, Steps: 10 | Train Loss: 1.028 Vali Loss: 2.985 Vali Acc: 0.208 Test Loss: 2.985 Test Acc: 0.208
Validation loss decreased (-0.190558 --> -0.208205).  Saving model ...
Epoch: 22 cost time: 1.1398379802703857
Epoch: 22, Steps: 10 | Train Loss: 0.990 Vali Loss: 3.008 Vali Acc: 0.200 Test Loss: 3.008 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1526765823364258
Epoch: 23, Steps: 10 | Train Loss: 0.769 Vali Loss: 2.979 Vali Acc: 0.235 Test Loss: 2.979 Test Acc: 0.235
Validation loss decreased (-0.208205 --> -0.235264).  Saving model ...
Epoch: 24 cost time: 1.1990606784820557
Epoch: 24, Steps: 10 | Train Loss: 0.728 Vali Loss: 2.964 Vali Acc: 0.222 Test Loss: 2.964 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.242809772491455
Epoch: 25, Steps: 10 | Train Loss: 0.638 Vali Loss: 2.929 Vali Acc: 0.242 Test Loss: 2.929 Test Acc: 0.242
Validation loss decreased (-0.235264 --> -0.242324).  Saving model ...
Epoch: 26 cost time: 1.312739372253418
Epoch: 26, Steps: 10 | Train Loss: 0.578 Vali Loss: 3.026 Vali Acc: 0.220 Test Loss: 3.026 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1995809078216553
Epoch: 27, Steps: 10 | Train Loss: 0.487 Vali Loss: 3.011 Vali Acc: 0.238 Test Loss: 3.011 Test Acc: 0.238
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.213193655014038
Epoch: 28, Steps: 10 | Train Loss: 0.426 Vali Loss: 2.996 Vali Acc: 0.241 Test Loss: 2.996 Test Acc: 0.241
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.2830536365509033
Epoch: 29, Steps: 10 | Train Loss: 0.371 Vali Loss: 2.980 Vali Acc: 0.253 Test Loss: 2.980 Test Acc: 0.253
Validation loss decreased (-0.242324 --> -0.252911).  Saving model ...
Epoch: 30 cost time: 1.294966697692871
Epoch: 30, Steps: 10 | Train Loss: 0.338 Vali Loss: 2.968 Vali Acc: 0.264 Test Loss: 2.968 Test Acc: 0.264
Validation loss decreased (-0.252911 --> -0.263500).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2635294117647059
model parameter : 290674
model size : 1.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.0409739017486572
Epoch: 1, Steps: 10 | Train Loss: 3.354 Vali Loss: 3.305 Vali Acc: 0.046 Test Loss: 3.305 Test Acc: 0.046
Validation loss decreased (inf --> -0.045849).  Saving model ...
Epoch: 2 cost time: 1.1792385578155518
Epoch: 2, Steps: 10 | Train Loss: 3.291 Vali Loss: 3.288 Vali Acc: 0.044 Test Loss: 3.288 Test Acc: 0.044
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.232621431350708
Epoch: 3, Steps: 10 | Train Loss: 3.226 Vali Loss: 3.271 Vali Acc: 0.046 Test Loss: 3.271 Test Acc: 0.046
Validation loss decreased (-0.045849 --> -0.045850).  Saving model ...
Epoch: 4 cost time: 1.2451612949371338
Epoch: 4, Steps: 10 | Train Loss: 3.132 Vali Loss: 3.262 Vali Acc: 0.073 Test Loss: 3.262 Test Acc: 0.073
Validation loss decreased (-0.045850 --> -0.072909).  Saving model ...
Epoch: 5 cost time: 1.1975398063659668
Epoch: 5, Steps: 10 | Train Loss: 2.993 Vali Loss: 3.259 Vali Acc: 0.080 Test Loss: 3.259 Test Acc: 0.080
Validation loss decreased (-0.072909 --> -0.079967).  Saving model ...
Epoch: 6 cost time: 1.163360834121704
Epoch: 6, Steps: 10 | Train Loss: 2.893 Vali Loss: 3.240 Vali Acc: 0.096 Test Loss: 3.240 Test Acc: 0.096
Validation loss decreased (-0.079967 --> -0.096438).  Saving model ...
Epoch: 7 cost time: 1.3042676448822021
Epoch: 7, Steps: 10 | Train Loss: 2.794 Vali Loss: 3.208 Vali Acc: 0.115 Test Loss: 3.208 Test Acc: 0.115
Validation loss decreased (-0.096438 --> -0.115262).  Saving model ...
Epoch: 8 cost time: 1.3412775993347168
Epoch: 8, Steps: 10 | Train Loss: 2.709 Vali Loss: 3.196 Vali Acc: 0.122 Test Loss: 3.196 Test Acc: 0.122
Validation loss decreased (-0.115262 --> -0.122321).  Saving model ...
Epoch: 9 cost time: 1.3408777713775635
Epoch: 9, Steps: 10 | Train Loss: 2.579 Vali Loss: 3.161 Vali Acc: 0.145 Test Loss: 3.161 Test Acc: 0.145
Validation loss decreased (-0.122321 --> -0.144674).  Saving model ...
Epoch: 10 cost time: 1.3391597270965576
Epoch: 10, Steps: 10 | Train Loss: 2.383 Vali Loss: 3.129 Vali Acc: 0.160 Test Loss: 3.129 Test Acc: 0.160
Validation loss decreased (-0.144674 --> -0.159969).  Saving model ...
Epoch: 11 cost time: 1.2883780002593994
Epoch: 11, Steps: 10 | Train Loss: 2.189 Vali Loss: 3.099 Vali Acc: 0.184 Test Loss: 3.099 Test Acc: 0.184
Validation loss decreased (-0.159969 --> -0.183498).  Saving model ...
Epoch: 12 cost time: 1.3151686191558838
Epoch: 12, Steps: 10 | Train Loss: 2.007 Vali Loss: 3.079 Vali Acc: 0.184 Test Loss: 3.079 Test Acc: 0.184
Validation loss decreased (-0.183498 --> -0.183499).  Saving model ...
Epoch: 13 cost time: 1.2888171672821045
Epoch: 13, Steps: 10 | Train Loss: 1.850 Vali Loss: 3.025 Vali Acc: 0.209 Test Loss: 3.025 Test Acc: 0.209
Validation loss decreased (-0.183499 --> -0.209382).  Saving model ...
Epoch: 14 cost time: 1.408078670501709
Epoch: 14, Steps: 10 | Train Loss: 1.638 Vali Loss: 2.998 Vali Acc: 0.216 Test Loss: 2.998 Test Acc: 0.216
Validation loss decreased (-0.209382 --> -0.216441).  Saving model ...
Epoch: 15 cost time: 1.367321491241455
Epoch: 15, Steps: 10 | Train Loss: 1.498 Vali Loss: 2.970 Vali Acc: 0.226 Test Loss: 2.970 Test Acc: 0.226
Validation loss decreased (-0.216441 --> -0.225853).  Saving model ...
Epoch: 16 cost time: 1.1831140518188477
Epoch: 16, Steps: 10 | Train Loss: 1.287 Vali Loss: 2.936 Vali Acc: 0.235 Test Loss: 2.936 Test Acc: 0.235
Validation loss decreased (-0.225853 --> -0.235265).  Saving model ...
Epoch: 17 cost time: 1.2036662101745605
Epoch: 17, Steps: 10 | Train Loss: 1.246 Vali Loss: 2.947 Vali Acc: 0.238 Test Loss: 2.947 Test Acc: 0.238
Validation loss decreased (-0.235265 --> -0.237618).  Saving model ...
Epoch: 18 cost time: 1.1965203285217285
Epoch: 18, Steps: 10 | Train Loss: 1.026 Vali Loss: 2.906 Vali Acc: 0.258 Test Loss: 2.906 Test Acc: 0.258
Validation loss decreased (-0.237618 --> -0.257618).  Saving model ...
Epoch: 19 cost time: 1.2409982681274414
Epoch: 19, Steps: 10 | Train Loss: 0.901 Vali Loss: 2.911 Vali Acc: 0.261 Test Loss: 2.911 Test Acc: 0.261
Validation loss decreased (-0.257618 --> -0.261147).  Saving model ...
Epoch: 20 cost time: 0.9560866355895996
Epoch: 20, Steps: 10 | Train Loss: 0.749 Vali Loss: 2.911 Vali Acc: 0.274 Test Loss: 2.911 Test Acc: 0.274
Validation loss decreased (-0.261147 --> -0.274089).  Saving model ...
Epoch: 21 cost time: 1.324578046798706
Epoch: 21, Steps: 10 | Train Loss: 0.663 Vali Loss: 2.900 Vali Acc: 0.280 Test Loss: 2.900 Test Acc: 0.280
Validation loss decreased (-0.274089 --> -0.279971).  Saving model ...
Epoch: 22 cost time: 1.3321828842163086
Epoch: 22, Steps: 10 | Train Loss: 0.582 Vali Loss: 2.919 Vali Acc: 0.286 Test Loss: 2.919 Test Acc: 0.286
Validation loss decreased (-0.279971 --> -0.285853).  Saving model ...
Epoch: 23 cost time: 1.344712257385254
Epoch: 23, Steps: 10 | Train Loss: 0.462 Vali Loss: 2.915 Vali Acc: 0.288 Test Loss: 2.915 Test Acc: 0.288
Validation loss decreased (-0.285853 --> -0.288206).  Saving model ...
Epoch: 24 cost time: 1.3316521644592285
Epoch: 24, Steps: 10 | Train Loss: 0.378 Vali Loss: 2.900 Vali Acc: 0.301 Test Loss: 2.900 Test Acc: 0.301
Validation loss decreased (-0.288206 --> -0.301147).  Saving model ...
Epoch: 25 cost time: 1.3056669235229492
Epoch: 25, Steps: 10 | Train Loss: 0.377 Vali Loss: 2.888 Vali Acc: 0.294 Test Loss: 2.888 Test Acc: 0.294
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3695499897003174
Epoch: 26, Steps: 10 | Train Loss: 0.442 Vali Loss: 2.881 Vali Acc: 0.313 Test Loss: 2.881 Test Acc: 0.313
Validation loss decreased (-0.301147 --> -0.312912).  Saving model ...
Epoch: 27 cost time: 1.325836420059204
Epoch: 27, Steps: 10 | Train Loss: 0.260 Vali Loss: 2.934 Vali Acc: 0.313 Test Loss: 2.934 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3572309017181396
Epoch: 28, Steps: 10 | Train Loss: 0.256 Vali Loss: 2.913 Vali Acc: 0.315 Test Loss: 2.913 Test Acc: 0.315
Validation loss decreased (-0.312912 --> -0.315265).  Saving model ...
Epoch: 29 cost time: 1.1679408550262451
Epoch: 29, Steps: 10 | Train Loss: 0.240 Vali Loss: 2.916 Vali Acc: 0.315 Test Loss: 2.916 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1808242797851562
Epoch: 30, Steps: 10 | Train Loss: 0.261 Vali Loss: 2.940 Vali Acc: 0.321 Test Loss: 2.940 Test Acc: 0.321
Validation loss decreased (-0.315265 --> -0.321147).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3211764705882353
model parameter : 911650
model size : 3.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.4401066303253174
Epoch: 1, Steps: 10 | Train Loss: 3.336 Vali Loss: 3.298 Vali Acc: 0.036 Test Loss: 3.298 Test Acc: 0.036
Validation loss decreased (inf --> -0.036438).  Saving model ...
Epoch: 2 cost time: 0.7646434307098389
Epoch: 2, Steps: 10 | Train Loss: 3.283 Vali Loss: 3.287 Vali Acc: 0.034 Test Loss: 3.287 Test Acc: 0.034
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0061399936676025
Epoch: 3, Steps: 10 | Train Loss: 3.190 Vali Loss: 3.279 Vali Acc: 0.046 Test Loss: 3.279 Test Acc: 0.046
Validation loss decreased (-0.036438 --> -0.045850).  Saving model ...
Epoch: 4 cost time: 0.9828732013702393
Epoch: 4, Steps: 10 | Train Loss: 3.163 Vali Loss: 3.280 Vali Acc: 0.051 Test Loss: 3.280 Test Acc: 0.051
Validation loss decreased (-0.045850 --> -0.050555).  Saving model ...
Epoch: 5 cost time: 0.7715582847595215
Epoch: 5, Steps: 10 | Train Loss: 3.027 Vali Loss: 3.279 Vali Acc: 0.067 Test Loss: 3.279 Test Acc: 0.067
Validation loss decreased (-0.050555 --> -0.067026).  Saving model ...
Epoch: 6 cost time: 0.7494969367980957
Epoch: 6, Steps: 10 | Train Loss: 2.953 Vali Loss: 3.277 Vali Acc: 0.086 Test Loss: 3.277 Test Acc: 0.086
Validation loss decreased (-0.067026 --> -0.085850).  Saving model ...
Epoch: 7 cost time: 0.7450664043426514
Epoch: 7, Steps: 10 | Train Loss: 2.877 Vali Loss: 3.262 Vali Acc: 0.093 Test Loss: 3.262 Test Acc: 0.093
Validation loss decreased (-0.085850 --> -0.092909).  Saving model ...
Epoch: 8 cost time: 0.7148661613464355
Epoch: 8, Steps: 10 | Train Loss: 2.767 Vali Loss: 3.252 Vali Acc: 0.105 Test Loss: 3.252 Test Acc: 0.105
Validation loss decreased (-0.092909 --> -0.104673).  Saving model ...
Epoch: 9 cost time: 0.7480113506317139
Epoch: 9, Steps: 10 | Train Loss: 2.682 Vali Loss: 3.229 Vali Acc: 0.107 Test Loss: 3.229 Test Acc: 0.107
Validation loss decreased (-0.104673 --> -0.107027).  Saving model ...
Epoch: 10 cost time: 0.7207119464874268
Epoch: 10, Steps: 10 | Train Loss: 2.567 Vali Loss: 3.207 Vali Acc: 0.118 Test Loss: 3.207 Test Acc: 0.118
Validation loss decreased (-0.107027 --> -0.117615).  Saving model ...
Epoch: 11 cost time: 0.8183085918426514
Epoch: 11, Steps: 10 | Train Loss: 2.443 Vali Loss: 3.191 Vali Acc: 0.121 Test Loss: 3.191 Test Acc: 0.121
Validation loss decreased (-0.117615 --> -0.121145).  Saving model ...
Epoch: 12 cost time: 0.895050048828125
Epoch: 12, Steps: 10 | Train Loss: 2.354 Vali Loss: 3.176 Vali Acc: 0.125 Test Loss: 3.176 Test Acc: 0.125
Validation loss decreased (-0.121145 --> -0.124674).  Saving model ...
Epoch: 13 cost time: 0.9157958030700684
Epoch: 13, Steps: 10 | Train Loss: 2.227 Vali Loss: 3.149 Vali Acc: 0.133 Test Loss: 3.149 Test Acc: 0.133
Validation loss decreased (-0.124674 --> -0.132910).  Saving model ...
Epoch: 14 cost time: 0.973496675491333
Epoch: 14, Steps: 10 | Train Loss: 2.076 Vali Loss: 3.146 Vali Acc: 0.146 Test Loss: 3.146 Test Acc: 0.146
Validation loss decreased (-0.132910 --> -0.145851).  Saving model ...
Epoch: 15 cost time: 0.9744594097137451
Epoch: 15, Steps: 10 | Train Loss: 1.978 Vali Loss: 3.120 Vali Acc: 0.149 Test Loss: 3.120 Test Acc: 0.149
Validation loss decreased (-0.145851 --> -0.149381).  Saving model ...
Epoch: 16 cost time: 0.9552791118621826
Epoch: 16, Steps: 10 | Train Loss: 1.812 Vali Loss: 3.098 Vali Acc: 0.158 Test Loss: 3.098 Test Acc: 0.158
Validation loss decreased (-0.149381 --> -0.157616).  Saving model ...
Epoch: 17 cost time: 0.9668426513671875
Epoch: 17, Steps: 10 | Train Loss: 1.655 Vali Loss: 3.078 Vali Acc: 0.169 Test Loss: 3.078 Test Acc: 0.169
Validation loss decreased (-0.157616 --> -0.169381).  Saving model ...
Epoch: 18 cost time: 0.836784839630127
Epoch: 18, Steps: 10 | Train Loss: 1.476 Vali Loss: 3.086 Vali Acc: 0.169 Test Loss: 3.086 Test Acc: 0.169
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8859858512878418
Epoch: 19, Steps: 10 | Train Loss: 1.375 Vali Loss: 3.028 Vali Acc: 0.175 Test Loss: 3.028 Test Acc: 0.175
Validation loss decreased (-0.169381 --> -0.175264).  Saving model ...
Epoch: 20 cost time: 0.8833718299865723
Epoch: 20, Steps: 10 | Train Loss: 1.212 Vali Loss: 3.019 Vali Acc: 0.184 Test Loss: 3.019 Test Acc: 0.184
Validation loss decreased (-0.175264 --> -0.183499).  Saving model ...
Epoch: 21 cost time: 0.7431628704071045
Epoch: 21, Steps: 10 | Train Loss: 1.076 Vali Loss: 3.015 Vali Acc: 0.195 Test Loss: 3.015 Test Acc: 0.195
Validation loss decreased (-0.183499 --> -0.195264).  Saving model ...
Epoch: 22 cost time: 0.919144868850708
Epoch: 22, Steps: 10 | Train Loss: 1.005 Vali Loss: 3.017 Vali Acc: 0.208 Test Loss: 3.017 Test Acc: 0.208
Validation loss decreased (-0.195264 --> -0.208205).  Saving model ...
Epoch: 23 cost time: 1.0033631324768066
Epoch: 23, Steps: 10 | Train Loss: 0.821 Vali Loss: 3.004 Vali Acc: 0.233 Test Loss: 3.004 Test Acc: 0.233
Validation loss decreased (-0.208205 --> -0.232911).  Saving model ...
Epoch: 24 cost time: 0.835338830947876
Epoch: 24, Steps: 10 | Train Loss: 0.798 Vali Loss: 3.000 Vali Acc: 0.244 Test Loss: 3.000 Test Acc: 0.244
Validation loss decreased (-0.232911 --> -0.243499).  Saving model ...
Epoch: 25 cost time: 0.929908275604248
Epoch: 25, Steps: 10 | Train Loss: 0.685 Vali Loss: 2.978 Vali Acc: 0.241 Test Loss: 2.978 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9703447818756104
Epoch: 26, Steps: 10 | Train Loss: 0.672 Vali Loss: 2.988 Vali Acc: 0.240 Test Loss: 2.988 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8923499584197998
Epoch: 27, Steps: 10 | Train Loss: 0.619 Vali Loss: 3.045 Vali Acc: 0.259 Test Loss: 3.045 Test Acc: 0.259
Validation loss decreased (-0.243499 --> -0.258793).  Saving model ...
Epoch: 28 cost time: 0.9499621391296387
Epoch: 28, Steps: 10 | Train Loss: 0.479 Vali Loss: 3.001 Vali Acc: 0.258 Test Loss: 3.001 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8703291416168213
Epoch: 29, Steps: 10 | Train Loss: 0.410 Vali Loss: 3.003 Vali Acc: 0.266 Test Loss: 3.003 Test Acc: 0.266
Validation loss decreased (-0.258793 --> -0.265852).  Saving model ...
Epoch: 30 cost time: 0.8792598247528076
Epoch: 30, Steps: 10 | Train Loss: 0.412 Vali Loss: 2.997 Vali Acc: 0.272 Test Loss: 2.997 Test Acc: 0.272
Validation loss decreased (-0.265852 --> -0.271735).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27176470588235296
model parameter : 290674
model size : 1.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.3271267414093018
Epoch: 1, Steps: 10 | Train Loss: 3.355 Vali Loss: 3.303 Vali Acc: 0.051 Test Loss: 3.303 Test Acc: 0.051
Validation loss decreased (inf --> -0.050555).  Saving model ...
Epoch: 2 cost time: 0.8578908443450928
Epoch: 2, Steps: 10 | Train Loss: 3.282 Vali Loss: 3.285 Vali Acc: 0.053 Test Loss: 3.285 Test Acc: 0.053
Validation loss decreased (-0.050555 --> -0.052908).  Saving model ...
Epoch: 3 cost time: 0.7907636165618896
Epoch: 3, Steps: 10 | Train Loss: 3.217 Vali Loss: 3.272 Vali Acc: 0.051 Test Loss: 3.272 Test Acc: 0.051
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7933659553527832
Epoch: 4, Steps: 10 | Train Loss: 3.120 Vali Loss: 3.267 Vali Acc: 0.064 Test Loss: 3.267 Test Acc: 0.064
Validation loss decreased (-0.052908 --> -0.063497).  Saving model ...
Epoch: 5 cost time: 0.8033390045166016
Epoch: 5, Steps: 10 | Train Loss: 2.981 Vali Loss: 3.267 Vali Acc: 0.076 Test Loss: 3.267 Test Acc: 0.076
Validation loss decreased (-0.063497 --> -0.076438).  Saving model ...
Epoch: 6 cost time: 0.6358127593994141
Epoch: 6, Steps: 10 | Train Loss: 2.912 Vali Loss: 3.251 Vali Acc: 0.088 Test Loss: 3.251 Test Acc: 0.088
Validation loss decreased (-0.076438 --> -0.088203).  Saving model ...
Epoch: 7 cost time: 0.7734947204589844
Epoch: 7, Steps: 10 | Train Loss: 2.830 Vali Loss: 3.231 Vali Acc: 0.106 Test Loss: 3.231 Test Acc: 0.106
Validation loss decreased (-0.088203 --> -0.105850).  Saving model ...
Epoch: 8 cost time: 0.6974823474884033
Epoch: 8, Steps: 10 | Train Loss: 2.712 Vali Loss: 3.224 Vali Acc: 0.119 Test Loss: 3.224 Test Acc: 0.119
Validation loss decreased (-0.105850 --> -0.118791).  Saving model ...
Epoch: 9 cost time: 0.8643262386322021
Epoch: 9, Steps: 10 | Train Loss: 2.633 Vali Loss: 3.198 Vali Acc: 0.129 Test Loss: 3.198 Test Acc: 0.129
Validation loss decreased (-0.118791 --> -0.129380).  Saving model ...
Epoch: 10 cost time: 0.9029951095581055
Epoch: 10, Steps: 10 | Train Loss: 2.544 Vali Loss: 3.181 Vali Acc: 0.141 Test Loss: 3.181 Test Acc: 0.141
Validation loss decreased (-0.129380 --> -0.141145).  Saving model ...
Epoch: 11 cost time: 0.8901617527008057
Epoch: 11, Steps: 10 | Train Loss: 2.389 Vali Loss: 3.170 Vali Acc: 0.146 Test Loss: 3.170 Test Acc: 0.146
Validation loss decreased (-0.141145 --> -0.145851).  Saving model ...
Epoch: 12 cost time: 0.9097633361816406
Epoch: 12, Steps: 10 | Train Loss: 2.263 Vali Loss: 3.145 Vali Acc: 0.160 Test Loss: 3.145 Test Acc: 0.160
Validation loss decreased (-0.145851 --> -0.159969).  Saving model ...
Epoch: 13 cost time: 0.9373805522918701
Epoch: 13, Steps: 10 | Train Loss: 2.077 Vali Loss: 3.117 Vali Acc: 0.171 Test Loss: 3.117 Test Acc: 0.171
Validation loss decreased (-0.159969 --> -0.170557).  Saving model ...
Epoch: 14 cost time: 0.9182314872741699
Epoch: 14, Steps: 10 | Train Loss: 1.948 Vali Loss: 3.095 Vali Acc: 0.185 Test Loss: 3.095 Test Acc: 0.185
Validation loss decreased (-0.170557 --> -0.184675).  Saving model ...
Epoch: 15 cost time: 0.8160099983215332
Epoch: 15, Steps: 10 | Train Loss: 1.760 Vali Loss: 3.060 Vali Acc: 0.196 Test Loss: 3.060 Test Acc: 0.196
Validation loss decreased (-0.184675 --> -0.196440).  Saving model ...
Epoch: 16 cost time: 0.7940216064453125
Epoch: 16, Steps: 10 | Train Loss: 1.627 Vali Loss: 3.038 Vali Acc: 0.199 Test Loss: 3.038 Test Acc: 0.199
Validation loss decreased (-0.196440 --> -0.198793).  Saving model ...
Epoch: 17 cost time: 0.7696981430053711
Epoch: 17, Steps: 10 | Train Loss: 1.573 Vali Loss: 3.039 Vali Acc: 0.207 Test Loss: 3.039 Test Acc: 0.207
Validation loss decreased (-0.198793 --> -0.207028).  Saving model ...
Epoch: 18 cost time: 0.7604849338531494
Epoch: 18, Steps: 10 | Train Loss: 1.291 Vali Loss: 3.022 Vali Acc: 0.222 Test Loss: 3.022 Test Acc: 0.222
Validation loss decreased (-0.207028 --> -0.222323).  Saving model ...
Epoch: 19 cost time: 0.5990355014801025
Epoch: 19, Steps: 10 | Train Loss: 1.306 Vali Loss: 3.002 Vali Acc: 0.234 Test Loss: 3.002 Test Acc: 0.234
Validation loss decreased (-0.222323 --> -0.234088).  Saving model ...
Epoch: 20 cost time: 0.8463718891143799
Epoch: 20, Steps: 10 | Train Loss: 1.096 Vali Loss: 2.989 Vali Acc: 0.231 Test Loss: 2.989 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8265566825866699
Epoch: 21, Steps: 10 | Train Loss: 0.908 Vali Loss: 2.980 Vali Acc: 0.227 Test Loss: 2.980 Test Acc: 0.227
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8512499332427979
Epoch: 22, Steps: 10 | Train Loss: 0.876 Vali Loss: 2.971 Vali Acc: 0.247 Test Loss: 2.971 Test Acc: 0.247
Validation loss decreased (-0.234088 --> -0.247029).  Saving model ...
Epoch: 23 cost time: 0.8250198364257812
Epoch: 23, Steps: 10 | Train Loss: 0.830 Vali Loss: 2.968 Vali Acc: 0.259 Test Loss: 2.968 Test Acc: 0.259
Validation loss decreased (-0.247029 --> -0.258794).  Saving model ...
Epoch: 24 cost time: 0.9188516139984131
Epoch: 24, Steps: 10 | Train Loss: 0.684 Vali Loss: 2.935 Vali Acc: 0.276 Test Loss: 2.935 Test Acc: 0.276
Validation loss decreased (-0.258794 --> -0.276441).  Saving model ...
Epoch: 25 cost time: 0.9590826034545898
Epoch: 25, Steps: 10 | Train Loss: 0.635 Vali Loss: 2.946 Vali Acc: 0.275 Test Loss: 2.946 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8665587902069092
Epoch: 26, Steps: 10 | Train Loss: 0.579 Vali Loss: 2.972 Vali Acc: 0.289 Test Loss: 2.972 Test Acc: 0.289
Validation loss decreased (-0.276441 --> -0.289382).  Saving model ...
Epoch: 27 cost time: 0.9544167518615723
Epoch: 27, Steps: 10 | Train Loss: 0.464 Vali Loss: 2.936 Vali Acc: 0.300 Test Loss: 2.936 Test Acc: 0.300
Validation loss decreased (-0.289382 --> -0.299971).  Saving model ...
Epoch: 28 cost time: 0.7694592475891113
Epoch: 28, Steps: 10 | Train Loss: 0.390 Vali Loss: 2.962 Vali Acc: 0.304 Test Loss: 2.962 Test Acc: 0.304
Validation loss decreased (-0.299971 --> -0.303500).  Saving model ...
Epoch: 29 cost time: 0.8355867862701416
Epoch: 29, Steps: 10 | Train Loss: 0.431 Vali Loss: 2.944 Vali Acc: 0.311 Test Loss: 2.944 Test Acc: 0.311
Validation loss decreased (-0.303500 --> -0.310559).  Saving model ...
Epoch: 30 cost time: 0.6978490352630615
Epoch: 30, Steps: 10 | Train Loss: 0.410 Vali Loss: 2.973 Vali Acc: 0.296 Test Loss: 2.973 Test Acc: 0.296
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.31058823529411766
model parameter : 911650
model size : 3.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.0312414169311523
Epoch: 1, Steps: 10 | Train Loss: 3.326 Vali Loss: 3.301 Vali Acc: 0.029 Test Loss: 3.301 Test Acc: 0.029
Validation loss decreased (inf --> -0.029379).  Saving model ...
Epoch: 2 cost time: 0.8194699287414551
Epoch: 2, Steps: 10 | Train Loss: 3.273 Vali Loss: 3.294 Vali Acc: 0.025 Test Loss: 3.294 Test Acc: 0.025
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7526140213012695
Epoch: 3, Steps: 10 | Train Loss: 3.195 Vali Loss: 3.286 Vali Acc: 0.029 Test Loss: 3.286 Test Acc: 0.029
Validation loss decreased (-0.029379 --> -0.029379).  Saving model ...
Epoch: 4 cost time: 0.7241940498352051
Epoch: 4, Steps: 10 | Train Loss: 3.173 Vali Loss: 3.285 Vali Acc: 0.040 Test Loss: 3.285 Test Acc: 0.040
Validation loss decreased (-0.029379 --> -0.039967).  Saving model ...
Epoch: 5 cost time: 0.6755361557006836
Epoch: 5, Steps: 10 | Train Loss: 3.067 Vali Loss: 3.287 Vali Acc: 0.052 Test Loss: 3.287 Test Acc: 0.052
Validation loss decreased (-0.039967 --> -0.051732).  Saving model ...
Epoch: 6 cost time: 0.6439294815063477
Epoch: 6, Steps: 10 | Train Loss: 2.987 Vali Loss: 3.287 Vali Acc: 0.062 Test Loss: 3.287 Test Acc: 0.062
Validation loss decreased (-0.051732 --> -0.062320).  Saving model ...
Epoch: 7 cost time: 0.6836216449737549
Epoch: 7, Steps: 10 | Train Loss: 2.914 Vali Loss: 3.279 Vali Acc: 0.081 Test Loss: 3.279 Test Acc: 0.081
Validation loss decreased (-0.062320 --> -0.081144).  Saving model ...
Epoch: 8 cost time: 0.696026086807251
Epoch: 8, Steps: 10 | Train Loss: 2.825 Vali Loss: 3.273 Vali Acc: 0.093 Test Loss: 3.273 Test Acc: 0.093
Validation loss decreased (-0.081144 --> -0.092908).  Saving model ...
Epoch: 9 cost time: 0.7345099449157715
Epoch: 9, Steps: 10 | Train Loss: 2.762 Vali Loss: 3.269 Vali Acc: 0.105 Test Loss: 3.269 Test Acc: 0.105
Validation loss decreased (-0.092908 --> -0.104673).  Saving model ...
Epoch: 10 cost time: 0.761913537979126
Epoch: 10, Steps: 10 | Train Loss: 2.648 Vali Loss: 3.260 Vali Acc: 0.119 Test Loss: 3.260 Test Acc: 0.119
Validation loss decreased (-0.104673 --> -0.118791).  Saving model ...
Epoch: 11 cost time: 0.7143838405609131
Epoch: 11, Steps: 10 | Train Loss: 2.540 Vali Loss: 3.243 Vali Acc: 0.101 Test Loss: 3.243 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7881574630737305
Epoch: 12, Steps: 10 | Train Loss: 2.429 Vali Loss: 3.227 Vali Acc: 0.114 Test Loss: 3.227 Test Acc: 0.114
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.716733455657959
Epoch: 13, Steps: 10 | Train Loss: 2.324 Vali Loss: 3.219 Vali Acc: 0.127 Test Loss: 3.219 Test Acc: 0.127
Validation loss decreased (-0.118791 --> -0.127027).  Saving model ...
Epoch: 14 cost time: 0.7439553737640381
Epoch: 14, Steps: 10 | Train Loss: 2.233 Vali Loss: 3.217 Vali Acc: 0.131 Test Loss: 3.217 Test Acc: 0.131
Validation loss decreased (-0.127027 --> -0.130556).  Saving model ...
Epoch: 15 cost time: 0.7754743099212646
Epoch: 15, Steps: 10 | Train Loss: 2.154 Vali Loss: 3.192 Vali Acc: 0.138 Test Loss: 3.192 Test Acc: 0.138
Validation loss decreased (-0.130556 --> -0.137615).  Saving model ...
Epoch: 16 cost time: 0.759282112121582
Epoch: 16, Steps: 10 | Train Loss: 2.061 Vali Loss: 3.181 Vali Acc: 0.138 Test Loss: 3.181 Test Acc: 0.138
Validation loss decreased (-0.137615 --> -0.137615).  Saving model ...
Epoch: 17 cost time: 0.7686443328857422
Epoch: 17, Steps: 10 | Train Loss: 1.915 Vali Loss: 3.155 Vali Acc: 0.146 Test Loss: 3.155 Test Acc: 0.146
Validation loss decreased (-0.137615 --> -0.145851).  Saving model ...
Epoch: 18 cost time: 0.5820136070251465
Epoch: 18, Steps: 10 | Train Loss: 1.750 Vali Loss: 3.147 Vali Acc: 0.152 Test Loss: 3.147 Test Acc: 0.152
Validation loss decreased (-0.145851 --> -0.151733).  Saving model ...
Epoch: 19 cost time: 0.7010440826416016
Epoch: 19, Steps: 10 | Train Loss: 1.625 Vali Loss: 3.139 Vali Acc: 0.158 Test Loss: 3.139 Test Acc: 0.158
Validation loss decreased (-0.151733 --> -0.157616).  Saving model ...
Epoch: 20 cost time: 0.7048954963684082
Epoch: 20, Steps: 10 | Train Loss: 1.499 Vali Loss: 3.124 Vali Acc: 0.166 Test Loss: 3.124 Test Acc: 0.166
Validation loss decreased (-0.157616 --> -0.165851).  Saving model ...
Epoch: 21 cost time: 0.7967710494995117
Epoch: 21, Steps: 10 | Train Loss: 1.467 Vali Loss: 3.158 Vali Acc: 0.173 Test Loss: 3.158 Test Acc: 0.173
Validation loss decreased (-0.165851 --> -0.172910).  Saving model ...
Epoch: 22 cost time: 0.8139457702636719
Epoch: 22, Steps: 10 | Train Loss: 1.293 Vali Loss: 3.118 Vali Acc: 0.178 Test Loss: 3.118 Test Acc: 0.178
Validation loss decreased (-0.172910 --> -0.177616).  Saving model ...
Epoch: 23 cost time: 0.7554850578308105
Epoch: 23, Steps: 10 | Train Loss: 1.151 Vali Loss: 3.089 Vali Acc: 0.196 Test Loss: 3.089 Test Acc: 0.196
Validation loss decreased (-0.177616 --> -0.196440).  Saving model ...
Epoch: 24 cost time: 0.7706992626190186
Epoch: 24, Steps: 10 | Train Loss: 1.067 Vali Loss: 3.098 Vali Acc: 0.196 Test Loss: 3.098 Test Acc: 0.196
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7395198345184326
Epoch: 25, Steps: 10 | Train Loss: 0.979 Vali Loss: 3.106 Vali Acc: 0.208 Test Loss: 3.106 Test Acc: 0.208
Validation loss decreased (-0.196440 --> -0.208204).  Saving model ...
Epoch: 26 cost time: 0.7188951969146729
Epoch: 26, Steps: 10 | Train Loss: 0.862 Vali Loss: 3.126 Vali Acc: 0.218 Test Loss: 3.126 Test Acc: 0.218
Validation loss decreased (-0.208204 --> -0.217616).  Saving model ...
Epoch: 27 cost time: 0.6043589115142822
Epoch: 27, Steps: 10 | Train Loss: 0.988 Vali Loss: 3.107 Vali Acc: 0.216 Test Loss: 3.107 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6645183563232422
Epoch: 28, Steps: 10 | Train Loss: 0.646 Vali Loss: 3.120 Vali Acc: 0.226 Test Loss: 3.120 Test Acc: 0.226
Validation loss decreased (-0.217616 --> -0.225851).  Saving model ...
Epoch: 29 cost time: 0.6668431758880615
Epoch: 29, Steps: 10 | Train Loss: 0.653 Vali Loss: 3.065 Vali Acc: 0.249 Test Loss: 3.065 Test Acc: 0.249
Validation loss decreased (-0.225851 --> -0.249381).  Saving model ...
Epoch: 30 cost time: 0.7254769802093506
Epoch: 30, Steps: 10 | Train Loss: 0.633 Vali Loss: 3.081 Vali Acc: 0.249 Test Loss: 3.081 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.24941176470588236
model parameter : 290674
model size : 1.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.863602876663208
Epoch: 1, Steps: 10 | Train Loss: 3.307 Vali Loss: 3.329 Vali Acc: 0.038 Test Loss: 3.329 Test Acc: 0.038
Validation loss decreased (inf --> -0.037614).  Saving model ...
Epoch: 2 cost time: 1.310657024383545
Epoch: 2, Steps: 10 | Train Loss: 3.280 Vali Loss: 3.313 Vali Acc: 0.036 Test Loss: 3.313 Test Acc: 0.036
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.261878490447998
Epoch: 3, Steps: 10 | Train Loss: 3.185 Vali Loss: 3.299 Vali Acc: 0.046 Test Loss: 3.299 Test Acc: 0.046
Validation loss decreased (-0.037614 --> -0.045849).  Saving model ...
Epoch: 4 cost time: 1.1938951015472412
Epoch: 4, Steps: 10 | Train Loss: 3.088 Vali Loss: 3.290 Vali Acc: 0.059 Test Loss: 3.290 Test Acc: 0.059
Validation loss decreased (-0.045849 --> -0.058791).  Saving model ...
Epoch: 5 cost time: 1.1645073890686035
Epoch: 5, Steps: 10 | Train Loss: 3.033 Vali Loss: 3.289 Vali Acc: 0.064 Test Loss: 3.289 Test Acc: 0.064
Validation loss decreased (-0.058791 --> -0.063497).  Saving model ...
Epoch: 6 cost time: 1.1892428398132324
Epoch: 6, Steps: 10 | Train Loss: 2.914 Vali Loss: 3.279 Vali Acc: 0.068 Test Loss: 3.279 Test Acc: 0.068
Validation loss decreased (-0.063497 --> -0.068203).  Saving model ...
Epoch: 7 cost time: 1.2600889205932617
Epoch: 7, Steps: 10 | Train Loss: 2.794 Vali Loss: 3.266 Vali Acc: 0.092 Test Loss: 3.266 Test Acc: 0.092
Validation loss decreased (-0.068203 --> -0.091732).  Saving model ...
Epoch: 8 cost time: 1.270392656326294
Epoch: 8, Steps: 10 | Train Loss: 2.692 Vali Loss: 3.244 Vali Acc: 0.107 Test Loss: 3.244 Test Acc: 0.107
Validation loss decreased (-0.091732 --> -0.107026).  Saving model ...
Epoch: 9 cost time: 1.2825219631195068
Epoch: 9, Steps: 10 | Train Loss: 2.592 Vali Loss: 3.223 Vali Acc: 0.107 Test Loss: 3.223 Test Acc: 0.107
Validation loss decreased (-0.107026 --> -0.107027).  Saving model ...
Epoch: 10 cost time: 1.346754789352417
Epoch: 10, Steps: 10 | Train Loss: 2.448 Vali Loss: 3.205 Vali Acc: 0.114 Test Loss: 3.205 Test Acc: 0.114
Validation loss decreased (-0.107027 --> -0.114086).  Saving model ...
Epoch: 11 cost time: 1.3265304565429688
Epoch: 11, Steps: 10 | Train Loss: 2.293 Vali Loss: 3.177 Vali Acc: 0.124 Test Loss: 3.177 Test Acc: 0.124
Validation loss decreased (-0.114086 --> -0.123498).  Saving model ...
Epoch: 12 cost time: 1.17877197265625
Epoch: 12, Steps: 10 | Train Loss: 2.140 Vali Loss: 3.152 Vali Acc: 0.140 Test Loss: 3.152 Test Acc: 0.140
Validation loss decreased (-0.123498 --> -0.139968).  Saving model ...
Epoch: 13 cost time: 1.1643776893615723
Epoch: 13, Steps: 10 | Train Loss: 1.999 Vali Loss: 3.129 Vali Acc: 0.151 Test Loss: 3.129 Test Acc: 0.151
Validation loss decreased (-0.139968 --> -0.150557).  Saving model ...
Epoch: 14 cost time: 1.2113008499145508
Epoch: 14, Steps: 10 | Train Loss: 1.909 Vali Loss: 3.087 Vali Acc: 0.164 Test Loss: 3.087 Test Acc: 0.164
Validation loss decreased (-0.150557 --> -0.163499).  Saving model ...
Epoch: 15 cost time: 1.280137538909912
Epoch: 15, Steps: 10 | Train Loss: 1.689 Vali Loss: 3.081 Vali Acc: 0.175 Test Loss: 3.081 Test Acc: 0.175
Validation loss decreased (-0.163499 --> -0.175263).  Saving model ...
Epoch: 16 cost time: 1.2660536766052246
Epoch: 16, Steps: 10 | Train Loss: 1.497 Vali Loss: 3.057 Vali Acc: 0.175 Test Loss: 3.057 Test Acc: 0.175
Validation loss decreased (-0.175263 --> -0.175264).  Saving model ...
Epoch: 17 cost time: 1.3516747951507568
Epoch: 17, Steps: 10 | Train Loss: 1.388 Vali Loss: 3.053 Vali Acc: 0.181 Test Loss: 3.053 Test Acc: 0.181
Validation loss decreased (-0.175264 --> -0.181146).  Saving model ...
Epoch: 18 cost time: 1.3420767784118652
Epoch: 18, Steps: 10 | Train Loss: 1.219 Vali Loss: 3.051 Vali Acc: 0.198 Test Loss: 3.051 Test Acc: 0.198
Validation loss decreased (-0.181146 --> -0.197617).  Saving model ...
Epoch: 19 cost time: 1.2068800926208496
Epoch: 19, Steps: 10 | Train Loss: 1.042 Vali Loss: 3.016 Vali Acc: 0.207 Test Loss: 3.016 Test Acc: 0.207
Validation loss decreased (-0.197617 --> -0.207029).  Saving model ...
Epoch: 20 cost time: 1.0665555000305176
Epoch: 20, Steps: 10 | Train Loss: 0.981 Vali Loss: 2.984 Vali Acc: 0.216 Test Loss: 2.984 Test Acc: 0.216
Validation loss decreased (-0.207029 --> -0.216441).  Saving model ...
Epoch: 21 cost time: 1.2079434394836426
Epoch: 21, Steps: 10 | Train Loss: 0.865 Vali Loss: 2.987 Vali Acc: 0.229 Test Loss: 2.987 Test Acc: 0.229
Validation loss decreased (-0.216441 --> -0.229382).  Saving model ...
Epoch: 22 cost time: 1.2903993129730225
Epoch: 22, Steps: 10 | Train Loss: 0.698 Vali Loss: 3.018 Vali Acc: 0.241 Test Loss: 3.018 Test Acc: 0.241
Validation loss decreased (-0.229382 --> -0.241146).  Saving model ...
Epoch: 23 cost time: 1.3025918006896973
Epoch: 23, Steps: 10 | Train Loss: 0.602 Vali Loss: 2.969 Vali Acc: 0.238 Test Loss: 2.969 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2755239009857178
Epoch: 24, Steps: 10 | Train Loss: 0.530 Vali Loss: 2.976 Vali Acc: 0.258 Test Loss: 2.976 Test Acc: 0.258
Validation loss decreased (-0.241146 --> -0.257617).  Saving model ...
Epoch: 25 cost time: 1.291741132736206
Epoch: 25, Steps: 10 | Train Loss: 0.511 Vali Loss: 2.957 Vali Acc: 0.240 Test Loss: 2.957 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1281235218048096
Epoch: 26, Steps: 10 | Train Loss: 0.409 Vali Loss: 3.052 Vali Acc: 0.252 Test Loss: 3.052 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.2505502700805664
Epoch: 27, Steps: 10 | Train Loss: 0.340 Vali Loss: 2.969 Vali Acc: 0.253 Test Loss: 2.969 Test Acc: 0.253
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.176727294921875
Epoch: 28, Steps: 10 | Train Loss: 0.243 Vali Loss: 2.993 Vali Acc: 0.264 Test Loss: 2.993 Test Acc: 0.264
Validation loss decreased (-0.257617 --> -0.263499).  Saving model ...
Epoch: 29 cost time: 1.0485167503356934
Epoch: 29, Steps: 10 | Train Loss: 0.217 Vali Loss: 2.989 Vali Acc: 0.273 Test Loss: 2.989 Test Acc: 0.273
Validation loss decreased (-0.263499 --> -0.272911).  Saving model ...
Epoch: 30 cost time: 1.2864553928375244
Epoch: 30, Steps: 10 | Train Loss: 0.247 Vali Loss: 3.021 Vali Acc: 0.259 Test Loss: 3.021 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27294117647058824
model parameter : 471778
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.4802489280700684
Epoch: 1, Steps: 10 | Train Loss: 3.309 Vali Loss: 3.322 Vali Acc: 0.036 Test Loss: 3.322 Test Acc: 0.036
Validation loss decreased (inf --> -0.036437).  Saving model ...
Epoch: 2 cost time: 1.0554709434509277
Epoch: 2, Steps: 10 | Train Loss: 3.222 Vali Loss: 3.308 Vali Acc: 0.039 Test Loss: 3.308 Test Acc: 0.039
Validation loss decreased (-0.036437 --> -0.038790).  Saving model ...
Epoch: 3 cost time: 0.9871680736541748
Epoch: 3, Steps: 10 | Train Loss: 3.196 Vali Loss: 3.296 Vali Acc: 0.038 Test Loss: 3.296 Test Acc: 0.038
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.000798225402832
Epoch: 4, Steps: 10 | Train Loss: 3.113 Vali Loss: 3.290 Vali Acc: 0.055 Test Loss: 3.290 Test Acc: 0.055
Validation loss decreased (-0.038790 --> -0.055261).  Saving model ...
Epoch: 5 cost time: 1.1175262928009033
Epoch: 5, Steps: 10 | Train Loss: 2.992 Vali Loss: 3.286 Vali Acc: 0.061 Test Loss: 3.286 Test Acc: 0.061
Validation loss decreased (-0.055261 --> -0.061144).  Saving model ...
Epoch: 6 cost time: 1.0884032249450684
Epoch: 6, Steps: 10 | Train Loss: 2.926 Vali Loss: 3.276 Vali Acc: 0.074 Test Loss: 3.276 Test Acc: 0.074
Validation loss decreased (-0.061144 --> -0.074085).  Saving model ...
Epoch: 7 cost time: 1.1137869358062744
Epoch: 7, Steps: 10 | Train Loss: 2.817 Vali Loss: 3.266 Vali Acc: 0.085 Test Loss: 3.266 Test Acc: 0.085
Validation loss decreased (-0.074085 --> -0.084673).  Saving model ...
Epoch: 8 cost time: 1.075427532196045
Epoch: 8, Steps: 10 | Train Loss: 2.707 Vali Loss: 3.244 Vali Acc: 0.099 Test Loss: 3.244 Test Acc: 0.099
Validation loss decreased (-0.084673 --> -0.098791).  Saving model ...
Epoch: 9 cost time: 1.060213327407837
Epoch: 9, Steps: 10 | Train Loss: 2.573 Vali Loss: 3.222 Vali Acc: 0.114 Test Loss: 3.222 Test Acc: 0.114
Validation loss decreased (-0.098791 --> -0.114085).  Saving model ...
Epoch: 10 cost time: 0.973872184753418
Epoch: 10, Steps: 10 | Train Loss: 2.459 Vali Loss: 3.202 Vali Acc: 0.119 Test Loss: 3.202 Test Acc: 0.119
Validation loss decreased (-0.114085 --> -0.118792).  Saving model ...
Epoch: 11 cost time: 0.9356167316436768
Epoch: 11, Steps: 10 | Train Loss: 2.349 Vali Loss: 3.179 Vali Acc: 0.139 Test Loss: 3.179 Test Acc: 0.139
Validation loss decreased (-0.118792 --> -0.138792).  Saving model ...
Epoch: 12 cost time: 0.973304033279419
Epoch: 12, Steps: 10 | Train Loss: 2.219 Vali Loss: 3.164 Vali Acc: 0.148 Test Loss: 3.164 Test Acc: 0.148
Validation loss decreased (-0.138792 --> -0.148204).  Saving model ...
Epoch: 13 cost time: 1.0834033489227295
Epoch: 13, Steps: 10 | Train Loss: 2.023 Vali Loss: 3.144 Vali Acc: 0.153 Test Loss: 3.144 Test Acc: 0.153
Validation loss decreased (-0.148204 --> -0.152910).  Saving model ...
Epoch: 14 cost time: 1.1487212181091309
Epoch: 14, Steps: 10 | Train Loss: 1.990 Vali Loss: 3.123 Vali Acc: 0.159 Test Loss: 3.123 Test Acc: 0.159
Validation loss decreased (-0.152910 --> -0.158792).  Saving model ...
Epoch: 15 cost time: 1.0299072265625
Epoch: 15, Steps: 10 | Train Loss: 1.752 Vali Loss: 3.098 Vali Acc: 0.173 Test Loss: 3.098 Test Acc: 0.173
Validation loss decreased (-0.158792 --> -0.172910).  Saving model ...
Epoch: 16 cost time: 1.1234281063079834
Epoch: 16, Steps: 10 | Train Loss: 1.628 Vali Loss: 3.075 Vali Acc: 0.185 Test Loss: 3.075 Test Acc: 0.185
Validation loss decreased (-0.172910 --> -0.184675).  Saving model ...
Epoch: 17 cost time: 1.1128811836242676
Epoch: 17, Steps: 10 | Train Loss: 1.412 Vali Loss: 3.056 Vali Acc: 0.189 Test Loss: 3.056 Test Acc: 0.189
Validation loss decreased (-0.184675 --> -0.189381).  Saving model ...
Epoch: 18 cost time: 0.9248020648956299
Epoch: 18, Steps: 10 | Train Loss: 1.380 Vali Loss: 3.056 Vali Acc: 0.194 Test Loss: 3.056 Test Acc: 0.194
Validation loss decreased (-0.189381 --> -0.194087).  Saving model ...
Epoch: 19 cost time: 1.007634162902832
Epoch: 19, Steps: 10 | Train Loss: 1.200 Vali Loss: 3.028 Vali Acc: 0.204 Test Loss: 3.028 Test Acc: 0.204
Validation loss decreased (-0.194087 --> -0.203499).  Saving model ...
Epoch: 20 cost time: 1.0428776741027832
Epoch: 20, Steps: 10 | Train Loss: 1.019 Vali Loss: 3.016 Vali Acc: 0.216 Test Loss: 3.016 Test Acc: 0.216
Validation loss decreased (-0.203499 --> -0.216440).  Saving model ...
Epoch: 21 cost time: 1.1436810493469238
Epoch: 21, Steps: 10 | Train Loss: 1.096 Vali Loss: 3.000 Vali Acc: 0.220 Test Loss: 3.000 Test Acc: 0.220
Validation loss decreased (-0.216440 --> -0.219970).  Saving model ...
Epoch: 22 cost time: 1.1716692447662354
Epoch: 22, Steps: 10 | Train Loss: 0.862 Vali Loss: 3.015 Vali Acc: 0.227 Test Loss: 3.015 Test Acc: 0.227
Validation loss decreased (-0.219970 --> -0.227029).  Saving model ...
Epoch: 23 cost time: 1.120452642440796
Epoch: 23, Steps: 10 | Train Loss: 0.737 Vali Loss: 2.991 Vali Acc: 0.241 Test Loss: 2.991 Test Acc: 0.241
Validation loss decreased (-0.227029 --> -0.241147).  Saving model ...
Epoch: 24 cost time: 1.195120096206665
Epoch: 24, Steps: 10 | Train Loss: 0.645 Vali Loss: 2.993 Vali Acc: 0.249 Test Loss: 2.993 Test Acc: 0.249
Validation loss decreased (-0.241147 --> -0.249382).  Saving model ...
Epoch: 25 cost time: 1.034766435623169
Epoch: 25, Steps: 10 | Train Loss: 0.574 Vali Loss: 3.002 Vali Acc: 0.256 Test Loss: 3.002 Test Acc: 0.256
Validation loss decreased (-0.249382 --> -0.256441).  Saving model ...
Epoch: 26 cost time: 1.0677106380462646
Epoch: 26, Steps: 10 | Train Loss: 0.528 Vali Loss: 3.024 Vali Acc: 0.258 Test Loss: 3.024 Test Acc: 0.258
Validation loss decreased (-0.256441 --> -0.257617).  Saving model ...
Epoch: 27 cost time: 1.0364940166473389
Epoch: 27, Steps: 10 | Train Loss: 0.413 Vali Loss: 3.032 Vali Acc: 0.267 Test Loss: 3.032 Test Acc: 0.267
Validation loss decreased (-0.257617 --> -0.267029).  Saving model ...
Epoch: 28 cost time: 0.9086902141571045
Epoch: 28, Steps: 10 | Train Loss: 0.482 Vali Loss: 3.046 Vali Acc: 0.272 Test Loss: 3.046 Test Acc: 0.272
Validation loss decreased (-0.267029 --> -0.271734).  Saving model ...
Epoch: 29 cost time: 1.0200097560882568
Epoch: 29, Steps: 10 | Train Loss: 0.362 Vali Loss: 3.029 Vali Acc: 0.280 Test Loss: 3.029 Test Acc: 0.280
Validation loss decreased (-0.271734 --> -0.279970).  Saving model ...
Epoch: 30 cost time: 1.0608799457550049
Epoch: 30, Steps: 10 | Train Loss: 0.300 Vali Loss: 3.073 Vali Acc: 0.284 Test Loss: 3.073 Test Acc: 0.284
Validation loss decreased (-0.279970 --> -0.283499).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28352941176470586
model parameter : 161266
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.199936866760254
Epoch: 1, Steps: 10 | Train Loss: 3.308 Vali Loss: 3.330 Vali Acc: 0.034 Test Loss: 3.330 Test Acc: 0.034
Validation loss decreased (inf --> -0.034084).  Saving model ...
Epoch: 2 cost time: 0.798651933670044
Epoch: 2, Steps: 10 | Train Loss: 3.280 Vali Loss: 3.314 Vali Acc: 0.029 Test Loss: 3.314 Test Acc: 0.029
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8608391284942627
Epoch: 3, Steps: 10 | Train Loss: 3.198 Vali Loss: 3.301 Vali Acc: 0.039 Test Loss: 3.301 Test Acc: 0.039
Validation loss decreased (-0.034084 --> -0.038791).  Saving model ...
Epoch: 4 cost time: 0.8812921047210693
Epoch: 4, Steps: 10 | Train Loss: 3.106 Vali Loss: 3.295 Vali Acc: 0.051 Test Loss: 3.295 Test Acc: 0.051
Validation loss decreased (-0.038791 --> -0.050555).  Saving model ...
Epoch: 5 cost time: 1.2116906642913818
Epoch: 5, Steps: 10 | Train Loss: 3.045 Vali Loss: 3.298 Vali Acc: 0.058 Test Loss: 3.298 Test Acc: 0.058
Validation loss decreased (-0.050555 --> -0.057614).  Saving model ...
Epoch: 6 cost time: 1.2590148448944092
Epoch: 6, Steps: 10 | Train Loss: 2.948 Vali Loss: 3.291 Vali Acc: 0.064 Test Loss: 3.291 Test Acc: 0.064
Validation loss decreased (-0.057614 --> -0.063497).  Saving model ...
Epoch: 7 cost time: 1.2043094635009766
Epoch: 7, Steps: 10 | Train Loss: 2.840 Vali Loss: 3.281 Vali Acc: 0.080 Test Loss: 3.281 Test Acc: 0.080
Validation loss decreased (-0.063497 --> -0.079967).  Saving model ...
Epoch: 8 cost time: 1.2390737533569336
Epoch: 8, Steps: 10 | Train Loss: 2.742 Vali Loss: 3.256 Vali Acc: 0.106 Test Loss: 3.256 Test Acc: 0.106
Validation loss decreased (-0.079967 --> -0.105850).  Saving model ...
Epoch: 9 cost time: 1.232358455657959
Epoch: 9, Steps: 10 | Train Loss: 2.625 Vali Loss: 3.233 Vali Acc: 0.113 Test Loss: 3.233 Test Acc: 0.113
Validation loss decreased (-0.105850 --> -0.112909).  Saving model ...
Epoch: 10 cost time: 1.271188497543335
Epoch: 10, Steps: 10 | Train Loss: 2.519 Vali Loss: 3.218 Vali Acc: 0.118 Test Loss: 3.218 Test Acc: 0.118
Validation loss decreased (-0.112909 --> -0.117615).  Saving model ...
Epoch: 11 cost time: 1.1891887187957764
Epoch: 11, Steps: 10 | Train Loss: 2.402 Vali Loss: 3.189 Vali Acc: 0.128 Test Loss: 3.189 Test Acc: 0.128
Validation loss decreased (-0.117615 --> -0.128203).  Saving model ...
Epoch: 12 cost time: 1.2505450248718262
Epoch: 12, Steps: 10 | Train Loss: 2.224 Vali Loss: 3.162 Vali Acc: 0.145 Test Loss: 3.162 Test Acc: 0.145
Validation loss decreased (-0.128203 --> -0.144674).  Saving model ...
Epoch: 13 cost time: 1.223186731338501
Epoch: 13, Steps: 10 | Train Loss: 2.127 Vali Loss: 3.161 Vali Acc: 0.162 Test Loss: 3.161 Test Acc: 0.162
Validation loss decreased (-0.144674 --> -0.162321).  Saving model ...
Epoch: 14 cost time: 1.1953175067901611
Epoch: 14, Steps: 10 | Train Loss: 2.041 Vali Loss: 3.113 Vali Acc: 0.168 Test Loss: 3.113 Test Acc: 0.168
Validation loss decreased (-0.162321 --> -0.168204).  Saving model ...
Epoch: 15 cost time: 1.2734525203704834
Epoch: 15, Steps: 10 | Train Loss: 1.811 Vali Loss: 3.083 Vali Acc: 0.187 Test Loss: 3.083 Test Acc: 0.187
Validation loss decreased (-0.168204 --> -0.187028).  Saving model ...
Epoch: 16 cost time: 1.2574715614318848
Epoch: 16, Steps: 10 | Train Loss: 1.620 Vali Loss: 3.066 Vali Acc: 0.192 Test Loss: 3.066 Test Acc: 0.192
Validation loss decreased (-0.187028 --> -0.191734).  Saving model ...
Epoch: 17 cost time: 1.3019499778747559
Epoch: 17, Steps: 10 | Train Loss: 1.514 Vali Loss: 3.063 Vali Acc: 0.191 Test Loss: 3.063 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.257847547531128
Epoch: 18, Steps: 10 | Train Loss: 1.312 Vali Loss: 3.043 Vali Acc: 0.204 Test Loss: 3.043 Test Acc: 0.204
Validation loss decreased (-0.191734 --> -0.203499).  Saving model ...
Epoch: 19 cost time: 1.3220365047454834
Epoch: 19, Steps: 10 | Train Loss: 1.234 Vali Loss: 3.023 Vali Acc: 0.213 Test Loss: 3.023 Test Acc: 0.213
Validation loss decreased (-0.203499 --> -0.212911).  Saving model ...
Epoch: 20 cost time: 1.2868292331695557
Epoch: 20, Steps: 10 | Train Loss: 1.057 Vali Loss: 3.017 Vali Acc: 0.231 Test Loss: 3.017 Test Acc: 0.231
Validation loss decreased (-0.212911 --> -0.230558).  Saving model ...
Epoch: 21 cost time: 0.8912267684936523
Epoch: 21, Steps: 10 | Train Loss: 0.967 Vali Loss: 2.989 Vali Acc: 0.246 Test Loss: 2.989 Test Acc: 0.246
Validation loss decreased (-0.230558 --> -0.245852).  Saving model ...
Epoch: 22 cost time: 1.1935720443725586
Epoch: 22, Steps: 10 | Train Loss: 0.865 Vali Loss: 2.981 Vali Acc: 0.247 Test Loss: 2.981 Test Acc: 0.247
Validation loss decreased (-0.245852 --> -0.247029).  Saving model ...
Epoch: 23 cost time: 1.0849711894989014
Epoch: 23, Steps: 10 | Train Loss: 0.738 Vali Loss: 2.930 Vali Acc: 0.236 Test Loss: 2.930 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2369880676269531
Epoch: 24, Steps: 10 | Train Loss: 0.583 Vali Loss: 2.945 Vali Acc: 0.253 Test Loss: 2.945 Test Acc: 0.253
Validation loss decreased (-0.247029 --> -0.252912).  Saving model ...
Epoch: 25 cost time: 0.972602367401123
Epoch: 25, Steps: 10 | Train Loss: 0.595 Vali Loss: 2.934 Vali Acc: 0.260 Test Loss: 2.934 Test Acc: 0.260
Validation loss decreased (-0.252912 --> -0.259971).  Saving model ...
Epoch: 26 cost time: 1.2866864204406738
Epoch: 26, Steps: 10 | Train Loss: 0.546 Vali Loss: 2.977 Vali Acc: 0.261 Test Loss: 2.977 Test Acc: 0.261
Validation loss decreased (-0.259971 --> -0.261147).  Saving model ...
Epoch: 27 cost time: 1.1355860233306885
Epoch: 27, Steps: 10 | Train Loss: 0.406 Vali Loss: 2.962 Vali Acc: 0.258 Test Loss: 2.962 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2549073696136475
Epoch: 28, Steps: 10 | Train Loss: 0.320 Vali Loss: 2.946 Vali Acc: 0.278 Test Loss: 2.946 Test Acc: 0.278
Validation loss decreased (-0.261147 --> -0.277618).  Saving model ...
Epoch: 29 cost time: 1.310072898864746
Epoch: 29, Steps: 10 | Train Loss: 0.284 Vali Loss: 2.948 Vali Acc: 0.273 Test Loss: 2.948 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.2612853050231934
Epoch: 30, Steps: 10 | Train Loss: 0.265 Vali Loss: 2.985 Vali Acc: 0.269 Test Loss: 2.985 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2776470588235294
model parameter : 471778
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.3080790042877197
Epoch: 1, Steps: 10 | Train Loss: 3.296 Vali Loss: 3.315 Vali Acc: 0.038 Test Loss: 3.315 Test Acc: 0.038
Validation loss decreased (inf --> -0.037614).  Saving model ...
Epoch: 2 cost time: 1.0157365798950195
Epoch: 2, Steps: 10 | Train Loss: 3.227 Vali Loss: 3.300 Vali Acc: 0.045 Test Loss: 3.300 Test Acc: 0.045
Validation loss decreased (-0.037614 --> -0.044673).  Saving model ...
Epoch: 3 cost time: 1.0660803318023682
Epoch: 3, Steps: 10 | Train Loss: 3.195 Vali Loss: 3.289 Vali Acc: 0.046 Test Loss: 3.289 Test Acc: 0.046
Validation loss decreased (-0.044673 --> -0.045849).  Saving model ...
Epoch: 4 cost time: 1.0968434810638428
Epoch: 4, Steps: 10 | Train Loss: 3.123 Vali Loss: 3.288 Vali Acc: 0.054 Test Loss: 3.288 Test Acc: 0.054
Validation loss decreased (-0.045849 --> -0.054085).  Saving model ...
Epoch: 5 cost time: 1.070779800415039
Epoch: 5, Steps: 10 | Train Loss: 3.011 Vali Loss: 3.288 Vali Acc: 0.064 Test Loss: 3.288 Test Acc: 0.064
Validation loss decreased (-0.054085 --> -0.063497).  Saving model ...
Epoch: 6 cost time: 1.0466182231903076
Epoch: 6, Steps: 10 | Train Loss: 2.943 Vali Loss: 3.277 Vali Acc: 0.076 Test Loss: 3.277 Test Acc: 0.076
Validation loss decreased (-0.063497 --> -0.076438).  Saving model ...
Epoch: 7 cost time: 1.0765507221221924
Epoch: 7, Steps: 10 | Train Loss: 2.860 Vali Loss: 3.268 Vali Acc: 0.089 Test Loss: 3.268 Test Acc: 0.089
Validation loss decreased (-0.076438 --> -0.089379).  Saving model ...
Epoch: 8 cost time: 1.0699570178985596
Epoch: 8, Steps: 10 | Train Loss: 2.748 Vali Loss: 3.252 Vali Acc: 0.098 Test Loss: 3.252 Test Acc: 0.098
Validation loss decreased (-0.089379 --> -0.097615).  Saving model ...
Epoch: 9 cost time: 0.9582219123840332
Epoch: 9, Steps: 10 | Train Loss: 2.625 Vali Loss: 3.236 Vali Acc: 0.106 Test Loss: 3.236 Test Acc: 0.106
Validation loss decreased (-0.097615 --> -0.105850).  Saving model ...
Epoch: 10 cost time: 1.1090214252471924
Epoch: 10, Steps: 10 | Train Loss: 2.548 Vali Loss: 3.218 Vali Acc: 0.113 Test Loss: 3.218 Test Acc: 0.113
Validation loss decreased (-0.105850 --> -0.112909).  Saving model ...
Epoch: 11 cost time: 1.1066970825195312
Epoch: 11, Steps: 10 | Train Loss: 2.443 Vali Loss: 3.202 Vali Acc: 0.131 Test Loss: 3.202 Test Acc: 0.131
Validation loss decreased (-0.112909 --> -0.130556).  Saving model ...
Epoch: 12 cost time: 0.9155251979827881
Epoch: 12, Steps: 10 | Train Loss: 2.278 Vali Loss: 3.190 Vali Acc: 0.144 Test Loss: 3.190 Test Acc: 0.144
Validation loss decreased (-0.130556 --> -0.143498).  Saving model ...
Epoch: 13 cost time: 1.1366353034973145
Epoch: 13, Steps: 10 | Train Loss: 2.177 Vali Loss: 3.168 Vali Acc: 0.149 Test Loss: 3.168 Test Acc: 0.149
Validation loss decreased (-0.143498 --> -0.149380).  Saving model ...
Epoch: 14 cost time: 1.1565890312194824
Epoch: 14, Steps: 10 | Train Loss: 2.108 Vali Loss: 3.149 Vali Acc: 0.158 Test Loss: 3.149 Test Acc: 0.158
Validation loss decreased (-0.149380 --> -0.157616).  Saving model ...
Epoch: 15 cost time: 1.0782525539398193
Epoch: 15, Steps: 10 | Train Loss: 1.874 Vali Loss: 3.127 Vali Acc: 0.188 Test Loss: 3.127 Test Acc: 0.188
Validation loss decreased (-0.157616 --> -0.188204).  Saving model ...
Epoch: 16 cost time: 1.038788080215454
Epoch: 16, Steps: 10 | Train Loss: 1.778 Vali Loss: 3.109 Vali Acc: 0.194 Test Loss: 3.109 Test Acc: 0.194
Validation loss decreased (-0.188204 --> -0.194087).  Saving model ...
Epoch: 17 cost time: 1.1097276210784912
Epoch: 17, Steps: 10 | Train Loss: 1.627 Vali Loss: 3.093 Vali Acc: 0.192 Test Loss: 3.093 Test Acc: 0.192
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.118039608001709
Epoch: 18, Steps: 10 | Train Loss: 1.534 Vali Loss: 3.080 Vali Acc: 0.209 Test Loss: 3.080 Test Acc: 0.209
Validation loss decreased (-0.194087 --> -0.209381).  Saving model ...
Epoch: 19 cost time: 1.0621416568756104
Epoch: 19, Steps: 10 | Train Loss: 1.411 Vali Loss: 3.063 Vali Acc: 0.201 Test Loss: 3.063 Test Acc: 0.201
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7910301685333252
Epoch: 20, Steps: 10 | Train Loss: 1.231 Vali Loss: 3.053 Vali Acc: 0.218 Test Loss: 3.053 Test Acc: 0.218
Validation loss decreased (-0.209381 --> -0.217617).  Saving model ...
Epoch: 21 cost time: 0.908280611038208
Epoch: 21, Steps: 10 | Train Loss: 1.238 Vali Loss: 3.054 Vali Acc: 0.212 Test Loss: 3.054 Test Acc: 0.212
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7219324111938477
Epoch: 22, Steps: 10 | Train Loss: 1.073 Vali Loss: 3.027 Vali Acc: 0.239 Test Loss: 3.027 Test Acc: 0.239
Validation loss decreased (-0.217617 --> -0.238793).  Saving model ...
Epoch: 23 cost time: 0.9685983657836914
Epoch: 23, Steps: 10 | Train Loss: 0.945 Vali Loss: 3.019 Vali Acc: 0.235 Test Loss: 3.019 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7904441356658936
Epoch: 24, Steps: 10 | Train Loss: 0.847 Vali Loss: 3.020 Vali Acc: 0.235 Test Loss: 3.020 Test Acc: 0.235
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1097438335418701
Epoch: 25, Steps: 10 | Train Loss: 0.743 Vali Loss: 3.026 Vali Acc: 0.249 Test Loss: 3.026 Test Acc: 0.249
Validation loss decreased (-0.238793 --> -0.249382).  Saving model ...
Epoch: 26 cost time: 1.103149175643921
Epoch: 26, Steps: 10 | Train Loss: 0.693 Vali Loss: 3.049 Vali Acc: 0.248 Test Loss: 3.049 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1178970336914062
Epoch: 27, Steps: 10 | Train Loss: 0.598 Vali Loss: 3.049 Vali Acc: 0.258 Test Loss: 3.049 Test Acc: 0.258
Validation loss decreased (-0.249382 --> -0.257617).  Saving model ...
Epoch: 28 cost time: 1.153442144393921
Epoch: 28, Steps: 10 | Train Loss: 0.580 Vali Loss: 3.032 Vali Acc: 0.265 Test Loss: 3.032 Test Acc: 0.265
Validation loss decreased (-0.257617 --> -0.264676).  Saving model ...
Epoch: 29 cost time: 1.1305859088897705
Epoch: 29, Steps: 10 | Train Loss: 0.500 Vali Loss: 3.018 Vali Acc: 0.269 Test Loss: 3.018 Test Acc: 0.269
Validation loss decreased (-0.264676 --> -0.269382).  Saving model ...
Epoch: 30 cost time: 1.1089653968811035
Epoch: 30, Steps: 10 | Train Loss: 0.414 Vali Loss: 3.032 Vali Acc: 0.266 Test Loss: 3.032 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26941176470588235
model parameter : 161266
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.3501572608947754
Epoch: 1, Steps: 10 | Train Loss: 3.305 Vali Loss: 3.332 Vali Acc: 0.041 Test Loss: 3.332 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 0.8873887062072754
Epoch: 2, Steps: 10 | Train Loss: 3.285 Vali Loss: 3.319 Vali Acc: 0.033 Test Loss: 3.319 Test Acc: 0.033
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.996330976486206
Epoch: 3, Steps: 10 | Train Loss: 3.214 Vali Loss: 3.309 Vali Acc: 0.042 Test Loss: 3.309 Test Acc: 0.042
Validation loss decreased (-0.041143 --> -0.042320).  Saving model ...
Epoch: 4 cost time: 0.9531869888305664
Epoch: 4, Steps: 10 | Train Loss: 3.128 Vali Loss: 3.305 Vali Acc: 0.051 Test Loss: 3.305 Test Acc: 0.051
Validation loss decreased (-0.042320 --> -0.050555).  Saving model ...
Epoch: 5 cost time: 1.0283706188201904
Epoch: 5, Steps: 10 | Train Loss: 3.068 Vali Loss: 3.309 Vali Acc: 0.056 Test Loss: 3.309 Test Acc: 0.056
Validation loss decreased (-0.050555 --> -0.056437).  Saving model ...
Epoch: 6 cost time: 1.0334153175354004
Epoch: 6, Steps: 10 | Train Loss: 2.998 Vali Loss: 3.306 Vali Acc: 0.065 Test Loss: 3.306 Test Acc: 0.065
Validation loss decreased (-0.056437 --> -0.064673).  Saving model ...
Epoch: 7 cost time: 1.0042943954467773
Epoch: 7, Steps: 10 | Train Loss: 2.903 Vali Loss: 3.300 Vali Acc: 0.075 Test Loss: 3.300 Test Acc: 0.075
Validation loss decreased (-0.064673 --> -0.075261).  Saving model ...
Epoch: 8 cost time: 0.9774844646453857
Epoch: 8, Steps: 10 | Train Loss: 2.798 Vali Loss: 3.285 Vali Acc: 0.098 Test Loss: 3.285 Test Acc: 0.098
Validation loss decreased (-0.075261 --> -0.097614).  Saving model ...
Epoch: 9 cost time: 0.9812109470367432
Epoch: 9, Steps: 10 | Train Loss: 2.721 Vali Loss: 3.268 Vali Acc: 0.096 Test Loss: 3.268 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8231477737426758
Epoch: 10, Steps: 10 | Train Loss: 2.618 Vali Loss: 3.253 Vali Acc: 0.104 Test Loss: 3.253 Test Acc: 0.104
Validation loss decreased (-0.097614 --> -0.103497).  Saving model ...
Epoch: 11 cost time: 0.9094181060791016
Epoch: 11, Steps: 10 | Train Loss: 2.536 Vali Loss: 3.227 Vali Acc: 0.120 Test Loss: 3.227 Test Acc: 0.120
Validation loss decreased (-0.103497 --> -0.119968).  Saving model ...
Epoch: 12 cost time: 0.8858020305633545
Epoch: 12, Steps: 10 | Train Loss: 2.348 Vali Loss: 3.209 Vali Acc: 0.127 Test Loss: 3.209 Test Acc: 0.127
Validation loss decreased (-0.119968 --> -0.127027).  Saving model ...
Epoch: 13 cost time: 0.9256463050842285
Epoch: 13, Steps: 10 | Train Loss: 2.269 Vali Loss: 3.200 Vali Acc: 0.138 Test Loss: 3.200 Test Acc: 0.138
Validation loss decreased (-0.127027 --> -0.137615).  Saving model ...
Epoch: 14 cost time: 1.0568909645080566
Epoch: 14, Steps: 10 | Train Loss: 2.266 Vali Loss: 3.166 Vali Acc: 0.146 Test Loss: 3.166 Test Acc: 0.146
Validation loss decreased (-0.137615 --> -0.145851).  Saving model ...
Epoch: 15 cost time: 0.6715033054351807
Epoch: 15, Steps: 10 | Train Loss: 1.981 Vali Loss: 3.138 Vali Acc: 0.160 Test Loss: 3.138 Test Acc: 0.160
Validation loss decreased (-0.145851 --> -0.159969).  Saving model ...
Epoch: 16 cost time: 1.062347650527954
Epoch: 16, Steps: 10 | Train Loss: 1.853 Vali Loss: 3.115 Vali Acc: 0.169 Test Loss: 3.115 Test Acc: 0.169
Validation loss decreased (-0.159969 --> -0.169381).  Saving model ...
Epoch: 17 cost time: 1.0513358116149902
Epoch: 17, Steps: 10 | Train Loss: 1.695 Vali Loss: 3.093 Vali Acc: 0.175 Test Loss: 3.093 Test Acc: 0.175
Validation loss decreased (-0.169381 --> -0.175263).  Saving model ...
Epoch: 18 cost time: 0.9794182777404785
Epoch: 18, Steps: 10 | Train Loss: 1.584 Vali Loss: 3.063 Vali Acc: 0.188 Test Loss: 3.063 Test Acc: 0.188
Validation loss decreased (-0.175263 --> -0.188205).  Saving model ...
Epoch: 19 cost time: 1.0423109531402588
Epoch: 19, Steps: 10 | Train Loss: 1.485 Vali Loss: 3.094 Vali Acc: 0.184 Test Loss: 3.094 Test Acc: 0.184
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.04827880859375
Epoch: 20, Steps: 10 | Train Loss: 1.358 Vali Loss: 3.064 Vali Acc: 0.184 Test Loss: 3.064 Test Acc: 0.184
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.029386281967163
Epoch: 21, Steps: 10 | Train Loss: 1.218 Vali Loss: 3.058 Vali Acc: 0.206 Test Loss: 3.058 Test Acc: 0.206
Validation loss decreased (-0.188205 --> -0.205852).  Saving model ...
Epoch: 22 cost time: 0.968087911605835
Epoch: 22, Steps: 10 | Train Loss: 1.094 Vali Loss: 3.066 Vali Acc: 0.214 Test Loss: 3.066 Test Acc: 0.214
Validation loss decreased (-0.205852 --> -0.214087).  Saving model ...
Epoch: 23 cost time: 0.9663064479827881
Epoch: 23, Steps: 10 | Train Loss: 1.008 Vali Loss: 3.006 Vali Acc: 0.224 Test Loss: 3.006 Test Acc: 0.224
Validation loss decreased (-0.214087 --> -0.223499).  Saving model ...
Epoch: 24 cost time: 0.9262721538543701
Epoch: 24, Steps: 10 | Train Loss: 0.947 Vali Loss: 3.046 Vali Acc: 0.214 Test Loss: 3.046 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7523629665374756
Epoch: 25, Steps: 10 | Train Loss: 0.825 Vali Loss: 3.014 Vali Acc: 0.232 Test Loss: 3.014 Test Acc: 0.232
Validation loss decreased (-0.223499 --> -0.231735).  Saving model ...
Epoch: 26 cost time: 0.8969745635986328
Epoch: 26, Steps: 10 | Train Loss: 0.748 Vali Loss: 3.062 Vali Acc: 0.240 Test Loss: 3.062 Test Acc: 0.240
Validation loss decreased (-0.231735 --> -0.239969).  Saving model ...
Epoch: 27 cost time: 0.9229462146759033
Epoch: 27, Steps: 10 | Train Loss: 0.677 Vali Loss: 2.965 Vali Acc: 0.249 Test Loss: 2.965 Test Acc: 0.249
Validation loss decreased (-0.239969 --> -0.249382).  Saving model ...
Epoch: 28 cost time: 1.0886189937591553
Epoch: 28, Steps: 10 | Train Loss: 0.541 Vali Loss: 3.022 Vali Acc: 0.242 Test Loss: 3.022 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0135011672973633
Epoch: 29, Steps: 10 | Train Loss: 0.501 Vali Loss: 3.030 Vali Acc: 0.259 Test Loss: 3.030 Test Acc: 0.259
Validation loss decreased (-0.249382 --> -0.258793).  Saving model ...
Epoch: 30 cost time: 1.001466989517212
Epoch: 30, Steps: 10 | Train Loss: 0.516 Vali Loss: 3.032 Vali Acc: 0.261 Test Loss: 3.032 Test Acc: 0.261
Validation loss decreased (-0.258793 --> -0.261146).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2611764705882353
model parameter : 471778
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.129249095916748
Epoch: 1, Steps: 10 | Train Loss: 3.285 Vali Loss: 3.316 Vali Acc: 0.032 Test Loss: 3.316 Test Acc: 0.032
Validation loss decreased (inf --> -0.031732).  Saving model ...
Epoch: 2 cost time: 0.9376356601715088
Epoch: 2, Steps: 10 | Train Loss: 3.226 Vali Loss: 3.302 Vali Acc: 0.040 Test Loss: 3.302 Test Acc: 0.040
Validation loss decreased (-0.031732 --> -0.039967).  Saving model ...
Epoch: 3 cost time: 0.7758009433746338
Epoch: 3, Steps: 10 | Train Loss: 3.195 Vali Loss: 3.290 Vali Acc: 0.044 Test Loss: 3.290 Test Acc: 0.044
Validation loss decreased (-0.039967 --> -0.043497).  Saving model ...
Epoch: 4 cost time: 0.8108832836151123
Epoch: 4, Steps: 10 | Train Loss: 3.149 Vali Loss: 3.289 Vali Acc: 0.051 Test Loss: 3.289 Test Acc: 0.051
Validation loss decreased (-0.043497 --> -0.050555).  Saving model ...
Epoch: 5 cost time: 0.8362991809844971
Epoch: 5, Steps: 10 | Train Loss: 3.041 Vali Loss: 3.289 Vali Acc: 0.066 Test Loss: 3.289 Test Acc: 0.066
Validation loss decreased (-0.050555 --> -0.065849).  Saving model ...
Epoch: 6 cost time: 0.8757150173187256
Epoch: 6, Steps: 10 | Train Loss: 2.962 Vali Loss: 3.284 Vali Acc: 0.068 Test Loss: 3.284 Test Acc: 0.068
Validation loss decreased (-0.065849 --> -0.068202).  Saving model ...
Epoch: 7 cost time: 0.8899531364440918
Epoch: 7, Steps: 10 | Train Loss: 2.903 Vali Loss: 3.276 Vali Acc: 0.082 Test Loss: 3.276 Test Acc: 0.082
Validation loss decreased (-0.068202 --> -0.082320).  Saving model ...
Epoch: 8 cost time: 0.6181581020355225
Epoch: 8, Steps: 10 | Train Loss: 2.794 Vali Loss: 3.261 Vali Acc: 0.094 Test Loss: 3.261 Test Acc: 0.094
Validation loss decreased (-0.082320 --> -0.094085).  Saving model ...
Epoch: 9 cost time: 0.8882944583892822
Epoch: 9, Steps: 10 | Train Loss: 2.699 Vali Loss: 3.247 Vali Acc: 0.115 Test Loss: 3.247 Test Acc: 0.115
Validation loss decreased (-0.094085 --> -0.115262).  Saving model ...
Epoch: 10 cost time: 0.8859033584594727
Epoch: 10, Steps: 10 | Train Loss: 2.578 Vali Loss: 3.224 Vali Acc: 0.122 Test Loss: 3.224 Test Acc: 0.122
Validation loss decreased (-0.115262 --> -0.122321).  Saving model ...
Epoch: 11 cost time: 0.9378788471221924
Epoch: 11, Steps: 10 | Train Loss: 2.541 Vali Loss: 3.208 Vali Acc: 0.141 Test Loss: 3.208 Test Acc: 0.141
Validation loss decreased (-0.122321 --> -0.141144).  Saving model ...
Epoch: 12 cost time: 0.9257073402404785
Epoch: 12, Steps: 10 | Train Loss: 2.353 Vali Loss: 3.200 Vali Acc: 0.142 Test Loss: 3.200 Test Acc: 0.142
Validation loss decreased (-0.141144 --> -0.142321).  Saving model ...
Epoch: 13 cost time: 0.9021379947662354
Epoch: 13, Steps: 10 | Train Loss: 2.264 Vali Loss: 3.186 Vali Acc: 0.144 Test Loss: 3.186 Test Acc: 0.144
Validation loss decreased (-0.142321 --> -0.143498).  Saving model ...
Epoch: 14 cost time: 0.953010082244873
Epoch: 14, Steps: 10 | Train Loss: 2.258 Vali Loss: 3.170 Vali Acc: 0.152 Test Loss: 3.170 Test Acc: 0.152
Validation loss decreased (-0.143498 --> -0.151733).  Saving model ...
Epoch: 15 cost time: 0.8664522171020508
Epoch: 15, Steps: 10 | Train Loss: 2.000 Vali Loss: 3.154 Vali Acc: 0.167 Test Loss: 3.154 Test Acc: 0.167
Validation loss decreased (-0.151733 --> -0.167027).  Saving model ...
Epoch: 16 cost time: 0.9051008224487305
Epoch: 16, Steps: 10 | Train Loss: 1.996 Vali Loss: 3.145 Vali Acc: 0.167 Test Loss: 3.145 Test Acc: 0.167
Validation loss decreased (-0.167027 --> -0.167027).  Saving model ...
Epoch: 17 cost time: 0.8533012866973877
Epoch: 17, Steps: 10 | Train Loss: 1.738 Vali Loss: 3.128 Vali Acc: 0.172 Test Loss: 3.128 Test Acc: 0.172
Validation loss decreased (-0.167027 --> -0.171733).  Saving model ...
Epoch: 18 cost time: 0.5818908214569092
Epoch: 18, Steps: 10 | Train Loss: 1.747 Vali Loss: 3.137 Vali Acc: 0.188 Test Loss: 3.137 Test Acc: 0.188
Validation loss decreased (-0.171733 --> -0.188204).  Saving model ...
Epoch: 19 cost time: 0.8139612674713135
Epoch: 19, Steps: 10 | Train Loss: 1.754 Vali Loss: 3.102 Vali Acc: 0.188 Test Loss: 3.102 Test Acc: 0.188
Validation loss decreased (-0.188204 --> -0.188204).  Saving model ...
Epoch: 20 cost time: 0.8767263889312744
Epoch: 20, Steps: 10 | Train Loss: 1.373 Vali Loss: 3.109 Vali Acc: 0.198 Test Loss: 3.109 Test Acc: 0.198
Validation loss decreased (-0.188204 --> -0.197616).  Saving model ...
Epoch: 21 cost time: 0.8866119384765625
Epoch: 21, Steps: 10 | Train Loss: 1.376 Vali Loss: 3.085 Vali Acc: 0.206 Test Loss: 3.085 Test Acc: 0.206
Validation loss decreased (-0.197616 --> -0.205851).  Saving model ...
Epoch: 22 cost time: 0.893974781036377
Epoch: 22, Steps: 10 | Train Loss: 1.253 Vali Loss: 3.081 Vali Acc: 0.220 Test Loss: 3.081 Test Acc: 0.220
Validation loss decreased (-0.205851 --> -0.219969).  Saving model ...
Epoch: 23 cost time: 0.8884842395782471
Epoch: 23, Steps: 10 | Train Loss: 0.975 Vali Loss: 3.062 Vali Acc: 0.225 Test Loss: 3.062 Test Acc: 0.225
Validation loss decreased (-0.219969 --> -0.224675).  Saving model ...
Epoch: 24 cost time: 0.9371376037597656
Epoch: 24, Steps: 10 | Train Loss: 1.089 Vali Loss: 3.091 Vali Acc: 0.233 Test Loss: 3.091 Test Acc: 0.233
Validation loss decreased (-0.224675 --> -0.232910).  Saving model ...
Epoch: 25 cost time: 0.9097504615783691
Epoch: 25, Steps: 10 | Train Loss: 0.961 Vali Loss: 3.070 Vali Acc: 0.233 Test Loss: 3.070 Test Acc: 0.233
Validation loss decreased (-0.232910 --> -0.232910).  Saving model ...
Epoch: 26 cost time: 0.8680469989776611
Epoch: 26, Steps: 10 | Train Loss: 0.755 Vali Loss: 3.154 Vali Acc: 0.233 Test Loss: 3.154 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.875173807144165
Epoch: 27, Steps: 10 | Train Loss: 0.709 Vali Loss: 3.088 Vali Acc: 0.249 Test Loss: 3.088 Test Acc: 0.249
Validation loss decreased (-0.232910 --> -0.249381).  Saving model ...
Epoch: 28 cost time: 0.8980772495269775
Epoch: 28, Steps: 10 | Train Loss: 0.741 Vali Loss: 3.107 Vali Acc: 0.244 Test Loss: 3.107 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8497781753540039
Epoch: 29, Steps: 10 | Train Loss: 0.560 Vali Loss: 3.067 Vali Acc: 0.265 Test Loss: 3.067 Test Acc: 0.265
Validation loss decreased (-0.249381 --> -0.264675).  Saving model ...
Epoch: 30 cost time: 0.8423259258270264
Epoch: 30, Steps: 10 | Train Loss: 0.555 Vali Loss: 3.131 Vali Acc: 0.256 Test Loss: 3.131 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2647058823529412
model parameter : 161266
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.0296742916107178
Epoch: 1, Steps: 10 | Train Loss: 3.332 Vali Loss: 3.303 Vali Acc: 0.034 Test Loss: 3.303 Test Acc: 0.034
Validation loss decreased (inf --> -0.034085).  Saving model ...
Epoch: 2 cost time: 1.385117769241333
Epoch: 2, Steps: 10 | Train Loss: 3.277 Vali Loss: 3.288 Vali Acc: 0.041 Test Loss: 3.288 Test Acc: 0.041
Validation loss decreased (-0.034085 --> -0.041144).  Saving model ...
Epoch: 3 cost time: 1.4459731578826904
Epoch: 3, Steps: 10 | Train Loss: 3.182 Vali Loss: 3.277 Vali Acc: 0.055 Test Loss: 3.277 Test Acc: 0.055
Validation loss decreased (-0.041144 --> -0.055261).  Saving model ...
Epoch: 4 cost time: 1.3907499313354492
Epoch: 4, Steps: 10 | Train Loss: 3.132 Vali Loss: 3.270 Vali Acc: 0.060 Test Loss: 3.270 Test Acc: 0.060
Validation loss decreased (-0.055261 --> -0.059967).  Saving model ...
Epoch: 5 cost time: 1.3413970470428467
Epoch: 5, Steps: 10 | Train Loss: 3.030 Vali Loss: 3.263 Vali Acc: 0.074 Test Loss: 3.263 Test Acc: 0.074
Validation loss decreased (-0.059967 --> -0.074085).  Saving model ...
Epoch: 6 cost time: 1.4357712268829346
Epoch: 6, Steps: 10 | Train Loss: 2.939 Vali Loss: 3.254 Vali Acc: 0.084 Test Loss: 3.254 Test Acc: 0.084
Validation loss decreased (-0.074085 --> -0.083497).  Saving model ...
Epoch: 7 cost time: 1.3188819885253906
Epoch: 7, Steps: 10 | Train Loss: 2.854 Vali Loss: 3.242 Vali Acc: 0.095 Test Loss: 3.242 Test Acc: 0.095
Validation loss decreased (-0.083497 --> -0.095262).  Saving model ...
Epoch: 8 cost time: 1.2062699794769287
Epoch: 8, Steps: 10 | Train Loss: 2.782 Vali Loss: 3.228 Vali Acc: 0.104 Test Loss: 3.228 Test Acc: 0.104
Validation loss decreased (-0.095262 --> -0.103497).  Saving model ...
Epoch: 9 cost time: 1.2274112701416016
Epoch: 9, Steps: 10 | Train Loss: 2.656 Vali Loss: 3.209 Vali Acc: 0.118 Test Loss: 3.209 Test Acc: 0.118
Validation loss decreased (-0.103497 --> -0.117615).  Saving model ...
Epoch: 10 cost time: 1.2228460311889648
Epoch: 10, Steps: 10 | Train Loss: 2.531 Vali Loss: 3.180 Vali Acc: 0.145 Test Loss: 3.180 Test Acc: 0.145
Validation loss decreased (-0.117615 --> -0.144674).  Saving model ...
Epoch: 11 cost time: 1.3403782844543457
Epoch: 11, Steps: 10 | Train Loss: 2.372 Vali Loss: 3.151 Vali Acc: 0.152 Test Loss: 3.151 Test Acc: 0.152
Validation loss decreased (-0.144674 --> -0.151733).  Saving model ...
Epoch: 12 cost time: 1.4377760887145996
Epoch: 12, Steps: 10 | Train Loss: 2.225 Vali Loss: 3.119 Vali Acc: 0.151 Test Loss: 3.119 Test Acc: 0.151
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4087252616882324
Epoch: 13, Steps: 10 | Train Loss: 2.084 Vali Loss: 3.101 Vali Acc: 0.154 Test Loss: 3.101 Test Acc: 0.154
Validation loss decreased (-0.151733 --> -0.154087).  Saving model ...
Epoch: 14 cost time: 1.4232795238494873
Epoch: 14, Steps: 10 | Train Loss: 1.925 Vali Loss: 3.068 Vali Acc: 0.171 Test Loss: 3.068 Test Acc: 0.171
Validation loss decreased (-0.154087 --> -0.170558).  Saving model ...
Epoch: 15 cost time: 1.3414669036865234
Epoch: 15, Steps: 10 | Train Loss: 1.741 Vali Loss: 3.042 Vali Acc: 0.192 Test Loss: 3.042 Test Acc: 0.192
Validation loss decreased (-0.170558 --> -0.191734).  Saving model ...
Epoch: 16 cost time: 1.3072192668914795
Epoch: 16, Steps: 10 | Train Loss: 1.599 Vali Loss: 3.015 Vali Acc: 0.194 Test Loss: 3.015 Test Acc: 0.194
Validation loss decreased (-0.191734 --> -0.194087).  Saving model ...
Epoch: 17 cost time: 1.3111004829406738
Epoch: 17, Steps: 10 | Train Loss: 1.417 Vali Loss: 2.983 Vali Acc: 0.202 Test Loss: 2.983 Test Acc: 0.202
Validation loss decreased (-0.194087 --> -0.202323).  Saving model ...
Epoch: 18 cost time: 1.320610761642456
Epoch: 18, Steps: 10 | Train Loss: 1.257 Vali Loss: 2.975 Vali Acc: 0.205 Test Loss: 2.975 Test Acc: 0.205
Validation loss decreased (-0.202323 --> -0.204676).  Saving model ...
Epoch: 19 cost time: 1.2351694107055664
Epoch: 19, Steps: 10 | Train Loss: 1.103 Vali Loss: 2.937 Vali Acc: 0.227 Test Loss: 2.937 Test Acc: 0.227
Validation loss decreased (-0.204676 --> -0.227029).  Saving model ...
Epoch: 20 cost time: 1.3790383338928223
Epoch: 20, Steps: 10 | Train Loss: 0.954 Vali Loss: 2.957 Vali Acc: 0.227 Test Loss: 2.957 Test Acc: 0.227
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3353147506713867
Epoch: 21, Steps: 10 | Train Loss: 0.863 Vali Loss: 2.921 Vali Acc: 0.235 Test Loss: 2.921 Test Acc: 0.235
Validation loss decreased (-0.227029 --> -0.235265).  Saving model ...
Epoch: 22 cost time: 1.4492316246032715
Epoch: 22, Steps: 10 | Train Loss: 0.693 Vali Loss: 2.906 Vali Acc: 0.255 Test Loss: 2.906 Test Acc: 0.255
Validation loss decreased (-0.235265 --> -0.255265).  Saving model ...
Epoch: 23 cost time: 1.4305005073547363
Epoch: 23, Steps: 10 | Train Loss: 0.630 Vali Loss: 2.875 Vali Acc: 0.258 Test Loss: 2.875 Test Acc: 0.258
Validation loss decreased (-0.255265 --> -0.257618).  Saving model ...
Epoch: 24 cost time: 1.3585820198059082
Epoch: 24, Steps: 10 | Train Loss: 0.542 Vali Loss: 2.904 Vali Acc: 0.262 Test Loss: 2.904 Test Acc: 0.262
Validation loss decreased (-0.257618 --> -0.262324).  Saving model ...
Epoch: 25 cost time: 0.8393280506134033
Epoch: 25, Steps: 10 | Train Loss: 0.439 Vali Loss: 2.888 Vali Acc: 0.271 Test Loss: 2.888 Test Acc: 0.271
Validation loss decreased (-0.262324 --> -0.270559).  Saving model ...
Epoch: 26 cost time: 1.2352685928344727
Epoch: 26, Steps: 10 | Train Loss: 0.349 Vali Loss: 2.899 Vali Acc: 0.275 Test Loss: 2.899 Test Acc: 0.275
Validation loss decreased (-0.270559 --> -0.275265).  Saving model ...
Epoch: 27 cost time: 1.3291733264923096
Epoch: 27, Steps: 10 | Train Loss: 0.352 Vali Loss: 2.881 Vali Acc: 0.281 Test Loss: 2.881 Test Acc: 0.281
Validation loss decreased (-0.275265 --> -0.281148).  Saving model ...
Epoch: 28 cost time: 1.3718154430389404
Epoch: 28, Steps: 10 | Train Loss: 0.264 Vali Loss: 2.892 Vali Acc: 0.295 Test Loss: 2.892 Test Acc: 0.295
Validation loss decreased (-0.281148 --> -0.295265).  Saving model ...
Epoch: 29 cost time: 1.384735107421875
Epoch: 29, Steps: 10 | Train Loss: 0.244 Vali Loss: 2.890 Vali Acc: 0.302 Test Loss: 2.890 Test Acc: 0.302
Validation loss decreased (-0.295265 --> -0.302324).  Saving model ...
Epoch: 30 cost time: 1.5317442417144775
Epoch: 30, Steps: 10 | Train Loss: 0.276 Vali Loss: 2.899 Vali Acc: 0.312 Test Loss: 2.899 Test Acc: 0.312
Validation loss decreased (-0.302324 --> -0.311736).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.31176470588235294
model parameter : 251842
model size : 1.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.502429246902466
Epoch: 1, Steps: 10 | Train Loss: 3.324 Vali Loss: 3.295 Vali Acc: 0.054 Test Loss: 3.295 Test Acc: 0.054
Validation loss decreased (inf --> -0.054085).  Saving model ...
Epoch: 2 cost time: 1.1774630546569824
Epoch: 2, Steps: 10 | Train Loss: 3.266 Vali Loss: 3.282 Vali Acc: 0.048 Test Loss: 3.282 Test Acc: 0.048
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0211198329925537
Epoch: 3, Steps: 10 | Train Loss: 3.197 Vali Loss: 3.274 Vali Acc: 0.046 Test Loss: 3.274 Test Acc: 0.046
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9921388626098633
Epoch: 4, Steps: 10 | Train Loss: 3.130 Vali Loss: 3.274 Vali Acc: 0.056 Test Loss: 3.274 Test Acc: 0.056
Validation loss decreased (-0.054085 --> -0.056438).  Saving model ...
Epoch: 5 cost time: 1.0804829597473145
Epoch: 5, Steps: 10 | Train Loss: 3.055 Vali Loss: 3.275 Vali Acc: 0.074 Test Loss: 3.275 Test Acc: 0.074
Validation loss decreased (-0.056438 --> -0.074085).  Saving model ...
Epoch: 6 cost time: 1.1191153526306152
Epoch: 6, Steps: 10 | Train Loss: 3.029 Vali Loss: 3.278 Vali Acc: 0.080 Test Loss: 3.278 Test Acc: 0.080
Validation loss decreased (-0.074085 --> -0.079967).  Saving model ...
Epoch: 7 cost time: 1.1438636779785156
Epoch: 7, Steps: 10 | Train Loss: 2.908 Vali Loss: 3.272 Vali Acc: 0.091 Test Loss: 3.272 Test Acc: 0.091
Validation loss decreased (-0.079967 --> -0.090556).  Saving model ...
Epoch: 8 cost time: 1.127854824066162
Epoch: 8, Steps: 10 | Train Loss: 2.840 Vali Loss: 3.264 Vali Acc: 0.098 Test Loss: 3.264 Test Acc: 0.098
Validation loss decreased (-0.090556 --> -0.097614).  Saving model ...
Epoch: 9 cost time: 1.2164099216461182
Epoch: 9, Steps: 10 | Train Loss: 2.771 Vali Loss: 3.249 Vali Acc: 0.107 Test Loss: 3.249 Test Acc: 0.107
Validation loss decreased (-0.097614 --> -0.107026).  Saving model ...
Epoch: 10 cost time: 1.2640650272369385
Epoch: 10, Steps: 10 | Train Loss: 2.636 Vali Loss: 3.226 Vali Acc: 0.114 Test Loss: 3.226 Test Acc: 0.114
Validation loss decreased (-0.107026 --> -0.114085).  Saving model ...
Epoch: 11 cost time: 1.1969585418701172
Epoch: 11, Steps: 10 | Train Loss: 2.524 Vali Loss: 3.209 Vali Acc: 0.119 Test Loss: 3.209 Test Acc: 0.119
Validation loss decreased (-0.114085 --> -0.118791).  Saving model ...
Epoch: 12 cost time: 1.2069964408874512
Epoch: 12, Steps: 10 | Train Loss: 2.421 Vali Loss: 3.190 Vali Acc: 0.122 Test Loss: 3.190 Test Acc: 0.122
Validation loss decreased (-0.118791 --> -0.122321).  Saving model ...
Epoch: 13 cost time: 1.2122673988342285
Epoch: 13, Steps: 10 | Train Loss: 2.324 Vali Loss: 3.171 Vali Acc: 0.132 Test Loss: 3.171 Test Acc: 0.132
Validation loss decreased (-0.122321 --> -0.131733).  Saving model ...
Epoch: 14 cost time: 1.1321253776550293
Epoch: 14, Steps: 10 | Train Loss: 2.181 Vali Loss: 3.159 Vali Acc: 0.146 Test Loss: 3.159 Test Acc: 0.146
Validation loss decreased (-0.131733 --> -0.145851).  Saving model ...
Epoch: 15 cost time: 1.090482473373413
Epoch: 15, Steps: 10 | Train Loss: 2.128 Vali Loss: 3.136 Vali Acc: 0.154 Test Loss: 3.136 Test Acc: 0.154
Validation loss decreased (-0.145851 --> -0.154086).  Saving model ...
Epoch: 16 cost time: 1.018803358078003
Epoch: 16, Steps: 10 | Train Loss: 1.933 Vali Loss: 3.119 Vali Acc: 0.161 Test Loss: 3.119 Test Acc: 0.161
Validation loss decreased (-0.154086 --> -0.161145).  Saving model ...
Epoch: 17 cost time: 1.205955982208252
Epoch: 17, Steps: 10 | Train Loss: 1.791 Vali Loss: 3.096 Vali Acc: 0.165 Test Loss: 3.096 Test Acc: 0.165
Validation loss decreased (-0.161145 --> -0.164675).  Saving model ...
Epoch: 18 cost time: 1.263098955154419
Epoch: 18, Steps: 10 | Train Loss: 1.625 Vali Loss: 3.095 Vali Acc: 0.172 Test Loss: 3.095 Test Acc: 0.172
Validation loss decreased (-0.164675 --> -0.171734).  Saving model ...
Epoch: 19 cost time: 1.1769695281982422
Epoch: 19, Steps: 10 | Train Loss: 1.462 Vali Loss: 3.068 Vali Acc: 0.191 Test Loss: 3.068 Test Acc: 0.191
Validation loss decreased (-0.171734 --> -0.190558).  Saving model ...
Epoch: 20 cost time: 1.173891544342041
Epoch: 20, Steps: 10 | Train Loss: 1.398 Vali Loss: 3.054 Vali Acc: 0.204 Test Loss: 3.054 Test Acc: 0.204
Validation loss decreased (-0.190558 --> -0.203499).  Saving model ...
Epoch: 21 cost time: 1.1915476322174072
Epoch: 21, Steps: 10 | Train Loss: 1.294 Vali Loss: 3.058 Vali Acc: 0.199 Test Loss: 3.058 Test Acc: 0.199
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2802379131317139
Epoch: 22, Steps: 10 | Train Loss: 1.174 Vali Loss: 3.040 Vali Acc: 0.209 Test Loss: 3.040 Test Acc: 0.209
Validation loss decreased (-0.203499 --> -0.209381).  Saving model ...
Epoch: 23 cost time: 1.1590771675109863
Epoch: 23, Steps: 10 | Train Loss: 1.129 Vali Loss: 3.046 Vali Acc: 0.220 Test Loss: 3.046 Test Acc: 0.220
Validation loss decreased (-0.209381 --> -0.219970).  Saving model ...
Epoch: 24 cost time: 1.0028495788574219
Epoch: 24, Steps: 10 | Train Loss: 0.874 Vali Loss: 3.045 Vali Acc: 0.218 Test Loss: 3.045 Test Acc: 0.218
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0833473205566406
Epoch: 25, Steps: 10 | Train Loss: 0.804 Vali Loss: 3.016 Vali Acc: 0.231 Test Loss: 3.016 Test Acc: 0.231
Validation loss decreased (-0.219970 --> -0.230558).  Saving model ...
Epoch: 26 cost time: 1.0626311302185059
Epoch: 26, Steps: 10 | Train Loss: 0.706 Vali Loss: 3.042 Vali Acc: 0.236 Test Loss: 3.042 Test Acc: 0.236
Validation loss decreased (-0.230558 --> -0.236440).  Saving model ...
Epoch: 27 cost time: 1.1560990810394287
Epoch: 27, Steps: 10 | Train Loss: 0.675 Vali Loss: 3.064 Vali Acc: 0.239 Test Loss: 3.064 Test Acc: 0.239
Validation loss decreased (-0.236440 --> -0.238793).  Saving model ...
Epoch: 28 cost time: 1.2091174125671387
Epoch: 28, Steps: 10 | Train Loss: 0.627 Vali Loss: 3.071 Vali Acc: 0.231 Test Loss: 3.071 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2072269916534424
Epoch: 29, Steps: 10 | Train Loss: 0.466 Vali Loss: 3.086 Vali Acc: 0.239 Test Loss: 3.086 Test Acc: 0.239
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.182661533355713
Epoch: 30, Steps: 10 | Train Loss: 0.452 Vali Loss: 3.089 Vali Acc: 0.241 Test Loss: 3.089 Test Acc: 0.241
Validation loss decreased (-0.238793 --> -0.241146).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2411764705882353
model parameter : 96562
model size : 0.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.64207124710083
Epoch: 1, Steps: 10 | Train Loss: 3.335 Vali Loss: 3.304 Vali Acc: 0.036 Test Loss: 3.304 Test Acc: 0.036
Validation loss decreased (inf --> -0.036438).  Saving model ...
Epoch: 2 cost time: 1.1304471492767334
Epoch: 2, Steps: 10 | Train Loss: 3.273 Vali Loss: 3.289 Vali Acc: 0.042 Test Loss: 3.289 Test Acc: 0.042
Validation loss decreased (-0.036438 --> -0.042320).  Saving model ...
Epoch: 3 cost time: 1.1412227153778076
Epoch: 3, Steps: 10 | Train Loss: 3.180 Vali Loss: 3.278 Vali Acc: 0.051 Test Loss: 3.278 Test Acc: 0.051
Validation loss decreased (-0.042320 --> -0.050555).  Saving model ...
Epoch: 4 cost time: 1.1532535552978516
Epoch: 4, Steps: 10 | Train Loss: 3.135 Vali Loss: 3.271 Vali Acc: 0.061 Test Loss: 3.271 Test Acc: 0.061
Validation loss decreased (-0.050555 --> -0.061144).  Saving model ...
Epoch: 5 cost time: 1.1797337532043457
Epoch: 5, Steps: 10 | Train Loss: 3.021 Vali Loss: 3.264 Vali Acc: 0.079 Test Loss: 3.264 Test Acc: 0.079
Validation loss decreased (-0.061144 --> -0.078791).  Saving model ...
Epoch: 6 cost time: 0.8408505916595459
Epoch: 6, Steps: 10 | Train Loss: 2.933 Vali Loss: 3.255 Vali Acc: 0.094 Test Loss: 3.255 Test Acc: 0.094
Validation loss decreased (-0.078791 --> -0.094085).  Saving model ...
Epoch: 7 cost time: 0.9343204498291016
Epoch: 7, Steps: 10 | Train Loss: 2.865 Vali Loss: 3.243 Vali Acc: 0.106 Test Loss: 3.243 Test Acc: 0.106
Validation loss decreased (-0.094085 --> -0.105850).  Saving model ...
Epoch: 8 cost time: 0.933720588684082
Epoch: 8, Steps: 10 | Train Loss: 2.793 Vali Loss: 3.228 Vali Acc: 0.109 Test Loss: 3.228 Test Acc: 0.109
Validation loss decreased (-0.105850 --> -0.109379).  Saving model ...
Epoch: 9 cost time: 0.9147257804870605
Epoch: 9, Steps: 10 | Train Loss: 2.654 Vali Loss: 3.207 Vali Acc: 0.121 Test Loss: 3.207 Test Acc: 0.121
Validation loss decreased (-0.109379 --> -0.121144).  Saving model ...
Epoch: 10 cost time: 0.7461857795715332
Epoch: 10, Steps: 10 | Train Loss: 2.526 Vali Loss: 3.174 Vali Acc: 0.142 Test Loss: 3.174 Test Acc: 0.142
Validation loss decreased (-0.121144 --> -0.142321).  Saving model ...
Epoch: 11 cost time: 1.0683269500732422
Epoch: 11, Steps: 10 | Train Loss: 2.377 Vali Loss: 3.147 Vali Acc: 0.147 Test Loss: 3.147 Test Acc: 0.147
Validation loss decreased (-0.142321 --> -0.147027).  Saving model ...
Epoch: 12 cost time: 0.877199649810791
Epoch: 12, Steps: 10 | Train Loss: 2.229 Vali Loss: 3.118 Vali Acc: 0.153 Test Loss: 3.118 Test Acc: 0.153
Validation loss decreased (-0.147027 --> -0.152910).  Saving model ...
Epoch: 13 cost time: 1.081547498703003
Epoch: 13, Steps: 10 | Train Loss: 2.102 Vali Loss: 3.102 Vali Acc: 0.158 Test Loss: 3.102 Test Acc: 0.158
Validation loss decreased (-0.152910 --> -0.157616).  Saving model ...
Epoch: 14 cost time: 1.0631604194641113
Epoch: 14, Steps: 10 | Train Loss: 1.980 Vali Loss: 3.073 Vali Acc: 0.173 Test Loss: 3.073 Test Acc: 0.173
Validation loss decreased (-0.157616 --> -0.172910).  Saving model ...
Epoch: 15 cost time: 1.027930498123169
Epoch: 15, Steps: 10 | Train Loss: 1.797 Vali Loss: 3.046 Vali Acc: 0.182 Test Loss: 3.046 Test Acc: 0.182
Validation loss decreased (-0.172910 --> -0.182322).  Saving model ...
Epoch: 16 cost time: 1.120426893234253
Epoch: 16, Steps: 10 | Train Loss: 1.645 Vali Loss: 3.026 Vali Acc: 0.202 Test Loss: 3.026 Test Acc: 0.202
Validation loss decreased (-0.182322 --> -0.202323).  Saving model ...
Epoch: 17 cost time: 0.9424417018890381
Epoch: 17, Steps: 10 | Train Loss: 1.488 Vali Loss: 3.000 Vali Acc: 0.200 Test Loss: 3.000 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9461872577667236
Epoch: 18, Steps: 10 | Train Loss: 1.327 Vali Loss: 2.988 Vali Acc: 0.218 Test Loss: 2.988 Test Acc: 0.218
Validation loss decreased (-0.202323 --> -0.217617).  Saving model ...
Epoch: 19 cost time: 0.9242172241210938
Epoch: 19, Steps: 10 | Train Loss: 1.213 Vali Loss: 2.948 Vali Acc: 0.221 Test Loss: 2.948 Test Acc: 0.221
Validation loss decreased (-0.217617 --> -0.221147).  Saving model ...
Epoch: 20 cost time: 1.074570894241333
Epoch: 20, Steps: 10 | Train Loss: 1.034 Vali Loss: 2.964 Vali Acc: 0.235 Test Loss: 2.964 Test Acc: 0.235
Validation loss decreased (-0.221147 --> -0.235264).  Saving model ...
Epoch: 21 cost time: 1.113260269165039
Epoch: 21, Steps: 10 | Train Loss: 0.884 Vali Loss: 2.938 Vali Acc: 0.254 Test Loss: 2.938 Test Acc: 0.254
Validation loss decreased (-0.235264 --> -0.254088).  Saving model ...
Epoch: 22 cost time: 1.1152288913726807
Epoch: 22, Steps: 10 | Train Loss: 0.765 Vali Loss: 2.934 Vali Acc: 0.255 Test Loss: 2.934 Test Acc: 0.255
Validation loss decreased (-0.254088 --> -0.255265).  Saving model ...
Epoch: 23 cost time: 1.0755305290222168
Epoch: 23, Steps: 10 | Train Loss: 0.714 Vali Loss: 2.908 Vali Acc: 0.272 Test Loss: 2.908 Test Acc: 0.272
Validation loss decreased (-0.255265 --> -0.271736).  Saving model ...
Epoch: 24 cost time: 1.040849208831787
Epoch: 24, Steps: 10 | Train Loss: 0.586 Vali Loss: 2.904 Vali Acc: 0.271 Test Loss: 2.904 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.015592098236084
Epoch: 25, Steps: 10 | Train Loss: 0.555 Vali Loss: 2.899 Vali Acc: 0.267 Test Loss: 2.899 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8631656169891357
Epoch: 26, Steps: 10 | Train Loss: 0.392 Vali Loss: 2.921 Vali Acc: 0.269 Test Loss: 2.921 Test Acc: 0.269
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.1532690525054932
Epoch: 27, Steps: 10 | Train Loss: 0.518 Vali Loss: 2.924 Vali Acc: 0.275 Test Loss: 2.924 Test Acc: 0.275
Validation loss decreased (-0.271736 --> -0.275265).  Saving model ...
Epoch: 28 cost time: 1.1925396919250488
Epoch: 28, Steps: 10 | Train Loss: 0.328 Vali Loss: 2.938 Vali Acc: 0.289 Test Loss: 2.938 Test Acc: 0.289
Validation loss decreased (-0.275265 --> -0.289382).  Saving model ...
Epoch: 29 cost time: 1.0318882465362549
Epoch: 29, Steps: 10 | Train Loss: 0.283 Vali Loss: 2.936 Vali Acc: 0.288 Test Loss: 2.936 Test Acc: 0.288
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9244787693023682
Epoch: 30, Steps: 10 | Train Loss: 0.295 Vali Loss: 2.930 Vali Acc: 0.304 Test Loss: 2.930 Test Acc: 0.304
Validation loss decreased (-0.289382 --> -0.303500).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3035294117647059
model parameter : 251842
model size : 1.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.333270788192749
Epoch: 1, Steps: 10 | Train Loss: 3.340 Vali Loss: 3.293 Vali Acc: 0.058 Test Loss: 3.293 Test Acc: 0.058
Validation loss decreased (inf --> -0.057614).  Saving model ...
Epoch: 2 cost time: 0.9046387672424316
Epoch: 2, Steps: 10 | Train Loss: 3.267 Vali Loss: 3.280 Vali Acc: 0.049 Test Loss: 3.280 Test Acc: 0.049
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9011385440826416
Epoch: 3, Steps: 10 | Train Loss: 3.206 Vali Loss: 3.272 Vali Acc: 0.038 Test Loss: 3.272 Test Acc: 0.038
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9119107723236084
Epoch: 4, Steps: 10 | Train Loss: 3.137 Vali Loss: 3.272 Vali Acc: 0.054 Test Loss: 3.272 Test Acc: 0.054
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8370766639709473
Epoch: 5, Steps: 10 | Train Loss: 3.067 Vali Loss: 3.274 Vali Acc: 0.068 Test Loss: 3.274 Test Acc: 0.068
Validation loss decreased (-0.057614 --> -0.068203).  Saving model ...
Epoch: 6 cost time: 0.789013147354126
Epoch: 6, Steps: 10 | Train Loss: 3.043 Vali Loss: 3.277 Vali Acc: 0.076 Test Loss: 3.277 Test Acc: 0.076
Validation loss decreased (-0.068203 --> -0.076438).  Saving model ...
Epoch: 7 cost time: 0.9010758399963379
Epoch: 7, Steps: 10 | Train Loss: 2.920 Vali Loss: 3.272 Vali Acc: 0.080 Test Loss: 3.272 Test Acc: 0.080
Validation loss decreased (-0.076438 --> -0.079967).  Saving model ...
Epoch: 8 cost time: 0.851492166519165
Epoch: 8, Steps: 10 | Train Loss: 2.856 Vali Loss: 3.264 Vali Acc: 0.087 Test Loss: 3.264 Test Acc: 0.087
Validation loss decreased (-0.079967 --> -0.087026).  Saving model ...
Epoch: 9 cost time: 0.8916363716125488
Epoch: 9, Steps: 10 | Train Loss: 2.791 Vali Loss: 3.249 Vali Acc: 0.093 Test Loss: 3.249 Test Acc: 0.093
Validation loss decreased (-0.087026 --> -0.092909).  Saving model ...
Epoch: 10 cost time: 0.8949415683746338
Epoch: 10, Steps: 10 | Train Loss: 2.658 Vali Loss: 3.227 Vali Acc: 0.102 Test Loss: 3.227 Test Acc: 0.102
Validation loss decreased (-0.092909 --> -0.102321).  Saving model ...
Epoch: 11 cost time: 0.9041779041290283
Epoch: 11, Steps: 10 | Train Loss: 2.581 Vali Loss: 3.210 Vali Acc: 0.118 Test Loss: 3.210 Test Acc: 0.118
Validation loss decreased (-0.102321 --> -0.117615).  Saving model ...
Epoch: 12 cost time: 0.8230361938476562
Epoch: 12, Steps: 10 | Train Loss: 2.447 Vali Loss: 3.192 Vali Acc: 0.127 Test Loss: 3.192 Test Acc: 0.127
Validation loss decreased (-0.117615 --> -0.127027).  Saving model ...
Epoch: 13 cost time: 0.841571569442749
Epoch: 13, Steps: 10 | Train Loss: 2.373 Vali Loss: 3.174 Vali Acc: 0.134 Test Loss: 3.174 Test Acc: 0.134
Validation loss decreased (-0.127027 --> -0.134086).  Saving model ...
Epoch: 14 cost time: 0.8303859233856201
Epoch: 14, Steps: 10 | Train Loss: 2.209 Vali Loss: 3.163 Vali Acc: 0.140 Test Loss: 3.163 Test Acc: 0.140
Validation loss decreased (-0.134086 --> -0.139968).  Saving model ...
Epoch: 15 cost time: 0.7087898254394531
Epoch: 15, Steps: 10 | Train Loss: 2.186 Vali Loss: 3.142 Vali Acc: 0.151 Test Loss: 3.142 Test Acc: 0.151
Validation loss decreased (-0.139968 --> -0.150557).  Saving model ...
Epoch: 16 cost time: 0.9537925720214844
Epoch: 16, Steps: 10 | Train Loss: 2.043 Vali Loss: 3.126 Vali Acc: 0.166 Test Loss: 3.126 Test Acc: 0.166
Validation loss decreased (-0.150557 --> -0.165851).  Saving model ...
Epoch: 17 cost time: 0.9778523445129395
Epoch: 17, Steps: 10 | Train Loss: 1.882 Vali Loss: 3.103 Vali Acc: 0.168 Test Loss: 3.103 Test Acc: 0.168
Validation loss decreased (-0.165851 --> -0.168204).  Saving model ...
Epoch: 18 cost time: 0.8832142353057861
Epoch: 18, Steps: 10 | Train Loss: 1.758 Vali Loss: 3.106 Vali Acc: 0.166 Test Loss: 3.106 Test Acc: 0.166
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9316051006317139
Epoch: 19, Steps: 10 | Train Loss: 1.594 Vali Loss: 3.084 Vali Acc: 0.176 Test Loss: 3.084 Test Acc: 0.176
Validation loss decreased (-0.168204 --> -0.176440).  Saving model ...
Epoch: 20 cost time: 0.8518996238708496
Epoch: 20, Steps: 10 | Train Loss: 1.593 Vali Loss: 3.080 Vali Acc: 0.192 Test Loss: 3.080 Test Acc: 0.192
Validation loss decreased (-0.176440 --> -0.191734).  Saving model ...
Epoch: 21 cost time: 0.6987884044647217
Epoch: 21, Steps: 10 | Train Loss: 1.422 Vali Loss: 3.080 Vali Acc: 0.187 Test Loss: 3.080 Test Acc: 0.187
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.874737024307251
Epoch: 22, Steps: 10 | Train Loss: 1.340 Vali Loss: 3.056 Vali Acc: 0.205 Test Loss: 3.056 Test Acc: 0.205
Validation loss decreased (-0.191734 --> -0.204675).  Saving model ...
Epoch: 23 cost time: 0.91607666015625
Epoch: 23, Steps: 10 | Train Loss: 1.200 Vali Loss: 3.065 Vali Acc: 0.209 Test Loss: 3.065 Test Acc: 0.209
Validation loss decreased (-0.204675 --> -0.209381).  Saving model ...
Epoch: 24 cost time: 0.9088535308837891
Epoch: 24, Steps: 10 | Train Loss: 1.044 Vali Loss: 3.044 Vali Acc: 0.214 Test Loss: 3.044 Test Acc: 0.214
Validation loss decreased (-0.209381 --> -0.214087).  Saving model ...
Epoch: 25 cost time: 0.898078441619873
Epoch: 25, Steps: 10 | Train Loss: 0.922 Vali Loss: 3.041 Vali Acc: 0.218 Test Loss: 3.041 Test Acc: 0.218
Validation loss decreased (-0.214087 --> -0.217617).  Saving model ...
Epoch: 26 cost time: 0.8393368721008301
Epoch: 26, Steps: 10 | Train Loss: 0.853 Vali Loss: 3.070 Vali Acc: 0.218 Test Loss: 3.070 Test Acc: 0.218
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7335929870605469
Epoch: 27, Steps: 10 | Train Loss: 0.776 Vali Loss: 3.052 Vali Acc: 0.235 Test Loss: 3.052 Test Acc: 0.235
Validation loss decreased (-0.217617 --> -0.235264).  Saving model ...
Epoch: 28 cost time: 0.8457727432250977
Epoch: 28, Steps: 10 | Train Loss: 0.667 Vali Loss: 3.109 Vali Acc: 0.228 Test Loss: 3.109 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8289284706115723
Epoch: 29, Steps: 10 | Train Loss: 0.695 Vali Loss: 3.089 Vali Acc: 0.233 Test Loss: 3.089 Test Acc: 0.233
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.729252815246582
Epoch: 30, Steps: 10 | Train Loss: 0.521 Vali Loss: 3.109 Vali Acc: 0.240 Test Loss: 3.109 Test Acc: 0.240
Validation loss decreased (-0.235264 --> -0.239969).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.24
model parameter : 96562
model size : 0.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.087520122528076
Epoch: 1, Steps: 10 | Train Loss: 3.342 Vali Loss: 3.303 Vali Acc: 0.029 Test Loss: 3.303 Test Acc: 0.029
Validation loss decreased (inf --> -0.029379).  Saving model ...
Epoch: 2 cost time: 0.8105933666229248
Epoch: 2, Steps: 10 | Train Loss: 3.283 Vali Loss: 3.288 Vali Acc: 0.045 Test Loss: 3.288 Test Acc: 0.045
Validation loss decreased (-0.029379 --> -0.044673).  Saving model ...
Epoch: 3 cost time: 0.799776554107666
Epoch: 3, Steps: 10 | Train Loss: 3.187 Vali Loss: 3.277 Vali Acc: 0.052 Test Loss: 3.277 Test Acc: 0.052
Validation loss decreased (-0.044673 --> -0.051732).  Saving model ...
Epoch: 4 cost time: 0.8393113613128662
Epoch: 4, Steps: 10 | Train Loss: 3.138 Vali Loss: 3.271 Vali Acc: 0.061 Test Loss: 3.271 Test Acc: 0.061
Validation loss decreased (-0.051732 --> -0.061144).  Saving model ...
Epoch: 5 cost time: 0.9027824401855469
Epoch: 5, Steps: 10 | Train Loss: 3.031 Vali Loss: 3.266 Vali Acc: 0.079 Test Loss: 3.266 Test Acc: 0.079
Validation loss decreased (-0.061144 --> -0.078791).  Saving model ...
Epoch: 6 cost time: 0.8864781856536865
Epoch: 6, Steps: 10 | Train Loss: 2.977 Vali Loss: 3.260 Vali Acc: 0.091 Test Loss: 3.260 Test Acc: 0.091
Validation loss decreased (-0.078791 --> -0.090556).  Saving model ...
Epoch: 7 cost time: 0.8252754211425781
Epoch: 7, Steps: 10 | Train Loss: 2.882 Vali Loss: 3.249 Vali Acc: 0.098 Test Loss: 3.249 Test Acc: 0.098
Validation loss decreased (-0.090556 --> -0.097615).  Saving model ...
Epoch: 8 cost time: 0.7515089511871338
Epoch: 8, Steps: 10 | Train Loss: 2.838 Vali Loss: 3.235 Vali Acc: 0.106 Test Loss: 3.235 Test Acc: 0.106
Validation loss decreased (-0.097615 --> -0.105850).  Saving model ...
Epoch: 9 cost time: 0.8080172538757324
Epoch: 9, Steps: 10 | Train Loss: 2.705 Vali Loss: 3.216 Vali Acc: 0.128 Test Loss: 3.216 Test Acc: 0.128
Validation loss decreased (-0.105850 --> -0.128203).  Saving model ...
Epoch: 10 cost time: 0.8011274337768555
Epoch: 10, Steps: 10 | Train Loss: 2.595 Vali Loss: 3.187 Vali Acc: 0.134 Test Loss: 3.187 Test Acc: 0.134
Validation loss decreased (-0.128203 --> -0.134086).  Saving model ...
Epoch: 11 cost time: 0.7915129661560059
Epoch: 11, Steps: 10 | Train Loss: 2.442 Vali Loss: 3.157 Vali Acc: 0.148 Test Loss: 3.157 Test Acc: 0.148
Validation loss decreased (-0.134086 --> -0.148204).  Saving model ...
Epoch: 12 cost time: 0.7802414894104004
Epoch: 12, Steps: 10 | Train Loss: 2.348 Vali Loss: 3.128 Vali Acc: 0.158 Test Loss: 3.128 Test Acc: 0.158
Validation loss decreased (-0.148204 --> -0.157616).  Saving model ...
Epoch: 13 cost time: 0.6958563327789307
Epoch: 13, Steps: 10 | Train Loss: 2.184 Vali Loss: 3.109 Vali Acc: 0.156 Test Loss: 3.109 Test Acc: 0.156
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9036374092102051
Epoch: 14, Steps: 10 | Train Loss: 2.030 Vali Loss: 3.087 Vali Acc: 0.167 Test Loss: 3.087 Test Acc: 0.167
Validation loss decreased (-0.157616 --> -0.167028).  Saving model ...
Epoch: 15 cost time: 0.9421007633209229
Epoch: 15, Steps: 10 | Train Loss: 1.896 Vali Loss: 3.066 Vali Acc: 0.181 Test Loss: 3.066 Test Acc: 0.181
Validation loss decreased (-0.167028 --> -0.181146).  Saving model ...
Epoch: 16 cost time: 0.8994705677032471
Epoch: 16, Steps: 10 | Train Loss: 1.798 Vali Loss: 3.042 Vali Acc: 0.185 Test Loss: 3.042 Test Acc: 0.185
Validation loss decreased (-0.181146 --> -0.184675).  Saving model ...
Epoch: 17 cost time: 0.808147668838501
Epoch: 17, Steps: 10 | Train Loss: 1.603 Vali Loss: 3.023 Vali Acc: 0.188 Test Loss: 3.023 Test Acc: 0.188
Validation loss decreased (-0.184675 --> -0.188205).  Saving model ...
Epoch: 18 cost time: 0.8283853530883789
Epoch: 18, Steps: 10 | Train Loss: 1.570 Vali Loss: 2.993 Vali Acc: 0.199 Test Loss: 2.993 Test Acc: 0.199
Validation loss decreased (-0.188205 --> -0.198794).  Saving model ...
Epoch: 19 cost time: 0.7995307445526123
Epoch: 19, Steps: 10 | Train Loss: 1.419 Vali Loss: 2.979 Vali Acc: 0.205 Test Loss: 2.979 Test Acc: 0.205
Validation loss decreased (-0.198794 --> -0.204676).  Saving model ...
Epoch: 20 cost time: 0.7878000736236572
Epoch: 20, Steps: 10 | Train Loss: 1.287 Vali Loss: 2.981 Vali Acc: 0.211 Test Loss: 2.981 Test Acc: 0.211
Validation loss decreased (-0.204676 --> -0.210558).  Saving model ...
Epoch: 21 cost time: 0.6452322006225586
Epoch: 21, Steps: 10 | Train Loss: 1.166 Vali Loss: 2.918 Vali Acc: 0.220 Test Loss: 2.918 Test Acc: 0.220
Validation loss decreased (-0.210558 --> -0.219971).  Saving model ...
Epoch: 22 cost time: 0.9013068675994873
Epoch: 22, Steps: 10 | Train Loss: 1.081 Vali Loss: 2.922 Vali Acc: 0.235 Test Loss: 2.922 Test Acc: 0.235
Validation loss decreased (-0.219971 --> -0.235265).  Saving model ...
Epoch: 23 cost time: 0.9005615711212158
Epoch: 23, Steps: 10 | Train Loss: 0.949 Vali Loss: 2.894 Vali Acc: 0.236 Test Loss: 2.894 Test Acc: 0.236
Validation loss decreased (-0.235265 --> -0.236442).  Saving model ...
Epoch: 24 cost time: 0.920236349105835
Epoch: 24, Steps: 10 | Train Loss: 0.888 Vali Loss: 2.915 Vali Acc: 0.252 Test Loss: 2.915 Test Acc: 0.252
Validation loss decreased (-0.236442 --> -0.251736).  Saving model ...
Epoch: 25 cost time: 0.8819398880004883
Epoch: 25, Steps: 10 | Train Loss: 0.752 Vali Loss: 2.896 Vali Acc: 0.245 Test Loss: 2.896 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6144890785217285
Epoch: 26, Steps: 10 | Train Loss: 0.621 Vali Loss: 2.923 Vali Acc: 0.256 Test Loss: 2.923 Test Acc: 0.256
Validation loss decreased (-0.251736 --> -0.256441).  Saving model ...
Epoch: 27 cost time: 0.8029403686523438
Epoch: 27, Steps: 10 | Train Loss: 0.612 Vali Loss: 2.910 Vali Acc: 0.280 Test Loss: 2.910 Test Acc: 0.280
Validation loss decreased (-0.256441 --> -0.279971).  Saving model ...
Epoch: 28 cost time: 0.7773833274841309
Epoch: 28, Steps: 10 | Train Loss: 0.569 Vali Loss: 2.944 Vali Acc: 0.272 Test Loss: 2.944 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7477283477783203
Epoch: 29, Steps: 10 | Train Loss: 0.534 Vali Loss: 2.940 Vali Acc: 0.280 Test Loss: 2.940 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8536951541900635
Epoch: 30, Steps: 10 | Train Loss: 0.554 Vali Loss: 2.958 Vali Acc: 0.274 Test Loss: 2.958 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28
model parameter : 251842
model size : 1.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.940506935119629
Epoch: 1, Steps: 10 | Train Loss: 3.324 Vali Loss: 3.304 Vali Acc: 0.047 Test Loss: 3.304 Test Acc: 0.047
Validation loss decreased (inf --> -0.047026).  Saving model ...
Epoch: 2 cost time: 0.7344553470611572
Epoch: 2, Steps: 10 | Train Loss: 3.260 Vali Loss: 3.292 Vali Acc: 0.051 Test Loss: 3.292 Test Acc: 0.051
Validation loss decreased (-0.047026 --> -0.050555).  Saving model ...
Epoch: 3 cost time: 0.638970136642456
Epoch: 3, Steps: 10 | Train Loss: 3.226 Vali Loss: 3.284 Vali Acc: 0.036 Test Loss: 3.284 Test Acc: 0.036
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7488553524017334
Epoch: 4, Steps: 10 | Train Loss: 3.153 Vali Loss: 3.285 Vali Acc: 0.048 Test Loss: 3.285 Test Acc: 0.048
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8126401901245117
Epoch: 5, Steps: 10 | Train Loss: 3.068 Vali Loss: 3.288 Vali Acc: 0.059 Test Loss: 3.288 Test Acc: 0.059
Validation loss decreased (-0.050555 --> -0.058791).  Saving model ...
Epoch: 6 cost time: 0.8467707633972168
Epoch: 6, Steps: 10 | Train Loss: 3.046 Vali Loss: 3.292 Vali Acc: 0.071 Test Loss: 3.292 Test Acc: 0.071
Validation loss decreased (-0.058791 --> -0.070555).  Saving model ...
Epoch: 7 cost time: 0.7978036403656006
Epoch: 7, Steps: 10 | Train Loss: 2.950 Vali Loss: 3.289 Vali Acc: 0.079 Test Loss: 3.289 Test Acc: 0.079
Validation loss decreased (-0.070555 --> -0.078791).  Saving model ...
Epoch: 8 cost time: 0.7431437969207764
Epoch: 8, Steps: 10 | Train Loss: 2.873 Vali Loss: 3.284 Vali Acc: 0.082 Test Loss: 3.284 Test Acc: 0.082
Validation loss decreased (-0.078791 --> -0.082320).  Saving model ...
Epoch: 9 cost time: 0.7816331386566162
Epoch: 9, Steps: 10 | Train Loss: 2.811 Vali Loss: 3.272 Vali Acc: 0.087 Test Loss: 3.272 Test Acc: 0.087
Validation loss decreased (-0.082320 --> -0.087026).  Saving model ...
Epoch: 10 cost time: 0.6807670593261719
Epoch: 10, Steps: 10 | Train Loss: 2.724 Vali Loss: 3.256 Vali Acc: 0.096 Test Loss: 3.256 Test Acc: 0.096
Validation loss decreased (-0.087026 --> -0.096438).  Saving model ...
Epoch: 11 cost time: 0.732715368270874
Epoch: 11, Steps: 10 | Train Loss: 2.628 Vali Loss: 3.244 Vali Acc: 0.101 Test Loss: 3.244 Test Acc: 0.101
Validation loss decreased (-0.096438 --> -0.101144).  Saving model ...
Epoch: 12 cost time: 0.7452621459960938
Epoch: 12, Steps: 10 | Train Loss: 2.566 Vali Loss: 3.231 Vali Acc: 0.111 Test Loss: 3.231 Test Acc: 0.111
Validation loss decreased (-0.101144 --> -0.110556).  Saving model ...
Epoch: 13 cost time: 0.7295372486114502
Epoch: 13, Steps: 10 | Train Loss: 2.500 Vali Loss: 3.219 Vali Acc: 0.115 Test Loss: 3.219 Test Acc: 0.115
Validation loss decreased (-0.110556 --> -0.115262).  Saving model ...
Epoch: 14 cost time: 0.8170032501220703
Epoch: 14, Steps: 10 | Train Loss: 2.347 Vali Loss: 3.212 Vali Acc: 0.109 Test Loss: 3.212 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7395555973052979
Epoch: 15, Steps: 10 | Train Loss: 2.318 Vali Loss: 3.193 Vali Acc: 0.131 Test Loss: 3.193 Test Acc: 0.131
Validation loss decreased (-0.115262 --> -0.130556).  Saving model ...
Epoch: 16 cost time: 0.7494299411773682
Epoch: 16, Steps: 10 | Train Loss: 2.147 Vali Loss: 3.182 Vali Acc: 0.140 Test Loss: 3.182 Test Acc: 0.140
Validation loss decreased (-0.130556 --> -0.139968).  Saving model ...
Epoch: 17 cost time: 0.7771930694580078
Epoch: 17, Steps: 10 | Train Loss: 2.053 Vali Loss: 3.161 Vali Acc: 0.145 Test Loss: 3.161 Test Acc: 0.145
Validation loss decreased (-0.139968 --> -0.144674).  Saving model ...
Epoch: 18 cost time: 0.7560479640960693
Epoch: 18, Steps: 10 | Train Loss: 1.979 Vali Loss: 3.161 Vali Acc: 0.144 Test Loss: 3.161 Test Acc: 0.144
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7062289714813232
Epoch: 19, Steps: 10 | Train Loss: 1.797 Vali Loss: 3.151 Vali Acc: 0.146 Test Loss: 3.151 Test Acc: 0.146
Validation loss decreased (-0.144674 --> -0.145851).  Saving model ...
Epoch: 20 cost time: 0.7489638328552246
Epoch: 20, Steps: 10 | Train Loss: 1.729 Vali Loss: 3.139 Vali Acc: 0.162 Test Loss: 3.139 Test Acc: 0.162
Validation loss decreased (-0.145851 --> -0.162322).  Saving model ...
Epoch: 21 cost time: 0.6449511051177979
Epoch: 21, Steps: 10 | Train Loss: 1.696 Vali Loss: 3.143 Vali Acc: 0.161 Test Loss: 3.143 Test Acc: 0.161
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6965997219085693
Epoch: 22, Steps: 10 | Train Loss: 1.558 Vali Loss: 3.129 Vali Acc: 0.172 Test Loss: 3.129 Test Acc: 0.172
Validation loss decreased (-0.162322 --> -0.171733).  Saving model ...
Epoch: 23 cost time: 0.7162313461303711
Epoch: 23, Steps: 10 | Train Loss: 1.473 Vali Loss: 3.127 Vali Acc: 0.176 Test Loss: 3.127 Test Acc: 0.176
Validation loss decreased (-0.171733 --> -0.176439).  Saving model ...
Epoch: 24 cost time: 0.7769553661346436
Epoch: 24, Steps: 10 | Train Loss: 1.325 Vali Loss: 3.129 Vali Acc: 0.182 Test Loss: 3.129 Test Acc: 0.182
Validation loss decreased (-0.176439 --> -0.182322).  Saving model ...
Epoch: 25 cost time: 0.8219265937805176
Epoch: 25, Steps: 10 | Train Loss: 1.219 Vali Loss: 3.118 Vali Acc: 0.194 Test Loss: 3.118 Test Acc: 0.194
Validation loss decreased (-0.182322 --> -0.194086).  Saving model ...
Epoch: 26 cost time: 0.7635157108306885
Epoch: 26, Steps: 10 | Train Loss: 1.130 Vali Loss: 3.133 Vali Acc: 0.204 Test Loss: 3.133 Test Acc: 0.204
Validation loss decreased (-0.194086 --> -0.203498).  Saving model ...
Epoch: 27 cost time: 0.8068108558654785
Epoch: 27, Steps: 10 | Train Loss: 1.067 Vali Loss: 3.140 Vali Acc: 0.202 Test Loss: 3.140 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7180631160736084
Epoch: 28, Steps: 10 | Train Loss: 0.920 Vali Loss: 3.143 Vali Acc: 0.209 Test Loss: 3.143 Test Acc: 0.209
Validation loss decreased (-0.203498 --> -0.209380).  Saving model ...
Epoch: 29 cost time: 0.6963741779327393
Epoch: 29, Steps: 10 | Train Loss: 0.821 Vali Loss: 3.137 Vali Acc: 0.206 Test Loss: 3.137 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7273967266082764
Epoch: 30, Steps: 10 | Train Loss: 0.796 Vali Loss: 3.163 Vali Acc: 0.212 Test Loss: 3.163 Test Acc: 0.212
Validation loss decreased (-0.209380 --> -0.211733).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el3_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.21176470588235294
model parameter : 96562
model size : 0.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 8.120953798294067
Epoch: 1, Steps: 10 | Train Loss: 3.244 Vali Loss: 3.242 Vali Acc: 0.074 Test Loss: 3.242 Test Acc: 0.074
Validation loss decreased (inf --> -0.074085).  Saving model ...
Epoch: 2 cost time: 5.876641035079956
Epoch: 2, Steps: 10 | Train Loss: 2.756 Vali Loss: 3.197 Vali Acc: 0.134 Test Loss: 3.197 Test Acc: 0.134
Validation loss decreased (-0.074085 --> -0.134086).  Saving model ...
Epoch: 3 cost time: 6.965490341186523
Epoch: 3, Steps: 10 | Train Loss: 1.782 Vali Loss: 3.023 Vali Acc: 0.209 Test Loss: 3.023 Test Acc: 0.209
Validation loss decreased (-0.134086 --> -0.209382).  Saving model ...
Epoch: 4 cost time: 5.984443426132202
Epoch: 4, Steps: 10 | Train Loss: 0.972 Vali Loss: 3.006 Vali Acc: 0.226 Test Loss: 3.006 Test Acc: 0.226
Validation loss decreased (-0.209382 --> -0.225852).  Saving model ...
Epoch: 5 cost time: 4.8389832973480225
Epoch: 5, Steps: 10 | Train Loss: 0.451 Vali Loss: 3.025 Vali Acc: 0.266 Test Loss: 3.025 Test Acc: 0.266
Validation loss decreased (-0.225852 --> -0.265852).  Saving model ...
Epoch: 6 cost time: 6.477365493774414
Epoch: 6, Steps: 10 | Train Loss: 0.221 Vali Loss: 3.164 Vali Acc: 0.279 Test Loss: 3.164 Test Acc: 0.279
Validation loss decreased (-0.265852 --> -0.278792).  Saving model ...
Epoch: 7 cost time: 7.492284297943115
Epoch: 7, Steps: 10 | Train Loss: 0.092 Vali Loss: 3.226 Vali Acc: 0.294 Test Loss: 3.226 Test Acc: 0.294
Validation loss decreased (-0.278792 --> -0.294085).  Saving model ...
Epoch: 8 cost time: 6.232681035995483
Epoch: 8, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.280 Vali Acc: 0.289 Test Loss: 3.280 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.427045822143555
Epoch: 9, Steps: 10 | Train Loss: 0.179 Vali Loss: 3.500 Vali Acc: 0.264 Test Loss: 3.500 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.221296548843384
Epoch: 10, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.234 Vali Acc: 0.301 Test Loss: 3.234 Test Acc: 0.301
Validation loss decreased (-0.294085 --> -0.301144).  Saving model ...
Epoch: 11 cost time: 7.36320948600769
Epoch: 11, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.697 Vali Acc: 0.287 Test Loss: 3.697 Test Acc: 0.287
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.160828590393066
Epoch: 12, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.508 Vali Acc: 0.306 Test Loss: 3.508 Test Acc: 0.306
Validation loss decreased (-0.301144 --> -0.305847).  Saving model ...
Epoch: 13 cost time: 7.070328712463379
Epoch: 13, Steps: 10 | Train Loss: 0.068 Vali Loss: 3.584 Vali Acc: 0.294 Test Loss: 3.584 Test Acc: 0.294
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.974659442901611
Epoch: 14, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.848 Vali Acc: 0.295 Test Loss: 3.848 Test Acc: 0.295
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 7.125308990478516
Epoch: 15, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.759 Vali Acc: 0.308 Test Loss: 3.759 Test Acc: 0.308
Validation loss decreased (-0.305847 --> -0.308198).  Saving model ...
Epoch: 16 cost time: 7.235114574432373
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.858 Vali Acc: 0.300 Test Loss: 3.858 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.2866599559783936
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.847 Vali Acc: 0.302 Test Loss: 3.847 Test Acc: 0.302
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.918172597885132
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.797 Vali Acc: 0.316 Test Loss: 3.797 Test Acc: 0.316
Validation loss decreased (-0.308198 --> -0.316433).  Saving model ...
Epoch: 19 cost time: 6.133108615875244
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.804 Vali Acc: 0.314 Test Loss: 3.804 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 7.298092842102051
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.872 Vali Acc: 0.325 Test Loss: 3.872 Test Acc: 0.325
Validation loss decreased (-0.316433 --> -0.324667).  Saving model ...
Epoch: 21 cost time: 5.944716691970825
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.857 Vali Acc: 0.308 Test Loss: 3.857 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 7.384473085403442
Epoch: 22, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.018 Vali Acc: 0.282 Test Loss: 4.018 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 6.5237205028533936
Epoch: 23, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.779 Vali Acc: 0.316 Test Loss: 3.779 Test Acc: 0.316
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 7.6228673458099365
Epoch: 24, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.989 Vali Acc: 0.291 Test Loss: 3.989 Test Acc: 0.291
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 7.393443584442139
Epoch: 25, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.940 Vali Acc: 0.315 Test Loss: 3.940 Test Acc: 0.315
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 6.395263195037842
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.135 Vali Acc: 0.294 Test Loss: 4.135 Test Acc: 0.294
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 7.233908653259277
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.974 Vali Acc: 0.308 Test Loss: 3.974 Test Acc: 0.308
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 5.80580735206604
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.151 Vali Acc: 0.293 Test Loss: 4.151 Test Acc: 0.293
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 7.185662269592285
Epoch: 29, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.082 Vali Acc: 0.307 Test Loss: 4.082 Test Acc: 0.307
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 6.446828603744507
Epoch: 30, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.748 Vali Acc: 0.284 Test Loss: 4.748 Test Acc: 0.284
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3247058823529412
model parameter : 37999002
model size : 147.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.80712890625
Epoch: 1, Steps: 10 | Train Loss: 3.371 Vali Loss: 3.274 Vali Acc: 0.086 Test Loss: 3.274 Test Acc: 0.086
Validation loss decreased (inf --> -0.085850).  Saving model ...
Epoch: 2 cost time: 2.129584312438965
Epoch: 2, Steps: 10 | Train Loss: 2.797 Vali Loss: 3.314 Vali Acc: 0.132 Test Loss: 3.314 Test Acc: 0.132
Validation loss decreased (-0.085850 --> -0.131732).  Saving model ...
Epoch: 3 cost time: 2.1420743465423584
Epoch: 3, Steps: 10 | Train Loss: 2.105 Vali Loss: 3.093 Vali Acc: 0.174 Test Loss: 3.093 Test Acc: 0.174
Validation loss decreased (-0.131732 --> -0.174087).  Saving model ...
Epoch: 4 cost time: 2.2471132278442383
Epoch: 4, Steps: 10 | Train Loss: 1.275 Vali Loss: 3.000 Vali Acc: 0.226 Test Loss: 3.000 Test Acc: 0.226
Validation loss decreased (-0.174087 --> -0.225852).  Saving model ...
Epoch: 5 cost time: 1.6066884994506836
Epoch: 5, Steps: 10 | Train Loss: 0.648 Vali Loss: 3.015 Vali Acc: 0.258 Test Loss: 3.015 Test Acc: 0.258
Validation loss decreased (-0.225852 --> -0.257617).  Saving model ...
Epoch: 6 cost time: 1.7916316986083984
Epoch: 6, Steps: 10 | Train Loss: 0.283 Vali Loss: 3.066 Vali Acc: 0.288 Test Loss: 3.066 Test Acc: 0.288
Validation loss decreased (-0.257617 --> -0.288205).  Saving model ...
Epoch: 7 cost time: 1.7479743957519531
Epoch: 7, Steps: 10 | Train Loss: 0.149 Vali Loss: 3.228 Vali Acc: 0.287 Test Loss: 3.228 Test Acc: 0.287
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.2365806102752686
Epoch: 8, Steps: 10 | Train Loss: 0.056 Vali Loss: 3.358 Vali Acc: 0.309 Test Loss: 3.358 Test Acc: 0.309
Validation loss decreased (-0.288205 --> -0.309378).  Saving model ...
Epoch: 9 cost time: 2.249265670776367
Epoch: 9, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.335 Vali Acc: 0.306 Test Loss: 3.335 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.068174362182617
Epoch: 10, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.501 Vali Acc: 0.286 Test Loss: 3.501 Test Acc: 0.286
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8617534637451172
Epoch: 11, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.398 Vali Acc: 0.307 Test Loss: 3.398 Test Acc: 0.307
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.2211828231811523
Epoch: 12, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.502 Vali Acc: 0.313 Test Loss: 3.502 Test Acc: 0.313
Validation loss decreased (-0.309378 --> -0.312906).  Saving model ...
Epoch: 13 cost time: 2.184389591217041
Epoch: 13, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.949 Vali Acc: 0.281 Test Loss: 3.949 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.878230094909668
Epoch: 14, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.487 Vali Acc: 0.293 Test Loss: 3.487 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.284008502960205
Epoch: 15, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.957 Vali Acc: 0.272 Test Loss: 3.957 Test Acc: 0.272
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.2328855991363525
Epoch: 16, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.574 Vali Acc: 0.315 Test Loss: 3.574 Test Acc: 0.315
Validation loss decreased (-0.312906 --> -0.315258).  Saving model ...
Epoch: 17 cost time: 1.9736335277557373
Epoch: 17, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.565 Vali Acc: 0.322 Test Loss: 3.565 Test Acc: 0.322
Validation loss decreased (-0.315258 --> -0.322317).  Saving model ...
Epoch: 18 cost time: 2.008169651031494
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.615 Vali Acc: 0.313 Test Loss: 3.615 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.2935173511505127
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.646 Vali Acc: 0.308 Test Loss: 3.646 Test Acc: 0.308
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.2658910751342773
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.598 Vali Acc: 0.322 Test Loss: 3.598 Test Acc: 0.322
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.9976835250854492
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.595 Vali Acc: 0.327 Test Loss: 3.595 Test Acc: 0.327
Validation loss decreased (-0.322317 --> -0.327023).  Saving model ...
Epoch: 22 cost time: 2.283464193344116
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.610 Vali Acc: 0.335 Test Loss: 3.610 Test Acc: 0.335
Validation loss decreased (-0.327023 --> -0.335258).  Saving model ...
Epoch: 23 cost time: 2.320923089981079
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.639 Vali Acc: 0.334 Test Loss: 3.639 Test Acc: 0.334
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.975231409072876
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.661 Vali Acc: 0.332 Test Loss: 3.661 Test Acc: 0.332
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.9005215167999268
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.915 Vali Acc: 0.302 Test Loss: 3.915 Test Acc: 0.302
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.2189338207244873
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.626 Vali Acc: 0.324 Test Loss: 3.626 Test Acc: 0.324
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.217273712158203
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.611 Vali Acc: 0.327 Test Loss: 3.611 Test Acc: 0.327
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.919424057006836
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.609 Vali Acc: 0.327 Test Loss: 3.609 Test Acc: 0.327
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.011429786682129
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.645 Vali Acc: 0.331 Test Loss: 3.645 Test Acc: 0.331
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.2944374084472656
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.682 Vali Acc: 0.329 Test Loss: 3.682 Test Acc: 0.329
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3352941176470588
model parameter : 11520922
model size : 46.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.921099901199341
Epoch: 1, Steps: 10 | Train Loss: 3.247 Vali Loss: 3.240 Vali Acc: 0.078 Test Loss: 3.240 Test Acc: 0.078
Validation loss decreased (inf --> -0.077615).  Saving model ...
Epoch: 2 cost time: 4.200219392776489
Epoch: 2, Steps: 10 | Train Loss: 2.794 Vali Loss: 3.207 Vali Acc: 0.145 Test Loss: 3.207 Test Acc: 0.145
Validation loss decreased (-0.077615 --> -0.144674).  Saving model ...
Epoch: 3 cost time: 5.0859620571136475
Epoch: 3, Steps: 10 | Train Loss: 1.906 Vali Loss: 3.007 Vali Acc: 0.224 Test Loss: 3.007 Test Acc: 0.224
Validation loss decreased (-0.144674 --> -0.223499).  Saving model ...
Epoch: 4 cost time: 4.138778924942017
Epoch: 4, Steps: 10 | Train Loss: 1.219 Vali Loss: 3.045 Vali Acc: 0.215 Test Loss: 3.045 Test Acc: 0.215
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.284350872039795
Epoch: 5, Steps: 10 | Train Loss: 0.732 Vali Loss: 3.084 Vali Acc: 0.268 Test Loss: 3.084 Test Acc: 0.268
Validation loss decreased (-0.223499 --> -0.268204).  Saving model ...
Epoch: 6 cost time: 3.604325532913208
Epoch: 6, Steps: 10 | Train Loss: 0.388 Vali Loss: 3.130 Vali Acc: 0.274 Test Loss: 3.130 Test Acc: 0.274
Validation loss decreased (-0.268204 --> -0.274086).  Saving model ...
Epoch: 7 cost time: 4.580169916152954
Epoch: 7, Steps: 10 | Train Loss: 0.232 Vali Loss: 3.242 Vali Acc: 0.294 Test Loss: 3.242 Test Acc: 0.294
Validation loss decreased (-0.274086 --> -0.294085).  Saving model ...
Epoch: 8 cost time: 3.8013880252838135
Epoch: 8, Steps: 10 | Train Loss: 0.084 Vali Loss: 3.267 Vali Acc: 0.300 Test Loss: 3.267 Test Acc: 0.300
Validation loss decreased (-0.294085 --> -0.299967).  Saving model ...
Epoch: 9 cost time: 4.364545106887817
Epoch: 9, Steps: 10 | Train Loss: 0.077 Vali Loss: 3.521 Vali Acc: 0.302 Test Loss: 3.521 Test Acc: 0.302
Validation loss decreased (-0.299967 --> -0.302318).  Saving model ...
Epoch: 10 cost time: 3.755983352661133
Epoch: 10, Steps: 10 | Train Loss: 0.072 Vali Loss: 3.533 Vali Acc: 0.298 Test Loss: 3.533 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.2308971881866455
Epoch: 11, Steps: 10 | Train Loss: 0.080 Vali Loss: 3.542 Vali Acc: 0.300 Test Loss: 3.542 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.427320957183838
Epoch: 12, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.563 Vali Acc: 0.309 Test Loss: 3.563 Test Acc: 0.309
Validation loss decreased (-0.302318 --> -0.309376).  Saving model ...
Epoch: 13 cost time: 3.760488510131836
Epoch: 13, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.752 Vali Acc: 0.294 Test Loss: 3.752 Test Acc: 0.294
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.32157564163208
Epoch: 14, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.631 Vali Acc: 0.312 Test Loss: 3.631 Test Acc: 0.312
Validation loss decreased (-0.309376 --> -0.311728).  Saving model ...
Epoch: 15 cost time: 3.759345769882202
Epoch: 15, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.600 Vali Acc: 0.316 Test Loss: 3.600 Test Acc: 0.316
Validation loss decreased (-0.311728 --> -0.316435).  Saving model ...
Epoch: 16 cost time: 3.263648509979248
Epoch: 16, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.881 Vali Acc: 0.305 Test Loss: 3.881 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.1762683391571045
Epoch: 17, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.009 Vali Acc: 0.294 Test Loss: 4.009 Test Acc: 0.294
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.000470399856567
Epoch: 18, Steps: 10 | Train Loss: 0.103 Vali Loss: 4.092 Vali Acc: 0.291 Test Loss: 4.092 Test Acc: 0.291
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.27371621131897
Epoch: 19, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.793 Vali Acc: 0.320 Test Loss: 3.793 Test Acc: 0.320
Validation loss decreased (-0.316435 --> -0.319962).  Saving model ...
Epoch: 20 cost time: 4.313084125518799
Epoch: 20, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.979 Vali Acc: 0.313 Test Loss: 3.979 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.679845571517944
Epoch: 21, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.902 Vali Acc: 0.328 Test Loss: 3.902 Test Acc: 0.328
Validation loss decreased (-0.319962 --> -0.328196).  Saving model ...
Epoch: 22 cost time: 5.187867879867554
Epoch: 22, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.134 Vali Acc: 0.309 Test Loss: 4.134 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.304588556289673
Epoch: 23, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.393 Vali Acc: 0.285 Test Loss: 4.393 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.774507522583008
Epoch: 24, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.031 Vali Acc: 0.285 Test Loss: 4.031 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 4.402446508407593
Epoch: 25, Steps: 10 | Train Loss: 0.059 Vali Loss: 4.195 Vali Acc: 0.301 Test Loss: 4.195 Test Acc: 0.301
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 5.150580883026123
Epoch: 26, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.060 Vali Acc: 0.308 Test Loss: 4.060 Test Acc: 0.308
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 5.325252532958984
Epoch: 27, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.434 Vali Acc: 0.274 Test Loss: 4.434 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 5.561875343322754
Epoch: 28, Steps: 10 | Train Loss: 0.126 Vali Loss: 4.482 Vali Acc: 0.293 Test Loss: 4.482 Test Acc: 0.293
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 5.165827751159668
Epoch: 29, Steps: 10 | Train Loss: 0.084 Vali Loss: 4.598 Vali Acc: 0.267 Test Loss: 4.598 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 4.7141900062561035
Epoch: 30, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.640 Vali Acc: 0.256 Test Loss: 4.640 Test Acc: 0.256
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.32823529411764707
model parameter : 37999002
model size : 147.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.1863224506378174
Epoch: 1, Steps: 10 | Train Loss: 3.369 Vali Loss: 3.274 Vali Acc: 0.086 Test Loss: 3.274 Test Acc: 0.086
Validation loss decreased (inf --> -0.085850).  Saving model ...
Epoch: 2 cost time: 1.7203338146209717
Epoch: 2, Steps: 10 | Train Loss: 2.819 Vali Loss: 3.327 Vali Acc: 0.121 Test Loss: 3.327 Test Acc: 0.121
Validation loss decreased (-0.085850 --> -0.121143).  Saving model ...
Epoch: 3 cost time: 1.8951787948608398
Epoch: 3, Steps: 10 | Train Loss: 2.219 Vali Loss: 3.125 Vali Acc: 0.180 Test Loss: 3.125 Test Acc: 0.180
Validation loss decreased (-0.121143 --> -0.179969).  Saving model ...
Epoch: 4 cost time: 1.841343879699707
Epoch: 4, Steps: 10 | Train Loss: 1.407 Vali Loss: 3.007 Vali Acc: 0.228 Test Loss: 3.007 Test Acc: 0.228
Validation loss decreased (-0.179969 --> -0.228205).  Saving model ...
Epoch: 5 cost time: 1.8695123195648193
Epoch: 5, Steps: 10 | Train Loss: 0.767 Vali Loss: 3.067 Vali Acc: 0.240 Test Loss: 3.067 Test Acc: 0.240
Validation loss decreased (-0.228205 --> -0.239969).  Saving model ...
Epoch: 6 cost time: 1.9123055934906006
Epoch: 6, Steps: 10 | Train Loss: 0.426 Vali Loss: 3.191 Vali Acc: 0.261 Test Loss: 3.191 Test Acc: 0.261
Validation loss decreased (-0.239969 --> -0.261145).  Saving model ...
Epoch: 7 cost time: 1.8029799461364746
Epoch: 7, Steps: 10 | Train Loss: 0.258 Vali Loss: 3.184 Vali Acc: 0.281 Test Loss: 3.184 Test Acc: 0.281
Validation loss decreased (-0.261145 --> -0.281145).  Saving model ...
Epoch: 8 cost time: 1.7631912231445312
Epoch: 8, Steps: 10 | Train Loss: 0.151 Vali Loss: 3.456 Vali Acc: 0.299 Test Loss: 3.456 Test Acc: 0.299
Validation loss decreased (-0.281145 --> -0.298789).  Saving model ...
Epoch: 9 cost time: 1.8151204586029053
Epoch: 9, Steps: 10 | Train Loss: 0.117 Vali Loss: 3.440 Vali Acc: 0.301 Test Loss: 3.440 Test Acc: 0.301
Validation loss decreased (-0.298789 --> -0.301142).  Saving model ...
Epoch: 10 cost time: 1.8610684871673584
Epoch: 10, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.445 Vali Acc: 0.300 Test Loss: 3.445 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6601243019104004
Epoch: 11, Steps: 10 | Train Loss: 0.069 Vali Loss: 3.596 Vali Acc: 0.296 Test Loss: 3.596 Test Acc: 0.296
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.635798454284668
Epoch: 12, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.510 Vali Acc: 0.301 Test Loss: 3.510 Test Acc: 0.301
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.6271073818206787
Epoch: 13, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.454 Vali Acc: 0.300 Test Loss: 3.454 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.6431450843811035
Epoch: 14, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.557 Vali Acc: 0.305 Test Loss: 3.557 Test Acc: 0.305
Validation loss decreased (-0.301142 --> -0.304670).  Saving model ...
Epoch: 15 cost time: 1.8581726551055908
Epoch: 15, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.642 Vali Acc: 0.312 Test Loss: 3.642 Test Acc: 0.312
Validation loss decreased (-0.304670 --> -0.311728).  Saving model ...
Epoch: 16 cost time: 1.8678038120269775
Epoch: 16, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.613 Vali Acc: 0.324 Test Loss: 3.613 Test Acc: 0.324
Validation loss decreased (-0.311728 --> -0.323493).  Saving model ...
Epoch: 17 cost time: 1.9071261882781982
Epoch: 17, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.775 Vali Acc: 0.324 Test Loss: 3.775 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.9698216915130615
Epoch: 18, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.719 Vali Acc: 0.320 Test Loss: 3.719 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.9708240032196045
Epoch: 19, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.814 Vali Acc: 0.319 Test Loss: 3.814 Test Acc: 0.319
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.4914331436157227
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.795 Vali Acc: 0.318 Test Loss: 3.795 Test Acc: 0.318
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.5884101390838623
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.197 Vali Acc: 0.296 Test Loss: 4.197 Test Acc: 0.296
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.496661901473999
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.005 Vali Acc: 0.320 Test Loss: 4.005 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.621241807937622
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.912 Vali Acc: 0.321 Test Loss: 3.912 Test Acc: 0.321
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.7447700500488281
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.856 Vali Acc: 0.326 Test Loss: 3.856 Test Acc: 0.326
Validation loss decreased (-0.323493 --> -0.325844).  Saving model ...
Epoch: 25 cost time: 1.7983455657958984
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.896 Vali Acc: 0.314 Test Loss: 3.896 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.7418975830078125
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.935 Vali Acc: 0.306 Test Loss: 3.935 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.8395051956176758
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.187 Vali Acc: 0.305 Test Loss: 4.187 Test Acc: 0.305
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.8143978118896484
Epoch: 28, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.167 Vali Acc: 0.286 Test Loss: 4.167 Test Acc: 0.286
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.798980712890625
Epoch: 29, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.151 Vali Acc: 0.287 Test Loss: 4.151 Test Acc: 0.287
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.6356627941131592
Epoch: 30, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.018 Vali Acc: 0.304 Test Loss: 4.018 Test Acc: 0.304
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.32588235294117646
model parameter : 11520922
model size : 46.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.721039056777954
Epoch: 1, Steps: 10 | Train Loss: 3.244 Vali Loss: 3.251 Vali Acc: 0.066 Test Loss: 3.251 Test Acc: 0.066
Validation loss decreased (inf --> -0.065850).  Saving model ...
Epoch: 2 cost time: 3.419938325881958
Epoch: 2, Steps: 10 | Train Loss: 2.859 Vali Loss: 3.261 Vali Acc: 0.115 Test Loss: 3.261 Test Acc: 0.115
Validation loss decreased (-0.065850 --> -0.115262).  Saving model ...
Epoch: 3 cost time: 3.4047000408172607
Epoch: 3, Steps: 10 | Train Loss: 2.112 Vali Loss: 3.095 Vali Acc: 0.188 Test Loss: 3.095 Test Acc: 0.188
Validation loss decreased (-0.115262 --> -0.188204).  Saving model ...
Epoch: 4 cost time: 2.9350318908691406
Epoch: 4, Steps: 10 | Train Loss: 1.417 Vali Loss: 3.124 Vali Acc: 0.215 Test Loss: 3.124 Test Acc: 0.215
Validation loss decreased (-0.188204 --> -0.215263).  Saving model ...
Epoch: 5 cost time: 2.5784077644348145
Epoch: 5, Steps: 10 | Train Loss: 0.898 Vali Loss: 3.142 Vali Acc: 0.248 Test Loss: 3.142 Test Acc: 0.248
Validation loss decreased (-0.215263 --> -0.248204).  Saving model ...
Epoch: 6 cost time: 2.5096218585968018
Epoch: 6, Steps: 10 | Train Loss: 0.564 Vali Loss: 3.195 Vali Acc: 0.261 Test Loss: 3.195 Test Acc: 0.261
Validation loss decreased (-0.248204 --> -0.261145).  Saving model ...
Epoch: 7 cost time: 2.8978219032287598
Epoch: 7, Steps: 10 | Train Loss: 0.338 Vali Loss: 3.237 Vali Acc: 0.281 Test Loss: 3.237 Test Acc: 0.281
Validation loss decreased (-0.261145 --> -0.281144).  Saving model ...
Epoch: 8 cost time: 2.830254316329956
Epoch: 8, Steps: 10 | Train Loss: 0.116 Vali Loss: 3.284 Vali Acc: 0.316 Test Loss: 3.284 Test Acc: 0.316
Validation loss decreased (-0.281144 --> -0.316438).  Saving model ...
Epoch: 9 cost time: 2.9017415046691895
Epoch: 9, Steps: 10 | Train Loss: 0.198 Vali Loss: 3.543 Vali Acc: 0.294 Test Loss: 3.543 Test Acc: 0.294
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.9359817504882812
Epoch: 10, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.341 Vali Acc: 0.311 Test Loss: 3.341 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.6519761085510254
Epoch: 11, Steps: 10 | Train Loss: 0.068 Vali Loss: 3.402 Vali Acc: 0.325 Test Loss: 3.402 Test Acc: 0.325
Validation loss decreased (-0.316438 --> -0.324672).  Saving model ...
Epoch: 12 cost time: 2.48132061958313
Epoch: 12, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.622 Vali Acc: 0.319 Test Loss: 3.622 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.651681661605835
Epoch: 13, Steps: 10 | Train Loss: 0.089 Vali Loss: 3.651 Vali Acc: 0.298 Test Loss: 3.651 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.783315658569336
Epoch: 14, Steps: 10 | Train Loss: 0.082 Vali Loss: 3.598 Vali Acc: 0.308 Test Loss: 3.598 Test Acc: 0.308
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.057861566543579
Epoch: 15, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.608 Vali Acc: 0.284 Test Loss: 3.608 Test Acc: 0.284
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.0366296768188477
Epoch: 16, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.715 Vali Acc: 0.316 Test Loss: 3.715 Test Acc: 0.316
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.85015606880188
Epoch: 17, Steps: 10 | Train Loss: 0.068 Vali Loss: 4.046 Vali Acc: 0.266 Test Loss: 4.046 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.721454620361328
Epoch: 18, Steps: 10 | Train Loss: 0.069 Vali Loss: 4.082 Vali Acc: 0.255 Test Loss: 4.082 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.71937894821167
Epoch: 19, Steps: 10 | Train Loss: 0.110 Vali Loss: 3.984 Vali Acc: 0.296 Test Loss: 3.984 Test Acc: 0.296
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.6595640182495117
Epoch: 20, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.230 Vali Acc: 0.255 Test Loss: 4.230 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.9134721755981445
Epoch: 21, Steps: 10 | Train Loss: 0.059 Vali Loss: 4.450 Vali Acc: 0.285 Test Loss: 4.450 Test Acc: 0.285
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3247058823529412
model parameter : 37999002
model size : 147.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.680075168609619
Epoch: 1, Steps: 10 | Train Loss: 3.369 Vali Loss: 3.284 Vali Acc: 0.081 Test Loss: 3.284 Test Acc: 0.081
Validation loss decreased (inf --> -0.081144).  Saving model ...
Epoch: 2 cost time: 1.4692296981811523
Epoch: 2, Steps: 10 | Train Loss: 2.861 Vali Loss: 3.358 Vali Acc: 0.105 Test Loss: 3.358 Test Acc: 0.105
Validation loss decreased (-0.081144 --> -0.104672).  Saving model ...
Epoch: 3 cost time: 1.3236165046691895
Epoch: 3, Steps: 10 | Train Loss: 2.304 Vali Loss: 3.178 Vali Acc: 0.154 Test Loss: 3.178 Test Acc: 0.154
Validation loss decreased (-0.104672 --> -0.154086).  Saving model ...
Epoch: 4 cost time: 1.2992274761199951
Epoch: 4, Steps: 10 | Train Loss: 1.667 Vali Loss: 3.107 Vali Acc: 0.191 Test Loss: 3.107 Test Acc: 0.191
Validation loss decreased (-0.154086 --> -0.190557).  Saving model ...
Epoch: 5 cost time: 1.2357780933380127
Epoch: 5, Steps: 10 | Train Loss: 0.966 Vali Loss: 3.148 Vali Acc: 0.224 Test Loss: 3.148 Test Acc: 0.224
Validation loss decreased (-0.190557 --> -0.223498).  Saving model ...
Epoch: 6 cost time: 1.1687395572662354
Epoch: 6, Steps: 10 | Train Loss: 0.511 Vali Loss: 3.154 Vali Acc: 0.273 Test Loss: 3.154 Test Acc: 0.273
Validation loss decreased (-0.223498 --> -0.272910).  Saving model ...
Epoch: 7 cost time: 1.2402524948120117
Epoch: 7, Steps: 10 | Train Loss: 0.306 Vali Loss: 3.331 Vali Acc: 0.267 Test Loss: 3.331 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.265139102935791
Epoch: 8, Steps: 10 | Train Loss: 0.278 Vali Loss: 3.340 Vali Acc: 0.278 Test Loss: 3.340 Test Acc: 0.278
Validation loss decreased (-0.272910 --> -0.277614).  Saving model ...
Epoch: 9 cost time: 1.27132248878479
Epoch: 9, Steps: 10 | Train Loss: 0.112 Vali Loss: 3.382 Vali Acc: 0.287 Test Loss: 3.382 Test Acc: 0.287
Validation loss decreased (-0.277614 --> -0.287025).  Saving model ...
Epoch: 10 cost time: 1.3015587329864502
Epoch: 10, Steps: 10 | Train Loss: 0.063 Vali Loss: 3.528 Vali Acc: 0.299 Test Loss: 3.528 Test Acc: 0.299
Validation loss decreased (-0.287025 --> -0.298788).  Saving model ...
Epoch: 11 cost time: 1.2519099712371826
Epoch: 11, Steps: 10 | Train Loss: 0.102 Vali Loss: 3.762 Vali Acc: 0.272 Test Loss: 3.762 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2387826442718506
Epoch: 12, Steps: 10 | Train Loss: 0.063 Vali Loss: 3.639 Vali Acc: 0.305 Test Loss: 3.639 Test Acc: 0.305
Validation loss decreased (-0.298788 --> -0.304669).  Saving model ...
Epoch: 13 cost time: 1.2673370838165283
Epoch: 13, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.733 Vali Acc: 0.298 Test Loss: 3.733 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.173208475112915
Epoch: 14, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.895 Vali Acc: 0.281 Test Loss: 3.895 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2415623664855957
Epoch: 15, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.715 Vali Acc: 0.314 Test Loss: 3.715 Test Acc: 0.314
Validation loss decreased (-0.304669 --> -0.314080).  Saving model ...
Epoch: 16 cost time: 1.2166764736175537
Epoch: 16, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.770 Vali Acc: 0.298 Test Loss: 3.770 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1804533004760742
Epoch: 17, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.907 Vali Acc: 0.307 Test Loss: 3.907 Test Acc: 0.307
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3411884307861328
Epoch: 18, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.998 Vali Acc: 0.292 Test Loss: 3.998 Test Acc: 0.292
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3749866485595703
Epoch: 19, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.925 Vali Acc: 0.311 Test Loss: 3.925 Test Acc: 0.311
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.3222615718841553
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.880 Vali Acc: 0.315 Test Loss: 3.880 Test Acc: 0.315
Validation loss decreased (-0.314080 --> -0.315255).  Saving model ...
Epoch: 21 cost time: 1.435239553451538
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.930 Vali Acc: 0.321 Test Loss: 3.930 Test Acc: 0.321
Validation loss decreased (-0.315255 --> -0.321137).  Saving model ...
Epoch: 22 cost time: 1.2589328289031982
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.934 Vali Acc: 0.320 Test Loss: 3.934 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2793960571289062
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.963 Vali Acc: 0.322 Test Loss: 3.963 Test Acc: 0.322
Validation loss decreased (-0.321137 --> -0.322313).  Saving model ...
Epoch: 24 cost time: 1.2225630283355713
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.003 Vali Acc: 0.327 Test Loss: 4.003 Test Acc: 0.327
Validation loss decreased (-0.322313 --> -0.327019).  Saving model ...
Epoch: 25 cost time: 1.2393097877502441
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.936 Vali Acc: 0.338 Test Loss: 3.936 Test Acc: 0.338
Validation loss decreased (-0.327019 --> -0.337608).  Saving model ...
Epoch: 26 cost time: 1.1399505138397217
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.903 Vali Acc: 0.346 Test Loss: 3.903 Test Acc: 0.346
Validation loss decreased (-0.337608 --> -0.345843).  Saving model ...
Epoch: 27 cost time: 1.16987943649292
Epoch: 27, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.176 Vali Acc: 0.320 Test Loss: 4.176 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2164602279663086
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.032 Vali Acc: 0.324 Test Loss: 4.032 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.2080585956573486
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.142 Vali Acc: 0.307 Test Loss: 4.142 Test Acc: 0.307
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.3582119941711426
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.278 Vali Acc: 0.307 Test Loss: 4.278 Test Acc: 0.307
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3458823529411765
model parameter : 11520922
model size : 46.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.565783977508545
Epoch: 1, Steps: 10 | Train Loss: 3.350 Vali Loss: 3.266 Vali Acc: 0.065 Test Loss: 3.266 Test Acc: 0.065
Validation loss decreased (inf --> -0.064673).  Saving model ...
Epoch: 2 cost time: 3.589128255844116
Epoch: 2, Steps: 10 | Train Loss: 2.865 Vali Loss: 3.291 Vali Acc: 0.132 Test Loss: 3.291 Test Acc: 0.132
Validation loss decreased (-0.064673 --> -0.131732).  Saving model ...
Epoch: 3 cost time: 3.974173069000244
Epoch: 3, Steps: 10 | Train Loss: 2.076 Vali Loss: 3.039 Vali Acc: 0.201 Test Loss: 3.039 Test Acc: 0.201
Validation loss decreased (-0.131732 --> -0.201146).  Saving model ...
Epoch: 4 cost time: 4.452332496643066
Epoch: 4, Steps: 10 | Train Loss: 1.286 Vali Loss: 3.061 Vali Acc: 0.218 Test Loss: 3.061 Test Acc: 0.218
Validation loss decreased (-0.201146 --> -0.217616).  Saving model ...
Epoch: 5 cost time: 4.471312046051025
Epoch: 5, Steps: 10 | Train Loss: 0.723 Vali Loss: 3.063 Vali Acc: 0.245 Test Loss: 3.063 Test Acc: 0.245
Validation loss decreased (-0.217616 --> -0.244675).  Saving model ...
Epoch: 6 cost time: 4.436407566070557
Epoch: 6, Steps: 10 | Train Loss: 0.371 Vali Loss: 3.181 Vali Acc: 0.276 Test Loss: 3.181 Test Acc: 0.276
Validation loss decreased (-0.244675 --> -0.276439).  Saving model ...
Epoch: 7 cost time: 3.8120453357696533
Epoch: 7, Steps: 10 | Train Loss: 0.152 Vali Loss: 3.233 Vali Acc: 0.298 Test Loss: 3.233 Test Acc: 0.298
Validation loss decreased (-0.276439 --> -0.297615).  Saving model ...
Epoch: 8 cost time: 3.927870988845825
Epoch: 8, Steps: 10 | Train Loss: 0.083 Vali Loss: 3.382 Vali Acc: 0.307 Test Loss: 3.382 Test Acc: 0.307
Validation loss decreased (-0.297615 --> -0.307025).  Saving model ...
Epoch: 9 cost time: 4.3852856159210205
Epoch: 9, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.328 Vali Acc: 0.312 Test Loss: 3.328 Test Acc: 0.312
Validation loss decreased (-0.307025 --> -0.311731).  Saving model ...
Epoch: 10 cost time: 4.524746656417847
Epoch: 10, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.349 Vali Acc: 0.328 Test Loss: 3.349 Test Acc: 0.328
Validation loss decreased (-0.311731 --> -0.328202).  Saving model ...
Epoch: 11 cost time: 3.881157875061035
Epoch: 11, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.659 Vali Acc: 0.299 Test Loss: 3.659 Test Acc: 0.299
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.766200065612793
Epoch: 12, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.615 Vali Acc: 0.304 Test Loss: 3.615 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.109922647476196
Epoch: 13, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.698 Vali Acc: 0.302 Test Loss: 3.698 Test Acc: 0.302
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.292195796966553
Epoch: 14, Steps: 10 | Train Loss: 0.043 Vali Loss: 3.379 Vali Acc: 0.336 Test Loss: 3.379 Test Acc: 0.336
Validation loss decreased (-0.328202 --> -0.336437).  Saving model ...
Epoch: 15 cost time: 4.4815850257873535
Epoch: 15, Steps: 10 | Train Loss: 0.086 Vali Loss: 3.454 Vali Acc: 0.319 Test Loss: 3.454 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.8353419303894043
Epoch: 16, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.736 Vali Acc: 0.305 Test Loss: 3.736 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.9469876289367676
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.629 Vali Acc: 0.325 Test Loss: 3.629 Test Acc: 0.325
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.276444435119629
Epoch: 18, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.214 Vali Acc: 0.284 Test Loss: 4.214 Test Acc: 0.284
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.241837024688721
Epoch: 19, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.554 Vali Acc: 0.318 Test Loss: 3.554 Test Acc: 0.318
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.524435758590698
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.655 Vali Acc: 0.329 Test Loss: 3.655 Test Acc: 0.329
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.8780739307403564
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.914 Vali Acc: 0.321 Test Loss: 3.914 Test Acc: 0.321
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.05955171585083
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.862 Vali Acc: 0.325 Test Loss: 3.862 Test Acc: 0.325
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.437484264373779
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.800 Vali Acc: 0.329 Test Loss: 3.800 Test Acc: 0.329
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 4.310598134994507
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.855 Vali Acc: 0.336 Test Loss: 3.855 Test Acc: 0.336
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.33647058823529413
model parameter : 19254170
model size : 75.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.735919237136841
Epoch: 1, Steps: 10 | Train Loss: 3.294 Vali Loss: 3.274 Vali Acc: 0.071 Test Loss: 3.274 Test Acc: 0.071
Validation loss decreased (inf --> -0.070555).  Saving model ...
Epoch: 2 cost time: 1.5983970165252686
Epoch: 2, Steps: 10 | Train Loss: 2.955 Vali Loss: 3.317 Vali Acc: 0.131 Test Loss: 3.317 Test Acc: 0.131
Validation loss decreased (-0.070555 --> -0.130555).  Saving model ...
Epoch: 3 cost time: 1.7361211776733398
Epoch: 3, Steps: 10 | Train Loss: 2.247 Vali Loss: 3.079 Vali Acc: 0.176 Test Loss: 3.079 Test Acc: 0.176
Validation loss decreased (-0.130555 --> -0.176440).  Saving model ...
Epoch: 4 cost time: 1.7662749290466309
Epoch: 4, Steps: 10 | Train Loss: 1.393 Vali Loss: 2.997 Vali Acc: 0.224 Test Loss: 2.997 Test Acc: 0.224
Validation loss decreased (-0.176440 --> -0.223499).  Saving model ...
Epoch: 5 cost time: 1.8489127159118652
Epoch: 5, Steps: 10 | Train Loss: 0.746 Vali Loss: 3.026 Vali Acc: 0.256 Test Loss: 3.026 Test Acc: 0.256
Validation loss decreased (-0.223499 --> -0.256440).  Saving model ...
Epoch: 6 cost time: 1.7979600429534912
Epoch: 6, Steps: 10 | Train Loss: 0.376 Vali Loss: 3.059 Vali Acc: 0.275 Test Loss: 3.059 Test Acc: 0.275
Validation loss decreased (-0.256440 --> -0.275264).  Saving model ...
Epoch: 7 cost time: 1.793156385421753
Epoch: 7, Steps: 10 | Train Loss: 0.163 Vali Loss: 3.286 Vali Acc: 0.287 Test Loss: 3.286 Test Acc: 0.287
Validation loss decreased (-0.275264 --> -0.287026).  Saving model ...
Epoch: 8 cost time: 1.596581220626831
Epoch: 8, Steps: 10 | Train Loss: 0.127 Vali Loss: 3.349 Vali Acc: 0.293 Test Loss: 3.349 Test Acc: 0.293
Validation loss decreased (-0.287026 --> -0.292908).  Saving model ...
Epoch: 9 cost time: 1.59975004196167
Epoch: 9, Steps: 10 | Train Loss: 0.073 Vali Loss: 3.409 Vali Acc: 0.311 Test Loss: 3.409 Test Acc: 0.311
Validation loss decreased (-0.292908 --> -0.310554).  Saving model ...
Epoch: 10 cost time: 1.7018015384674072
Epoch: 10, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.584 Vali Acc: 0.274 Test Loss: 3.584 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6743769645690918
Epoch: 11, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.694 Vali Acc: 0.296 Test Loss: 3.694 Test Acc: 0.296
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7668688297271729
Epoch: 12, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.525 Vali Acc: 0.311 Test Loss: 3.525 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.8306760787963867
Epoch: 13, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.513 Vali Acc: 0.312 Test Loss: 3.513 Test Acc: 0.312
Validation loss decreased (-0.310554 --> -0.311730).  Saving model ...
Epoch: 14 cost time: 1.7805535793304443
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.563 Vali Acc: 0.319 Test Loss: 3.563 Test Acc: 0.319
Validation loss decreased (-0.311730 --> -0.318788).  Saving model ...
Epoch: 15 cost time: 1.7294731140136719
Epoch: 15, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.680 Vali Acc: 0.315 Test Loss: 3.680 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7420036792755127
Epoch: 16, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.843 Vali Acc: 0.300 Test Loss: 3.843 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.8410022258758545
Epoch: 17, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.618 Vali Acc: 0.319 Test Loss: 3.618 Test Acc: 0.319
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.6119167804718018
Epoch: 18, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.829 Vali Acc: 0.305 Test Loss: 3.829 Test Acc: 0.305
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.233588457107544
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.785 Vali Acc: 0.309 Test Loss: 3.785 Test Acc: 0.309
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.5786399841308594
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.674 Vali Acc: 0.326 Test Loss: 3.674 Test Acc: 0.326
Validation loss decreased (-0.318788 --> -0.325846).  Saving model ...
Epoch: 21 cost time: 1.1735050678253174
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.676 Vali Acc: 0.332 Test Loss: 3.676 Test Acc: 0.332
Validation loss decreased (-0.325846 --> -0.331728).  Saving model ...
Epoch: 22 cost time: 1.644658088684082
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.719 Vali Acc: 0.333 Test Loss: 3.719 Test Acc: 0.333
Validation loss decreased (-0.331728 --> -0.332904).  Saving model ...
Epoch: 23 cost time: 1.1788394451141357
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.811 Vali Acc: 0.321 Test Loss: 3.811 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1444787979125977
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.784 Vali Acc: 0.324 Test Loss: 3.784 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.17213773727417
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.766 Vali Acc: 0.326 Test Loss: 3.766 Test Acc: 0.326
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.1342308521270752
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.773 Vali Acc: 0.332 Test Loss: 3.773 Test Acc: 0.332
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.137178659439087
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.788 Vali Acc: 0.331 Test Loss: 3.788 Test Acc: 0.331
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.4419934749603271
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.784 Vali Acc: 0.336 Test Loss: 3.784 Test Acc: 0.336
Validation loss decreased (-0.332904 --> -0.336433).  Saving model ...
Epoch: 29 cost time: 1.5033438205718994
Epoch: 29, Steps: 10 | Train Loss: 0.078 Vali Loss: 4.010 Vali Acc: 0.278 Test Loss: 4.010 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.5491740703582764
Epoch: 30, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.883 Vali Acc: 0.293 Test Loss: 3.883 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.33647058823529413
model parameter : 6014874
model size : 25.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.7908101081848145
Epoch: 1, Steps: 10 | Train Loss: 3.357 Vali Loss: 3.272 Vali Acc: 0.071 Test Loss: 3.272 Test Acc: 0.071
Validation loss decreased (inf --> -0.070556).  Saving model ...
Epoch: 2 cost time: 2.3297476768493652
Epoch: 2, Steps: 10 | Train Loss: 2.891 Vali Loss: 3.309 Vali Acc: 0.126 Test Loss: 3.309 Test Acc: 0.126
Validation loss decreased (-0.070556 --> -0.125849).  Saving model ...
Epoch: 3 cost time: 2.655585765838623
Epoch: 3, Steps: 10 | Train Loss: 2.205 Vali Loss: 3.068 Vali Acc: 0.193 Test Loss: 3.068 Test Acc: 0.193
Validation loss decreased (-0.125849 --> -0.192911).  Saving model ...
Epoch: 4 cost time: 2.717846155166626
Epoch: 4, Steps: 10 | Train Loss: 1.432 Vali Loss: 3.059 Vali Acc: 0.238 Test Loss: 3.059 Test Acc: 0.238
Validation loss decreased (-0.192911 --> -0.237616).  Saving model ...
Epoch: 5 cost time: 2.403090715408325
Epoch: 5, Steps: 10 | Train Loss: 0.845 Vali Loss: 3.131 Vali Acc: 0.248 Test Loss: 3.131 Test Acc: 0.248
Validation loss decreased (-0.237616 --> -0.248204).  Saving model ...
Epoch: 6 cost time: 2.5258331298828125
Epoch: 6, Steps: 10 | Train Loss: 0.477 Vali Loss: 3.079 Vali Acc: 0.299 Test Loss: 3.079 Test Acc: 0.299
Validation loss decreased (-0.248204 --> -0.298793).  Saving model ...
Epoch: 7 cost time: 2.5424203872680664
Epoch: 7, Steps: 10 | Train Loss: 0.318 Vali Loss: 3.391 Vali Acc: 0.294 Test Loss: 3.391 Test Acc: 0.294
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.630828380584717
Epoch: 8, Steps: 10 | Train Loss: 0.174 Vali Loss: 3.370 Vali Acc: 0.306 Test Loss: 3.370 Test Acc: 0.306
Validation loss decreased (-0.298793 --> -0.305849).  Saving model ...
Epoch: 9 cost time: 2.579359769821167
Epoch: 9, Steps: 10 | Train Loss: 0.067 Vali Loss: 3.448 Vali Acc: 0.301 Test Loss: 3.448 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.281327247619629
Epoch: 10, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.425 Vali Acc: 0.321 Test Loss: 3.425 Test Acc: 0.321
Validation loss decreased (-0.305849 --> -0.321142).  Saving model ...
Epoch: 11 cost time: 2.3003668785095215
Epoch: 11, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.454 Vali Acc: 0.318 Test Loss: 3.454 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.4388210773468018
Epoch: 12, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.654 Vali Acc: 0.324 Test Loss: 3.654 Test Acc: 0.324
Validation loss decreased (-0.321142 --> -0.323493).  Saving model ...
Epoch: 13 cost time: 2.5160889625549316
Epoch: 13, Steps: 10 | Train Loss: 0.058 Vali Loss: 3.790 Vali Acc: 0.306 Test Loss: 3.790 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.55729341506958
Epoch: 14, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.677 Vali Acc: 0.316 Test Loss: 3.677 Test Acc: 0.316
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.2443761825561523
Epoch: 15, Steps: 10 | Train Loss: 0.081 Vali Loss: 3.720 Vali Acc: 0.299 Test Loss: 3.720 Test Acc: 0.299
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.3470404148101807
Epoch: 16, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.700 Vali Acc: 0.320 Test Loss: 3.700 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.707624673843384
Epoch: 17, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.939 Vali Acc: 0.315 Test Loss: 3.939 Test Acc: 0.315
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.7270936965942383
Epoch: 18, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.797 Vali Acc: 0.321 Test Loss: 3.797 Test Acc: 0.321
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.682502269744873
Epoch: 19, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.725 Vali Acc: 0.313 Test Loss: 3.725 Test Acc: 0.313
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.3979294300079346
Epoch: 20, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.870 Vali Acc: 0.325 Test Loss: 3.870 Test Acc: 0.325
Validation loss decreased (-0.323493 --> -0.324667).  Saving model ...
Epoch: 21 cost time: 2.3596105575561523
Epoch: 21, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.121 Vali Acc: 0.302 Test Loss: 4.121 Test Acc: 0.302
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.6910831928253174
Epoch: 22, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.521 Vali Acc: 0.272 Test Loss: 4.521 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.6267194747924805
Epoch: 23, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.352 Vali Acc: 0.299 Test Loss: 4.352 Test Acc: 0.299
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.3476719856262207
Epoch: 24, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.308 Vali Acc: 0.311 Test Loss: 4.308 Test Acc: 0.311
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.436265468597412
Epoch: 25, Steps: 10 | Train Loss: 0.051 Vali Loss: 4.173 Vali Acc: 0.307 Test Loss: 4.173 Test Acc: 0.307
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.4597320556640625
Epoch: 26, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.430 Vali Acc: 0.309 Test Loss: 4.430 Test Acc: 0.309
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.7278850078582764
Epoch: 27, Steps: 10 | Train Loss: 0.153 Vali Loss: 4.758 Vali Acc: 0.298 Test Loss: 4.758 Test Acc: 0.298
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.7102882862091064
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.576 Vali Acc: 0.293 Test Loss: 4.576 Test Acc: 0.293
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.3051323890686035
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.338 Vali Acc: 0.312 Test Loss: 4.338 Test Acc: 0.312
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.236802101135254
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.298 Vali Acc: 0.315 Test Loss: 4.298 Test Acc: 0.315
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3247058823529412
model parameter : 19254170
model size : 75.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.40773868560791
Epoch: 1, Steps: 10 | Train Loss: 3.289 Vali Loss: 3.279 Vali Acc: 0.069 Test Loss: 3.279 Test Acc: 0.069
Validation loss decreased (inf --> -0.069379).  Saving model ...
Epoch: 2 cost time: 1.1603121757507324
Epoch: 2, Steps: 10 | Train Loss: 2.964 Vali Loss: 3.324 Vali Acc: 0.134 Test Loss: 3.324 Test Acc: 0.134
Validation loss decreased (-0.069379 --> -0.134084).  Saving model ...
Epoch: 3 cost time: 1.1874420642852783
Epoch: 3, Steps: 10 | Train Loss: 2.303 Vali Loss: 3.087 Vali Acc: 0.181 Test Loss: 3.087 Test Acc: 0.181
Validation loss decreased (-0.134084 --> -0.181146).  Saving model ...
Epoch: 4 cost time: 1.0972394943237305
Epoch: 4, Steps: 10 | Train Loss: 1.452 Vali Loss: 2.996 Vali Acc: 0.221 Test Loss: 2.996 Test Acc: 0.221
Validation loss decreased (-0.181146 --> -0.221147).  Saving model ...
Epoch: 5 cost time: 0.9400951862335205
Epoch: 5, Steps: 10 | Train Loss: 0.815 Vali Loss: 3.038 Vali Acc: 0.248 Test Loss: 3.038 Test Acc: 0.248
Validation loss decreased (-0.221147 --> -0.248205).  Saving model ...
Epoch: 6 cost time: 1.0930676460266113
Epoch: 6, Steps: 10 | Train Loss: 0.464 Vali Loss: 3.055 Vali Acc: 0.280 Test Loss: 3.055 Test Acc: 0.280
Validation loss decreased (-0.248205 --> -0.279969).  Saving model ...
Epoch: 7 cost time: 1.202129602432251
Epoch: 7, Steps: 10 | Train Loss: 0.195 Vali Loss: 3.346 Vali Acc: 0.273 Test Loss: 3.346 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1350202560424805
Epoch: 8, Steps: 10 | Train Loss: 0.110 Vali Loss: 3.271 Vali Acc: 0.293 Test Loss: 3.271 Test Acc: 0.293
Validation loss decreased (-0.279969 --> -0.292908).  Saving model ...
Epoch: 9 cost time: 1.2365164756774902
Epoch: 9, Steps: 10 | Train Loss: 0.104 Vali Loss: 3.397 Vali Acc: 0.306 Test Loss: 3.397 Test Acc: 0.306
Validation loss decreased (-0.292908 --> -0.305848).  Saving model ...
Epoch: 10 cost time: 1.214221477508545
Epoch: 10, Steps: 10 | Train Loss: 0.079 Vali Loss: 3.786 Vali Acc: 0.244 Test Loss: 3.786 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2153418064117432
Epoch: 11, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.673 Vali Acc: 0.288 Test Loss: 3.673 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0152506828308105
Epoch: 12, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.560 Vali Acc: 0.287 Test Loss: 3.560 Test Acc: 0.287
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0955266952514648
Epoch: 13, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.673 Vali Acc: 0.304 Test Loss: 3.673 Test Acc: 0.304
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9057216644287109
Epoch: 14, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.688 Vali Acc: 0.308 Test Loss: 3.688 Test Acc: 0.308
Validation loss decreased (-0.305848 --> -0.308198).  Saving model ...
Epoch: 15 cost time: 1.0115346908569336
Epoch: 15, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.796 Vali Acc: 0.275 Test Loss: 3.796 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0799126625061035
Epoch: 16, Steps: 10 | Train Loss: 0.058 Vali Loss: 3.831 Vali Acc: 0.279 Test Loss: 3.831 Test Acc: 0.279
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1134696006774902
Epoch: 17, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.310 Vali Acc: 0.261 Test Loss: 4.310 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.217031478881836
Epoch: 18, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.043 Vali Acc: 0.295 Test Loss: 4.043 Test Acc: 0.295
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.221501350402832
Epoch: 19, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.879 Vali Acc: 0.309 Test Loss: 3.879 Test Acc: 0.309
Validation loss decreased (-0.308198 --> -0.309373).  Saving model ...
Epoch: 20 cost time: 1.2099556922912598
Epoch: 20, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.791 Vali Acc: 0.321 Test Loss: 3.791 Test Acc: 0.321
Validation loss decreased (-0.309373 --> -0.321139).  Saving model ...
Epoch: 21 cost time: 1.1416888236999512
Epoch: 21, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.176 Vali Acc: 0.289 Test Loss: 4.176 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.02534818649292
Epoch: 22, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.385 Vali Acc: 0.288 Test Loss: 4.385 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9884381294250488
Epoch: 23, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.153 Vali Acc: 0.294 Test Loss: 4.153 Test Acc: 0.294
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.0506343841552734
Epoch: 24, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.116 Vali Acc: 0.319 Test Loss: 4.116 Test Acc: 0.319
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.905341625213623
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.223 Vali Acc: 0.300 Test Loss: 4.223 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.0824391841888428
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.266 Vali Acc: 0.307 Test Loss: 4.266 Test Acc: 0.307
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.102921962738037
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.231 Vali Acc: 0.318 Test Loss: 4.231 Test Acc: 0.318
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.2639844417572021
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.187 Vali Acc: 0.313 Test Loss: 4.187 Test Acc: 0.313
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.3533339500427246
Epoch: 29, Steps: 10 | Train Loss: 0.072 Vali Loss: 4.523 Vali Acc: 0.284 Test Loss: 4.523 Test Acc: 0.284
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.3480610847473145
Epoch: 30, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.308 Vali Acc: 0.287 Test Loss: 4.308 Test Acc: 0.287
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3211764705882353
model parameter : 6014874
model size : 25.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.9589314460754395
Epoch: 1, Steps: 10 | Train Loss: 3.356 Vali Loss: 3.278 Vali Acc: 0.064 Test Loss: 3.278 Test Acc: 0.064
Validation loss decreased (inf --> -0.063497).  Saving model ...
Epoch: 2 cost time: 1.7782118320465088
Epoch: 2, Steps: 10 | Train Loss: 2.943 Vali Loss: 3.343 Vali Acc: 0.109 Test Loss: 3.343 Test Acc: 0.109
Validation loss decreased (-0.063497 --> -0.109378).  Saving model ...
Epoch: 3 cost time: 1.7793865203857422
Epoch: 3, Steps: 10 | Train Loss: 2.349 Vali Loss: 3.132 Vali Acc: 0.179 Test Loss: 3.132 Test Acc: 0.179
Validation loss decreased (-0.109378 --> -0.178792).  Saving model ...
Epoch: 4 cost time: 1.71608304977417
Epoch: 4, Steps: 10 | Train Loss: 1.694 Vali Loss: 3.119 Vali Acc: 0.206 Test Loss: 3.119 Test Acc: 0.206
Validation loss decreased (-0.178792 --> -0.205851).  Saving model ...
Epoch: 5 cost time: 1.4353153705596924
Epoch: 5, Steps: 10 | Train Loss: 1.071 Vali Loss: 3.154 Vali Acc: 0.219 Test Loss: 3.154 Test Acc: 0.219
Validation loss decreased (-0.205851 --> -0.218792).  Saving model ...
Epoch: 6 cost time: 1.3890407085418701
Epoch: 6, Steps: 10 | Train Loss: 0.588 Vali Loss: 3.212 Vali Acc: 0.258 Test Loss: 3.212 Test Acc: 0.258
Validation loss decreased (-0.218792 --> -0.257615).  Saving model ...
Epoch: 7 cost time: 1.3610427379608154
Epoch: 7, Steps: 10 | Train Loss: 0.335 Vali Loss: 3.303 Vali Acc: 0.279 Test Loss: 3.303 Test Acc: 0.279
Validation loss decreased (-0.257615 --> -0.278790).  Saving model ...
Epoch: 8 cost time: 1.3212153911590576
Epoch: 8, Steps: 10 | Train Loss: 0.193 Vali Loss: 3.539 Vali Acc: 0.256 Test Loss: 3.539 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1581242084503174
Epoch: 9, Steps: 10 | Train Loss: 0.087 Vali Loss: 3.376 Vali Acc: 0.308 Test Loss: 3.376 Test Acc: 0.308
Validation loss decreased (-0.278790 --> -0.308202).  Saving model ...
Epoch: 10 cost time: 1.1794118881225586
Epoch: 10, Steps: 10 | Train Loss: 0.130 Vali Loss: 3.391 Vali Acc: 0.300 Test Loss: 3.391 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.230443000793457
Epoch: 11, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.404 Vali Acc: 0.334 Test Loss: 3.404 Test Acc: 0.334
Validation loss decreased (-0.308202 --> -0.334084).  Saving model ...
Epoch: 12 cost time: 1.3416996002197266
Epoch: 12, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.696 Vali Acc: 0.309 Test Loss: 3.696 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.67083740234375
Epoch: 13, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.647 Vali Acc: 0.315 Test Loss: 3.647 Test Acc: 0.315
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7582993507385254
Epoch: 14, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.694 Vali Acc: 0.333 Test Loss: 3.694 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6546263694763184
Epoch: 15, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.750 Vali Acc: 0.316 Test Loss: 3.750 Test Acc: 0.316
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.8217434883117676
Epoch: 16, Steps: 10 | Train Loss: 0.066 Vali Loss: 3.709 Vali Acc: 0.307 Test Loss: 3.709 Test Acc: 0.307
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.7540102005004883
Epoch: 17, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.812 Vali Acc: 0.314 Test Loss: 3.812 Test Acc: 0.314
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.3913779258728027
Epoch: 18, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.828 Vali Acc: 0.311 Test Loss: 3.828 Test Acc: 0.311
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.489534616470337
Epoch: 19, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.782 Vali Acc: 0.318 Test Loss: 3.782 Test Acc: 0.318
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.9217884540557861
Epoch: 20, Steps: 10 | Train Loss: 0.055 Vali Loss: 4.263 Vali Acc: 0.296 Test Loss: 4.263 Test Acc: 0.296
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.9251339435577393
Epoch: 21, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.277 Vali Acc: 0.301 Test Loss: 4.277 Test Acc: 0.301
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3341176470588235
model parameter : 19254170
model size : 75.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.41599440574646
Epoch: 1, Steps: 10 | Train Loss: 3.296 Vali Loss: 3.292 Vali Acc: 0.072 Test Loss: 3.292 Test Acc: 0.072
Validation loss decreased (inf --> -0.071732).  Saving model ...
Epoch: 2 cost time: 0.9758598804473877
Epoch: 2, Steps: 10 | Train Loss: 3.017 Vali Loss: 3.361 Vali Acc: 0.115 Test Loss: 3.361 Test Acc: 0.115
Validation loss decreased (-0.071732 --> -0.115261).  Saving model ...
Epoch: 3 cost time: 0.9434235095977783
Epoch: 3, Steps: 10 | Train Loss: 2.406 Vali Loss: 3.155 Vali Acc: 0.173 Test Loss: 3.155 Test Acc: 0.173
Validation loss decreased (-0.115261 --> -0.172910).  Saving model ...
Epoch: 4 cost time: 0.9269974231719971
Epoch: 4, Steps: 10 | Train Loss: 1.658 Vali Loss: 3.070 Vali Acc: 0.218 Test Loss: 3.070 Test Acc: 0.218
Validation loss decreased (-0.172910 --> -0.217616).  Saving model ...
Epoch: 5 cost time: 1.0804061889648438
Epoch: 5, Steps: 10 | Train Loss: 1.078 Vali Loss: 3.117 Vali Acc: 0.233 Test Loss: 3.117 Test Acc: 0.233
Validation loss decreased (-0.217616 --> -0.232910).  Saving model ...
Epoch: 6 cost time: 0.977794885635376
Epoch: 6, Steps: 10 | Train Loss: 0.694 Vali Loss: 3.146 Vali Acc: 0.260 Test Loss: 3.146 Test Acc: 0.260
Validation loss decreased (-0.232910 --> -0.259969).  Saving model ...
Epoch: 7 cost time: 0.9218883514404297
Epoch: 7, Steps: 10 | Train Loss: 0.354 Vali Loss: 3.303 Vali Acc: 0.267 Test Loss: 3.303 Test Acc: 0.267
Validation loss decreased (-0.259969 --> -0.267026).  Saving model ...
Epoch: 8 cost time: 0.9910082817077637
Epoch: 8, Steps: 10 | Train Loss: 0.200 Vali Loss: 3.206 Vali Acc: 0.300 Test Loss: 3.206 Test Acc: 0.300
Validation loss decreased (-0.267026 --> -0.299968).  Saving model ...
Epoch: 9 cost time: 0.978754997253418
Epoch: 9, Steps: 10 | Train Loss: 0.155 Vali Loss: 3.550 Vali Acc: 0.293 Test Loss: 3.550 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9968240261077881
Epoch: 10, Steps: 10 | Train Loss: 0.086 Vali Loss: 3.679 Vali Acc: 0.266 Test Loss: 3.679 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8644695281982422
Epoch: 11, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.749 Vali Acc: 0.298 Test Loss: 3.749 Test Acc: 0.298
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8823964595794678
Epoch: 12, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.646 Vali Acc: 0.306 Test Loss: 3.646 Test Acc: 0.306
Validation loss decreased (-0.299968 --> -0.305846).  Saving model ...
Epoch: 13 cost time: 0.8753750324249268
Epoch: 13, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.610 Vali Acc: 0.329 Test Loss: 3.610 Test Acc: 0.329
Validation loss decreased (-0.305846 --> -0.329376).  Saving model ...
Epoch: 14 cost time: 0.9021635055541992
Epoch: 14, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.821 Vali Acc: 0.302 Test Loss: 3.821 Test Acc: 0.302
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7340183258056641
Epoch: 15, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.850 Vali Acc: 0.299 Test Loss: 3.850 Test Acc: 0.299
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9586224555969238
Epoch: 16, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.770 Vali Acc: 0.292 Test Loss: 3.770 Test Acc: 0.292
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9462075233459473
Epoch: 17, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.779 Vali Acc: 0.300 Test Loss: 3.779 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9783408641815186
Epoch: 18, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.083 Vali Acc: 0.275 Test Loss: 4.083 Test Acc: 0.275
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9714481830596924
Epoch: 19, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.134 Vali Acc: 0.293 Test Loss: 4.134 Test Acc: 0.293
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.0060441493988037
Epoch: 20, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.378 Vali Acc: 0.285 Test Loss: 4.378 Test Acc: 0.285
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9916455745697021
Epoch: 21, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.080 Vali Acc: 0.304 Test Loss: 4.080 Test Acc: 0.304
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.8717107772827148
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.017 Vali Acc: 0.305 Test Loss: 4.017 Test Acc: 0.305
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.8861818313598633
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.972 Vali Acc: 0.314 Test Loss: 3.972 Test Acc: 0.314
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.32941176470588235
model parameter : 6014874
model size : 25.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 6.4251179695129395
Epoch: 1, Steps: 10 | Train Loss: 3.315 Vali Loss: 3.257 Vali Acc: 0.072 Test Loss: 3.257 Test Acc: 0.072
Validation loss decreased (inf --> -0.071732).  Saving model ...
Epoch: 2 cost time: 5.094298601150513
Epoch: 2, Steps: 10 | Train Loss: 2.982 Vali Loss: 3.255 Vali Acc: 0.109 Test Loss: 3.255 Test Acc: 0.109
Validation loss decreased (-0.071732 --> -0.109379).  Saving model ...
Epoch: 3 cost time: 4.60401463508606
Epoch: 3, Steps: 10 | Train Loss: 2.458 Vali Loss: 3.119 Vali Acc: 0.167 Test Loss: 3.119 Test Acc: 0.167
Validation loss decreased (-0.109379 --> -0.167028).  Saving model ...
Epoch: 4 cost time: 4.575505495071411
Epoch: 4, Steps: 10 | Train Loss: 1.732 Vali Loss: 3.035 Vali Acc: 0.192 Test Loss: 3.035 Test Acc: 0.192
Validation loss decreased (-0.167028 --> -0.191734).  Saving model ...
Epoch: 5 cost time: 4.87103009223938
Epoch: 5, Steps: 10 | Train Loss: 1.265 Vali Loss: 3.064 Vali Acc: 0.222 Test Loss: 3.064 Test Acc: 0.222
Validation loss decreased (-0.191734 --> -0.222322).  Saving model ...
Epoch: 6 cost time: 4.239408731460571
Epoch: 6, Steps: 10 | Train Loss: 0.759 Vali Loss: 3.011 Vali Acc: 0.241 Test Loss: 3.011 Test Acc: 0.241
Validation loss decreased (-0.222322 --> -0.241146).  Saving model ...
Epoch: 7 cost time: 4.152447700500488
Epoch: 7, Steps: 10 | Train Loss: 0.482 Vali Loss: 3.060 Vali Acc: 0.265 Test Loss: 3.060 Test Acc: 0.265
Validation loss decreased (-0.241146 --> -0.264675).  Saving model ...
Epoch: 8 cost time: 4.7671263217926025
Epoch: 8, Steps: 10 | Train Loss: 0.230 Vali Loss: 3.095 Vali Acc: 0.285 Test Loss: 3.095 Test Acc: 0.285
Validation loss decreased (-0.264675 --> -0.284675).  Saving model ...
Epoch: 9 cost time: 4.897011995315552
Epoch: 9, Steps: 10 | Train Loss: 0.126 Vali Loss: 3.133 Vali Acc: 0.276 Test Loss: 3.133 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.400054931640625
Epoch: 10, Steps: 10 | Train Loss: 0.116 Vali Loss: 3.233 Vali Acc: 0.300 Test Loss: 3.233 Test Acc: 0.300
Validation loss decreased (-0.284675 --> -0.299968).  Saving model ...
Epoch: 11 cost time: 4.183613300323486
Epoch: 11, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.176 Vali Acc: 0.294 Test Loss: 3.176 Test Acc: 0.294
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.90702748298645
Epoch: 12, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.226 Vali Acc: 0.301 Test Loss: 3.226 Test Acc: 0.301
Validation loss decreased (-0.299968 --> -0.301144).  Saving model ...
Epoch: 13 cost time: 4.56319522857666
Epoch: 13, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.309 Vali Acc: 0.300 Test Loss: 3.309 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.227522611618042
Epoch: 14, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.280 Vali Acc: 0.298 Test Loss: 3.280 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.061790943145752
Epoch: 15, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.240 Vali Acc: 0.320 Test Loss: 3.240 Test Acc: 0.320
Validation loss decreased (-0.301144 --> -0.319968).  Saving model ...
Epoch: 16 cost time: 4.888678550720215
Epoch: 16, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.308 Vali Acc: 0.322 Test Loss: 3.308 Test Acc: 0.322
Validation loss decreased (-0.319968 --> -0.322320).  Saving model ...
Epoch: 17 cost time: 4.181557655334473
Epoch: 17, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.314 Vali Acc: 0.311 Test Loss: 3.314 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.332897186279297
Epoch: 18, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.415 Vali Acc: 0.306 Test Loss: 3.415 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.854129314422607
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.294 Vali Acc: 0.316 Test Loss: 3.294 Test Acc: 0.316
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.890624046325684
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.317 Vali Acc: 0.315 Test Loss: 3.317 Test Acc: 0.315
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 4.164818048477173
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.340 Vali Acc: 0.319 Test Loss: 3.340 Test Acc: 0.319
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 4.991228103637695
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.350 Vali Acc: 0.329 Test Loss: 3.350 Test Acc: 0.329
Validation loss decreased (-0.322320 --> -0.329378).  Saving model ...
Epoch: 23 cost time: 4.950138568878174
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.341 Vali Acc: 0.324 Test Loss: 3.341 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.176027059555054
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.359 Vali Acc: 0.318 Test Loss: 3.359 Test Acc: 0.318
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.33429741859436
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.392 Vali Acc: 0.319 Test Loss: 3.392 Test Acc: 0.319
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 4.890965223312378
Epoch: 26, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.526 Vali Acc: 0.314 Test Loss: 3.526 Test Acc: 0.314
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 5.004981279373169
Epoch: 27, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.385 Vali Acc: 0.316 Test Loss: 3.385 Test Acc: 0.316
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 4.3907716274261475
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.382 Vali Acc: 0.319 Test Loss: 3.382 Test Acc: 0.319
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 4.171851634979248
Epoch: 29, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.428 Vali Acc: 0.315 Test Loss: 3.428 Test Acc: 0.315
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 4.935653924942017
Epoch: 30, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.496 Vali Acc: 0.316 Test Loss: 3.496 Test Acc: 0.316
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.32941176470588235
model parameter : 19001050
model size : 73.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.2053720951080322
Epoch: 1, Steps: 10 | Train Loss: 3.317 Vali Loss: 3.294 Vali Acc: 0.056 Test Loss: 3.294 Test Acc: 0.056
Validation loss decreased (inf --> -0.056438).  Saving model ...
Epoch: 2 cost time: 1.9585814476013184
Epoch: 2, Steps: 10 | Train Loss: 3.092 Vali Loss: 3.291 Vali Acc: 0.095 Test Loss: 3.291 Test Acc: 0.095
Validation loss decreased (-0.056438 --> -0.095261).  Saving model ...
Epoch: 3 cost time: 1.9765827655792236
Epoch: 3, Steps: 10 | Train Loss: 2.556 Vali Loss: 3.194 Vali Acc: 0.158 Test Loss: 3.194 Test Acc: 0.158
Validation loss decreased (-0.095261 --> -0.157615).  Saving model ...
Epoch: 4 cost time: 1.9389948844909668
Epoch: 4, Steps: 10 | Train Loss: 1.997 Vali Loss: 3.071 Vali Acc: 0.193 Test Loss: 3.071 Test Acc: 0.193
Validation loss decreased (-0.157615 --> -0.192910).  Saving model ...
Epoch: 5 cost time: 1.8471508026123047
Epoch: 5, Steps: 10 | Train Loss: 1.371 Vali Loss: 2.983 Vali Acc: 0.225 Test Loss: 2.983 Test Acc: 0.225
Validation loss decreased (-0.192910 --> -0.224676).  Saving model ...
Epoch: 6 cost time: 1.6324596405029297
Epoch: 6, Steps: 10 | Train Loss: 0.857 Vali Loss: 2.964 Vali Acc: 0.252 Test Loss: 2.964 Test Acc: 0.252
Validation loss decreased (-0.224676 --> -0.251735).  Saving model ...
Epoch: 7 cost time: 1.7866380214691162
Epoch: 7, Steps: 10 | Train Loss: 0.528 Vali Loss: 3.028 Vali Acc: 0.248 Test Loss: 3.028 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6225645542144775
Epoch: 8, Steps: 10 | Train Loss: 0.405 Vali Loss: 3.003 Vali Acc: 0.284 Test Loss: 3.003 Test Acc: 0.284
Validation loss decreased (-0.251735 --> -0.283499).  Saving model ...
Epoch: 9 cost time: 1.711414098739624
Epoch: 9, Steps: 10 | Train Loss: 0.212 Vali Loss: 3.116 Vali Acc: 0.296 Test Loss: 3.116 Test Acc: 0.296
Validation loss decreased (-0.283499 --> -0.296439).  Saving model ...
Epoch: 10 cost time: 1.7539408206939697
Epoch: 10, Steps: 10 | Train Loss: 0.096 Vali Loss: 3.117 Vali Acc: 0.299 Test Loss: 3.117 Test Acc: 0.299
Validation loss decreased (-0.296439 --> -0.298792).  Saving model ...
Epoch: 11 cost time: 1.826977014541626
Epoch: 11, Steps: 10 | Train Loss: 0.075 Vali Loss: 3.198 Vali Acc: 0.301 Test Loss: 3.198 Test Acc: 0.301
Validation loss decreased (-0.298792 --> -0.301144).  Saving model ...
Epoch: 12 cost time: 1.8638224601745605
Epoch: 12, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.277 Vali Acc: 0.298 Test Loss: 3.277 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5775845050811768
Epoch: 13, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.333 Vali Acc: 0.305 Test Loss: 3.333 Test Acc: 0.305
Validation loss decreased (-0.301144 --> -0.304673).  Saving model ...
Epoch: 14 cost time: 1.341775894165039
Epoch: 14, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.316 Vali Acc: 0.307 Test Loss: 3.316 Test Acc: 0.307
Validation loss decreased (-0.304673 --> -0.307026).  Saving model ...
Epoch: 15 cost time: 1.636028528213501
Epoch: 15, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.525 Vali Acc: 0.287 Test Loss: 3.525 Test Acc: 0.287
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6268844604492188
Epoch: 16, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.334 Vali Acc: 0.281 Test Loss: 3.334 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.570188283920288
Epoch: 17, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.379 Vali Acc: 0.312 Test Loss: 3.379 Test Acc: 0.312
Validation loss decreased (-0.307026 --> -0.311731).  Saving model ...
Epoch: 18 cost time: 1.2092030048370361
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.297 Vali Acc: 0.322 Test Loss: 3.297 Test Acc: 0.322
Validation loss decreased (-0.311731 --> -0.322320).  Saving model ...
Epoch: 19 cost time: 1.2155158519744873
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.298 Vali Acc: 0.325 Test Loss: 3.298 Test Acc: 0.325
Validation loss decreased (-0.322320 --> -0.324673).  Saving model ...
Epoch: 20 cost time: 1.19746732711792
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.364 Vali Acc: 0.320 Test Loss: 3.364 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.286489725112915
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.425 Vali Acc: 0.322 Test Loss: 3.425 Test Acc: 0.322
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.4880156517028809
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.423 Vali Acc: 0.321 Test Loss: 3.423 Test Acc: 0.321
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.5431313514709473
Epoch: 23, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.420 Vali Acc: 0.321 Test Loss: 3.420 Test Acc: 0.321
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.5059247016906738
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.515 Vali Acc: 0.314 Test Loss: 3.515 Test Acc: 0.314
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.1909348964691162
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.437 Vali Acc: 0.327 Test Loss: 3.437 Test Acc: 0.327
Validation loss decreased (-0.324673 --> -0.327024).  Saving model ...
Epoch: 26 cost time: 1.354957103729248
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.417 Vali Acc: 0.342 Test Loss: 3.417 Test Acc: 0.342
Validation loss decreased (-0.327024 --> -0.342319).  Saving model ...
Epoch: 27 cost time: 1.431352138519287
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.435 Vali Acc: 0.340 Test Loss: 3.435 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.51176118850708
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.426 Vali Acc: 0.344 Test Loss: 3.426 Test Acc: 0.344
Validation loss decreased (-0.342319 --> -0.343495).  Saving model ...
Epoch: 29 cost time: 1.5423533916473389
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.435 Vali Acc: 0.342 Test Loss: 3.435 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.5528788566589355
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.472 Vali Acc: 0.325 Test Loss: 3.472 Test Acc: 0.325
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.34352941176470586
model parameter : 5761498
model size : 23.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.40543794631958
Epoch: 1, Steps: 10 | Train Loss: 3.317 Vali Loss: 3.259 Vali Acc: 0.072 Test Loss: 3.259 Test Acc: 0.072
Validation loss decreased (inf --> -0.071732).  Saving model ...
Epoch: 2 cost time: 3.1196129322052
Epoch: 2, Steps: 10 | Train Loss: 3.015 Vali Loss: 3.265 Vali Acc: 0.108 Test Loss: 3.265 Test Acc: 0.108
Validation loss decreased (-0.071732 --> -0.108203).  Saving model ...
Epoch: 3 cost time: 2.8453028202056885
Epoch: 3, Steps: 10 | Train Loss: 2.504 Vali Loss: 3.139 Vali Acc: 0.156 Test Loss: 3.139 Test Acc: 0.156
Validation loss decreased (-0.108203 --> -0.156439).  Saving model ...
Epoch: 4 cost time: 3.2569844722747803
Epoch: 4, Steps: 10 | Train Loss: 1.932 Vali Loss: 3.045 Vali Acc: 0.188 Test Loss: 3.045 Test Acc: 0.188
Validation loss decreased (-0.156439 --> -0.188205).  Saving model ...
Epoch: 5 cost time: 2.9397644996643066
Epoch: 5, Steps: 10 | Train Loss: 1.457 Vali Loss: 3.060 Vali Acc: 0.209 Test Loss: 3.060 Test Acc: 0.209
Validation loss decreased (-0.188205 --> -0.209381).  Saving model ...
Epoch: 6 cost time: 2.681572437286377
Epoch: 6, Steps: 10 | Train Loss: 0.932 Vali Loss: 2.996 Vali Acc: 0.252 Test Loss: 2.996 Test Acc: 0.252
Validation loss decreased (-0.209381 --> -0.251735).  Saving model ...
Epoch: 7 cost time: 2.641246795654297
Epoch: 7, Steps: 10 | Train Loss: 0.574 Vali Loss: 2.990 Vali Acc: 0.276 Test Loss: 2.990 Test Acc: 0.276
Validation loss decreased (-0.251735 --> -0.276441).  Saving model ...
Epoch: 8 cost time: 2.9118268489837646
Epoch: 8, Steps: 10 | Train Loss: 0.404 Vali Loss: 3.100 Vali Acc: 0.278 Test Loss: 3.100 Test Acc: 0.278
Validation loss decreased (-0.276441 --> -0.277616).  Saving model ...
Epoch: 9 cost time: 2.9592318534851074
Epoch: 9, Steps: 10 | Train Loss: 0.311 Vali Loss: 3.061 Vali Acc: 0.301 Test Loss: 3.061 Test Acc: 0.301
Validation loss decreased (-0.277616 --> -0.301146).  Saving model ...
Epoch: 10 cost time: 2.566934585571289
Epoch: 10, Steps: 10 | Train Loss: 0.106 Vali Loss: 3.109 Vali Acc: 0.308 Test Loss: 3.109 Test Acc: 0.308
Validation loss decreased (-0.301146 --> -0.308204).  Saving model ...
Epoch: 11 cost time: 2.8478052616119385
Epoch: 11, Steps: 10 | Train Loss: 0.100 Vali Loss: 3.252 Vali Acc: 0.319 Test Loss: 3.252 Test Acc: 0.319
Validation loss decreased (-0.308204 --> -0.318791).  Saving model ...
Epoch: 12 cost time: 2.932159185409546
Epoch: 12, Steps: 10 | Train Loss: 0.063 Vali Loss: 3.352 Vali Acc: 0.318 Test Loss: 3.352 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.770798444747925
Epoch: 13, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.319 Vali Acc: 0.321 Test Loss: 3.319 Test Acc: 0.321
Validation loss decreased (-0.318791 --> -0.321143).  Saving model ...
Epoch: 14 cost time: 2.608922004699707
Epoch: 14, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.422 Vali Acc: 0.315 Test Loss: 3.422 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.954374313354492
Epoch: 15, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.508 Vali Acc: 0.307 Test Loss: 3.508 Test Acc: 0.307
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.860321044921875
Epoch: 16, Steps: 10 | Train Loss: 0.089 Vali Loss: 3.444 Vali Acc: 0.301 Test Loss: 3.444 Test Acc: 0.301
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.5895042419433594
Epoch: 17, Steps: 10 | Train Loss: 0.126 Vali Loss: 3.283 Vali Acc: 0.322 Test Loss: 3.283 Test Acc: 0.322
Validation loss decreased (-0.321143 --> -0.322320).  Saving model ...
Epoch: 18 cost time: 2.6126725673675537
Epoch: 18, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.316 Vali Acc: 0.300 Test Loss: 3.316 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.946417808532715
Epoch: 19, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.626 Vali Acc: 0.273 Test Loss: 3.626 Test Acc: 0.273
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.9897449016571045
Epoch: 20, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.412 Vali Acc: 0.302 Test Loss: 3.412 Test Acc: 0.302
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.569938898086548
Epoch: 21, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.403 Vali Acc: 0.321 Test Loss: 3.403 Test Acc: 0.321
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.6342804431915283
Epoch: 22, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.409 Vali Acc: 0.321 Test Loss: 3.409 Test Acc: 0.321
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.9175262451171875
Epoch: 23, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.430 Vali Acc: 0.326 Test Loss: 3.430 Test Acc: 0.326
Validation loss decreased (-0.322320 --> -0.325848).  Saving model ...
Epoch: 24 cost time: 2.983006477355957
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.439 Vali Acc: 0.334 Test Loss: 3.439 Test Acc: 0.334
Validation loss decreased (-0.325848 --> -0.334083).  Saving model ...
Epoch: 25 cost time: 2.646078109741211
Epoch: 25, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.526 Vali Acc: 0.316 Test Loss: 3.526 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.547779083251953
Epoch: 26, Steps: 10 | Train Loss: 0.059 Vali Loss: 3.559 Vali Acc: 0.334 Test Loss: 3.559 Test Acc: 0.334
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.903900146484375
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.566 Vali Acc: 0.325 Test Loss: 3.566 Test Acc: 0.325
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.8347666263580322
Epoch: 28, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.663 Vali Acc: 0.318 Test Loss: 3.663 Test Acc: 0.318
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.602344512939453
Epoch: 29, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.565 Vali Acc: 0.333 Test Loss: 3.565 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.551520824432373
Epoch: 30, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.638 Vali Acc: 0.329 Test Loss: 3.638 Test Acc: 0.329
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3341176470588235
model parameter : 19001050
model size : 73.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.689708948135376
Epoch: 1, Steps: 10 | Train Loss: 3.299 Vali Loss: 3.296 Vali Acc: 0.059 Test Loss: 3.296 Test Acc: 0.059
Validation loss decreased (inf --> -0.058791).  Saving model ...
Epoch: 2 cost time: 1.217956781387329
Epoch: 2, Steps: 10 | Train Loss: 3.093 Vali Loss: 3.296 Vali Acc: 0.095 Test Loss: 3.296 Test Acc: 0.095
Validation loss decreased (-0.058791 --> -0.095261).  Saving model ...
Epoch: 3 cost time: 1.310511589050293
Epoch: 3, Steps: 10 | Train Loss: 2.581 Vali Loss: 3.206 Vali Acc: 0.152 Test Loss: 3.206 Test Acc: 0.152
Validation loss decreased (-0.095261 --> -0.151733).  Saving model ...
Epoch: 4 cost time: 1.3226468563079834
Epoch: 4, Steps: 10 | Train Loss: 2.061 Vali Loss: 3.089 Vali Acc: 0.181 Test Loss: 3.089 Test Acc: 0.181
Validation loss decreased (-0.151733 --> -0.181146).  Saving model ...
Epoch: 5 cost time: 1.4789350032806396
Epoch: 5, Steps: 10 | Train Loss: 1.459 Vali Loss: 3.002 Vali Acc: 0.219 Test Loss: 3.002 Test Acc: 0.219
Validation loss decreased (-0.181146 --> -0.218794).  Saving model ...
Epoch: 6 cost time: 1.2908577919006348
Epoch: 6, Steps: 10 | Train Loss: 1.098 Vali Loss: 2.980 Vali Acc: 0.239 Test Loss: 2.980 Test Acc: 0.239
Validation loss decreased (-0.218794 --> -0.238794).  Saving model ...
Epoch: 7 cost time: 1.103546380996704
Epoch: 7, Steps: 10 | Train Loss: 0.827 Vali Loss: 3.051 Vali Acc: 0.241 Test Loss: 3.051 Test Acc: 0.241
Validation loss decreased (-0.238794 --> -0.241146).  Saving model ...
Epoch: 8 cost time: 1.0757946968078613
Epoch: 8, Steps: 10 | Train Loss: 0.523 Vali Loss: 2.973 Vali Acc: 0.282 Test Loss: 2.973 Test Acc: 0.282
Validation loss decreased (-0.241146 --> -0.282323).  Saving model ...
Epoch: 9 cost time: 1.14548659324646
Epoch: 9, Steps: 10 | Train Loss: 0.308 Vali Loss: 3.067 Vali Acc: 0.291 Test Loss: 3.067 Test Acc: 0.291
Validation loss decreased (-0.282323 --> -0.290558).  Saving model ...
Epoch: 10 cost time: 1.2001099586486816
Epoch: 10, Steps: 10 | Train Loss: 0.133 Vali Loss: 3.107 Vali Acc: 0.312 Test Loss: 3.107 Test Acc: 0.312
Validation loss decreased (-0.290558 --> -0.311734).  Saving model ...
Epoch: 11 cost time: 1.204176425933838
Epoch: 11, Steps: 10 | Train Loss: 0.079 Vali Loss: 3.174 Vali Acc: 0.314 Test Loss: 3.174 Test Acc: 0.314
Validation loss decreased (-0.311734 --> -0.314086).  Saving model ...
Epoch: 12 cost time: 1.2115962505340576
Epoch: 12, Steps: 10 | Train Loss: 0.142 Vali Loss: 3.164 Vali Acc: 0.308 Test Loss: 3.164 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2609455585479736
Epoch: 13, Steps: 10 | Train Loss: 0.058 Vali Loss: 3.215 Vali Acc: 0.311 Test Loss: 3.215 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1159377098083496
Epoch: 14, Steps: 10 | Train Loss: 0.090 Vali Loss: 3.396 Vali Acc: 0.301 Test Loss: 3.396 Test Acc: 0.301
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1132102012634277
Epoch: 15, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.248 Vali Acc: 0.333 Test Loss: 3.248 Test Acc: 0.333
Validation loss decreased (-0.314086 --> -0.332909).  Saving model ...
Epoch: 16 cost time: 1.138183832168579
Epoch: 16, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.317 Vali Acc: 0.320 Test Loss: 3.317 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1698174476623535
Epoch: 17, Steps: 10 | Train Loss: 0.056 Vali Loss: 3.368 Vali Acc: 0.320 Test Loss: 3.368 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1926438808441162
Epoch: 18, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.421 Vali Acc: 0.319 Test Loss: 3.421 Test Acc: 0.319
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2191483974456787
Epoch: 19, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.372 Vali Acc: 0.333 Test Loss: 3.372 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.255981683731079
Epoch: 20, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.556 Vali Acc: 0.318 Test Loss: 3.556 Test Acc: 0.318
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.1065189838409424
Epoch: 21, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.358 Vali Acc: 0.336 Test Loss: 3.358 Test Acc: 0.336
Validation loss decreased (-0.332909 --> -0.336437).  Saving model ...
Epoch: 22 cost time: 1.1515982151031494
Epoch: 22, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.418 Vali Acc: 0.324 Test Loss: 3.418 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0954599380493164
Epoch: 23, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.526 Vali Acc: 0.332 Test Loss: 3.526 Test Acc: 0.332
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.3058173656463623
Epoch: 24, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.702 Vali Acc: 0.333 Test Loss: 3.702 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.154733419418335
Epoch: 25, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.714 Vali Acc: 0.327 Test Loss: 3.714 Test Acc: 0.327
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.2043540477752686
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.593 Vali Acc: 0.340 Test Loss: 3.593 Test Acc: 0.340
Validation loss decreased (-0.336437 --> -0.339964).  Saving model ...
Epoch: 27 cost time: 1.1834583282470703
Epoch: 27, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.443 Vali Acc: 0.349 Test Loss: 3.443 Test Acc: 0.349
Validation loss decreased (-0.339964 --> -0.349377).  Saving model ...
Epoch: 28 cost time: 1.1213698387145996
Epoch: 28, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.597 Vali Acc: 0.324 Test Loss: 3.597 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.284146785736084
Epoch: 29, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.701 Vali Acc: 0.332 Test Loss: 3.701 Test Acc: 0.332
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.3005256652832031
Epoch: 30, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.525 Vali Acc: 0.339 Test Loss: 3.525 Test Acc: 0.339
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.34941176470588237
model parameter : 5761498
model size : 23.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.327754497528076
Epoch: 1, Steps: 10 | Train Loss: 3.333 Vali Loss: 3.263 Vali Acc: 0.062 Test Loss: 3.263 Test Acc: 0.062
Validation loss decreased (inf --> -0.062320).  Saving model ...
Epoch: 2 cost time: 1.8328356742858887
Epoch: 2, Steps: 10 | Train Loss: 3.046 Vali Loss: 3.304 Vali Acc: 0.096 Test Loss: 3.304 Test Acc: 0.096
Validation loss decreased (-0.062320 --> -0.096438).  Saving model ...
Epoch: 3 cost time: 1.7569046020507812
Epoch: 3, Steps: 10 | Train Loss: 2.652 Vali Loss: 3.220 Vali Acc: 0.132 Test Loss: 3.220 Test Acc: 0.132
Validation loss decreased (-0.096438 --> -0.131733).  Saving model ...
Epoch: 4 cost time: 1.8526432514190674
Epoch: 4, Steps: 10 | Train Loss: 2.082 Vali Loss: 3.119 Vali Acc: 0.178 Test Loss: 3.119 Test Acc: 0.178
Validation loss decreased (-0.131733 --> -0.177616).  Saving model ...
Epoch: 5 cost time: 1.7871568202972412
Epoch: 5, Steps: 10 | Train Loss: 1.506 Vali Loss: 3.106 Vali Acc: 0.204 Test Loss: 3.106 Test Acc: 0.204
Validation loss decreased (-0.177616 --> -0.203498).  Saving model ...
Epoch: 6 cost time: 1.4489266872406006
Epoch: 6, Steps: 10 | Train Loss: 1.039 Vali Loss: 3.049 Vali Acc: 0.240 Test Loss: 3.049 Test Acc: 0.240
Validation loss decreased (-0.203498 --> -0.239970).  Saving model ...
Epoch: 7 cost time: 1.5611321926116943
Epoch: 7, Steps: 10 | Train Loss: 0.869 Vali Loss: 3.061 Vali Acc: 0.267 Test Loss: 3.061 Test Acc: 0.267
Validation loss decreased (-0.239970 --> -0.267028).  Saving model ...
Epoch: 8 cost time: 1.3560357093811035
Epoch: 8, Steps: 10 | Train Loss: 0.413 Vali Loss: 3.119 Vali Acc: 0.289 Test Loss: 3.119 Test Acc: 0.289
Validation loss decreased (-0.267028 --> -0.289381).  Saving model ...
Epoch: 9 cost time: 1.3966798782348633
Epoch: 9, Steps: 10 | Train Loss: 0.202 Vali Loss: 3.088 Vali Acc: 0.299 Test Loss: 3.088 Test Acc: 0.299
Validation loss decreased (-0.289381 --> -0.298793).  Saving model ...
Epoch: 10 cost time: 1.367126703262329
Epoch: 10, Steps: 10 | Train Loss: 0.147 Vali Loss: 3.157 Vali Acc: 0.305 Test Loss: 3.157 Test Acc: 0.305
Validation loss decreased (-0.298793 --> -0.304674).  Saving model ...
Epoch: 11 cost time: 1.3736226558685303
Epoch: 11, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.218 Vali Acc: 0.300 Test Loss: 3.218 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3249437808990479
Epoch: 12, Steps: 10 | Train Loss: 0.068 Vali Loss: 3.297 Vali Acc: 0.315 Test Loss: 3.297 Test Acc: 0.315
Validation loss decreased (-0.304674 --> -0.315261).  Saving model ...
Epoch: 13 cost time: 1.7988393306732178
Epoch: 13, Steps: 10 | Train Loss: 0.063 Vali Loss: 3.306 Vali Acc: 0.325 Test Loss: 3.306 Test Acc: 0.325
Validation loss decreased (-0.315261 --> -0.324673).  Saving model ...
Epoch: 14 cost time: 1.8237688541412354
Epoch: 14, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.362 Vali Acc: 0.301 Test Loss: 3.362 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5690381526947021
Epoch: 15, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.321 Vali Acc: 0.319 Test Loss: 3.321 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.580958366394043
Epoch: 16, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.375 Vali Acc: 0.328 Test Loss: 3.375 Test Acc: 0.328
Validation loss decreased (-0.324673 --> -0.328202).  Saving model ...
Epoch: 17 cost time: 1.709137201309204
Epoch: 17, Steps: 10 | Train Loss: 0.068 Vali Loss: 3.445 Vali Acc: 0.315 Test Loss: 3.445 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8516933917999268
Epoch: 18, Steps: 10 | Train Loss: 0.043 Vali Loss: 3.531 Vali Acc: 0.299 Test Loss: 3.531 Test Acc: 0.299
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.7745110988616943
Epoch: 19, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.464 Vali Acc: 0.308 Test Loss: 3.464 Test Acc: 0.308
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.774867296218872
Epoch: 20, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.503 Vali Acc: 0.286 Test Loss: 3.503 Test Acc: 0.286
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.627922534942627
Epoch: 21, Steps: 10 | Train Loss: 0.117 Vali Loss: 3.549 Vali Acc: 0.288 Test Loss: 3.549 Test Acc: 0.288
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.5766901969909668
Epoch: 22, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.596 Vali Acc: 0.311 Test Loss: 3.596 Test Acc: 0.311
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.889343500137329
Epoch: 23, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.502 Vali Acc: 0.318 Test Loss: 3.502 Test Acc: 0.318
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.8834407329559326
Epoch: 24, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.740 Vali Acc: 0.299 Test Loss: 3.740 Test Acc: 0.299
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.9392564296722412
Epoch: 25, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.920 Vali Acc: 0.291 Test Loss: 3.920 Test Acc: 0.291
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.6727240085601807
Epoch: 26, Steps: 10 | Train Loss: 0.066 Vali Loss: 3.625 Vali Acc: 0.306 Test Loss: 3.625 Test Acc: 0.306
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.32823529411764707
model parameter : 19001050
model size : 73.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.2858834266662598
Epoch: 1, Steps: 10 | Train Loss: 3.291 Vali Loss: 3.299 Vali Acc: 0.047 Test Loss: 3.299 Test Acc: 0.047
Validation loss decreased (inf --> -0.047026).  Saving model ...
Epoch: 2 cost time: 1.031815528869629
Epoch: 2, Steps: 10 | Train Loss: 3.147 Vali Loss: 3.320 Vali Acc: 0.079 Test Loss: 3.320 Test Acc: 0.079
Validation loss decreased (-0.047026 --> -0.078790).  Saving model ...
Epoch: 3 cost time: 1.0509543418884277
Epoch: 3, Steps: 10 | Train Loss: 2.656 Vali Loss: 3.250 Vali Acc: 0.139 Test Loss: 3.250 Test Acc: 0.139
Validation loss decreased (-0.078790 --> -0.138791).  Saving model ...
Epoch: 4 cost time: 0.9617798328399658
Epoch: 4, Steps: 10 | Train Loss: 2.263 Vali Loss: 3.133 Vali Acc: 0.169 Test Loss: 3.133 Test Acc: 0.169
Validation loss decreased (-0.138791 --> -0.169380).  Saving model ...
Epoch: 5 cost time: 0.90566086769104
Epoch: 5, Steps: 10 | Train Loss: 1.687 Vali Loss: 3.071 Vali Acc: 0.195 Test Loss: 3.071 Test Acc: 0.195
Validation loss decreased (-0.169380 --> -0.195263).  Saving model ...
Epoch: 6 cost time: 0.8318028450012207
Epoch: 6, Steps: 10 | Train Loss: 1.327 Vali Loss: 3.057 Vali Acc: 0.202 Test Loss: 3.057 Test Acc: 0.202
Validation loss decreased (-0.195263 --> -0.202322).  Saving model ...
Epoch: 7 cost time: 0.8962972164154053
Epoch: 7, Steps: 10 | Train Loss: 1.064 Vali Loss: 3.036 Vali Acc: 0.227 Test Loss: 3.036 Test Acc: 0.227
Validation loss decreased (-0.202322 --> -0.227028).  Saving model ...
Epoch: 8 cost time: 0.9614322185516357
Epoch: 8, Steps: 10 | Train Loss: 0.659 Vali Loss: 3.005 Vali Acc: 0.264 Test Loss: 3.005 Test Acc: 0.264
Validation loss decreased (-0.227028 --> -0.263499).  Saving model ...
Epoch: 9 cost time: 0.9118351936340332
Epoch: 9, Steps: 10 | Train Loss: 0.405 Vali Loss: 3.047 Vali Acc: 0.267 Test Loss: 3.047 Test Acc: 0.267
Validation loss decreased (-0.263499 --> -0.267028).  Saving model ...
Epoch: 10 cost time: 0.9180154800415039
Epoch: 10, Steps: 10 | Train Loss: 0.240 Vali Loss: 3.113 Vali Acc: 0.291 Test Loss: 3.113 Test Acc: 0.291
Validation loss decreased (-0.267028 --> -0.290557).  Saving model ...
Epoch: 11 cost time: 0.783888578414917
Epoch: 11, Steps: 10 | Train Loss: 0.149 Vali Loss: 3.202 Vali Acc: 0.294 Test Loss: 3.202 Test Acc: 0.294
Validation loss decreased (-0.290557 --> -0.294086).  Saving model ...
Epoch: 12 cost time: 0.807283878326416
Epoch: 12, Steps: 10 | Train Loss: 0.153 Vali Loss: 3.223 Vali Acc: 0.315 Test Loss: 3.223 Test Acc: 0.315
Validation loss decreased (-0.294086 --> -0.315262).  Saving model ...
Epoch: 13 cost time: 0.864708423614502
Epoch: 13, Steps: 10 | Train Loss: 0.142 Vali Loss: 3.264 Vali Acc: 0.304 Test Loss: 3.264 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8787283897399902
Epoch: 14, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.306 Vali Acc: 0.331 Test Loss: 3.306 Test Acc: 0.331
Validation loss decreased (-0.315262 --> -0.330555).  Saving model ...
Epoch: 15 cost time: 0.9818410873413086
Epoch: 15, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.324 Vali Acc: 0.340 Test Loss: 3.324 Test Acc: 0.340
Validation loss decreased (-0.330555 --> -0.339967).  Saving model ...
Epoch: 16 cost time: 0.9480741024017334
Epoch: 16, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.337 Vali Acc: 0.325 Test Loss: 3.337 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.956012487411499
Epoch: 17, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.334 Vali Acc: 0.331 Test Loss: 3.334 Test Acc: 0.331
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1305716037750244
Epoch: 18, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.596 Vali Acc: 0.311 Test Loss: 3.596 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7974197864532471
Epoch: 19, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.562 Vali Acc: 0.315 Test Loss: 3.562 Test Acc: 0.315
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8314785957336426
Epoch: 20, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.530 Vali Acc: 0.326 Test Loss: 3.530 Test Acc: 0.326
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.8396224975585938
Epoch: 21, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.490 Vali Acc: 0.346 Test Loss: 3.490 Test Acc: 0.346
Validation loss decreased (-0.339967 --> -0.345847).  Saving model ...
Epoch: 22 cost time: 0.9306516647338867
Epoch: 22, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.577 Vali Acc: 0.325 Test Loss: 3.577 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9274806976318359
Epoch: 23, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.604 Vali Acc: 0.316 Test Loss: 3.604 Test Acc: 0.316
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9618871212005615
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.590 Vali Acc: 0.335 Test Loss: 3.590 Test Acc: 0.335
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.8849332332611084
Epoch: 25, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.529 Vali Acc: 0.338 Test Loss: 3.529 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.8882699012756348
Epoch: 26, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.630 Vali Acc: 0.312 Test Loss: 3.630 Test Acc: 0.312
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.8143570423126221
Epoch: 27, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.713 Vali Acc: 0.326 Test Loss: 3.713 Test Acc: 0.326
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.8289952278137207
Epoch: 28, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.796 Vali Acc: 0.307 Test Loss: 3.796 Test Acc: 0.307
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.9682748317718506
Epoch: 29, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.738 Vali Acc: 0.320 Test Loss: 3.738 Test Acc: 0.320
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.9030942916870117
Epoch: 30, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.645 Vali Acc: 0.329 Test Loss: 3.645 Test Acc: 0.329
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3458823529411765
model parameter : 5761498
model size : 23.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.796834707260132
Epoch: 1, Steps: 10 | Train Loss: 3.287 Vali Loss: 3.270 Vali Acc: 0.039 Test Loss: 3.270 Test Acc: 0.039
Validation loss decreased (inf --> -0.038791).  Saving model ...
Epoch: 2 cost time: 2.376450538635254
Epoch: 2, Steps: 10 | Train Loss: 2.990 Vali Loss: 3.276 Vali Acc: 0.096 Test Loss: 3.276 Test Acc: 0.096
Validation loss decreased (-0.038791 --> -0.096438).  Saving model ...
Epoch: 3 cost time: 2.6887378692626953
Epoch: 3, Steps: 10 | Train Loss: 2.562 Vali Loss: 3.182 Vali Acc: 0.142 Test Loss: 3.182 Test Acc: 0.142
Validation loss decreased (-0.096438 --> -0.142321).  Saving model ...
Epoch: 4 cost time: 2.7645018100738525
Epoch: 4, Steps: 10 | Train Loss: 1.974 Vali Loss: 3.014 Vali Acc: 0.198 Test Loss: 3.014 Test Acc: 0.198
Validation loss decreased (-0.142321 --> -0.197617).  Saving model ...
Epoch: 5 cost time: 2.2750494480133057
Epoch: 5, Steps: 10 | Train Loss: 1.360 Vali Loss: 3.003 Vali Acc: 0.219 Test Loss: 3.003 Test Acc: 0.219
Validation loss decreased (-0.197617 --> -0.218793).  Saving model ...
Epoch: 6 cost time: 2.3756024837493896
Epoch: 6, Steps: 10 | Train Loss: 0.856 Vali Loss: 2.960 Vali Acc: 0.224 Test Loss: 2.960 Test Acc: 0.224
Validation loss decreased (-0.218793 --> -0.223500).  Saving model ...
Epoch: 7 cost time: 2.72538423538208
Epoch: 7, Steps: 10 | Train Loss: 0.536 Vali Loss: 3.036 Vali Acc: 0.285 Test Loss: 3.036 Test Acc: 0.285
Validation loss decreased (-0.223500 --> -0.284676).  Saving model ...
Epoch: 8 cost time: 2.653958320617676
Epoch: 8, Steps: 10 | Train Loss: 0.279 Vali Loss: 3.004 Vali Acc: 0.287 Test Loss: 3.004 Test Acc: 0.287
Validation loss decreased (-0.284676 --> -0.287029).  Saving model ...
Epoch: 9 cost time: 2.3836450576782227
Epoch: 9, Steps: 10 | Train Loss: 0.255 Vali Loss: 3.104 Vali Acc: 0.314 Test Loss: 3.104 Test Acc: 0.314
Validation loss decreased (-0.287029 --> -0.314087).  Saving model ...
Epoch: 10 cost time: 2.227773904800415
Epoch: 10, Steps: 10 | Train Loss: 0.101 Vali Loss: 3.149 Vali Acc: 0.313 Test Loss: 3.149 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.6160781383514404
Epoch: 11, Steps: 10 | Train Loss: 0.064 Vali Loss: 3.144 Vali Acc: 0.322 Test Loss: 3.144 Test Acc: 0.322
Validation loss decreased (-0.314087 --> -0.322322).  Saving model ...
Epoch: 12 cost time: 2.713866710662842
Epoch: 12, Steps: 10 | Train Loss: 0.110 Vali Loss: 3.148 Vali Acc: 0.327 Test Loss: 3.148 Test Acc: 0.327
Validation loss decreased (-0.322322 --> -0.327027).  Saving model ...
Epoch: 13 cost time: 2.206519365310669
Epoch: 13, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.238 Vali Acc: 0.321 Test Loss: 3.238 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.6351919174194336
Epoch: 14, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.215 Vali Acc: 0.327 Test Loss: 3.215 Test Acc: 0.327
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.6545355319976807
Epoch: 15, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.331 Vali Acc: 0.320 Test Loss: 3.331 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.701878309249878
Epoch: 16, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.355 Vali Acc: 0.313 Test Loss: 3.355 Test Acc: 0.313
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.156982183456421
Epoch: 17, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.328 Vali Acc: 0.319 Test Loss: 3.328 Test Acc: 0.319
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.49397873878479
Epoch: 18, Steps: 10 | Train Loss: 0.072 Vali Loss: 3.490 Vali Acc: 0.306 Test Loss: 3.490 Test Acc: 0.306
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.5664846897125244
Epoch: 19, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.397 Vali Acc: 0.314 Test Loss: 3.397 Test Acc: 0.314
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.5468358993530273
Epoch: 20, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.380 Vali Acc: 0.332 Test Loss: 3.380 Test Acc: 0.332
Validation loss decreased (-0.327027 --> -0.331731).  Saving model ...
Epoch: 21 cost time: 2.17830491065979
Epoch: 21, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.363 Vali Acc: 0.334 Test Loss: 3.363 Test Acc: 0.334
Validation loss decreased (-0.331731 --> -0.334084).  Saving model ...
Epoch: 22 cost time: 2.4406819343566895
Epoch: 22, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.522 Vali Acc: 0.315 Test Loss: 3.522 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.479254722595215
Epoch: 23, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.595 Vali Acc: 0.314 Test Loss: 3.595 Test Acc: 0.314
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.59676456451416
Epoch: 24, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.522 Vali Acc: 0.326 Test Loss: 3.522 Test Acc: 0.326
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.2152860164642334
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.482 Vali Acc: 0.328 Test Loss: 3.482 Test Acc: 0.328
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.035680055618286
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.479 Vali Acc: 0.328 Test Loss: 3.479 Test Acc: 0.328
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.464632272720337
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.510 Vali Acc: 0.329 Test Loss: 3.510 Test Acc: 0.329
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.53546404838562
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.509 Vali Acc: 0.333 Test Loss: 3.509 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.1880533695220947
Epoch: 29, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.561 Vali Acc: 0.328 Test Loss: 3.561 Test Acc: 0.328
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.1872668266296387
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.818 Vali Acc: 0.289 Test Loss: 3.818 Test Acc: 0.289
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3341176470588235
model parameter : 9627866
model size : 37.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.2682697772979736
Epoch: 1, Steps: 10 | Train Loss: 3.302 Vali Loss: 3.286 Vali Acc: 0.036 Test Loss: 3.286 Test Acc: 0.036
Validation loss decreased (inf --> -0.036438).  Saving model ...
Epoch: 2 cost time: 0.9036850929260254
Epoch: 2, Steps: 10 | Train Loss: 3.046 Vali Loss: 3.274 Vali Acc: 0.085 Test Loss: 3.274 Test Acc: 0.085
Validation loss decreased (-0.036438 --> -0.084673).  Saving model ...
Epoch: 3 cost time: 0.9433181285858154
Epoch: 3, Steps: 10 | Train Loss: 2.614 Vali Loss: 3.199 Vali Acc: 0.128 Test Loss: 3.199 Test Acc: 0.128
Validation loss decreased (-0.084673 --> -0.128203).  Saving model ...
Epoch: 4 cost time: 1.0676851272583008
Epoch: 4, Steps: 10 | Train Loss: 2.134 Vali Loss: 3.077 Vali Acc: 0.178 Test Loss: 3.077 Test Acc: 0.178
Validation loss decreased (-0.128203 --> -0.177616).  Saving model ...
Epoch: 5 cost time: 1.0671987533569336
Epoch: 5, Steps: 10 | Train Loss: 1.583 Vali Loss: 2.980 Vali Acc: 0.204 Test Loss: 2.980 Test Acc: 0.204
Validation loss decreased (-0.177616 --> -0.203500).  Saving model ...
Epoch: 6 cost time: 1.0537528991699219
Epoch: 6, Steps: 10 | Train Loss: 1.106 Vali Loss: 2.940 Vali Acc: 0.240 Test Loss: 2.940 Test Acc: 0.240
Validation loss decreased (-0.203500 --> -0.239971).  Saving model ...
Epoch: 7 cost time: 1.0037267208099365
Epoch: 7, Steps: 10 | Train Loss: 0.646 Vali Loss: 3.027 Vali Acc: 0.246 Test Loss: 3.027 Test Acc: 0.246
Validation loss decreased (-0.239971 --> -0.245852).  Saving model ...
Epoch: 8 cost time: 1.12302827835083
Epoch: 8, Steps: 10 | Train Loss: 0.397 Vali Loss: 3.077 Vali Acc: 0.269 Test Loss: 3.077 Test Acc: 0.269
Validation loss decreased (-0.245852 --> -0.269381).  Saving model ...
Epoch: 9 cost time: 1.028752326965332
Epoch: 9, Steps: 10 | Train Loss: 0.227 Vali Loss: 3.026 Vali Acc: 0.308 Test Loss: 3.026 Test Acc: 0.308
Validation loss decreased (-0.269381 --> -0.308205).  Saving model ...
Epoch: 10 cost time: 1.0657033920288086
Epoch: 10, Steps: 10 | Train Loss: 0.150 Vali Loss: 3.190 Vali Acc: 0.294 Test Loss: 3.190 Test Acc: 0.294
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1212046146392822
Epoch: 11, Steps: 10 | Train Loss: 0.072 Vali Loss: 3.239 Vali Acc: 0.294 Test Loss: 3.239 Test Acc: 0.294
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0253698825836182
Epoch: 12, Steps: 10 | Train Loss: 0.074 Vali Loss: 3.279 Vali Acc: 0.299 Test Loss: 3.279 Test Acc: 0.299
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9949061870574951
Epoch: 13, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.217 Vali Acc: 0.314 Test Loss: 3.217 Test Acc: 0.314
Validation loss decreased (-0.308205 --> -0.314085).  Saving model ...
Epoch: 14 cost time: 0.9894957542419434
Epoch: 14, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.322 Vali Acc: 0.306 Test Loss: 3.322 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0576276779174805
Epoch: 15, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.383 Vali Acc: 0.306 Test Loss: 3.383 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1515066623687744
Epoch: 16, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.347 Vali Acc: 0.319 Test Loss: 3.347 Test Acc: 0.319
Validation loss decreased (-0.314085 --> -0.318790).  Saving model ...
Epoch: 17 cost time: 1.2382862567901611
Epoch: 17, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.294 Vali Acc: 0.328 Test Loss: 3.294 Test Acc: 0.328
Validation loss decreased (-0.318790 --> -0.328202).  Saving model ...
Epoch: 18 cost time: 1.0429041385650635
Epoch: 18, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.302 Vali Acc: 0.325 Test Loss: 3.302 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.968731164932251
Epoch: 19, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.384 Vali Acc: 0.325 Test Loss: 3.384 Test Acc: 0.325
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.040569543838501
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.448 Vali Acc: 0.319 Test Loss: 3.448 Test Acc: 0.319
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1168184280395508
Epoch: 21, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.626 Vali Acc: 0.313 Test Loss: 3.626 Test Acc: 0.313
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.1323933601379395
Epoch: 22, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.450 Vali Acc: 0.321 Test Loss: 3.450 Test Acc: 0.321
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.1027967929840088
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.504 Vali Acc: 0.308 Test Loss: 3.504 Test Acc: 0.308
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.0456740856170654
Epoch: 24, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.595 Vali Acc: 0.312 Test Loss: 3.595 Test Acc: 0.312
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.0559096336364746
Epoch: 25, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.680 Vali Acc: 0.315 Test Loss: 3.680 Test Acc: 0.315
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.1353373527526855
Epoch: 26, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.546 Vali Acc: 0.305 Test Loss: 3.546 Test Acc: 0.305
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.1691007614135742
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.552 Vali Acc: 0.322 Test Loss: 3.552 Test Acc: 0.322
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.32823529411764707
model parameter : 3007962
model size : 12.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.132040500640869
Epoch: 1, Steps: 10 | Train Loss: 3.277 Vali Loss: 3.274 Vali Acc: 0.041 Test Loss: 3.274 Test Acc: 0.041
Validation loss decreased (inf --> -0.041144).  Saving model ...
Epoch: 2 cost time: 1.831521987915039
Epoch: 2, Steps: 10 | Train Loss: 3.002 Vali Loss: 3.284 Vali Acc: 0.106 Test Loss: 3.284 Test Acc: 0.106
Validation loss decreased (-0.041144 --> -0.105850).  Saving model ...
Epoch: 3 cost time: 1.596695899963379
Epoch: 3, Steps: 10 | Train Loss: 2.588 Vali Loss: 3.206 Vali Acc: 0.138 Test Loss: 3.206 Test Acc: 0.138
Validation loss decreased (-0.105850 --> -0.137615).  Saving model ...
Epoch: 4 cost time: 1.6083319187164307
Epoch: 4, Steps: 10 | Train Loss: 2.045 Vali Loss: 3.047 Vali Acc: 0.195 Test Loss: 3.047 Test Acc: 0.195
Validation loss decreased (-0.137615 --> -0.195264).  Saving model ...
Epoch: 5 cost time: 1.7808244228363037
Epoch: 5, Steps: 10 | Train Loss: 1.452 Vali Loss: 3.074 Vali Acc: 0.200 Test Loss: 3.074 Test Acc: 0.200
Validation loss decreased (-0.195264 --> -0.199969).  Saving model ...
Epoch: 6 cost time: 1.8879194259643555
Epoch: 6, Steps: 10 | Train Loss: 0.990 Vali Loss: 3.009 Vali Acc: 0.241 Test Loss: 3.009 Test Acc: 0.241
Validation loss decreased (-0.199969 --> -0.241146).  Saving model ...
Epoch: 7 cost time: 1.645324945449829
Epoch: 7, Steps: 10 | Train Loss: 0.702 Vali Loss: 3.082 Vali Acc: 0.254 Test Loss: 3.082 Test Acc: 0.254
Validation loss decreased (-0.241146 --> -0.254087).  Saving model ...
Epoch: 8 cost time: 1.6317787170410156
Epoch: 8, Steps: 10 | Train Loss: 0.425 Vali Loss: 3.024 Vali Acc: 0.296 Test Loss: 3.024 Test Acc: 0.296
Validation loss decreased (-0.254087 --> -0.296440).  Saving model ...
Epoch: 9 cost time: 1.7701680660247803
Epoch: 9, Steps: 10 | Train Loss: 0.350 Vali Loss: 3.144 Vali Acc: 0.287 Test Loss: 3.144 Test Acc: 0.287
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.669600248336792
Epoch: 10, Steps: 10 | Train Loss: 0.237 Vali Loss: 3.148 Vali Acc: 0.308 Test Loss: 3.148 Test Acc: 0.308
Validation loss decreased (-0.296440 --> -0.308204).  Saving model ...
Epoch: 11 cost time: 1.554434061050415
Epoch: 11, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.140 Vali Acc: 0.318 Test Loss: 3.140 Test Acc: 0.318
Validation loss decreased (-0.308204 --> -0.317616).  Saving model ...
Epoch: 12 cost time: 1.528383493423462
Epoch: 12, Steps: 10 | Train Loss: 0.090 Vali Loss: 3.340 Vali Acc: 0.314 Test Loss: 3.340 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6694269180297852
Epoch: 13, Steps: 10 | Train Loss: 0.074 Vali Loss: 3.227 Vali Acc: 0.334 Test Loss: 3.227 Test Acc: 0.334
Validation loss decreased (-0.317616 --> -0.334085).  Saving model ...
Epoch: 14 cost time: 1.7039988040924072
Epoch: 14, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.306 Vali Acc: 0.340 Test Loss: 3.306 Test Acc: 0.340
Validation loss decreased (-0.334085 --> -0.339967).  Saving model ...
Epoch: 15 cost time: 1.5956790447235107
Epoch: 15, Steps: 10 | Train Loss: 0.083 Vali Loss: 3.367 Vali Acc: 0.318 Test Loss: 3.367 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5173962116241455
Epoch: 16, Steps: 10 | Train Loss: 0.083 Vali Loss: 3.303 Vali Acc: 0.324 Test Loss: 3.303 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.71832275390625
Epoch: 17, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.259 Vali Acc: 0.331 Test Loss: 3.259 Test Acc: 0.331
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.6647472381591797
Epoch: 18, Steps: 10 | Train Loss: 0.059 Vali Loss: 3.365 Vali Acc: 0.332 Test Loss: 3.365 Test Acc: 0.332
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.5748677253723145
Epoch: 19, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.465 Vali Acc: 0.318 Test Loss: 3.465 Test Acc: 0.318
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.5554144382476807
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.395 Vali Acc: 0.332 Test Loss: 3.395 Test Acc: 0.332
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.6784625053405762
Epoch: 21, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.401 Vali Acc: 0.336 Test Loss: 3.401 Test Acc: 0.336
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.6596570014953613
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.530 Vali Acc: 0.332 Test Loss: 3.530 Test Acc: 0.332
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.5377388000488281
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.532 Vali Acc: 0.338 Test Loss: 3.532 Test Acc: 0.338
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.5476248264312744
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.535 Vali Acc: 0.329 Test Loss: 3.535 Test Acc: 0.329
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.34
model parameter : 9627866
model size : 37.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.1263415813446045
Epoch: 1, Steps: 10 | Train Loss: 3.311 Vali Loss: 3.285 Vali Acc: 0.035 Test Loss: 3.285 Test Acc: 0.035
Validation loss decreased (inf --> -0.035261).  Saving model ...
Epoch: 2 cost time: 0.8965001106262207
Epoch: 2, Steps: 10 | Train Loss: 3.062 Vali Loss: 3.277 Vali Acc: 0.079 Test Loss: 3.277 Test Acc: 0.079
Validation loss decreased (-0.035261 --> -0.078791).  Saving model ...
Epoch: 3 cost time: 0.8547310829162598
Epoch: 3, Steps: 10 | Train Loss: 2.667 Vali Loss: 3.209 Vali Acc: 0.119 Test Loss: 3.209 Test Acc: 0.119
Validation loss decreased (-0.078791 --> -0.118791).  Saving model ...
Epoch: 4 cost time: 0.8749885559082031
Epoch: 4, Steps: 10 | Train Loss: 2.223 Vali Loss: 3.090 Vali Acc: 0.174 Test Loss: 3.090 Test Acc: 0.174
Validation loss decreased (-0.118791 --> -0.174087).  Saving model ...
Epoch: 5 cost time: 0.7800862789154053
Epoch: 5, Steps: 10 | Train Loss: 1.672 Vali Loss: 2.985 Vali Acc: 0.213 Test Loss: 2.985 Test Acc: 0.213
Validation loss decreased (-0.174087 --> -0.212911).  Saving model ...
Epoch: 6 cost time: 0.7844538688659668
Epoch: 6, Steps: 10 | Train Loss: 1.246 Vali Loss: 2.965 Vali Acc: 0.222 Test Loss: 2.965 Test Acc: 0.222
Validation loss decreased (-0.212911 --> -0.222323).  Saving model ...
Epoch: 7 cost time: 0.8117315769195557
Epoch: 7, Steps: 10 | Train Loss: 0.781 Vali Loss: 3.023 Vali Acc: 0.241 Test Loss: 3.023 Test Acc: 0.241
Validation loss decreased (-0.222323 --> -0.241146).  Saving model ...
Epoch: 8 cost time: 0.7793536186218262
Epoch: 8, Steps: 10 | Train Loss: 0.529 Vali Loss: 3.050 Vali Acc: 0.268 Test Loss: 3.050 Test Acc: 0.268
Validation loss decreased (-0.241146 --> -0.268205).  Saving model ...
Epoch: 9 cost time: 0.8038225173950195
Epoch: 9, Steps: 10 | Train Loss: 0.363 Vali Loss: 3.029 Vali Acc: 0.287 Test Loss: 3.029 Test Acc: 0.287
Validation loss decreased (-0.268205 --> -0.287029).  Saving model ...
Epoch: 10 cost time: 0.7149879932403564
Epoch: 10, Steps: 10 | Train Loss: 0.200 Vali Loss: 3.188 Vali Acc: 0.288 Test Loss: 3.188 Test Acc: 0.288
Validation loss decreased (-0.287029 --> -0.288203).  Saving model ...
Epoch: 11 cost time: 0.722618818283081
Epoch: 11, Steps: 10 | Train Loss: 0.163 Vali Loss: 3.159 Vali Acc: 0.293 Test Loss: 3.159 Test Acc: 0.293
Validation loss decreased (-0.288203 --> -0.292910).  Saving model ...
Epoch: 12 cost time: 0.7592098712921143
Epoch: 12, Steps: 10 | Train Loss: 0.149 Vali Loss: 3.212 Vali Acc: 0.306 Test Loss: 3.212 Test Acc: 0.306
Validation loss decreased (-0.292910 --> -0.305850).  Saving model ...
Epoch: 13 cost time: 0.9327630996704102
Epoch: 13, Steps: 10 | Train Loss: 0.106 Vali Loss: 3.202 Vali Acc: 0.306 Test Loss: 3.202 Test Acc: 0.306
Validation loss decreased (-0.305850 --> -0.305850).  Saving model ...
Epoch: 14 cost time: 0.9703230857849121
Epoch: 14, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.387 Vali Acc: 0.318 Test Loss: 3.387 Test Acc: 0.318
Validation loss decreased (-0.305850 --> -0.317613).  Saving model ...
Epoch: 15 cost time: 0.9891972541809082
Epoch: 15, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.246 Vali Acc: 0.333 Test Loss: 3.246 Test Acc: 0.333
Validation loss decreased (-0.317613 --> -0.332909).  Saving model ...
Epoch: 16 cost time: 0.9135341644287109
Epoch: 16, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.358 Vali Acc: 0.327 Test Loss: 3.358 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9834849834442139
Epoch: 17, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.463 Vali Acc: 0.296 Test Loss: 3.463 Test Acc: 0.296
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0291707515716553
Epoch: 18, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.363 Vali Acc: 0.328 Test Loss: 3.363 Test Acc: 0.328
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9951376914978027
Epoch: 19, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.480 Vali Acc: 0.324 Test Loss: 3.480 Test Acc: 0.324
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9404499530792236
Epoch: 20, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.394 Vali Acc: 0.334 Test Loss: 3.394 Test Acc: 0.334
Validation loss decreased (-0.332909 --> -0.334084).  Saving model ...
Epoch: 21 cost time: 0.8815703392028809
Epoch: 21, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.417 Vali Acc: 0.335 Test Loss: 3.417 Test Acc: 0.335
Validation loss decreased (-0.334084 --> -0.335260).  Saving model ...
Epoch: 22 cost time: 0.8417246341705322
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.415 Vali Acc: 0.327 Test Loss: 3.415 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.895951509475708
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.433 Vali Acc: 0.341 Test Loss: 3.433 Test Acc: 0.341
Validation loss decreased (-0.335260 --> -0.341142).  Saving model ...
Epoch: 24 cost time: 0.8936007022857666
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.444 Vali Acc: 0.348 Test Loss: 3.444 Test Acc: 0.348
Validation loss decreased (-0.341142 --> -0.348201).  Saving model ...
Epoch: 25 cost time: 0.9596889019012451
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.440 Vali Acc: 0.351 Test Loss: 3.440 Test Acc: 0.351
Validation loss decreased (-0.348201 --> -0.350554).  Saving model ...
Epoch: 26 cost time: 0.93357253074646
Epoch: 26, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.453 Vali Acc: 0.348 Test Loss: 3.453 Test Acc: 0.348
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9602985382080078
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.716 Vali Acc: 0.306 Test Loss: 3.716 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.00950026512146
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.680 Vali Acc: 0.316 Test Loss: 3.680 Test Acc: 0.316
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.987391471862793
Epoch: 29, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.545 Vali Acc: 0.332 Test Loss: 3.545 Test Acc: 0.332
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.9815711975097656
Epoch: 30, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.642 Vali Acc: 0.311 Test Loss: 3.642 Test Acc: 0.311
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.35058823529411764
model parameter : 3007962
model size : 12.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.607347249984741
Epoch: 1, Steps: 10 | Train Loss: 3.275 Vali Loss: 3.277 Vali Acc: 0.042 Test Loss: 3.277 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 1.295494794845581
Epoch: 2, Steps: 10 | Train Loss: 3.026 Vali Loss: 3.303 Vali Acc: 0.085 Test Loss: 3.303 Test Acc: 0.085
Validation loss decreased (-0.042320 --> -0.084673).  Saving model ...
Epoch: 3 cost time: 1.3015177249908447
Epoch: 3, Steps: 10 | Train Loss: 2.691 Vali Loss: 3.253 Vali Acc: 0.112 Test Loss: 3.253 Test Acc: 0.112
Validation loss decreased (-0.084673 --> -0.111732).  Saving model ...
Epoch: 4 cost time: 1.462921142578125
Epoch: 4, Steps: 10 | Train Loss: 2.149 Vali Loss: 3.110 Vali Acc: 0.187 Test Loss: 3.110 Test Acc: 0.187
Validation loss decreased (-0.111732 --> -0.187028).  Saving model ...
Epoch: 5 cost time: 1.3686623573303223
Epoch: 5, Steps: 10 | Train Loss: 1.693 Vali Loss: 3.131 Vali Acc: 0.195 Test Loss: 3.131 Test Acc: 0.195
Validation loss decreased (-0.187028 --> -0.195263).  Saving model ...
Epoch: 6 cost time: 1.2408697605133057
Epoch: 6, Steps: 10 | Train Loss: 1.119 Vali Loss: 3.100 Vali Acc: 0.229 Test Loss: 3.100 Test Acc: 0.229
Validation loss decreased (-0.195263 --> -0.229381).  Saving model ...
Epoch: 7 cost time: 1.2604188919067383
Epoch: 7, Steps: 10 | Train Loss: 0.850 Vali Loss: 3.126 Vali Acc: 0.255 Test Loss: 3.126 Test Acc: 0.255
Validation loss decreased (-0.229381 --> -0.255263).  Saving model ...
Epoch: 8 cost time: 1.1944162845611572
Epoch: 8, Steps: 10 | Train Loss: 0.522 Vali Loss: 3.122 Vali Acc: 0.275 Test Loss: 3.122 Test Acc: 0.275
Validation loss decreased (-0.255263 --> -0.275263).  Saving model ...
Epoch: 9 cost time: 1.2594997882843018
Epoch: 9, Steps: 10 | Train Loss: 0.470 Vali Loss: 3.139 Vali Acc: 0.309 Test Loss: 3.139 Test Acc: 0.309
Validation loss decreased (-0.275263 --> -0.309380).  Saving model ...
Epoch: 10 cost time: 1.1184382438659668
Epoch: 10, Steps: 10 | Train Loss: 0.235 Vali Loss: 3.135 Vali Acc: 0.311 Test Loss: 3.135 Test Acc: 0.311
Validation loss decreased (-0.309380 --> -0.310557).  Saving model ...
Epoch: 11 cost time: 1.1392779350280762
Epoch: 11, Steps: 10 | Train Loss: 0.122 Vali Loss: 3.120 Vali Acc: 0.329 Test Loss: 3.120 Test Acc: 0.329
Validation loss decreased (-0.310557 --> -0.329381).  Saving model ...
Epoch: 12 cost time: 1.1367995738983154
Epoch: 12, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.352 Vali Acc: 0.296 Test Loss: 3.352 Test Acc: 0.296
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1196210384368896
Epoch: 13, Steps: 10 | Train Loss: 0.104 Vali Loss: 3.292 Vali Acc: 0.307 Test Loss: 3.292 Test Acc: 0.307
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1121220588684082
Epoch: 14, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.310 Vali Acc: 0.308 Test Loss: 3.310 Test Acc: 0.308
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2734100818634033
Epoch: 15, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.294 Vali Acc: 0.325 Test Loss: 3.294 Test Acc: 0.325
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2382030487060547
Epoch: 16, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.459 Vali Acc: 0.295 Test Loss: 3.459 Test Acc: 0.295
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.229003667831421
Epoch: 17, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.509 Vali Acc: 0.315 Test Loss: 3.509 Test Acc: 0.315
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.313460111618042
Epoch: 18, Steps: 10 | Train Loss: 0.067 Vali Loss: 3.499 Vali Acc: 0.332 Test Loss: 3.499 Test Acc: 0.332
Validation loss decreased (-0.329381 --> -0.331730).  Saving model ...
Epoch: 19 cost time: 1.2728638648986816
Epoch: 19, Steps: 10 | Train Loss: 0.061 Vali Loss: 3.511 Vali Acc: 0.338 Test Loss: 3.511 Test Acc: 0.338
Validation loss decreased (-0.331730 --> -0.337612).  Saving model ...
Epoch: 20 cost time: 1.2154138088226318
Epoch: 20, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.493 Vali Acc: 0.340 Test Loss: 3.493 Test Acc: 0.340
Validation loss decreased (-0.337612 --> -0.339965).  Saving model ...
Epoch: 21 cost time: 1.1350288391113281
Epoch: 21, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.538 Vali Acc: 0.338 Test Loss: 3.538 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1388003826141357
Epoch: 22, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.460 Vali Acc: 0.345 Test Loss: 3.460 Test Acc: 0.345
Validation loss decreased (-0.339965 --> -0.344671).  Saving model ...
Epoch: 23 cost time: 0.9454965591430664
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.517 Vali Acc: 0.334 Test Loss: 3.517 Test Acc: 0.334
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0821213722229004
Epoch: 24, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.483 Vali Acc: 0.346 Test Loss: 3.483 Test Acc: 0.346
Validation loss decreased (-0.344671 --> -0.345848).  Saving model ...
Epoch: 25 cost time: 1.0955967903137207
Epoch: 25, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.588 Vali Acc: 0.334 Test Loss: 3.588 Test Acc: 0.334
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2241027355194092
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.900 Vali Acc: 0.308 Test Loss: 3.900 Test Acc: 0.308
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.2452633380889893
Epoch: 27, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.555 Vali Acc: 0.338 Test Loss: 3.555 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.2355587482452393
Epoch: 28, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.684 Vali Acc: 0.302 Test Loss: 3.684 Test Acc: 0.302
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.292583703994751
Epoch: 29, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.920 Vali Acc: 0.316 Test Loss: 3.920 Test Acc: 0.316
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.2252404689788818
Epoch: 30, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.064 Vali Acc: 0.288 Test Loss: 4.064 Test Acc: 0.288
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3458823529411765
model parameter : 9627866
model size : 37.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.0710434913635254
Epoch: 1, Steps: 10 | Train Loss: 3.314 Vali Loss: 3.290 Vali Acc: 0.035 Test Loss: 3.290 Test Acc: 0.035
Validation loss decreased (inf --> -0.035261).  Saving model ...
Epoch: 2 cost time: 0.7837021350860596
Epoch: 2, Steps: 10 | Train Loss: 3.086 Vali Loss: 3.290 Vali Acc: 0.074 Test Loss: 3.290 Test Acc: 0.074
Validation loss decreased (-0.035261 --> -0.074085).  Saving model ...
Epoch: 3 cost time: 0.755117654800415
Epoch: 3, Steps: 10 | Train Loss: 2.682 Vali Loss: 3.242 Vali Acc: 0.113 Test Loss: 3.242 Test Acc: 0.113
Validation loss decreased (-0.074085 --> -0.112909).  Saving model ...
Epoch: 4 cost time: 0.8932650089263916
Epoch: 4, Steps: 10 | Train Loss: 2.258 Vali Loss: 3.136 Vali Acc: 0.159 Test Loss: 3.136 Test Acc: 0.159
Validation loss decreased (-0.112909 --> -0.158792).  Saving model ...
Epoch: 5 cost time: 0.9188282489776611
Epoch: 5, Steps: 10 | Train Loss: 1.769 Vali Loss: 3.053 Vali Acc: 0.178 Test Loss: 3.053 Test Acc: 0.178
Validation loss decreased (-0.158792 --> -0.177617).  Saving model ...
Epoch: 6 cost time: 0.7244079113006592
Epoch: 6, Steps: 10 | Train Loss: 1.363 Vali Loss: 3.035 Vali Acc: 0.211 Test Loss: 3.035 Test Acc: 0.211
Validation loss decreased (-0.177617 --> -0.210558).  Saving model ...
Epoch: 7 cost time: 0.7927539348602295
Epoch: 7, Steps: 10 | Train Loss: 0.903 Vali Loss: 3.113 Vali Acc: 0.225 Test Loss: 3.113 Test Acc: 0.225
Validation loss decreased (-0.210558 --> -0.224675).  Saving model ...
Epoch: 8 cost time: 0.727853536605835
Epoch: 8, Steps: 10 | Train Loss: 0.467 Vali Loss: 3.079 Vali Acc: 0.255 Test Loss: 3.079 Test Acc: 0.255
Validation loss decreased (-0.224675 --> -0.255263).  Saving model ...
Epoch: 9 cost time: 0.7830016613006592
Epoch: 9, Steps: 10 | Train Loss: 0.465 Vali Loss: 3.052 Vali Acc: 0.268 Test Loss: 3.052 Test Acc: 0.268
Validation loss decreased (-0.255263 --> -0.268205).  Saving model ...
Epoch: 10 cost time: 0.7997138500213623
Epoch: 10, Steps: 10 | Train Loss: 0.340 Vali Loss: 3.125 Vali Acc: 0.287 Test Loss: 3.125 Test Acc: 0.287
Validation loss decreased (-0.268205 --> -0.287028).  Saving model ...
Epoch: 11 cost time: 0.7592604160308838
Epoch: 11, Steps: 10 | Train Loss: 0.211 Vali Loss: 3.100 Vali Acc: 0.308 Test Loss: 3.100 Test Acc: 0.308
Validation loss decreased (-0.287028 --> -0.308204).  Saving model ...
Epoch: 12 cost time: 0.7013871669769287
Epoch: 12, Steps: 10 | Train Loss: 0.140 Vali Loss: 3.222 Vali Acc: 0.319 Test Loss: 3.222 Test Acc: 0.319
Validation loss decreased (-0.308204 --> -0.318791).  Saving model ...
Epoch: 13 cost time: 0.6391944885253906
Epoch: 13, Steps: 10 | Train Loss: 0.102 Vali Loss: 3.207 Vali Acc: 0.322 Test Loss: 3.207 Test Acc: 0.322
Validation loss decreased (-0.318791 --> -0.322321).  Saving model ...
Epoch: 14 cost time: 0.6864655017852783
Epoch: 14, Steps: 10 | Train Loss: 0.135 Vali Loss: 3.254 Vali Acc: 0.311 Test Loss: 3.254 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7609255313873291
Epoch: 15, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.238 Vali Acc: 0.316 Test Loss: 3.238 Test Acc: 0.316
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6563992500305176
Epoch: 16, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.269 Vali Acc: 0.312 Test Loss: 3.269 Test Acc: 0.312
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6920239925384521
Epoch: 17, Steps: 10 | Train Loss: 0.092 Vali Loss: 3.254 Vali Acc: 0.324 Test Loss: 3.254 Test Acc: 0.324
Validation loss decreased (-0.322321 --> -0.323497).  Saving model ...
Epoch: 18 cost time: 0.6695139408111572
Epoch: 18, Steps: 10 | Train Loss: 0.043 Vali Loss: 3.464 Vali Acc: 0.304 Test Loss: 3.464 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5805714130401611
Epoch: 19, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.516 Vali Acc: 0.326 Test Loss: 3.516 Test Acc: 0.326
Validation loss decreased (-0.323497 --> -0.325847).  Saving model ...
Epoch: 20 cost time: 0.8531942367553711
Epoch: 20, Steps: 10 | Train Loss: 0.073 Vali Loss: 3.563 Vali Acc: 0.314 Test Loss: 3.563 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8117256164550781
Epoch: 21, Steps: 10 | Train Loss: 0.056 Vali Loss: 3.508 Vali Acc: 0.319 Test Loss: 3.508 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7234704494476318
Epoch: 22, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.464 Vali Acc: 0.332 Test Loss: 3.464 Test Acc: 0.332
Validation loss decreased (-0.325847 --> -0.331730).  Saving model ...
Epoch: 23 cost time: 0.8028304576873779
Epoch: 23, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.549 Vali Acc: 0.326 Test Loss: 3.549 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.770341157913208
Epoch: 24, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.596 Vali Acc: 0.326 Test Loss: 3.596 Test Acc: 0.326
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7853732109069824
Epoch: 25, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.579 Vali Acc: 0.327 Test Loss: 3.579 Test Acc: 0.327
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7534945011138916
Epoch: 26, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.572 Vali Acc: 0.318 Test Loss: 3.572 Test Acc: 0.318
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.733665943145752
Epoch: 27, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.727 Vali Acc: 0.301 Test Loss: 3.727 Test Acc: 0.301
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.7295739650726318
Epoch: 28, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.771 Vali Acc: 0.298 Test Loss: 3.771 Test Acc: 0.298
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.7298579216003418
Epoch: 29, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.722 Vali Acc: 0.331 Test Loss: 3.722 Test Acc: 0.331
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.6480197906494141
Epoch: 30, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.780 Vali Acc: 0.322 Test Loss: 3.780 Test Acc: 0.322
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.33176470588235296
model parameter : 3007962
model size : 12.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.1068217754364014
Epoch: 1, Steps: 10 | Train Loss: 3.322 Vali Loss: 3.277 Vali Acc: 0.051 Test Loss: 3.277 Test Acc: 0.051
Validation loss decreased (inf --> -0.050555).  Saving model ...
Epoch: 2 cost time: 2.0038650035858154
Epoch: 2, Steps: 10 | Train Loss: 3.056 Vali Loss: 3.298 Vali Acc: 0.074 Test Loss: 3.298 Test Acc: 0.074
Validation loss decreased (-0.050555 --> -0.074085).  Saving model ...
Epoch: 3 cost time: 1.9420812129974365
Epoch: 3, Steps: 10 | Train Loss: 2.717 Vali Loss: 3.242 Vali Acc: 0.140 Test Loss: 3.242 Test Acc: 0.140
Validation loss decreased (-0.074085 --> -0.139968).  Saving model ...
Epoch: 4 cost time: 2.0047290325164795
Epoch: 4, Steps: 10 | Train Loss: 2.249 Vali Loss: 3.107 Vali Acc: 0.151 Test Loss: 3.107 Test Acc: 0.151
Validation loss decreased (-0.139968 --> -0.150557).  Saving model ...
Epoch: 5 cost time: 1.7320780754089355
Epoch: 5, Steps: 10 | Train Loss: 1.736 Vali Loss: 3.048 Vali Acc: 0.181 Test Loss: 3.048 Test Acc: 0.181
Validation loss decreased (-0.150557 --> -0.181146).  Saving model ...
Epoch: 6 cost time: 1.7632989883422852
Epoch: 6, Steps: 10 | Train Loss: 1.243 Vali Loss: 3.006 Vali Acc: 0.221 Test Loss: 3.006 Test Acc: 0.221
Validation loss decreased (-0.181146 --> -0.221146).  Saving model ...
Epoch: 7 cost time: 1.7665817737579346
Epoch: 7, Steps: 10 | Train Loss: 0.784 Vali Loss: 3.000 Vali Acc: 0.238 Test Loss: 3.000 Test Acc: 0.238
Validation loss decreased (-0.221146 --> -0.237617).  Saving model ...
Epoch: 8 cost time: 1.6241028308868408
Epoch: 8, Steps: 10 | Train Loss: 0.460 Vali Loss: 2.979 Vali Acc: 0.279 Test Loss: 2.979 Test Acc: 0.279
Validation loss decreased (-0.237617 --> -0.278794).  Saving model ...
Epoch: 9 cost time: 1.964958906173706
Epoch: 9, Steps: 10 | Train Loss: 0.305 Vali Loss: 3.060 Vali Acc: 0.287 Test Loss: 3.060 Test Acc: 0.287
Validation loss decreased (-0.278794 --> -0.287028).  Saving model ...
Epoch: 10 cost time: 1.9877002239227295
Epoch: 10, Steps: 10 | Train Loss: 0.162 Vali Loss: 3.232 Vali Acc: 0.276 Test Loss: 3.232 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.933173656463623
Epoch: 11, Steps: 10 | Train Loss: 0.111 Vali Loss: 3.165 Vali Acc: 0.295 Test Loss: 3.165 Test Acc: 0.295
Validation loss decreased (-0.287028 --> -0.295262).  Saving model ...
Epoch: 12 cost time: 1.9691226482391357
Epoch: 12, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.253 Vali Acc: 0.289 Test Loss: 3.253 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7664172649383545
Epoch: 13, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.149 Vali Acc: 0.327 Test Loss: 3.149 Test Acc: 0.327
Validation loss decreased (-0.295262 --> -0.327027).  Saving model ...
Epoch: 14 cost time: 1.7165889739990234
Epoch: 14, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.272 Vali Acc: 0.312 Test Loss: 3.272 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8427174091339111
Epoch: 15, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.276 Vali Acc: 0.331 Test Loss: 3.276 Test Acc: 0.331
Validation loss decreased (-0.327027 --> -0.330555).  Saving model ...
Epoch: 16 cost time: 2.0005288124084473
Epoch: 16, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.287 Vali Acc: 0.329 Test Loss: 3.287 Test Acc: 0.329
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9442834854125977
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.251 Vali Acc: 0.327 Test Loss: 3.251 Test Acc: 0.327
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.0386576652526855
Epoch: 18, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.244 Vali Acc: 0.333 Test Loss: 3.244 Test Acc: 0.333
Validation loss decreased (-0.330555 --> -0.332909).  Saving model ...
Epoch: 19 cost time: 1.982738733291626
Epoch: 19, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.342 Vali Acc: 0.321 Test Loss: 3.342 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.9778084754943848
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.351 Vali Acc: 0.331 Test Loss: 3.351 Test Acc: 0.331
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.769998550415039
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.302 Vali Acc: 0.329 Test Loss: 3.302 Test Acc: 0.329
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.7497467994689941
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.333 Vali Acc: 0.332 Test Loss: 3.333 Test Acc: 0.332
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.7599129676818848
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.334 Vali Acc: 0.336 Test Loss: 3.334 Test Acc: 0.336
Validation loss decreased (-0.332909 --> -0.336437).  Saving model ...
Epoch: 24 cost time: 1.9337279796600342
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.359 Vali Acc: 0.333 Test Loss: 3.359 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.0032799243927
Epoch: 25, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.400 Vali Acc: 0.335 Test Loss: 3.400 Test Acc: 0.335
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.9412577152252197
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.578 Vali Acc: 0.335 Test Loss: 3.578 Test Acc: 0.335
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.8637878894805908
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.510 Vali Acc: 0.325 Test Loss: 3.510 Test Acc: 0.325
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.6480460166931152
Epoch: 28, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.427 Vali Acc: 0.324 Test Loss: 3.427 Test Acc: 0.324
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.7583589553833008
Epoch: 29, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.439 Vali Acc: 0.324 Test Loss: 3.439 Test Acc: 0.324
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.7576820850372314
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.528 Vali Acc: 0.313 Test Loss: 3.528 Test Acc: 0.313
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.33647058823529413
model parameter : 4941274
model size : 20.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.300823450088501
Epoch: 1, Steps: 10 | Train Loss: 3.339 Vali Loss: 3.289 Vali Acc: 0.053 Test Loss: 3.289 Test Acc: 0.053
Validation loss decreased (inf --> -0.052908).  Saving model ...
Epoch: 2 cost time: 0.969456672668457
Epoch: 2, Steps: 10 | Train Loss: 3.077 Vali Loss: 3.301 Vali Acc: 0.085 Test Loss: 3.301 Test Acc: 0.085
Validation loss decreased (-0.052908 --> -0.084673).  Saving model ...
Epoch: 3 cost time: 1.143998146057129
Epoch: 3, Steps: 10 | Train Loss: 2.730 Vali Loss: 3.230 Vali Acc: 0.133 Test Loss: 3.230 Test Acc: 0.133
Validation loss decreased (-0.084673 --> -0.132909).  Saving model ...
Epoch: 4 cost time: 0.9955465793609619
Epoch: 4, Steps: 10 | Train Loss: 2.271 Vali Loss: 3.118 Vali Acc: 0.178 Test Loss: 3.118 Test Acc: 0.178
Validation loss decreased (-0.132909 --> -0.177616).  Saving model ...
Epoch: 5 cost time: 1.0102722644805908
Epoch: 5, Steps: 10 | Train Loss: 1.760 Vali Loss: 3.047 Vali Acc: 0.192 Test Loss: 3.047 Test Acc: 0.192
Validation loss decreased (-0.177616 --> -0.191734).  Saving model ...
Epoch: 6 cost time: 0.8327796459197998
Epoch: 6, Steps: 10 | Train Loss: 1.274 Vali Loss: 2.986 Vali Acc: 0.216 Test Loss: 2.986 Test Acc: 0.216
Validation loss decreased (-0.191734 --> -0.216441).  Saving model ...
Epoch: 7 cost time: 0.925100564956665
Epoch: 7, Steps: 10 | Train Loss: 0.856 Vali Loss: 3.010 Vali Acc: 0.234 Test Loss: 3.010 Test Acc: 0.234
Validation loss decreased (-0.216441 --> -0.234088).  Saving model ...
Epoch: 8 cost time: 0.938828706741333
Epoch: 8, Steps: 10 | Train Loss: 0.496 Vali Loss: 2.994 Vali Acc: 0.274 Test Loss: 2.994 Test Acc: 0.274
Validation loss decreased (-0.234088 --> -0.274088).  Saving model ...
Epoch: 9 cost time: 0.9883577823638916
Epoch: 9, Steps: 10 | Train Loss: 0.302 Vali Loss: 3.059 Vali Acc: 0.293 Test Loss: 3.059 Test Acc: 0.293
Validation loss decreased (-0.274088 --> -0.292911).  Saving model ...
Epoch: 10 cost time: 0.9627389907836914
Epoch: 10, Steps: 10 | Train Loss: 0.134 Vali Loss: 3.057 Vali Acc: 0.311 Test Loss: 3.057 Test Acc: 0.311
Validation loss decreased (-0.292911 --> -0.310558).  Saving model ...
Epoch: 11 cost time: 0.9953501224517822
Epoch: 11, Steps: 10 | Train Loss: 0.137 Vali Loss: 3.215 Vali Acc: 0.307 Test Loss: 3.215 Test Acc: 0.307
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.028029203414917
Epoch: 12, Steps: 10 | Train Loss: 0.081 Vali Loss: 3.230 Vali Acc: 0.312 Test Loss: 3.230 Test Acc: 0.312
Validation loss decreased (-0.310558 --> -0.311732).  Saving model ...
Epoch: 13 cost time: 1.0961687564849854
Epoch: 13, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.278 Vali Acc: 0.312 Test Loss: 3.278 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.030968427658081
Epoch: 14, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.239 Vali Acc: 0.329 Test Loss: 3.239 Test Acc: 0.329
Validation loss decreased (-0.311732 --> -0.329379).  Saving model ...
Epoch: 15 cost time: 1.0788488388061523
Epoch: 15, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.237 Vali Acc: 0.326 Test Loss: 3.237 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.050870656967163
Epoch: 16, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.275 Vali Acc: 0.327 Test Loss: 3.275 Test Acc: 0.327
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0489487648010254
Epoch: 17, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.361 Vali Acc: 0.321 Test Loss: 3.361 Test Acc: 0.321
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.885028600692749
Epoch: 18, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.417 Vali Acc: 0.314 Test Loss: 3.417 Test Acc: 0.314
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9386987686157227
Epoch: 19, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.419 Vali Acc: 0.326 Test Loss: 3.419 Test Acc: 0.326
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.9824912548065186
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.383 Vali Acc: 0.333 Test Loss: 3.383 Test Acc: 0.333
Validation loss decreased (-0.329379 --> -0.332907).  Saving model ...
Epoch: 21 cost time: 0.9765603542327881
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.397 Vali Acc: 0.344 Test Loss: 3.397 Test Acc: 0.344
Validation loss decreased (-0.332907 --> -0.343495).  Saving model ...
Epoch: 22 cost time: 0.9509789943695068
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.422 Vali Acc: 0.342 Test Loss: 3.422 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7935078144073486
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.389 Vali Acc: 0.336 Test Loss: 3.389 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1292941570281982
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.401 Vali Acc: 0.344 Test Loss: 3.401 Test Acc: 0.344
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0794103145599365
Epoch: 25, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.465 Vali Acc: 0.325 Test Loss: 3.465 Test Acc: 0.325
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.0286197662353516
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.329 Vali Acc: 0.329 Test Loss: 3.329 Test Acc: 0.329
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.1040334701538086
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.408 Vali Acc: 0.344 Test Loss: 3.408 Test Acc: 0.344
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.0700249671936035
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.517 Vali Acc: 0.341 Test Loss: 3.517 Test Acc: 0.341
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.0375075340270996
Epoch: 29, Steps: 10 | Train Loss: 0.097 Vali Loss: 3.461 Vali Acc: 0.339 Test Loss: 3.461 Test Acc: 0.339
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.0367250442504883
Epoch: 30, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.477 Vali Acc: 0.336 Test Loss: 3.477 Test Acc: 0.336
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.34352941176470586
model parameter : 1631194
model size : 7.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.8197031021118164
Epoch: 1, Steps: 10 | Train Loss: 3.329 Vali Loss: 3.274 Vali Acc: 0.060 Test Loss: 3.274 Test Acc: 0.060
Validation loss decreased (inf --> -0.059967).  Saving model ...
Epoch: 2 cost time: 1.4491081237792969
Epoch: 2, Steps: 10 | Train Loss: 3.061 Vali Loss: 3.300 Vali Acc: 0.086 Test Loss: 3.300 Test Acc: 0.086
Validation loss decreased (-0.059967 --> -0.085849).  Saving model ...
Epoch: 3 cost time: 1.5335667133331299
Epoch: 3, Steps: 10 | Train Loss: 2.742 Vali Loss: 3.250 Vali Acc: 0.136 Test Loss: 3.250 Test Acc: 0.136
Validation loss decreased (-0.085849 --> -0.136438).  Saving model ...
Epoch: 4 cost time: 1.4511964321136475
Epoch: 4, Steps: 10 | Train Loss: 2.311 Vali Loss: 3.126 Vali Acc: 0.151 Test Loss: 3.126 Test Acc: 0.151
Validation loss decreased (-0.136438 --> -0.150557).  Saving model ...
Epoch: 5 cost time: 1.5838265419006348
Epoch: 5, Steps: 10 | Train Loss: 1.873 Vali Loss: 3.065 Vali Acc: 0.179 Test Loss: 3.065 Test Acc: 0.179
Validation loss decreased (-0.150557 --> -0.178793).  Saving model ...
Epoch: 6 cost time: 1.5067691802978516
Epoch: 6, Steps: 10 | Train Loss: 1.315 Vali Loss: 3.010 Vali Acc: 0.226 Test Loss: 3.010 Test Acc: 0.226
Validation loss decreased (-0.178793 --> -0.225852).  Saving model ...
Epoch: 7 cost time: 1.337705373764038
Epoch: 7, Steps: 10 | Train Loss: 1.041 Vali Loss: 3.100 Vali Acc: 0.231 Test Loss: 3.100 Test Acc: 0.231
Validation loss decreased (-0.225852 --> -0.230557).  Saving model ...
Epoch: 8 cost time: 1.3254165649414062
Epoch: 8, Steps: 10 | Train Loss: 0.829 Vali Loss: 3.029 Vali Acc: 0.260 Test Loss: 3.029 Test Acc: 0.260
Validation loss decreased (-0.230557 --> -0.259970).  Saving model ...
Epoch: 9 cost time: 1.3386616706848145
Epoch: 9, Steps: 10 | Train Loss: 0.413 Vali Loss: 3.055 Vali Acc: 0.280 Test Loss: 3.055 Test Acc: 0.280
Validation loss decreased (-0.259970 --> -0.279969).  Saving model ...
Epoch: 10 cost time: 1.3187870979309082
Epoch: 10, Steps: 10 | Train Loss: 0.233 Vali Loss: 3.141 Vali Acc: 0.282 Test Loss: 3.141 Test Acc: 0.282
Validation loss decreased (-0.279969 --> -0.282322).  Saving model ...
Epoch: 11 cost time: 1.3264873027801514
Epoch: 11, Steps: 10 | Train Loss: 0.118 Vali Loss: 3.219 Vali Acc: 0.287 Test Loss: 3.219 Test Acc: 0.287
Validation loss decreased (-0.282322 --> -0.287027).  Saving model ...
Epoch: 12 cost time: 1.3292386531829834
Epoch: 12, Steps: 10 | Train Loss: 0.075 Vali Loss: 3.291 Vali Acc: 0.300 Test Loss: 3.291 Test Acc: 0.300
Validation loss decreased (-0.287027 --> -0.299967).  Saving model ...
Epoch: 13 cost time: 0.9871697425842285
Epoch: 13, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.287 Vali Acc: 0.306 Test Loss: 3.287 Test Acc: 0.306
Validation loss decreased (-0.299967 --> -0.305849).  Saving model ...
Epoch: 14 cost time: 1.0612828731536865
Epoch: 14, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.431 Vali Acc: 0.311 Test Loss: 3.431 Test Acc: 0.311
Validation loss decreased (-0.305849 --> -0.310554).  Saving model ...
Epoch: 15 cost time: 1.0356740951538086
Epoch: 15, Steps: 10 | Train Loss: 0.061 Vali Loss: 3.411 Vali Acc: 0.319 Test Loss: 3.411 Test Acc: 0.319
Validation loss decreased (-0.310554 --> -0.318789).  Saving model ...
Epoch: 16 cost time: 1.0161142349243164
Epoch: 16, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.480 Vali Acc: 0.313 Test Loss: 3.480 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0537776947021484
Epoch: 17, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.509 Vali Acc: 0.305 Test Loss: 3.509 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3036041259765625
Epoch: 18, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.320 Vali Acc: 0.329 Test Loss: 3.320 Test Acc: 0.329
Validation loss decreased (-0.318789 --> -0.329379).  Saving model ...
Epoch: 19 cost time: 1.2616510391235352
Epoch: 19, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.478 Vali Acc: 0.313 Test Loss: 3.478 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1991991996765137
Epoch: 20, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.452 Vali Acc: 0.305 Test Loss: 3.452 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2220869064331055
Epoch: 21, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.469 Vali Acc: 0.309 Test Loss: 3.469 Test Acc: 0.309
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0532646179199219
Epoch: 22, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.470 Vali Acc: 0.332 Test Loss: 3.470 Test Acc: 0.332
Validation loss decreased (-0.329379 --> -0.331730).  Saving model ...
Epoch: 23 cost time: 1.1623032093048096
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.501 Vali Acc: 0.328 Test Loss: 3.501 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1047589778900146
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.512 Vali Acc: 0.332 Test Loss: 3.512 Test Acc: 0.332
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.142455816268921
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.506 Vali Acc: 0.327 Test Loss: 3.506 Test Acc: 0.327
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.2214133739471436
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.497 Vali Acc: 0.329 Test Loss: 3.497 Test Acc: 0.329
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.2622261047363281
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.518 Vali Acc: 0.328 Test Loss: 3.518 Test Acc: 0.328
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.3535804748535156
Epoch: 28, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.516 Vali Acc: 0.334 Test Loss: 3.516 Test Acc: 0.334
Validation loss decreased (-0.331730 --> -0.334082).  Saving model ...
Epoch: 29 cost time: 1.2557804584503174
Epoch: 29, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.596 Vali Acc: 0.320 Test Loss: 3.596 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1789047718048096
Epoch: 30, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.689 Vali Acc: 0.294 Test Loss: 3.689 Test Acc: 0.294
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3341176470588235
model parameter : 4941274
model size : 20.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.9667584896087646
Epoch: 1, Steps: 10 | Train Loss: 3.329 Vali Loss: 3.290 Vali Acc: 0.062 Test Loss: 3.290 Test Acc: 0.062
Validation loss decreased (inf --> -0.062320).  Saving model ...
Epoch: 2 cost time: 0.7885043621063232
Epoch: 2, Steps: 10 | Train Loss: 3.093 Vali Loss: 3.303 Vali Acc: 0.082 Test Loss: 3.303 Test Acc: 0.082
Validation loss decreased (-0.062320 --> -0.082320).  Saving model ...
Epoch: 3 cost time: 0.7854304313659668
Epoch: 3, Steps: 10 | Train Loss: 2.775 Vali Loss: 3.240 Vali Acc: 0.131 Test Loss: 3.240 Test Acc: 0.131
Validation loss decreased (-0.082320 --> -0.130556).  Saving model ...
Epoch: 4 cost time: 0.7385945320129395
Epoch: 4, Steps: 10 | Train Loss: 2.345 Vali Loss: 3.137 Vali Acc: 0.171 Test Loss: 3.137 Test Acc: 0.171
Validation loss decreased (-0.130556 --> -0.170557).  Saving model ...
Epoch: 5 cost time: 0.744182825088501
Epoch: 5, Steps: 10 | Train Loss: 1.874 Vali Loss: 3.073 Vali Acc: 0.186 Test Loss: 3.073 Test Acc: 0.186
Validation loss decreased (-0.170557 --> -0.185852).  Saving model ...
Epoch: 6 cost time: 0.7481381893157959
Epoch: 6, Steps: 10 | Train Loss: 1.397 Vali Loss: 3.006 Vali Acc: 0.205 Test Loss: 3.006 Test Acc: 0.205
Validation loss decreased (-0.185852 --> -0.204676).  Saving model ...
Epoch: 7 cost time: 0.7391812801361084
Epoch: 7, Steps: 10 | Train Loss: 0.998 Vali Loss: 3.012 Vali Acc: 0.239 Test Loss: 3.012 Test Acc: 0.239
Validation loss decreased (-0.204676 --> -0.238793).  Saving model ...
Epoch: 8 cost time: 0.7217855453491211
Epoch: 8, Steps: 10 | Train Loss: 0.630 Vali Loss: 3.041 Vali Acc: 0.267 Test Loss: 3.041 Test Acc: 0.267
Validation loss decreased (-0.238793 --> -0.267028).  Saving model ...
Epoch: 9 cost time: 0.7390785217285156
Epoch: 9, Steps: 10 | Train Loss: 0.430 Vali Loss: 3.062 Vali Acc: 0.281 Test Loss: 3.062 Test Acc: 0.281
Validation loss decreased (-0.267028 --> -0.281146).  Saving model ...
Epoch: 10 cost time: 0.6836419105529785
Epoch: 10, Steps: 10 | Train Loss: 0.219 Vali Loss: 3.120 Vali Acc: 0.302 Test Loss: 3.120 Test Acc: 0.302
Validation loss decreased (-0.281146 --> -0.302322).  Saving model ...
Epoch: 11 cost time: 0.6752331256866455
Epoch: 11, Steps: 10 | Train Loss: 0.172 Vali Loss: 3.196 Vali Acc: 0.304 Test Loss: 3.196 Test Acc: 0.304
Validation loss decreased (-0.302322 --> -0.303497).  Saving model ...
Epoch: 12 cost time: 0.7446620464324951
Epoch: 12, Steps: 10 | Train Loss: 0.126 Vali Loss: 3.322 Vali Acc: 0.299 Test Loss: 3.322 Test Acc: 0.299
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7326633930206299
Epoch: 13, Steps: 10 | Train Loss: 0.067 Vali Loss: 3.435 Vali Acc: 0.294 Test Loss: 3.435 Test Acc: 0.294
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.715247631072998
Epoch: 14, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.418 Vali Acc: 0.319 Test Loss: 3.418 Test Acc: 0.319
Validation loss decreased (-0.303497 --> -0.318789).  Saving model ...
Epoch: 15 cost time: 0.6846411228179932
Epoch: 15, Steps: 10 | Train Loss: 0.063 Vali Loss: 3.401 Vali Acc: 0.319 Test Loss: 3.401 Test Acc: 0.319
Validation loss decreased (-0.318789 --> -0.318790).  Saving model ...
Epoch: 16 cost time: 0.7412431240081787
Epoch: 16, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.445 Vali Acc: 0.318 Test Loss: 3.445 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7262475490570068
Epoch: 17, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.420 Vali Acc: 0.335 Test Loss: 3.420 Test Acc: 0.335
Validation loss decreased (-0.318790 --> -0.335260).  Saving model ...
Epoch: 18 cost time: 0.7565646171569824
Epoch: 18, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.457 Vali Acc: 0.340 Test Loss: 3.457 Test Acc: 0.340
Validation loss decreased (-0.335260 --> -0.339965).  Saving model ...
Epoch: 19 cost time: 0.7200345993041992
Epoch: 19, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.533 Vali Acc: 0.327 Test Loss: 3.533 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6396281719207764
Epoch: 20, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.539 Vali Acc: 0.340 Test Loss: 3.539 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6808409690856934
Epoch: 21, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.434 Vali Acc: 0.336 Test Loss: 3.434 Test Acc: 0.336
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6725156307220459
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.413 Vali Acc: 0.346 Test Loss: 3.413 Test Acc: 0.346
Validation loss decreased (-0.339965 --> -0.345848).  Saving model ...
Epoch: 23 cost time: 0.7257792949676514
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.440 Vali Acc: 0.346 Test Loss: 3.440 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.709404468536377
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.474 Vali Acc: 0.354 Test Loss: 3.474 Test Acc: 0.354
Validation loss decreased (-0.345848 --> -0.354083).  Saving model ...
Epoch: 25 cost time: 0.739431619644165
Epoch: 25, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.492 Vali Acc: 0.349 Test Loss: 3.492 Test Acc: 0.349
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7213242053985596
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.566 Vali Acc: 0.336 Test Loss: 3.566 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7368826866149902
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.550 Vali Acc: 0.354 Test Loss: 3.550 Test Acc: 0.354
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.7349214553833008
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.514 Vali Acc: 0.342 Test Loss: 3.514 Test Acc: 0.342
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.6975932121276855
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.535 Vali Acc: 0.344 Test Loss: 3.535 Test Acc: 0.344
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.8337743282318115
Epoch: 30, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.655 Vali Acc: 0.324 Test Loss: 3.655 Test Acc: 0.324
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.35411764705882354
model parameter : 1631194
model size : 7.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.2010507583618164
Epoch: 1, Steps: 10 | Train Loss: 3.317 Vali Loss: 3.275 Vali Acc: 0.055 Test Loss: 3.275 Test Acc: 0.055
Validation loss decreased (inf --> -0.055261).  Saving model ...
Epoch: 2 cost time: 0.8749990463256836
Epoch: 2, Steps: 10 | Train Loss: 3.070 Vali Loss: 3.309 Vali Acc: 0.075 Test Loss: 3.309 Test Acc: 0.075
Validation loss decreased (-0.055261 --> -0.075261).  Saving model ...
Epoch: 3 cost time: 0.9432785511016846
Epoch: 3, Steps: 10 | Train Loss: 2.795 Vali Loss: 3.274 Vali Acc: 0.109 Test Loss: 3.274 Test Acc: 0.109
Validation loss decreased (-0.075261 --> -0.109379).  Saving model ...
Epoch: 4 cost time: 0.9205772876739502
Epoch: 4, Steps: 10 | Train Loss: 2.418 Vali Loss: 3.173 Vali Acc: 0.128 Test Loss: 3.173 Test Acc: 0.128
Validation loss decreased (-0.109379 --> -0.128204).  Saving model ...
Epoch: 5 cost time: 0.957998514175415
Epoch: 5, Steps: 10 | Train Loss: 1.958 Vali Loss: 3.130 Vali Acc: 0.169 Test Loss: 3.130 Test Acc: 0.169
Validation loss decreased (-0.128204 --> -0.169380).  Saving model ...
Epoch: 6 cost time: 0.888782262802124
Epoch: 6, Steps: 10 | Train Loss: 1.488 Vali Loss: 3.110 Vali Acc: 0.186 Test Loss: 3.110 Test Acc: 0.186
Validation loss decreased (-0.169380 --> -0.185851).  Saving model ...
Epoch: 7 cost time: 0.8792808055877686
Epoch: 7, Steps: 10 | Train Loss: 1.091 Vali Loss: 3.118 Vali Acc: 0.209 Test Loss: 3.118 Test Acc: 0.209
Validation loss decreased (-0.185851 --> -0.209381).  Saving model ...
Epoch: 8 cost time: 0.8806464672088623
Epoch: 8, Steps: 10 | Train Loss: 0.775 Vali Loss: 3.080 Vali Acc: 0.261 Test Loss: 3.080 Test Acc: 0.261
Validation loss decreased (-0.209381 --> -0.261146).  Saving model ...
Epoch: 9 cost time: 0.85634446144104
Epoch: 9, Steps: 10 | Train Loss: 0.454 Vali Loss: 3.117 Vali Acc: 0.273 Test Loss: 3.117 Test Acc: 0.273
Validation loss decreased (-0.261146 --> -0.272910).  Saving model ...
Epoch: 10 cost time: 0.8235933780670166
Epoch: 10, Steps: 10 | Train Loss: 0.339 Vali Loss: 3.134 Vali Acc: 0.291 Test Loss: 3.134 Test Acc: 0.291
Validation loss decreased (-0.272910 --> -0.290557).  Saving model ...
Epoch: 11 cost time: 0.85809326171875
Epoch: 11, Steps: 10 | Train Loss: 0.155 Vali Loss: 3.183 Vali Acc: 0.304 Test Loss: 3.183 Test Acc: 0.304
Validation loss decreased (-0.290557 --> -0.303498).  Saving model ...
Epoch: 12 cost time: 0.8863861560821533
Epoch: 12, Steps: 10 | Train Loss: 0.136 Vali Loss: 3.267 Vali Acc: 0.299 Test Loss: 3.267 Test Acc: 0.299
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8605077266693115
Epoch: 13, Steps: 10 | Train Loss: 0.079 Vali Loss: 3.288 Vali Acc: 0.288 Test Loss: 3.288 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8626716136932373
Epoch: 14, Steps: 10 | Train Loss: 0.070 Vali Loss: 3.331 Vali Acc: 0.300 Test Loss: 3.331 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8454725742340088
Epoch: 15, Steps: 10 | Train Loss: 0.083 Vali Loss: 3.488 Vali Acc: 0.304 Test Loss: 3.488 Test Acc: 0.304
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8675801753997803
Epoch: 16, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.381 Vali Acc: 0.315 Test Loss: 3.381 Test Acc: 0.315
Validation loss decreased (-0.303498 --> -0.315260).  Saving model ...
Epoch: 17 cost time: 0.8164405822753906
Epoch: 17, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.439 Vali Acc: 0.318 Test Loss: 3.439 Test Acc: 0.318
Validation loss decreased (-0.315260 --> -0.317613).  Saving model ...
Epoch: 18 cost time: 0.887037992477417
Epoch: 18, Steps: 10 | Train Loss: 0.060 Vali Loss: 3.354 Vali Acc: 0.331 Test Loss: 3.354 Test Acc: 0.331
Validation loss decreased (-0.317613 --> -0.330555).  Saving model ...
Epoch: 19 cost time: 0.9064679145812988
Epoch: 19, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.478 Vali Acc: 0.315 Test Loss: 3.478 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8322386741638184
Epoch: 20, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.610 Vali Acc: 0.293 Test Loss: 3.610 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8147287368774414
Epoch: 21, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.500 Vali Acc: 0.325 Test Loss: 3.500 Test Acc: 0.325
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.831061840057373
Epoch: 22, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.466 Vali Acc: 0.312 Test Loss: 3.466 Test Acc: 0.312
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.8826296329498291
Epoch: 23, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.507 Vali Acc: 0.324 Test Loss: 3.507 Test Acc: 0.324
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.882840633392334
Epoch: 24, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.490 Vali Acc: 0.322 Test Loss: 3.490 Test Acc: 0.322
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.9326274394989014
Epoch: 25, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.507 Vali Acc: 0.321 Test Loss: 3.507 Test Acc: 0.321
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.8652098178863525
Epoch: 26, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.665 Vali Acc: 0.321 Test Loss: 3.665 Test Acc: 0.321
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.9076154232025146
Epoch: 27, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.677 Vali Acc: 0.311 Test Loss: 3.677 Test Acc: 0.311
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.0303235054016113
Epoch: 28, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.553 Vali Acc: 0.344 Test Loss: 3.553 Test Acc: 0.344
Validation loss decreased (-0.330555 --> -0.343494).  Saving model ...
Epoch: 29 cost time: 0.9092893600463867
Epoch: 29, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.612 Vali Acc: 0.332 Test Loss: 3.612 Test Acc: 0.332
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7748439311981201
Epoch: 30, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.841 Vali Acc: 0.289 Test Loss: 3.841 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.34352941176470586
model parameter : 4941274
model size : 20.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.8727591037750244
Epoch: 1, Steps: 10 | Train Loss: 3.350 Vali Loss: 3.294 Vali Acc: 0.059 Test Loss: 3.294 Test Acc: 0.059
Validation loss decreased (inf --> -0.058791).  Saving model ...
Epoch: 2 cost time: 0.5896530151367188
Epoch: 2, Steps: 10 | Train Loss: 3.110 Vali Loss: 3.312 Vali Acc: 0.079 Test Loss: 3.312 Test Acc: 0.079
Validation loss decreased (-0.058791 --> -0.078790).  Saving model ...
Epoch: 3 cost time: 0.6092002391815186
Epoch: 3, Steps: 10 | Train Loss: 2.767 Vali Loss: 3.253 Vali Acc: 0.127 Test Loss: 3.253 Test Acc: 0.127
Validation loss decreased (-0.078790 --> -0.127026).  Saving model ...
Epoch: 4 cost time: 0.5769805908203125
Epoch: 4, Steps: 10 | Train Loss: 2.361 Vali Loss: 3.159 Vali Acc: 0.166 Test Loss: 3.159 Test Acc: 0.166
Validation loss decreased (-0.127026 --> -0.165851).  Saving model ...
Epoch: 5 cost time: 0.611229658126831
Epoch: 5, Steps: 10 | Train Loss: 1.965 Vali Loss: 3.109 Vali Acc: 0.191 Test Loss: 3.109 Test Acc: 0.191
Validation loss decreased (-0.165851 --> -0.190557).  Saving model ...
Epoch: 6 cost time: 0.6025912761688232
Epoch: 6, Steps: 10 | Train Loss: 1.499 Vali Loss: 3.049 Vali Acc: 0.204 Test Loss: 3.049 Test Acc: 0.204
Validation loss decreased (-0.190557 --> -0.203499).  Saving model ...
Epoch: 7 cost time: 0.6220698356628418
Epoch: 7, Steps: 10 | Train Loss: 1.087 Vali Loss: 3.078 Vali Acc: 0.233 Test Loss: 3.078 Test Acc: 0.233
Validation loss decreased (-0.203499 --> -0.232910).  Saving model ...
Epoch: 8 cost time: 0.5720486640930176
Epoch: 8, Steps: 10 | Train Loss: 0.716 Vali Loss: 3.110 Vali Acc: 0.253 Test Loss: 3.110 Test Acc: 0.253
Validation loss decreased (-0.232910 --> -0.252910).  Saving model ...
Epoch: 9 cost time: 0.5520648956298828
Epoch: 9, Steps: 10 | Train Loss: 0.429 Vali Loss: 3.116 Vali Acc: 0.268 Test Loss: 3.116 Test Acc: 0.268
Validation loss decreased (-0.252910 --> -0.268204).  Saving model ...
Epoch: 10 cost time: 0.6069808006286621
Epoch: 10, Steps: 10 | Train Loss: 0.270 Vali Loss: 3.137 Vali Acc: 0.281 Test Loss: 3.137 Test Acc: 0.281
Validation loss decreased (-0.268204 --> -0.281145).  Saving model ...
Epoch: 11 cost time: 0.5772316455841064
Epoch: 11, Steps: 10 | Train Loss: 0.167 Vali Loss: 3.207 Vali Acc: 0.300 Test Loss: 3.207 Test Acc: 0.300
Validation loss decreased (-0.281145 --> -0.299968).  Saving model ...
Epoch: 12 cost time: 0.5517969131469727
Epoch: 12, Steps: 10 | Train Loss: 0.154 Vali Loss: 3.208 Vali Acc: 0.298 Test Loss: 3.208 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5372655391693115
Epoch: 13, Steps: 10 | Train Loss: 0.074 Vali Loss: 3.235 Vali Acc: 0.296 Test Loss: 3.235 Test Acc: 0.296
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5928421020507812
Epoch: 14, Steps: 10 | Train Loss: 0.077 Vali Loss: 3.331 Vali Acc: 0.301 Test Loss: 3.331 Test Acc: 0.301
Validation loss decreased (-0.299968 --> -0.301143).  Saving model ...
Epoch: 15 cost time: 0.5307931900024414
Epoch: 15, Steps: 10 | Train Loss: 0.102 Vali Loss: 3.338 Vali Acc: 0.311 Test Loss: 3.338 Test Acc: 0.311
Validation loss decreased (-0.301143 --> -0.310555).  Saving model ...
Epoch: 16 cost time: 0.5987813472747803
Epoch: 16, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.261 Vali Acc: 0.321 Test Loss: 3.261 Test Acc: 0.321
Validation loss decreased (-0.310555 --> -0.321144).  Saving model ...
Epoch: 17 cost time: 0.6121792793273926
Epoch: 17, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.384 Vali Acc: 0.299 Test Loss: 3.384 Test Acc: 0.299
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5299067497253418
Epoch: 18, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.446 Vali Acc: 0.319 Test Loss: 3.446 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6117184162139893
Epoch: 19, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.568 Vali Acc: 0.324 Test Loss: 3.568 Test Acc: 0.324
Validation loss decreased (-0.321144 --> -0.323494).  Saving model ...
Epoch: 20 cost time: 0.5892794132232666
Epoch: 20, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.526 Vali Acc: 0.328 Test Loss: 3.526 Test Acc: 0.328
Validation loss decreased (-0.323494 --> -0.328200).  Saving model ...
Epoch: 21 cost time: 0.5646469593048096
Epoch: 21, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.471 Vali Acc: 0.328 Test Loss: 3.471 Test Acc: 0.328
Validation loss decreased (-0.328200 --> -0.328201).  Saving model ...
Epoch: 22 cost time: 0.5606729984283447
Epoch: 22, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.559 Vali Acc: 0.327 Test Loss: 3.559 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5659346580505371
Epoch: 23, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.683 Vali Acc: 0.313 Test Loss: 3.683 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5673611164093018
Epoch: 24, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.924 Vali Acc: 0.309 Test Loss: 3.924 Test Acc: 0.309
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.6202552318572998
Epoch: 25, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.718 Vali Acc: 0.324 Test Loss: 3.718 Test Acc: 0.324
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.5166909694671631
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.730 Vali Acc: 0.315 Test Loss: 3.730 Test Acc: 0.315
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.5971755981445312
Epoch: 27, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.636 Vali Acc: 0.329 Test Loss: 3.636 Test Acc: 0.329
Validation loss decreased (-0.328201 --> -0.329375).  Saving model ...
Epoch: 28 cost time: 0.5567705631256104
Epoch: 28, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.813 Vali Acc: 0.320 Test Loss: 3.813 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5707805156707764
Epoch: 29, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.853 Vali Acc: 0.312 Test Loss: 3.853 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.5373361110687256
Epoch: 30, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.791 Vali Acc: 0.324 Test Loss: 3.791 Test Acc: 0.324
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.32941176470588235
model parameter : 1631194
model size : 7.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.0373904705047607
Epoch: 1, Steps: 10 | Train Loss: 3.307 Vali Loss: 3.280 Vali Acc: 0.054 Test Loss: 3.280 Test Acc: 0.054
Validation loss decreased (inf --> -0.054085).  Saving model ...
Epoch: 2 cost time: 1.6990418434143066
Epoch: 2, Steps: 10 | Train Loss: 3.130 Vali Loss: 3.255 Vali Acc: 0.080 Test Loss: 3.255 Test Acc: 0.080
Validation loss decreased (-0.054085 --> -0.079967).  Saving model ...
Epoch: 3 cost time: 1.52667236328125
Epoch: 3, Steps: 10 | Train Loss: 2.891 Vali Loss: 3.250 Vali Acc: 0.104 Test Loss: 3.250 Test Acc: 0.104
Validation loss decreased (-0.079967 --> -0.103497).  Saving model ...
Epoch: 4 cost time: 1.48148775100708
Epoch: 4, Steps: 10 | Train Loss: 2.550 Vali Loss: 3.165 Vali Acc: 0.154 Test Loss: 3.165 Test Acc: 0.154
Validation loss decreased (-0.103497 --> -0.154086).  Saving model ...
Epoch: 5 cost time: 1.5774517059326172
Epoch: 5, Steps: 10 | Train Loss: 2.187 Vali Loss: 3.077 Vali Acc: 0.181 Test Loss: 3.077 Test Acc: 0.181
Validation loss decreased (-0.154086 --> -0.181146).  Saving model ...
Epoch: 6 cost time: 1.7424721717834473
Epoch: 6, Steps: 10 | Train Loss: 1.777 Vali Loss: 3.045 Vali Acc: 0.182 Test Loss: 3.045 Test Acc: 0.182
Validation loss decreased (-0.181146 --> -0.182322).  Saving model ...
Epoch: 7 cost time: 1.7193989753723145
Epoch: 7, Steps: 10 | Train Loss: 1.405 Vali Loss: 3.002 Vali Acc: 0.206 Test Loss: 3.002 Test Acc: 0.206
Validation loss decreased (-0.182322 --> -0.205852).  Saving model ...
Epoch: 8 cost time: 1.6893417835235596
Epoch: 8, Steps: 10 | Train Loss: 1.110 Vali Loss: 2.988 Vali Acc: 0.215 Test Loss: 2.988 Test Acc: 0.215
Validation loss decreased (-0.205852 --> -0.215264).  Saving model ...
Epoch: 9 cost time: 1.6731395721435547
Epoch: 9, Steps: 10 | Train Loss: 0.873 Vali Loss: 2.999 Vali Acc: 0.233 Test Loss: 2.999 Test Acc: 0.233
Validation loss decreased (-0.215264 --> -0.232911).  Saving model ...
Epoch: 10 cost time: 1.4954643249511719
Epoch: 10, Steps: 10 | Train Loss: 0.576 Vali Loss: 3.038 Vali Acc: 0.248 Test Loss: 3.038 Test Acc: 0.248
Validation loss decreased (-0.232911 --> -0.248205).  Saving model ...
Epoch: 11 cost time: 1.496009349822998
Epoch: 11, Steps: 10 | Train Loss: 0.409 Vali Loss: 2.959 Vali Acc: 0.268 Test Loss: 2.959 Test Acc: 0.268
Validation loss decreased (-0.248205 --> -0.268206).  Saving model ...
Epoch: 12 cost time: 1.5144729614257812
Epoch: 12, Steps: 10 | Train Loss: 0.273 Vali Loss: 2.954 Vali Acc: 0.298 Test Loss: 2.954 Test Acc: 0.298
Validation loss decreased (-0.268206 --> -0.297618).  Saving model ...
Epoch: 13 cost time: 1.4913842678070068
Epoch: 13, Steps: 10 | Train Loss: 0.143 Vali Loss: 3.036 Vali Acc: 0.287 Test Loss: 3.036 Test Acc: 0.287
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3804404735565186
Epoch: 14, Steps: 10 | Train Loss: 0.120 Vali Loss: 3.096 Vali Acc: 0.291 Test Loss: 3.096 Test Acc: 0.291
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.279329776763916
Epoch: 15, Steps: 10 | Train Loss: 0.069 Vali Loss: 3.043 Vali Acc: 0.314 Test Loss: 3.043 Test Acc: 0.314
Validation loss decreased (-0.297618 --> -0.314087).  Saving model ...
Epoch: 16 cost time: 1.2636666297912598
Epoch: 16, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.104 Vali Acc: 0.307 Test Loss: 3.104 Test Acc: 0.307
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3325657844543457
Epoch: 17, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.011 Vali Acc: 0.315 Test Loss: 3.011 Test Acc: 0.315
Validation loss decreased (-0.314087 --> -0.315264).  Saving model ...
Epoch: 18 cost time: 1.862426996231079
Epoch: 18, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.090 Vali Acc: 0.315 Test Loss: 3.090 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8833348751068115
Epoch: 19, Steps: 10 | Train Loss: 0.056 Vali Loss: 3.075 Vali Acc: 0.321 Test Loss: 3.075 Test Acc: 0.321
Validation loss decreased (-0.315264 --> -0.321146).  Saving model ...
Epoch: 20 cost time: 1.8302862644195557
Epoch: 20, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.114 Vali Acc: 0.305 Test Loss: 3.114 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8487136363983154
Epoch: 21, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.156 Vali Acc: 0.301 Test Loss: 3.156 Test Acc: 0.301
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.682624340057373
Epoch: 22, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.127 Vali Acc: 0.313 Test Loss: 3.127 Test Acc: 0.313
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.5811679363250732
Epoch: 23, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.168 Vali Acc: 0.306 Test Loss: 3.168 Test Acc: 0.306
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.4074225425720215
Epoch: 24, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.199 Vali Acc: 0.322 Test Loss: 3.199 Test Acc: 0.322
Validation loss decreased (-0.321146 --> -0.322321).  Saving model ...
Epoch: 25 cost time: 1.8932116031646729
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.179 Vali Acc: 0.318 Test Loss: 3.179 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.9035563468933105
Epoch: 26, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.282 Vali Acc: 0.304 Test Loss: 3.282 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.8998117446899414
Epoch: 27, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.183 Vali Acc: 0.322 Test Loss: 3.183 Test Acc: 0.322
Validation loss decreased (-0.322321 --> -0.322321).  Saving model ...
Epoch: 28 cost time: 1.6192476749420166
Epoch: 28, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.306 Vali Acc: 0.325 Test Loss: 3.306 Test Acc: 0.325
Validation loss decreased (-0.322321 --> -0.324673).  Saving model ...
Epoch: 29 cost time: 1.417839765548706
Epoch: 29, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.270 Vali Acc: 0.318 Test Loss: 3.270 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.7135558128356934
Epoch: 30, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.230 Vali Acc: 0.334 Test Loss: 3.230 Test Acc: 0.334
Validation loss decreased (-0.324673 --> -0.334085).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3341176470588235
model parameter : 4814714
model size : 19.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.4918248653411865
Epoch: 1, Steps: 10 | Train Loss: 3.298 Vali Loss: 3.296 Vali Acc: 0.028 Test Loss: 3.296 Test Acc: 0.028
Validation loss decreased (inf --> -0.028202).  Saving model ...
Epoch: 2 cost time: 1.1501350402832031
Epoch: 2, Steps: 10 | Train Loss: 3.182 Vali Loss: 3.286 Vali Acc: 0.053 Test Loss: 3.286 Test Acc: 0.053
Validation loss decreased (-0.028202 --> -0.052908).  Saving model ...
Epoch: 3 cost time: 0.9717752933502197
Epoch: 3, Steps: 10 | Train Loss: 2.950 Vali Loss: 3.271 Vali Acc: 0.081 Test Loss: 3.271 Test Acc: 0.081
Validation loss decreased (-0.052908 --> -0.081144).  Saving model ...
Epoch: 4 cost time: 0.9947640895843506
Epoch: 4, Steps: 10 | Train Loss: 2.645 Vali Loss: 3.219 Vali Acc: 0.118 Test Loss: 3.219 Test Acc: 0.118
Validation loss decreased (-0.081144 --> -0.117615).  Saving model ...
Epoch: 5 cost time: 0.9565584659576416
Epoch: 5, Steps: 10 | Train Loss: 2.385 Vali Loss: 3.177 Vali Acc: 0.134 Test Loss: 3.177 Test Acc: 0.134
Validation loss decreased (-0.117615 --> -0.134086).  Saving model ...
Epoch: 6 cost time: 0.9307193756103516
Epoch: 6, Steps: 10 | Train Loss: 1.981 Vali Loss: 3.094 Vali Acc: 0.160 Test Loss: 3.094 Test Acc: 0.160
Validation loss decreased (-0.134086 --> -0.159969).  Saving model ...
Epoch: 7 cost time: 1.123774528503418
Epoch: 7, Steps: 10 | Train Loss: 1.662 Vali Loss: 3.030 Vali Acc: 0.186 Test Loss: 3.030 Test Acc: 0.186
Validation loss decreased (-0.159969 --> -0.185852).  Saving model ...
Epoch: 8 cost time: 1.1186060905456543
Epoch: 8, Steps: 10 | Train Loss: 1.272 Vali Loss: 3.038 Vali Acc: 0.193 Test Loss: 3.038 Test Acc: 0.193
Validation loss decreased (-0.185852 --> -0.192911).  Saving model ...
Epoch: 9 cost time: 1.0558931827545166
Epoch: 9, Steps: 10 | Train Loss: 0.960 Vali Loss: 2.988 Vali Acc: 0.219 Test Loss: 2.988 Test Acc: 0.219
Validation loss decreased (-0.192911 --> -0.218794).  Saving model ...
Epoch: 10 cost time: 1.07366943359375
Epoch: 10, Steps: 10 | Train Loss: 0.764 Vali Loss: 2.993 Vali Acc: 0.242 Test Loss: 2.993 Test Acc: 0.242
Validation loss decreased (-0.218794 --> -0.242323).  Saving model ...
Epoch: 11 cost time: 1.1185722351074219
Epoch: 11, Steps: 10 | Train Loss: 0.524 Vali Loss: 3.055 Vali Acc: 0.248 Test Loss: 3.055 Test Acc: 0.248
Validation loss decreased (-0.242323 --> -0.248205).  Saving model ...
Epoch: 12 cost time: 1.0301177501678467
Epoch: 12, Steps: 10 | Train Loss: 0.379 Vali Loss: 3.044 Vali Acc: 0.266 Test Loss: 3.044 Test Acc: 0.266
Validation loss decreased (-0.248205 --> -0.265852).  Saving model ...
Epoch: 13 cost time: 1.0072157382965088
Epoch: 13, Steps: 10 | Train Loss: 0.247 Vali Loss: 3.078 Vali Acc: 0.278 Test Loss: 3.078 Test Acc: 0.278
Validation loss decreased (-0.265852 --> -0.277616).  Saving model ...
Epoch: 14 cost time: 0.9264721870422363
Epoch: 14, Steps: 10 | Train Loss: 0.200 Vali Loss: 3.045 Vali Acc: 0.271 Test Loss: 3.045 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9709146022796631
Epoch: 15, Steps: 10 | Train Loss: 0.111 Vali Loss: 3.123 Vali Acc: 0.298 Test Loss: 3.123 Test Acc: 0.298
Validation loss decreased (-0.277616 --> -0.297616).  Saving model ...
Epoch: 16 cost time: 1.0251476764678955
Epoch: 16, Steps: 10 | Train Loss: 0.085 Vali Loss: 3.098 Vali Acc: 0.308 Test Loss: 3.098 Test Acc: 0.308
Validation loss decreased (-0.297616 --> -0.308204).  Saving model ...
Epoch: 17 cost time: 1.078521728515625
Epoch: 17, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.110 Vali Acc: 0.313 Test Loss: 3.110 Test Acc: 0.313
Validation loss decreased (-0.308204 --> -0.312910).  Saving model ...
Epoch: 18 cost time: 1.092064380645752
Epoch: 18, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.119 Vali Acc: 0.301 Test Loss: 3.119 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.001509666442871
Epoch: 19, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.173 Vali Acc: 0.300 Test Loss: 3.173 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.06209397315979
Epoch: 20, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.165 Vali Acc: 0.305 Test Loss: 3.165 Test Acc: 0.305
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0792627334594727
Epoch: 21, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.236 Vali Acc: 0.311 Test Loss: 3.236 Test Acc: 0.311
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9383015632629395
Epoch: 22, Steps: 10 | Train Loss: 0.070 Vali Loss: 3.199 Vali Acc: 0.313 Test Loss: 3.199 Test Acc: 0.313
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.886289119720459
Epoch: 23, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.199 Vali Acc: 0.304 Test Loss: 3.199 Test Acc: 0.304
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.9496777057647705
Epoch: 24, Steps: 10 | Train Loss: 0.059 Vali Loss: 3.344 Vali Acc: 0.302 Test Loss: 3.344 Test Acc: 0.302
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.7979588508605957
Epoch: 25, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.249 Vali Acc: 0.321 Test Loss: 3.249 Test Acc: 0.321
Validation loss decreased (-0.312910 --> -0.321144).  Saving model ...
Epoch: 26 cost time: 1.0226004123687744
Epoch: 26, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.233 Vali Acc: 0.324 Test Loss: 3.233 Test Acc: 0.324
Validation loss decreased (-0.321144 --> -0.323497).  Saving model ...
Epoch: 27 cost time: 1.0741205215454102
Epoch: 27, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.248 Vali Acc: 0.324 Test Loss: 3.248 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.024721384048462
Epoch: 28, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.279 Vali Acc: 0.318 Test Loss: 3.279 Test Acc: 0.318
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.0817601680755615
Epoch: 29, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.268 Vali Acc: 0.320 Test Loss: 3.268 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.0409014225006104
Epoch: 30, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.312 Vali Acc: 0.319 Test Loss: 3.312 Test Acc: 0.319
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3235294117647059
model parameter : 1504506
model size : 6.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.0016918182373047
Epoch: 1, Steps: 10 | Train Loss: 3.305 Vali Loss: 3.281 Vali Acc: 0.053 Test Loss: 3.281 Test Acc: 0.053
Validation loss decreased (inf --> -0.052908).  Saving model ...
Epoch: 2 cost time: 1.4652059078216553
Epoch: 2, Steps: 10 | Train Loss: 3.137 Vali Loss: 3.259 Vali Acc: 0.079 Test Loss: 3.259 Test Acc: 0.079
Validation loss decreased (-0.052908 --> -0.078791).  Saving model ...
Epoch: 3 cost time: 1.5325613021850586
Epoch: 3, Steps: 10 | Train Loss: 2.911 Vali Loss: 3.260 Vali Acc: 0.098 Test Loss: 3.260 Test Acc: 0.098
Validation loss decreased (-0.078791 --> -0.097614).  Saving model ...
Epoch: 4 cost time: 1.5142297744750977
Epoch: 4, Steps: 10 | Train Loss: 2.613 Vali Loss: 3.187 Vali Acc: 0.138 Test Loss: 3.187 Test Acc: 0.138
Validation loss decreased (-0.097614 --> -0.137615).  Saving model ...
Epoch: 5 cost time: 1.5298559665679932
Epoch: 5, Steps: 10 | Train Loss: 2.310 Vali Loss: 3.113 Vali Acc: 0.158 Test Loss: 3.113 Test Acc: 0.158
Validation loss decreased (-0.137615 --> -0.157616).  Saving model ...
Epoch: 6 cost time: 1.1906707286834717
Epoch: 6, Steps: 10 | Train Loss: 1.843 Vali Loss: 3.082 Vali Acc: 0.185 Test Loss: 3.082 Test Acc: 0.185
Validation loss decreased (-0.157616 --> -0.184675).  Saving model ...
Epoch: 7 cost time: 1.007669448852539
Epoch: 7, Steps: 10 | Train Loss: 1.598 Vali Loss: 3.025 Vali Acc: 0.209 Test Loss: 3.025 Test Acc: 0.209
Validation loss decreased (-0.184675 --> -0.209382).  Saving model ...
Epoch: 8 cost time: 1.246856689453125
Epoch: 8, Steps: 10 | Train Loss: 1.200 Vali Loss: 3.008 Vali Acc: 0.216 Test Loss: 3.008 Test Acc: 0.216
Validation loss decreased (-0.209382 --> -0.216441).  Saving model ...
Epoch: 9 cost time: 1.4139459133148193
Epoch: 9, Steps: 10 | Train Loss: 0.888 Vali Loss: 3.019 Vali Acc: 0.245 Test Loss: 3.019 Test Acc: 0.245
Validation loss decreased (-0.216441 --> -0.244676).  Saving model ...
Epoch: 10 cost time: 1.2967400550842285
Epoch: 10, Steps: 10 | Train Loss: 0.553 Vali Loss: 3.033 Vali Acc: 0.252 Test Loss: 3.033 Test Acc: 0.252
Validation loss decreased (-0.244676 --> -0.251734).  Saving model ...
Epoch: 11 cost time: 1.3738069534301758
Epoch: 11, Steps: 10 | Train Loss: 0.530 Vali Loss: 2.968 Vali Acc: 0.280 Test Loss: 2.968 Test Acc: 0.280
Validation loss decreased (-0.251734 --> -0.279970).  Saving model ...
Epoch: 12 cost time: 1.3716022968292236
Epoch: 12, Steps: 10 | Train Loss: 0.393 Vali Loss: 3.044 Vali Acc: 0.287 Test Loss: 3.044 Test Acc: 0.287
Validation loss decreased (-0.279970 --> -0.287028).  Saving model ...
Epoch: 13 cost time: 1.3665313720703125
Epoch: 13, Steps: 10 | Train Loss: 0.373 Vali Loss: 3.005 Vali Acc: 0.289 Test Loss: 3.005 Test Acc: 0.289
Validation loss decreased (-0.287028 --> -0.289382).  Saving model ...
Epoch: 14 cost time: 1.2210347652435303
Epoch: 14, Steps: 10 | Train Loss: 0.180 Vali Loss: 3.062 Vali Acc: 0.286 Test Loss: 3.062 Test Acc: 0.286
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1868534088134766
Epoch: 15, Steps: 10 | Train Loss: 0.128 Vali Loss: 3.126 Vali Acc: 0.295 Test Loss: 3.126 Test Acc: 0.295
Validation loss decreased (-0.289382 --> -0.295263).  Saving model ...
Epoch: 16 cost time: 1.1886038780212402
Epoch: 16, Steps: 10 | Train Loss: 0.082 Vali Loss: 3.143 Vali Acc: 0.300 Test Loss: 3.143 Test Acc: 0.300
Validation loss decreased (-0.295263 --> -0.299969).  Saving model ...
Epoch: 17 cost time: 1.0710570812225342
Epoch: 17, Steps: 10 | Train Loss: 0.073 Vali Loss: 3.136 Vali Acc: 0.304 Test Loss: 3.136 Test Acc: 0.304
Validation loss decreased (-0.299969 --> -0.303498).  Saving model ...
Epoch: 18 cost time: 1.4504129886627197
Epoch: 18, Steps: 10 | Train Loss: 0.113 Vali Loss: 3.113 Vali Acc: 0.304 Test Loss: 3.113 Test Acc: 0.304
Validation loss decreased (-0.303498 --> -0.303498).  Saving model ...
Epoch: 19 cost time: 1.401463270187378
Epoch: 19, Steps: 10 | Train Loss: 0.101 Vali Loss: 3.072 Vali Acc: 0.311 Test Loss: 3.072 Test Acc: 0.311
Validation loss decreased (-0.303498 --> -0.310558).  Saving model ...
Epoch: 20 cost time: 1.3164331912994385
Epoch: 20, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.046 Vali Acc: 0.315 Test Loss: 3.046 Test Acc: 0.315
Validation loss decreased (-0.310558 --> -0.315264).  Saving model ...
Epoch: 21 cost time: 1.3126599788665771
Epoch: 21, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.080 Vali Acc: 0.327 Test Loss: 3.080 Test Acc: 0.327
Validation loss decreased (-0.315264 --> -0.327028).  Saving model ...
Epoch: 22 cost time: 1.2136898040771484
Epoch: 22, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.056 Vali Acc: 0.324 Test Loss: 3.056 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2009336948394775
Epoch: 23, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.116 Vali Acc: 0.328 Test Loss: 3.116 Test Acc: 0.328
Validation loss decreased (-0.327028 --> -0.328204).  Saving model ...
Epoch: 24 cost time: 1.2065882682800293
Epoch: 24, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.196 Vali Acc: 0.321 Test Loss: 3.196 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2248520851135254
Epoch: 25, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.130 Vali Acc: 0.342 Test Loss: 3.130 Test Acc: 0.342
Validation loss decreased (-0.328204 --> -0.342322).  Saving model ...
Epoch: 26 cost time: 1.4565458297729492
Epoch: 26, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.181 Vali Acc: 0.331 Test Loss: 3.181 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.411419153213501
Epoch: 27, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.101 Vali Acc: 0.336 Test Loss: 3.101 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.3915278911590576
Epoch: 28, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.088 Vali Acc: 0.333 Test Loss: 3.088 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.4098386764526367
Epoch: 29, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.272 Vali Acc: 0.321 Test Loss: 3.272 Test Acc: 0.321
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.262655258178711
Epoch: 30, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.276 Vali Acc: 0.314 Test Loss: 3.276 Test Acc: 0.314
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3423529411764706
model parameter : 4814714
model size : 19.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.263519287109375
Epoch: 1, Steps: 10 | Train Loss: 3.291 Vali Loss: 3.294 Vali Acc: 0.033 Test Loss: 3.294 Test Acc: 0.033
Validation loss decreased (inf --> -0.032908).  Saving model ...
Epoch: 2 cost time: 0.884246826171875
Epoch: 2, Steps: 10 | Train Loss: 3.174 Vali Loss: 3.288 Vali Acc: 0.053 Test Loss: 3.288 Test Acc: 0.053
Validation loss decreased (-0.032908 --> -0.052908).  Saving model ...
Epoch: 3 cost time: 0.822394847869873
Epoch: 3, Steps: 10 | Train Loss: 2.971 Vali Loss: 3.276 Vali Acc: 0.079 Test Loss: 3.276 Test Acc: 0.079
Validation loss decreased (-0.052908 --> -0.078791).  Saving model ...
Epoch: 4 cost time: 0.8416845798492432
Epoch: 4, Steps: 10 | Train Loss: 2.683 Vali Loss: 3.230 Vali Acc: 0.114 Test Loss: 3.230 Test Acc: 0.114
Validation loss decreased (-0.078791 --> -0.114085).  Saving model ...
Epoch: 5 cost time: 0.8611538410186768
Epoch: 5, Steps: 10 | Train Loss: 2.436 Vali Loss: 3.190 Vali Acc: 0.131 Test Loss: 3.190 Test Acc: 0.131
Validation loss decreased (-0.114085 --> -0.130556).  Saving model ...
Epoch: 6 cost time: 0.8273310661315918
Epoch: 6, Steps: 10 | Train Loss: 2.067 Vali Loss: 3.111 Vali Acc: 0.161 Test Loss: 3.111 Test Acc: 0.161
Validation loss decreased (-0.130556 --> -0.161145).  Saving model ...
Epoch: 7 cost time: 0.7665677070617676
Epoch: 7, Steps: 10 | Train Loss: 1.743 Vali Loss: 3.049 Vali Acc: 0.186 Test Loss: 3.049 Test Acc: 0.186
Validation loss decreased (-0.161145 --> -0.185852).  Saving model ...
Epoch: 8 cost time: 0.7679259777069092
Epoch: 8, Steps: 10 | Train Loss: 1.456 Vali Loss: 3.050 Vali Acc: 0.194 Test Loss: 3.050 Test Acc: 0.194
Validation loss decreased (-0.185852 --> -0.194087).  Saving model ...
Epoch: 9 cost time: 0.7669370174407959
Epoch: 9, Steps: 10 | Train Loss: 1.096 Vali Loss: 3.003 Vali Acc: 0.226 Test Loss: 3.003 Test Acc: 0.226
Validation loss decreased (-0.194087 --> -0.225852).  Saving model ...
Epoch: 10 cost time: 0.8513636589050293
Epoch: 10, Steps: 10 | Train Loss: 0.950 Vali Loss: 3.016 Vali Acc: 0.240 Test Loss: 3.016 Test Acc: 0.240
Validation loss decreased (-0.225852 --> -0.239970).  Saving model ...
Epoch: 11 cost time: 0.8589341640472412
Epoch: 11, Steps: 10 | Train Loss: 0.744 Vali Loss: 3.072 Vali Acc: 0.245 Test Loss: 3.072 Test Acc: 0.245
Validation loss decreased (-0.239970 --> -0.244675).  Saving model ...
Epoch: 12 cost time: 0.8498589992523193
Epoch: 12, Steps: 10 | Train Loss: 0.511 Vali Loss: 3.006 Vali Acc: 0.286 Test Loss: 3.006 Test Acc: 0.286
Validation loss decreased (-0.244675 --> -0.285852).  Saving model ...
Epoch: 13 cost time: 0.8077528476715088
Epoch: 13, Steps: 10 | Train Loss: 0.377 Vali Loss: 3.086 Vali Acc: 0.278 Test Loss: 3.086 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8875629901885986
Epoch: 14, Steps: 10 | Train Loss: 0.270 Vali Loss: 3.071 Vali Acc: 0.291 Test Loss: 3.071 Test Acc: 0.291
Validation loss decreased (-0.285852 --> -0.290558).  Saving model ...
Epoch: 15 cost time: 0.8139448165893555
Epoch: 15, Steps: 10 | Train Loss: 0.177 Vali Loss: 3.127 Vali Acc: 0.286 Test Loss: 3.127 Test Acc: 0.286
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8132846355438232
Epoch: 16, Steps: 10 | Train Loss: 0.211 Vali Loss: 3.066 Vali Acc: 0.306 Test Loss: 3.066 Test Acc: 0.306
Validation loss decreased (-0.290558 --> -0.305852).  Saving model ...
Epoch: 17 cost time: 0.8315060138702393
Epoch: 17, Steps: 10 | Train Loss: 0.114 Vali Loss: 3.110 Vali Acc: 0.305 Test Loss: 3.110 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7738521099090576
Epoch: 18, Steps: 10 | Train Loss: 0.086 Vali Loss: 3.137 Vali Acc: 0.304 Test Loss: 3.137 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7992031574249268
Epoch: 19, Steps: 10 | Train Loss: 0.092 Vali Loss: 3.158 Vali Acc: 0.325 Test Loss: 3.158 Test Acc: 0.325
Validation loss decreased (-0.305852 --> -0.324674).  Saving model ...
Epoch: 20 cost time: 0.7720341682434082
Epoch: 20, Steps: 10 | Train Loss: 0.122 Vali Loss: 3.212 Vali Acc: 0.327 Test Loss: 3.212 Test Acc: 0.327
Validation loss decreased (-0.324674 --> -0.327027).  Saving model ...
Epoch: 21 cost time: 0.7802760601043701
Epoch: 21, Steps: 10 | Train Loss: 0.061 Vali Loss: 3.226 Vali Acc: 0.329 Test Loss: 3.226 Test Acc: 0.329
Validation loss decreased (-0.327027 --> -0.329380).  Saving model ...
Epoch: 22 cost time: 0.6512038707733154
Epoch: 22, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.250 Vali Acc: 0.318 Test Loss: 3.250 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.830967903137207
Epoch: 23, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.201 Vali Acc: 0.327 Test Loss: 3.201 Test Acc: 0.327
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8351457118988037
Epoch: 24, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.266 Vali Acc: 0.316 Test Loss: 3.266 Test Acc: 0.316
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7971096038818359
Epoch: 25, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.249 Vali Acc: 0.309 Test Loss: 3.249 Test Acc: 0.309
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.8702640533447266
Epoch: 26, Steps: 10 | Train Loss: 0.043 Vali Loss: 3.254 Vali Acc: 0.322 Test Loss: 3.254 Test Acc: 0.322
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.8178167343139648
Epoch: 27, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.284 Vali Acc: 0.314 Test Loss: 3.284 Test Acc: 0.314
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.9616570472717285
Epoch: 28, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.281 Vali Acc: 0.342 Test Loss: 3.281 Test Acc: 0.342
Validation loss decreased (-0.329380 --> -0.342320).  Saving model ...
Epoch: 29 cost time: 0.7749547958374023
Epoch: 29, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.296 Vali Acc: 0.335 Test Loss: 3.296 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.894874095916748
Epoch: 30, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.425 Vali Acc: 0.304 Test Loss: 3.425 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3423529411764706
model parameter : 1504506
model size : 6.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.2155134677886963
Epoch: 1, Steps: 10 | Train Loss: 3.310 Vali Loss: 3.284 Vali Acc: 0.048 Test Loss: 3.284 Test Acc: 0.048
Validation loss decreased (inf --> -0.048202).  Saving model ...
Epoch: 2 cost time: 1.0388526916503906
Epoch: 2, Steps: 10 | Train Loss: 3.153 Vali Loss: 3.270 Vali Acc: 0.075 Test Loss: 3.270 Test Acc: 0.075
Validation loss decreased (-0.048202 --> -0.075261).  Saving model ...
Epoch: 3 cost time: 1.0292596817016602
Epoch: 3, Steps: 10 | Train Loss: 2.964 Vali Loss: 3.289 Vali Acc: 0.082 Test Loss: 3.289 Test Acc: 0.082
Validation loss decreased (-0.075261 --> -0.082320).  Saving model ...
Epoch: 4 cost time: 1.0168919563293457
Epoch: 4, Steps: 10 | Train Loss: 2.683 Vali Loss: 3.237 Vali Acc: 0.109 Test Loss: 3.237 Test Acc: 0.109
Validation loss decreased (-0.082320 --> -0.109379).  Saving model ...
Epoch: 5 cost time: 1.0946271419525146
Epoch: 5, Steps: 10 | Train Loss: 2.398 Vali Loss: 3.153 Vali Acc: 0.151 Test Loss: 3.153 Test Acc: 0.151
Validation loss decreased (-0.109379 --> -0.150557).  Saving model ...
Epoch: 6 cost time: 0.8366734981536865
Epoch: 6, Steps: 10 | Train Loss: 2.042 Vali Loss: 3.103 Vali Acc: 0.162 Test Loss: 3.103 Test Acc: 0.162
Validation loss decreased (-0.150557 --> -0.162322).  Saving model ...
Epoch: 7 cost time: 0.8790972232818604
Epoch: 7, Steps: 10 | Train Loss: 1.791 Vali Loss: 3.076 Vali Acc: 0.180 Test Loss: 3.076 Test Acc: 0.180
Validation loss decreased (-0.162322 --> -0.179969).  Saving model ...
Epoch: 8 cost time: 0.8658225536346436
Epoch: 8, Steps: 10 | Train Loss: 1.578 Vali Loss: 3.068 Vali Acc: 0.215 Test Loss: 3.068 Test Acc: 0.215
Validation loss decreased (-0.179969 --> -0.215263).  Saving model ...
Epoch: 9 cost time: 0.8686344623565674
Epoch: 9, Steps: 10 | Train Loss: 1.271 Vali Loss: 3.065 Vali Acc: 0.229 Test Loss: 3.065 Test Acc: 0.229
Validation loss decreased (-0.215263 --> -0.229381).  Saving model ...
Epoch: 10 cost time: 0.9774661064147949
Epoch: 10, Steps: 10 | Train Loss: 0.898 Vali Loss: 3.068 Vali Acc: 0.245 Test Loss: 3.068 Test Acc: 0.245
Validation loss decreased (-0.229381 --> -0.244675).  Saving model ...
Epoch: 11 cost time: 0.9374861717224121
Epoch: 11, Steps: 10 | Train Loss: 0.772 Vali Loss: 2.996 Vali Acc: 0.254 Test Loss: 2.996 Test Acc: 0.254
Validation loss decreased (-0.244675 --> -0.254088).  Saving model ...
Epoch: 12 cost time: 0.9353644847869873
Epoch: 12, Steps: 10 | Train Loss: 0.546 Vali Loss: 2.992 Vali Acc: 0.271 Test Loss: 2.992 Test Acc: 0.271
Validation loss decreased (-0.254088 --> -0.270558).  Saving model ...
Epoch: 13 cost time: 0.9063506126403809
Epoch: 13, Steps: 10 | Train Loss: 0.345 Vali Loss: 3.007 Vali Acc: 0.293 Test Loss: 3.007 Test Acc: 0.293
Validation loss decreased (-0.270558 --> -0.292911).  Saving model ...
Epoch: 14 cost time: 0.9134917259216309
Epoch: 14, Steps: 10 | Train Loss: 0.245 Vali Loss: 3.026 Vali Acc: 0.296 Test Loss: 3.026 Test Acc: 0.296
Validation loss decreased (-0.292911 --> -0.296440).  Saving model ...
Epoch: 15 cost time: 0.9667131900787354
Epoch: 15, Steps: 10 | Train Loss: 0.165 Vali Loss: 3.076 Vali Acc: 0.292 Test Loss: 3.076 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7172880172729492
Epoch: 16, Steps: 10 | Train Loss: 0.133 Vali Loss: 3.044 Vali Acc: 0.314 Test Loss: 3.044 Test Acc: 0.314
Validation loss decreased (-0.296440 --> -0.314087).  Saving model ...
Epoch: 17 cost time: 0.8119606971740723
Epoch: 17, Steps: 10 | Train Loss: 0.080 Vali Loss: 3.059 Vali Acc: 0.324 Test Loss: 3.059 Test Acc: 0.324
Validation loss decreased (-0.314087 --> -0.323499).  Saving model ...
Epoch: 18 cost time: 0.8008623123168945
Epoch: 18, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.052 Vali Acc: 0.342 Test Loss: 3.052 Test Acc: 0.342
Validation loss decreased (-0.323499 --> -0.342322).  Saving model ...
Epoch: 19 cost time: 0.7976851463317871
Epoch: 19, Steps: 10 | Train Loss: 0.086 Vali Loss: 3.088 Vali Acc: 0.340 Test Loss: 3.088 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8578085899353027
Epoch: 20, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.135 Vali Acc: 0.326 Test Loss: 3.135 Test Acc: 0.326
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7509214878082275
Epoch: 21, Steps: 10 | Train Loss: 0.104 Vali Loss: 3.154 Vali Acc: 0.327 Test Loss: 3.154 Test Acc: 0.327
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8433513641357422
Epoch: 22, Steps: 10 | Train Loss: 0.066 Vali Loss: 3.040 Vali Acc: 0.340 Test Loss: 3.040 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.7102625370025635
Epoch: 23, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.087 Vali Acc: 0.335 Test Loss: 3.087 Test Acc: 0.335
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.6744203567504883
Epoch: 24, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.140 Vali Acc: 0.340 Test Loss: 3.140 Test Acc: 0.340
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.7059717178344727
Epoch: 25, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.159 Vali Acc: 0.338 Test Loss: 3.159 Test Acc: 0.338
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.6795899868011475
Epoch: 26, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.252 Vali Acc: 0.332 Test Loss: 3.252 Test Acc: 0.332
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.6880965232849121
Epoch: 27, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.125 Vali Acc: 0.344 Test Loss: 3.125 Test Acc: 0.344
Validation loss decreased (-0.342322 --> -0.343498).  Saving model ...
Epoch: 28 cost time: 0.687446117401123
Epoch: 28, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.178 Vali Acc: 0.356 Test Loss: 3.178 Test Acc: 0.356
Validation loss decreased (-0.343498 --> -0.356439).  Saving model ...
Epoch: 29 cost time: 0.6959595680236816
Epoch: 29, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.173 Vali Acc: 0.341 Test Loss: 3.173 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7139425277709961
Epoch: 30, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.146 Vali Acc: 0.360 Test Loss: 3.146 Test Acc: 0.360
Validation loss decreased (-0.356439 --> -0.359969).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.36
model parameter : 4814714
model size : 19.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.8282346725463867
Epoch: 1, Steps: 10 | Train Loss: 3.297 Vali Loss: 3.297 Vali Acc: 0.032 Test Loss: 3.297 Test Acc: 0.032
Validation loss decreased (inf --> -0.031732).  Saving model ...
Epoch: 2 cost time: 0.6011967658996582
Epoch: 2, Steps: 10 | Train Loss: 3.169 Vali Loss: 3.293 Vali Acc: 0.039 Test Loss: 3.293 Test Acc: 0.039
Validation loss decreased (-0.031732 --> -0.038791).  Saving model ...
Epoch: 3 cost time: 0.608816385269165
Epoch: 3, Steps: 10 | Train Loss: 3.017 Vali Loss: 3.291 Vali Acc: 0.081 Test Loss: 3.291 Test Acc: 0.081
Validation loss decreased (-0.038791 --> -0.081144).  Saving model ...
Epoch: 4 cost time: 0.6130733489990234
Epoch: 4, Steps: 10 | Train Loss: 2.726 Vali Loss: 3.253 Vali Acc: 0.108 Test Loss: 3.253 Test Acc: 0.108
Validation loss decreased (-0.081144 --> -0.108203).  Saving model ...
Epoch: 5 cost time: 0.5923442840576172
Epoch: 5, Steps: 10 | Train Loss: 2.500 Vali Loss: 3.223 Vali Acc: 0.129 Test Loss: 3.223 Test Acc: 0.129
Validation loss decreased (-0.108203 --> -0.129380).  Saving model ...
Epoch: 6 cost time: 0.5799942016601562
Epoch: 6, Steps: 10 | Train Loss: 2.171 Vali Loss: 3.147 Vali Acc: 0.153 Test Loss: 3.147 Test Acc: 0.153
Validation loss decreased (-0.129380 --> -0.152910).  Saving model ...
Epoch: 7 cost time: 0.5560524463653564
Epoch: 7, Steps: 10 | Train Loss: 1.885 Vali Loss: 3.096 Vali Acc: 0.167 Test Loss: 3.096 Test Acc: 0.167
Validation loss decreased (-0.152910 --> -0.167028).  Saving model ...
Epoch: 8 cost time: 0.5924079418182373
Epoch: 8, Steps: 10 | Train Loss: 1.601 Vali Loss: 3.104 Vali Acc: 0.175 Test Loss: 3.104 Test Acc: 0.175
Validation loss decreased (-0.167028 --> -0.175263).  Saving model ...
Epoch: 9 cost time: 0.5485212802886963
Epoch: 9, Steps: 10 | Train Loss: 1.501 Vali Loss: 3.059 Vali Acc: 0.176 Test Loss: 3.059 Test Acc: 0.176
Validation loss decreased (-0.175263 --> -0.176440).  Saving model ...
Epoch: 10 cost time: 0.496326208114624
Epoch: 10, Steps: 10 | Train Loss: 1.092 Vali Loss: 3.062 Vali Acc: 0.211 Test Loss: 3.062 Test Acc: 0.211
Validation loss decreased (-0.176440 --> -0.210558).  Saving model ...
Epoch: 11 cost time: 0.552232027053833
Epoch: 11, Steps: 10 | Train Loss: 0.871 Vali Loss: 3.092 Vali Acc: 0.219 Test Loss: 3.092 Test Acc: 0.219
Validation loss decreased (-0.210558 --> -0.218793).  Saving model ...
Epoch: 12 cost time: 0.5601933002471924
Epoch: 12, Steps: 10 | Train Loss: 0.745 Vali Loss: 3.026 Vali Acc: 0.247 Test Loss: 3.026 Test Acc: 0.247
Validation loss decreased (-0.218793 --> -0.247029).  Saving model ...
Epoch: 13 cost time: 0.5237512588500977
Epoch: 13, Steps: 10 | Train Loss: 0.511 Vali Loss: 3.087 Vali Acc: 0.260 Test Loss: 3.087 Test Acc: 0.260
Validation loss decreased (-0.247029 --> -0.259969).  Saving model ...
Epoch: 14 cost time: 0.5479741096496582
Epoch: 14, Steps: 10 | Train Loss: 0.415 Vali Loss: 3.073 Vali Acc: 0.262 Test Loss: 3.073 Test Acc: 0.262
Validation loss decreased (-0.259969 --> -0.262322).  Saving model ...
Epoch: 15 cost time: 0.5052797794342041
Epoch: 15, Steps: 10 | Train Loss: 0.234 Vali Loss: 3.170 Vali Acc: 0.279 Test Loss: 3.170 Test Acc: 0.279
Validation loss decreased (-0.262322 --> -0.278792).  Saving model ...
Epoch: 16 cost time: 0.5182602405548096
Epoch: 16, Steps: 10 | Train Loss: 0.208 Vali Loss: 3.087 Vali Acc: 0.300 Test Loss: 3.087 Test Acc: 0.300
Validation loss decreased (-0.278792 --> -0.299969).  Saving model ...
Epoch: 17 cost time: 0.5693347454071045
Epoch: 17, Steps: 10 | Train Loss: 0.166 Vali Loss: 3.098 Vali Acc: 0.300 Test Loss: 3.098 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5248699188232422
Epoch: 18, Steps: 10 | Train Loss: 0.100 Vali Loss: 3.115 Vali Acc: 0.315 Test Loss: 3.115 Test Acc: 0.315
Validation loss decreased (-0.299969 --> -0.315263).  Saving model ...
Epoch: 19 cost time: 0.5475451946258545
Epoch: 19, Steps: 10 | Train Loss: 0.098 Vali Loss: 3.183 Vali Acc: 0.311 Test Loss: 3.183 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6852381229400635
Epoch: 20, Steps: 10 | Train Loss: 0.110 Vali Loss: 3.168 Vali Acc: 0.324 Test Loss: 3.168 Test Acc: 0.324
Validation loss decreased (-0.315263 --> -0.323498).  Saving model ...
Epoch: 21 cost time: 0.7664585113525391
Epoch: 21, Steps: 10 | Train Loss: 0.091 Vali Loss: 3.233 Vali Acc: 0.307 Test Loss: 3.233 Test Acc: 0.307
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6663413047790527
Epoch: 22, Steps: 10 | Train Loss: 0.102 Vali Loss: 3.193 Vali Acc: 0.322 Test Loss: 3.193 Test Acc: 0.322
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6361038684844971
Epoch: 23, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.213 Vali Acc: 0.305 Test Loss: 3.213 Test Acc: 0.305
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6405107975006104
Epoch: 24, Steps: 10 | Train Loss: 0.067 Vali Loss: 3.326 Vali Acc: 0.321 Test Loss: 3.326 Test Acc: 0.321
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.5568640232086182
Epoch: 25, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.255 Vali Acc: 0.314 Test Loss: 3.255 Test Acc: 0.314
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.5530338287353516
Epoch: 26, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.278 Vali Acc: 0.324 Test Loss: 3.278 Test Acc: 0.324
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.5713918209075928
Epoch: 27, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.274 Vali Acc: 0.332 Test Loss: 3.274 Test Acc: 0.332
Validation loss decreased (-0.323498 --> -0.331732).  Saving model ...
Epoch: 28 cost time: 0.5972177982330322
Epoch: 28, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.363 Vali Acc: 0.316 Test Loss: 3.363 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.552666425704956
Epoch: 29, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.348 Vali Acc: 0.327 Test Loss: 3.348 Test Acc: 0.327
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.5739860534667969
Epoch: 30, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.402 Vali Acc: 0.325 Test Loss: 3.402 Test Acc: 0.325
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.33176470588235296
model parameter : 1504506
model size : 6.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.653890371322632
Epoch: 1, Steps: 10 | Train Loss: 3.287 Vali Loss: 3.302 Vali Acc: 0.044 Test Loss: 3.302 Test Acc: 0.044
Validation loss decreased (inf --> -0.043496).  Saving model ...
Epoch: 2 cost time: 1.2539598941802979
Epoch: 2, Steps: 10 | Train Loss: 3.140 Vali Loss: 3.265 Vali Acc: 0.078 Test Loss: 3.265 Test Acc: 0.078
Validation loss decreased (-0.043496 --> -0.077614).  Saving model ...
Epoch: 3 cost time: 1.2322461605072021
Epoch: 3, Steps: 10 | Train Loss: 2.901 Vali Loss: 3.247 Vali Acc: 0.101 Test Loss: 3.247 Test Acc: 0.101
Validation loss decreased (-0.077614 --> -0.101144).  Saving model ...
Epoch: 4 cost time: 1.2796804904937744
Epoch: 4, Steps: 10 | Train Loss: 2.593 Vali Loss: 3.177 Vali Acc: 0.135 Test Loss: 3.177 Test Acc: 0.135
Validation loss decreased (-0.101144 --> -0.135262).  Saving model ...
Epoch: 5 cost time: 1.1328623294830322
Epoch: 5, Steps: 10 | Train Loss: 2.271 Vali Loss: 3.122 Vali Acc: 0.168 Test Loss: 3.122 Test Acc: 0.168
Validation loss decreased (-0.135262 --> -0.168204).  Saving model ...
Epoch: 6 cost time: 1.1447975635528564
Epoch: 6, Steps: 10 | Train Loss: 1.834 Vali Loss: 3.050 Vali Acc: 0.172 Test Loss: 3.050 Test Acc: 0.172
Validation loss decreased (-0.168204 --> -0.171734).  Saving model ...
Epoch: 7 cost time: 1.1173782348632812
Epoch: 7, Steps: 10 | Train Loss: 1.503 Vali Loss: 2.991 Vali Acc: 0.195 Test Loss: 2.991 Test Acc: 0.195
Validation loss decreased (-0.171734 --> -0.195264).  Saving model ...
Epoch: 8 cost time: 1.246591329574585
Epoch: 8, Steps: 10 | Train Loss: 1.192 Vali Loss: 2.956 Vali Acc: 0.211 Test Loss: 2.956 Test Acc: 0.211
Validation loss decreased (-0.195264 --> -0.210559).  Saving model ...
Epoch: 9 cost time: 1.335758924484253
Epoch: 9, Steps: 10 | Train Loss: 0.859 Vali Loss: 2.974 Vali Acc: 0.239 Test Loss: 2.974 Test Acc: 0.239
Validation loss decreased (-0.210559 --> -0.238794).  Saving model ...
Epoch: 10 cost time: 1.2436039447784424
Epoch: 10, Steps: 10 | Train Loss: 0.629 Vali Loss: 2.914 Vali Acc: 0.261 Test Loss: 2.914 Test Acc: 0.261
Validation loss decreased (-0.238794 --> -0.261147).  Saving model ...
Epoch: 11 cost time: 1.0995419025421143
Epoch: 11, Steps: 10 | Train Loss: 0.397 Vali Loss: 2.945 Vali Acc: 0.276 Test Loss: 2.945 Test Acc: 0.276
Validation loss decreased (-0.261147 --> -0.276441).  Saving model ...
Epoch: 12 cost time: 1.1900575160980225
Epoch: 12, Steps: 10 | Train Loss: 0.298 Vali Loss: 3.023 Vali Acc: 0.282 Test Loss: 3.023 Test Acc: 0.282
Validation loss decreased (-0.276441 --> -0.282323).  Saving model ...
Epoch: 13 cost time: 1.1261212825775146
Epoch: 13, Steps: 10 | Train Loss: 0.309 Vali Loss: 2.989 Vali Acc: 0.299 Test Loss: 2.989 Test Acc: 0.299
Validation loss decreased (-0.282323 --> -0.298794).  Saving model ...
Epoch: 14 cost time: 1.1951074600219727
Epoch: 14, Steps: 10 | Train Loss: 0.189 Vali Loss: 2.970 Vali Acc: 0.295 Test Loss: 2.970 Test Acc: 0.295
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.256824254989624
Epoch: 15, Steps: 10 | Train Loss: 0.112 Vali Loss: 3.022 Vali Acc: 0.304 Test Loss: 3.022 Test Acc: 0.304
Validation loss decreased (-0.298794 --> -0.303499).  Saving model ...
Epoch: 16 cost time: 1.2190830707550049
Epoch: 16, Steps: 10 | Train Loss: 0.091 Vali Loss: 3.108 Vali Acc: 0.312 Test Loss: 3.108 Test Acc: 0.312
Validation loss decreased (-0.303499 --> -0.311734).  Saving model ...
Epoch: 17 cost time: 1.1772620677947998
Epoch: 17, Steps: 10 | Train Loss: 0.073 Vali Loss: 3.114 Vali Acc: 0.307 Test Loss: 3.114 Test Acc: 0.307
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1319053173065186
Epoch: 18, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.109 Vali Acc: 0.308 Test Loss: 3.109 Test Acc: 0.308
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1238386631011963
Epoch: 19, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.115 Vali Acc: 0.315 Test Loss: 3.115 Test Acc: 0.315
Validation loss decreased (-0.311734 --> -0.315263).  Saving model ...
Epoch: 20 cost time: 1.1109569072723389
Epoch: 20, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.183 Vali Acc: 0.313 Test Loss: 3.183 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2202165126800537
Epoch: 21, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.162 Vali Acc: 0.309 Test Loss: 3.162 Test Acc: 0.309
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1435635089874268
Epoch: 22, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.147 Vali Acc: 0.320 Test Loss: 3.147 Test Acc: 0.320
Validation loss decreased (-0.315263 --> -0.319969).  Saving model ...
Epoch: 23 cost time: 1.2654085159301758
Epoch: 23, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.191 Vali Acc: 0.320 Test Loss: 3.191 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2747960090637207
Epoch: 24, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.174 Vali Acc: 0.320 Test Loss: 3.174 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1818568706512451
Epoch: 25, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.194 Vali Acc: 0.320 Test Loss: 3.194 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.2014505863189697
Epoch: 26, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.204 Vali Acc: 0.320 Test Loss: 3.204 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.1192553043365479
Epoch: 27, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.272 Vali Acc: 0.305 Test Loss: 3.272 Test Acc: 0.305
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.2795801162719727
Epoch: 28, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.294 Vali Acc: 0.308 Test Loss: 3.294 Test Acc: 0.308
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.2304258346557617
Epoch: 29, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.238 Vali Acc: 0.316 Test Loss: 3.238 Test Acc: 0.316
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.2002017498016357
Epoch: 30, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.210 Vali Acc: 0.324 Test Loss: 3.210 Test Acc: 0.324
Validation loss decreased (-0.319969 --> -0.323497).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3235294117647059
model parameter : 2471034
model size : 10.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.140876293182373
Epoch: 1, Steps: 10 | Train Loss: 3.415 Vali Loss: 3.292 Vali Acc: 0.048 Test Loss: 3.292 Test Acc: 0.048
Validation loss decreased (inf --> -0.048202).  Saving model ...
Epoch: 2 cost time: 0.7659487724304199
Epoch: 2, Steps: 10 | Train Loss: 3.238 Vali Loss: 3.261 Vali Acc: 0.056 Test Loss: 3.261 Test Acc: 0.056
Validation loss decreased (-0.048202 --> -0.056438).  Saving model ...
Epoch: 3 cost time: 0.7671451568603516
Epoch: 3, Steps: 10 | Train Loss: 2.980 Vali Loss: 3.266 Vali Acc: 0.078 Test Loss: 3.266 Test Acc: 0.078
Validation loss decreased (-0.056438 --> -0.077614).  Saving model ...
Epoch: 4 cost time: 0.8201828002929688
Epoch: 4, Steps: 10 | Train Loss: 2.753 Vali Loss: 3.231 Vali Acc: 0.100 Test Loss: 3.231 Test Acc: 0.100
Validation loss decreased (-0.077614 --> -0.099968).  Saving model ...
Epoch: 5 cost time: 0.7551000118255615
Epoch: 5, Steps: 10 | Train Loss: 2.460 Vali Loss: 3.161 Vali Acc: 0.133 Test Loss: 3.161 Test Acc: 0.133
Validation loss decreased (-0.099968 --> -0.132910).  Saving model ...
Epoch: 6 cost time: 0.8459880352020264
Epoch: 6, Steps: 10 | Train Loss: 2.182 Vali Loss: 3.090 Vali Acc: 0.173 Test Loss: 3.090 Test Acc: 0.173
Validation loss decreased (-0.132910 --> -0.172910).  Saving model ...
Epoch: 7 cost time: 0.7890925407409668
Epoch: 7, Steps: 10 | Train Loss: 1.818 Vali Loss: 3.030 Vali Acc: 0.208 Test Loss: 3.030 Test Acc: 0.208
Validation loss decreased (-0.172910 --> -0.208205).  Saving model ...
Epoch: 8 cost time: 0.772686243057251
Epoch: 8, Steps: 10 | Train Loss: 1.423 Vali Loss: 2.974 Vali Acc: 0.218 Test Loss: 2.974 Test Acc: 0.218
Validation loss decreased (-0.208205 --> -0.217617).  Saving model ...
Epoch: 9 cost time: 0.7434487342834473
Epoch: 9, Steps: 10 | Train Loss: 1.112 Vali Loss: 2.928 Vali Acc: 0.247 Test Loss: 2.928 Test Acc: 0.247
Validation loss decreased (-0.217617 --> -0.247030).  Saving model ...
Epoch: 10 cost time: 0.8437972068786621
Epoch: 10, Steps: 10 | Train Loss: 0.837 Vali Loss: 2.947 Vali Acc: 0.258 Test Loss: 2.947 Test Acc: 0.258
Validation loss decreased (-0.247030 --> -0.257618).  Saving model ...
Epoch: 11 cost time: 0.8149564266204834
Epoch: 11, Steps: 10 | Train Loss: 0.606 Vali Loss: 2.976 Vali Acc: 0.282 Test Loss: 2.976 Test Acc: 0.282
Validation loss decreased (-0.257618 --> -0.282323).  Saving model ...
Epoch: 12 cost time: 0.8111369609832764
Epoch: 12, Steps: 10 | Train Loss: 0.367 Vali Loss: 2.951 Vali Acc: 0.280 Test Loss: 2.951 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8062422275543213
Epoch: 13, Steps: 10 | Train Loss: 0.222 Vali Loss: 2.989 Vali Acc: 0.298 Test Loss: 2.989 Test Acc: 0.298
Validation loss decreased (-0.282323 --> -0.297617).  Saving model ...
Epoch: 14 cost time: 0.8157081604003906
Epoch: 14, Steps: 10 | Train Loss: 0.180 Vali Loss: 3.040 Vali Acc: 0.307 Test Loss: 3.040 Test Acc: 0.307
Validation loss decreased (-0.297617 --> -0.307028).  Saving model ...
Epoch: 15 cost time: 0.8159356117248535
Epoch: 15, Steps: 10 | Train Loss: 0.120 Vali Loss: 3.057 Vali Acc: 0.315 Test Loss: 3.057 Test Acc: 0.315
Validation loss decreased (-0.307028 --> -0.315264).  Saving model ...
Epoch: 16 cost time: 0.7815625667572021
Epoch: 16, Steps: 10 | Train Loss: 0.104 Vali Loss: 3.099 Vali Acc: 0.312 Test Loss: 3.099 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7224977016448975
Epoch: 17, Steps: 10 | Train Loss: 0.072 Vali Loss: 3.110 Vali Acc: 0.306 Test Loss: 3.110 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7706916332244873
Epoch: 18, Steps: 10 | Train Loss: 0.064 Vali Loss: 3.195 Vali Acc: 0.327 Test Loss: 3.195 Test Acc: 0.327
Validation loss decreased (-0.315264 --> -0.327027).  Saving model ...
Epoch: 19 cost time: 0.7872202396392822
Epoch: 19, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.154 Vali Acc: 0.325 Test Loss: 3.154 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7835779190063477
Epoch: 20, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.251 Vali Acc: 0.331 Test Loss: 3.251 Test Acc: 0.331
Validation loss decreased (-0.327027 --> -0.330556).  Saving model ...
Epoch: 21 cost time: 0.7400274276733398
Epoch: 21, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.203 Vali Acc: 0.324 Test Loss: 3.203 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7783277034759521
Epoch: 22, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.231 Vali Acc: 0.315 Test Loss: 3.231 Test Acc: 0.315
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7820286750793457
Epoch: 23, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.291 Vali Acc: 0.327 Test Loss: 3.291 Test Acc: 0.327
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7962276935577393
Epoch: 24, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.219 Vali Acc: 0.332 Test Loss: 3.219 Test Acc: 0.332
Validation loss decreased (-0.330556 --> -0.331733).  Saving model ...
Epoch: 25 cost time: 0.8006246089935303
Epoch: 25, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.300 Vali Acc: 0.328 Test Loss: 3.300 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.740494966506958
Epoch: 26, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.260 Vali Acc: 0.331 Test Loss: 3.260 Test Acc: 0.331
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8211057186126709
Epoch: 27, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.257 Vali Acc: 0.327 Test Loss: 3.257 Test Acc: 0.327
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.7638049125671387
Epoch: 28, Steps: 10 | Train Loss: 0.079 Vali Loss: 3.307 Vali Acc: 0.338 Test Loss: 3.307 Test Acc: 0.338
Validation loss decreased (-0.331733 --> -0.337614).  Saving model ...
Epoch: 29 cost time: 0.7880010604858398
Epoch: 29, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.321 Vali Acc: 0.320 Test Loss: 3.321 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7833704948425293
Epoch: 30, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.342 Vali Acc: 0.331 Test Loss: 3.342 Test Acc: 0.331
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3376470588235294
model parameter : 815866
model size : 3.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.3627214431762695
Epoch: 1, Steps: 10 | Train Loss: 3.287 Vali Loss: 3.302 Vali Acc: 0.045 Test Loss: 3.302 Test Acc: 0.045
Validation loss decreased (inf --> -0.044673).  Saving model ...
Epoch: 2 cost time: 0.9632887840270996
Epoch: 2, Steps: 10 | Train Loss: 3.148 Vali Loss: 3.265 Vali Acc: 0.079 Test Loss: 3.265 Test Acc: 0.079
Validation loss decreased (-0.044673 --> -0.078791).  Saving model ...
Epoch: 3 cost time: 0.9629762172698975
Epoch: 3, Steps: 10 | Train Loss: 2.918 Vali Loss: 3.248 Vali Acc: 0.107 Test Loss: 3.248 Test Acc: 0.107
Validation loss decreased (-0.078791 --> -0.107026).  Saving model ...
Epoch: 4 cost time: 1.0023114681243896
Epoch: 4, Steps: 10 | Train Loss: 2.654 Vali Loss: 3.181 Vali Acc: 0.136 Test Loss: 3.181 Test Acc: 0.136
Validation loss decreased (-0.107026 --> -0.136439).  Saving model ...
Epoch: 5 cost time: 1.0096855163574219
Epoch: 5, Steps: 10 | Train Loss: 2.309 Vali Loss: 3.117 Vali Acc: 0.174 Test Loss: 3.117 Test Acc: 0.174
Validation loss decreased (-0.136439 --> -0.174086).  Saving model ...
Epoch: 6 cost time: 0.9686672687530518
Epoch: 6, Steps: 10 | Train Loss: 1.952 Vali Loss: 3.061 Vali Acc: 0.174 Test Loss: 3.061 Test Acc: 0.174
Validation loss decreased (-0.174086 --> -0.174087).  Saving model ...
Epoch: 7 cost time: 1.0024549961090088
Epoch: 7, Steps: 10 | Train Loss: 1.621 Vali Loss: 3.002 Vali Acc: 0.208 Test Loss: 3.002 Test Acc: 0.208
Validation loss decreased (-0.174087 --> -0.208205).  Saving model ...
Epoch: 8 cost time: 0.9707305431365967
Epoch: 8, Steps: 10 | Train Loss: 1.408 Vali Loss: 3.004 Vali Acc: 0.206 Test Loss: 3.004 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8778936862945557
Epoch: 9, Steps: 10 | Train Loss: 1.028 Vali Loss: 3.005 Vali Acc: 0.242 Test Loss: 3.005 Test Acc: 0.242
Validation loss decreased (-0.208205 --> -0.242323).  Saving model ...
Epoch: 10 cost time: 0.814586877822876
Epoch: 10, Steps: 10 | Train Loss: 0.799 Vali Loss: 2.949 Vali Acc: 0.260 Test Loss: 2.949 Test Acc: 0.260
Validation loss decreased (-0.242323 --> -0.259971).  Saving model ...
Epoch: 11 cost time: 0.8865647315979004
Epoch: 11, Steps: 10 | Train Loss: 0.441 Vali Loss: 2.963 Vali Acc: 0.282 Test Loss: 2.963 Test Acc: 0.282
Validation loss decreased (-0.259971 --> -0.282323).  Saving model ...
Epoch: 12 cost time: 0.9369614124298096
Epoch: 12, Steps: 10 | Train Loss: 0.419 Vali Loss: 3.014 Vali Acc: 0.293 Test Loss: 3.014 Test Acc: 0.293
Validation loss decreased (-0.282323 --> -0.292911).  Saving model ...
Epoch: 13 cost time: 0.8935794830322266
Epoch: 13, Steps: 10 | Train Loss: 0.236 Vali Loss: 2.913 Vali Acc: 0.307 Test Loss: 2.913 Test Acc: 0.307
Validation loss decreased (-0.292911 --> -0.307030).  Saving model ...
Epoch: 14 cost time: 0.9335958957672119
Epoch: 14, Steps: 10 | Train Loss: 0.118 Vali Loss: 2.990 Vali Acc: 0.313 Test Loss: 2.990 Test Acc: 0.313
Validation loss decreased (-0.307030 --> -0.312911).  Saving model ...
Epoch: 15 cost time: 0.9482710361480713
Epoch: 15, Steps: 10 | Train Loss: 0.209 Vali Loss: 2.984 Vali Acc: 0.309 Test Loss: 2.984 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9413881301879883
Epoch: 16, Steps: 10 | Train Loss: 0.104 Vali Loss: 3.075 Vali Acc: 0.307 Test Loss: 3.075 Test Acc: 0.307
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.891669511795044
Epoch: 17, Steps: 10 | Train Loss: 0.089 Vali Loss: 3.067 Vali Acc: 0.319 Test Loss: 3.067 Test Acc: 0.319
Validation loss decreased (-0.312911 --> -0.318793).  Saving model ...
Epoch: 18 cost time: 0.9023721218109131
Epoch: 18, Steps: 10 | Train Loss: 0.108 Vali Loss: 3.051 Vali Acc: 0.309 Test Loss: 3.051 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9101152420043945
Epoch: 19, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.153 Vali Acc: 0.312 Test Loss: 3.153 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8937592506408691
Epoch: 20, Steps: 10 | Train Loss: 0.070 Vali Loss: 3.083 Vali Acc: 0.318 Test Loss: 3.083 Test Acc: 0.318
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9288713932037354
Epoch: 21, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.081 Vali Acc: 0.327 Test Loss: 3.081 Test Acc: 0.327
Validation loss decreased (-0.318793 --> -0.327028).  Saving model ...
Epoch: 22 cost time: 0.9909005165100098
Epoch: 22, Steps: 10 | Train Loss: 0.088 Vali Loss: 3.161 Vali Acc: 0.322 Test Loss: 3.161 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9263134002685547
Epoch: 23, Steps: 10 | Train Loss: 0.105 Vali Loss: 3.050 Vali Acc: 0.329 Test Loss: 3.050 Test Acc: 0.329
Validation loss decreased (-0.327028 --> -0.329381).  Saving model ...
Epoch: 24 cost time: 0.9668879508972168
Epoch: 24, Steps: 10 | Train Loss: 0.084 Vali Loss: 3.048 Vali Acc: 0.326 Test Loss: 3.048 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9794712066650391
Epoch: 25, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.057 Vali Acc: 0.333 Test Loss: 3.057 Test Acc: 0.333
Validation loss decreased (-0.329381 --> -0.332911).  Saving model ...
Epoch: 26 cost time: 0.8789944648742676
Epoch: 26, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.165 Vali Acc: 0.355 Test Loss: 3.165 Test Acc: 0.355
Validation loss decreased (-0.332911 --> -0.355262).  Saving model ...
Epoch: 27 cost time: 0.8236064910888672
Epoch: 27, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.104 Vali Acc: 0.338 Test Loss: 3.104 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9099366664886475
Epoch: 28, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.113 Vali Acc: 0.356 Test Loss: 3.113 Test Acc: 0.356
Validation loss decreased (-0.355262 --> -0.356439).  Saving model ...
Epoch: 29 cost time: 1.0000154972076416
Epoch: 29, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.157 Vali Acc: 0.353 Test Loss: 3.157 Test Acc: 0.353
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9659159183502197
Epoch: 30, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.195 Vali Acc: 0.347 Test Loss: 3.195 Test Acc: 0.347
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3564705882352941
model parameter : 2471034
model size : 10.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.9296388626098633
Epoch: 1, Steps: 10 | Train Loss: 3.413 Vali Loss: 3.295 Vali Acc: 0.041 Test Loss: 3.295 Test Acc: 0.041
Validation loss decreased (inf --> -0.041144).  Saving model ...
Epoch: 2 cost time: 0.7364182472229004
Epoch: 2, Steps: 10 | Train Loss: 3.255 Vali Loss: 3.264 Vali Acc: 0.051 Test Loss: 3.264 Test Acc: 0.051
Validation loss decreased (-0.041144 --> -0.050556).  Saving model ...
Epoch: 3 cost time: 0.7004306316375732
Epoch: 3, Steps: 10 | Train Loss: 3.008 Vali Loss: 3.271 Vali Acc: 0.074 Test Loss: 3.271 Test Acc: 0.074
Validation loss decreased (-0.050556 --> -0.074085).  Saving model ...
Epoch: 4 cost time: 0.7090339660644531
Epoch: 4, Steps: 10 | Train Loss: 2.783 Vali Loss: 3.240 Vali Acc: 0.092 Test Loss: 3.240 Test Acc: 0.092
Validation loss decreased (-0.074085 --> -0.091732).  Saving model ...
Epoch: 5 cost time: 0.7505502700805664
Epoch: 5, Steps: 10 | Train Loss: 2.512 Vali Loss: 3.174 Vali Acc: 0.131 Test Loss: 3.174 Test Acc: 0.131
Validation loss decreased (-0.091732 --> -0.130556).  Saving model ...
Epoch: 6 cost time: 0.712435245513916
Epoch: 6, Steps: 10 | Train Loss: 2.240 Vali Loss: 3.105 Vali Acc: 0.152 Test Loss: 3.105 Test Acc: 0.152
Validation loss decreased (-0.130556 --> -0.151734).  Saving model ...
Epoch: 7 cost time: 0.6769134998321533
Epoch: 7, Steps: 10 | Train Loss: 1.965 Vali Loss: 3.046 Vali Acc: 0.204 Test Loss: 3.046 Test Acc: 0.204
Validation loss decreased (-0.151734 --> -0.203499).  Saving model ...
Epoch: 8 cost time: 0.6320757865905762
Epoch: 8, Steps: 10 | Train Loss: 1.556 Vali Loss: 2.988 Vali Acc: 0.212 Test Loss: 2.988 Test Acc: 0.212
Validation loss decreased (-0.203499 --> -0.211735).  Saving model ...
Epoch: 9 cost time: 0.7356584072113037
Epoch: 9, Steps: 10 | Train Loss: 1.276 Vali Loss: 2.950 Vali Acc: 0.239 Test Loss: 2.950 Test Acc: 0.239
Validation loss decreased (-0.211735 --> -0.238794).  Saving model ...
Epoch: 10 cost time: 0.7483382225036621
Epoch: 10, Steps: 10 | Train Loss: 0.935 Vali Loss: 2.942 Vali Acc: 0.244 Test Loss: 2.942 Test Acc: 0.244
Validation loss decreased (-0.238794 --> -0.243500).  Saving model ...
Epoch: 11 cost time: 0.6619396209716797
Epoch: 11, Steps: 10 | Train Loss: 0.830 Vali Loss: 2.964 Vali Acc: 0.264 Test Loss: 2.964 Test Acc: 0.264
Validation loss decreased (-0.243500 --> -0.263500).  Saving model ...
Epoch: 12 cost time: 0.68269944190979
Epoch: 12, Steps: 10 | Train Loss: 0.515 Vali Loss: 2.936 Vali Acc: 0.280 Test Loss: 2.936 Test Acc: 0.280
Validation loss decreased (-0.263500 --> -0.279971).  Saving model ...
Epoch: 13 cost time: 0.6867375373840332
Epoch: 13, Steps: 10 | Train Loss: 0.368 Vali Loss: 3.022 Vali Acc: 0.276 Test Loss: 3.022 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6769149303436279
Epoch: 14, Steps: 10 | Train Loss: 0.284 Vali Loss: 2.989 Vali Acc: 0.300 Test Loss: 2.989 Test Acc: 0.300
Validation loss decreased (-0.279971 --> -0.299970).  Saving model ...
Epoch: 15 cost time: 0.6704721450805664
Epoch: 15, Steps: 10 | Train Loss: 0.179 Vali Loss: 3.065 Vali Acc: 0.305 Test Loss: 3.065 Test Acc: 0.305
Validation loss decreased (-0.299970 --> -0.304675).  Saving model ...
Epoch: 16 cost time: 0.6708190441131592
Epoch: 16, Steps: 10 | Train Loss: 0.188 Vali Loss: 3.069 Vali Acc: 0.316 Test Loss: 3.069 Test Acc: 0.316
Validation loss decreased (-0.304675 --> -0.316440).  Saving model ...
Epoch: 17 cost time: 0.6664233207702637
Epoch: 17, Steps: 10 | Train Loss: 0.150 Vali Loss: 3.121 Vali Acc: 0.318 Test Loss: 3.121 Test Acc: 0.318
Validation loss decreased (-0.316440 --> -0.317616).  Saving model ...
Epoch: 18 cost time: 0.6913406848907471
Epoch: 18, Steps: 10 | Train Loss: 0.173 Vali Loss: 3.183 Vali Acc: 0.325 Test Loss: 3.183 Test Acc: 0.325
Validation loss decreased (-0.317616 --> -0.324674).  Saving model ...
Epoch: 19 cost time: 0.6725461483001709
Epoch: 19, Steps: 10 | Train Loss: 0.091 Vali Loss: 3.153 Vali Acc: 0.333 Test Loss: 3.153 Test Acc: 0.333
Validation loss decreased (-0.324674 --> -0.332910).  Saving model ...
Epoch: 20 cost time: 0.7220752239227295
Epoch: 20, Steps: 10 | Train Loss: 0.098 Vali Loss: 3.157 Vali Acc: 0.336 Test Loss: 3.157 Test Acc: 0.336
Validation loss decreased (-0.332910 --> -0.336439).  Saving model ...
Epoch: 21 cost time: 0.6366801261901855
Epoch: 21, Steps: 10 | Train Loss: 0.073 Vali Loss: 3.189 Vali Acc: 0.324 Test Loss: 3.189 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.694138765335083
Epoch: 22, Steps: 10 | Train Loss: 0.081 Vali Loss: 3.201 Vali Acc: 0.327 Test Loss: 3.201 Test Acc: 0.327
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7497835159301758
Epoch: 23, Steps: 10 | Train Loss: 0.063 Vali Loss: 3.162 Vali Acc: 0.340 Test Loss: 3.162 Test Acc: 0.340
Validation loss decreased (-0.336439 --> -0.339968).  Saving model ...
Epoch: 24 cost time: 0.7040178775787354
Epoch: 24, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.209 Vali Acc: 0.334 Test Loss: 3.209 Test Acc: 0.334
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6490819454193115
Epoch: 25, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.263 Vali Acc: 0.341 Test Loss: 3.263 Test Acc: 0.341
Validation loss decreased (-0.339968 --> -0.341144).  Saving model ...
Epoch: 26 cost time: 0.7272412776947021
Epoch: 26, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.243 Vali Acc: 0.342 Test Loss: 3.243 Test Acc: 0.342
Validation loss decreased (-0.341144 --> -0.342321).  Saving model ...
Epoch: 27 cost time: 0.7009985446929932
Epoch: 27, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.255 Vali Acc: 0.347 Test Loss: 3.255 Test Acc: 0.347
Validation loss decreased (-0.342321 --> -0.347026).  Saving model ...
Epoch: 28 cost time: 0.7809851169586182
Epoch: 28, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.251 Vali Acc: 0.339 Test Loss: 3.251 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7367007732391357
Epoch: 29, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.254 Vali Acc: 0.331 Test Loss: 3.254 Test Acc: 0.331
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6622014045715332
Epoch: 30, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.333 Vali Acc: 0.342 Test Loss: 3.333 Test Acc: 0.342
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.34705882352941175
model parameter : 815866
model size : 3.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.304647922515869
Epoch: 1, Steps: 10 | Train Loss: 3.304 Vali Loss: 3.307 Vali Acc: 0.047 Test Loss: 3.307 Test Acc: 0.047
Validation loss decreased (inf --> -0.047026).  Saving model ...
Epoch: 2 cost time: 0.8056910037994385
Epoch: 2, Steps: 10 | Train Loss: 3.164 Vali Loss: 3.276 Vali Acc: 0.067 Test Loss: 3.276 Test Acc: 0.067
Validation loss decreased (-0.047026 --> -0.067026).  Saving model ...
Epoch: 3 cost time: 0.8604485988616943
Epoch: 3, Steps: 10 | Train Loss: 2.973 Vali Loss: 3.273 Vali Acc: 0.099 Test Loss: 3.273 Test Acc: 0.099
Validation loss decreased (-0.067026 --> -0.098791).  Saving model ...
Epoch: 4 cost time: 0.8068695068359375
Epoch: 4, Steps: 10 | Train Loss: 2.736 Vali Loss: 3.226 Vali Acc: 0.115 Test Loss: 3.226 Test Acc: 0.115
Validation loss decreased (-0.098791 --> -0.115262).  Saving model ...
Epoch: 5 cost time: 0.912006139755249
Epoch: 5, Steps: 10 | Train Loss: 2.519 Vali Loss: 3.178 Vali Acc: 0.146 Test Loss: 3.178 Test Acc: 0.146
Validation loss decreased (-0.115262 --> -0.145851).  Saving model ...
Epoch: 6 cost time: 0.8144052028656006
Epoch: 6, Steps: 10 | Train Loss: 2.155 Vali Loss: 3.116 Vali Acc: 0.158 Test Loss: 3.116 Test Acc: 0.158
Validation loss decreased (-0.145851 --> -0.157616).  Saving model ...
Epoch: 7 cost time: 0.7524909973144531
Epoch: 7, Steps: 10 | Train Loss: 1.919 Vali Loss: 3.071 Vali Acc: 0.171 Test Loss: 3.071 Test Acc: 0.171
Validation loss decreased (-0.157616 --> -0.170558).  Saving model ...
Epoch: 8 cost time: 0.7072749137878418
Epoch: 8, Steps: 10 | Train Loss: 1.624 Vali Loss: 3.055 Vali Acc: 0.195 Test Loss: 3.055 Test Acc: 0.195
Validation loss decreased (-0.170558 --> -0.195264).  Saving model ...
Epoch: 9 cost time: 0.7363033294677734
Epoch: 9, Steps: 10 | Train Loss: 1.349 Vali Loss: 3.065 Vali Acc: 0.204 Test Loss: 3.065 Test Acc: 0.204
Validation loss decreased (-0.195264 --> -0.203499).  Saving model ...
Epoch: 10 cost time: 0.7903590202331543
Epoch: 10, Steps: 10 | Train Loss: 1.054 Vali Loss: 2.974 Vali Acc: 0.244 Test Loss: 2.974 Test Acc: 0.244
Validation loss decreased (-0.203499 --> -0.243500).  Saving model ...
Epoch: 11 cost time: 0.7613174915313721
Epoch: 11, Steps: 10 | Train Loss: 0.784 Vali Loss: 2.996 Vali Acc: 0.256 Test Loss: 2.996 Test Acc: 0.256
Validation loss decreased (-0.243500 --> -0.256441).  Saving model ...
Epoch: 12 cost time: 0.8665194511413574
Epoch: 12, Steps: 10 | Train Loss: 0.649 Vali Loss: 3.012 Vali Acc: 0.269 Test Loss: 3.012 Test Acc: 0.269
Validation loss decreased (-0.256441 --> -0.269382).  Saving model ...
Epoch: 13 cost time: 0.8266823291778564
Epoch: 13, Steps: 10 | Train Loss: 0.417 Vali Loss: 2.955 Vali Acc: 0.304 Test Loss: 2.955 Test Acc: 0.304
Validation loss decreased (-0.269382 --> -0.303500).  Saving model ...
Epoch: 14 cost time: 0.769744873046875
Epoch: 14, Steps: 10 | Train Loss: 0.267 Vali Loss: 2.945 Vali Acc: 0.295 Test Loss: 2.945 Test Acc: 0.295
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7823765277862549
Epoch: 15, Steps: 10 | Train Loss: 0.249 Vali Loss: 2.959 Vali Acc: 0.306 Test Loss: 2.959 Test Acc: 0.306
Validation loss decreased (-0.303500 --> -0.305853).  Saving model ...
Epoch: 16 cost time: 0.7858037948608398
Epoch: 16, Steps: 10 | Train Loss: 0.131 Vali Loss: 3.007 Vali Acc: 0.311 Test Loss: 3.007 Test Acc: 0.311
Validation loss decreased (-0.305853 --> -0.310558).  Saving model ...
Epoch: 17 cost time: 0.7436504364013672
Epoch: 17, Steps: 10 | Train Loss: 0.150 Vali Loss: 2.979 Vali Acc: 0.313 Test Loss: 2.979 Test Acc: 0.313
Validation loss decreased (-0.310558 --> -0.312911).  Saving model ...
Epoch: 18 cost time: 0.7093868255615234
Epoch: 18, Steps: 10 | Train Loss: 0.089 Vali Loss: 2.982 Vali Acc: 0.336 Test Loss: 2.982 Test Acc: 0.336
Validation loss decreased (-0.312911 --> -0.336441).  Saving model ...
Epoch: 19 cost time: 0.7634861469268799
Epoch: 19, Steps: 10 | Train Loss: 0.086 Vali Loss: 2.989 Vali Acc: 0.338 Test Loss: 2.989 Test Acc: 0.338
Validation loss decreased (-0.336441 --> -0.337617).  Saving model ...
Epoch: 20 cost time: 0.7863025665283203
Epoch: 20, Steps: 10 | Train Loss: 0.081 Vali Loss: 3.096 Vali Acc: 0.331 Test Loss: 3.096 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7423202991485596
Epoch: 21, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.043 Vali Acc: 0.331 Test Loss: 3.043 Test Acc: 0.331
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.769291877746582
Epoch: 22, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.042 Vali Acc: 0.332 Test Loss: 3.042 Test Acc: 0.332
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7888367176055908
Epoch: 23, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.141 Vali Acc: 0.325 Test Loss: 3.141 Test Acc: 0.325
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.7261245250701904
Epoch: 24, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.125 Vali Acc: 0.326 Test Loss: 3.125 Test Acc: 0.326
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7037026882171631
Epoch: 25, Steps: 10 | Train Loss: 0.063 Vali Loss: 3.075 Vali Acc: 0.332 Test Loss: 3.075 Test Acc: 0.332
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.6854703426361084
Epoch: 26, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.173 Vali Acc: 0.325 Test Loss: 3.173 Test Acc: 0.325
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.7349612712860107
Epoch: 27, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.128 Vali Acc: 0.336 Test Loss: 3.128 Test Acc: 0.336
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.794400691986084
Epoch: 28, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.137 Vali Acc: 0.359 Test Loss: 3.137 Test Acc: 0.359
Validation loss decreased (-0.337617 --> -0.358792).  Saving model ...
Epoch: 29 cost time: 0.7640666961669922
Epoch: 29, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.136 Vali Acc: 0.353 Test Loss: 3.136 Test Acc: 0.353
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7520928382873535
Epoch: 30, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.250 Vali Acc: 0.344 Test Loss: 3.250 Test Acc: 0.344
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3588235294117647
model parameter : 2471034
model size : 10.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.8909449577331543
Epoch: 1, Steps: 10 | Train Loss: 3.408 Vali Loss: 3.297 Vali Acc: 0.045 Test Loss: 3.297 Test Acc: 0.045
Validation loss decreased (inf --> -0.044673).  Saving model ...
Epoch: 2 cost time: 0.6358439922332764
Epoch: 2, Steps: 10 | Train Loss: 3.252 Vali Loss: 3.268 Vali Acc: 0.041 Test Loss: 3.268 Test Acc: 0.041
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6288237571716309
Epoch: 3, Steps: 10 | Train Loss: 3.040 Vali Loss: 3.278 Vali Acc: 0.061 Test Loss: 3.278 Test Acc: 0.061
Validation loss decreased (-0.044673 --> -0.061144).  Saving model ...
Epoch: 4 cost time: 0.5700051784515381
Epoch: 4, Steps: 10 | Train Loss: 2.827 Vali Loss: 3.256 Vali Acc: 0.099 Test Loss: 3.256 Test Acc: 0.099
Validation loss decreased (-0.061144 --> -0.098791).  Saving model ...
Epoch: 5 cost time: 0.6033470630645752
Epoch: 5, Steps: 10 | Train Loss: 2.595 Vali Loss: 3.202 Vali Acc: 0.131 Test Loss: 3.202 Test Acc: 0.131
Validation loss decreased (-0.098791 --> -0.130556).  Saving model ...
Epoch: 6 cost time: 0.5824422836303711
Epoch: 6, Steps: 10 | Train Loss: 2.336 Vali Loss: 3.143 Vali Acc: 0.149 Test Loss: 3.143 Test Acc: 0.149
Validation loss decreased (-0.130556 --> -0.149380).  Saving model ...
Epoch: 7 cost time: 0.5933413505554199
Epoch: 7, Steps: 10 | Train Loss: 2.093 Vali Loss: 3.095 Vali Acc: 0.179 Test Loss: 3.095 Test Acc: 0.179
Validation loss decreased (-0.149380 --> -0.178793).  Saving model ...
Epoch: 8 cost time: 0.5996866226196289
Epoch: 8, Steps: 10 | Train Loss: 1.714 Vali Loss: 3.045 Vali Acc: 0.204 Test Loss: 3.045 Test Acc: 0.204
Validation loss decreased (-0.178793 --> -0.203499).  Saving model ...
Epoch: 9 cost time: 0.5676491260528564
Epoch: 9, Steps: 10 | Train Loss: 1.515 Vali Loss: 3.004 Vali Acc: 0.215 Test Loss: 3.004 Test Acc: 0.215
Validation loss decreased (-0.203499 --> -0.215264).  Saving model ...
Epoch: 10 cost time: 0.5441668033599854
Epoch: 10, Steps: 10 | Train Loss: 1.241 Vali Loss: 2.989 Vali Acc: 0.220 Test Loss: 2.989 Test Acc: 0.220
Validation loss decreased (-0.215264 --> -0.219970).  Saving model ...
Epoch: 11 cost time: 0.6041092872619629
Epoch: 11, Steps: 10 | Train Loss: 0.971 Vali Loss: 2.978 Vali Acc: 0.260 Test Loss: 2.978 Test Acc: 0.260
Validation loss decreased (-0.219970 --> -0.259970).  Saving model ...
Epoch: 12 cost time: 0.6149647235870361
Epoch: 12, Steps: 10 | Train Loss: 0.717 Vali Loss: 2.957 Vali Acc: 0.262 Test Loss: 2.957 Test Acc: 0.262
Validation loss decreased (-0.259970 --> -0.262323).  Saving model ...
Epoch: 13 cost time: 0.5842015743255615
Epoch: 13, Steps: 10 | Train Loss: 0.529 Vali Loss: 2.989 Vali Acc: 0.292 Test Loss: 2.989 Test Acc: 0.292
Validation loss decreased (-0.262323 --> -0.291735).  Saving model ...
Epoch: 14 cost time: 0.6243622303009033
Epoch: 14, Steps: 10 | Train Loss: 0.379 Vali Loss: 2.962 Vali Acc: 0.284 Test Loss: 2.962 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6074950695037842
Epoch: 15, Steps: 10 | Train Loss: 0.269 Vali Loss: 2.999 Vali Acc: 0.316 Test Loss: 2.999 Test Acc: 0.316
Validation loss decreased (-0.291735 --> -0.316441).  Saving model ...
Epoch: 16 cost time: 0.582827091217041
Epoch: 16, Steps: 10 | Train Loss: 0.217 Vali Loss: 3.018 Vali Acc: 0.312 Test Loss: 3.018 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.609560489654541
Epoch: 17, Steps: 10 | Train Loss: 0.137 Vali Loss: 3.061 Vali Acc: 0.311 Test Loss: 3.061 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6344585418701172
Epoch: 18, Steps: 10 | Train Loss: 0.100 Vali Loss: 3.071 Vali Acc: 0.320 Test Loss: 3.071 Test Acc: 0.320
Validation loss decreased (-0.316441 --> -0.319969).  Saving model ...
Epoch: 19 cost time: 0.5961172580718994
Epoch: 19, Steps: 10 | Train Loss: 0.142 Vali Loss: 3.110 Vali Acc: 0.318 Test Loss: 3.110 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5855712890625
Epoch: 20, Steps: 10 | Train Loss: 0.084 Vali Loss: 3.156 Vali Acc: 0.307 Test Loss: 3.156 Test Acc: 0.307
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5791890621185303
Epoch: 21, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.156 Vali Acc: 0.333 Test Loss: 3.156 Test Acc: 0.333
Validation loss decreased (-0.319969 --> -0.332910).  Saving model ...
Epoch: 22 cost time: 0.5805239677429199
Epoch: 22, Steps: 10 | Train Loss: 0.056 Vali Loss: 3.109 Vali Acc: 0.322 Test Loss: 3.109 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5726115703582764
Epoch: 23, Steps: 10 | Train Loss: 0.082 Vali Loss: 3.255 Vali Acc: 0.320 Test Loss: 3.255 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.594048261642456
Epoch: 24, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.223 Vali Acc: 0.315 Test Loss: 3.223 Test Acc: 0.315
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.5949587821960449
Epoch: 25, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.320 Vali Acc: 0.332 Test Loss: 3.320 Test Acc: 0.332
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.6129145622253418
Epoch: 26, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.231 Vali Acc: 0.331 Test Loss: 3.231 Test Acc: 0.331
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.6189224720001221
Epoch: 27, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.311 Vali Acc: 0.341 Test Loss: 3.311 Test Acc: 0.341
Validation loss decreased (-0.332910 --> -0.341143).  Saving model ...
Epoch: 28 cost time: 0.6409425735473633
Epoch: 28, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.323 Vali Acc: 0.319 Test Loss: 3.323 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5906331539154053
Epoch: 29, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.385 Vali Acc: 0.320 Test Loss: 3.385 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6292502880096436
Epoch: 30, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.341 Vali Acc: 0.333 Test Loss: 3.341 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3411764705882353
model parameter : 815866
model size : 3.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.267820119857788
Epoch: 1, Steps: 10 | Train Loss: 3.322 Vali Loss: 3.318 Vali Acc: 0.032 Test Loss: 3.318 Test Acc: 0.032
Validation loss decreased (inf --> -0.031732).  Saving model ...
Epoch: 2 cost time: 0.9579355716705322
Epoch: 2, Steps: 10 | Train Loss: 3.171 Vali Loss: 3.290 Vali Acc: 0.048 Test Loss: 3.290 Test Acc: 0.048
Validation loss decreased (-0.031732 --> -0.048202).  Saving model ...
Epoch: 3 cost time: 1.0538928508758545
Epoch: 3, Steps: 10 | Train Loss: 2.931 Vali Loss: 3.287 Vali Acc: 0.085 Test Loss: 3.287 Test Acc: 0.085
Validation loss decreased (-0.048202 --> -0.084673).  Saving model ...
Epoch: 4 cost time: 1.0566387176513672
Epoch: 4, Steps: 10 | Train Loss: 2.730 Vali Loss: 3.235 Vali Acc: 0.107 Test Loss: 3.235 Test Acc: 0.107
Validation loss decreased (-0.084673 --> -0.107026).  Saving model ...
Epoch: 5 cost time: 0.9502999782562256
Epoch: 5, Steps: 10 | Train Loss: 2.431 Vali Loss: 3.165 Vali Acc: 0.134 Test Loss: 3.165 Test Acc: 0.134
Validation loss decreased (-0.107026 --> -0.134086).  Saving model ...
Epoch: 6 cost time: 0.9377639293670654
Epoch: 6, Steps: 10 | Train Loss: 2.085 Vali Loss: 3.075 Vali Acc: 0.182 Test Loss: 3.075 Test Acc: 0.182
Validation loss decreased (-0.134086 --> -0.182322).  Saving model ...
Epoch: 7 cost time: 0.9928615093231201
Epoch: 7, Steps: 10 | Train Loss: 1.793 Vali Loss: 3.028 Vali Acc: 0.188 Test Loss: 3.028 Test Acc: 0.188
Validation loss decreased (-0.182322 --> -0.188205).  Saving model ...
Epoch: 8 cost time: 1.0292448997497559
Epoch: 8, Steps: 10 | Train Loss: 1.447 Vali Loss: 2.988 Vali Acc: 0.186 Test Loss: 2.988 Test Acc: 0.186
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1141581535339355
Epoch: 9, Steps: 10 | Train Loss: 1.129 Vali Loss: 2.960 Vali Acc: 0.225 Test Loss: 2.960 Test Acc: 0.225
Validation loss decreased (-0.188205 --> -0.224676).  Saving model ...
Epoch: 10 cost time: 1.042142629623413
Epoch: 10, Steps: 10 | Train Loss: 0.869 Vali Loss: 2.947 Vali Acc: 0.247 Test Loss: 2.947 Test Acc: 0.247
Validation loss decreased (-0.224676 --> -0.247029).  Saving model ...
Epoch: 11 cost time: 1.0908057689666748
Epoch: 11, Steps: 10 | Train Loss: 0.579 Vali Loss: 2.947 Vali Acc: 0.269 Test Loss: 2.947 Test Acc: 0.269
Validation loss decreased (-0.247029 --> -0.269382).  Saving model ...
Epoch: 12 cost time: 1.1192951202392578
Epoch: 12, Steps: 10 | Train Loss: 0.449 Vali Loss: 2.947 Vali Acc: 0.281 Test Loss: 2.947 Test Acc: 0.281
Validation loss decreased (-0.269382 --> -0.281147).  Saving model ...
Epoch: 13 cost time: 1.0301051139831543
Epoch: 13, Steps: 10 | Train Loss: 0.311 Vali Loss: 3.078 Vali Acc: 0.274 Test Loss: 3.078 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0940208435058594
Epoch: 14, Steps: 10 | Train Loss: 0.290 Vali Loss: 3.012 Vali Acc: 0.296 Test Loss: 3.012 Test Acc: 0.296
Validation loss decreased (-0.281147 --> -0.296440).  Saving model ...
Epoch: 15 cost time: 1.128584384918213
Epoch: 15, Steps: 10 | Train Loss: 0.164 Vali Loss: 3.066 Vali Acc: 0.298 Test Loss: 3.066 Test Acc: 0.298
Validation loss decreased (-0.296440 --> -0.297616).  Saving model ...
Epoch: 16 cost time: 1.065863847732544
Epoch: 16, Steps: 10 | Train Loss: 0.099 Vali Loss: 3.083 Vali Acc: 0.307 Test Loss: 3.083 Test Acc: 0.307
Validation loss decreased (-0.297616 --> -0.307028).  Saving model ...
Epoch: 17 cost time: 1.0950393676757812
Epoch: 17, Steps: 10 | Train Loss: 0.068 Vali Loss: 3.104 Vali Acc: 0.309 Test Loss: 3.104 Test Acc: 0.309
Validation loss decreased (-0.307028 --> -0.309381).  Saving model ...
Epoch: 18 cost time: 1.0819549560546875
Epoch: 18, Steps: 10 | Train Loss: 0.068 Vali Loss: 3.152 Vali Acc: 0.298 Test Loss: 3.152 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9174621105194092
Epoch: 19, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.221 Vali Acc: 0.324 Test Loss: 3.221 Test Acc: 0.324
Validation loss decreased (-0.309381 --> -0.323497).  Saving model ...
Epoch: 20 cost time: 0.896291971206665
Epoch: 20, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.188 Vali Acc: 0.309 Test Loss: 3.188 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.112255573272705
Epoch: 21, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.195 Vali Acc: 0.311 Test Loss: 3.195 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1072449684143066
Epoch: 22, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.162 Vali Acc: 0.308 Test Loss: 3.162 Test Acc: 0.308
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.1084346771240234
Epoch: 23, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.192 Vali Acc: 0.313 Test Loss: 3.192 Test Acc: 0.313
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.136035680770874
Epoch: 24, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.202 Vali Acc: 0.319 Test Loss: 3.202 Test Acc: 0.319
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.0231974124908447
Epoch: 25, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.348 Vali Acc: 0.316 Test Loss: 3.348 Test Acc: 0.316
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.017657995223999
Epoch: 26, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.239 Vali Acc: 0.313 Test Loss: 3.239 Test Acc: 0.313
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.1324982643127441
Epoch: 27, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.247 Vali Acc: 0.314 Test Loss: 3.247 Test Acc: 0.314
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.123323678970337
Epoch: 28, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.381 Vali Acc: 0.308 Test Loss: 3.381 Test Acc: 0.308
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.1485755443572998
Epoch: 29, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.359 Vali Acc: 0.320 Test Loss: 3.359 Test Acc: 0.320
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3235294117647059
model parameter : 1299194
model size : 5.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.033358573913574
Epoch: 1, Steps: 10 | Train Loss: 3.301 Vali Loss: 3.310 Vali Acc: 0.039 Test Loss: 3.310 Test Acc: 0.039
Validation loss decreased (inf --> -0.038790).  Saving model ...
Epoch: 2 cost time: 0.7642076015472412
Epoch: 2, Steps: 10 | Train Loss: 3.138 Vali Loss: 3.289 Vali Acc: 0.060 Test Loss: 3.289 Test Acc: 0.060
Validation loss decreased (-0.038790 --> -0.059967).  Saving model ...
Epoch: 3 cost time: 0.8267316818237305
Epoch: 3, Steps: 10 | Train Loss: 2.965 Vali Loss: 3.289 Vali Acc: 0.091 Test Loss: 3.289 Test Acc: 0.091
Validation loss decreased (-0.059967 --> -0.090555).  Saving model ...
Epoch: 4 cost time: 0.7637443542480469
Epoch: 4, Steps: 10 | Train Loss: 2.737 Vali Loss: 3.250 Vali Acc: 0.113 Test Loss: 3.250 Test Acc: 0.113
Validation loss decreased (-0.090555 --> -0.112909).  Saving model ...
Epoch: 5 cost time: 0.7823762893676758
Epoch: 5, Steps: 10 | Train Loss: 2.521 Vali Loss: 3.196 Vali Acc: 0.135 Test Loss: 3.196 Test Acc: 0.135
Validation loss decreased (-0.112909 --> -0.135262).  Saving model ...
Epoch: 6 cost time: 0.800997257232666
Epoch: 6, Steps: 10 | Train Loss: 2.203 Vali Loss: 3.152 Vali Acc: 0.162 Test Loss: 3.152 Test Acc: 0.162
Validation loss decreased (-0.135262 --> -0.162321).  Saving model ...
Epoch: 7 cost time: 0.7272109985351562
Epoch: 7, Steps: 10 | Train Loss: 1.908 Vali Loss: 3.075 Vali Acc: 0.186 Test Loss: 3.075 Test Acc: 0.186
Validation loss decreased (-0.162321 --> -0.185852).  Saving model ...
Epoch: 8 cost time: 0.851534366607666
Epoch: 8, Steps: 10 | Train Loss: 1.624 Vali Loss: 3.017 Vali Acc: 0.194 Test Loss: 3.017 Test Acc: 0.194
Validation loss decreased (-0.185852 --> -0.194087).  Saving model ...
Epoch: 9 cost time: 0.706026554107666
Epoch: 9, Steps: 10 | Train Loss: 1.277 Vali Loss: 3.006 Vali Acc: 0.212 Test Loss: 3.006 Test Acc: 0.212
Validation loss decreased (-0.194087 --> -0.211735).  Saving model ...
Epoch: 10 cost time: 0.7710936069488525
Epoch: 10, Steps: 10 | Train Loss: 1.032 Vali Loss: 2.977 Vali Acc: 0.238 Test Loss: 2.977 Test Acc: 0.238
Validation loss decreased (-0.211735 --> -0.237617).  Saving model ...
Epoch: 11 cost time: 0.7283802032470703
Epoch: 11, Steps: 10 | Train Loss: 0.747 Vali Loss: 3.022 Vali Acc: 0.235 Test Loss: 3.022 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8199994564056396
Epoch: 12, Steps: 10 | Train Loss: 0.509 Vali Loss: 2.972 Vali Acc: 0.275 Test Loss: 2.972 Test Acc: 0.275
Validation loss decreased (-0.237617 --> -0.275264).  Saving model ...
Epoch: 13 cost time: 0.6813366413116455
Epoch: 13, Steps: 10 | Train Loss: 0.402 Vali Loss: 3.020 Vali Acc: 0.273 Test Loss: 3.020 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7052781581878662
Epoch: 14, Steps: 10 | Train Loss: 0.248 Vali Loss: 3.034 Vali Acc: 0.288 Test Loss: 3.034 Test Acc: 0.288
Validation loss decreased (-0.275264 --> -0.288205).  Saving model ...
Epoch: 15 cost time: 0.7510960102081299
Epoch: 15, Steps: 10 | Train Loss: 0.169 Vali Loss: 3.051 Vali Acc: 0.302 Test Loss: 3.051 Test Acc: 0.302
Validation loss decreased (-0.288205 --> -0.302322).  Saving model ...
Epoch: 16 cost time: 0.7423186302185059
Epoch: 16, Steps: 10 | Train Loss: 0.139 Vali Loss: 3.108 Vali Acc: 0.312 Test Loss: 3.108 Test Acc: 0.312
Validation loss decreased (-0.302322 --> -0.311734).  Saving model ...
Epoch: 17 cost time: 0.6768183708190918
Epoch: 17, Steps: 10 | Train Loss: 0.091 Vali Loss: 3.091 Vali Acc: 0.314 Test Loss: 3.091 Test Acc: 0.314
Validation loss decreased (-0.311734 --> -0.314087).  Saving model ...
Epoch: 18 cost time: 0.7818119525909424
Epoch: 18, Steps: 10 | Train Loss: 0.078 Vali Loss: 3.116 Vali Acc: 0.331 Test Loss: 3.116 Test Acc: 0.331
Validation loss decreased (-0.314087 --> -0.330557).  Saving model ...
Epoch: 19 cost time: 0.7945530414581299
Epoch: 19, Steps: 10 | Train Loss: 0.078 Vali Loss: 3.112 Vali Acc: 0.320 Test Loss: 3.112 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7179450988769531
Epoch: 20, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.139 Vali Acc: 0.320 Test Loss: 3.139 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8180673122406006
Epoch: 21, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.134 Vali Acc: 0.334 Test Loss: 3.134 Test Acc: 0.334
Validation loss decreased (-0.330557 --> -0.334086).  Saving model ...
Epoch: 22 cost time: 0.8858089447021484
Epoch: 22, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.157 Vali Acc: 0.332 Test Loss: 3.157 Test Acc: 0.332
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7265803813934326
Epoch: 23, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.253 Vali Acc: 0.321 Test Loss: 3.253 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7724514007568359
Epoch: 24, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.215 Vali Acc: 0.329 Test Loss: 3.215 Test Acc: 0.329
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7444543838500977
Epoch: 25, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.189 Vali Acc: 0.329 Test Loss: 3.189 Test Acc: 0.329
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.8123400211334229
Epoch: 26, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.229 Vali Acc: 0.327 Test Loss: 3.229 Test Acc: 0.327
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.74855637550354
Epoch: 27, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.262 Vali Acc: 0.328 Test Loss: 3.262 Test Acc: 0.328
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.7643461227416992
Epoch: 28, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.273 Vali Acc: 0.313 Test Loss: 3.273 Test Acc: 0.313
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.8372857570648193
Epoch: 29, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.348 Vali Acc: 0.321 Test Loss: 3.348 Test Acc: 0.321
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.7425093650817871
Epoch: 30, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.258 Vali Acc: 0.319 Test Loss: 3.258 Test Acc: 0.319
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3341176470588235
model parameter : 471546
model size : 2.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.049506902694702
Epoch: 1, Steps: 10 | Train Loss: 3.325 Vali Loss: 3.319 Vali Acc: 0.031 Test Loss: 3.319 Test Acc: 0.031
Validation loss decreased (inf --> -0.030555).  Saving model ...
Epoch: 2 cost time: 0.7950229644775391
Epoch: 2, Steps: 10 | Train Loss: 3.177 Vali Loss: 3.293 Vali Acc: 0.046 Test Loss: 3.293 Test Acc: 0.046
Validation loss decreased (-0.030555 --> -0.045849).  Saving model ...
Epoch: 3 cost time: 0.838930606842041
Epoch: 3, Steps: 10 | Train Loss: 2.957 Vali Loss: 3.292 Vali Acc: 0.084 Test Loss: 3.292 Test Acc: 0.084
Validation loss decreased (-0.045849 --> -0.083496).  Saving model ...
Epoch: 4 cost time: 0.8282973766326904
Epoch: 4, Steps: 10 | Train Loss: 2.765 Vali Loss: 3.245 Vali Acc: 0.105 Test Loss: 3.245 Test Acc: 0.105
Validation loss decreased (-0.083496 --> -0.104673).  Saving model ...
Epoch: 5 cost time: 0.8065598011016846
Epoch: 5, Steps: 10 | Train Loss: 2.502 Vali Loss: 3.190 Vali Acc: 0.125 Test Loss: 3.190 Test Acc: 0.125
Validation loss decreased (-0.104673 --> -0.124674).  Saving model ...
Epoch: 6 cost time: 0.8035721778869629
Epoch: 6, Steps: 10 | Train Loss: 2.198 Vali Loss: 3.110 Vali Acc: 0.181 Test Loss: 3.110 Test Acc: 0.181
Validation loss decreased (-0.124674 --> -0.181145).  Saving model ...
Epoch: 7 cost time: 0.8272602558135986
Epoch: 7, Steps: 10 | Train Loss: 1.869 Vali Loss: 3.059 Vali Acc: 0.182 Test Loss: 3.059 Test Acc: 0.182
Validation loss decreased (-0.181145 --> -0.182322).  Saving model ...
Epoch: 8 cost time: 0.7673907279968262
Epoch: 8, Steps: 10 | Train Loss: 1.559 Vali Loss: 3.027 Vali Acc: 0.196 Test Loss: 3.027 Test Acc: 0.196
Validation loss decreased (-0.182322 --> -0.196440).  Saving model ...
Epoch: 9 cost time: 0.7537350654602051
Epoch: 9, Steps: 10 | Train Loss: 1.315 Vali Loss: 2.997 Vali Acc: 0.231 Test Loss: 2.997 Test Acc: 0.231
Validation loss decreased (-0.196440 --> -0.230558).  Saving model ...
Epoch: 10 cost time: 0.7491743564605713
Epoch: 10, Steps: 10 | Train Loss: 1.037 Vali Loss: 3.008 Vali Acc: 0.234 Test Loss: 3.008 Test Acc: 0.234
Validation loss decreased (-0.230558 --> -0.234088).  Saving model ...
Epoch: 11 cost time: 0.7760818004608154
Epoch: 11, Steps: 10 | Train Loss: 0.759 Vali Loss: 3.021 Vali Acc: 0.261 Test Loss: 3.021 Test Acc: 0.261
Validation loss decreased (-0.234088 --> -0.261146).  Saving model ...
Epoch: 12 cost time: 0.7598874568939209
Epoch: 12, Steps: 10 | Train Loss: 0.615 Vali Loss: 2.993 Vali Acc: 0.271 Test Loss: 2.993 Test Acc: 0.271
Validation loss decreased (-0.261146 --> -0.270558).  Saving model ...
Epoch: 13 cost time: 0.8025476932525635
Epoch: 13, Steps: 10 | Train Loss: 0.434 Vali Loss: 3.011 Vali Acc: 0.274 Test Loss: 3.011 Test Acc: 0.274
Validation loss decreased (-0.270558 --> -0.274088).  Saving model ...
Epoch: 14 cost time: 0.7757852077484131
Epoch: 14, Steps: 10 | Train Loss: 0.390 Vali Loss: 2.969 Vali Acc: 0.288 Test Loss: 2.969 Test Acc: 0.288
Validation loss decreased (-0.274088 --> -0.288206).  Saving model ...
Epoch: 15 cost time: 0.8086485862731934
Epoch: 15, Steps: 10 | Train Loss: 0.256 Vali Loss: 3.140 Vali Acc: 0.291 Test Loss: 3.140 Test Acc: 0.291
Validation loss decreased (-0.288206 --> -0.290557).  Saving model ...
Epoch: 16 cost time: 0.7719438076019287
Epoch: 16, Steps: 10 | Train Loss: 0.202 Vali Loss: 3.091 Vali Acc: 0.286 Test Loss: 3.091 Test Acc: 0.286
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6666433811187744
Epoch: 17, Steps: 10 | Train Loss: 0.111 Vali Loss: 3.158 Vali Acc: 0.309 Test Loss: 3.158 Test Acc: 0.309
Validation loss decreased (-0.290557 --> -0.309380).  Saving model ...
Epoch: 18 cost time: 0.8110008239746094
Epoch: 18, Steps: 10 | Train Loss: 0.089 Vali Loss: 3.093 Vali Acc: 0.305 Test Loss: 3.093 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7398371696472168
Epoch: 19, Steps: 10 | Train Loss: 0.138 Vali Loss: 3.120 Vali Acc: 0.315 Test Loss: 3.120 Test Acc: 0.315
Validation loss decreased (-0.309380 --> -0.315263).  Saving model ...
Epoch: 20 cost time: 0.7419397830963135
Epoch: 20, Steps: 10 | Train Loss: 0.066 Vali Loss: 3.086 Vali Acc: 0.331 Test Loss: 3.086 Test Acc: 0.331
Validation loss decreased (-0.315263 --> -0.330557).  Saving model ...
Epoch: 21 cost time: 0.7985684871673584
Epoch: 21, Steps: 10 | Train Loss: 0.068 Vali Loss: 3.099 Vali Acc: 0.316 Test Loss: 3.099 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7765488624572754
Epoch: 22, Steps: 10 | Train Loss: 0.080 Vali Loss: 3.101 Vali Acc: 0.320 Test Loss: 3.101 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.759713888168335
Epoch: 23, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.098 Vali Acc: 0.331 Test Loss: 3.098 Test Acc: 0.331
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6878533363342285
Epoch: 24, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.107 Vali Acc: 0.336 Test Loss: 3.107 Test Acc: 0.336
Validation loss decreased (-0.330557 --> -0.336440).  Saving model ...
Epoch: 25 cost time: 0.7974791526794434
Epoch: 25, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.157 Vali Acc: 0.338 Test Loss: 3.157 Test Acc: 0.338
Validation loss decreased (-0.336440 --> -0.337615).  Saving model ...
Epoch: 26 cost time: 0.7535398006439209
Epoch: 26, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.256 Vali Acc: 0.332 Test Loss: 3.256 Test Acc: 0.332
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7895920276641846
Epoch: 27, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.197 Vali Acc: 0.346 Test Loss: 3.197 Test Acc: 0.346
Validation loss decreased (-0.337615 --> -0.345850).  Saving model ...
Epoch: 28 cost time: 0.7992656230926514
Epoch: 28, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.205 Vali Acc: 0.340 Test Loss: 3.205 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7395904064178467
Epoch: 29, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.274 Vali Acc: 0.338 Test Loss: 3.274 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.7416069507598877
Epoch: 30, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.147 Vali Acc: 0.345 Test Loss: 3.147 Test Acc: 0.345
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3458823529411765
model parameter : 1299194
model size : 5.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.7808539867401123
Epoch: 1, Steps: 10 | Train Loss: 3.300 Vali Loss: 3.316 Vali Acc: 0.041 Test Loss: 3.316 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 0.6270241737365723
Epoch: 2, Steps: 10 | Train Loss: 3.134 Vali Loss: 3.295 Vali Acc: 0.058 Test Loss: 3.295 Test Acc: 0.058
Validation loss decreased (-0.041143 --> -0.057614).  Saving model ...
Epoch: 3 cost time: 0.6168344020843506
Epoch: 3, Steps: 10 | Train Loss: 2.957 Vali Loss: 3.296 Vali Acc: 0.087 Test Loss: 3.296 Test Acc: 0.087
Validation loss decreased (-0.057614 --> -0.087026).  Saving model ...
Epoch: 4 cost time: 0.6255402565002441
Epoch: 4, Steps: 10 | Train Loss: 2.751 Vali Loss: 3.258 Vali Acc: 0.105 Test Loss: 3.258 Test Acc: 0.105
Validation loss decreased (-0.087026 --> -0.104673).  Saving model ...
Epoch: 5 cost time: 0.6543211936950684
Epoch: 5, Steps: 10 | Train Loss: 2.530 Vali Loss: 3.208 Vali Acc: 0.126 Test Loss: 3.208 Test Acc: 0.126
Validation loss decreased (-0.104673 --> -0.125850).  Saving model ...
Epoch: 6 cost time: 0.6935086250305176
Epoch: 6, Steps: 10 | Train Loss: 2.271 Vali Loss: 3.168 Vali Acc: 0.161 Test Loss: 3.168 Test Acc: 0.161
Validation loss decreased (-0.125850 --> -0.161145).  Saving model ...
Epoch: 7 cost time: 0.6648051738739014
Epoch: 7, Steps: 10 | Train Loss: 1.982 Vali Loss: 3.101 Vali Acc: 0.181 Test Loss: 3.101 Test Acc: 0.181
Validation loss decreased (-0.161145 --> -0.181145).  Saving model ...
Epoch: 8 cost time: 0.6831357479095459
Epoch: 8, Steps: 10 | Train Loss: 1.673 Vali Loss: 3.045 Vali Acc: 0.181 Test Loss: 3.045 Test Acc: 0.181
Validation loss decreased (-0.181145 --> -0.181146).  Saving model ...
Epoch: 9 cost time: 0.6127822399139404
Epoch: 9, Steps: 10 | Train Loss: 1.320 Vali Loss: 3.021 Vali Acc: 0.211 Test Loss: 3.021 Test Acc: 0.211
Validation loss decreased (-0.181146 --> -0.210558).  Saving model ...
Epoch: 10 cost time: 0.6252548694610596
Epoch: 10, Steps: 10 | Train Loss: 1.230 Vali Loss: 2.999 Vali Acc: 0.225 Test Loss: 2.999 Test Acc: 0.225
Validation loss decreased (-0.210558 --> -0.224676).  Saving model ...
Epoch: 11 cost time: 0.628375768661499
Epoch: 11, Steps: 10 | Train Loss: 0.820 Vali Loss: 3.027 Vali Acc: 0.239 Test Loss: 3.027 Test Acc: 0.239
Validation loss decreased (-0.224676 --> -0.238793).  Saving model ...
Epoch: 12 cost time: 0.6325979232788086
Epoch: 12, Steps: 10 | Train Loss: 0.636 Vali Loss: 2.995 Vali Acc: 0.272 Test Loss: 2.995 Test Acc: 0.272
Validation loss decreased (-0.238793 --> -0.271735).  Saving model ...
Epoch: 13 cost time: 0.6192970275878906
Epoch: 13, Steps: 10 | Train Loss: 0.608 Vali Loss: 3.031 Vali Acc: 0.282 Test Loss: 3.031 Test Acc: 0.282
Validation loss decreased (-0.271735 --> -0.282323).  Saving model ...
Epoch: 14 cost time: 0.7092752456665039
Epoch: 14, Steps: 10 | Train Loss: 0.316 Vali Loss: 3.031 Vali Acc: 0.291 Test Loss: 3.031 Test Acc: 0.291
Validation loss decreased (-0.282323 --> -0.290558).  Saving model ...
Epoch: 15 cost time: 0.59859299659729
Epoch: 15, Steps: 10 | Train Loss: 0.276 Vali Loss: 3.051 Vali Acc: 0.300 Test Loss: 3.051 Test Acc: 0.300
Validation loss decreased (-0.290558 --> -0.299969).  Saving model ...
Epoch: 16 cost time: 0.6468138694763184
Epoch: 16, Steps: 10 | Train Loss: 0.260 Vali Loss: 3.043 Vali Acc: 0.298 Test Loss: 3.043 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6485350131988525
Epoch: 17, Steps: 10 | Train Loss: 0.221 Vali Loss: 3.100 Vali Acc: 0.309 Test Loss: 3.100 Test Acc: 0.309
Validation loss decreased (-0.299969 --> -0.309381).  Saving model ...
Epoch: 18 cost time: 0.6037111282348633
Epoch: 18, Steps: 10 | Train Loss: 0.144 Vali Loss: 3.167 Vali Acc: 0.307 Test Loss: 3.167 Test Acc: 0.307
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6239228248596191
Epoch: 19, Steps: 10 | Train Loss: 0.081 Vali Loss: 3.177 Vali Acc: 0.308 Test Loss: 3.177 Test Acc: 0.308
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6519749164581299
Epoch: 20, Steps: 10 | Train Loss: 0.068 Vali Loss: 3.175 Vali Acc: 0.316 Test Loss: 3.175 Test Acc: 0.316
Validation loss decreased (-0.309381 --> -0.316439).  Saving model ...
Epoch: 21 cost time: 0.6064651012420654
Epoch: 21, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.220 Vali Acc: 0.329 Test Loss: 3.220 Test Acc: 0.329
Validation loss decreased (-0.316439 --> -0.329380).  Saving model ...
Epoch: 22 cost time: 0.6454837322235107
Epoch: 22, Steps: 10 | Train Loss: 0.072 Vali Loss: 3.244 Vali Acc: 0.320 Test Loss: 3.244 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7109603881835938
Epoch: 23, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.228 Vali Acc: 0.321 Test Loss: 3.228 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.706566572189331
Epoch: 24, Steps: 10 | Train Loss: 0.082 Vali Loss: 3.226 Vali Acc: 0.321 Test Loss: 3.226 Test Acc: 0.321
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.5888552665710449
Epoch: 25, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.232 Vali Acc: 0.326 Test Loss: 3.232 Test Acc: 0.326
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.6889138221740723
Epoch: 26, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.316 Vali Acc: 0.326 Test Loss: 3.316 Test Acc: 0.326
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.680006742477417
Epoch: 27, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.305 Vali Acc: 0.335 Test Loss: 3.305 Test Acc: 0.335
Validation loss decreased (-0.329380 --> -0.335261).  Saving model ...
Epoch: 28 cost time: 0.606126070022583
Epoch: 28, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.416 Vali Acc: 0.319 Test Loss: 3.416 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7670657634735107
Epoch: 29, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.359 Vali Acc: 0.307 Test Loss: 3.359 Test Acc: 0.307
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.7233338356018066
Epoch: 30, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.377 Vali Acc: 0.314 Test Loss: 3.377 Test Acc: 0.314
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3352941176470588
model parameter : 471546
model size : 2.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.8738200664520264
Epoch: 1, Steps: 10 | Train Loss: 3.321 Vali Loss: 3.315 Vali Acc: 0.035 Test Loss: 3.315 Test Acc: 0.035
Validation loss decreased (inf --> -0.035261).  Saving model ...
Epoch: 2 cost time: 0.5440607070922852
Epoch: 2, Steps: 10 | Train Loss: 3.169 Vali Loss: 3.291 Vali Acc: 0.048 Test Loss: 3.291 Test Acc: 0.048
Validation loss decreased (-0.035261 --> -0.048202).  Saving model ...
Epoch: 3 cost time: 0.6054508686065674
Epoch: 3, Steps: 10 | Train Loss: 2.962 Vali Loss: 3.294 Vali Acc: 0.078 Test Loss: 3.294 Test Acc: 0.078
Validation loss decreased (-0.048202 --> -0.077614).  Saving model ...
Epoch: 4 cost time: 0.6194272041320801
Epoch: 4, Steps: 10 | Train Loss: 2.774 Vali Loss: 3.252 Vali Acc: 0.108 Test Loss: 3.252 Test Acc: 0.108
Validation loss decreased (-0.077614 --> -0.108203).  Saving model ...
Epoch: 5 cost time: 0.6395699977874756
Epoch: 5, Steps: 10 | Train Loss: 2.517 Vali Loss: 3.205 Vali Acc: 0.128 Test Loss: 3.205 Test Acc: 0.128
Validation loss decreased (-0.108203 --> -0.128203).  Saving model ...
Epoch: 6 cost time: 0.5771267414093018
Epoch: 6, Steps: 10 | Train Loss: 2.272 Vali Loss: 3.143 Vali Acc: 0.158 Test Loss: 3.143 Test Acc: 0.158
Validation loss decreased (-0.128203 --> -0.157616).  Saving model ...
Epoch: 7 cost time: 0.5859405994415283
Epoch: 7, Steps: 10 | Train Loss: 1.964 Vali Loss: 3.110 Vali Acc: 0.171 Test Loss: 3.110 Test Acc: 0.171
Validation loss decreased (-0.157616 --> -0.170557).  Saving model ...
Epoch: 8 cost time: 0.6063566207885742
Epoch: 8, Steps: 10 | Train Loss: 1.701 Vali Loss: 3.098 Vali Acc: 0.176 Test Loss: 3.098 Test Acc: 0.176
Validation loss decreased (-0.170557 --> -0.176440).  Saving model ...
Epoch: 9 cost time: 0.5439586639404297
Epoch: 9, Steps: 10 | Train Loss: 1.456 Vali Loss: 3.051 Vali Acc: 0.212 Test Loss: 3.051 Test Acc: 0.212
Validation loss decreased (-0.176440 --> -0.211734).  Saving model ...
Epoch: 10 cost time: 0.5818414688110352
Epoch: 10, Steps: 10 | Train Loss: 1.216 Vali Loss: 3.067 Vali Acc: 0.218 Test Loss: 3.067 Test Acc: 0.218
Validation loss decreased (-0.211734 --> -0.217616).  Saving model ...
Epoch: 11 cost time: 0.5403780937194824
Epoch: 11, Steps: 10 | Train Loss: 0.975 Vali Loss: 3.066 Vali Acc: 0.238 Test Loss: 3.066 Test Acc: 0.238
Validation loss decreased (-0.217616 --> -0.237616).  Saving model ...
Epoch: 12 cost time: 0.6355328559875488
Epoch: 12, Steps: 10 | Train Loss: 0.791 Vali Loss: 3.014 Vali Acc: 0.264 Test Loss: 3.014 Test Acc: 0.264
Validation loss decreased (-0.237616 --> -0.263499).  Saving model ...
Epoch: 13 cost time: 0.6127889156341553
Epoch: 13, Steps: 10 | Train Loss: 0.623 Vali Loss: 3.048 Vali Acc: 0.276 Test Loss: 3.048 Test Acc: 0.276
Validation loss decreased (-0.263499 --> -0.276440).  Saving model ...
Epoch: 14 cost time: 0.6083962917327881
Epoch: 14, Steps: 10 | Train Loss: 0.576 Vali Loss: 3.034 Vali Acc: 0.280 Test Loss: 3.034 Test Acc: 0.280
Validation loss decreased (-0.276440 --> -0.279970).  Saving model ...
Epoch: 15 cost time: 0.8010337352752686
Epoch: 15, Steps: 10 | Train Loss: 0.336 Vali Loss: 3.068 Vali Acc: 0.304 Test Loss: 3.068 Test Acc: 0.304
Validation loss decreased (-0.279970 --> -0.303499).  Saving model ...
Epoch: 16 cost time: 0.7569491863250732
Epoch: 16, Steps: 10 | Train Loss: 0.233 Vali Loss: 3.048 Vali Acc: 0.307 Test Loss: 3.048 Test Acc: 0.307
Validation loss decreased (-0.303499 --> -0.307028).  Saving model ...
Epoch: 17 cost time: 0.7699353694915771
Epoch: 17, Steps: 10 | Train Loss: 0.152 Vali Loss: 3.079 Vali Acc: 0.311 Test Loss: 3.079 Test Acc: 0.311
Validation loss decreased (-0.307028 --> -0.310557).  Saving model ...
Epoch: 18 cost time: 0.7467401027679443
Epoch: 18, Steps: 10 | Train Loss: 0.146 Vali Loss: 3.098 Vali Acc: 0.316 Test Loss: 3.098 Test Acc: 0.316
Validation loss decreased (-0.310557 --> -0.316440).  Saving model ...
Epoch: 19 cost time: 0.770578145980835
Epoch: 19, Steps: 10 | Train Loss: 0.130 Vali Loss: 3.134 Vali Acc: 0.326 Test Loss: 3.134 Test Acc: 0.326
Validation loss decreased (-0.316440 --> -0.325851).  Saving model ...
Epoch: 20 cost time: 0.7979512214660645
Epoch: 20, Steps: 10 | Train Loss: 0.115 Vali Loss: 3.154 Vali Acc: 0.329 Test Loss: 3.154 Test Acc: 0.329
Validation loss decreased (-0.325851 --> -0.329380).  Saving model ...
Epoch: 21 cost time: 0.7464497089385986
Epoch: 21, Steps: 10 | Train Loss: 0.085 Vali Loss: 3.202 Vali Acc: 0.321 Test Loss: 3.202 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7256174087524414
Epoch: 22, Steps: 10 | Train Loss: 0.076 Vali Loss: 3.147 Vali Acc: 0.341 Test Loss: 3.147 Test Acc: 0.341
Validation loss decreased (-0.329380 --> -0.341145).  Saving model ...
Epoch: 23 cost time: 0.9203329086303711
Epoch: 23, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.214 Vali Acc: 0.347 Test Loss: 3.214 Test Acc: 0.347
Validation loss decreased (-0.341145 --> -0.347027).  Saving model ...
Epoch: 24 cost time: 0.7288498878479004
Epoch: 24, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.151 Vali Acc: 0.342 Test Loss: 3.151 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6878011226654053
Epoch: 25, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.242 Vali Acc: 0.339 Test Loss: 3.242 Test Acc: 0.339
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6828408241271973
Epoch: 26, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.224 Vali Acc: 0.336 Test Loss: 3.224 Test Acc: 0.336
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.7338407039642334
Epoch: 27, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.302 Vali Acc: 0.332 Test Loss: 3.302 Test Acc: 0.332
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.6492116451263428
Epoch: 28, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.244 Vali Acc: 0.345 Test Loss: 3.244 Test Acc: 0.345
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.6731996536254883
Epoch: 29, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.228 Vali Acc: 0.346 Test Loss: 3.228 Test Acc: 0.346
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.8279221057891846
Epoch: 30, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.303 Vali Acc: 0.345 Test Loss: 3.303 Test Acc: 0.345
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.34705882352941175
model parameter : 1299194
model size : 5.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.7499675750732422
Epoch: 1, Steps: 10 | Train Loss: 3.312 Vali Loss: 3.320 Vali Acc: 0.045 Test Loss: 3.320 Test Acc: 0.045
Validation loss decreased (inf --> -0.044673).  Saving model ...
Epoch: 2 cost time: 0.5741207599639893
Epoch: 2, Steps: 10 | Train Loss: 3.133 Vali Loss: 3.301 Vali Acc: 0.058 Test Loss: 3.301 Test Acc: 0.058
Validation loss decreased (-0.044673 --> -0.057614).  Saving model ...
Epoch: 3 cost time: 0.748063325881958
Epoch: 3, Steps: 10 | Train Loss: 2.982 Vali Loss: 3.304 Vali Acc: 0.080 Test Loss: 3.304 Test Acc: 0.080
Validation loss decreased (-0.057614 --> -0.079967).  Saving model ...
Epoch: 4 cost time: 0.6237437725067139
Epoch: 4, Steps: 10 | Train Loss: 2.773 Vali Loss: 3.270 Vali Acc: 0.102 Test Loss: 3.270 Test Acc: 0.102
Validation loss decreased (-0.079967 --> -0.102320).  Saving model ...
Epoch: 5 cost time: 0.6133956909179688
Epoch: 5, Steps: 10 | Train Loss: 2.599 Vali Loss: 3.225 Vali Acc: 0.126 Test Loss: 3.225 Test Acc: 0.126
Validation loss decreased (-0.102320 --> -0.125850).  Saving model ...
Epoch: 6 cost time: 0.5738182067871094
Epoch: 6, Steps: 10 | Train Loss: 2.348 Vali Loss: 3.193 Vali Acc: 0.153 Test Loss: 3.193 Test Acc: 0.153
Validation loss decreased (-0.125850 --> -0.152909).  Saving model ...
Epoch: 7 cost time: 0.6059167385101318
Epoch: 7, Steps: 10 | Train Loss: 2.085 Vali Loss: 3.128 Vali Acc: 0.167 Test Loss: 3.128 Test Acc: 0.167
Validation loss decreased (-0.152909 --> -0.167028).  Saving model ...
Epoch: 8 cost time: 0.6106038093566895
Epoch: 8, Steps: 10 | Train Loss: 1.842 Vali Loss: 3.074 Vali Acc: 0.186 Test Loss: 3.074 Test Acc: 0.186
Validation loss decreased (-0.167028 --> -0.185852).  Saving model ...
Epoch: 9 cost time: 0.6045169830322266
Epoch: 9, Steps: 10 | Train Loss: 1.580 Vali Loss: 3.055 Vali Acc: 0.208 Test Loss: 3.055 Test Acc: 0.208
Validation loss decreased (-0.185852 --> -0.208205).  Saving model ...
Epoch: 10 cost time: 0.552208423614502
Epoch: 10, Steps: 10 | Train Loss: 1.346 Vali Loss: 3.044 Vali Acc: 0.220 Test Loss: 3.044 Test Acc: 0.220
Validation loss decreased (-0.208205 --> -0.219970).  Saving model ...
Epoch: 11 cost time: 0.5624089241027832
Epoch: 11, Steps: 10 | Train Loss: 1.072 Vali Loss: 3.057 Vali Acc: 0.228 Test Loss: 3.057 Test Acc: 0.228
Validation loss decreased (-0.219970 --> -0.228205).  Saving model ...
Epoch: 12 cost time: 0.6013286113739014
Epoch: 12, Steps: 10 | Train Loss: 0.868 Vali Loss: 3.041 Vali Acc: 0.238 Test Loss: 3.041 Test Acc: 0.238
Validation loss decreased (-0.228205 --> -0.237617).  Saving model ...
Epoch: 13 cost time: 0.6220300197601318
Epoch: 13, Steps: 10 | Train Loss: 0.724 Vali Loss: 3.050 Vali Acc: 0.253 Test Loss: 3.050 Test Acc: 0.253
Validation loss decreased (-0.237617 --> -0.252911).  Saving model ...
Epoch: 14 cost time: 0.6896336078643799
Epoch: 14, Steps: 10 | Train Loss: 0.486 Vali Loss: 3.073 Vali Acc: 0.269 Test Loss: 3.073 Test Acc: 0.269
Validation loss decreased (-0.252911 --> -0.269381).  Saving model ...
Epoch: 15 cost time: 0.6655428409576416
Epoch: 15, Steps: 10 | Train Loss: 0.461 Vali Loss: 3.074 Vali Acc: 0.279 Test Loss: 3.074 Test Acc: 0.279
Validation loss decreased (-0.269381 --> -0.278793).  Saving model ...
Epoch: 16 cost time: 0.611987829208374
Epoch: 16, Steps: 10 | Train Loss: 0.374 Vali Loss: 3.099 Vali Acc: 0.291 Test Loss: 3.099 Test Acc: 0.291
Validation loss decreased (-0.278793 --> -0.290557).  Saving model ...
Epoch: 17 cost time: 0.6306257247924805
Epoch: 17, Steps: 10 | Train Loss: 0.242 Vali Loss: 3.101 Vali Acc: 0.307 Test Loss: 3.101 Test Acc: 0.307
Validation loss decreased (-0.290557 --> -0.307028).  Saving model ...
Epoch: 18 cost time: 0.6063642501831055
Epoch: 18, Steps: 10 | Train Loss: 0.182 Vali Loss: 3.152 Vali Acc: 0.314 Test Loss: 3.152 Test Acc: 0.314
Validation loss decreased (-0.307028 --> -0.314086).  Saving model ...
Epoch: 19 cost time: 0.6476268768310547
Epoch: 19, Steps: 10 | Train Loss: 0.127 Vali Loss: 3.173 Vali Acc: 0.325 Test Loss: 3.173 Test Acc: 0.325
Validation loss decreased (-0.314086 --> -0.324674).  Saving model ...
Epoch: 20 cost time: 0.6433236598968506
Epoch: 20, Steps: 10 | Train Loss: 0.080 Vali Loss: 3.191 Vali Acc: 0.325 Test Loss: 3.191 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5854854583740234
Epoch: 21, Steps: 10 | Train Loss: 0.069 Vali Loss: 3.217 Vali Acc: 0.325 Test Loss: 3.217 Test Acc: 0.325
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5845532417297363
Epoch: 22, Steps: 10 | Train Loss: 0.069 Vali Loss: 3.247 Vali Acc: 0.326 Test Loss: 3.247 Test Acc: 0.326
Validation loss decreased (-0.324674 --> -0.325850).  Saving model ...
Epoch: 23 cost time: 0.5380582809448242
Epoch: 23, Steps: 10 | Train Loss: 0.060 Vali Loss: 3.275 Vali Acc: 0.309 Test Loss: 3.275 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5991790294647217
Epoch: 24, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.243 Vali Acc: 0.326 Test Loss: 3.243 Test Acc: 0.326
Validation loss decreased (-0.325850 --> -0.325850).  Saving model ...
Epoch: 25 cost time: 0.6581430435180664
Epoch: 25, Steps: 10 | Train Loss: 0.058 Vali Loss: 3.381 Vali Acc: 0.331 Test Loss: 3.381 Test Acc: 0.331
Validation loss decreased (-0.325850 --> -0.330554).  Saving model ...
Epoch: 26 cost time: 0.5859982967376709
Epoch: 26, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.366 Vali Acc: 0.322 Test Loss: 3.366 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5727593898773193
Epoch: 27, Steps: 10 | Train Loss: 0.043 Vali Loss: 3.362 Vali Acc: 0.327 Test Loss: 3.362 Test Acc: 0.327
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.5783746242523193
Epoch: 28, Steps: 10 | Train Loss: 0.043 Vali Loss: 3.304 Vali Acc: 0.322 Test Loss: 3.304 Test Acc: 0.322
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.44777965545654297
Epoch: 29, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.335 Vali Acc: 0.320 Test Loss: 3.335 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.598529577255249
Epoch: 30, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.410 Vali Acc: 0.322 Test Loss: 3.410 Test Acc: 0.322
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3305882352941176
model parameter : 471546
model size : 2.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.713707685470581
Epoch: 1, Steps: 10 | Train Loss: 3.364 Vali Loss: 3.281 Vali Acc: 0.048 Test Loss: 3.281 Test Acc: 0.048
Validation loss decreased (inf --> -0.048202).  Saving model ...
Epoch: 2 cost time: 1.2160427570343018
Epoch: 2, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.251 Vali Acc: 0.073 Test Loss: 3.251 Test Acc: 0.073
Validation loss decreased (-0.048202 --> -0.072909).  Saving model ...
Epoch: 3 cost time: 1.1961286067962646
Epoch: 3, Steps: 10 | Train Loss: 3.087 Vali Loss: 3.251 Vali Acc: 0.072 Test Loss: 3.251 Test Acc: 0.072
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9965476989746094
Epoch: 4, Steps: 10 | Train Loss: 2.945 Vali Loss: 3.232 Vali Acc: 0.099 Test Loss: 3.232 Test Acc: 0.099
Validation loss decreased (-0.072909 --> -0.098791).  Saving model ...
Epoch: 5 cost time: 1.068166732788086
Epoch: 5, Steps: 10 | Train Loss: 2.798 Vali Loss: 3.204 Vali Acc: 0.127 Test Loss: 3.204 Test Acc: 0.127
Validation loss decreased (-0.098791 --> -0.127027).  Saving model ...
Epoch: 6 cost time: 0.9369425773620605
Epoch: 6, Steps: 10 | Train Loss: 2.557 Vali Loss: 3.150 Vali Acc: 0.151 Test Loss: 3.150 Test Acc: 0.151
Validation loss decreased (-0.127027 --> -0.150557).  Saving model ...
Epoch: 7 cost time: 1.05934476852417
Epoch: 7, Steps: 10 | Train Loss: 2.323 Vali Loss: 3.106 Vali Acc: 0.148 Test Loss: 3.106 Test Acc: 0.148
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0665497779846191
Epoch: 8, Steps: 10 | Train Loss: 2.046 Vali Loss: 3.058 Vali Acc: 0.161 Test Loss: 3.058 Test Acc: 0.161
Validation loss decreased (-0.150557 --> -0.161146).  Saving model ...
Epoch: 9 cost time: 1.2739574909210205
Epoch: 9, Steps: 10 | Train Loss: 1.794 Vali Loss: 3.043 Vali Acc: 0.184 Test Loss: 3.043 Test Acc: 0.184
Validation loss decreased (-0.161146 --> -0.183499).  Saving model ...
Epoch: 10 cost time: 1.203462839126587
Epoch: 10, Steps: 10 | Train Loss: 1.602 Vali Loss: 3.037 Vali Acc: 0.180 Test Loss: 3.037 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1405980587005615
Epoch: 11, Steps: 10 | Train Loss: 1.364 Vali Loss: 3.058 Vali Acc: 0.202 Test Loss: 3.058 Test Acc: 0.202
Validation loss decreased (-0.183499 --> -0.202322).  Saving model ...
Epoch: 12 cost time: 1.161370038986206
Epoch: 12, Steps: 10 | Train Loss: 1.117 Vali Loss: 3.038 Vali Acc: 0.208 Test Loss: 3.038 Test Acc: 0.208
Validation loss decreased (-0.202322 --> -0.208205).  Saving model ...
Epoch: 13 cost time: 1.0817914009094238
Epoch: 13, Steps: 10 | Train Loss: 0.945 Vali Loss: 3.053 Vali Acc: 0.220 Test Loss: 3.053 Test Acc: 0.220
Validation loss decreased (-0.208205 --> -0.219969).  Saving model ...
Epoch: 14 cost time: 1.139636754989624
Epoch: 14, Steps: 10 | Train Loss: 0.785 Vali Loss: 3.025 Vali Acc: 0.228 Test Loss: 3.025 Test Acc: 0.228
Validation loss decreased (-0.219969 --> -0.228205).  Saving model ...
Epoch: 15 cost time: 0.9210689067840576
Epoch: 15, Steps: 10 | Train Loss: 0.610 Vali Loss: 3.050 Vali Acc: 0.248 Test Loss: 3.050 Test Acc: 0.248
Validation loss decreased (-0.228205 --> -0.248205).  Saving model ...
Epoch: 16 cost time: 1.0192196369171143
Epoch: 16, Steps: 10 | Train Loss: 0.449 Vali Loss: 3.063 Vali Acc: 0.268 Test Loss: 3.063 Test Acc: 0.268
Validation loss decreased (-0.248205 --> -0.268205).  Saving model ...
Epoch: 17 cost time: 1.0118732452392578
Epoch: 17, Steps: 10 | Train Loss: 0.358 Vali Loss: 3.112 Vali Acc: 0.262 Test Loss: 3.112 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.042492389678955
Epoch: 18, Steps: 10 | Train Loss: 0.232 Vali Loss: 3.100 Vali Acc: 0.272 Test Loss: 3.100 Test Acc: 0.272
Validation loss decreased (-0.268205 --> -0.271734).  Saving model ...
Epoch: 19 cost time: 1.019852638244629
Epoch: 19, Steps: 10 | Train Loss: 0.192 Vali Loss: 3.160 Vali Acc: 0.279 Test Loss: 3.160 Test Acc: 0.279
Validation loss decreased (-0.271734 --> -0.278792).  Saving model ...
Epoch: 20 cost time: 1.1563739776611328
Epoch: 20, Steps: 10 | Train Loss: 0.203 Vali Loss: 3.167 Vali Acc: 0.275 Test Loss: 3.167 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.125319480895996
Epoch: 21, Steps: 10 | Train Loss: 0.237 Vali Loss: 3.178 Vali Acc: 0.280 Test Loss: 3.178 Test Acc: 0.280
Validation loss decreased (-0.278792 --> -0.279968).  Saving model ...
Epoch: 22 cost time: 1.1584267616271973
Epoch: 22, Steps: 10 | Train Loss: 0.104 Vali Loss: 3.145 Vali Acc: 0.284 Test Loss: 3.145 Test Acc: 0.284
Validation loss decreased (-0.279968 --> -0.283498).  Saving model ...
Epoch: 23 cost time: 1.1262154579162598
Epoch: 23, Steps: 10 | Train Loss: 0.090 Vali Loss: 3.192 Vali Acc: 0.286 Test Loss: 3.192 Test Acc: 0.286
Validation loss decreased (-0.283498 --> -0.285850).  Saving model ...
Epoch: 24 cost time: 1.1429059505462646
Epoch: 24, Steps: 10 | Train Loss: 0.079 Vali Loss: 3.180 Vali Acc: 0.302 Test Loss: 3.180 Test Acc: 0.302
Validation loss decreased (-0.285850 --> -0.302321).  Saving model ...
Epoch: 25 cost time: 1.1127009391784668
Epoch: 25, Steps: 10 | Train Loss: 0.101 Vali Loss: 3.190 Vali Acc: 0.296 Test Loss: 3.190 Test Acc: 0.296
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1566133499145508
Epoch: 26, Steps: 10 | Train Loss: 0.088 Vali Loss: 3.189 Vali Acc: 0.284 Test Loss: 3.189 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0245873928070068
Epoch: 27, Steps: 10 | Train Loss: 0.063 Vali Loss: 3.297 Vali Acc: 0.289 Test Loss: 3.297 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9980597496032715
Epoch: 28, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.223 Vali Acc: 0.302 Test Loss: 3.223 Test Acc: 0.302
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.0215694904327393
Epoch: 29, Steps: 10 | Train Loss: 0.136 Vali Loss: 3.229 Vali Acc: 0.289 Test Loss: 3.229 Test Acc: 0.289
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.0536565780639648
Epoch: 30, Steps: 10 | Train Loss: 0.083 Vali Loss: 3.225 Vali Acc: 0.301 Test Loss: 3.225 Test Acc: 0.301
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3023529411764706
model parameter : 1235914
model size : 5.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.227128028869629
Epoch: 1, Steps: 10 | Train Loss: 3.327 Vali Loss: 3.299 Vali Acc: 0.044 Test Loss: 3.299 Test Acc: 0.044
Validation loss decreased (inf --> -0.043496).  Saving model ...
Epoch: 2 cost time: 0.8982410430908203
Epoch: 2, Steps: 10 | Train Loss: 3.247 Vali Loss: 3.283 Vali Acc: 0.040 Test Loss: 3.283 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8606350421905518
Epoch: 3, Steps: 10 | Train Loss: 3.124 Vali Loss: 3.276 Vali Acc: 0.053 Test Loss: 3.276 Test Acc: 0.053
Validation loss decreased (-0.043496 --> -0.052908).  Saving model ...
Epoch: 4 cost time: 0.9020845890045166
Epoch: 4, Steps: 10 | Train Loss: 3.000 Vali Loss: 3.276 Vali Acc: 0.069 Test Loss: 3.276 Test Acc: 0.069
Validation loss decreased (-0.052908 --> -0.069379).  Saving model ...
Epoch: 5 cost time: 0.85679030418396
Epoch: 5, Steps: 10 | Train Loss: 2.852 Vali Loss: 3.253 Vali Acc: 0.081 Test Loss: 3.253 Test Acc: 0.081
Validation loss decreased (-0.069379 --> -0.081144).  Saving model ...
Epoch: 6 cost time: 0.938709020614624
Epoch: 6, Steps: 10 | Train Loss: 2.678 Vali Loss: 3.216 Vali Acc: 0.108 Test Loss: 3.216 Test Acc: 0.108
Validation loss decreased (-0.081144 --> -0.108203).  Saving model ...
Epoch: 7 cost time: 0.7455990314483643
Epoch: 7, Steps: 10 | Train Loss: 2.454 Vali Loss: 3.179 Vali Acc: 0.128 Test Loss: 3.179 Test Acc: 0.128
Validation loss decreased (-0.108203 --> -0.128204).  Saving model ...
Epoch: 8 cost time: 0.787632942199707
Epoch: 8, Steps: 10 | Train Loss: 2.304 Vali Loss: 3.151 Vali Acc: 0.146 Test Loss: 3.151 Test Acc: 0.146
Validation loss decreased (-0.128204 --> -0.145851).  Saving model ...
Epoch: 9 cost time: 0.8338098526000977
Epoch: 9, Steps: 10 | Train Loss: 2.024 Vali Loss: 3.122 Vali Acc: 0.155 Test Loss: 3.122 Test Acc: 0.155
Validation loss decreased (-0.145851 --> -0.155263).  Saving model ...
Epoch: 10 cost time: 0.8390786647796631
Epoch: 10, Steps: 10 | Train Loss: 1.804 Vali Loss: 3.091 Vali Acc: 0.182 Test Loss: 3.091 Test Acc: 0.182
Validation loss decreased (-0.155263 --> -0.182322).  Saving model ...
Epoch: 11 cost time: 0.8831729888916016
Epoch: 11, Steps: 10 | Train Loss: 1.568 Vali Loss: 3.077 Vali Acc: 0.180 Test Loss: 3.077 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8731131553649902
Epoch: 12, Steps: 10 | Train Loss: 1.352 Vali Loss: 3.050 Vali Acc: 0.195 Test Loss: 3.050 Test Acc: 0.195
Validation loss decreased (-0.182322 --> -0.195264).  Saving model ...
Epoch: 13 cost time: 0.9004063606262207
Epoch: 13, Steps: 10 | Train Loss: 1.154 Vali Loss: 3.023 Vali Acc: 0.200 Test Loss: 3.023 Test Acc: 0.200
Validation loss decreased (-0.195264 --> -0.199970).  Saving model ...
Epoch: 14 cost time: 0.869774580001831
Epoch: 14, Steps: 10 | Train Loss: 0.942 Vali Loss: 2.998 Vali Acc: 0.215 Test Loss: 2.998 Test Acc: 0.215
Validation loss decreased (-0.199970 --> -0.215264).  Saving model ...
Epoch: 15 cost time: 0.9453253746032715
Epoch: 15, Steps: 10 | Train Loss: 0.854 Vali Loss: 3.003 Vali Acc: 0.224 Test Loss: 3.003 Test Acc: 0.224
Validation loss decreased (-0.215264 --> -0.223499).  Saving model ...
Epoch: 16 cost time: 0.8528423309326172
Epoch: 16, Steps: 10 | Train Loss: 0.630 Vali Loss: 3.023 Vali Acc: 0.233 Test Loss: 3.023 Test Acc: 0.233
Validation loss decreased (-0.223499 --> -0.232911).  Saving model ...
Epoch: 17 cost time: 0.8477087020874023
Epoch: 17, Steps: 10 | Train Loss: 0.535 Vali Loss: 3.087 Vali Acc: 0.225 Test Loss: 3.087 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8696498870849609
Epoch: 18, Steps: 10 | Train Loss: 0.403 Vali Loss: 3.017 Vali Acc: 0.256 Test Loss: 3.017 Test Acc: 0.256
Validation loss decreased (-0.232911 --> -0.256440).  Saving model ...
Epoch: 19 cost time: 0.8707640171051025
Epoch: 19, Steps: 10 | Train Loss: 0.311 Vali Loss: 3.087 Vali Acc: 0.262 Test Loss: 3.087 Test Acc: 0.262
Validation loss decreased (-0.256440 --> -0.262322).  Saving model ...
Epoch: 20 cost time: 0.853398323059082
Epoch: 20, Steps: 10 | Train Loss: 0.246 Vali Loss: 3.087 Vali Acc: 0.253 Test Loss: 3.087 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.816810131072998
Epoch: 21, Steps: 10 | Train Loss: 0.244 Vali Loss: 3.121 Vali Acc: 0.275 Test Loss: 3.121 Test Acc: 0.275
Validation loss decreased (-0.262322 --> -0.275263).  Saving model ...
Epoch: 22 cost time: 0.8023734092712402
Epoch: 22, Steps: 10 | Train Loss: 0.175 Vali Loss: 3.066 Vali Acc: 0.268 Test Loss: 3.066 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8156867027282715
Epoch: 23, Steps: 10 | Train Loss: 0.183 Vali Loss: 3.138 Vali Acc: 0.268 Test Loss: 3.138 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8285362720489502
Epoch: 24, Steps: 10 | Train Loss: 0.120 Vali Loss: 3.141 Vali Acc: 0.273 Test Loss: 3.141 Test Acc: 0.273
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.8062779903411865
Epoch: 25, Steps: 10 | Train Loss: 0.090 Vali Loss: 3.171 Vali Acc: 0.274 Test Loss: 3.171 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.8946981430053711
Epoch: 26, Steps: 10 | Train Loss: 0.094 Vali Loss: 3.129 Vali Acc: 0.291 Test Loss: 3.129 Test Acc: 0.291
Validation loss decreased (-0.275263 --> -0.290557).  Saving model ...
Epoch: 27 cost time: 0.8347866535186768
Epoch: 27, Steps: 10 | Train Loss: 0.066 Vali Loss: 3.183 Vali Acc: 0.288 Test Loss: 3.183 Test Acc: 0.288
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8757624626159668
Epoch: 28, Steps: 10 | Train Loss: 0.066 Vali Loss: 3.156 Vali Acc: 0.295 Test Loss: 3.156 Test Acc: 0.295
Validation loss decreased (-0.290557 --> -0.295263).  Saving model ...
Epoch: 29 cost time: 0.9128847122192383
Epoch: 29, Steps: 10 | Train Loss: 0.067 Vali Loss: 3.185 Vali Acc: 0.292 Test Loss: 3.185 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8947188854217529
Epoch: 30, Steps: 10 | Train Loss: 0.105 Vali Loss: 3.128 Vali Acc: 0.293 Test Loss: 3.128 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2952941176470588
model parameter : 408202
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.637110471725464
Epoch: 1, Steps: 10 | Train Loss: 3.360 Vali Loss: 3.279 Vali Acc: 0.052 Test Loss: 3.279 Test Acc: 0.052
Validation loss decreased (inf --> -0.051732).  Saving model ...
Epoch: 2 cost time: 0.9907541275024414
Epoch: 2, Steps: 10 | Train Loss: 3.252 Vali Loss: 3.252 Vali Acc: 0.066 Test Loss: 3.252 Test Acc: 0.066
Validation loss decreased (-0.051732 --> -0.065850).  Saving model ...
Epoch: 3 cost time: 0.9758298397064209
Epoch: 3, Steps: 10 | Train Loss: 3.095 Vali Loss: 3.255 Vali Acc: 0.069 Test Loss: 3.255 Test Acc: 0.069
Validation loss decreased (-0.065850 --> -0.069379).  Saving model ...
Epoch: 4 cost time: 0.9723472595214844
Epoch: 4, Steps: 10 | Train Loss: 2.975 Vali Loss: 3.243 Vali Acc: 0.091 Test Loss: 3.243 Test Acc: 0.091
Validation loss decreased (-0.069379 --> -0.090556).  Saving model ...
Epoch: 5 cost time: 0.8790085315704346
Epoch: 5, Steps: 10 | Train Loss: 2.846 Vali Loss: 3.226 Vali Acc: 0.111 Test Loss: 3.226 Test Acc: 0.111
Validation loss decreased (-0.090556 --> -0.110556).  Saving model ...
Epoch: 6 cost time: 0.9571192264556885
Epoch: 6, Steps: 10 | Train Loss: 2.653 Vali Loss: 3.177 Vali Acc: 0.132 Test Loss: 3.177 Test Acc: 0.132
Validation loss decreased (-0.110556 --> -0.131733).  Saving model ...
Epoch: 7 cost time: 1.0145938396453857
Epoch: 7, Steps: 10 | Train Loss: 2.471 Vali Loss: 3.145 Vali Acc: 0.151 Test Loss: 3.145 Test Acc: 0.151
Validation loss decreased (-0.131733 --> -0.150557).  Saving model ...
Epoch: 8 cost time: 0.982912540435791
Epoch: 8, Steps: 10 | Train Loss: 2.214 Vali Loss: 3.113 Vali Acc: 0.154 Test Loss: 3.113 Test Acc: 0.154
Validation loss decreased (-0.150557 --> -0.154087).  Saving model ...
Epoch: 9 cost time: 0.9893045425415039
Epoch: 9, Steps: 10 | Train Loss: 2.012 Vali Loss: 3.082 Vali Acc: 0.172 Test Loss: 3.082 Test Acc: 0.172
Validation loss decreased (-0.154087 --> -0.171734).  Saving model ...
Epoch: 10 cost time: 0.9741730690002441
Epoch: 10, Steps: 10 | Train Loss: 1.890 Vali Loss: 3.084 Vali Acc: 0.181 Test Loss: 3.084 Test Acc: 0.181
Validation loss decreased (-0.171734 --> -0.181146).  Saving model ...
Epoch: 11 cost time: 0.9367437362670898
Epoch: 11, Steps: 10 | Train Loss: 1.637 Vali Loss: 3.067 Vali Acc: 0.198 Test Loss: 3.067 Test Acc: 0.198
Validation loss decreased (-0.181146 --> -0.197616).  Saving model ...
Epoch: 12 cost time: 0.9795711040496826
Epoch: 12, Steps: 10 | Train Loss: 1.477 Vali Loss: 3.041 Vali Acc: 0.205 Test Loss: 3.041 Test Acc: 0.205
Validation loss decreased (-0.197616 --> -0.204675).  Saving model ...
Epoch: 13 cost time: 1.050168514251709
Epoch: 13, Steps: 10 | Train Loss: 1.267 Vali Loss: 3.026 Vali Acc: 0.231 Test Loss: 3.026 Test Acc: 0.231
Validation loss decreased (-0.204675 --> -0.230558).  Saving model ...
Epoch: 14 cost time: 0.9096634387969971
Epoch: 14, Steps: 10 | Train Loss: 1.080 Vali Loss: 2.984 Vali Acc: 0.248 Test Loss: 2.984 Test Acc: 0.248
Validation loss decreased (-0.230558 --> -0.248205).  Saving model ...
Epoch: 15 cost time: 0.8372321128845215
Epoch: 15, Steps: 10 | Train Loss: 0.932 Vali Loss: 3.015 Vali Acc: 0.252 Test Loss: 3.015 Test Acc: 0.252
Validation loss decreased (-0.248205 --> -0.251735).  Saving model ...
Epoch: 16 cost time: 0.8318099975585938
Epoch: 16, Steps: 10 | Train Loss: 0.723 Vali Loss: 2.995 Vali Acc: 0.288 Test Loss: 2.995 Test Acc: 0.288
Validation loss decreased (-0.251735 --> -0.288205).  Saving model ...
Epoch: 17 cost time: 0.8954148292541504
Epoch: 17, Steps: 10 | Train Loss: 0.557 Vali Loss: 2.969 Vali Acc: 0.296 Test Loss: 2.969 Test Acc: 0.296
Validation loss decreased (-0.288205 --> -0.296441).  Saving model ...
Epoch: 18 cost time: 0.9185750484466553
Epoch: 18, Steps: 10 | Train Loss: 0.445 Vali Loss: 2.979 Vali Acc: 0.305 Test Loss: 2.979 Test Acc: 0.305
Validation loss decreased (-0.296441 --> -0.304676).  Saving model ...
Epoch: 19 cost time: 0.908184289932251
Epoch: 19, Steps: 10 | Train Loss: 0.353 Vali Loss: 3.024 Vali Acc: 0.308 Test Loss: 3.024 Test Acc: 0.308
Validation loss decreased (-0.304676 --> -0.308205).  Saving model ...
Epoch: 20 cost time: 0.9385020732879639
Epoch: 20, Steps: 10 | Train Loss: 0.248 Vali Loss: 2.973 Vali Acc: 0.326 Test Loss: 2.973 Test Acc: 0.326
Validation loss decreased (-0.308205 --> -0.325853).  Saving model ...
Epoch: 21 cost time: 1.0110223293304443
Epoch: 21, Steps: 10 | Train Loss: 0.264 Vali Loss: 3.008 Vali Acc: 0.322 Test Loss: 3.008 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.978736162185669
Epoch: 22, Steps: 10 | Train Loss: 0.161 Vali Loss: 2.991 Vali Acc: 0.325 Test Loss: 2.991 Test Acc: 0.325
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9178869724273682
Epoch: 23, Steps: 10 | Train Loss: 0.147 Vali Loss: 3.070 Vali Acc: 0.318 Test Loss: 3.070 Test Acc: 0.318
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9296140670776367
Epoch: 24, Steps: 10 | Train Loss: 0.160 Vali Loss: 3.022 Vali Acc: 0.338 Test Loss: 3.022 Test Acc: 0.338
Validation loss decreased (-0.325853 --> -0.337617).  Saving model ...
Epoch: 25 cost time: 0.959550142288208
Epoch: 25, Steps: 10 | Train Loss: 0.135 Vali Loss: 3.061 Vali Acc: 0.329 Test Loss: 3.061 Test Acc: 0.329
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0390119552612305
Epoch: 26, Steps: 10 | Train Loss: 0.094 Vali Loss: 3.034 Vali Acc: 0.346 Test Loss: 3.034 Test Acc: 0.346
Validation loss decreased (-0.337617 --> -0.345852).  Saving model ...
Epoch: 27 cost time: 0.9371075630187988
Epoch: 27, Steps: 10 | Train Loss: 0.097 Vali Loss: 3.108 Vali Acc: 0.332 Test Loss: 3.108 Test Acc: 0.332
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8574807643890381
Epoch: 28, Steps: 10 | Train Loss: 0.075 Vali Loss: 3.007 Vali Acc: 0.344 Test Loss: 3.007 Test Acc: 0.344
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8777127265930176
Epoch: 29, Steps: 10 | Train Loss: 0.101 Vali Loss: 3.065 Vali Acc: 0.339 Test Loss: 3.065 Test Acc: 0.339
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.8294727802276611
Epoch: 30, Steps: 10 | Train Loss: 0.083 Vali Loss: 3.059 Vali Acc: 0.336 Test Loss: 3.059 Test Acc: 0.336
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3458823529411765
model parameter : 1235914
model size : 5.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.210824966430664
Epoch: 1, Steps: 10 | Train Loss: 3.330 Vali Loss: 3.304 Vali Acc: 0.051 Test Loss: 3.304 Test Acc: 0.051
Validation loss decreased (inf --> -0.050555).  Saving model ...
Epoch: 2 cost time: 0.8052120208740234
Epoch: 2, Steps: 10 | Train Loss: 3.252 Vali Loss: 3.289 Vali Acc: 0.038 Test Loss: 3.289 Test Acc: 0.038
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7537229061126709
Epoch: 3, Steps: 10 | Train Loss: 3.140 Vali Loss: 3.285 Vali Acc: 0.053 Test Loss: 3.285 Test Acc: 0.053
Validation loss decreased (-0.050555 --> -0.052908).  Saving model ...
Epoch: 4 cost time: 0.8939661979675293
Epoch: 4, Steps: 10 | Train Loss: 3.035 Vali Loss: 3.288 Vali Acc: 0.073 Test Loss: 3.288 Test Acc: 0.073
Validation loss decreased (-0.052908 --> -0.072908).  Saving model ...
Epoch: 5 cost time: 0.8541409969329834
Epoch: 5, Steps: 10 | Train Loss: 2.900 Vali Loss: 3.270 Vali Acc: 0.075 Test Loss: 3.270 Test Acc: 0.075
Validation loss decreased (-0.072908 --> -0.075261).  Saving model ...
Epoch: 6 cost time: 0.7653779983520508
Epoch: 6, Steps: 10 | Train Loss: 2.747 Vali Loss: 3.235 Vali Acc: 0.095 Test Loss: 3.235 Test Acc: 0.095
Validation loss decreased (-0.075261 --> -0.095262).  Saving model ...
Epoch: 7 cost time: 0.859424352645874
Epoch: 7, Steps: 10 | Train Loss: 2.569 Vali Loss: 3.199 Vali Acc: 0.105 Test Loss: 3.199 Test Acc: 0.105
Validation loss decreased (-0.095262 --> -0.104674).  Saving model ...
Epoch: 8 cost time: 0.8362274169921875
Epoch: 8, Steps: 10 | Train Loss: 2.425 Vali Loss: 3.169 Vali Acc: 0.133 Test Loss: 3.169 Test Acc: 0.133
Validation loss decreased (-0.104674 --> -0.132909).  Saving model ...
Epoch: 9 cost time: 0.6864602565765381
Epoch: 9, Steps: 10 | Train Loss: 2.185 Vali Loss: 3.133 Vali Acc: 0.152 Test Loss: 3.133 Test Acc: 0.152
Validation loss decreased (-0.132909 --> -0.151733).  Saving model ...
Epoch: 10 cost time: 0.770207405090332
Epoch: 10, Steps: 10 | Train Loss: 1.988 Vali Loss: 3.112 Vali Acc: 0.161 Test Loss: 3.112 Test Acc: 0.161
Validation loss decreased (-0.151733 --> -0.161145).  Saving model ...
Epoch: 11 cost time: 0.7066102027893066
Epoch: 11, Steps: 10 | Train Loss: 1.801 Vali Loss: 3.089 Vali Acc: 0.178 Test Loss: 3.089 Test Acc: 0.178
Validation loss decreased (-0.161145 --> -0.177616).  Saving model ...
Epoch: 12 cost time: 0.7082693576812744
Epoch: 12, Steps: 10 | Train Loss: 1.619 Vali Loss: 3.063 Vali Acc: 0.195 Test Loss: 3.063 Test Acc: 0.195
Validation loss decreased (-0.177616 --> -0.195263).  Saving model ...
Epoch: 13 cost time: 0.7040281295776367
Epoch: 13, Steps: 10 | Train Loss: 1.462 Vali Loss: 3.034 Vali Acc: 0.209 Test Loss: 3.034 Test Acc: 0.209
Validation loss decreased (-0.195263 --> -0.209381).  Saving model ...
Epoch: 14 cost time: 0.6727132797241211
Epoch: 14, Steps: 10 | Train Loss: 1.198 Vali Loss: 2.991 Vali Acc: 0.212 Test Loss: 2.991 Test Acc: 0.212
Validation loss decreased (-0.209381 --> -0.211735).  Saving model ...
Epoch: 15 cost time: 0.7963669300079346
Epoch: 15, Steps: 10 | Train Loss: 1.082 Vali Loss: 2.988 Vali Acc: 0.238 Test Loss: 2.988 Test Acc: 0.238
Validation loss decreased (-0.211735 --> -0.237617).  Saving model ...
Epoch: 16 cost time: 0.690190315246582
Epoch: 16, Steps: 10 | Train Loss: 0.792 Vali Loss: 2.955 Vali Acc: 0.264 Test Loss: 2.955 Test Acc: 0.264
Validation loss decreased (-0.237617 --> -0.263500).  Saving model ...
Epoch: 17 cost time: 0.7360398769378662
Epoch: 17, Steps: 10 | Train Loss: 0.682 Vali Loss: 3.026 Vali Acc: 0.255 Test Loss: 3.026 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8485233783721924
Epoch: 18, Steps: 10 | Train Loss: 0.644 Vali Loss: 2.971 Vali Acc: 0.256 Test Loss: 2.971 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7811851501464844
Epoch: 19, Steps: 10 | Train Loss: 0.478 Vali Loss: 2.985 Vali Acc: 0.272 Test Loss: 2.985 Test Acc: 0.272
Validation loss decreased (-0.263500 --> -0.271735).  Saving model ...
Epoch: 20 cost time: 0.8067021369934082
Epoch: 20, Steps: 10 | Train Loss: 0.342 Vali Loss: 3.050 Vali Acc: 0.273 Test Loss: 3.050 Test Acc: 0.273
Validation loss decreased (-0.271735 --> -0.272911).  Saving model ...
Epoch: 21 cost time: 0.8168723583221436
Epoch: 21, Steps: 10 | Train Loss: 0.330 Vali Loss: 2.979 Vali Acc: 0.278 Test Loss: 2.979 Test Acc: 0.278
Validation loss decreased (-0.272911 --> -0.277617).  Saving model ...
Epoch: 22 cost time: 0.7520308494567871
Epoch: 22, Steps: 10 | Train Loss: 0.235 Vali Loss: 3.021 Vali Acc: 0.284 Test Loss: 3.021 Test Acc: 0.284
Validation loss decreased (-0.277617 --> -0.283499).  Saving model ...
Epoch: 23 cost time: 0.8071515560150146
Epoch: 23, Steps: 10 | Train Loss: 0.261 Vali Loss: 2.995 Vali Acc: 0.300 Test Loss: 2.995 Test Acc: 0.300
Validation loss decreased (-0.283499 --> -0.299970).  Saving model ...
Epoch: 24 cost time: 0.7097697257995605
Epoch: 24, Steps: 10 | Train Loss: 0.154 Vali Loss: 3.040 Vali Acc: 0.294 Test Loss: 3.040 Test Acc: 0.294
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7594559192657471
Epoch: 25, Steps: 10 | Train Loss: 0.191 Vali Loss: 3.066 Vali Acc: 0.301 Test Loss: 3.066 Test Acc: 0.301
Validation loss decreased (-0.299970 --> -0.301146).  Saving model ...
Epoch: 26 cost time: 0.7565252780914307
Epoch: 26, Steps: 10 | Train Loss: 0.144 Vali Loss: 3.020 Vali Acc: 0.299 Test Loss: 3.020 Test Acc: 0.299
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7344732284545898
Epoch: 27, Steps: 10 | Train Loss: 0.114 Vali Loss: 3.017 Vali Acc: 0.307 Test Loss: 3.017 Test Acc: 0.307
Validation loss decreased (-0.301146 --> -0.307029).  Saving model ...
Epoch: 28 cost time: 0.6948165893554688
Epoch: 28, Steps: 10 | Train Loss: 0.151 Vali Loss: 3.102 Vali Acc: 0.307 Test Loss: 3.102 Test Acc: 0.307
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6427538394927979
Epoch: 29, Steps: 10 | Train Loss: 0.086 Vali Loss: 3.110 Vali Acc: 0.304 Test Loss: 3.110 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.7918641567230225
Epoch: 30, Steps: 10 | Train Loss: 0.095 Vali Loss: 3.078 Vali Acc: 0.309 Test Loss: 3.078 Test Acc: 0.309
Validation loss decreased (-0.307029 --> -0.309381).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.30941176470588233
model parameter : 408202
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.0355944633483887
Epoch: 1, Steps: 10 | Train Loss: 3.361 Vali Loss: 3.280 Vali Acc: 0.053 Test Loss: 3.280 Test Acc: 0.053
Validation loss decreased (inf --> -0.052908).  Saving model ...
Epoch: 2 cost time: 0.7984910011291504
Epoch: 2, Steps: 10 | Train Loss: 3.276 Vali Loss: 3.258 Vali Acc: 0.067 Test Loss: 3.258 Test Acc: 0.067
Validation loss decreased (-0.052908 --> -0.067026).  Saving model ...
Epoch: 3 cost time: 0.8115255832672119
Epoch: 3, Steps: 10 | Train Loss: 3.135 Vali Loss: 3.266 Vali Acc: 0.066 Test Loss: 3.266 Test Acc: 0.066
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8012151718139648
Epoch: 4, Steps: 10 | Train Loss: 3.024 Vali Loss: 3.263 Vali Acc: 0.069 Test Loss: 3.263 Test Acc: 0.069
Validation loss decreased (-0.067026 --> -0.069379).  Saving model ...
Epoch: 5 cost time: 0.7189724445343018
Epoch: 5, Steps: 10 | Train Loss: 2.930 Vali Loss: 3.254 Vali Acc: 0.085 Test Loss: 3.254 Test Acc: 0.085
Validation loss decreased (-0.069379 --> -0.084673).  Saving model ...
Epoch: 6 cost time: 0.7271173000335693
Epoch: 6, Steps: 10 | Train Loss: 2.797 Vali Loss: 3.220 Vali Acc: 0.114 Test Loss: 3.220 Test Acc: 0.114
Validation loss decreased (-0.084673 --> -0.114085).  Saving model ...
Epoch: 7 cost time: 0.7832803726196289
Epoch: 7, Steps: 10 | Train Loss: 2.619 Vali Loss: 3.192 Vali Acc: 0.118 Test Loss: 3.192 Test Acc: 0.118
Validation loss decreased (-0.114085 --> -0.117615).  Saving model ...
Epoch: 8 cost time: 0.7373108863830566
Epoch: 8, Steps: 10 | Train Loss: 2.465 Vali Loss: 3.158 Vali Acc: 0.139 Test Loss: 3.158 Test Acc: 0.139
Validation loss decreased (-0.117615 --> -0.138792).  Saving model ...
Epoch: 9 cost time: 0.6759233474731445
Epoch: 9, Steps: 10 | Train Loss: 2.260 Vali Loss: 3.124 Vali Acc: 0.164 Test Loss: 3.124 Test Acc: 0.164
Validation loss decreased (-0.138792 --> -0.163498).  Saving model ...
Epoch: 10 cost time: 0.6391830444335938
Epoch: 10, Steps: 10 | Train Loss: 2.048 Vali Loss: 3.118 Vali Acc: 0.168 Test Loss: 3.118 Test Acc: 0.168
Validation loss decreased (-0.163498 --> -0.168204).  Saving model ...
Epoch: 11 cost time: 0.620030403137207
Epoch: 11, Steps: 10 | Train Loss: 1.825 Vali Loss: 3.065 Vali Acc: 0.189 Test Loss: 3.065 Test Acc: 0.189
Validation loss decreased (-0.168204 --> -0.189381).  Saving model ...
Epoch: 12 cost time: 0.7646574974060059
Epoch: 12, Steps: 10 | Train Loss: 1.627 Vali Loss: 3.052 Vali Acc: 0.202 Test Loss: 3.052 Test Acc: 0.202
Validation loss decreased (-0.189381 --> -0.202322).  Saving model ...
Epoch: 13 cost time: 0.7292430400848389
Epoch: 13, Steps: 10 | Train Loss: 1.366 Vali Loss: 3.060 Vali Acc: 0.215 Test Loss: 3.060 Test Acc: 0.215
Validation loss decreased (-0.202322 --> -0.215264).  Saving model ...
Epoch: 14 cost time: 0.7148137092590332
Epoch: 14, Steps: 10 | Train Loss: 1.146 Vali Loss: 2.999 Vali Acc: 0.240 Test Loss: 2.999 Test Acc: 0.240
Validation loss decreased (-0.215264 --> -0.239970).  Saving model ...
Epoch: 15 cost time: 0.7163403034210205
Epoch: 15, Steps: 10 | Train Loss: 1.095 Vali Loss: 3.011 Vali Acc: 0.252 Test Loss: 3.011 Test Acc: 0.252
Validation loss decreased (-0.239970 --> -0.251735).  Saving model ...
Epoch: 16 cost time: 0.7121880054473877
Epoch: 16, Steps: 10 | Train Loss: 0.869 Vali Loss: 3.014 Vali Acc: 0.247 Test Loss: 3.014 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7321453094482422
Epoch: 17, Steps: 10 | Train Loss: 0.706 Vali Loss: 3.019 Vali Acc: 0.278 Test Loss: 3.019 Test Acc: 0.278
Validation loss decreased (-0.251735 --> -0.277617).  Saving model ...
Epoch: 18 cost time: 0.7164435386657715
Epoch: 18, Steps: 10 | Train Loss: 0.530 Vali Loss: 3.031 Vali Acc: 0.271 Test Loss: 3.031 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6961698532104492
Epoch: 19, Steps: 10 | Train Loss: 0.486 Vali Loss: 3.032 Vali Acc: 0.296 Test Loss: 3.032 Test Acc: 0.296
Validation loss decreased (-0.277617 --> -0.296440).  Saving model ...
Epoch: 20 cost time: 0.7308332920074463
Epoch: 20, Steps: 10 | Train Loss: 0.377 Vali Loss: 3.033 Vali Acc: 0.300 Test Loss: 3.033 Test Acc: 0.300
Validation loss decreased (-0.296440 --> -0.299970).  Saving model ...
Epoch: 21 cost time: 0.7691538333892822
Epoch: 21, Steps: 10 | Train Loss: 0.354 Vali Loss: 2.978 Vali Acc: 0.309 Test Loss: 2.978 Test Acc: 0.309
Validation loss decreased (-0.299970 --> -0.309382).  Saving model ...
Epoch: 22 cost time: 0.7136478424072266
Epoch: 22, Steps: 10 | Train Loss: 0.276 Vali Loss: 2.963 Vali Acc: 0.312 Test Loss: 2.963 Test Acc: 0.312
Validation loss decreased (-0.309382 --> -0.311735).  Saving model ...
Epoch: 23 cost time: 0.627516508102417
Epoch: 23, Steps: 10 | Train Loss: 0.178 Vali Loss: 3.059 Vali Acc: 0.300 Test Loss: 3.059 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7171065807342529
Epoch: 24, Steps: 10 | Train Loss: 0.216 Vali Loss: 2.973 Vali Acc: 0.325 Test Loss: 2.973 Test Acc: 0.325
Validation loss decreased (-0.311735 --> -0.324676).  Saving model ...
Epoch: 25 cost time: 0.6171178817749023
Epoch: 25, Steps: 10 | Train Loss: 0.176 Vali Loss: 3.011 Vali Acc: 0.313 Test Loss: 3.011 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5246789455413818
Epoch: 26, Steps: 10 | Train Loss: 0.123 Vali Loss: 2.995 Vali Acc: 0.326 Test Loss: 2.995 Test Acc: 0.326
Validation loss decreased (-0.324676 --> -0.325852).  Saving model ...
Epoch: 27 cost time: 0.6704230308532715
Epoch: 27, Steps: 10 | Train Loss: 0.152 Vali Loss: 3.123 Vali Acc: 0.302 Test Loss: 3.123 Test Acc: 0.302
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6411311626434326
Epoch: 28, Steps: 10 | Train Loss: 0.090 Vali Loss: 2.976 Vali Acc: 0.331 Test Loss: 2.976 Test Acc: 0.331
Validation loss decreased (-0.325852 --> -0.330558).  Saving model ...
Epoch: 29 cost time: 0.5962417125701904
Epoch: 29, Steps: 10 | Train Loss: 0.148 Vali Loss: 3.038 Vali Acc: 0.339 Test Loss: 3.038 Test Acc: 0.339
Validation loss decreased (-0.330558 --> -0.338793).  Saving model ...
Epoch: 30 cost time: 0.7328839302062988
Epoch: 30, Steps: 10 | Train Loss: 0.105 Vali Loss: 3.008 Vali Acc: 0.351 Test Loss: 3.008 Test Acc: 0.351
Validation loss decreased (-0.338793 --> -0.350558).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.35058823529411764
model parameter : 1235914
model size : 5.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.8923585414886475
Epoch: 1, Steps: 10 | Train Loss: 3.327 Vali Loss: 3.309 Vali Acc: 0.052 Test Loss: 3.309 Test Acc: 0.052
Validation loss decreased (inf --> -0.051732).  Saving model ...
Epoch: 2 cost time: 0.6951234340667725
Epoch: 2, Steps: 10 | Train Loss: 3.260 Vali Loss: 3.297 Vali Acc: 0.035 Test Loss: 3.297 Test Acc: 0.035
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6328485012054443
Epoch: 3, Steps: 10 | Train Loss: 3.174 Vali Loss: 3.294 Vali Acc: 0.056 Test Loss: 3.294 Test Acc: 0.056
Validation loss decreased (-0.051732 --> -0.056438).  Saving model ...
Epoch: 4 cost time: 0.6655442714691162
Epoch: 4, Steps: 10 | Train Loss: 3.063 Vali Loss: 3.300 Vali Acc: 0.065 Test Loss: 3.300 Test Acc: 0.065
Validation loss decreased (-0.056438 --> -0.064673).  Saving model ...
Epoch: 5 cost time: 0.6287169456481934
Epoch: 5, Steps: 10 | Train Loss: 2.952 Vali Loss: 3.287 Vali Acc: 0.071 Test Loss: 3.287 Test Acc: 0.071
Validation loss decreased (-0.064673 --> -0.070555).  Saving model ...
Epoch: 6 cost time: 0.6587884426116943
Epoch: 6, Steps: 10 | Train Loss: 2.812 Vali Loss: 3.258 Vali Acc: 0.094 Test Loss: 3.258 Test Acc: 0.094
Validation loss decreased (-0.070555 --> -0.094085).  Saving model ...
Epoch: 7 cost time: 0.6023123264312744
Epoch: 7, Steps: 10 | Train Loss: 2.641 Vali Loss: 3.223 Vali Acc: 0.113 Test Loss: 3.223 Test Acc: 0.113
Validation loss decreased (-0.094085 --> -0.112909).  Saving model ...
Epoch: 8 cost time: 0.6295754909515381
Epoch: 8, Steps: 10 | Train Loss: 2.521 Vali Loss: 3.194 Vali Acc: 0.119 Test Loss: 3.194 Test Acc: 0.119
Validation loss decreased (-0.112909 --> -0.118792).  Saving model ...
Epoch: 9 cost time: 0.6139979362487793
Epoch: 9, Steps: 10 | Train Loss: 2.332 Vali Loss: 3.162 Vali Acc: 0.142 Test Loss: 3.162 Test Acc: 0.142
Validation loss decreased (-0.118792 --> -0.142321).  Saving model ...
Epoch: 10 cost time: 0.5647242069244385
Epoch: 10, Steps: 10 | Train Loss: 2.197 Vali Loss: 3.140 Vali Acc: 0.152 Test Loss: 3.140 Test Acc: 0.152
Validation loss decreased (-0.142321 --> -0.151733).  Saving model ...
Epoch: 11 cost time: 0.6021566390991211
Epoch: 11, Steps: 10 | Train Loss: 1.998 Vali Loss: 3.121 Vali Acc: 0.158 Test Loss: 3.121 Test Acc: 0.158
Validation loss decreased (-0.151733 --> -0.157616).  Saving model ...
Epoch: 12 cost time: 0.5857164859771729
Epoch: 12, Steps: 10 | Train Loss: 1.804 Vali Loss: 3.096 Vali Acc: 0.172 Test Loss: 3.096 Test Acc: 0.172
Validation loss decreased (-0.157616 --> -0.171734).  Saving model ...
Epoch: 13 cost time: 0.6488072872161865
Epoch: 13, Steps: 10 | Train Loss: 1.625 Vali Loss: 3.056 Vali Acc: 0.176 Test Loss: 3.056 Test Acc: 0.176
Validation loss decreased (-0.171734 --> -0.176440).  Saving model ...
Epoch: 14 cost time: 0.6138753890991211
Epoch: 14, Steps: 10 | Train Loss: 1.463 Vali Loss: 3.025 Vali Acc: 0.204 Test Loss: 3.025 Test Acc: 0.204
Validation loss decreased (-0.176440 --> -0.203499).  Saving model ...
Epoch: 15 cost time: 0.5859744548797607
Epoch: 15, Steps: 10 | Train Loss: 1.275 Vali Loss: 3.002 Vali Acc: 0.202 Test Loss: 3.002 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5299098491668701
Epoch: 16, Steps: 10 | Train Loss: 1.043 Vali Loss: 2.959 Vali Acc: 0.222 Test Loss: 2.959 Test Acc: 0.222
Validation loss decreased (-0.203499 --> -0.222323).  Saving model ...
Epoch: 17 cost time: 0.6151630878448486
Epoch: 17, Steps: 10 | Train Loss: 0.887 Vali Loss: 3.003 Vali Acc: 0.252 Test Loss: 3.003 Test Acc: 0.252
Validation loss decreased (-0.222323 --> -0.251735).  Saving model ...
Epoch: 18 cost time: 0.6521291732788086
Epoch: 18, Steps: 10 | Train Loss: 0.773 Vali Loss: 2.965 Vali Acc: 0.256 Test Loss: 2.965 Test Acc: 0.256
Validation loss decreased (-0.251735 --> -0.256441).  Saving model ...
Epoch: 19 cost time: 0.6445648670196533
Epoch: 19, Steps: 10 | Train Loss: 0.691 Vali Loss: 2.969 Vali Acc: 0.261 Test Loss: 2.969 Test Acc: 0.261
Validation loss decreased (-0.256441 --> -0.261147).  Saving model ...
Epoch: 20 cost time: 0.6011495590209961
Epoch: 20, Steps: 10 | Train Loss: 0.513 Vali Loss: 3.059 Vali Acc: 0.271 Test Loss: 3.059 Test Acc: 0.271
Validation loss decreased (-0.261147 --> -0.270558).  Saving model ...
Epoch: 21 cost time: 0.5908646583557129
Epoch: 21, Steps: 10 | Train Loss: 0.459 Vali Loss: 2.940 Vali Acc: 0.287 Test Loss: 2.940 Test Acc: 0.287
Validation loss decreased (-0.270558 --> -0.287029).  Saving model ...
Epoch: 22 cost time: 0.7088222503662109
Epoch: 22, Steps: 10 | Train Loss: 0.377 Vali Loss: 2.973 Vali Acc: 0.289 Test Loss: 2.973 Test Acc: 0.289
Validation loss decreased (-0.287029 --> -0.289382).  Saving model ...
Epoch: 23 cost time: 0.6980338096618652
Epoch: 23, Steps: 10 | Train Loss: 0.336 Vali Loss: 2.993 Vali Acc: 0.291 Test Loss: 2.993 Test Acc: 0.291
Validation loss decreased (-0.289382 --> -0.290558).  Saving model ...
Epoch: 24 cost time: 0.6738035678863525
Epoch: 24, Steps: 10 | Train Loss: 0.247 Vali Loss: 3.034 Vali Acc: 0.296 Test Loss: 3.034 Test Acc: 0.296
Validation loss decreased (-0.290558 --> -0.296440).  Saving model ...
Epoch: 25 cost time: 0.6869199275970459
Epoch: 25, Steps: 10 | Train Loss: 0.235 Vali Loss: 3.007 Vali Acc: 0.295 Test Loss: 3.007 Test Acc: 0.295
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6358332633972168
Epoch: 26, Steps: 10 | Train Loss: 0.155 Vali Loss: 3.122 Vali Acc: 0.301 Test Loss: 3.122 Test Acc: 0.301
Validation loss decreased (-0.296440 --> -0.301145).  Saving model ...
Epoch: 27 cost time: 0.5890176296234131
Epoch: 27, Steps: 10 | Train Loss: 0.115 Vali Loss: 3.021 Vali Acc: 0.298 Test Loss: 3.021 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6423265933990479
Epoch: 28, Steps: 10 | Train Loss: 0.118 Vali Loss: 3.105 Vali Acc: 0.311 Test Loss: 3.105 Test Acc: 0.311
Validation loss decreased (-0.301145 --> -0.310557).  Saving model ...
Epoch: 29 cost time: 0.6411597728729248
Epoch: 29, Steps: 10 | Train Loss: 0.101 Vali Loss: 3.076 Vali Acc: 0.305 Test Loss: 3.076 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5792007446289062
Epoch: 30, Steps: 10 | Train Loss: 0.095 Vali Loss: 3.086 Vali Acc: 0.320 Test Loss: 3.086 Test Acc: 0.320
Validation loss decreased (-0.310557 --> -0.319969).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.32
model parameter : 408202
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.5162670612335205
Epoch: 1, Steps: 10 | Train Loss: 3.369 Vali Loss: 3.295 Vali Acc: 0.033 Test Loss: 3.295 Test Acc: 0.033
Validation loss decreased (inf --> -0.032908).  Saving model ...
Epoch: 2 cost time: 1.0878992080688477
Epoch: 2, Steps: 10 | Train Loss: 3.293 Vali Loss: 3.271 Vali Acc: 0.041 Test Loss: 3.271 Test Acc: 0.041
Validation loss decreased (-0.032908 --> -0.041144).  Saving model ...
Epoch: 3 cost time: 1.0322017669677734
Epoch: 3, Steps: 10 | Train Loss: 3.160 Vali Loss: 3.263 Vali Acc: 0.061 Test Loss: 3.263 Test Acc: 0.061
Validation loss decreased (-0.041144 --> -0.061144).  Saving model ...
Epoch: 4 cost time: 1.0881798267364502
Epoch: 4, Steps: 10 | Train Loss: 3.039 Vali Loss: 3.260 Vali Acc: 0.080 Test Loss: 3.260 Test Acc: 0.080
Validation loss decreased (-0.061144 --> -0.079967).  Saving model ...
Epoch: 5 cost time: 1.042297124862671
Epoch: 5, Steps: 10 | Train Loss: 2.852 Vali Loss: 3.247 Vali Acc: 0.102 Test Loss: 3.247 Test Acc: 0.102
Validation loss decreased (-0.079967 --> -0.102320).  Saving model ...
Epoch: 6 cost time: 1.036109447479248
Epoch: 6, Steps: 10 | Train Loss: 2.667 Vali Loss: 3.219 Vali Acc: 0.108 Test Loss: 3.219 Test Acc: 0.108
Validation loss decreased (-0.102320 --> -0.108203).  Saving model ...
Epoch: 7 cost time: 0.8734776973724365
Epoch: 7, Steps: 10 | Train Loss: 2.518 Vali Loss: 3.170 Vali Acc: 0.140 Test Loss: 3.170 Test Acc: 0.140
Validation loss decreased (-0.108203 --> -0.139968).  Saving model ...
Epoch: 8 cost time: 0.931117057800293
Epoch: 8, Steps: 10 | Train Loss: 2.265 Vali Loss: 3.106 Vali Acc: 0.167 Test Loss: 3.106 Test Acc: 0.167
Validation loss decreased (-0.139968 --> -0.167028).  Saving model ...
Epoch: 9 cost time: 0.9281783103942871
Epoch: 9, Steps: 10 | Train Loss: 2.045 Vali Loss: 3.063 Vali Acc: 0.178 Test Loss: 3.063 Test Acc: 0.178
Validation loss decreased (-0.167028 --> -0.177616).  Saving model ...
Epoch: 10 cost time: 0.9682981967926025
Epoch: 10, Steps: 10 | Train Loss: 1.776 Vali Loss: 3.035 Vali Acc: 0.192 Test Loss: 3.035 Test Acc: 0.192
Validation loss decreased (-0.177616 --> -0.191734).  Saving model ...
Epoch: 11 cost time: 0.8343701362609863
Epoch: 11, Steps: 10 | Train Loss: 1.559 Vali Loss: 3.014 Vali Acc: 0.196 Test Loss: 3.014 Test Acc: 0.196
Validation loss decreased (-0.191734 --> -0.196440).  Saving model ...
Epoch: 12 cost time: 1.0732431411743164
Epoch: 12, Steps: 10 | Train Loss: 1.328 Vali Loss: 3.002 Vali Acc: 0.211 Test Loss: 3.002 Test Acc: 0.211
Validation loss decreased (-0.196440 --> -0.210558).  Saving model ...
Epoch: 13 cost time: 1.1690480709075928
Epoch: 13, Steps: 10 | Train Loss: 1.106 Vali Loss: 2.998 Vali Acc: 0.226 Test Loss: 2.998 Test Acc: 0.226
Validation loss decreased (-0.210558 --> -0.225852).  Saving model ...
Epoch: 14 cost time: 1.1365132331848145
Epoch: 14, Steps: 10 | Train Loss: 0.920 Vali Loss: 2.968 Vali Acc: 0.224 Test Loss: 2.968 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1568872928619385
Epoch: 15, Steps: 10 | Train Loss: 0.788 Vali Loss: 2.971 Vali Acc: 0.241 Test Loss: 2.971 Test Acc: 0.241
Validation loss decreased (-0.225852 --> -0.241147).  Saving model ...
Epoch: 16 cost time: 1.126075029373169
Epoch: 16, Steps: 10 | Train Loss: 0.611 Vali Loss: 2.992 Vali Acc: 0.249 Test Loss: 2.992 Test Acc: 0.249
Validation loss decreased (-0.241147 --> -0.249382).  Saving model ...
Epoch: 17 cost time: 1.0657262802124023
Epoch: 17, Steps: 10 | Train Loss: 0.450 Vali Loss: 3.024 Vali Acc: 0.260 Test Loss: 3.024 Test Acc: 0.260
Validation loss decreased (-0.249382 --> -0.259970).  Saving model ...
Epoch: 18 cost time: 1.0494275093078613
Epoch: 18, Steps: 10 | Train Loss: 0.355 Vali Loss: 3.001 Vali Acc: 0.271 Test Loss: 3.001 Test Acc: 0.271
Validation loss decreased (-0.259970 --> -0.270558).  Saving model ...
Epoch: 19 cost time: 0.8816514015197754
Epoch: 19, Steps: 10 | Train Loss: 0.247 Vali Loss: 2.987 Vali Acc: 0.273 Test Loss: 2.987 Test Acc: 0.273
Validation loss decreased (-0.270558 --> -0.272911).  Saving model ...
Epoch: 20 cost time: 0.9104301929473877
Epoch: 20, Steps: 10 | Train Loss: 0.221 Vali Loss: 2.995 Vali Acc: 0.278 Test Loss: 2.995 Test Acc: 0.278
Validation loss decreased (-0.272911 --> -0.277617).  Saving model ...
Epoch: 21 cost time: 0.909290075302124
Epoch: 21, Steps: 10 | Train Loss: 0.184 Vali Loss: 3.023 Vali Acc: 0.291 Test Loss: 3.023 Test Acc: 0.291
Validation loss decreased (-0.277617 --> -0.290558).  Saving model ...
Epoch: 22 cost time: 0.953744649887085
Epoch: 22, Steps: 10 | Train Loss: 0.134 Vali Loss: 3.044 Vali Acc: 0.304 Test Loss: 3.044 Test Acc: 0.304
Validation loss decreased (-0.290558 --> -0.303499).  Saving model ...
Epoch: 23 cost time: 0.8087074756622314
Epoch: 23, Steps: 10 | Train Loss: 0.124 Vali Loss: 3.067 Vali Acc: 0.296 Test Loss: 3.067 Test Acc: 0.296
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9670019149780273
Epoch: 24, Steps: 10 | Train Loss: 0.090 Vali Loss: 3.089 Vali Acc: 0.302 Test Loss: 3.089 Test Acc: 0.302
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9356114864349365
Epoch: 25, Steps: 10 | Train Loss: 0.085 Vali Loss: 3.110 Vali Acc: 0.298 Test Loss: 3.110 Test Acc: 0.298
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8148016929626465
Epoch: 26, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.137 Vali Acc: 0.295 Test Loss: 3.137 Test Acc: 0.295
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.8626072406768799
Epoch: 27, Steps: 10 | Train Loss: 0.105 Vali Loss: 3.141 Vali Acc: 0.294 Test Loss: 3.141 Test Acc: 0.294
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.8420259952545166
Epoch: 28, Steps: 10 | Train Loss: 0.073 Vali Loss: 3.169 Vali Acc: 0.300 Test Loss: 3.169 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.87418532371521
Epoch: 29, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.130 Vali Acc: 0.301 Test Loss: 3.130 Test Acc: 0.301
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.9800631999969482
Epoch: 30, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.134 Vali Acc: 0.309 Test Loss: 3.134 Test Acc: 0.309
Validation loss decreased (-0.303499 --> -0.309380).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.30941176470588233
model parameter : 649802
model size : 2.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.933762788772583
Epoch: 1, Steps: 10 | Train Loss: 3.387 Vali Loss: 3.317 Vali Acc: 0.029 Test Loss: 3.317 Test Acc: 0.029
Validation loss decreased (inf --> -0.029379).  Saving model ...
Epoch: 2 cost time: 0.7928042411804199
Epoch: 2, Steps: 10 | Train Loss: 3.286 Vali Loss: 3.287 Vali Acc: 0.032 Test Loss: 3.287 Test Acc: 0.032
Validation loss decreased (-0.029379 --> -0.031732).  Saving model ...
Epoch: 3 cost time: 0.7293922901153564
Epoch: 3, Steps: 10 | Train Loss: 3.171 Vali Loss: 3.275 Vali Acc: 0.041 Test Loss: 3.275 Test Acc: 0.041
Validation loss decreased (-0.031732 --> -0.041144).  Saving model ...
Epoch: 4 cost time: 0.6987974643707275
Epoch: 4, Steps: 10 | Train Loss: 3.024 Vali Loss: 3.264 Vali Acc: 0.059 Test Loss: 3.264 Test Acc: 0.059
Validation loss decreased (-0.041144 --> -0.058791).  Saving model ...
Epoch: 5 cost time: 0.8001453876495361
Epoch: 5, Steps: 10 | Train Loss: 2.860 Vali Loss: 3.244 Vali Acc: 0.085 Test Loss: 3.244 Test Acc: 0.085
Validation loss decreased (-0.058791 --> -0.084673).  Saving model ...
Epoch: 6 cost time: 0.7935898303985596
Epoch: 6, Steps: 10 | Train Loss: 2.744 Vali Loss: 3.227 Vali Acc: 0.100 Test Loss: 3.227 Test Acc: 0.100
Validation loss decreased (-0.084673 --> -0.099968).  Saving model ...
Epoch: 7 cost time: 0.7438721656799316
Epoch: 7, Steps: 10 | Train Loss: 2.572 Vali Loss: 3.196 Vali Acc: 0.119 Test Loss: 3.196 Test Acc: 0.119
Validation loss decreased (-0.099968 --> -0.118792).  Saving model ...
Epoch: 8 cost time: 0.7626988887786865
Epoch: 8, Steps: 10 | Train Loss: 2.395 Vali Loss: 3.163 Vali Acc: 0.141 Test Loss: 3.163 Test Acc: 0.141
Validation loss decreased (-0.118792 --> -0.141145).  Saving model ...
Epoch: 9 cost time: 0.692779541015625
Epoch: 9, Steps: 10 | Train Loss: 2.174 Vali Loss: 3.119 Vali Acc: 0.156 Test Loss: 3.119 Test Acc: 0.156
Validation loss decreased (-0.141145 --> -0.156439).  Saving model ...
Epoch: 10 cost time: 0.7071647644042969
Epoch: 10, Steps: 10 | Train Loss: 1.952 Vali Loss: 3.084 Vali Acc: 0.168 Test Loss: 3.084 Test Acc: 0.168
Validation loss decreased (-0.156439 --> -0.168204).  Saving model ...
Epoch: 11 cost time: 0.7247247695922852
Epoch: 11, Steps: 10 | Train Loss: 1.748 Vali Loss: 3.054 Vali Acc: 0.178 Test Loss: 3.054 Test Acc: 0.178
Validation loss decreased (-0.168204 --> -0.177617).  Saving model ...
Epoch: 12 cost time: 0.7313740253448486
Epoch: 12, Steps: 10 | Train Loss: 1.509 Vali Loss: 3.055 Vali Acc: 0.179 Test Loss: 3.055 Test Acc: 0.179
Validation loss decreased (-0.177617 --> -0.178793).  Saving model ...
Epoch: 13 cost time: 0.7655401229858398
Epoch: 13, Steps: 10 | Train Loss: 1.325 Vali Loss: 3.017 Vali Acc: 0.200 Test Loss: 3.017 Test Acc: 0.200
Validation loss decreased (-0.178793 --> -0.199970).  Saving model ...
Epoch: 14 cost time: 0.7846260070800781
Epoch: 14, Steps: 10 | Train Loss: 1.119 Vali Loss: 2.996 Vali Acc: 0.214 Test Loss: 2.996 Test Acc: 0.214
Validation loss decreased (-0.199970 --> -0.214088).  Saving model ...
Epoch: 15 cost time: 0.7980451583862305
Epoch: 15, Steps: 10 | Train Loss: 0.944 Vali Loss: 2.999 Vali Acc: 0.227 Test Loss: 2.999 Test Acc: 0.227
Validation loss decreased (-0.214088 --> -0.227029).  Saving model ...
Epoch: 16 cost time: 0.7308056354522705
Epoch: 16, Steps: 10 | Train Loss: 0.761 Vali Loss: 2.985 Vali Acc: 0.227 Test Loss: 2.985 Test Acc: 0.227
Validation loss decreased (-0.227029 --> -0.227029).  Saving model ...
Epoch: 17 cost time: 0.7676501274108887
Epoch: 17, Steps: 10 | Train Loss: 0.643 Vali Loss: 2.997 Vali Acc: 0.246 Test Loss: 2.997 Test Acc: 0.246
Validation loss decreased (-0.227029 --> -0.245852).  Saving model ...
Epoch: 18 cost time: 0.8319582939147949
Epoch: 18, Steps: 10 | Train Loss: 0.444 Vali Loss: 3.019 Vali Acc: 0.255 Test Loss: 3.019 Test Acc: 0.255
Validation loss decreased (-0.245852 --> -0.255264).  Saving model ...
Epoch: 19 cost time: 0.725337028503418
Epoch: 19, Steps: 10 | Train Loss: 0.407 Vali Loss: 2.989 Vali Acc: 0.268 Test Loss: 2.989 Test Acc: 0.268
Validation loss decreased (-0.255264 --> -0.268205).  Saving model ...
Epoch: 20 cost time: 0.7492580413818359
Epoch: 20, Steps: 10 | Train Loss: 0.316 Vali Loss: 3.054 Vali Acc: 0.275 Test Loss: 3.054 Test Acc: 0.275
Validation loss decreased (-0.268205 --> -0.275264).  Saving model ...
Epoch: 21 cost time: 0.7566490173339844
Epoch: 21, Steps: 10 | Train Loss: 0.253 Vali Loss: 3.050 Vali Acc: 0.287 Test Loss: 3.050 Test Acc: 0.287
Validation loss decreased (-0.275264 --> -0.287028).  Saving model ...
Epoch: 22 cost time: 0.7201557159423828
Epoch: 22, Steps: 10 | Train Loss: 0.210 Vali Loss: 3.026 Vali Acc: 0.293 Test Loss: 3.026 Test Acc: 0.293
Validation loss decreased (-0.287028 --> -0.292911).  Saving model ...
Epoch: 23 cost time: 0.7721388339996338
Epoch: 23, Steps: 10 | Train Loss: 0.172 Vali Loss: 3.076 Vali Acc: 0.285 Test Loss: 3.076 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7675845623016357
Epoch: 24, Steps: 10 | Train Loss: 0.134 Vali Loss: 3.092 Vali Acc: 0.288 Test Loss: 3.092 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7526359558105469
Epoch: 25, Steps: 10 | Train Loss: 0.128 Vali Loss: 3.122 Vali Acc: 0.289 Test Loss: 3.122 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7407128810882568
Epoch: 26, Steps: 10 | Train Loss: 0.105 Vali Loss: 3.141 Vali Acc: 0.287 Test Loss: 3.141 Test Acc: 0.287
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.812218189239502
Epoch: 27, Steps: 10 | Train Loss: 0.081 Vali Loss: 3.138 Vali Acc: 0.287 Test Loss: 3.138 Test Acc: 0.287
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.6995444297790527
Epoch: 28, Steps: 10 | Train Loss: 0.078 Vali Loss: 3.151 Vali Acc: 0.302 Test Loss: 3.151 Test Acc: 0.302
Validation loss decreased (-0.292911 --> -0.302321).  Saving model ...
Epoch: 29 cost time: 0.6482851505279541
Epoch: 29, Steps: 10 | Train Loss: 0.063 Vali Loss: 3.169 Vali Acc: 0.298 Test Loss: 3.169 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7051620483398438
Epoch: 30, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.175 Vali Acc: 0.294 Test Loss: 3.175 Test Acc: 0.294
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3023529411764706
model parameter : 235914
model size : 1.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.088815689086914
Epoch: 1, Steps: 10 | Train Loss: 3.371 Vali Loss: 3.296 Vali Acc: 0.036 Test Loss: 3.296 Test Acc: 0.036
Validation loss decreased (inf --> -0.036438).  Saving model ...
Epoch: 2 cost time: 0.8184847831726074
Epoch: 2, Steps: 10 | Train Loss: 3.290 Vali Loss: 3.274 Vali Acc: 0.038 Test Loss: 3.274 Test Acc: 0.038
Validation loss decreased (-0.036438 --> -0.037614).  Saving model ...
Epoch: 3 cost time: 0.8041625022888184
Epoch: 3, Steps: 10 | Train Loss: 3.178 Vali Loss: 3.267 Vali Acc: 0.059 Test Loss: 3.267 Test Acc: 0.059
Validation loss decreased (-0.037614 --> -0.058791).  Saving model ...
Epoch: 4 cost time: 0.8441359996795654
Epoch: 4, Steps: 10 | Train Loss: 3.051 Vali Loss: 3.265 Vali Acc: 0.084 Test Loss: 3.265 Test Acc: 0.084
Validation loss decreased (-0.058791 --> -0.083497).  Saving model ...
Epoch: 5 cost time: 0.7672960758209229
Epoch: 5, Steps: 10 | Train Loss: 2.884 Vali Loss: 3.254 Vali Acc: 0.098 Test Loss: 3.254 Test Acc: 0.098
Validation loss decreased (-0.083497 --> -0.097615).  Saving model ...
Epoch: 6 cost time: 0.7785651683807373
Epoch: 6, Steps: 10 | Train Loss: 2.729 Vali Loss: 3.231 Vali Acc: 0.113 Test Loss: 3.231 Test Acc: 0.113
Validation loss decreased (-0.097615 --> -0.112909).  Saving model ...
Epoch: 7 cost time: 0.6958355903625488
Epoch: 7, Steps: 10 | Train Loss: 2.607 Vali Loss: 3.193 Vali Acc: 0.128 Test Loss: 3.193 Test Acc: 0.128
Validation loss decreased (-0.112909 --> -0.128203).  Saving model ...
Epoch: 8 cost time: 0.7182667255401611
Epoch: 8, Steps: 10 | Train Loss: 2.377 Vali Loss: 3.135 Vali Acc: 0.155 Test Loss: 3.135 Test Acc: 0.155
Validation loss decreased (-0.128203 --> -0.155263).  Saving model ...
Epoch: 9 cost time: 0.8234915733337402
Epoch: 9, Steps: 10 | Train Loss: 2.183 Vali Loss: 3.098 Vali Acc: 0.166 Test Loss: 3.098 Test Acc: 0.166
Validation loss decreased (-0.155263 --> -0.165851).  Saving model ...
Epoch: 10 cost time: 0.7723274230957031
Epoch: 10, Steps: 10 | Train Loss: 1.975 Vali Loss: 3.076 Vali Acc: 0.172 Test Loss: 3.076 Test Acc: 0.172
Validation loss decreased (-0.165851 --> -0.171734).  Saving model ...
Epoch: 11 cost time: 0.7736985683441162
Epoch: 11, Steps: 10 | Train Loss: 1.776 Vali Loss: 3.021 Vali Acc: 0.181 Test Loss: 3.021 Test Acc: 0.181
Validation loss decreased (-0.171734 --> -0.181146).  Saving model ...
Epoch: 12 cost time: 0.7869789600372314
Epoch: 12, Steps: 10 | Train Loss: 1.605 Vali Loss: 3.017 Vali Acc: 0.185 Test Loss: 3.017 Test Acc: 0.185
Validation loss decreased (-0.181146 --> -0.184676).  Saving model ...
Epoch: 13 cost time: 0.7284753322601318
Epoch: 13, Steps: 10 | Train Loss: 1.336 Vali Loss: 3.002 Vali Acc: 0.199 Test Loss: 3.002 Test Acc: 0.199
Validation loss decreased (-0.184676 --> -0.198794).  Saving model ...
Epoch: 14 cost time: 0.764106273651123
Epoch: 14, Steps: 10 | Train Loss: 1.147 Vali Loss: 2.975 Vali Acc: 0.209 Test Loss: 2.975 Test Acc: 0.209
Validation loss decreased (-0.198794 --> -0.209382).  Saving model ...
Epoch: 15 cost time: 0.8382890224456787
Epoch: 15, Steps: 10 | Train Loss: 1.059 Vali Loss: 2.933 Vali Acc: 0.225 Test Loss: 2.933 Test Acc: 0.225
Validation loss decreased (-0.209382 --> -0.224677).  Saving model ...
Epoch: 16 cost time: 0.7328181266784668
Epoch: 16, Steps: 10 | Train Loss: 0.841 Vali Loss: 2.954 Vali Acc: 0.242 Test Loss: 2.954 Test Acc: 0.242
Validation loss decreased (-0.224677 --> -0.242323).  Saving model ...
Epoch: 17 cost time: 0.7501533031463623
Epoch: 17, Steps: 10 | Train Loss: 0.635 Vali Loss: 2.993 Vali Acc: 0.254 Test Loss: 2.993 Test Acc: 0.254
Validation loss decreased (-0.242323 --> -0.254088).  Saving model ...
Epoch: 18 cost time: 0.7629082202911377
Epoch: 18, Steps: 10 | Train Loss: 0.537 Vali Loss: 2.924 Vali Acc: 0.273 Test Loss: 2.924 Test Acc: 0.273
Validation loss decreased (-0.254088 --> -0.272912).  Saving model ...
Epoch: 19 cost time: 0.7849414348602295
Epoch: 19, Steps: 10 | Train Loss: 0.377 Vali Loss: 2.947 Vali Acc: 0.267 Test Loss: 2.947 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7257494926452637
Epoch: 20, Steps: 10 | Train Loss: 0.359 Vali Loss: 2.961 Vali Acc: 0.293 Test Loss: 2.961 Test Acc: 0.293
Validation loss decreased (-0.272912 --> -0.292912).  Saving model ...
Epoch: 21 cost time: 0.7142593860626221
Epoch: 21, Steps: 10 | Train Loss: 0.276 Vali Loss: 2.929 Vali Acc: 0.302 Test Loss: 2.929 Test Acc: 0.302
Validation loss decreased (-0.292912 --> -0.302324).  Saving model ...
Epoch: 22 cost time: 0.7400565147399902
Epoch: 22, Steps: 10 | Train Loss: 0.205 Vali Loss: 2.944 Vali Acc: 0.306 Test Loss: 2.944 Test Acc: 0.306
Validation loss decreased (-0.302324 --> -0.305853).  Saving model ...
Epoch: 23 cost time: 0.7466256618499756
Epoch: 23, Steps: 10 | Train Loss: 0.223 Vali Loss: 2.999 Vali Acc: 0.301 Test Loss: 2.999 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7490143775939941
Epoch: 24, Steps: 10 | Train Loss: 0.144 Vali Loss: 3.038 Vali Acc: 0.305 Test Loss: 3.038 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7505669593811035
Epoch: 25, Steps: 10 | Train Loss: 0.133 Vali Loss: 3.041 Vali Acc: 0.306 Test Loss: 3.041 Test Acc: 0.306
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8437180519104004
Epoch: 26, Steps: 10 | Train Loss: 0.108 Vali Loss: 3.052 Vali Acc: 0.321 Test Loss: 3.052 Test Acc: 0.321
Validation loss decreased (-0.305853 --> -0.321146).  Saving model ...
Epoch: 27 cost time: 0.763643741607666
Epoch: 27, Steps: 10 | Train Loss: 0.111 Vali Loss: 3.017 Vali Acc: 0.319 Test Loss: 3.017 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8013815879821777
Epoch: 28, Steps: 10 | Train Loss: 0.113 Vali Loss: 3.049 Vali Acc: 0.314 Test Loss: 3.049 Test Acc: 0.314
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7543661594390869
Epoch: 29, Steps: 10 | Train Loss: 0.099 Vali Loss: 3.163 Vali Acc: 0.319 Test Loss: 3.163 Test Acc: 0.319
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.7616324424743652
Epoch: 30, Steps: 10 | Train Loss: 0.071 Vali Loss: 3.067 Vali Acc: 0.324 Test Loss: 3.067 Test Acc: 0.324
Validation loss decreased (-0.321146 --> -0.323499).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3235294117647059
model parameter : 649802
model size : 2.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.000777006149292
Epoch: 1, Steps: 10 | Train Loss: 3.385 Vali Loss: 3.315 Vali Acc: 0.029 Test Loss: 3.315 Test Acc: 0.029
Validation loss decreased (inf --> -0.029379).  Saving model ...
Epoch: 2 cost time: 0.7075042724609375
Epoch: 2, Steps: 10 | Train Loss: 3.290 Vali Loss: 3.285 Vali Acc: 0.031 Test Loss: 3.285 Test Acc: 0.031
Validation loss decreased (-0.029379 --> -0.030555).  Saving model ...
Epoch: 3 cost time: 0.6807963848114014
Epoch: 3, Steps: 10 | Train Loss: 3.173 Vali Loss: 3.273 Vali Acc: 0.039 Test Loss: 3.273 Test Acc: 0.039
Validation loss decreased (-0.030555 --> -0.038791).  Saving model ...
Epoch: 4 cost time: 0.6244480609893799
Epoch: 4, Steps: 10 | Train Loss: 3.030 Vali Loss: 3.263 Vali Acc: 0.056 Test Loss: 3.263 Test Acc: 0.056
Validation loss decreased (-0.038791 --> -0.056438).  Saving model ...
Epoch: 5 cost time: 0.6163208484649658
Epoch: 5, Steps: 10 | Train Loss: 2.861 Vali Loss: 3.244 Vali Acc: 0.080 Test Loss: 3.244 Test Acc: 0.080
Validation loss decreased (-0.056438 --> -0.079968).  Saving model ...
Epoch: 6 cost time: 0.6599845886230469
Epoch: 6, Steps: 10 | Train Loss: 2.763 Vali Loss: 3.229 Vali Acc: 0.099 Test Loss: 3.229 Test Acc: 0.099
Validation loss decreased (-0.079968 --> -0.098791).  Saving model ...
Epoch: 7 cost time: 0.6807427406311035
Epoch: 7, Steps: 10 | Train Loss: 2.635 Vali Loss: 3.200 Vali Acc: 0.109 Test Loss: 3.200 Test Acc: 0.109
Validation loss decreased (-0.098791 --> -0.109380).  Saving model ...
Epoch: 8 cost time: 0.7106845378875732
Epoch: 8, Steps: 10 | Train Loss: 2.448 Vali Loss: 3.170 Vali Acc: 0.127 Test Loss: 3.170 Test Acc: 0.127
Validation loss decreased (-0.109380 --> -0.127027).  Saving model ...
Epoch: 9 cost time: 0.5628416538238525
Epoch: 9, Steps: 10 | Train Loss: 2.271 Vali Loss: 3.126 Vali Acc: 0.145 Test Loss: 3.126 Test Acc: 0.145
Validation loss decreased (-0.127027 --> -0.144675).  Saving model ...
Epoch: 10 cost time: 0.6270866394042969
Epoch: 10, Steps: 10 | Train Loss: 2.091 Vali Loss: 3.095 Vali Acc: 0.162 Test Loss: 3.095 Test Acc: 0.162
Validation loss decreased (-0.144675 --> -0.162322).  Saving model ...
Epoch: 11 cost time: 0.6422967910766602
Epoch: 11, Steps: 10 | Train Loss: 1.885 Vali Loss: 3.066 Vali Acc: 0.191 Test Loss: 3.066 Test Acc: 0.191
Validation loss decreased (-0.162322 --> -0.190558).  Saving model ...
Epoch: 12 cost time: 0.6452765464782715
Epoch: 12, Steps: 10 | Train Loss: 1.743 Vali Loss: 3.073 Vali Acc: 0.181 Test Loss: 3.073 Test Acc: 0.181
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6104159355163574
Epoch: 13, Steps: 10 | Train Loss: 1.529 Vali Loss: 3.037 Vali Acc: 0.198 Test Loss: 3.037 Test Acc: 0.198
Validation loss decreased (-0.190558 --> -0.197617).  Saving model ...
Epoch: 14 cost time: 0.7611443996429443
Epoch: 14, Steps: 10 | Train Loss: 1.353 Vali Loss: 3.011 Vali Acc: 0.218 Test Loss: 3.011 Test Acc: 0.218
Validation loss decreased (-0.197617 --> -0.217617).  Saving model ...
Epoch: 15 cost time: 0.6685454845428467
Epoch: 15, Steps: 10 | Train Loss: 1.121 Vali Loss: 3.005 Vali Acc: 0.216 Test Loss: 3.005 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6485538482666016
Epoch: 16, Steps: 10 | Train Loss: 0.977 Vali Loss: 2.978 Vali Acc: 0.233 Test Loss: 2.978 Test Acc: 0.233
Validation loss decreased (-0.217617 --> -0.232911).  Saving model ...
Epoch: 17 cost time: 0.703031063079834
Epoch: 17, Steps: 10 | Train Loss: 0.823 Vali Loss: 2.973 Vali Acc: 0.255 Test Loss: 2.973 Test Acc: 0.255
Validation loss decreased (-0.232911 --> -0.255264).  Saving model ...
Epoch: 18 cost time: 0.6735002994537354
Epoch: 18, Steps: 10 | Train Loss: 0.672 Vali Loss: 3.014 Vali Acc: 0.268 Test Loss: 3.014 Test Acc: 0.268
Validation loss decreased (-0.255264 --> -0.268205).  Saving model ...
Epoch: 19 cost time: 0.7045538425445557
Epoch: 19, Steps: 10 | Train Loss: 0.528 Vali Loss: 2.965 Vali Acc: 0.272 Test Loss: 2.965 Test Acc: 0.272
Validation loss decreased (-0.268205 --> -0.271735).  Saving model ...
Epoch: 20 cost time: 0.6436774730682373
Epoch: 20, Steps: 10 | Train Loss: 0.444 Vali Loss: 3.038 Vali Acc: 0.274 Test Loss: 3.038 Test Acc: 0.274
Validation loss decreased (-0.271735 --> -0.274087).  Saving model ...
Epoch: 21 cost time: 0.6553475856781006
Epoch: 21, Steps: 10 | Train Loss: 0.345 Vali Loss: 2.972 Vali Acc: 0.291 Test Loss: 2.972 Test Acc: 0.291
Validation loss decreased (-0.274087 --> -0.290559).  Saving model ...
Epoch: 22 cost time: 0.7319080829620361
Epoch: 22, Steps: 10 | Train Loss: 0.337 Vali Loss: 2.987 Vali Acc: 0.295 Test Loss: 2.987 Test Acc: 0.295
Validation loss decreased (-0.290559 --> -0.295264).  Saving model ...
Epoch: 23 cost time: 0.6239089965820312
Epoch: 23, Steps: 10 | Train Loss: 0.255 Vali Loss: 3.025 Vali Acc: 0.302 Test Loss: 3.025 Test Acc: 0.302
Validation loss decreased (-0.295264 --> -0.302323).  Saving model ...
Epoch: 24 cost time: 0.6016628742218018
Epoch: 24, Steps: 10 | Train Loss: 0.192 Vali Loss: 3.010 Vali Acc: 0.307 Test Loss: 3.010 Test Acc: 0.307
Validation loss decreased (-0.302323 --> -0.307029).  Saving model ...
Epoch: 25 cost time: 0.6352791786193848
Epoch: 25, Steps: 10 | Train Loss: 0.186 Vali Loss: 3.045 Vali Acc: 0.307 Test Loss: 3.045 Test Acc: 0.307
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6240837574005127
Epoch: 26, Steps: 10 | Train Loss: 0.148 Vali Loss: 3.065 Vali Acc: 0.307 Test Loss: 3.065 Test Acc: 0.307
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7353224754333496
Epoch: 27, Steps: 10 | Train Loss: 0.106 Vali Loss: 3.075 Vali Acc: 0.307 Test Loss: 3.075 Test Acc: 0.307
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6610352993011475
Epoch: 28, Steps: 10 | Train Loss: 0.133 Vali Loss: 3.062 Vali Acc: 0.312 Test Loss: 3.062 Test Acc: 0.312
Validation loss decreased (-0.307029 --> -0.311734).  Saving model ...
Epoch: 29 cost time: 0.636284589767456
Epoch: 29, Steps: 10 | Train Loss: 0.115 Vali Loss: 3.083 Vali Acc: 0.306 Test Loss: 3.083 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6094188690185547
Epoch: 30, Steps: 10 | Train Loss: 0.080 Vali Loss: 3.101 Vali Acc: 0.308 Test Loss: 3.101 Test Acc: 0.308
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.31176470588235294
model parameter : 235914
model size : 1.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.823077917098999
Epoch: 1, Steps: 10 | Train Loss: 3.379 Vali Loss: 3.300 Vali Acc: 0.038 Test Loss: 3.300 Test Acc: 0.038
Validation loss decreased (inf --> -0.037614).  Saving model ...
Epoch: 2 cost time: 0.6688909530639648
Epoch: 2, Steps: 10 | Train Loss: 3.293 Vali Loss: 3.280 Vali Acc: 0.039 Test Loss: 3.280 Test Acc: 0.039
Validation loss decreased (-0.037614 --> -0.038791).  Saving model ...
Epoch: 3 cost time: 0.6847860813140869
Epoch: 3, Steps: 10 | Train Loss: 3.196 Vali Loss: 3.276 Vali Acc: 0.045 Test Loss: 3.276 Test Acc: 0.045
Validation loss decreased (-0.038791 --> -0.044673).  Saving model ...
Epoch: 4 cost time: 0.7124536037445068
Epoch: 4, Steps: 10 | Train Loss: 3.067 Vali Loss: 3.277 Vali Acc: 0.064 Test Loss: 3.277 Test Acc: 0.064
Validation loss decreased (-0.044673 --> -0.063497).  Saving model ...
Epoch: 5 cost time: 0.6452069282531738
Epoch: 5, Steps: 10 | Train Loss: 2.930 Vali Loss: 3.273 Vali Acc: 0.079 Test Loss: 3.273 Test Acc: 0.079
Validation loss decreased (-0.063497 --> -0.078791).  Saving model ...
Epoch: 6 cost time: 0.6253511905670166
Epoch: 6, Steps: 10 | Train Loss: 2.773 Vali Loss: 3.258 Vali Acc: 0.084 Test Loss: 3.258 Test Acc: 0.084
Validation loss decreased (-0.078791 --> -0.083497).  Saving model ...
Epoch: 7 cost time: 0.641209602355957
Epoch: 7, Steps: 10 | Train Loss: 2.676 Vali Loss: 3.225 Vali Acc: 0.111 Test Loss: 3.225 Test Acc: 0.111
Validation loss decreased (-0.083497 --> -0.110556).  Saving model ...
Epoch: 8 cost time: 0.6397793292999268
Epoch: 8, Steps: 10 | Train Loss: 2.514 Vali Loss: 3.172 Vali Acc: 0.136 Test Loss: 3.172 Test Acc: 0.136
Validation loss decreased (-0.110556 --> -0.136439).  Saving model ...
Epoch: 9 cost time: 0.7010130882263184
Epoch: 9, Steps: 10 | Train Loss: 2.315 Vali Loss: 3.144 Vali Acc: 0.147 Test Loss: 3.144 Test Acc: 0.147
Validation loss decreased (-0.136439 --> -0.147027).  Saving model ...
Epoch: 10 cost time: 0.7279243469238281
Epoch: 10, Steps: 10 | Train Loss: 2.155 Vali Loss: 3.133 Vali Acc: 0.153 Test Loss: 3.133 Test Acc: 0.153
Validation loss decreased (-0.147027 --> -0.152910).  Saving model ...
Epoch: 11 cost time: 0.69352126121521
Epoch: 11, Steps: 10 | Train Loss: 1.984 Vali Loss: 3.086 Vali Acc: 0.162 Test Loss: 3.086 Test Acc: 0.162
Validation loss decreased (-0.152910 --> -0.162322).  Saving model ...
Epoch: 12 cost time: 0.6618738174438477
Epoch: 12, Steps: 10 | Train Loss: 1.764 Vali Loss: 3.055 Vali Acc: 0.189 Test Loss: 3.055 Test Acc: 0.189
Validation loss decreased (-0.162322 --> -0.189381).  Saving model ...
Epoch: 13 cost time: 0.687373161315918
Epoch: 13, Steps: 10 | Train Loss: 1.527 Vali Loss: 3.024 Vali Acc: 0.209 Test Loss: 3.024 Test Acc: 0.209
Validation loss decreased (-0.189381 --> -0.209382).  Saving model ...
Epoch: 14 cost time: 0.6818270683288574
Epoch: 14, Steps: 10 | Train Loss: 1.340 Vali Loss: 3.021 Vali Acc: 0.213 Test Loss: 3.021 Test Acc: 0.213
Validation loss decreased (-0.209382 --> -0.212911).  Saving model ...
Epoch: 15 cost time: 0.6288385391235352
Epoch: 15, Steps: 10 | Train Loss: 1.191 Vali Loss: 2.977 Vali Acc: 0.222 Test Loss: 2.977 Test Acc: 0.222
Validation loss decreased (-0.212911 --> -0.222323).  Saving model ...
Epoch: 16 cost time: 0.6353847980499268
Epoch: 16, Steps: 10 | Train Loss: 1.063 Vali Loss: 3.000 Vali Acc: 0.234 Test Loss: 3.000 Test Acc: 0.234
Validation loss decreased (-0.222323 --> -0.234088).  Saving model ...
Epoch: 17 cost time: 0.6028702259063721
Epoch: 17, Steps: 10 | Train Loss: 0.862 Vali Loss: 3.072 Vali Acc: 0.238 Test Loss: 3.072 Test Acc: 0.238
Validation loss decreased (-0.234088 --> -0.237616).  Saving model ...
Epoch: 18 cost time: 0.6174955368041992
Epoch: 18, Steps: 10 | Train Loss: 0.697 Vali Loss: 2.966 Vali Acc: 0.264 Test Loss: 2.966 Test Acc: 0.264
Validation loss decreased (-0.237616 --> -0.263500).  Saving model ...
Epoch: 19 cost time: 0.6193716526031494
Epoch: 19, Steps: 10 | Train Loss: 0.574 Vali Loss: 2.964 Vali Acc: 0.273 Test Loss: 2.964 Test Acc: 0.273
Validation loss decreased (-0.263500 --> -0.272912).  Saving model ...
Epoch: 20 cost time: 0.6781871318817139
Epoch: 20, Steps: 10 | Train Loss: 0.476 Vali Loss: 3.021 Vali Acc: 0.278 Test Loss: 3.021 Test Acc: 0.278
Validation loss decreased (-0.272912 --> -0.277617).  Saving model ...
Epoch: 21 cost time: 0.6806294918060303
Epoch: 21, Steps: 10 | Train Loss: 0.436 Vali Loss: 2.968 Vali Acc: 0.287 Test Loss: 2.968 Test Acc: 0.287
Validation loss decreased (-0.277617 --> -0.287029).  Saving model ...
Epoch: 22 cost time: 0.6673619747161865
Epoch: 22, Steps: 10 | Train Loss: 0.325 Vali Loss: 2.974 Vali Acc: 0.293 Test Loss: 2.974 Test Acc: 0.293
Validation loss decreased (-0.287029 --> -0.292911).  Saving model ...
Epoch: 23 cost time: 0.6630158424377441
Epoch: 23, Steps: 10 | Train Loss: 0.238 Vali Loss: 3.016 Vali Acc: 0.280 Test Loss: 3.016 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6719563007354736
Epoch: 24, Steps: 10 | Train Loss: 0.212 Vali Loss: 3.050 Vali Acc: 0.302 Test Loss: 3.050 Test Acc: 0.302
Validation loss decreased (-0.292911 --> -0.302322).  Saving model ...
Epoch: 25 cost time: 0.6726474761962891
Epoch: 25, Steps: 10 | Train Loss: 0.175 Vali Loss: 3.050 Vali Acc: 0.301 Test Loss: 3.050 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6354825496673584
Epoch: 26, Steps: 10 | Train Loss: 0.214 Vali Loss: 3.105 Vali Acc: 0.296 Test Loss: 3.105 Test Acc: 0.296
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.647960901260376
Epoch: 27, Steps: 10 | Train Loss: 0.117 Vali Loss: 3.148 Vali Acc: 0.305 Test Loss: 3.148 Test Acc: 0.305
Validation loss decreased (-0.302322 --> -0.304674).  Saving model ...
Epoch: 28 cost time: 0.6738526821136475
Epoch: 28, Steps: 10 | Train Loss: 0.115 Vali Loss: 3.117 Vali Acc: 0.316 Test Loss: 3.117 Test Acc: 0.316
Validation loss decreased (-0.304674 --> -0.316439).  Saving model ...
Epoch: 29 cost time: 0.5918543338775635
Epoch: 29, Steps: 10 | Train Loss: 0.151 Vali Loss: 3.118 Vali Acc: 0.318 Test Loss: 3.118 Test Acc: 0.318
Validation loss decreased (-0.316439 --> -0.317616).  Saving model ...
Epoch: 30 cost time: 0.639460563659668
Epoch: 30, Steps: 10 | Train Loss: 0.088 Vali Loss: 3.102 Vali Acc: 0.325 Test Loss: 3.102 Test Acc: 0.325
Validation loss decreased (-0.317616 --> -0.324675).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3247058823529412
model parameter : 649802
model size : 2.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.8119077682495117
Epoch: 1, Steps: 10 | Train Loss: 3.386 Vali Loss: 3.317 Vali Acc: 0.032 Test Loss: 3.317 Test Acc: 0.032
Validation loss decreased (inf --> -0.031732).  Saving model ...
Epoch: 2 cost time: 0.6302471160888672
Epoch: 2, Steps: 10 | Train Loss: 3.295 Vali Loss: 3.288 Vali Acc: 0.032 Test Loss: 3.288 Test Acc: 0.032
Validation loss decreased (-0.031732 --> -0.031732).  Saving model ...
Epoch: 3 cost time: 0.6033060550689697
Epoch: 3, Steps: 10 | Train Loss: 3.198 Vali Loss: 3.276 Vali Acc: 0.036 Test Loss: 3.276 Test Acc: 0.036
Validation loss decreased (-0.031732 --> -0.036438).  Saving model ...
Epoch: 4 cost time: 0.6731302738189697
Epoch: 4, Steps: 10 | Train Loss: 3.051 Vali Loss: 3.267 Vali Acc: 0.062 Test Loss: 3.267 Test Acc: 0.062
Validation loss decreased (-0.036438 --> -0.062320).  Saving model ...
Epoch: 5 cost time: 0.5975742340087891
Epoch: 5, Steps: 10 | Train Loss: 2.876 Vali Loss: 3.250 Vali Acc: 0.079 Test Loss: 3.250 Test Acc: 0.079
Validation loss decreased (-0.062320 --> -0.078791).  Saving model ...
Epoch: 6 cost time: 0.6803994178771973
Epoch: 6, Steps: 10 | Train Loss: 2.820 Vali Loss: 3.238 Vali Acc: 0.094 Test Loss: 3.238 Test Acc: 0.094
Validation loss decreased (-0.078791 --> -0.094085).  Saving model ...
Epoch: 7 cost time: 0.573286771774292
Epoch: 7, Steps: 10 | Train Loss: 2.658 Vali Loss: 3.214 Vali Acc: 0.111 Test Loss: 3.214 Test Acc: 0.111
Validation loss decreased (-0.094085 --> -0.110556).  Saving model ...
Epoch: 8 cost time: 0.60964035987854
Epoch: 8, Steps: 10 | Train Loss: 2.536 Vali Loss: 3.187 Vali Acc: 0.122 Test Loss: 3.187 Test Acc: 0.122
Validation loss decreased (-0.110556 --> -0.122321).  Saving model ...
Epoch: 9 cost time: 0.56856369972229
Epoch: 9, Steps: 10 | Train Loss: 2.326 Vali Loss: 3.146 Vali Acc: 0.136 Test Loss: 3.146 Test Acc: 0.136
Validation loss decreased (-0.122321 --> -0.136439).  Saving model ...
Epoch: 10 cost time: 0.5722873210906982
Epoch: 10, Steps: 10 | Train Loss: 2.162 Vali Loss: 3.115 Vali Acc: 0.155 Test Loss: 3.115 Test Acc: 0.155
Validation loss decreased (-0.136439 --> -0.155263).  Saving model ...
Epoch: 11 cost time: 0.5642251968383789
Epoch: 11, Steps: 10 | Train Loss: 1.998 Vali Loss: 3.096 Vali Acc: 0.154 Test Loss: 3.096 Test Acc: 0.154
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5833654403686523
Epoch: 12, Steps: 10 | Train Loss: 1.801 Vali Loss: 3.107 Vali Acc: 0.159 Test Loss: 3.107 Test Acc: 0.159
Validation loss decreased (-0.155263 --> -0.158792).  Saving model ...
Epoch: 13 cost time: 0.6149458885192871
Epoch: 13, Steps: 10 | Train Loss: 1.626 Vali Loss: 3.074 Vali Acc: 0.181 Test Loss: 3.074 Test Acc: 0.181
Validation loss decreased (-0.158792 --> -0.181146).  Saving model ...
Epoch: 14 cost time: 0.583636999130249
Epoch: 14, Steps: 10 | Train Loss: 1.467 Vali Loss: 3.049 Vali Acc: 0.205 Test Loss: 3.049 Test Acc: 0.205
Validation loss decreased (-0.181146 --> -0.204675).  Saving model ...
Epoch: 15 cost time: 0.594212532043457
Epoch: 15, Steps: 10 | Train Loss: 1.180 Vali Loss: 3.056 Vali Acc: 0.211 Test Loss: 3.056 Test Acc: 0.211
Validation loss decreased (-0.204675 --> -0.210558).  Saving model ...
Epoch: 16 cost time: 0.6056077480316162
Epoch: 16, Steps: 10 | Train Loss: 1.065 Vali Loss: 3.027 Vali Acc: 0.225 Test Loss: 3.027 Test Acc: 0.225
Validation loss decreased (-0.210558 --> -0.224676).  Saving model ...
Epoch: 17 cost time: 0.6619668006896973
Epoch: 17, Steps: 10 | Train Loss: 0.947 Vali Loss: 3.038 Vali Acc: 0.228 Test Loss: 3.038 Test Acc: 0.228
Validation loss decreased (-0.224676 --> -0.228205).  Saving model ...
Epoch: 18 cost time: 0.6195595264434814
Epoch: 18, Steps: 10 | Train Loss: 0.851 Vali Loss: 3.024 Vali Acc: 0.244 Test Loss: 3.024 Test Acc: 0.244
Validation loss decreased (-0.228205 --> -0.243499).  Saving model ...
Epoch: 19 cost time: 0.6311900615692139
Epoch: 19, Steps: 10 | Train Loss: 0.740 Vali Loss: 3.015 Vali Acc: 0.259 Test Loss: 3.015 Test Acc: 0.259
Validation loss decreased (-0.243499 --> -0.258793).  Saving model ...
Epoch: 20 cost time: 0.6100368499755859
Epoch: 20, Steps: 10 | Train Loss: 0.492 Vali Loss: 3.041 Vali Acc: 0.254 Test Loss: 3.041 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6494722366333008
Epoch: 21, Steps: 10 | Train Loss: 0.438 Vali Loss: 3.037 Vali Acc: 0.275 Test Loss: 3.037 Test Acc: 0.275
Validation loss decreased (-0.258793 --> -0.275264).  Saving model ...
Epoch: 22 cost time: 0.6859285831451416
Epoch: 22, Steps: 10 | Train Loss: 0.428 Vali Loss: 3.044 Vali Acc: 0.265 Test Loss: 3.044 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6271090507507324
Epoch: 23, Steps: 10 | Train Loss: 0.357 Vali Loss: 3.081 Vali Acc: 0.272 Test Loss: 3.081 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5682430267333984
Epoch: 24, Steps: 10 | Train Loss: 0.356 Vali Loss: 3.050 Vali Acc: 0.280 Test Loss: 3.050 Test Acc: 0.280
Validation loss decreased (-0.275264 --> -0.279970).  Saving model ...
Epoch: 25 cost time: 0.6148285865783691
Epoch: 25, Steps: 10 | Train Loss: 0.291 Vali Loss: 3.114 Vali Acc: 0.286 Test Loss: 3.114 Test Acc: 0.286
Validation loss decreased (-0.279970 --> -0.285851).  Saving model ...
Epoch: 26 cost time: 0.601783037185669
Epoch: 26, Steps: 10 | Train Loss: 0.197 Vali Loss: 3.091 Vali Acc: 0.296 Test Loss: 3.091 Test Acc: 0.296
Validation loss decreased (-0.285851 --> -0.296440).  Saving model ...
Epoch: 27 cost time: 0.6600589752197266
Epoch: 27, Steps: 10 | Train Loss: 0.143 Vali Loss: 3.135 Vali Acc: 0.291 Test Loss: 3.135 Test Acc: 0.291
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6214454174041748
Epoch: 28, Steps: 10 | Train Loss: 0.130 Vali Loss: 3.129 Vali Acc: 0.302 Test Loss: 3.129 Test Acc: 0.302
Validation loss decreased (-0.296440 --> -0.302322).  Saving model ...
Epoch: 29 cost time: 0.60703444480896
Epoch: 29, Steps: 10 | Train Loss: 0.158 Vali Loss: 3.179 Vali Acc: 0.293 Test Loss: 3.179 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.578235387802124
Epoch: 30, Steps: 10 | Train Loss: 0.129 Vali Loss: 3.158 Vali Acc: 0.300 Test Loss: 3.158 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3023529411764706
model parameter : 235914
model size : 1.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.0963966846466064
Epoch: 1, Steps: 10 | Train Loss: 3.287 Vali Loss: 3.307 Vali Acc: 0.053 Test Loss: 3.307 Test Acc: 0.053
Validation loss decreased (inf --> -0.052908).  Saving model ...
Epoch: 2 cost time: 0.8006391525268555
Epoch: 2, Steps: 10 | Train Loss: 3.222 Vali Loss: 3.287 Vali Acc: 0.060 Test Loss: 3.287 Test Acc: 0.060
Validation loss decreased (-0.052908 --> -0.059967).  Saving model ...
Epoch: 3 cost time: 0.8742325305938721
Epoch: 3, Steps: 10 | Train Loss: 3.097 Vali Loss: 3.280 Vali Acc: 0.079 Test Loss: 3.280 Test Acc: 0.079
Validation loss decreased (-0.059967 --> -0.078791).  Saving model ...
Epoch: 4 cost time: 0.9688930511474609
Epoch: 4, Steps: 10 | Train Loss: 2.955 Vali Loss: 3.267 Vali Acc: 0.086 Test Loss: 3.267 Test Acc: 0.086
Validation loss decreased (-0.078791 --> -0.085850).  Saving model ...
Epoch: 5 cost time: 0.9572083950042725
Epoch: 5, Steps: 10 | Train Loss: 2.829 Vali Loss: 3.254 Vali Acc: 0.102 Test Loss: 3.254 Test Acc: 0.102
Validation loss decreased (-0.085850 --> -0.102320).  Saving model ...
Epoch: 6 cost time: 0.9495599269866943
Epoch: 6, Steps: 10 | Train Loss: 2.688 Vali Loss: 3.223 Vali Acc: 0.118 Test Loss: 3.223 Test Acc: 0.118
Validation loss decreased (-0.102320 --> -0.117615).  Saving model ...
Epoch: 7 cost time: 0.891146183013916
Epoch: 7, Steps: 10 | Train Loss: 2.471 Vali Loss: 3.180 Vali Acc: 0.135 Test Loss: 3.180 Test Acc: 0.135
Validation loss decreased (-0.117615 --> -0.135262).  Saving model ...
Epoch: 8 cost time: 0.9734454154968262
Epoch: 8, Steps: 10 | Train Loss: 2.271 Vali Loss: 3.137 Vali Acc: 0.148 Test Loss: 3.137 Test Acc: 0.148
Validation loss decreased (-0.135262 --> -0.148204).  Saving model ...
Epoch: 9 cost time: 0.9555671215057373
Epoch: 9, Steps: 10 | Train Loss: 2.048 Vali Loss: 3.084 Vali Acc: 0.171 Test Loss: 3.084 Test Acc: 0.171
Validation loss decreased (-0.148204 --> -0.170557).  Saving model ...
Epoch: 10 cost time: 0.8864395618438721
Epoch: 10, Steps: 10 | Train Loss: 1.791 Vali Loss: 3.051 Vali Acc: 0.182 Test Loss: 3.051 Test Acc: 0.182
Validation loss decreased (-0.170557 --> -0.182322).  Saving model ...
Epoch: 11 cost time: 0.9063780307769775
Epoch: 11, Steps: 10 | Train Loss: 1.604 Vali Loss: 3.047 Vali Acc: 0.196 Test Loss: 3.047 Test Acc: 0.196
Validation loss decreased (-0.182322 --> -0.196440).  Saving model ...
Epoch: 12 cost time: 0.8936896324157715
Epoch: 12, Steps: 10 | Train Loss: 1.345 Vali Loss: 3.014 Vali Acc: 0.218 Test Loss: 3.014 Test Acc: 0.218
Validation loss decreased (-0.196440 --> -0.217617).  Saving model ...
Epoch: 13 cost time: 0.770463228225708
Epoch: 13, Steps: 10 | Train Loss: 1.127 Vali Loss: 2.999 Vali Acc: 0.214 Test Loss: 2.999 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0360162258148193
Epoch: 14, Steps: 10 | Train Loss: 0.879 Vali Loss: 2.990 Vali Acc: 0.235 Test Loss: 2.990 Test Acc: 0.235
Validation loss decreased (-0.217617 --> -0.235264).  Saving model ...
Epoch: 15 cost time: 0.9617855548858643
Epoch: 15, Steps: 10 | Train Loss: 0.739 Vali Loss: 2.977 Vali Acc: 0.235 Test Loss: 2.977 Test Acc: 0.235
Validation loss decreased (-0.235264 --> -0.235264).  Saving model ...
Epoch: 16 cost time: 0.9200170040130615
Epoch: 16, Steps: 10 | Train Loss: 0.581 Vali Loss: 3.020 Vali Acc: 0.252 Test Loss: 3.020 Test Acc: 0.252
Validation loss decreased (-0.235264 --> -0.251735).  Saving model ...
Epoch: 17 cost time: 1.0582504272460938
Epoch: 17, Steps: 10 | Train Loss: 0.439 Vali Loss: 3.003 Vali Acc: 0.248 Test Loss: 3.003 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0194039344787598
Epoch: 18, Steps: 10 | Train Loss: 0.419 Vali Loss: 3.039 Vali Acc: 0.244 Test Loss: 3.039 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9478564262390137
Epoch: 19, Steps: 10 | Train Loss: 0.389 Vali Loss: 3.150 Vali Acc: 0.254 Test Loss: 3.150 Test Acc: 0.254
Validation loss decreased (-0.251735 --> -0.254086).  Saving model ...
Epoch: 20 cost time: 0.9381566047668457
Epoch: 20, Steps: 10 | Train Loss: 0.235 Vali Loss: 3.087 Vali Acc: 0.268 Test Loss: 3.087 Test Acc: 0.268
Validation loss decreased (-0.254086 --> -0.268204).  Saving model ...
Epoch: 21 cost time: 0.8456575870513916
Epoch: 21, Steps: 10 | Train Loss: 0.195 Vali Loss: 3.138 Vali Acc: 0.269 Test Loss: 3.138 Test Acc: 0.269
Validation loss decreased (-0.268204 --> -0.269380).  Saving model ...
Epoch: 22 cost time: 0.8944761753082275
Epoch: 22, Steps: 10 | Train Loss: 0.170 Vali Loss: 3.085 Vali Acc: 0.280 Test Loss: 3.085 Test Acc: 0.280
Validation loss decreased (-0.269380 --> -0.279969).  Saving model ...
Epoch: 23 cost time: 1.0131170749664307
Epoch: 23, Steps: 10 | Train Loss: 0.124 Vali Loss: 3.057 Vali Acc: 0.289 Test Loss: 3.057 Test Acc: 0.289
Validation loss decreased (-0.279969 --> -0.289381).  Saving model ...
Epoch: 24 cost time: 1.053426742553711
Epoch: 24, Steps: 10 | Train Loss: 0.107 Vali Loss: 3.076 Vali Acc: 0.288 Test Loss: 3.076 Test Acc: 0.288
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.017406940460205
Epoch: 25, Steps: 10 | Train Loss: 0.094 Vali Loss: 3.102 Vali Acc: 0.299 Test Loss: 3.102 Test Acc: 0.299
Validation loss decreased (-0.289381 --> -0.298793).  Saving model ...
Epoch: 26 cost time: 0.9966580867767334
Epoch: 26, Steps: 10 | Train Loss: 0.082 Vali Loss: 3.141 Vali Acc: 0.307 Test Loss: 3.141 Test Acc: 0.307
Validation loss decreased (-0.298793 --> -0.307027).  Saving model ...
Epoch: 27 cost time: 1.0517163276672363
Epoch: 27, Steps: 10 | Train Loss: 0.064 Vali Loss: 3.154 Vali Acc: 0.304 Test Loss: 3.154 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9330735206604004
Epoch: 28, Steps: 10 | Train Loss: 0.059 Vali Loss: 3.153 Vali Acc: 0.302 Test Loss: 3.153 Test Acc: 0.302
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9439089298248291
Epoch: 29, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.177 Vali Acc: 0.306 Test Loss: 3.177 Test Acc: 0.306
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.9891090393066406
Epoch: 30, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.159 Vali Acc: 0.307 Test Loss: 3.159 Test Acc: 0.307
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3070588235294118
model parameter : 356746
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.152505874633789
Epoch: 1, Steps: 10 | Train Loss: 3.315 Vali Loss: 3.299 Vali Acc: 0.041 Test Loss: 3.299 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 0.8710513114929199
Epoch: 2, Steps: 10 | Train Loss: 3.231 Vali Loss: 3.288 Vali Acc: 0.062 Test Loss: 3.288 Test Acc: 0.062
Validation loss decreased (-0.041143 --> -0.062320).  Saving model ...
Epoch: 3 cost time: 0.8085412979125977
Epoch: 3, Steps: 10 | Train Loss: 3.135 Vali Loss: 3.289 Vali Acc: 0.068 Test Loss: 3.289 Test Acc: 0.068
Validation loss decreased (-0.062320 --> -0.068202).  Saving model ...
Epoch: 4 cost time: 0.8249082565307617
Epoch: 4, Steps: 10 | Train Loss: 2.997 Vali Loss: 3.290 Vali Acc: 0.078 Test Loss: 3.290 Test Acc: 0.078
Validation loss decreased (-0.068202 --> -0.077614).  Saving model ...
Epoch: 5 cost time: 0.6292920112609863
Epoch: 5, Steps: 10 | Train Loss: 2.885 Vali Loss: 3.280 Vali Acc: 0.109 Test Loss: 3.280 Test Acc: 0.109
Validation loss decreased (-0.077614 --> -0.109379).  Saving model ...
Epoch: 6 cost time: 0.7810628414154053
Epoch: 6, Steps: 10 | Train Loss: 2.709 Vali Loss: 3.251 Vali Acc: 0.127 Test Loss: 3.251 Test Acc: 0.127
Validation loss decreased (-0.109379 --> -0.127026).  Saving model ...
Epoch: 7 cost time: 0.7119076251983643
Epoch: 7, Steps: 10 | Train Loss: 2.628 Vali Loss: 3.222 Vali Acc: 0.142 Test Loss: 3.222 Test Acc: 0.142
Validation loss decreased (-0.127026 --> -0.142321).  Saving model ...
Epoch: 8 cost time: 0.7834982872009277
Epoch: 8, Steps: 10 | Train Loss: 2.452 Vali Loss: 3.182 Vali Acc: 0.148 Test Loss: 3.182 Test Acc: 0.148
Validation loss decreased (-0.142321 --> -0.148203).  Saving model ...
Epoch: 9 cost time: 0.7163074016571045
Epoch: 9, Steps: 10 | Train Loss: 2.256 Vali Loss: 3.142 Vali Acc: 0.156 Test Loss: 3.142 Test Acc: 0.156
Validation loss decreased (-0.148203 --> -0.156439).  Saving model ...
Epoch: 10 cost time: 0.926645040512085
Epoch: 10, Steps: 10 | Train Loss: 2.051 Vali Loss: 3.098 Vali Acc: 0.171 Test Loss: 3.098 Test Acc: 0.171
Validation loss decreased (-0.156439 --> -0.170557).  Saving model ...
Epoch: 11 cost time: 0.8560729026794434
Epoch: 11, Steps: 10 | Train Loss: 1.818 Vali Loss: 3.068 Vali Acc: 0.180 Test Loss: 3.068 Test Acc: 0.180
Validation loss decreased (-0.170557 --> -0.179969).  Saving model ...
Epoch: 12 cost time: 0.9224998950958252
Epoch: 12, Steps: 10 | Train Loss: 1.614 Vali Loss: 3.056 Vali Acc: 0.201 Test Loss: 3.056 Test Acc: 0.201
Validation loss decreased (-0.179969 --> -0.201146).  Saving model ...
Epoch: 13 cost time: 0.8154568672180176
Epoch: 13, Steps: 10 | Train Loss: 1.413 Vali Loss: 3.023 Vali Acc: 0.206 Test Loss: 3.023 Test Acc: 0.206
Validation loss decreased (-0.201146 --> -0.205852).  Saving model ...
Epoch: 14 cost time: 0.881077766418457
Epoch: 14, Steps: 10 | Train Loss: 1.213 Vali Loss: 3.008 Vali Acc: 0.220 Test Loss: 3.008 Test Acc: 0.220
Validation loss decreased (-0.205852 --> -0.219970).  Saving model ...
Epoch: 15 cost time: 0.798037052154541
Epoch: 15, Steps: 10 | Train Loss: 1.038 Vali Loss: 3.024 Vali Acc: 0.228 Test Loss: 3.024 Test Acc: 0.228
Validation loss decreased (-0.219970 --> -0.228205).  Saving model ...
Epoch: 16 cost time: 0.8119931221008301
Epoch: 16, Steps: 10 | Train Loss: 0.939 Vali Loss: 2.994 Vali Acc: 0.238 Test Loss: 2.994 Test Acc: 0.238
Validation loss decreased (-0.228205 --> -0.237617).  Saving model ...
Epoch: 17 cost time: 0.7615699768066406
Epoch: 17, Steps: 10 | Train Loss: 0.743 Vali Loss: 3.013 Vali Acc: 0.253 Test Loss: 3.013 Test Acc: 0.253
Validation loss decreased (-0.237617 --> -0.252911).  Saving model ...
Epoch: 18 cost time: 0.813500165939331
Epoch: 18, Steps: 10 | Train Loss: 0.610 Vali Loss: 2.994 Vali Acc: 0.259 Test Loss: 2.994 Test Acc: 0.259
Validation loss decreased (-0.252911 --> -0.258794).  Saving model ...
Epoch: 19 cost time: 0.7497725486755371
Epoch: 19, Steps: 10 | Train Loss: 0.507 Vali Loss: 3.013 Vali Acc: 0.262 Test Loss: 3.013 Test Acc: 0.262
Validation loss decreased (-0.258794 --> -0.262323).  Saving model ...
Epoch: 20 cost time: 0.8477935791015625
Epoch: 20, Steps: 10 | Train Loss: 0.398 Vali Loss: 3.031 Vali Acc: 0.278 Test Loss: 3.031 Test Acc: 0.278
Validation loss decreased (-0.262323 --> -0.277617).  Saving model ...
Epoch: 21 cost time: 0.917736291885376
Epoch: 21, Steps: 10 | Train Loss: 0.321 Vali Loss: 3.023 Vali Acc: 0.287 Test Loss: 3.023 Test Acc: 0.287
Validation loss decreased (-0.277617 --> -0.287029).  Saving model ...
Epoch: 22 cost time: 0.8903100490570068
Epoch: 22, Steps: 10 | Train Loss: 0.271 Vali Loss: 3.042 Vali Acc: 0.292 Test Loss: 3.042 Test Acc: 0.292
Validation loss decreased (-0.287029 --> -0.291734).  Saving model ...
Epoch: 23 cost time: 0.9350204467773438
Epoch: 23, Steps: 10 | Train Loss: 0.231 Vali Loss: 3.136 Vali Acc: 0.282 Test Loss: 3.136 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8093457221984863
Epoch: 24, Steps: 10 | Train Loss: 0.193 Vali Loss: 3.107 Vali Acc: 0.292 Test Loss: 3.107 Test Acc: 0.292
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8636233806610107
Epoch: 25, Steps: 10 | Train Loss: 0.164 Vali Loss: 3.108 Vali Acc: 0.293 Test Loss: 3.108 Test Acc: 0.293
Validation loss decreased (-0.291734 --> -0.292910).  Saving model ...
Epoch: 26 cost time: 0.8041484355926514
Epoch: 26, Steps: 10 | Train Loss: 0.138 Vali Loss: 3.116 Vali Acc: 0.296 Test Loss: 3.116 Test Acc: 0.296
Validation loss decreased (-0.292910 --> -0.296439).  Saving model ...
Epoch: 27 cost time: 0.8044252395629883
Epoch: 27, Steps: 10 | Train Loss: 0.129 Vali Loss: 3.148 Vali Acc: 0.296 Test Loss: 3.148 Test Acc: 0.296
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.802215576171875
Epoch: 28, Steps: 10 | Train Loss: 0.096 Vali Loss: 3.182 Vali Acc: 0.293 Test Loss: 3.182 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8088870048522949
Epoch: 29, Steps: 10 | Train Loss: 0.089 Vali Loss: 3.181 Vali Acc: 0.296 Test Loss: 3.181 Test Acc: 0.296
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.8941571712493896
Epoch: 30, Steps: 10 | Train Loss: 0.079 Vali Loss: 3.192 Vali Acc: 0.301 Test Loss: 3.192 Test Acc: 0.301
Validation loss decreased (-0.296439 --> -0.301145).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.30117647058823527
model parameter : 149770
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.256477117538452
Epoch: 1, Steps: 10 | Train Loss: 3.292 Vali Loss: 3.307 Vali Acc: 0.052 Test Loss: 3.307 Test Acc: 0.052
Validation loss decreased (inf --> -0.051732).  Saving model ...
Epoch: 2 cost time: 0.9162538051605225
Epoch: 2, Steps: 10 | Train Loss: 3.220 Vali Loss: 3.288 Vali Acc: 0.058 Test Loss: 3.288 Test Acc: 0.058
Validation loss decreased (-0.051732 --> -0.057614).  Saving model ...
Epoch: 3 cost time: 0.8196675777435303
Epoch: 3, Steps: 10 | Train Loss: 3.104 Vali Loss: 3.282 Vali Acc: 0.073 Test Loss: 3.282 Test Acc: 0.073
Validation loss decreased (-0.057614 --> -0.072908).  Saving model ...
Epoch: 4 cost time: 0.74503493309021
Epoch: 4, Steps: 10 | Train Loss: 2.959 Vali Loss: 3.270 Vali Acc: 0.084 Test Loss: 3.270 Test Acc: 0.084
Validation loss decreased (-0.072908 --> -0.083497).  Saving model ...
Epoch: 5 cost time: 0.7784435749053955
Epoch: 5, Steps: 10 | Train Loss: 2.844 Vali Loss: 3.260 Vali Acc: 0.098 Test Loss: 3.260 Test Acc: 0.098
Validation loss decreased (-0.083497 --> -0.097614).  Saving model ...
Epoch: 6 cost time: 0.8263258934020996
Epoch: 6, Steps: 10 | Train Loss: 2.704 Vali Loss: 3.233 Vali Acc: 0.115 Test Loss: 3.233 Test Acc: 0.115
Validation loss decreased (-0.097614 --> -0.115262).  Saving model ...
Epoch: 7 cost time: 0.7643108367919922
Epoch: 7, Steps: 10 | Train Loss: 2.497 Vali Loss: 3.194 Vali Acc: 0.129 Test Loss: 3.194 Test Acc: 0.129
Validation loss decreased (-0.115262 --> -0.129380).  Saving model ...
Epoch: 8 cost time: 0.8230161666870117
Epoch: 8, Steps: 10 | Train Loss: 2.333 Vali Loss: 3.155 Vali Acc: 0.151 Test Loss: 3.155 Test Acc: 0.151
Validation loss decreased (-0.129380 --> -0.150557).  Saving model ...
Epoch: 9 cost time: 0.9034018516540527
Epoch: 9, Steps: 10 | Train Loss: 2.114 Vali Loss: 3.107 Vali Acc: 0.174 Test Loss: 3.107 Test Acc: 0.174
Validation loss decreased (-0.150557 --> -0.174087).  Saving model ...
Epoch: 10 cost time: 0.8590817451477051
Epoch: 10, Steps: 10 | Train Loss: 1.859 Vali Loss: 3.070 Vali Acc: 0.182 Test Loss: 3.070 Test Acc: 0.182
Validation loss decreased (-0.174087 --> -0.182322).  Saving model ...
Epoch: 11 cost time: 0.8741657733917236
Epoch: 11, Steps: 10 | Train Loss: 1.681 Vali Loss: 3.075 Vali Acc: 0.186 Test Loss: 3.075 Test Acc: 0.186
Validation loss decreased (-0.182322 --> -0.185852).  Saving model ...
Epoch: 12 cost time: 0.8978912830352783
Epoch: 12, Steps: 10 | Train Loss: 1.443 Vali Loss: 3.048 Vali Acc: 0.199 Test Loss: 3.048 Test Acc: 0.199
Validation loss decreased (-0.185852 --> -0.198793).  Saving model ...
Epoch: 13 cost time: 0.8072996139526367
Epoch: 13, Steps: 10 | Train Loss: 1.204 Vali Loss: 3.037 Vali Acc: 0.215 Test Loss: 3.037 Test Acc: 0.215
Validation loss decreased (-0.198793 --> -0.215264).  Saving model ...
Epoch: 14 cost time: 0.7982325553894043
Epoch: 14, Steps: 10 | Train Loss: 1.076 Vali Loss: 3.013 Vali Acc: 0.233 Test Loss: 3.013 Test Acc: 0.233
Validation loss decreased (-0.215264 --> -0.232911).  Saving model ...
Epoch: 15 cost time: 0.8316287994384766
Epoch: 15, Steps: 10 | Train Loss: 0.832 Vali Loss: 3.015 Vali Acc: 0.231 Test Loss: 3.015 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7840602397918701
Epoch: 16, Steps: 10 | Train Loss: 0.774 Vali Loss: 3.069 Vali Acc: 0.236 Test Loss: 3.069 Test Acc: 0.236
Validation loss decreased (-0.232911 --> -0.236440).  Saving model ...
Epoch: 17 cost time: 0.9435160160064697
Epoch: 17, Steps: 10 | Train Loss: 0.635 Vali Loss: 3.015 Vali Acc: 0.260 Test Loss: 3.015 Test Acc: 0.260
Validation loss decreased (-0.236440 --> -0.259970).  Saving model ...
Epoch: 18 cost time: 0.931877613067627
Epoch: 18, Steps: 10 | Train Loss: 0.417 Vali Loss: 3.012 Vali Acc: 0.276 Test Loss: 3.012 Test Acc: 0.276
Validation loss decreased (-0.259970 --> -0.276440).  Saving model ...
Epoch: 19 cost time: 0.8788011074066162
Epoch: 19, Steps: 10 | Train Loss: 0.417 Vali Loss: 3.047 Vali Acc: 0.280 Test Loss: 3.047 Test Acc: 0.280
Validation loss decreased (-0.276440 --> -0.279970).  Saving model ...
Epoch: 20 cost time: 0.848914623260498
Epoch: 20, Steps: 10 | Train Loss: 0.277 Vali Loss: 3.046 Vali Acc: 0.291 Test Loss: 3.046 Test Acc: 0.291
Validation loss decreased (-0.279970 --> -0.290558).  Saving model ...
Epoch: 21 cost time: 0.8563766479492188
Epoch: 21, Steps: 10 | Train Loss: 0.363 Vali Loss: 3.135 Vali Acc: 0.287 Test Loss: 3.135 Test Acc: 0.287
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.854032039642334
Epoch: 22, Steps: 10 | Train Loss: 0.295 Vali Loss: 3.108 Vali Acc: 0.289 Test Loss: 3.108 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7947824001312256
Epoch: 23, Steps: 10 | Train Loss: 0.189 Vali Loss: 3.043 Vali Acc: 0.313 Test Loss: 3.043 Test Acc: 0.313
Validation loss decreased (-0.290558 --> -0.312911).  Saving model ...
Epoch: 24 cost time: 0.8244006633758545
Epoch: 24, Steps: 10 | Train Loss: 0.156 Vali Loss: 3.067 Vali Acc: 0.301 Test Loss: 3.067 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7661359310150146
Epoch: 25, Steps: 10 | Train Loss: 0.105 Vali Loss: 3.138 Vali Acc: 0.300 Test Loss: 3.138 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8046045303344727
Epoch: 26, Steps: 10 | Train Loss: 0.147 Vali Loss: 3.147 Vali Acc: 0.313 Test Loss: 3.147 Test Acc: 0.313
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8708405494689941
Epoch: 27, Steps: 10 | Train Loss: 0.134 Vali Loss: 3.142 Vali Acc: 0.316 Test Loss: 3.142 Test Acc: 0.316
Validation loss decreased (-0.312911 --> -0.316439).  Saving model ...
Epoch: 28 cost time: 0.8834142684936523
Epoch: 28, Steps: 10 | Train Loss: 0.126 Vali Loss: 3.202 Vali Acc: 0.304 Test Loss: 3.202 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8398258686065674
Epoch: 29, Steps: 10 | Train Loss: 0.056 Vali Loss: 3.191 Vali Acc: 0.315 Test Loss: 3.191 Test Acc: 0.315
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8861594200134277
Epoch: 30, Steps: 10 | Train Loss: 0.101 Vali Loss: 3.165 Vali Acc: 0.313 Test Loss: 3.165 Test Acc: 0.313
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3164705882352941
model parameter : 356746
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.0791358947753906
Epoch: 1, Steps: 10 | Train Loss: 3.302 Vali Loss: 3.298 Vali Acc: 0.047 Test Loss: 3.298 Test Acc: 0.047
Validation loss decreased (inf --> -0.047026).  Saving model ...
Epoch: 2 cost time: 0.6235833168029785
Epoch: 2, Steps: 10 | Train Loss: 3.231 Vali Loss: 3.288 Vali Acc: 0.067 Test Loss: 3.288 Test Acc: 0.067
Validation loss decreased (-0.047026 --> -0.067026).  Saving model ...
Epoch: 3 cost time: 0.6752922534942627
Epoch: 3, Steps: 10 | Train Loss: 3.145 Vali Loss: 3.289 Vali Acc: 0.068 Test Loss: 3.289 Test Acc: 0.068
Validation loss decreased (-0.067026 --> -0.068202).  Saving model ...
Epoch: 4 cost time: 0.6383960247039795
Epoch: 4, Steps: 10 | Train Loss: 3.001 Vali Loss: 3.291 Vali Acc: 0.080 Test Loss: 3.291 Test Acc: 0.080
Validation loss decreased (-0.068202 --> -0.079967).  Saving model ...
Epoch: 5 cost time: 0.7087936401367188
Epoch: 5, Steps: 10 | Train Loss: 2.897 Vali Loss: 3.282 Vali Acc: 0.106 Test Loss: 3.282 Test Acc: 0.106
Validation loss decreased (-0.079967 --> -0.105850).  Saving model ...
Epoch: 6 cost time: 0.7788174152374268
Epoch: 6, Steps: 10 | Train Loss: 2.736 Vali Loss: 3.255 Vali Acc: 0.124 Test Loss: 3.255 Test Acc: 0.124
Validation loss decreased (-0.105850 --> -0.123497).  Saving model ...
Epoch: 7 cost time: 0.745673656463623
Epoch: 7, Steps: 10 | Train Loss: 2.665 Vali Loss: 3.230 Vali Acc: 0.134 Test Loss: 3.230 Test Acc: 0.134
Validation loss decreased (-0.123497 --> -0.134085).  Saving model ...
Epoch: 8 cost time: 0.6927545070648193
Epoch: 8, Steps: 10 | Train Loss: 2.516 Vali Loss: 3.191 Vali Acc: 0.147 Test Loss: 3.191 Test Acc: 0.147
Validation loss decreased (-0.134085 --> -0.147027).  Saving model ...
Epoch: 9 cost time: 0.7752676010131836
Epoch: 9, Steps: 10 | Train Loss: 2.304 Vali Loss: 3.155 Vali Acc: 0.153 Test Loss: 3.155 Test Acc: 0.153
Validation loss decreased (-0.147027 --> -0.152910).  Saving model ...
Epoch: 10 cost time: 0.7246608734130859
Epoch: 10, Steps: 10 | Train Loss: 2.128 Vali Loss: 3.112 Vali Acc: 0.173 Test Loss: 3.112 Test Acc: 0.173
Validation loss decreased (-0.152910 --> -0.172910).  Saving model ...
Epoch: 11 cost time: 0.5995972156524658
Epoch: 11, Steps: 10 | Train Loss: 1.943 Vali Loss: 3.086 Vali Acc: 0.169 Test Loss: 3.086 Test Acc: 0.169
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6465306282043457
Epoch: 12, Steps: 10 | Train Loss: 1.698 Vali Loss: 3.076 Vali Acc: 0.191 Test Loss: 3.076 Test Acc: 0.191
Validation loss decreased (-0.172910 --> -0.190557).  Saving model ...
Epoch: 13 cost time: 0.5614469051361084
Epoch: 13, Steps: 10 | Train Loss: 1.496 Vali Loss: 3.043 Vali Acc: 0.202 Test Loss: 3.043 Test Acc: 0.202
Validation loss decreased (-0.190557 --> -0.202323).  Saving model ...
Epoch: 14 cost time: 0.6196420192718506
Epoch: 14, Steps: 10 | Train Loss: 1.381 Vali Loss: 3.037 Vali Acc: 0.209 Test Loss: 3.037 Test Acc: 0.209
Validation loss decreased (-0.202323 --> -0.209381).  Saving model ...
Epoch: 15 cost time: 0.7146909236907959
Epoch: 15, Steps: 10 | Train Loss: 1.229 Vali Loss: 3.022 Vali Acc: 0.227 Test Loss: 3.022 Test Acc: 0.227
Validation loss decreased (-0.209381 --> -0.227029).  Saving model ...
Epoch: 16 cost time: 0.7379536628723145
Epoch: 16, Steps: 10 | Train Loss: 1.092 Vali Loss: 3.003 Vali Acc: 0.233 Test Loss: 3.003 Test Acc: 0.233
Validation loss decreased (-0.227029 --> -0.232911).  Saving model ...
Epoch: 17 cost time: 0.7692050933837891
Epoch: 17, Steps: 10 | Train Loss: 0.922 Vali Loss: 3.016 Vali Acc: 0.242 Test Loss: 3.016 Test Acc: 0.242
Validation loss decreased (-0.232911 --> -0.242323).  Saving model ...
Epoch: 18 cost time: 0.7225351333618164
Epoch: 18, Steps: 10 | Train Loss: 0.745 Vali Loss: 3.027 Vali Acc: 0.259 Test Loss: 3.027 Test Acc: 0.259
Validation loss decreased (-0.242323 --> -0.258793).  Saving model ...
Epoch: 19 cost time: 0.7839388847351074
Epoch: 19, Steps: 10 | Train Loss: 0.650 Vali Loss: 3.033 Vali Acc: 0.265 Test Loss: 3.033 Test Acc: 0.265
Validation loss decreased (-0.258793 --> -0.264676).  Saving model ...
Epoch: 20 cost time: 0.74558424949646
Epoch: 20, Steps: 10 | Train Loss: 0.521 Vali Loss: 3.069 Vali Acc: 0.262 Test Loss: 3.069 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7249410152435303
Epoch: 21, Steps: 10 | Train Loss: 0.459 Vali Loss: 3.073 Vali Acc: 0.281 Test Loss: 3.073 Test Acc: 0.281
Validation loss decreased (-0.264676 --> -0.281146).  Saving model ...
Epoch: 22 cost time: 0.766446590423584
Epoch: 22, Steps: 10 | Train Loss: 0.378 Vali Loss: 3.049 Vali Acc: 0.294 Test Loss: 3.049 Test Acc: 0.294
Validation loss decreased (-0.281146 --> -0.294087).  Saving model ...
Epoch: 23 cost time: 0.6729474067687988
Epoch: 23, Steps: 10 | Train Loss: 0.309 Vali Loss: 3.088 Vali Acc: 0.286 Test Loss: 3.088 Test Acc: 0.286
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6618368625640869
Epoch: 24, Steps: 10 | Train Loss: 0.320 Vali Loss: 3.130 Vali Acc: 0.287 Test Loss: 3.130 Test Acc: 0.287
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.6784636974334717
Epoch: 25, Steps: 10 | Train Loss: 0.200 Vali Loss: 3.147 Vali Acc: 0.292 Test Loss: 3.147 Test Acc: 0.292
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7263765335083008
Epoch: 26, Steps: 10 | Train Loss: 0.187 Vali Loss: 3.156 Vali Acc: 0.301 Test Loss: 3.156 Test Acc: 0.301
Validation loss decreased (-0.294087 --> -0.301145).  Saving model ...
Epoch: 27 cost time: 0.7375209331512451
Epoch: 27, Steps: 10 | Train Loss: 0.213 Vali Loss: 3.151 Vali Acc: 0.302 Test Loss: 3.151 Test Acc: 0.302
Validation loss decreased (-0.301145 --> -0.302321).  Saving model ...
Epoch: 28 cost time: 0.7237434387207031
Epoch: 28, Steps: 10 | Train Loss: 0.138 Vali Loss: 3.190 Vali Acc: 0.296 Test Loss: 3.190 Test Acc: 0.296
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7610998153686523
Epoch: 29, Steps: 10 | Train Loss: 0.205 Vali Loss: 3.162 Vali Acc: 0.307 Test Loss: 3.162 Test Acc: 0.307
Validation loss decreased (-0.302321 --> -0.307027).  Saving model ...
Epoch: 30 cost time: 0.745506763458252
Epoch: 30, Steps: 10 | Train Loss: 0.144 Vali Loss: 3.115 Vali Acc: 0.313 Test Loss: 3.115 Test Acc: 0.313
Validation loss decreased (-0.307027 --> -0.312910).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3129411764705882
model parameter : 149770
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.2008883953094482
Epoch: 1, Steps: 10 | Train Loss: 3.290 Vali Loss: 3.308 Vali Acc: 0.049 Test Loss: 3.308 Test Acc: 0.049
Validation loss decreased (inf --> -0.049379).  Saving model ...
Epoch: 2 cost time: 0.6782948970794678
Epoch: 2, Steps: 10 | Train Loss: 3.222 Vali Loss: 3.290 Vali Acc: 0.060 Test Loss: 3.290 Test Acc: 0.060
Validation loss decreased (-0.049379 --> -0.059967).  Saving model ...
Epoch: 3 cost time: 0.6337425708770752
Epoch: 3, Steps: 10 | Train Loss: 3.112 Vali Loss: 3.286 Vali Acc: 0.068 Test Loss: 3.286 Test Acc: 0.068
Validation loss decreased (-0.059967 --> -0.068202).  Saving model ...
Epoch: 4 cost time: 0.6200544834136963
Epoch: 4, Steps: 10 | Train Loss: 2.988 Vali Loss: 3.278 Vali Acc: 0.081 Test Loss: 3.278 Test Acc: 0.081
Validation loss decreased (-0.068202 --> -0.081144).  Saving model ...
Epoch: 5 cost time: 0.5995688438415527
Epoch: 5, Steps: 10 | Train Loss: 2.871 Vali Loss: 3.271 Vali Acc: 0.100 Test Loss: 3.271 Test Acc: 0.100
Validation loss decreased (-0.081144 --> -0.099967).  Saving model ...
Epoch: 6 cost time: 0.612532377243042
Epoch: 6, Steps: 10 | Train Loss: 2.754 Vali Loss: 3.249 Vali Acc: 0.104 Test Loss: 3.249 Test Acc: 0.104
Validation loss decreased (-0.099967 --> -0.103497).  Saving model ...
Epoch: 7 cost time: 0.6590301990509033
Epoch: 7, Steps: 10 | Train Loss: 2.563 Vali Loss: 3.215 Vali Acc: 0.114 Test Loss: 3.215 Test Acc: 0.114
Validation loss decreased (-0.103497 --> -0.114085).  Saving model ...
Epoch: 8 cost time: 0.6157009601593018
Epoch: 8, Steps: 10 | Train Loss: 2.431 Vali Loss: 3.184 Vali Acc: 0.135 Test Loss: 3.184 Test Acc: 0.135
Validation loss decreased (-0.114085 --> -0.135262).  Saving model ...
Epoch: 9 cost time: 0.6065819263458252
Epoch: 9, Steps: 10 | Train Loss: 2.253 Vali Loss: 3.146 Vali Acc: 0.156 Test Loss: 3.146 Test Acc: 0.156
Validation loss decreased (-0.135262 --> -0.156439).  Saving model ...
Epoch: 10 cost time: 0.6061489582061768
Epoch: 10, Steps: 10 | Train Loss: 2.011 Vali Loss: 3.114 Vali Acc: 0.160 Test Loss: 3.114 Test Acc: 0.160
Validation loss decreased (-0.156439 --> -0.159969).  Saving model ...
Epoch: 11 cost time: 0.6045637130737305
Epoch: 11, Steps: 10 | Train Loss: 1.836 Vali Loss: 3.108 Vali Acc: 0.168 Test Loss: 3.108 Test Acc: 0.168
Validation loss decreased (-0.159969 --> -0.168204).  Saving model ...
Epoch: 12 cost time: 0.5416812896728516
Epoch: 12, Steps: 10 | Train Loss: 1.660 Vali Loss: 3.091 Vali Acc: 0.187 Test Loss: 3.091 Test Acc: 0.187
Validation loss decreased (-0.168204 --> -0.187028).  Saving model ...
Epoch: 13 cost time: 0.5586380958557129
Epoch: 13, Steps: 10 | Train Loss: 1.464 Vali Loss: 3.082 Vali Acc: 0.194 Test Loss: 3.082 Test Acc: 0.194
Validation loss decreased (-0.187028 --> -0.194087).  Saving model ...
Epoch: 14 cost time: 0.5942859649658203
Epoch: 14, Steps: 10 | Train Loss: 1.226 Vali Loss: 3.066 Vali Acc: 0.219 Test Loss: 3.066 Test Acc: 0.219
Validation loss decreased (-0.194087 --> -0.218793).  Saving model ...
Epoch: 15 cost time: 0.6011166572570801
Epoch: 15, Steps: 10 | Train Loss: 1.053 Vali Loss: 3.033 Vali Acc: 0.232 Test Loss: 3.033 Test Acc: 0.232
Validation loss decreased (-0.218793 --> -0.231734).  Saving model ...
Epoch: 16 cost time: 0.6057658195495605
Epoch: 16, Steps: 10 | Train Loss: 0.957 Vali Loss: 3.091 Vali Acc: 0.226 Test Loss: 3.091 Test Acc: 0.226
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6101522445678711
Epoch: 17, Steps: 10 | Train Loss: 0.668 Vali Loss: 3.008 Vali Acc: 0.258 Test Loss: 3.008 Test Acc: 0.258
Validation loss decreased (-0.231734 --> -0.257617).  Saving model ...
Epoch: 18 cost time: 0.5719847679138184
Epoch: 18, Steps: 10 | Train Loss: 0.536 Vali Loss: 3.036 Vali Acc: 0.260 Test Loss: 3.036 Test Acc: 0.260
Validation loss decreased (-0.257617 --> -0.259970).  Saving model ...
Epoch: 19 cost time: 0.604252815246582
Epoch: 19, Steps: 10 | Train Loss: 0.561 Vali Loss: 3.088 Vali Acc: 0.258 Test Loss: 3.088 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5921108722686768
Epoch: 20, Steps: 10 | Train Loss: 0.396 Vali Loss: 3.019 Vali Acc: 0.295 Test Loss: 3.019 Test Acc: 0.295
Validation loss decreased (-0.259970 --> -0.295264).  Saving model ...
Epoch: 21 cost time: 0.6308469772338867
Epoch: 21, Steps: 10 | Train Loss: 0.339 Vali Loss: 3.080 Vali Acc: 0.298 Test Loss: 3.080 Test Acc: 0.298
Validation loss decreased (-0.295264 --> -0.297616).  Saving model ...
Epoch: 22 cost time: 0.6282815933227539
Epoch: 22, Steps: 10 | Train Loss: 0.291 Vali Loss: 3.092 Vali Acc: 0.291 Test Loss: 3.092 Test Acc: 0.291
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5918087959289551
Epoch: 23, Steps: 10 | Train Loss: 0.245 Vali Loss: 3.120 Vali Acc: 0.302 Test Loss: 3.120 Test Acc: 0.302
Validation loss decreased (-0.297616 --> -0.302322).  Saving model ...
Epoch: 24 cost time: 0.6506118774414062
Epoch: 24, Steps: 10 | Train Loss: 0.177 Vali Loss: 3.116 Vali Acc: 0.299 Test Loss: 3.116 Test Acc: 0.299
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6766567230224609
Epoch: 25, Steps: 10 | Train Loss: 0.154 Vali Loss: 3.118 Vali Acc: 0.308 Test Loss: 3.118 Test Acc: 0.308
Validation loss decreased (-0.302322 --> -0.308204).  Saving model ...
Epoch: 26 cost time: 0.6220426559448242
Epoch: 26, Steps: 10 | Train Loss: 0.141 Vali Loss: 3.199 Vali Acc: 0.309 Test Loss: 3.199 Test Acc: 0.309
Validation loss decreased (-0.308204 --> -0.309380).  Saving model ...
Epoch: 27 cost time: 0.6154048442840576
Epoch: 27, Steps: 10 | Train Loss: 0.139 Vali Loss: 3.174 Vali Acc: 0.322 Test Loss: 3.174 Test Acc: 0.322
Validation loss decreased (-0.309380 --> -0.322321).  Saving model ...
Epoch: 28 cost time: 0.5591919422149658
Epoch: 28, Steps: 10 | Train Loss: 0.103 Vali Loss: 3.241 Vali Acc: 0.301 Test Loss: 3.241 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6360175609588623
Epoch: 29, Steps: 10 | Train Loss: 0.072 Vali Loss: 3.222 Vali Acc: 0.315 Test Loss: 3.222 Test Acc: 0.315
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6202020645141602
Epoch: 30, Steps: 10 | Train Loss: 0.076 Vali Loss: 3.209 Vali Acc: 0.320 Test Loss: 3.209 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.32235294117647056
model parameter : 356746
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.7319226264953613
Epoch: 1, Steps: 10 | Train Loss: 3.315 Vali Loss: 3.295 Vali Acc: 0.055 Test Loss: 3.295 Test Acc: 0.055
Validation loss decreased (inf --> -0.055261).  Saving model ...
Epoch: 2 cost time: 0.5966603755950928
Epoch: 2, Steps: 10 | Train Loss: 3.229 Vali Loss: 3.287 Vali Acc: 0.066 Test Loss: 3.287 Test Acc: 0.066
Validation loss decreased (-0.055261 --> -0.065849).  Saving model ...
Epoch: 3 cost time: 0.5534102916717529
Epoch: 3, Steps: 10 | Train Loss: 3.149 Vali Loss: 3.290 Vali Acc: 0.073 Test Loss: 3.290 Test Acc: 0.073
Validation loss decreased (-0.065849 --> -0.072908).  Saving model ...
Epoch: 4 cost time: 0.5287694931030273
Epoch: 4, Steps: 10 | Train Loss: 3.018 Vali Loss: 3.296 Vali Acc: 0.074 Test Loss: 3.296 Test Acc: 0.074
Validation loss decreased (-0.072908 --> -0.074085).  Saving model ...
Epoch: 5 cost time: 0.5570230484008789
Epoch: 5, Steps: 10 | Train Loss: 2.925 Vali Loss: 3.292 Vali Acc: 0.100 Test Loss: 3.292 Test Acc: 0.100
Validation loss decreased (-0.074085 --> -0.099967).  Saving model ...
Epoch: 6 cost time: 0.503603458404541
Epoch: 6, Steps: 10 | Train Loss: 2.760 Vali Loss: 3.268 Vali Acc: 0.109 Test Loss: 3.268 Test Acc: 0.109
Validation loss decreased (-0.099967 --> -0.109379).  Saving model ...
Epoch: 7 cost time: 0.5357458591461182
Epoch: 7, Steps: 10 | Train Loss: 2.711 Vali Loss: 3.247 Vali Acc: 0.127 Test Loss: 3.247 Test Acc: 0.127
Validation loss decreased (-0.109379 --> -0.127026).  Saving model ...
Epoch: 8 cost time: 0.5281074047088623
Epoch: 8, Steps: 10 | Train Loss: 2.558 Vali Loss: 3.215 Vali Acc: 0.139 Test Loss: 3.215 Test Acc: 0.139
Validation loss decreased (-0.127026 --> -0.138791).  Saving model ...
Epoch: 9 cost time: 0.5437028408050537
Epoch: 9, Steps: 10 | Train Loss: 2.413 Vali Loss: 3.187 Vali Acc: 0.151 Test Loss: 3.187 Test Acc: 0.151
Validation loss decreased (-0.138791 --> -0.150556).  Saving model ...
Epoch: 10 cost time: 0.5540668964385986
Epoch: 10, Steps: 10 | Train Loss: 2.239 Vali Loss: 3.149 Vali Acc: 0.166 Test Loss: 3.149 Test Acc: 0.166
Validation loss decreased (-0.150556 --> -0.165851).  Saving model ...
Epoch: 11 cost time: 0.5656368732452393
Epoch: 11, Steps: 10 | Train Loss: 2.073 Vali Loss: 3.128 Vali Acc: 0.178 Test Loss: 3.128 Test Acc: 0.178
Validation loss decreased (-0.165851 --> -0.177616).  Saving model ...
Epoch: 12 cost time: 0.5702972412109375
Epoch: 12, Steps: 10 | Train Loss: 1.896 Vali Loss: 3.126 Vali Acc: 0.193 Test Loss: 3.126 Test Acc: 0.193
Validation loss decreased (-0.177616 --> -0.192910).  Saving model ...
Epoch: 13 cost time: 0.56292724609375
Epoch: 13, Steps: 10 | Train Loss: 1.713 Vali Loss: 3.097 Vali Acc: 0.189 Test Loss: 3.097 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.538313627243042
Epoch: 14, Steps: 10 | Train Loss: 1.527 Vali Loss: 3.090 Vali Acc: 0.204 Test Loss: 3.090 Test Acc: 0.204
Validation loss decreased (-0.192910 --> -0.203499).  Saving model ...
Epoch: 15 cost time: 0.5966193675994873
Epoch: 15, Steps: 10 | Train Loss: 1.401 Vali Loss: 3.070 Vali Acc: 0.218 Test Loss: 3.070 Test Acc: 0.218
Validation loss decreased (-0.203499 --> -0.217616).  Saving model ...
Epoch: 16 cost time: 0.5005283355712891
Epoch: 16, Steps: 10 | Train Loss: 1.275 Vali Loss: 3.065 Vali Acc: 0.224 Test Loss: 3.065 Test Acc: 0.224
Validation loss decreased (-0.217616 --> -0.223499).  Saving model ...
Epoch: 17 cost time: 0.5467331409454346
Epoch: 17, Steps: 10 | Train Loss: 1.089 Vali Loss: 3.059 Vali Acc: 0.233 Test Loss: 3.059 Test Acc: 0.233
Validation loss decreased (-0.223499 --> -0.232911).  Saving model ...
Epoch: 18 cost time: 0.5606863498687744
Epoch: 18, Steps: 10 | Train Loss: 0.916 Vali Loss: 3.059 Vali Acc: 0.244 Test Loss: 3.059 Test Acc: 0.244
Validation loss decreased (-0.232911 --> -0.243499).  Saving model ...
Epoch: 19 cost time: 0.5613076686859131
Epoch: 19, Steps: 10 | Train Loss: 0.839 Vali Loss: 3.038 Vali Acc: 0.256 Test Loss: 3.038 Test Acc: 0.256
Validation loss decreased (-0.243499 --> -0.256440).  Saving model ...
Epoch: 20 cost time: 0.5609633922576904
Epoch: 20, Steps: 10 | Train Loss: 0.648 Vali Loss: 3.052 Vali Acc: 0.275 Test Loss: 3.052 Test Acc: 0.275
Validation loss decreased (-0.256440 --> -0.275264).  Saving model ...
Epoch: 21 cost time: 0.6437110900878906
Epoch: 21, Steps: 10 | Train Loss: 0.535 Vali Loss: 3.059 Vali Acc: 0.280 Test Loss: 3.059 Test Acc: 0.280
Validation loss decreased (-0.275264 --> -0.279969).  Saving model ...
Epoch: 22 cost time: 0.553720235824585
Epoch: 22, Steps: 10 | Train Loss: 0.452 Vali Loss: 3.051 Vali Acc: 0.289 Test Loss: 3.051 Test Acc: 0.289
Validation loss decreased (-0.279969 --> -0.289381).  Saving model ...
Epoch: 23 cost time: 0.5921838283538818
Epoch: 23, Steps: 10 | Train Loss: 0.392 Vali Loss: 3.072 Vali Acc: 0.299 Test Loss: 3.072 Test Acc: 0.299
Validation loss decreased (-0.289381 --> -0.298793).  Saving model ...
Epoch: 24 cost time: 0.5299208164215088
Epoch: 24, Steps: 10 | Train Loss: 0.289 Vali Loss: 3.118 Vali Acc: 0.294 Test Loss: 3.118 Test Acc: 0.294
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5840065479278564
Epoch: 25, Steps: 10 | Train Loss: 0.258 Vali Loss: 3.097 Vali Acc: 0.309 Test Loss: 3.097 Test Acc: 0.309
Validation loss decreased (-0.298793 --> -0.309381).  Saving model ...
Epoch: 26 cost time: 0.5188682079315186
Epoch: 26, Steps: 10 | Train Loss: 0.230 Vali Loss: 3.102 Vali Acc: 0.313 Test Loss: 3.102 Test Acc: 0.313
Validation loss decreased (-0.309381 --> -0.312910).  Saving model ...
Epoch: 27 cost time: 0.5423386096954346
Epoch: 27, Steps: 10 | Train Loss: 0.230 Vali Loss: 3.095 Vali Acc: 0.324 Test Loss: 3.095 Test Acc: 0.324
Validation loss decreased (-0.312910 --> -0.323498).  Saving model ...
Epoch: 28 cost time: 0.5480461120605469
Epoch: 28, Steps: 10 | Train Loss: 0.199 Vali Loss: 3.152 Vali Acc: 0.321 Test Loss: 3.152 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5259683132171631
Epoch: 29, Steps: 10 | Train Loss: 0.174 Vali Loss: 3.135 Vali Acc: 0.316 Test Loss: 3.135 Test Acc: 0.316
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.5433046817779541
Epoch: 30, Steps: 10 | Train Loss: 0.162 Vali Loss: 3.108 Vali Acc: 0.321 Test Loss: 3.108 Test Acc: 0.321
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3235294117647059
model parameter : 149770
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.3267438411712646
Epoch: 1, Steps: 10 | Train Loss: 3.329 Vali Loss: 3.311 Vali Acc: 0.034 Test Loss: 3.311 Test Acc: 0.034
Validation loss decreased (inf --> -0.034085).  Saving model ...
Epoch: 2 cost time: 0.8621311187744141
Epoch: 2, Steps: 10 | Train Loss: 3.272 Vali Loss: 3.297 Vali Acc: 0.034 Test Loss: 3.297 Test Acc: 0.034
Validation loss decreased (-0.034085 --> -0.034085).  Saving model ...
Epoch: 3 cost time: 0.9631946086883545
Epoch: 3, Steps: 10 | Train Loss: 3.193 Vali Loss: 3.289 Vali Acc: 0.044 Test Loss: 3.289 Test Acc: 0.044
Validation loss decreased (-0.034085 --> -0.043497).  Saving model ...
Epoch: 4 cost time: 0.9351377487182617
Epoch: 4, Steps: 10 | Train Loss: 3.104 Vali Loss: 3.281 Vali Acc: 0.059 Test Loss: 3.281 Test Acc: 0.059
Validation loss decreased (-0.043497 --> -0.058791).  Saving model ...
Epoch: 5 cost time: 1.0138161182403564
Epoch: 5, Steps: 10 | Train Loss: 3.017 Vali Loss: 3.275 Vali Acc: 0.073 Test Loss: 3.275 Test Acc: 0.073
Validation loss decreased (-0.058791 --> -0.072908).  Saving model ...
Epoch: 6 cost time: 0.9164373874664307
Epoch: 6, Steps: 10 | Train Loss: 2.862 Vali Loss: 3.260 Vali Acc: 0.089 Test Loss: 3.260 Test Acc: 0.089
Validation loss decreased (-0.072908 --> -0.089379).  Saving model ...
Epoch: 7 cost time: 0.9423058032989502
Epoch: 7, Steps: 10 | Train Loss: 2.778 Vali Loss: 3.245 Vali Acc: 0.108 Test Loss: 3.245 Test Acc: 0.108
Validation loss decreased (-0.089379 --> -0.108203).  Saving model ...
Epoch: 8 cost time: 0.9582211971282959
Epoch: 8, Steps: 10 | Train Loss: 2.668 Vali Loss: 3.227 Vali Acc: 0.131 Test Loss: 3.227 Test Acc: 0.131
Validation loss decreased (-0.108203 --> -0.130556).  Saving model ...
Epoch: 9 cost time: 0.9634349346160889
Epoch: 9, Steps: 10 | Train Loss: 2.452 Vali Loss: 3.198 Vali Acc: 0.138 Test Loss: 3.198 Test Acc: 0.138
Validation loss decreased (-0.130556 --> -0.137615).  Saving model ...
Epoch: 10 cost time: 0.8653571605682373
Epoch: 10, Steps: 10 | Train Loss: 2.312 Vali Loss: 3.164 Vali Acc: 0.164 Test Loss: 3.164 Test Acc: 0.164
Validation loss decreased (-0.137615 --> -0.163498).  Saving model ...
Epoch: 11 cost time: 0.9000992774963379
Epoch: 11, Steps: 10 | Train Loss: 2.160 Vali Loss: 3.140 Vali Acc: 0.164 Test Loss: 3.140 Test Acc: 0.164
Validation loss decreased (-0.163498 --> -0.163498).  Saving model ...
Epoch: 12 cost time: 0.8498251438140869
Epoch: 12, Steps: 10 | Train Loss: 1.976 Vali Loss: 3.110 Vali Acc: 0.180 Test Loss: 3.110 Test Acc: 0.180
Validation loss decreased (-0.163498 --> -0.179969).  Saving model ...
Epoch: 13 cost time: 0.886937141418457
Epoch: 13, Steps: 10 | Train Loss: 1.829 Vali Loss: 3.092 Vali Acc: 0.184 Test Loss: 3.092 Test Acc: 0.184
Validation loss decreased (-0.179969 --> -0.183498).  Saving model ...
Epoch: 14 cost time: 0.8547024726867676
Epoch: 14, Steps: 10 | Train Loss: 1.588 Vali Loss: 3.070 Vali Acc: 0.193 Test Loss: 3.070 Test Acc: 0.193
Validation loss decreased (-0.183498 --> -0.192910).  Saving model ...
Epoch: 15 cost time: 0.9588198661804199
Epoch: 15, Steps: 10 | Train Loss: 1.477 Vali Loss: 3.054 Vali Acc: 0.192 Test Loss: 3.054 Test Acc: 0.192
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.941370964050293
Epoch: 16, Steps: 10 | Train Loss: 1.245 Vali Loss: 3.043 Vali Acc: 0.209 Test Loss: 3.043 Test Acc: 0.209
Validation loss decreased (-0.192910 --> -0.209381).  Saving model ...
Epoch: 17 cost time: 0.9434287548065186
Epoch: 17, Steps: 10 | Train Loss: 1.130 Vali Loss: 3.009 Vali Acc: 0.213 Test Loss: 3.009 Test Acc: 0.213
Validation loss decreased (-0.209381 --> -0.212911).  Saving model ...
Epoch: 18 cost time: 0.8872830867767334
Epoch: 18, Steps: 10 | Train Loss: 1.019 Vali Loss: 3.031 Vali Acc: 0.231 Test Loss: 3.031 Test Acc: 0.231
Validation loss decreased (-0.212911 --> -0.230558).  Saving model ...
Epoch: 19 cost time: 0.9019179344177246
Epoch: 19, Steps: 10 | Train Loss: 0.865 Vali Loss: 2.997 Vali Acc: 0.231 Test Loss: 2.997 Test Acc: 0.231
Validation loss decreased (-0.230558 --> -0.230558).  Saving model ...
Epoch: 20 cost time: 0.8728799819946289
Epoch: 20, Steps: 10 | Train Loss: 0.740 Vali Loss: 2.978 Vali Acc: 0.235 Test Loss: 2.978 Test Acc: 0.235
Validation loss decreased (-0.230558 --> -0.235264).  Saving model ...
Epoch: 21 cost time: 0.9601588249206543
Epoch: 21, Steps: 10 | Train Loss: 0.668 Vali Loss: 3.013 Vali Acc: 0.244 Test Loss: 3.013 Test Acc: 0.244
Validation loss decreased (-0.235264 --> -0.243499).  Saving model ...
Epoch: 22 cost time: 0.9435915946960449
Epoch: 22, Steps: 10 | Train Loss: 0.536 Vali Loss: 2.992 Vali Acc: 0.248 Test Loss: 2.992 Test Acc: 0.248
Validation loss decreased (-0.243499 --> -0.248205).  Saving model ...
Epoch: 23 cost time: 0.9117276668548584
Epoch: 23, Steps: 10 | Train Loss: 0.475 Vali Loss: 3.028 Vali Acc: 0.261 Test Loss: 3.028 Test Acc: 0.261
Validation loss decreased (-0.248205 --> -0.261146).  Saving model ...
Epoch: 24 cost time: 0.9783697128295898
Epoch: 24, Steps: 10 | Train Loss: 0.451 Vali Loss: 3.022 Vali Acc: 0.271 Test Loss: 3.022 Test Acc: 0.271
Validation loss decreased (-0.261146 --> -0.270558).  Saving model ...
Epoch: 25 cost time: 0.9393529891967773
Epoch: 25, Steps: 10 | Train Loss: 0.303 Vali Loss: 2.998 Vali Acc: 0.267 Test Loss: 2.998 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.920140266418457
Epoch: 26, Steps: 10 | Train Loss: 0.300 Vali Loss: 3.024 Vali Acc: 0.272 Test Loss: 3.024 Test Acc: 0.272
Validation loss decreased (-0.270558 --> -0.271734).  Saving model ...
Epoch: 27 cost time: 0.8861479759216309
Epoch: 27, Steps: 10 | Train Loss: 0.247 Vali Loss: 3.003 Vali Acc: 0.282 Test Loss: 3.003 Test Acc: 0.282
Validation loss decreased (-0.271734 --> -0.282323).  Saving model ...
Epoch: 28 cost time: 0.8939898014068604
Epoch: 28, Steps: 10 | Train Loss: 0.223 Vali Loss: 2.993 Vali Acc: 0.298 Test Loss: 2.993 Test Acc: 0.298
Validation loss decreased (-0.282323 --> -0.297617).  Saving model ...
Epoch: 29 cost time: 0.9321238994598389
Epoch: 29, Steps: 10 | Train Loss: 0.209 Vali Loss: 2.986 Vali Acc: 0.294 Test Loss: 2.986 Test Acc: 0.294
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9828917980194092
Epoch: 30, Steps: 10 | Train Loss: 0.184 Vali Loss: 3.097 Vali Acc: 0.280 Test Loss: 3.097 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.29764705882352943
model parameter : 618354
model size : 2.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.2234714031219482
Epoch: 1, Steps: 10 | Train Loss: 3.344 Vali Loss: 3.312 Vali Acc: 0.042 Test Loss: 3.312 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 0.7396929264068604
Epoch: 2, Steps: 10 | Train Loss: 3.265 Vali Loss: 3.294 Vali Acc: 0.044 Test Loss: 3.294 Test Acc: 0.044
Validation loss decreased (-0.042320 --> -0.043496).  Saving model ...
Epoch: 3 cost time: 0.7702317237854004
Epoch: 3, Steps: 10 | Train Loss: 3.207 Vali Loss: 3.279 Vali Acc: 0.044 Test Loss: 3.279 Test Acc: 0.044
Validation loss decreased (-0.043496 --> -0.043497).  Saving model ...
Epoch: 4 cost time: 0.7207465171813965
Epoch: 4, Steps: 10 | Train Loss: 3.078 Vali Loss: 3.270 Vali Acc: 0.047 Test Loss: 3.270 Test Acc: 0.047
Validation loss decreased (-0.043497 --> -0.047026).  Saving model ...
Epoch: 5 cost time: 0.7377133369445801
Epoch: 5, Steps: 10 | Train Loss: 3.021 Vali Loss: 3.261 Vali Acc: 0.051 Test Loss: 3.261 Test Acc: 0.051
Validation loss decreased (-0.047026 --> -0.050556).  Saving model ...
Epoch: 6 cost time: 0.7885138988494873
Epoch: 6, Steps: 10 | Train Loss: 2.922 Vali Loss: 3.253 Vali Acc: 0.061 Test Loss: 3.253 Test Acc: 0.061
Validation loss decreased (-0.050556 --> -0.061144).  Saving model ...
Epoch: 7 cost time: 0.7415618896484375
Epoch: 7, Steps: 10 | Train Loss: 2.833 Vali Loss: 3.235 Vali Acc: 0.068 Test Loss: 3.235 Test Acc: 0.068
Validation loss decreased (-0.061144 --> -0.068203).  Saving model ...
Epoch: 8 cost time: 0.7917752265930176
Epoch: 8, Steps: 10 | Train Loss: 2.745 Vali Loss: 3.216 Vali Acc: 0.080 Test Loss: 3.216 Test Acc: 0.080
Validation loss decreased (-0.068203 --> -0.079968).  Saving model ...
Epoch: 9 cost time: 0.7815709114074707
Epoch: 9, Steps: 10 | Train Loss: 2.581 Vali Loss: 3.192 Vali Acc: 0.101 Test Loss: 3.192 Test Acc: 0.101
Validation loss decreased (-0.079968 --> -0.101145).  Saving model ...
Epoch: 10 cost time: 0.7790501117706299
Epoch: 10, Steps: 10 | Train Loss: 2.440 Vali Loss: 3.167 Vali Acc: 0.116 Test Loss: 3.167 Test Acc: 0.116
Validation loss decreased (-0.101145 --> -0.116439).  Saving model ...
Epoch: 11 cost time: 0.7268612384796143
Epoch: 11, Steps: 10 | Train Loss: 2.284 Vali Loss: 3.146 Vali Acc: 0.139 Test Loss: 3.146 Test Acc: 0.139
Validation loss decreased (-0.116439 --> -0.138792).  Saving model ...
Epoch: 12 cost time: 0.7066571712493896
Epoch: 12, Steps: 10 | Train Loss: 2.193 Vali Loss: 3.127 Vali Acc: 0.142 Test Loss: 3.127 Test Acc: 0.142
Validation loss decreased (-0.138792 --> -0.142322).  Saving model ...
Epoch: 13 cost time: 0.7586402893066406
Epoch: 13, Steps: 10 | Train Loss: 2.043 Vali Loss: 3.106 Vali Acc: 0.156 Test Loss: 3.106 Test Acc: 0.156
Validation loss decreased (-0.142322 --> -0.156440).  Saving model ...
Epoch: 14 cost time: 0.7722654342651367
Epoch: 14, Steps: 10 | Train Loss: 1.907 Vali Loss: 3.088 Vali Acc: 0.176 Test Loss: 3.088 Test Acc: 0.176
Validation loss decreased (-0.156440 --> -0.176440).  Saving model ...
Epoch: 15 cost time: 0.7880022525787354
Epoch: 15, Steps: 10 | Train Loss: 1.748 Vali Loss: 3.071 Vali Acc: 0.180 Test Loss: 3.071 Test Acc: 0.180
Validation loss decreased (-0.176440 --> -0.179969).  Saving model ...
Epoch: 16 cost time: 0.7901921272277832
Epoch: 16, Steps: 10 | Train Loss: 1.624 Vali Loss: 3.054 Vali Acc: 0.192 Test Loss: 3.054 Test Acc: 0.192
Validation loss decreased (-0.179969 --> -0.191734).  Saving model ...
Epoch: 17 cost time: 0.725855827331543
Epoch: 17, Steps: 10 | Train Loss: 1.472 Vali Loss: 3.060 Vali Acc: 0.191 Test Loss: 3.060 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8029789924621582
Epoch: 18, Steps: 10 | Train Loss: 1.306 Vali Loss: 3.042 Vali Acc: 0.194 Test Loss: 3.042 Test Acc: 0.194
Validation loss decreased (-0.191734 --> -0.194087).  Saving model ...
Epoch: 19 cost time: 0.7207732200622559
Epoch: 19, Steps: 10 | Train Loss: 1.211 Vali Loss: 3.029 Vali Acc: 0.209 Test Loss: 3.029 Test Acc: 0.209
Validation loss decreased (-0.194087 --> -0.209381).  Saving model ...
Epoch: 20 cost time: 0.7315497398376465
Epoch: 20, Steps: 10 | Train Loss: 1.089 Vali Loss: 3.016 Vali Acc: 0.224 Test Loss: 3.016 Test Acc: 0.224
Validation loss decreased (-0.209381 --> -0.223499).  Saving model ...
Epoch: 21 cost time: 0.7424404621124268
Epoch: 21, Steps: 10 | Train Loss: 0.930 Vali Loss: 3.017 Vali Acc: 0.216 Test Loss: 3.017 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7384011745452881
Epoch: 22, Steps: 10 | Train Loss: 0.826 Vali Loss: 3.006 Vali Acc: 0.224 Test Loss: 3.006 Test Acc: 0.224
Validation loss decreased (-0.223499 --> -0.223499).  Saving model ...
Epoch: 23 cost time: 0.76774001121521
Epoch: 23, Steps: 10 | Train Loss: 0.719 Vali Loss: 3.006 Vali Acc: 0.225 Test Loss: 3.006 Test Acc: 0.225
Validation loss decreased (-0.223499 --> -0.224676).  Saving model ...
Epoch: 24 cost time: 0.7614362239837646
Epoch: 24, Steps: 10 | Train Loss: 0.617 Vali Loss: 3.038 Vali Acc: 0.235 Test Loss: 3.038 Test Acc: 0.235
Validation loss decreased (-0.224676 --> -0.235264).  Saving model ...
Epoch: 25 cost time: 0.7581784725189209
Epoch: 25, Steps: 10 | Train Loss: 0.520 Vali Loss: 3.045 Vali Acc: 0.225 Test Loss: 3.045 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7822282314300537
Epoch: 26, Steps: 10 | Train Loss: 0.454 Vali Loss: 3.049 Vali Acc: 0.231 Test Loss: 3.049 Test Acc: 0.231
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7895760536193848
Epoch: 27, Steps: 10 | Train Loss: 0.352 Vali Loss: 3.080 Vali Acc: 0.245 Test Loss: 3.080 Test Acc: 0.245
Validation loss decreased (-0.235264 --> -0.244675).  Saving model ...
Epoch: 28 cost time: 0.7797160148620605
Epoch: 28, Steps: 10 | Train Loss: 0.320 Vali Loss: 3.064 Vali Acc: 0.253 Test Loss: 3.064 Test Acc: 0.253
Validation loss decreased (-0.244675 --> -0.252911).  Saving model ...
Epoch: 29 cost time: 0.6992499828338623
Epoch: 29, Steps: 10 | Train Loss: 0.353 Vali Loss: 3.074 Vali Acc: 0.258 Test Loss: 3.074 Test Acc: 0.258
Validation loss decreased (-0.252911 --> -0.257616).  Saving model ...
Epoch: 30 cost time: 0.6827218532562256
Epoch: 30, Steps: 10 | Train Loss: 0.288 Vali Loss: 3.063 Vali Acc: 0.258 Test Loss: 3.063 Test Acc: 0.258
Validation loss decreased (-0.257616 --> -0.257616).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2576470588235294
model parameter : 204370
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.087334394454956
Epoch: 1, Steps: 10 | Train Loss: 3.325 Vali Loss: 3.309 Vali Acc: 0.033 Test Loss: 3.309 Test Acc: 0.033
Validation loss decreased (inf --> -0.032908).  Saving model ...
Epoch: 2 cost time: 0.7422795295715332
Epoch: 2, Steps: 10 | Train Loss: 3.272 Vali Loss: 3.294 Vali Acc: 0.035 Test Loss: 3.294 Test Acc: 0.035
Validation loss decreased (-0.032908 --> -0.035261).  Saving model ...
Epoch: 3 cost time: 0.7412943840026855
Epoch: 3, Steps: 10 | Train Loss: 3.199 Vali Loss: 3.285 Vali Acc: 0.045 Test Loss: 3.285 Test Acc: 0.045
Validation loss decreased (-0.035261 --> -0.044673).  Saving model ...
Epoch: 4 cost time: 0.8232367038726807
Epoch: 4, Steps: 10 | Train Loss: 3.095 Vali Loss: 3.276 Vali Acc: 0.056 Test Loss: 3.276 Test Acc: 0.056
Validation loss decreased (-0.044673 --> -0.056438).  Saving model ...
Epoch: 5 cost time: 0.7758786678314209
Epoch: 5, Steps: 10 | Train Loss: 3.014 Vali Loss: 3.270 Vali Acc: 0.073 Test Loss: 3.270 Test Acc: 0.073
Validation loss decreased (-0.056438 --> -0.072908).  Saving model ...
Epoch: 6 cost time: 0.7268564701080322
Epoch: 6, Steps: 10 | Train Loss: 2.867 Vali Loss: 3.254 Vali Acc: 0.091 Test Loss: 3.254 Test Acc: 0.091
Validation loss decreased (-0.072908 --> -0.090556).  Saving model ...
Epoch: 7 cost time: 0.7874054908752441
Epoch: 7, Steps: 10 | Train Loss: 2.770 Vali Loss: 3.235 Vali Acc: 0.108 Test Loss: 3.235 Test Acc: 0.108
Validation loss decreased (-0.090556 --> -0.108203).  Saving model ...
Epoch: 8 cost time: 0.75714111328125
Epoch: 8, Steps: 10 | Train Loss: 2.624 Vali Loss: 3.218 Vali Acc: 0.126 Test Loss: 3.218 Test Acc: 0.126
Validation loss decreased (-0.108203 --> -0.125850).  Saving model ...
Epoch: 9 cost time: 0.8433668613433838
Epoch: 9, Steps: 10 | Train Loss: 2.462 Vali Loss: 3.181 Vali Acc: 0.145 Test Loss: 3.181 Test Acc: 0.145
Validation loss decreased (-0.125850 --> -0.144674).  Saving model ...
Epoch: 10 cost time: 0.8813283443450928
Epoch: 10, Steps: 10 | Train Loss: 2.291 Vali Loss: 3.148 Vali Acc: 0.167 Test Loss: 3.148 Test Acc: 0.167
Validation loss decreased (-0.144674 --> -0.167027).  Saving model ...
Epoch: 11 cost time: 0.8259851932525635
Epoch: 11, Steps: 10 | Train Loss: 2.214 Vali Loss: 3.121 Vali Acc: 0.171 Test Loss: 3.121 Test Acc: 0.171
Validation loss decreased (-0.167027 --> -0.170557).  Saving model ...
Epoch: 12 cost time: 0.8124978542327881
Epoch: 12, Steps: 10 | Train Loss: 2.070 Vali Loss: 3.092 Vali Acc: 0.180 Test Loss: 3.092 Test Acc: 0.180
Validation loss decreased (-0.170557 --> -0.179969).  Saving model ...
Epoch: 13 cost time: 0.7496259212493896
Epoch: 13, Steps: 10 | Train Loss: 1.877 Vali Loss: 3.074 Vali Acc: 0.185 Test Loss: 3.074 Test Acc: 0.185
Validation loss decreased (-0.179969 --> -0.184675).  Saving model ...
Epoch: 14 cost time: 0.7570278644561768
Epoch: 14, Steps: 10 | Train Loss: 1.675 Vali Loss: 3.046 Vali Acc: 0.189 Test Loss: 3.046 Test Acc: 0.189
Validation loss decreased (-0.184675 --> -0.189381).  Saving model ...
Epoch: 15 cost time: 0.7184350490570068
Epoch: 15, Steps: 10 | Train Loss: 1.534 Vali Loss: 3.011 Vali Acc: 0.204 Test Loss: 3.011 Test Acc: 0.204
Validation loss decreased (-0.189381 --> -0.203499).  Saving model ...
Epoch: 16 cost time: 0.7579286098480225
Epoch: 16, Steps: 10 | Train Loss: 1.350 Vali Loss: 3.033 Vali Acc: 0.220 Test Loss: 3.033 Test Acc: 0.220
Validation loss decreased (-0.203499 --> -0.219970).  Saving model ...
Epoch: 17 cost time: 0.8248336315155029
Epoch: 17, Steps: 10 | Train Loss: 1.116 Vali Loss: 3.002 Vali Acc: 0.225 Test Loss: 3.002 Test Acc: 0.225
Validation loss decreased (-0.219970 --> -0.224676).  Saving model ...
Epoch: 18 cost time: 0.8355300426483154
Epoch: 18, Steps: 10 | Train Loss: 1.025 Vali Loss: 3.002 Vali Acc: 0.227 Test Loss: 3.002 Test Acc: 0.227
Validation loss decreased (-0.224676 --> -0.227029).  Saving model ...
Epoch: 19 cost time: 0.7470202445983887
Epoch: 19, Steps: 10 | Train Loss: 0.897 Vali Loss: 2.943 Vali Acc: 0.256 Test Loss: 2.943 Test Acc: 0.256
Validation loss decreased (-0.227029 --> -0.256441).  Saving model ...
Epoch: 20 cost time: 0.7940182685852051
Epoch: 20, Steps: 10 | Train Loss: 0.772 Vali Loss: 2.928 Vali Acc: 0.265 Test Loss: 2.928 Test Acc: 0.265
Validation loss decreased (-0.256441 --> -0.264677).  Saving model ...
Epoch: 21 cost time: 0.8029575347900391
Epoch: 21, Steps: 10 | Train Loss: 0.829 Vali Loss: 2.984 Vali Acc: 0.255 Test Loss: 2.984 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7891595363616943
Epoch: 22, Steps: 10 | Train Loss: 0.621 Vali Loss: 2.968 Vali Acc: 0.259 Test Loss: 2.968 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.75166916847229
Epoch: 23, Steps: 10 | Train Loss: 0.586 Vali Loss: 2.952 Vali Acc: 0.271 Test Loss: 2.952 Test Acc: 0.271
Validation loss decreased (-0.264677 --> -0.270559).  Saving model ...
Epoch: 24 cost time: 0.7862763404846191
Epoch: 24, Steps: 10 | Train Loss: 0.431 Vali Loss: 2.968 Vali Acc: 0.273 Test Loss: 2.968 Test Acc: 0.273
Validation loss decreased (-0.270559 --> -0.272911).  Saving model ...
Epoch: 25 cost time: 0.7975659370422363
Epoch: 25, Steps: 10 | Train Loss: 0.482 Vali Loss: 2.907 Vali Acc: 0.285 Test Loss: 2.907 Test Acc: 0.285
Validation loss decreased (-0.272911 --> -0.284677).  Saving model ...
Epoch: 26 cost time: 0.812535285949707
Epoch: 26, Steps: 10 | Train Loss: 0.409 Vali Loss: 2.955 Vali Acc: 0.278 Test Loss: 2.955 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7920150756835938
Epoch: 27, Steps: 10 | Train Loss: 0.307 Vali Loss: 2.986 Vali Acc: 0.284 Test Loss: 2.986 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.842968225479126
Epoch: 28, Steps: 10 | Train Loss: 0.218 Vali Loss: 2.933 Vali Acc: 0.291 Test Loss: 2.933 Test Acc: 0.291
Validation loss decreased (-0.284677 --> -0.290559).  Saving model ...
Epoch: 29 cost time: 0.8039758205413818
Epoch: 29, Steps: 10 | Train Loss: 0.178 Vali Loss: 2.957 Vali Acc: 0.286 Test Loss: 2.957 Test Acc: 0.286
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8357434272766113
Epoch: 30, Steps: 10 | Train Loss: 0.237 Vali Loss: 3.031 Vali Acc: 0.288 Test Loss: 3.031 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.29058823529411765
model parameter : 618354
model size : 2.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.955876350402832
Epoch: 1, Steps: 10 | Train Loss: 3.337 Vali Loss: 3.312 Vali Acc: 0.045 Test Loss: 3.312 Test Acc: 0.045
Validation loss decreased (inf --> -0.044673).  Saving model ...
Epoch: 2 cost time: 0.7418837547302246
Epoch: 2, Steps: 10 | Train Loss: 3.266 Vali Loss: 3.294 Vali Acc: 0.045 Test Loss: 3.294 Test Acc: 0.045
Validation loss decreased (-0.044673 --> -0.044673).  Saving model ...
Epoch: 3 cost time: 0.6494452953338623
Epoch: 3, Steps: 10 | Train Loss: 3.206 Vali Loss: 3.279 Vali Acc: 0.040 Test Loss: 3.279 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6022500991821289
Epoch: 4, Steps: 10 | Train Loss: 3.084 Vali Loss: 3.270 Vali Acc: 0.051 Test Loss: 3.270 Test Acc: 0.051
Validation loss decreased (-0.044673 --> -0.050556).  Saving model ...
Epoch: 5 cost time: 0.5890038013458252
Epoch: 5, Steps: 10 | Train Loss: 3.030 Vali Loss: 3.261 Vali Acc: 0.051 Test Loss: 3.261 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 6 cost time: 0.6032323837280273
Epoch: 6, Steps: 10 | Train Loss: 2.922 Vali Loss: 3.255 Vali Acc: 0.060 Test Loss: 3.255 Test Acc: 0.060
Validation loss decreased (-0.050556 --> -0.059967).  Saving model ...
Epoch: 7 cost time: 0.6407866477966309
Epoch: 7, Steps: 10 | Train Loss: 2.841 Vali Loss: 3.238 Vali Acc: 0.068 Test Loss: 3.238 Test Acc: 0.068
Validation loss decreased (-0.059967 --> -0.068203).  Saving model ...
Epoch: 8 cost time: 0.6162710189819336
Epoch: 8, Steps: 10 | Train Loss: 2.757 Vali Loss: 3.222 Vali Acc: 0.081 Test Loss: 3.222 Test Acc: 0.081
Validation loss decreased (-0.068203 --> -0.081144).  Saving model ...
Epoch: 9 cost time: 0.7304060459136963
Epoch: 9, Steps: 10 | Train Loss: 2.597 Vali Loss: 3.199 Vali Acc: 0.095 Test Loss: 3.199 Test Acc: 0.095
Validation loss decreased (-0.081144 --> -0.095262).  Saving model ...
Epoch: 10 cost time: 0.7154042720794678
Epoch: 10, Steps: 10 | Train Loss: 2.465 Vali Loss: 3.180 Vali Acc: 0.108 Test Loss: 3.180 Test Acc: 0.108
Validation loss decreased (-0.095262 --> -0.108203).  Saving model ...
Epoch: 11 cost time: 0.782477855682373
Epoch: 11, Steps: 10 | Train Loss: 2.346 Vali Loss: 3.155 Vali Acc: 0.131 Test Loss: 3.155 Test Acc: 0.131
Validation loss decreased (-0.108203 --> -0.130557).  Saving model ...
Epoch: 12 cost time: 0.698932409286499
Epoch: 12, Steps: 10 | Train Loss: 2.195 Vali Loss: 3.138 Vali Acc: 0.128 Test Loss: 3.138 Test Acc: 0.128
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6708295345306396
Epoch: 13, Steps: 10 | Train Loss: 2.107 Vali Loss: 3.119 Vali Acc: 0.151 Test Loss: 3.119 Test Acc: 0.151
Validation loss decreased (-0.130557 --> -0.150557).  Saving model ...
Epoch: 14 cost time: 0.8233141899108887
Epoch: 14, Steps: 10 | Train Loss: 2.008 Vali Loss: 3.102 Vali Acc: 0.154 Test Loss: 3.102 Test Acc: 0.154
Validation loss decreased (-0.150557 --> -0.154087).  Saving model ...
Epoch: 15 cost time: 0.6700191497802734
Epoch: 15, Steps: 10 | Train Loss: 1.844 Vali Loss: 3.089 Vali Acc: 0.175 Test Loss: 3.089 Test Acc: 0.175
Validation loss decreased (-0.154087 --> -0.175263).  Saving model ...
Epoch: 16 cost time: 0.7247531414031982
Epoch: 16, Steps: 10 | Train Loss: 1.695 Vali Loss: 3.060 Vali Acc: 0.175 Test Loss: 3.060 Test Acc: 0.175
Validation loss decreased (-0.175263 --> -0.175264).  Saving model ...
Epoch: 17 cost time: 0.7808129787445068
Epoch: 17, Steps: 10 | Train Loss: 1.568 Vali Loss: 3.063 Vali Acc: 0.173 Test Loss: 3.063 Test Acc: 0.173
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7126884460449219
Epoch: 18, Steps: 10 | Train Loss: 1.419 Vali Loss: 3.046 Vali Acc: 0.187 Test Loss: 3.046 Test Acc: 0.187
Validation loss decreased (-0.175264 --> -0.187028).  Saving model ...
Epoch: 19 cost time: 0.8156955242156982
Epoch: 19, Steps: 10 | Train Loss: 1.255 Vali Loss: 3.039 Vali Acc: 0.200 Test Loss: 3.039 Test Acc: 0.200
Validation loss decreased (-0.187028 --> -0.199970).  Saving model ...
Epoch: 20 cost time: 0.7311325073242188
Epoch: 20, Steps: 10 | Train Loss: 1.258 Vali Loss: 3.016 Vali Acc: 0.202 Test Loss: 3.016 Test Acc: 0.202
Validation loss decreased (-0.199970 --> -0.202323).  Saving model ...
Epoch: 21 cost time: 0.7452991008758545
Epoch: 21, Steps: 10 | Train Loss: 1.078 Vali Loss: 3.022 Vali Acc: 0.214 Test Loss: 3.022 Test Acc: 0.214
Validation loss decreased (-0.202323 --> -0.214087).  Saving model ...
Epoch: 22 cost time: 0.6895008087158203
Epoch: 22, Steps: 10 | Train Loss: 0.971 Vali Loss: 3.015 Vali Acc: 0.228 Test Loss: 3.015 Test Acc: 0.228
Validation loss decreased (-0.214087 --> -0.228205).  Saving model ...
Epoch: 23 cost time: 0.7005853652954102
Epoch: 23, Steps: 10 | Train Loss: 0.819 Vali Loss: 3.007 Vali Acc: 0.227 Test Loss: 3.007 Test Acc: 0.227
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7253129482269287
Epoch: 24, Steps: 10 | Train Loss: 0.683 Vali Loss: 3.025 Vali Acc: 0.239 Test Loss: 3.025 Test Acc: 0.239
Validation loss decreased (-0.228205 --> -0.238793).  Saving model ...
Epoch: 25 cost time: 0.7290916442871094
Epoch: 25, Steps: 10 | Train Loss: 0.596 Vali Loss: 3.035 Vali Acc: 0.244 Test Loss: 3.035 Test Acc: 0.244
Validation loss decreased (-0.238793 --> -0.243499).  Saving model ...
Epoch: 26 cost time: 0.7999272346496582
Epoch: 26, Steps: 10 | Train Loss: 0.514 Vali Loss: 3.022 Vali Acc: 0.251 Test Loss: 3.022 Test Acc: 0.251
Validation loss decreased (-0.243499 --> -0.250558).  Saving model ...
Epoch: 27 cost time: 0.780057430267334
Epoch: 27, Steps: 10 | Train Loss: 0.477 Vali Loss: 3.035 Vali Acc: 0.247 Test Loss: 3.035 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.793280839920044
Epoch: 28, Steps: 10 | Train Loss: 0.418 Vali Loss: 3.055 Vali Acc: 0.259 Test Loss: 3.055 Test Acc: 0.259
Validation loss decreased (-0.250558 --> -0.258793).  Saving model ...
Epoch: 29 cost time: 0.7341017723083496
Epoch: 29, Steps: 10 | Train Loss: 0.424 Vali Loss: 3.095 Vali Acc: 0.251 Test Loss: 3.095 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7050423622131348
Epoch: 30, Steps: 10 | Train Loss: 0.297 Vali Loss: 3.046 Vali Acc: 0.271 Test Loss: 3.046 Test Acc: 0.271
Validation loss decreased (-0.258793 --> -0.270558).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27058823529411763
model parameter : 204370
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.9228112697601318
Epoch: 1, Steps: 10 | Train Loss: 3.328 Vali Loss: 3.311 Vali Acc: 0.031 Test Loss: 3.311 Test Acc: 0.031
Validation loss decreased (inf --> -0.030555).  Saving model ...
Epoch: 2 cost time: 0.816256046295166
Epoch: 2, Steps: 10 | Train Loss: 3.283 Vali Loss: 3.298 Vali Acc: 0.035 Test Loss: 3.298 Test Acc: 0.035
Validation loss decreased (-0.030555 --> -0.035261).  Saving model ...
Epoch: 3 cost time: 0.671100378036499
Epoch: 3, Steps: 10 | Train Loss: 3.209 Vali Loss: 3.289 Vali Acc: 0.045 Test Loss: 3.289 Test Acc: 0.045
Validation loss decreased (-0.035261 --> -0.044673).  Saving model ...
Epoch: 4 cost time: 0.670036792755127
Epoch: 4, Steps: 10 | Train Loss: 3.125 Vali Loss: 3.282 Vali Acc: 0.054 Test Loss: 3.282 Test Acc: 0.054
Validation loss decreased (-0.044673 --> -0.054085).  Saving model ...
Epoch: 5 cost time: 0.6053469181060791
Epoch: 5, Steps: 10 | Train Loss: 3.041 Vali Loss: 3.277 Vali Acc: 0.066 Test Loss: 3.277 Test Acc: 0.066
Validation loss decreased (-0.054085 --> -0.065850).  Saving model ...
Epoch: 6 cost time: 0.5907609462738037
Epoch: 6, Steps: 10 | Train Loss: 2.942 Vali Loss: 3.266 Vali Acc: 0.078 Test Loss: 3.266 Test Acc: 0.078
Validation loss decreased (-0.065850 --> -0.077614).  Saving model ...
Epoch: 7 cost time: 0.6492054462432861
Epoch: 7, Steps: 10 | Train Loss: 2.830 Vali Loss: 3.250 Vali Acc: 0.098 Test Loss: 3.250 Test Acc: 0.098
Validation loss decreased (-0.077614 --> -0.097615).  Saving model ...
Epoch: 8 cost time: 0.6996610164642334
Epoch: 8, Steps: 10 | Train Loss: 2.715 Vali Loss: 3.231 Vali Acc: 0.108 Test Loss: 3.231 Test Acc: 0.108
Validation loss decreased (-0.097615 --> -0.108203).  Saving model ...
Epoch: 9 cost time: 0.7105460166931152
Epoch: 9, Steps: 10 | Train Loss: 2.557 Vali Loss: 3.206 Vali Acc: 0.138 Test Loss: 3.206 Test Acc: 0.138
Validation loss decreased (-0.108203 --> -0.137615).  Saving model ...
Epoch: 10 cost time: 0.8088932037353516
Epoch: 10, Steps: 10 | Train Loss: 2.499 Vali Loss: 3.194 Vali Acc: 0.144 Test Loss: 3.194 Test Acc: 0.144
Validation loss decreased (-0.137615 --> -0.143497).  Saving model ...
Epoch: 11 cost time: 0.6656620502471924
Epoch: 11, Steps: 10 | Train Loss: 2.441 Vali Loss: 3.167 Vali Acc: 0.154 Test Loss: 3.167 Test Acc: 0.154
Validation loss decreased (-0.143497 --> -0.154086).  Saving model ...
Epoch: 12 cost time: 0.6770775318145752
Epoch: 12, Steps: 10 | Train Loss: 2.255 Vali Loss: 3.138 Vali Acc: 0.156 Test Loss: 3.138 Test Acc: 0.156
Validation loss decreased (-0.154086 --> -0.156439).  Saving model ...
Epoch: 13 cost time: 0.7073895931243896
Epoch: 13, Steps: 10 | Train Loss: 2.100 Vali Loss: 3.135 Vali Acc: 0.168 Test Loss: 3.135 Test Acc: 0.168
Validation loss decreased (-0.156439 --> -0.168204).  Saving model ...
Epoch: 14 cost time: 0.6751136779785156
Epoch: 14, Steps: 10 | Train Loss: 2.018 Vali Loss: 3.116 Vali Acc: 0.193 Test Loss: 3.116 Test Acc: 0.193
Validation loss decreased (-0.168204 --> -0.192910).  Saving model ...
Epoch: 15 cost time: 0.641542911529541
Epoch: 15, Steps: 10 | Train Loss: 1.881 Vali Loss: 3.103 Vali Acc: 0.189 Test Loss: 3.103 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6510655879974365
Epoch: 16, Steps: 10 | Train Loss: 1.655 Vali Loss: 3.096 Vali Acc: 0.200 Test Loss: 3.096 Test Acc: 0.200
Validation loss decreased (-0.192910 --> -0.199969).  Saving model ...
Epoch: 17 cost time: 0.6528105735778809
Epoch: 17, Steps: 10 | Train Loss: 1.538 Vali Loss: 3.062 Vali Acc: 0.206 Test Loss: 3.062 Test Acc: 0.206
Validation loss decreased (-0.199969 --> -0.205852).  Saving model ...
Epoch: 18 cost time: 0.6837153434753418
Epoch: 18, Steps: 10 | Train Loss: 1.451 Vali Loss: 3.106 Vali Acc: 0.199 Test Loss: 3.106 Test Acc: 0.199
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7116632461547852
Epoch: 19, Steps: 10 | Train Loss: 1.311 Vali Loss: 3.032 Vali Acc: 0.219 Test Loss: 3.032 Test Acc: 0.219
Validation loss decreased (-0.205852 --> -0.218793).  Saving model ...
Epoch: 20 cost time: 0.7469604015350342
Epoch: 20, Steps: 10 | Train Loss: 1.186 Vali Loss: 3.037 Vali Acc: 0.231 Test Loss: 3.037 Test Acc: 0.231
Validation loss decreased (-0.218793 --> -0.230558).  Saving model ...
Epoch: 21 cost time: 0.6824719905853271
Epoch: 21, Steps: 10 | Train Loss: 1.148 Vali Loss: 3.063 Vali Acc: 0.242 Test Loss: 3.063 Test Acc: 0.242
Validation loss decreased (-0.230558 --> -0.242322).  Saving model ...
Epoch: 22 cost time: 0.7074058055877686
Epoch: 22, Steps: 10 | Train Loss: 0.928 Vali Loss: 2.998 Vali Acc: 0.253 Test Loss: 2.998 Test Acc: 0.253
Validation loss decreased (-0.242322 --> -0.252911).  Saving model ...
Epoch: 23 cost time: 0.6899423599243164
Epoch: 23, Steps: 10 | Train Loss: 0.947 Vali Loss: 3.055 Vali Acc: 0.254 Test Loss: 3.055 Test Acc: 0.254
Validation loss decreased (-0.252911 --> -0.254087).  Saving model ...
Epoch: 24 cost time: 0.6064684391021729
Epoch: 24, Steps: 10 | Train Loss: 0.739 Vali Loss: 2.981 Vali Acc: 0.262 Test Loss: 2.981 Test Acc: 0.262
Validation loss decreased (-0.254087 --> -0.262323).  Saving model ...
Epoch: 25 cost time: 0.6917557716369629
Epoch: 25, Steps: 10 | Train Loss: 0.653 Vali Loss: 2.998 Vali Acc: 0.280 Test Loss: 2.998 Test Acc: 0.280
Validation loss decreased (-0.262323 --> -0.279970).  Saving model ...
Epoch: 26 cost time: 0.6532595157623291
Epoch: 26, Steps: 10 | Train Loss: 0.564 Vali Loss: 2.993 Vali Acc: 0.285 Test Loss: 2.993 Test Acc: 0.285
Validation loss decreased (-0.279970 --> -0.284676).  Saving model ...
Epoch: 27 cost time: 0.698143720626831
Epoch: 27, Steps: 10 | Train Loss: 0.497 Vali Loss: 3.023 Vali Acc: 0.275 Test Loss: 3.023 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7118666172027588
Epoch: 28, Steps: 10 | Train Loss: 0.424 Vali Loss: 2.996 Vali Acc: 0.287 Test Loss: 2.996 Test Acc: 0.287
Validation loss decreased (-0.284676 --> -0.287029).  Saving model ...
Epoch: 29 cost time: 0.687741756439209
Epoch: 29, Steps: 10 | Train Loss: 0.330 Vali Loss: 3.031 Vali Acc: 0.281 Test Loss: 3.031 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6238977909088135
Epoch: 30, Steps: 10 | Train Loss: 0.299 Vali Loss: 3.029 Vali Acc: 0.284 Test Loss: 3.029 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28705882352941176
model parameter : 618354
model size : 2.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.7509255409240723
Epoch: 1, Steps: 10 | Train Loss: 3.340 Vali Loss: 3.316 Vali Acc: 0.042 Test Loss: 3.316 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 0.6244025230407715
Epoch: 2, Steps: 10 | Train Loss: 3.253 Vali Loss: 3.298 Vali Acc: 0.048 Test Loss: 3.298 Test Acc: 0.048
Validation loss decreased (-0.042320 --> -0.048202).  Saving model ...
Epoch: 3 cost time: 0.6494271755218506
Epoch: 3, Steps: 10 | Train Loss: 3.207 Vali Loss: 3.283 Vali Acc: 0.047 Test Loss: 3.283 Test Acc: 0.047
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6090166568756104
Epoch: 4, Steps: 10 | Train Loss: 3.077 Vali Loss: 3.275 Vali Acc: 0.052 Test Loss: 3.275 Test Acc: 0.052
Validation loss decreased (-0.048202 --> -0.051732).  Saving model ...
Epoch: 5 cost time: 0.5818684101104736
Epoch: 5, Steps: 10 | Train Loss: 3.029 Vali Loss: 3.267 Vali Acc: 0.052 Test Loss: 3.267 Test Acc: 0.052
Validation loss decreased (-0.051732 --> -0.051732).  Saving model ...
Epoch: 6 cost time: 0.6321418285369873
Epoch: 6, Steps: 10 | Train Loss: 2.932 Vali Loss: 3.263 Vali Acc: 0.062 Test Loss: 3.263 Test Acc: 0.062
Validation loss decreased (-0.051732 --> -0.062320).  Saving model ...
Epoch: 7 cost time: 0.5809571743011475
Epoch: 7, Steps: 10 | Train Loss: 2.880 Vali Loss: 3.249 Vali Acc: 0.071 Test Loss: 3.249 Test Acc: 0.071
Validation loss decreased (-0.062320 --> -0.070556).  Saving model ...
Epoch: 8 cost time: 0.658825159072876
Epoch: 8, Steps: 10 | Train Loss: 2.825 Vali Loss: 3.235 Vali Acc: 0.084 Test Loss: 3.235 Test Acc: 0.084
Validation loss decreased (-0.070556 --> -0.083497).  Saving model ...
Epoch: 9 cost time: 0.6668920516967773
Epoch: 9, Steps: 10 | Train Loss: 2.652 Vali Loss: 3.215 Vali Acc: 0.093 Test Loss: 3.215 Test Acc: 0.093
Validation loss decreased (-0.083497 --> -0.092909).  Saving model ...
Epoch: 10 cost time: 0.5787580013275146
Epoch: 10, Steps: 10 | Train Loss: 2.547 Vali Loss: 3.190 Vali Acc: 0.109 Test Loss: 3.190 Test Acc: 0.109
Validation loss decreased (-0.092909 --> -0.109380).  Saving model ...
Epoch: 11 cost time: 0.5875771045684814
Epoch: 11, Steps: 10 | Train Loss: 2.370 Vali Loss: 3.170 Vali Acc: 0.126 Test Loss: 3.170 Test Acc: 0.126
Validation loss decreased (-0.109380 --> -0.125851).  Saving model ...
Epoch: 12 cost time: 0.589005708694458
Epoch: 12, Steps: 10 | Train Loss: 2.284 Vali Loss: 3.148 Vali Acc: 0.133 Test Loss: 3.148 Test Acc: 0.133
Validation loss decreased (-0.125851 --> -0.132910).  Saving model ...
Epoch: 13 cost time: 0.6021952629089355
Epoch: 13, Steps: 10 | Train Loss: 2.170 Vali Loss: 3.132 Vali Acc: 0.147 Test Loss: 3.132 Test Acc: 0.147
Validation loss decreased (-0.132910 --> -0.147028).  Saving model ...
Epoch: 14 cost time: 0.6073801517486572
Epoch: 14, Steps: 10 | Train Loss: 2.040 Vali Loss: 3.126 Vali Acc: 0.147 Test Loss: 3.126 Test Acc: 0.147
Validation loss decreased (-0.147028 --> -0.147028).  Saving model ...
Epoch: 15 cost time: 0.6286106109619141
Epoch: 15, Steps: 10 | Train Loss: 1.958 Vali Loss: 3.116 Vali Acc: 0.164 Test Loss: 3.116 Test Acc: 0.164
Validation loss decreased (-0.147028 --> -0.163498).  Saving model ...
Epoch: 16 cost time: 0.5809886455535889
Epoch: 16, Steps: 10 | Train Loss: 1.868 Vali Loss: 3.099 Vali Acc: 0.185 Test Loss: 3.099 Test Acc: 0.185
Validation loss decreased (-0.163498 --> -0.184675).  Saving model ...
Epoch: 17 cost time: 0.5983138084411621
Epoch: 17, Steps: 10 | Train Loss: 1.750 Vali Loss: 3.100 Vali Acc: 0.180 Test Loss: 3.100 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5310673713684082
Epoch: 18, Steps: 10 | Train Loss: 1.585 Vali Loss: 3.075 Vali Acc: 0.188 Test Loss: 3.075 Test Acc: 0.188
Validation loss decreased (-0.184675 --> -0.188205).  Saving model ...
Epoch: 19 cost time: 0.6225986480712891
Epoch: 19, Steps: 10 | Train Loss: 1.563 Vali Loss: 3.044 Vali Acc: 0.199 Test Loss: 3.044 Test Acc: 0.199
Validation loss decreased (-0.188205 --> -0.198793).  Saving model ...
Epoch: 20 cost time: 0.6519441604614258
Epoch: 20, Steps: 10 | Train Loss: 1.367 Vali Loss: 3.041 Vali Acc: 0.198 Test Loss: 3.041 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.617814302444458
Epoch: 21, Steps: 10 | Train Loss: 1.283 Vali Loss: 3.052 Vali Acc: 0.208 Test Loss: 3.052 Test Acc: 0.208
Validation loss decreased (-0.198793 --> -0.208205).  Saving model ...
Epoch: 22 cost time: 0.5757126808166504
Epoch: 22, Steps: 10 | Train Loss: 1.128 Vali Loss: 3.024 Vali Acc: 0.221 Test Loss: 3.024 Test Acc: 0.221
Validation loss decreased (-0.208205 --> -0.221146).  Saving model ...
Epoch: 23 cost time: 0.6377263069152832
Epoch: 23, Steps: 10 | Train Loss: 1.002 Vali Loss: 3.037 Vali Acc: 0.229 Test Loss: 3.037 Test Acc: 0.229
Validation loss decreased (-0.221146 --> -0.229381).  Saving model ...
Epoch: 24 cost time: 0.5588476657867432
Epoch: 24, Steps: 10 | Train Loss: 0.966 Vali Loss: 3.050 Vali Acc: 0.233 Test Loss: 3.050 Test Acc: 0.233
Validation loss decreased (-0.229381 --> -0.232911).  Saving model ...
Epoch: 25 cost time: 0.5910971164703369
Epoch: 25, Steps: 10 | Train Loss: 0.828 Vali Loss: 3.027 Vali Acc: 0.239 Test Loss: 3.027 Test Acc: 0.239
Validation loss decreased (-0.232911 --> -0.238793).  Saving model ...
Epoch: 26 cost time: 0.5630474090576172
Epoch: 26, Steps: 10 | Train Loss: 0.747 Vali Loss: 3.020 Vali Acc: 0.246 Test Loss: 3.020 Test Acc: 0.246
Validation loss decreased (-0.238793 --> -0.245852).  Saving model ...
Epoch: 27 cost time: 0.6216268539428711
Epoch: 27, Steps: 10 | Train Loss: 0.665 Vali Loss: 3.023 Vali Acc: 0.248 Test Loss: 3.023 Test Acc: 0.248
Validation loss decreased (-0.245852 --> -0.248205).  Saving model ...
Epoch: 28 cost time: 0.5889992713928223
Epoch: 28, Steps: 10 | Train Loss: 0.602 Vali Loss: 3.027 Vali Acc: 0.258 Test Loss: 3.027 Test Acc: 0.258
Validation loss decreased (-0.248205 --> -0.257617).  Saving model ...
Epoch: 29 cost time: 0.5961575508117676
Epoch: 29, Steps: 10 | Train Loss: 0.531 Vali Loss: 3.047 Vali Acc: 0.260 Test Loss: 3.047 Test Acc: 0.260
Validation loss decreased (-0.257617 --> -0.259970).  Saving model ...
Epoch: 30 cost time: 0.5709214210510254
Epoch: 30, Steps: 10 | Train Loss: 0.412 Vali Loss: 3.028 Vali Acc: 0.269 Test Loss: 3.028 Test Acc: 0.269
Validation loss decreased (-0.259970 --> -0.269381).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26941176470588235
model parameter : 204370
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.3981950283050537
Epoch: 1, Steps: 10 | Train Loss: 3.409 Vali Loss: 3.301 Vali Acc: 0.042 Test Loss: 3.301 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 0.8925702571868896
Epoch: 2, Steps: 10 | Train Loss: 3.329 Vali Loss: 3.279 Vali Acc: 0.042 Test Loss: 3.279 Test Acc: 0.042
Validation loss decreased (-0.042320 --> -0.042320).  Saving model ...
Epoch: 3 cost time: 0.9064688682556152
Epoch: 3, Steps: 10 | Train Loss: 3.242 Vali Loss: 3.258 Vali Acc: 0.055 Test Loss: 3.258 Test Acc: 0.055
Validation loss decreased (-0.042320 --> -0.055262).  Saving model ...
Epoch: 4 cost time: 0.9740395545959473
Epoch: 4, Steps: 10 | Train Loss: 3.160 Vali Loss: 3.248 Vali Acc: 0.071 Test Loss: 3.248 Test Acc: 0.071
Validation loss decreased (-0.055262 --> -0.070556).  Saving model ...
Epoch: 5 cost time: 0.9796059131622314
Epoch: 5, Steps: 10 | Train Loss: 3.048 Vali Loss: 3.244 Vali Acc: 0.074 Test Loss: 3.244 Test Acc: 0.074
Validation loss decreased (-0.070556 --> -0.074085).  Saving model ...
Epoch: 6 cost time: 0.9583723545074463
Epoch: 6, Steps: 10 | Train Loss: 2.938 Vali Loss: 3.236 Vali Acc: 0.079 Test Loss: 3.236 Test Acc: 0.079
Validation loss decreased (-0.074085 --> -0.078791).  Saving model ...
Epoch: 7 cost time: 0.9985110759735107
Epoch: 7, Steps: 10 | Train Loss: 2.862 Vali Loss: 3.231 Vali Acc: 0.084 Test Loss: 3.231 Test Acc: 0.084
Validation loss decreased (-0.078791 --> -0.083497).  Saving model ...
Epoch: 8 cost time: 0.9628551006317139
Epoch: 8, Steps: 10 | Train Loss: 2.717 Vali Loss: 3.215 Vali Acc: 0.096 Test Loss: 3.215 Test Acc: 0.096
Validation loss decreased (-0.083497 --> -0.096438).  Saving model ...
Epoch: 9 cost time: 0.9689228534698486
Epoch: 9, Steps: 10 | Train Loss: 2.611 Vali Loss: 3.191 Vali Acc: 0.125 Test Loss: 3.191 Test Acc: 0.125
Validation loss decreased (-0.096438 --> -0.124674).  Saving model ...
Epoch: 10 cost time: 0.8213460445404053
Epoch: 10, Steps: 10 | Train Loss: 2.476 Vali Loss: 3.174 Vali Acc: 0.138 Test Loss: 3.174 Test Acc: 0.138
Validation loss decreased (-0.124674 --> -0.137615).  Saving model ...
Epoch: 11 cost time: 0.963977575302124
Epoch: 11, Steps: 10 | Train Loss: 2.368 Vali Loss: 3.146 Vali Acc: 0.144 Test Loss: 3.146 Test Acc: 0.144
Validation loss decreased (-0.137615 --> -0.143498).  Saving model ...
Epoch: 12 cost time: 0.9712440967559814
Epoch: 12, Steps: 10 | Train Loss: 2.182 Vali Loss: 3.111 Vali Acc: 0.154 Test Loss: 3.111 Test Acc: 0.154
Validation loss decreased (-0.143498 --> -0.154087).  Saving model ...
Epoch: 13 cost time: 0.8099174499511719
Epoch: 13, Steps: 10 | Train Loss: 2.028 Vali Loss: 3.076 Vali Acc: 0.172 Test Loss: 3.076 Test Acc: 0.172
Validation loss decreased (-0.154087 --> -0.171734).  Saving model ...
Epoch: 14 cost time: 0.8792500495910645
Epoch: 14, Steps: 10 | Train Loss: 1.861 Vali Loss: 3.045 Vali Acc: 0.176 Test Loss: 3.045 Test Acc: 0.176
Validation loss decreased (-0.171734 --> -0.176440).  Saving model ...
Epoch: 15 cost time: 0.7360973358154297
Epoch: 15, Steps: 10 | Train Loss: 1.667 Vali Loss: 3.029 Vali Acc: 0.184 Test Loss: 3.029 Test Acc: 0.184
Validation loss decreased (-0.176440 --> -0.183499).  Saving model ...
Epoch: 16 cost time: 0.7948918342590332
Epoch: 16, Steps: 10 | Train Loss: 1.497 Vali Loss: 3.023 Vali Acc: 0.192 Test Loss: 3.023 Test Acc: 0.192
Validation loss decreased (-0.183499 --> -0.191734).  Saving model ...
Epoch: 17 cost time: 0.7501466274261475
Epoch: 17, Steps: 10 | Train Loss: 1.323 Vali Loss: 2.969 Vali Acc: 0.205 Test Loss: 2.969 Test Acc: 0.205
Validation loss decreased (-0.191734 --> -0.204676).  Saving model ...
Epoch: 18 cost time: 0.8587214946746826
Epoch: 18, Steps: 10 | Train Loss: 1.203 Vali Loss: 2.958 Vali Acc: 0.209 Test Loss: 2.958 Test Acc: 0.209
Validation loss decreased (-0.204676 --> -0.209382).  Saving model ...
Epoch: 19 cost time: 0.7790622711181641
Epoch: 19, Steps: 10 | Train Loss: 1.094 Vali Loss: 2.936 Vali Acc: 0.227 Test Loss: 2.936 Test Acc: 0.227
Validation loss decreased (-0.209382 --> -0.227029).  Saving model ...
Epoch: 20 cost time: 0.863283634185791
Epoch: 20, Steps: 10 | Train Loss: 0.869 Vali Loss: 2.946 Vali Acc: 0.244 Test Loss: 2.946 Test Acc: 0.244
Validation loss decreased (-0.227029 --> -0.243500).  Saving model ...
Epoch: 21 cost time: 0.8077917098999023
Epoch: 21, Steps: 10 | Train Loss: 0.836 Vali Loss: 2.959 Vali Acc: 0.233 Test Loss: 2.959 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8673756122589111
Epoch: 22, Steps: 10 | Train Loss: 0.705 Vali Loss: 2.935 Vali Acc: 0.248 Test Loss: 2.935 Test Acc: 0.248
Validation loss decreased (-0.243500 --> -0.248206).  Saving model ...
Epoch: 23 cost time: 0.8591599464416504
Epoch: 23, Steps: 10 | Train Loss: 0.611 Vali Loss: 2.947 Vali Acc: 0.255 Test Loss: 2.947 Test Acc: 0.255
Validation loss decreased (-0.248206 --> -0.255265).  Saving model ...
Epoch: 24 cost time: 0.8335621356964111
Epoch: 24, Steps: 10 | Train Loss: 0.524 Vali Loss: 2.927 Vali Acc: 0.273 Test Loss: 2.927 Test Acc: 0.273
Validation loss decreased (-0.255265 --> -0.272912).  Saving model ...
Epoch: 25 cost time: 0.867868185043335
Epoch: 25, Steps: 10 | Train Loss: 0.427 Vali Loss: 2.919 Vali Acc: 0.269 Test Loss: 2.919 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8908922672271729
Epoch: 26, Steps: 10 | Train Loss: 0.366 Vali Loss: 2.945 Vali Acc: 0.267 Test Loss: 2.945 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8801116943359375
Epoch: 27, Steps: 10 | Train Loss: 0.310 Vali Loss: 2.962 Vali Acc: 0.280 Test Loss: 2.962 Test Acc: 0.280
Validation loss decreased (-0.272912 --> -0.279970).  Saving model ...
Epoch: 28 cost time: 0.9378325939178467
Epoch: 28, Steps: 10 | Train Loss: 0.290 Vali Loss: 2.960 Vali Acc: 0.275 Test Loss: 2.960 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8999123573303223
Epoch: 29, Steps: 10 | Train Loss: 0.248 Vali Loss: 2.992 Vali Acc: 0.282 Test Loss: 2.992 Test Acc: 0.282
Validation loss decreased (-0.279970 --> -0.282323).  Saving model ...
Epoch: 30 cost time: 0.7930972576141357
Epoch: 30, Steps: 10 | Train Loss: 0.259 Vali Loss: 2.999 Vali Acc: 0.280 Test Loss: 2.999 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2823529411764706
model parameter : 325106
model size : 1.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.250692367553711
Epoch: 1, Steps: 10 | Train Loss: 3.323 Vali Loss: 3.299 Vali Acc: 0.044 Test Loss: 3.299 Test Acc: 0.044
Validation loss decreased (inf --> -0.043496).  Saving model ...
Epoch: 2 cost time: 0.7951028347015381
Epoch: 2, Steps: 10 | Train Loss: 3.241 Vali Loss: 3.287 Vali Acc: 0.055 Test Loss: 3.287 Test Acc: 0.055
Validation loss decreased (-0.043496 --> -0.055261).  Saving model ...
Epoch: 3 cost time: 0.666771411895752
Epoch: 3, Steps: 10 | Train Loss: 3.177 Vali Loss: 3.281 Vali Acc: 0.056 Test Loss: 3.281 Test Acc: 0.056
Validation loss decreased (-0.055261 --> -0.056438).  Saving model ...
Epoch: 4 cost time: 0.7499954700469971
Epoch: 4, Steps: 10 | Train Loss: 3.104 Vali Loss: 3.276 Vali Acc: 0.065 Test Loss: 3.276 Test Acc: 0.065
Validation loss decreased (-0.056438 --> -0.064673).  Saving model ...
Epoch: 5 cost time: 0.7187352180480957
Epoch: 5, Steps: 10 | Train Loss: 2.988 Vali Loss: 3.275 Vali Acc: 0.068 Test Loss: 3.275 Test Acc: 0.068
Validation loss decreased (-0.064673 --> -0.068203).  Saving model ...
Epoch: 6 cost time: 0.807636022567749
Epoch: 6, Steps: 10 | Train Loss: 2.927 Vali Loss: 3.273 Vali Acc: 0.081 Test Loss: 3.273 Test Acc: 0.081
Validation loss decreased (-0.068203 --> -0.081144).  Saving model ...
Epoch: 7 cost time: 0.7536699771881104
Epoch: 7, Steps: 10 | Train Loss: 2.871 Vali Loss: 3.267 Vali Acc: 0.081 Test Loss: 3.267 Test Acc: 0.081
Validation loss decreased (-0.081144 --> -0.081144).  Saving model ...
Epoch: 8 cost time: 0.7948050498962402
Epoch: 8, Steps: 10 | Train Loss: 2.750 Vali Loss: 3.254 Vali Acc: 0.093 Test Loss: 3.254 Test Acc: 0.093
Validation loss decreased (-0.081144 --> -0.092909).  Saving model ...
Epoch: 9 cost time: 0.6635894775390625
Epoch: 9, Steps: 10 | Train Loss: 2.668 Vali Loss: 3.246 Vali Acc: 0.101 Test Loss: 3.246 Test Acc: 0.101
Validation loss decreased (-0.092909 --> -0.101144).  Saving model ...
Epoch: 10 cost time: 0.730100154876709
Epoch: 10, Steps: 10 | Train Loss: 2.552 Vali Loss: 3.231 Vali Acc: 0.107 Test Loss: 3.231 Test Acc: 0.107
Validation loss decreased (-0.101144 --> -0.107027).  Saving model ...
Epoch: 11 cost time: 0.696465015411377
Epoch: 11, Steps: 10 | Train Loss: 2.416 Vali Loss: 3.214 Vali Acc: 0.122 Test Loss: 3.214 Test Acc: 0.122
Validation loss decreased (-0.107027 --> -0.122321).  Saving model ...
Epoch: 12 cost time: 0.7513034343719482
Epoch: 12, Steps: 10 | Train Loss: 2.294 Vali Loss: 3.190 Vali Acc: 0.128 Test Loss: 3.190 Test Acc: 0.128
Validation loss decreased (-0.122321 --> -0.128203).  Saving model ...
Epoch: 13 cost time: 0.7481670379638672
Epoch: 13, Steps: 10 | Train Loss: 2.177 Vali Loss: 3.185 Vali Acc: 0.145 Test Loss: 3.185 Test Acc: 0.145
Validation loss decreased (-0.128203 --> -0.144674).  Saving model ...
Epoch: 14 cost time: 0.7881565093994141
Epoch: 14, Steps: 10 | Train Loss: 2.090 Vali Loss: 3.179 Vali Acc: 0.149 Test Loss: 3.179 Test Acc: 0.149
Validation loss decreased (-0.144674 --> -0.149380).  Saving model ...
Epoch: 15 cost time: 0.7298276424407959
Epoch: 15, Steps: 10 | Train Loss: 1.939 Vali Loss: 3.153 Vali Acc: 0.167 Test Loss: 3.153 Test Acc: 0.167
Validation loss decreased (-0.149380 --> -0.167027).  Saving model ...
Epoch: 16 cost time: 0.8181853294372559
Epoch: 16, Steps: 10 | Train Loss: 1.780 Vali Loss: 3.142 Vali Acc: 0.175 Test Loss: 3.142 Test Acc: 0.175
Validation loss decreased (-0.167027 --> -0.175263).  Saving model ...
Epoch: 17 cost time: 0.7811682224273682
Epoch: 17, Steps: 10 | Train Loss: 1.613 Vali Loss: 3.126 Vali Acc: 0.176 Test Loss: 3.126 Test Acc: 0.176
Validation loss decreased (-0.175263 --> -0.176439).  Saving model ...
Epoch: 18 cost time: 0.6999001502990723
Epoch: 18, Steps: 10 | Train Loss: 1.444 Vali Loss: 3.108 Vali Acc: 0.193 Test Loss: 3.108 Test Acc: 0.193
Validation loss decreased (-0.176439 --> -0.192910).  Saving model ...
Epoch: 19 cost time: 0.7308402061462402
Epoch: 19, Steps: 10 | Train Loss: 1.345 Vali Loss: 3.122 Vali Acc: 0.187 Test Loss: 3.122 Test Acc: 0.187
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7110452651977539
Epoch: 20, Steps: 10 | Train Loss: 1.210 Vali Loss: 3.104 Vali Acc: 0.194 Test Loss: 3.104 Test Acc: 0.194
Validation loss decreased (-0.192910 --> -0.194087).  Saving model ...
Epoch: 21 cost time: 0.6951377391815186
Epoch: 21, Steps: 10 | Train Loss: 1.067 Vali Loss: 3.111 Vali Acc: 0.200 Test Loss: 3.111 Test Acc: 0.200
Validation loss decreased (-0.194087 --> -0.199969).  Saving model ...
Epoch: 22 cost time: 0.6861820220947266
Epoch: 22, Steps: 10 | Train Loss: 0.929 Vali Loss: 3.117 Vali Acc: 0.211 Test Loss: 3.117 Test Acc: 0.211
Validation loss decreased (-0.199969 --> -0.210557).  Saving model ...
Epoch: 23 cost time: 0.7518932819366455
Epoch: 23, Steps: 10 | Train Loss: 0.841 Vali Loss: 3.114 Vali Acc: 0.219 Test Loss: 3.114 Test Acc: 0.219
Validation loss decreased (-0.210557 --> -0.218792).  Saving model ...
Epoch: 24 cost time: 0.7632627487182617
Epoch: 24, Steps: 10 | Train Loss: 0.704 Vali Loss: 3.141 Vali Acc: 0.215 Test Loss: 3.141 Test Acc: 0.215
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.708315372467041
Epoch: 25, Steps: 10 | Train Loss: 0.600 Vali Loss: 3.126 Vali Acc: 0.228 Test Loss: 3.126 Test Acc: 0.228
Validation loss decreased (-0.218792 --> -0.228204).  Saving model ...
Epoch: 26 cost time: 0.7145018577575684
Epoch: 26, Steps: 10 | Train Loss: 0.551 Vali Loss: 3.153 Vali Acc: 0.241 Test Loss: 3.153 Test Acc: 0.241
Validation loss decreased (-0.228204 --> -0.241145).  Saving model ...
Epoch: 27 cost time: 0.7216207981109619
Epoch: 27, Steps: 10 | Train Loss: 0.512 Vali Loss: 3.167 Vali Acc: 0.231 Test Loss: 3.167 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.724783182144165
Epoch: 28, Steps: 10 | Train Loss: 0.432 Vali Loss: 3.153 Vali Acc: 0.256 Test Loss: 3.153 Test Acc: 0.256
Validation loss decreased (-0.241145 --> -0.256439).  Saving model ...
Epoch: 29 cost time: 0.7320723533630371
Epoch: 29, Steps: 10 | Train Loss: 0.363 Vali Loss: 3.180 Vali Acc: 0.249 Test Loss: 3.180 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7735469341278076
Epoch: 30, Steps: 10 | Train Loss: 0.315 Vali Loss: 3.186 Vali Acc: 0.260 Test Loss: 3.186 Test Acc: 0.260
Validation loss decreased (-0.256439 --> -0.259968).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26
model parameter : 118098
model size : 0.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.9961726665496826
Epoch: 1, Steps: 10 | Train Loss: 3.408 Vali Loss: 3.300 Vali Acc: 0.046 Test Loss: 3.300 Test Acc: 0.046
Validation loss decreased (inf --> -0.045849).  Saving model ...
Epoch: 2 cost time: 0.8141164779663086
Epoch: 2, Steps: 10 | Train Loss: 3.323 Vali Loss: 3.279 Vali Acc: 0.044 Test Loss: 3.279 Test Acc: 0.044
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7581770420074463
Epoch: 3, Steps: 10 | Train Loss: 3.245 Vali Loss: 3.258 Vali Acc: 0.064 Test Loss: 3.258 Test Acc: 0.064
Validation loss decreased (-0.045849 --> -0.063497).  Saving model ...
Epoch: 4 cost time: 0.7515947818756104
Epoch: 4, Steps: 10 | Train Loss: 3.164 Vali Loss: 3.248 Vali Acc: 0.074 Test Loss: 3.248 Test Acc: 0.074
Validation loss decreased (-0.063497 --> -0.074085).  Saving model ...
Epoch: 5 cost time: 0.7728972434997559
Epoch: 5, Steps: 10 | Train Loss: 3.056 Vali Loss: 3.245 Vali Acc: 0.073 Test Loss: 3.245 Test Acc: 0.073
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8194637298583984
Epoch: 6, Steps: 10 | Train Loss: 2.942 Vali Loss: 3.241 Vali Acc: 0.079 Test Loss: 3.241 Test Acc: 0.079
Validation loss decreased (-0.074085 --> -0.078791).  Saving model ...
Epoch: 7 cost time: 0.7653474807739258
Epoch: 7, Steps: 10 | Train Loss: 2.873 Vali Loss: 3.235 Vali Acc: 0.091 Test Loss: 3.235 Test Acc: 0.091
Validation loss decreased (-0.078791 --> -0.090556).  Saving model ...
Epoch: 8 cost time: 0.7765712738037109
Epoch: 8, Steps: 10 | Train Loss: 2.728 Vali Loss: 3.222 Vali Acc: 0.100 Test Loss: 3.222 Test Acc: 0.100
Validation loss decreased (-0.090556 --> -0.099968).  Saving model ...
Epoch: 9 cost time: 0.7359905242919922
Epoch: 9, Steps: 10 | Train Loss: 2.661 Vali Loss: 3.197 Vali Acc: 0.121 Test Loss: 3.197 Test Acc: 0.121
Validation loss decreased (-0.099968 --> -0.121145).  Saving model ...
Epoch: 10 cost time: 0.702716588973999
Epoch: 10, Steps: 10 | Train Loss: 2.523 Vali Loss: 3.184 Vali Acc: 0.126 Test Loss: 3.184 Test Acc: 0.126
Validation loss decreased (-0.121145 --> -0.125851).  Saving model ...
Epoch: 11 cost time: 0.7625925540924072
Epoch: 11, Steps: 10 | Train Loss: 2.439 Vali Loss: 3.160 Vali Acc: 0.131 Test Loss: 3.160 Test Acc: 0.131
Validation loss decreased (-0.125851 --> -0.130557).  Saving model ...
Epoch: 12 cost time: 0.7632720470428467
Epoch: 12, Steps: 10 | Train Loss: 2.248 Vali Loss: 3.136 Vali Acc: 0.138 Test Loss: 3.136 Test Acc: 0.138
Validation loss decreased (-0.130557 --> -0.137616).  Saving model ...
Epoch: 13 cost time: 0.7388138771057129
Epoch: 13, Steps: 10 | Train Loss: 2.118 Vali Loss: 3.109 Vali Acc: 0.154 Test Loss: 3.109 Test Acc: 0.154
Validation loss decreased (-0.137616 --> -0.154087).  Saving model ...
Epoch: 14 cost time: 0.7129325866699219
Epoch: 14, Steps: 10 | Train Loss: 1.978 Vali Loss: 3.080 Vali Acc: 0.169 Test Loss: 3.080 Test Acc: 0.169
Validation loss decreased (-0.154087 --> -0.169381).  Saving model ...
Epoch: 15 cost time: 0.7808074951171875
Epoch: 15, Steps: 10 | Train Loss: 1.824 Vali Loss: 3.073 Vali Acc: 0.174 Test Loss: 3.073 Test Acc: 0.174
Validation loss decreased (-0.169381 --> -0.174087).  Saving model ...
Epoch: 16 cost time: 0.763582706451416
Epoch: 16, Steps: 10 | Train Loss: 1.598 Vali Loss: 3.069 Vali Acc: 0.174 Test Loss: 3.069 Test Acc: 0.174
Validation loss decreased (-0.174087 --> -0.174087).  Saving model ...
Epoch: 17 cost time: 0.6833398342132568
Epoch: 17, Steps: 10 | Train Loss: 1.478 Vali Loss: 3.040 Vali Acc: 0.179 Test Loss: 3.040 Test Acc: 0.179
Validation loss decreased (-0.174087 --> -0.178793).  Saving model ...
Epoch: 18 cost time: 0.7510104179382324
Epoch: 18, Steps: 10 | Train Loss: 1.380 Vali Loss: 3.028 Vali Acc: 0.206 Test Loss: 3.028 Test Acc: 0.206
Validation loss decreased (-0.178793 --> -0.205852).  Saving model ...
Epoch: 19 cost time: 0.8356382846832275
Epoch: 19, Steps: 10 | Train Loss: 1.198 Vali Loss: 3.019 Vali Acc: 0.206 Test Loss: 3.019 Test Acc: 0.206
Validation loss decreased (-0.205852 --> -0.205852).  Saving model ...
Epoch: 20 cost time: 0.7435486316680908
Epoch: 20, Steps: 10 | Train Loss: 1.040 Vali Loss: 3.048 Vali Acc: 0.218 Test Loss: 3.048 Test Acc: 0.218
Validation loss decreased (-0.205852 --> -0.217617).  Saving model ...
Epoch: 21 cost time: 0.7422218322753906
Epoch: 21, Steps: 10 | Train Loss: 1.044 Vali Loss: 2.993 Vali Acc: 0.220 Test Loss: 2.993 Test Acc: 0.220
Validation loss decreased (-0.217617 --> -0.219970).  Saving model ...
Epoch: 22 cost time: 0.6976828575134277
Epoch: 22, Steps: 10 | Train Loss: 0.986 Vali Loss: 3.014 Vali Acc: 0.245 Test Loss: 3.014 Test Acc: 0.245
Validation loss decreased (-0.219970 --> -0.244676).  Saving model ...
Epoch: 23 cost time: 0.6945257186889648
Epoch: 23, Steps: 10 | Train Loss: 0.711 Vali Loss: 2.973 Vali Acc: 0.252 Test Loss: 2.973 Test Acc: 0.252
Validation loss decreased (-0.244676 --> -0.251735).  Saving model ...
Epoch: 24 cost time: 0.6552715301513672
Epoch: 24, Steps: 10 | Train Loss: 0.629 Vali Loss: 2.963 Vali Acc: 0.252 Test Loss: 2.963 Test Acc: 0.252
Validation loss decreased (-0.251735 --> -0.251735).  Saving model ...
Epoch: 25 cost time: 0.7571756839752197
Epoch: 25, Steps: 10 | Train Loss: 0.639 Vali Loss: 2.987 Vali Acc: 0.255 Test Loss: 2.987 Test Acc: 0.255
Validation loss decreased (-0.251735 --> -0.255264).  Saving model ...
Epoch: 26 cost time: 0.7627997398376465
Epoch: 26, Steps: 10 | Train Loss: 0.487 Vali Loss: 2.958 Vali Acc: 0.266 Test Loss: 2.958 Test Acc: 0.266
Validation loss decreased (-0.255264 --> -0.265853).  Saving model ...
Epoch: 27 cost time: 0.8415732383728027
Epoch: 27, Steps: 10 | Train Loss: 0.476 Vali Loss: 2.948 Vali Acc: 0.274 Test Loss: 2.948 Test Acc: 0.274
Validation loss decreased (-0.265853 --> -0.274088).  Saving model ...
Epoch: 28 cost time: 0.8611490726470947
Epoch: 28, Steps: 10 | Train Loss: 0.414 Vali Loss: 2.957 Vali Acc: 0.286 Test Loss: 2.957 Test Acc: 0.286
Validation loss decreased (-0.274088 --> -0.285853).  Saving model ...
Epoch: 29 cost time: 0.7597622871398926
Epoch: 29, Steps: 10 | Train Loss: 0.435 Vali Loss: 2.968 Vali Acc: 0.287 Test Loss: 2.968 Test Acc: 0.287
Validation loss decreased (-0.285853 --> -0.287029).  Saving model ...
Epoch: 30 cost time: 0.7562963962554932
Epoch: 30, Steps: 10 | Train Loss: 0.405 Vali Loss: 2.987 Vali Acc: 0.282 Test Loss: 2.987 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28705882352941176
model parameter : 325106
model size : 1.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.8542637825012207
Epoch: 1, Steps: 10 | Train Loss: 3.314 Vali Loss: 3.295 Vali Acc: 0.047 Test Loss: 3.295 Test Acc: 0.047
Validation loss decreased (inf --> -0.047026).  Saving model ...
Epoch: 2 cost time: 0.70320725440979
Epoch: 2, Steps: 10 | Train Loss: 3.236 Vali Loss: 3.283 Vali Acc: 0.058 Test Loss: 3.283 Test Acc: 0.058
Validation loss decreased (-0.047026 --> -0.057614).  Saving model ...
Epoch: 3 cost time: 0.6948885917663574
Epoch: 3, Steps: 10 | Train Loss: 3.175 Vali Loss: 3.277 Vali Acc: 0.056 Test Loss: 3.277 Test Acc: 0.056
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6029701232910156
Epoch: 4, Steps: 10 | Train Loss: 3.111 Vali Loss: 3.274 Vali Acc: 0.060 Test Loss: 3.274 Test Acc: 0.060
Validation loss decreased (-0.057614 --> -0.059967).  Saving model ...
Epoch: 5 cost time: 0.6424479484558105
Epoch: 5, Steps: 10 | Train Loss: 2.984 Vali Loss: 3.273 Vali Acc: 0.069 Test Loss: 3.273 Test Acc: 0.069
Validation loss decreased (-0.059967 --> -0.069379).  Saving model ...
Epoch: 6 cost time: 0.6665232181549072
Epoch: 6, Steps: 10 | Train Loss: 2.930 Vali Loss: 3.269 Vali Acc: 0.073 Test Loss: 3.269 Test Acc: 0.073
Validation loss decreased (-0.069379 --> -0.072908).  Saving model ...
Epoch: 7 cost time: 0.6986820697784424
Epoch: 7, Steps: 10 | Train Loss: 2.879 Vali Loss: 3.263 Vali Acc: 0.081 Test Loss: 3.263 Test Acc: 0.081
Validation loss decreased (-0.072908 --> -0.081144).  Saving model ...
Epoch: 8 cost time: 0.7438628673553467
Epoch: 8, Steps: 10 | Train Loss: 2.751 Vali Loss: 3.251 Vali Acc: 0.093 Test Loss: 3.251 Test Acc: 0.093
Validation loss decreased (-0.081144 --> -0.092909).  Saving model ...
Epoch: 9 cost time: 0.635272741317749
Epoch: 9, Steps: 10 | Train Loss: 2.666 Vali Loss: 3.242 Vali Acc: 0.101 Test Loss: 3.242 Test Acc: 0.101
Validation loss decreased (-0.092909 --> -0.101144).  Saving model ...
Epoch: 10 cost time: 0.643700361251831
Epoch: 10, Steps: 10 | Train Loss: 2.567 Vali Loss: 3.228 Vali Acc: 0.108 Test Loss: 3.228 Test Acc: 0.108
Validation loss decreased (-0.101144 --> -0.108203).  Saving model ...
Epoch: 11 cost time: 0.6758201122283936
Epoch: 11, Steps: 10 | Train Loss: 2.422 Vali Loss: 3.213 Vali Acc: 0.115 Test Loss: 3.213 Test Acc: 0.115
Validation loss decreased (-0.108203 --> -0.115262).  Saving model ...
Epoch: 12 cost time: 0.6590189933776855
Epoch: 12, Steps: 10 | Train Loss: 2.302 Vali Loss: 3.191 Vali Acc: 0.133 Test Loss: 3.191 Test Acc: 0.133
Validation loss decreased (-0.115262 --> -0.132909).  Saving model ...
Epoch: 13 cost time: 0.6217954158782959
Epoch: 13, Steps: 10 | Train Loss: 2.181 Vali Loss: 3.188 Vali Acc: 0.129 Test Loss: 3.188 Test Acc: 0.129
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.69205641746521
Epoch: 14, Steps: 10 | Train Loss: 2.078 Vali Loss: 3.179 Vali Acc: 0.140 Test Loss: 3.179 Test Acc: 0.140
Validation loss decreased (-0.132909 --> -0.139968).  Saving model ...
Epoch: 15 cost time: 0.6638481616973877
Epoch: 15, Steps: 10 | Train Loss: 1.979 Vali Loss: 3.149 Vali Acc: 0.158 Test Loss: 3.149 Test Acc: 0.158
Validation loss decreased (-0.139968 --> -0.157616).  Saving model ...
Epoch: 16 cost time: 0.6821081638336182
Epoch: 16, Steps: 10 | Train Loss: 1.827 Vali Loss: 3.140 Vali Acc: 0.158 Test Loss: 3.140 Test Acc: 0.158
Validation loss decreased (-0.157616 --> -0.157616).  Saving model ...
Epoch: 17 cost time: 0.7176761627197266
Epoch: 17, Steps: 10 | Train Loss: 1.680 Vali Loss: 3.127 Vali Acc: 0.153 Test Loss: 3.127 Test Acc: 0.153
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7146053314208984
Epoch: 18, Steps: 10 | Train Loss: 1.579 Vali Loss: 3.124 Vali Acc: 0.171 Test Loss: 3.124 Test Acc: 0.171
Validation loss decreased (-0.157616 --> -0.170557).  Saving model ...
Epoch: 19 cost time: 0.6542634963989258
Epoch: 19, Steps: 10 | Train Loss: 1.370 Vali Loss: 3.132 Vali Acc: 0.173 Test Loss: 3.132 Test Acc: 0.173
Validation loss decreased (-0.170557 --> -0.172910).  Saving model ...
Epoch: 20 cost time: 0.7302951812744141
Epoch: 20, Steps: 10 | Train Loss: 1.237 Vali Loss: 3.122 Vali Acc: 0.187 Test Loss: 3.122 Test Acc: 0.187
Validation loss decreased (-0.172910 --> -0.187028).  Saving model ...
Epoch: 21 cost time: 0.703709602355957
Epoch: 21, Steps: 10 | Train Loss: 1.159 Vali Loss: 3.120 Vali Acc: 0.192 Test Loss: 3.120 Test Acc: 0.192
Validation loss decreased (-0.187028 --> -0.191734).  Saving model ...
Epoch: 22 cost time: 0.6471014022827148
Epoch: 22, Steps: 10 | Train Loss: 0.997 Vali Loss: 3.125 Vali Acc: 0.205 Test Loss: 3.125 Test Acc: 0.205
Validation loss decreased (-0.191734 --> -0.204675).  Saving model ...
Epoch: 23 cost time: 0.6603713035583496
Epoch: 23, Steps: 10 | Train Loss: 0.964 Vali Loss: 3.124 Vali Acc: 0.214 Test Loss: 3.124 Test Acc: 0.214
Validation loss decreased (-0.204675 --> -0.214086).  Saving model ...
Epoch: 24 cost time: 0.676743745803833
Epoch: 24, Steps: 10 | Train Loss: 0.794 Vali Loss: 3.147 Vali Acc: 0.228 Test Loss: 3.147 Test Acc: 0.228
Validation loss decreased (-0.214086 --> -0.228204).  Saving model ...
Epoch: 25 cost time: 0.6208600997924805
Epoch: 25, Steps: 10 | Train Loss: 0.748 Vali Loss: 3.133 Vali Acc: 0.229 Test Loss: 3.133 Test Acc: 0.229
Validation loss decreased (-0.228204 --> -0.229380).  Saving model ...
Epoch: 26 cost time: 0.6432383060455322
Epoch: 26, Steps: 10 | Train Loss: 0.594 Vali Loss: 3.154 Vali Acc: 0.238 Test Loss: 3.154 Test Acc: 0.238
Validation loss decreased (-0.229380 --> -0.237616).  Saving model ...
Epoch: 27 cost time: 0.6151885986328125
Epoch: 27, Steps: 10 | Train Loss: 0.524 Vali Loss: 3.154 Vali Acc: 0.244 Test Loss: 3.154 Test Acc: 0.244
Validation loss decreased (-0.237616 --> -0.243498).  Saving model ...
Epoch: 28 cost time: 0.6917688846588135
Epoch: 28, Steps: 10 | Train Loss: 0.618 Vali Loss: 3.171 Vali Acc: 0.247 Test Loss: 3.171 Test Acc: 0.247
Validation loss decreased (-0.243498 --> -0.247027).  Saving model ...
Epoch: 29 cost time: 0.6495232582092285
Epoch: 29, Steps: 10 | Train Loss: 0.385 Vali Loss: 3.191 Vali Acc: 0.252 Test Loss: 3.191 Test Acc: 0.252
Validation loss decreased (-0.247027 --> -0.251733).  Saving model ...
Epoch: 30 cost time: 0.6338918209075928
Epoch: 30, Steps: 10 | Train Loss: 0.501 Vali Loss: 3.199 Vali Acc: 0.254 Test Loss: 3.199 Test Acc: 0.254
Validation loss decreased (-0.251733 --> -0.254086).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2541176470588235
model parameter : 118098
model size : 0.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.122438669204712
Epoch: 1, Steps: 10 | Train Loss: 3.401 Vali Loss: 3.307 Vali Acc: 0.036 Test Loss: 3.307 Test Acc: 0.036
Validation loss decreased (inf --> -0.036438).  Saving model ...
Epoch: 2 cost time: 0.6156091690063477
Epoch: 2, Steps: 10 | Train Loss: 3.327 Vali Loss: 3.285 Vali Acc: 0.046 Test Loss: 3.285 Test Acc: 0.046
Validation loss decreased (-0.036438 --> -0.045850).  Saving model ...
Epoch: 3 cost time: 0.6206350326538086
Epoch: 3, Steps: 10 | Train Loss: 3.248 Vali Loss: 3.265 Vali Acc: 0.056 Test Loss: 3.265 Test Acc: 0.056
Validation loss decreased (-0.045850 --> -0.056438).  Saving model ...
Epoch: 4 cost time: 0.5592336654663086
Epoch: 4, Steps: 10 | Train Loss: 3.172 Vali Loss: 3.256 Vali Acc: 0.076 Test Loss: 3.256 Test Acc: 0.076
Validation loss decreased (-0.056438 --> -0.076438).  Saving model ...
Epoch: 5 cost time: 0.6558477878570557
Epoch: 5, Steps: 10 | Train Loss: 3.088 Vali Loss: 3.254 Vali Acc: 0.068 Test Loss: 3.254 Test Acc: 0.068
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7199263572692871
Epoch: 6, Steps: 10 | Train Loss: 2.968 Vali Loss: 3.251 Vali Acc: 0.080 Test Loss: 3.251 Test Acc: 0.080
Validation loss decreased (-0.076438 --> -0.079967).  Saving model ...
Epoch: 7 cost time: 0.6460049152374268
Epoch: 7, Steps: 10 | Train Loss: 2.916 Vali Loss: 3.247 Vali Acc: 0.085 Test Loss: 3.247 Test Acc: 0.085
Validation loss decreased (-0.079967 --> -0.084673).  Saving model ...
Epoch: 8 cost time: 0.728679895401001
Epoch: 8, Steps: 10 | Train Loss: 2.787 Vali Loss: 3.236 Vali Acc: 0.091 Test Loss: 3.236 Test Acc: 0.091
Validation loss decreased (-0.084673 --> -0.090556).  Saving model ...
Epoch: 9 cost time: 0.6857402324676514
Epoch: 9, Steps: 10 | Train Loss: 2.717 Vali Loss: 3.215 Vali Acc: 0.109 Test Loss: 3.215 Test Acc: 0.109
Validation loss decreased (-0.090556 --> -0.109380).  Saving model ...
Epoch: 10 cost time: 0.6683614253997803
Epoch: 10, Steps: 10 | Train Loss: 2.610 Vali Loss: 3.206 Vali Acc: 0.124 Test Loss: 3.206 Test Acc: 0.124
Validation loss decreased (-0.109380 --> -0.123497).  Saving model ...
Epoch: 11 cost time: 0.6750204563140869
Epoch: 11, Steps: 10 | Train Loss: 2.535 Vali Loss: 3.191 Vali Acc: 0.133 Test Loss: 3.191 Test Acc: 0.133
Validation loss decreased (-0.123497 --> -0.132909).  Saving model ...
Epoch: 12 cost time: 0.6807916164398193
Epoch: 12, Steps: 10 | Train Loss: 2.416 Vali Loss: 3.165 Vali Acc: 0.125 Test Loss: 3.165 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6725325584411621
Epoch: 13, Steps: 10 | Train Loss: 2.289 Vali Loss: 3.150 Vali Acc: 0.146 Test Loss: 3.150 Test Acc: 0.146
Validation loss decreased (-0.132909 --> -0.145851).  Saving model ...
Epoch: 14 cost time: 0.6589851379394531
Epoch: 14, Steps: 10 | Train Loss: 2.174 Vali Loss: 3.137 Vali Acc: 0.153 Test Loss: 3.137 Test Acc: 0.153
Validation loss decreased (-0.145851 --> -0.152910).  Saving model ...
Epoch: 15 cost time: 0.623049259185791
Epoch: 15, Steps: 10 | Train Loss: 2.032 Vali Loss: 3.107 Vali Acc: 0.160 Test Loss: 3.107 Test Acc: 0.160
Validation loss decreased (-0.152910 --> -0.159969).  Saving model ...
Epoch: 16 cost time: 0.593186616897583
Epoch: 16, Steps: 10 | Train Loss: 1.815 Vali Loss: 3.105 Vali Acc: 0.159 Test Loss: 3.105 Test Acc: 0.159
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6614015102386475
Epoch: 17, Steps: 10 | Train Loss: 1.742 Vali Loss: 3.090 Vali Acc: 0.162 Test Loss: 3.090 Test Acc: 0.162
Validation loss decreased (-0.159969 --> -0.162322).  Saving model ...
Epoch: 18 cost time: 0.6356496810913086
Epoch: 18, Steps: 10 | Train Loss: 1.602 Vali Loss: 3.068 Vali Acc: 0.175 Test Loss: 3.068 Test Acc: 0.175
Validation loss decreased (-0.162322 --> -0.175263).  Saving model ...
Epoch: 19 cost time: 0.5896077156066895
Epoch: 19, Steps: 10 | Train Loss: 1.529 Vali Loss: 3.042 Vali Acc: 0.192 Test Loss: 3.042 Test Acc: 0.192
Validation loss decreased (-0.175263 --> -0.191734).  Saving model ...
Epoch: 20 cost time: 0.6693389415740967
Epoch: 20, Steps: 10 | Train Loss: 1.363 Vali Loss: 3.035 Vali Acc: 0.196 Test Loss: 3.035 Test Acc: 0.196
Validation loss decreased (-0.191734 --> -0.196440).  Saving model ...
Epoch: 21 cost time: 0.6273014545440674
Epoch: 21, Steps: 10 | Train Loss: 1.289 Vali Loss: 3.020 Vali Acc: 0.214 Test Loss: 3.020 Test Acc: 0.214
Validation loss decreased (-0.196440 --> -0.214087).  Saving model ...
Epoch: 22 cost time: 0.5663354396820068
Epoch: 22, Steps: 10 | Train Loss: 1.118 Vali Loss: 3.036 Vali Acc: 0.213 Test Loss: 3.036 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7494034767150879
Epoch: 23, Steps: 10 | Train Loss: 1.020 Vali Loss: 2.988 Vali Acc: 0.226 Test Loss: 2.988 Test Acc: 0.226
Validation loss decreased (-0.214087 --> -0.225852).  Saving model ...
Epoch: 24 cost time: 0.7165377140045166
Epoch: 24, Steps: 10 | Train Loss: 0.877 Vali Loss: 3.007 Vali Acc: 0.233 Test Loss: 3.007 Test Acc: 0.233
Validation loss decreased (-0.225852 --> -0.232911).  Saving model ...
Epoch: 25 cost time: 0.6812753677368164
Epoch: 25, Steps: 10 | Train Loss: 0.810 Vali Loss: 2.965 Vali Acc: 0.252 Test Loss: 2.965 Test Acc: 0.252
Validation loss decreased (-0.232911 --> -0.251735).  Saving model ...
Epoch: 26 cost time: 0.6557655334472656
Epoch: 26, Steps: 10 | Train Loss: 0.629 Vali Loss: 2.970 Vali Acc: 0.253 Test Loss: 2.970 Test Acc: 0.253
Validation loss decreased (-0.251735 --> -0.252911).  Saving model ...
Epoch: 27 cost time: 0.6704719066619873
Epoch: 27, Steps: 10 | Train Loss: 0.569 Vali Loss: 2.969 Vali Acc: 0.260 Test Loss: 2.969 Test Acc: 0.260
Validation loss decreased (-0.252911 --> -0.259970).  Saving model ...
Epoch: 28 cost time: 0.6900436878204346
Epoch: 28, Steps: 10 | Train Loss: 0.554 Vali Loss: 2.956 Vali Acc: 0.265 Test Loss: 2.956 Test Acc: 0.265
Validation loss decreased (-0.259970 --> -0.264676).  Saving model ...
Epoch: 29 cost time: 0.6848926544189453
Epoch: 29, Steps: 10 | Train Loss: 0.503 Vali Loss: 3.050 Vali Acc: 0.272 Test Loss: 3.050 Test Acc: 0.272
Validation loss decreased (-0.264676 --> -0.271734).  Saving model ...
Epoch: 30 cost time: 0.7076215744018555
Epoch: 30, Steps: 10 | Train Loss: 0.522 Vali Loss: 2.968 Vali Acc: 0.273 Test Loss: 2.968 Test Acc: 0.273
Validation loss decreased (-0.271734 --> -0.272911).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27294117647058824
model parameter : 325106
model size : 1.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.9721643924713135
Epoch: 1, Steps: 10 | Train Loss: 3.302 Vali Loss: 3.292 Vali Acc: 0.048 Test Loss: 3.292 Test Acc: 0.048
Validation loss decreased (inf --> -0.048202).  Saving model ...
Epoch: 2 cost time: 0.5683577060699463
Epoch: 2, Steps: 10 | Train Loss: 3.254 Vali Loss: 3.280 Vali Acc: 0.051 Test Loss: 3.280 Test Acc: 0.051
Validation loss decreased (-0.048202 --> -0.050555).  Saving model ...
Epoch: 3 cost time: 0.5606253147125244
Epoch: 3, Steps: 10 | Train Loss: 3.191 Vali Loss: 3.274 Vali Acc: 0.058 Test Loss: 3.274 Test Acc: 0.058
Validation loss decreased (-0.050555 --> -0.057614).  Saving model ...
Epoch: 4 cost time: 0.5461900234222412
Epoch: 4, Steps: 10 | Train Loss: 3.130 Vali Loss: 3.271 Vali Acc: 0.054 Test Loss: 3.271 Test Acc: 0.054
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6105222702026367
Epoch: 5, Steps: 10 | Train Loss: 3.021 Vali Loss: 3.270 Vali Acc: 0.074 Test Loss: 3.270 Test Acc: 0.074
Validation loss decreased (-0.057614 --> -0.074085).  Saving model ...
Epoch: 6 cost time: 0.5630314350128174
Epoch: 6, Steps: 10 | Train Loss: 2.976 Vali Loss: 3.268 Vali Acc: 0.075 Test Loss: 3.268 Test Acc: 0.075
Validation loss decreased (-0.074085 --> -0.075261).  Saving model ...
Epoch: 7 cost time: 0.5477349758148193
Epoch: 7, Steps: 10 | Train Loss: 2.918 Vali Loss: 3.263 Vali Acc: 0.085 Test Loss: 3.263 Test Acc: 0.085
Validation loss decreased (-0.075261 --> -0.084673).  Saving model ...
Epoch: 8 cost time: 0.5628767013549805
Epoch: 8, Steps: 10 | Train Loss: 2.800 Vali Loss: 3.250 Vali Acc: 0.094 Test Loss: 3.250 Test Acc: 0.094
Validation loss decreased (-0.084673 --> -0.094085).  Saving model ...
Epoch: 9 cost time: 0.6050901412963867
Epoch: 9, Steps: 10 | Train Loss: 2.759 Vali Loss: 3.241 Vali Acc: 0.108 Test Loss: 3.241 Test Acc: 0.108
Validation loss decreased (-0.094085 --> -0.108203).  Saving model ...
Epoch: 10 cost time: 0.5613641738891602
Epoch: 10, Steps: 10 | Train Loss: 2.643 Vali Loss: 3.225 Vali Acc: 0.112 Test Loss: 3.225 Test Acc: 0.112
Validation loss decreased (-0.108203 --> -0.111732).  Saving model ...
Epoch: 11 cost time: 0.6002521514892578
Epoch: 11, Steps: 10 | Train Loss: 2.555 Vali Loss: 3.209 Vali Acc: 0.121 Test Loss: 3.209 Test Acc: 0.121
Validation loss decreased (-0.111732 --> -0.121144).  Saving model ...
Epoch: 12 cost time: 0.5458929538726807
Epoch: 12, Steps: 10 | Train Loss: 2.455 Vali Loss: 3.185 Vali Acc: 0.129 Test Loss: 3.185 Test Acc: 0.129
Validation loss decreased (-0.121144 --> -0.129380).  Saving model ...
Epoch: 13 cost time: 0.5659928321838379
Epoch: 13, Steps: 10 | Train Loss: 2.364 Vali Loss: 3.184 Vali Acc: 0.135 Test Loss: 3.184 Test Acc: 0.135
Validation loss decreased (-0.129380 --> -0.135262).  Saving model ...
Epoch: 14 cost time: 0.5473828315734863
Epoch: 14, Steps: 10 | Train Loss: 2.273 Vali Loss: 3.174 Vali Acc: 0.139 Test Loss: 3.174 Test Acc: 0.139
Validation loss decreased (-0.135262 --> -0.138792).  Saving model ...
Epoch: 15 cost time: 0.6023011207580566
Epoch: 15, Steps: 10 | Train Loss: 2.115 Vali Loss: 3.144 Vali Acc: 0.151 Test Loss: 3.144 Test Acc: 0.151
Validation loss decreased (-0.138792 --> -0.150557).  Saving model ...
Epoch: 16 cost time: 0.5764546394348145
Epoch: 16, Steps: 10 | Train Loss: 2.027 Vali Loss: 3.131 Vali Acc: 0.158 Test Loss: 3.131 Test Acc: 0.158
Validation loss decreased (-0.150557 --> -0.157616).  Saving model ...
Epoch: 17 cost time: 0.5543398857116699
Epoch: 17, Steps: 10 | Train Loss: 1.933 Vali Loss: 3.115 Vali Acc: 0.165 Test Loss: 3.115 Test Acc: 0.165
Validation loss decreased (-0.157616 --> -0.164675).  Saving model ...
Epoch: 18 cost time: 0.5707652568817139
Epoch: 18, Steps: 10 | Train Loss: 1.769 Vali Loss: 3.093 Vali Acc: 0.179 Test Loss: 3.093 Test Acc: 0.179
Validation loss decreased (-0.164675 --> -0.178793).  Saving model ...
Epoch: 19 cost time: 0.5868895053863525
Epoch: 19, Steps: 10 | Train Loss: 1.659 Vali Loss: 3.093 Vali Acc: 0.187 Test Loss: 3.093 Test Acc: 0.187
Validation loss decreased (-0.178793 --> -0.187028).  Saving model ...
Epoch: 20 cost time: 0.5653729438781738
Epoch: 20, Steps: 10 | Train Loss: 1.554 Vali Loss: 3.096 Vali Acc: 0.179 Test Loss: 3.096 Test Acc: 0.179
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5726141929626465
Epoch: 21, Steps: 10 | Train Loss: 1.378 Vali Loss: 3.076 Vali Acc: 0.200 Test Loss: 3.076 Test Acc: 0.200
Validation loss decreased (-0.187028 --> -0.199969).  Saving model ...
Epoch: 22 cost time: 0.5992922782897949
Epoch: 22, Steps: 10 | Train Loss: 1.365 Vali Loss: 3.077 Vali Acc: 0.199 Test Loss: 3.077 Test Acc: 0.199
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5512347221374512
Epoch: 23, Steps: 10 | Train Loss: 1.252 Vali Loss: 3.064 Vali Acc: 0.216 Test Loss: 3.064 Test Acc: 0.216
Validation loss decreased (-0.199969 --> -0.216440).  Saving model ...
Epoch: 24 cost time: 0.5899927616119385
Epoch: 24, Steps: 10 | Train Loss: 1.059 Vali Loss: 3.062 Vali Acc: 0.215 Test Loss: 3.062 Test Acc: 0.215
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.581352949142456
Epoch: 25, Steps: 10 | Train Loss: 1.031 Vali Loss: 3.054 Vali Acc: 0.238 Test Loss: 3.054 Test Acc: 0.238
Validation loss decreased (-0.216440 --> -0.237617).  Saving model ...
Epoch: 26 cost time: 0.5888118743896484
Epoch: 26, Steps: 10 | Train Loss: 0.879 Vali Loss: 3.049 Vali Acc: 0.248 Test Loss: 3.049 Test Acc: 0.248
Validation loss decreased (-0.237617 --> -0.248205).  Saving model ...
Epoch: 27 cost time: 0.5431432723999023
Epoch: 27, Steps: 10 | Train Loss: 0.770 Vali Loss: 3.055 Vali Acc: 0.244 Test Loss: 3.055 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5778653621673584
Epoch: 28, Steps: 10 | Train Loss: 0.735 Vali Loss: 3.066 Vali Acc: 0.258 Test Loss: 3.066 Test Acc: 0.258
Validation loss decreased (-0.248205 --> -0.257616).  Saving model ...
Epoch: 29 cost time: 0.5443425178527832
Epoch: 29, Steps: 10 | Train Loss: 0.603 Vali Loss: 3.066 Vali Acc: 0.262 Test Loss: 3.066 Test Acc: 0.262
Validation loss decreased (-0.257616 --> -0.262322).  Saving model ...
Epoch: 30 cost time: 0.5684781074523926
Epoch: 30, Steps: 10 | Train Loss: 0.558 Vali Loss: 3.047 Vali Acc: 0.268 Test Loss: 3.047 Test Acc: 0.268
Validation loss decreased (-0.262322 --> -0.268205).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26823529411764707
model parameter : 118098
model size : 0.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.214061975479126
Epoch: 1, Steps: 10 | Train Loss: 3.371 Vali Loss: 3.322 Vali Acc: 0.036 Test Loss: 3.322 Test Acc: 0.036
Validation loss decreased (inf --> -0.036437).  Saving model ...
Epoch: 2 cost time: 0.83750319480896
Epoch: 2, Steps: 10 | Train Loss: 3.286 Vali Loss: 3.309 Vali Acc: 0.034 Test Loss: 3.309 Test Acc: 0.034
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8460290431976318
Epoch: 3, Steps: 10 | Train Loss: 3.222 Vali Loss: 3.297 Vali Acc: 0.038 Test Loss: 3.297 Test Acc: 0.038
Validation loss decreased (-0.036437 --> -0.037614).  Saving model ...
Epoch: 4 cost time: 0.8647787570953369
Epoch: 4, Steps: 10 | Train Loss: 3.136 Vali Loss: 3.292 Vali Acc: 0.039 Test Loss: 3.292 Test Acc: 0.039
Validation loss decreased (-0.037614 --> -0.038791).  Saving model ...
Epoch: 5 cost time: 0.904472827911377
Epoch: 5, Steps: 10 | Train Loss: 3.047 Vali Loss: 3.287 Vali Acc: 0.060 Test Loss: 3.287 Test Acc: 0.060
Validation loss decreased (-0.038791 --> -0.059967).  Saving model ...
Epoch: 6 cost time: 0.9098215103149414
Epoch: 6, Steps: 10 | Train Loss: 3.001 Vali Loss: 3.277 Vali Acc: 0.074 Test Loss: 3.277 Test Acc: 0.074
Validation loss decreased (-0.059967 --> -0.074085).  Saving model ...
Epoch: 7 cost time: 0.8676638603210449
Epoch: 7, Steps: 10 | Train Loss: 2.881 Vali Loss: 3.268 Vali Acc: 0.084 Test Loss: 3.268 Test Acc: 0.084
Validation loss decreased (-0.074085 --> -0.083497).  Saving model ...
Epoch: 8 cost time: 0.8373138904571533
Epoch: 8, Steps: 10 | Train Loss: 2.802 Vali Loss: 3.255 Vali Acc: 0.092 Test Loss: 3.255 Test Acc: 0.092
Validation loss decreased (-0.083497 --> -0.091732).  Saving model ...
Epoch: 9 cost time: 0.91263747215271
Epoch: 9, Steps: 10 | Train Loss: 2.672 Vali Loss: 3.242 Vali Acc: 0.107 Test Loss: 3.242 Test Acc: 0.107
Validation loss decreased (-0.091732 --> -0.107026).  Saving model ...
Epoch: 10 cost time: 0.889348030090332
Epoch: 10, Steps: 10 | Train Loss: 2.568 Vali Loss: 3.226 Vali Acc: 0.104 Test Loss: 3.226 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9224884510040283
Epoch: 11, Steps: 10 | Train Loss: 2.445 Vali Loss: 3.198 Vali Acc: 0.120 Test Loss: 3.198 Test Acc: 0.120
Validation loss decreased (-0.107026 --> -0.119968).  Saving model ...
Epoch: 12 cost time: 0.8610196113586426
Epoch: 12, Steps: 10 | Train Loss: 2.304 Vali Loss: 3.171 Vali Acc: 0.120 Test Loss: 3.171 Test Acc: 0.120
Validation loss decreased (-0.119968 --> -0.119968).  Saving model ...
Epoch: 13 cost time: 0.8512039184570312
Epoch: 13, Steps: 10 | Train Loss: 2.160 Vali Loss: 3.153 Vali Acc: 0.133 Test Loss: 3.153 Test Acc: 0.133
Validation loss decreased (-0.119968 --> -0.132910).  Saving model ...
Epoch: 14 cost time: 0.9003994464874268
Epoch: 14, Steps: 10 | Train Loss: 2.000 Vali Loss: 3.126 Vali Acc: 0.147 Test Loss: 3.126 Test Acc: 0.147
Validation loss decreased (-0.132910 --> -0.147028).  Saving model ...
Epoch: 15 cost time: 0.8723876476287842
Epoch: 15, Steps: 10 | Train Loss: 1.817 Vali Loss: 3.105 Vali Acc: 0.160 Test Loss: 3.105 Test Acc: 0.160
Validation loss decreased (-0.147028 --> -0.159969).  Saving model ...
Epoch: 16 cost time: 0.8412168025970459
Epoch: 16, Steps: 10 | Train Loss: 1.658 Vali Loss: 3.079 Vali Acc: 0.182 Test Loss: 3.079 Test Acc: 0.182
Validation loss decreased (-0.159969 --> -0.182322).  Saving model ...
Epoch: 17 cost time: 0.8297402858734131
Epoch: 17, Steps: 10 | Train Loss: 1.497 Vali Loss: 3.058 Vali Acc: 0.193 Test Loss: 3.058 Test Acc: 0.193
Validation loss decreased (-0.182322 --> -0.192911).  Saving model ...
Epoch: 18 cost time: 0.8537197113037109
Epoch: 18, Steps: 10 | Train Loss: 1.381 Vali Loss: 3.031 Vali Acc: 0.195 Test Loss: 3.031 Test Acc: 0.195
Validation loss decreased (-0.192911 --> -0.195264).  Saving model ...
Epoch: 19 cost time: 0.9186382293701172
Epoch: 19, Steps: 10 | Train Loss: 1.225 Vali Loss: 3.051 Vali Acc: 0.199 Test Loss: 3.051 Test Acc: 0.199
Validation loss decreased (-0.195264 --> -0.198793).  Saving model ...
Epoch: 20 cost time: 0.905303955078125
Epoch: 20, Steps: 10 | Train Loss: 1.048 Vali Loss: 3.060 Vali Acc: 0.208 Test Loss: 3.060 Test Acc: 0.208
Validation loss decreased (-0.198793 --> -0.208205).  Saving model ...
Epoch: 21 cost time: 0.936751127243042
Epoch: 21, Steps: 10 | Train Loss: 0.975 Vali Loss: 2.990 Vali Acc: 0.224 Test Loss: 2.990 Test Acc: 0.224
Validation loss decreased (-0.208205 --> -0.223500).  Saving model ...
Epoch: 22 cost time: 0.8638503551483154
Epoch: 22, Steps: 10 | Train Loss: 0.836 Vali Loss: 2.979 Vali Acc: 0.235 Test Loss: 2.979 Test Acc: 0.235
Validation loss decreased (-0.223500 --> -0.235264).  Saving model ...
Epoch: 23 cost time: 0.8454229831695557
Epoch: 23, Steps: 10 | Train Loss: 0.667 Vali Loss: 2.963 Vali Acc: 0.242 Test Loss: 2.963 Test Acc: 0.242
Validation loss decreased (-0.235264 --> -0.242323).  Saving model ...
Epoch: 24 cost time: 0.886878252029419
Epoch: 24, Steps: 10 | Train Loss: 0.599 Vali Loss: 2.943 Vali Acc: 0.254 Test Loss: 2.943 Test Acc: 0.254
Validation loss decreased (-0.242323 --> -0.254088).  Saving model ...
Epoch: 25 cost time: 0.8499445915222168
Epoch: 25, Steps: 10 | Train Loss: 0.505 Vali Loss: 2.998 Vali Acc: 0.252 Test Loss: 2.998 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8531155586242676
Epoch: 26, Steps: 10 | Train Loss: 0.431 Vali Loss: 2.946 Vali Acc: 0.267 Test Loss: 2.946 Test Acc: 0.267
Validation loss decreased (-0.254088 --> -0.267029).  Saving model ...
Epoch: 27 cost time: 0.8416163921356201
Epoch: 27, Steps: 10 | Train Loss: 0.400 Vali Loss: 2.956 Vali Acc: 0.274 Test Loss: 2.956 Test Acc: 0.274
Validation loss decreased (-0.267029 --> -0.274088).  Saving model ...
Epoch: 28 cost time: 0.717846155166626
Epoch: 28, Steps: 10 | Train Loss: 0.365 Vali Loss: 3.073 Vali Acc: 0.262 Test Loss: 3.073 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8035078048706055
Epoch: 29, Steps: 10 | Train Loss: 0.296 Vali Loss: 2.964 Vali Acc: 0.273 Test Loss: 2.964 Test Acc: 0.273
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.7891204357147217
Epoch: 30, Steps: 10 | Train Loss: 0.282 Vali Loss: 3.063 Vali Acc: 0.272 Test Loss: 3.063 Test Acc: 0.272
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2741176470588235
model parameter : 178482
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.0247788429260254
Epoch: 1, Steps: 10 | Train Loss: 3.351 Vali Loss: 3.345 Vali Acc: 0.061 Test Loss: 3.345 Test Acc: 0.061
Validation loss decreased (inf --> -0.061143).  Saving model ...
Epoch: 2 cost time: 0.7993054389953613
Epoch: 2, Steps: 10 | Train Loss: 3.297 Vali Loss: 3.329 Vali Acc: 0.054 Test Loss: 3.329 Test Acc: 0.054
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7603304386138916
Epoch: 3, Steps: 10 | Train Loss: 3.211 Vali Loss: 3.312 Vali Acc: 0.049 Test Loss: 3.312 Test Acc: 0.049
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7484896183013916
Epoch: 4, Steps: 10 | Train Loss: 3.108 Vali Loss: 3.304 Vali Acc: 0.065 Test Loss: 3.304 Test Acc: 0.065
Validation loss decreased (-0.061143 --> -0.064673).  Saving model ...
Epoch: 5 cost time: 0.8118462562561035
Epoch: 5, Steps: 10 | Train Loss: 3.085 Vali Loss: 3.301 Vali Acc: 0.062 Test Loss: 3.301 Test Acc: 0.062
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7436108589172363
Epoch: 6, Steps: 10 | Train Loss: 2.994 Vali Loss: 3.296 Vali Acc: 0.068 Test Loss: 3.296 Test Acc: 0.068
Validation loss decreased (-0.064673 --> -0.068202).  Saving model ...
Epoch: 7 cost time: 0.7494080066680908
Epoch: 7, Steps: 10 | Train Loss: 2.927 Vali Loss: 3.290 Vali Acc: 0.073 Test Loss: 3.290 Test Acc: 0.073
Validation loss decreased (-0.068202 --> -0.072908).  Saving model ...
Epoch: 8 cost time: 0.7076151371002197
Epoch: 8, Steps: 10 | Train Loss: 2.862 Vali Loss: 3.278 Vali Acc: 0.082 Test Loss: 3.278 Test Acc: 0.082
Validation loss decreased (-0.072908 --> -0.082320).  Saving model ...
Epoch: 9 cost time: 0.7446603775024414
Epoch: 9, Steps: 10 | Train Loss: 2.755 Vali Loss: 3.266 Vali Acc: 0.092 Test Loss: 3.266 Test Acc: 0.092
Validation loss decreased (-0.082320 --> -0.091732).  Saving model ...
Epoch: 10 cost time: 0.7166621685028076
Epoch: 10, Steps: 10 | Train Loss: 2.652 Vali Loss: 3.246 Vali Acc: 0.096 Test Loss: 3.246 Test Acc: 0.096
Validation loss decreased (-0.091732 --> -0.096438).  Saving model ...
Epoch: 11 cost time: 0.7872076034545898
Epoch: 11, Steps: 10 | Train Loss: 2.526 Vali Loss: 3.227 Vali Acc: 0.105 Test Loss: 3.227 Test Acc: 0.105
Validation loss decreased (-0.096438 --> -0.104674).  Saving model ...
Epoch: 12 cost time: 0.7056431770324707
Epoch: 12, Steps: 10 | Train Loss: 2.434 Vali Loss: 3.211 Vali Acc: 0.116 Test Loss: 3.211 Test Acc: 0.116
Validation loss decreased (-0.104674 --> -0.116438).  Saving model ...
Epoch: 13 cost time: 0.7561051845550537
Epoch: 13, Steps: 10 | Train Loss: 2.351 Vali Loss: 3.193 Vali Acc: 0.129 Test Loss: 3.193 Test Acc: 0.129
Validation loss decreased (-0.116438 --> -0.129380).  Saving model ...
Epoch: 14 cost time: 0.7266199588775635
Epoch: 14, Steps: 10 | Train Loss: 2.205 Vali Loss: 3.174 Vali Acc: 0.136 Test Loss: 3.174 Test Acc: 0.136
Validation loss decreased (-0.129380 --> -0.136439).  Saving model ...
Epoch: 15 cost time: 0.7270829677581787
Epoch: 15, Steps: 10 | Train Loss: 2.056 Vali Loss: 3.158 Vali Acc: 0.151 Test Loss: 3.158 Test Acc: 0.151
Validation loss decreased (-0.136439 --> -0.150557).  Saving model ...
Epoch: 16 cost time: 0.7474377155303955
Epoch: 16, Steps: 10 | Train Loss: 1.898 Vali Loss: 3.140 Vali Acc: 0.165 Test Loss: 3.140 Test Acc: 0.165
Validation loss decreased (-0.150557 --> -0.164674).  Saving model ...
Epoch: 17 cost time: 0.764930248260498
Epoch: 17, Steps: 10 | Train Loss: 1.791 Vali Loss: 3.131 Vali Acc: 0.171 Test Loss: 3.131 Test Acc: 0.171
Validation loss decreased (-0.164674 --> -0.170557).  Saving model ...
Epoch: 18 cost time: 0.8047134876251221
Epoch: 18, Steps: 10 | Train Loss: 1.634 Vali Loss: 3.114 Vali Acc: 0.173 Test Loss: 3.114 Test Acc: 0.173
Validation loss decreased (-0.170557 --> -0.172910).  Saving model ...
Epoch: 19 cost time: 0.6452662944793701
Epoch: 19, Steps: 10 | Train Loss: 1.496 Vali Loss: 3.107 Vali Acc: 0.184 Test Loss: 3.107 Test Acc: 0.184
Validation loss decreased (-0.172910 --> -0.183498).  Saving model ...
Epoch: 20 cost time: 0.7396748065948486
Epoch: 20, Steps: 10 | Train Loss: 1.360 Vali Loss: 3.095 Vali Acc: 0.181 Test Loss: 3.095 Test Acc: 0.181
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7834906578063965
Epoch: 21, Steps: 10 | Train Loss: 1.230 Vali Loss: 3.101 Vali Acc: 0.194 Test Loss: 3.101 Test Acc: 0.194
Validation loss decreased (-0.183498 --> -0.194087).  Saving model ...
Epoch: 22 cost time: 0.7086806297302246
Epoch: 22, Steps: 10 | Train Loss: 1.096 Vali Loss: 3.097 Vali Acc: 0.205 Test Loss: 3.097 Test Acc: 0.205
Validation loss decreased (-0.194087 --> -0.204675).  Saving model ...
Epoch: 23 cost time: 0.7508368492126465
Epoch: 23, Steps: 10 | Train Loss: 1.008 Vali Loss: 3.105 Vali Acc: 0.202 Test Loss: 3.105 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8029003143310547
Epoch: 24, Steps: 10 | Train Loss: 0.890 Vali Loss: 3.093 Vali Acc: 0.211 Test Loss: 3.093 Test Acc: 0.211
Validation loss decreased (-0.204675 --> -0.210557).  Saving model ...
Epoch: 25 cost time: 0.8003425598144531
Epoch: 25, Steps: 10 | Train Loss: 0.810 Vali Loss: 3.105 Vali Acc: 0.216 Test Loss: 3.105 Test Acc: 0.216
Validation loss decreased (-0.210557 --> -0.216440).  Saving model ...
Epoch: 26 cost time: 0.7834179401397705
Epoch: 26, Steps: 10 | Train Loss: 0.675 Vali Loss: 3.098 Vali Acc: 0.220 Test Loss: 3.098 Test Acc: 0.220
Validation loss decreased (-0.216440 --> -0.219969).  Saving model ...
Epoch: 27 cost time: 0.7612006664276123
Epoch: 27, Steps: 10 | Train Loss: 0.560 Vali Loss: 3.094 Vali Acc: 0.225 Test Loss: 3.094 Test Acc: 0.225
Validation loss decreased (-0.219969 --> -0.224675).  Saving model ...
Epoch: 28 cost time: 0.8025901317596436
Epoch: 28, Steps: 10 | Train Loss: 0.531 Vali Loss: 3.113 Vali Acc: 0.241 Test Loss: 3.113 Test Acc: 0.241
Validation loss decreased (-0.224675 --> -0.241145).  Saving model ...
Epoch: 29 cost time: 0.7282066345214844
Epoch: 29, Steps: 10 | Train Loss: 0.436 Vali Loss: 3.109 Vali Acc: 0.234 Test Loss: 3.109 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8538095951080322
Epoch: 30, Steps: 10 | Train Loss: 0.405 Vali Loss: 3.151 Vali Acc: 0.229 Test Loss: 3.151 Test Acc: 0.229
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2411764705882353
model parameter : 74962
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.12296986579895
Epoch: 1, Steps: 10 | Train Loss: 3.373 Vali Loss: 3.323 Vali Acc: 0.036 Test Loss: 3.323 Test Acc: 0.036
Validation loss decreased (inf --> -0.036437).  Saving model ...
Epoch: 2 cost time: 0.8241636753082275
Epoch: 2, Steps: 10 | Train Loss: 3.287 Vali Loss: 3.310 Vali Acc: 0.035 Test Loss: 3.310 Test Acc: 0.035
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7380740642547607
Epoch: 3, Steps: 10 | Train Loss: 3.224 Vali Loss: 3.298 Vali Acc: 0.033 Test Loss: 3.298 Test Acc: 0.033
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8554978370666504
Epoch: 4, Steps: 10 | Train Loss: 3.137 Vali Loss: 3.293 Vali Acc: 0.041 Test Loss: 3.293 Test Acc: 0.041
Validation loss decreased (-0.036437 --> -0.041144).  Saving model ...
Epoch: 5 cost time: 0.758453369140625
Epoch: 5, Steps: 10 | Train Loss: 3.056 Vali Loss: 3.287 Vali Acc: 0.055 Test Loss: 3.287 Test Acc: 0.055
Validation loss decreased (-0.041144 --> -0.055261).  Saving model ...
Epoch: 6 cost time: 0.8498108386993408
Epoch: 6, Steps: 10 | Train Loss: 3.019 Vali Loss: 3.278 Vali Acc: 0.075 Test Loss: 3.278 Test Acc: 0.075
Validation loss decreased (-0.055261 --> -0.075261).  Saving model ...
Epoch: 7 cost time: 0.8118429183959961
Epoch: 7, Steps: 10 | Train Loss: 2.906 Vali Loss: 3.270 Vali Acc: 0.082 Test Loss: 3.270 Test Acc: 0.082
Validation loss decreased (-0.075261 --> -0.082320).  Saving model ...
Epoch: 8 cost time: 0.8253986835479736
Epoch: 8, Steps: 10 | Train Loss: 2.804 Vali Loss: 3.258 Vali Acc: 0.096 Test Loss: 3.258 Test Acc: 0.096
Validation loss decreased (-0.082320 --> -0.096438).  Saving model ...
Epoch: 9 cost time: 0.796025276184082
Epoch: 9, Steps: 10 | Train Loss: 2.705 Vali Loss: 3.246 Vali Acc: 0.114 Test Loss: 3.246 Test Acc: 0.114
Validation loss decreased (-0.096438 --> -0.114085).  Saving model ...
Epoch: 10 cost time: 0.8622641563415527
Epoch: 10, Steps: 10 | Train Loss: 2.595 Vali Loss: 3.231 Vali Acc: 0.112 Test Loss: 3.231 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7642292976379395
Epoch: 11, Steps: 10 | Train Loss: 2.454 Vali Loss: 3.202 Vali Acc: 0.124 Test Loss: 3.202 Test Acc: 0.124
Validation loss decreased (-0.114085 --> -0.123497).  Saving model ...
Epoch: 12 cost time: 0.7823758125305176
Epoch: 12, Steps: 10 | Train Loss: 2.320 Vali Loss: 3.173 Vali Acc: 0.135 Test Loss: 3.173 Test Acc: 0.135
Validation loss decreased (-0.123497 --> -0.135262).  Saving model ...
Epoch: 13 cost time: 0.7380812168121338
Epoch: 13, Steps: 10 | Train Loss: 2.182 Vali Loss: 3.155 Vali Acc: 0.154 Test Loss: 3.155 Test Acc: 0.154
Validation loss decreased (-0.135262 --> -0.154086).  Saving model ...
Epoch: 14 cost time: 0.7891359329223633
Epoch: 14, Steps: 10 | Train Loss: 2.088 Vali Loss: 3.129 Vali Acc: 0.154 Test Loss: 3.129 Test Acc: 0.154
Validation loss decreased (-0.154086 --> -0.154086).  Saving model ...
Epoch: 15 cost time: 0.7352485656738281
Epoch: 15, Steps: 10 | Train Loss: 1.876 Vali Loss: 3.123 Vali Acc: 0.171 Test Loss: 3.123 Test Acc: 0.171
Validation loss decreased (-0.154086 --> -0.170557).  Saving model ...
Epoch: 16 cost time: 0.7211835384368896
Epoch: 16, Steps: 10 | Train Loss: 1.704 Vali Loss: 3.100 Vali Acc: 0.178 Test Loss: 3.100 Test Acc: 0.178
Validation loss decreased (-0.170557 --> -0.177616).  Saving model ...
Epoch: 17 cost time: 0.7812397480010986
Epoch: 17, Steps: 10 | Train Loss: 1.517 Vali Loss: 3.073 Vali Acc: 0.194 Test Loss: 3.073 Test Acc: 0.194
Validation loss decreased (-0.177616 --> -0.194087).  Saving model ...
Epoch: 18 cost time: 0.8287653923034668
Epoch: 18, Steps: 10 | Train Loss: 1.405 Vali Loss: 3.052 Vali Acc: 0.207 Test Loss: 3.052 Test Acc: 0.207
Validation loss decreased (-0.194087 --> -0.207028).  Saving model ...
Epoch: 19 cost time: 0.8103218078613281
Epoch: 19, Steps: 10 | Train Loss: 1.314 Vali Loss: 3.066 Vali Acc: 0.209 Test Loss: 3.066 Test Acc: 0.209
Validation loss decreased (-0.207028 --> -0.209381).  Saving model ...
Epoch: 20 cost time: 0.8076012134552002
Epoch: 20, Steps: 10 | Train Loss: 1.123 Vali Loss: 3.104 Vali Acc: 0.213 Test Loss: 3.104 Test Acc: 0.213
Validation loss decreased (-0.209381 --> -0.212910).  Saving model ...
Epoch: 21 cost time: 0.8002641201019287
Epoch: 21, Steps: 10 | Train Loss: 1.134 Vali Loss: 3.011 Vali Acc: 0.232 Test Loss: 3.011 Test Acc: 0.232
Validation loss decreased (-0.212910 --> -0.231735).  Saving model ...
Epoch: 22 cost time: 0.7692074775695801
Epoch: 22, Steps: 10 | Train Loss: 0.921 Vali Loss: 3.008 Vali Acc: 0.249 Test Loss: 3.008 Test Acc: 0.249
Validation loss decreased (-0.231735 --> -0.249382).  Saving model ...
Epoch: 23 cost time: 0.8665776252746582
Epoch: 23, Steps: 10 | Train Loss: 0.815 Vali Loss: 2.999 Vali Acc: 0.255 Test Loss: 2.999 Test Acc: 0.255
Validation loss decreased (-0.249382 --> -0.255264).  Saving model ...
Epoch: 24 cost time: 0.7644038200378418
Epoch: 24, Steps: 10 | Train Loss: 0.733 Vali Loss: 3.010 Vali Acc: 0.253 Test Loss: 3.010 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7815678119659424
Epoch: 25, Steps: 10 | Train Loss: 0.572 Vali Loss: 3.016 Vali Acc: 0.260 Test Loss: 3.016 Test Acc: 0.260
Validation loss decreased (-0.255264 --> -0.259970).  Saving model ...
Epoch: 26 cost time: 0.7460670471191406
Epoch: 26, Steps: 10 | Train Loss: 0.525 Vali Loss: 3.008 Vali Acc: 0.272 Test Loss: 3.008 Test Acc: 0.272
Validation loss decreased (-0.259970 --> -0.271735).  Saving model ...
Epoch: 27 cost time: 0.7951185703277588
Epoch: 27, Steps: 10 | Train Loss: 0.397 Vali Loss: 2.997 Vali Acc: 0.286 Test Loss: 2.997 Test Acc: 0.286
Validation loss decreased (-0.271735 --> -0.285852).  Saving model ...
Epoch: 28 cost time: 0.7861881256103516
Epoch: 28, Steps: 10 | Train Loss: 0.450 Vali Loss: 3.109 Vali Acc: 0.264 Test Loss: 3.109 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7309226989746094
Epoch: 29, Steps: 10 | Train Loss: 0.312 Vali Loss: 3.020 Vali Acc: 0.282 Test Loss: 3.020 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.7152531147003174
Epoch: 30, Steps: 10 | Train Loss: 0.293 Vali Loss: 3.070 Vali Acc: 0.280 Test Loss: 3.070 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2858823529411765
model parameter : 178482
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.015472412109375
Epoch: 1, Steps: 10 | Train Loss: 3.367 Vali Loss: 3.345 Vali Acc: 0.060 Test Loss: 3.345 Test Acc: 0.060
Validation loss decreased (inf --> -0.059967).  Saving model ...
Epoch: 2 cost time: 0.7260746955871582
Epoch: 2, Steps: 10 | Train Loss: 3.305 Vali Loss: 3.329 Vali Acc: 0.059 Test Loss: 3.329 Test Acc: 0.059
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6889503002166748
Epoch: 3, Steps: 10 | Train Loss: 3.214 Vali Loss: 3.312 Vali Acc: 0.049 Test Loss: 3.312 Test Acc: 0.049
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7211334705352783
Epoch: 4, Steps: 10 | Train Loss: 3.114 Vali Loss: 3.304 Vali Acc: 0.062 Test Loss: 3.304 Test Acc: 0.062
Validation loss decreased (-0.059967 --> -0.062320).  Saving model ...
Epoch: 5 cost time: 0.6536605358123779
Epoch: 5, Steps: 10 | Train Loss: 3.099 Vali Loss: 3.300 Vali Acc: 0.062 Test Loss: 3.300 Test Acc: 0.062
Validation loss decreased (-0.062320 --> -0.062320).  Saving model ...
Epoch: 6 cost time: 0.6353151798248291
Epoch: 6, Steps: 10 | Train Loss: 3.008 Vali Loss: 3.296 Vali Acc: 0.068 Test Loss: 3.296 Test Acc: 0.068
Validation loss decreased (-0.062320 --> -0.068202).  Saving model ...
Epoch: 7 cost time: 0.6314449310302734
Epoch: 7, Steps: 10 | Train Loss: 2.948 Vali Loss: 3.289 Vali Acc: 0.073 Test Loss: 3.289 Test Acc: 0.073
Validation loss decreased (-0.068202 --> -0.072908).  Saving model ...
Epoch: 8 cost time: 0.6950502395629883
Epoch: 8, Steps: 10 | Train Loss: 2.880 Vali Loss: 3.278 Vali Acc: 0.087 Test Loss: 3.278 Test Acc: 0.087
Validation loss decreased (-0.072908 --> -0.087026).  Saving model ...
Epoch: 9 cost time: 0.6664133071899414
Epoch: 9, Steps: 10 | Train Loss: 2.783 Vali Loss: 3.267 Vali Acc: 0.089 Test Loss: 3.267 Test Acc: 0.089
Validation loss decreased (-0.087026 --> -0.089379).  Saving model ...
Epoch: 10 cost time: 0.6727683544158936
Epoch: 10, Steps: 10 | Train Loss: 2.688 Vali Loss: 3.249 Vali Acc: 0.094 Test Loss: 3.249 Test Acc: 0.094
Validation loss decreased (-0.089379 --> -0.094085).  Saving model ...
Epoch: 11 cost time: 0.6288924217224121
Epoch: 11, Steps: 10 | Train Loss: 2.562 Vali Loss: 3.230 Vali Acc: 0.104 Test Loss: 3.230 Test Acc: 0.104
Validation loss decreased (-0.094085 --> -0.103497).  Saving model ...
Epoch: 12 cost time: 0.6589655876159668
Epoch: 12, Steps: 10 | Train Loss: 2.479 Vali Loss: 3.216 Vali Acc: 0.112 Test Loss: 3.216 Test Acc: 0.112
Validation loss decreased (-0.103497 --> -0.111733).  Saving model ...
Epoch: 13 cost time: 0.6188309192657471
Epoch: 13, Steps: 10 | Train Loss: 2.372 Vali Loss: 3.199 Vali Acc: 0.122 Test Loss: 3.199 Test Acc: 0.122
Validation loss decreased (-0.111733 --> -0.122321).  Saving model ...
Epoch: 14 cost time: 0.5683331489562988
Epoch: 14, Steps: 10 | Train Loss: 2.256 Vali Loss: 3.178 Vali Acc: 0.136 Test Loss: 3.178 Test Acc: 0.136
Validation loss decreased (-0.122321 --> -0.136439).  Saving model ...
Epoch: 15 cost time: 0.7039353847503662
Epoch: 15, Steps: 10 | Train Loss: 2.109 Vali Loss: 3.161 Vali Acc: 0.141 Test Loss: 3.161 Test Acc: 0.141
Validation loss decreased (-0.136439 --> -0.141145).  Saving model ...
Epoch: 16 cost time: 0.6705811023712158
Epoch: 16, Steps: 10 | Train Loss: 1.982 Vali Loss: 3.147 Vali Acc: 0.158 Test Loss: 3.147 Test Acc: 0.158
Validation loss decreased (-0.141145 --> -0.157616).  Saving model ...
Epoch: 17 cost time: 0.6739449501037598
Epoch: 17, Steps: 10 | Train Loss: 1.853 Vali Loss: 3.140 Vali Acc: 0.156 Test Loss: 3.140 Test Acc: 0.156
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7315397262573242
Epoch: 18, Steps: 10 | Train Loss: 1.742 Vali Loss: 3.124 Vali Acc: 0.173 Test Loss: 3.124 Test Acc: 0.173
Validation loss decreased (-0.157616 --> -0.172910).  Saving model ...
Epoch: 19 cost time: 0.7381870746612549
Epoch: 19, Steps: 10 | Train Loss: 1.551 Vali Loss: 3.122 Vali Acc: 0.180 Test Loss: 3.122 Test Acc: 0.180
Validation loss decreased (-0.172910 --> -0.179969).  Saving model ...
Epoch: 20 cost time: 0.7317097187042236
Epoch: 20, Steps: 10 | Train Loss: 1.465 Vali Loss: 3.107 Vali Acc: 0.180 Test Loss: 3.107 Test Acc: 0.180
Validation loss decreased (-0.179969 --> -0.179969).  Saving model ...
Epoch: 21 cost time: 0.705258846282959
Epoch: 21, Steps: 10 | Train Loss: 1.266 Vali Loss: 3.116 Vali Acc: 0.188 Test Loss: 3.116 Test Acc: 0.188
Validation loss decreased (-0.179969 --> -0.188204).  Saving model ...
Epoch: 22 cost time: 0.7017374038696289
Epoch: 22, Steps: 10 | Train Loss: 1.195 Vali Loss: 3.117 Vali Acc: 0.187 Test Loss: 3.117 Test Acc: 0.187
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.704747200012207
Epoch: 23, Steps: 10 | Train Loss: 1.056 Vali Loss: 3.121 Vali Acc: 0.199 Test Loss: 3.121 Test Acc: 0.199
Validation loss decreased (-0.188204 --> -0.198792).  Saving model ...
Epoch: 24 cost time: 0.669043779373169
Epoch: 24, Steps: 10 | Train Loss: 1.072 Vali Loss: 3.126 Vali Acc: 0.207 Test Loss: 3.126 Test Acc: 0.207
Validation loss decreased (-0.198792 --> -0.207028).  Saving model ...
Epoch: 25 cost time: 0.6294615268707275
Epoch: 25, Steps: 10 | Train Loss: 0.868 Vali Loss: 3.137 Vali Acc: 0.218 Test Loss: 3.137 Test Acc: 0.218
Validation loss decreased (-0.207028 --> -0.217616).  Saving model ...
Epoch: 26 cost time: 0.6726646423339844
Epoch: 26, Steps: 10 | Train Loss: 0.821 Vali Loss: 3.127 Vali Acc: 0.224 Test Loss: 3.127 Test Acc: 0.224
Validation loss decreased (-0.217616 --> -0.223498).  Saving model ...
Epoch: 27 cost time: 0.5535633563995361
Epoch: 27, Steps: 10 | Train Loss: 0.657 Vali Loss: 3.145 Vali Acc: 0.224 Test Loss: 3.145 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6803529262542725
Epoch: 28, Steps: 10 | Train Loss: 0.643 Vali Loss: 3.168 Vali Acc: 0.238 Test Loss: 3.168 Test Acc: 0.238
Validation loss decreased (-0.223498 --> -0.237615).  Saving model ...
Epoch: 29 cost time: 0.7044756412506104
Epoch: 29, Steps: 10 | Train Loss: 0.573 Vali Loss: 3.161 Vali Acc: 0.249 Test Loss: 3.161 Test Acc: 0.249
Validation loss decreased (-0.237615 --> -0.249380).  Saving model ...
Epoch: 30 cost time: 0.6423385143280029
Epoch: 30, Steps: 10 | Train Loss: 0.468 Vali Loss: 3.188 Vali Acc: 0.246 Test Loss: 3.188 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.24941176470588236
model parameter : 74962
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.8420495986938477
Epoch: 1, Steps: 10 | Train Loss: 3.381 Vali Loss: 3.330 Vali Acc: 0.034 Test Loss: 3.330 Test Acc: 0.034
Validation loss decreased (inf --> -0.034084).  Saving model ...
Epoch: 2 cost time: 0.70611572265625
Epoch: 2, Steps: 10 | Train Loss: 3.289 Vali Loss: 3.317 Vali Acc: 0.029 Test Loss: 3.317 Test Acc: 0.029
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6522963047027588
Epoch: 3, Steps: 10 | Train Loss: 3.221 Vali Loss: 3.304 Vali Acc: 0.027 Test Loss: 3.304 Test Acc: 0.027
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.655282735824585
Epoch: 4, Steps: 10 | Train Loss: 3.136 Vali Loss: 3.300 Vali Acc: 0.034 Test Loss: 3.300 Test Acc: 0.034
Validation loss decreased (-0.034084 --> -0.034085).  Saving model ...
Epoch: 5 cost time: 0.6545729637145996
Epoch: 5, Steps: 10 | Train Loss: 3.071 Vali Loss: 3.294 Vali Acc: 0.056 Test Loss: 3.294 Test Acc: 0.056
Validation loss decreased (-0.034085 --> -0.056438).  Saving model ...
Epoch: 6 cost time: 0.5568110942840576
Epoch: 6, Steps: 10 | Train Loss: 3.028 Vali Loss: 3.285 Vali Acc: 0.069 Test Loss: 3.285 Test Acc: 0.069
Validation loss decreased (-0.056438 --> -0.069379).  Saving model ...
Epoch: 7 cost time: 0.6014688014984131
Epoch: 7, Steps: 10 | Train Loss: 2.910 Vali Loss: 3.279 Vali Acc: 0.072 Test Loss: 3.279 Test Acc: 0.072
Validation loss decreased (-0.069379 --> -0.071732).  Saving model ...
Epoch: 8 cost time: 0.633314847946167
Epoch: 8, Steps: 10 | Train Loss: 2.828 Vali Loss: 3.269 Vali Acc: 0.088 Test Loss: 3.269 Test Acc: 0.088
Validation loss decreased (-0.071732 --> -0.088203).  Saving model ...
Epoch: 9 cost time: 0.5635135173797607
Epoch: 9, Steps: 10 | Train Loss: 2.683 Vali Loss: 3.259 Vali Acc: 0.105 Test Loss: 3.259 Test Acc: 0.105
Validation loss decreased (-0.088203 --> -0.104673).  Saving model ...
Epoch: 10 cost time: 0.6344377994537354
Epoch: 10, Steps: 10 | Train Loss: 2.645 Vali Loss: 3.246 Vali Acc: 0.098 Test Loss: 3.246 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6470930576324463
Epoch: 11, Steps: 10 | Train Loss: 2.477 Vali Loss: 3.221 Vali Acc: 0.116 Test Loss: 3.221 Test Acc: 0.116
Validation loss decreased (-0.104673 --> -0.116438).  Saving model ...
Epoch: 12 cost time: 0.5827488899230957
Epoch: 12, Steps: 10 | Train Loss: 2.350 Vali Loss: 3.192 Vali Acc: 0.121 Test Loss: 3.192 Test Acc: 0.121
Validation loss decreased (-0.116438 --> -0.121145).  Saving model ...
Epoch: 13 cost time: 0.7097291946411133
Epoch: 13, Steps: 10 | Train Loss: 2.252 Vali Loss: 3.175 Vali Acc: 0.134 Test Loss: 3.175 Test Acc: 0.134
Validation loss decreased (-0.121145 --> -0.134086).  Saving model ...
Epoch: 14 cost time: 0.6453993320465088
Epoch: 14, Steps: 10 | Train Loss: 2.100 Vali Loss: 3.150 Vali Acc: 0.151 Test Loss: 3.150 Test Acc: 0.151
Validation loss decreased (-0.134086 --> -0.150557).  Saving model ...
Epoch: 15 cost time: 0.5762655735015869
Epoch: 15, Steps: 10 | Train Loss: 1.959 Vali Loss: 3.149 Vali Acc: 0.159 Test Loss: 3.149 Test Acc: 0.159
Validation loss decreased (-0.150557 --> -0.158792).  Saving model ...
Epoch: 16 cost time: 0.5666356086730957
Epoch: 16, Steps: 10 | Train Loss: 1.786 Vali Loss: 3.141 Vali Acc: 0.167 Test Loss: 3.141 Test Acc: 0.167
Validation loss decreased (-0.158792 --> -0.167027).  Saving model ...
Epoch: 17 cost time: 0.6166665554046631
Epoch: 17, Steps: 10 | Train Loss: 1.654 Vali Loss: 3.128 Vali Acc: 0.185 Test Loss: 3.128 Test Acc: 0.185
Validation loss decreased (-0.167027 --> -0.184675).  Saving model ...
Epoch: 18 cost time: 0.5811030864715576
Epoch: 18, Steps: 10 | Train Loss: 1.605 Vali Loss: 3.121 Vali Acc: 0.182 Test Loss: 3.121 Test Acc: 0.182
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.566575288772583
Epoch: 19, Steps: 10 | Train Loss: 1.533 Vali Loss: 3.133 Vali Acc: 0.187 Test Loss: 3.133 Test Acc: 0.187
Validation loss decreased (-0.184675 --> -0.187027).  Saving model ...
Epoch: 20 cost time: 0.6281332969665527
Epoch: 20, Steps: 10 | Train Loss: 1.328 Vali Loss: 3.118 Vali Acc: 0.195 Test Loss: 3.118 Test Acc: 0.195
Validation loss decreased (-0.187027 --> -0.195263).  Saving model ...
Epoch: 21 cost time: 0.5878705978393555
Epoch: 21, Steps: 10 | Train Loss: 1.283 Vali Loss: 3.074 Vali Acc: 0.208 Test Loss: 3.074 Test Acc: 0.208
Validation loss decreased (-0.195263 --> -0.208205).  Saving model ...
Epoch: 22 cost time: 0.6283173561096191
Epoch: 22, Steps: 10 | Train Loss: 1.152 Vali Loss: 3.071 Vali Acc: 0.219 Test Loss: 3.071 Test Acc: 0.219
Validation loss decreased (-0.208205 --> -0.218793).  Saving model ...
Epoch: 23 cost time: 0.551053524017334
Epoch: 23, Steps: 10 | Train Loss: 0.990 Vali Loss: 3.073 Vali Acc: 0.228 Test Loss: 3.073 Test Acc: 0.228
Validation loss decreased (-0.218793 --> -0.228205).  Saving model ...
Epoch: 24 cost time: 0.5932319164276123
Epoch: 24, Steps: 10 | Train Loss: 0.879 Vali Loss: 3.079 Vali Acc: 0.236 Test Loss: 3.079 Test Acc: 0.236
Validation loss decreased (-0.228205 --> -0.236440).  Saving model ...
Epoch: 25 cost time: 0.6207468509674072
Epoch: 25, Steps: 10 | Train Loss: 0.838 Vali Loss: 3.109 Vali Acc: 0.233 Test Loss: 3.109 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6275613307952881
Epoch: 26, Steps: 10 | Train Loss: 0.688 Vali Loss: 3.050 Vali Acc: 0.259 Test Loss: 3.050 Test Acc: 0.259
Validation loss decreased (-0.236440 --> -0.258793).  Saving model ...
Epoch: 27 cost time: 0.5880048274993896
Epoch: 27, Steps: 10 | Train Loss: 0.646 Vali Loss: 3.023 Vali Acc: 0.271 Test Loss: 3.023 Test Acc: 0.271
Validation loss decreased (-0.258793 --> -0.270558).  Saving model ...
Epoch: 28 cost time: 0.600527286529541
Epoch: 28, Steps: 10 | Train Loss: 0.570 Vali Loss: 3.081 Vali Acc: 0.264 Test Loss: 3.081 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6058971881866455
Epoch: 29, Steps: 10 | Train Loss: 0.530 Vali Loss: 3.122 Vali Acc: 0.258 Test Loss: 3.122 Test Acc: 0.258
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6416153907775879
Epoch: 30, Steps: 10 | Train Loss: 0.499 Vali Loss: 3.052 Vali Acc: 0.272 Test Loss: 3.052 Test Acc: 0.272
Validation loss decreased (-0.270558 --> -0.271734).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27176470588235296
model parameter : 178482
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.9195325374603271
Epoch: 1, Steps: 10 | Train Loss: 3.372 Vali Loss: 3.339 Vali Acc: 0.058 Test Loss: 3.339 Test Acc: 0.058
Validation loss decreased (inf --> -0.057614).  Saving model ...
Epoch: 2 cost time: 0.5399377346038818
Epoch: 2, Steps: 10 | Train Loss: 3.304 Vali Loss: 3.324 Vali Acc: 0.059 Test Loss: 3.324 Test Acc: 0.059
Validation loss decreased (-0.057614 --> -0.058790).  Saving model ...
Epoch: 3 cost time: 0.5612192153930664
Epoch: 3, Steps: 10 | Train Loss: 3.242 Vali Loss: 3.308 Vali Acc: 0.053 Test Loss: 3.308 Test Acc: 0.053
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5301475524902344
Epoch: 4, Steps: 10 | Train Loss: 3.132 Vali Loss: 3.302 Vali Acc: 0.066 Test Loss: 3.302 Test Acc: 0.066
Validation loss decreased (-0.058790 --> -0.065849).  Saving model ...
Epoch: 5 cost time: 0.510451078414917
Epoch: 5, Steps: 10 | Train Loss: 3.113 Vali Loss: 3.299 Vali Acc: 0.066 Test Loss: 3.299 Test Acc: 0.066
Validation loss decreased (-0.065849 --> -0.065849).  Saving model ...
Epoch: 6 cost time: 0.5094492435455322
Epoch: 6, Steps: 10 | Train Loss: 3.024 Vali Loss: 3.295 Vali Acc: 0.072 Test Loss: 3.295 Test Acc: 0.072
Validation loss decreased (-0.065849 --> -0.071732).  Saving model ...
Epoch: 7 cost time: 0.46045517921447754
Epoch: 7, Steps: 10 | Train Loss: 2.974 Vali Loss: 3.289 Vali Acc: 0.076 Test Loss: 3.289 Test Acc: 0.076
Validation loss decreased (-0.071732 --> -0.076438).  Saving model ...
Epoch: 8 cost time: 0.48713135719299316
Epoch: 8, Steps: 10 | Train Loss: 2.903 Vali Loss: 3.280 Vali Acc: 0.086 Test Loss: 3.280 Test Acc: 0.086
Validation loss decreased (-0.076438 --> -0.085850).  Saving model ...
Epoch: 9 cost time: 0.5162160396575928
Epoch: 9, Steps: 10 | Train Loss: 2.820 Vali Loss: 3.271 Vali Acc: 0.093 Test Loss: 3.271 Test Acc: 0.093
Validation loss decreased (-0.085850 --> -0.092908).  Saving model ...
Epoch: 10 cost time: 0.5701630115509033
Epoch: 10, Steps: 10 | Train Loss: 2.729 Vali Loss: 3.255 Vali Acc: 0.092 Test Loss: 3.255 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5428190231323242
Epoch: 11, Steps: 10 | Train Loss: 2.616 Vali Loss: 3.240 Vali Acc: 0.102 Test Loss: 3.240 Test Acc: 0.102
Validation loss decreased (-0.092908 --> -0.102321).  Saving model ...
Epoch: 12 cost time: 0.536508321762085
Epoch: 12, Steps: 10 | Train Loss: 2.576 Vali Loss: 3.230 Vali Acc: 0.108 Test Loss: 3.230 Test Acc: 0.108
Validation loss decreased (-0.102321 --> -0.108203).  Saving model ...
Epoch: 13 cost time: 0.5134122371673584
Epoch: 13, Steps: 10 | Train Loss: 2.475 Vali Loss: 3.218 Vali Acc: 0.116 Test Loss: 3.218 Test Acc: 0.116
Validation loss decreased (-0.108203 --> -0.116438).  Saving model ...
Epoch: 14 cost time: 0.5053882598876953
Epoch: 14, Steps: 10 | Train Loss: 2.360 Vali Loss: 3.200 Vali Acc: 0.120 Test Loss: 3.200 Test Acc: 0.120
Validation loss decreased (-0.116438 --> -0.119968).  Saving model ...
Epoch: 15 cost time: 0.5201466083526611
Epoch: 15, Steps: 10 | Train Loss: 2.241 Vali Loss: 3.183 Vali Acc: 0.129 Test Loss: 3.183 Test Acc: 0.129
Validation loss decreased (-0.119968 --> -0.129380).  Saving model ...
Epoch: 16 cost time: 0.54062819480896
Epoch: 16, Steps: 10 | Train Loss: 2.097 Vali Loss: 3.167 Vali Acc: 0.146 Test Loss: 3.167 Test Acc: 0.146
Validation loss decreased (-0.129380 --> -0.145851).  Saving model ...
Epoch: 17 cost time: 0.5158910751342773
Epoch: 17, Steps: 10 | Train Loss: 2.039 Vali Loss: 3.158 Vali Acc: 0.148 Test Loss: 3.158 Test Acc: 0.148
Validation loss decreased (-0.145851 --> -0.148204).  Saving model ...
Epoch: 18 cost time: 0.5013620853424072
Epoch: 18, Steps: 10 | Train Loss: 1.917 Vali Loss: 3.145 Vali Acc: 0.156 Test Loss: 3.145 Test Acc: 0.156
Validation loss decreased (-0.148204 --> -0.156439).  Saving model ...
Epoch: 19 cost time: 0.5371501445770264
Epoch: 19, Steps: 10 | Train Loss: 1.761 Vali Loss: 3.139 Vali Acc: 0.162 Test Loss: 3.139 Test Acc: 0.162
Validation loss decreased (-0.156439 --> -0.162322).  Saving model ...
Epoch: 20 cost time: 0.5639111995697021
Epoch: 20, Steps: 10 | Train Loss: 1.636 Vali Loss: 3.127 Vali Acc: 0.166 Test Loss: 3.127 Test Acc: 0.166
Validation loss decreased (-0.162322 --> -0.165851).  Saving model ...
Epoch: 21 cost time: 0.5310347080230713
Epoch: 21, Steps: 10 | Train Loss: 1.564 Vali Loss: 3.134 Vali Acc: 0.175 Test Loss: 3.134 Test Acc: 0.175
Validation loss decreased (-0.165851 --> -0.175263).  Saving model ...
Epoch: 22 cost time: 0.49544429779052734
Epoch: 22, Steps: 10 | Train Loss: 1.398 Vali Loss: 3.118 Vali Acc: 0.185 Test Loss: 3.118 Test Acc: 0.185
Validation loss decreased (-0.175263 --> -0.184675).  Saving model ...
Epoch: 23 cost time: 0.5389888286590576
Epoch: 23, Steps: 10 | Train Loss: 1.374 Vali Loss: 3.124 Vali Acc: 0.199 Test Loss: 3.124 Test Acc: 0.199
Validation loss decreased (-0.184675 --> -0.198792).  Saving model ...
Epoch: 24 cost time: 0.5490109920501709
Epoch: 24, Steps: 10 | Train Loss: 1.160 Vali Loss: 3.116 Vali Acc: 0.201 Test Loss: 3.116 Test Acc: 0.201
Validation loss decreased (-0.198792 --> -0.201145).  Saving model ...
Epoch: 25 cost time: 0.5148184299468994
Epoch: 25, Steps: 10 | Train Loss: 1.027 Vali Loss: 3.121 Vali Acc: 0.207 Test Loss: 3.121 Test Acc: 0.207
Validation loss decreased (-0.201145 --> -0.207028).  Saving model ...
Epoch: 26 cost time: 0.4910430908203125
Epoch: 26, Steps: 10 | Train Loss: 0.945 Vali Loss: 3.123 Vali Acc: 0.228 Test Loss: 3.123 Test Acc: 0.228
Validation loss decreased (-0.207028 --> -0.228204).  Saving model ...
Epoch: 27 cost time: 0.4772202968597412
Epoch: 27, Steps: 10 | Train Loss: 0.795 Vali Loss: 3.118 Vali Acc: 0.225 Test Loss: 3.118 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.4973938465118408
Epoch: 28, Steps: 10 | Train Loss: 0.819 Vali Loss: 3.152 Vali Acc: 0.233 Test Loss: 3.152 Test Acc: 0.233
Validation loss decreased (-0.228204 --> -0.232910).  Saving model ...
Epoch: 29 cost time: 0.5373296737670898
Epoch: 29, Steps: 10 | Train Loss: 0.648 Vali Loss: 3.145 Vali Acc: 0.239 Test Loss: 3.145 Test Acc: 0.239
Validation loss decreased (-0.232910 --> -0.238792).  Saving model ...
Epoch: 30 cost time: 0.5506138801574707
Epoch: 30, Steps: 10 | Train Loss: 0.596 Vali Loss: 3.171 Vali Acc: 0.236 Test Loss: 3.171 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Handwriting_TimesNet_UEA_ftM_sl152_ll0_pl0_el2_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2388235294117647
model parameter : 74962
model size : 0.45MB
